(() => {
  const __dcg_shared_module_source__ = "// shared.js\n  (() => {\n    const __dcg_chunk_exports__ = {};var K3=Object.create;var eI=Object.defineProperty;var eG=Object.getOwnPropertyDescriptor;var tG=Object.getOwnPropertyNames;var nG=Object.getPrototypeOf,rG=Object.prototype.hasOwnProperty;var JW=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,n)=>(typeof require!=\"undefined\"?require:t)[n]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw Error('Dynamic require of \"'+e+'\" is not supported')});var QW=(e,t)=>()=>(e&&(t=e(e=0)),t);var KW=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ka=(e,t)=>{for(var n in t)eI(e,n,{get:t[n],enumerable:!0})},sG=(e,t,n,r)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let s of tG(t))!rG.call(e,s)&&s!==n&&eI(e,s,{get:()=>t[s],enumerable:!(r=eG(t,s))||r.enumerable});return e};var e4=(e,t,n)=>(n=e!=null?K3(nG(e)):{},sG(t||!e||!e.__esModule?eI(n,\"default\",{value:e,enumerable:!0}):n,e));var SN=function(){{let e=function(){},t=[\"log\",\"info\",\"warn\",\"error\",\"assert\",\"dir\",\"clear\",\"profile\",\"profileEnd\",\"time\",\"timeEnd\",\"group\",\"groupCollapsed\",\"groupEnd\",\"trace\"],n={},r=function(s){typeof window!=\"undefined\"&&window.console&&window.console[s]?n[s]=function(){Function.prototype.apply.call(window.console[s],window.console,arguments)}:n[s]=e};return t.forEach(r),n}}(),n4=SN,{log:r4,warn:s4,error:o4,assert:i4,dir:a4,clear:u4,profile:c4,profileEnd:l4,time:p4,timeEnd:m4,group:d4,groupCollapsed:f4,groupEnd:y4,trace:g4}=SN;var va={};Ka(va,{DEFAULT_COMPLEX_EVALUATION_LABEL_OPTIONS:()=>cM,DEFAULT_EVALUATION_LABEL_OPTIONS:()=>MO,canDisplayAsFraction:()=>vO,complexNumberLabel:()=>$f,complexPlainMathNumberLabel:()=>lM,formatSymbol:()=>z,getPointEstimateLatexLabel:()=>qz,identifierToHTML:()=>Hz,identifierToLatex:()=>ss,latexToIdentifier:()=>vi,numericLabel:()=>sb,point:()=>Az,point3dLabel:()=>zz,pointLabel:()=>Uz,trimLatex:()=>Tu,truncatedHTMLLabel:()=>ob,truncatedLatexLabel:()=>Oc,truncatedPlainmathLabel:()=>pm,value:()=>uM});function MN(e,t,n){if(e=Dp(e),n>0){let r=Dp(t);return e<r&&(e+=2*Math.PI),(e-r)/n}else{let r=Dp(t+n);return e<r&&(e+=2*Math.PI),1+(e-r)/n}}function lg(e,t,n){e=Dp(e);let r=Dp(t),s=Dp(t+n);if(n<0){let o=r;r=s,s=o}return r<s?r<=e&&e<=s:r<=e||e<=s}function Dp(e){let t=2*Math.PI;return(e%t+t)%t}function b4(e,t){if(!(isNaN(e)||isNaN(t)))return e>=0?Math.atan(t/e):Math.atan(t/e)+Math.PI}var yi=Math.hypot;function zu(e,t){return e>0==t>0?e+.5*(t-e):.5*(e+t)}function iG(e,t,n,r,s,o){return e*r+t*s+n*o}function qi(e,t,n,r,s,o,i,a,u){let c=yi(i-r,a-s,u-o);return c===0?0:iG((e-r)/c,(t-s)/c,(n-o)/c,(i-r)/c,(a-s)/c,(u-o)/c)}function aG(e,t,n,r,s,o){let i=qi(e,t,0,n,r,0,s,o,0);return i<=0?[n,r]:i>=1?[s,o]:[n+i*(s-n),r+i*(o-r)]}function uG(e,t,n,r,s,o,i,a,u){let c=qi(e,t,n,r,s,o,i,a,u);return c<=0?[r,s,o]:c>=1?[i,a,u]:[r+c*(i-r),s+c*(a-s),o+c*(u-o)]}function T4(e,t,n,r,s,o,i,a){let u=qi(e,t,0,n,r,0,s,o,0);return u<=0&&!i?[n,r]:u>=1&&!a?[s,o]:[n+u*(s-n),r+u*(o-r)]}function CN(e,t,n,r,s,o){let i=aG(e,t,n,r,s,o);return yi(e-i[0],t-i[1])}function vN(e,t,n,r,s,o,i,a,u){let c=uG(e,t,n,r,s,o,i,a,u);return yi(e-c[0],t-c[1],n-c[2])}function I4(e,t,n,r,s,o,i){let a=Math.atan2(t-r,e-n);if(lg(a,o,i-o))return[s*Math.cos(a)+n,s*Math.sin(a)+r]}function Co(e,t,n=1){if(e===t)return!0;if(!isFinite(e)||!isFinite(t))return!1;if(n>50)throw new Error(\"Within \"+(52-n)+\" bits isn't really approximate any more\");let r=Math.max(Math.max(Math.abs(e),Math.abs(t)),1),s=n===1?.5:Math.pow(.5,n);return r===r+s*Math.abs(t-e)}function P4(e){return Math.round(e-.5)+.5}function $u(e,t=1e6){if(e===1/0)return{n:1/0,d:1};if(e===-1/0)return{n:-1/0,d:1};if(!isFinite(e))return{n:NaN,d:1};let n,r=0,s=1,o=1,i=0,a,u;for(;n=Math.floor(e),a=n*s+r,u=n*i+o,!(u>t||(r=s,o=i,s=a,i=u,e===n));)e=1/(e-n);return{n:s,d:i}}var ue={};Ka(ue,{Action:()=>it,AngleMarker:()=>ve,Any:()=>Pn,Arc:()=>ae,Bool:()=>Re,BroadcastableArg:()=>gg,Circle:()=>pe,Complex:()=>O,ConfidenceInterval:()=>Et,DirectedAngleMarker:()=>Te,Distribution:()=>Sn,EmptyList:()=>Ae,ErrorType:()=>El,EstimatedParameter:()=>Mn,HypothesisTest:()=>Ot,InferenceObjectTypes:()=>fg,Line:()=>Pe,ListArgType:()=>yg,ListOfAngleMarker:()=>Er,ListOfAny:()=>Yn,ListOfArc:()=>ts,ListOfBool:()=>ro,ListOfCircle:()=>oo,ListOfColor:()=>xs,ListOfComplex:()=>He,ListOfConfidenceInterval:()=>nu,ListOfDirectedAngleMarker:()=>Sr,ListOfDistribution:()=>so,ListOfHypothesisTest:()=>cu,ListOfLine:()=>io,ListOfMapInterval2DComplex:()=>Ta,ListOfMapInterval2DPoint:()=>ha,ListOfMapInterval2DPoint3D:()=>ba,ListOfMapIntervalComplex:()=>xa,ListOfMapIntervalPoint:()=>ga,ListOfMapIntervalPoint3D:()=>ki,ListOfNumber:()=>Y,ListOfNumberNC:()=>$i,ListOfOneProportionZInference:()=>au,ListOfOneSampleTInference:()=>ru,ListOfOneSampleZInference:()=>ou,ListOfPoint:()=>Gt,ListOfPoint3D:()=>zr,ListOfPolygon:()=>hr,ListOfRay:()=>ns,ListOfRegressionTInference:()=>lu,ListOfRestriction:()=>eu,ListOfSegment:()=>lr,ListOfSegment3D:()=>vo,ListOfSphere3D:()=>zi,ListOfTone:()=>tu,ListOfTransformation:()=>Ui,ListOfTriangle3D:()=>As,ListOfTwoProportionZInference:()=>uu,ListOfTwoSampleTInference:()=>su,ListOfTwoSampleZInference:()=>iu,ListOfVector:()=>ao,ListOfVector3D:()=>Do,MapInterval2DComplex:()=>xi,MapInterval2DPoint:()=>hi,MapInterval2DPoint3D:()=>bi,MapIntervalComplex:()=>Ro,MapIntervalPoint:()=>No,MapIntervalPoint3D:()=>rs,NoCoerceComplexToReal:()=>Hd,Number:()=>b,NumberNC:()=>ge,OneProportionZInference:()=>$t,OneSampleTInference:()=>St,OneSampleZInference:()=>Ht,Point:()=>N,Point3D:()=>F,Polygon:()=>Se,RGBColor:()=>pn,Ray:()=>De,RegressionTInference:()=>Ut,Restriction:()=>nn,SeedType:()=>Pt,Segment:()=>Ie,Segment3D:()=>Jt,SlotNameMap:()=>Vd,Sphere3D:()=>Mr,Tone:()=>Qn,Transformation:()=>Ne,Triangle3D:()=>Kn,TupleTypeMap:()=>Sl,TwoProportionZInference:()=>Yt,TwoSampleTInference:()=>Mt,TwoSampleZInference:()=>qt,UNKNOWN_RETURN_TYPE:()=>hG,Union:()=>cr,Vector:()=>ye,Vector3D:()=>Fe,allListTypes:()=>Oo,allTupleTypes:()=>rI,allValueTypes:()=>pG,angleTypes:()=>iI,assertTypeIsOneOf:()=>mu,broadcastArg:()=>Cr,broadcastable:()=>q,commonCoerceableType:()=>gc,commonCoerceableTypeWithBroadcast:()=>Yu,elementType:()=>Xe,getAllowedTypesForArg:()=>Ud,hasListType:()=>Hn,hasMapType:()=>aI,isActionValue:()=>Zu,isEligibleForBroadcast:()=>hg,isGeometryType:()=>Gd,isInferenceObjectType:()=>pu,isList:()=>$,isMapOrListOfMap:()=>Ia,isMultipliableElementType:()=>sI,isOneOf:()=>hc,isSubType:()=>gi,isSubTypeOrCoercible:()=>Jn,isSubTypeOrNonComplexCoercible:()=>Pl,isSummableElementType:()=>Op,isTupleType:()=>tI,isTypeOrListOfType:()=>se,isValidOnLogScales:()=>Ml,listArg:()=>qd,listType:()=>Ln,mapType:()=>uI,multipliableElementTypes:()=>mg,namedSlot:()=>gG,nanOrZeroOfTupleType:()=>nI,prettyPrint:()=>oe,repr:()=>We,scalarType:()=>Zn,signature:()=>gt,slotIndex:()=>Bd,straightTypes:()=>dg,summableElementTypes:()=>Rp,typeSatisfiesArgType:()=>bg,typeSatisfiesArgTypeUncoerced:()=>Cl,valueTypes:()=>DN,variadicMinCount:()=>kr,vectorTypes:()=>oI});function pg(e,t){return t?Ln(e):e}function gi(e,t){return e===Ae&&$(t)||t===Yn&&$(e)||t===Pn&&!$(e)?!0:e===t}function Jn(e,t){if(e===void 0)return!1;if(gi(e,t))return!0;$(e)&&$(t)&&t!==Ae&&(e=Xe(e),t=Xe(t));let n=t;switch(e){case ve:case Te:case nn:case b:case O:return n===b||n===O;default:return!1}}function Pl(e,t){return t===b&&e===O||t===Y&&e===He?!1:Jn(e,t)}function gc(e,t){if(gi(e,t))return t;if(gi(t,e))return e;let n=$(e);if(n!=$(t))return;let r=pg(O,n);if(e===r&&Jn(t,r))return r;if(t===r&&Jn(e,r))return r;let s=pg(b,n);if(Jn(e,s)&&Jn(t,s)){let o=pg(ve,n),i=pg(Te,n);return e===o&&t===i||e===i&&t===o?void 0:s}}function Yu(e,t){return $(e)&&Hn(t)?gc(e,Ln(t)):Hn(e)&&$(t)?gc(Ln(e),t):gc(e,t)}function I(e,t){return{key:e,vars:t}}var Pn=0,b=1,Re=2,N=3,Sn=4,it=5,Yn=6,Y=7,ro=8,Gt=9,so=10,Ae=11,El=12,Pt=13,pn=14,xs=15,Se=16,hr=17,Ie=18,lr=19,pe=20,oo=21,ae=22,ts=23,Pe=24,io=25,De=26,ns=27,ve=28,Er=29,Te=30,Sr=31,Ne=32,Ui=33,ye=34,ao=35,nn=36,eu=37,O=38,He=39,Qn=50,tu=51,Et=60,nu=61,St=62,ru=63,Mt=64,su=65,Ht=66,ou=67,qt=68,iu=69,$t=70,au=71,Yt=72,uu=73,Ot=74,cu=75,Ut=76,lu=77,F=100,zr=101,Jt=102,vo=103,Kn=104,As=105,Mr=106,zi=107,Fe=108,Do=109,No=200,rs=201,hi=202,bi=203,ga=204,ki=205,ha=206,ba=207,Ro=208,xi=209,xa=210,Ta=211,DN={Any:Pn,Number:b,Bool:Re,Complex:O,ListOfComplex:He,Point:N,Point3D:F,Distribution:Sn,Action:it,ListOfAny:Yn,ListOfNumber:Y,ListOfBool:ro,ListOfPoint:Gt,ListOfPoint3D:zr,ListOfDistribution:so,EmptyList:Ae,ErrorType:El,SeedType:Pt,RGBColor:pn,ListOfColor:xs,Polygon:Se,ListOfPolygon:hr,Segment:Ie,ListOfSegment:lr,Circle:pe,ListOfCircle:oo,Arc:ae,ListOfArc:ts,Line:Pe,ListOfLine:io,Ray:De,ListOfRay:ns,Vector:ye,ListOfVector:ao,Restriction:nn,ListOfRestriction:eu,AngleMarker:ve,ListOfAngleMarker:Er,DirectedAngleMarker:Te,ListOfDirectedAngleMarker:Sr,Transformation:Ne,ListOfTransformation:Ui,Segment3D:Jt,ListOfSegment3D:vo,Triangle3D:Kn,ListOfTriangle3D:As,Sphere3D:Mr,ListOfSphere3D:zi,Vector3D:Fe,ListOfVector3D:Do,Tone:Qn,ListOfTone:tu,ConfidenceInterval:Et,ListOfConfidenceInterval:nu,OneSampleTInference:St,ListOfOneSampleTInference:ru,TwoSampleTInference:Mt,ListOfTwoSampleTInference:su,RegressionTInference:Ut,ListOfRegressionTInference:lu,OneSampleZInference:Ht,ListOfOneSampleZInference:ou,TwoSampleZInference:qt,ListOfTwoSampleZInference:iu,OneProportionZInference:$t,ListOfOneProportionZInference:au,TwoProportionZInference:Yt,ListOfTwoProportionZInference:uu,HypothesisTest:Ot,ListOfHypothesisTest:cu,MapIntervalPoint:No,MapIntervalComplex:Ro,MapIntervalPoint3D:rs,MapInterval2DPoint:hi,MapInterval2DComplex:xi,MapInterval2DPoint3D:bi,ListOfMapIntervalPoint:ga,ListOfMapIntervalComplex:xa,ListOfMapIntervalPoint3D:ki,ListOfMapInterval2DPoint:ha,ListOfMapInterval2DComplex:Ta,ListOfMapInterval2DPoint3D:ba},NN={[N]:[[\"x\",b],[\"y\",b]],[F]:[[\"x\",b],[\"y\",b],[\"z\",b]],[O]:[[\"real\",b],[\"imag\",b]],[Et]:[[\"min\",b],[\"max\",b],[\"testStatisticType\",b]],[St]:[[\"mean\",b],[\"stdev\",b],[\"count\",b],[\"dof\",b]],[Mt]:[[\"mean1\",b],[\"stdev1\",b],[\"count1\",b],[\"mean2\",b],[\"stdev2\",b],[\"count2\",b],[\"dof\",b]],[Ut]:[[\"pointEstimate\",b],[\"standardError\",b],[\"dof\",b]],[Ht]:[[\"mean\",b],[\"count\",b],[\"stdevp\",b]],[qt]:[[\"mean1\",b],[\"count1\",b],[\"stdevp1\",b],[\"mean2\",b],[\"count2\",b],[\"stdevp2\",b]],[$t]:[[\"successes\",b],[\"count\",b]],[Yt]:[[\"successes1\",b],[\"count1\",b],[\"successes2\",b],[\"count2\",b]],[Ot]:[[\"p\",b],[\"score\",b],[\"hypothesis\",b],[\"testStatisticType\",b],[\"pleft\",b],[\"pright\",b],[\"dof\",b]]};function cG(){let e={};for(let[t,n]of Object.entries(NN))e[t]=n.map(r=>r[1]);return e}function lG(){let e={};for(let[t,n]of Object.entries(NN))e[t]=n.map(r=>r[0]);return e}var Sl=cG(),Vd=lG();function Bd(e,t){let n=Vd[e];if(n===void 0)throw new Error(`Programming error: ${We(e)} is not a tuple type.`);let r=n.indexOf(t);if(r===-1)throw new Error(`Programming error: ${t} is not a slot of ${We(e)}`);return r}function tI(e){return e in Vd}function nI(e,t){let n=Sl[e];return{valueType:e,value:n.map(r=>{if(r!==b)throw new Error(\"Unable to handle tuple type unless all slots are Number\");return t})}}var cr=class e{constructor(t,{coerceComplexToReal:n}){this.types=t;this.coerceComplexToReal=n}static of(t,n={coerceComplexToReal:!0}){return new e(t,n)}getTypes(){return this.types}},pG=Object.values(DN),mG=Object.keys(Sl).map(parseFloat),rI=cr.of(mG);function We(e){if($(e))return e===Ae?\"EmptyList\":`ListOf${We(Xe(e))}`;switch(e){case Pn:return\"Any\";case b:return\"Number\";case Re:return\"Bool\";case O:return\"Complex\";case N:return\"Point\";case F:return\"Point3D\";case Sn:return\"Distribution\";case Et:return\"ConfidenceInterval\";case St:return\"OneSampleTInference\";case Mt:return\"TwoSampleTInference\";case Ut:return\"RegressionTInference\";case Ht:return\"OneSampleZInference\";case qt:return\"TwoSampleZInference\";case $t:return\"OneProportionZInference\";case Yt:return\"TwoProportionZInference\";case Ot:return\"HypothesisTest\";case it:return\"Action\";case El:return\"ErrorType\";case Pt:return\"SeedType\";case pn:return\"RGBColor\";case Se:return\"Polygon\";case Ie:return\"Segment\";case pe:return\"Circle\";case ae:return\"Arc\";case Pe:return\"Line\";case De:return\"Ray\";case ye:return\"Vector\";case nn:return\"Restriction\";case ve:return\"Angle\";case Te:return\"DirectedAngle\";case Ne:return\"Transformation\";case Jt:return\"Segment3D\";case Fe:return\"Vector3D\";case Kn:return\"Triangle3D\";case Mr:return\"Sphere3D\";case Qn:return\"Tone\";case No:return\"MapIntervalPoint\";case Ro:return\"MapIntervalComplex\";case rs:return\"MapIntervalPoint3D\";case hi:return\"MapInterval2ToPoint\";case xi:return\"MapInterval2ToComplex\";case bi:return\"MapInterval2DPoint3D\";default:let t=e;throw new Error(`Invalid type: ${t}`)}}function oe(e,t){var r;let n=(r=t==null?void 0:t.specifyPointDimensions)!=null?r:!1;switch(e){case Pn:return I(\"shared-calculator-label-value-type-any\");case b:return I(\"shared-calculator-label-value-type-number\");case Re:return I(\"shared-calculator-label-value-type-bool\");case O:return I(\"shared-calculator-label-value-type-complex\");case N:return n?I(\"shared-calculator-label-value-type-point2d\"):I(\"shared-calculator-label-value-type-point\");case F:return I(\"shared-calculator-label-value-type-point3d\");case Sn:return I(\"shared-calculator-label-value-type-distribution\");case it:return I(\"shared-calculator-label-value-type-action\");case Yn:return I(\"shared-calculator-label-value-type-list-of-any\");case Y:return I(\"shared-calculator-label-value-type-list-of-numbers\");case ro:return I(\"shared-calculator-label-value-type-list-of-bool\");case He:return I(\"shared-calculator-label-value-type-list-of-complex\");case Gt:return n?I(\"shared-calculator-label-value-type-list-of-2d-points\"):I(\"shared-calculator-label-value-type-list-of-points\");case zr:return I(\"shared-calculator-label-value-type-list-of-3d-points\");case so:return I(\"shared-calculator-label-value-type-list-of-distributions\");case Ae:return I(\"shared-calculator-label-value-type-empty-list\");case El:return I(\"shared-calculator-label-value-type-error\");case Pt:return I(\"shared-calculator-label-value-type-seed\");case pn:return I(\"shared-calculator-label-value-type-color\");case xs:return I(\"shared-calculator-label-value-type-list-of-colors\");case Se:return I(\"shared-calculator-label-value-type-polygon\");case hr:return I(\"shared-calculator-label-value-type-list-of-polygons\");case Ie:return I(\"shared-calculator-label-value-type-segment\");case lr:return I(\"shared-calculator-label-value-type-list-of-segments\");case pe:return I(\"shared-calculator-label-value-type-circle\");case oo:return I(\"shared-calculator-label-value-type-list-of-circles\");case ae:return I(\"shared-calculator-label-value-type-arc\");case ts:return I(\"shared-calculator-label-value-type-list-of-arcs\");case Pe:return I(\"shared-calculator-label-value-type-line\");case io:return I(\"shared-calculator-label-value-type-list-of-lines\");case De:return I(\"shared-calculator-label-value-type-ray\");case ns:return I(\"shared-calculator-label-value-type-list-of-rays\");case ye:return I(\"shared-calculator-label-value-type-vector\");case ao:return I(\"shared-calculator-label-value-type-list-of-vectors\");case nn:return I(\"shared-calculator-label-value-type-restriction\");case eu:return I(\"shared-calculator-label-value-type-list-of-restrictions\");case ve:return I(\"shared-calculator-label-value-type-angle\");case Er:return I(\"shared-calculator-label-value-type-list-of-angles\");case Te:return I(\"shared-calculator-label-value-type-directed-angle\");case Sr:return I(\"shared-calculator-label-value-type-list-of-directed-angles\");case Ne:return I(\"shared-calculator-label-value-type-transformation\");case Ui:return I(\"shared-calculator-label-value-type-list-of-transformations\");case Jt:return I(\"shared-calculator-label-value-type-segment3d\");case vo:return I(\"shared-calculator-label-value-type-list-of-segment3d\");case Fe:return I(\"shared-calculator-label-value-type-vector3d\");case Do:return I(\"shared-calculator-label-value-type-list-of-vector3d\");case Kn:return I(\"shared-calculator-label-value-type-triangle3d\");case As:return I(\"shared-calculator-label-value-type-list-of-triangle3d\");case Mr:return I(\"shared-calculator-label-value-type-sphere3d\");case zi:return I(\"shared-calculator-label-value-type-list-of-sphere3d\");case Qn:return I(\"shared-calculator-label-value-type-tone\");case tu:return I(\"shared-calculator-label-value-type-list-of-tone\");case Et:return I(\"shared-calculator-label-value-type-confidence-interval\");case nu:return I(\"shared-calculator-label-value-type-list-of-confidence-interval\");case Ot:return I(\"shared-calculator-label-value-type-hypothesis-test\");case cu:return I(\"shared-calculator-label-value-type-list-of-hypothesis-test\");case St:return I(\"shared-calculator-label-value-type-one-sample-t-inference\");case Mt:return I(\"shared-calculator-label-value-type-two-sample-t-inference\");case Ut:return I(\"shared-calculator-label-value-type-regression-t-inference\");case Ht:return I(\"shared-calculator-label-value-type-one-sample-z-inference\");case qt:return I(\"shared-calculator-label-value-type-two-sample-z-inference\");case $t:return I(\"shared-calculator-label-value-type-one-proportion-z-inference\");case Yt:return I(\"shared-calculator-label-value-type-two-proportion-z-inference\");case ru:return I(\"shared-calculator-label-value-type-list-of-one-sample-t-inference\");case su:return I(\"shared-calculator-label-value-type-list-of-two-sample-t-inference\");case lu:return I(\"shared-calculator-label-value-type-list-of-regression-t-inference\");case ou:return I(\"shared-calculator-label-value-type-list-of-one-sample-z-inference\");case iu:return I(\"shared-calculator-label-value-type-list-of-two-sample-z-inference\");case au:return I(\"shared-calculator-label-value-type-list-of-one-proportion-z-inference\");case uu:return I(\"shared-calculator-label-value-type-list-of-two-proportion-z-inference\");case No:case hi:return I(\"shared-calculator-label-value-type-lambda-point\");case Ro:case xi:return I(\"shared-calculator-label-value-type-lambda-complex\");case rs:case bi:return I(\"shared-calculator-label-value-type-lambda-point3d\");case ga:case ha:return I(\"shared-calculator-label-value-type-list-of-lambda-point\");case xa:case Ta:return I(\"shared-calculator-label-value-type-list-of-lambda-complex\");case ki:case ba:return I(\"shared-calculator-label-value-type-list-of-lambda-point3d\");default:throw new Error(`Invalid type: ${e}`)}}var dG=[Yn,Y,ro,He,eu,Gt,zr,so,Ae,xs,hr,lr,oo,ts,io,ns,ao,Er,Sr,Ui,vo,Do,As,zi,tu,nu,ru,su,lu,ou,iu,au,uu,cu,ga,xa,ki,ha,Ta,ba],Oo=cr.of(dG,{coerceComplexToReal:!1}),RN={[Yn]:Pn,[Ae]:b,[Y]:b,[ro]:Re,[He]:O,[eu]:nn,[Gt]:N,[zr]:F,[so]:Sn,[xs]:pn,[hr]:Se,[lr]:Ie,[oo]:pe,[ts]:ae,[io]:Pe,[ns]:De,[ao]:ye,[Er]:ve,[Sr]:Te,[Ui]:Ne,[vo]:Jt,[Do]:Fe,[As]:Kn,[zi]:Mr,[tu]:Qn,[nu]:Et,[ru]:St,[su]:Mt,[lu]:Ut,[ou]:Ht,[iu]:qt,[au]:$t,[uu]:Yt,[cu]:Ot,[ga]:No,[xa]:Ro,[ki]:rs,[ha]:hi,[Ta]:xi,[ba]:bi};function $(e){return e===void 0?!1:e in RN}function Xe(e){if(!$(e))throw new Error(\"Type \"+We(e)+\" does not implement elementType.\");return RN[e]}function Zn(e){return $(e)?Xe(e):e}function Ln(e){if($(e))throw new Error(\"Type \"+We(e)+\" does not implement listType.\");switch(e){case Pn:return Yn;case b:return Y;case Re:return ro;case O:return He;case nn:return eu;case N:return Gt;case F:return zr;case Sn:return so;case pn:return xs;case Se:return hr;case Ie:return lr;case pe:return oo;case ae:return ts;case Pe:return io;case De:return ns;case ye:return ao;case ve:return Er;case Te:return Sr;case Ne:return Ui;case Jt:return vo;case Fe:return Do;case Kn:return As;case Mr:return zi;case Qn:return tu;case Et:return nu;case St:return ru;case Mt:return su;case Ut:return lu;case Ht:return ou;case qt:return iu;case $t:return au;case Yt:return uu;case Ot:return cu;case No:return ga;case Ro:return xa;case rs:return ki;case hi:return ha;case xi:return Ta;case bi:return ba;case El:case Pt:case it:throw new Error(\"Type \"+We(e)+\" does not implement listType.\");default:throw new Error(`Invalid type: ${e}`)}}function Hn(e){if($(e))return!1;switch(e){case Pt:case it:case El:return!1;default:return!0}}function Gd(e){if(e===void 0)return!1;switch(e){case N:case Se:case Ie:case pe:case ae:case Pe:case De:case ye:case ve:case Te:case Ne:return!0;default:return!1}}function Ml(e){if($(e))return Ml(Xe(e));switch(e){case b:case Pn:case Re:case O:case nn:case N:case No:case Ro:case Sn:case it:case El:case Pt:case pn:case Qn:case Et:case St:case Mt:case Ut:case Ht:case qt:case $t:case Yt:case Ot:return!0;case F:case Jt:case Fe:case Kn:case Mr:case Se:case Ie:case pe:case ae:case Pe:case De:case ye:case ve:case Te:case Ne:case rs:case hi:case xi:case bi:return!1;default:throw new Error(`Invalid type: ${e}`)}}function hc(e,t){for(let n of t)if(e===n)return!0;return!1}var Rp=[b,O,N,F];function Op(e){return Rp.includes(e)}var mg=[b,O];function sI(e){return mg.includes(e)}var dg=cr.of([Pe,De,Ie,ye]),oI=cr.of([ye,Fe]),iI=cr.of([ve,Te]);function se(e,t){return e===void 0?!1:e===t?!0:$(e)?e===Ae?!0:Xe(e)===t:!1}function Ia(e){return hc(e,[No,Ro,rs,hi,xi,bi,ga,xa,ki,ha,Ta,ba])}var ON={[N]:No,[O]:Ro,[F]:rs},fG={[N]:hi,[O]:xi,[F]:bi};function aI(e){return ON[e]!==void 0}function uI(e,t){let n=t===1?ON[e]:fG[e];if(n===void 0)throw new Error(`Unexpected return type for map: ${We(e)}`);return n}var fg=[St,Mt,Ut,Ht,qt,$t,Yt];function pu(e){return hc(e,fg)}function mu(e,t){if(!hc(e,t))throw new Error(`Programming error: expected one of ${t.map(We)} but found ${e&&We(e)} instead.`)}var Mn={MEAN_T_INFERENCE:0,MEAN_Z_INFERENCE:1,DIFFERENCE_OF_MEANS_T_INFERENCE:2,DIFFERENCE_OF_MEANS_Z_INFERENCE:3,PROPORTION:4,DIFFERENCE_OF_PROPORTIONS:5};function Zu(e){return typeof e==\"object\"&&\"type\"in e&&e.type===\"Action\"}function gG(e,t){return e.value[Bd(e.valueType,t)]}var hG=Symbol(\"UNKNOWN_RETURN_TYPE\");function AN(e){return typeof e==\"object\"&&e.type===\"variadic\"}function kr(e,t){return{type:\"variadic\",initial:new Array(t).fill(e),rest:e}}var cI=class{constructor(t,n){this.argTypes=t;this.productContext=n;this.minArity=this.argTypes.length,this.maxArity=this.argTypes.length}argTypeAtIndex(t){if(!(t>this.argTypes.length-1))return this.argTypes[t]}matches(t){return _N(this,t)}satisfiesPolicy(t){return t.is3dProduct()?this.productContext[\"3d\"]:t.isGeometryEnabled()?this.productContext.geometry:this.productContext.graphing}},lI=class{constructor(t,n){this.productContext=n;this.maxArity=void 0;this.initial=t.initial,this.rest=t.rest,this.minArity=this.initial.length}argTypeAtIndex(t){return t<this.initial.length?this.initial[t]:this.rest}matches(t){return _N(this,t)}satisfiesPolicy(t){return t.is3dProduct()?this.productContext[\"3d\"]:t.isGeometryEnabled()?this.productContext.geometry:this.productContext.graphing}};function _N(e,t){return e.maxArity!==void 0&&e.maxArity<t.length?!1:!!t.every((n,r)=>{if(n===void 0)return!0;let s=e.argTypeAtIndex(r);return s===void 0?!1:bg(n,s)})}var Hd=class{constructor(t){this.arg=t;this.coerceComplexToReal=!1}getTypes(){return typeof this.arg==\"number\"?[this.arg]:this.arg.getTypes()}},ge=new Hd(b),$i=new Hd(Y),yg=class{constructor(t){typeof t==\"number\"?(this.coerceComplexToReal=t===b,this.nodeTypes=[Ln(t)]):(this.coerceComplexToReal=t.coerceComplexToReal,this.nodeTypes=t.getTypes().map(Ln))}getTypes(){return this.nodeTypes}};function qd(e){return new yg(e)}var gg=class{constructor(t){if(typeof t==\"number\")this.coerceComplexToReal=t===b,this.nodeTypes=[t,Ln(t)];else{this.coerceComplexToReal=t.coerceComplexToReal,this.nodeTypes=[];for(let n of t.getTypes())this.nodeTypes.push(n,Ln(n))}}getTypes(){return this.nodeTypes}};function hg(e){return typeof e==\"number\"?Hn(e):e instanceof cr?e.types.every(hg):!1}function Cr(e){return new gg(e)}function gt(e,t={}){let n={geometry:!0,\"3d\":!0,graphing:!0,...t};return AN(e)?new lI(e,n):new cI(e,n)}function q(e,t={}){return AN(e)?gt({type:\"variadic\",initial:e.initial.map(Cr),rest:Cr(e.rest)},t):gt(e.map(Cr),t)}function bg(e,t){if(typeof t==\"number\")return Jn(e,t);{let n=t.getTypes();return t.coerceComplexToReal?n.some(r=>Jn(e,r)):n.some(r=>Pl(e,r))}}function Cl(e,t){return typeof t==\"number\"?gi(e,t):t.getTypes().some(r=>gi(e,r))}function Ud(e,t){let n=new Set;for(let r of e){let s=r.argTypeAtIndex(t);if(s===void 0)continue;let o=bG(s);for(let i of o)n.add(i)}return[...n]}function bG(e){return typeof e==\"number\"?[e]:e.getTypes()}var xg=typeof self==\"object\"&&self.self===self&&self||typeof global==\"object\"&&global.global===global&&global||Function(\"return this\")()||{},Pg=Array.prototype,dI=Object.prototype,wN=typeof Symbol!=\"undefined\"?Symbol.prototype:null,w4=Pg.push,HN=Pg.slice,Tg=dI.toString,xG=dI.hasOwnProperty,TG=Array.isArray,LN=Object.keys,FN=Object.create,qN=xg.isNaN,IG=xg.isFinite,pI=function(){};function $r(e){if(e instanceof $r)return e;if(!(this instanceof $r))return new $r(e);this._wrapped=e}var L4=$r.VERSION=\"1.10.2\";function Eg(e,t,n){if(t===void 0)return e;switch(n==null?3:n){case 1:return function(r){return e.call(t,r)};case 3:return function(r,s,o){return e.call(t,r,s,o)};case 4:return function(r,s,o,i){return e.call(t,r,s,o,i)}}return function(){return e.apply(t,arguments)}}function UN(e,t,n){return e==null?WG:Xu(e)?Eg(e,t,n):Fp(e)&&!Lp(e)?jG(e):eR(e)}$r.iteratee=zN;function zN(e,t){return UN(e,t,1/0)}function Pa(e,t,n){return $r.iteratee!==zN?$r.iteratee(e,t):UN(e,t,n)}function Ti(e,t){return t=t==null?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),s=0;s<n;s++)r[s]=arguments[s+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var o=Array(t+1);for(s=0;s<t;s++)o[s]=arguments[s];return o[t]=r,e.apply(this,o)}}function PG(e){if(!Fp(e))return{};if(FN)return FN(e);pI.prototype=e;var t=new pI;return pI.prototype=null,t}function kN(e){return function(t){return t==null?void 0:t[e]}}function _p(e,t){return e!=null&&xG.call(e,t)}function $N(e,t){for(var n=t.length,r=0;r<n;r++){if(e==null)return;e=e[t[r]]}return n?e:void 0}var EG=Math.pow(2,53)-1,bc=kN(\"length\");function Ii(e){var t=bc(e);return typeof t==\"number\"&&t>=0&&t<=EG}function wp(e,t,n){t=Eg(t,n);var r,s;if(Ii(e))for(r=0,s=e.length;r<s;r++)t(e[r],r,e);else{var o=Yo(e);for(r=0,s=o.length;r<s;r++)t(e[o[r]],o[r],e)}return e}function Sg(e,t,n){t=Pa(t,n);for(var r=!Ii(e)&&Yo(e),s=(r||e).length,o=Array(s),i=0;i<s;i++){var a=r?r[i]:i;o[i]=t(e[a],a,e)}return o}function YN(e){var t=function(n,r,s,o){var i=!Ii(n)&&Yo(n),a=(i||n).length,u=e>0?0:a-1;for(o||(s=n[i?i[u]:u],u+=e);u>=0&&u<a;u+=e){var c=i?i[u]:u;s=r(s,n[c],c,n)}return s};return function(n,r,s,o){var i=arguments.length>=3;return t(n,Eg(r,o,4),s,i)}}var F4=YN(1),V4=YN(-1);function SG(e,t,n){var r=[];return t=Pa(t,n),wp(e,function(s,o,i){t(s,o,i)&&r.push(s)}),r}function B4(e,t,n){t=Pa(t,n);for(var r=!Ii(e)&&Yo(e),s=(r||e).length,o=0;o<s;o++){var i=r?r[o]:o;if(!t(e[i],i,e))return!1}return!0}function G4(e,t,n){t=Pa(t,n);for(var r=!Ii(e)&&Yo(e),s=(r||e).length,o=0;o<s;o++){var i=r?r[o]:o;if(t(e[i],i,e))return!0}return!1}function Ap(e,t,n,r){return Ii(e)||(e=zd(e)),(typeof n!=\"number\"||r)&&(n=0),OG(e,t,n)>=0}var H4=Ti(function(e,t,n){var r,s;return Xu(t)?s=t:Lp(t)&&(r=t.slice(0,-1),t=t[t.length-1]),Sg(e,function(o){var i=s;if(!i){if(r&&r.length&&(o=$N(o,r)),o==null)return;i=o[t]}return i==null?i:i.apply(o,n)})});function ZN(e,t){return Sg(e,eR(t))}function MG(e,t,n){var r=-1/0,s=-1/0,o,i;if(t==null||typeof t==\"number\"&&typeof e[0]!=\"object\"&&e!=null){e=Ii(e)?e:zd(e);for(var a=0,u=e.length;a<u;a++)o=e[a],o!=null&&o>r&&(r=o)}else t=Pa(t,n),wp(e,function(c,p,l){i=t(c,p,l),(i>s||i===-1/0&&r===-1/0)&&(r=c,s=i)});return r}function q4(e,t,n){var r=1/0,s=1/0,o,i;if(t==null||typeof t==\"number\"&&typeof e[0]!=\"object\"&&e!=null){e=Ii(e)?e:zd(e);for(var a=0,u=e.length;a<u;a++)o=e[a],o!=null&&o<r&&(r=o)}else t=Pa(t,n),wp(e,function(c,p,l){i=t(c,p,l),(i<s||i===1/0&&r===1/0)&&(r=c,s=i)});return r}function U4(e){return CG(e,1/0)}function CG(e,t,n){if(t==null||n)return Ii(e)||(e=zd(e)),e[BN(e.length-1)];var r=Ii(e)?HG(e):zd(e),s=bc(r);t=Math.max(Math.min(t,s),0);for(var o=s-1,i=0;i<t;i++){var a=BN(i,o),u=r[i];r[i]=r[a],r[a]=u}return r.slice(0,t)}function fI(e,t,n){var r=0;return t=Pa(t,n),ZN(Sg(e,function(s,o,i){return{value:s,index:r++,criteria:t(s,o,i)}}).sort(function(s,o){var i=s.criteria,a=o.criteria;if(i!==a){if(i>a||i===void 0)return 1;if(i<a||a===void 0)return-1}return s.index-o.index}),\"value\")}function Mg(e,t){return function(n,r,s){var o=t?[[],[]]:{};return r=Pa(r,s),wp(n,function(i,a){var u=r(i,a,n);e(o,i,u)}),o}}var z4=Mg(function(e,t,n){_p(e,n)?e[n].push(t):e[n]=[t]}),k4=Mg(function(e,t,n){e[n]=t}),$4=Mg(function(e,t,n){_p(e,n)?e[n]++:e[n]=1});function Y4(e){return e==null?0:Ii(e)?e.length:Yo(e).length}var Z4=Mg(function(e,t,n){e[n?0:1].push(t)},!0);function vl(e,t,n,r){r=r||[];for(var s=r.length,o=0,i=bc(e);o<i;o++){var a=e[o];if(Ii(a)&&(Lp(a)||Ig(a)))if(t)for(var u=0,c=a.length;u<c;)r[s++]=a[u++];else vl(a,t,n,r),s=r.length;else n||(r[s++]=a)}return r}function X4(e,t){return vl(e,t,!1)}var W4=Ti(function(e,t){return gI(e,t)});function yI(e,t,n,r){XG(t)||(r=n,n=t,t=!1),n!=null&&(n=Pa(n,r));for(var s=[],o=[],i=0,a=bc(e);i<a;i++){var u=e[i],c=n?n(u,i,e):u;t&&!n?((!i||o!==c)&&s.push(u),o=c):n?Ap(o,c)||(o.push(c),s.push(u)):Ap(s,u)||s.push(u)}return s}var j4=Ti(function(e){return yI(vl(e,!0,!0))});var gI=Ti(function(e,t){return t=vl(t,!0,!0),SG(e,function(n){return!Ap(t,n)})});function vG(e){for(var t=e&&MG(e,bc).length||0,n=Array(t),r=0;r<t;r++)n[r]=ZN(e,r);return n}var J4=Ti(vG);function XN(e){return function(t,n,r){n=Pa(n,r);for(var s=bc(t),o=e>0?0:s-1;o>=0&&o<s;o+=e)if(n(t[o],o,t))return o;return-1}}var DG=XN(1),NG=XN(-1);function RG(e,t,n,r){n=Pa(n,r,1);for(var s=n(t),o=0,i=bc(e);o<i;){var a=Math.floor((o+i)/2);n(e[a])<s?o=a+1:i=a}return o}function WN(e,t,n){return function(r,s,o){var i=0,a=bc(r);if(typeof o==\"number\")e>0?i=o>=0?o:Math.max(o+a,i):a=o>=0?Math.min(o+1,a):o+a+1;else if(n&&o&&a)return o=n(r,s),r[o]===s?o:-1;if(s!==s)return o=t(HN.call(r,i,a),ZG),o>=0?o+i:-1;for(o=e>0?i:a-1;o>=0&&o<a;o+=e)if(r[o]===s)return o;return-1}}var OG=WN(1,DG,RG),Q4=WN(-1,NG);function K4(e,t){if(t==null||t<1)return[];for(var n=[],r=0,s=e.length;r<s;)n.push(HN.call(e,r,r+=t));return n}function jN(e,t,n,r,s){if(!(r instanceof t))return e.apply(n,s);var o=PG(e.prototype),i=e.apply(o,s);return Fp(i)?i:o}var AG=Ti(function(e,t,n){if(!Xu(e))throw new TypeError(\"Bind must be called on a function\");var r=Ti(function(s){return jN(e,r,t,this,n.concat(s))});return r}),Cg=Ti(function(e,t){var n=Cg.placeholder,r=function(){for(var s=0,o=t.length,i=Array(o),a=0;a<o;a++)i[a]=t[a]===n?arguments[s++]:t[a];for(;s<arguments.length;)i.push(arguments[s++]);return jN(e,r,this,this,i)};return r});Cg.placeholder=$r;var e6=Ti(function(e,t){t=vl(t,!1,!1);var n=t.length;if(n<1)throw new Error(\"bindAll must be passed function names\");for(;n--;){var r=t[n];e[r]=AG(e[r],e)}});var JN=Ti(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),t6=Cg(JN,$r,1);function n6(e,t,n){var r,s,o,i,a=0;n||(n={});var u=function(){a=n.leading===!1?0:GN(),r=null,i=e.apply(s,o),r||(s=o=null)},c=function(){var p=GN();!a&&n.leading===!1&&(a=p);var l=t-(p-a);return s=this,o=arguments,l<=0||l>t?(r&&(clearTimeout(r),r=null),a=p,i=e.apply(s,o),r||(s=o=null)):!r&&n.trailing!==!1&&(r=setTimeout(u,l)),i};return c.cancel=function(){clearTimeout(r),a=0,r=s=o=null},c}function r6(e,t,n){var r,s,o=function(a,u){r=null,u&&(s=e.apply(a,u))},i=Ti(function(a){if(r&&clearTimeout(r),n){var u=!r;r=setTimeout(o,t),u&&(s=e.apply(this,a))}else r=JN(o,t,this,a);return s});return i.cancel=function(){clearTimeout(r),r=null},i}function _G(e){return function(){return!e.apply(this,arguments)}}function wG(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}var s6=Cg(wG,2),QN=!{toString:null}.propertyIsEnumerable(\"toString\"),VN=[\"valueOf\",\"isPrototypeOf\",\"toString\",\"propertyIsEnumerable\",\"hasOwnProperty\",\"toLocaleString\"];function KN(e,t){var n=VN.length,r=e.constructor,s=Xu(r)&&r.prototype||dI,o=\"constructor\";for(_p(e,o)&&!Ap(t,o)&&t.push(o);n--;)o=VN[n],o in e&&e[o]!==s[o]&&!Ap(t,o)&&t.push(o)}function Yo(e){if(!Fp(e))return[];if(LN)return LN(e);var t=[];for(var n in e)_p(e,n)&&t.push(n);return QN&&KN(e,t),t}function hI(e){if(!Fp(e))return[];var t=[];for(var n in e)t.push(n);return QN&&KN(e,t),t}function zd(e){for(var t=Yo(e),n=t.length,r=Array(n),s=0;s<n;s++)r[s]=e[t[s]];return r}function LG(e){for(var t={},n=Yo(e),r=0,s=n.length;r<s;r++)t[e[n[r]]]=n[r];return t}function bI(e,t){return function(n){var r=arguments.length;if(t&&(n=Object(n)),r<2||n==null)return n;for(var s=1;s<r;s++)for(var o=arguments[s],i=e(o),a=i.length,u=0;u<a;u++){var c=i[u];(!t||n[c]===void 0)&&(n[c]=o[c])}return n}}var FG=bI(hI),VG=bI(Yo);function BG(e,t,n){return t in n}var GG=Ti(function(e,t){var n={},r=t[0];if(e==null)return n;Xu(r)?(t.length>1&&(r=Eg(r,t[1])),t=hI(e)):(r=BG,t=vl(t,!1,!1),e=Object(e));for(var s=0,o=t.length;s<o;s++){var i=t[s],a=e[i];r(a,i,e)&&(n[i]=a)}return n}),o6=Ti(function(e,t){var n=t[0],r;return Xu(n)?(n=_G(n),t.length>1&&(r=t[1])):(t=Sg(vl(t,!1,!1),String),n=function(s,o){return!Ap(t,o)}),GG(e,n,r)}),i6=bI(hI,!0);function HG(e){return Fp(e)?Lp(e)?e.slice():FG({},e):e}function qG(e,t){var n=Yo(t),r=n.length;if(e==null)return!r;for(var s=Object(e),o=0;o<r;o++){var i=n[o];if(t[i]!==s[i]||!(i in s))return!1}return!0}function mI(e,t,n,r){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var s=typeof e;return s!==\"function\"&&s!==\"object\"&&typeof t!=\"object\"?!1:UG(e,t,n,r)}function UG(e,t,n,r){e instanceof $r&&(e=e._wrapped),t instanceof $r&&(t=t._wrapped);var s=Tg.call(e);if(s!==Tg.call(t))return!1;switch(s){case\"[object RegExp]\":case\"[object String]\":return\"\"+e==\"\"+t;case\"[object Number]\":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case\"[object Date]\":case\"[object Boolean]\":return+e==+t;case\"[object Symbol]\":return wN.valueOf.call(e)===wN.valueOf.call(t)}var o=s===\"[object Array]\";if(!o){if(typeof e!=\"object\"||typeof t!=\"object\")return!1;var i=e.constructor,a=t.constructor;if(i!==a&&!(Xu(i)&&i instanceof i&&Xu(a)&&a instanceof a)&&\"constructor\"in e&&\"constructor\"in t)return!1}n=n||[],r=r||[];for(var u=n.length;u--;)if(n[u]===e)return r[u]===t;if(n.push(e),r.push(t),o){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!mI(e[u],t[u],n,r))return!1}else{var c=Yo(e),p;if(u=c.length,Yo(t).length!==u)return!1;for(;u--;)if(p=c[u],!(_p(t,p)&&mI(e[p],t[p],n,r)))return!1}return n.pop(),r.pop(),!0}function _s(e,t){return mI(e,t)}function a6(e){return e==null?!0:Ii(e)&&(Lp(e)||zG(e)||Ig(e))?e.length===0:Yo(e).length===0}function Pi(e){return function(t){return Tg.call(t)===\"[object \"+e+\"]\"}}var Lp=TG||Pi(\"Array\");function Fp(e){var t=typeof e;return t===\"function\"||t===\"object\"&&!!e}var Ig=Pi(\"Arguments\"),Xu=Pi(\"Function\"),zG=Pi(\"String\"),kG=Pi(\"Number\"),u6=Pi(\"Date\"),c6=Pi(\"RegExp\"),l6=Pi(\"Error\"),$G=Pi(\"Symbol\"),p6=Pi(\"Map\"),m6=Pi(\"WeakMap\"),d6=Pi(\"Set\"),f6=Pi(\"WeakSet\");(function(){Ig(arguments)||(Ig=function(e){return _p(e,\"callee\")})})();var YG=xg.document&&xg.document.childNodes;typeof/./!=\"function\"&&typeof Int8Array!=\"object\"&&typeof YG!=\"function\"&&(Xu=function(e){return typeof e==\"function\"||!1});function y6(e){return!$G(e)&&IG(e)&&!qN(parseFloat(e))}function ZG(e){return kG(e)&&qN(e)}function XG(e){return e===!0||e===!1||Tg.call(e)===\"[object Boolean]\"}function WG(e){return e}function eR(e){return Lp(e)?function(t){return $N(t,e)}:kN(e)}function jG(e){return e=VG({},e),function(t){return qG(t,e)}}function BN(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}var GN=Date.now||function(){return new Date().getTime()},tR={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\",\"`\":\"&#x60;\"},JG=LG(tR);function nR(e){var t=function(o){return e[o]},n=\"(?:\"+Yo(e).join(\"|\")+\")\",r=RegExp(n),s=RegExp(n,\"g\");return function(o){return o=o==null?\"\":\"\"+o,r.test(o)?o.replace(s,t):o}}var rR=nR(tR),g6=nR(JG);var QG=0;function h6(e){var t=++QG+\"\";return e?e+t:t}var b6=$r.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g,escape:/<%-([\\s\\S]+?)%>/g};function sR(e,t){return e._chain?$r(t).chain():t}wp([\"pop\",\"push\",\"reverse\",\"shift\",\"sort\",\"splice\",\"unshift\"],function(e){var t=Pg[e];$r.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e===\"shift\"||e===\"splice\")&&n.length===0&&delete n[0],sR(this,n)}});wp([\"concat\",\"join\",\"slice\"],function(e){var t=Pg[e];$r.prototype[e]=function(){return sR(this,t.apply(this._wrapped,arguments))}});$r.prototype.value=function(){return this._wrapped};$r.prototype.valueOf=$r.prototype.toJSON=$r.prototype.value;$r.prototype.toString=function(){return String(this._wrapped)};var Ps={};Ka(Ps,{LruCache:()=>rm,RECURSIVE_COMPUTATION_LIMIT:()=>E1,RECURSIVE_DEPTH_LIMIT:()=>Hf,RecursiveFunctionResult:()=>P1,SYMBOL_DIVERGES:()=>I1,TerminationStatus:()=>S1,_chisqccdf:()=>b0,_chisqcdf:()=>h0,_complexGCD:()=>iM,_poissonpdf:()=>Dc,acosh:()=>b1,acot:()=>xH,acoth:()=>vH,acsc:()=>TH,acsch:()=>CH,addTangentAngle:()=>mU,addTangentArc:()=>pU,addTangentCircle:()=>lU,addTangentLine:()=>aU,addTangentPolygon:()=>oU,addTangentRay:()=>uU,addTangentSegment:()=>tb,addTangentSegmentThreeD:()=>iU,addTangentTransformation:()=>dU,addTangentVector:()=>cU,angleMarkerMultiplier:()=>Xq,angleMarkerRawDelta:()=>Zq,angleStart:()=>zq,angleVertex:()=>Uq,anglebisector:()=>DU,arc:()=>Bq,arcArcIntersection:()=>PU,arcCenter:()=>cm,arcCircleIntersection:()=>IU,arcFirstPoint:()=>Gq,arcGlider:()=>oO,arcLineIntersection:()=>uO,arcMiddlePoint:()=>Hq,arcOmega:()=>lm,arcThirdPoint:()=>qq,arg:()=>oz,argMax:()=>aq,argMin:()=>iq,asec:()=>IH,asech:()=>MH,asinh:()=>x1,atanh:()=>T1,basePointFromVector:()=>Rq,basePointFromVectorThreeD:()=>_q,bernoulliTable:()=>D1,binomSample:()=>HH,binomcdf:()=>zH,binompdf:()=>Xh,center:()=>Fq,chisqIndependenceTestInternal:()=>Oz,chisqcdf:()=>ZH,chisqpdf:()=>V0,chooseNonIncidentPoint:()=>bU,circle:()=>Lq,circleArcIntersection:()=>TU,circleCircleIntersection:()=>Bf,circleGlider:()=>yU,circleLineIntersection:()=>J0,clamp:()=>tr,coerceComplexToReal:()=>sM,coerceComplexToRealWithTolerance:()=>Pz,coerceRealToComplex:()=>Mz,common_log:()=>fH,compareComplexLexicographic:()=>Z1,complex:()=>Zt,complexAcos:()=>TO,complexAcosh:()=>PO,complexAcot:()=>bz,complexAcoth:()=>Iz,complexAcsc:()=>hz,complexAcsch:()=>Tz,complexAsec:()=>gz,complexAsech:()=>xz,complexAsin:()=>rM,complexAsinh:()=>IO,complexAtan:()=>E0,complexAtanh:()=>Uh,complexCeil:()=>vz,complexCommonLog:()=>yH,complexCos:()=>gO,complexCosh:()=>xO,complexCot:()=>mz,complexCoth:()=>yz,complexCsc:()=>pz,complexCsch:()=>fz,complexDivide:()=>Rc,complexExp:()=>az,complexFloor:()=>EO,complexFromPolarRounded:()=>Cc,complexGCD:()=>M0,complexLCM:()=>C0,complexListGCD:()=>cH,complexListLCM:()=>lH,complexLog:()=>P0,complexLogbase:()=>O1,complexMod:()=>Dz,complexMultiplyPoints:()=>pO,complexPow:()=>cz,complexPowReal:()=>fO,complexReciprocal:()=>Gs,complexRound:()=>nm,complexSec:()=>lz,complexSech:()=>dz,complexSin:()=>yO,complexSinh:()=>bO,complexSortPerm:()=>tq,complexSqrt:()=>dO,complexTan:()=>hO,complexTanh:()=>nM,composeTransformation:()=>GU,conj:()=>Xl,corr:()=>eb,cos:()=>Fn,cosh:()=>am,cot:()=>bH,cotDerivative:()=>N1,coth:()=>SH,cov:()=>cq,covp:()=>J1,csc:()=>hH,csch:()=>EH,dilation:()=>FU,directedAngleMarker:()=>rO,directedAngleStart:()=>$q,directedAngleVertex:()=>kq,directedCoterminalAngle:()=>sO,distance:()=>om,distanceThreeD:()=>dq,elementsAt:()=>jU,erf:()=>JH,erfcx:()=>xu,executeRecursiveFunction:()=>sH,expm1:()=>J2,factorial:()=>Ju,frequency:()=>KU,gcd:()=>Ah,getArcDetails:()=>nb,getBroadcastTargetElements:()=>tH,getRecursiveDepthLimit:()=>eH,gosperr:()=>yo,handleRecursionLimitExceeded:()=>C1,hsv:()=>fq,hypot:()=>Bs,identity:()=>wq,imag:()=>sz,invBinom:()=>U1,invChisq:()=>XH,invNorm:()=>jh,invPoisson:()=>q1,invT:()=>z1,invUniform:()=>KH,invertTransformation:()=>HU,isDegenerateArc:()=>Y0,itscore:()=>$1,ittest:()=>H0,lcm:()=>g0,line:()=>Cq,lineArcIntersection:()=>aO,lineCircleIntersection:()=>j0,lineGlider:()=>X0,lineLineIntersection:()=>iO,listGCD:()=>aH,listLCM:()=>uH,listLength:()=>eq,listMax:()=>Qh,listMin:()=>Jh,log:()=>dH,log1p:()=>um,log_base:()=>wh,losesInfoWhenCoercingToReal:()=>oM,lowerQuantileIndex:()=>rq,lowerQuartileIndex:()=>oq,mad:()=>uq,mathVector:()=>eO,mathVectorThreeD:()=>tO,md5Spyable:()=>h1,mean:()=>bu,median:()=>W1,mod:()=>zl,nCr:()=>Mc,nPr:()=>_h,normalSample:()=>BH,normalcdf:()=>G1,normalpdf:()=>Zh,parallel:()=>CU,peelableCoerceComplexToReal:()=>Ez,peelableCoerceComplexToRealWithTolerance:()=>Sz,perpendicular:()=>vU,pointDet:()=>mO,pointDot:()=>NU,pointPerp:()=>RU,poissonSample:()=>qH,poissoncdf:()=>$H,poissonpdf:()=>Wh,polyGamma:()=>R1,polygon:()=>yq,polygonArea:()=>k0,polygonEdgeByParameter:()=>gU,polygonEdges:()=>Tq,polygonGlider:()=>hU,polygonInteriorDirectedAngles:()=>Mq,polygonInteriorUndirectedAngles:()=>Sq,polygonPerimeter:()=>Iq,pow:()=>K2,quad:()=>mq,quantile:()=>Y1,quartile:()=>Zl,quartileIndex:()=>Kh,radius:()=>Vq,random:()=>L0,randomPerm:()=>F0,rank:()=>T0,rawTransform:()=>OU,rawTransformConj:()=>AU,ray:()=>vq,rayGlider:()=>I0,real:()=>rz,recursionCacheKey:()=>y0,recursionDiverges:()=>M1,recursionMissingCacheEntry:()=>rH,recursionSuccess:()=>nH,reflection:()=>BU,restriction:()=>tz,restrictionToBoolean:()=>nz,rgb:()=>Q1,rotation:()=>VU,scaleTangentAngle:()=>sU,scaleTangentArc:()=>rU,scaleTangentCircle:()=>nU,scaleTangentLine:()=>eU,scaleTangentPolygon:()=>Kq,scaleTangentRay:()=>tU,scaleTangentSegment:()=>Z0,scaleTangentTransformation:()=>Qq,sec:()=>gH,sech:()=>PH,segment:()=>$0,segmentGlider:()=>W0,segmentThreeD:()=>gq,segmentThreeDGlider:()=>fU,select:()=>WU,serializeNonNumericSeedPart:()=>w0,shuffle:()=>VH,sign:()=>D0,sin:()=>Cn,sinh:()=>jl,sortPerm:()=>Jl,spearman:()=>lq,sphere:()=>bq,sqrtxsqm1:()=>iH,sqrtxsqp1:()=>oH,stats:()=>q0,stdev:()=>Fh,stdevp:()=>pq,supplementAngle:()=>jq,tSample:()=>GH,tan:()=>R0,tanh:()=>v0,tcdf:()=>Rh,testingOnlySetRecursiveDepthLimit:()=>N0,toFraction:()=>Q2,tone:()=>QU,total:()=>NH,tpdf:()=>Yh,transformAngleMarker:()=>XU,transformArc:()=>YU,transformCircle:()=>$U,transformLine:()=>UU,transformPoint:()=>Zi,transformPolygon:()=>ZU,transformRay:()=>zU,transformScaleFactor:()=>wU,transformSegment:()=>tM,transformVector:()=>kU,transformWithoutTranslation:()=>_U,translation:()=>LU,triangle:()=>hq,tscore:()=>k1,ttest:()=>G0,undirectedAngleMarker:()=>Yq,undirectedCoterminalAngle:()=>Wq,uniformSample:()=>vc,uniformcdf:()=>jH,uniformpdf:()=>B0,uniquePerm:()=>JU,upperQuantileIndex:()=>nq,upperQuartileIndex:()=>sq,validateRangeLength:()=>U0,validateSampleCount:()=>z0,variance:()=>j1,varp:()=>qf,vector:()=>Dq,vectorDisplacementAsPoint:()=>Nq,vectorThreeD:()=>Oq,vectorThreeDDisplacementAsPoint:()=>Aq,vertices:()=>xq,volume:()=>ez,wirtingerEqualOrWarning:()=>Cz});var oR=function(){\"use strict\";function e(g,f){let h=(g&65535)+(f&65535);return(g>>16)+(f>>16)+(h>>16)<<16|h&65535}function t(g,f){return g<<f|g>>>32-f}function n(g,f,h,x,T,P){return e(t(e(e(f,g),e(x,P)),T),h)}function r(g,f,h,x,T,P,M){return n(f&h|~f&x,g,f,T,P,M)}function s(g,f,h,x,T,P,M){return n(f&x|h&~x,g,f,T,P,M)}function o(g,f,h,x,T,P,M){return n(f^h^x,g,f,T,P,M)}function i(g,f,h,x,T,P,M){return n(h^(f|~x),g,f,T,P,M)}function a(g,f){g[f>>5]|=128<<f%32,g[(f+64>>>9<<4)+14]=f;let h,x,T,P,M,S=1732584193,E=-271733879,v=-1732584194,D=271733878;for(h=0;h<g.length;h+=16)x=S,T=E,P=v,M=D,S=r(S,E,v,D,g[h],7,-680876936),D=r(D,S,E,v,g[h+1],12,-389564586),v=r(v,D,S,E,g[h+2],17,606105819),E=r(E,v,D,S,g[h+3],22,-1044525330),S=r(S,E,v,D,g[h+4],7,-176418897),D=r(D,S,E,v,g[h+5],12,1200080426),v=r(v,D,S,E,g[h+6],17,-1473231341),E=r(E,v,D,S,g[h+7],22,-45705983),S=r(S,E,v,D,g[h+8],7,1770035416),D=r(D,S,E,v,g[h+9],12,-1958414417),v=r(v,D,S,E,g[h+10],17,-42063),E=r(E,v,D,S,g[h+11],22,-1990404162),S=r(S,E,v,D,g[h+12],7,1804603682),D=r(D,S,E,v,g[h+13],12,-40341101),v=r(v,D,S,E,g[h+14],17,-1502002290),E=r(E,v,D,S,g[h+15],22,1236535329),S=s(S,E,v,D,g[h+1],5,-165796510),D=s(D,S,E,v,g[h+6],9,-1069501632),v=s(v,D,S,E,g[h+11],14,643717713),E=s(E,v,D,S,g[h],20,-373897302),S=s(S,E,v,D,g[h+5],5,-701558691),D=s(D,S,E,v,g[h+10],9,38016083),v=s(v,D,S,E,g[h+15],14,-660478335),E=s(E,v,D,S,g[h+4],20,-405537848),S=s(S,E,v,D,g[h+9],5,568446438),D=s(D,S,E,v,g[h+14],9,-1019803690),v=s(v,D,S,E,g[h+3],14,-187363961),E=s(E,v,D,S,g[h+8],20,1163531501),S=s(S,E,v,D,g[h+13],5,-1444681467),D=s(D,S,E,v,g[h+2],9,-51403784),v=s(v,D,S,E,g[h+7],14,1735328473),E=s(E,v,D,S,g[h+12],20,-1926607734),S=o(S,E,v,D,g[h+5],4,-378558),D=o(D,S,E,v,g[h+8],11,-2022574463),v=o(v,D,S,E,g[h+11],16,1839030562),E=o(E,v,D,S,g[h+14],23,-35309556),S=o(S,E,v,D,g[h+1],4,-1530992060),D=o(D,S,E,v,g[h+4],11,1272893353),v=o(v,D,S,E,g[h+7],16,-155497632),E=o(E,v,D,S,g[h+10],23,-1094730640),S=o(S,E,v,D,g[h+13],4,681279174),D=o(D,S,E,v,g[h],11,-358537222),v=o(v,D,S,E,g[h+3],16,-722521979),E=o(E,v,D,S,g[h+6],23,76029189),S=o(S,E,v,D,g[h+9],4,-640364487),D=o(D,S,E,v,g[h+12],11,-421815835),v=o(v,D,S,E,g[h+15],16,530742520),E=o(E,v,D,S,g[h+2],23,-995338651),S=i(S,E,v,D,g[h],6,-198630844),D=i(D,S,E,v,g[h+7],10,1126891415),v=i(v,D,S,E,g[h+14],15,-1416354905),E=i(E,v,D,S,g[h+5],21,-57434055),S=i(S,E,v,D,g[h+12],6,1700485571),D=i(D,S,E,v,g[h+3],10,-1894986606),v=i(v,D,S,E,g[h+10],15,-1051523),E=i(E,v,D,S,g[h+1],21,-2054922799),S=i(S,E,v,D,g[h+8],6,1873313359),D=i(D,S,E,v,g[h+15],10,-30611744),v=i(v,D,S,E,g[h+6],15,-1560198380),E=i(E,v,D,S,g[h+13],21,1309151649),S=i(S,E,v,D,g[h+4],6,-145523070),D=i(D,S,E,v,g[h+11],10,-1120210379),v=i(v,D,S,E,g[h+2],15,718787259),E=i(E,v,D,S,g[h+9],21,-343485551),S=e(S,x),E=e(E,T),v=e(v,P),D=e(D,M);return[S,E,v,D]}function u(g){let f,h=\"\",x=g.length*32;for(f=0;f<x;f+=8)h+=String.fromCharCode(g[f>>5]>>>f%32&255);return h}function c(g){let f,h=[];for(h[(g.length>>2)-1]=void 0,f=0;f<h.length;f+=1)h[f]=0;let x=g.length*8;for(f=0;f<x;f+=8)h[f>>5]|=(g.charCodeAt(f/8)&255)<<f%32;return h}function p(g){return u(a(c(g),g.length*8))}function l(g){let f=\"0123456789abcdef\",h=\"\",x,T;for(T=0;T<g.length;T+=1)x=g.charCodeAt(T),h+=f.charAt(x>>>4&15)+f.charAt(x&15);return h}function m(g){return unescape(encodeURIComponent(g))}function d(g){return p(m(g))}function y(g){return l(d(g))}return y}();function Ei(e,t,n){return e>0==t>0?n===1?t:e+n*(t-e):e*(1-n)+t*n}function br(e,t,n){return[Ei(e[0],t[0],n),Ei(e[1],t[1],n)]}function Si(e,t,n){return[Ei(e[0],t[0],n),Ei(e[1],t[1],n),Ei(e[2],t[2],n)]}function kd(e,t){return[e[0]+t[0],e[1]+t[1]]}function iR(e,t){return[e[0]-t[0],e[1]-t[1]]}function xI(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]}function TI(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Wu(e,t){return Bp(xI(e,t))}function vg(e,t,n){return[Ei(e[0],t[0],n[0]),Ei(e[1],t[1],n[1])]}function aR(e,t){return[e[0]*t,e[1]*t]}function Bp(e){let[t,n,r]=e;return t*t+n*n+r*r}function Gp(e,t){let n=e[1]*t[2]-e[2]*t[1],r=e[2]*t[0]-e[0]*t[2],s=e[0]*t[1]-e[1]*t[0],o=Math.sqrt(n*n+r*r+s*s);return[n/o,r/o,s/o]}function Hp(e,t,n){e=Math.fround(e),t=Math.fround(t),n=Math.fround(n);let r=Math.fround(e*e+t*t+n*n);return isFinite(r)&&r!=0}function du([e,t,n]){return isFinite(e)&&isFinite(t)&&isFinite(n)}function Zo(e,t){let n;e>t&&(n=e,e=t,t=n);let r=e>0,s=t>0,o=Math.abs(e)>.01,i=Math.abs(t)>.01;if(o||i)return zu(e,t);if(e===0)return t*Math.abs(t);if(t===0)return e*Math.abs(e);if(r!==s)return 0;let a=r?Math.sqrt(e*t):-Math.sqrt(e*t);return a>=e&&t>=a?a:zu(e,t)}function MI(e,t,n,r,s){if(!(isNaN(t)||isNaN(r)||t<0==r<0))for(;;){let o=Zo(e,n),i=s(o);if(!isFinite(i))return;if(o===e||o===n)return Math.abs(t)<=Math.abs(r)?[e,t]:[n,r];if(i===0)return Yd(e,t,o,i,n,r,s);t<0!=i<0?(n=o,r=i):(e=o,t=i)}}function hR(e,t,n,r,s){if(!(II(t)||II(r))&&PI(t,r))for(;;){let o=Zo(e,n),i=s(o);if(II(i))return;if(o===e||o===n)return o;if(PI(t,i))n=o,r=i;else if(PI(i,r))e=o,t=i;else return}}function II(e){for(let t of e)if(isNaN(t))return!0;return!1}function PI(e,t){for(let n=0;n<e.length;n++)if(!KG(e[n],t[n]))return!1;return!0}function KG(e,t){return e<=0&&t>=0||e>=0&&t<=0}function Yd(e,t,n,r,s,o,i){let a;if(!isFinite(r))return;isFinite(t)||(a=ws(e,t,n,r,i),a!==void 0&&(e=a,t=i(e))),isFinite(o)||(a=ws(n,r,s,o,i),a!==void 0&&(s=a,o=i(a)));let u,c;t===r?u=[e,t]:u=uR(e,t,n,r,i,r),o===r?c=[s,o]:c=uR(n,r,s,o,i,r);let p;return u&&c&&(p=Zo(u[0],c[0])),p!==void 0?[p,i(p)]:void 0}function ws(e,t,n,r,s){if(isFinite(t)!==isFinite(r))for(;;){let o=Zo(e,n),i=s(o);if(o===e||o===n)return isFinite(t)?e:n;isFinite(i)!==isFinite(t)?(n=o,r=i):(e=o,t=i)}}function Dg(e,t,n,r,s){if(du(t)!==du(r))for(;;){let o=Zo(e,n),i=s(o);if(o===e||o===n)return du(t)?e:n;du(i)!==du(t)?(n=o,r=i):(e=o,t=i)}}function uR(e,t,n,r,s,o){if(t===o!=(r===o))for(;;){let i=Zo(e,n),a=s(i);if(i===e||i===n)return t===o?[e,t]:[n,r];a===o!=(t===o)?(n=i,r=a):(e=i,t=a)}}function bR(e,t,n,r,s,o,i){if(e<n&&n<s&&isFinite(t)&&isFinite(r)&&isFinite(o)&&t!==r&&r!==o&&r>t==r>o)for(;;){let a=Zo(e,n),u=i(a),c=Zo(n,s),p=i(c);if(!isFinite(u)||!isFinite(p))return;if(a===e||a===n||c===n||c===s)return u>r==r>t?[a,u]:p>r==r>t?[c,p]:[n,r];if(u===r||p===r)return Yd(e,t,n,r,s,o,i);r>t&&u>t&&u>r||r<t&&u<t&&u<r?(s=n,o=r,n=a,r=u):r>t&&p>r&&p>o||r<t&&p<r&&p<o?(e=n,t=r,n=c,r=p):(e=a,t=u,s=c,o=p)}}function Mi([e,t],[n,r]){return(n-e)*(n-e)+(r-t)*(r-t)}function cR(e,t,n,r,s,o){let i=o(e),a=o(t),u=o(n),c=Mi(i,r),p=Mi(a,r),l=Mi(u,r);if(!(t<=e||n<=t)&&!(!isFinite(c)||!isFinite(p)||!isFinite(l))&&!(p>=c||p>=l))for(;;){if(Math.abs(u[0]-i[0])<s&&Math.abs(u[1]-i[1])<s)return[e,n];let m=Zo(e,t),d=o(m),y=Mi(d,r),g=Zo(t,n),f=o(g),h=Mi(f,r);if(!isFinite(y)||!isFinite(h))return;if(m===e||m===t||g===t||g===n)return y<p&&y<h?[m,m]:h<y&&h<p?[g,g]:[t,t];if((y===p||h===p)&&(t=.5*(m+t),a=o(t),p=Mi(a,r),y===p||h===p))return[e,n];y<p&&y<h?([n,t]=[t,m],[u,a]=[a,d],[l,p]=[p,y]):h<y&&h<p?([e,t]=[t,g],[i,a]=[a,f],[c,p]=[p,h]):([e,n]=[m,g],[i,u]=[d,f],[c,l]=[y,h])}}function lR(e,t,n){return t===void 0&&(t=-1/0),n===void 0&&(n=1/0),Math.min(n,Math.max(t,e))}function EI(e,t,n,r,s,o){let i;if(r!==void 0&&s!==void 0){let l=.5*(r+s);i=n+.01*(n<l?s-r:r-s)}else i=Math.abs(n)>1?n*1.00001:n+1e-5;let a=e(n),u=e(i),c=Mi(a,t),p=Mi(u,t);if(!(!isFinite(c)||!isFinite(p))){if(c===p)return[n,i];for(p>c&&([n,i]=[i,n],[a,u]=[u,a],[c,p]=[p,c]);isFinite(n)&&isFinite(i)&&n!==i;){if(s!==void 0&&i>s)return[s,s];if(r!==void 0&&i<r)return[r,r];let l=n+3*(i-n),m=e(l),d=Mi(m,t);if(!isFinite(d))return[n,i];if(d===p)return[n,i];if(d>p){let y=i>n?cR(n,i,l,t,o,e):cR(l,i,n,t,o,e);return y&&[lR(y[0],r,s),lR(y[1],r,s)]}[n,c,i,p]=[i,p,l,d]}return[n,i]}}function pR(e,t,n,r){return n?r?Math.min(Mi(e(r[0]),t),Mi(e(r[1]),t))<Math.min(Mi(e(n[0]),t),Mi(e(n[1]),t)):!1:!0}function P6(e,t,n,r,s,o){let i=EI(e,t,n,r,s,o);if(r!==void 0){let a=EI(e,t,r,r,s,o);pR(e,t,i,a)&&(i=a)}if(s!==void 0){let a=EI(e,t,s,r,s,o);pR(e,t,i,a)&&(i=a)}return i}function mR(e,t,n,r,s,o,i,a){let u=Math.abs(r-t),c=Math.abs(o-r),p=Math.abs(a-o);return u>c&&u>p?[e,n]:p>c&&p>u?[s,i]:[n,s]}function qp(e,t,n,r,s,o,i,a=0){if(!((n-e)*(s-n)<=0)&&!(!isFinite(e)||!isFinite(n)||!isFinite(s))&&!(!isFinite(t)||!isFinite(o))){if(!isFinite(r)){let u=ws(e,t,n,r,i),c=ws(n,r,s,o,i);return u===void 0||c===void 0?void 0:[u,c]}if(!(Math.abs(r-((s-n)*t+(n-e)*o)/(s-e))<a))for(;;){let u=Zo(e,n),c=i(u),p=Zo(n,s),l=i(p),m=Math.abs(c-zu(t,r)),d=Math.abs(r-zu(c,l)),y=Math.abs(l-zu(r,o));if(m<=a&&d<=a&&y<=a)return;if(!isFinite(c)){let g=ws(e,t,u,c,i),f=ws(u,c,s,o,i);return g===void 0||f===void 0?void 0:[g,f]}if(!isFinite(l)){let g=ws(e,t,p,l,i),f=ws(p,l,s,o,i);return g===void 0||f===void 0?void 0:[g,f]}if((u===e||u===n)&&(p===n||p===s))return Math.abs(r-t)>Math.abs(o-r)?[e,n]:[n,s];if(u===e||u===n)return mR(e,t,n,r,p,l,s,o);if(p===n||p===s)return mR(e,t,u,c,n,r,s,o);m>y&&m>=d?(s=n,o=r,n=u,r=c):y>m&&y>=d?(e=n,t=r,n=p,r=l):(e=u,t=c,s=p,o=l)}}}var ju=(Math.sqrt(5)-1)/2;function $d(e,t){return e>0==t>0?e+ju*(t-e):(1-ju)*e+ju*t}function xc(e,t){let n;e>t&&(n=e,e=t,t=n);let r=e>0,s=t>0,o=Math.abs(e)>.01,i=Math.abs(t)>.01;if(o||i)return $d(e,t);if(e===0)return t*Math.abs(t);if(t===0)return e*Math.abs(e);if(r!==s)return 0;let a=r?Math.sqrt(e*t):-Math.sqrt(e*t);return a>=e&&t>=a?a:$d(e,t)}function xR(e,t,n,r,s,o){if(!isFinite(e)||!isFinite(n)||!isFinite(t)||!isFinite(r))return;e>n&&([e,t,n,r]=[n,r,e,t]);let i=xc(e,n),a=s(i);if(Math.abs(a-$d(t,r))<=o)return;let u=xc(e,i),c=s(u);for(;;){let p=Math.abs(c-$d(t,a)),l=Math.abs(a-$d(r,c));if(p<=o&&l<=o)return;if(p>l){if(n=i,r=a,i=u,a=c,u=xc(e,i),c=s(u),u===e||u===i)return fR(e,t,i,a,n,r);if(!isFinite(c))return dR(e,t,u,c,n,r,s)}else{if(e=u,t=c,u=i,c=a,i=xc(n,i),a=s(i),i===n||i===u)return fR(e,t,u,c,n,r);if(!isFinite(a))return dR(e,t,i,a,n,r,s)}}}function dR(e,t,n,r,s,o,i){let a=ws(e,t,n,r,i),u=ws(n,r,s,o,i);if(!(a===void 0||u===void 0))return[a,u]}function fR(e,t,n,r,s,o){return Math.abs(r-t)>Math.abs(o-r)?[e,n]:[n,s]}function SI(e,t,n){let r=e[0]*(1-ju)+t[0]*ju-n[0],s=e[1]*(1-ju)+t[1]*ju-n[1],o=e[2]*(1-ju)+t[2]*ju-n[2];return r*r+s*s+o*o}function Ng(e,t,n,r,s,o,i,a){if(!isFinite(e)||!isFinite(n)||!du(t)||!du(r))return;e>n&&([e,t,n,r]=[n,r,e,t]);let u=xc(e,n),c=s(u),p=o*o;if(SI(t,r,c)<=p)return;let l=xc(e,u),m=s(l);for(;;){let d=SI(t,c,m),y=SI(r,m,c);if(d<=p&&y<=p)return n-e<a?l:void 0;if(d>y){if(n=u,r=c,u=l,c=m,l=xc(e,u),m=s(l),l===e||u-l<=i)return gR(e,t,u,c,n,r);if(!du(m))return yR(e,t,l,m,n,r,s)}else{if(e=l,t=m,l=u,m=c,u=xc(n,u),c=s(u),u===n||u-l<=i)return gR(e,t,l,m,n,r);if(!du(c))return yR(e,t,u,c,n,r,s)}}}function yR(e,t,n,r,s,o,i){let a=Dg(e,t,n,r,i),u=Dg(n,r,s,o,i);if(!(a===void 0||u===void 0))return[a,u]}function gR(e,t,n,r,s,o){return Wu(r,t)>Wu(o,r)?[e,n]:[n,s]}var Zd=class{constructor(t){this.comparator=t;this._data=[]}size(){return this._data.length}queue(t){let n=this._data.length;for(this._data.push(t);n>0;){let r=n-1>>>1;if(this.comparator(this._data[n],this._data[r])<0){let s=this._data[r];this._data[r]=this._data[n],this._data[n]=s,n=r}else break}}dequeue(){let t=this._data[0],n=this._data.pop();if(this._data.length>0&&n!==void 0){this._data[0]=n;let r=0,s=this._data.length-1;for(;;){let o=(r<<1)+1,i=o+1,a=r;if(o<=s&&this.comparator(this._data[o],this._data[a])<0&&(a=o),i<=s&&this.comparator(this._data[i],this._data[a])<0&&(a=i),a!==r){let u=this._data[a];this._data[a]=this._data[r],this._data[r]=u,r=a}else break}}return t}peek(){return this._data[0]}clear(){this._data.length=0}};function t2(e,t){let n=e.start[1]-e.end[1],r=e.end[0]-e.start[0],s=t.start[1]-t.end[1],o=t.end[0]-t.start[0],i=n*e.end[0]+r*e.end[1],a=s*t.end[0]+o*t.end[1],u=n*o-s*r;if(u!==0)return(n*a-s*i)/u}function n2(e,t,n){if(n.xSlope>=t.xSlope)return;if(t.scanlineX===n.scanlineX)return e;let r=t.start[1]>t.end[1]?t.start:t.end,s=n.start[1]>n.end[1]?n.start:n.end,o=r[1];if(s[1]<r[1]){if(o=s[1],CI(o,t)<s[0])return}else if(r[1]<s[1]){let a=CI(o,n);if(r[0]<a)return}else if(r[0]<s[0])return;let i=t2(t,n);if(i!==void 0)return Math.max(Math.min(i,o),e)}function CI(e,t){let n=t.end[0],r=t.start[0],s=t.end[1],o=t.start[1];if(s===e)return n;if(o===e)return r;{let i=(e-s)/(o-s),a=(1-i)*n+i*r;if(n<r){if(a<=n)return n;if(r<=a)return r}else{if(a<=r)return r;if(n<=a)return n}return a}}function vI(e){let t=0,n=0,r=!1,s=0;for(let{scanlineX:o,isClockwise:i}of e)i?s+=1:s-=1,s!==0&&!r?(r=!0,n=o):s===0&&r&&(r=!1,t+=o-n);return t}var Xd=class{constructor(t){this.scanlineY=-1/0;let n=1;this.activeEdges=[],this.events=new Zd((r,s)=>r.y-s.y),this.scanlineY=-1/0,this.polygonLength=t.length-1;for(let r=t.length-1;r>=1;r--){let s=t[r],o=t[r-1],i={id:n++,index:r-1,end:s,start:o,scanlineX:0,xSlope:1/0,isClockwise:o[1]>s[1],skipIntersectionWith:{}};o[1]>s[1]?(this.events.queue({type:\"+\",y:s[1],edge:i}),this.events.queue({type:\"-\",y:o[1],edge:i}),i.xSlope=(o[0]-s[0])/(o[1]-s[1]),i.scanlineX=s[0]):s[1]>o[1]?(this.events.queue({type:\"+\",y:o[1],edge:i}),this.events.queue({type:\"-\",y:s[1],edge:i}),i.xSlope=(s[0]-o[0])/(s[1]-o[1]),i.scanlineX=o[0]):this.events.queue({type:\"h\",y:o[1],edge:i})}}nextScanline(){var o;let t,n=this.events.peek();if(!n)return;if(n.y<=this.scanlineY)throw new Error(\"Programming error: expected next event to begin a new scanline\");this.scanlineY=n.y,this.updateActiveEdgeScanlineIntersections();let r=vI(this.activeEdges),s=[];for(;t=this.events.dequeue();)if(t.type===\"x\"?this.swapActiveEdges(t):t.type===\"+\"?this.insertActiveEdge(t):t.type===\"-\"&&this.removeActiveEdge(t),s.push(t),((o=this.events.peek())==null?void 0:o.y)!==this.scanlineY)return{y:this.scanlineY,activeEdges:this.activeEdges,lengthBeforeProcessingEvents:r,events:s}}updateActiveEdgeScanlineIntersections(){let t=-1/0;for(let n of this.activeEdges){let r=CI(this.scanlineY,n);r<t?r=t:t=r,n.scanlineX=r}}insertActiveEdge(t){let n=this.activeEdges,r=t.edge,s=t.y,{xSlope:o,scanlineX:i}=r,a;for(a=0;a<n.length;a++){let u=n[a];if(i<u.scanlineX||i===u.scanlineX&&o<=u.xSlope)break}n.splice(a,0,r),this.checkIntersection(s,n[a-1],r),this.checkIntersection(s,r,n[a+1])}checkIntersection(t,n,r){if(!n||!r||n.index===(r.index+1)%this.polygonLength||r.index===(n.index+1)%this.polygonLength)return;if(n.id<r.id){if(n.skipIntersectionWith[r.id])return}else if(r.skipIntersectionWith[n.id])return;let s=n2(t,n,r);if(s===void 0)return;n.id<r.id?n.skipIntersectionWith[r.id]=!0:r.skipIntersectionWith[n.id]=!0;let o={type:\"x\",y:s,edge1:n,edge2:r};this.events.queue(o)}removeActiveEdge(t){let n=this.activeEdges,r=t.edge,s=t.y,o=n.indexOf(r);n.splice(o,1),this.checkIntersection(s,n[o-1],n[o])}swapActiveEdges(t){let n=this.activeEdges,r=t.edge1,s=t.edge2,o=t.y,i=n.indexOf(r),a=i+1;i===-1||n[a]!==s?r.id<s.id?delete r.skipIntersectionWith[s.id]:delete s.skipIntersectionWith[r.id]:(n[i]=s,n[a]=r,this.checkIntersection(o,n[i-1],s),this.checkIntersection(o,r,n[a+1]))}static debugEvent(t){let n=`y=${t.y} `;return n+=t.type===\"x\"?`[x ${t.edge1.index}/${t.edge2.index}]`:`[${t.type} ${t.edge.index}] (${t.edge.end})-(${t.edge.start})`,n}debugState(){return`y=${this.scanlineY}\n${this.activeEdges.map(t=>`[${t.index}] ${t.scanlineX}`)}`}};function r2(e){let t=e.slice(0,2),n=e.slice(-2);return t[0]!==n[0]||t[1]!==n[1]?[...e,...t]:e}function v6(e,t){if(!e)return!1;let n=r2(e),[r,s]=t,o=0;for(let i=n.length-1;i>=3;i-=2){let a=n[i-3],u=n[i-2],c=n[i-1],p=n[i];u>s!=p>s&&r<(c-a)*(s-u)/(p-u)+a&&(u>p?o+=1:u<p&&(o-=1))}return o!==0}function IR(e){if(e.length<4||e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])return 0;let t=new Xd(e),n,r=0,s;for(;s=t.nextScanline();){let o=s.lengthBeforeProcessingEvents;n&&(r+=.5*(s.y-n.y)*(o+n.length)),n={y:s.y,length:vI(s.activeEdges)}}return r}function PR(e){if(!e.length)return[];if(e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])throw new Error(\"Programming error: expected last point to be a duplicate of the first point.\");for(let m=0;m<e.length-1;m++)if(e[m][0]===e[m+1][0]&&e[m][1]===e[m+1][1])throw new Error(`Programming error: unexpected duplicate point at ${m+1}`);let t=new Xd(e),n=e.slice(0,-1).map(()=>0),r;for(;r=t.nextScanline();)for(let m of r.events){let d={};if(m.type===\"h\"){let y=m.edge;d[y.index]={xMin:Math.min(y.end[0],y.start[0]),xMax:Math.max(y.end[0],y.start[0]),dx:y.end[0]-y.start[0]}}else if(m.type===\"x\"){let y=m.edge1,g=m.edge2,f=TR([y.start,y.end],[g.start,g.end]),h=f>0?-1:f<0?1:0;n[y.index]+=h,n[g.index]-=h}for(let y of r.activeEdges){let g=y.end[1]-y.start[1];for(let f in d){let{xMin:h,xMax:x,dx:T}=d[f];if(h<y.scanlineX&&y.scanlineX<x){let P=T*g,M=P>0?-1:P<0?1:0;n[f]+=M,n[y.index]-=M}}}}let s=e.slice(0,-1).map(()=>0),o=e[0][1],i=0;for(let m=1;m<e.length;m++)e[m][1]<o&&(o=e[m][1],i=m);let a=e.length-1,u=i>0?i-1:a-1,c=(i+1)%a,l=TR([e[u],e[i]],[e[i],e[c]])>0?1:0;s[i]=l>0?-1:1;for(let m=0;m<a-1;m++){let d=(i+m)%a;l+=n[d],s[(d+1)%a]=l>0?-1:1}return s}function TR(e,t){let n=e[1][0]-e[0][0],r=e[1][1]-e[0][1],s=t[1][0]-t[0][0],o=t[1][1]-t[0][1];return n*o-r*s}var s2=qp,Rg=ws,o2=3.154019550531224,ER=Math.pow(2,-13),Tc=ER*ER,SR=Tc*Tc,DI=Tc,RI=32,Ea=[],Ic=[];function i2(e,t){for(let n=RI;n>0;n--){let r=o2/RI*n,s=Math.sinh(r),o=Math.cosh(Math.PI/2*s),i=1/(Math.exp(Math.PI/2*s)*o),a=Math.cosh(r)/(o*o);e.push(i),t.push(a)}}i2(Ea,Ic);var vR=0;for(let e=0;e<Ic.length;e++)vR+=Ic[e];var Og=1/(1+2*vR);function uo(e,t,n){return .5*(t*(2-n)+e*n)}function a2(e,t,n){let r=.5*(t+n),s=s2(t,e(t),r,e(r),n,e(n),e);return s?.5*(s[0]+s[1]):r}function Wd(e,t,n,r,s){return{x1:e,x2:t,value:n,error:r,minerror:s}}function MR(e,t,n){let r=Math.abs(e(uo(t,n,Tc))),s=Math.abs(e(uo(t,n,2*Tc))),o=Math.abs(e(uo(t,n,4*Tc)));return r<Tc||s<Tc?!1:r>1.95*s&&s>1.95*o}function NI(e,t,n){let r=uo(n,t,Ea[0]),s=uo(t,n,Ea[0]),o=e(r),i=e(s),a=uo(t,n,1),u=e(a),c,p;if(isFinite(u)&&!isFinite(o)){if(c=Rg(r,o,a,u,e),Math.abs((c-t)/(n-t))>DI)return Wd(t,n,NaN,NaN,NaN);t=c,o=e(t)}if(isFinite(u)&&!isFinite(i)){if(p=Rg(a,u,s,i,e),Math.abs((p-n)/(n-t))>DI)return Wd(t,n,NaN,NaN,NaN);n=p,i=e(n)}if(isFinite(o)&&isFinite(i)&&!isFinite(u)){if(c=Rg(r,o,a,u,e),p=Rg(a,u,s,i,e),Math.abs((p-c)/(n-t))>DI)return Wd(t,n,NaN,NaN,NaN);u=.5*(c+p)}if(MR(e,t,n)||MR(e,n,t))return Wd(t,n,NaN,NaN,NaN);let l=u,m=0,d=0,y=0,g=0,f=0,h=0;for(let G=0;G<RI;G+=4)f=e(uo(t,n,Ea[G])),h=e(uo(n,t,Ea[G])),g=Math.max(g,Math.abs(f),Math.abs(h)),m+=Ic[G]*(f+h),f=e(uo(t,n,Ea[G+1])),h=e(uo(n,t,Ea[G+1])),g=Math.max(g,Math.abs(f),Math.abs(h)),y+=Ic[G+1]*(f+h),f=e(uo(t,n,Ea[G+2])),h=e(uo(n,t,Ea[G+2])),g=Math.max(g,Math.abs(f),Math.abs(h)),d+=Ic[G+2]*(f+h),f=e(uo(t,n,Ea[G+3])),h=e(uo(n,t,Ea[G+3])),g=Math.max(g,Math.abs(f),Math.abs(h)),y+=Ic[G+3]*(f+h);let x=l+m,T=x+d,P=T+y,M=Math.abs(d-x),S=Math.abs(y-T),E=Og*(n-t)*P,v=Og*Math.abs(n-t)*g*Ic[0],D;return M===0?D=Og*Math.abs(n-t)*S:D=Og*Math.abs(n-t)*S*(S/M)*(S/M),D=Math.max(D,v),Wd(t,n,E,D,v)}function CR(e){let t=-1/0,n=-1/0,r=-1,s=0;for(let o=0;o<e.length;o++){let i=e[o];s+=i.value,i.error>t&&(t=i.error,r=o),i.minerror>n&&(n=i.minerror)}return{maxerror:t,maxminerror:n,maxindex:r,totalvalue:s}}function jd(e,t,n,r=32){if(isNaN(t)||isNaN(n))return NaN;let s=1;if(t>n){let a=t;t=n,n=a,s=-1}if(t===1/0&&n===1/0)return NaN;if(t===-1/0&&n===-1/0)return NaN;if(t===-1/0&&n===1/0)return s*jd(a=>e(a/((1+a)*(1-a)))*(1+a*a)/((1+a)*(1+a)*(1-a)*(1-a)),-1,1,r);if(t===-1/0)return s*jd(a=>-e(n-a/(1-a))/((1-a)*(1-a)),1,0,r);if(n===1/0)return s*jd(a=>e(t+a/(1-a))/((1-a)*(1-a)),0,1,r);let o=[NI(e,t,n)],i=CR(o);for(let a=1;a<r&&!(Math.abs(i.maxerror/i.totalvalue)<=32*SR||i.maxerror<=32*SR||i.maxerror<=32*i.maxminerror||!isFinite(i.maxerror)||!isFinite(i.maxminerror));a++){let u=o[o.length-1];o[o.length-1]=o[i.maxindex],o[i.maxindex]=u;let c=o.pop(),p=a2(e,uo(c.x2,c.x1,.125),uo(c.x1,c.x2,.125));o.push(NI(e,c.x1,p)),o.push(NI(e,p,c.x2)),i=CR(o)}return!isFinite(i.maxerror)||!isFinite(i.maxminerror)?NaN:Math.abs(i.totalvalue)<=10*i.maxminerror?0:s*i.totalvalue}function Ag(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function OI(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Kd(){}var Jd=.7,Lg=1/Jd,Up=\"\\\\s*([+-]?\\\\d+)\\\\s*\",Qd=\"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",fu=\"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",c2=/^#([0-9a-f]{3,8})$/,l2=new RegExp(`^rgb\\\\(${Up},${Up},${Up}\\\\)$`),p2=new RegExp(`^rgb\\\\(${fu},${fu},${fu}\\\\)$`),m2=new RegExp(`^rgba\\\\(${Up},${Up},${Up},${Qd}\\\\)$`),d2=new RegExp(`^rgba\\\\(${fu},${fu},${fu},${Qd}\\\\)$`),f2=new RegExp(`^hsl\\\\(${Qd},${fu},${fu}\\\\)$`),y2=new RegExp(`^hsla\\\\(${Qd},${fu},${fu},${Qd}\\\\)$`),DR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ag(Kd,ef,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:NR,formatHex:NR,formatHex8:g2,formatHsl:h2,formatRgb:RR,toString:RR});function NR(){return this.rgb().formatHex()}function g2(){return this.rgb().formatHex8()}function h2(){return FR(this).formatHsl()}function RR(){return this.rgb().formatRgb()}function ef(e){var t,n;return e=(e+\"\").trim().toLowerCase(),(t=c2.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?OR(t):n===3?new Xo(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?_g(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?_g(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=l2.exec(e))?new Xo(t[1],t[2],t[3],1):(t=p2.exec(e))?new Xo(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=m2.exec(e))?_g(t[1],t[2],t[3],t[4]):(t=d2.exec(e))?_g(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=f2.exec(e))?wR(t[1],t[2]/100,t[3]/100,1):(t=y2.exec(e))?wR(t[1],t[2]/100,t[3]/100,t[4]):DR.hasOwnProperty(e)?OR(DR[e]):e===\"transparent\"?new Xo(NaN,NaN,NaN,0):null}function OR(e){return new Xo(e>>16&255,e>>8&255,e&255,1)}function _g(e,t,n,r){return r<=0&&(e=t=n=NaN),new Xo(e,t,n,r)}function b2(e){return e instanceof Kd||(e=ef(e)),e?(e=e.rgb(),new Xo(e.r,e.g,e.b,e.opacity)):new Xo}function Rl(e,t,n,r){return arguments.length===1?b2(e):new Xo(e,t,n,r==null?1:r)}function Xo(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Ag(Xo,Rl,OI(Kd,{brighter(e){return e=e==null?Lg:Math.pow(Lg,e),new Xo(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Jd:Math.pow(Jd,e),new Xo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Xo(Nl(this.r),Nl(this.g),Nl(this.b),Fg(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:AR,formatHex:AR,formatHex8:x2,formatRgb:_R,toString:_R}));function AR(){return`#${Dl(this.r)}${Dl(this.g)}${Dl(this.b)}`}function x2(){return`#${Dl(this.r)}${Dl(this.g)}${Dl(this.b)}${Dl((isNaN(this.opacity)?1:this.opacity)*255)}`}function _R(){let e=Fg(this.opacity);return`${e===1?\"rgb(\":\"rgba(\"}${Nl(this.r)}, ${Nl(this.g)}, ${Nl(this.b)}${e===1?\")\":`, ${e})`}`}function Fg(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Nl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Dl(e){return e=Nl(e),(e<16?\"0\":\"\")+e.toString(16)}function wR(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Sa(e,t,n,r)}function FR(e){if(e instanceof Sa)return new Sa(e.h,e.s,e.l,e.opacity);if(e instanceof Kd||(e=ef(e)),!e)return new Sa;if(e instanceof Sa)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),o=Math.max(t,n,r),i=NaN,a=o-s,u=(o+s)/2;return a?(t===o?i=(n-r)/a+(n<r)*6:n===o?i=(r-t)/a+2:i=(t-n)/a+4,a/=u<.5?o+s:2-o-s,i*=60):a=u>0&&u<1?0:i,new Sa(i,a,u,e.opacity)}function Vg(e,t,n,r){return arguments.length===1?FR(e):new Sa(e,t,n,r==null?1:r)}function Sa(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ag(Sa,Vg,OI(Kd,{brighter(e){return e=e==null?Lg:Math.pow(Lg,e),new Sa(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Jd:Math.pow(Jd,e),new Sa(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new Xo(AI(e>=240?e-240:e+120,s,r),AI(e,s,r),AI(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new Sa(LR(this.h),wg(this.s),wg(this.l),Fg(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=Fg(this.opacity);return`${e===1?\"hsl(\":\"hsla(\"}${LR(this.h)}, ${wg(this.s)*100}%, ${wg(this.l)*100}%${e===1?\")\":`, ${e})`}`}}));function LR(e){return e=(e||0)%360,e<0?e+360:e}function wg(e){return Math.max(0,Math.min(1,e||0))}function AI(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function Ol(e,t){if(!isFinite(e)||!isFinite(t))return NaN;if(e=Math.round(e),t=Math.round(t),e<0&&(e=-e),t<0&&(t=-t),t>e){let r=t;t=e,e=r}if(t===0)return e;let n=e%t;for(;n>0;)e=t,t=n,n=e%t;return t}function Al(e,t){if(isNaN(e)&&t===0)return NaN;if(e>=0||t===Math.floor(t))return Math.pow(e,t);let n=$u(t,100);return Co(n.n/n.d,t,2)&&n.d%2===1?(n.n%2===0?1:-1)*Math.pow(-e,t):NaN}var Ct={};Ka(Ct,{actionMergeFreeVariable:()=>HP,addArgumentsToDefinition:()=>xf,addTypeError:()=>YI,adjacentMixedNumber:()=>th,adjacentNumbers:()=>pE,andTypeError:()=>rP,ansUndefined:()=>wS,assignmentsUnsupported:()=>VS,badEqualitySlice:()=>gu,badForInputListDependency:()=>YS,badForIntervalDependency:()=>ZS,badImplicitCall:()=>eh,badIntegralBoundDependency:()=>RS,badLogExponent:()=>DE,badProductBoundDependency:()=>IS,badSampleSize:()=>AS,badSumBoundDependency:()=>TS,badSymbolContext:()=>Sf,badTrigExponent:()=>vE,badTupleDimensions:()=>lE,baseCaseCannotDependOnRecursiveParameter:()=>GI,baseCaseTooComplicatedUsePiecewise:()=>of,baseCasesMustAllHaveSameReturnType:()=>sf,binaryOperatorMissingOperand:()=>Zp,blankExpression:()=>hf,boxplotBreadthInvalid:()=>QP,boxplotOffsetInvalid:()=>JP,cannotAssignColor:()=>QE,cannotRedefine:()=>Xp,cannotRestrict:()=>jE,cannotRestrictTrianglesWithList:()=>JE,cannotRestrictWithEquality:()=>KE,cannotSubscript:()=>wE,cantCombineSphericalAndCylindrical:()=>lh,cdfMaxInvalid:()=>ZE,cdfMaxLessThanMin:()=>C2,cdfMinInvalid:()=>YE,cdfRequiresArguments:()=>eE,cdfTooManyArguments:()=>tE,clickableObjectAlreadyAssigned:()=>w2,clickableObjectAssignmentNotDefined:()=>_2,clickableObjectAssignmentNotIdentifier:()=>L2,clickableObjectInvalidExpression:()=>F2,colonMissingCondition:()=>OE,colorArity:()=>sE,combineTypeError:()=>jg,comparatorTypeError:()=>nP,complexPlottedTableCell:()=>v2,complicatedDoubleInequality:()=>fh,complicatedPolarImplicit:()=>iS,computedColumnHeader:()=>i0,constantUnsupported:()=>Mf,coordinateAccessTypeError:()=>iP,customRegressionsUnsupported:()=>qS,cycle:()=>LE,deeplyNested:()=>kP,dependsOnDeletedGeoObject:()=>n0,derivativeMissingBody:()=>DS,derivativeRecursiveCycle:()=>MP,derivativeTypeError:()=>PP,derivativeTypeErrorRespect:()=>EP,derivativeVariableTypeError:()=>SP,differentialWithSuperscript:()=>SS,distributionAsFunction:()=>hh,divideTypeError:()=>JI,domainMaxInvalid:()=>kE,domainMaxLessThanMin:()=>$E,domainMinInvalid:()=>zE,dotLHSConstantNumberError:()=>$g,dotLHSTypeError:()=>pP,dotRHSPropertyError:()=>mP,duplicateFunctionParameter:()=>AE,duplicateUpdateRules:()=>FP,eachBaseCaseArgumentMustBeSimple:()=>Ug,emptyParen:()=>gf,emptyPipe:()=>CE,emptyRadical:()=>EE,emptyRadicalIndex:()=>SE,emptySquareBracket:()=>ME,emptySubscript:()=>sh,emptySuperscript:()=>bE,equationRequired:()=>yh,equationsUnsupported:()=>Cf,eventHandlerTypeError:()=>pf,expectedArgumentToBeButFound:()=>kI,exponentTypeError:()=>QI,featureUnavailable:()=>vf,fractionEmpty:()=>hE,fractionMissingDenominator:()=>gE,fractionMissingNumerator:()=>yE,fractionsUnavailable:()=>Eh,functionDefinitionsUnsupported:()=>BS,functionNameAsParameter:()=>_E,functionNotDefined:()=>ah,functionOnlyWorksInComplexMode:()=>HR,functionRequiresNumberOfArguments:()=>zI,functionTypeError:()=>Fs,functionUnsupported:()=>Na,geometryLengthTypeError:()=>cP,getLogInternalErrors:()=>P2,gpuLongProduct:()=>jP,gpuLongSum:()=>WP,gpuMaxListSize:()=>Bl,gpuUnsupportedFunction:()=>Yp,gpuUnsupportedIntegral:()=>ZP,gpuUnsupportedRecursion:()=>XP,gpuVariableListLength:()=>Pc,gpuVariableProduct:()=>Qg,gpuVariableSum:()=>Jg,heterogeneousList:()=>mf,identifierAsFunction:()=>nh,identifierIsNotFunction:()=>rh,illegalBinWidth:()=>Ef,illegalDotCall:()=>lf,implicitsDisabled:()=>oS,incorrectProductLowerBound:()=>xS,incorrectSumLowerBound:()=>bS,indexTypeError:()=>cf,inequalitiesDisabled:()=>ph,inequalitiesUnsupported:()=>GS,integralArgumentTypeError:()=>IP,integralLowerBoundTypeError:()=>xP,integralMissingBody:()=>vS,integralMissingBound:()=>PS,integralMissingDifferential:()=>ES,integralUpperBoundTypeError:()=>TP,internal:()=>V,invalidDependentFirstTableColumn:()=>D2,invalidDoubleEquality3d:()=>uS,invalidDoubleInequality3d:()=>aS,invalidDoubleInequalityVariables:()=>mh,invalidFirstTableColumn:()=>pS,invalidFunctionName:()=>Ph,invalidHalfEmptyRange:()=>yS,invalidImplicitVariables:()=>ql,invalidImplicitVariables3d:()=>rS,invalidInequalityVariables:()=>nS,invalidIntervalComprehensionArity:()=>s0,invalidIntervalComprehensionParameter:()=>Jp,invalidIntervalComprehensionReturnType:()=>r0,invalidLHS:()=>eS,invalidNestedIntervalComprehension:()=>o0,invalidOperatorName:()=>TE,invalidPvalue:()=>FI,invalidRegressionParameter:()=>mS,invalidSubscript:()=>xE,invalidTableEntry:()=>Tf,invalidTableHeader:()=>lS,listComprehensionIncorrectInput:()=>$S,listComprehensionInputListTypeError:()=>kS,listTypeError:()=>Vl,logScaleBoxPlot:()=>zP,logScaleDotPlot:()=>UP,logScaleHistogram:()=>qP,logScaleTypeError:()=>$p,logbaseUnsupported:()=>FS,malformedList:()=>cE,malformedPoint:()=>uE,matrixAddDimensions:()=>B2,matrixAssignment:()=>V2,matrixElementTypeError:()=>z2,matrixFractionalPower:()=>q2,matrixInvalidVariable:()=>k2,matrixMultiplyDimensions:()=>H2,matrixPowerDimensions:()=>U2,matrixSubtractDimensions:()=>G2,maxListSize:()=>df,methodRequiresList:()=>hu,mismatchedBraces:()=>NS,mismatchedDoubleInequality:()=>dh,mixedComparatorChain:()=>eP,mixedRestrictionEquation:()=>YP,multipleEqualityRestrictions:()=>$P,multiplyDefined:()=>bf,multiplyTypeError:()=>uf,multiplyTypeError2D:()=>WI,multiplyTypeError3D:()=>jI,multiplyTypeErrorCross:()=>XI,negativeTypeError:()=>KI,nonArithmeticRange:()=>Pf,nonListDoubleReducer:()=>If,nonListParameterizedReducer:()=>fS,nonSquareDeterminant:()=>N2,nonSquareInverse:()=>O2,nonSquareTrace:()=>R2,opaque:()=>af,optimizationError:()=>dS,orTypeError:()=>sP,parameterAlreadyDefined:()=>uh,parenthesesUnavailable:()=>zS,pdfWrongArity:()=>KP,percentMissingOf:()=>OS,piecewiseBranchTypeError:()=>vP,piecewiseConditionTypeError:()=>Xg,piecewiseMissingCondition:()=>NE,piecewisePartMissingCondition:()=>RE,pointTypeError:()=>oP,pointsUnsupported:()=>US,polygonTwoNumbersError:()=>ff,polygonUnsupportedIn3d:()=>Th,primeVariableTypeError:()=>CP,primeWithoutParen:()=>ih,primedFunctionArity:()=>Gl,productArgumentTypeError:()=>bP,productInfiniteBoundError:()=>Zg,productLowerBoundTypeError:()=>gP,productMissingBody:()=>CS,productMissingBound:()=>hS,productUpperBoundTypeError:()=>hP,randomArity:()=>nE,randomFromBroadcastDistribution:()=>rE,recursionCyclicDependency:()=>HI,recursionDoesNotTerminate:()=>qI,recursionInRegression:()=>RP,recursiveDepthExceeded:()=>UI,recursiveFunctionCannotDependOnFreeVariable:()=>BI,recursiveFunctionMissingBaseCase:()=>qg,recursiveFunctionMissingBaseCaseWithMetadata:()=>VI,regressionTypeError:()=>_P,regressionsUnsupported:()=>HS,selfReferentialBaseCase:()=>FE,selfReferentialFunctions:()=>Hl,setLogInternalErrors:()=>wI,shadowedIndex:()=>ch,shadowedIntegrationVariable:()=>bh,shadowedListComprehensionInput:()=>Sh,singleVariableImplicitEquationsDisabled:()=>sS,singularInverse:()=>A2,sliderLimitReferencesExport:()=>BE,sliderMaxInvalid:()=>HE,sliderMaxLessThanMin:()=>qE,sliderMinInvalid:()=>GE,sliderStepInvalid:()=>UE,substitutionAmbiguousComma:()=>Sc,substitutionBodyAction:()=>Y2,substitutionBodyDependsOnRegression:()=>KS,substitutionDuplicateSymbol:()=>e0,substitutionFunctionLHS:()=>Of,substitutionIllegalLHS:()=>Rf,substitutionInvalidAssignments:()=>Nf,substitutionLocalLHS:()=>QS,substitutionNested:()=>Mh,substitutionRecursiveCallLHS:()=>t0,substitutionTypeError:()=>$2,substitutionUnsupportedInterval:()=>Ch,subtractTypeError:()=>ZI,sumArgumentTypeError:()=>yP,sumInfiniteBoundError:()=>Yg,sumLowerBoundTypeError:()=>dP,sumMissingBody:()=>MS,sumMissingBound:()=>gS,sumUpperBoundTypeError:()=>fP,superscriptWithPrime:()=>PE,tableEntryTypeError:()=>NP,tableHeaderTypeError:()=>DP,tableRegressionInvalidData:()=>AP,tableRegressionLogWithNegative:()=>S2,tableRegressionTypeError:()=>OP,tdistWrongArity:()=>M2,threeDLengthTypeError:()=>lP,tickerMinStepNonNegativeNumber:()=>VE,todoStats:()=>LI,tokenWithSubscript:()=>mE,tooManyArguments:()=>Kg,tooManyVariables:()=>mn,transformationDefinitionTypeError:()=>aP,transformationTypeError:()=>uP,ttestListTooShort:()=>jp,unaryOperatorMissingLeft:()=>dE,unaryOperatorMissingRight:()=>fE,unexpectedEquality:()=>$I,unexpectedInequality:()=>kg,unexpectedPrime:()=>oh,unexpectedSubscript:()=>IE,unexpectedSymbol:()=>Ls,unexportableTableRegression:()=>a0,unplottableEqualityChain:()=>cS,unplottableLongInequalityChain:()=>tP,unplottablePolarFunction:()=>tS,unrecognizedSymbol:()=>zg,updateRuleFunctionLHS:()=>GP,updateRuleIllegalLHS:()=>BP,updateRuleLocalLHS:()=>Wg,updateRuleNonIdentifierLHS:()=>LP,updateRuleTypeError:()=>wP,updateRuleUndefinedLHS:()=>VP,useRForCylindricalCoordinates:()=>WE,useRhoForSphericalCoordinates:()=>XE,using3dObjectIn2d:()=>Ec,variableAsFunction:()=>gh,variableLengthDistributionList:()=>Df,variableLengthIntegralDependsOnIntegrationVariable:()=>JS,variableLengthProductBodyDependsOnIndex:()=>jS,variableLengthSumBodyDependsOnIndex:()=>WS,variableLengthTopLevelList:()=>XS,variableSeed:()=>_S,variableUnsupported:()=>Ih,variablesUnsupported:()=>LS,warnComplexImplicit:()=>Wp,writeIntegral:()=>xh,wrongArity:()=>Da,wrongArityLengthAsCount:()=>oE,wrongDoubleReducerArity:()=>yf,wrongParameterizedReducerArity:()=>iE,zeroArgReducer:()=>aE});function tf(e){return{__isLocalizableNumericValue:!0,value:e}}function L6(e){return e&&e.__isLocalizableNumericValue}var yu=()=>({type:\"empty\"}),vr=()=>I2([-1/0,1/0]),Ma=()=>jo([-1/0,1/0]),jo=e=>Bg(e,!0),I2=e=>Bg(e,!1),Bg=(e,t)=>isNaN(e[0])||isNaN(e[1])||e[1]<e[0]?yu():{type:\"interval\",bounds:e,tight:t};function co(e){return e.type===\"empty\"}function Wo(e){return co(e)||e.tight}var zp=(e,t)=>{if(t===0)return e>0?Ma():yu();let n=-e/t,r=t<0?[-1/0,n]:[n,1/0];return jo(r)},er=(e,t)=>{if(co(e)||co(t))return yu();let n=[Math.max(e.bounds[0],t.bounds[0]),Math.min(e.bounds[1],t.bounds[1])],r=Wo(e)&&Wo(t);return Bg(n,r)},nf=(e,t)=>{if(co(e))return t;if(co(t))return e;let n=[Math.min(e.bounds[0],t.bounds[0]),Math.max(e.bounds[1],t.bounds[1])],r;return!Wo(e)&&!Wo(t)?r=!1:Wo(e)&&!Wo(t)?r=e.bounds[0]<=t.bounds[0]&&e.bounds[1]>=t.bounds[1]:!Wo(e)&&Wo(t)?r=t.bounds[0]<=e.bounds[0]&&t.bounds[1]>=e.bounds[1]:r=e.bounds[0]<=t.bounds[1]&&t.bounds[0]<=e.bounds[1],Bg(n,r)},VR=(e,t,n)=>{if(co(e))return n;let r=er(e,t);return Wo(e)?(e.bounds[0]>-1/0&&(r=nf(r,er(jo([-1/0,e.bounds[0]]),n))),e.bounds[1]<1/0&&(r=nf(r,er(jo([e.bounds[1],1/0]),n)))):r=nf(r,er(n,vr())),r};function lo(e,t,n){return{input:e,start:t,end:n}}function Ca(e,t){return lo(e,t,t)}function po(e,t){if(e.input!==t.input)throw new Error(\"Programming Error: cannot form a span on different inputs\");return lo(e.input,e.start,t.end)}function pr(e){return e.input.slice(e.start,e.end)}var lt=class{constructor(){this.tableFrameID=void 0;this._dependencies=[],this._optionalDependencies=[],this._updateSymbols=[],this._scope={definitions:[],dependencies:[],substitutionDependencies:[],scopes:[]},this._exports=[],this.metaData={extraDepNodes:[]},this.userData={}}setInputSpan(t){this._inputSpan=t}getInputString(){return this._inputSpan===void 0?\"\":pr(this._inputSpan)}getInputSpan(){return this._inputSpan}shouldExportAns(){return!1}getAnsVariable(){return this.shouldExportAns()&&this.userData&&this.userData.hasOwnProperty(\"index\")?[\"ans_\"+this.userData.index]:[]}addDependency(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._scope.dependencies.indexOf(t)===-1&&this._scope.dependencies.push(t)}addDependencies(t){for(let n=0;n<t.length;n++)this.addDependency(t[n])}addOptionalDependencies(t){for(let n=0;n<t.length;n++){let r=t[n];this._dependencies.indexOf(r)===-1&&this._dependencies.push(r),this._optionalDependencies.indexOf(r)===-1&&this._optionalDependencies.push(r)}}addUpdateSymbol(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._updateSymbols.indexOf(t)===-1&&this._updateSymbols.push(t)}addSubstitutionDependencies(t){for(let n=0;n<t.length;n++){let r=t[n];if(this._dependencies.indexOf(r)===-1)throw new Error(\"Programming error: substitution dependency \"+r+\" must also be registered as a regular dependency\");this._scope.substitutionDependencies.indexOf(r)===-1&&this._scope.substitutionDependencies.push(r)}}mergeDependencies(...t){for(let n=0;n<t.length;n++){let r=t[n];for(let s=0;s<r._dependencies.length;s++)this._dependencies.indexOf(r._dependencies[s])===-1&&this._dependencies.push(r._dependencies[s]);for(let s=0;s<r._updateSymbols.length;s++)this._updateSymbols.indexOf(r._updateSymbols[s])===-1&&this._updateSymbols.push(r._updateSymbols[s]);for(let s=0;s<r._scope.dependencies.length;s++)this._scope.dependencies.indexOf(r._scope.dependencies[s])===-1&&this._scope.dependencies.push(r._scope.dependencies[s]);for(let s=0;s<r._scope.substitutionDependencies.length;s++)this._scope.substitutionDependencies.indexOf(r._scope.substitutionDependencies[s])===-1&&this._scope.substitutionDependencies.push(r._scope.substitutionDependencies[s]);this.addOptionalDependencies(r.getOptionalDependencies()),Array.prototype.push.apply(this._scope.scopes,r._scope.scopes)}}mergeDependenciesInScope(t,n,r,s){let o=r.getScope(),i={kind:t,definitions:n,dependencies:o.dependencies,substitutionDependencies:o.substitutionDependencies,scopes:o.scopes,functionDefinitionSymbol:s==null?void 0:s.functionDefinitionSymbol};this._scope.scopes.push(i);for(let a=0;a<r._dependencies.length;a++){let u=r._dependencies[a];!n.includes(u)&&!this._dependencies.includes(u)&&this._dependencies.push(u)}for(let a=0;a<r._updateSymbols.length;a++)this._updateSymbols.indexOf(r._updateSymbols[a])===-1&&this._updateSymbols.push(r._updateSymbols[a]);this.addOptionalDependencies(r.getOptionalDependencies())}getDependencies(){return this._dependencies}graphmodeDependencies(t,n){return this.getDependencies()}getOptionalDependencies(){return this._optionalDependencies}getUpdateSymbols(){return this._updateSymbols}getScope(){return this._scope}dependsOn(t){return this._dependencies.indexOf(t)>-1}getExports(t){let n=this._exports||[];if(this.userData&&\"id\"in this.userData){let r=this.userData.id;n=n.concat([\"idref_\"+r])}return t.ansEnabled()&&(n=n.concat(this.getAnsVariable())),n}getLegalExports(t){return this.getExports(t).filter(n=>!t.assignmentForbidden(n))}exportsSymbol(t){return this._exports.indexOf(t)>-1}exportTo(t,n,r){let s=[],o=this.getLegalExports(t);for(let i=0;i<o.length;i++){let a=o[i];if(r.hasOwnProperty(a))return s;r[a]=n.type===\"Error\"&&n.blocksExport?n:this,s.push(a)}return s}getOperator(){return this.operator||\"=\"}isInequality(){return!1}isShadeBetween(){return!1}shouldPromoteToSlider(t){return!1}getSliderVariables(t,n,r){let s=t.sliderVariables(r!=null?r:n.getDependencies());return n.valueType===N||n.valueType===Gt||n.valueType===F||n.valueType===zr||n.valueType===O||n.valueType===He?t.is3dPolicy()?s.includes(\"t\")&&!s.includes(\"u\")&&!s.includes(\"v\")?s.filter(o=>o!=\"t\"):!s.includes(\"t\")&&(s.includes(\"u\")||s.includes(\"v\"))?s.filter(o=>o!=\"u\"&&o!=\"v\"):s:s.filter(o=>!t.validParametricVariable(o)):s}asValue(){}boundDomain(t){return vr()}getCursorContext(){}asCompilerValue(){}substitute(t){}getExpressionType(t,n){}tableInfo(t,n){}getGraphMode(t,n){}getMoveStrategy(t,n,r,s){}};var C=class extends lt{constructor(n){super();this.type=\"Error\";this.isError=!0;this.blocksExport=!1;this._msg=n,this.blocksExport=!0}evaluateOnce(n){return this._msg}getError(){return this._msg}setDependencies(n){return this.addDependencies(n),this}setActionValue(n){this.actionValue=n}allowExport(){return this.blocksExport=!1,this}setCursorContext(n){this.cursorContext=n}getCursorContext(){return this.cursorContext}},kp=class extends C{};var rf={real:!0,imag:!0,conj:!0,arg:!0},GR=Object.keys(rf);var wl=class{constructor(t){this.singleExpression=t.singleExpression}isGeometryEnabled(){return!1}is3dProduct(){return!1}is3dPolicy(){return!1}isComplexEnabled(){return!1}isRecursionEnabled(){return!1}polygonUnsupportedPreferTriangle(){return!1}areAllScalesLinear(){return!0}assignmentForbidden(t){return t.slice(0,3)!==\"ans\"}isValidSlider(t){return!1}sliderVariables(){return[]}graphingEnabled(){return!1}ansEnabled(){return!this.singleExpression}dimensionVarsEnabled(){return!1}disabledFeatures(){return[\"Sum\",\"Product\",\"Integral\",\"List\",\"Derivative\",\"Piecewise\",\"Restriction\",\"Norm\",\"Exponent\",\"PercentOf\",\"Substitution\"]}shouldIncludeFunctionParametersInRandomSeed(){return!0}isNewStatsEnabled(){return!1}};var Hg=!1;function wI(e){Hg=e}function P2(){return Hg}function E2(...e){Hg&&console.error(...e)}function V(e){if(Hg){let t=e instanceof Error?e:new Error(`${e}`);return E2(t.stack),new C(I(\"shared-calculator-error-internal-error\",{msg:t.message}))}return new C(I(\"shared-calculator-error-parse-error\"))}function LI(e){return V(e)}function FI(){return new C(I(\"graphing-calculator-error-inference-invalid-cdf-p-value\"))}function qg(e){let t=e.length,n=e[0];return new C(I(\"shared-calculator-error-recursion-missing-base-case\",{count:tf(t),lastSymbol:z(n),symbols:e.slice(1).map(r=>z(r)).join(\"', '\")}))}function VI(e,t){let n=qg(e);return n.recursionMetadata=t,n}function BI(e){return new C(I(\"shared-calculator-error-recursion-base-case-free-variable\",{freeVariable:z(e)}))}function GI(e){return new C(I(\"shared-calculator-error-recursion-base-case-free-variable\",{freeVariable:z(e)}))}function sf({blockExport:e}){let t=new C(I(\"shared-calculator-error-recursion-base-case-same-type\"));return e||t.allowExport(),t}function of(){return new C(I(\"shared-calculator-error-recursion-base-case-too-complicated\"))}function Ug(){return new C(I(\"shared-calculator-error-recursion-base-case-argument-non-number\"))}function HI(){return new C(I(\"shared-calculator-error-recursion-does-not-terminate\"))}function qI(){return new C(I(\"shared-calculator-error-recursion-does-not-terminate\"))}function UI(){return new C(I(\"shared-calculator-error-recursion-depth-limit-exceeded\"))}function zI(e,t){return new C(I(\"shared-calculator-error-recursion-wrong-arity\",{fnSymbol:z(e),count:tf(t)}))}function kI(e,t,n,{blockExport:r}){let s=new C(I(\"shared-calculator-error-recursion-argument-type\",{index:e+1,expectedType:t,foundType:n}));return r||s.allowExport(),s}function af(){return new C(I(\"shared-calculator-error-parse-error\"))}function zg(e){return e=z(e),new C(I(\"shared-calculator-error-unrecognized-symbol\",{symbol:e}))}function kg(){return new C(I(\"shared-calculator-error-unexpected-inequality\"))}function $I(){return new C(I(\"shared-calculator-error-unexpected-equality\"))}function Ls(e){return e=z(e),new C(I(\"shared-calculator-error-unexpected-symbol\",{symbol:e}))}function YI(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-add-type-error\",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function ZI(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-subtract-type-error\",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function uf(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-multiply-type-error\",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function XI(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-multiply-type-error-cross\",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function WI(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-multiply-type-error-2d\",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function jI(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-multiply-type-error-3d\",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function JI(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-divide-type-error\",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function QI(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-exponent-type-error\",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function KI(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-negative-type-error\",{symbol:e[0]}));return t||n.allowExport(),n}function eP(){return new C(I(\"shared-calculator-error-mixed-comparator-chain\"))}function tP(){return new C(I(\"shared-calculator-error-unplottable-long-inequality-chain\"))}function nP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-comparator-type-error\",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function rP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-operator-type-error\",{symbol:\"and\",symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function sP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-operator-type-error\",{symbol:\"or\",symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function Vl(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-list-type-error\",{symbol1:e[0]}));return t||n.allowExport(),n}function oP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-point-type-error\",{symbol1:e,symbol2:oe(N)}));return t||n.allowExport(),n}function cf(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-index-type-error\",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function iP(e,t,{blockExport:n}){let r=t===\".p\"?new C(I(\"shared-calculator-error-unexpected-symbol\",{symbol:\".\"})):new C(I(\"shared-calculator-error-coordinate-access-type-error\",{coordinate:t,symbol:e[0]}));return n||r.allowExport(),r}function Fs(e,t,{blockExport:n}){let r;switch(t.length){case 1:r=new C(I(\"shared-calculator-error-function-type-error-1\",{fn:z(e),arg:t[0]}));break;case 2:r=new C(I(\"shared-calculator-error-function-type-error-2\",{fn:z(e),arg1:t[0],arg2:t[1]}));break;default:r=new C(I(\"shared-calculator-error-function-type-error-many\",{fn:z(e)}));break}return n||r.allowExport(),r}var _I={translate:\"translation\",rotate:\"rotation\",dilate:\"dilation\",reflect:\"reflection\"};function aP(e,t,n,{blockExport:r}){let s=[];if(n.maxArity===void 0)return Fs(e,t,{blockExport:r});for(let a=1;a<n.argTypes.length;a++){let u=n.argTypes[a];typeof u==\"number\"?s.push(oe(u)):s.push(oe(u.getTypes()[0]))}let o=\"\";switch(s.length){case 1:o=I(t.length>s.length?\"shared-calculator-error-transformation-definition-expected-types-use-fewer-1\":\"shared-calculator-error-transformation-definition-expected-types-1\",{arg:s[0]});break;case 2:o=I(t.length>s.length?\"shared-calculator-error-transformation-definition-expected-types-use-fewer-2\":\"shared-calculator-error-transformation-definition-expected-types-2\",{arg1:s[0],arg2:s[1]});break}let i;switch(t.length){case 1:i=new C(I(t.length<s.length?\"shared-calculator-error-transformation-definition-type-error-use-more-1\":\"shared-calculator-error-transformation-definition-type-error-1\",{fn:z(_I[e]),arg:t[0],expectedTypeMessage:o}));break;case 2:i=new C(I(t.length<s.length?\"shared-calculator-error-transformation-definition-type-error-use-more-2\":\"shared-calculator-error-transformation-definition-type-error-2\",{fn:z(_I[e]),arg1:t[0],arg2:t[1],expectedTypeMessage:o}));break;default:i=new C(I(\"shared-calculator-error-transformation-definition-type-error-many\",{fn:z(_I[e])}));break}return r||i.allowExport(),i}function uP(e,t,{blockExport:n}){let r;switch(t.length){case 1:r=new C(I(\"shared-calculator-error-transformation-type-error-1\",{fn:z(e),arg:t[0]}));break;case 2:r=new C(I(\"shared-calculator-error-transformation-type-error-2\",{fn:z(e),arg1:t[0],arg2:t[1]}));break;default:r=new C(I(\"shared-calculator-error-transformation-type-error-many\",{fn:z(e)}));break}return n||r.allowExport(),r}function cP(e,t,{blockExport:n}){let r=z(e),s=z(\"count\"),o=new C(I(\"shared-calculator-error-geometry-length-type-error\",{fn:r,alternativeFn:s,arg:t}));return n||o.allowExport(),o}function lP(e,t,{blockExport:n}){let r=z(e),s=z(\"count\"),o=new C(I(\"shared-calculator-error-3d-length-type-error\",{fn:r,alternativeFn:s,arg:t}));return n||o.allowExport(),o}function lf(e){return new C(I(\"shared-calculator-error-illegal-dot-call\",{symbol:z(e)}))}function pP(e,t,{blockExport:n}){let r=new C(I(\"shared-calculator-error-dot-lhs-type-error\",{symbol:z(e),type:t}));return n||r.allowExport(),r}function $g(){return new C(I(\"shared-calculator-error-dot-lhs-constant-number\"))}function mP(e){return new C(I(\"shared-calculator-error-dot-rhs-property-error\",{symbol:z(e)}))}function dP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-sum-lower-bound-type-error\",{symbol:e[0]}));return t||n.allowExport(),n}function fP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-sum-upper-bound-type-error\",{symbol:e[0]}));return t||n.allowExport(),n}function Yg(){return new C(I(\"shared-calculator-error-sum-infinite-bound-type-error\"))}function yP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-sum-argument-type-error\",{symbol:e[0]}));return t||n.allowExport(),n}function gP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-product-lower-bound-type-error\",{symbol:e[0]}));return t||n.allowExport(),n}function hP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-product-upper-bound-type-error\",{symbol:e[0]}));return t||n.allowExport(),n}function Zg(){return new C(I(\"shared-calculator-error-product-infinite-bound-type-error\"))}function bP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-product-argument-type-error\",{symbol:e[0]}));return t||n.allowExport(),n}function xP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-integral-lower-bound-type-error\",{symbol:e[0]}));return t||n.allowExport(),n}function TP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-integral-upper-bound-type-error\",{symbol:e[0]}));return t||n.allowExport(),n}function IP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-integral-argument-type-error\",{symbol:e[0]}));return t||n.allowExport(),n}function PP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-derivative-type-error\",{symbol:e[0]}));return t||n.allowExport(),n}function EP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-derivative-type-error-respect\",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function SP(e,t,{blockExport:n}){let r=new C(I(\"shared-calculator-error-derivative-variable-type-error\",{symbol1:z(e),symbol2:t[0]}));return n||r.allowExport(),r}function MP(e){return new C(I(\"shared-calculator-error-derivative-recursive-cycle\",{symbol1:z(e)}))}function CP(e,t,{blockExport:n}){let r=new C(I(\"shared-calculator-error-prime-variable-type-error\",{symbol1:z(e),symbol2:t[0]}));return n||r.allowExport(),r}function Xg(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-piecewise-condition-type-error\",{symbol1:oe(Re),symbol2:e[0]}));return t||n.allowExport(),n}function vP(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-piecewise-branch-type-error\",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function DP(e){return new C(I(\"shared-calculator-error-table-header-type-error\",{symbol:e[0]}))}function NP(e){return new C(I(\"shared-calculator-error-table-entry-type-error\",{symbol:e[0]}))}function RP(){return new C(I(\"shared-calculator-error-regression-recursion\"))}function OP(e){return new C(I(\"shared-calculator-error-table-regression-type-error\",{symbol:e}))}function AP(){return new C(I(\"shared-calculator-error-table-regression-invalid-data\"))}function S2(){return new C(I(\"shared-calculator-error-table-regression-log-with-negative\"))}function _P(e){return new C(I(\"shared-calculator-error-regression-type-error\",{symbol1:e[0],symbol2:e[1]}))}function wP(e){return new C(I(\"shared-calculator-error-update-rule-type-error\",{symbol:e}))}function LP(){return new C(I(\"shared-calculator-error-update-rule-non-identifier-lhs\",{arrow:\"\\u2192\",example:\"a\"}))}function FP(e){return new C(I(\"shared-calculator-error-duplicate-update-rules\",{symbol:z(e)}))}function VP(e){return new C(I(\"shared-calculator-error-update-rule-undefined-lhs\",{symbol:z(e)}))}function BP(e){return new C(I(\"shared-calculator-error-update-rule-illegal-lhs\",{symbol:z(e)}))}function GP(e){return new C(I(\"shared-calculator-error-update-rule-function-lhs\",{symbol:z(e)}))}function Wg(e){return new C(I(\"shared-calculator-error-update-rule-local-lhs\",{symbol:z(e)}))}function HP(e){let t=e.filter(n=>n.scope===\"free\").map(n=>n.symbol);return new C(I(\"shared-calculator-error-action-merge-free-variable\",{symbol:z(t[0]||\"\")})).setDependencies(t).allowExport()}function pf(e){return new C(I(\"shared-calculator-error-event-handler-type-error\",{example:\"a\\u2192a+1\"}))}function mf({blockExport:e}){let t=new C(I(\"shared-calculator-error-heterogeneous-list\"));return e||t.allowExport(),t}function jg(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-combine-type-error\",{symbol1:e[0],symbol2:e[1]}));return t||n.allowExport(),n}function $p(e){return new C(I(\"shared-calculator-error-log-scale-type-error\",{symbol:e})).allowExport()}function qP(){return new C(I(\"shared-calculator-error-log-scale-histogram\"))}function UP(){return new C(I(\"shared-calculator-error-log-scale-dot-plot\"))}function zP(){return new C(I(\"shared-calculator-error-log-scale-box-plot\"))}function kP(){return new C(I(\"shared-calculator-error-deeply-nested\")).allowExport()}function $P(){return new C(I(\"shared-calculator-error-3d-multiple-equality-restrictions\")).allowExport()}function YP(){return new C(I(\"shared-calculator-error-3d-mixed-restriction-equation\")).allowExport()}function gu(){return new C(I(\"shared-calculator-error-3d-bad-equality-slice\")).allowExport()}function Pc(e){return new C(I(\"shared-calculator-error-gpu-variable-list-length\",{symbol:z(e.filter(t=>t.symbol!==\"globalRandomSeed\")[0].symbol)}))}function Jg(e){return new C(I(\"shared-calculator-error-gpu-variable-sum\",{symbol:z(e[0].symbol)}))}function Qg(e){return new C(I(\"shared-calculator-error-gpu-variable-product\",{symbol:z(e[0].symbol)}))}function Yp(e){return new C(I(\"shared-calculator-error-gpu-function-unsupported\",{symbol:z(e)}))}function ZP(){return new C(I(\"shared-calculator-error-gpu-integral-unsupported\"))}function XP(){return new C(I(\"shared-calculator-error-gpu-recursion-unsupported\"))}function WP(){return new C(I(\"shared-calculator-error-gpu-long-sum\",{maxTermCount:1e3.toLocaleString()}))}function jP(){return new C(I(\"shared-calculator-error-gpu-long-product\",{maxTermCount:1e3.toLocaleString()}))}function Bl(){return new C(I(\"shared-calculator-error-gpu-max-list-size\",{maxListSize:100 .toLocaleString()}))}function df(){return new C(I(\"shared-calculator-error-max-list-size\",{maxListSize:1e4.toLocaleString()})).allowExport()}function ff(){return new C(I(\"shared-calculator-error-two-numbers-error\"))}function JP(){return new C(I(\"shared-calculator-error-boxplot-offset-invalid\"))}function QP(){return new C(I(\"shared-calculator-error-boxplot-breadth-invalid\"))}function Kg(e,t){return new C(I(\"shared-calculator-error-too-many-arguments\",{symbol:e,max:t}))}function KP(){let e=I(\"shared-calculator-error-pdf-wrong-arity-recommendation\"),t=I(\"shared-calculator-error-pdf-wrong-arity\",{recommendation:e});return new C(t)}function eE(){let e=I(\"shared-calculator-error-cdf-wrong-arity-recommendation\"),t=I(\"shared-calculator-error-cdf-wrong-arity\",{recommendation:e});return new C(t)}function tE(){let e=I(\"shared-calculator-error-cdf-too-many-arguments-recommendation\"),t=I(\"shared-calculator-error-cdf-too-many-arguments\",{recommendation:e});return new C(t)}function M2(){return new C(I(\"shared-calculator-error-tdist-wrong-arity\"))}function nE(){return new C(I(\"shared-calculator-error-random-arity\"))}function rE(){return new C(I(\"shared-calculator-error-random-from-broadcast-distribution\"))}function sE(e){let t=e===\"rgb\"?[150,30,100]:[180,.5,.5],n=I(\"shared-calculator-error-color-arity-recommendation\",{recommendation:z(e)+\"(\"+t.join(\", \")+\")\"}),r=I(\"shared-calculator-error-color-arity\",{symbol:e,recommendation:n});return new C(r)}function Da(e,t,n,r){e=z(e);let s,o;if(t===1)o=r.includeUsageExample?I(\"shared-calculator-error-wrong-arity-supplement\",{recommendation:r.usageExample||e+\"(x)\"}):\"\",n>1?s=I(\"shared-calculator-error-wrong-arity-single-arg-too-many\",{dependency:e,supplement:o}):s=I(\"shared-calculator-error-wrong-arity-single-arg-too-few\",{dependency:e,supplement:o});else{let i=[],a=r.usageExample;if(!a){for(let u=0;u<t;u++)i[u]=u+1;a=z(e)+\"(\"+i.join(\", \")+\")\"}o=r.includeUsageExample?I(\"shared-calculator-error-wrong-arity-supplement\",{recommendation:a}):\"\",s=I(\"shared-calculator-error-wrong-arity-many-arg\",{dependency:e,assignment_arity:t,supplement:o})}return new C(s)}function oE(){let e=I(\"shared-calculator-error-wrong-arity-supplement\",{recommendation:\"length(x)\"}),t=I(\"shared-calculator-error-wrong-arity-single-arg-too-few\",{dependency:\"length\",supplement:e});return new C(t)}function iE(e){return new C(I(\"shared-calculator-error-wrong-two-arg-arity\",{symbol:z(e),recommendation:z(e)+\"([1,2,3], 1)\"}))}function yf(e){return new C(I(\"shared-calculator-error-wrong-two-arg-arity\",{symbol:z(e),recommendation:z(e)+\"([1,2,3], [3,2,1])\"}))}function Gl(){return new C(I(\"shared-calculator-error-primed-function-arity\"))}function aE(e){return new C(I(\"shared-calculator-error-zero-arg-reducer\",{symbol:z(e)}))}function uE(){return new C(I(\"shared-calculator-error-malformed-point\"))}function cE(){return new C(I(\"shared-calculator-error-malformed-list\"))}function lE(e){return new C(I(\"shared-calculator-error-bad-tuple-dimensions\",{symbol:e}))}function Ec(e){return new C(I(\"shared-calculator-error-3d-object-in-2d\",{type:oe(e)}))}function eh(e){return e=z(e),new C(I(\"shared-calculator-error-bad-implicit-call\",{symbol:e}))}function pE(e,t){return new C(I(\"shared-calculator-error-adjacent-numbers\",{left:e,right:t}))}function th(e){return new C(I(\"shared-calculator-error-adjacent-mixed-number\",{mixedNumber:e}))}function mE(){return new C(I(\"shared-calculator-error-token-with-subscript\"))}function nh(e){return e=z(e),new C(I(\"shared-calculator-error-identifier-as-function\",{symbol:e}))}function rh(e){return e=z(e),new C(I(\"shared-calculator-error-identifier-is-not-function\",{symbol:e}))}function Zp(e){return e=z(e),e===\"%\"&&(e=\"% of\"),new C(I(\"shared-calculator-error-binary-operator-missing-operand\",{symbol:e}))}function dE(e){return e=z(e),new C(I(\"shared-calculator-error-unary-operator-missing-left\",{symbol:e}))}function fE(e){return e=z(e),new C(I(\"shared-calculator-error-unary-operator-missing-right\",{symbol:e}))}function yE(){return new C(I(\"shared-calculator-error-fraction-missing-numerator\"))}function gE(){return new C(I(\"shared-calculator-error-fraction-missing-denominator\"))}function hE(){return new C(I(\"shared-calculator-error-fraction-empty\"))}function sh(){return new C(I(\"shared-calculator-error-empty-subscript\"))}function bE(){return new C(I(\"shared-calculator-error-empty-superscript\"))}function xE(e){return e=z(e),new C(I(\"shared-calculator-error-invalid-subscript\",{symbol:e}))}function TE(){return new C(I(\"shared-calculator-error-invalid-operator-name\"))}function IE(){return new C(I(\"shared-calculator-error-unexpected-subscript\"))}function PE(){return new C(I(\"shared-calculator-error-superscript-with-prime\"))}function oh(){return new C(I(\"shared-calculator-error-unexpected-prime\"))}function ih(){return new C(I(\"shared-calculator-error-prime-without-paren\"))}function EE(){return new C(I(\"shared-calculator-error-empty-radical\"))}function SE(){return new C(I(\"shared-calculator-error-empty-radical-index\"))}function gf(){return new C(I(\"shared-calculator-error-empty-paren\"))}function ME(){return new C(I(\"shared-calculator-error-empty-square-bracket\"))}function CE(){return new C(I(\"shared-calculator-error-empty-pipe\"))}function vE(e){let t=e+\"^2\",n=e+\"^-1\";return new C(I(\"shared-calculator-error-bad-trig-exponent\",{form1:t,form2:n}))}function DE(e){let t=e+\"^2\";return new C(I(\"shared-calculator-error-bad-log-exponent\",{form:t}))}function NE(){return new C(I(\"shared-calculator-error-piecewise-missing-condition\"))}function RE(){return new C(I(\"shared-calculator-error-piecewise-part-missing-condition\"))}function OE(){return new C(I(\"shared-calculator-error-colon-missing-condition\"))}function hf(){let e=new C(I(\"shared-calculator-error-blank-expression\"));return e.silent=!0,e}function ah(e){return e=z(e),new C(I(\"shared-calculator-error-function-not-defined\",{dependency:e}))}function uh(e){return e=z(e),new C(I(\"shared-calculator-error-parameter-already-defined\",{dependency:e}))}function AE(e){return e=z(e),new C(I(\"shared-calculator-error-duplicate-function-parameter\",{dependency:e}))}function _E(e){return e=z(e),new C(I(\"shared-calculator-error-function-name-as-parameter\",{dependency:e}))}function Xp(e,t){return e=z(e),t===void 0?new C(I(\"shared-calculator-error-cannot-redefine\",{symbol:e})):new C(I(\"shared-calculator-error-cannot-redefine-root\",{symbol:e,symbolRoot:t}))}function wE(e){return e=z(e),new C(I(\"shared-calculator-error-cannot-subscript\",{symbol:e}))}function bf(e){return e=z(e),new C(I(\"shared-calculator-error-multiply-defined\",{dependency:e}))}function ch(e){return e=z(e),new C(I(\"shared-calculator-error-shadowed-index\",{symbol:e}))}function LE(e){e=e.map(z);let t=e.pop()||\"\",n=new C(I(\"shared-calculator-error-dependency-cycle\",{symbols:e.join(\"', '\"),lastSymbol:t}));return n.isCyclicDependencyError=!0,n}function Hl(e,t){let n=e.length,r=e[0];return t.suggestAlternativeFunctionName&&n==1?new C(I(\"shared-calculator-error-self-referential-suggest-alternative\",{symbol:z(r)})):new C(I(\"shared-calculator-error-self-referential-functions\",{symbols:e.slice(1).map(s=>z(s)).join(\"', '\"),lastSymbol:z(r),count:tf(n)}))}function FE(e){return new C(I(\"shared-calculator-error-self-referential-base-case\",{symbol:z(e)}))}function VE(){return new C(I(\"shared-calculator-error-ticker-min-step-nonnegative\"))}function BE(e){return new kp(I(\"shared-calculator-error-slider-limit-references-export\",{symbol:z(e)}))}function GE(){return new C(I(\"shared-calculator-error-slider-min-invalid\"))}function HE(){return new C(I(\"shared-calculator-error-slider-max-invalid\"))}function qE(){return new C(I(\"shared-calculator-error-slider-max-less-than-min\"))}function UE(){return new C(I(\"shared-calculator-error-slider-step-invalid\"))}function zE(){return new C(I(\"shared-calculator-error-domain-min-invalid\"))}function kE(){return new C(I(\"shared-calculator-error-domain-max-invalid\"))}function $E(){return new C(I(\"shared-calculator-error-domain-max-less-than-min\"))}function YE(){return new C(I(\"shared-calculator-error-cdf-min-invalid\"))}function ZE(){return new C(I(\"shared-calculator-error-cdf-max-invalid\"))}function C2(){return new C(I(\"shared-calculator-error-cdf-max-less-than-min\"))}function XE(){return new C(I(\"shared-calculator-error-use-rho-for-spherical-coordinates\"))}function WE(){return new C(I(\"shared-calculator-error-use-r-for-cylindrical-coordinates\"))}function lh(){return new C(I(\"shared-calculator-error-cant-combine-spherical-and-cylindrical\"))}function mn(e){if(e=e.map(z),e.length===0)return new C(I(\"shared-calculator-error-too-many-variables-no-symbols\"));let t=e.pop()||\"\";return e.length>0?new C(I(\"shared-calculator-error-too-many-variables-many-symbols\",{variables:e.join(\"', '\"),lastVariable:t})):new C(I(\"shared-calculator-error-too-many-variables-one-symbol\",{variable:t}))}function jE(e){return new C(I(\"shared-calculator-error-cannot-restrict\",{variable:z(e)}))}function JE(){return new C(I(\"shared-calculator-error-cannot-restrict-triangles-with-list\"))}function QE(e){return new C(I(\"shared-calculator-error-cannot-assign-color\",{variable:z(e)}))}function KE(e){return new C(I(\"shared-calculator-error-cannot-restrict-with-equality\",{variable:z(e)}))}function xf(e,t,n){e=e.map(z),t=z(t),n=n.map(z);let r=t+\"(\"+n.join(\",\")+\",\"+e.join(\",\")+\")\",s=e.pop()||\"\",o={symbols:e.join(\"', '\"),lastSymbol:s,newSignature:r};return e.length?new C(I(\"shared-calculator-error-add-arguments-to-definition-many\",o)):new C(I(\"shared-calculator-error-add-arguments-to-definition-one\",o))}function eS(e){return e=z(e),new C(I(\"shared-calculator-error-invalid-lhs\",{symbol:e}))}function tS(){return new C(I(\"shared-calculator-error-unplottable-polar-function\"))}function nS(){return new C(I(\"shared-calculator-error-invalid-inequality-variables\"))}function ql(){return new C(I(\"shared-calculator-error-invalid-implicit-variables\"))}function rS(){return new C(I(\"shared-calculator-error-invalid-implicit-variables-3d\"))}function sS(){return new C(I(\"shared-calculator-error-single-variable-implicit-equations-disabled\"))}function oS(){return new C(I(\"shared-calculator-error-implicits-disabled\"))}function Wp(e){let t=new C(e===\"=\"?I(\"graphing-calculator-error-nan-blame-complex-coercion\"):I(\"shared-calculator-error-complex-operation-undefined\",{symbol:z(e)}));return t.warning=t.getError(),t.silent=!0,t}function v2(){return new C(I(\"shared-calculator-error-complex-table-point-coordinate\"))}function ph(){return new C(I(\"shared-calculator-error-inequalities-disabled\"))}function iS(){return new C(I(\"shared-calculator-error-complicated-polar-implicit\"))}function aS(){return new C(I(\"shared-calculator-error-invalid-double-inequality-3d\"))}function uS(){return new C(I(\"shared-calculator-error-invalid-double-equality-3d\"))}function cS(){return new C(I(\"shared-calculator-error-unplottable-chained-equality\"))}function mh(){return new C(I(\"shared-calculator-error-invalid-double-inequality-variables\"))}function dh(){return new C(I(\"shared-calculator-error-mismatched-double-inequality\",{example:\"1 < y < 2\"}))}function fh(){return new C(I(\"shared-calculator-error-complicated-double-inequality\"))}function yh(e){return e?(e=z(e),new C(I(\"shared-calculator-error-equation-required-symbol\",{lhs:e+\"=\"}))):new C(I(\"shared-calculator-error-equation-required\"))}function gh(e){return e=z(e),new C(I(\"shared-calculator-error-variable-as-function\",{dependency:e}))}function hh(e){return e=z(e),new C(I(\"shared-calculator-error-distribution-as-function\",{symbol:e}))}function lS(e){return new C(I(\"shared-calculator-error-invalid-table-header\",{supplement:e}))}function Tf(e){return new C(I(\"shared-calculator-error-invalid-table-entry\",{supplement:e}))}function pS(){return new C(I(\"shared-calculator-error-invalid-first-table-column\",{most:\"'y', 'r',\",last:\"'\\u03B8'\"}))}function D2(){return new C(I(\"shared-calculator-error-invalid-dependent-first-table-column\"))}function mS(e){return new C(I(\"shared-calculator-error-invalid-regression-parameter\",{symbol:z(e)}))}function dS(){return new C(I(\"shared-calculator-error-optimization-error\"))}function If(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-non-list-double-reducer\",{symbol:z(e),recommendation:z(e)+\"([1,2,3], [3,2,1])\"}));return t||n.allowExport(),n}function fS(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-non-list-parameterized-reducer\",{symbol:z(e),recommendation:z(e)+\"([1,2,3], 1)\"}));return t||n.allowExport(),n}function hu(e,{blockExport:t}){let n=new C(I(\"shared-calculator-error-method-requires-list\",{symbol:z(e),recommendation:z(e)+\"([1,2,3])\"}));return t||n.allowExport(),n}function Pf(){return new C(I(\"shared-calculator-error-non-arithmetic-range\")).allowExport()}function yS(){return new C(I(\"shared-calculator-error-invalid-half-empty-range\"))}function gS(){return new C(I(\"shared-calculator-error-sum-missing-bound\"))}function hS(){return new C(I(\"shared-calculator-error-product-missing-bound\"))}function bS(){return new C(I(\"shared-calculator-error-incorrect-sum-lower-bound\"))}function xS(){return new C(I(\"shared-calculator-error-incorrect-product-lower-bound\"))}function TS(e){return new C(I(\"shared-calculator-error-bad-sum-bound-dependency\",{symbol:z(e)}))}function IS(e){return new C(I(\"shared-calculator-error-bad-product-bound-dependency\",{symbol:z(e)}))}function PS(){return new C(I(\"shared-calculator-error-integral-missing-bound\"))}function ES(){return new C(I(\"shared-calculator-error-integral-missing-differential\"))}function SS(){return new C(I(\"shared-calculator-error-differential-with-superscript\"))}function MS(){return new C(I(\"shared-calculator-error-sum-missing-body\"))}function CS(){return new C(I(\"shared-calculator-error-product-missing-body\"))}function vS(){return new C(I(\"shared-calculator-error-integral-missing-body\"))}function DS(){return new C(I(\"shared-calculator-error-derivative-missing-body\"))}function NS(e,t){return e=z(e),t=z(t),new C(I(\"shared-calculator-error-mismatched-braces\",{symbol1:e,symbol2:t}))}function bh(e){return new C(I(\"shared-calculator-error-shadowed-integration-variable\",{symbol:z(e)}))}function RS(e){return new C(I(\"shared-calculator-error-bad-integral-bound-dependency\",{symbol:z(e)}))}function OS(){return new C(I(\"shared-calculator-error-percent-missing-of\"))}function Ef(e){return e=z(e),new C(I(\"shared-calculator-error-illegal-bin-width\",{symbol:e}))}function jp(e){return e=z(e),new C(I(\"shared-calculator-error-ttest-list-too-short\",{symbol:e}))}function AS(){return new C(I(\"shared-calculator-error-bad-sample-size\"))}function _S(e){return new C(I(\"shared-calculator-error-variable-seed\",{symbol:z(e[0].symbol)})).setDependencies(e.filter(t=>t.scope===\"free\").map(t=>t.symbol)).allowExport()}function Sf(e){return new C(I(\"shared-calculator-error-bad-symbol-context\",{symbol:z(e)}))}function xh(){return new C(I(\"shared-calculator-error-write-integral\",{command:\"integral\",symbol:\"\\u222B\"}))}function wS(){return new C(I(\"shared-calculator-error-ans-undefined\"))}function LS(e){return new C(I(\"shared-calculator-error-variables-unsupported\",{variable:z(e)}))}function Th(){return new C(I(\"shared-calculator-error-polygon-unsupported-in-3d\"))}function HR(e){return new C(I(\"shared-calculator-error-function-only-works-in-complex\",{symbol:z(e)}))}function Na(e,t){return t!=null&&t.is3dPolicy()&&e===\"polygon\"?Th():!!t&&!(t!=null&&t.isGeometryEnabled())&&!(t instanceof wl)&&!t.isComplexEnabled()&&GR.indexOf(e)!==-1?HR(e):new C(I(\"shared-calculator-error-function-unsupported\",{symbol:z(e)}))}function FS(){return new C(I(\"shared-calculator-error-logbase-unsupported\"))}function Mf(e){return new C(I(\"shared-calculator-error-constant-unsupported\",{symbol:z(e)}))}function Ih(e){return new C(I(\"shared-calculator-error-variable-unsupported\",{symbol:z(e)}))}function Ph(e){return new C(I(\"shared-calculator-error-variable-invalid-function-name\",{symbol:z(e)}))}function VS(){return new C(I(\"shared-calculator-error-assignments-unsupported\"))}function BS(){return new C(I(\"shared-calculator-error-function-definition-unsupported\"))}function Cf(){return new C(I(\"shared-calculator-error-equations-unsupported\"))}function GS(){return new C(I(\"shared-calculator-error-inequalities-unsupported\"))}function HS(){return new C(I(\"shared-calculator-error-regressions-unsupported\"))}function qS(){return new C(I(\"shared-calculator-error-custom-regressions-unsupported\"))}function US(){return new C(I(\"shared-calculator-error-points-unsupported\"))}function vf(){return new C(I(\"shared-calculator-error-feature-unavailable\"))}function Eh(){return new C(I(\"basic-calculator-error-fractions-unavailable\"))}function zS(){return new C(I(\"basic-calculator-error-parentheses-unavailable\"))}function N2(){return new C(I(\"shared-calculator-error-non-square-determinant\"))}function R2(){return new C(I(\"shared-calculator-error-non-square-trace\"))}function O2(){return new C(I(\"shared-calculator-error-non-square-inverse\"))}function A2(){return new C(I(\"shared-calculator-error-non-singular-inverse\"))}function _2(e){return new C(I(\"shared-calculator-error-clickable-object-assignment-not-defined\",{symbol:e}))}function w2(e){return new C(I(\"shared-calculator-error-multiply-defined\",{dependency:e}))}function L2(){return new C(I(\"shared-calculator-error-clickable-object-assignment-not-identifier\"))}function F2(){return new C(I(\"shared-calculator-error-clickable-object-invalid-expression\"))}function V2(){return new C(I(\"shared-calculator-error-matrix-assignment\"))}function B2(){return new C(I(\"shared-calculator-error-matrix-add-dimensions\"))}function G2(){return new C(I(\"shared-calculator-error-matrix-subtract-dimensions\"))}function H2(){return new C(I(\"shared-calculator-error-matrix-multiply-dimensions\"))}function q2(){return new C(I(\"shared-calculator-error-matrix-fractional-power\"))}function U2(){return new C(I(\"shared-calculator-error-matrix-power-dimensions\"))}function z2(e){return new C(I(\"shared-calculator-error-matrix-element-type-error\",{arg:e[0]}))}function k2(e){return new C(I(\"shared-calculator-error-matrix-invalid-variable\",{symbol:z(e)}))}function kS(e,t,n,{blockExport:r}){let s=\"[1...10]\";n&&!/[\\\\]/.test(n)&&(s=`[${n}]`);let o=new C(I(\"shared-calculator-error-list-comprehension-input-type-error\",{identifier:e,actual:t,example:s}));return r||o.allowExport(),o}function $S(){return new C(I(\"shared-calculator-error-incorrect-list-comprehension-input\"))}function Sh(e){return e=z(e),new C(I(\"shared-calculator-error-shadowed-list-comprehension-input\",{symbol:e}))}function YS(e){return e=z(e),new C(I(\"shared-calculator-error-bad-for-input-list-dependency\",{symbol:e}))}function ZS(e){return e=z(e),new C(I(\"shared-calculator-error-bad-for-interval-dependency\",{symbol:e}))}function XS(e){let t=e.filter(n=>n.scope===\"free\").map(n=>n.symbol);return new C(I(\"shared-calculator-error-variable-length-top-level-list\",{symbol:z(t[0]||\"\")})).setDependencies(t).allowExport()}function Df(e){return new C(I(\"shared-calculator-error-variable-length-distribution-list\",{symbol:e[0].symbol})).setDependencies(e.filter(t=>t.scope===\"free\").map(t=>t.symbol))}function WS(e){return new C(I(\"shared-calculator-error-variable-length-sum-body-depends-on-index\",{symbol:e}))}function jS(e){return new C(I(\"shared-calculator-error-variable-length-product-body-depends-on-index\",{symbol:e}))}function JS(e){return new C(I(\"shared-calculator-error-variable-length-integral-depends-on-integration-var\",{symbol:e}))}function $2(e,t){return new C(I(\"shared-calculator-error-substitution-type-error\",{actual:oe(e),expected:oe(t)}))}function Nf(){return new C(I(\"shared-calculator-error-substitution-invalid-assignments\"))}function QS(e){return new C(I(\"shared-calculator-error-substitution-local-lhs\",{symbol:z(e)}))}function Rf(e){return new C(I(\"shared-calculator-error-substitution-illegal-lhs\",{symbol:z(e)}))}function Of(e){return new C(I(\"shared-calculator-error-substitution-function-lhs\",{symbol:z(e)}))}function KS(e,t,n){return new C(I(\"shared-calculator-error-substitution-body-regression-parameter-dependency\",{globalVariable:z(e),regressionParameter:z(t),operator:n}))}function Y2(){return new C(I(\"shared-calculator-error-substitution-body-action\"))}function Mh(){return new C(I(\"shared-calculator-error-substitution-nested\"))}function Sc(e){return new C(I(\"shared-calculator-error-substitution-ambiguous-comma\",{operation:e}))}function e0(e){return new C(I(\"shared-calculator-error-substitution-duplicate-assignment\",{symbol:z(e)}))}function t0(e,t,n){return new C(I(\"shared-calculator-error-substitution-recursive-call-lhs\",{operator:e,globalVariable:z(t),fnSymbol:z(n)}))}function n0(){return new C(I(\"shared-calculator-error-depends-on-deleted-geo-object\"))}function r0(e){return new C(I(\"shared-calculator-error-invalid-interval-comprehension-return-type\",{type:oe(e)}))}function s0(e,t){return new C(I(\"shared-calculator-error-bad-interval-comprehension-arity\",{type:oe(e),count:tf(t)}))}function Jp(e){return new C(I(\"shared-calculator-error-invalid-interval-comprehension-invalid-bound\",{identifier:e}))}function o0(){return new C(I(\"shared-calculator-error-nested-interval-comprehension\"))}function Ch(){return new C(I(\"shared-calculator-error-substitution-unsupported-interval\"))}function i0(e){return new C(I(\"shared-calculator-error-table-regression-invalid-export-identifier\",{latex:\"`\"+e+\"`\"}))}function a0(e){return new C(e.length===1?I(\"graphing-calculator-error-table-regression-unexportable-reserved-variable-single\",{variable:\"`\"+e[0]+\"`\"}):I(\"graphing-calculator-error-table-regression-unexportable-reserved-variables-many\"))}function he(e){return Object.keys(e)}function qR(e,t){return`dcg_import_${e}__${t}`}var mr=\"**dcg_global_module_id**\";function qn(e,t){return{frameID:e,symbol:t}}function Af(e,t){let n=[];for(let r of t)n.push({frameID:e,symbol:r});return n}function u0(e,t){let n=[];for(let r of t)n.push({frameID:e,symbol:r});return n}var Ul=class e{constructor(t){this.map=new Map;if(t)for(let[n,r]of t)this.set(n,r)}getOrCreateEntry(t){let n=this.map.get(t);if(n)return n;let r=new Map;return this.map.set(t,r),r}set(t,n){this.getOrCreateEntry(t.frameID).set(t.symbol,n)}get(t){var n;return(n=this.map.get(t.frameID))==null?void 0:n.get(t.symbol)}getOrInsert(t,n){let r=this.get(t);return r!==void 0?r:(this.set(t,n),n)}delete(t){var n;(n=this.map.get(t.frameID))==null||n.delete(t.symbol)}*[Symbol.iterator](){for(let[t,n]of this.map)for(let[r,s]of n)yield[qn(t,r),s]}*keys(){for(let[t,n]of this.map)for(let r of n.keys())yield qn(t,r)}mapForFrame(t){return this.map.get(t)}toJSONForTests(){let t={},n=fI([...this].map(([{symbol:r,frameID:s},o])=>[s+\"::\"+r,o]),([r,s])=>r);for(let[r,s]of n)t[r]=s;return t}static fromJSONForTests(t){let n=new e;for(let r of he(t))for(let s of he(t[r]))n.set(qn(r,s),t[r][s]);return n}},Ts=class e{constructor(t){this.map=new Ul;if(t)for(let n of t)this.add(n)}add(t){this.map.set(t,!0)}delete(t){this.map.delete(t)}has(t){return!!this.map.get(t)}[Symbol.iterator](){return this.map.keys()}mapForFrame(t){return this.map.mapForFrame(t)}toJSONForTests(){return fI([...this].map(({symbol:t,frameID:n})=>n+\"::\"+t),t=>t)}static fromJSONForTests(t){let n=new e;for(let r of he(t))for(let s of t[r])n.add(qn(r,s));return n}};function On(e){return Object.create(e)}var UR=Symbol(\"DEPENDENCY_ORDER\");function zR(e){let t=e[UR];if(!t)throw V(\"Missing dependency order.\");return t}function kR(e,t){e[UR]=t}var $R=Symbol(\"FRAME_CONTEXT\");function YR(e){let t=e[$R];if(!t)throw V(\"Missing frame context.\");return t}function ZR(e,t){e[$R]=t}var Z2=Symbol(\"FRAME_ID\");function XR(e,t){e[Z2]=t}var X6=e=>{switch(e){case $t:return Mn.PROPORTION;case Yt:return Mn.DIFFERENCE_OF_PROPORTIONS;case St:return Mn.MEAN_T_INFERENCE;case Ht:return Mn.MEAN_Z_INFERENCE;case Ut:return Mn.MEAN_T_INFERENCE;case qt:return Mn.DIFFERENCE_OF_MEANS_Z_INFERENCE;case Mt:return Mn.DIFFERENCE_OF_MEANS_T_INFERENCE;default:throw new Error(`Unexpected type ${e}`)}};function c0(e){return $(e.valueType)}function WR(e,t){if(c0(e)&&e.valueType!==Ae)return{valueType:Xe(e.valueType),value:e.value[t]};throw new Error(\"Programming Error: expected a list type but found \"+oe(e.valueType))}var l0=[Re,nn,b,O,N,F,Jt,Fe,Kn,Mr,it,pn,Se,Ie,pe,ae,Pe,De,ye,ve,Te,Ne,Qn,Et,Ot,St,Mt,Ut,Ht,qt,$t,Yt],X2=new Set(l0),_f=cr.of(l0.filter(e=>Hn(e))),wf=cr.of(l0.filter(e=>!Hn(e)));function Yi(e){return X2.has(e)}function jR(e){return Yi(e)}function Is(e){return QR(e,NaN).value}function JR(e){return QR(e,0).value}function QR(e,t){switch(e){case b:return{valueType:e,value:t};case Jt:case Fe:return{valueType:e,value:[[t,t,t],[t,t,t]]};case Kn:return{valueType:e,value:[[t,t,t],[t,t,t],[t,t,t]]};case Mr:return{valueType:e,value:[[t,t,t],t]};case pn:return{valueType:e,value:[t,t,t]};case it:return{valueType:e,value:{type:\"Action\",updateRules:{}}};case Ie:case De:case Pe:return{valueType:e,value:[[t,t],[t,t]]};case ye:return{valueType:e,value:[[t,t],[t,t]]};case pe:return{valueType:e,value:[[t,t],t]};case ae:return{valueType:e,value:[[t,t],[t,t],[t,t]]};case Re:case nn:return{valueType:e,value:!1};case Se:return{valueType:e,value:[]};case Ne:return{valueType:e,value:[[t,t],[t,t],!1]};case ve:case Te:return{valueType:e,value:[[t,t],t,t,t]};case Qn:return{valueType:e,value:[t,t]};case Et:return{valueType:e,value:[t,t,Mn.MEAN_T_INFERENCE]};case Ot:return{valueType:e,value:[t,t,t,Mn.MEAN_T_INFERENCE,t,t,t]};default:if(tI(e))return nI(e,t);throw new Error(`${e} does not have a ${t===0?\"zero\":\"NaN\"} type.`)}}function KR(e,t){return _s(Is(e),t)}function Qp(e,t){return{n:e,d:t}}function gn(e){return typeof e==\"object\"&&typeof e.n==\"number\"&&typeof e.d==\"number\"}var Lf=Math.pow(2,53)-1;function kl(e){let t=e.match(/^(-)?(\\d*)?(?:\\.(\\d*))?$/);if(!t)return NaN;let n=t[1],r=t[2],s=t[3];if(!r&&!s)return NaN;let o=!!n;if(s){let i=s.replace(/0+$/,\"\"),a=i.length,u=Math.pow(10,a),c=parseInt(r||\"0\",10)*u+parseInt(i||\"0\",10);return c>Lf||u>Lf?parseFloat(e):be(o?-c:c,u)}else{let i=parseInt(r,10);return i>Lf?parseFloat(e):be(o?-i:i,1)}}function w(e){return gn(e)?e.n/e.d:+e}function Ao(e){return gn(e)?!1:isNaN(e)}function be(e,t){if(!isFinite(e)||!isFinite(t)||t===0||Math.floor(e)!==e||Math.floor(t)!==t||Math.abs(e)>Lf||Math.abs(t)>Lf)return e/t;t<0&&(e=-e,t=-t);let n=Ol(e,t);return Qp(e/n,t/n)}function mo(e){return gn(e)?Qp(-e.n,e.d):-e}function e1(e){return gn(e)?Qp(Math.abs(e.n),Math.abs(e.d)):Math.abs(e)}function t1(e){return gn(e)?e.n===0?e.d/e.n:Qp(e.n<0?-e.d:e.d,Math.abs(e.n)):1/e}function fo(e,t){if(!gn(e)||!gn(t))return w(e)+w(t);let n=Ol(e.d,t.d);return be(e.n*(t.d/n)+t.n*(e.d/n),e.d/n*t.d)}function wr(e,t){if(!gn(e)||!gn(t))return w(e)*w(t);let n=Ol(e.n,t.d),r=Ol(t.n,e.d);return be(e.n/n*(t.n/r),e.d/r*(t.d/n))}function _o(e,t){return fo(e,mo(t))}function Vs(e,t){return!gn(e)||!gn(t)?w(e)/w(t):wr(e,t1(t))}function j2(e,t){let n=e,r=t;if(t.n<0&&(r=mo(t),n=t1(e)),!gn(n)||!gn(r))return Al(w(e),w(t));if(e=n,t=r,t.d===1)return be(Math.pow(e.n,t.n),Math.pow(e.d,t.n));let s=e.n<0;if(s&&t.d%2!==1)return NaN;let i=(s?-1:1)*Math.round(Math.pow(Math.abs(e.n),1/t.d)),a=Math.round(Math.pow(Math.abs(e.d),1/t.d));return Math.pow(i,t.d)!==e.n||Math.pow(a,t.d)!==e.d?Al(w(e),w(t)):be(Math.pow(i,t.n),Math.pow(a,t.n))}function n1(e,t){if(!gn(e)||!gn(t))return Al(w(e),w(t));let n=j2(e,t);return gn(n)?n:Al(w(e),w(t))}function r1(e){if(!gn(e))return Math.sqrt(e);let t=Math.round(Math.sqrt(e.n)),n=Math.round(Math.sqrt(e.d));return t*t!==e.n||n*n!==e.d?Math.sqrt(w(e)):be(t,n)}function s1(e,t){if(!gn(e)||!gn(t)){let r=w(e),s=w(t);zl(r,s)}let n=_o(e,wr(t,Qp(Math.floor(w(Vs(e,t))),1)));return gn(n)?n:zl(w(e),w(t))}function o1(e){let t=Qp(0,1);for(let n of e)t=fo(t,n);return t}var h1={spy:oR},{cosh:am,sinh:jl,tanh:v0,acosh:b1,asinh:x1,atanh:T1,expm1:J2,log1p:um,sign:D0,hypot:Bs}=Math,Q2=$u,Ah=Ol,K2=Al,I1=Symbol(\"DIVERGES\"),P1=(n=>(n[n.SUCCESS=0]=\"SUCCESS\",n[n.MISSING_CACHE_ENTRY=1]=\"MISSING_CACHE_ENTRY\",n))(P1||{}),zh=class zh{constructor(t=zh.defaultLimit,n){this.limit=t;this.computeSize=n;this.currentSize=0;this.cache=new Map}get(t){let n=this.cache.get(t);return n&&(this.cache.delete(t),this.cache.set(t,n)),n==null?void 0:n.value}set(t,n){let r=this.computeSize?this.computeSize(n):1;if(this.currentSize+r>=this.limit){let s=this.cache.keys().next().value;s&&this.cache.delete(s)}this.cache.set(t,{size:r,value:n})}};zh.defaultLimit=1e5;var rm=zh,Hf=1e4,E1=Hf*2;function eH(){return Hf}function N0(e){Hf=e}var S1=(n=>(n[n.DoesNotTerminate=0]=\"DoesNotTerminate\",n[n.DepthLimitExceeded=1]=\"DepthLimitExceeded\",n))(S1||{});function M1(e,t){if(Yi(t))return e.recursionTerminationStatus=0,Is(t);throw qI()}function C1(e,t){if(Yi(t))return e.recursionTerminationStatus=1,Is(t);throw UI()}var i1=new WeakMap;function tH(e){let t=i1.get(e);return t||(t=new Set(e),i1.set(e,t)),t}function y0(e){return`${e.fn}:${JSON.stringify(e.args)}`}function nH(e,t){return{status:0,result:[e,t]}}function rH(e){return{status:1,stackFrame:e}}function sH(e,t,n,r){let s=e.recursiveFunctionCache||new rm,o=[];o.push(r);let i=0;for(;o.length>0;){if(o.length>Hf||i++>E1)return C1(e,n);let a=o.pop(),{fn:u,args:c}=a,p=t[u](s,...c);if(p===I1)return M1(e,n);if((p==null?void 0:p.status)===1)o.push({fn:u,args:c}),o.push(p.stackFrame);else{let l=y0(a);s.set(l,p.result)}}return s.get(y0(r))[0]}var oH=function(e){let t=e*e;return 1+t===1?1:1+t===t?Math.abs(e):Math.sqrt(t+1)},iH=function(e){let t=e*e;return t<1?NaN:t-1===t?Math.abs(e):Math.sqrt(t-1)};function tr(e,t,n){return Math.max(t,Math.min(n,e))}function zl(e,t){let n=e%t;return e*t<0&&n!==0?n+t:n}function g0(e,t){if(e=Math.round(e),t=Math.round(t),!isFinite(e)||!isFinite(t))return NaN;if(e===0&&t===0)return 0;let n=Ah(e,t);return Math.abs(e/n*t)}function aH(e){if(e.length===0)return NaN;if(e.length===1)return Ah(e[0],0);let t=e[0];for(let n=1;n<e.length;n++)t=Ah(t,e[n]);return t}function uH(e){if(e.length===0)return NaN;if(e.length===1)return g0(e[0],1);let t=e[0];for(let n=1;n<e.length;n++)t=g0(t,e[n]);return t}function cH(e){if(e.length===0)return[NaN,NaN];if(e.length===1)return M0(e[0],[0,0]);let t=e[0];for(let n=1;n<e.length;n++)t=M0(t,e[n]);return t}function lH(e){if(e.length===0)return[NaN,NaN];if(e.length===1)return C0(e[0],[1,0]);let t=e[0];for(let n=1;n<e.length;n++)t=C0(t,e[n]);return t}function Mc(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0||e===t)return 1;if(e===0)return Ci(t);let n=isFinite(e)&&e===Math.round(e),r=isFinite(t)&&t===Math.round(t);if(e<0&&t<0&&e-t<0)return n&&r?0:Ci(e-t)*Ci(t)/(Ci(e)*Mc(-e,-t));if(e<0&&t>0&&e-t<0)return n&&r?Math.pow(-1,t)*Mc(t-e-1,t):Ci(e-t)/Ci(e)*Mc(-(e-t),t);if(e<0&&t<0&&e-t>0)return n&&r?Math.pow(-1,e-t)*Mc(-t-1,e-t):Ci(t)/Ci(e)*Mc(-t,-e);if(e>0&&t<0&&e-t>0){let a=Math.abs(e)>Math.abs(t)?-t:e;return Ci(t)/Mc(e-t,a)}if(e>0&&t>0&&e-t<0)return Ci(e-t)/Mc(t,e);if(e<0||t<0||e-t<0)return _h(e,t)/Ju(t);let s=yo(e)-yo(t)-yo(e-t)-(e-t)*um(-t/e),o=Math.sqrt((e+1/6)/(2*Math.PI*(t+1/6)*(e-t+1/6)))*Math.pow(e/t,t)*Math.exp(s);return n&&r&&e>0&&t>0&&e-t>0?Math.round(o):o}function _h(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0)return 1;if(e===0)return 1/Ju(-t);if(e===t)return Ju(e);let n=isFinite(e)&&e===Math.round(e),r=isFinite(t)&&t===Math.round(t);if(e<0&&e-t<0)return n&&r?Math.pow(-1,t)*_h(t-e-1,t):Ci(e-t)/Ci(e)*_h(-(e-t),t);if(e<0||e-t<0)return Ju(e)/Ju(e-t);let s=yo(e)-yo(e-t)-(e-t)*um(-t/e),o=Math.sqrt((e+1/6)/(e-t+1/6))*v1(e,t)*Math.exp(s);return n&&r&&e>0&&t>0&&e-t>0?Math.round(o):o}function Ju(e){if(e===-1/0)return NaN;let t=Number.isInteger(e);if(t&&e<0)return 1/0;let n=Math.abs(e),r=Math.sqrt(2*Math.PI*(n+1/6))*v1(n,n)*Math.exp(yo(n));return e<0?1/(Ci(e)*r):t?Math.round(r):r}function a1(e){let t=(e-1)/2,n=.003986126881698112,r=.018251909205311435,s=.029941517126885264,o=.02189053314125264,i=.006189087779028262,a=5073115018776601e-24,u=7.482475354254652,c=23.07580194442752,p=37.71198466711076,l=34.64514153026584,m=17.084767168000226,d=3.5649457718715754,y=n+t*(r+t*(s+t*(o+t*(i+t*a)))),g=1+t*(u+t*(c+t*(p+t*(l+t*(m+t*d)))));return y/g}var pH=Math.pow(2,27)+1;function mH(e){let t=pH*e;return t-(t-e)}var p0=.3678794428706169,m0=-16991745912462731e-25;function v1(e,t){if(!isFinite(e)||!isFinite(t)||Math.abs(t)>2**26)return Math.pow(e/Math.E,t);let n=mH(e),r=e-n,s=e*(p0+m0);if(s===0)return Math.pow(e/Math.E,t);let o=n*p0-s+n*m0+r*p0+r*m0;return Math.pow(s,t)*(1+t*(o/s))}var D1=[1/6,-1/30,1/42,-1/30,5/66,-691/2730,7/6,-3617/510,43867/798,-174611/330,854513/138,-236364091/2730,8553103/6,-23749461029/870];function N1(e,t){if(e!==Math.floor(e))return NaN;if(e<0)return NaN;if(e===0)return 1/R0(t);let n=Cn(t);if(e===1)return-1/(n*n);let r=Fn(t);if(e===2)return 2*r/(n*n*n);let s=[0,2],o=[];for(let a=3;a<=e;a++){o=[];for(let u=0;u<a;u++){let c=0,p=0;u>0&&(c=(a-u+1)*s[u-1]),u+2<a&&(p=(u+1)*s[u+1]),o.push(-(c+p))}s=o}let i=0;for(let a=e-1;a>=0;a--)i=o[a]+r*i;return i/Math.pow(n,e+1)}function R1(e,t){if(e<0)return NaN;if(e!==Math.floor(e))return NaN;let n=e%2===0?-1:1;if(t<0)return-n*R1(e,1-t)-Math.pow(Math.PI,e+1)*N1(e,Math.PI*t);let r=Ju(e),s=0,o=Math.pow(t,-(e+1));for(;t<10;)s+=o,t++,o=Math.pow(t,-(e+1));s+=e===0?-Math.log(t):o*t/e,s+=.5*o;let i=D1,a=e+1,u=2,c=o*t*a/u,p=1/(t*t);for(let l=1;l<=14;l++)c*=p,s+=c*i[l-1],a++,u++,c*=a/u,a++,u++,c*=a/u;return r*n*s}function dH(e){let t=Math.log(e);return Math.exp(Math.round(t))===e?Math.round(t):t}function wh(e,t){if(t===0)return NaN;let n;return t===Math.E?n=Math.log(e):t===2&&Math.log2?n=Math.log2(e):t===10&&Math.log10?n=Math.log10(e):n=Math.log(e)/Math.log(t),Math.pow(t,Math.round(n))===e?Math.round(n):n}function fH(e){return wh(e,10)}function O1(e,t){let[n,r]=e,[s,o]=t;return o===0&&s===0?[NaN,NaN]:n===0&&r===0?[-1/0,0]:o===0&&r===0&&s>0?n>0?Zt(wh(n,s),0):Zt(wh(-n,s),Math.PI/Math.log(s)):Rc(P0(e),P0(t))}function yH(e){return O1(e,[10,0])}var A1=1/Math.PI;function kh(e){return e>1e12?!1:Math.round(A1*e)*Math.PI===e}function $h(e){if(e>1e12)return!1;let t=Math.round(2*A1*e);return t%2===1&&t*Math.PI===2*e}function Cn(e){return kh(Math.abs(e))?0:Math.sin(e)}function Fn(e){return $h(Math.abs(e))?0:Math.cos(e)}function R0(e){let t=Math.abs(e);return kh(t)?0:$h(t)?1/0:Math.tan(e)}function gH(e){return $h(Math.abs(e))?1/0:1/Math.cos(e)}function hH(e){return kh(Math.abs(e))?1/0:1/Math.sin(e)}function bH(e){let t=Math.abs(e);return kh(t)?1/0:$h(t)?0:1/Math.tan(e)}function xH(e){return e>0?Math.atan(1/e):Math.PI/2-Math.atan(e)}function TH(e){return Math.asin(1/e)}function IH(e){return Math.acos(1/e)}function PH(e){return 1/am(e)}function EH(e){return 1/jl(e)}function SH(e){return 1/v0(e)}function MH(e){return b1(1/e)}function CH(e){return x1(1/e)}function vH(e){return T1(1/e)}function DH(e){if(e===0||isNaN(e))return e;if(!isFinite(e))return NaN;if(e===Math.floor(e))return e>0?0:-0;let t=Math.round(2*e),n=-.5*t+e,r=t&2?-1:1,s=t&1?Math.cos(Math.PI*n):Math.sin(Math.PI*n);return r*s}function Ci(e){return e===1/0||e===-1/0?0:e===0?1:DH(e)/(Math.PI*e)}function bu(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}function NH(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function Nh(e){if(e===1/0)return 1/Math.sqrt(2*Math.PI);let t=yo(.5*(e+1))-yo(.5*e)+.5*(e*(Math.log1p(1/e)-1/e));return Math.exp(t)/Math.sqrt(2*Math.PI*(1+1/(e*(3*e+4))))}function sm(e,t,n=e-t){if(Math.abs(n)<.1*(e+t)){let r=n/(e+t),s=n*n/(e+t),o=2*e*r;for(let i=1;i<10;i++){o*=r*r;let a=s+o/(2*i+1);if(a==s)return a;s=a}}return e*Math.log(e/t)+t-e}function yo(e){if(e<0)return NaN;if(e>=3)return RH(e)-.5*Math.log1p(1/(6*e));if(e>=1)return a1(e);let t=.5772156649015329,n=-.1952810437829498,r=e*(1+6*e),s=Math.log1p(6*e/(1+r));return(e-t)*s+.5*Math.log1p(2/5*(1+4*e*(1-3*e))/(1+r))+(t-.5)*s+(e===0?0:e*Math.log1p(1/r))+n+a1(e+1)}function RH(e){let t=1/(e*e),n=.03333333333333229,r=.3816877588482201,s=1.1226896867003733,o=.8424153799350397,i=.06216815175439515,a=11.73634705109923,u=36.819646921154714,c=33.58045682700508,p=6.435857736505945,l=n+t*(r+t*(s+t*(o+t*i))),m=1+t*(a+t*(u+t*(c+t*p)));return(1-t*(l/m))/(12*e)}function Yh(e,t){if(t<=0)return NaN;if(t===1/0)return Zh(e,0,1);let n=e*e/t;return n===0?Nh(t)*Math.exp(-.5*e*e):n<1?Nh(t)*(1+n)**-.5*Math.exp(-.5*t*um(n)):Nh(t)*(1+n)**-.5*Math.pow(1+n,-t/2)}function $l(e,t){if(e===1/0)return G1(-1/0,t,0,1);if(t>0)return 1-$l(e,-t);if(t===-1/0)return 0;if(t===0)return .5;if(e>=30&&16*t*t<e)return OH(e,t);if(t/e<-1e3){let r=t*t;return Nh(e)*Math.pow(e,.5*(e-1))*Math.pow(Math.abs(t),-e)*(1-e*e*(e+1)*(1/(2+e)+e*(e+3)/(4*(4+e)*r))/(2*r))}let n=Math.sqrt(t*t+e);return _H((t+n)/(2*n),e/2,e/2)}var u1=[1/4,1/96,-1/384,-1/10240,19/368640,79/61931520,-55/49545216,-2339/118908518400,11813/475634073600,677/1993133260800,-2117/3720515420160];function OH(e,t){let n=Math.log1p(t*t/e),r=Math.sign(t)*Math.sqrt(n),s=1/e,o=Math.sqrt(.5*e),i=0,a=0;for(let u=u1.length-1;u>=0;u--)i=(i*(2*u+3)-u1[u])*s,a=n*a+i;return Math.exp(-.5*e*n)*(.5*xu(-r*o)+o/(Math.sqrt(Math.PI)*(1-i))*a*r)}function AH(e,t,n,r,s){if(n<=0||!isFinite(r)||!isFinite(s))return NaN;if(s===0)return e<=r&&r<=t?1:0;let o=(e-r)/Math.abs(s),i=(t-r)/Math.abs(s);return o===-1/0?$l(n,i):o>0&&i>0?$l(n,-o)-$l(n,-i):$l(n,i)-$l(n,o)}function Rh(e,t,n,r,s){return AH(Math.min(e,t),Math.max(e,t),n,r,s)}function _H(e,t,n){if(e<0||e>1)throw new RangeError(\"First argument must be between 0 and 1.\");if(t===1&&n===1)return e;if(e===0)return 0;if(e===1)return 1;if(t===0)return 1;if(n===0)return 0;{let r=yo(t+n)-yo(t)-yo(n)-sm(t,(t+n)*e)-sm(n,(t+n)*(1-e),(t+n)*e-t),s=Math.exp(r)*Math.sqrt((1+1/(6*(t+n)))/(2*Math.PI*(1+1/(6*t))*(1+1/(6*n))*(1/t+1/n)));return e<(t+1)/(t+n+2)?s*c1(e,t,n)/t:1-s*c1(1-e,n,t)/n}}function c1(e,t,n){let r=Math.pow(2,-52),s=1e-300,o=t+n,i=t+1,a=t-1,u=1,c=1-o*e/i;Math.abs(c)<s&&(c=s),c=1/c;let p=c;for(let l=1;l<=100;l++){let m=2*l,d=l*(n-l)*e/((a+m)*(t+m));c=1+d*c,Math.abs(c)<s&&(c=s),u=1+d/u,Math.abs(u)<s&&(u=s),c=1/c,p*=c*u,d=-(t+l)*(o+l)*e/((t+m)*(i+m)),c=1+d*c,Math.abs(c)<s&&(c=s),u=1+d/u,Math.abs(u)<s&&(u=s),c=1/c;let y=c*u;if(p*=y,Math.abs(y-1)<=r)return p}return p}function _1(e,t){let n=Math.pow(2,-52),r=1e-300,s=1,o=e,i=s/o,a=s/r,u=1/o,c=2,p=0,l=o,m=-(e-1),d=0;do m-=1,l+=1,u=u*m*t+l,u===0&&(u=r),a=l+m*t/a,a===0&&(a=r),u=1/u,p=a*u,i=i*p,d+=1,l+=1,u=u*d*t+l,u===0&&(u=r),a=l+d*t/a,a===0&&(a=r),u=1/u,p=a*u,i*=p,c+=2;while(c<100&&Math.abs(p-1)>n);return i}function w1(e,t){let n=Math.pow(2,-52),r=1e-300,s=1,o=t+1-e,i=s/o,a=s/r,u=1/o,c=2,p=0,l=o;do{let m=-(c-1)*(c-e-1);l+=2,u=u*m+l,u===0&&(u=r),a=l+m/a,a===0&&(a=r),u=1/u,p=a*u,i*=p,c+=1}while(c<100&&Math.abs(p-1)>n);return i}function L1(e,t,n=!1){let r=t/e,s=D0(t-e)*Math.sqrt(2*sm(1,r)),o=[1,-.3333333333333333,.08333333333333333,-.014814814814814815,.0011574074074074073,.0003527336860670194,-.0001787551440329218,3919263178522438e-20,-2185448510679992e-21,-185406221071516e-20,8296711340953087e-22,-17665952736826078e-23,6707853543401498e-24,10261809784240309e-24,-4382036018453353e-24,914769958223679e-24,-25514193994946248e-27,-5830772132550426e-26,24361948020667415e-27,-50276692801141755e-28,11004392031956135e-29,3371763262400985e-28,-1392388722418162e-28,28534893807047445e-30,-5139111834242572e-31,-19752288294349442e-31,8099521156704561e-31],i=o.length-2,a=0,u=0,c=0,p=0;for(;i>=0;i--)c=(i+2)*a/e+o[i+1],p=s*p+c,a=u,u=c;if(p=e/(e+a)*p,t<e){let l=Math.exp(-.5*e*s*s)*(.5*xu(-s*Math.sqrt(e/2))-p/Math.sqrt(2*Math.PI*e));return n?isFinite(l)?l:0:isFinite(l)?1-l:1}else{let l=Math.exp(-.5*e*s*s)*(.5*xu(s*Math.sqrt(e/2))+p/Math.sqrt(2*Math.PI*e));return n?isFinite(l)?1-l:1:isFinite(l)?l:0}}var O0=0,A0=1,_0=2,Lh=3;function F1(e,t){return isNaN(e)||isNaN(t)||e<0||t<0?Lh:e>12&&2.35*e>t&&.3*e<t?_0:e>=t||e<1&&t<4.25?O0:A0}function V1(e,t){let n=F1(e,t);switch(n){case _0:return L1(e,t,!0);case O0:{let r=_1(e,t);return isFinite(r)?e*Dc(e,t)*r:0}case A0:{let r=w1(e,t);return isFinite(r)?1-e*Dc(e,t)*r:1}case Lh:return NaN;default:return NaN}}function B1(e,t){let n=F1(e,t);switch(n){case _0:return L1(e,t);case O0:{let r=_1(e,t);return isFinite(r)?1-e*Dc(e,t)*r:1}case A0:{let r=w1(e,t);return isFinite(r)?e*Dc(e,t)*r:0}case Lh:return NaN;default:return NaN}}function wH(e,t){let n,r;if(e<25){n=Math.pow(t*Ju(e),1/e);let a=e-1,u=-Math.log(Ju(a)*(1-t));r=u+a*Math.log(u),a<0&&(r+=.5*Math.log1p(a/u)),Number.isNaN(r)&&(r=0)}else n=e/Math.E*Math.pow(t*Math.sqrt(2*Math.PI*e),1/e),r=0;let s=n/(1+e),o=n*(1+s*(1+s*((5+3*e)/(2*(2+e))))),i=jh(t)*Math.sqrt(e)+(e-.5);return Math.max(o,i,r)}function LH(e,t){if(isNaN(e)||e<=0||t<0||t>1)return NaN;if(e===1/0)return t===1?NaN:0;if(t===0)return 0;if(t===1)return 1/0;let n=wH(e,t);if(n===0||n===1/0)return n;for(let r=0;r<10;r++){let s=t-V1(e,n),o=s/(e/n*Dc(e,n)+.5*((e-1)/n-1)*s),i=n+1e-8*o===n;if(n+=o,i)break}return n}function l1(e,t,n){return(e-t)/(Math.SQRT2*Math.abs(n))}function Ff(e){return e<0?.5*Math.exp(-e*e)*xu(-e):1-.5*Math.exp(-e*e)*xu(e)}function FH(e,t,n,r){if(!isFinite(r)||isNaN(n))return NaN;if(r===0)return e<=n&&n<=t?1:0;let s=l1(e,n,r),o=l1(t,n,r);return s===-1/0?Ff(o):s>0&&o>0?Ff(-s)-Ff(-o):Ff(o)-Ff(s)}function G1(e,t,n,r){return FH(Math.min(e,t),Math.max(e,t),n,r)}function Zh(e,t,n){return 1/Math.sqrt(2*Math.PI*n*n)*Math.exp(-(e-t)*(e-t)/(2*n*n))}function w0(e,t){return`t${e}:${qh(t)}`}function L0(e){let t=h1.spy(e),n=parseInt(t.slice(0,8),16)&2097151,r=parseInt(t.slice(8,16),16);return(n*4294967296+r)/9007199254740992}function H1(e,t){for(let n=t.length-1;n>0;n--){let r=e+\"::sc\"+n,s=Math.floor(L0(r)*(n+1)),o=t[n];t[n]=t[s],t[s]=o}}function VH(e,t){let n=t.slice();return H1(e,n),n}function F0(e,t){let n=[];for(let r=0;r<t;r++)n.push(r);return H1(e,n),n}function vc(e,t,n){return L0(e)*(n-t)+t}function BH(e,t,n){let r=0,s,o,i,a;do s=e+\"::sc\"+r,r+=1,o=vc(s,0,1)*2-1,s=e+\"::sc\"+r,r+=1,i=vc(s,0,1)*2-1,a=o*o+i*i;while(a>=1||a===0);let u=Math.sqrt(-2*Math.log(a)/a);return t+n*o*u}function GH(e,t){if(t<=0)return NaN;let n=0,r,s,o,i;do r=e+\"::sc\"+n,n+=1,s=vc(r,0,1)*2-1,r=e+\"::sc\"+n,n+=1,o=vc(r,0,1)*2-1,i=s*s+o*o;while(i>1);let a=s*s/i,u=t*(Math.pow(i,-2/t)-1);return r=e+\"::sc\"+n,n+=1,(vc(r,0,1)<.5?-1:1)*Math.sqrt(a*u)}function HH(e,t,n){return t=tr(Math.round(t),0,1/0),t===1/0?NaN:(n=tr(n,0,1),U1(vc(e,0,1),t,n))}function qH(e,t){return t<0?NaN:q1(vc(e,0,1),t)}function Oh(e,t,n){return e>=t?1:e<0?0:e<Math.floor((t+1)*n)?p1(e,t,n):1-p1(t-e-1,t,1-n)}function p1(e,t,n){let r=(1-n)/n,s=Xh(e,t,n),o=s;for(;e>0&&(s*=e/(t-e+1)*r,o+s!==o);e--)o+=s;return o}function UH(e,t,n,r){return n=tr(Math.round(n),0,1/0),n===1/0?NaN:(r=tr(r,0,1),e=Math.ceil(e),t=Math.floor(t),e===-1/0?Oh(t,n,r):Oh(t,n,r)-Oh(e-1,n,r))}function zH(e,t,n,r){return UH(Math.min(e,t),Math.max(e,t),n,r)}function Xh(e,t,n){if(e=Math.round(e),t=tr(Math.round(t),0,1/0),t===1/0)return NaN;if(n=tr(n,0,1),e<0||e>t)return 0;if(n===0)return e===0?1:0;if(n===1)return e===t?1:0;if(e===0)return Math.exp(t*um(-n));if(e===t)return Math.pow(n,t);let r=yo(t)-yo(e)-yo(t-e)-sm(e,t*n)-sm(t-e,t*(1-n),t*n-e);return Math.exp(r)*Math.sqrt((t+1/6)/(2*Math.PI*(e+1/6)*(t-e+1/6)))}function Dc(e,t){return Math.exp(-yo(e)-sm(e,t))/Math.sqrt(2*Math.PI*(e+1/6))}function Wh(e,t){return t<0?NaN:(e=Math.round(e),e<0?0:t===0?e===0?1:0:e===0?Math.exp(-t):Dc(e,t))}function Vf(e,t){return isNaN(e)||isNaN(t)?NaN:e===1/0?1:(e=Math.floor(e),e<0?0:t===0?1:B1(Math.floor(e+1),t))}function kH(e,t,n){return n<0?NaN:(e=Math.ceil(e),t=Math.floor(t),e===-1/0?Vf(t,n):Vf(t,n)-Vf(e-1,n))}function $H(e,t,n){return kH(Math.min(e,t),Math.max(e,t),n)}function V0(e,t){return isNaN(e)||isNaN(t)?NaN:t<=0?NaN:e<0?0:e===1/0&&t===1/0?NaN:e===1/0||t===1/0?0:e===0?t<2?1/0:t===2?.5:0:.5*(t/e)*Dc(t/2,e/2)}function h0(e,t){return e<=0?0:t===1/0?e===1/0?NaN:0:e===1/0?1:V1(t/2,e/2)}function b0(e,t){return e<=0?1:t===1/0?e===1/0?NaN:1:e===1/0?0:B1(t/2,e/2)}function YH(e,t,n){return isNaN(e)||isNaN(t)||isNaN(n)?NaN:n<=0?NaN:t>n&&e>n?b0(e,n)-b0(t,n):h0(t,n)-h0(e,n)}function ZH(e,t,n){return YH(Math.min(e,t),Math.max(e,t),n)}function XH(e,t){return 2*LH(t/2,e)}function B0(e,t,n){return n<=t?NaN:e<t||e>n?0:1/(n-t)}function WH(e,t,n,r){return r<n?NaN:n===r?e<=n&&n<=t?1:0:(tr(t,n,r)-tr(e,n,r))/(r-n)}function jH(e,t,n,r){return WH(Math.min(e,t),Math.max(e,t),n,r)}function JH(e){let t=-e*e;return t<-750?e>=0?1:-1:e>=.065?1-Math.exp(t)*xu(e):e<=-.065?Math.exp(t)*xu(-e)-1:e*(1.1283791670955126+t*(.37612638903183754+t*(.11283791670955126+t*(.026866170645131252+t*.005223977625442188))))}function xu(e){let t=.9999999999999999,n=2.224574423459406,r=2.444115549920689,s=1.7057986861852539,o=.8257463703357973,i=.28647031042892007,a=.07124513844341643,u=.012296749268608364,c=.001347817214557592,p=7263959403471071e-20,l=1,m=3.352953590554884,d=5.227518529742423,y=5.003720878235473,g=3.266590890998987,f=1.5255421920765353,h=.5185887413188858,x=.12747319185915415,T=.02185979575963238,P=.0023889438122503674,M=.00012875032817508128;if(e<0)return e<-6.1?2*Math.exp(e*e):2*Math.exp(e*e)-xu(-e);if(e>50){let S=.5641895835477563,E=e*e;return e>5e7?S/e:S*(E*(E+4.5)+2)/(e*(E*(E+5)+3.75))}else{let S=t+e*(n+e*(r+e*(s+e*(o+e*(i+e*(a+e*(u+e*(c+e*p)))))))),E=l+e*(m+e*(d+e*(y+e*(g+e*(f+e*(h+e*(x+e*(T+e*(P+e*M)))))))));return S/E}}function jh(e){let t=-39.6968302866538,n=220.946098424521,r=-275.928510446969,s=138.357751867269,o=-30.6647980661472,i=2.50662827745924,a=-54.4760987982241,u=161.585836858041,c=-155.698979859887,p=66.8013118877197,l=-13.2806815528857,m=-.00778489400243029,d=-.322396458041136,y=-2.40075827716184,g=-2.54973253934373,f=4.37466414146497,h=2.93816398269878,x=.00778469570904146,T=.32246712907004,P=2.445134137143,M=3.75440866190742,S=.02425,E,v,D;return e>.5?-jh(1-e):e===.5?0:e<0?NaN:e===0?-1/0:(e<S?(E=Math.sqrt(-2*Math.log(e)),D=(((((m*E+d)*E+y)*E+g)*E+f)*E+h)/((((x*E+T)*E+P)*E+M)*E+1)):(E=e-.5,v=E*E,D=(((((t*v+n)*v+r)*v+s)*v+o)*v+i)*E/(((((a*v+u)*v+c)*v+p)*v+l)*v+1)),D-Math.sqrt(2*Math.PI)*(.5*xu(-D/Math.SQRT2)-Math.exp(.5*D*D)*e))}function q1(e,t){if(t<0||e<0||e>1)return NaN;if(t===0||e===0)return 0;if(e===1)return 1/0;let n=-1,r=Math.ceil(t);for(;Vf(r,t)<e;)r=2*r;let s=Math.floor(n+(r-n)/2);for(;n<s&&s<r;)Vf(s,t)<e?n=s:r=s,s=Math.floor(n+(r-n)/2);return r}function U1(e,t,n){if(t!==Math.round(t))return NaN;if(n<0||n>1)return NaN;if(e<0||e>1)return NaN;if(e===0)return 0;if(e===1)return t;if(t===0)return 0;if(n===1)return t;if(n===0)return 0;let r=-1,s=t,o=Math.floor(r+(s-r)/2);for(;r<o&&o<s;)Oh(o,t,n)<e?r=o:s=o,o=Math.floor(r+(s-r)/2);return s}function z1(e,t){if(isNaN(t)||t<=0||e<0||e>1)return NaN;if(e===0)return-1/0;if(e===1)return 1/0;if(t===1||t===2||t===4)return d0(t,e);let n,r;if(e===.5)return 0;if(e>.5)n=t>1?jh(e):d0(1,e),r=t>1?d0(1,e):Math.pow(Yh(0,t)*Math.pow(t,(t-1)/2)/(1-e),1/t);else return-z1(1-e,t);return QH(t,e,n,r)}function d0(e,t){let n=4*t*(1-t);switch(e){case 1:return Math.tan(Math.PI*(t-.5));case 2:return 2*(t-.5)*Math.sqrt(2/n);case 4:let r=Math.cos(Math.acos(Math.sqrt(n))/3)/Math.sqrt(n);return D0(t-.5)*2*Math.sqrt(r-1);default:throw new Error(\"_invTSimple() must be called with 1, 2, or 4 df.\")}}function QH(e,t,n,r){if(!isFinite(n)||!isFinite(r))return NaN;let s=n,o=r;for(;;){let i=Zo(s,o),a=$l(e,i);if(i===s||i===o)return a>t?s:o;a<t?s=i:o=i}}function KH(e,t,n){return e<0||e>1||n<=t?NaN:e===0?t:e===1?n:t+e*(n-t)}function k1(e,t){let n=Fh(e);return(bu(e)-t)*Math.sqrt(e.length)/n}function $1(e,t){let n=e.length,r=bu(e),s=Fh(e),o=t.length,i=bu(t),a=Fh(t),u=Math.sqrt(((n-1)*s*s+(o-1)*a*a)/(n+o-2));return(r-i)/(u*Math.sqrt(1/n+1/o))}function tm(e,t,n){return n<0?Rh(-1/0,e,t,0,1):n>0?Rh(-1/0,-e,t,0,1):2*Rh(-1/0,-Math.abs(e),t,0,1)}function G0(e,t){t===void 0&&(t=0);let n=k1(e,t),r=e.length-1;return{lessThan:tm(n,r,-1),greaterThan:tm(n,r,1),notEqual:tm(n,r,0)}}function H0(e,t){let n=$1(e,t),r=e.length+t.length-2;return{lessThan:tm(n,r,-1),greaterThan:tm(n,r,1),notEqual:tm(n,r,0)}}function q0(e){return{min:Jh(e),q1:Zl(e,1),median:W1(e),q3:Zl(e,3),max:Qh(e)}}function eq(e){return e.length}function Jh(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let n=1;n<e.length;n++){if(isNaN(e[n]))return NaN;e[n]<t&&(t=e[n])}return t}function Qh(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let n=1;n<e.length;n++){if(isNaN(e[n]))return NaN;e[n]>=t&&(t=e[n])}return t}function Y1(e,t){if(!isFinite(t)||t<0||t>1)return NaN;if(e.some(isNaN))return NaN;if(e.length===0)return NaN;let n=e.length,r=Jl(e),s=t*(n-1);return Math.floor(s)===s?e[r[s]]:(Math.ceil(s)-s)*e[r[Math.floor(s)]]+(s-Math.floor(s))*e[r[Math.ceil(s)]]}function Zl(e,t){if(!isFinite(t)||t<0||t>4)return NaN;if(e.some(isNaN))return NaN;let n=Jl(e),r=Kh(e,t),s=Math.floor(r),o=Math.ceil(r);return(e[n[s]]+e[n[o]])/2}function x0(e,t){let n=e-t;return Number.isNaN(n)?+Number.isNaN(e)-+Number.isNaN(t):n}function Z1(e,t){return x0(e[0],t[0])||x0(e[1],t[1])}function X1(e){let t=[];for(let n=0;n<e;n++)t.push(n);return t}function Jl(e){return X1(e.length).sort((t,n)=>x0(e[t],e[n]))}function tq(e){return X1(e.length).sort((t,n)=>Z1(e[t],e[n]))}function Kh(e,t){t=Math.round(t);let n=e.length,r=n%2===1,s;return n===1?0:(t===0&&(s=0),t===2&&(s=(n-1)/2),t===4&&(s=n-1),t===1&&(s=r?(n+1)/4-1:(n+2)/4-1),t===3&&(s=r?(3*n+3)/4-1:(3*n+2)/4-1),s===void 0?NaN:s)}function nq(e,t){return Jl(e)[Math.ceil(t*(e.length-1))]+1}function rq(e,t){return Jl(e)[Math.floor(t*(e.length-1))]+1}function sq(e,t){return Jl(e)[Math.ceil(Kh(e,t))]+1}function oq(e,t){return Jl(e)[Math.floor(Kh(e,t))]+1}function W1(e){return Y1(e,.5)}function iq(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let n=0;for(let r=1;r<e.length;r++){if(isNaN(e[r]))return 0;e[r]<t&&(n=r,t=e[r])}return n+1}function aq(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let n=0;for(let r=1;r<e.length;r++)if(e[r]>=t){if(isNaN(e[r]))return 0;n=r,t=e[r]}return n+1}function qf(e){let t=bu(e),n=0;for(let r=0;r<e.length;r++){let s=e[r]-t;n+=s*s}return n/e.length}function uq(e){let t=bu(e),n=0;for(let r=0;r<e.length;r++)n+=Math.abs(e[r]-t);return n/e.length}function j1(e){let t=e.length;return qf(e)*t/(t-1)}function J1(e,t){let n=Math.min(e.length,t.length);e.length!==n&&(e=e.slice(0,n)),t.length!==n&&(t=t.slice(0,n));let r=bu(e),s=bu(t),o=0;for(let i=0;i<n;i++)o+=(e[i]-r)*(t[i]-s);return o/n}function cq(e,t){let n=Math.min(e.length,t.length);return J1(e,t)*n/(n-1)}function eb(e,t){let n=Math.min(e.length,t.length);e.length!==n&&(e=e.slice(0,n)),t.length!==n&&(t=t.slice(0,n));let r=bu(e),s=bu(t),o=0,i=0,a=0;for(let u=0;u<n;u++){let c=e[u]-r,p=t[u]-s;o+=c*c,i+=p*p,a+=c*p}return a/Math.sqrt(o*i)}function U0(e,t,n,r){let s=e[0];for(let i=2;i<e.length;i++){let a=w(Vs(_o(e[i],s),n));if(!Co(a,i,10))return 0}let o=w(r);for(let i=0;i<t.length-1;i++){let a=w(Vs(_o(t[i],s),n));if(!Co(a,o-t.length+i,10))return 0}return!isFinite(o)||o<e.length||o<t.length?0:o}function z0(e){return e<0||!isFinite(e)?0:e}function T0(e){let t=e.length;if(t===0)return[];let n=[],r=[];for(let a=0;a<t;a++)r.push([e[a],a]);r.sort((a,u)=>{let c=a[0],p=u[0];return c===1/0&&p===1/0||c===-1/0&&p===-1/0?0:c-p});let s=0,o=1,i=1;for(;s<t;){let a=s;for(;a<t-1&&r[a][0]===r[a+1][0];)a+=1;i=a-s+1;let u;for(a=0;a<i;a++)u=r[s+a][1],n[u]=isNaN(e[u])?NaN:o+.5*(i-1);o+=i,s+=i}return n}function lq(e,t){let n=Math.min(e.length,t.length);return e.length!==n&&(e=e.slice(0,n)),t.length!==n&&(t=t.slice(0,n)),eb(T0(e),T0(t))}function Fh(e){return Math.sqrt(j1(e))}function pq(e){return Math.sqrt(qf(e))}var mq=jd;function om(e,t){return Bs(t[0]-e[0],t[1]-e[1])}function dq(e,t){return Bs(t[0]-e[0],Bs(t[1]-e[1],t[2]-e[2]))}function Q1(e,t,n){return[tr(Math.round(e),0,255),tr(Math.round(t),0,255),tr(Math.round(n),0,255)]}function fq(e,t,n){isFinite(e)||(e=0),t=tr(t,0,1),n=tr(n,0,1);let r=n*(1-t/2);r===0||r===1?t=0:t=(n-r)/Math.min(r,1-r);let{r:s,g:o,b:i}=Vg(e,t,r).rgb();return Q1(s,o,i)}function yq(e){return e}function gq(e,t){return[e,t]}function hq(e,t,n){return[e,t,n]}function bq(e,t){return[e,t]}function xq(e){return e}function Tq(e){let t=[];if(e.length===0)return[];for(let n=0;n<e.length-1;n++)t.push([e[n],e[n+1]]);return t.push([e[e.length-1],e[0]]),t}function k0(e){if(e.length==0)return 0;let t=[...e,e[0]];return IR(t)}function Iq(e){let t=0;for(let n=0;n<e.length-1;n++){let[r,s]=e[n],[o,i]=e[n+1];t+=yi(o-r,i-s)}if(e.length>1){let[n,r]=e[e.length-1],[s,o]=e[0];t+=yi(s-n,o-r)}return t}function Pq(e){let t=!1;for(let n=0;n<e.length;n++){let r=(n+1)%e.length;e[n][0]===e[r][0]&&e[n][1]===e[r][1]&&(t=!0)}return t?e.filter((n,r)=>{let s=e[r===0?e.length-1:r-1];return n[0]!==s[0]||n[1]!==s[1]}):e}function Eq(e){let[t,n,r,s]=e;return[t,r>=0?n:n+r,r>=0?r:-r,s]}function K1(e,t,n){if(e.length===0)return[];if(e=Pq(e),e.length===0)return[];let r=PR([...e,e[0]]),s=[];for(let o=0;o<e.length;o++){let i=e[o>0?o-1:e.length-1],a=e[o],u=e[o<e.length-1?o+1:0],c=r[o]===1,p=Jq(i,a,u,c?\"counterclockwise\":\"clockwise\",n);s.push(t?p:Eq(p))}return s}function Sq(e,t){return K1(e,!1,t)}function Mq(e,t){return K1(e,!0,t)}function $0(e,t){return[e,t]}var Cq=$0,vq=$0;function Dq(e,t){let n=[t[0]-e[0],t[1]-e[1]],r=[e[0],e[1]];return eO(n,r)}function eO(e,t){return[e,t]}function Nq(e){return e[0]}function Rq(e){return e[1]}function Oq(e,t){let n=[t[0]-e[0],t[1]-e[1],t[2]-e[2]],r=[e[0],e[1],e[2]];return tO(n,r)}function tO(e,t){return[e,t]}function Aq(e){return e[0]}function _q(e){return e[1]}function wq(e){return e}function Lq(e,t){return[e,t]}function Fq(e){return e[0]}function Vq(e){return e[1]}function Bq(e,t,n){return[e,t,n]}function cm([e,t,n]){let[r,s]=e,[o,i]=t,[a,u]=n,c=o*o+i*i,p=(r*r+s*s-c)/2,l=(c-a*a-u*u)/2,m=(r-o)*(i-u)-(o-a)*(s-i);m=1/m;let d=(p*(i-u)-l*(s-i))*m,y=((r-o)*l-(o-a)*p)*m;return[d,y]}function Gq(e){return e[0]}function Hq(e){return e[1]}function qq(e){return e[2]}function lm(e){let[[t,n],[r,s],[o,i]]=e,a=r-t,u=s-n,c=o-r,p=i-s;return 2*Math.atan2(a*p-c*u,a*c+u*p)}function Y0(e){let t=Math.abs(lm(e));return t<1e-9||t>2*Math.PI-1e-9}function Uq(e){return e[0]}function zq(e){return e[1]}function kq(e){return e[0]}function $q(e){return e[1]}function nO(e){return Math.abs(e)===Math.PI?Math.PI:zl(e+Math.PI,2*Math.PI)-Math.PI}function rO(e,t,n,r){return[e,nO(t),n,r]}function Yq([e,t,n,r]){return[e,t,n,r]}function Zq(e){return e[2]}function Xq(e){return e[3]}function sO(e){let[t,n,r,s]=e,o=Math.PI*2,i=r===0?o:r>0?r-o:r+o;return[t,n,i,s]}function Wq(e){let[t,n,r,s]=sO(e);return[t,n,r,s]}function jq(e){let[t,n,r,s]=e,o=r>=0?Math.PI-r:-Math.PI-r;return[t,nO(n+r),o,s]}function Jq(e,t,n,r,s){let o=e[0]-t[0],i=e[1]-t[1],a=n[0]-t[0],u=n[1]-t[1],c=Math.atan2(i,o),p=Math.atan2(o*u-i*a,o*a+i*u),l=2*Math.PI;return r===\"clockwise\"?p-=p<0?0:l:r===\"counterclockwise\"&&(p+=p<0?l:0),rO(t,c,p,s)}function Qq(e,t){let[[n,r],[s,o],i]=e;return[[n*t,r*t],[s*t,o*t],i]}function Kq(e,t){let n=new Array(e.length);for(let r=0;r<n.length;r++){let s=e[r];n[r]=[s[0]*t,s[1]*t]}return n}function Z0(e,t){let[[n,r],[s,o]]=e;return[[t*n,t*r],[t*s,t*o]]}var eU=Z0,tU=Z0;function nU(e,t){let[[n,r],s]=e;return[[t*n,t*r],t*s]}function rU(e,t){let[[n,r],[s,o],[i,a]]=e;return[[t*n,t*r],[t*s,t*o],[t*i,t*a]]}function sU(e,t){let[[n,r],s,o,i]=e;return[[t*n,t*r],t*s,t*o,i]}function oU(e,t){if(e.length!==t.length)throw new Error(\"Polygon tangent must be added to polygon of same length.\");let n=new Array(e.length);for(let r=0;r<n.length;r++){let s=e[r],o=t[r];n[r]=[s[0]+o[0],s[1]+o[1]]}return n}function tb(e,t){let[[n,r],[s,o]]=e,[[i,a],[u,c]]=t;return[[n+i,r+a],[s+u,o+c]]}function iU(e,t){let[[n,r,s],[o,i,a]]=e,[[u,c,p],[l,m,d]]=t;return[[n+u,r+c,s+p],[o+l,i+m,a+d]]}var aU=tb,uU=tb,cU=tb;function lU(e,t){let[[n,r],s]=e,[[o,i],a]=t;return[[n+o,r+i],s+a]}function pU(e,t){let[[n,r],[s,o],[i,a]]=e,[[u,c],[p,l],[m,d]]=t;return[[n+u,r+c],[s+p,o+l],[i+m,a+d]]}function mU(e,t){let[[n,r],s,o,i]=e,[[a,u],c,p]=t;return[[n+a,r+u],s+c,o+p,i]}function dU(e,t){let[[n,r],[s,o],i]=e,[[a,u],[c,p]]=t;return[[n+a,r+u],[s+c,o+p],i]}function X0(e,t){let[[n,r],[s,o]]=e;return[(1-t)*n+t*s,(1-t)*r+t*o]}function W0(e,t){return X0(e,tr(t,0,1))}function fU(e,t){t=tr(t,0,1);let[[n,r,s],[o,i,a]]=e;return[(1-t)*n+t*o,(1-t)*r+t*i,(1-t)*s+t*a]}function I0(e,t){return X0(e,tr(t,0,1/0))}function yU(e,t){let[[n,r],s]=e,o=Math.min(1,Math.max(0,t));return[n+s*Math.cos(2*Math.PI*o),r+s*Math.sin(2*Math.PI*o)]}function oO(e,t){let n=nb(e);if(!n)return[NaN,NaN];if(n.type===\"segment\")return W0([e[0],e[2]],t);if(n.type===\"rays\")return t<=0?I0([n.start1,n.end1],-t):t>=1?I0([n.start2,n.end2],t-1):[NaN,NaN];t=Math.min(1,Math.max(0,t));let r=cm(e),s=lm(e),o=Math.atan2(e[0][1]-r[1],e[0][0]-r[0]),i=om(r,e[0]),a=o+t*s;return[r[0]+i*Math.cos(a),r[1]+i*Math.sin(a)]}function gU(e,t){if(isNaN(t)||e.length===0)return[[NaN,NaN],[NaN,NaN]];if(t<0||t>=e.length)return[e[0],e[0]];let n=Math.floor(t);return[e[n],e[(n+1)%e.length]]}function hU(e,t){if(isNaN(t)||e.length===0)return[NaN,NaN];if(t<0||t>=e.length)return e[0];let n=Math.floor(t);return W0([e[n],e[(n+1)%e.length]],t-n)}function nb(e){let[t,n,r]=e,[[s,o],[i,a],[u,c]]=[t,n,r];if(isNaN(s)||isNaN(o)||isNaN(i)||isNaN(a)||isNaN(u)||isNaN(c))return;let p=cm([t,n,r]),l=om(p,t);if(isFinite(l)&&!Y0([t,n,r])){let m=Math.atan2(t[1]-p[1],t[0]-p[0]),d=m+lm([t,n,r]);return{type:\"arc\",center:p,radius:l,startAngle:m,endAngle:d}}else{let m=qi(i,a,0,s,o,0,u,c,0);return m<0||m>1?{type:\"rays\",start1:[s,o],end1:[s+(s-u),o+(o-c)],start2:[u,c],end2:[u+(u-s),c+(c-o)]}:{type:\"segment\",start:[s,o],end:[u,c]}}}function bU(e,t,n){let s=om(e,t);if(s>1e-9)return t;let o=om(e,n);return o>1e-9?n:isNaN(s)&&isNaN(o)?[NaN,NaN]:e}function Bf(e,t){let[[n,r],s]=e,[[o,i],a]=t,u=Bs(o-n,i-r),c=u*u,p=s*s,l=a*a,[m,d,y]=[u,s,a].sort((M,S)=>S-M),g=m+d+y,f=y-(m-d),h=y+(m-d),x=m+(d-y),T=.01,P;return f<0&&m+T*f===m||h<0&&m+T*h===m||x<0&&m+T*x===m?P=0:P=Math.sqrt(g*f*h*x)/4,[(o+n)/2+(o-n)*(p-l)/(2*c)+-2*(i-r)*P/c,(i+r)/2+(i-r)*(p-l)/(2*c)+2*(o-n)*P/c]}function Vh(e,t,n){let[[r,s],o]=e,[[i,a],[u,c]]=t,p=i-r,l=u-r,m=a-s,d=c-s,y=u-i,g=c-a,f=y*y+g*g,h=Bs(y,g),x=p*d-l*m,T=o*h,P=T+x,M=T-x,S=.01,E;if(P<0&&T+S*P===T||M<0&&T+S*M===T?E=0:E=P*M,E<0)return[NaN,NaN];let v=Math.sqrt(E);return[r+(x*g+n*y*v)/f,s+(-x*y+n*g*v)/f]}function xU(e,t){let[[n,r],[s,o]]=e,[[i,a],[u,c]]=t,p=o-r,l=n-s,m=c-a,d=i-u,y=p*n+l*r,g=m*i+d*a,f=p*d-m*l,h=f/(Bs(p,l)*Bs(m,d));return f===0||1+.1*h===1?[NaN,NaN]:[(d*y-l*g)/f,(p*g-m*y)/f]}function j0(e,t,n=0){let r=Vh(t,e,-1);if(Nc(r,e,n,!0))return r;{let s=Vh(t,e,1);return Nc(s,e,n,!0)?s:[NaN,NaN]}}function J0(e,t,n=0){let r=Vh(e,t,1);if(Nc(r,t,n,!1))return r;{let s=Vh(e,t,-1);return Nc(s,t,n,!1)?s:[NaN,NaN]}}function iO(e,t,n=0){let r=xU(e,t);return!Nc(r,e,n,!0)||!Nc(r,t,n,!1)?[NaN,NaN]:r}function TU(e,t,n=0){let r=cO(t,e,n,-1);return im(r,t,n,!1)?r:[NaN,NaN]}function aO(e,t,n=0){let r=lO(t,e,n,-1);return!Nc(r,e,n,!0)||!im(r,t,n,!1)?[NaN,NaN]:r}function IU(e,t,n=0){let r=cO(e,t,n,1);return im(r,e,n,!0)?r:[NaN,NaN]}function uO(e,t,n=0){let r=lO(e,t,n,1);return!im(r,e,n,!0)||!Nc(r,t,n,!1)?[NaN,NaN]:r}function PU(e,t,n=0){let r=EU(e,t,n);return!im(r,e,n,!0)||!im(r,t,n,!1)?[NaN,NaN]:r}function EU(e,t,n){let r=Gh(e);if(Hh(r))return aO(r,t,n);let s=Gh(t);return Hh(s)?uO(e,s,n):Q0(()=>Bf(r,s),()=>Bf(s,r),o=>K0(-1,Bh(e,o),Bh(t,o)))}function cO(e,t,n,r){let s=Gh(e);return Hh(s)?r>0?J0(t,s,n):j0(s,t,n):Q0(()=>Bf(s,t),()=>Bf(t,s),o=>K0(r,Bh(e,o),SU(t,o)))}function lO(e,t,n,r){let s=Gh(e);return Hh(s)?iO(s,t,n):Q0(()=>J0(s,t,n),()=>j0(t,s,n),o=>K0(r,Bh(e,o),MU(t)))}function Q0(e,t,n){let r=e();if(n(r))return r;let s=t();return n(s)?s:[NaN,NaN]}function K0(e,t,n){return e*mO(t,n)>0}function Bh(e,[t,n]){let[r,s]=cm(e);return lm(e)>0?[s-n,t-r]:[n-s,r-t]}function SU([[e,t]],[n,r]){return[t-r,n-e]}function MU([[e,t],[n,r]]){return[n-e,r-t]}function Gh(e){let t=cm(e),n=om(t,oO(e,0));return isFinite(n)&&!Y0(e)?[t,n]:[e[0],e[2]]}function Hh(e){return Array.isArray(e[1])}function im([e,t],n,r,s){let[o,i]=cm(n);return(s?(r&3)===0:(r&12)===0)||lg(Math.atan2(t-i,e-o),Math.atan2(n[0][1]-i,n[0][0]-o),lm(n))}function Nc([e,t],[[n,r],[s,o]],i,a){let u=qi(e,t,0,n,r,0,s,o,0),[c,p]=a?[(i&1)===0,(i&2)===0]:[(i&4)===0,(i&8)===0];return!isNaN(u)&&(u>=0||c)&&(u<=1||p)}function CU(e,t){let[[n,r],[s,o]]=e,[i,a]=t;return[[i,a],[i+(s-n),a+(o-r)]]}function vU(e,t){let[[n,r],[s,o]]=e,[i,a]=t;return[[i,a],[i+(o-r),a-(s-n)]]}function DU(e){let[t,n,r]=e,[s,o]=t,i=Fn(n+r/2),a=Cn(n+r/2);return[[s,o],[s+i,o+a]]}function pO(e,t){let[n,r]=e,[s,o]=t;return[n*s-r*o,n*o+s*r]}function eM(e,t){let[n,r,s]=e,[o,i]=n,[a,u]=t;return s&&(u=-u),i===0?[o*a,o*u]:[o*a-i*u,o*u+a*i]}function mO(e,t){let[n,r]=e,[s,o]=t;return n*o-s*r}function NU(e,t){let[n,r]=e,[s,o]=t;return n*s+r*o}function RU(e){let[t,n]=e;return[-n,t]}function OU(e,t){return[e,t,!1]}function AU(e,t){return[e,t,!0]}function _U(e){return[e[0],[0,0],e[2]]}function wU(e){return e[0]}function LU(e){return[[1,0],e,!1]}function FU(e,t){let[n,r]=e;return[[t,0],[(1-t)*n,(1-t)*r],!1]}function VU(e,t){let[n,r]=e,s=Math.cos(t),o=Math.sin(t);return[[s,o],[n*(1-s)+r*o,r*(1-s)-n*o],!1]}function BU(e){let[[t,n],[r,s]]=e,o=r-t,i=s-n,a=o*o+i*i,u=(o*o-i*i)/a,c=2*o*i/a;return[[u,c],[(1-u)*t-c*n,(1+u)*n-c*t],!0]}function GU(e,t){let n=e[2],[r,s,o]=t;return[eM(e,r),Zi(e,s),o!==n]}function HU(e){let[[t,n],[r,s],o]=e,i=t*t+n*n,a=t/i,u=-n/i,c=-(t/i*r+n/i*s),p=-(t/i*s-n/i*r);return o&&(u=-u,p=-p),[[a,u],[c,p],o]}function Zi(e,t){let[n,r]=eM(e,t),[s,o]=e[1];return[n+s,r+o]}function qU(e,t){let[n,r,s]=e;return s?-t:t}function tM(e,t){let[n,r]=t;return[Zi(e,n),Zi(e,r)]}var UU=tM,zU=tM;function kU(e,t){let[n,r]=t;return[eM(e,n),Zi(e,r)]}function $U(e,t){let[n,r]=t,[[s,o]]=e;return[Zi(e,n),Bs(s,o)*r]}function YU(e,t){let[n,r,s]=t;return[Zi(e,n),Zi(e,r),Zi(e,s)]}function ZU(e,t){let n=[];for(let r of t)n.push(Zi(e,r));return n}function XU(e,t){let[n,r,s]=t,o=Zi(e,n),[i,a,u]=e,[c,p]=Zi([i,[0,0],u],[Math.cos(r),Math.sin(r)]),l=Math.atan2(p,c),m=qU(e,s);return[o,l,m,t[3]]}function WU(e,t){let n=[];for(let r=0;r<Math.min(e.length,t.length);r++)t[r]&&n.push(e[r]);return n}function jU(e,t){let n=[];for(let r of t)n.push(e[r]);return n}function JU(e){let t=[],n={};for(let r=0;r<e.length;r++){let s=e[r],o=qh(s);n.hasOwnProperty(o)||(n[o]=!0,t.push(r))}return t}function QU(e,t){return[e,t]}function KU(e){return e[0]}function ez(e){return e[1]}function qh(e){if(Array.isArray(e))return`[${e.map(qh).join(\",\")}]`;switch(typeof e){case\"string\":return e;case\"boolean\":case\"number\":return e.toString();case\"object\":if(Zu(e)){let n=[];for(let r of he(e.updateRules))n.push(`\"${String(r)}\": ${qh(e.updateRules[r].value)}`);return`{${n.join(\",\")}}`}else return w(e).toString();default:return e}}function tz(e){return e}function nz(e){return e}function Zt(e,t){return isNaN(e)||isNaN(t)?[NaN,NaN]:[e,t]}function Cc(e,t){return isNaN(e)||isNaN(t)?Zt(NaN,NaN):e===0?Zt(0,0):Zt(e*Fn(t),e*Cn(t))}function rz([e,t]){return e}function sz([e,t]){return t}function oz([e,t]){return Uf(t,e)}function Xl([e,t]){return[e,-t]}function Rc(e,t){let[n,r]=t;return Math.abs(r)<=Math.abs(n)?d1(e,t):Xl(d1(m1(e),m1(t)))}function m1([e,t]){return[t,e]}function d1([e,t],[n,r]){let s=r/n,o=1/(n+r*s);return s===0?Zt((e+r*(t/n))*o,(t-r*(e/n))*o):Zt((e+t*s)*o,(t-e*s)*o)}function dO([e,t]){return Wl(e,t)}function Wl(e,t){let n=Math.sqrt(.5*(Math.abs(e)+Bs(e,t)));return n===1/0&&(n=2*Math.sqrt(.5*(Math.abs(.25*e)+Bs(.25*e,.25*t)))),n===0||!isFinite(t)?Zt(n,t):e>0?Zt(n,.5*(t/n)):(t<0&&(n=-n),Zt(.5*(t/n),n))}function Gs(e){return Rc(Zt(1,0),e)}function Gf(e){return 0+e}function Uf(e,t){return Math.atan2(Gf(e),Gf(t))}function iz(e,t){let n=e*e+t*t;if(n===1/0)return Math.log(Math.hypot(.5*e,.5*t))+Math.LN2;if(n===0)return Math.log(Math.hypot(e,t));if(.5<n&&n<3){let r=Math.max(e,t),s=Math.min(e,t);return .5*Math.log1p((r+1)*(r-1)+s*s)}else return .5*Math.log(n)}function P0([e,t]){return Zt(iz(e,t),Uf(t,e))}function az([e,t]){let n=Math.exp(e);return t===0?Zt(n,0):Cc(n,t)}function uz([e,t]){return Zt((e+t)*(e-t),2*e*t)}function f1(e,t){t=t>>>0;let[n,r]=e,s=1,o=0;for(;t;){for(;!(t&1);){let u=(n+r)*(n-r),c=2*n*r;n=u,r=c,t=t>>>1}let i=n*s-r*o,a=n*o+s*r;s=i,o=a,t=t-1>>>0}return Zt(s,o)}function cz(e,t){let[n,r]=t;if(r===0)return fO(e,n);let[s,o]=e;if(isNaN(s)||isNaN(o)||isNaN(n)||isNaN(r))return Zt(NaN,NaN);let i=Bs(s,o),a=Uf(o,s),u=Math.pow(i,n)*Math.exp(-a*r),c=Math.log(i)*r+a*n;return isFinite(u)?Cc(u,c):Cc(Math.exp(n*Math.log(i)-a*r),c)}function fO(e,t){let[n,r]=e;if(isNaN(n)||isNaN(r)||isNaN(t))return Zt(NaN,NaN);switch(t){case-1:return Gs(e);case 0:return Zt(1,0);case .5:return dO(e);case 1:return e}return r===0?Number.isInteger(t)||n>=0?Zt(Math.pow(n,t),0):Cc(Math.pow(-n,t),Math.PI*t):n===0?r>=0?Cc(Math.pow(r,t),.5*Math.PI*t):Cc(Math.pow(-r,t),-.5*Math.PI*t):t===2?uz(e):t===(t|0)?t<0?Gs(f1(e,-t)):f1(e,t):Cc(Math.pow(Math.hypot(n,r),t),t*Uf(r,n))}function yO([e,t]){return Zt(Cn(e)*am(t),Fn(e)*jl(t))}function gO([e,t]){return Zt(Fn(e)*am(t),-Cn(e)*jl(t))}function hO([e,t]){let[n,r]=nM([-t,e]);return[r,-n]}function bO([e,t]){return Zt(jl(e)*Fn(t),am(e)*Cn(t))}function xO([e,t]){return Zt(am(e)*Fn(t),jl(e)*Cn(t))}function nM([e,t]){let n=R0(t),r=v0(e);if(!isFinite(n))return Zt(1/r,1/n);let s=n*n,o=1+s,i=jl(e),a=i*i,u=r*r;return Zt(o*r/(1+s*u),n/(1+o*a))}function lz(e){return Gs(gO(e))}function pz(e){return Gs(yO(e))}function mz(e){return Gs(hO(e))}function dz(e){return Gs(xO(e))}function fz(e){return Gs(bO(e))}function yz(e){return Gs(nM(e))}function rM([e,t]){let n=Wl(1-e,-t),r=Wl(1+e,t);return Zt(Math.atan(e/Gf(Yl(n,r)[0])),Math.asinh(Yl(Xl(n),r)[1]))}function TO([e,t]){let n=Wl(1-e,-t),r=Wl(1+e,t);return Zt(2*Math.atan(n[0]/Gf(r[0])),Math.asinh(Yl(Xl(r),n)[1]))}function E0([e,t]){let[n,r]=Uh([-t,e]);return[r,-n]}function IO([e,t]){let[n,r]=rM([-t,e]);return[r,-n]}function PO([e,t]){let n=Wl(e-1,t),r=Wl(e+1,t);return Zt(Math.asinh(Yl(Xl(n),r)[0]),2*Math.atan(n[1]/Gf(r[0])))}function Uh([e,t]){if(e<0){let[n,r]=g1(-e,-t);return[-n,-r]}else return g1(e,t)}var y1=Math.sqrt(Number.MAX_VALUE)/4;function g1(e,t){if(e>y1||Math.abs(t)>y1)return Zt(Gs([e,t])[0],t<=0?-Math.PI/2:Math.PI/2);if(e===1){if(t===0)return Zt(1/0,0);let n=Math.abs(t),r=Math.log(Math.sqrt(Math.sqrt(4+t*t))/Math.sqrt(n)),s=(Math.PI/2+Math.atan(n/2))/2;return t<0!=s<0&&(s=-s),Zt(r,s)}else return Zt(um(4*e/((1-e)**2+t**2))/4,-Uf(-2*t,(1-e)*(1+e)-t**2)/2)}function gz(e){return TO(Gs(e))}function hz(e){return rM(Gs(e))}function bz(e){if(e[0]>0)return E0(Gs(e));let[t,n]=E0(e);return Zt(Math.PI/2-t,-n)}function xz(e){let[t,n]=e;return t===0&&n===0?Zt(1/0,0):PO(Gs(e))}function Tz(e){let[t,n]=e;return t===0&&n===0?Zt(1/0,0):IO(Gs(e))}function Iz(e){return e[0]>0?Xl(Uh(Xl(Gs(e)))):Uh(Gs(e))}function sM([e,t]){return t===0?e:NaN}function Pz([e,t]){let r=Math.abs(t),s=Math.abs(t/e);return(isNaN(s)?r:Math.min(r,s))<1e-15?e:NaN}function Ez([e,t],n){var r,s;return t===0?((r=n.goodCoercionCount)!=null||(n.goodCoercionCount=0),n.goodCoercionCount++,e):(isNaN(t)||((s=n.badCoercionCount)!=null||(n.badCoercionCount=0),n.badCoercionCount++),NaN)}function oM(e){return e!==0&&!isNaN(e)}function Sz([e,t],n){var a,u;let s=Math.abs(t),o=Math.abs(t/e);return(isNaN(o)?s:Math.min(s,o))<1e-15?((a=n.goodCoercionCount)!=null||(n.goodCoercionCount=0),n.goodCoercionCount++,e):(isNaN(t)||((u=n.badCoercionCount)!=null||(n.badCoercionCount=0),n.badCoercionCount++),NaN)}function Mz(e){return isNaN(e)?[NaN,NaN]:[e,0]}function Cz(e,t){return t}function EO([e,t]){let n=Math.floor(e),r=Math.floor(t);if(!isFinite(n)||!isFinite(r))return[n,r];let s=e-n,o=t-r;return s+o<1?[n,r]:s>=o?[n+1,r]:[n,r+1]}function vz([e,t]){let n=EO([-e,-t]);return[-n[0],-n[1]]}function nm(e){return[Math.round(e[0]),Math.round(e[1])]}function Dz(e,t){let[n,r]=e,[s,o]=t;if(!isFinite(n)||!isFinite(r)||isNaN(s)||isNaN(o))return[NaN,NaN];if(!isFinite(s)&&!isFinite(o))return e;if(s===1/0)return vh(n,r,o);if(s===-1/0){let[m,d]=vh(-n,-r,-o);return[-m,-d]}else if(o===1/0){let[m,d]=vh(r,-n,-s);return[-d,m]}else if(o===-1/0){let[m,d]=vh(-r,n,s);return[d,-m]}let i=S0(t),a=n*s+r*o,u=r*s-n*o,c=zl(a,i),p=zl(u,i);c+p<i||(c>=p?c-=i:p-=i);let l=Rc([c,p],[s,-o]);return Number.isInteger(n)&&Number.isInteger(r)&&Number.isInteger(s)&&Number.isInteger(o)?[Math.round(l[0]),Math.round(l[1])]:l}function vh(e,t,n){return e+t<0?e>=t?Zt(e-n,1/0):Zt(1/0,t+n):[e,t]}function S0([e,t]){return e*e+t*t}function M0(e,t){if(!isFinite(e[0])||!isFinite(e[1])||!isFinite(t[0])||!isFinite(t[1]))return[NaN,NaN];e=nm(e),t=nm(t);let n=iM(e,t);return SO(n)}function iM(e,t){let n=[1,0];for(e=[e[0],e[1]],t=[t[0],t[1]];;){let r=S0(e),s=S0(t);if(r===1||s===1)return n;if(r===0)return Yl(t,n);if(s===0)return Yl(e,n);if(r===s&&Rz(e,t))return Yl(e,n);switch(Dh(e[0])<<3|Dh(e[1])<<2|Dh(t[0])<<1|Dh(t[1])){case 0:Kp(e),Kp(t),Nz(n);break;case 1:case 2:Kp(e);break;case 4:case 8:Kp(t);break;case 3:Kp(e),em(t),f0(n);break;case 12:em(e),Kp(t),f0(n);break;case 14:case 13:em(e);break;case 7:case 11:em(t);break;case 15:em(e),em(t),f0(n);break;case 5:case 10:e=[.5*(e[0]-t[0]),.5*(e[1]-t[1])],t=[e[0]+t[0],e[1]+t[1]];break;case 6:case 9:e=[.5*(e[0]+t[1]),.5*(e[1]-t[0])],t=[e[0]-t[1],e[1]+t[0]];break}}}function Nz(e){e[0]*=2,e[1]*=2}function Kp(e){e[0]*=.5,e[1]*=.5}function f0(e){let t=e[0]-e[1];e[1]=e[1]+e[0],e[0]=t}function em(e){let t=.5*(e[0]+e[1]);e[1]=.5*(e[1]-e[0]),e[0]=t}function Dh(e){return e%2==0?0:1}function Yl(e,t){let[n,r]=e,[s,o]=t;return Zt(n*s-r*o,n*o+s*r)}function Rz(e,t){return e[0]==t[0]&&e[1]==t[1]||e[0]==-t[0]&&e[1]==-t[1]||e[0]==-t[1]&&e[1]==t[0]||e[0]==t[1]&&e[1]==-t[0]}function SO(e){let[t,n]=e;return t>=0&&n<0?[-n,t]:t<0&&n<=0?[-t,-n]:t<=0&&n>0?[n,-t]:e}function C0(e,t){if(!isFinite(e[0])||!isFinite(e[1])||!isFinite(t[0])||!isFinite(t[1]))return[NaN,NaN];if(e[0]===0&&e[1]===0||t[0]===0&&t[1]===0)return[0,0];if(!isFinite(e[0])||!isFinite(e[1])||!isFinite(t[0])||!isFinite(t[1]))return[NaN,NaN];e=nm(e),t=nm(t);let n=iM(e,t),r=nm(Rc(e,n)),s=pO(r,t);return SO(s)}function Oz(e,t,n){let r=e.length/t;if(r!==n||!Number.isInteger(r))throw new Error(\"Invalid matrix dimensions\");let s=[],o=[],i=0;for(let u=0;u<t;u++)for(let c=0;c<n;c++)s[u]===void 0&&(s[u]=0),o[c]===void 0&&(o[c]=0),s[u]+=e[c*t+u],o[c]+=e[c*t+u],i+=e[c*t+u];let a=0;for(let u=0;u<t;u++)for(let c=0;c<n;c++){let p=s[u]*o[c]/i,l=e[c*t+u];a+=(l-p)**2/p}return a}function Xi(e){if(typeof e==\"string\")return e;if(e===void 0)return\"\";if(isNaN(e))return\"\\\\frac{0}{0}\";if(e===1/0)return\"\\\\infty\";if(e===-1/0)return\"-\\\\infty\";let t=e+\"\";return t=t.replace(/^1e\\+?([-\\d]+)/,\"10^{$1}\"),t=t.replace(/([-\\d\\.]+)e\\+?([-\\d]+)/,\"$1\\\\cdot 10^{$2}\"),t}function zf(e){let t=e+\"\";if(/\\d+\\.?\\d*e[\\+\\-]*\\d+/i.test(t)){let n=\"0\",r=String(t).toLowerCase().split(\"e\"),s=parseFloat(r[0]),o=parseInt(r[1],10),i=Math.abs(o),a=Math.abs(s).toString().split(\".\");if(o<0)t=\"0.\"+new Array(i).join(n)+a.join(\"\");else{let u=a[1];u&&(i=i-u.length),t=a.join(\"\")+new Array(i+1).join(n)}s<0&&(t=\"-\"+t)}return t}function a9(e,t=2){let n=zf(e),r=n.indexOf(\".\");if(r===-1)return n;let s,o;for(o=r+1;o<n.length;o++)if(s){if(n[o]!==s)break}else if(n[o]===\"0\"||n[o]===\"9\")s=n[o];else break;return n.substr(0,Math.max(r+5,o+t))}function uM(e,t=e,n=!1){if(isNaN(e)||!isFinite(e))return{string:\"undefined\",latex:\"undefined\",value:e};if(e===0)return{string:\"0\",latex:\"0\",value:e};Math.abs(e)>Math.abs(t)&&(t=e);let r=$u(e/Math.PI,24),s,o,i,a,u,c,p=n?Vz(t):Fz(t);if(p&&Co(r.n/r.d*Math.PI,e,3))return r.n===0?(s=\"0\",a=\"0\"):r.n===1?(s=\"\\u03C0\",a=\"\\\\pi\"):r.n===-1?(s=\"-\\u03C0\",a=\"-\\\\pi\"):(s=r.n.toString()+\"\\u03C0\",a=r.n.toString()+\"\\\\pi\"),r.d===1?(o=\"\",u=\"\"):(o=\"/\"+r.d.toString(),u=r.d.toString()),i=s+o,u===\"\"?c=a:a[0]===\"-\"?c=`-\\\\frac{${a.slice(1)}}{${u}}`:c=`\\\\frac{${a}}{${u}}`,{string:i,latex:c,value:r.n/r.d*Math.PI};if(p)return i=Lz(kf(e.toFixed(aM(t)))),{string:i,latex:i,value:parseFloat(i)};{let l=kf(e.toExponential(aM(t/e))).split(\"e\"),m=l[0]===\"1\"&&n?\"10\":l[0]+\"\\xD710\",d=l[1].replace(\"+\",\"\");return i=kf(e.toExponential(aM(t/e))).replace(\"+\",\"\"),c=`${l[0]}\\\\times10^{${d}}`,{string:i,latex:c,mantissa:m,superscript:d,value:parseFloat(i)}}}function Az(e,t,n,r){let s=uM(e,t),o=uM(r(s.value),n);return[s,o]}var _z=/\\.?0+$/,wz=/\\.?0+e/;function kf(e){return e.indexOf(\".\")===-1?e:e.indexOf(\"e\")!==-1?e.replace(wz,\"e\"):e.replace(_z,\"\")}function Lz(e){return e===\"-0\"?\"0\":e}function Fz(e){return e=Math.abs(e),1e-4<e&&e<1e7}function Vz(e){return e=Math.abs(e),.001<e&&e<1e4}var Bz=5,Gz=5;function aM(e){return e=Math.abs(e),e=Math.max(e,1e-16),Math.max(Bz,Math.floor(Gz+1.5-Math.log10(e)))}var rb={zeroCutoff:0,smallCutoff:.001,bigCutoff:1e6,digits:10,displayAsFraction:!1,addEllipses:!1,alwaysEmitImaginary:!1,spaceConstrained:!1},MO={smallCutoff:1e-6,bigCutoff:1e9,digits:12},cM={...MO,smallCutoff:1e-4,bigCutoff:1e6,digits:9,scientificNotationDigits:4,spaceConstrained:!0};function CO(e){return 1e6/Math.sqrt(Math.abs(e))}function vO(e){let t=CO(e);if(t<1||t>1e12)return!1;let{n,d:r}=$u(e,t);return r===1?!1:e===e+Math.pow(2,-3)*Math.abs(n/r-e)}function sb(e,t){var g;let{zeroCutoff:n,smallCutoff:r,bigCutoff:s,digits:o,displayAsFraction:i,addEllipses:a,spaceConstrained:u}={...rb,...t},c=(g=t==null?void 0:t.scientificNotationDigits)!=null?g:o-2;if(isNaN(e)||!isFinite(e))return{type:\"undefined\"};if(e===0||Math.abs(e)<n)return{type:\"decimal\",value:\"0\"};let l=kf(e.toExponential(c)).match(/([\\d\\.\\-]+)e\\+?([\\d\\-]+)/);if(!l)return{type:\"undefined\"};let m=parseInt(l[2],10),d=m>=o;if(vO(e)&&i){let f=$u(e,CO(e));return{type:\"fraction\",numerator:f.n.toString(),denominator:f.d.toString()}}else{if(Math.abs(e)>s||Math.abs(e)<r||d)return{type:\"scientific\",mantissa:l[1],exponent:l[2]};{let f=tr(u&&m<0?o+m:o,1,100),h=kf(e.toPrecision(f));return e!==Number(h)&&a&&(h+=\"...\"),{type:\"decimal\",value:h}}}}function ob(e,t){let n=sb(e,t);switch(n.type){case\"undefined\":return\"undefined\";case\"decimal\":return n.value;case\"scientific\":return n.mantissa+\"<span class='dcg-cross'>\\xD7</span>10<sup>\"+n.exponent+\"</sup>\";case\"fraction\":return n.denominator===\"1\"?n.numerator:`${n.numerator}/${n.denominator}`;default:return n}}function pm(e,t){let n=sb(e,t);switch(n.type){case\"undefined\":return\"undefined\";case\"decimal\":return n.value;case\"scientific\":return n.mantissa+\" * 10^\"+n.exponent;case\"fraction\":return n.denominator===\"1\"?n.numerator:`${n.numerator}/${n.denominator}`;default:return n}}function Oc(e,t){let n=sb(e,t);switch(n.type){case\"undefined\":return\"undefined\";case\"decimal\":return n.value;case\"scientific\":return n.mantissa+\"\\\\times10^{\"+n.exponent+\"}\";case\"fraction\":return n.denominator===\"1\"?n.numerator:n.numerator[0]===\"-\"?`-\\\\frac{${n.numerator.slice(1)}}{${n.denominator}}`:`\\\\frac{${n.numerator}}{${n.denominator}}`;default:return n}}function z(e){if(e.startsWith(\"_base_case\")){let[n,r,s]=e.split(\":\"),o=[];for(let i of s.split(\",\")){let a=parseFloat(i);isNaN(a)?o.push(z(i)):o.push(pm(a))}return`${z(r)}(${o.join(\",\")})`}e=e.replace(\"\\\\\",\"\");let t={alpha:\"\\u03B1\",beta:\"\\u03B2\",gamma:\"\\u03B3\",delta:\"\\u03B4\",epsilon:\"\\u03F5\",varepsilon:\"\\u03B5\",zeta:\"\\u03B6\",eta:\"\\u03B7\",theta:\"\\u03B8\",vartheta:\"\\u03D1\",iota:\"\\u03B9\",kappa:\"\\u03BA\",varkappa:\"\\u03F0\",lambda:\"\\u03BB\",mu:\"\\u03BC\",xi:\"\\u03BE\",pi:\"\\u03C0\",varpi:\"\\u03D6\",rho:\"\\u03C1\",varrho:\"\\u03F1\",sigma:\"\\u03C3\",varsigma:\"\\u03C2\",tau:\"\\u03C4\",phi:\"\\u03D5\",varphi:\"\\u03C6\",chi:\"\\u03C7\",psi:\"\\u03C8\",omega:\"\\u03C9\",Gamma:\"\\u0393\",Delta:\"\\u0394\",Theta:\"\\u0398\",Lambda:\"\\u039B\",Xi:\"\\u039E\",Pi:\"\\u03A0\",Sigma:\"\\u03A3\",Phi:\"\\u03A6\",Psi:\"\\u03A8\",Omega:\"\\u03A9\",div:\"\\xF7\",cdot:\"\\u22C5\",times:\"\\xD7\",lt:\"<\",gt:\">\",le:\"\\u2264\",ge:\"\\u2265\",sim:\"\\u223C\",ldots:\"\\u2026\",prime:\"\\u2032\",approx:\"\\u2248\",to:\"\\u2192\",\"->\":\"\\u2192\",\"<=\":\"\\u2264\",\">=\":\"\\u2265\"};return t.hasOwnProperty(e)?t[e]:e}function ss(e){let t=e.match(/^\\$(\\d+)$/);if(t)return`\\\\token{${t[1]}}`;let n=e.split(\"_\"),r=\"\";return n[0].length>1&&(r+=\"\\\\\"),r+=n[0],n[1]&&(r+=\"_{\"+n[1]+\"}\"),r}function Hz(e){if(!e)return\"\";let t=e.split(\"_\");t[0]=z(t[0]);let n=t.map(rR);return n[1]&&(n[1]=\"<sub>\"+n[1]+\"</sub>\"),n.join(\"\")}function vi(e){let t=e.match(/\\\\token\\{(\\d+)\\}/);return t?`$${t[1]}`:(e=e.replace(/\\\\operatorname\\{(.*)\\}/,\"$1\"),e.replace(/[{}\\\\]/g,\"\"))}function Tu(e){return e.replace(/^(\\\\ |\\s|\\\\space(?![a-zA-Z]))+/,\"\").replace(/(\\\\ |\\s|\\\\space(?![a-zA-Z]))+$/,\"\")}function $f(e,t={},n=\"latex\"){let r={...rb,...t},{alwaysEmitImaginary:s}=r,o;n===\"decimalString\"?o=zf:n===\"latex\"?o=Oc:o=ob;let[i,a]=[e[0]!==0?o(e[0],r):void 0,e[1]!==0||s?o(Math.abs(e[1]),r):void 0];return i===\"undefined\"||a===\"undefined\"?\"undefined\":i&&a?`${i}${e[1]>=0?\"+\":\"-\"}${a!==\"1\"?`${a}`:\"\"}i`:a?`${e[1]>=0?\"\":\"-\"}${a!==\"1\"?`${a}`:\"\"}i`:i!=null?i:\"0\"}function lM(e,t={}){let[n,r]=[e[0]!==0?pm(e[0],t):void 0,e[1]!==0?pm(Math.abs(e[1]),t):void 0];if(n===\"undefined\"||r===\"undefined\")return\"undefined\";let s=r!=null&&r.includes(\" * \")||r!=null&&r.includes(\"/\")?\" \":\"\";return n&&r?`${n}${e[1]>0?\" + \":\" - \"}${r!==\"1\"?`${r}${s}`:\"\"}i`:r?`${e[1]>0?\"\":\"-\"}${r!==\"1\"?`${r}${s}`:\"\"}i`:n!=null?n:\"0\"}function qz(e){switch(e){case Mn.MEAN_T_INFERENCE:case Mn.MEAN_Z_INFERENCE:return\"\\\\mu\";case Mn.DIFFERENCE_OF_MEANS_T_INFERENCE:case Mn.DIFFERENCE_OF_MEANS_Z_INFERENCE:return\"\\\\mu_{1} - \\\\mu_{2}\";case Mn.PROPORTION:return\"p\";case Mn.DIFFERENCE_OF_PROPORTIONS:return\"p_{1} - p_{2}\";default:throw new Error(`Unexpected statistic: ${e}`)}}function Uz(e,t={},n=\"latex\"){let r={...rb,...t},s;n===\"decimalString\"?s=zf:n===\"latex\"?s=Oc:s=ob;let[o,i]=[s(e[0],r),s(e[1],r)];return o===\"undefined\"||i===\"undefined\"?\"undefined\":`\\\\left(${o},${i}\\\\right)`}function zz(e,t={},n=\"latex\"){let r={...rb,...t},s;n===\"decimalString\"?s=zf:n===\"latex\"?s=Oc:s=ob;let[o,i,a]=[s(e[0],r),s(e[1],r),s(e[2],r)];return o===\"undefined\"||i===\"undefined\"||a===\"undefined\"?\"undefined\":`\\\\left(${o},${i},${a}\\\\right)`}var k=class extends lt{constructor(t,n){if(!Array.isArray(t))throw new TypeError(\"Argument to expression constructor must be an Array.\");super(),this.args=t,(!n||!n.skipRegisterDependencies)&&this.registerDependencies()}shouldExportAns(){return!0}registerDependencies(){for(let t=0;t<this.args.length;t++)this.mergeDependencies(this.args[t])}copyWithArgs(t){throw new Error(`Programming Error: copyWithArgs not implemented for ${this.constructor.name}`)}};var _n=class extends k{constructor(t){super([]),typeof t==\"number\"&&(t=be(t,1)),this._constantValue=t}asValue(){let t=this._constantValue;return typeof t==\"boolean\"?t:w(t)}asCompilerValue(){return this._constantValue}scalarExprString(){return this.asValue()>0?String(this.asValue()):\"(\"+String(this.asValue())+\")\"}isNaN(){let t=this.asValue();return typeof t==\"number\"&&isNaN(t)}},Xn=class extends _n{constructor(){super(...arguments);this.type=\"Constant\"}};function fM(e){if(!gn(e))throw new Error(\"Programming Error: numeric constants should be rational\");return{type:1,valueType:b,value:e}}var Qu=fM(be(0,1)),Ac=fM(be(1,1)),Yf=fM(be(1,2));function et(e){return e.map(t=>q(t))}function Wi(e){return e.map(t=>gt(t))}function X(e,t){var d,y,g,f,h;let n=t==null?void 0:t.defaultArguments,r=1/0,s=0,o=(d=n==null?void 0:n.length)!=null?d:0;for(let x of e){let T=x.minArity-o;T<r&&(r=T);let P=(y=x.maxArity)!=null?y:1/0;P>s&&(s=P)}let i=(g=t==null?void 0:t.fallthroughUnlessDistribution)!=null?g:!1,a=(f=t==null?void 0:t.allowDotCall)!=null?f:!1,u=(h=t==null?void 0:t.isSeeded)!=null?h:!1,c=t==null?void 0:t.minArityExampleArgs,p=t==null?void 0:t.maxArityExampleArgs,l=t==null?void 0:t.dotMinArityExampleArgs,m=t==null?void 0:t.dotMaxArityExampleArgs;return{minArity:r,getSignatures:x=>e.filter(T=>T.satisfiesPolicy(x)),maxArity:s,defaultArguments:n,fallthroughUnlessDistribution:i,minArityExampleArgs:c,maxArityExampleArgs:p,dotMinArityExampleArgs:l,dotMaxArityExampleArgs:m,allowDotCall:a,isSeeded:u}}function Iu(){return X(et([{type:\"variadic\",initial:[],rest:Pn}]),{})}var ib=cr.of([Ie,pe,Pe,De,ae]),pM=cr.of([Ie,Pe,De,ye]),mm=cr.of([N,Ie,pe,Pe,De,ye,ae,Se,ve,Te,Ne]),mM=cr.of([...Oo.types.filter(e=>e!==so),Sn]),dM=cr.of([Pn,Yn],{coerceComplexToReal:!1});function Ql(e){return!!Ra[e]}function Un(e){return[gt([qd(e)]),gt([e]),q({type:\"variadic\",initial:[e,e],rest:e})]}function dm(e){return[gt([qd(e),qd(e)])]}var Ra={midpoint:X([...et([[N,N],[Ie]]),...et([[F,F],[Jt]])],{allowDotCall:!0}),segment:X([q([N,N]),q([F,F])]),vector:X([q([N,N]),q([F,F])]),sphere:X([q([N,b]),q([F,b])]),distance:X(et([[N,N],[F,F]])),glider:X(et([[cr.of([Ie,pe,Pe,De,ae,Se]),b]])),circle:X(et([[N,Ie],[N,N],[N,b]]),{}),center:X(et([[pe],[ae]]),{allowDotCall:!0}),radius:X(et([[pe],[ae]]),{allowDotCall:!0}),intersection:X(et([[ib,ib]])),strictintersection:X(et([[ib,ib]])),parallel:X(et([[pM,N]])),perpendicular:X(et([[pM,N]])),anglebisector:X(et([[iI]])),start:X([q([ye]),q([Fe])],{allowDotCall:!0}),end:X([q([ye]),q([Fe])],{allowDotCall:!0}),length:X([gt([Oo],{geometry:!1,\"3d\":!1}),q([Jt]),q([Fe]),q([Ie]),q([ye]),q([ae]),gt({type:\"variadic\",initial:[Pn],rest:Pn},{geometry:!1,\"3d\":!1})],{allowDotCall:!0}),translate:X(et([[mm,ye],[mm,N,N]])),dilate:X(et([[mm,N,b]])),rotate:X(et([[mm,N,b]])),reflect:X(et([[mm,pM]])),apply:X(et([[Ne,mm]])),points:X([]),lines:X([]),circles:X([]),arcs:X([]),polygons:X([]),rays:X([]),vectors:X([]),angle:X(et([[N,N,N]])),directedangle:X(et([[N,N,N]])),angles:X(Wi([[Se]]),{allowDotCall:!0}),directedangles:X(Wi([[Se]]),{allowDotCall:!0}),coterminal:X(et([[ve],[Te]])),round:X([...et([[ge],[ge,b]]),...et([[O],[O,b]])]),mod:X([...et([[ge,ge]]),...et([[O,O]])]),floor:X([...et([[ge]]),...et([[O]])]),ceil:X([...et([[ge]]),...et([[O]])]),abs:X([...et([[ge]]),...et([[O]])]),sign:X([q([ge]),q([O])]),coerceToReal:X([...et([[Pn]])]),real:X([q([O])],{allowDotCall:!0}),imag:X([q([O])],{allowDotCall:!0}),conj:X([...et([[ge]]),...et([[O]])]),exp:X([q([ge]),q([O])]),sin:X([q([ge]),q([O])]),cos:X([q([ge]),q([O])]),tan:X([q([ge]),q([O])]),sinh:X([q([ge]),q([O])]),cosh:X([q([ge]),q([O])]),tanh:X([q([ge]),q([O])]),sec:X([q([ge]),q([O])]),csc:X([q([ge]),q([O])]),cot:X([q([ge]),q([O])]),sech:X([q([ge]),q([O])]),csch:X([q([ge]),q([O])]),coth:X([q([ge]),q([O])]),arctan:X([q([ge]),q([O]),...et([[b,b]])]),arcsinh:X([q([ge]),q([O])]),arccot:X([q([ge]),q([O])]),arccsch:X([q([ge]),q([O])]),nthroot:X([...et([[b,b]])]),complexNthRoot:X([...et([[O,O]])]),sort:X(Wi([[$i],[He],[Oo,$i],[Oo,He]]),{minArityExampleArgs:\"([3,2,1])\",maxArityExampleArgs:\"([1,2,3],[3,2,1])\",dotMaxArityExampleArgs:\"([3,4])\",allowDotCall:!0}),shuffle:X(Wi([[Pt,Oo],[Pt,Oo,b]]),{minArityExampleArgs:\"([1,2,3])\",maxArityExampleArgs:\"([1,2,3],2)\",dotMaxArityExampleArgs:\"(2)\",allowDotCall:!0,isSeeded:!0}),join:X(Wi([{type:\"variadic\",initial:[dM,dM],rest:dM}]),{minArityExampleArgs:\"([1,2],[3,4])\",dotMinArityExampleArgs:\"([3,4])\",allowDotCall:!0}),unique:X(Wi([[cr.of(Oo.types.filter(e=>e!==so&&e!==Yn),{coerceComplexToReal:!1})]]),{minArityExampleArgs:\"([1,2,3])\",maxArityExampleArgs:\"([1,2,3])\",allowDotCall:!0}),normaldist:X(et([[b,b]]),{defaultArguments:[Qu,Ac]}),tdist:X(et([[b,b,b]]),{defaultArguments:[Qu,Ac]}),chisqdist:X(et([[b]])),binomialdist:X(et([[b,b]]),{defaultArguments:[Yf]}),poissondist:X(et([[b]])),uniformdist:X(et([[b,b]]),{defaultArguments:[Qu,Ac]}),pdf:X(et([[Sn,b]]),{allowDotCall:!0}),cdf:X(et([[Sn,b],[Sn,b,b]]),{allowDotCall:!0}),median:X([...et([[Sn]]),...Un(b)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),stdev:X([...et([[Sn]]),...Un(ge),...Un(O)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),stdevp:X([...Un(ge),...Un(O)],{allowDotCall:!0}),var:X([...et([[Sn]]),...Un(ge),...Un(O)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),cov:X([...dm(ge),...dm(O)]),covp:X([...dm(ge),...dm(O)]),corr:X([...dm(ge),...dm(O)]),quantile:X([...et([[Sn,b]]),gt([Y,Cr(b)])],{fallthroughUnlessDistribution:!0,allowDotCall:!0,minArityExampleArgs:\"([1,2,3], 1)\",maxArityExampleArgs:\"([1,2,3], 1)\",dotMinArityExampleArgs:\"(x)\",dotMaxArityExampleArgs:\"(x)\"}),random:X([gt([Pt]),...Wi([[Pt,b],[Pt,b,b],[Pt,mM],[Pt,mM,b],[Pt,mM,b,b]])],{allowDotCall:!0,isSeeded:!0}),polygon:X([gt([]),...Un(N),...Wi([[Y,Y],[b,Y],[Y,b]])]),total:X([...Un(ge),...Un(O),...Un(N),...Un(F)],{allowDotCall:!0}),mean:X([q([Sn]),...Un(ge),...Un(O),...Un(N),...Un(F)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),varp:X([q([Sn]),...Un(ge),...Un(O)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),mad:X([...Un(ge),...Un(O)]),lcm:X([...Un(ge),...Un(O)],{allowDotCall:!0}),gcd:X([...Un(ge),...Un(O)],{allowDotCall:!0}),min:X([...Un(b),q([Et])],{allowDotCall:!0}),lower:X([q([Et])],{allowDotCall:!0}),max:X([...Un(b),q([Et])],{allowDotCall:!0}),upper:X([q([Et])],{allowDotCall:!0}),ztest:X([gt([Y,Cr(b)]),q([b,b,b]),gt([Y,Cr(b),Y,Cr(b)]),q([b,b,b,b,b,b])]),zproptest:X(et([[b,b],[b,b,b,b]])),ttest:X([gt([Y]),q([b,b,b]),gt([Y,Y]),q([b,b,b,b,b,b])]),null:X([q([St,b]),q([Mt,b]),q([Ut,b]),q([Ht,b]),q([qt,b]),q([$t,b]),q([Yt,b])],{allowDotCall:!0}),conf:X([q([St,b]),q([Mt,b]),q([Ut,b]),q([Ht,b]),q([qt,b]),q([$t,b]),q([Yt,b])],{allowDotCall:!0}),score:X([q([Ot]),q([St]),q([Mt]),q([Ut]),q([Ht]),q([qt]),q([$t]),q([Yt])],{allowDotCall:!0}),pleft:X([q([Ot]),q([St]),q([Mt]),q([Ut]),q([Ht]),q([qt]),q([$t]),q([Yt])],{allowDotCall:!0}),pright:X([q([Ot]),q([St]),q([Mt]),q([Ut]),q([Ht]),q([qt]),q([$t]),q([Yt])],{allowDotCall:!0}),dof:X([q([St]),q([Mt]),q([Ot])],{allowDotCall:!0}),stderr:X([q([St]),q([Mt]),q([Ut]),q([Ht]),q([qt]),q([$t]),q([Yt])],{allowDotCall:!0}),point:X([q([St]),q([Mt]),q([Ut]),q([Ht]),q([qt]),q([$t]),q([Yt])],{allowDotCall:!0}),chisqtest:X(Wi([{type:\"variadic\",initial:[Y,Y],rest:Y}])),chisqgof:X(Wi([[Y],[Y,Y]])),chisqscore:X(Wi([{type:\"variadic\",initial:[Y,Y],rest:Y}])),chisqgofscore:X(Wi([[Y,Y]])),histogram:Iu(),dotplot:Iu(),boxplot:Iu(),ittest:Iu(),stats:Iu(),det:Iu(),inv:Iu(),transpose:Iu(),rref:Iu(),trace:Iu()};function kz(e){switch(e){case\"default\":case\"trig\":case\"inverseTrig\":case\"trig2\":case\"never-broadcast\":return[b];case\"reducer\":return[Y];case\"doubleReducer\":return[Y,Y];case\"parameterizedReducer\":return[Y,b];case\"color\":return[b,b,b]}}function $z(e){switch(e){case\"default\":case\"trig\":case\"inverseTrig\":case\"trig2\":case\"doubleReducer\":case\"color\":case\"never-broadcast\":return!1;case\"reducer\":case\"parameterizedReducer\":return!0}}function Yz(e,t,n){return e===\"reducer\"?1/0:t+n}function R(e,t,n){var d,y,g,f,h;n===void 0&&(n={});let r=(d=n.tag)!=null?d:\"default\",s=(y=n.argumentTypes)!=null?y:kz(r),o=n.defaultArguments?n.defaultArguments.length:0,i=s.length-o,a=Yz(r,i,o),u=(g=n.allowDotCall)!=null?g:$z(r),c=(f=n.noPeel)!=null?f:!1,{defaultArguments:p,minArityExampleArgs:l,maxArityExampleArgs:m}=n;return{module:e,symbol:t,argumentTypes:s,defaultArguments:p,returnType:(h=n.returnType)!=null?h:b,tag:r,minArity:i,maxArity:a,allowDotCall:u,noPeel:c,minArityExampleArgs:l,maxArityExampleArgs:m}}function _c(e){let t;return e in Wn&&(t=Wn[e].tag),t===\"trig\"||t===\"trig2\"||t===\"inverseTrig\"?!0:e===\"angle\"||e===\"angles\"||e===\"directedangle\"||e===\"directedangles\"||e===\"rotate\"}var Wn={sin:R(\"BuiltIn\",\"sin\",{tag:\"trig\"}),cos:R(\"BuiltIn\",\"cos\",{tag:\"trig\"}),tan:R(\"BuiltIn\",\"tan\",{tag:\"trig\"}),cot:R(\"BuiltIn\",\"cot\",{tag:\"trig\"}),sec:R(\"BuiltIn\",\"sec\",{tag:\"trig\"}),csc:R(\"BuiltIn\",\"csc\",{tag:\"trig\"}),arcsin:R(\"Math\",\"asin\",{tag:\"inverseTrig\"}),arccos:R(\"Math\",\"acos\",{tag:\"inverseTrig\"}),arctan:R(\"Math\",\"atan2\",{argumentTypes:[b,b],tag:\"inverseTrig\"}),arccot:R(\"BuiltIn\",\"acot\",{tag:\"inverseTrig\"}),arcsec:R(\"BuiltIn\",\"asec\",{tag:\"inverseTrig\"}),arccsc:R(\"BuiltIn\",\"acsc\",{tag:\"inverseTrig\"}),sinh:R(\"BuiltIn\",\"sinh\"),cosh:R(\"BuiltIn\",\"cosh\"),tanh:R(\"BuiltIn\",\"tanh\"),coth:R(\"BuiltIn\",\"coth\"),sech:R(\"BuiltIn\",\"sech\"),csch:R(\"BuiltIn\",\"csch\"),arcsinh:R(\"BuiltIn\",\"asinh\"),arccosh:R(\"BuiltIn\",\"acosh\"),arctanh:R(\"BuiltIn\",\"atanh\"),arccoth:R(\"BuiltIn\",\"acoth\"),arcsech:R(\"BuiltIn\",\"asech\"),arccsch:R(\"BuiltIn\",\"acsch\"),sqrt:R(\"Math\",\"sqrt\"),rtxsqpone:R(\"BuiltIn\",\"sqrtxsqp1\"),rtxsqmone:R(\"BuiltIn\",\"sqrtxsqm1\"),hypot:R(\"BuiltIn\",\"hypot\",{argumentTypes:[b,b]}),log:R(\"BuiltIn\",\"common_log\"),logbase:R(\"BuiltIn\",\"log_base\",{argumentTypes:[b,b]}),ln:R(\"BuiltIn\",\"log\"),exp:R(\"Math\",\"exp\"),floor:R(\"Math\",\"floor\"),complexFloor:R(\"BuiltIn\",\"complexFloor\",{argumentTypes:[O],returnType:O}),ceil:R(\"Math\",\"ceil\"),complexCeil:R(\"BuiltIn\",\"complexCeil\",{argumentTypes:[O],returnType:O}),round:R(\"Math\",\"round\"),complexRound:R(\"BuiltIn\",\"complexRound\",{argumentTypes:[O],returnType:O}),abs:R(\"Math\",\"abs\"),sign:R(\"BuiltIn\",\"sign\"),mod:R(\"BuiltIn\",\"mod\",{argumentTypes:[b,b]}),complexMod:R(\"BuiltIn\",\"complexMod\",{argumentTypes:[O,O],returnType:O}),nCr:R(\"BuiltIn\",\"nCr\",{argumentTypes:[b,b]}),nPr:R(\"BuiltIn\",\"nPr\",{argumentTypes:[b,b]}),factorial:R(\"BuiltIn\",\"factorial\"),polyGamma:R(\"BuiltIn\",\"polyGamma\",{argumentTypes:[b,b]}),lcm:R(\"BuiltIn\",\"listLCM\",{tag:\"reducer\"}),complexLCM:R(\"BuiltIn\",\"complexListLCM\",{argumentTypes:[He],returnType:O,tag:\"reducer\"}),gcd:R(\"BuiltIn\",\"listGCD\",{tag:\"reducer\"}),complexGCD:R(\"BuiltIn\",\"complexListGCD\",{argumentTypes:[He],returnType:O,tag:\"reducer\"}),distance:R(\"BuiltIn\",\"distance\",{argumentTypes:[N,N]}),polygon:R(\"BuiltIn\",\"polygon\",{tag:\"reducer\",argumentTypes:[Gt],returnType:Se}),area:R(\"BuiltIn\",\"polygonArea\",{argumentTypes:[Se]}),perimeter:R(\"BuiltIn\",\"polygonPerimeter\",{argumentTypes:[Se]}),pointDet:R(\"BuiltIn\",\"pointDet\",{argumentTypes:[N,N]}),pointDot:R(\"BuiltIn\",\"pointDot\",{argumentTypes:[N,N]}),pointPerp:R(\"BuiltIn\",\"pointPerp\",{argumentTypes:[N],returnType:N}),complexMultiplyPoints:R(\"BuiltIn\",\"complexMultiplyPoints\",{argumentTypes:[N,N],returnType:N}),segment:R(\"BuiltIn\",\"segment\",{argumentTypes:[N,N],returnType:Ie}),line:R(\"BuiltIn\",\"line\",{argumentTypes:[N,N],returnType:Pe}),ray:R(\"BuiltIn\",\"ray\",{argumentTypes:[N,N],returnType:De}),vector:R(\"BuiltIn\",\"vector\",{argumentTypes:[N,N],returnType:ye}),vectorThreeD:R(\"BuiltIn\",\"vectorThreeD\",{argumentTypes:[F,F],returnType:Fe}),mathVector:R(\"BuiltIn\",\"mathVector\",{argumentTypes:[N,N],returnType:ye}),mathVectorThreeD:R(\"BuiltIn\",\"mathVectorThreeD\",{argumentTypes:[F,F],returnType:Fe}),vectorDisplacementAsPoint:R(\"BuiltIn\",\"vectorDisplacementAsPoint\",{argumentTypes:[ye],returnType:N}),vectorThreeDDisplacementAsPoint:R(\"BuiltIn\",\"vectorThreeDDisplacementAsPoint\",{argumentTypes:[Fe],returnType:F}),basePointFromVector:R(\"BuiltIn\",\"basePointFromVector\",{argumentTypes:[ye],returnType:N}),basePointFromVectorThreeD:R(\"BuiltIn\",\"basePointFromVectorThreeD\",{argumentTypes:[Fe],returnType:F}),circle:R(\"BuiltIn\",\"circle\",{argumentTypes:[N,b],returnType:pe}),center:R(\"BuiltIn\",\"center\",{argumentTypes:[pe],returnType:N,allowDotCall:!0}),radius:R(\"BuiltIn\",\"radius\",{argumentTypes:[pe],returnType:b,allowDotCall:!0}),arc:R(\"BuiltIn\",\"arc\",{argumentTypes:[N,N,N],returnType:ae}),arcCenter:R(\"BuiltIn\",\"arcCenter\",{argumentTypes:[ae],returnType:N}),arcFirstPoint:R(\"BuiltIn\",\"arcFirstPoint\",{argumentTypes:[ae],returnType:N}),arcMiddlePoint:R(\"BuiltIn\",\"arcMiddlePoint\",{argumentTypes:[ae],returnType:N}),arcThirdPoint:R(\"BuiltIn\",\"arcThirdPoint\",{argumentTypes:[ae],returnType:N}),arcOmega:R(\"BuiltIn\",\"arcOmega\",{argumentTypes:[ae],returnType:b}),undirectedAngleMarker:R(\"BuiltIn\",\"undirectedAngleMarker\",{argumentTypes:[Te],returnType:ve}),directedAngleMarker:R(\"BuiltIn\",\"directedAngleMarker\",{argumentTypes:[N,b,b,b],returnType:Te}),directedCoterminalAngle:R(\"BuiltIn\",\"directedCoterminalAngle\",{argumentTypes:[Te],returnType:Te}),undirectedCoterminalAngle:R(\"BuiltIn\",\"undirectedCoterminalAngle\",{argumentTypes:[ve],returnType:ve}),supplement:R(\"BuiltIn\",\"supplementAngle\",{argumentTypes:[Te],returnType:Te}),directedAngleMarkerRawDelta:R(\"BuiltIn\",\"angleMarkerRawDelta\",{argumentTypes:[Te],returnType:b}),undirectedAngleMarkerRawDelta:R(\"BuiltIn\",\"angleMarkerRawDelta\",{argumentTypes:[ve],returnType:b}),directedAngleMarkerMultiplier:R(\"BuiltIn\",\"angleMarkerMultiplier\",{argumentTypes:[Te],returnType:b}),undirectedAngleMarkerMultiplier:R(\"BuiltIn\",\"angleMarkerMultiplier\",{argumentTypes:[ve],returnType:b}),polygonInteriorUndirectedAngles:R(\"BuiltIn\",\"polygonInteriorUndirectedAngles\",{argumentTypes:[Se,b],returnType:Er,allowDotCall:!0,tag:\"never-broadcast\"}),polygonInteriorDirectedAngles:R(\"BuiltIn\",\"polygonInteriorDirectedAngles\",{argumentTypes:[Se,b],returnType:Sr,allowDotCall:!0,tag:\"never-broadcast\"}),vertices:R(\"BuiltIn\",\"vertices\",{argumentTypes:[Se],returnType:Gt,allowDotCall:!0,tag:\"never-broadcast\"}),segments:R(\"BuiltIn\",\"polygonEdges\",{argumentTypes:[Se],returnType:lr,allowDotCall:!0,tag:\"never-broadcast\"}),scaleTangentTransformation:R(\"BuiltIn\",\"scaleTangentTransformation\",{argumentTypes:[Ne,b],returnType:Se}),scaleTangentPolygon:R(\"BuiltIn\",\"scaleTangentPolygon\",{argumentTypes:[Se,b],returnType:Se}),scaleTangentSegment:R(\"BuiltIn\",\"scaleTangentSegment\",{argumentTypes:[Ie,b],returnType:Ie}),scaleTangentLine:R(\"BuiltIn\",\"scaleTangentLine\",{argumentTypes:[Pe,b],returnType:Pe}),scaleTangentRay:R(\"BuiltIn\",\"scaleTangentRay\",{argumentTypes:[De,b],returnType:De}),scaleTangentCircle:R(\"BuiltIn\",\"scaleTangentCircle\",{argumentTypes:[pe,b],returnType:pe}),scaleTangentArc:R(\"BuiltIn\",\"scaleTangentArc\",{argumentTypes:[ae,b],returnType:pe}),scaleTangentDirectedAngleMarker:R(\"BuiltIn\",\"scaleTangentAngle\",{argumentTypes:[Te,b],returnType:Te}),scaleTangentUndirectedAngleMarker:R(\"BuiltIn\",\"scaleTangentAngle\",{argumentTypes:[ve,b],returnType:ve}),addTangentPolygon:R(\"BuiltIn\",\"addTangentPolygon\",{argumentTypes:[Se,Se],returnType:Se}),addTangentSegment:R(\"BuiltIn\",\"addTangentSegment\",{argumentTypes:[Ie,Ie],returnType:Ie}),addTangentSegmentThreeD:R(\"BuiltIn\",\"addTangentSegmentThreeD\",{argumentTypes:[Jt,Jt],returnType:Jt}),addTangentLine:R(\"BuiltIn\",\"addTangentLine\",{argumentTypes:[Pe,Pe],returnType:Pe}),addTangentRay:R(\"BuiltIn\",\"addTangentRay\",{argumentTypes:[De,De],returnType:De}),addTangentVector:R(\"BuiltIn\",\"addTangentVector\",{argumentTypes:[ye,ye],returnType:ye}),addTangentCircle:R(\"BuiltIn\",\"addTangentCircle\",{argumentTypes:[pe,pe],returnType:pe}),addTangentArc:R(\"BuiltIn\",\"addTangentArc\",{argumentTypes:[ae,ae],returnType:ae}),addTangentTransformation:R(\"BuiltIn\",\"addTangentTransformation\",{argumentTypes:[Ne,Ne],returnType:Ne}),addTangentDirectedAngleMarker:R(\"BuiltIn\",\"addTangentAngle\",{argumentTypes:[Te,Te],returnType:Te}),addTangentUndirectedAngleMarker:R(\"BuiltIn\",\"addTangentAngle\",{argumentTypes:[ve,ve],returnType:ve}),segmentGlider:R(\"BuiltIn\",\"segmentGlider\",{argumentTypes:[Ie,b],returnType:N}),segmentThreeDGlider:R(\"BuiltIn\",\"segmentThreeDGlider\",{argumentTypes:[Jt,b],returnType:F}),lineGlider:R(\"BuiltIn\",\"lineGlider\",{argumentTypes:[Pe,b],returnType:N}),rayGlider:R(\"BuiltIn\",\"rayGlider\",{argumentTypes:[De,b],returnType:N}),circleGlider:R(\"BuiltIn\",\"circleGlider\",{argumentTypes:[pe,b],returnType:N}),arcGlider:R(\"BuiltIn\",\"arcGlider\",{argumentTypes:[ae,b],returnType:N}),polygonEdgeByParameter:R(\"BuiltIn\",\"polygonEdgeByParameter\",{argumentTypes:[Se,b],returnType:Ie}),polygonGlider:R(\"BuiltIn\",\"polygonGlider\",{argumentTypes:[Se,b],returnType:N}),chooseNonIncidentPoint:R(\"BuiltIn\",\"chooseNonIncidentPoint\",{argumentTypes:[N,N,N],returnType:N}),circleCircleIntersection:R(\"BuiltIn\",\"circleCircleIntersection\",{argumentTypes:[pe,pe,b],returnType:N}),circleArcIntersection:R(\"BuiltIn\",\"circleArcIntersection\",{argumentTypes:[pe,ae,b],returnType:N}),circleLineIntersection:R(\"BuiltIn\",\"circleLineIntersection\",{argumentTypes:[pe,Pe,b],returnType:N}),arcCircleIntersection:R(\"BuiltIn\",\"arcCircleIntersection\",{argumentTypes:[ae,pe,b],returnType:N}),arcArcIntersection:R(\"BuiltIn\",\"arcArcIntersection\",{argumentTypes:[ae,ae,b],returnType:N}),arcLineIntersection:R(\"BuiltIn\",\"arcLineIntersection\",{argumentTypes:[ae,Pe,b],returnType:N}),lineCircleIntersection:R(\"BuiltIn\",\"lineCircleIntersection\",{argumentTypes:[Pe,pe,b],returnType:N}),lineArcIntersection:R(\"BuiltIn\",\"lineArcIntersection\",{argumentTypes:[Pe,ae,b],returnType:N}),lineLineIntersection:R(\"BuiltIn\",\"lineLineIntersection\",{argumentTypes:[Pe,Pe,b],returnType:N}),lineFromSegment:R(\"BuiltIn\",\"identity\",{argumentTypes:[Ie],returnType:Pe}),lineFromRay:R(\"BuiltIn\",\"identity\",{argumentTypes:[De],returnType:Pe}),parallel:R(\"BuiltIn\",\"parallel\",{argumentTypes:[Pe,N],returnType:Pe}),perpendicular:R(\"BuiltIn\",\"perpendicular\",{argumentTypes:[Pe,N],returnType:Pe}),anglebisector:R(\"BuiltIn\",\"anglebisector\",{argumentTypes:[ve],returnType:De}),directedanglebisector:R(\"BuiltIn\",\"anglebisector\",{argumentTypes:[Te],returnType:De}),rawTransform:R(\"BuiltIn\",\"rawTransform\",{argumentTypes:[N,N],returnType:Ne}),rawTransformConj:R(\"BuiltIn\",\"rawTransformConj\",{argumentTypes:[N,N],returnType:Ne}),transformWithoutTranslation:R(\"BuiltIn\",\"transformWithoutTranslation\",{argumentTypes:[Ne],returnType:Ne}),transformScaleFactor:R(\"BuiltIn\",\"transformScaleFactor\",{argumentTypes:[Ne],returnType:N}),translation:R(\"BuiltIn\",\"translation\",{argumentTypes:[N],returnType:Ne}),dilation:R(\"BuiltIn\",\"dilation\",{argumentTypes:[N,b],returnType:Ne}),rotation:R(\"BuiltIn\",\"rotation\",{tag:\"trig2\",argumentTypes:[N,b],returnType:Ne}),reflection:R(\"BuiltIn\",\"reflection\",{argumentTypes:[Pe],returnType:Ne}),compose:R(\"BuiltIn\",\"composeTransformation\",{argumentTypes:[Ne,Ne],returnType:Ne}),inverse:R(\"BuiltIn\",\"invertTransformation\",{argumentTypes:[Ne],returnType:Ne}),transformPoint:R(\"BuiltIn\",\"transformPoint\",{argumentTypes:[Ne,N],returnType:N}),transformSegment:R(\"BuiltIn\",\"transformSegment\",{argumentTypes:[Ne,Ie],returnType:Ie}),transformLine:R(\"BuiltIn\",\"transformLine\",{argumentTypes:[Ne,Pe],returnType:Pe}),transformRay:R(\"BuiltIn\",\"transformRay\",{argumentTypes:[Ne,De],returnType:De}),transformVector:R(\"BuiltIn\",\"transformVector\",{argumentTypes:[Ne,ye],returnType:ye}),transformCircle:R(\"BuiltIn\",\"transformCircle\",{argumentTypes:[Ne,pe],returnType:pe}),transformArc:R(\"BuiltIn\",\"transformArc\",{argumentTypes:[Ne,ae],returnType:ae}),transformPolygon:R(\"BuiltIn\",\"transformPolygon\",{argumentTypes:[Ne,Se],returnType:Se}),transformAngleMarker:R(\"BuiltIn\",\"transformAngleMarker\",{argumentTypes:[Ne,ve],returnType:ve}),transformDirectedAngleMarker:R(\"BuiltIn\",\"transformAngleMarker\",{argumentTypes:[Ne,Te],returnType:Te}),distanceThreeD:R(\"BuiltIn\",\"distanceThreeD\",{argumentTypes:[F,F]}),segmentThreeD:R(\"BuiltIn\",\"segmentThreeD\",{argumentTypes:[F,F],returnType:Jt}),triangle:R(\"BuiltIn\",\"triangle\",{argumentTypes:[F,F,F],returnType:Kn}),sphere:R(\"BuiltIn\",\"sphere\",{argumentTypes:[F,b],returnType:Mr}),mean:R(\"BuiltIn\",\"mean\",{tag:\"reducer\"}),total:R(\"BuiltIn\",\"total\",{tag:\"reducer\"}),stdev:R(\"BuiltIn\",\"stdev\",{tag:\"reducer\"}),stdevp:R(\"BuiltIn\",\"stdevp\",{tag:\"reducer\"}),mad:R(\"BuiltIn\",\"mad\",{tag:\"reducer\"}),count:R(\"BuiltIn\",\"listLength\",{tag:\"reducer\",argumentTypes:[Yn],noPeel:!0}),listMin:R(\"BuiltIn\",\"listMin\",{tag:\"reducer\"}),listMax:R(\"BuiltIn\",\"listMax\",{tag:\"reducer\"}),min:R(\"Math\",\"min\",{argumentTypes:[b,b],returnType:b}),max:R(\"Math\",\"max\",{argumentTypes:[b,b],returnType:b}),argmin:R(\"BuiltIn\",\"argMin\",{tag:\"reducer\",noPeel:!0}),argmax:R(\"BuiltIn\",\"argMax\",{tag:\"reducer\",noPeel:!0}),median:R(\"BuiltIn\",\"median\",{tag:\"reducer\"}),var:R(\"BuiltIn\",\"variance\",{tag:\"reducer\"}),varp:R(\"BuiltIn\",\"varp\",{tag:\"reducer\"}),cov:R(\"BuiltIn\",\"cov\",{tag:\"doubleReducer\"}),covp:R(\"BuiltIn\",\"covp\",{tag:\"doubleReducer\"}),corr:R(\"BuiltIn\",\"corr\",{tag:\"doubleReducer\"}),spearman:R(\"BuiltIn\",\"spearman\",{tag:\"doubleReducer\"}),quantile:R(\"BuiltIn\",\"quantile\",{tag:\"parameterizedReducer\"}),quartile:R(\"BuiltIn\",\"quartile\",{tag:\"parameterizedReducer\"}),upperQuantileIndex:R(\"BuiltIn\",\"upperQuantileIndex\",{tag:\"parameterizedReducer\"}),lowerQuantileIndex:R(\"BuiltIn\",\"lowerQuantileIndex\",{tag:\"parameterizedReducer\"}),quartileIndex:R(\"BuiltIn\",\"quartileIndex\",{tag:\"parameterizedReducer\"}),upperQuartileIndex:R(\"BuiltIn\",\"upperQuartileIndex\",{tag:\"parameterizedReducer\"}),lowerQuartileIndex:R(\"BuiltIn\",\"lowerQuartileIndex\",{tag:\"parameterizedReducer\"}),normalcdf:R(\"BuiltIn\",\"normalcdf\",{argumentTypes:[b,b,b,b],defaultArguments:[Qu,Ac]}),normalpdf:R(\"BuiltIn\",\"normalpdf\",{argumentTypes:[b,b,b],defaultArguments:[Qu,Ac]}),binomcdf:R(\"BuiltIn\",\"binomcdf\",{argumentTypes:[b,b,b,b],defaultArguments:[Yf]}),binompdf:R(\"BuiltIn\",\"binompdf\",{argumentTypes:[b,b,b],defaultArguments:[Yf]}),poissoncdf:R(\"BuiltIn\",\"poissoncdf\",{argumentTypes:[b,b,b]}),poissonpdf:R(\"BuiltIn\",\"poissonpdf\",{argumentTypes:[b,b,b]}),uniformcdf:R(\"BuiltIn\",\"uniformcdf\",{argumentTypes:[b,b,b,b],defaultArguments:[Qu,Ac]}),uniformpdf:R(\"BuiltIn\",\"uniformpdf\",{argumentTypes:[b,b,b],defaultArguments:[Qu,Ac]}),invT:R(\"BuiltIn\",\"invT\",{argumentTypes:[b,b]}),invPoisson:R(\"BuiltIn\",\"invPoisson\",{argumentTypes:[b,b]}),invBinom:R(\"BuiltIn\",\"invBinom\",{argumentTypes:[b,b,b]}),invUniform:R(\"BuiltIn\",\"invUniform\",{argumentTypes:[b,b,b]}),tpdf:R(\"BuiltIn\",\"tpdf\",{argumentTypes:[b,b]}),tcdf:R(\"BuiltIn\",\"tcdf\",{argumentTypes:[b,b,b,b,b]}),erf:R(\"BuiltIn\",\"erf\"),invNorm:R(\"BuiltIn\",\"invNorm\"),tscore:R(\"BuiltIn\",\"tscore\",{tag:\"parameterizedReducer\",defaultArguments:[Qu]}),normalSample:R(\"BuiltIn\",\"normalSample\",{argumentTypes:[Pt,b,b]}),uniformSample:R(\"BuiltIn\",\"uniformSample\",{argumentTypes:[Pt,b,b]}),tSample:R(\"BuiltIn\",\"tSample\",{argumentTypes:[Pt,b]}),poissonSample:R(\"BuiltIn\",\"poissonSample\",{argumentTypes:[Pt,b]}),binomSample:R(\"BuiltIn\",\"binomSample\",{argumentTypes:[Pt,b,b]}),rgb:R(\"BuiltIn\",\"rgb\",{returnType:pn,tag:\"color\"}),hsv:R(\"BuiltIn\",\"hsv\",{returnType:pn,tag:\"color\"}),tone:R(\"BuiltIn\",\"tone\",{argumentTypes:[b,b],returnType:Qn,defaultArguments:[Yf],minArityExampleArgs:\"(440)\",maxArityExampleArgs:\"(440, 0.5)\"}),validateRangeLength:R(\"BuiltIn\",\"validateRangeLength\",{returnType:b,argumentTypes:[Y,Y,b,b],tag:\"never-broadcast\",noPeel:!0}),validateSampleCount:R(\"BuiltIn\",\"validateSampleCount\",{returnType:b,argumentTypes:[b]}),select:R(\"BuiltIn\",\"select\",{argumentTypes:[Yn,ro],returnType:e=>e[0],tag:\"never-broadcast\",noPeel:!0}),shuffle:R(\"BuiltIn\",\"shuffle\",{argumentTypes:[Pt,Yn],returnType:e=>e[1],tag:\"never-broadcast\"}),sortPerm:R(\"BuiltIn\",\"sortPerm\",{argumentTypes:[Y],returnType:Y,tag:\"never-broadcast\",noPeel:!0}),complexSortPerm:R(\"BuiltIn\",\"complexSortPerm\",{argumentTypes:[He],returnType:Y,tag:\"never-broadcast\",noPeel:!0}),elementsAt:R(\"BuiltIn\",\"elementsAt\",{argumentTypes:[Yn,Y],returnType:e=>e[0],tag:\"never-broadcast\",noPeel:!0}),uniquePerm:R(\"BuiltIn\",\"uniquePerm\",{argumentTypes:[Yn],returnType:Y,tag:\"never-broadcast\",noPeel:!0}),restriction:R(\"BuiltIn\",\"restriction\",{argumentTypes:[Re],returnType:nn}),restrictionToBoolean:R(\"BuiltIn\",\"restrictionToBoolean\",{argumentTypes:[nn],returnType:Re}),complex:R(\"BuiltIn\",\"complex\",{argumentTypes:[b,b],returnType:O}),arg:R(\"BuiltIn\",\"arg\",{argumentTypes:[O],returnType:b}),wirtingerEqualOrWarning:R(\"BuiltIn\",\"wirtingerEqualOrWarning\",{argumentTypes:[O,O],returnType:O}),complexDivide:R(\"BuiltIn\",\"complexDivide\",{argumentTypes:[O,O],returnType:O}),peelableCoerceComplexToReal:R(\"BuiltIn\",\"coerceComplexToReal\",{argumentTypes:[O],returnType:b}),peelableCoerceComplexToRealWithTolerance:R(\"BuiltIn\",\"coerceComplexToReal\",{argumentTypes:[O],returnType:b}),coerceComplexToReal:R(\"BuiltIn\",\"coerceComplexToReal\",{argumentTypes:[O],returnType:b}),coerceComplexToRealWithTolerance:R(\"BuiltIn\",\"coerceComplexToRealWithTolerance\",{argumentTypes:[O],returnType:b}),coerceRealToComplex:R(\"BuiltIn\",\"coerceRealToComplex\",{argumentTypes:[b],returnType:O}),complexSqrt:R(\"BuiltIn\",\"complexSqrt\",{argumentTypes:[O],returnType:O}),complexLn:R(\"BuiltIn\",\"complexLog\",{argumentTypes:[O],returnType:O}),complexLogbase:R(\"BuiltIn\",\"complexLogbase\",{argumentTypes:[O,O],returnType:O}),complexLog:R(\"BuiltIn\",\"complexCommonLog\",{argumentTypes:[O],returnType:O}),complexExp:R(\"BuiltIn\",\"complexExp\",{argumentTypes:[O],returnType:O}),complexPow:R(\"BuiltIn\",\"complexPow\",{argumentTypes:[O,O],returnType:O}),complexSin:R(\"BuiltIn\",\"complexSin\",{argumentTypes:[O],returnType:O}),complexCos:R(\"BuiltIn\",\"complexCos\",{argumentTypes:[O],returnType:O}),complexTan:R(\"BuiltIn\",\"complexTan\",{argumentTypes:[O],returnType:O}),complexSinh:R(\"BuiltIn\",\"complexSinh\",{argumentTypes:[O],returnType:O}),complexCosh:R(\"BuiltIn\",\"complexCosh\",{argumentTypes:[O],returnType:O}),complexTanh:R(\"BuiltIn\",\"complexTanh\",{argumentTypes:[O],returnType:O}),complexSec:R(\"BuiltIn\",\"complexSec\",{argumentTypes:[O],returnType:O}),complexCsc:R(\"BuiltIn\",\"complexCsc\",{argumentTypes:[O],returnType:O}),complexCot:R(\"BuiltIn\",\"complexCot\",{argumentTypes:[O],returnType:O}),complexSech:R(\"BuiltIn\",\"complexSech\",{argumentTypes:[O],returnType:O}),complexCsch:R(\"BuiltIn\",\"complexCsch\",{argumentTypes:[O],returnType:O}),complexCoth:R(\"BuiltIn\",\"complexCoth\",{argumentTypes:[O],returnType:O}),complexArcsin:R(\"BuiltIn\",\"complexAsin\",{argumentTypes:[O],returnType:O}),complexArccos:R(\"BuiltIn\",\"complexAcos\",{argumentTypes:[O],returnType:O}),complexArctan:R(\"BuiltIn\",\"complexAtan\",{argumentTypes:[O],returnType:O}),complexArcsec:R(\"BuiltIn\",\"complexAsec\",{argumentTypes:[O],returnType:O}),complexArccsc:R(\"BuiltIn\",\"complexAcsc\",{argumentTypes:[O],returnType:O}),complexArccot:R(\"BuiltIn\",\"complexAcot\",{argumentTypes:[O],returnType:O}),complexArcsinh:R(\"BuiltIn\",\"complexAsinh\",{argumentTypes:[O],returnType:O}),complexArccosh:R(\"BuiltIn\",\"complexAcosh\",{argumentTypes:[O],returnType:O}),complexArctanh:R(\"BuiltIn\",\"complexAtanh\",{argumentTypes:[O],returnType:O}),complexArcsech:R(\"BuiltIn\",\"complexAsech\",{argumentTypes:[O],returnType:O}),complexArccsch:R(\"BuiltIn\",\"complexAcsch\",{argumentTypes:[O],returnType:O}),complexArccoth:R(\"BuiltIn\",\"complexAcoth\",{argumentTypes:[O],returnType:O}),angleVertex:R(\"BuiltIn\",\"angleVertex\",{argumentTypes:[ve],returnType:N}),angleStart:R(\"BuiltIn\",\"angleStart\",{argumentTypes:[ve],returnType:b}),directedAngleVertex:R(\"BuiltIn\",\"angleVertex\",{argumentTypes:[Te],returnType:N}),directedAngleStart:R(\"BuiltIn\",\"angleStart\",{argumentTypes:[Te],returnType:b}),chisqIndependenceTestInternal:R(\"BuiltIn\",\"chisqIndependenceTestInternal\",{argumentTypes:[Y,b,b],returnType:b,tag:\"never-broadcast\",noPeel:!0}),chisqcdf:R(\"BuiltIn\",\"chisqcdf\",{argumentTypes:[b,b,b],returnType:b,noPeel:!0}),chisqpdf:R(\"BuiltIn\",\"chisqpdf\",{argumentTypes:[b,b],returnType:b,noPeel:!0}),invChisq:R(\"BuiltIn\",\"invChisq\",{argumentTypes:[b,b]})},ym={sqrt:\"complexSqrt\",ln:\"complexLn\",log:\"complexLog\",logbase:\"complexLogbase\",exp:\"complexExp\",sin:\"complexSin\",cos:\"complexCos\",tan:\"complexTan\",sinh:\"complexSinh\",cosh:\"complexCosh\",tanh:\"complexTanh\",sec:\"complexSec\",csc:\"complexCsc\",cot:\"complexCot\",sech:\"complexSech\",csch:\"complexCsch\",coth:\"complexCoth\",arcsin:\"complexArcsin\",arccos:\"complexArccos\",arctan:\"complexArctan\",arcsec:\"complexArcsec\",arccsc:\"complexArccsc\",arccot:\"complexArccot\",arcsinh:\"complexArcsinh\",arccosh:\"complexArccosh\",arctanh:\"complexArctanh\",arcsech:\"complexArcsech\",arccsch:\"complexArccsch\",arccoth:\"complexArccoth\",floor:\"complexFloor\",ceil:\"complexCeil\",mod:\"complexMod\",nthroot:\"complexNthRoot\",sortPerm:\"complexSortPerm\"},Zz={sqrt:!0,ln:!0,log:!0,logbase:!0,arcsin:!0,arccos:!0,arcsec:!0,arccsc:!0,arccosh:!0,arctanh:!0,arcsech:!0,arccoth:!0,nthroot:!0};function ab(e,t){return e.isComplexEnabled()&&t in Zz?ym[t]:t}function fm(e){return!!Wn[e]}function Zf(e,t){let n=Ql(t)?Ra[t]:void 0;if(!n&&!fm(t))return;let r=[];return n&&(r=[...n.getSignatures(e)]),fm(t)&&!n&&r.push(...yM(t)),r}function yM(e){var s;let t=[],n=Wn[e],r=(s=n.returnType)!=null?s:b;switch(n.tag){case\"reducer\":{if(Array.isArray(n.argumentTypes)&&typeof n.argumentTypes[0]==\"number\"&&$(n.argumentTypes[0])&&typeof r==\"number\"&&Hn(r)){let o=n.argumentTypes[0],i=Xe(o);t.push(...Un(i))}else throw new Error(`Programming error: declared argumentTypes for built-in function ${e} is not consistent with \"reducer\"`);break}case\"parameterizedReducer\":{if(t.push(gt(n.argumentTypes)),Array.isArray(n.argumentTypes)&&n.argumentTypes.length===2){let o=n.argumentTypes[1];t.push(gt([n.argumentTypes[0],typeof o==\"number\"&&Hn(o)?Cr(o):o]))}break}case\"doubleReducer\":case\"never-broadcast\":{t.push(gt(n.argumentTypes));break}default:{t.push(gt(n.argumentTypes.map(o=>hg(o)?Cr(o):o)));break}}return t}var Ve=class extends k{constructor(t){super([]),this._symbol=vi(t),this._errorSymbol=this._symbol,this.addDependency(this._symbol)}setInputSpan(t){super.setInputSpan(t),this._errorSymbol=vi(this.getInputString())}getInputSpan(){return this._inputSpan===void 0?lo(this._symbol,0,this._symbol.length):this._inputSpan}},hn=class extends Ve{constructor(){super(...arguments);this.type=\"Identifier\"}};var En=class extends k{constructor(t,n){super(n,{skipRegisterDependencies:!0}),typeof t==\"string\"&&(t=new hn(t)),this._identifier=t,this._symbol=t._symbol,this._errorSymbol=t._errorSymbol===\"logbase\"?\"log\":t._errorSymbol,this.registerDependencies()}registerDependencies(){this.addDependency(this._symbol),super.registerDependencies(),_c(this._symbol)&&this.addDependency(\"trigAngleMultiplier\")}},xr=class extends En{constructor(){super(...arguments);this.type=\"FunctionCall\"}};var Di=class extends k{slot(t){return this.args[t]}},wc=class extends Di{constructor(){super(...arguments);this.type=\"ParenSeq\"}};var gM={pi:new Xn(Math.PI),tau:new Xn(2*Math.PI),e:new Xn(Math.E),trigAngleMultiplier:new Xn(be(1,1)),infty:new Xn(1/0),identityTransformation:new xr(\"translation\",[new wc([new Xn(0),new Xn(0)])])};var Kl=class extends lt{constructor(){super(...arguments);this.type=\"Placeholder\"}};var ep,rt={};for(ep of he(gM))rt[ep]=gM[ep];for(ep of he(Wn))rt[ep]=new Kl;for(ep of he(Ra))rt[ep]=new Kl;var gm=class extends lt{constructor(n,r){super();this.type=\"AssignmentImport\";this._symbol=n,this._importFrom=r,this._exports=[n]}};var Yr={\"<\":{inclusive:!1,direction:-1},\"!=\":{inclusive:!1,direction:0},\">\":{inclusive:!1,direction:1},\"<=\":{inclusive:!0,direction:-1},\"=\":{inclusive:!0,direction:0},\">=\":{inclusive:!0,direction:1}};function Lc(e,t){switch(t){case-1:return e?\"<=\":\"<\";case 0:return e?\"=\":\"!=\";case 1:return e?\">=\":\">\";default:throw\"Programming error.  Comparators must have a direction of -1, 0, or 1\"}}var Hs=class extends k{constructor(){super(...arguments);this.type=\"Subtract\"}};var os=class extends k{constructor(n,r){super(r);this.operator=n;this._difference=Yr[this.operator].direction===-1?new Hs([r[1],r[0]]):new Hs([r[0],r[1]])}asComparator(){return this}isInequality(){return Yr[this.operator].direction!==0}},Wf=class extends os{constructor(n){super(\"<\",n);this.type=\"Comparator['<']\"}},jf=class extends os{constructor(n){super(\"<=\",n);this.type=\"Comparator['<=']\"}},Jf=class extends os{constructor(n){super(\">\",n);this.type=\"Comparator['>']\"}},Qf=class extends os{constructor(n){super(\">=\",n);this.type=\"Comparator['>=']\"}},Oa=class extends os{constructor(n){super(\"=\",n);this.type=\"Comparator['=']\"}};function ub(e,t){switch(e){case\">\":return new Jf(t);case\"<\":return new Wf(t);case\">=\":return new Qf(t);case\"<=\":return new jf(t);case\"=\":return new Oa(t);default:throw new Error(`Unsupported operator ${e}`)}}var Fc=class extends lt{constructor(n,r){super();this.type=\"Equation\";this.mergeDependencies(n,r),this._lhs=n,this._rhs=r,this._difference=new Hs([this._lhs,this._rhs])}asComparator(){return new Oa([this._lhs,this._rhs])}};var Tr=class extends lt{constructor(n,r,s,o){super();this.recursionInfo=o;this.type=\"FunctionDefinition\";this.externalBaseCases=[];this._symbol=n._symbol,this._argSymbols=r.map(i=>i._symbol);for(let i of this._argSymbols)if(i===this._symbol)throw _E(i);this._exports=[this._symbol],this._expression=s,this.mergeDependenciesInScope(\"FunctionDefinition\",[this._symbol].concat(this._argSymbols),this._expression,{functionDefinitionSymbol:this._symbol}),this.combinedDependencies=super.getDependencies()}getDependencies(){return this.combinedDependencies}setExternalBaseCases(n){this.externalBaseCases=[...n],this.combinedDependencies=[...super.getDependencies()];for(let r of n){let s=r.getRef();s&&this.combinedDependencies.push(s)}}getExternalBaseCases(){return this.externalBaseCases}getSliderVariables(n,r){let s=this._argSymbols;return super.getSliderVariables(n,r).filter(o=>s.indexOf(o)===-1)}asEquation(){let n=this._argSymbols.map(s=>new hn(s)),r=new Fc(new xr(new hn(this._symbol),n),this._expression);return r.userData=this.userData,r.metaData=this.metaData,r}};var is=class e extends lt{constructor(n,r,s,o,i){super();this.specifiedArg=s;this.rhs=o;this.originalNode=i;this.type=\"RecursiveFunctionBaseCase\";if(this._symbol=n,this._argSymbols=r.map(a=>a._symbol),this._expression=o,this.userData=i.userData,this.metaData=i.metaData,this._inputSpan=i._inputSpan,this.mergeDependenciesInScope(\"FunctionDefinition\",this._argSymbols,this._expression,{functionDefinitionSymbol:this._symbol}),s.valid){let a=s.functionDefArgSymbols.slice();a[s.argIndex]=s.argValue.toString(),this.ref=`_base_case:${n}:${a.join(\",\")}`,this._exports=[this.ref]}else{let a=this._exports.find(u=>u.indexOf(\"idref\")!==-1);a&&(this.ref=a)}}static fromCallAssignment(n,r){let s=r._lhs;if(!(s instanceof En))return;let o=n[s._symbol];if(!o||!(o instanceof Tr))return;if(s.args.length!==o._argSymbols.length)return new e(o._symbol,[],{valid:!1,error:zI(o._symbol,o._argSymbols.length)},r._rhs,r);let i,a=[];for(let u=0;u<s.args.length;u++){let c=s.args[u];if(c instanceof _n){if(i){i={valid:!1,error:of()};break}i={valid:!0,argIndex:u,functionDefArgSymbols:o._argSymbols,argValue:c.asValue(),argSymbol:o._argSymbols[u]}}else if(c instanceof Ve)if(c._symbol!==o._argSymbols[u]){i={valid:!1,error:Ug()};break}else a.push(c);else{i={valid:!1,error:Ug()};break}}if(i)return new e(o._symbol,a,i,r._rhs,r)}getRef(){return this.ref}getSliderVariables(n,r){let s=this._argSymbols;return super.getSliderVariables(n,r).filter(o=>s.indexOf(o)===-1)}};var hm=class extends lt{constructor(n,r,s,o,i){super();this.type=\"OptimizedRegression\";this.parameters=n,this.residuals=r,this.statistics=s,this.model=o,this.isModelValid=i.isModelValid,this.residualVariable=i.residualVariable,this.residualSuggestionId=i.residualSuggestionId,this.shouldSuggestLogMode=i.shouldSuggestLogMode,this.isLinear=i.isLinear,this.parameterWarning=i.parameterWarning,this.displayPrecision=i.displayPrecision,this.scaleFactors=i.scaleFactors,this._exports=[this.residualVariable];for(let a of he(n))this._exports.push(a);this.mergeDependencies(o)}getCompiledFunction(){return this.model.getCompiledFunction.apply(this.model,arguments)}getCompiledDerivative(){return this.model.getCompiledDerivative.apply(this.model,arguments)}};var bm=class extends lt{constructor(n,r){super();this._symbol=n;this._optimizedRegression=r;this.type=\"RegressionParameter\"}asValue(){return this._optimizedRegression.parameters[this._symbol].asValue()}asCompilerValue(){return this._optimizedRegression.parameters[this._symbol].asCompilerValue()}};function DO(e){let t=1/0;for(let n=0;n<e.length;n++)(e[n].isList||e[n].isBroadcast)&&(t=Math.min(t,e[n].length));return t}var wo=class extends k{constructor(n){super(n);this.isList=!0;this.length=n.length}elementAt(n){if(n=Math.floor(n),n>=0&&n<this.args.length)return this.args[n];throw new Error(\"Out of bounds list access\")}eachElement(n){for(let r=0;r<this.length;r++)n(this.elementAt(r),r)}mapElements(n){let r=[];for(let s=0;s<this.length;s++)r.push(n(this.elementAt(s),s));return r}asValue(){let n=[];for(let r=0;r<this.args.length;r++)n.push(this.args[r].asValue());return n}asCompilerValue(){let n=[];for(let r=0;r<this.args.length;r++)n.push(this.args[r].asCompilerValue());return n}},Kf=class Kf extends wo{constructor(){super(...arguments);this.type=\"List\"}};Kf.eachArgs=function(n,r){let s=DO(n);if(!isFinite(s)){r(n);return}for(let o=0;o<s;o++){let i=[];for(let a=0;a<n.length;a++)i.push(hM(n[a])||$(n[a].valueType)?n[a].elementAt(o):n[a]);r(i,o)}},Kf.wrap=function(n){return n instanceof wo||$(n.valueType)?n:new Kf([n])};var Tm=Kf,xm=class xm extends wo{constructor(){super(...arguments);this.type=\"List\"}};xm.eachArgs=function(n,r){let s=DO(n);if(!isFinite(s)){r(n);return}for(let o=0;o<s;o++){let i=[];for(let a=0;a<n.length;a++)i.push(hM(n[a])||$(n[a].valueType)?n[a].elementAt(o):n[a]);r(i,o)}},xm.wrap=function(n){return n instanceof xm||$(n.valueType)?n:new xm([n])};var Es=xm;function ey(e){return(e==null?void 0:e.type)===\"FunctionDefinition\"}function Vc(e){return(e==null?void 0:e.type)===\"Placeholder\"||(e==null?void 0:e.type)===\"FunctionDefinition\"}function Aa(e){return e.type===\"Identifier\"}function Pu(e){return e.type===\"Table\"}function cb(e){return e.type===\"Image\"}function as(e){return e.type===\"Error\"}function Jo(e){return e.type===\"Regression\"}function Bc(e){return e.type===\"TableColumn\"}function Eu(e){return e.type===\"TableColumnValue\"}function Im(e){return e.type===\"IRExpression\"||e instanceof wo}function hM(e){return Im(e)&&e.isList}function lb(e){return(e==null?void 0:e.type)===\"Constant\"||(e==null?void 0:e.type)===\"IRExpression\"&&(e==null?void 0:e.isConstant)}function Pm(e){return(e==null?void 0:e.type)===\"MixedNumber\"||lb(e)}function Ni(e){return e.type===\"MovablePoint\"||e.type===\"MovableComplexNumber\"||e.type===\"IRExpression\"&&e.isTypedConstant}function pb(e){return(e==null?void 0:e.type)===\"MovableComplexNumber\"||(e==null?void 0:e.type)===\"MovablePoint\"}var Em=class extends lt{constructor(n,r){super();this.type=\"Regression\";this.isRegression=!0;this.tableRegressionData=void 0;this._lhs=n,this.isLhsSimple=n instanceof Ve,this._logLhs=new xr(\"ln\",[n]),this._rhs=r,this._difference=new Hs([n,r]),this._logDifference=new Hs([new xr(\"ln\",[n]),new xr(\"ln\",[r])]),this.mergeDependencies(n,r)}getExportsFromConcrete(n,r){if(as(r))return[];let s=[];for(let o of he(r.parameters))n.assignmentForbidden(o)||s.push(o);return n.assignmentForbidden(r.residualVariable)||s.push(r.residualVariable),s}exportTo(n,r,s){if(r.type===\"Error\")return[];if(!(r instanceof hm))throw V(`Expected optimized regression but got ${r.type}.`);let o=[];for(let i of he(r.parameters))n.assignmentForbidden(i)||(o.push(i),s[i]=s[i]?bf(i):new bm(i,r));return n.assignmentForbidden(r.residualVariable)?[]:(s[r.residualVariable]=r.residuals,o.push(r.residualVariable),o)}getSliderVariables(){return[]}};var mb=class extends lt{constructor(n,r,s,o){super();this.calcColumns=r;this.regression=s;this.type=\"Table\";this.exportPenalty=1;this.isTable=!0;this.columns=n,this.mergeDependencies.apply(this,n),this.tableFrameID=o}getExports(){return[]}getColumnIdsForGraphing(){return this.columns.map(n=>n.userData.id)}getColumnStatementIds(){return this.calcColumns.map(n=>n.userData.id)}getRegressionId(){var n;return(n=this.regression)==null?void 0:n.userData.id}isValueDraggable(n,r,s){if(n.columns[r].type!==\"TableColumnValue\"||!n.columns[r].isIndependent)return!1;let i=this.calcColumns[r].values,a=i&&i[s],u=a&&a.asValue();return!!(typeof u==\"number\"&&isFinite(u)&&a.getDependencies().length===0)}},Ku=class extends mb{},db=class extends mb{};var ji=class extends lt{constructor(n,r,s,o){super();this.tableID=s;this.columnIndex=o;this.type=\"TableColumn\";this.headerDependencies=new Set;this.cellDependencies=new Set;this.length=0;this.header=n,this.values=r,this.registerDependencies(),this._exports=this.computeExports(),this.tableFrameID=s}registerDependencies(){this.mergeDependencies(this.header),this.mergeDependencies.apply(this,this.values);for(let n of this.header.getDependencies())this.headerDependencies.add(n);for(let n of this.header.getOptionalDependencies())this.headerDependencies.add(n);for(let n of this.values){for(let r of n.getDependencies())this.cellDependencies.add(r);for(let r of n.getOptionalDependencies())this.cellDependencies.add(r)}}computeExports(){return this.header instanceof Ve?[this.header._symbol]:[]}_exportSymbolsTo(n,r,s){if(n.length===0)return n;let o=this.getExportValue(r,s);this.header instanceof Ve&&!this.isFreeVariable(s)&&(n=n.filter(i=>i!==this.header._symbol));for(let i of n)s.hasOwnProperty(i)||(s[i]=o);return n}getExportValue(n,r){return this.isFreeVariable(r)||n.type===\"Error\"&&n.blocksExport?n:this.header}isFreeVariable(n){if(!(this.header instanceof Ve))return!1;let r=qn(this.tableFrameID,this.header._symbol);return!!zR(n).assignmentMaps.assignments.get(r)}exportTo(n,r,s){let o=this.getLegalExports(n);return this._exportSymbolsTo(o,r,s)}exportToLocal(n,r,s){this._exportSymbolsTo(this.getExports(n),r,s)}};function fb({statement:e,moduleID:t}){return e instanceof is?{type:2}:ey(e)?{type:1,directlyDependsOnSelf:e._expression.getDependencies().includes(e._symbol),fnName:qn(t,e._symbol)}:{type:0}}function Wz(e,t,n){let{statement:r,id:s,moduleID:o}=t;if(r instanceof Em){let i=n==null?void 0:n.get(s);if(i)return{type:\"simple\",meta:fb(t),exports:i,dependencies:[]}}if(r instanceof ji){if(r.tableFrameID===void 0)throw new Error(\"Programming Error: TableColumn missing tableFrameID.\");let i=r.header instanceof Ve?qn(r.tableFrameID,r.header._symbol):void 0,a=u0(r.tableFrameID,r.headerDependencies),u=u0(r.tableFrameID,r.cellDependencies);return{type:\"table-column\",meta:fb(t),exports:{moduleID:o,moduleExports:Af(o,r.getLegalExports(e)),tableExports:Af(r.tableFrameID,r.getExports(e))},dependencies:{headerIdent:i,headerDependencies:a,cellDependencies:u}}}return r instanceof gm?{type:\"simple\",meta:fb(t),exports:[qn(o,r._symbol)],dependencies:[r._importFrom]}:{type:\"simple\",meta:fb(t),exports:Af(o,r.getLegalExports(e)),dependencies:jz(t)}}function jz({statement:e,moduleID:t}){if(e instanceof Ku){let r=[];for(let s of e.getColumnStatementIds())r.push(qn(e.tableFrameID,`idref_${s}`));for(let s of e.getDependencies())r.push(qn(e.tableFrameID,s));return r}let n=Jo(e)&&e.tableRegressionData?e.tableRegressionData.tableId:t;return Af(n,e.getDependencies())}function ty(e,t,n,r){let s=Jz(e,t,r),o=Qz(t),i=Kz(s,o);return tk(e,s,i,n)}function Jz(e,t,n){let r={};for(let s of t.values()){let o=Wz(e,s,n);r[s.id]=o}return r}function Qz(e){let t=new Map;for(let{moduleID:n}of e.values())n!==mr&&t.set(n,mr);for(let{id:n,moduleID:r,statement:s}of e.values())s instanceof Ku&&t.set(n,r);return t}function bM(e,t,n){var s,o;let r=e.assignments.getOrInsert(t,[]);r.push(n),r.length>1&&e.multiplyDefined.add(t),(o=(s=e.resolvedExports)[n])!=null||(s[n]=[]),e.resolvedExports[n].push(t)}function Kz(e,t){let n=new Ul,r=new Ts,s={assignments:n,resolvedExports:{},resolvedDependencies:{},parentFrames:t,multiplyDefined:r},o=new Ts;for(let i of he(e)){let a=e[i];if(a.type===\"simple\"){for(let u of a.exports)rt[u.symbol]||(o.add(u),bM(s,u,i));s.resolvedDependencies[i]=a.dependencies}}for(let i of he(e)){let a=e[i];if(a.type!==\"table-column\")continue;for(let p of a.exports.moduleExports)rt[p.symbol]||o.has(p)||bM(s,p,i);for(let p of a.exports.tableExports){let l=qn(a.exports.moduleID,p.symbol);rt[p.symbol]||o.has(l)||bM(s,p,i)}let u=a.dependencies,c=u.headerIdent&&s.assignments.get(u.headerIdent);s.resolvedDependencies[i]=c?u.cellDependencies:u.headerDependencies}return s}function ek(e,t){let{assignments:n,parentFrames:r}=e;for(;;){let s=n.get(t);if(s)return s;let o=r.get(t.frameID);if(!o)return[];t=qn(o,t.symbol)}}function tk(e,t,n,r){let s=[],o=new Set,i={},a=new Ts,u={},c=0,p=[],l=[];for(let g of r)u.hasOwnProperty(g)||m(g);function m(g){u[g]=u[g]||{};let f=u[g],h;f.id=g,f.index=c,f.lowlink=c,p.push(f),f.instack=!0,c++;let x=n.resolvedDependencies[g];for(let T of x){let P=ek(n,T);for(let M of P)u.hasOwnProperty(M)?(h=u[M],h.instack&&(f.lowlink=Math.min(f.lowlink,h.index))):(m(M),h=u[M],f.lowlink=Math.min(f.lowlink,h.lowlink))}if(f.lowlink===f.index)if(h=p.pop(),h.instack=!1,h===f)d(f.id);else{let T=[h.id];for(;h=p.pop(),h.instack=!1,T.push(h.id),h!==f;);y(T)}}function d(g){l.push(g);let f=t[g];if(f.meta.type===1){let h=f.meta.fnName;!e.assignmentForbidden(h.symbol)&&f.meta.directlyDependsOnSelf&&!n.multiplyDefined.has(h)&&(i[g]=[g],a.add(h))}}function y(g){let f=[],h=!0,x=[],T=new Set;for(let P=g.length-1;P>=0;P--){let M=g[P],S=t[M];for(let E of n.resolvedExports[M])f.push(E);T.add(M),l.push(M),S.meta.type===1&&!n.multiplyDefined.has(S.meta.fnName)?x.push(M):h=!1,S.meta.type===2&&o.add(M)}if(h){for(let P of[...T])i[P]=x;for(let P of f)a.add(P)}s.push(f)}return{resolved:l,cycles:s,recursiveFunctionGroups:i,recursiveFunctionSymbols:a,recursiveFunctionBaseCasesWithCycles:o,assignmentMaps:n}}var Sm=class extends k{constructor(){super(...arguments);this.type=\"Add\"}};var yb=class extends Ve{constructor(){super(...arguments);this.type=\"Ans\"}};var Rn=class extends lt{constructor(t,n){super(),t instanceof Ve?this._symbol=t._symbol:this._symbol=t,this.mergeDependencies(n),this._expression=n,this._exports=this.computeExports()}shouldExportAns(){return!0}computeExports(){let t=this._symbol,n=this.getDependencies();for(let r=0;r<n.length;r++)if(n[r]===t)return[];return[t]}isEquation(t,n){let r=this._symbol,s=r===\"x\"||r===\"y\",o=r===\"r\"||r===\"z\",i=r===\"rho\",a=n.getDependencies(),u=this.graphmodeDependencies(t,n);return i||o||s&&a.includes(\"z\")?u.includes(r):a.includes(r)}asEquation(){let t=new Fc(new hn(this._symbol),this._expression);return t.userData=this.userData,t.metaData=this.metaData,t}shouldPromoteToSlider(t){if(this._expression.type!==\"Constant\")return!1;let n=this._expression.asValue();return typeof n!=\"number\"||!isFinite(n)?!1:t.isValidSlider(this._symbol)}},Mm=class extends Rn{constructor(){super(...arguments);this.type=\"Assignment\"}};var tp=class extends k{constructor(n){super(n);this.type=\"AssignmentExpression\";this._symbol=n[0]._symbol,this._lhs=n[0],this._rhs=n[1]}};var Gc=class extends k{constructor(){super(...arguments);this.type=\"BareSeq\"}};var Cm=class extends k{constructor(){super(...arguments);this.type=\"BoxPlot\";this._symbol=\"boxplot\"}};var us=class extends k{constructor(){super(...arguments);this.type=\"Piecewise\"}};function nk(e,t){let n=Yr[e[0]].direction===-1?new Hs([t[1],t[0]]):new Hs([t[0],t[1]]);switch(e.length){case 0:throw new Error(\"Programming Error: ComparatorChain must have at least one comparator\");case 1:return n;default:return new us([new Hc(e.slice(1),t.slice(1)),n,new Xn(NaN)])}}var Hc=class e extends k{constructor(n,r){super(r);this.symbols=n;this.type=\"ComparatorChain\";if(n.length<1)throw\"Programming Error: ComparatorChain must have at least one comparator.\";if(r.length!==n.length+1)throw\"Programming Error: ComparatorChain must have one more arg than symbols\";if(n.includes(\"=\")&&!n.every(s=>s===\"=\"))throw eP()}getRestrictedDifference(){return nk(this.symbols,this.args)}isInequality(){return!this.symbols.includes(\"=\")}withArgsCoerced(){let n=new e(this.symbols,this.args.map(r=>new xr(\"coerceToReal\",[r])));return n.userData=this.userData,n.metaData=this.metaData,n}};var np=class extends k{constructor(n){let r=n.map(s=>new hn(\"\\\\idref_{\"+s+\"}\"));super(r);this.constructedObjectIds=n;this.type=\"Construction\";this._exports.push(\"construction\")}};var vm=class extends k{constructor(){super(...arguments);this.type=\"CrossMultiply\"}};var rp=class extends k{constructor(n,r){super(r);this.type=\"Derivative\";n instanceof Ve?this._symbol=n._symbol:this._symbol=new hn(n)._symbol,this.addDependency(this._symbol)}};var Dm=class extends k{constructor(){super(...arguments);this.type=\"Divide\"}};var qs=class extends k{constructor(){super(...arguments);this.type=\"DotAccess\"}registerDependencies(){if(super.registerDependencies(),this.args[1]instanceof Ve){let n=this.args[1]._symbol;_c(n)&&this.addDependency(\"trigAngleMultiplier\")}}};var qc=class extends k{constructor(){super(...arguments);this.type=\"DotMultiply\"}};var Nm=class extends k{constructor(){super(...arguments);this.type=\"DotPlot\";this._symbol=\"dotplot\"}};var gb=class extends lt{constructor(n){super();this.type=\"DoubleInequality\";let[r,s,o,i,a]=n;this.args=n,this._symbol=o._symbol,this._operators=[s,i],this._expressions=[r,a];let u=Lc(Yr[s].inclusive&&Yr[n[3]].inclusive,Yr[n[1]].direction);this._indicator=ub(u,[new xr(\"coerceToReal\",[n[0]]),new xr(\"coerceToReal\",[n[4]])]),this.addDependency(this._symbol),this.mergeDependencies(this._expressions[0],this._expressions[1])}isInequality(){return!0}isShadeBetween(){return!0}},hb=class extends gb{},Rm=class extends gb{};var ny=class extends k{},Om=class extends ny{constructor(){super(...arguments);this.type=\"Exponent\"}};var sp=class extends k{constructor(n,r){super(r);this.type=\"ExtendSeed\";this.seed=r[0],this.userSeed=r[1],this.tag=n}asValue(){return this.seed.asValue()+\"::\"+this.tag+this.userSeed.asValue()}};var Uc=class extends k{constructor(){super(...arguments);this.type=\"FunctionExponent\"}registerDependencies(){if(super.registerDependencies(),this.args[0].type===\"Identifier\"){let n=this.args[0]._symbol;_c(n)&&this.addDependency(\"trigAngleMultiplier\")}}};var zc=class extends k{constructor(){super(...arguments);this.type=\"FunctionFactorial\"}registerDependencies(){if(this.addDependency(\"factorial\"),super.registerDependencies(),this.args[0].type===\"Identifier\"){let n=this.args[0]._symbol;_c(n)&&this.addDependency(\"trigAngleMultiplier\")}}};var Am=class extends k{constructor(){super(...arguments);this.type=\"Histogram\";this._symbol=\"histogram\"}};var bb=class extends lt{constructor(n){super();this.type=\"Image\";this.isImage=!0;this.center=n.center,this.radianAngle=n.radianAngle,this.width=n.width,this.height=n.height,this.opacity=n.opacity,this.mergeDependencies(this.center,this.radianAngle,this.width,this.height,this.opacity)}},xb=class extends bb{},_m=class extends bb{constructor(t){super(t)}};var wm=class extends k{constructor(){super(...arguments);this.type=\"IndependentTTest\";this._symbol=\"ittest\"}};var Lm=class extends k{constructor(n){super(n,{skipRegisterDependencies:!0});this.type=\"Integral\";this._differential=n[0],this.registerDependencies()}registerDependencies(){for(let n=1;n<=3;n++)this.mergeDependenciesInScope(\"Integral\",[this._differential._symbol],this.args[n])}};function Lr(e,t){return _a(Tb(e,t))}function Tb(e,t){let n=e.getInstruction(t);switch(n.type){case 1:return n.value;default:throw new Error(`Unexpected opcode ${n.type}.`)}}function _a(e){if(Array.isArray(e))return e.map(_a);switch(typeof e){case\"boolean\":case\"number\":case\"string\":return e;case\"object\":if(Zu(e)){let t={};for(let n of he(e.updateRules)){let r=e.updateRules[n];t[n]={value:_a(r.value),valueType:r.valueType}}return{type:\"Action\",updateRules:t}}else return w(e);default:throw new Error(`Unexpected value: ${e}`)}}function Fm(e){return $(e.valueType)}function NO(e){return e.type<=3}function RO(e){return e.type===4}function ce(e){return e.type>=8}function cs(e){switch(e.type){case 21:case 23:case 19:case 50:case 53:return!0;default:return!1}}function Ss(e){switch(e.type){case 20:case 22:case 24:case 51:case 54:return!0;default:return!1}}function Ib(e){switch(e.type){case 20:case 22:case 24:case 51:return!0;default:return!1}}function Zr(e,t){let n=new Array(t);for(let s=0;s<t;s++)n[s]=!1;n[t]=!0;let r=t;for(;r>0;){r=0;for(let s=t;s>=0;s--){if(!n[s])continue;let o=e.getInstruction(s);if(ce(o))for(let i of e.getDirectDependencies(o))i>s&&!n[i]&&i>r&&(r=i),n[i]=!0}}return n}function OO(e,t){let n=new Array(t);for(let s=0;s<t;s++)n[s]=!1;n[t]=!0;let r=t;for(;r>0;){r=0;for(let s=t;s>=0;s--){if(!n[s])continue;let o=e.getInstruction(s);if(ce(o))if(o.type===33)n[o.args[1]]=!0,n[o.args[2]]=!0;else for(let i of e.getDirectDependencies(o))i>s&&!n[i]&&(r=i),n[i]=!0}}return n}function Ms(e,t){var s;let n=[],r=[];for(let o=0;o<t;o++)r.push(!1);r.push(!0);for(let o=t;o>=0;o--){if(!r[o])continue;let i=e.getInstruction(o);if(i.type===2)n.push({symbol:e.argNames[o],scope:\"free\"});else if(cs(i))switch(i.type){case 21:n.push({symbol:i.callData.indexSymbol,scope:\"integral\"});break;case 19:n.push({symbol:i.callData.indexSymbol,scope:i.callData.type});break;case 23:if(((s=i.context)==null?void 0:s.type)===\"list-comprehension\")for(let u of i.context.callData.inputListSymbols)n.push({symbol:u,scope:\"comprehension\"});break;case 50:for(let u of i.callData.parameterSymbols)n.push({symbol:u,scope:\"map\"});break;case 53:{let u=e.getInstruction(i.args[0]);for(let c of u.parameterSymbols)n.push({symbol:c,scope:\"recursive-function\"});break}default:let a=i;throw new Error(`Programming Error: unexpected loop instruction ${a.type}`)}else i.type===3&&i.symbol&&n.push({symbol:i.symbol,scope:\"symbolic-var\"});if(ce(i))for(let a of e.getDirectDependencies(i))r[a]=!0}return n.reverse()}function kc(e,t){return Su(e,[t],0,e.instructionsLength()-1)}function Su(e,t,n,r){let s=[];for(let i=n;i<=r;i++)s[i]=!1;for(let i of t)s[i]=!0;let o=Math.min(...t);for(let i=0;i<=1;i++){let a=!1;for(let u=o+1;u<e.instructionsLength();u++){let c=e.getInstruction(u);if(!ce(c)||s[u])continue;let p=!1;for(let l of e.getDirectDependencies(c))if(s[l]){p=!0;break}if(s[u]=p,p&&c.type===20&&!s[c.args[0]]){let l=c.args[0],m=c.args.length-1;for(let d=0;d<m;d++){let y=c.args[1+d],g=l+1+d;s[y]&&(s[g]=!0,a=!0)}}}if(!a)break}return s}function AO(e){if(e.isConstant())return;let t=[];for(let o=0;o<e.getReturnIndex();o++)e.getInstruction(o).type===44&&t.push(o);if(t.length===0)return;let n=Zr(e,e.getReturnIndex()),r=[];for(let o=0;o<e.argNames.length;o++)n[o]&&r.push(o);let s=Su(e,r,0,e.getReturnIndex());for(let o of t)if(n[o]&&s[o])throw _S(Ms(e,o))}function Dr(e){if(!ec(e))throw new Error(\"Programming error: expected an array but found \"+typeof e)}function ec(e){return Array.isArray(e)}function _O(e){if(ec(e))for(let{compiled:t}of e)t&&xM(t)}function yJ(e){if(ec(e))for(let{compiled:t}of e)t&&ok(t)}function xM(e){delete e.fn}function ok(e){e.fn=ry(e.args,e.source,e.constants,e.executionMetadata)}function ry(e,t,n,r){let o=`var fn = (function(${e.join(\",\")}){\"use strict\"; ${t}});\nfn.__meta = __meta;\nreturn fn;\n`;return new Function(\"BuiltIn\",\"ErrorMsg\",\"_C\",\"__meta\",o)(Ps,Ct,n,r)}function LO(e,t,n){let r=\"\",s=(e.instructionsLength()-1).toString().length,o=0,i=!1,a=Zr(e,t);for(let u=0;u<e.instructionsLength();u++){let c=e.getInstruction(u),p=n.comments[u]||\"\";if(Ss(c)&&(o-=1),!a[u]&&!n.printUnreferencedInstructions||c.type===0)i||(r+=`${wO(u,s)}: ${PM(2*o)}...\n`),i=!0;else{i=!1;let l=`${wO(u,s)}: ${PM(2*o)}${op(e,u)}`;p&&(l+=\" \".repeat(Math.max(0,36-l.length)),l+=`\t# ${p}`),r+=l+`\n`}cs(c)&&(o+=1)}return r}function op(e,t){let n=e.getInstruction(t);switch(n.type){case 0:return ls(n.type);case 2:return`${ls(n.type)} ${We(n.valueType)} ${e.argNames[t]}`;case 3:return`${ls(n.type)} ${We(n.valueType)}`;case 1:return`${ls(n.type)} ${We(n.valueType)} ${IM(n.value)}`;case 37:case 42:return`${ls(n.type)} ${We(n.valueType)} ${n.symbol} ${n.args.join(\" \")}`;case 44:return`${ls(n.type)} ${We(n.valueType)} ${n.tag} ${n.args.join(\" \")}`;case 48:return`${ls(n.type)} ${We(n.valueType)} ${n.args.join(\" \")}`;case 16:return`${ls(n.type)} ${We(n.valueType)} (${n.index}) ${n.args.join(\" \")}`;case 50:return`${ls(n.type)} ${We(n.valueType)} ${n.args.join(\" \")} (${n.callData.parameterSymbols.join(\",\")})`;case 4:{let s=n.signature.argTypes.map(o=>We(o)).join(\", \");return`${ls(n.type)} ${We(n.valueType)} ${n.symbol}(${s}) [group ${n.recursionGroup.join(\" \")}]`}case 8:case 9:case 10:case 11:case 13:case 12:case 14:case 56:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 32:case 31:case 33:case 38:case 39:case 40:case 41:case 47:case 49:case 51:case 53:case 54:case 55:case 15:return`${ls(n.type)} ${We(n.valueType)} ${n.args.join(\" \")}`;default:let r=n;throw new Error(`Unexpected opcode ${r.type}`)}}function ls(e){switch(e){case 0:return\"Noop\";case 1:return\"Constant\";case 8:return\"Add\";case 9:return\"Subtract\";case 10:return\"Multiply\";case 11:return\"Divide\";case 12:return\"Exponent\";case 13:return\"RawExponent\";case 14:return\"Negative\";case 56:return\"Square\";case 19:return\"BeginLoop\";case 20:return\"EndLoop\";case 21:return\"BeginIntegral\";case 22:return\"EndIntegral\";case 23:return\"BeginBroadcast\";case 24:return\"EndBroadcast\";case 25:return\"Equal\";case 26:return\"Less\";case 27:return\"Greater\";case 28:return\"LessEqual\";case 29:return\"GreaterEqual\";case 31:return\"Or\";case 32:return\"And\";case 33:return\"Piecewise\";case 38:return\"List\";case 39:return\"ListAccess\";case 40:return\"DeferredListAccess\";case 41:return\"InboundsListAccess\";case 37:return\"NativeFunction\";case 42:return\"Distribution\";case 2:return\"LoadArg\";case 47:return\"BlockVar\";case 48:return\"BroadcastResult\";case 3:return\"SymbolicVar\";case 44:return\"ExtendSeed\";case 49:return\"Action\";case 50:return\"BeginMap\";case 51:return\"EndMap\";case 4:return\"FunctionHeader\";case 53:return\"BeginFunction\";case 54:return\"EndFunction\";case 55:return\"FunctionCall\";case 15:return\"Tuple\";case 16:return\"Slot\";default:let t=e;throw new Error(`Unexpected opcode ${t.type}`)}}function IM(e){if(Array.isArray(e))return`[${e.map(IM).join(\",\")}]`;switch(typeof e){case\"string\":return e;case\"boolean\":case\"number\":return e.toString();case\"object\":if(Zu(e)){let t=[];for(let n of he(e.updateRules))t.push(`\"${n}\": ${IM(e.updateRules[n].value)}`);return`{${t.join(\", \")}}`}else return`${e.n}/${e.d}`;default:throw new Error(`Unexpected value: ${e}`)}}function wO(e,t){let n=e.toString();return PM(t-n.length)+n}function PM(e){let t=\"\";for(let n=0;n<e;n++)t+=\" \";return t}function vn(e){return`_${e}`}function Vm(e){return`_${e}_thunk_computed`}function Bm(e){return`_${e}_thunk_function`}function Pb(e){return`_${e}_next`}function FO(e){return`_${e}_next1`}function EM(e,t){return`_${e}_${t}`}function SM(e){return`_${e}_inner`}function VO(e){return`_${e}_cache`}function BO(e){return`_${e}_key`}function Eb(e){return`_${e}_computationMetrics`}function GO(e){return`_${e}_out`}function HO(e){return`_${e}_computationMetrics`}function qO(e){return`_${e}_cacheEntry`}function UO(e){return`_${e}_args`}function sy(e,t){return`_${e}_prev_${t}`}function zO(e){return`_${e}_computationDepth`}function kO(e){return`_${e}_computationCount`}function Ue(e){return e.type===1}function $O(e){if(!Ue(e))throw new Error(`Programming error: expected constant instruction but found ${ls(e.type)} instead.`)}var CM=class{constructor(t,n){this.chunk=t;this.recursiveFunctionGroup=n;this.referencesFrom={};this.referencesTo={};this.baseCases={};for(let c of Object.values(n))this.referencesFrom[c]=[],this.referencesTo[c]=[],this.baseCases[c]=[];let{dependsOnRecursiveCall:r,iterationParameterIndex:s,recursiveReferences:o}=ck(this.chunk,this.recursiveFunctionGroup);for(let c of o)this.referencesFrom[c.from].push(c),this.referencesTo[c.to].push(c);this.iterationParameterIndex=s;let{baseCases:i,isEveryBranchRecursiveOrBaseCase:a,isUnconditionallyRecursive:u}=uk(t,n,r,s);this.isEveryBranchRecursiveOrBaseCase=a,this.isUnconditionallyRecursive=u;for(let c of i)this.baseCases[c.fn].push(c)}hasRecursiveReferences(){for(let t of Object.values(this.referencesFrom))if(t.length>0)return!0;return!1}getBaseCasesForFunction(t){return this.baseCases[t]}getReferencesFrom(t){return this.referencesFrom[t]}getReferencesTo(t){return this.referencesTo[t]}getAllReferences(){let t=[];for(let n of Object.values(this.referencesFrom))t.push(...n);return t}};function ak(e,t,n){if(t===void 0)return;let r=e.getInstruction(n),s=e.getInstruction(r.args[0]);if(s.type!==25)return;let[o,i]=s.args,a;if(o===t)a=i;else if(i===t)a=o;else return;let u=e.getInstruction(a);if(Ue(u)&&u.valueType===b)return u.value}function uk(e,t,n,r){let s=[],o=!0,i=!0;for(let a in t){let u=t[a],p=e.getInstruction(u).endIndex,m=e.getInstruction(p).args[0],d=r!==void 0?m+r+1:void 0,y={[p]:!0};for(let g=p;g>m;g--){if(!y[g])continue;let f=e.getInstruction(g);if(ce(f)){if(f.type===33){let h=f.args[1],x=f.args[2];if(!n[h]||!n[x]){o=!1;let P=ak(e,d,g);P!==void 0&&!n[h]?s.push({fn:u,argValue:P}):i=!1}}for(let h of f.args)y[h]=!0}}}return s.sort((a,u)=>w(a.argValue)-w(u.argValue)),{baseCases:s,isUnconditionallyRecursive:o,isEveryBranchRecursiveOrBaseCase:i}}var MM=Symbol(\"NON_ITERATIVE\");function ck(e,t){let n=new Set(Object.values(t)),r={},s=[],o;for(let i in t){let a=t[i],c=e.getInstruction(a).endIndex,l=e.getInstruction(c).args[0],m=Zr(e,c);for(let d=l;d<c;d++){let y=e.getInstruction(d);if(ce(y)&&m[d]){if(y.type===55&&n.has(y.args[0])){r[d]=!0;let g=vM(e,l,y);g?(g.iterationParameterIndex!==void 0&&(o!==void 0&&o!==g.iterationParameterIndex?o=MM:o=g.iterationParameterIndex),s.push(g.ref)):o=MM}for(let g of e.getDirectDependencies(y))if(r[g]){r[d]=!0;break}}}}return o===void 0&&Object.values(t).every(i=>e.getInstruction(i).signature.argTypes.length===1)&&(o=0),{dependsOnRecursiveCall:r,iterationParameterIndex:o===MM?void 0:o,recursiveReferences:s}}function vM(e,t,n){let r=e.getInstruction(t),s,o;for(let i=1;i<n.args.length;i++){let a=n.args[i],u=e.getInstruction(a),c,p;if(u.type===9&&s===void 0){let d=e.getInstruction(u.args[1]);if(!(d.type===1&&d.valueType===b))return;p=w(d.value),c=u.args[0]}else p=0,c=a;let l=e.getInstruction(c);if(!(l.type===47&&l.args[0]===t&&i===c-t)||p!==Math.floor(p)||p<0)return;if(s===void 0)o=p,p!==0&&(s=i-1);else if(p!==0)return}if(o!==void 0)return{ref:{from:r.args[0],to:n.args[0],iterationParameterOffset:o},iterationParameterIndex:s}}function YO(e,t){var c,p;let n=new CM(e,t),r={};for(let l in n.recursiveFunctionGroup){let m=n.recursiveFunctionGroup[l],d=n.getBaseCasesForFunction(m);if(d.length===0)continue;let y=w(d[0].argValue),g=1;for(;g<d.length&&w(d[g].argValue)===w(d[g-1].argValue)+1;)g++;let f=d.slice(g).map(h=>w(h.argValue));r[l]={min:y,consecutiveCount:g,additional:f}}let s={},o=-1/0,i=1/0;if(n.iterationParameterIndex!==void 0&&n.isEveryBranchRecursiveOrBaseCase){let l=new Map;for(let m of Object.values(n.recursiveFunctionGroup)){let d=e.getInstruction(m).symbol,y=-1/0;for(let g of n.getReferencesTo(m))y=Math.max(y,g.iterationParameterOffset);if(isFinite(y)&&(s[d]=y),y>0){let g=r[e.getInstruction(m).symbol],f=(c=g==null?void 0:g.min)!=null?c:-1/0;l.set(m,{min:f+y,max:f+((p=g==null?void 0:g.consecutiveCount)!=null?p:0)})}}for(let{min:m,max:d}of l.values())o=Math.max(o,m),i=Math.min(i,d)}let a={};for(let l in n.recursiveFunctionGroup){let m=n.recursiveFunctionGroup[l],d=e.getInstruction(m);a[l]=d.parameterSymbols}let u={};for(let l in n.recursiveFunctionGroup){let m=n.recursiveFunctionGroup[l],d=e.getInstruction(m);u[l]=d.signature.argTypes.map((y,g)=>g===n.iterationParameterIndex&&n.isEveryBranchRecursiveOrBaseCase&&!n.isUnconditionallyRecursive?1:0)}if(n.iterationParameterIndex!==void 0&&isFinite(o)&&o<=i){let l=lk(n);return{canIterate:!0,parameterSymbols:a,baseCaseInfo:r,maxRecursiveCallOffsets:s,iterationParameterIndex:n.iterationParameterIndex,domainInfo:u,loopStart:o,order:l}}else return{canIterate:!1,parameterSymbols:a,baseCaseInfo:r,maxRecursiveCallOffsets:s,iterationParameterIndex:n.iterationParameterIndex,domainInfo:u}}function lk(e){if(e.iterationParameterIndex===void 0)throw V(\"Programming error: no recursive parameter\");let n=Object.values(e.recursiveFunctionGroup),r=new Map,s=new Map,o=u=>{let c=new Set;for(let p of e.getReferencesTo(u))p.iterationParameterOffset===0&&c.add(p.from);return[...c]};n.forEach(u=>{let c=o(u);r.set(u,c);for(let p of c)s.set(p,(s.get(p)||0)+1);s.has(u)||s.set(u,0)});let i=[];s.forEach((u,c)=>{u===0&&i.push(c)});let a=[];for(;i.length>0;){let u=i.shift();a.push(u),(r.get(u)||[]).forEach(p=>{let l=p,m=s.get(l)-1;s.set(l,m),m===0&&i.push(l)})}if(a.length!==n.length)throw HI();return a}function Sb(e,t){let n;for(let i=t,a=0;i>0;i--){let u=e.getInstruction(i);if(u.type===53&&a===0){n=i;break}u.type===54&&a++,u.type===53&&a--}if(n===void 0)return!1;let r=e.getInstruction(t),s=e.getInstruction(r.args[0]),o=e.getInstruction(n).args[0];return s.recursionGroup.includes(o)}function Mb(e){for(let t=0;t<e.argCoeffs.length;t++)if(w(e.argCoeffs[t])!==0)return!1;return!0}var Cb=be(0,1),ZO=be(1,1);function vb(e){if(e.op===\"&&\")return{op:\"||\",values:e.values.map(vb)};if(e.op===\"||\")return{op:\"&&\",values:e.values.map(vb)};switch(e.condition){case\">0\":return{op:\"comparator\",value:Us._neg(e.value),condition:\">=0\"};case\">=0\":return{op:\"comparator\",value:Us._neg(e.value),condition:\">0\"};case\"=0\":return{op:\"comparator\",value:e.value,condition:\"!=0\"};case\"!=0\":return{op:\"comparator\",value:e.value,condition:\"=0\"}}}function DM(e,t){let n=[];return e.op===\"&&\"?n.push(...e.values):n.push(e),t.op===\"&&\"?n.push(...t.values):n.push(t),{op:\"&&\",values:n}}var Us;(c=>{function e(p,l){if(!(p===void 0||l===void 0))return t(p,l)}c.add=e;function t(p,l){let m=[];for(let d=0;d<p.argCoeffs.length;d++)m.push(fo(p.argCoeffs[d],l.argCoeffs[d]));return{argCoeffs:m,constantCoeff:fo(p.constantCoeff,l.constantCoeff)}}c._add=t;function n(p,l){if(!(p===void 0||l===void 0))return r(p,l)}c.sub=n;function r(p,l){let m=[];for(let d=0;d<p.argCoeffs.length;d++)m.push(_o(p.argCoeffs[d],l.argCoeffs[d]));return{argCoeffs:m,constantCoeff:_o(p.constantCoeff,l.constantCoeff)}}c._sub=r;function s(p){if(p!==void 0)return o(p)}c.neg=s;function o(p){let l=[];for(let m=0;m<p.argCoeffs.length;m++)l.push(mo(p.argCoeffs[m]));return{argCoeffs:l,constantCoeff:mo(p.constantCoeff)}}c._neg=o;function i(p,l){if(p===void 0||l===void 0)return;let m=Mb(p),d=Mb(l);if(!m&&!d)return;d||([p,l]=[l,p]);let y=[];for(let g=0;g<p.argCoeffs.length;g++)y.push(wr(p.argCoeffs[g],l.constantCoeff));return{argCoeffs:y,constantCoeff:wr(p.constantCoeff,l.constantCoeff)}}c.mul=i;function a(p,l){if(p===void 0||l===void 0||!Mb(l))return;let d=[];for(let y=0;y<p.argCoeffs.length;y++)d.push(Vs(p.argCoeffs[y],l.constantCoeff));return{argCoeffs:d,constantCoeff:Vs(p.constantCoeff,l.constantCoeff)}}c.div=a;function u(p,l){if(!(p===void 0||l===void 0||!Mb(l)))return w(l.constantCoeff)===0?{argCoeffs:new Array(p.argCoeffs.length).fill(Cb),constantCoeff:ZO}:w(l.constantCoeff)===1?p:void 0}c.pow=u})(Us||(Us={}));var Db=class{constructor(t,n,r,s){this.chunk=t;this.coefficientTable=[];this.conditionTable=[];this.ZERO_COEFFS=new Array(n.length).fill(Cb),this.mask=Su(t,n,r,s);for(let o=0;o<n.length;o++){let i=[];for(let a=0;a<n.length;a++)i.push(o===a?ZO:Cb);this.coefficientTable[n[o]]={argCoeffs:i,constantCoeff:Cb}}}coeffs(t){let n=this.coefficientTable[t];if(n!==void 0)return n;let r,s=this.chunk.getInstruction(t);return s.type===1&&s.valueType===b?r={argCoeffs:this.ZERO_COEFFS,constantCoeff:s.value}:this.mask[t]?r=this._coeffs(t):r=void 0,this.coefficientTable[t]=r,r}_coeffs(t){let n=this.chunk.getInstruction(t);switch(n.type){case 8:{let[s,o]=n.args;return Us.add(this.coeffs(s),this.coeffs(o))}case 9:{let[s,o]=n.args;return Us.sub(this.coeffs(s),this.coeffs(o))}case 14:{let s=n.args[0];return Us.neg(this.coeffs(s))}case 10:{let[s,o]=n.args;return Us.mul(this.coeffs(s),this.coeffs(o))}case 11:{let[s,o]=n.args;return Us.div(this.coeffs(s),this.coeffs(o))}case 12:case 13:{let[s,o]=n.args;return Us.pow(this.coeffs(s),this.coeffs(o))}case 26:case 28:case 27:case 29:case 33:case 0:case 23:case 2:case 1:case 25:case 32:case 31:case 15:case 16:case 38:case 39:case 40:case 41:case 37:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:case 50:case 51:case 4:case 53:case 54:case 55:case 56:return;default:let r=n;throw new Error(`Unexpected opcode ${r.type}`)}}condition(t){let n=this.conditionTable[t];if(n!==void 0)return n;let r;return this.mask[t]?r=this._condition(t):r=void 0,this.conditionTable[t]=r,r}_condition(t){let n=this.chunk.getInstruction(t);switch(n.type){case 26:{let[s,o]=n.args,i=Us.sub(this.coeffs(o),this.coeffs(s));return i===void 0?void 0:{op:\"comparator\",value:i,condition:\">0\"}}case 28:{let[s,o]=n.args,i=Us.sub(this.coeffs(o),this.coeffs(s));return i===void 0?void 0:{op:\"comparator\",value:i,condition:\">=0\"}}case 27:{let[s,o]=n.args,i=Us.sub(this.coeffs(s),this.coeffs(o));return i===void 0?void 0:{op:\"comparator\",value:i,condition:\">0\"}}case 29:{let[s,o]=n.args,i=Us.sub(this.coeffs(s),this.coeffs(o));return i===void 0?void 0:{op:\"comparator\",value:i,condition:\">=0\"}}case 25:{let[s,o]=n.args,i=Us.sub(this.coeffs(s),this.coeffs(o));return i===void 0?void 0:{op:\"comparator\",value:i,condition:\"=0\"}}case 32:{let s=n.args.map(o=>this.condition(o));return s.some(o=>o===void 0)?void 0:{op:\"&&\",values:s}}case 31:{let s=n.args.map(o=>this.condition(o));return s.some(o=>o===void 0)?void 0:{op:\"||\",values:s}}case 8:case 9:case 14:case 56:case 10:case 11:case 12:case 13:case 33:case 0:case 23:case 2:case 1:case 15:case 16:case 38:case 39:case 40:case 41:case 37:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:case 50:case 51:case 4:case 53:case 54:case 55:return;default:let r=n;throw new Error(`Unexpected opcode ${r.type}`)}}};function WO(e,t,n,r){let s=t.reachConditions[n];if(s!==void 0)return jO(e,t,r,s)}function jO(e,t,n,r){let s=t.argBlockvars;if(r.op===\"||\"||r.op===\"&&\"){let o=[];for(let i of r.values){let a=jO(e,t,n,i);if(a===void 0)return;o.push(a)}return o.length===0?r.op===\"&&\"?\"true\":\"false\":`(${o.join(r.op)})`}switch(r.condition){case\">0\":case\">=0\":{let i=`(${XO(e,r.value,s)}${r.condition})`,a=NM(e,r.value,s,n);return`(${i}&&${a})`}case\"!=0\":{let o=XO(e,r.value,s),i=`(${o}>0)`,a=NM(e,r.value,s,n),u=`(${o}<0)`,c=NM(e,Us._neg(r.value),s,n);return`((${i}&&${a})||(${u}&&${c}))`}case\"=0\":return}}function NM(e,t,n,r){let s=[];for(let o=0;o<n.length;o++){let i=w(t.argCoeffs[o]),a=e.referenceArg(n[o]),u=e.referenceArg(r[o]);i>0?s.push(`${u}>=${a}`):i<0&&s.push(`${u}<=${a}`)}return s.length===0?!0:`(${s.join(\"&&\")})`}function XO(e,t,n){let r=\"\";for(let s=0;s<n.length;s++){let o=e.printValue({value:t.argCoeffs[s],valueType:b}),i=e.referenceArg(n[s]);r+=`${o}*${i}+`}return r+=e.printValue({value:t.constantCoeff,valueType:b}),`(${r})`}var sn;(r=>(r.Noop=0,r.Inline=1,r.Block=2))(sn||(sn={}));function RM(e){switch(e.type){case sn.Noop:return\"\";case sn.Inline:return e.source+`;\n`;case sn.Block:return e.source}}function JO(e,t,n){if(e.glsl)throw V(\"GLSL function not implemented\");let{chunk:r,referenced:s}=e,o=t.args[0],i=r.getInstruction(o),a=i.signature.argTypes;if(e.isTailFunction[o])return{type:sn.Noop,nextIdx:i.endIndex+1};e.enterFunction(t,n,0);let u=\"\";for(let c=0;c<a.length;c++){let p=n+c+1;s[p]&&(u+=`${vn(p)}=${EM(o,c)};\n`)}return{type:sn.Block,source:pk(e,t,n,u),nextIdx:n+1}}function pk(e,t,n,r){let{chunk:s}=e,o=t.args[0],i=s.getInstruction(o),a=i.signature.argTypes,u=\"\";for(let d=0;d<a.length;d++)d>0&&(u+=\",\"),u+=EM(o,d);let c=SM(o),p=VO(o),l=BO(o),m=Eb(o);return`\n    const ${l}=${a.length===1&&i.signature.argTypes[0]===b?\"({fn, args}) => `${fn}:${args[0]}`\":\"({fn, args}) => `${fn}:${JSON.stringify(args)}`\"};\n\n    const ${c}=((${p}, ${u}) => {\n      ${Gm(e,n+1,i.endIndex-1)}\n      const ${m} = {depth: 0, count: 0};\n      const cache = ${p};\n      ${r}\n    `}function QO(e,t,n){let r=n+1,s=t.args[0],i=e.chunk.getInstruction(s).args[0];if(e.isTailFunction[i])throw V(\"Unexpected tail recursive function\");let a=mk(e,t),{referenced:u}=e;return u[n]&&(a+=`${vn(n)}=${e.referenceArg(t.args[0])};\n`),e.exitFunction(),{type:sn.Block,source:a,nextIdx:r}}function mk(e,t){let n=t.args[0],r=e.chunk.getInstruction(n),s=r.args[0],o=GO(s),i=Eb(s),a=r.valueType;return`\n${i}.count++;\n${i}.depth++;\nlet ${o};\nif ((${i}.depth > BuiltIn.RECURSIVE_DEPTH_LIMIT) || (${i}.count > BuiltIn.RECURSIVE_COMPUTATION_LIMIT)) {\n  ${o}=BuiltIn.handleRecursionLimitExceeded(__meta, ${a});\n} else {\n  ${o}=${e.referenceArg(t.args[1])};\n}\nreturn BuiltIn.recursionSuccess(${o},${i});\n});\n`}function oy(e,t){return`{ fn: ${e}, args: ${t} }`}function KO(e,t,n){let r=n+1,{chunk:s}=e,o=t.args[0],i=s.getInstruction(o),u=s.getInstruction(i.endIndex).args[0],c=t.args.slice(1).map(f=>e.referenceArg(f)),p=vn(n),l=UO(n),m=HO(n),d=qO(n),y=s.getInstruction(u),g=s.getInstruction(y.args[0]);if(Sb(s,n)){if(e.recursiveFunctionInfo.length<1)throw V(\"Expected recursive function info\");let f=e.recursiveFunctionInfo[e.recursiveFunctionInfo.length-1],h=\"\",x=WO(e,f,n,t.args.slice(1));if(e.isTailFunction[o]){let S=y.valueType;x&&(h=`\nif (${x}) {\n            return BuiltIn.recursionDiverges(__meta, ${S});\n          }`);let E=g.signature.argTypes,v=h+`\n`;v+=\"looping=true\";for(let D=0;D<E.length;D++){let G=Pb(u+D+1);v+=`,\n${G}=${c[D]}`}return h?{type:sn.Block,source:v+`;\n`,nextIdx:r}:{type:sn.Inline,source:v,nextIdx:r}}else if(f.executionMode===1){let S=s.getInstruction(s.getInstruction(f.fn).endIndex),E=vM(s,S.args[0],t);if(!E)throw V(\"Expected valid iteration reference\");let v=sy(E.ref.to,E.ref.iterationParameterOffset);return{type:sn.Inline,source:`${p}=${v}`,nextIdx:r}}x&&(h=`\nif (${x}) {\n          return BuiltIn.SYMBOL_DIVERGES;\n        }`);let T=Eb(f.fn),P=oy(o,l),M=`\n      const ${l} = ([${c.join(\",\")}]);\n      ${h}\n      const ${d} = cache.get(BuiltIn.recursionCacheKey(${P}));\n      if (${d} === undefined) {\n        return BuiltIn.recursionMissingCacheEntry(${P});\n      }\n      ${p} = ${d}[0];\n      const ${m} = ${d}[1];\n      if (${m}.count > ${T}.count) {\n        ${T}.count = ${m}.count;\n      }\n      if (${m}.depth > ${T}.depth) {\n        ${T}.depth = ${m}.depth;\n      }\n    `;return{type:sn.Block,source:M,nextIdx:r}}else{let f=`{${g.recursionGroup.map(P=>`${P}: ${SM(P)}`).join(\",\")}}`,h=e.chunk.getRecursionStructure(y.args[0]);if(e.isTailFunction[o])return dk(e,t,n);if(h.canIterate)return fk(e,t,n,h,{innerFunctionsMap:f});let x=oy(o,`[${c.join(\",\")}]`),T=`${p}=BuiltIn.executeRecursiveFunction(\n      __meta,\n      ${f},\n      ${y.valueType},\n      ${x}\n    )`;return{type:sn.Inline,source:T,nextIdx:r}}}var eA=Symbol(\"UPDATED_IN_BODY\");function tA(e){let t=\"\";for(let n of e){let r=\"declare\"in n?`let ${n.declare}`:vn(n.reference),s=n.initializeRHS;t+=`${r}=${s};\n`}return t}function nA(e){let t=\"\",n=\"\";for(let r of e){let s=\"declare\"in r?r.declare:vn(r.reference);r.updateRHS!==eA&&(t&&(t+=\",\",n+=\",\"),t+=`${s}`,n+=`${r.updateRHS}`)}return`[${t}]=[${n}]`}function dk(e,t,n){let r=t.args[0],s=e.chunk.getInstruction(r),o=e.chunk.getInstruction(s.endIndex),i=o.args[0],a=e.chunk.getInstruction(i),u=a.valueType,c=vn(n),p=[];e.enterFunction(a,i,2);let l=Nb(e,i,s.endIndex).source;e.exitFunction();let m=zO(n),d=kO(n);p.push({declare:m,initializeRHS:\"0\",updateRHS:`${m}+1`},{declare:d,initializeRHS:\"0\",updateRHS:`${d}+1`});for(let g=1;g<t.args.length;g++){let f=i+g;if(!e.referenced[f])continue;let h=Pb(f);p.push({reference:f,initializeRHS:e.referenceArg(t.args[g]),updateRHS:h},{declare:h,initializeRHS:void 0,updateRHS:eA})}let y=`${c}=(() => {\n    ${Gm(e,i+1,s.endIndex-1)}\n\n    let looping = true;\n    ${tA(p)}\n    while (looping) {\n      looping = false;\n\n      ${l}\n\n      if (looping) {\n        ${nA(p)}\n      }\n\n      if ((${m} > BuiltIn.RECURSIVE_DEPTH_LIMIT) || (${d} > BuiltIn.RECURSIVE_COMPUTATION_LIMIT)) {\n        return BuiltIn.handleRecursionLimitExceeded(__meta, ${u});\n      };\n    }\n\n    return ${e.referenceArg(o.args[1])}\n  })()`;return{type:sn.Inline,source:y,nextIdx:n+1}}function fk(e,t,n,r,s){let o=t.args[0],i=e.chunk.getInstruction(o),a=e.chunk.getInstruction(i.endIndex),u=a.args[0],c=vn(n),p=[],l=\"\",m,{iterationParameterIndex:d,loopStart:y,order:g}=r,f=r.maxRecursiveCallOffsets,h=u+d+1,x=vn(h),T=t.args[d+1],P=`(${y})`,M=e.chunk.getInstruction(T),S=(M.type===39||M.type===41)&&e.chunk.getInstruction(M.args[1]).type===23?M.args[0]:void 0,E=`(${e.referenceArg(T)})-${P}`,v,D;if(S!==void 0){let W=e.referenceArg(S);v=`BuiltIn.listMax(\n      (${W}).filter(\n        x => isFinite(x) &&\n        Math.floor(x - ${P}) === (x - ${P})\n      )\n    )`,D=`BuiltIn.getBroadcastTargetElements(${W}).has(${x})`}else v=`(${e.referenceArg(T)})`,D=\"false\";p.push({reference:h,initializeRHS:`(${P})`,updateRHS:`${x}+1`}),m=\"\";for(let W of g){let K=e.chunk.getInstruction(W),J=K.endIndex,re=e.chunk.getInstruction(J),ie=re.args[0],It=e.chunk.getInstruction(ie);for(let xe=1;xe<t.args.length;xe++){let ee=ie+xe;if(!e.referenced[ee])continue;let U=vn(ee);xe===d+1?m+=`${U}=${e.referenceArg(h)};\n`:l+=`${U}=${e.referenceArg(t.args[xe])};\n`}l+=Gm(e,ie+1,K.endIndex-1);let Bt=f[K.symbol];if(Bt!==void 0)for(let xe=1;xe<=Bt;xe++){let ee=sy(W,xe),U=xe===1?e.referenceArg(re.args[1]):sy(W,xe-1),te=t.args.slice(1).map((Rt,Mo)=>Mo===d?y-xe:e.referenceArg(Rt)),Ce=oy(W,`[${te.join(\",\")}]`),Ge=`BuiltIn.executeRecursiveFunction(\n            __meta,\n            ${s.innerFunctionsMap},\n            ${It.valueType},\n            ${Ce}\n          )`,pt=`(\n          broadcastOutputMap\n            ? (broadcastOutputMap[BuiltIn.recursionCacheKey(${Ce})] = ${Ge})\n            : ${Ge}\n        )`;p.push({declare:ee,initializeRHS:pt,updateRHS:U})}e.enterFunction(It,ie,1),m+=Nb(e,ie,K.endIndex).source,e.exitFunction(),m+=`const ${sy(W,0)}=${e.referenceArg(re.args[1])};\n`}let G=t.args.slice(1).map(W=>e.referenceArg(W)),j=t.args.slice(1).map((W,K)=>K===d?x:e.referenceArg(W)),Q=`${c}=(() => {\n    ${l}\n    const broadcastOutputMap = ${S!==void 0?\"__meta.iterativeRecursionOutputs\":\"undefined\"};\n\n    ${tA(p)}\n\n    const outerStackFrame = ${oy(o,`[${G.join(\",\")}]`)};\n\n    if (broadcastOutputMap) {\n        const cacheEntry = broadcastOutputMap[BuiltIn.recursionCacheKey(outerStackFrame)];\n        if (cacheEntry !== undefined) {\n          return cacheEntry;\n        }\n      }\n\n\n    const targetLoopSteps = ${E}\n    if (targetLoopSteps < 0 || Math.floor(targetLoopSteps) !== targetLoopSteps) {\n      return BuiltIn.executeRecursiveFunction(\n        __meta,\n        ${s.innerFunctionsMap},\n        ${i.valueType},\n        outerStackFrame\n      );\n    }\n\n    const loopEnd = ${v};\n\n    let result;\n    while (true) {\n      ${m}\n\n      result = ${e.referenceArg(a.args[1])};\n\n      if (broadcastOutputMap && ${D}) {\n        const key = BuiltIn.recursionCacheKey(${oy(o,`[${j.join(\",\")}]`)});\n        broadcastOutputMap[key] = result;\n      }\n\n      if (${x} < loopEnd) {\n        ${nA(p)}\n      } else {\n        break;\n      }\n    }\n\n    ${S===void 0?\"return result;\":`const cached = broadcastOutputMap[BuiltIn.recursionCacheKey(outerStackFrame)];\n          if (cached === undefined) {\n            return BuiltIn.recursionDiverges(__meta, ${i.valueType});\n          }\n          return cached;\n          `}\n  })()`;return{type:sn.Inline,source:Q,nextIdx:n+1}}function Rb(e){let{chunk:t}=e,n=Gm(e,t.argNames.length,t.instructionsLength()-1),r=0;for(;r<t.instructionsLength();){let s=t.getInstruction(r),o=OM(e,s,r);n+=RM(o),r=o.nextIdx}return n+=`return ${e.referenceArg(t.getReturnIndex())};`,n}function yk(e,t){let{chunk:n}=e,r=[],s=e.thunkName(t),o=e.thunkEnd(s),i=Vm(s),a=Bm(s),u=\"\",c=!1,p=!1;e.wantToInlineThunk(s)||(p=!0);let l=t;for(;l<=o;){let m=n.getInstruction(l),d=l===t?rA(e,m,l):OM(e,m,l);switch(d.type){case sn.Noop:break;case sn.Inline:c&&(u+=`,\n`),u+=d.source,c=!0;break;case sn.Block:c&&(u+=`;\n`),c=!1,u+=d.source,p=!0;break}r.push(u),l=d.nextIdx}if(u===\"\"&&(u=\"0\",p=!1),p){let m=`${i}=false;${a}=()=>{\n${i}=true;\n\n      ${u}${c?\";\":\"\"}\n    };\n`;return{type:sn.Block,source:m,nextIdx:l}}else return e.inlineThunk(s,u),{type:sn.Noop,nextIdx:l}}function OM(e,t,n){return e.isThunkBegin(n)?yk(e,n):rA(e,t,n)}function rA(e,t,n){let r=n+1;if(!e.referenced[n])return{type:sn.Noop,nextIdx:r};switch(t.type){case 0:case 47:case 48:case 22:case 49:case 4:return{type:sn.Noop,nextIdx:r};case 21:if(e.glsl)throw ZP();return hk(e,t,n);case 2:return e.inlineSource(n,e.chunk.argNames[n]),{type:sn.Noop,nextIdx:r};case 23:return{type:sn.Block,source:bk(e,t,n),nextIdx:r};case 24:return{type:sn.Block,source:xk(e,t,n),nextIdx:r};case 19:return{type:sn.Block,source:Tk(e,t,n),nextIdx:r};case 20:return{type:sn.Block,source:Ik(e,t,n),nextIdx:r};case 50:return{type:sn.Block,source:Pk(e,t,n),nextIdx:r};case 51:return{type:sn.Block,source:Ek(e,t,n),nextIdx:r};case 53:return JO(e,t,n);case 54:return QO(e,t,n);case 33:{let s=e.referenceArg(t.args[0]),o=e.referencePiecewiseBranch(t.args[1]),i=e.referencePiecewiseBranch(t.args[2]);if(!(o.thunkDependencies.some(l=>e.isEarlyReturningThunk(l))||i.thunkDependencies.some(l=>e.isEarlyReturningThunk(l)))){let l=e.emitTernary(s,o.expression,i.expression,t);return e.shouldInline(n)?(e.inlineSource(n,`(${l})`),{type:sn.Noop,nextIdx:r}):{type:sn.Inline,source:`${vn(n)}=${l}`,nextIdx:r}}let u=vn(n),c=l=>{if(l.length===0)return\"\";let m=\"\";for(let d of l){let y=e.inlinedThunks[d];if(y!==void 0){let g=`(${y},void 0)`;m!==\"\"?m=`(${m}||${g})`:m=g}else{let g=Vm(d),f=Bm(d);m!==\"\"&&(m+=\"||\"),m+=`(${g} ? undefined : ${f}())`}}return m=\"const earlyReturn =\"+m,m+=`;\nif (earlyReturn !== undefined) return earlyReturn;\n`,m},p=`if (${s}) {\n          ${c(o.thunkDependencies)}${u} = ${o.rawExpression};\n        } else {\n          ${c(i.thunkDependencies)}${u} = ${i.rawExpression};\n        }`;return{type:sn.Block,source:p,nextIdx:r}}case 55:return KO(e,t,n);default:{let s=Sk(e,t,n);return e.shouldInline(n)?(e.inlineSource(n,`(${s})`),{type:sn.Noop,nextIdx:r}):{type:sn.Inline,source:`${vn(n)}=${s}`,nextIdx:r}}}}function Nb(e,t,n){let{chunk:r,referenced:s}=e,o=\"\",i=t+1;for(;i<n;){if(!s[i]){i=i+1;continue}let a=r.getInstruction(i),u=OM(e,a,i);o+=RM(u),i=u.nextIdx}return{type:sn.Block,source:o,nextIdx:i}}function gk(e,t,n){let{endIndex:r}=t,{chunk:s}=e,o=`function(${vn(n)}) {\n`,i=n+1,a=r-1;o+=Gm(e,i,a),o+=Nb(e,n,r).source;let u=s.getInstruction(r);return o+=`return ${e.referenceArg(u.args[1])};\n}`,o}function hk(e,t,n){let r=\"BuiltIn.quad(\";r+=gk(e,t,n),r+=`,${e.referenceArg(t.args[0])},${e.referenceArg(t.args[1])})`;let{endIndex:s}=t,o=s+1;return e.shouldInline(o)?(e.inlineSource(o,r),{type:sn.Noop,nextIdx:t.endIndex}):{type:sn.Inline,source:`${vn(s+1)}=${r}`,nextIdx:t.endIndex}}function Gm(e,t,n){let{chunk:r,referenced:s}=e,o=\"\",i=!1;for(let a=t;a<=n;a++){if(!e.glsl&&e.isThunkBegin(a)){let c=e.thunkName(a);o+=`${i?\",\":\"var \"}${Vm(c)}`,o+=`,${Bm(c)}`,i=!0}let u=r.getInstruction(a);if(!(u.type===0||u.type===24||u.type===20||!s[a])){if(u.type===21){let{endIndex:c}=u;a=c,e.shouldInline(c+1)&&a++;continue}if(e.glsl&&u.type===4)throw XP();if(!e.shouldInline(a)&&(o+=e.emitVarDeclaration(a,i),i=!0,u.type===53)){let{endIndex:c}=u;a=c-1;continue}}}return i&&(o+=`;\n`),o}function bk(e,t,n){let{glsl:r,chunk:s,referenced:o}=e,i=vn(n),a=s.getInstruction(t.endIndex),u=e.referenceArg(t.args[0]),c=\"\";for(let l=1;l<a.args.length;l++){let m=t.endIndex+l;if(!o[m]||s.getInstruction(m).type!==48)continue;let y=vn(m);r||(c+=`${y}=[];\n`)}return r||(c+=`if(${u}>${1e4}) throw ErrorMsg.maxListSize();\n`),c+=`for(${i}=1${r?\".0\":\"\"};${i}<=${u};${i}++){\n`,c}function xk(e,t,n){let{glsl:r,chunk:s,referenced:o}=e,i=\"\";for(let a=1;a<t.args.length;a++){let u=n+a;if(u>=s.instructionsLength()||!o[u]||s.getInstruction(u).type!==48)continue;let c=vn(n+a),p=e.referenceArg(t.args[a]);if(r){let l=e.referenceArg(t.args[0]);i+=`${c}[int(${l})-1]=${p};\n`}else i+=`${c}.push(${p});\n`}return i+=`}\n`,i}function Tk(e,t,n){let{chunk:r,referenced:s}=e,o=vn(n);e.beforeBeginLoop(t);let i=`${e.referenceArg(t.args[0])}`,a=`${e.referenceArg(t.args[1])}`,u=`if(${i}>${a}){\n`;for(let c=2;c<t.args.length;c++){let p=t.endIndex+c-1;if(p>=r.instructionsLength()||!s[p]||r.getInstruction(p).type!==47)continue;let l=vn(p);u+=`${l}=${e.referenceArg(t.args[c])};\n`}u+=e.checkFiniteBounds(t,i,a),u+=`}else{\n`;for(let c=2;c<t.args.length;c++){let p=n+c-1;if(!s[p]||r.getInstruction(p).type!==47)continue;let l=vn(p);u+=`${l}=${e.referenceArg(t.args[c])};\n`}return u+=`${o}=${i};\n`,u+=\"while (true) {\",u}function Ik(e,t,n){let{chunk:r,referenced:s}=e,o=r.getInstruction(t.args[0]),i=`${e.referenceArg(o.args[1])}`,a=vn(t.args[0]),u=`${a}++;`;u+=`if (${a}<=${i}) {\n`;let c=new Map,p=[];for(let l=1;l<t.args.length;l++){let m=t.args[0]+l;if(!s[m]||r.getInstruction(m).type!==47)continue;let d=t.args[l];c.set(m,e.referenceArg(d)),p[d]=e.isDirectlyReferencedByName(d)}for(let[l,m]of c.entries())if(p[l]){let d=FO(l);u+=e.emitImmediateAssignment(l,d,m),c.set(l,d)}for(let[l,m]of c.entries())u+=`${vn(l)}=${m};\n`;u+=`} else {\n`;for(let l=1;l<t.args.length;l++){let m=n+l;if(m>=r.instructionsLength()||!s[m]||r.getInstruction(m).type!==47)continue;let d=vn(m);u+=`${d}=${e.referenceArg(t.args[l])};\n`}return u+=`break;\n`,u+=`}\n}\n`,u+=`}\n`,u}function Pk(e,t,n){let{glsl:r}=e;if(r)throw V(\"GLSL map not implemented yet\");let s=vn(t.endIndex+1),o=[];for(let a=0;a<t.callData.parameterSymbols.length;a++){let u=vn(n+a+1);o.push(u)}let i=o.join(\",\");return`${s}=(${i}) => {\n`}function Ek(e,t,n){let r=`return ${e.referenceArg(t.args[1])}`;return r+=`}\n`,r}function Sk(e,t,n){switch(t.type){case 1:return e.emitConstant(t);case 8:case 9:case 10:case 11:case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 31:case 32:return e.emitBinary(t,e.referenceArg(t.args[0]),e.referenceArg(t.args[1]));case 14:{let s=e.referenceArg(t.args[0]);return e.emitNeg(s)}case 56:{let s=e.referenceArg(t.args[0]);return e.emitSquare(s)}case 15:{let s=t.valueType;switch(s){case N:case O:return e.emitVec2(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]));case F:return e.emitVec3(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]),e.referenceArg(t.args[2]));case Et:return e.emitVec3(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]),e.referenceArg(t.args[2]));case St:case Mt:case Ut:case Ht:case qt:case $t:case Yt:case Ot:return e.emitVec(...t.args.map(i=>e.referenceArg(i)));default:let o=s;throw new Error(`Unexpected tuple type ${o}`)}}case 16:{let s=e.chunk.getInstruction(t.args[0]).valueType;switch(s){case N:case F:case O:case Et:case St:case Mt:case Ut:case Ht:case qt:case $t:case Yt:case Ot:return e.emitVecAccess(e.referenceArg(t.args[0]),t.index);default:let o=s;throw new Error(`Unexpected tuple type ${o}`)}}case 38:return e.emitList(t.args.map(s=>e.referenceArg(s)),t);case 40:case 42:case 3:throw new Error(`Programming Error: expect ${ls(t.type)} to be removed before emitting code.`);case 39:{let s=t.valueType;return e.emitListAccess(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]),e.printValue({value:Is(s),valueType:s}),t)}case 41:return e.emitInboundsListAccess(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]));case 37:{let s=t.args.map(i=>e.referenceArg(i)),o=Mk(e,t,n,s);return o!=null?o:e.emitNativeFunction(s,t)}case 44:return e.emitExtendSeed(e.referenceArg(t.args[0]),e.chunk.getInstruction(t.args[1]).valueType,e.referenceArg(t.args[1]),t.tag);case 2:case 0:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 48:case 49:case 50:case 51:case 53:case 54:case 33:case 55:case 4:throw new Error(`Unexpected opcode ${t.type}`);default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function Mk(e,t,n,r){if(e.glsl)return;if(n===e.chunk.getReturnIndex()&&t.symbol===\"coerceComplexToReal\"||t.symbol===\"peelableCoerceComplexToReal\")return`BuiltIn.peelableCoerceComplexToReal(${r.join(\",\")},__meta)`;if(n===e.chunk.getReturnIndex()&&t.symbol===\"coerceComplexToRealWithTolerance\"||t.symbol===\"peelableCoerceComplexToRealWithTolerance\")return`BuiltIn.peelableCoerceComplexToRealWithTolerance(${r.join(\",\")},__meta)`}function sA(e,t,n){if(t.recursionGroup.length>1)return!1;let r=t.endIndex,s=e.getInstruction(r),[o,...i]=s.args;if(i.length!==1)return!1;let u=e.getInstruction(o).args[0],c={};c[i[0]]=!1;for(let p=r-1;p>=o;p--){let l=e.getInstruction(p);if(ce(l)&&n[p]){if(l.type===33&&!c[p])c[l.args[0]]=!0;else for(let m of l.args)c[m]=!0;if(l.type===55&&l.args[0]===u&&c[p])return!1}}return!0}function oA(e,t,n,r){let s=e.getInstruction(n.args[0]);if(s.recursionGroup.length>1)return[];let o=s.endIndex,i=e.getInstruction(o),a=new Db(e,r,t,o),u=[];for(let p=1;p<i.args.length;p++)u[i.args[p]]={op:\"&&\",values:[]};for(let p=o-1;p>t;p--){let l=u[p];if(l===void 0)continue;let m=e.getInstruction(p);if(ce(m))if(m.type===33){u[m.args[0]]=l;let d=a.condition(m.args[0]);d!==void 0&&(u[m.args[1]]=DM(l,d),u[m.args[2]]=DM(l,vb(d)))}else for(let d of m.args)u[d]=l}let c=[];e:for(let p=o-1;p>=t;p--){let l=e.getInstruction(p);if(l.type!==55)continue;let m=e.getInstruction(l.args[0]);if(p>m.endIndex)continue;let d=l.args.slice(1);if(d.length!==m.signature.argTypes.length)throw new Error(\"Programming error: Non-matching arg length\");let y=u[p];if(y!==void 0){if(y.op===\"&&\"&&y.values.length===0)throw new Error(\"Programming error: Recursive call unconditionally executed\");for(let g=0;g<d.length;g++){if(e.getInstruction(d[g]).valueType!==b)continue e;let f=a.coeffs(d[g]);if(f===void 0||!Ck(f,g)||w(f.argCoeffs[g])<-1)continue e}c[p]=y}}return c}function Ck(e,t){for(let n=0;n<e.argCoeffs.length;n++)if(n!==t&&w(e.argCoeffs[n])!==0)return!1;return!0}function iA(e,t){let n=e.getReturnIndex(),r=new Array(n),s=new Array(n).fill(!1);for(let i=0;i<=n;i++){let a=e.getInstruction(i);cs(a)||Ss(a)||a.type===48||a.type===47&&e.getInstruction(a.args[0]).type!==22||a.type===0||a.type===55?r[i]=2:r[i]=0}r[n]===0&&(r[n]=1,s[n]=!0);let o=0;for(let i=n;i>=0;i--){if(!t[i])continue;let a=e.getInstruction(i);if(a.type===54?o++:a.type===53&&o--,!ce(a))continue;if(a.type===19||a.type===20||a.type===24||a.type===54||a.type===39||a.type===55)for(let c of a.args){let p=e.getInstruction(c);r[c]===0&&p.type===1&&p.valueType===b?(r[c]=1,s[c]=!0):(r[c]=2,s[c]=!1)}else{for(let c of a.args)switch(r[c]){case 0:r[c]=1,s[c]=!0;break;case 1:case 2:r[c]=2,s[c]=!1;break}o>0&&a.type===33&&(r[i]=2,s[i]=!1)}}return s}function vk(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}var Ob=class{constructor(t,n,r){this.chunk=t;this.referenced=n;this.shouldInline=r;this.thunkSets=[];this.thunkStarts=[];this.thunkEnds=[];this._isThunkEnd=[];this.piecewiseReferencedCount=[];this.dependencyThunkNames=[];this.parentFunctionStart=[];let s=t.getReturnIndex();for(let a=0;a<=t.instructionsLength();a++)this.thunkSets[a]=new Set;let o=t.argNames.length,i=[];for(let a=o;a<=t.getReturnIndex();a++){let u=t.getInstruction(a);this.parentFunctionStart[a]=i[i.length-1],u.type===53?i.push(a):u.type===54&&i.pop()}this.markThunkSets(o,s,[s],\"always\"),this.markThunks(o,s)}isThunkBegin(t){return this.thunkStarts[t]===t}isThunkEnd(t){return!!this._isThunkEnd[t]}containingThunkName(t){return this.thunkStarts[t]}thunkEnd(t){return this.thunkEnds[t]}isEarlyReturningThunk(t){let n=this.parentFunctionStart[t];return this.isThunkBegin(t)&&n!==void 0}dependencyThunkNamesForPiecewiseBranch(t){return this.dependencyThunkNames[t]}wantToInlineThunk(t){let n=this.thunkSets[t];if(n!==\"always\"&&n.size===1){for(let r of n)if(this.piecewiseReferencedCount[r]!==1)return!1;return!0}return!1}printChunkWithThunkInfo(){for(let t=0;t<=this.chunk.getReturnIndex();t++){let n=this.thunkSets[t],r=n===\"always\"?\"always\":`{${[...n].sort().join(\",\")}}`;if(this.isThunkBegin(t)&&(r+=\" beginThunk\"),this.isThunkEnd(t))r+=\" endThunk\";else{let s=this.containingThunkName(t);s!==void 0&&(r+=` start:${s}`)}this.shouldInline[t]&&(r+=\"\t[inline]\"),this.chunk.comments[t]=r}return this.chunk.print(this.chunk.getReturnIndex())}markThunkSets(t,n,r,s){let{chunk:o,referenced:i,thunkSets:a,piecewiseReferencedCount:u}=this;for(let p of r)a[p]=\"always\";function c(p,l){let m=a[p];if(m!==\"always\"){if(l===\"always\"){a[p]=l;return}for(let d of l)m.add(d)}}for(let p=n;p>=t;p--){if(!i[p])continue;let l=o.getInstruction(p);if(!ce(l))continue;let m=a[p];if(Ss(l)){let d=l.args[0];this.markThunkSets(d+1,p-1,l.args.slice(1),m),p=d+1;continue}for(let d=0;d<l.args.length;d++){let y=l.args[d];if(y<t)c(y,s);else if(d>0&&l.type===33){let g=a[y];g!==\"always\"&&g.add(y);let f=u[y];u[y]=(f!=null?f:0)+1}else c(y,m)}}}markThunks(t,n){var a,u;let{chunk:r,thunkSets:s}=this,o,i;for(let c=t;c<=n;c=i){let p=r.getInstruction(c),l=Dk(this.chunk,p),m,d;if(l){let y=c+1,g=l.innerEndIndex-1;this.markThunks(y,g),d=s[l.innerEndIndex],i=l.outerEndIndex+1,m=this.thunkDecision(o,c,this.referenced[l.innerEndIndex],p.type===21&&this.shouldInline[l.outerEndIndex],d)}else d=s[c],i=c+1,m=this.thunkDecision(o,c,this.referenced[c],this.shouldInline[c],d);if(o!==void 0&&m.shouldEndThunk&&(this.markEndThunk(c-1,o),o=void 0),m.shouldStartThunk&&d!==\"always\"){for(let y of d)(u=(a=this.dependencyThunkNames)[y])!=null||(a[y]=[]),this.dependencyThunkNames[y].push(c);o={start:c,set:d}}if(o!==void 0&&(this.thunkStarts[c]=o.start,l))for(let y=l.innerEndIndex;y<=l.outerEndIndex;y++)this.thunkStarts[y]=o.start}o!==void 0&&this.markEndThunk(n,o)}thunkDecision(t,n,r,s,o){let i=this.chunk.getInstruction(n);if(i.type===33&&(s=!1),s||!r)return{shouldEndThunk:!1,shouldStartThunk:!1};if(o===\"always\")return{shouldEndThunk:t!==void 0,shouldStartThunk:!1};let a=i.type===1||i.type===47,u=o.size>0&&!a,c=t!==void 0&&!vk(o,t.set);return{shouldEndThunk:c,shouldStartThunk:(c||t===void 0)&&u}}markEndThunk(t,n){let{referenced:r}=this;for(;t>=0&&!r[t];)t--;this._isThunkEnd[t]=!0,this.thunkEnds[n.start]=t}};function Dk(e,t){if(cs(t)){let n=t.endIndex,r=e.getInstruction(n);if(r===void 0)return;if(Ib(r))return{outerEndIndex:n+r.args.length-1,innerEndIndex:n};if(r.type===54)return{outerEndIndex:n,innerEndIndex:n}}}var Hm=class{constructor(t,n){this.chunk=t;this.glsl=n;this.inlinedSource=[];this.inlinedThunks=[];this.recursiveFunctionInfo=[];this.isTailFunction=[];let r=t.getReturnIndex();this.referenced=Zr(t,r),this._shouldInline=iA(t,this.referenced),!this.glsl&&t.computeNeedsThunking()&&(this.thunks=new Ob(t,this.referenced,this._shouldInline));for(let s=0;s<=r;s++){let o=t.getInstruction(s);if(o.type===4){if(!this.referenced[s])continue;this.isTailFunction[s]=sA(t,o,this.referenced),o.recursionGroup=o.recursionGroup.filter(i=>this.referenced[i])}}}isThunkBegin(t){return!!this.thunks&&this.thunks.isThunkBegin(t)}isThunkEnd(t){return!!this.thunks&&this.thunks.isThunkEnd(t)}isEarlyReturningThunk(t){return!!this.thunks&&this.thunks.isEarlyReturningThunk(t)&&this.inlinedThunks[t]===void 0}thunkName(t){var n;return(n=this.thunks)==null?void 0:n.containingThunkName(t)}thunkEnd(t){return this.thunks.thunkEnd(t)}shouldInline(t){return this._shouldInline[t]}inlineSource(t,n){this.inlinedSource[t]=n}wantToInlineThunk(t){return!!this.thunks&&this.thunks.wantToInlineThunk(t)}inlineThunk(t,n){this.inlinedThunks[t]=n}referenceArg(t){let n=this.inlinedSource[t];return n!==void 0?n:vn(t)}isDirectlyReferencedByName(t){return this.inlinedSource[t]===void 0}referencePiecewiseBranch(t){var i;let n=this.referenceArg(t),r=(i=this.thunks)==null?void 0:i.dependencyThunkNamesForPiecewiseBranch(t);if(!r||r.length===0)return{expression:n,rawExpression:n,thunkDependencies:[]};let s=[],o=\"\";for(let a of r){let u=this.inlinedThunks[a];if(u!==void 0)o&&(o+=\",\"),o+=u;else{let c=Vm(a),p=Bm(a),l=`${c}||${p}()`;o&&(o+=\",\"),o+=`${l}`}s.push(a)}return{expression:\"(\"+o+\",\"+n+\")\",rawExpression:n,thunkDependencies:s}}enterFunction(t,n,r){let s=t.args[0],o=this.chunk.getInstruction(s),i=[];for(let u=0;u<o.signature.argTypes.length;u++)i.push(n+u+1);let a=oA(this.chunk,n,t,i);this.recursiveFunctionInfo.push({fn:s,argBlockvars:i,reachConditions:a,returnType:t.valueType,executionMode:r})}exitFunction(){this.recursiveFunctionInfo.pop()}};function Ab(e){let t=new AM(e),n=Rb(t);return t.finish(n)}var AM=class extends Hm{constructor(n){super(n,!1);this.constants=[]}finish(n){return{source:n,constants:this.constants}}printValue(n){return aA(n.value)}beforeBeginLoop(){}checkFiniteBounds(n,r,s){let o=`}else if(!isFinite(${s}-${r})){\n`;for(let i=2;i<n.args.length;i++){let a=n.endIndex+i-1;if(a>=this.chunk.instructionsLength()||!this.referenced[a])continue;let u=this.chunk.getInstruction(a);if(u.type!==47)continue;let c=vn(a);Yi(u.valueType)?o+=`${c}=${this.printValue({value:Is(u.valueType),valueType:u.valueType})};\n`:o+=`throw new Error('Cannot set ${c} of type ${We(u.valueType)} to NaN value');\n`}return o}emitConstant(n){return n.valueType===b||n.valueType===Re||n.valueType===N||n.valueType===F?this.printValue(n):(this.constants.push(_a(n.value)),`_C[${this.constants.length-1}]`)}emitNeg(n){return`-${n}`}emitSquare(n){return`(${n})**2`}emitTernary(n,r,s){return`${n}?${r}:${s}`}emitVec2(n,r){return`[${n},${r}]`}emitVec3(n,r,s){return`[${n},${r},${s}]`}emitVec(...n){return`[${n.join(\",\")}]`}emitVecAccess(n,r){return`${n}[${r}]`}emitBinary(n,r,s){switch(n.type){case 8:return`${r}+${s}`;case 9:return`${r}-${s}`;case 10:return`${r}*${s}`;case 11:return`${r}/${s}`;case 12:return`BuiltIn.pow(${r},${s})`;case 13:return`Math.pow(${r},${s})`;case 25:return`${r}===${s}`;case 26:return`${r}<${s}`;case 28:return`${r}<=${s}`;case 27:return`${r}>${s}`;case 29:return`${r}>=${s}`;case 31:return`${r}||${s}`;case 32:return`${r}&&${s}`;default:throw new Error(\"Programming Error: invalid binary opcode.\")}}emitList(n){return`[${n.join(\",\")}]`}emitListAccess(n,r,s){let o=`${n}.length`,i=`Math.floor(${r})`;return`(${i}>=1&&${i}<=${o})?${n}[${i}-1]:${s}`}emitInboundsListAccess(n,r){return`${n}[${r}-1]`}emitNativeFunction(n,r){let s=Wn[r.symbol];return`${s.module}.${s.symbol}(${n.join(\",\")})`}emitExtendSeed(n,r,s,o){let i=r===b?s:`BuiltIn.serializeNonNumericSeedPart(${r},${s})`;return`${n}+'::${o}'+${i}`}emitVarDeclaration(n,r){let s=r?\",\":\"var \";return s+=vn(n),s}emitImmediateAssignment(n,r,s){return`var ${r}=${s};`}emitFunctionCall(n,r,s,o){return`${n}(${r}, ${s}, ${o.join(\",\")})`}};function aA(e){if(Array.isArray(e))return`[${e.map(aA).join(\",\")}]`;switch(typeof e){case\"boolean\":case\"number\":return e.toString();case\"string\":return`${JSON.stringify(e)}`;case\"object\":if(Zu(e))throw new Error(\"Action values cannot be compiled\");return w(e).toString();default:throw new Error(`Unexpected value: ${e}`)}}function _b(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==47)throw new Error(`Expected BlockVar, got ${t.type}`);let n=e.getInstruction(t.args[0]);if(n.type!==51)throw new Error(`Expected EndMap, got ${n.type}`);let r=Zn(t.valueType),s=e.getInstruction(n.args[0]);if(s.type!==50)throw new Error(`Expected BeginMap, got ${s.type}`);let o=[];for(let l of s.args){let m=e.getInstruction(l);if(!Ue(m)||m.valueType!==b)throw V(\"Programming error: interval bounds must be constant numbers\");o.push(w(m.value))}let i,a;r===No||r===Ro||r===rs?(i=[\"t\"],a={type:\"1d\",min:o[0],max:o[1]}):(i=[\"u\",\"v\"],a={type:\"2d\",uMin:o[0],uMax:o[1],vMin:o[2],vMax:o[3]});let u=Ab(e),c=`\n  const mapFn = (function() {\n    \"use strict\";\n    ${u.source}\n  })();\n  return mapFn(${i.join(\",\")});\n`,p={};return{args:i,source:c,constants:u.constants,executionMetadata:p,fn:ry(i,c,u.constants,p),domain:a}}var Dn=class e extends lt{constructor(n){super();this.type=\"IRExpression\";this.isError=!1;if(n.getError())throw new Error(\"Programming error: IRExpression should not be constructed with an error chunk\");if(this.warning=n.getWarning(),this._chunk=n,this.valueType=n.getReturnType(),this.addDependencies(n.getLiveArgNames()),this.isList=$(this.valueType),this.isList&&(this.length=this._chunk.getConstantListLength(),this.length===void 0))throw XS(n.getListLengthDependencies());AO(n);let r=n.isConstant();this.isConstant=r&&(this.valueType===b||this.valueType===Re),this.isTypedConstant=r,this.isEmptyAction=r&&this.valueType===it&&Object.keys(n.asValue().updateRules).length===0}shouldExportAns(){return!0}getCompiledFunction(n){return Ia(this.valueType)?_b(this._chunk):this._chunk.getCompiledFunction(n)}getRestrictedFunctionForGLSL(n,r){return this._chunk.getRestrictedFunctionForGLSL(n,r)}polynomialOrder(n){return this._chunk.polynomialOrder(n,{allowRestriction:!0,allowClosedBlockReferences:!1})}getPolynomialCoefficients(n){let r=this._chunk.getPolynomialCoefficients(n),s=r.chunk,o=r.coefficients,i=[];for(let a=0;a<o.length;a++){let u=s.copy();u.setReturnIndex(o[a]),u.fuseBroadcast(),i.push(new e(u))}return i}takeDerivative(n){let r=this._chunk.copy().takeDerivative(n).fuseBroadcast();return new e(r)}gradient(n){let r=this._chunk.copy().gradient(n).fuseBroadcast();return new e(r)}toImplicitBool(){let n=this._chunk.copy();return n.GreaterEqual([n.getReturnIndex(),n.Constant(0)]),n.fuseBroadcast(),new e(n)}interpretWithParameters(n){let r,s=this._chunk.argNames;if(n.length===s.length)r=n;else{r=[];let o=this.getDependencies();for(let i=0,a=0;i<s.length;i++)o[a]===s[i]?(r.push(n[a]),a+=1):r.push(void 0)}return this._chunk.interpretWithParameters(r)}substituteConstantArguments(n){return new e(this._chunk.substituteConstantArguments(n))}boundDomain(n){return this._chunk.boundDomain(n)}asValue(){var n;if(this._chunk.isConstant())return this._chunk.asValue();if(this.isList){let r=[],s=_a(Is(Xe(this.valueType)));for(let o=0;o<((n=this.length)!=null?n:0);o++)r.push(s);return r}else return _a(Is(this.valueType))}asCompilerValue(){return this._chunk.asCompilerValue()}isNaN(){return typeof this.asValue()==\"number\"&&isNaN(this.asValue())}findLinearSubset(n){return this._chunk.findLinearSubset(n)}deriveRegressionRestrictions(){let n=this._chunk.deriveRegressionRestrictions();return n===this._chunk?this:new e(n)}eachElement(n){var r;for(let s=0;s<((r=this.length)!=null?r:0);s++)n(this.elementAt(s),s)}mapElements(n){var s;let r=[];for(let o=0;o<((s=this.length)!=null?s:0);o++)r.push(n(this.elementAt(o),o));return r}elementAt(n){let r=this._chunk.elementAt(n);return new e(r)}getCursorContext(){return this._chunk.getCursorContext()}getRecursiveFunctionMetadata(){let n=this._chunk.getInstruction(this._chunk.getReturnIndex());if(n.type===55)return this._chunk.getRecursiveFunctionMetadata(n.args[0])}coerceToNumericIfPossible(n={}){if(se(this.valueType,ve)||se(this.valueType,Te)||se(this.valueType,O)){let r=this._chunk.copy(),s=r.getReturnIndex();return r.coerceToNumericIfPossible(n)===s?this:new e(r)}else return this}coerceToNumericIfPossibleWithTolerance(){return this.coerceToNumericIfPossible({withTolerance:!0})}slot(n){let r=this._chunk.copy();return r.setReturnIndex(r.Slot(n,[r.getReturnIndex()])),new e(r)}getCompiledDerivative(){let n=this.getDependencies();return this.takeDerivative(n[0]||\"x\").getCompiledFunction()}};var La=class extends k{constructor(n){super(n);this.type=\"ListAccess\";this.list=n[0],this.index=n[1]}};var tc=class extends k{constructor(n,r,s,o,i=[]){super([n,r].concat(s),{skipRegisterDependencies:!0});this.shouldCoerceToList=o;this.parameters=i;this.type=\"ListComprehension\";this._index=n,this._body=r,this._inputLists=s,this.registerDependencies()}registerDependencies(){let n=[];for(let o of this._inputLists){let i=o._symbol;n.push(i)}for(let o of this.parameters){let i=o.identifier._symbol;n.push(i)}this.addOptionalDependencies(n);let s=[this._index._symbol,...n];for(let o of this._inputLists)this.mergeDependenciesInScope(\"ListComprehension\",s,o.args[1]);for(let o of this.parameters)this.mergeDependenciesInScope(\"ListComprehension\",s,o.bounds[0]),this.mergeDependenciesInScope(\"ListComprehension\",s,o.bounds[1]);this.mergeDependenciesInScope(\"ListComprehension\",s,this._body)}};var wb=class extends _n{constructor(){super(...arguments);this.type=\"MixedNumber\"}};var Fa=class extends Di{constructor(n,r,s){super(n);this.type=\"MovablePoint\";this.moveStrategy=r,this.defaultDragMode=s,this.valueType=N}asValue(){return[+this.args[0].asValue(),+this.args[1].asValue()]}asCompilerValue(){return[this.args[0].asCompilerValue(),this.args[1].asCompilerValue()]}};var qm=class extends k{constructor(){super(...arguments);this.type=\"Multiply\"}};var Um=class extends k{constructor(){super(...arguments);this.type=\"Negative\"}};var zm=class extends k{constructor(){super(...arguments);this.type=\"Norm\"}};var km=class extends k{constructor(){super(...arguments);this.type=\"Or\"}};var $m=class extends k{constructor(){super(...arguments);this.type=\"PercentOf\"}};var ip=class extends k{constructor(n,r){super(r);this.type=\"Prime\";this.order=n}};var Ym=class extends k{constructor(t){super(t,{skipRegisterDependencies:!0}),this._index=t[0],this.registerDependencies()}registerDependencies(){for(let t=1;t<=3;t++)this.mergeDependenciesInScope(\"RepeatedOperator\",[this._index._symbol],this.args[t])}};var Zm=class extends Ym{constructor(){super(...arguments);this.type=\"Product\";this.in_place_operator=\"*=\";this.starting_value=1}evaluateConstant(n){let r=1+Math.round(n[1])-Math.round(n[0]);return r<=0?this.starting_value:Math.pow(n[2],r)}update(n,r){return n*r}};var ap=class extends k{constructor(n){super(n);this.type=\"Range\";this.beginning=n[0],this.end=n[1]}isHalfEmpty(){return this.end&&this.end.args&&this.end.args.length===0}};var Xm=class extends k{constructor(){super(...arguments);this.type=\"Restriction\"}};var up=class extends k{constructor(n){typeof n!=\"string\"&&(n=\"\"+n);super([]);this.type=\"Seed\";this.isString=!0;this._stringValue=n}asValue(){return this._stringValue}};var Lb=class extends En{constructor(n,r){super(n,r);this.type=\"SeededFunctionCall\";this.seed=r[0]}};var Fb=class extends Rn{constructor(n,r){super(new hn(n._symbol),n._expression);this.type=\"Slider\";this.setInputSpan(n._inputSpan),this.sliderAssignment=n,this.sliderMin=r.sliderMin,this.sliderMax=r.sliderMax,this.sliderSoftMin=r.sliderSoftMin,this.sliderSoftMax=r.sliderSoftMax,this.sliderStep=r.sliderStep,this.sliderIsPlayingOnce=r.sliderIsPlayingOnce,this.sliderMin&&this.mergeDependencies(this.sliderMin),this.sliderMax&&this.mergeDependencies(this.sliderMax),this.sliderStep&&this.mergeDependencies(this.sliderStep)}shouldPromoteToSlider(n){return!1}asAssignment(){return new Mm(this._symbol,this._expression)}};var Vb=class extends lt{constructor(n,r,s,o){super();this.type=\"SolvedEquation\";this._symbol=n,this._expression=r,this.otherVariableSolutionData=s,this.mergeDependencies(r),this.branchMultiplier=o}};var Wm=class extends k{constructor(){super(...arguments);this.type=\"Stats\";this._symbol=\"stats\"}};var Mu=class extends k{constructor(n,r){super([n].concat(r),{skipRegisterDependencies:!0});this.type=\"Substitution\";this._body=n,this._assignments=r,this.registerDependencies()}registerDependencies(){let n=[];for(let r=0;r<this._assignments.length;r++){let s=this._assignments[r],o=s._lhs,i=s._rhs;if(o instanceof Ve){let a=s._symbol;n.push(a),this.mergeDependencies(i)}else if(o instanceof En)this.mergeDependencies(s);else throw new Error(`Unexpected LHS in assignment expression: ${o.type}`);this.addSubstitutionDependencies(i.getDependencies())}this.addOptionalDependencies(n),this.mergeDependenciesInScope(\"Substitution\",n,this._body)}};var jm=class extends Ym{constructor(){super(...arguments);this.type=\"Sum\";this.in_place_operator=\"+=\";this.starting_value=0}evaluateConstant(n){let r=1+Math.round(n[1])-Math.round(n[0]);return r<=0?this.starting_value:r*n[2]}update(n,r){return n+r}};var Bb=class extends lt{constructor(n){super();this.type=\"Ticker\";this.handler=n.handler,this.minStep=n.minStep,this.mergeDependencies(this.handler),this.mergeDependencies(this.minStep)}};var Jm=class extends k{constructor(){super(...arguments);this.type=\"TTest\";this._symbol=\"ttest\"}};var Qm=class extends k{constructor(n){super(n,{skipRegisterDependencies:!0});this.type=\"UpdateRule\";this._symbol=n[0]._symbol,this._expression=n[1],this.registerDependencies()}registerDependencies(){this.addUpdateSymbol(this._symbol),this.mergeDependencies(this._expression)}};var $c=class extends lt{constructor(n,r){super();this.type=\"CallAssignment\";this._symbol=n._symbol,this.mergeDependencies(n,r),this._lhs=n,this._rhs=r}asComparator(){return new Oa([this._lhs,this._rhs])}};var Nr=\"i\",Va=class extends k{constructor(){super([]);this.type=\"ImaginaryUnit\"}};var Cu=class extends k{constructor(n,r,s){super(n);this.type=\"MovableComplexNumber\";this.moveStrategy=r,this.defaultDragMode=s,this.valueType=O}asValue(){return[+this.args[0].asValue(),+this.args[1].asValue()]}asCompilerValue(){return[this.args[0].asCompilerValue(),this.args[1].asCompilerValue()]}};var Ba=class extends k{constructor(n,r){super(r);this.type=\"NamedCoordinateAccess\";this.symbol=n}};function Cs(e){switch(e.type){case\"IRExpression\":case\"MovablePoint\":case\"MovableComplexNumber\":return{valueType:e.valueType,value:e.asValue()};default:return}}function ut(e){if(Fm(e)){let r=[],s=Xe(e.valueType);for(let o of e.value)r.push(ut({valueType:s,value:o}));return new A.List(r)}let{value:t,valueType:n}=e;switch(n){case b:case Re:return new A.Constant(t);case Pt:return new A.Seed(t);case O:return new A.Add([ut({valueType:b,value:t[0]}),new A.Multiply([ut({valueType:b,value:t[1]}),new A.ImaginaryUnit])]);case N:return new A.ParenSeq([ut({valueType:b,value:t[0]}),ut({valueType:b,value:t[1]})]);case F:return new A.ParenSeq([ut({valueType:b,value:t[0]}),ut({valueType:b,value:t[1]}),ut({valueType:b,value:t[2]})]);case Jt:return new A.FunctionCall(\"segment\",[ut({valueType:F,value:t[0]}),ut({valueType:F,value:t[1]})]);case Fe:return new A.FunctionCall(\"vector\",[ut({valueType:F,value:t[0]}),ut({valueType:F,value:t[1]})]);case Kn:return new A.FunctionCall(\"triangle\",[ut({valueType:F,value:t[0]}),ut({valueType:F,value:t[1]}),ut({valueType:F,value:t[2]})]);case Mr:return new A.FunctionCall(\"sphere\",[ut({valueType:F,value:t[0]}),ut({valueType:b,value:t[1]})]);case pn:return new A.FunctionCall(\"rgb\",[ut({valueType:b,value:t[0]}),ut({valueType:b,value:t[1]}),ut({valueType:b,value:t[2]})]);case Se:return new A.FunctionCall(\"polygon\",[ut({valueType:Gt,value:t})]);case Ie:return new A.FunctionCall(\"segment\",[ut({valueType:N,value:t[0]}),ut({valueType:N,value:t[1]})]);case Pe:return new A.FunctionCall(\"line\",[ut({valueType:N,value:t[0]}),ut({valueType:N,value:t[1]})]);case De:return new A.FunctionCall(\"ray\",[ut({valueType:N,value:t[0]}),ut({valueType:N,value:t[1]})]);case ye:return new A.FunctionCall(\"mathVector\",[ut({valueType:N,value:t[0]}),ut({valueType:N,value:t[1]})]);case pe:return new A.FunctionCall(\"circle\",[ut({valueType:N,value:t[0]}),ut({valueType:b,value:t[1]})]);case ae:return new A.FunctionCall(\"arc\",[ut({valueType:N,value:t[0]}),ut({valueType:N,value:t[1]}),ut({valueType:N,value:t[2]})]);case ve:return new A.FunctionCall(\"angle\",[ut({valueType:N,value:t[0]}),ut({valueType:b,value:t[1]}),ut({valueType:b,value:t[2]})]);case Te:return new A.FunctionCall(\"directedangle\",[ut({valueType:N,value:t[0]}),ut({valueType:b,value:t[1]}),ut({valueType:b,value:t[2]})]);case Qn:return new A.FunctionCall(\"tone\",[ut({valueType:b,value:t[0]}),ut({valueType:b,value:t[1]})]);case it:case Ne:case nn:case Et:case Ot:case St:case Mt:case Ut:case Ht:case qt:case $t:case Yt:throw new Error(`Programming error: cannot create parse node from valueType: ${We(n)}`);default:throw new Error(`Programming error: unexpected value: ${e}`)}}function Nk(e){if(!Ni(e))return new Xn(NaN);let t={value:e.asCompilerValue(),valueType:e.valueType};return t?ut(t):new Xn(NaN)}function Rk(e){if(!Ni(e))return NaN;let t=Cs(e);if(!t)return NaN;switch(t.valueType){case b:return t.value;case O:return t.value;default:throw V(`Unexpected type ${We(t.valueType)} in column.`)}}var vu=class extends wo{constructor(n,r){super(n.map(Nk));this.rawArgs=n;this.headerSymbol=r;this.type=\"TableColumnValue\";this.isIndependent=r!==void 0}asValueMixed(){return this.rawArgs.map(Rk)}};var Ok={Placeholder:Kl,Error:C,Constant:Xn,MixedNumber:wb,Identifier:hn,Ans:yb,ImaginaryUnit:Va,List:Tm,TableColumnValue:vu,Range:ap,ListAccess:La,DotAccess:qs,Construction:np,ParenSeq:wc,MovableComplexNumber:Cu,MovablePoint:Fa,NamedCoordinateAccess:Ba,BareSeq:Gc,Norm:zm,ComparatorChain:Hc,DoubleInequality:hb,Sum:jm,Product:Zm,Integral:Lm,AssignmentExpression:tp,ListComprehension:tc,FunctionCall:xr,RecursiveFunctionBaseCase:is,SeededFunctionCall:Lb,FunctionExponent:Uc,FunctionFactorial:zc,Prime:ip,Piecewise:us,Restriction:Xm,Derivative:rp,UpdateRule:Qm,Substitution:Mu,Histogram:Am,DotPlot:Nm,BoxPlot:Cm,TTest:Jm,IndependentTTest:wm,Stats:Wm,Assignment:Mm,AssignmentImport:gm,FunctionDefinition:Tr,CallAssignment:$c,Equation:Fc,Regression:Em,Image:xb,Ticker:Bb,Slider:Fb,RegressionParameter:bm,Table:Ku,TableColumn:ji,SolvedEquation:Vb,OptimizedRegression:hm,Seed:up,ExtendSeed:sp,IRExpression:Dn,Add:Sm,Subtract:Hs,Multiply:qm,DotMultiply:qc,CrossMultiply:vm,Divide:Dm,Exponent:Om,Negative:Um,Or:km,PercentOf:$m,\"Comparator['<']\":Wf,\"Comparator['>']\":Jf,\"Comparator['<=']\":jf,\"Comparator['>=']\":Qf,\"Comparator['=']\":Oa},A=Ok;var qD={};Ka(qD,{parse:()=>Uo,parseIdentifier:()=>dT,setInput:()=>wV});var nc;function uA(e){nc=e}function cA(){nc&&(nc.cacheHits+=1)}function lA(){nc&&(nc.cacheMisses+=1)}function pA(){nc&&(nc.cacheWrites+=1)}function mA(){nc&&(nc.cacheReads+=1)}var Fr={xmin:-5,xmax:5,ymin:-5,ymax:5,zmin:-5,zmax:5};function _M(e,t){let n=Math.round(1e6*e)/1e6;return Math.abs(n-e)<t?n:e}function ate(e){let t=!0,n=!0,r=!0;return e.hardMin!==void 0&&e.target<e.hardMin&&(t=!1),e.hardMax!==void 0&&e.target>e.hardMax&&(n=!1),e.step&&Gb({target:e.target,step:e.step,hardMin:t?e.hardMin:void 0,hardMax:n?e.hardMax:void 0})!==e.target&&(r=!1),{min:t,max:n,step:r}}function Gb(e){let{target:t,hardMin:n,hardMax:r,step:s}=e,o=1e-10;if(n!==void 0&&r!==void 0&&(o=Math.min(o,Math.abs(r-n)/1e3)),s&&(o=Math.min(o,s/10)),n!==void 0&&(n=_M(n,o)),r!==void 0&&(r=_M(r,o)),e.forceSliderToMax&&r!==void 0&&(t=r),n>r||t<=n)return n;if(t>=r)return r;if(s){let a=n!==void 0?n:0,u=Math.round((t-a)/s);t=s*u+a}let i=_M(t,o);return(s||n===i||r===i)&&(t=i),t<=n?n:t>=r?r:t}function dA(e){let{storedMax:t,sliderValue:n,hardMin:r,step:s}=e,o=e.is3d?Fr.xmax:10;if(t>o&&(o=t),n>o&&(o=n),r>o&&(o=r),s){let i=Gb({target:o,hardMin:r,hardMax:void 0,step:s});i>=o?o=i:o=i+s}return o}var _k=hc;function wM(e){let t=[];for(let n=0;n<e.length;n++)t.push(oe(e[n].valueType));return t}var Ji=!0;function fA(e,t,n){let r=t.length,s=t[0];if(r<n)throw hu(e._symbol,{blockExport:Ji});if(!_k(s.valueType,[Y,Ae]))throw hu(e._symbol,{blockExport:Ji});if(r>n)throw e.type===\"BoxPlot\"?hu(e._symbol,{blockExport:Ji}):Kg(e._symbol,2)}function Hb(e,t){var n,r,s;switch(e.type){case\"Histogram\":case\"DotPlot\":return fA(e,t,2);case\"BoxPlot\":return fA(e,t,1);case\"TTest\":{let o=e._symbol;if(t.length===0)throw hu(o,{blockExport:Ji});if(t[0].valueType===Ae)throw jp(o);if(t[0].valueType!==Y)throw hu(o,{blockExport:Ji});if(t.length>2)throw Kg(o,2);if(!(\"length\"in t[0])||((n=t[0].length)!=null?n:0)<2)throw jp(o);if(t[1]&&t[1].valueType!==b)throw Fs(o,wM(t),{blockExport:Ji});break}case\"IndependentTTest\":{let o=e._symbol;if(t.length!==2)throw yf(o);if(!$(t[0].valueType)||!$(t[1].valueType))throw If(o,{blockExport:Ji});if(t[0].valueType===Ae||t[1].valueType===Ae)throw jp(\"ittest\");if(t[0].valueType!==Y||t[1].valueType!==Y)throw Fs(o,wM(t),{blockExport:Ji});if(!(\"length\"in t[0])||!(\"length\"in t[1])||((r=t[0].length)!=null?r:0)<2||((s=t[1].length)!=null?s:0)<2)throw jp(\"ittest\");break}case\"Stats\":{let o=t.length,i=t[0];if(o===0)throw hu(e._symbol,{blockExport:Ji});if(i.valueType===Ae)throw Fs(e._symbol,wM(t),{blockExport:Ji});if(i.valueType!==Y)throw hu(e._symbol,{blockExport:Ji});if(o>1)throw hu(e._symbol,{blockExport:Ji});break}}}var rc={coerceToNumber:\"all\"};function de(e,t,n,r={}){if(e.type===\"IRExpression\"||e.type===\"Error\")return e;try{return Yc(e,t,n,r)}catch(s){return s instanceof A.Error?s:V(s)}}function Yc(e,t,n,r={}){let s=Ga(e,t,n,{coerceToNumber:r.coerceToNumber});if(s.isError)throw s;return s}function FM(e,t,n){var a;let r=Yc(new A.Piecewise([e._indicator,new A.FunctionCall(\"coerceToReal\",[e._expressions[0]]),new Xn(NaN)]),t,n),s=Yc(new A.Piecewise([e._indicator,new A.FunctionCall(\"coerceToReal\",[e._expressions[1]]),new Xn(NaN)]),t,n),o=new Rm([r,e._operators[0],new hn(e._symbol),e._operators[1],s]),i=(a=r.warning)!=null?a:s.warning;return i&&(o.warning=i),o}function iy(e,t){return e.type===\"Error\"?e:t.indexOf(e.valueType)===-1?af():e}function VM(e,t,n){let r=de(e.center,t,n),s=de(e.radianAngle,t,n,rc),o=de(e.width,t,n,rc),i=de(e.height,t,n,rc),a=de(e.opacity,t,n,rc),u=[N,Gt,Ae],c=[b,Y,Ae];return r=iy(r,u),s=iy(s,c),o=iy(o,c),i=iy(i,c),a=iy(a,c),new _m({center:r,radianAngle:s,width:o,height:i,opacity:a})}function BM(e,t,n){let r=de(e.handler,t,n);!r.isError&&r.valueType!==it&&(r=pf(oe(r.valueType)));let s=r.getDependencies().filter(o=>!(t.graphingEnabled()&&t.validActionVariable(o)));return s.length&&(r=mn(t.sliderVariables(s)).setDependencies(s)),new A.Ticker({handler:r,minStep:de(e.minStep,t,n,rc)})}function LM(e,t,n){if(!t){n.valids[e]=!0;return}let r=t.getDependencies();if(t.type===\"Error\")n.errors[e]=!0;else if(r.length>0){n.errors[e]=!0;for(let s=0;s<r.length;s++)r[s]===n.exportedSymbol?n.errors.cycle=!0:n.missingVars.push(r[s])}else n.values[e]=+t.asValue();n.valids[e]=n.values[e]!==void 0&&isFinite(n.values[e]),n.valids[e]||(n.values[e]=void 0)}function qb(e){return e&&e.valueType===Y&&e.type===\"List\"&&e.length===1&&\"args\"in e&&e.args?e.args[0]:e}function cp(e,t,n){let r=Yc(e._expression,t,n),s=qb(e.sliderMin&&de(e.sliderMin,t,n,rc)),o=qb(e.sliderMax&&de(e.sliderMax,t,n,rc)),i=qb(e.sliderStep&&de(e.sliderStep,t,n,rc)),a={exportedSymbol:e._symbol,errors:{},values:{},valids:{},missingVars:[],errMsg:void 0};if(LM(\"min\",s,a),LM(\"max\",o,a),LM(\"step\",i,a),i&&a.valids.step&&(a.values.step===0?delete a.values.step:a.values.step=Math.abs(a.values.step)),a.errors.cycle?r=BE(a.exportedSymbol):(a.errors.min||!a.valids.min?a.errMsg=GE():a.errors.max||!a.valids.max?a.errMsg=HE():(a.errors.step||!a.valids.step)&&(a.errMsg=UE()),a.values.min>a.values.max&&(a.valids.min=!1,a.valids.max=!1,a.errMsg||(a.errMsg=qE()))),r.type===\"IRExpression\"&&r.isConstant){let c=n.initialEvaluation&&n.initialEvaluation.asValue()&&e.sliderIsPlayingOnce,p=a.values.max,l=+r.asValue(),m=a.values.min,d=a.values.step;if(c&&!isFinite(p)){let h=qb(e.sliderSoftMax&&de(e.sliderSoftMax,t,n,rc));h&&(p=dA({storedMax:+h.asValue(),sliderValue:l,step:d,hardMin:m,is3d:t.is3dProduct()}))}let y=Gb({target:l,hardMin:m,hardMax:p,step:d,forceSliderToMax:!!c}),g=kl(y.toString()),f=isFinite(w(g))?g:y;r=Yc(new Xn(f),t,n)}return r.sliderInfo=a,r}function GM(e,t,n){if(!n[e._symbol])throw Na(e._symbol,t);let r=e.args.map(s=>de(s,t,n));if(r.length>0){if(r.length===1&&r.push(de(new A.Constant(1),t,n)),r[1].getDependencies().length)throw Ef(e._symbol).setDependencies(r[1].getDependencies());if(r[1].valueType!==b)throw Ef(e._symbol);let s=r[1].asValue();if(!isFinite(s)||s<=0)throw Ef(e._symbol)}return Hb(e,r),new e.constructor(r)}function HM(e,t,n){if(!n[e._symbol])throw Na(e._symbol,t);let r=e.args.map(s=>Yc(s,t,n));if(Hb(e,r),r.length===1&&(r[0].valueType===Y||r[0].valueType===Ae))return new A.BoxPlot(r);throw V(\"Failed to compile BoxPlot\")}function go(e,t,n,r){try{return e(t,n,r)}catch(s){return s instanceof C?s:V(s)}}function Ub(e,t,n){if(!e._symbol||!n[e._symbol])throw Na(e._symbol,t);let r=e.args.map(s=>Yc(s,t,n));return Hb(e,r),e.copyWithArgs(r)}function qM(e,t,n){var i;let r=[];for(let a of e.columns){let u=Bc(a)&&Aa(a.header)?n[a.header._symbol]:void 0;u&&Eu(u)?r.push(u):r.push(go(zb,a,t,n))}let s=1;for(let a of r)Im(a)&&a.isList&&(s=Math.max((i=a.length)!=null?i:0,s));let o=[];for(let a of r)o.push(wk(a,s));return new db(o,e.calcColumns,e.regression,e.tableFrameID)}function wk(e,t){if(as(e))return e;if(Eu(e))return e;if(Im(e)&&e.isList)return new A.TableColumnValue(e.mapElements(n=>n),void 0);if(e.isTypedConstant){let n=[];for(let r=0;r<t;r++)n.push(e);return new vu(n,void 0)}else return V(`Invalid column: expected an error, constant, or list but got:\n ${e.repr(\"\",1)}`)}function zb(e,t,n){var s,o,i,a;let r=e.header.tableError();if(r)throw lS(r);if(e.header instanceof Ve){let u=n[e.header._symbol];if(u&&n.hasOwnProperty(e.header._symbol)&&as(u))throw u}if(e.isFreeVariable(n)){if(e.columnIndex===0){let c=e.header._symbol;if(!t.validFirstColumnVariable(c))throw pS()}let u=[];for(let c=0;c<e.values.length;c++){let p=(o=(s=e.values[c]).tableError)==null?void 0:o.call(s);if(p){u.push(Tf(p));continue}let l=de(e.values[c],t,n),m=(i=l.tableError)==null?void 0:i.call(l);l.isError?u.push(l):m?u.push(Tf(m)):l.valueType===b||l.valueType===O?u.push(l):u.push(NP([oe(l.valueType)]))}for(let c=0;c<u.length;c++){if(u[c].isError)continue;let p=e.values[c]&&e.values[c].tableError();if(p){u[c]=Tf(p);continue}let l=u[c].getDependencies();l.length&&(u[c]=mn(l).setDependencies(l))}return new vu(u,e.header._symbol)}else{let u=de(e.header,t,n,{coerceToNumber:\"all-except-complex\"});if(!u.isError&&u.valueType!==b&&u.valueType!==Y&&u.valueType!==O&&u.valueType!==He&&u.valueType!==Ae)throw DP([oe((a=u.valueType)!=null?a:Pn)]);if(u.getDependencies().length>0)throw mn(u.getDependencies()).setDependencies(u.getDependencies());if(u.isError)throw u;return u}}function Zc(e,t,n,r={}){try{return Lk(e,t,n,r)}catch(s){return s instanceof C?s:V(s)}}function Lk(e,t,n,r={}){switch(e.type){case\"IRExpression\":return e;case\"DoubleInequality\":return FM(e,t,n);case\"Error\":return e;case\"Image\":return VM(e,t,n);case\"Ticker\":return BM(e,t,n);case\"Slider\":return cp(e,t,n);case\"Table\":return qM(e,t,n);case\"TableColumn\":return zb(e,t,n);case\"Histogram\":case\"DotPlot\":return GM(e,t,n);case\"BoxPlot\":return HM(e,t,n);case\"TTest\":case\"IndependentTTest\":case\"Stats\":return Ub(e,t,n);case\"Regression\":case\"Placeholder\":throw new Error(\"Unexpected placeholder or regression\")}return Yc(e,t,n,r)}var yA={segment:!0,ray:!0,vector:!0,line:!0,circle:!0,arc:!0,polygon:!0,glider:!0,midpoint:!0,intersection:!0,strictintersection:!0,perpendicular:!0,parallel:!0,translate:!0,rotate:!0,dilate:!0,reflect:!0,apply:!0,segments:!0,vertices:!0,angle:!0,angles:!0,directedangle:!0,directedangles:!0,clockwise:!0,counterclockwise:!0,reflex:!0,start:!0,end:!0,anglebisector:!0};function Ha(e){switch(e.type){case\"simple\":return;case\"list-access\":return e.listIndex;case\"polygon-edge\":return Ha(e.polygon);case\"arbitrary-expression\":return;default:throw new Error(`Unexpected parent type: ${e.type}`)}}function Du(e){switch(e.type){case\"simple\":case\"list-access\":return e.identifier;case\"polygon-edge\":return Du(e.polygon);default:throw new Error(`Unexpected parent type: ${e.type}`)}}var Km={simple:e=>({type:\"simple\",identifier:e}),listAccess:(e,t)=>({type:\"list-access\",identifier:e,listIndex:t}),polygonEdge:(e,t)=>({type:\"polygon-edge\",polygon:{type:\"simple\",identifier:e},edgeIndex:t}),polygonListItemEdge:(e,t)=>({type:\"polygon-edge\",polygon:{type:\"list-access\",identifier:e,listIndex:t.listIndex},edgeIndex:t.edgeIndex}),arbitraryExpression:e=>({type:\"arbitrary-expression\",latex:e.getInputString()})};function Fk(e){return e!==void 0&&e in yA}function ay(e){return Fk(e)?e===\"rotate\"||e===\"dilate\"||e===\"translate\"||e===\"reflect\"?!0:!1:!1}function kb(e){if(e instanceof La&&e.list instanceof Ve&&e.index instanceof _n)return Km.listAccess(e.list._symbol,e.index.asValue());if(e instanceof La&&e.list instanceof qs&&e.index instanceof _n){let t=e.list.args[0],n=e.list.args[1];if(t instanceof Ve&&n instanceof Ve&&n._symbol===\"segments\")return Km.polygonEdge(t._symbol,e.index.asValue());if(t instanceof La&&t.list instanceof Ve&&t.index instanceof _n)return Km.polygonListItemEdge(t.list._symbol,{listIndex:t.index.asValue(),edgeIndex:e.index.asValue()})}return e.type===\"Identifier\"?Km.simple(e._symbol):Km.arbitraryExpression(e)}function $b(e){let t={},n=e;if((n instanceof Rn||n instanceof Tr)&&(t.identifier=n._symbol,n=n._expression),n instanceof La&&n.index instanceof _n&&(t.listAccess=n.index.asValue(),n=n.list),n instanceof En){let r=n._symbol,s=n.args[0]instanceof Ve?n.args[0]._symbol:void 0;if(ay(r)&&e instanceof Tr&&s&&e._argSymbols.some(o=>o===s))t.tree={symbol:r,parents:n.args.slice(1).map(kb)};else if(yA[r])t.tree={symbol:r,parents:n.args.map(kb)};else{let o=Km.simple(n._symbol);t.tree={symbol:\"apply\",parents:[o,...n.args.map(kb)]}}}else if(n instanceof qs){let r=n.args.map(kb);r.length===2&&r[1]&&r[1].type===\"simple\"&&r[1].identifier===\"segments\"?t.tree={symbol:\"segments\",parents:[r[0]]}:r.length===2&&r[1]&&r[1].type===\"simple\"&&r[1].identifier===\"start\"?t.tree={symbol:\"start\",parents:[r[0]]}:r.length===2&&r[1]&&r[1].type===\"simple\"&&r[1].identifier===\"end\"&&(t.tree={symbol:\"end\",parents:[r[0]]})}return t}function bA(e,t,n,r,s){let o=se(n,pe)||se(n,ae),i=se(s,pe)||se(s,ae);if(!o&&!i)return;let a=hA(e,t,n),u=hA(e,r,s),c=a.filter(p=>{let l=Du(p);return l?u.some(m=>_s(p,m))&&!!e.lookup(l):!1});for(let p of a)gA(e,p,r)&&c.every(l=>!_s(p,l))&&c.push(p);for(let p of u)gA(e,p,t)&&c.every(l=>!_s(p,l))&&c.push(p);if(c.length===1)return c[0]}function gA(e,t,n){let r=Du(t),s=r!==void 0?e.lookup(r):void 0,o=s&&e.getGeometryTree(s);return((o==null?void 0:o.symbol)===\"glider\"||(o==null?void 0:o.symbol)===\"intersection\"||(o==null?void 0:o.symbol)===\"strictintersection\"||(o==null?void 0:o.symbol)===\"midpoint\")&&(o==null?void 0:o.parents.some(i=>{if(i.type===\"arbitrary-expression\")return!1;let a=Du(i);return a&&e.resolvesTo(a,n)&&(Ha(t)===void 0||Ha(i)===void 0||Ha(i)===Ha(t))}))}function hA(e,t,n){var o;let r=[],s=((o=e.getGeometryTree(t))==null?void 0:o.parents)||[];for(let i=0;i<s.length;i++){let a=s[i];if(se(n,pe)&&i===0||a.type===\"arbitrary-expression\"||a.type===\"polygon-edge\")continue;let u=Du(a);if(!u)continue;let c=e.lookup(u);c&&e.isPointOrListOfPoints(c)&&r.push(a)}return r}function ed(e){if(e.length===0)return Ae;if(e.includes(O))return He;let t=e[0];if(t!==b&&Jn(t,b))for(let n of e){let r=gc(t,n);r!==void 0&&(t=r)}return Hn(t)?Ln(t):Yn}function xA(e){let t=[];for(let n of e)n!==Ae&&t.push(Zn(n));return ed(t)}var Yb=class e{constructor(t,n,r){this.startIP=t;this.endIP=n;this.arr=r}static newFromRange(t,n){return new e(t,n,new Uint16Array(n-t+1))}clone(){return new e(this.startIP,this.endIP,this.arr.slice())}translateAddr(t){if(t<this.startIP||t>this.endIP)throw new Error(`get(${t}) out of range for IPMapArray(${this.startIP}, ${this.endIP}).`);return t-this.startIP}get(t){return this.arr[this.translateAddr(t)]}set(t,n){this.arr[this.translateAddr(t)]=n}};var vs=class e{constructor(t,n,r,s=t,o){this.oldChunk=t;this.oldStart=n;this.oldEnd=r;this.newChunk=s;if(r<n)throw new Error(\"End before start in ChunkCopyContext.\");this.oldIPtoNewIP=o!=null?o:Yb.newFromRange(n,r)}clone(){return new e(this.oldChunk,this.oldStart,this.oldEnd,this.newChunk,this.oldIPtoNewIP.clone())}copyUntilEnd(t){for(let n=this.oldStart;n<=this.oldEnd;n++){let r=this.oldChunk.getInstruction(n),s=t(this.newChunk,r,n,this.oldChunk);this.markMappedIndex(n,s)}}markMappedIndex(t,n){this.oldIPtoNewIP.set(t,n)}mapIndex(t){return t<this.oldStart?t:this.oldIPtoNewIP.get(t)}mapArgs(t){let n=[];for(let r of t)n.push(this.mapIndex(r));return n}copyLeafOrFunctionHeader(t){if(RO(t)){let n=this.newChunk.FunctionHeader(t.symbol,t.valueType,t.signature,t.parameterSymbols);return this.functionHeaderCopied(t,n),n}else return this.newChunk.copyLeafInstruction(t)}functionHeaderCopied(t,n){var o;(o=this.unpatchedHeaderMap)!=null||(this.unpatchedHeaderMap=new Map);let r=t.recursionGroup[0],s=this.unpatchedHeaderMap.get(r);if(s===void 0&&(s=[],this.unpatchedHeaderMap.set(r,s)),s.push(n),s.length===t.recursionGroup.length){this.unpatchedHeaderMap.delete(r);for(let i of s)this.newChunk.getInstruction(i).recursionGroup=s}}};function Vr(e,t){let n=e.getInstruction(t);if(n.type!==48)return t;let r=n.args[0],s=e.getInstruction(r),o=s.args[0],i=!1;for(let c=o+1;c<r;c++){let p=e.getInstruction(c);if(p.type===40&&p.args[1]===o){i=!0;break}}if(!i)return t;let a=r+s.args.length-1,u=new vs(e,o,a);return u.copyUntilEnd((c,p)=>{if(ce(p)){let l=u.mapArgs(p.args);return p.type===40?c.InboundsListAccess(l):c.copyInstructionWithArgs(p,l)}else return u.copyLeafOrFunctionHeader(p)}),e.getReturnIndex()}function qa(e,t,n){let r=or(e,t);if(r===void 0)throw new Error(`${n}\nNon-constant instruction: \"${op(e,dr(e,t))}\"`);return r}function or(e,t){let n=lp(e,t,void 0,void 0);if(!(n<0))return n}function lp(e,t,n,r){var a;let s=n&&n[t];if(s)return s;let o=e.getInstruction(t),i;switch(o.type){case 38:i=o.args.length;break;case 1:i=o.value.length;break;case 48:{i=(a=o.constantLength)!=null?a:-1;break}}return i===void 0&&(n=n||{},i=Vk(e,o,n,r||new Set)),n&&(n[t]=i),i}function Vk(e,t,n,r){switch(t.type){case 33:{let s=lp(e,t.args[1],n,r),o=lp(e,t.args[2],n,r);return s===o?s:-1}case 37:switch(t.symbol){case\"elementsAt\":return lp(e,t.args[1],n,r);case\"sortPerm\":case\"complexSortPerm\":return lp(e,t.args[0],n,r);case\"shuffle\":return lp(e,t.args[1],n,r);default:return-1}case 55:{if(r&&r.has(t.args[0]))return-1;r.add(t.args[0]);let s=e.dereferenceFunctionHeader(t.args[0]);if(s!==void 0){let o=e.getInstruction(s);return lp(e,o.args[1],n,r)}return-1}default:{if($(t.valueType))return-1;throw new Error(`Programming Error: cannot find the list length of ${ls(t.type)} ${oe(t.valueType)}.`)}}}function dr(e,t){let n=e.getInstruction(t);if(!$(n.valueType))throw new Error(`Programming Error: cannot find the list length of ${e.printInstruction(t)}`);switch(n.type){case 38:return e.Constant(n.args.length);case 1:return e.Constant(n.value.length);case 48:{let r=e.getInstruction(n.args[0]);return e.getInstruction(r.args[0]).args[0]}case 37:switch(n.symbol){case\"elementsAt\":return dr(e,n.args[1]);case\"sortPerm\":case\"complexSortPerm\":return dr(e,n.args[0]);case\"shuffle\":return dr(e,n.args[1])}}return e.NativeFunction(\"count\",[t])}function td(e,t){let n=[];for(let i of t)$(e.getInstruction(i).valueType)&&n.push(i);if(n.length===0)return;if(n.length===1)return dr(e,n[0]);let r=[];for(let i of n)r.push(or(e,i));let s,o=1/0;for(let i=0;i<r.length;i++){let a=n[i],u=r[i];if(u===void 0)return e.NativeFunction(\"listMin\",[e.List(n.map(c=>dr(e,c)))]);u<o&&(s=a,o=u)}return s!==void 0?dr(e,s):e.Constant(o)}var uy=[Cr(b),Cr(b)],UM=[...Lo([[ge,ge],[O,O],[N,b],[b,N],[b,ye],[b,Fe],[ye,b],[Fe,b],[F,b],[b,F],[nn,_f],[_f,nn]]),gt([nn,wf]),gt([wf,nn])],zM={Negative:Lo([[ge],[O],[N],[ye],[Fe],[F]]),Add:Lo([[ge,ge],[O,O],[N,N],[ye,ye],[Fe,Fe],[F,F]]),Subtract:Lo([[ge,ge],[O,O],[N,N],[ye,ye],[Fe,Fe],[F,F]]),Multiply:UM,DotMultiply:[...Lo([[ye,ye],[Fe,Fe],[F,F]]),...UM],CrossMultiply:[...Lo([[Fe,Fe],[F,F]]),...Lo([[ge,ge],[O,O],[N,b],[b,N],[ye,b],[b,ye],[Fe,b],[b,Fe],[nn,_f],[_f,nn]]),gt([nn,wf]),gt([wf,nn])],Divide:Lo([[ge,ge],[O,O],[N,b],[ye,b],[Fe,b],[F,b]]),Exponent:Lo([[ge,ge],[O,O]]),\"Comparator['=']\":[gt(uy)],\"Comparator['>']\":[gt(uy)],\"Comparator['<']\":[gt(uy)],\"Comparator['>=']\":[gt(uy)],\"Comparator['<=']\":[gt(uy)],ComparatorChain:Lo([{type:\"variadic\",initial:[b,b],rest:b}]),PercentOf:UM,Norm:Lo([[b],[N],[F],[ye],[Fe]]),ListAccess:[gt([Oo,Cr(cr.of([Re,b]))])],Integral:Lo([[b,b,cr.of(Rp,{coerceComplexToReal:!1})]])};function Lo(e){return e.map(t=>q(t))}function Zb(e,t,n){if(t instanceof wo){let r=n.filter(o=>o!==void 0);if(r.length===0)return;let s=ed(r);return $(s)&&s!==Yn?Xc([gt({type:\"variadic\",initial:[],rest:Xe(s)})],n):[]}else if(t instanceof En||t instanceof qs){let r=t instanceof qs?t.args[1]._symbol:t._symbol;if(!r)return;let s=Zf(e,r);return s?Xc(s,n):void 0}else if(t instanceof us){let[r,s,o]=n,i=s!==void 0&&o!==void 0?Yu(s,o):void 0;!i&&o===b&&t.args[2]instanceof _n&&t.args[2].isNaN()&&(o=void 0);let a;if(i!==void 0)a=i;else if(s!==void 0)a=s;else if(o!==void 0)a=o;else return;a=Zn(a);let u=Hn(a)?Cr(a):a;return Xc([gt([Cr(Re),u,u])],[n[0],s,o])}else if(t instanceof qc){let r=[...zM.DotMultiply,q([N,N])];return Xc(r,n)}else if(t instanceof Di){let r=[gt({type:\"variadic\",initial:[it],rest:it}),q([b,b]),q([b,b,b])];return Xc(r,n)}else if(t instanceof Gc){let r=[gt({type:\"variadic\",initial:[it],rest:it})],s=n.filter(o=>o!==void 0&&o!==b);if(s.length>0){let o=ed(s);$(o)&&o!==Yn&&r.push(gt({type:\"variadic\",initial:[],rest:Xe(o)}))}return Xc(r,n)}else if(t instanceof Ba){let r=t.symbol,s;switch(r){case\"x\":case\"y\":s=Lo([[N],[F]]);break;case\"z\":s=Lo([[F]]);break;case\"p\":s=Lo([[Ot],...fg.map(o=>[o])]);break;default:{let o=r;throw new Error(`Programming Error: unexpected named coordinate: '${o}'.`)}}return Xc(s,n)}else if(t.type in zM&&n.some(r=>r!==void 0)){let r=zM[t.type];return r?Xc(r,n):void 0}}function Xc(e,t){return e.filter(n=>n.matches(t))}function IA(e,t,n,r){if(!EA(e,n,r))return;let s=t.type;switch(s){case\"Comparator['>']\":case\"Comparator['<']\":case\"Comparator['>=']\":case\"Comparator['<=']\":{e.setWarning(I(\"shared-calculator-error-complex-operation-undefined\",{symbol:z(t.operator)}));break}case\"ComparatorChain\":{let[o]=t.symbols;if(o===void 0||o===\"=\")break;e.setWarning(I(\"shared-calculator-error-complex-operation-undefined\",{symbol:z(o)}));break}case\"ParenSeq\":e.setWarning(I(\"shared-calculator-error-complex-point-coordinate\"));break;case\"Integral\":switch(SA(e,n,r)){case 0:e.setWarning(I(\"shared-calculator-error-integral-lower-bound-type-error\",{symbol:oe(e.getInstruction(n[0]).valueType)}));break;case 1:e.setWarning(I(\"shared-calculator-error-integral-upper-bound-type-error\",{symbol:oe(e.getInstruction(n[1]).valueType)}));break;default:break}break;case\"ListAccess\":e.setWarning(I(\"shared-calculator-error-complex-list-access\"));break;case\"CrossMultiply\":case\"DotMultiply\":case\"Multiply\":case\"PercentOf\":if(n.length!==2)break;e.setWarning(I(\"shared-calculator-error-multiply-type-error\",TA(e,n)));break;case\"Divide\":if(n.length!==2)break;e.setWarning(I(\"shared-calculator-error-divide-type-error\",TA(e,n)));break;case\"Sum\":case\"Product\":case\"Range\":break;case\"DotAccess\":case\"FunctionCall\":case\"SeededFunctionCall\":break;case\"Comparator['=']\":case\"Add\":case\"Subtract\":case\"Exponent\":case\"Negative\":case\"Or\":case\"Piecewise\":case\"Restriction\":case\"List\":case\"TableColumnValue\":case\"Norm\":case\"BareSeq\":case\"NamedCoordinateAccess\":case\"Ans\":case\"Constant\":case\"ImaginaryUnit\":case\"Assignment\":case\"RecursiveFunctionBaseCase\":case\"MixedNumber\":case\"Identifier\":case\"AssignmentImport\":case\"Construction\":case\"ListComprehension\":case\"FunctionExponent\":case\"FunctionFactorial\":case\"Prime\":case\"Derivative\":case\"UpdateRule\":case\"Substitution\":case\"FunctionDefinition\":case\"Slider\":case\"RegressionParameter\":case\"Seed\":case\"ExtendSeed\":case\"Placeholder\":break;default:}}function PA(e,t,n,r,s){if(t===\"sort\"){let o;if(r.length===1)o=r[0];else if(r.length===2)o=r[1];else return;MA(e.getInstruction(o))&&e.setWarning(I(\"shared-calculator-error-complex-sort\",{symbol:z(n)}));return}if(EA(e,r,s))switch(t){case\"factorial\":case\"erf\":case\"nCr\":case\"nPr\":e.setWarning(I(\"shared-calculator-error-complex-operation-unimplemented\",{symbol:z(n)}));break;case\"round\":e.setWarning(I(\"shared-calculator-error-complex-round\",{symbol:z(n)}));break;default:e.setWarning(I(\"shared-calculator-error-complex-operation-undefined\",{symbol:z(n)}));break}}function EA(e,t,n){return SA(e,t,n)!==-1}function SA(e,t,n){if(n.length===0)return-1;let r=n[0];for(let s=0;s<t.length;s++){let o=t[s],i=r.argTypeAtIndex(s);if(!(i===b||i===Y||typeof i==\"object\"&&i.coerceComplexToReal))continue;let u=e.getInstruction(o);if(MA(u))return s}return-1}function MA(e){if(e.type!==1)return!1;switch(e.valueType){case O:return w(e.value[1])!==0;case He:return e.value.some(t=>w(t[1])!==0);default:return!1}}function TA(e,t){let n=e.getInstruction(t[0]),r=e.getInstruction(t[1]);return{symbol1:oe(n.valueType),symbol2:oe(r.valueType)}}function vA(e,t,n,r,s,o){var x,T,P,M;if(n=ab(t,n),!Ql(n)&&!fm(n)||ay(n))return;let i,a=!1,u=!1,c=0,p=[],l=[],m=s.map(S=>e.getInstruction(S).valueType),d=Ql(n)?Ra[n]:void 0;if(d&&(a=d.isSeeded,i=void 0,p.push(...d.getSignatures(t)),c=(T=(x=d.defaultArguments)==null?void 0:x.length)!=null?T:0,l=Xb(p,m,c),u=d.allowDotCall),l.length===0&&(d!=null&&d.fallthroughUnlessDistribution)&&m.length>0&&se(m[0],Sn))p=p.filter(S=>{let E=S.argTypeAtIndex(0);return E===void 0?!1:Cl(Sn,E)}),l=[];else if(fm(n)&&l.length===0){let S=Wn[n];i=S.tag,p.push(...yM(n)),c=(M=(P=S.defaultArguments)==null?void 0:P.length)!=null?M:0,l=Xb(p,m,c),u=u||S.allowDotCall}let y=Math.min(...p.map(S=>S.minArity)),g=Math.max(...p.map(S=>{var E;return(E=S.maxArity)!=null?E:1/0})),f=s,h=s;if(a&&(h=f=s.slice(1),y-=1,g-=1),o){if(!u)throw lf(r);let S=e.getInstruction(f[0]).valueType;if(!$(S)&&S!==Jt&&S!==Fe&&S!==Sn&&S!==Qn&&S!==Ot&&S!==Et&&!pu(S)&&(S===N||!Gd(S))&&n!==\"real\"&&n!==\"imag\")throw pP(r,oe(S),{blockExport:e.areAllArgsConstant([f[0]])});r=\".\"+r,h=f.slice(1),y-=1,g-=1}if((t.isGeometryEnabled()||t.is3dPolicy())&&n===\"length\"&&h.length===1&&$(e.getInstruction(h[0]).valueType)){let S=t.is3dPolicy()?lP:cP;if(l.length===0)throw S(r,Ua(e,h)[0],{blockExport:e.areAllArgsConstant(h)});if(h.length===1&&e.getInstruction(h[0]).valueType===Ae)throw S(r,Ua(e,h)[0],{blockExport:e.areAllArgsConstant(h)})}if(l.length>0){PA(e,n,r,s,l);return}throw kM(e,{symbol:n,errorSymbol:r,providedArgs:h,argsWithoutSeed:f,isDotCall:o,minArity:y,maxArity:g,defaultArgumentCount:c,builtInTag:i,signatures:p})}function kM(e,{symbol:t,errorSymbol:n,providedArgs:r,argsWithoutSeed:s,isDotCall:o,minArity:i,maxArity:a,defaultArgumentCount:u,builtInTag:c,signatures:p}){if(c===\"doubleReducer\"&&r.length===2){if(!$(e.getInstruction(r[0]).valueType)||!$(e.getInstruction(r[1]).valueType))throw If(t,{blockExport:e.areAllArgsConstant(r)})}else if(c===\"parameterizedReducer\"&&!o&&r.length===2&&!$(e.getInstruction(r[0]).valueType))throw fS(t,{blockExport:e.areAllArgsConstant([r[0]])});if(t===\"logbase\"&&r.length!==2)return Da(\"log\",1,r.length-1,{includeUsageExample:!0});if(t===\"random\")return nE();if(r.length<i||r.length>a){let{dotMinArityExampleArgs:g,dotMaxArityExampleArgs:f,minArityExampleArgs:h,maxArityExampleArgs:x}=Bk(t),T,P;if(r.length<i?(P=i-u,o&&g?T=n+g:h&&(T=n+h)):(P=a,o&&f?T=n+f:x&&(T=n+x)),o&&(c===\"parameterizedReducer\"||t===\"pdf\"||t===\"cdf\"))return Da(n,P,r.length,{includeUsageExample:!0,usageExample:T});if(c===\"reducer\"&&r.length===0)return aE(n);if(c===\"doubleReducer\")return yf(n);if(c===\"parameterizedReducer\")return iE(n);if(c===\"color\")return sE(n);if(Ql(t))switch(t){case\"pdf\":return KP();case\"cdf\":return r.length<i?eE():tE();case\"tdist\":case\"length\":case\"round\":case\"floor\":case\"ceil\":case\"abs\":case\"sign\":case\"mod\":case\"gcd\":case\"lcm\":case\"min\":case\"max\":case\"midpoint\":case\"segment\":case\"vector\":case\"sphere\":case\"distance\":case\"circle\":case\"center\":case\"radius\":case\"glider\":case\"intersection\":case\"strictintersection\":case\"parallel\":case\"perpendicular\":case\"anglebisector\":case\"start\":case\"end\":case\"angle\":case\"directedangle\":case\"angles\":case\"directedangles\":case\"apply\":case\"translate\":case\"reflect\":case\"dilate\":case\"rotate\":case\"normaldist\":case\"poissondist\":case\"binomialdist\":case\"uniformdist\":case\"chisqdist\":case\"total\":case\"mean\":case\"median\":case\"stdev\":case\"stdevp\":case\"var\":case\"varp\":case\"covp\":case\"cov\":case\"corr\":case\"mad\":case\"quantile\":case\"sort\":case\"shuffle\":case\"join\":case\"unique\":case\"polygon\":case\"coterminal\":case\"coerceToReal\":case\"real\":case\"imag\":case\"conj\":case\"exp\":case\"sin\":case\"cos\":case\"tan\":case\"sinh\":case\"cosh\":case\"tanh\":case\"sec\":case\"csc\":case\"cot\":case\"sech\":case\"csch\":case\"coth\":case\"arccot\":case\"arcsinh\":case\"arccsch\":case\"arctan\":case\"nthroot\":case\"ztest\":case\"zproptest\":case\"ttest\":case\"null\":case\"chisqtest\":case\"chisqscore\":case\"chisqgof\":case\"chisqgofscore\":case\"score\":case\"conf\":case\"dof\":case\"point\":case\"stderr\":case\"pleft\":case\"pright\":case\"lower\":case\"upper\":case\"complexNthRoot\":return CA(n,P,p,r.map(S=>e.getInstruction(S).valueType),T);case\"points\":case\"lines\":case\"circles\":case\"polygons\":case\"rays\":case\"vectors\":case\"arcs\":throw Ls(n);case\"histogram\":case\"dotplot\":case\"boxplot\":case\"ittest\":case\"stats\":case\"det\":case\"inv\":case\"transpose\":case\"rref\":case\"trace\":throw V(`Unexpected arity error for ${t}`);default:let M=t;throw new Error(`Unexpected compiler function ${M}`)}return CA(n,P,p,r.map(M=>e.getInstruction(M).valueType),T)}if(t===\"polygon\"&&r.length===2&&e.getInstruction(r[0]).valueType===b&&e.getInstruction(r[1]).valueType===b)return ff();let l=[],m=[];for(let g=0;g<s.length;g++){let f=s[g],h=c!==void 0&&c!==\"doubleReducer\"&&c!==\"never-broadcast\"&&!(c===\"parameterizedReducer\"&&g===0)&&t!==\"polygon\",x=e.getInstruction(f).valueType;$(x)&&h&&(x=Xe(x)),l.push(x),m.push(oe(x))}let d=e.areAllArgsConstant(s),y=DA(t);if(y&&!NA(t,p,l)){let g=new C(y);return d?g:g.allowExport()}return Fs(n,m,{blockExport:d})}function CA(e,t,n,r,s){let o=DA(e);return o&&!NA(e,n,r)?new C(o):Da(e,t,r.length,{includeUsageExample:!o,usageExample:s})}function Bk(e){return Ql(e)?Ra[e]:fm(e)?Wn[e]:{}}function Xb(e,t,n){return e.filter(r=>r.matches(t)&&t.length+n>=r.minArity)}function DA(e){switch(e){case\"midpoint\":return I(\"shared-calculator-error-required-arguments-midpoint\");case\"intersection\":return I(\"shared-calculator-error-required-arguments-intersection\");case\"segment\":case\"line\":case\"ray\":case\"distance\":return I(\"shared-calculator-error-required-arguments-points\",{symbol:e,count:2});case\"parallel\":case\"perpendicular\":return I(\"shared-calculator-error-required-arguments-perpendicular\",{symbol:e});case\"circle\":return I(\"shared-calculator-error-required-arguments-circle\");case\"arc\":case\"angle\":case\"directedangle\":return I(\"shared-calculator-error-required-arguments-points\",{symbol:e,count:3});case\"triangle\":return I(\"shared-calculator-error-required-arguments-triangle\");case\"polygon\":return I(\"shared-calculator-error-required-arguments-polygon\");case\"glider\":return I(\"shared-calculator-error-required-arguments-glider\");case\"vector\":return I(\"shared-calculator-error-required-arguments-vector\");case\"length\":return I(\"shared-calculator-error-required-arguments-length\");case\"area\":case\"perimeter\":case\"vertices\":case\"angles\":case\"directedangles\":case\"segments\":return I(\"shared-calculator-error-required-arguments-area\",{symbol:e});case\"radius\":case\"center\":return I(\"shared-calculator-error-required-arguments-radius\",{symbol:e});case\"anglebisector\":case\"coterminal\":return I(\"shared-calculator-error-required-arguments-coterminal\",{symbol:e});case\"supplement\":return I(\"shared-calculator-error-required-arguments-supplement\");case\"start\":case\"end\":return I(\"shared-calculator-error-required-arguments-start\",{symbol:e});case\"dilate\":case\"rotate\":return I(\"shared-calculator-error-required-arguments-dilate\",{symbol:e});case\"reflect\":return I(\"shared-calculator-error-required-arguments-reflect\");case\"translate\":return I(\"shared-calculator-error-required-arguments-translate\");case\"sphere\":return I(\"shared-calculator-error-required-arguments-sphere\")}}function NA(e,t,n){return e===\"polygon\"&&(t=t.filter(s=>s.maxArity!==1)),t.some(s=>s.maxArity===0||n.length<s.minArity?!1:n.every((o,i)=>{let a=s.argTypeAtIndex(i);return a===void 0?!0:bg(o,a)}))}function Ua(e,t){let n=[];for(let r of t)n.push(oe(e.getInstruction(r).valueType));return n}function Wc(e,t){let n=[];for(let r of t){let s=e.getInstruction(r).valueType,o=Zn(s);n.push(oe(o))}return n}function ft(e,t,n){return se(e.getInstruction(t).valueType,n)}function za(e,t,n,r){var p,l;let s=n.type;if(s===\"FunctionCall\"||s===\"SeededFunctionCall\"||s===\"DotAccess\"){let m,d;if(n instanceof qs&&(n.args[1]instanceof Ve||n.args[1]instanceof En))m=n.args[1]._symbol,d=(p=n.args[1]._errorSymbol)!=null?p:m;else if(n instanceof En)m=n._symbol,d=(l=n._errorSymbol)!=null?l:m;else return;if(m===\"polygon\"&&t.polygonUnsupportedPreferTriangle())throw Th();if(m===\"length\"&&!t.isGeometryEnabled()&&!t.is3dPolicy()&&r.length===0)throw oE();vA(e,t,m,d,r,n instanceof qs);return}let o=r.map(m=>e.getInstruction(m).valueType),i=Zb(t,n,o);if(!i)return;let a=Math.min(...i.map(m=>m.minArity));if(i.length>0&&r.length>=a){IA(e,n,r,i);return}let u=Gk(s,o,{specifyPointDimensions:n instanceof Ba&&n.symbol===\"z\"}),c=e.areAllArgsConstant(r);switch(s){case\"Add\":throw YI(u,{blockExport:c});case\"Subtract\":throw ZI(u,{blockExport:c});case\"CrossMultiply\":throw o.length===2&&(se(o[0],N)&&se(o[1],N)||se(o[0],b)&&se(o[1],F)||se(o[0],F)&&se(o[1],b))?XI(u,{blockExport:c}):uf(u,{blockExport:c});case\"DotMultiply\":throw uf(u,{blockExport:c});case\"Multiply\":{if(t.is3dProduct()&&o.length===2){if(se(o[0],F)&&se(o[1],F))throw jI(u,{blockExport:c});if(se(o[0],N)&&se(o[1],N))throw WI(u,{blockExport:c})}throw uf(u,{blockExport:c})}case\"Divide\":throw JI(u,{blockExport:c});case\"Exponent\":throw QI(u,{blockExport:c});case\"Negative\":throw KI(u,{blockExport:c});case\"Comparator['=']\":case\"Comparator['>']\":case\"Comparator['<']\":case\"Comparator['>=']\":case\"Comparator['<=']\":case\"ComparatorChain\":throw nP(u,{blockExport:c});case\"Or\":throw sP(u,{blockExport:c});case\"Piecewise\":throw se(o[0],Re)?vP([oe(e.getInstruction(r[1]).valueType),oe(e.getInstruction(r[2]).valueType)],{blockExport:e.areAllArgsConstant([r[1],r[2]])}):Xg(u,{blockExport:e.areAllArgsConstant([r[0]])});case\"Restriction\":throw Xg(u,{blockExport:c});case\"List\":case\"TableColumnValue\":{RA(e,r);break}case\"ListAccess\":throw cf(u,{blockExport:c});case\"Norm\":throw Fs(\"abs\",u,{blockExport:c});case\"ParenSeq\":{let m=o.indexOf(it)!==-1,d=o.some(g=>g!==it);if(m&&d)throw jg([oe(o[0]),oe(o[1])],{blockExport:c});if(o.length!==2&&o.length!==3){let g=t.is3dPolicy()?3:2;throw lE(g)}let y=o.find(g=>!se(g,b));throw y!==void 0?oP(oe(y),{blockExport:c}):V(\"Unexpected error type checking ParenSeq\")}case\"BareSeq\":{if(o.length===0)throw gf();if(o.length===1)throw V(\"Length-1 BareSeq is impossible\");let m=o[0],d=o.find(y=>y!==m);if(d)throw jg([oe(m),oe(d)],{blockExport:c});if(m===b)throw r.length===2?uE():cE();RA(e,r);break}case\"NamedCoordinateAccess\":throw iP(u,\".\"+n.symbol,{blockExport:c});case\"Integral\":{let[m,d,y]=o,g=Zn(m),f=Zn(d);throw Jn(g,b)?Jn(f,b)?IP([oe(y)],{blockExport:c}):TP([oe(d)],{blockExport:c}):xP([oe(m)],{blockExport:c})}case\"Ans\":case\"Constant\":case\"ImaginaryUnit\":case\"Assignment\":case\"RecursiveFunctionBaseCase\":case\"MixedNumber\":case\"Identifier\":case\"AssignmentImport\":case\"Construction\":case\"Range\":case\"Sum\":case\"Product\":case\"ListComprehension\":case\"FunctionExponent\":case\"FunctionFactorial\":case\"Prime\":case\"Derivative\":case\"UpdateRule\":case\"Substitution\":case\"FunctionDefinition\":case\"Slider\":case\"RegressionParameter\":case\"Seed\":case\"ExtendSeed\":case\"PercentOf\":case\"Placeholder\":return;default:throw new Error(`Unexpected node type: ${s}`)}}function RA(e,t){if(t.length===0)return;let n=e.getInstruction(t[0]).valueType;if(!Hn(n))throw Vl([oe(n)],{blockExport:Ue(e.getInstruction(t[0]))});let r=e.areAllArgsConstant(t);for(let s of t){let o=e.getInstruction(s).valueType;if(!Hn(o))throw Vl([oe(o)],{blockExport:r});if(o!==n)throw mf({blockExport:r})}}function Gk(e,t,n){switch(e){case\"Add\":case\"Subtract\":case\"Multiply\":case\"Divide\":case\"Exponent\":case\"Negative\":case\"Comparator['<']\":case\"Comparator['>']\":case\"Comparator['=']\":case\"Comparator['<=']\":case\"Comparator['>=']\":case\"NamedCoordinateAccess\":return t.map(r=>oe(r,n));case\"ComparatorChain\":{for(let r=0;r<t.length;r++)if(!Jn(t[r],b)&&!Jn(t[r],Y))return r===0?[oe(t[r]),oe(t[r+1])]:[oe(t[r-1]),oe(t[r])];return t.map(r=>oe(r))}case\"ListAccess\":case\"Constant\":case\"ImaginaryUnit\":case\"MixedNumber\":case\"Identifier\":case\"AssignmentImport\":case\"Ans\":case\"List\":case\"TableColumnValue\":case\"Range\":case\"Construction\":case\"ParenSeq\":case\"BareSeq\":case\"Norm\":case\"Sum\":case\"Product\":case\"Integral\":case\"ListComprehension\":case\"FunctionExponent\":case\"FunctionFactorial\":case\"Prime\":case\"Piecewise\":case\"Restriction\":case\"Derivative\":case\"UpdateRule\":case\"Substitution\":case\"Assignment\":case\"RecursiveFunctionBaseCase\":case\"FunctionDefinition\":case\"Slider\":case\"RegressionParameter\":case\"Seed\":case\"ExtendSeed\":case\"DotMultiply\":case\"CrossMultiply\":case\"Or\":case\"PercentOf\":return t.map(r=>oe(r));case\"Placeholder\":throw new Error(\"Unexpected placeholder\");default:throw new Error(`Unexpected node type: ${e}`)}}function OA(e,t){let n=e.getInstruction(t);if(!ce(n))return;let r=gt($M(e,n).expectedTypes);if(n.type===49){for(let u of n.args){let c=e.getInstruction(u).valueType;if(!se(c,b)&&!se(c,O)&&!se(c,N)&&!se(c,F)&&!se(c,pn)&&!se(c,Se)&&!se(c,Ie)&&!se(c,Pe)&&!se(c,De)&&!se(c,ye)&&!se(c,pe)&&!se(c,ae)&&!se(c,ve)&&!se(c,Qn)&&!se(c,Te))throw wP(oe(c))}let a={};for(let u of n.symbols){if(a[u])throw FP(u);a[u]=!0}return}let s=[];for(let a=0;a<n.args.length;a++){let u=e.getInstruction(n.args[a]).valueType,c=r.argTypeAtIndex(a);(c===void 0||!Cl(u,c))&&s.push(n.args[a])}if(s.length===0)return;let o=Ua(e,n.args),i=e.areAllArgsConstant(n.args);switch(n.type){case 32:throw rP(o,{blockExport:i});case 22:case 21:case 44:case 31:case 15:case 16:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 56:case 25:case 26:case 27:case 28:case 29:case 38:case 39:case 40:case 41:case 37:case 42:case 33:case 48:case 47:case 23:case 24:case 19:case 20:case 50:case 51:case 53:case 54:case 55:throw V(`Invalid argument types for opcode ${n.type}`);default:{let a=n;throw new Error(`Unexpected opcode: ${a.type}`)}}}function $M(e,t,n=!1){switch(t.type){case 8:case 9:case 10:case 11:return n&&t.args.length>0&&e.getInstruction(t.args[0]).valueType===N?{expectedTypes:[N,N]}:{expectedTypes:[b,b]};case 12:case 13:case 25:case 26:case 27:case 28:case 29:return{expectedTypes:[b,b]};case 14:case 56:return{expectedTypes:[b]};case 31:return{expectedTypes:[Re,Re]};case 32:return{expectedTypes:[Re,Re]};case 33:return{expectedTypes:[Re,t.valueType,t.valueType]};case 15:return{expectedTypes:Sl[t.valueType]};case 21:return{expectedTypes:[b,b]};case 22:{let r=e.getInstruction(t.args[1]).valueType;return Op(r)?{expectedTypes:[b,r]}:{expectedTypes:[b,b]}}case 38:{let r=t.valueType,s=Xe(r);return{expectedTypes:{type:\"variadic\",initial:[],rest:s}}}case 39:case 40:case 41:return{expectedTypes:[Yn,b]};case 37:{let r=t.symbol,s=Wn[r],o=s.argumentTypes;return s.tag===\"reducer\"&&!Hk(e,t.args)&&Array.isArray(o)&&typeof o[0]==\"number\"&&$(o[0])?{isReducerWithNoListArgs:!0,expectedTypes:{type:\"variadic\",initial:[],rest:Xe(o[0])}}:{expectedTypes:o}}case 44:{let r=e.getInstruction(t.args[1]).valueType;return{expectedTypes:[Pt,r]}}case 47:return{expectedTypes:t.args.map(r=>e.getInstruction(r).valueType)};case 23:return{expectedTypes:[b]};case 19:return{expectedTypes:t.args.map(r=>{let s=e.getInstruction(r).valueType;return s===Re||(t.callData.type===\"sum\"?Op(s):sI(s))?s:b})};case 50:{let r=t.callData.parameterSymbols.length,s=[];for(let o=0;o<r;o++)s.push(b,b);return{expectedTypes:s}}case 24:case 20:case 51:{let r=[b];for(let s=1;s<t.args.length;s++)r.push(e.getInstruction(t.args[s]).valueType);return{expectedTypes:r}}case 42:return{expectedTypes:t.args.map(()=>b)};case 48:case 49:return{expectedTypes:t.args.map(r=>e.getInstruction(r).valueType)};case 53:return{expectedTypes:[t.valueType]};case 54:return{expectedTypes:t.args.map(r=>e.getInstruction(r).valueType)};case 55:return{expectedTypes:t.args.map(r=>e.getInstruction(r).valueType)};case 16:return{expectedTypes:[rI]};default:{let r=t;throw new Error(`Unexpected opcode: ${r.type}`)}}}function Hk(e,t){for(let n of t)if($(e.getInstruction(n).valueType))return!0;return!1}var cy=(e,t,n,r)=>{let s=[],o=!0;for(let f of t){let h=e.getInstruction(f);Ue(h)||(o=!1);let x=h.valueType;if(x!==Ae)if($(x))s.push({isList:!0,index:f,elementType:Xe(x)});else if(Hn(x))s.push({isList:!1,index:f,elementType:x});else throw Fs(n,Ua(e,r),{blockExport:e.areAllArgsConstant(t)})}if(s.length===0)return e.ConstantOfType(Ae,[]);for(let f of s)if(f.elementType!==s[0].elementType)throw Fs(n,Ua(e,r),{blockExport:e.areAllArgsConstant(t)});if(o){let f=[];for(let h of s){let x=e.getInstruction(Vr(e,h.index));$O(x),h.isList?f.push(...x.value):f.push(x.value)}return e.ConstantOfType(Ln(s[0].elementType),f)}let i=e.Constant(0),a=e.Constant(1),u={};for(let f of s)f.isList&&u[f.index]===void 0&&(u[f.index]=dr(e,f.index));let c=e.NativeFunction(\"total\",s.map(f=>f.isList?u[f.index]:a)),p=e.BeginBroadcast([c]),l=i,m=[],d=[];for(let f of s){let h=f.isList?e.ListAccess([f.index,e.Subtract([p,l])]):f.index;if(d.push(h),f!==s[s.length-1]){let x=f.isList?u[f.index]:a;l=e.Add([l,x]),m.push(e.LessEqual([p,l]))}}let y=d[d.length-1];for(let f=d.length-2;f>=0;f--)y=e.Piecewise([m[f],d[f],y]);let g=e.EndBroadcast([p,y]);return e.BroadcastResult(Ln(s[0].elementType),[g])};var Qi=(e,t,n)=>{var i;let r=e.getInstruction(n).valueType,s=Zn(r),o=e.Constant(0);return e.Piecewise([e.And([e.GreaterEqual([t.count,o]),e.GreaterEqual([(i=t.stdev)!=null?i:o,o])]),n,e.NanOfType(s)])},nd=(e,t,n)=>{let r=e.getInstruction(n).valueType,s=Zn(r),o=e.Constant(0);return e.Piecewise([e.And([e.GreaterEqual([t.count,o]),e.LessEqual([t.successes,t.count])]),n,e.NanOfType(s)])},AA=(e,t)=>{let n=e.getInstruction(t).valueType,r=Zn(n),s=e.Constant(0),o=e.Constant(1);return e.Piecewise([e.And([e.GreaterEqual([t,s]),e.LessEqual([t,o])]),t,e.NanOfType(r)])},Wb=(e,t)=>{let n=e.NativeFunction(\"normalcdf\",[e.Constant(-1/0),e.Negative([e.NativeFunction(\"abs\",[t])]),e.Constant(0),e.Constant(1)]),r=e.Subtract([e.Constant(1),n]),s=e.Constant(0),o=e.Piecewise([e.LessEqual([t,s]),n,r]),i=e.Piecewise([e.Greater([t,s]),n,r]);return{p:e.Multiply([e.Constant(2),n]),pleft:o,pright:i}},qk=(e,t,n,r)=>Qi(e,t,e.Divide([e.Subtract([t.mean,r]),e.Divide([n,e.NativeFunction(\"sqrt\",[t.count])])])),Uk=(e,t,n,r,s,o)=>Qi(e,t,Qi(e,r,e.Divide([e.Subtract([e.Subtract([t.mean,r.mean]),o]),e.NativeFunction(\"sqrt\",[e.Add([e.Divide([e.Square([n]),t.count]),e.Divide([e.Square([s]),r.count])])])]))),zk=(e,t,n)=>{let r=e.Subtract([e.Constant(1),n]);return nd(e,t,e.Divide([e.Subtract([e.Divide([t.successes,t.count]),n]),e.NativeFunction(\"sqrt\",[e.Divide([e.Multiply([n,r]),t.count])])]))},jb=(e,t)=>e.NativeFunction(\"invNorm\",[e.Divide([e.Subtract([e.Constant(1),AA(e,t)]),e.Constant(2)])]),ZM=(e,t)=>{let n=e.Divide([t.successes,t.count]),r=e.Subtract([e.Constant(1),n]);return e.NativeFunction(\"sqrt\",[e.Divide([e.Multiply([n,r]),t.count])])},_A=(e,t,n)=>{let r=jb(e,n),s=e.Divide([t.successes,t.count]),o=ZM(e,t),i=e.Multiply([r,o]);return nd(e,t,e.TupleOfType(Et,{min:e.Add([s,i]),max:e.Subtract([s,i]),testStatisticType:e.Constant(Mn.PROPORTION)}))},XM=(e,t,n)=>{let r=e.Divide([t.successes,t.count]),s=e.Subtract([e.Constant(1),r]),o=e.Divide([n.successes,n.count]),i=e.Subtract([e.Constant(1),o]);return e.NativeFunction(\"sqrt\",[e.Add([e.Divide([e.Multiply([r,s]),t.count]),e.Divide([e.Multiply([o,i]),n.count])])])},wA=(e,t,n,r)=>{let s=jb(e,r),o=e.Divide([t.successes,t.count]),i=e.Divide([n.successes,n.count]),a=XM(e,t,n),u=e.Multiply([s,a]),c=e.Subtract([o,i]);return nd(e,t,nd(e,n,e.TupleOfType(Et,{min:e.Add([c,u]),max:e.Subtract([c,u]),testStatisticType:e.Constant(Mn.DIFFERENCE_OF_PROPORTIONS)})))},kk=(e,t,n,r)=>{let s=e.Divide([t.successes,t.count]),o=e.Divide([n.successes,n.count]),i=e.Constant(1),a=e.Divide([e.Add([t.successes,n.successes]),e.Add([t.count,n.count])]),u=e.Subtract([i,a]),c=e.Divide([e.Subtract([e.Subtract([s,o]),r]),e.NativeFunction(\"sqrt\",[e.Multiply([e.Multiply([a,u]),e.Add([e.Divide([i,t.count]),e.Divide([i,n.count])])])])]),p=e.Divide([e.Subtract([e.Subtract([s,o]),r]),e.NativeFunction(\"sqrt\",[e.Add([e.Divide([e.Multiply([s,e.Subtract([i,s])]),t.count]),e.Divide([e.Multiply([o,e.Subtract([i,o])]),n.count])])])]);return nd(e,t,nd(e,n,e.Piecewise([e.Equal([r,e.Constant(0)]),c,p])))},$k=(e,t,n)=>Qi(e,t,e.Divide([e.Subtract([t.mean,n]),e.Divide([t.stdev,e.NativeFunction(\"sqrt\",[t.count])])])),Yk=(e,t,n)=>e.Divide([e.Subtract([t.estimate,n]),t.standardError]),WM=(e,t,n)=>e.NativeFunction(\"invT\",[e.Divide([e.Subtract([e.Constant(1),AA(e,t)]),e.Constant(2)]),n]),jM=(e,t)=>e.Divide([t.stdev,e.NativeFunction(\"sqrt\",[t.count])]),LA=(e,t,n)=>{let r=e.Subtract([t.count,e.Constant(1)]),s=WM(e,n,r),o=jM(e,t),i=e.Multiply([s,o]);return Qi(e,t,e.TupleOfType(Et,{min:e.Add([t.mean,i]),max:e.Subtract([t.mean,i]),testStatisticType:e.Constant(Mn.MEAN_T_INFERENCE)}))},FA=(e,{estimate:t,dof:n,standardError:r},s)=>{let o=WM(e,s,n),i=e.Multiply([o,r]);return e.TupleOfType(Et,{min:e.Add([t,i]),max:e.Subtract([t,i]),testStatisticType:e.Constant(Mn.MEAN_T_INFERENCE)})},JM=(e,t,n)=>e.NativeFunction(\"sqrt\",[e.Add([e.Divide([e.Square([t.stdev]),t.count]),e.Divide([e.Square([n.stdev]),n.count])])]),VA=(e,t,n,r)=>{let s=Jb(e,t,n),o=WM(e,r,s),i=JM(e,t,n),a=e.Multiply([o,i]),u=e.Subtract([t.mean,n.mean]);return Qi(e,t,Qi(e,n,e.TupleOfType(Et,{min:e.Add([u,a]),max:e.Subtract([u,a]),testStatisticType:e.Constant(Mn.DIFFERENCE_OF_MEANS_T_INFERENCE)})))},QM=(e,t,n)=>e.Divide([t,e.NativeFunction(\"sqrt\",[n])]),BA=(e,t,n,r)=>{let s=jb(e,r),o=QM(e,n,t.count),i=e.Multiply([s,o]);return Qi(e,t,e.TupleOfType(Et,{min:e.Add([t.mean,i]),max:e.Subtract([t.mean,i]),testStatisticType:e.Constant(Mn.MEAN_Z_INFERENCE)}))},KM=(e,t,n,r,s)=>e.NativeFunction(\"sqrt\",[e.Add([e.Divide([e.Square([t]),n]),e.Divide([e.Square([r]),s])])]),GA=(e,t,n,r,s,o)=>{let i=jb(e,o),a=KM(e,n,t.count,s,r.count),u=e.Multiply([i,a]),c=e.Subtract([t.mean,r.mean]);return Qi(e,t,Qi(e,r,e.TupleOfType(Et,{min:e.Add([c,u]),max:e.Subtract([c,u]),testStatisticType:e.Constant(Mn.DIFFERENCE_OF_MEANS_Z_INFERENCE)})))},Zk=(e,t,n,r)=>Qi(e,t,Qi(e,n,e.Divide([e.Subtract([e.Subtract([t.mean,n.mean]),r]),e.NativeFunction(\"sqrt\",[e.Add([e.Divide([e.Square([t.stdev]),t.count]),e.Divide([e.Square([n.stdev]),n.count])])])]))),YM=(e,t,n)=>{let r=e.NativeFunction(\"tcdf\",[e.Constant(-1/0),e.Negative([e.NativeFunction(\"abs\",[t])]),n,e.Constant(0),e.Constant(1)]),s=e.Subtract([e.Constant(1),r]),o=e.Constant(0),i=e.Piecewise([e.LessEqual([t,o]),r,s]),a=e.Piecewise([e.Greater([t,o]),r,s]);return{p:e.Multiply([e.Constant(2),r]),pleft:i,pright:a}},HA=(e,t,n,r)=>{let s=cy(e,t,n,r),o=e.NativeFunction(\"count\",[t[0]]),i=e.Constant(t.length);return e.NativeFunction(\"chisqIndependenceTestInternal\",[s,o,i])},qA=(e,t,n,r)=>{let s=cy(e,t,n,r),o=e.NativeFunction(\"count\",[t[0]]),i=e.Constant(t.length),a=e.Multiply([e.Subtract([o,e.Constant(1)]),e.Subtract([i,e.Constant(1)])]);return e.NativeFunction(\"chisqcdf\",[e.NativeFunction(\"chisqIndependenceTestInternal\",[s,o,i]),e.Constant(1/0),a])},eC=(e,t,n)=>e.NativeFunction(\"total\",[e.Divide([e.Square([e.Subtract([t,n])]),n])]),tC=(e,t,n)=>{let r=eC(e,t,n),s=e.Subtract([e.NativeFunction(\"count\",[t]),e.Constant(1)]);return e.NativeFunction(\"chisqcdf\",[r,e.Constant(1/0),s])},Jb=(e,t,n)=>{let r=e.Constant(2),s=e.Constant(1),o=e.Divide([e.Exponent([t.stdev,r]),t.count]),i=e.Divide([e.Exponent([n.stdev,r]),n.count]),a=e.Subtract([t.count,s]),u=e.Subtract([n.count,s]);return e.Divide([e.Exponent([e.Add([o,i]),r]),e.Add([e.Divide([e.Exponent([o,r]),a]),e.Divide([e.Exponent([i,r]),u])])])},rd=(e,t)=>{var r,s,o,i,a,u,c;let n=Zn(e.getInstruction(t[0]).valueType);if(!pu(n))throw new Error(`Unexpected arg type ${We(n)}`);switch(n){case Ht:{let p={mean:e.NamedSlot(\"mean\",[t[0]]),count:e.NamedSlot(\"count\",[t[0]])},l=e.NamedSlot(\"stdevp\",[t[0]]),m=(r=t[1])!=null?r:e.Constant(0),d=qk(e,p,l,m);return e.TupleOfType(Ot,{...Wb(e,d),score:d,hypothesis:m,testStatisticType:e.Constant(Mn.MEAN_Z_INFERENCE),dof:e.Constant(NaN)})}case qt:{let p={mean:e.NamedSlot(\"mean1\",[t[0]]),count:e.NamedSlot(\"count1\",[t[0]])},l=e.NamedSlot(\"stdevp1\",[t[0]]),m={mean:e.NamedSlot(\"mean2\",[t[0]]),count:e.NamedSlot(\"count2\",[t[0]])},d=e.NamedSlot(\"stdevp2\",[t[0]]),y=(s=t[1])!=null?s:e.Constant(0),g=Uk(e,p,l,m,d,y);return e.TupleOfType(Ot,{...Wb(e,g),score:g,hypothesis:y,testStatisticType:e.Constant(Mn.MEAN_Z_INFERENCE),dof:e.Constant(NaN)})}case $t:{let p={successes:e.NamedSlot(\"successes\",[t[0]]),count:e.NamedSlot(\"count\",[t[0]])},l=(o=t[1])!=null?o:e.Constant(.5),m=zk(e,p,l);return e.TupleOfType(Ot,{...Wb(e,m),score:m,hypothesis:l,testStatisticType:e.Constant(Mn.PROPORTION),dof:e.Constant(NaN)})}case Yt:{let p={successes:e.NamedSlot(\"successes1\",[t[0]]),count:e.NamedSlot(\"count1\",[t[0]])},l={successes:e.NamedSlot(\"successes2\",[t[0]]),count:e.NamedSlot(\"count2\",[t[0]])},m=(i=t[1])!=null?i:e.Constant(0),d=kk(e,p,l,m);return e.TupleOfType(Ot,{...Wb(e,d),score:d,hypothesis:m,testStatisticType:e.Constant(Mn.DIFFERENCE_OF_PROPORTIONS),dof:e.Constant(NaN)})}case St:{let p={mean:e.NamedSlot(\"mean\",[t[0]]),stdev:e.NamedSlot(\"stdev\",[t[0]]),count:e.NamedSlot(\"count\",[t[0]])},l=(a=t[1])!=null?a:e.Constant(0),m=$k(e,p,l),d=e.NamedSlot(\"dof\",[t[0]]);return e.TupleOfType(Ot,{...YM(e,m,d),score:m,hypothesis:l,testStatisticType:e.Constant(Mn.MEAN_T_INFERENCE),dof:d})}case Mt:{let p={mean:e.NamedSlot(\"mean1\",[t[0]]),stdev:e.NamedSlot(\"stdev1\",[t[0]]),count:e.NamedSlot(\"count1\",[t[0]])},l={mean:e.NamedSlot(\"mean2\",[t[0]]),stdev:e.NamedSlot(\"stdev2\",[t[0]]),count:e.NamedSlot(\"count2\",[t[0]])},m=(u=t[1])!=null?u:e.Constant(0),d=e.NamedSlot(\"dof\",[t[0]]),y=Zk(e,p,l,m);return e.TupleOfType(Ot,{hypothesis:m,score:y,...YM(e,y,d),testStatisticType:e.Constant(Mn.DIFFERENCE_OF_MEANS_T_INFERENCE),dof:d})}case Ut:{let p={estimate:e.NamedSlot(\"pointEstimate\",[t[0]]),standardError:e.NamedSlot(\"standardError\",[t[0]]),dof:e.NamedSlot(\"dof\",[t[0]])},l=(c=t[1])!=null?c:e.Constant(0),m=Yk(e,p,l);return e.TupleOfType(Ot,{...YM(e,m,p.dof),score:m,hypothesis:l,testStatisticType:e.Constant(Mn.MEAN_T_INFERENCE),dof:e.NamedSlot(\"dof\",[t[0]])})}}};function Qb(e){if(Fm(e)){let t=Xe(e.valueType);return e.value.some(n=>Xr({valueType:t,value:n}))}return Xr(e)}function Xr({value:e,valueType:t}){switch(t){case b:return Ao(e);case nn:return e;case O:case N:{let[n,r]=e;return Ao(n)||Ao(r)}case F:{let[n,r,s]=e;return Ao(n)||Ao(r)||Ao(s)}case pn:{let[n,r,s]=e;return Ao(n)||Ao(r)||Ao(s)}case Se:{for(let n of e)if(Xr({valueType:N,value:n}))return!0;return!1}case Mr:{let[n,r]=e;return Xr({valueType:F,value:n})||Xr({valueType:b,value:r})}case Kn:{let[n,r,s]=e;return Xr({valueType:F,value:n})||Xr({valueType:F,value:r})||Xr({valueType:F,value:s})}case Jt:case Fe:{let[n,r]=e;return Xr({valueType:F,value:n})||Xr({valueType:F,value:r})}case Ie:case Pe:case De:case ye:{let[n,r]=e;return Xr({valueType:N,value:n})||Xr({valueType:N,value:r})}case pe:{let[n,r]=e;return Xr({valueType:N,value:n})||Xr({valueType:b,value:r})}case ae:{let[n,r,s]=e;return Xr({valueType:N,value:n})||Xr({valueType:N,value:r})||Xr({valueType:N,value:s})}case ve:case Te:{let[n,r,s]=e;return Xr({valueType:N,value:n})||Xr({valueType:b,value:r})||Xr({valueType:b,value:s})}case Et:case St:case Mt:case Ut:case Ht:case qt:case $t:case Yt:case Ot:return e.some(n=>Ao(n));case it:return Object.keys(e.updateRules).length===0;case Re:case Pt:case Ne:return!1;case Qn:{let[n,r]=e;return Ao(n)||Ao(r)}default:throw new Error(\"Type cannot contain a NaN value: \"+oe(t)+\".\")}}function UA(e,t,n){let r=e.argNames.indexOf(t);if(r===-1)return 0;let s=ps(e,r,n);return yn(s,e.getReturnIndex())}function ps(e,t,{allowRestriction:n,allowClosedBlockReferences:r}){return{chunk:e,argIndex:t,orderTable:[],mask:kc(e,t),allowRestriction:n,allowClosedBlockReferences:r}}function yn(e,t){let n=e.orderTable[t];if(n!==void 0)return n;let r=Xk(e,t);return e.orderTable[t]=r,r}function Xk(e,t){let{chunk:n,mask:r,argIndex:s,allowRestriction:o,allowClosedBlockReferences:i}=e;if(!i&&n.isInClosedBlock(t))return 1/0;if(t===s)return 1;if(!r[t])return 0;let a=n.getInstruction(t);if(cs(a)||Ss(a))return 1/0;switch(a.type){case 8:case 9:case 26:case 28:case 27:case 29:{let[c,p]=a.args;return Math.max(yn(e,c),yn(e,p))}case 10:{let[c,p]=a.args;return yn(e,c)+yn(e,p)}case 14:return yn(e,a.args[0]);case 11:{let[c,p]=a.args;return yn(e,p)>0?1/0:yn(e,c)}case 12:case 13:{let[c,p]=a.args,l=n.getInstruction(p);if(yn(e,c)===0&&yn(e,p)===0)return 0;if(l.type===1){let m=w(l.value);return m===Math.round(m)&&m>0?yn(e,c)*m:1/0}else return 1/0}case 56:return 2*yn(e,a.args[0]);case 33:{let c=n.getInstruction(a.args[2]);return o&&c.type===1&&isNaN(w(c.value))?yn(e,a.args[1]):1/0}case 16:case 37:case 2:case 0:case 1:case 25:case 32:case 31:case 15:case 38:case 39:case 40:case 41:case 42:case 48:case 47:case 3:case 44:case 49:case 4:case 55:return 1/0;default:let u=a;throw new Error(`Unexpected opcode ${u.type}`)}}function zA(e,t){let n=e.argNames.indexOf(t),r=e.getReturnIndex(),s=Ki(ps(e,n,{allowRestriction:!0,allowClosedBlockReferences:!1}),r);if(yn(s.orderCtx,r)>2)throw new Error(\"Programming Error: cannot compute polynomial coefficients for polynomials of order greater than 2\");let o=ir(s,r),i=!1;for(let a=0;a<e.instructionsLength();a++)e.getInstruction(a).type===33&&s.mask[a]&&(i=!0);return{chunk:s.newChunk,coefficients:o,mappedArgIndex:n===-1?void 0:s.valueMap.get(n),mappedReturnIndex:s.valueMap.get(r),isRestrictedPolynomial:i}}function Ki(e,t){let{chunk:n,argIndex:r}=e,s=Zr(n,t);if(n.isInClosedBlock(r))throw new Error(\"Programming Error: cannot find polynomial coefficients of an instruction in a closed block\");let o,i;r>=0&&r<n.argNames.length?(o=n.argNames.slice(),i=n.argTypes.slice(),o.splice(r,1),i.splice(r,1)):(o=n.argNames,i=n.argTypes);let a=new Nu({argNames:o,argTypes:i}),u=0,c=n.instructionsLength()-1,p=new vs(n,u,c,a);p.copyUntilEnd((g,f,h)=>{if(!(s[h]||f.type===47&&s[f.args[0]]))return h;if(f.type===2)return h<r||r<0?h:h===r?g.SymbolicVar(n.argTypes[h]):h-1;if(ce(f)){let x=p.mapArgs(f.args);return g.copyInstructionWithArgs(f,x)}else return p.copyLeafOrFunctionHeader(f)});let l=[],m=a.Constant(0),d=a.Constant(1),y=a.Constant(NaN);return{chunk:n,newChunk:a,orderCtx:e,coefficientTable:l,mask:e.mask,valueMap:p.oldIPtoNewIP,argIndex:r,zero:m,one:d,nan:y}}function ir(e,t){let{newChunk:n,orderCtx:r,coefficientTable:s,mask:o,valueMap:i,argIndex:a,zero:u,one:c,nan:p}=e,l=s[t];if(l!==void 0)return l;let m;for(o[t]?t===a?m=[u,c]:yn(r,t)>2?m=[p]:m=Wk(e,t):m=[i.get(t)];m.length>1;){let d=n.getInstruction(m[m.length-1]);if(d.type===1&&w(d.value)===0)m.pop();else break}if(m.length===0)throw new Error(\"Programming Error: coefficients cannot be empty\");return s[t]=m,m}function Wk(e,t){let n=e.chunk.getInstruction(t),{newChunk:r}=e;switch(n.type){case 8:{let[o,i]=n.args,a=ir(e,o),u=ir(e,i),c=a.length-1,p=u.length-1,l=[];for(let m=0;m<=Math.max(c,p);m++)c>=m&&p>=m?l.push(r.Add([a[m],u[m]])):l.push(c>p?a[m]:u[m]);return l}case 9:case 26:case 28:case 27:case 29:{let[o,i]=n.args;(n.type===26||n.type==28)&&([o,i]=[i,o]);let a=ir(e,o),u=ir(e,i),c=a.length-1,p=u.length-1,l=[];for(let m=0;m<=Math.max(c,p);m++)c>=m&&p>=m?l.push(r.Subtract([a[m],u[m]])):l.push(c>p?a[m]:r.Negative([u[m]]));return l}case 14:{let o=n.args[0],i=ir(e,o),a=[];for(let u=0;u<i.length;u++)a.push(r.Negative([i[u]]));return a}case 10:{let[o,i]=n.args,a=ir(e,o),u=ir(e,i),c=a.length-1,p=u.length-1,l=[];for(let m=0;m<=c;m++)for(let d=0;d<=p;d++){if(m+d>2)continue;let y=r.Multiply([a[m],u[d]]),g=l[m+d];g===void 0?l[m+d]=y:l[m+d]=r.Add([g,y])}return l}case 11:{let[o,i]=n.args,a=ir(e,o),u=ir(e,i),c=[];for(let p=0;p<a.length;p++)c.push(r.Divide([a[p],u[0]]));return c}case 12:case 13:{let[o,i]=n.args,a=ir(e,o),u=ir(e,i);if(a.length-1===0)return[r.RawExponent([a[0],u[0]])];let p=r.getInstruction(u[0]);switch(w(p.value)){case 0:return[r.Constant(1)];case 1:return a;case 2:return[r.Square([a[0]]),r.Multiply([r.Constant(2),r.Multiply([a[0],a[1]])]),r.Square([a[1]])]}}case 56:{let o=n.args[0],i=ir(e,o);return i.length-1===0?[r.Square([i[0]])]:[r.Square([i[0]]),r.Multiply([r.Constant(2),r.Multiply([i[0],i[1]])]),r.Square([i[1]])]}case 33:return ir(e,n.args[1]);case 37:case 16:case 0:case 23:case 2:case 1:case 25:case 32:case 31:case 15:case 38:case 39:case 40:case 41:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:case 50:case 51:case 4:case 53:case 54:case 55:throw new Error(`Cannot find polynomial coefficients of opcode ${n.type} that depends on symbol.`);default:let s=n;throw new Error(`Unexpected opcode ${s.type}`)}}function kA(e,t,n){let r=e.argNames.indexOf(t);if(r===-1){let i=e.getInstruction(n);return i.type===1?$A(i):vr()}let s=ps(e,r,{allowRestriction:!0,allowClosedBlockReferences:!1}),o=jk(s,n);return zs(o,n)}function jk(e,t){let{chunk:n,mask:r}=e;return{chunk:n,mask:r,orderCtx:e,domainTable:[],index:t}}function zs(e,t){let{domainTable:n}=e,r=n[t];if(r!==void 0)return r;let s=Jk(e,t);return n[t]=s,s}function Jk(e,t){let{chunk:n,mask:r,orderCtx:s}=e,o=n.getInstruction(t);switch(o.type){case 1:return $A(o);case 3:case 2:return o.valueType===b?Ma():vr();case 0:return vr();case 31:return nf(zs(e,o.args[0]),zs(e,o.args[1]));case 32:case 8:case 9:case 10:return er(zs(e,o.args[0]),zs(e,o.args[1]));case 11:{let i=er(zs(e,o.args[0]),zs(e,o.args[1])),a=n.getInstruction(o.args[1]);return a.type===1&&a.valueType===b&&w(a.value)!==0?i:er(vr(),i)}case 14:case 56:return zs(e,o.args[0]);case 15:{let i=o.valueType;switch(i){case N:case F:return Qk(e,o.args);case O:return Kb(e,o.args);case Et:case Ot:case St:case Mt:case Ut:case Ht:case qt:case $t:case Yt:return Kb(e,o.args);default:let a=i;throw new Error(`Unexpected tuple type ${a}`)}}case 12:case 13:case 47:case 48:case 16:case 42:case 21:case 22:case 23:case 24:case 19:case 20:case 39:case 40:case 41:case 44:case 50:case 51:case 54:case 55:return Kb(e,o.args);case 4:case 53:return vr();case 49:return vr();case 38:return o.args.length===1?zs(e,o.args[0]):vr();case 25:return vr();case 33:return VR(zs(e,o.args[0]),zs(e,o.args[1]),zs(e,o.args[2]));case 26:case 27:case 28:case 29:{if(!r[t])return Ma();let i=er(zs(e,o.args[0]),zs(e,o.args[1]));if(yn(s,t)>1)return er(vr(),i);let a=e.coefficientCtx;a===void 0&&(a=Ki(s,e.index),e.coefficientCtx=a);let u=a.newChunk,c=ir(a,t),[p,l]=c;if(!Ue(u.getInstruction(p)))return er(vr(),i);let m=Lr(u,p);if(isNaN(m))return yu();if(l===void 0)return o.type===28||o.type===29?m>=0?i:yu():m>0?i:yu();{let d=Lr(u,l);return er(i,zp(m,d))}}case 37:switch(o.symbol){case\"restriction\":case\"restrictionToBoolean\":return zs(e,o.args[0]);case\"count\":return Ma();default:return Wn[o.symbol].noPeel?vr():Kb(e,o.args)}}}function Qk(e,t){let n=Ma();for(let r of t)n=er(n,zs(e,r));return n}function Kb(e,t){let n=vr();for(let r of t)n=er(n,zs(e,r));return n}function $A(e){if(Fm(e)&&e.value.length!==1)return vr();switch(e.valueType){case b:case Y:case N:case Gt:case F:case zr:return Qb(e)?yu():Ma();case Re:return e.value?Ma():yu();case ro:return e.value[0]?Ma():yu();default:return vr()}}function YA(e){let t=e.getReturnIndex(),n=e.getInstruction(t);if(!ce(n))return t;let r=$M(e,n),s=gt(r.expectedTypes),o=nC(e,n.args,[s]);if(r.isReducerWithNoListArgs){let i=e8(e,o.didCoerce?o.args:n.args),a=Ln(r.expectedTypes.rest);if(gi(i,a)){o.didCoerce?e.replaceInstructionWithNoop(t):e.popInstruction();let u=e.List(n.args);return e.copyInstructionWithArgs(n,[u])}}else o.didCoerce&&(e.replaceInstructionWithNoop(t),e.copyInstructionWithArgs(n,o.args));return e.getReturnIndex()}function nC(e,t,n){let r=!1,s=[];for(let o=0;o<t.length;o++){let i=Ud(n,o),a=t[o],u=e.getInstruction(a).valueType,c=a;i.every(p=>!gi(u,p))&&(se(i[0],b)?c=Fo(e,a):se(i[0],O)&&(c=Kk(e,a))),c!==a&&(r=!0),s.push(c)}return r?{didCoerce:r,args:s}:{didCoerce:!1}}function Fo(e,t,n={}){var s;let r=e.getInstruction(t);return r.valueType===Ae?t:se(r.valueType,ve)?XA(e,t):se(r.valueType,Te)?ZA(e,t):se(r.valueType,nn)?e.Piecewise([e.NativeFunction(\"restrictionToBoolean\",[t]),e.Constant(1),e.Constant(NaN)]):se(r.valueType,O)?(s=n.peelableCoerce)!=null&&s?e.NativeFunction(n.withTolerance?\"peelableCoerceComplexToRealWithTolerance\":\"peelableCoerceComplexToReal\",[t]):e.NativeFunction(n.withTolerance?\"coerceComplexToRealWithTolerance\":\"coerceComplexToReal\",[t]):t}function pp(e,t){let n=e.getInstruction(t);return n.valueType===Ae||se(n.valueType,O)?t:Fo(e,t)}function Kk(e,t){let n=e.getInstruction(t);if(n.valueType===Ae)return t;if(se(n.valueType,b))return e.NativeFunction(\"coerceRealToComplex\",[t]);if(se(n.valueType,O))return t;if(Jn(n.valueType,b)||Jn(n.valueType,Y)){let r=Fo(e,t);return e.NativeFunction(\"coerceRealToComplex\",[r])}return t}function e8(e,t){let n=e.getInstruction(t[0]).valueType;if(!Hn(n))return Yn;for(let r of t)if(e.getInstruction(r).valueType!==n)return Yn;return Ln(n)}function tx(e,t,n){let r=e.getInstruction(n);if(ce(r)){for(let i of r.args)if(ex(e,i,n))return!0}if(ex(e,n,n))return!0;let s=[!0];for(let i=n+1;i<t;i++)s.push(!1);s.push(!0);let o=[t];for(;o.length;){let i=o.pop(),a=e.getInstruction(i);if(ex(e,i,n))return!0;if(ce(a)){for(let u of a.args)if(u>=n)s[u-n]||(o.push(u),s[u-n]=!0);else if(ex(e,u,n))return!0}}return!1}function ex(e,t,n){let r=e.getInstruction(t);return t<n?r.type===4?!1:!Ue(r):r.type===50?!0:r.type===3}function ly(e,t,n){let r=e.getInstruction(t);if($(r.valueType)){let s=or(e,t);if(n=Math.floor(n),isNaN(n)||n<0||s!==void 0&&n>=s){let o=Xe(r.valueType);return e.NanOfType(o)}return r.type===38?r.args[n]:r.type===1&&$(r.valueType)?e.ConstantOfType(Xe(r.valueType),r.value[n]):s!==void 0?e.InboundsListAccess([t,e.Constant(n+1)]):e.ListAccess([t,e.Constant(n+1)])}else throw new Error(`Cannot access elements of ${oe(r.valueType)}`)}function nx(e,t,n){let r=e.getInstruction(t);if(n.length===0)return e.ConstantOfType(r.valueType,[]);if(r.type===1&&$(r.valueType)){let s=[],o=Xe(r.valueType);for(let i of n){let a=Math.floor(i);isNaN(a)||a<0||a>=qa(e,t,\"Programming error: expected Constant list instruction to have constant length.\")?s.push(Is(o)):s.push(r.value[a])}return e.ConstantOfType(r.valueType,s)}else if(r.type===38){let s=[];for(let o of n){let i=Math.floor(o);if(isNaN(i)||i<0||i>=qa(e,t,\"Programming error: expected List instruction to have constant length.\")){let a=Xe(r.valueType);s.push(e.NanOfType(a))}else s.push(r.args[i])}return e.List(s)}else{let s=[],o=!0,i=or(e,t);for(let u of n){let c=Math.floor(u);s.push(e.Constant(c+1)),(isNaN(c)||c<0||i===void 0||c>=i)&&(o=!1)}let a=[t,e.List(s)];return o?e.InboundsListAccess(a):e.ListAccess(a)}}function rC(e,t){return!gn(e)&&isNaN(e)||!gn(t)&&isNaN(t)?[NaN,NaN]:[e,t]}function rx(e){return Zt(w(e[0]),w(e[1]))}function WA([e,t]){return gn(e)&&gn(t)}function jA(e,t){if(!WA(e)||!WA(t))return Rc(rx(e),rx(t));let[n,r]=e,[s,o]=t,i=fo(wr(s,s),wr(o,o)),a=fo(wr(n,s),wr(r,o)),u=_o(wr(r,s),wr(n,o)),c=Vs(a,i),p=Vs(u,i);return!gn(c)||!gn(p)?Rc(rx(e),rx(t)):rC(c,p)}function sC(e,t,n){let r;return sx(t)?r=iC(t,n):r=QA(t,n),e.ConstantOfType(t,r)}function oC(e){return sx(e)||JA(e)}function sx(e){switch(e){case Ae:case Y:case ro:case He:case eu:case Gt:case lr:case oo:case ts:case ns:case ao:case io:case hr:case Er:case Sr:case zr:case Do:case As:case zi:case vo:case xs:case tu:case nu:case cu:case ru:case su:case lu:case ou:case iu:case au:case uu:case Ui:return!0;default:return!1}}function JA(e){switch(e){case b:case Re:case O:case nn:case N:case Ie:case pe:case ae:case De:case ye:case Pe:case Se:case ve:case Te:case F:case Fe:case Kn:case Mr:case Jt:case pn:case Qn:case Ne:case it:case Et:case Ot:case St:case Mt:case Ut:case Ht:case qt:case $t:case Yt:case Pt:return!0;default:return!1}}function iC(e,t){if(e===Ae)return[];let n=Xe(e);if(!JA(n))throw new Error(`Programming error: unexpected element type ${We(n)} for list type ${We(e)}.`);let r=[];for(let s=0;s<t.length;s++){let o=QA(n,t[s]);r.push(o)}return r}function QA(e,t){if(e===b)return be(t,1);if(e===N||e===O){let[n,r]=t;return[be(n,1),be(r,1)]}else if(e===F){let[n,r,s]=t;return[be(n,1),be(r,1),be(s,1)]}else return t}function aC(e,t){return fo(e,t)}function uC(e,t){return _o(e,t)}function cC(e,t){return wr(e,t)}function lC(e,t){return Vs(e,t)}function py(e,t){return w(e)===Math.E?Math.exp(w(t)):n1(e,t)}var n8=py;function pC(e){return mo(e)}function mC(e){return wr(e,e)}function r8(e,t){return t[e]}function dC(e,t){return w(e)===w(t)}function fC(e,t){return w(e)<w(t)}function yC(e,t){return w(e)>w(t)}function gC(e,t){return w(e)<=w(t)}function hC(e,t){return w(e)>=w(t)}function e_(e,t){return e||t}function t_(e,t){return e&&t}function s8(e,t,n){let r=Math.floor(w(n))-1;return!isFinite(r)||r<0||r>=t.length?Is(e):t[r]}function bC(e,t,n,r){gn(r)&&(r=w(r));let s=n===b||n===Pt?r:w0(n,r);return`${t}::${e}${s}`}function xC(e,t){switch(e){case\"mod\":return s1(t[0],t[1]);case\"abs\":return e1(t[0]);case\"sqrt\":return r1(t[0]);case\"total\":return o1(t[0]);case\"count\":return t[0].length;case\"validateRangeLength\":{let n=t[0],r=t[1],s=t[2],o=t[3],i=U0(n,r,s,o);if(i===0)throw Pf();return i}case\"validateSampleCount\":{let n=_a(t[0]),r=z0(n);if(r===0&&n!==0)throw AS();return r}case\"select\":case\"elementsAt\":case\"uniquePerm\":{let n=Wn[e];return Ps[n.symbol].apply(null,t)}case\"complex\":return rC(t[0],t[1]);case\"complexDivide\":return jA(t[0],t[1]);case\"wirtingerEqualOrWarning\":return t[1];default:{let n=Wn[e];return(n.module===\"Math\"?Math:Ps)[n.symbol].apply(null,_a(t))}}}function TC(e,t){let n=w(t[0][0]),r=w(t[1][0]),s=w(t[0][1]),o=w(t[1][1]);if(n!==r||s!==o){let i=n-r,a=s-o;if(isNaN(i)||isNaN(a))return;let u=Math.abs(i)+Math.abs(a),c=Math.abs(n)+Math.abs(s),p=Math.abs(r)+Math.abs(o);if(u<1e-14*Math.max(c,p))return;e.setWarning(I(\"shared-calculator-error-complex-wirtinger-differs\"))}}function IC(e,t){let n=w(t[0][1]);oM(n)&&e.setWarning(I(\"graphing-calculator-error-nan-blame-complex-coercion\"))}function n_(e,t){let n=Array(t+1);return Tt(e,t,n)}function r_(e,t,n){let r=Array(t+1);for(let s=0;s<n.length;s++)r[s]=n[s];return Tt(e,t,r)}function s_(e,t,n){if(t.constantLength)return t.constantLength;let r=t.args[0],o=e.getInstruction(r).args[0],i=e.getInstruction(o);return w(Tt(e,i.args[0],n))}function o_(e,t,n,r){let s=e.getInstruction(t),o=s_(e,s,r);if(!isFinite(n)||n<0||n>=o)return Is(Xe(s.valueType));let i=s.args[0],a=t-i,u=e.getInstruction(i),c=u.args[0],p=u.args[a];r[c]=n+1;let l=Tt(e,p,r);for(let m=c;m<=i;m++)r[m]=void 0;return l}function o8(e,t,n){let r=e.getInstruction(t),s=r.args[0],o=e.getInstruction(s).args[0];if(a8(e,o+1,s-1)&&sx(r.valueType)){let u=e.copy(),c=sd(u);return iC(r.valueType,c)}let i=s_(e,r,n),a=[];for(let u=i-1;u>=0;u--)a[u]=o_(e,t,u,n);return a}function i_(e,t,n){let r=Tt(e,t.args[1],n),s=t.args[0],o=e.getInstruction(s);if(o.type===48)return o_(e,s,w(r)-1,n);if(o.type===33){let i=Tt(e,o.args[0],n);return i_(e,{...t,args:[i?o.args[1]:o.args[2],t.args[1]]},n)}else{let i=Tt(e,t.args[0],n);return s8(t.valueType,i,r)}}function Tt(e,t,n){let r=n[t];if(r!==void 0)return r;let s=i8(e,t,n);return typeof s==\"number\"&&s===Math.floor(s)&&(s=be(s,1)),n[t]=s,s}function i8(e,t,n){let r=e.getInstruction(t);switch(r.type){case 1:return r.value;case 8:return aC(Tt(e,r.args[0],n),Tt(e,r.args[1],n));case 9:return uC(Tt(e,r.args[0],n),Tt(e,r.args[1],n));case 10:return cC(Tt(e,r.args[0],n),Tt(e,r.args[1],n));case 11:return lC(Tt(e,r.args[0],n),Tt(e,r.args[1],n));case 12:return py(Tt(e,r.args[0],n),Tt(e,r.args[1],n));case 13:return n8(Tt(e,r.args[0],n),Tt(e,r.args[1],n));case 14:return pC(Tt(e,r.args[0],n));case 56:return mC(Tt(e,r.args[0],n));case 15:return r.args.map(o=>Tt(e,o,n));case 16:return r8(r.index,Tt(e,r.args[0],n));case 25:return dC(Tt(e,r.args[0],n),Tt(e,r.args[1],n));case 26:return fC(Tt(e,r.args[0],n),Tt(e,r.args[1],n));case 27:return yC(Tt(e,r.args[0],n),Tt(e,r.args[1],n));case 28:return gC(Tt(e,r.args[0],n),Tt(e,r.args[1],n));case 29:return hC(Tt(e,r.args[0],n),Tt(e,r.args[1],n));case 31:return Tt(e,r.args[0],n)||Tt(e,r.args[1],n);case 32:return Tt(e,r.args[0],n)&&Tt(e,r.args[1],n);case 44:return bC(r.tag,Tt(e,r.args[0],n),e.getInstruction(r.args[1]).valueType,Tt(e,r.args[1],n));case 33:return Tt(e,r.args[0],n)?Tt(e,r.args[1],n):Tt(e,r.args[2],n);case 37:{let o=[];for(let i of r.args)o.push(Tt(e,i,n));return r.symbol===\"wirtingerEqualOrWarning\"&&TC(e,o),r.symbol===\"peelableCoerceComplexToReal\"&&IC(e,o),xC(r.symbol,o)}case 38:{let o=[];for(let i of r.args)o.push(Tt(e,i,n));return o}case 39:case 40:case 41:return i_(e,r,n);case 48:return o8(e,t,n);case 47:{let o=r.args[0],i=t-o,u=e.getInstruction(o).args[i],c=KA(e,{endIndex:o,returnIndex:u,resultIndex:t},n);return sd(c)}case 55:{let o=r.args[0],a=e.getInstruction(o).endIndex,c=e.getInstruction(a).args[0],p=KA(e,{endIndex:a,returnIndex:c,resultIndex:t},n);return sd(p)}case 19:case 20:case 21:case 22:case 23:case 24:case 42:case 0:case 2:case 3:case 49:case 50:case 51:case 4:case 53:case 54:throw new Error(`Programming Error: cannot interpret opcode ${r.type}`);default:let s=r;throw new Error(`Programming Error: unexpected opcode ${s.type}`)}}function KA(e,t,n){let r=t.endIndex,s=t.returnIndex,o=t.resultIndex,i=e.getInstruction(r).args[0],a=[];a[s]=!0;let u=s;e.getInstruction(o).type===55&&(a[o]=!0,u=o);for(let y=u;y>=i;y--){if(!a[y])continue;let g=e.getInstruction(y);if(ce(g))for(let f of g.args)f<i||f>r?Tt(e,f,n):a[f]=!0}let p=e.copy();p.unsafelyTruncate(i);for(let y=0;y<i;y++){let g=n[y],f=e.getInstruction(y);if(g!==void 0){let h=f.valueType;p.replaceInstructionWithConstant(y,{type:1,valueType:h,value:g})}}p.reopenAllBlocks();let l=o-1,m=new vs(e,i,l,p);m.copyUntilEnd((y,g)=>{if(ce(g)){let f=m.mapArgs(g.args);return g.type===40?y.InboundsListAccess(f):y.copyInstructionWithArgs(g,f)}else return m.copyLeafOrFunctionHeader(g)}),p.Noop();let d=e.getInstruction(o);if(d.type===47)p.replaceInstructionWithBlockVarOrFunctionCall(p.getReturnIndex(),{type:47,valueType:d.valueType,args:[m.mapIndex(r)]});else if(d.type===55)p.replaceInstructionWithBlockVarOrFunctionCall(p.getReturnIndex(),{type:55,valueType:d.valueType,args:m.mapArgs(d.args)});else throw new Error(`Programming error: unexpected opcode ${ls(d.type)}`);return p}function a8(e,t,n){let r=[];for(let o=0;o<=t;o++)r.push(!1);let s=[];for(let o=t+1;o<=n;o++)s.push(o);for(;s.length;){let o=s.pop();if(r[o])continue;r[o]=!0;let i=e.getInstruction(o);if(i.type===55)return!0;if(ce(i))for(let a of i.args)r[a]||s.push(a)}return!1}function a_(e,t){let n=[];for(let s=0;s<=t;s++)n.push(!1);let r=[t];for(;r.length;){let s=r.pop();if(n[s])continue;n[s]=!0;let o=e.getInstruction(s);if(o.type===4&&o.endIndex===-1)return!0;if(ce(o))for(let i of o.args)n[i]||r.push(i)}return!1}function sd(e){let t=e.getCompiledFunction();return t.executionMetadata.recursiveFunctionCache=new rm,t.executionMetadata.iterativeRecursionOutputs={},t.fn()}function c_(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error(\"Programming Error: only the final instruction in a chunk can be constant collapsed\");let t=e.getInstruction(e.getReturnIndex());if(!ce(t))return e.getReturnIndex();switch(t.type){case 8:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.Constant(aC(r.value,s.value))):r.type===1&&w(r.value)===0?(e.popInstruction(),t.args[1]):s.type===1&&w(s.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 9:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.Constant(uC(r.value,s.value))):r.type===1&&w(r.value)===0?(e.popInstruction(),e.Negative([t.args[1]])):s.type===1&&w(s.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 10:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.Constant(cC(r.value,s.value))):r.type===1&&w(r.value)===1?(e.popInstruction(),t.args[1]):s.type===1&&w(s.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 11:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.Constant(lC(r.value,s.value))):s.type===1&&w(s.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 12:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);if(r.type===1&&s.type===1)return e.popInstruction(),e.Constant(py(r.value,s.value));if(r.type===1&&r.valueType===b){let o=w(r.value);if(o===Math.E)return e.popInstruction(),e.NativeFunction(\"exp\",[t.args[1]]);if(o>0)return e.popInstruction(),e.RawExponent(t.args)}if(s.type===1&&s.valueType===b){let o=w(s.value);if(o===1)return e.popInstruction(),t.args[0];if(o===Math.floor(o))return e.popInstruction(),e.RawExponent(t.args);if(gn(s.value)){let{n:i,d:a}=s.value;if(a%2===1){e.popInstruction();let u=e.RawExponent([e.NativeFunction(\"abs\",[t.args[0]]),t.args[1]]);return i%2===0?u:e.Multiply([e.NativeFunction(\"sign\",[t.args[0]]),u])}}}return e.getReturnIndex()}case 13:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.Constant(py(r.value,s.value))):s.type===1&&w(s.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 14:{let r=e.getInstruction(t.args[0]);return r.type===1?(e.popInstruction(),e.Constant(pC(r.value))):e.getReturnIndex()}case 56:{let r=e.getInstruction(t.args[0]);return r.type===1?(e.popInstruction(),e.Constant(mC(r.value))):e.getReturnIndex()}case 25:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(Re,dC(r.value,s.value))):e.getReturnIndex()}case 26:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(Re,fC(r.value,s.value))):e.getReturnIndex()}case 27:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(Re,yC(r.value,s.value))):e.getReturnIndex()}case 28:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(Re,gC(r.value,s.value))):e.getReturnIndex()}case 29:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(Re,hC(r.value,s.value))):e.getReturnIndex()}case 31:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(Re,e_(r.value,s.value))):r.type===1?(e.popInstruction(),r.value?t.args[0]:t.args[1]):s.type===1?(e.popInstruction(),s.value?t.args[1]:t.args[0]):e.getReturnIndex()}case 32:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return r.type===1&&s.type===1?(e.popInstruction(),e.ConstantOfType(Re,t_(r.value,s.value))):r.type===1?(e.popInstruction(),r.value?t.args[1]:t.args[0]):s.type===1?(e.popInstruction(),s.value?t.args[0]:t.args[1]):e.getReturnIndex()}case 33:{let r=e.getInstruction(t.args[0]);return r.type===1?(e.popInstruction(),r.value?t.args[1]:t.args[2]):e.getReturnIndex()}case 16:{let r=e.getInstruction(t.args[0]),s=t.index;return r.type===15?(e.popInstruction(),r.args[s]):r.type===1?(e.popInstruction(),e.ConstantOfType(t.valueType,r.value[s])):e.getReturnIndex()}case 38:case 15:{if(u_(e,t.args)){e.popInstruction();let r=[];for(let s of t.args)r.push(e.getInstruction(s).value);return e.ConstantOfType(t.valueType,r)}return e.getReturnIndex()}case 39:case 41:{let r=t.args[0],s=e.getInstruction(r),o=e.getInstruction(t.args[1]),i=or(e,r);if(i===0)return e.popInstruction(),e.NanOfType(t.valueType);if(s.type===33&&o.type===1){let a=t.type===39?e.ListAccess([s.args[1],t.args[1]]):e.InboundsListAccess([s.args[1],t.args[1]]),u=t.type===39?e.ListAccess([s.args[2],t.args[1]]):e.InboundsListAccess([s.args[2],t.args[1]]);return e.Piecewise([s.args[0],a,u])}if(s.type===48){e.popInstruction();let a=s.args[0],u=r-a,c=e.getInstruction(a),p=c.args[0],l,m;if(t.type===41)l=t.args[1];else if(o.type===1&&o.valueType===b&&i!==void 0){let g=w(o.value),f=Math.floor(g);if(f<1||f>i)return e.NanOfType(t.valueType);l=g===f?t.args[1]:e.Constant(f)}else{let g=e.Constant(1),h=e.getInstruction(p).args[0],x=e.NativeFunction(\"floor\",[t.args[1]]),T=e.GreaterEqual([x,g]),P=e.LessEqual([x,h]);l=e.Piecewise([T,e.Piecewise([P,x,h]),g]),m={one:g,lengthIndex:h,roundedIndex:x,greaterEqualIndex:T,lessEqualIndex:P}}if(c.args[u]<p)return c.args[u];let d=c.args[u],y=new vs(e,p,d);if(y.copyUntilEnd((g,f,h)=>{if(h===p)return l;if(ce(f)){let x=y.mapArgs(f.args);return f.type===40?g.InboundsListAccess(x):g.copyInstructionWithArgs(f,x)}else return y.copyLeafOrFunctionHeader(f)}),m){let{greaterEqualIndex:g,lessEqualIndex:f,lengthIndex:h,one:x}=m,T=Xe(s.valueType),P=e.NanOfType(T),M=y.mapIndex(d),S=e.And([e.And([g,f]),e.GreaterEqual([h,x])]);return e.Piecewise([S,M,P])}else return y.mapIndex(d)}else if(o.type===1&&o.valueType===b)if(s.type===38){e.popInstruction();let a=Math.floor(w(o.value))-1;return isNaN(a)||a<0||a>=s.args.length?e.NanOfType(t.valueType):s.args[a]}else if(s.type===1){e.popInstruction();let a=Math.floor(w(o.value))-1;return isNaN(a)||a<0||a>=s.value.length?e.NanOfType(t.valueType):e.ConstantOfType(Xe(s.valueType),s.value[a])}else return e.getReturnIndex();else return e.getReturnIndex()}case 47:{let r=e.getInstruction(t.args[0]);if(!Ss(r)||tx(e,e.getReturnIndex(),r.args[0]))return e.getReturnIndex();if(oC(t.valueType)){let s=e.copy(),o=sd(s);return e.popInstruction(),sC(e,t.valueType,o)}else throw new Error(`Constant collapsing a block with return type ${oe(t.valueType)} is not implemented.`)}case 55:{let r=e.dereferenceFunctionHeader(t.args[0]);if(r===void 0||!u_(e,t.args.slice(1))||tx(e,r,t.args[0]))return e.getReturnIndex();if(oC(t.valueType)){let s=e.copy(),o=sd(s);return e.popInstruction(),sC(e,t.valueType,o)}else throw new Error(`Constant collapsing a function call with return type ${oe(t.valueType)} is not implemented.`)}case 37:{let r=c8(e,t.args);if(r!==void 0)return e.popInstruction(),t.symbol===\"wirtingerEqualOrWarning\"&&TC(e,r),t.symbol===\"peelableCoerceComplexToReal\"&&IC(e,r),e.ConstantOfType(t.valueType,xC(t.symbol,r));switch(t.symbol){case\"peelableCoerceComplexToReal\":{let s=e.getInstruction(t.args[0]);if(s.type===37){if(s.symbol===\"complex\"){let o=e.getInstruction(s.args[1]);if(o.type===1&&o.valueType===b&&w(o.value)===0)return e.popInstruction(),s.args[0]}else if(s.symbol===\"coerceRealToComplex\")return e.popInstruction(),s.args[0]}return e.getReturnIndex()}case\"complexPow\":{let s=e.getInstruction(t.args[1]);if(s.type===1&&s.valueType===O){let[o,i]=s.value;if(w(o)===1&&w(i)===0)return e.popInstruction(),t.args[0]}return e.getReturnIndex()}case\"count\":{let s=or(e,t.args[0]);return s!==void 0?(e.popInstruction(),e.Constant(s)):e.getReturnIndex()}case\"select\":{let s=or(e,t.args[0]);if(s!==void 0&&Ue(e.getInstruction(t.args[1]))){e.popInstruction();let o=Lr(e,t.args[1]),i=[];for(let a=0;a<Math.min(s,o.length);a++)o[a]&&i.push(a);return nx(e,t.args[0],i)}else return e.getReturnIndex()}case\"shuffle\":{let s=t.args[0],o=t.args[1],i=or(e,o);if(i!==void 0&&Ue(e.getInstruction(s))){e.popInstruction();let a=F0(Lr(e,s),i);return nx(e,o,a)}else return e.getReturnIndex()}case\"elementsAt\":{let s=t.args[0],o=t.args[1];if(Ue(e.getInstruction(o))){e.popInstruction();let i=Lr(e,o);return nx(e,s,i)}return e.getReturnIndex()}case\"restrictionToBoolean\":{let s=e.getInstruction(t.args[0]);return Ue(s)?(e.popInstruction(),e.ConstantOfType(Re,s.value)):s.type===37&&s.symbol===\"restriction\"?(e.popInstruction(),s.args[0]):e.getReturnIndex()}default:return e.getReturnIndex()}}case 44:{let r=e.getInstruction(t.args[0]),s=e.getInstruction(t.args[1]);return Ue(r)&&Ue(s)?e.ConstantOfType(Pt,bC(t.tag,Tb(e,t.args[0]),s.valueType,Tb(e,t.args[1]))):e.getReturnIndex()}case 48:{let r=e.getReturnIndex(),s=or(e,r);if(s!==void 0&&s===0)return e.popInstruction(),e.ConstantOfType(t.valueType,[]);let o=t.args[0],i=e.getInstruction(o),a=i.args[0],u=r-o,c=i.args[u];if(!tx(e,c,a)){if(t.valueType===so){if(s==null)throw Df(Ms(e,r));let m=[];for(let d=0;d<s;d++){let y=e.InboundsListAccess([r,e.Constant(d+1)]);m.push(y)}return e.List(m)}if(a_(e,r))return r;e.fuseBroadcast(),r=e.getReturnIndex();let l=n_(e,r);e.popInstruction(),e.ConstantOfType(t.valueType,l)}return r}case 49:{for(let s of t.args)if(!Ue(e.getInstruction(s)))return e.getReturnIndex();e.popInstruction();let r={};for(let s=0;s<t.symbols.length;s++){let o=t.symbols[s],i=e.getInstruction(t.args[s]);if(i.type===48&&(i=e.getInstruction(Vr(e,t.args[s]))),i.type!==1)throw new Error(\"Expected instruction to be constant\");Qb(i)||(r[o]=i)}return e.ConstantOfType(it,{type:\"Action\",updateRules:r})}case 20:case 22:case 23:case 24:case 40:case 42:case 21:case 19:case 50:case 51:case 53:case 54:return e.getReturnIndex();default:let n=t;throw new Error(`Unexpected opcode ${n.type}`)}}function u_(e,t){for(let n of t){let r=e.getInstruction(n);if(!Ue(r))return!1}return!0}function c8(e,t){let n=[];for(let r of t){let s=e.getInstruction(r);if(Ue(s))n.push(s.value);else return}return n}function od(e,t,n){switch(t.type){case 8:return e.Add(n);case 9:return e.Subtract(n);case 10:return e.Multiply(n);case 11:return e.Divide(n);case 12:return e.Exponent(n);case 13:return e.RawExponent(n);case 14:return e.Negative(n);case 56:return e.Square(n);case 25:return e.Equal(n);case 26:return e.Less(n);case 27:return e.Greater(n);case 28:return e.LessEqual(n);case 29:return e.GreaterEqual(n);case 31:return e.Or(n);case 32:return e.And(n);case 33:return e.Piecewise(n);case 47:return e.BlockVar(t.valueType,n);case 48:return e.BroadcastResult(t.valueType,n);case 15:return e.TupleOfType(t.valueType,n);case 16:return e.Slot(t.index,n);case 37:return e.NativeFunction(t.symbol,n);case 42:return e.Distribution(t.symbol,n);case 21:return e.BeginIntegral(t.callData,n);case 22:return e.EndIntegral(n);case 23:return e.BeginBroadcast(n,t.context);case 24:return e.EndBroadcast(n);case 19:return e.BeginLoop(t.callData,n);case 20:return e.EndLoop(n);case 38:return e.List(n);case 39:return e.ListAccess(n);case 40:return e.DeferredListAccess(n);case 41:return e.InboundsListAccess(n);case 44:return e.ExtendSeed(t.tag,n);case 49:return e.Action(t.symbols,n);case 50:return e.BeginMap(t.callData,n);case 51:return e.EndMap(n);case 53:return e.BeginFunction(n);case 54:return e.EndFunction(n);case 55:return e.FunctionCall(n);default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function l_(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error(\"Programming Error: only the final instruction in a chunk can be converted to broadcast\");let t=e.getInstruction(e.getReturnIndex());if(!ce(t))return e.getReturnIndex();switch(t.type){case 8:case 9:case 10:case 11:case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 31:case 32:case 15:case 14:case 56:case 33:case 16:return mp(e,t);case 42:return Vr(e,mp(e,t));case 37:{let r=Wn[t.symbol];switch(r.tag){case\"default\":case\"trig\":case\"trig2\":case\"inverseTrig\":case\"color\":return mp(e,t);case\"never-broadcast\":{let s=[],o=!1;for(let i of t.args){let a=Vr(e,i);a!==i?(o=!0,s.push(a)):s.push(i)}return o?e.copyInstructionWithArgs(t,s):e.getReturnIndex()}case\"reducer\":if(l8(e,t.args))if(t.args.length===1){let s=t.args[0],o=Vr(e,s);return o!==s?e.copyInstructionWithArgs(t,[o]):e.getReturnIndex()}else return mp(e,t);else return e.getReturnIndex();case\"doubleReducer\":{if(t.args.length!==2)throw new Error(\"Programming error: double reducers must have two arguments\");let s=Vr(e,t.args[0]),o=Vr(e,t.args[1]);return s!==t.args[0]||o!==t.args[1]?e.copyInstructionWithArgs(t,[s,o]):e.getReturnIndex()}case\"parameterizedReducer\":{if(t.args.length!==2)throw new Error(\"Programming error: double reducers must have two arguments\");let s=Vr(e,t.args[0]);return s===t.args[0]?mp(e,t,[!1,!0]):e.copyInstructionWithArgs(t,[s,t.args[1]])}default:{let s=r.tag;throw new Error(`Programming Error: unexpected tag ${s}`)}}}case 39:case 40:case 41:return e.getInstruction(t.args[0]).valueType===Ae&&$(e.getInstruction(t.args[1]).valueType)?e.ConstantOfType(Ae,[]):mp(e,t,[!1,!0]);case 55:{let s=e.getInstruction(t.args[0]).signature.argTypes.map(a=>!$(a)),o=[t.args[0]],i=!1;for(let a=1;a<t.args.length;a++){let u=t.args[a],c=Vr(e,u);c!==u?(i=!0,o.push(c)):o.push(u)}return i?e.copyInstructionWithArgs(t,o):mp(e,t,[!1,...s])}case 21:case 22:case 19:case 20:case 50:case 51:return e.getReturnIndex();case 38:case 47:case 23:case 24:case 48:case 44:case 49:case 53:case 54:return e.getReturnIndex();default:let n=t;throw new Error(`Unexpected opcode ${n.type}`)}}function l8(e,t){for(let n of t)if($(e.getInstruction(n).valueType))return!0;return!1}function mp(e,t,n){let r=t.args,s=!1,o=[];for(let d=0;d<r.length;d++){if(n&&!n[d])continue;let y=r[d],g=e.getInstruction(y).valueType;$(g)&&o.indexOf(y)===-1&&o.push(y),g===Ae&&(s=!0)}if(o.length===0)return e.getReturnIndex();if(t.type===33&&o.indexOf(t.args[0])==-1&&o.indexOf(t.args[1])>=0&&o.indexOf(t.args[2])>=0){let d=Vr(e,t.args[1]),y=Vr(e,t.args[2]);return d!==t.args[1]||y!==t.args[2]?od(e,t,[t.args[0],d,y]):e.getReturnIndex()}e.popInstruction();let i=td(e,o);if(i===void 0)throw new Error(\"Programming Error: expected minListLength to be defined for \"+o.length+\" lists\");let a=i;if(Ue(e.getInstruction(a))&&Lr(e,a)===0&&s)return e.ConstantOfType(Ae,[]);let u=e.BeginBroadcast([a],{type:\"implicit\"}),c=[];for(let d of o)c.push(Ru(e,d,u));let p=[];for(let d=0;d<r.length;d++){let y=r[d];if(n&&!n[d])p.push(y);else{let g=o.indexOf(y);p.push(g===-1?y:c[g])}}let l=e.copyInstructionWithArgs(t,p),m=e.EndBroadcast([u,l]);return e.BroadcastResult(Ln(e.getInstruction(l).valueType),[m])}function Ru(e,t,n){return e.getInstruction(t).type==48?e.DeferredListAccess([t,n]):e.InboundsListAccess([t,n])}function m_(e){let t=e.getReturnIndex(),n=Zr(e,t),r=e.getInstruction(t);if(r.type!==48)return e;let s=r.args[0],o=t-s,i=e.getInstruction(s),a=i.args[0],u=i.args[o],c=[],p=[];c.push(a);let l=qa(e,e.getReturnIndex(),\"Programming error: cannot optimize regression on non-constant-length list\");p.push({range:l-1,length:l});let m=!1,d=!1;for(let E=a+1;E<=u;E++){if(!n[E])continue;let v=e.getInstruction(E);if(cs(v)||Ss(v))return e;if(v.type===39||v.type===41||v.type===40){if(v.args[1]!==a)continue;let D=v.args[0];if(e.getInstruction(D).valueType!==Y||!Ue(e.getInstruction(D)))continue;let G=Lr(e,D),j=d8(G);if(!isFinite(j.range))continue;c.push(E),p.push(j)}else p_(v)?m=!0:(v.type===12||v.type===13)&&(d=!0)}if(c.length===0||!d&&!m)return e;let y=[],g=[];for(let E=0;E<e.argNames.length;E++)g.push(E),y.push(Ma());let f=[],h=[];for(let E=0;E<=u;E++)f.push(PC(e,g,f,E)),h.push(PC(e,c,h,E));for(let E=0;E<=u;E++){if(!n[E])continue;let v=e.getInstruction(E);if(v.type===33){let D=f[E];for(let G=0;G<D.length;G++)if(D[G])return e}else if(v.type===12||v.type===13){let D=!1,G=!1;for(let ee=0;ee<c.length;ee++)h[v.args[0]][ee]&&(D=!0),h[v.args[1]][ee]&&(G=!0);if(D||!G)continue;let j=f[v.args[0]],Q=0,W;for(let ee=0;ee<j.length;ee++)j[ee]&&(W=ee,Q+=1);if(Q!==1||W===void 0)continue;let K=g[W],J=ps(e.copy().reopenFinalBlock(),K,{allowRestriction:!1,allowClosedBlockReferences:!1});if(yn(J,v.args[0])!==1)continue;let re=Ki(J,v.args[0]),[ie,It]=ir(re,v.args[0]);if(It===void 0)continue;let Bt=Lr(re.newChunk,It),xe=Lr(re.newChunk,ie);y[W]=er(y[W],zp(xe,Bt))}}if(m){let E=e.copy().reopenFinalBlock();for(let v=0;v<c.length;v++){let D=ps(E,c[v],{allowRestriction:!1,allowClosedBlockReferences:!1}),G=Ki(D,u);for(let j=a+1;j<=u;j++){if(!n[j])continue;let Q=E.getInstruction(j);if(p_(Q)){let W=Q.args[0];if(yn(D,W)!==1)continue;let K=ir(G,W)[1];if(K===void 0)continue;let J=m8(G.newChunk,K),re,ie=0;for(let pt=0;pt<J.length;pt++)J[pt]&&(re=pt,ie+=1);if(ie!==1||re===void 0)continue;let It=ps(G.newChunk,re,{allowRestriction:!1,allowClosedBlockReferences:!1});if(yn(It,K)!==1)continue;let Bt=Ki(It,K),[xe,ee]=ir(Bt,K);if(ee===void 0||!Ue(Bt.newChunk.getInstruction(xe))||!Ue(Bt.newChunk.getInstruction(ee)))continue;let U=Lr(Bt.newChunk,xe),te=Lr(Bt.newChunk,ee),Ce=y8(p[v]),Ge=f8(p[v]);if(!isFinite(Ce)||Ce<=0||!isFinite(Ge)||Ge<0||Ce<=Ge)continue;y[re]=er(y[re],er(zp(-Ge+U,te),zp(Ce-U,-te)))}}}}let x=!1;for(let E of y){if(co(E)||!Wo(E))return e;(E.bounds[0]!==-1/0||E.bounds[1]!==1/0)&&(x=!0)}if(!x)return e;let T=e.copy(),P=T.Constant(1),M=T.Constant(NaN),S=t;for(let E=0;E<T.argNames.length;E++)S=p8(T,y[E],S,E,P,M);return T.fuseBroadcast(),T}function p8(e,t,n,r,s,o){if(co(t)||!Wo(t)||t.bounds[0]===-1/0&&t.bounds[1]===1/0)return n;let i=e.And([e.LessEqual([e.Constant(t.bounds[0]),r]),e.LessEqual([r,e.Constant(t.bounds[1])])]);return e.Multiply([n,e.Piecewise([i,s,o])])}function m8(e,t){let n=[];for(let s=0;s<e.argNames.length;s++)n.push(s);let r=[];for(let s=0;s<=t;s++)r.push(PC(e,n,r,s));return r[t]}function p_(e){return e.type===37&&(e.symbol===\"sin\"||e.symbol===\"cos\")}function d8(e){let t=1/0,n=-1/0,r=e.length;for(let s of e)t=Math.min(t,s),n=Math.max(n,s);return{range:n-t,length:r}}function f8({range:e}){return 1e-5/e}function y8({range:e,length:t}){let n=e/Math.min(t-1,31);return Math.PI/n}function PC(e,t,n,r){let s=e.getInstruction(r),o=g8(t.length);for(let i=0;i<t.length;i++)if(t[i]===r)return o[i]=!0,o;if(!ce(s))return o;for(let i of s.args){let a=n[i];for(let u=0;u<a.length;u++)o[u]=o[u]||a[u]}return o}function g8(e){let t=[];for(let n=0;n<e;n++)t.push(!1);return t}var b_=SC({sin:Bn(\"isinf(x) || isnan(x) ? NaN : dcg_isPiMultiple(abs(x)) ? 0.0 : sin(x)\"),cos:Bn(\"isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? 0.0 : cos(x)\"),tan:Vo(le`float a=abs(x);\n    return isinf(x) || isnan(x) ? NaN\n      : dcg_isPiMultiple(a) ? 0.0\n      : dcg_isOddHalfPiMultiple(a) ? Infinity\n      : tan(x);`),cot:Vo(le`float a=abs(x);\n      return isinf(x) || isnan(x) ? NaN\n        : a < 0.03 ? 1.0/x - x/3.0\n        : dcg_isPiMultiple(a) ? Infinity\n        : dcg_isOddHalfPiMultiple(a) ? 0.0\n        : 1.0 / tan(x);`),sec:Bn(\"isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? Infinity: 1.0 / cos(x)\"),csc:Vo(le`float a=abs(x);\n      return isinf(x) || isnan(x) ? NaN\n        : a < 0.03 ? 1.0/x + x/6.0\n        : dcg_isPiMultiple(a) ? Infinity\n        : 1.0 / sin(x);`),arcsin:Vo(le`if (isinf(x) || isnan(x)) { return NaN; }\n    if (x == 1.0) { return dcg_PI/2.0; }\n    if (x == -1.0) { return -dcg_PI/2.0; }\n    if (x > 1.0 || x < -1.0) return NaN;\n    float y0 = asin(x);\n    return y0 + (x - sin(y0)) / cos(y0);`),arccos:Vo(le`if (isinf(x) || isnan(x)) { return NaN; }\n    if (x == 1.0) { return 0.0; }\n    if (x == -1.0) { return dcg_PI; }\n    if (x > 1.0 || x < -1.0) return NaN;\n    float y0 = acos(x);\n    return y0 + (cos(y0) - x) / sin(y0);`),arctan:my(le`isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) ?\n        (y > 0.0 ? 0.25 : 0.75) * sign(x) * dcg_PI\n      : x == 0.0 && y == 0.0 ? y\n      : atan(x, y)\n    `),arccot:Bn(\"isnan(x) ? NaN : dcg_PI/2.0 - atan(x)\"),arcsec:Bn(\"isnan(x) ? NaN : dcg_arccos(1.0/x)\"),arccsc:Bn(\"isnan(x) ? NaN : dcg_arcsin(1.0/x)\"),sinh:Bn(\"isinf(x) ? x : isnan(x) ? NaN : sinh(x)\"),cosh:Bn(\"isinf(x) ? Infinity : isnan(x) ? NaN : cosh(x)\"),tanh:Bn(\"abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : tanh(x)\"),coth:Bn(\"abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x + x/3.0 : 1.0/tanh(x)\"),sech:Bn(\"isinf(x) ? 0.0 : isnan(x) ? NaN : 1.0/cosh(x)\"),csch:Bn(\"isinf(x) ? 0.0 : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x - x/6.0 : 1.0/sinh(x)\"),arcsinh:Vo(le`float a=abs(x);\n      return isnan(x) ? NaN : sign(x) * (\n        1.0 + x * x == 1.0\n          ? dcg_log1p(a)\n          : log(a + dcg_rtxsqpone(a))\n      );`),arccosh:Bn(\"x < 1.0 || isnan(x) ? NaN : log(x + dcg_rtxsqmone(x))\"),arctanh:Vo(le`if (isnan(x) || abs(x) > 1.0) { return NaN; }\n      if (x == 1.0) { return Infinity; }\n      if (x == -1.0) { return -Infinity; }\n      float y0 = 0.5*(dcg_log1p(x) - dcg_log1p(-x));\n      float c = cosh(y0);\n      return y0 + (x - tanh(y0)) * c * c;`),arccoth:Bn(\"isnan(x) ? NaN : abs(x) >= 1.0 ? dcg_arctanh(1.0/x) : NaN\"),arcsech:Bn(\"isnan(x) ? NaN : 0.0 < x && x <= 1.0 ? dcg_arccosh(1.0/x) : x == 0.0 ? Infinity : NaN\"),arccsch:Bn(\"isinf(x) ? 0.0 : isnan(x) ? NaN : dcg_arcsinh(1.0/x)\"),sinpiSeries:Vo(le`float xsq = x*x;\n    return x*(dcg_PI-xsq*(5.167708-xsq*(2.549761-xsq*0.5890122)));`),sinpi:Vo(le`if (isnan(x) || isinf(x)) { return NaN; }\n    if (x==0.0) { return x; }\n    if (x == floor(x)) { return x > 0.0 ? 0.0 : -0.0; }\n    int i = int(dcg_round(2.0*x));\n    float t = -0.5 * float(i) + x;\n    float s = bool(i & 2) ? -1.0 : 1.0;\n    float y = bool(i & 1) ? cos(dcg_PI * t) : dcg_sinpiSeries(t);\n    return s*y;`),sincpi:Bn(\"isnan(x) ? NaN : isinf(x) ? 0.0 : x == 0.0 ? 1.0 : dcg_sinpi(x)/(dcg_PI*x);\"),sqrt:Bn(\"isnan(x) ? NaN : x >= 0.0 ? sqrt(x) : NaN\"),rtxsqpone:Bn(\"dcg_hypot(x, 1.0)\"),rtxsqmone:Vo(\"float t = x*x; return isnan(x) || t < 1.0 ? NaN : t - 1.0 == t ? abs(x) : sqrt(t - 1.0);\"),hypot:x_(le`if (isnan(x) || isnan(y)) return NaN;\n      if (isinf(x) || isinf(y)) return Infinity;\n      x = abs(x);\n      y = abs(y);\n      float m = max(x,y);\n      x /= m;\n      y /= m;\n      return m == 0.0 ? 0.0 : sqrt(x*x + y*y) * m;`),min:my(le`isnan(x) || isnan(y) ? NaN : min(x, y)`),max:my(le`isnan(x) || isnan(y) ? NaN : max(x, y)`),log:Bn(\"isnan(x) ? NaN : x > 0.0 ? log(x)*0.4342944819 : x == 0.0 ? -Infinity : NaN\"),logbase:my(le`isnan(x) || isnan(y) ? NaN\n      : y == 1.0 ?\n        (\n          x > 1.0 ? Infinity\n          : x == 1.0 ? NaN\n          : x < 0.0 ? NaN\n          : -Infinity\n        )\n      : y > 0.0 ?\n        (\n          x > 0.0 ? log(x)/log(y)\n          : x == 0.0 && !isinf(y) ? -Infinity\n          : NaN\n        )\n      : NaN`),ln:Bn(\"isnan(x) ? NaN : x > 0.0 ? log(x) : x == 0.0 ? -Infinity : NaN\"),exp:Bn(\"isnan(x) ? NaN : exp(x)\"),floor:Bn(\"isnan(x) ? NaN : floor(x)\"),ceil:Bn(\"isnan(x) ? NaN : ceil(x)\"),round:Bn(\"isinf(x) || isnan(x) ? x : floor(0.5 + x)\"),abs:Bn(\"isnan(x) ? NaN : abs(x)\"),sign:Bn(\"isnan(x) ? NaN : sign(x)\"),mod:my(\"isinf(x) || isinf(y) || isnan(x) || isnan(y) || y == 0.0 ? NaN : mod(x, y)\"),stirlingPrefactor:Br(\"float\",\"float x, float y\",le`if (isnan(x) || isnan(y)) { return NaN; }\n    return pow(x/exp(1.0), y);`),stirlerrSeries:Vo(le`float S0 = 0.083333336;\n    float S1 = 0.0027777778;\n    float S2 = 0.0007936508;\n    float nn = x*x;\n    return (S0-(S1-S2/nn)/nn)/x;`),factorialAsymptotic:Bn(\"dcg_stirlingPrefactor(x,x)*sqrt(2.0*dcg_PI*x)*exp(dcg_stirlerrSeries(x))\"),factorialMinimax:Vo(le`float n1 = 2.1618295;\n    float n2 = 1.5849807;\n    float n3 = 0.4026814;\n    float d1 = 2.2390451;\n    float d2 = 1.6824219;\n    float d3 = 0.43668285;\n\n    float n = 1.0 + x*(n1 + x*(n2 + x*n3));\n    float d = 1.0 + x*(d1 + x*(d2 + x*d3));\n    float xp1 = x+1.0;\n\n    return dcg_stirlingPrefactor(xp1,x)*sqrt(xp1)*(n/d);\n    `),factorialPositive:Bn(le`(x>33.0)?Infinity:(x>8.0)?dcg_factorialAsymptotic(x):dcg_factorialMinimax(x);`),factorial:Vo(le`if (isnan(x) || (isinf(x) && x < 0.0)) { return NaN; }\n    bool isInteger = x == floor(x);\n    if (x < 0.0) {\n      if (isInteger) return Infinity;\n      return 1.0 / (dcg_sincpi(x) * dcg_factorialPositive(-x));\n    }\n    float approx = dcg_factorialPositive(x);\n    return isInteger ? dcg_round(approx) : approx;`),distance:Br(\"float\",\"vec2 a, vec2 b\",le`\n      if (any(isnan(a)) || any(isnan(b))) return NaN;\n      vec2 d = a-b;\n      return dcg_hypot(d.x, d.y);`),distanceThreeD:Br(\"float\",\"vec3 a, vec3 b\",le`\n      if (any(isnan(a)) || any(isnan(b))) return NaN;\n      vec3 d = a-b;\n      return dcg_hypot(dcg_hypot(d.x, d.y), d.z);`),hsv:Br(\"vec3\",\"float h, float s, float v\",le`if (isnan(h) || isnan(s) || isnan(v)) {discard;}\n      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n      if (isinf(h)) h = 0.0;\n      vec3 p = abs(fract(h / 360.0 + K.xyz) * 6.0 - K.www);\n      return vec3(clamp(v, 0.0, 1.0) * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), clamp(s, 0.0, 1.0)));`),rgb:Br(\"vec3\",\"float r, float g, float b\",le`if (isnan(r) || isnan(g) || isnan(b)) {discard;}\n    return clamp(vec3(r,g,b),0.0,255.0)/255.0;`),erf:Vo(le`if (isnan(x)) return NaN;\n      float t = abs(x);\n      float n = x*x;\n      float r = -n;\n      return sign(x) * (\n        r < -750.0\n          ? 1.0\n          : t >= 0.065\n          ? 1.0 - exp(r) * (\n            t > 50000000.0\n              ? r / t\n              : t > 50.0\n              ? (r * (n * (n + 4.5) + 2.0)) / (t * (n * (n + 5.0) + 3.75))\n              : ((0.9999999999999999+t*(2.224574423459406+t*(2.444115549920689+\n                t*(1.7057986861852539+t*(0.8257463703357973+\n                  t*(0.28647031042892007+t*(0.07124513844341643+\n                    t*(0.012296749268608364+t*(0.001347817214557592+\n                      0.00007263959403471071*t))))))))\n                )/(1.0+t*(3.352953590554884+t*(5.227518529742423+\n                  t*(5.003720878235473+t*(3.266590890998987+\n                    t*(1.5255421920765353+t*(0.5185887413188858+\n                      t*(0.12747319185915415+t*(0.02185979575963238+\n                        t*(0.0023889438122503674+0.00012875032817508128*t\n                ))))))))))\n              )\n          )\n          : t*(1.1283791670955126+r*(0.37612638903183754+\n              r*(0.11283791670955126+r*(0.026866170645131252+\n                0.005223977625442188*r))))\n      );`),restriction:Br(\"bool\",\"bool x\",\"return x;\"),restrictionToBoolean:Br(\"bool\",\"bool x\",\"return x;\"),complex:Br(\"vec2\",\"float u, float v\",le`if (isnan(u) || isnan(v)) { return vec2(NaN, NaN); }\n    return vec2(u,v);`),real:Br(\"float\",\"vec2 c\",\"return c.x;\"),imag:Br(\"float\",\"vec2 c\",\"return c.y;\"),arg:Br(\"float\",\"vec2 c\",\"return dcg_arctan(c.y,c.x);\"),peelableCoerceComplexToReal:Br(\"float\",\"vec2 a\",\"return a.y == 0.0 ? a.x : NaN;\"),coerceComplexToReal:Br(\"float\",\"vec2 a\",\"return a.y == 0.0 ? a.x : NaN;\"),coerceRealToComplex:Br(\"vec2\",\"float x\",\"return isnan(x) ? vec2(NaN, NaN) : vec2(x, 0);\"),complexSqrt:ho(le`float u = z.x; float v = z.y;\n    float r = sqrt(0.5 * (abs(u) + dcg_hypot(u, v)));\n    if (r == 0.0 || isnan(v) || isinf(v)) return dcg_complex(r, v);\n    if (u > 0.0) return dcg_complex(r, 0.5 * (v / r));\n    if (v < 0.0) r = -r;\n    return dcg_complex(0.5 * (v / r), r);`),complexDivide:Br(\"vec2\",\"vec2 a, vec2 b\",le`float u1 = a.x; float v1 = a.y;\n      float u2 = b.x; float v2 = b.y;\n      if (isnan(u1) || isnan(v1) || isnan(u2) || isnan(v2)) return vec2(NaN, NaN);\n      if (isinf(u1) || isinf(v1)) return vec2(NaN, NaN);\n      if (u2 == 0.0 && v2 == 0.0) return vec2(NaN, NaN);\n      if (isinf(u2) || isinf(v2)) return vec2(0.0, 0.0);\n      if (abs(v2) <= abs(u2)) {\n        return dcg_subComplexDivide(a, b);\n      } else {\n        return dcg_conj(dcg_subComplexDivide(a.yx, b.yx));\n      }`),wirtingerEqualOrWarning:Br(\"vec2\",\"vec2 a, vec2 b\",\"return b;\"),complexLn:ho(le`float u = z.x; float v = z.y;\n      return dcg_complex(dcg_ln(dcg_hypot(u,v)), dcg_arctan(v,u));`),complexExp:ho(le`float u = z.x; float v = z.y;\n      if (isnan(u)) return vec2(NaN, NaN);\n      float r = exp(u);\n      return v == 0.0 ? vec2(r, 0.0) : dcg_complexFromPolarRounded(r, v);`),complexPow:Br(\"vec2\",\"vec2 z1, vec2 z2\",le`float u2 = z2.x; float v2 = z2.y;\n      float u1 = z1.x; float v1 = z1.y;\n      if (isnan(u1) || isnan(v1) || isnan(u2) || isnan(v2))\n        return vec2(NaN, NaN);\n      float r1 = dcg_hypot(u1, v1);\n      float theta1 = dcg_arctan(v1, u1);\n      float rOut = pow(r1, u2) * exp(-theta1 * v2);\n      float thetaOut = log(r1) * v2 + theta1 * u2;\n      if (!isinf(rOut)) {\n        return dcg_complexFromPolarRounded(rOut, thetaOut);\n      } else {\n        return dcg_complexFromPolarRounded(\n          exp(u2 * log(r1) - theta1 * v2),\n          thetaOut\n        );\n      }\n      `),complexSin:ho(le`float u = z.x; float v = z.y;\n      return dcg_complex(dcg_sin(u) * dcg_cosh(v), dcg_cos(u) * dcg_sinh(v));`),complexCos:ho(le`float u = z.x; float v = z.y;\n      return dcg_complex(dcg_cos(u) * dcg_cosh(v), -dcg_sin(u) * dcg_sinh(v));`),complexSinh:ho(le`float u = z.x; float v = z.y;\n      return dcg_complex(dcg_sinh(u) * dcg_cos(v), dcg_cosh(u) * dcg_sin(v));`),complexCosh:ho(le`float u = z.x; float v = z.y;\n      return dcg_complex(dcg_cosh(u) * dcg_cos(v), dcg_sinh(u) * dcg_sin(v));`),complexTanh:ho(le`float u = z.x; float v = z.y;\n      float tanv = dcg_tan(v); float tanhu = dcg_tanh(u);\n      if (isnan(tanv) || isnan(tanhu)) return vec2(NaN, NaN);\n      if (isinf(tanv)) return vec2(1.0 / tanhu, 0.0);\n\n      float tanv2 = tanv * tanv;\n      float secv2 = 1.0 + tanv2;\n      float sinhu = dcg_sinh(u);\n      float sinhu2 = sinhu * sinhu;\n      float tanhu2 = tanhu * tanhu;\n      return dcg_complex(\n        (secv2 * tanhu) / (1.0 + tanv2 * tanhu2),\n        tanv / (1.0 + secv2 * sinhu2)\n      );`),complexTan:ho(le`float u = z.x; float v = z.y;\n      vec2 t = dcg_complexTanh(vec2(-v, u));\n      return vec2(t.y, -t.x);`),complexSec:ho(\"return dcg_complexReciprocal(dcg_complexCos(z));\"),complexCsc:ho(\"return dcg_complexReciprocal(dcg_complexSin(z));\"),complexCot:ho(\"return dcg_complexReciprocal(dcg_complexTan(z));\"),complexSech:ho(\"return dcg_complexReciprocal(dcg_complexCosh(z));\"),complexCsch:ho(\"return dcg_complexReciprocal(dcg_complexSinh(z));\"),complexCoth:ho(\"return dcg_complexReciprocal(dcg_complexTanh(z));\"),complexLogbase:Br(\"vec2\",\"vec2 z, vec2 base\",le`\n      float u = z.x; float v = z.y;\n      float bu = base.x; float bv = base.y;\n      if (any(isnan(z)) || any(isnan(base))) return vec2(NaN, NaN);\n      if (bv == 0.0 && bu == 0.0) return vec2(NaN, NaN);\n      if (u == 0.0 && v == 0.0) return vec2(-Infinity, 0);${\"\"}\n      return dcg_complexDivide(dcg_complexLn(z), dcg_complexLn(base));`),complexLog:ho(\"return dcg_complexLogbase(z, vec2(10.0,0.0));\")});function Br(e,t,n){return{type:\"scalar\",value:`${e} dcg_[[name_here]](${t}){ ${n} }`}}function Vo(e){return Br(\"float\",\"float x\",e)}function Bn(e){return Vo(`return ${e};`)}function x_(e){return Br(\"float\",\"float x, float y\",e)}function my(e){return x_(`return ${e};`)}function ho(e){return Br(\"vec2\",\"vec2 z\",e)}function bo(e,{inType:t,outType:n,deps:r}={}){let s=t!=null?t:i=>`float[${i}]`,o=n!=null?n:()=>\"float\";return{type:\"reducer\",value:i=>`${o(i)} dcg_[[name_here]](${s(i)} L) { ${e(i)} }`,deps:r!=null?r:[]}}function EC(e){return{type:\"double-reducer\",value:(t,n)=>{let r=Math.min(t,n),s=e(r);return`float dcg_[[name_here]](float[${t}] X, float[${n}] Y) { ${s} }`}}}var h8=SC({lcm:bo(e=>le`float g = abs(dcg_round(L[0]));\n      if (isnan(g) || isinf(g)) return NaN;\n      for (int i=1; i<${e}; i++) {\n        float v = abs(dcg_round(L[i]));\n        if (isnan(v) || isinf(v)) return NaN;\n        if (g != 0.0)\n          g *= dcg_round(v / dcg_gcd2(g, v));\n      }\n      return g;`),gcd:bo(e=>le`float g = abs(dcg_round(L[0]));\n      if (isnan(g) || isinf(g)) return NaN;\n      for (int i=1; i<${e}; i++) {\n        float x = L[i];\n        if (isnan(x) || isinf(x)) return NaN;\n        g = dcg_gcd2(g, abs(dcg_round(x)));\n      }\n      return g;`),mean:bo(e=>le`float tot = 0.0;\n      for (int i=0; i<${e}; i++) {\n        float x = L[i];\n        if (isnan(x) || (isinf(x) && x == -tot)) return NaN;\n        tot += x;\n      }\n      return tot / ${e}.0;`),total:bo(e=>le`float tot = 0.0;\n      for (int i=0; i<${e}; i++) {\n        float x = L[i];\n        if (isnan(x) || (isinf(x) && x == -tot)) return NaN;\n        tot += x;\n      }\n      return tot;`),stdev:bo(e=>f_(e,e-1),{deps:[\"mean\"]}),stdevp:bo(e=>f_(e,e),{deps:[\"mean\"]}),mad:bo(e=>le`float mean = dcg_mean(L);\n      if (isnan(mean) || isinf(mean)) return NaN;\n      float tot = 0.0;\n      for (int i=0; i<${e}; i++) {\n        tot += abs(L[i] - mean);\n      }\n      return tot / ${e}.0;`,{deps:[\"mean\"]}),listMin:bo(e=>y_(e,\"min\")),listMax:bo(e=>y_(e,\"max\")),argmin:bo(e=>g_(e,\"<\")),argmax:bo(e=>g_(e,\">=\")),median:bo(e=>e%2===1?`return L[int(dcg_sortPerm(L)[${(e-1)/2}])];`:le`float[${e}] perm = dcg_sortPerm(L);\n          return 0.5*(L[int(perm[${e/2}])]+L[int(perm[${e/2-1}])]);`,{deps:[\"sortPerm\"]}),varp:bo(e=>d_(e,e),{deps:[\"mean\"]}),var:bo(e=>d_(e,e-1),{deps:[\"mean\"]}),sortPerm:bo(e=>{if(e>100)throw Bl();return le`float[${e}] permFloat;\n        float lastMin = -Infinity;\n        int lastIndex = -1;\n        for (int i=0; i<${e}; i++) {\n          float currMin = NaN;\n          int currIndex = ${e};\n          int j;\n          for (j=0; j<${e}; j++) {\n            float e = L[j];\n            float cmpLast = dcg_compareAscendingNaNLast(e, lastMin);\n            float cmpCurr = dcg_compareAscendingNaNLast(currMin, e);\n            if (\n              (cmpLast > 0.0 || (cmpLast == 0.0 && j > lastIndex))\n              && (cmpCurr > 0.0 || (cmpCurr == 0.0 && j < currIndex))\n            ) {\n              currMin = e;\n              currIndex = j;\n            }\n          }\n          permFloat[i] = float(currIndex);\n          lastMin = currMin;\n          lastIndex = currIndex;\n        }\n        return permFloat;`},{outType:e=>`float[${e}]`}),complexSortPerm:bo(e=>{if(e>100)throw Bl();return le`float[${e}] permFloat;\n      vec2 lastMin = vec2(-Infinity,-Infinity);\n      int lastIndex = -1;\n      for (int i=0; i<${e}; i++) {\n        vec2 currMin = vec2(NaN,NaN);\n        int currIndex = ${e};\n        int j;\n        for (j=0; j<${e}; j++) {\n          vec2 e = L[j];\n          float cmpLast = dcg_compareComplexLexicographic(e, lastMin);\n          float cmpCurr = dcg_compareComplexLexicographic(currMin, e);\n          if (\n            (cmpLast > 0.0 || (cmpLast == 0.0 && j > lastIndex))\n            && (cmpCurr > 0.0 || (cmpCurr == 0.0 && j < currIndex))\n          ) {\n            currMin = e;\n            currIndex = j;\n          }\n        }\n        permFloat[i] = float(currIndex);\n        lastMin = currMin;\n        lastIndex = currIndex;\n      }\n      return permFloat;`},{inType:e=>`vec2[${e}]`,outType:e=>`float[${e}]`})});function d_(e,t){return t===0?\"return NaN;\":le`float mean = dcg_mean(L);\n    if (isnan(mean) || isinf(mean)) return NaN;\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float delta = L[i] - mean;\n      tot += delta * delta;\n    }\n    return tot / ${t}.0;`}function f_(e,t){return t===0?\"return NaN;\":le`float mean = dcg_mean(L);\n    if (isnan(mean) || isinf(mean)) return NaN;\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      tot = dcg_hypot(tot, L[i] - mean);\n    }\n    return tot / ${MC(Math.sqrt(t))};`}function y_(e,t){return le`float m = L[0];\n    if (isnan(m)) return NaN;\n    for (int i=1; i<${e}; i++) {\n      float x = L[i];\n      if (isnan(x)) return NaN;\n      m = ${t}(m, x);\n    }\n    return m;`}function g_(e,t){return le`if (isnan(L[0])) return 0.0;\n    int arg = 0;\n    float best = L[0];\n    for (int i=1; i<${e}; i++) {\n      float e = L[i];\n      if (isnan(e)) return 0.0;\n      if (e ${t} best) {\n        arg = i;\n        best = e;\n      }\n    }\n    return float(arg + 1);`}var b8=SC({cov:EC(e=>h_(e,e-1)),covp:EC(e=>h_(e,e)),corr:EC(e=>le`${T_(e)}\n      float t1 = 0.0;\n      float t2 = 0.0;\n      float tc = 0.0;\n      for (int i=0; i<${e}; i++) {\n        float d1 = X[i] - m1;\n        float d2 = Y[i] - m2;\n        t1 = dcg_hypot(t1, d1);\n        t2 = dcg_hypot(t2, d2);\n        tc += d1 * d2;\n      }\n      return tc / (t1 * t2);`)}),x8={type:\"elementsAt\",value:(e,t)=>`${e}[${t}] dcg_elementsAt(${e}[${t}] X, float[${t}] Y) {\n      ${e}[${t}] outList;\n      for (int i=0; i<${t}; i++) {\n        outList[i] = X[int(Y[i])];\n      }\n      return outList;\n    }`},T8={...b_,...h8,...b8,elementsAt:x8},ox=T8;function I8(e,t){switch(e.type){case\"scalar\":return e.value.replace(\"[[name_here]]\",t);case\"reducer\":{let n=e.value;return r=>n(r).replace(\"[[name_here]]\",t)}case\"double-reducer\":{let n=e.value;return(r,s)=>n(r,s).replace(\"[[name_here]]\",t)}default:return e.value}}function SC(e){for(let[t,n]of Object.entries(e))n.type!==\"omitted\"&&(n.value=I8(n,t));return e}function h_(e,t){return le`${T_(e)}\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      tot += (X[i] - m1) * (Y[i] - m2);\n    }\n    return tot / ${t}.0;`}function T_(e){return le`float m1 = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float x = X[i];\n      if (isnan(x) || isinf(x)) return NaN;\n      m1 += x;\n    }\n    m1 /= ${e}.0;\n    float m2 = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float y = Y[i];\n      if (isnan(y) || isinf(y)) return NaN;\n      m2 += y;\n    }\n    m2 /= ${e}.0;`}var P8=[le`float dcg_rawpow(float x, float y) {\n    if (isnan(x) || isnan(y)) return NaN;\n    if (y==0.0) return 1.0;\n    if (isinf(y)) {${\"\"}\n      float a = abs(x);\n      if (a == 1.0) return NaN;\n      if (y > 0.0) {\n        return a > 1.0 ? Infinity : 0.0;\n      } else {\n        return a < 1.0 ? Infinity : 0.0;\n      }\n    }\n    if (x > 0.0) return pow(x, y);\n    else if (x == 0.0) {\n      if (y > 0.0) return 0.0;\n      else if (y == 0.0) return 1.0;\n      else return Infinity;\n    } else {\n      float m = mod(y, 2.0);\n      if (m == 1.0) return -pow(-x, y);\n      else return pow(-x, y);\n    }\n  }`,le`float dcg_pow(float x, float y) {\n    if (isnan(x) || isnan(y)) return NaN;\n    if (y==0.0) return 1.0;\n    if (isinf(y)) {\n      float a = abs(x);\n      if (a == 1.0) return NaN;\n      if (y > 0.0) {\n        return a > 1.0 ? Infinity : 0.0;\n      } else {\n        return a < 1.0 ? Infinity : 0.0;\n      }\n    }\n    if (x > 0.0) return pow(x,y);\n    else if (x == 0.0) {\n      if (y > 0.0) return 0.0;\n      if (y == 0.0) return 1.0;\n      if (y < 0.0) return Infinity;\n    } else {\n      float m = mod(y, 2.0);\n      if (m == 0.0) return pow(-x, y);\n      else if (m == 1.0) return -pow(-x, y);\n      else {${\"\"}\n        vec2 a0 = vec2(0.0, 1.0);\n        vec2 a1 = vec2(1.0, 0.0);\n        float approx = y;\n        for (int i=0; i<12; i+=1) {\n          float whole = floor(approx);\n          vec2 a = whole * a1 + a0;\n          if (a.y > 100.0) break;\n          a0 = a1; a1 = a;\n          if (approx == whole) break;\n          approx = 1.0 / (approx - whole);\n        }${\"\"}\n        float r = a1.x / a1.y;\n        float m = max(max(abs(y), abs(r)), 1.0);\n        if (abs(mod(a1.y, 2.0) - 1.0) < 0.01 && abs((r - y)/y) < 0.00001) {\n          return (mod(a1.x, 2.0) == 0.0 ? 1.0 : -1.0) * pow(-x, y);\n        } else {\n          return NaN;\n        }\n      }\n    }\n  }`,le`float dcg_add(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) && x != y ? NaN\n      : x + y;\n  }`,le`float dcg_sub(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) && x != -y ? NaN\n      : x - y;\n  }`,le`float dcg_mul(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && y == 0.0 ? NaN\n      : x == 0.0 && isinf(y) ? NaN\n      : x * y;\n  }`,le`float dcg_div(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) ? NaN\n      : x == 0.0 && y == 0.0 ? NaN\n      : x / y;\n  }`,le`float dcg_neg(float x) {\n    return isnan(x) ? NaN : -x;\n  }`,le`float dcg_square(float x) {\n    return x*x;\n  }`,le`bool dcg_equal(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x == y;\n  }`,le`bool dcg_less(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x < y;\n  }`,le`bool dcg_lessEqual(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x <= y;\n  }`,le`bool dcg_greater(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x > y;\n  }`,le`bool dcg_greaterEqual(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x >= y;\n  }`,le`float dcg_gcd2(float u, float v) {\n    for (int i=0; i<95; i++) {\n      if (v == 0.0) break;\n      u = mod(u, v);\n      if (u == 0.0) break;\n      v = mod(v, u);\n    }\n    return u+v;\n  }`,le`float dcg_log1p(float x) {\n    return x - 0.5 * x * x == x ? x : log(1.0 + x);\n  }`,le`bool dcg_isPiMultiple(float absx) {\n    if (absx > 1.0e5) return false;\n    return floor(0.5 + dcg_PI_INV * absx) * dcg_PI == absx;\n  }`,le`bool dcg_isOddHalfPiMultiple(float absx) {\n    if (absx > 1.0e5) return false;\n    float n = floor(0.5 + 2.0 * dcg_PI_INV * absx);\n    return mod(n, 2.0) == 1.0 && n * dcg_PI == 2.0 * absx;\n  }`,\"vec2 dcg_conj(vec2 a) { return vec2(a.x, -a.y); }\",le`vec2 dcg_subComplexDivide(vec2 a, vec2 b) {\n    float u1 = a.x; float v1 = a.y;\n    float u2 = b.x; float v2 = b.y;\n    float r = v2 / u2;\n    float t = 1.0 / (u2 + v2 * r);\n    if (r == 0.0) {\n      return dcg_complex((u1 + v2 * (v1 / u2)) * t, (v1 - v2 * (u1 / u2)) * t);\n    } else {\n      return dcg_complex((u1 + v1 * r) * t, (v1 - u1 * r) * t);\n    }\n  }`,le`vec2 dcg_complexFromPolarRounded(float r, float theta) {\n    if (isnan(r) || isnan(theta)) return vec2(NaN, NaN);\n    if (r == 0.0) return vec2(0.0, 0.0);\n    return dcg_complex(r * dcg_cos(theta), r * dcg_sin(theta));\n  }`,le`vec2 dcg_complexReciprocal(vec2 z) {\n    return dcg_complexDivide(vec2(1.0,0.0), z);\n  }`,le`float dcg_compareAscendingNaNLast(float x, float y) {\n    float diff = dcg_sub(x,y);\n    return !isnan(diff) ? diff : float(isnan(x)) - float(isnan(y));\n  }`,le`float dcg_compareComplexLexicographic(vec2 x, vec2 y) {\n    float realComparison = dcg_compareAscendingNaNLast(x.x, y.x);\n    return realComparison != 0.0 ? realComparison : dcg_compareAscendingNaNLast(x.y, y.y);\n  }`].join(`\n`),E8=`\n  float dcg_round(float x);\n  float dcg_hypot(float x, float y);\n  float dcg_rtxsqpone(float x);\n  float dcg_rtxsqmone(float x);\n  float dcg_cos(float x);\n  float dcg_sin(float x);\n  float dcg_tan(float x);\n  float dcg_tanh(float x);\n  vec2 dcg_complex(float u, float v);\n  vec2 dcg_complexDivide(vec2 a, vec2 b);\n`,S8=Object.values(b_).map(e=>e.value).join(`\n`),Ure=le`uniform float NaN;\n    uniform float Infinity;\n    #define dcg_PI 3.141592653589793\n    #define dcg_PI_INV 0.3183098861837907\n    ${E8}\\n\n    ${P8}\\n\n    ${S8}`;function le(e,...t){let n=e[0];for(let r=0;r<t.length;r++)n+=t[r],n+=e[r+1];return M8(n)}function M8(e){let t=e.split(`\n`);if(/^\\s/.test(t[0][0]))throw new Error(\"Programming error: Expected un-indented first line\");if(t.length<=1)return e;let n=Math.min(...t.slice(1).map(r=>r.match(/^\\s*/)[0].length));return t[0]+`\n`+t.slice(1).map(r=>r.slice(n)).join(`\n`)}function Qo(e,t){let n=new CC(e,t),r=Rb(n);return n.finish(r)}var CC=class extends Hm{constructor(n,r){super(n,!0);this.maxUniforms=r;this.glsl=!0;this.shaderUniforms=[];this.definitions={}}finish(n){return{source:n,shaderFunctions:C8(this.chunk,this.definitions),shaderUniforms:this.shaderUniforms}}printValue(n){let{value:r,valueType:s}=n;if(Array.isArray(r)){if(r.length>100)throw Bl();let o=$(s),i=Zn(s),a=r.map(p=>this.printValue({value:p,valueType:i})).join(\",\"),u=dy(s),c=I_({type:u,arity:r.length});return this.definitions[c]=!0,(o?\"buildList\":u)+\"(\"+a+\")\"}switch(typeof r){case\"boolean\":return r.toString();case\"number\":return this.printFloatOrUniformGLSL(r);case\"string\":throw Yp(\"random\");case\"object\":if(s===it)throw new Error(\"Action values cannot be compiled\");return this.printFloatOrUniformGLSL(w(r));default:throw new Error(`Unexpected value: ${r}`)}}printFloatOrUniformGLSL(n){if(this.shaderUniforms.length>=this.maxUniforms)return MC(n);{let s=\"_DCG_SC_\"+this.shaderUniforms.length;return this.shaderUniforms.push(n),s}}beforeBeginLoop(n){let r=this.chunk.getInstruction(n.args[0]),s=this.chunk.getInstruction(n.args[1]),o=n.callData.type===\"sum\";if(r.type!==1){let u=Ms(this.chunk,n.args[0]);throw o?Jg(u):Qg(u)}if(s.type!==1){let u=Ms(this.chunk,n.args[1]);throw o?Jg(u):Qg(u)}if(r.valueType!==b||s.valueType!==b)throw new Error(\"Programming error: non-number in summation bounds\");let i=w(r.value),a=w(s.value);if(!isFinite(a-i)||a-i>=1e3)throw o?WP():jP()}checkFiniteBounds(){return\"\"}emitConstant(n){return this.printValue(n)}emitNeg(n){return`dcg_neg(${n})`}emitSquare(n){return`dcg_square(${n})`}emitTernary(n,r,s,o){return $(o.valueType)?`dcg_ternary(${n},${r},${s})`:`${n}?${r}:${s}`}emitVec2(n,r){return`vec2(${n},${r})`}emitVec3(n,r,s){return`vec3(${n},${r},${s})`}emitVec(...n){throw new Error(\"Unimplemented\")}emitVecAccess(n,r){return`${n}.${r===0?\"x\":r===1?\"y\":\"z\"}`}emitBinary(n,r,s){switch(n.type){case 8:return`dcg_add(${r},${s})`;case 9:return`dcg_sub(${r},${s})`;case 10:return`dcg_mul(${r},${s})`;case 11:return`dcg_div(${r},${s})`;case 12:return`dcg_pow(${r},${s})`;case 13:return`dcg_rawpow(${r},${s})`;case 25:return`dcg_equal(${r},${s})`;case 26:return`dcg_less(${r},${s})`;case 28:return`dcg_lessEqual(${r},${s})`;case 27:return`dcg_greater(${r},${s})`;case 29:return`dcg_greaterEqual(${r},${s})`;case 31:return`${r}||${s}`;case 32:return`${r}&&${s}`;default:throw new Error(\"Programming Error: invalid binary opcode.\")}}emitList(n,r){let s=I_({type:dy(r.valueType),arity:r.args.length});return this.definitions[s]=!0,`buildList(${n.join(\",\")})`}emitListAccess(n,r,s,o){let i=or(this.chunk,o.args[0]);if(i===void 0)throw Pc(Ms(this.chunk,o.args[0]));let a=`int(${r})`;return`(${a}>=1&&${a}<=${i})?${n}[${a}-1]:${s}`}emitInboundsListAccess(n,r){return`${n}[int(${r})-1]`}emitNativeFunction(n,r){if(!ox[r.symbol])throw Yp(r.symbol);return`dcg_${r.symbol}(${n.join(\",\")})`}emitExtendSeed(){throw Yp(\"random\")}emitVarDeclaration(n,r){let s=r?\";\":\"\";return s+=vC(this.chunk,n)+\" \"+vn(n),s}emitImmediateAssignment(n,r,s){return`${vC(this.chunk,n)} ${r}=${s};`}emitFunctionCall(){throw Yp(\"recursion\")}};function Qre(...e){return Object.keys(Object.assign({},...e)).join(`\n`)}function I_(e){let{type:t,arity:n}=e,r=t+\"[\"+n+\"]\",s=r+\" buildList(\";for(let o=0;o<n-1;o++)s+=`${t} _${o}, `;s+=`${t} _${n-1}) {\n`,s+=r+` a;\n`;for(let o=0;o<n;o++)s+=`a[${o}] = _${o};\n`;return s+=`return a;\n}\n`,s}function C8(e,t){let n=e.argNames.length,r=e.instructionsLength()-1;for(let s=n;s<=r;s++){let o=e.getInstruction(s);if(o.type===33){if($(o.valueType)){let i=vC(e,s),a=`${i} dcg_ternary(bool x, ${i} y, ${i} z) { if (x) return y; return z; }`;t[a]=!0}}else if(o.type===37){let i=ox[o.symbol];if((i==null?void 0:i.type)===\"reducer\"){let a=o.args[0],u=or(e,a);if(u===void 0)throw Pc(Ms(e,a));for(let c of i.deps)t[ox[c].value(u)]=!0;t[i.value(u)]=!0}else if((i==null?void 0:i.type)===\"double-reducer\"){let a=o.args[0],u=o.args[1],c=or(e,a),p=or(e,u);if(c===void 0)throw Pc(Ms(e,a));if(p===void 0)throw Pc(Ms(e,u));t[i.value(c,p)]=!0}else if((i==null?void 0:i.type)===\"elementsAt\"){let a=dy(Xe(o.valueType)),u=o.args[1],c=or(e,u);if(c===void 0)throw Pc(Ms(e,u));t[i.value(a,c)]=!0}}}return t}function MC(e){let t=e.toString();return/^-?\\d+$/.test(t)?t+\".0\":t}function dy(e){switch(Zn(e)){case Re:return\"bool\";case b:return\"float\";case N:case O:return\"vec2\";case pn:case F:return\"vec3\";default:throw new Error(\"Unexpected type: \"+We(e))}}function vC(e,t){let n=e.getInstruction(t);if($(n.valueType)){let r=or(e,t);if(r===void 0)throw Pc(Ms(e,t));if(r>100)throw Bl();return`${dy(n.valueType)}[${r}]`}else return dy(n.valueType)}function Kre(e){let t={},n=\"\";if(e)for(let r=0;r<e.length;r++){let s=\"_DCG_SC_\"+r;t[s]={value:e[r]},n+=\"uniform float \"+s+`;\n`}return{uniforms:t,declarations:n}}function P_(e){let t=[],n=[];for(let r=0;r<e.argNames.length;r++){let s=[],o=[];for(let i=0;i<e.argNames.length;i++)s.push(e.argTypes[i]===b),o.push(r===i);n.push(o),t.push(s)}for(let r=e.argNames.length;r<=e.getReturnIndex();r++)n.push(v8(e,n,r)),t.push(D8(e,n,t,r));return t[e.getReturnIndex()]}function v8(e,t,n){let r=e.getInstruction(n),s=R8(e.argNames.length);if(!ce(r))return s;for(let o of r.args){let i=t[o];for(let a=0;a<i.length;a++)s[a]=s[a]||i[a]}return s}function D8(e,t,n,r){let s=e.getInstruction(r);if(!ce(s))return DC(e.argNames.length);switch(s.type){case 8:case 9:case 14:case 15:case 16:case 38:{let i=DC(e.argNames.length);for(let a=0;a<s.args.length;a++){let u=n[s.args[a]];for(let c=0;c<u.length;c++)i[c]=i[c]&&u[c]}return i}case 11:{let i=[],a=n[s.args[0]],u=t[s.args[1]];for(let c=0;c<a.length;c++)i.push(a[c]&&!u[c]);return i}case 10:{let i=n[s.args[0]].slice(),a=n[s.args[1]].slice(),u=t[s.args[0]],c=t[s.args[1]],p=0,l=0;for(let m=0;m<i.length;m++){let d=i[m]&&!c[m],y=a[m]&&!u[m];i[m]=d,a[m]=y,d&&(p+=1),y&&(l+=1)}return p>=l?i:a}case 33:{let i=t[s.args[0]],a=n[s.args[1]],u=n[s.args[2]],c=[];for(let p=0;p<i.length;p++)c.push(!i[p]&&a[p]&&u[p]);return c}case 39:case 40:case 41:{let i=n[s.args[0]],a=t[s.args[1]],u=[];for(let c=0;c<a.length;c++)u.push(i[c]&&!a[c]);return u}case 48:{let i=s.args[0],a=e.getInstruction(i),u=r-i;return n[a.args[u]]}case 37:return N8(e,s,t,n,r);case 56:case 12:case 13:case 26:case 28:case 27:case 29:case 25:case 32:case 31:case 42:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 44:case 49:case 50:case 51:case 53:case 54:case 55:{let i=t[r],a=[];for(let u of i)a.push(!u);return a}default:let o=s;throw new Error(`Unexpected opcode ${o.type}`)}}function N8(e,t,n,r,s){switch(t.symbol){case\"complex\":{let o=DC(e.argNames.length);for(let i=0;i<t.args.length;i++){let a=r[t.args[i]];for(let u=0;u<a.length;u++)o[u]=o[u]&&a[u]}return o}default:{let o=n[s],i=[];for(let a of o)i.push(!a);return i}}}function R8(e){let t=[];for(let n=0;n<e;n++)t.push(!1);return t}function DC(e){let t=[];for(let n=0;n<e;n++)t.push(!0);return t}function wn(e,t,n){switch(t){case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 56:case 21:case 19:case 23:case 50:return b;case 25:case 26:case 27:case 28:case 29:case 31:case 32:return Re;case 33:{let s=e.getInstruction(n[1]).valueType,o=e.getInstruction(n[2]).valueType,i=Yu(s,o);return i===void 0?s:i}case 38:return ed(n.map(s=>e.getInstruction(s).valueType));case 39:case 40:case 41:{let s=e.getInstruction(n[0]).valueType;return $(s)?Xe(s):Pn}case 44:return Pt;case 49:return it;case 55:return e.getInstruction(n[0]).valueType;case 1:case 2:case 37:case 42:case 47:case 48:case 3:case 0:case 24:case 22:case 20:case 51:case 4:case 53:case 54:case 15:case 16:return Pn;default:let r=t;throw new Error(`Unexpected opcode ${r}`)}}function E_(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error(\"Programming Error: only the final instruction in a chunk can be lifted to numbers\");let t=e.getInstruction(e.getReturnIndex());if(!ce(t))return e.getReturnIndex();switch(t.type){case 8:let[n,r]=t.args;return Ir(e,n)&&Ir(e,r)?(e.popInstruction(),e.NativeFunction(\"complex\",[e.Add([e.Slot(0,[n]),e.Slot(0,[r])]),e.Add([e.Slot(1,[n]),e.Slot(1,[r])])])):Ir(e,n)&&ms(e,r)?(e.popInstruction(),e.NativeFunction(\"complex\",[e.Add([e.Slot(0,[n]),r]),e.Slot(1,[n])])):ms(e,n)&&Ir(e,r)?(e.popInstruction(),e.NativeFunction(\"complex\",[e.Add([n,e.Slot(0,[r])]),e.Slot(1,[r])])):jc(e,n)&&jc(e,r)?(e.popInstruction(),e.TupleOfType(N,[e.Add([e.Slot(0,[n]),e.Slot(0,[r])]),e.Add([e.Slot(1,[n]),e.Slot(1,[r])])])):Jc(e,n)&&Jc(e,r)?(e.popInstruction(),e.TupleOfType(F,[e.Add([e.Slot(0,[n]),e.Slot(0,[r])]),e.Add([e.Slot(1,[n]),e.Slot(1,[r])]),e.Add([e.Slot(2,[n]),e.Slot(2,[r])])])):sc(e,t.args)?(e.popInstruction(),Qc(e,[e.Add([ks(e,n),ks(e,r)]),ka(e,t.args[0])])):e.getReturnIndex();case 9:{let[o,i]=t.args;return Ir(e,o)&&Ir(e,i)?(e.popInstruction(),e.NativeFunction(\"complex\",[e.Subtract([e.Slot(0,[o]),e.Slot(0,[i])]),e.Subtract([e.Slot(1,[o]),e.Slot(1,[i])])])):Ir(e,o)&&ms(e,i)?(e.popInstruction(),e.NativeFunction(\"complex\",[e.Subtract([e.Slot(0,[o]),i]),e.Slot(1,[o])])):ms(e,o)&&Ir(e,i)?(e.popInstruction(),e.NativeFunction(\"complex\",[e.Subtract([o,e.Slot(0,[i])]),e.Negative([e.Slot(1,[i])])])):jc(e,o)&&jc(e,i)?(e.popInstruction(),e.TupleOfType(N,[e.Subtract([e.Slot(0,[o]),e.Slot(0,[i])]),e.Subtract([e.Slot(1,[o]),e.Slot(1,[i])])])):Jc(e,o)&&Jc(e,i)?(e.popInstruction(),e.TupleOfType(F,[e.Subtract([e.Slot(0,[o]),e.Slot(0,[i])]),e.Subtract([e.Slot(1,[o]),e.Slot(1,[i])]),e.Subtract([e.Slot(2,[o]),e.Slot(2,[i])])])):sc(e,t.args)?(e.popInstruction(),Qc(e,[e.Subtract([ks(e,o),ks(e,i)]),ka(e,o)])):e.getReturnIndex()}case 14:{let[o]=t.args;return Ir(e,o)?(e.popInstruction(),e.NativeFunction(\"complex\",[e.Negative([e.Slot(0,[o])]),e.Negative([e.Slot(1,[o])])])):jc(e,o)?(e.popInstruction(),e.TupleOfType(N,[e.Negative([e.Slot(0,[o])]),e.Negative([e.Slot(1,[o])])])):Jc(e,o)?(e.popInstruction(),e.TupleOfType(F,[e.Negative([e.Slot(0,[o])]),e.Negative([e.Slot(1,[o])]),e.Negative([e.Slot(2,[o])])])):sc(e,t.args)?(e.popInstruction(),Qc(e,[e.Negative([ks(e,o)]),ka(e,o)])):e.getReturnIndex()}case 10:{let[o,i]=t.args;if(Ir(e,o)&&Ir(e,i)){e.popInstruction();let a=e.Slot(0,[o]),u=e.Slot(1,[o]),c=e.Slot(0,[i]),p=e.Slot(1,[i]);return e.NativeFunction(\"complex\",[e.Subtract([e.Multiply([a,c]),e.Multiply([u,p])]),e.Add([e.Multiply([a,p]),e.Multiply([c,u])])])}else{if(Ir(e,o)&&ms(e,i))return e.popInstruction(),e.NativeFunction(\"complex\",[e.Multiply([e.Slot(0,[o]),i]),e.Multiply([e.Slot(1,[o]),i])]);if(ms(e,o)&&Ir(e,i))return e.popInstruction(),e.NativeFunction(\"complex\",[e.Multiply([o,e.Slot(0,[i])]),e.Multiply([o,e.Slot(1,[i])])]);if(fy(e,o)&&fy(e,i))return e.popInstruction(),e.NativeFunction(\"restriction\",[e.And([e.NativeFunction(\"restrictionToBoolean\",[o]),e.NativeFunction(\"restrictionToBoolean\",[i])])]);if(fy(e,o)||fy(e,i)){let a,u;fy(e,o)?(a=o,u=i):(a=i,u=o);let c=e.getInstruction(u).valueType;return Yi(c)?(e.popInstruction(),e.Piecewise([e.NativeFunction(\"restrictionToBoolean\",[a]),u,e.NanOfType(c)])):e.getReturnIndex()}else return jc(e,o)&&ms(e,i)?(e.popInstruction(),e.TupleOfType(N,[e.Multiply([e.Slot(0,[o]),i]),e.Multiply([e.Slot(1,[o]),i])])):ms(e,o)&&jc(e,i)?(e.popInstruction(),e.TupleOfType(N,[e.Multiply([o,e.Slot(0,[i])]),e.Multiply([o,e.Slot(1,[i])])])):sc(e,[o])&&ms(e,i)?(e.popInstruction(),Qc(e,[e.Multiply([ks(e,o),i]),ka(e,o)])):ms(e,o)&&sc(e,[i])?(e.popInstruction(),Qc(e,[e.Multiply([o,ks(e,i)]),ka(e,i)])):Jc(e,o)&&ms(e,i)?(e.popInstruction(),e.TupleOfType(F,[e.Multiply([e.Slot(0,[o]),i]),e.Multiply([e.Slot(1,[o]),i]),e.Multiply([e.Slot(2,[o]),i])])):ms(e,o)&&Jc(e,i)?(e.popInstruction(),e.TupleOfType(F,[e.Multiply([o,e.Slot(0,[i])]),e.Multiply([o,e.Slot(1,[i])]),e.Multiply([o,e.Slot(2,[i])])])):e.getReturnIndex()}}case 11:{let[o,i]=t.args;return Ir(e,o)&&Ir(e,i)?(e.popInstruction(),e.NativeFunction(\"complexDivide\",[o,i])):Ir(e,o)&&ms(e,i)?(e.popInstruction(),e.NativeFunction(\"complex\",[e.Divide([e.Slot(0,[o]),i]),e.Divide([e.Slot(1,[o]),i])])):ms(e,o)&&Ir(e,i)?(e.popInstruction(),e.NativeFunction(\"complexDivide\",[e.NativeFunction(\"complex\",[o,e.Constant(0)]),i])):jc(e,o)&&ms(e,i)?(e.popInstruction(),e.TupleOfType(N,[e.Divide([e.Slot(0,[o]),i]),e.Divide([e.Slot(1,[o]),i])])):sc(e,[o])&&ms(e,i)?(e.popInstruction(),Qc(e,[e.Divide([ks(e,o),i]),ka(e,o)])):Jc(e,o)&&ms(e,i)?(e.popInstruction(),e.TupleOfType(F,[e.Divide([e.Slot(0,[o]),i]),e.Divide([e.Slot(1,[o]),i]),e.Divide([e.Slot(2,[o]),i])])):e.getReturnIndex()}case 25:{let[o,i]=t.args;if(Ir(e,o)&&Ir(e,i)){e.popInstruction();let a=e.Slot(0,[o]),u=e.Slot(0,[i]),c=e.Slot(1,[o]),p=e.Slot(1,[i]);return e.And([e.Equal([a,u]),e.Equal([c,p])])}else if(ms(e,o)&&Ir(e,i)){e.popInstruction();let a=o,u=e.Slot(0,[i]),c=e.Constant(0),p=e.Slot(1,[i]);return e.And([e.Equal([a,u]),e.Equal([c,p])])}else if(Ir(e,o)&&ms(e,i)){e.popInstruction();let a=e.Slot(0,[o]),u=i,c=e.Slot(1,[o]),p=e.Constant(0);return e.And([e.Equal([a,u]),e.Equal([c,p])])}else return e.getReturnIndex()}case 28:case 29:{let[o,i]=t.args;if(Ir(e,o)&&Ir(e,i)){e.popInstruction();let a=t.type===28?e.Less(t.args):e.Greater(t.args);return e.Or([a,e.Equal(t.args)])}else return e.getReturnIndex()}case 12:case 56:case 13:case 26:case 27:case 32:case 31:case 15:case 33:case 16:case 37:case 42:case 39:case 40:case 41:case 21:case 22:case 19:case 20:case 38:case 47:case 23:case 24:case 48:case 44:case 49:case 50:case 51:case 53:case 54:case 55:return e.getReturnIndex();default:let s=t;throw new Error(`Unexpected opcode ${s.type}`)}}function jc(e,t){return e.getInstruction(t).valueType===N}function Jc(e,t){return e.getInstruction(t).valueType===F}function ms(e,t){return e.getInstruction(t).valueType===b}function Ir(e,t){return e.getInstruction(t).valueType===O}function fy(e,t){return e.getInstruction(t).valueType===nn}function sc(e,t){return t.every(n=>ft(e,n,ye))||t.every(n=>ft(e,n,Fe))}function Qc(e,t){return Ri(e,t,\"mathVector\",yy(\"mathVector\",\"mathVectorThreeD\"))}function ka(e,t){return Ri(e,[t],\"start\",[{match:[ye],build:()=>e.NativeFunction(\"basePointFromVector\",[t])},{match:[Fe],build:()=>e.NativeFunction(\"basePointFromVectorThreeD\",[t])}])}function ks(e,t){return Ri(e,[t],\"displacement\",[{match:[ye],build:()=>e.NativeFunction(\"vectorDisplacementAsPoint\",[t])},{match:[Fe],build:()=>e.NativeFunction(\"vectorThreeDDisplacementAsPoint\",[t])}])}function yy(e,t){return[{match:[N,N],build:(n,r)=>n.NativeFunction(e,r)},{match:[F,F],build:(n,r)=>n.NativeFunction(t,r)}]}var _={X_OR_Y:\"X_OR_Y\",SINGLE_POINT:\"SINGLE_POINT\",POINT_LIST:\"POINT_LIST\",PARAMETRIC:\"PARAMETRIC\",POLAR:\"POLAR\",IMPLICIT:\"IMPLICIT\",POLYGON:\"POLYGON\",HISTOGRAM:\"HISTOGRAM\",DOTPLOT:\"DOTPLOT\",BOXPLOT:\"BOXPLOT\",TTEST:\"TTEST\",STATS:\"STATS\",VECTOR2D:\"VECTOR2D\",POINT3D:\"POINT3D\",POINT3D_LIST:\"POINT3D_LIST\",TRIANGLE3D:\"TRIANGLE3D\",SEGMENT3D:\"SEGMENT3D\",VECTOR3D:\"VECTOR3D\",SPHERE3D:\"SPHERE3D\",CURVE3D_xyz_t:\"CURVE3D_xyz_t\",SURFACE_xyz_uv:\"SURFACE_xyz_uv\",SURFACE_z_r\\u03B8:\"SURFACE_z_r\\u03B8\",SURFACE_r_\\u03B8z:\"SURFACE_r_\\u03B8z\",SURFACE_r_\\u03B8\\u03C6:\"SURFACE_r_\\u03B8\\u03C6\",SURFACE_r_\\u03B8z_AMBIGUOUS:\"SURFACE_r_\\u03B8z_AMBIGUOUS\",SURFACE_AMBIGUOUS:\"SURFACE_AMBIGUOUS\",SURFACE_CONSTANT_AMBIGUOUS:\"SURFACE_CONSTANT_AMBIGUOUS\",SURFACE:\"SURFACE\",IMPLICIT_SURFACE:\"IMPLICIT_SURFACE\",IMPLICIT_SURFACE_AMBIGUOUS:\"IMPLICIT_SURFACE_AMBIGUOUS\",SLICE:\"SLICE\",SLICE_r\\u03B8z_at_z:\"SLICE_r\\u03B8z_at_z\",SLICE_zr\\u03B8_at_r:\"SLICE_zr\\u03B8_at_r\",SLICE_zr\\u03B8_at_\\u03B8:\"SLICE_zr\\u03B8_at_\\u03B8\",SLICE_zr\\u03B8_at_xyz:\"SLICE_zr\\u03B8_at_xyz\",SLICE_r\\u03B8\\u03C6_at_\\u03B8:\"SLICE_r\\u03B8\\u03C6_at_\\u03B8\",SLICE_r\\u03B8\\u03C6_at_\\u03C6:\"SLICE_r\\u03B8\\u03C6_at_\\u03C6\",SLICE_r\\u03B8\\u03C6_at_xyz:\"SLICE_r\\u03B8\\u03C6_at_xyz\",SLICE_xyz_uv:\"SLICE_xyz_uv\"},O8={X_OR_Y:{points:!1,lines:!0,fill:!1},SINGLE_POINT:{points:!0,lines:!1,fill:!1},POINT_LIST:{points:!0,lines:!1,fill:!1},PARAMETRIC:{points:!1,lines:!0,fill:!1},POLAR:{points:!1,lines:!0,fill:!1},IMPLICIT:{points:!1,lines:!0,fill:!1},POLYGON:{points:!1,lines:!0,fill:!0},HISTOGRAM:{points:!1,lines:!0,fill:!0},DOTPLOT:{points:!0,lines:!1,fill:!1},BOXPLOT:{points:!1,lines:!0,fill:!1},TTEST:{points:!1,lines:!1,fill:!1},STATS:{points:!1,lines:!1,fill:!1},VECTOR2D:{points:!1,lines:!0,fill:!1},POINT3D:{points:!0,lines:!1,fill:!1},POINT3D_LIST:{points:!0,lines:!1,fill:!1},CURVE3D_xyz_t:{points:!1,lines:!0,fill:!1},SLICE:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8z_at_z:{points:!1,lines:!0,fill:!1},SLICE_zr\\u03B8_at_r:{points:!1,lines:!0,fill:!1},SLICE_zr\\u03B8_at_\\u03B8:{points:!1,lines:!0,fill:!1},SLICE_zr\\u03B8_at_xyz:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8\\u03C6_at_\\u03B8:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8\\u03C6_at_\\u03C6:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8\\u03C6_at_xyz:{points:!1,lines:!0,fill:!1},SLICE_xyz_uv:{points:!1,lines:!0,fill:!1},SEGMENT3D:{points:!1,lines:!0,fill:!1},VECTOR3D:{points:!1,lines:!0,fill:!1},SPHERE3D:{points:!1,lines:!0,fill:!1},SURFACE_xyz_uv:{points:!1,lines:!0,fill:!1},SURFACE_z_r\\u03B8:{points:!1,lines:!0,fill:!1},SURFACE_r_\\u03B8z:{points:!1,lines:!0,fill:!1},SURFACE_r_\\u03B8\\u03C6:{points:!1,lines:!0,fill:!1},SURFACE_r_\\u03B8z_AMBIGUOUS:{points:!1,lines:!0,fill:!1},SURFACE:{points:!1,lines:!0,fill:!1},TRIANGLE3D:{points:!1,lines:!0,fill:!1},SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!1},SURFACE_CONSTANT_AMBIGUOUS:{points:!1,lines:!0,fill:!1},IMPLICIT_SURFACE:{points:!1,lines:!0,fill:!1},IMPLICIT_SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!1}};function NC(e,t,n){var s,o,i,a,u,c;if(e===void 0)return{points:!1,lines:!1,fill:!1};let r=O8[e];switch(e){case _.SINGLE_POINT:return{points:!0,lines:!1,fill:!1};case _.POINT_LIST:case _.POINT3D_LIST:case _.DOTPLOT:return{points:(s=t.points)!=null?s:r.points,lines:(o=t.lines)!=null?o:r.lines,fill:!1};case _.POINT3D:return{points:(i=t.points)!=null?i:r.points,lines:!1,fill:!1};case _.PARAMETRIC:case _.POLYGON:case _.X_OR_Y:case _.VECTOR2D:case _.POLAR:case _.IMPLICIT:case _.HISTOGRAM:case _.BOXPLOT:case _.TTEST:case _.STATS:case _.CURVE3D_xyz_t:return{points:!1,lines:(a=t.lines)!=null?a:r.lines,fill:(u=t.fill)!=null?u:r.fill};case _.TRIANGLE3D:case _.SPHERE3D:case _.SURFACE:case _.SURFACE_r_\\u03B8z:case _.SURFACE_z_r\\u03B8:case _.SURFACE_r_\\u03B8\\u03C6:case _.SURFACE_xyz_uv:case _.IMPLICIT_SURFACE:case _.SURFACE_AMBIGUOUS:case _.SURFACE_CONSTANT_AMBIGUOUS:case _.SURFACE_r_\\u03B8z_AMBIGUOUS:case _.IMPLICIT_SURFACE_AMBIGUOUS:case _.SEGMENT3D:case _.VECTOR3D:case _.SLICE:case _.SLICE_r\\u03B8z_at_z:case _.SLICE_zr\\u03B8_at_r:case _.SLICE_zr\\u03B8_at_\\u03B8:case _.SLICE_zr\\u03B8_at_xyz:case _.SLICE_r\\u03B8\\u03C6_at_\\u03B8:case _.SLICE_r\\u03B8\\u03C6_at_\\u03C6:case _.SLICE_r\\u03B8\\u03C6_at_xyz:case _.SLICE_xyz_uv:return{points:!1,lines:(c=t.lines)!=null?c:r.lines,fill:!1};default:n&&n(e);let p=e;return NC(e,t)||p}}function S_(e){if(e===void 0)return!1;switch(e){case _.SINGLE_POINT:case _.POINT_LIST:case _.PARAMETRIC:case _.POLYGON:case _.X_OR_Y:case _.VECTOR2D:case _.POLAR:case _.IMPLICIT:case _.SURFACE:case _.SURFACE_AMBIGUOUS:case _.SURFACE_CONSTANT_AMBIGUOUS:case _.SURFACE_r_\\u03B8z:case _.SURFACE_r_\\u03B8z_AMBIGUOUS:case _.SURFACE_z_r\\u03B8:case _.SURFACE_r_\\u03B8\\u03C6:case _.SURFACE_xyz_uv:case _.IMPLICIT_SURFACE:case _.IMPLICIT_SURFACE_AMBIGUOUS:case _.CURVE3D_xyz_t:case _.SLICE:case _.SLICE_r\\u03B8z_at_z:case _.SLICE_zr\\u03B8_at_r:case _.SLICE_zr\\u03B8_at_\\u03B8:case _.SLICE_zr\\u03B8_at_xyz:case _.SLICE_r\\u03B8\\u03C6_at_\\u03B8:case _.SLICE_r\\u03B8\\u03C6_at_\\u03C6:case _.SLICE_r\\u03B8\\u03C6_at_xyz:case _.SLICE_xyz_uv:case _.SEGMENT3D:case _.VECTOR3D:case _.SPHERE3D:case _.POINT3D:case _.POINT3D_LIST:case _.TRIANGLE3D:return!0;case _.HISTOGRAM:case _.BOXPLOT:case _.DOTPLOT:case _.TTEST:case _.STATS:return!1;default:return e}}function M_(e){return e===_.SURFACE_r_\\u03B8\\u03C6||e===_.SLICE_r\\u03B8\\u03C6_at_\\u03B8||e===_.SLICE_r\\u03B8\\u03C6_at_\\u03C6||e===_.SLICE_r\\u03B8\\u03C6_at_xyz}function C_(e){return e===_.SURFACE_z_r\\u03B8||e===_.SLICE_zr\\u03B8_at_r||e===_.SLICE_zr\\u03B8_at_\\u03B8||e===_.SLICE_zr\\u03B8_at_xyz}function v_(e){return e===_.SURFACE_r_\\u03B8z||e===_.SURFACE_r_\\u03B8z_AMBIGUOUS||e===_.SLICE_r\\u03B8z_at_z}function Ou(e){return e>=100}function D_(e,t){switch(e){case 106:return 200;case 107:return 201;case 108:return 202;case 103:return 214;case 130:return 215;case 112:return 209;case 113:return 210;case 110:switch(t){case\"z\":return 206;case\"theta\":return 205;case\"x\":case\"y\":case\"r\":case\"_implicit\":return 211;default:return 10}case 109:switch(t){case\"r\":return 203;case\"theta\":return 204;case\"x\":case\"y\":case\"z\":case\"_implicit\":return 213;default:return 10}case 111:switch(t){case\"theta\":return 207;case\"phi\":return 208;case\"x\":case\"y\":case\"z\":case\"rho\":case\"_implicit\":return 212;default:return 10}default:return 10}}function RC(e){switch(e){case 123:case 122:case 121:case 120:case 124:case 126:case 127:return!0;default:return!1}}function Kc(e){return e===26||e===4}function lse(e){return Kc(e)||e===3||e===25}var{sin:A8,cos:_8}=Math,Ke=class e{constructor(t=0,n=0,r=0){this.x=t;this.y=n;this.z=r}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}set(t,n,r){return this.x=t,this.y=n,this.z=r,this}clone(){return new e(this.x,this.y,this.z)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}isZero(){return this.x===0&&this.y===0&&this.z===0}isFinite(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this}multiply(t){return this.x*=t,this.y*=t,this.z*=t,this}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){return this.multiply(1/this.magnitude()),this}cross(t){return this.crossVectors(this,t)}crossVectors(t,n){let r=t.x,s=t.y,o=t.z,i=n.x,a=n.y,u=n.z;return this.x=s*u-o*a,this.y=o*i-r*u,this.z=r*a-s*i,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}rotateAroundAxis(t,n){let r=w8(t,n);return new e(r[0]*this.x+r[1]*this.y+r[2]*this.z,r[3]*this.x+r[4]*this.y+r[5]*this.z,r[6]*this.x+r[7]*this.y+r[8]*this.z)}};function w8(e,t){let n=e.x,r=e.y,s=e.z,o=A8(t),i=_8(t),a=1-i;return[a*n*n+i,a*n*r+o*s,a*n*s-o*r,a*r*n-o*s,a*r*r+i,a*r*s+o*n,a*s*n+o*r,a*s*r-o*n,a*s*s+i]}function id(e,t,n,r,s,o,i){let[a,u,c]=[new Ke,new Ke,new Ke],[p,l,m]=[new Ke,new Ke,new Ke],[d,y]=[new Ke,new Ke];for(let g=0;g<e.length/3;g++){let f=e[3*g],h=e[3*g+1],x=e[3*g+2];a.set(t[3*f],t[3*f+1],t[3*f+2]),u.set(t[3*h],t[3*h+1],t[3*h+2]),c.set(t[3*x],t[3*x+1],t[3*x+2]),p.set(n[3*f],n[3*f+1],n[3*f+2]),l.set(n[3*h],n[3*h+1],n[3*h+2]),m.set(n[3*x],n[3*x+1],n[3*x+2]),d.subVectors(c,a),y.subVectors(a,u);let T=d.cross(y).normalize();if(!(p.dot(T)>i&&l.dot(T)>i&&m.dot(T)>i)||p.dot(l)<0||p.dot(m)<0||l.dot(m)<0){let M=t.length/3;e[3*g]=M,e[3*g+1]=M+1,e[3*g+2]=M+2,t.push(a.x,a.y,a.z),t.push(u.x,u.y,u.z),t.push(c.x,c.y,c.z),n.push(T.x,T.y,T.z),n.push(T.x,T.y,T.z),n.push(T.x,T.y,T.z),r.push(r[2*f],r[2*f+1]),r.push(r[2*h],r[2*h+1]),r.push(r[2*x],r[2*x+1]);let S=s;if(s>0){for(let E=0;E<S;E++)o.push(o[S*f+E]);for(let E=0;E<S;E++)o.push(o[S*h+E]);for(let E=0;E<S;E++)o.push(o[S*x+E])}}}}function ax(e){let{triangles:t,normalDirHints:n}=e.triangulate(),{extraAttrCount:r}=e,s=e.getVertexCount(),o=new Array(s),i=new Array(s*3),a=[],u=!1,c=new Array(s*3),p=new Array(s*2),l=new Array(s*r),m=[],d=0;function y(f){let h=e.getVertex(f);if(!h)return null;let x=n[f],T=x?e.hintedNormal(f,x):e.getNormal(f);T?(c[3*d]=T[0],c[3*d+1]=T[1],c[3*d+2]=T[2]):(a[d]=!0,u=!0,c[3*d]=0,c[3*d+1]=0,c[3*d+2]=0),i[3*d]=h[0],i[3*d+1]=h[1],i[3*d+2]=h[2];let P=e.getUV(f);if(p[2*d]=P[0],p[2*d+1]=P[1],r>0)for(let M=0;M<r;M++)l[r*d+M]=e.getExtraAttr(f,M);return d++}function g(f){let h=o[f];return h===void 0?o[f]=y(f):h}for(let f=0;f<t.length;f+=3){let h=t[f],x=t[f+1],T=t[f+2],P=g(h),M=g(x),S=g(T);if(P===null||M===null||S===null)continue;m.push(P,M,S);let E=a[P],v=a[M],D=a[S];if(E||v||D){let G=i,j=c,Q=new Ke(G[3*P],G[3*P+1],G[3*P+2]),W=new Ke(G[3*M],G[3*M+1],G[3*M+2]),K=new Ke(G[3*S],G[3*S+1],G[3*S+2]),J=new Ke().subVectors(K,Q),re=new Ke().subVectors(Q,W),ie=J.cross(re);if(!ie.isFinite())continue;E&&(j[3*P+0]+=ie.x,j[3*P+1]+=ie.y,j[3*P+2]+=ie.z),v&&(j[3*M+0]+=ie.x,j[3*M+1]+=ie.y,j[3*M+2]+=ie.z),D&&(j[3*S+0]+=ie.x,j[3*S+1]+=ie.y,j[3*S+2]+=ie.z)}}if(i.length=d*3,c.length=d*3,p.length=d*2,u)for(let f=0;f<d;f++){if(!a[f])continue;let h=c[3*f],x=c[3*f+1],T=c[3*f+2],P=Math.sqrt(h*h+x*x+T*T);c[3*f]=h/P,c[3*f+1]=x/P,c[3*f+2]=T/P}return id(m,i,c,p,r,l,0),{positions:i,normals:c,faces:m,uvs:p,resolved:!0,extraAttrs:l}}var _C=class{constructor({resolution:t,uRange:n,vRange:r,du:s,dv:o,extraAttrCount:i}){this.normalDirHints=[];this.isVertexAtCreaseCache=[];this.triangles=[];this.edgeVertices=new Map;this.edgeNormalVertices=new Map;this.finiteVertices=new Map;this.resolution=t,this.uRange=n,this.vRange=r,this.du=s,this.dv=o,this.extraAttrCount=i,this.duSquared=s*s,this.dvSquared=o*o}addVertex(t){return this.normalDirHints.push(void 0),this.isVertexAtCreaseCache.push(void 0),this._addVertex(t)}jumpAlongEdge(t,n){let r=0;if(t>n){let u=t;t=n,n=u,r=1}let s=n*n+t,o=this.edgeVertices.get(s);if(o===null)return;if(o!==void 0)return[o[r],o[1-r]];let i=this.findJumpBetweenTwoSamples(t,n);if(i===void 0){this.edgeVertices.set(s,null);return}let a=[this.addVertex(i[0]),this.addVertex(i[1])];return this.edgeVertices.set(s,a),[a[r],a[1-r]]}edgeNormalFeature(t,n){let r=0;if(t>n){let u=t;t=n,n=u,r=1}let s=n*n+t,o=this.edgeNormalVertices.get(s);if(o!==void 0)return this.flipEdgeNormalFeature(o,r);let i=this.findCreaseBetweenTwoSamples(t,n),a=i===null?null:i.type===\"high-curvature\"?{type:\"high-curvature\",pos:this.addVertex(i.pos)}:{type:\"crease\",left:this.addVertex(i.left),right:this.addVertex(i.right)};return this.edgeNormalVertices.set(s,a),this.flipEdgeNormalFeature(a,r)}flipEdgeNormalFeature(t,n){return(t==null?void 0:t.type)===\"crease\"?{type:\"crease\",left:n===0?t.left:t.right,right:n===0?t.right:t.left}:t}findCreaseBetweenTwoSamples(t,n){let o=this.getUV(t),i=this.getUV(n),a=this.getNormal(t),u=this.getNormal(n),c=x=>{var P;let T=br(o,i,x);return(P=this.fn(T).normal)!=null?P:[NaN,NaN,NaN]};if(!a||!u)return null;let p=i[0]-o[0],l=i[1]-o[1],m=this.du,d=this.dv,y=(Math.abs(m*p)+Math.abs(d*l))/(p*p+l*l),g=Ng(0,a,1,u,c,.01,2*y,.9);if(g===void 0)return null;if(typeof g==\"number\")return g<y||g>1-y?null:{type:\"high-curvature\",pos:this.fn(br(o,i,g))};let f=g[0],h=g[1];return f<y||h>1-y?null:(f-=y,h+=y,f<=1e-8&&(f=1e-8),h>=1-1e-8&&(h=1-1e-8),{type:\"crease\",left:this.fn(br(o,i,f)),right:this.fn(br(o,i,h))})}isVertexAtCrease(t){let n=this.isVertexAtCreaseCache[t];if(n!==void 0)return n;let r=this._isVertexAtCrease(t);return this.isVertexAtCreaseCache[t]=r,r}finiteAlongEdge(t,n){if(t>n){let a=t;t=n,n=a}let r=n*n+t,s=this.finiteVertices.get(r);if(s!==void 0)return s;let o=this.findFiniteBetweenTwoSamples(t,n);if(o===void 0)return;let i=this.addVertex(o);return this.finiteVertices.set(r,i),i}pushTriangle(t,n,r){this.isDegenerate(t,n,r)||this.triangles.push(t,n,r)}getTriangles(){return this.triangles}},L8=1e-4,F8=.99,ud=.9999;function OC(e,t){return!e||!t?!0:e[0]*t[0]+e[1]*t[1]+e[2]*t[2]<F8}var wC=class extends _C{hintVec(t,n){let r=this.getUV(t),s=this.getUV(n);return aR(iR(s,r),L8)}hintNormal1(t,n,r){let s=this.hintVec(t,n),o=this.hintVec(t,r);this.normalDirHints[t]=[s,o]}hintNormals2(t,n){let r=this.hintVec(t,n),s=AC(r);this.normalDirHints[t]=[ix(r),s],this.normalDirHints[n]=[s,ix(s)]}hintNormals2Finite(t,n){let r=this.hintVec(t,n),s=ix(r);this.normalDirHints[t]=this.normalDirHints[n]=[s,AC(s)]}hintNormalFirstBad(t,n){let r=this.hintVec(t,n);this.normalDirHints[t]=[ix(r),AC(r)]}hintNormalSecondBad(t,n){let r=this.hintVec(n,t);this.normalDirHints[n]=[B8(r),V8(r)]}},LC=class extends wC{oneJump(t,n,r,s){let o=s[0],i=s[1];this.pushTriangle(o,r,t),this.pushTriangle(i,n,r),this.hintNormalFirstBad(o,r),this.hintNormalSecondBad(r,i)}oneJumpOneExtra(t,n,r,s,o){let i=s[0],a=s[1];this.pushTriangle(i,r,t),this.pushTriangle(i,o,r),this.pushTriangle(a,n,o),this.hintNormalFirstBad(i,r),this.hintNormalSecondBad(r,a)}oneJumpOneExtra2(t,n,r,s,o){let i=s[0],a=s[1];this.pushTriangle(a,n,r),this.pushTriangle(a,r,o),this.pushTriangle(i,o,t),this.hintNormalFirstBad(i,r),this.hintNormalSecondBad(r,a)}oneJumpTwoExtra(t,n,r,s,o,i){let a=s[0],u=s[1];this.pushTriangle(a,i,t),this.pushTriangle(a,o,i),this.pushTriangle(o,r,i),this.pushTriangle(u,n,o)}twoJumps(t,n,r,s,o){let i=s[0],a=s[1],u=o[0],c=o[1];this.pushTriangle(i,r,t),this.pushTriangle(i,c,r),this.pushTriangle(a,n,u),this.hintNormals2(i,c),this.hintNormals2(u,a)}twoJumpsOneExtraPoint(t,n,r,s,o,i){let a=s[0],u=s[1],c=o[0],p=o[1];this.pushTriangle(a,i,t),this.pushTriangle(a,p,i),this.pushTriangle(p,r,i),this.pushTriangle(u,n,c),this.hintNormals2(a,p),this.hintNormals2(c,u)}oneExtraPoint(t,n,r,s){this.pushTriangle(s,r,t),this.pushTriangle(s,n,r)}oneExtraPointOneVertexCrease(t,n,r,s){let o=this.copyVertex(r);this.pushTriangle(s,o,t),this.pushTriangle(s,n,o),this.hintNormal1(o,t,n)}twoExtraPoints(t,n,r,s,o){this.pushTriangle(s,r,t),this.pushTriangle(s,o,r),this.pushTriangle(s,n,o)}threeExtraPoints(t,n,r,s,o,i){this.pushTriangle(s,i,t),this.pushTriangle(s,o,i),this.pushTriangle(s,n,o),this.pushTriangle(o,r,i)}oneEdgeJumpOneVertexCrease(t,n,r,s){let o=s[0],i=s[1],a=this.copyVertex(r),u=this.copyVertex(r);this.pushTriangle(o,a,t),this.pushTriangle(i,n,u),this.hintNormals2(u,i),this.hintNormals2(o,a)}threeVertexCrease(t,n,r){let s=this.copyVertex(t),o=this.copyVertex(n),i=this.copyVertex(r);this.pushTriangle(s,o,i),this.hintNormals2(s,o),this.hintNormalFirstBad(i,s)}twoVertexCrease(t,n,r){let s=this.copyVertex(t),o=this.copyVertex(n);this.pushTriangle(s,o,r),this.hintNormals2(s,o)}oneVertexCrease(t,n,r){let s=this.copyVertex(t);this.pushTriangle(s,n,r),this.hintNormal1(s,n,r)}pushTrianglesBasedOnJumps(t,n,r){let s=this.jumpAlongEdge(t,n),o=this.jumpAlongEdge(n,r),i=this.jumpAlongEdge(r,t);if(s&&o&&i){let f=this.getUV(t),h=this.getUV(n),x=this.getUV(r),T=this.addVertex(this.fn(br(f,br(h,x,.5),1e-4))),P=this.addVertex(this.fn(br(h,br(x,f,.5),1e-4))),M=this.addVertex(this.fn(br(x,br(f,h,.5),1e-4))),S=this.jumpAlongEdge(T,P),E=this.jumpAlongEdge(P,M),v=this.jumpAlongEdge(M,T);if(S&&E&&v)return;t=T,n=P,r=M,s=S,o=E,i=v}let a=this.getNormal(t),u=this.getNormal(n),c=this.getNormal(r),p=this.isVertexAtCrease(t),l=this.isVertexAtCrease(n),m=this.isVertexAtCrease(r),d,y,g;if(!p&&!l&&!s&&OC(a,u)){let f=this.edgeNormalFeature(t,n);f!==null&&(f.type===\"high-curvature\"?d=f.pos:s=[f.left,f.right])}if(!l&&!m&&!o&&OC(u,c)){let f=this.edgeNormalFeature(n,r);f!==null&&(f.type===\"high-curvature\"?y=f.pos:o=[f.left,f.right])}if(!m&&!p&&!i&&OC(c,a)){let f=this.edgeNormalFeature(r,t);f!==null&&(f.type===\"high-curvature\"?g=f.pos:i=[f.left,f.right])}s&&o?g?this.twoJumpsOneExtraPoint(t,n,r,s,o,g):this.twoJumps(t,n,r,s,o):o&&i?d?this.twoJumpsOneExtraPoint(n,r,t,o,i,d):this.twoJumps(n,r,t,o,i):i&&s?y?this.twoJumpsOneExtraPoint(r,t,n,i,s,y):this.twoJumps(r,t,n,i,s):s?m?this.oneEdgeJumpOneVertexCrease(t,n,r,s):y&&g?this.oneJumpTwoExtra(t,n,r,s,y,g):y?this.oneJumpOneExtra(t,n,r,s,y):g?this.oneJumpOneExtra2(t,n,r,s,g):this.oneJump(t,n,r,s):o?p?this.oneEdgeJumpOneVertexCrease(n,r,t,o):g&&d?this.oneJumpTwoExtra(n,r,t,o,g,d):g?this.oneJumpOneExtra(n,r,t,o,g):d?this.oneJumpOneExtra2(n,r,t,o,d):this.oneJump(n,r,t,o):i?l?this.oneEdgeJumpOneVertexCrease(r,t,n,i):d&&y?this.oneJumpTwoExtra(r,t,n,i,d,y):d?this.oneJumpOneExtra(r,t,n,i,d):y?this.oneJumpOneExtra2(r,t,n,i,y):this.oneJump(r,t,n,i):p&&l&&m?this.threeVertexCrease(t,n,r):p&&l?this.twoVertexCrease(t,n,r):l&&m?this.twoVertexCrease(n,r,t):m&&p?this.twoVertexCrease(r,t,n):p?y?this.oneExtraPointOneVertexCrease(n,r,t,y):this.oneVertexCrease(t,n,r):l?g?this.oneExtraPointOneVertexCrease(r,t,n,g):this.oneVertexCrease(n,r,t):m?d?this.oneExtraPointOneVertexCrease(t,n,r,d):this.oneVertexCrease(r,t,n):d&&y&&g?this.threeExtraPoints(t,n,r,d,y,g):d&&y?this.twoExtraPoints(t,n,r,d,y):y&&g?this.twoExtraPoints(n,r,t,y,g):g&&d?this.twoExtraPoints(r,t,n,g,d):d?this.oneExtraPoint(t,n,r,d):y?this.oneExtraPoint(n,r,t,y):g?this.oneExtraPoint(r,t,n,g):this.pushTriangle(t,n,r)}oneNonFinite(t,n,r){let s=this.finiteAlongEdge(n,r),o=this.finiteAlongEdge(t,r);o!==void 0&&s!==void 0&&(this.pushTrianglesBasedOnJumps(s,t,n),this.pushTrianglesBasedOnJumps(s,o,t),this.hintNormals2Finite(s,o))}twoNonFinite(t,n,r){let s=this.finiteAlongEdge(t,n),o=this.finiteAlongEdge(t,r);s!==void 0&&o!==void 0&&(this.pushTrianglesBasedOnJumps(t,s,o),this.hintNormals2Finite(s,o))}pushTriangles(t,n,r){let s=this.allowVertex(t),o=this.allowVertex(n),i=this.allowVertex(r);s&&o&&i?this.pushTrianglesBasedOnJumps(t,n,r):s&&o?this.oneNonFinite(t,n,r):o&&i?this.oneNonFinite(n,r,t):i&&s?this.oneNonFinite(r,t,n):s?this.twoNonFinite(t,n,r):o?this.twoNonFinite(n,r,t):i&&this.twoNonFinite(r,t,n)}},ad=class extends LC{triangulate(){let t=this.resolution,{uRange:n,vRange:r,fn:s}=this,o=[n.min,r.min],i=[n.max,r.max],a=t-1,u=new Array(t*t);u[0]=this.addVertex(s(o));for(let c=1;c<=a;c++)u[c]=this.addVertex(s(vg(o,i,[c/a,0]))),u[t*c]=this.addVertex(s(vg(o,i,[0,c/a])));for(let c=1;c<=a;c++)for(let p=1;p<=a;p++){let l=u[(p-1)*t+(c-1)],m=u[p*t+(c-1)],d=u[(p-1)*t+c],y=this.addVertex(s(vg(o,i,[c/a,p/a])));u[p*t+c]=y,(c+p)%2===0?(this.pushTriangles(l,y,m),this.pushTriangles(l,d,y)):(this.pushTriangles(l,d,m),this.pushTriangles(d,y,m))}return{triangles:this.getTriangles(),normalDirHints:this.normalDirHints}}};function V8(e){let t=e[0]*Math.SQRT1_2,n=e[1]*Math.SQRT1_2;return[t+n,n-t]}function ix(e){let t=e[0]*Math.SQRT1_2,n=e[1]*Math.SQRT1_2;return[t-n,t+n]}function B8(e){return[e[1],-e[0]]}function AC(e){return[-e[1],e[0]]}var we=class{constructor(t,n){this.min=t;this.max=n}get width(){return this.max-this.min}};var FC=class extends ad{constructor(n,r,s,o,i,a=[0,1,2]){let u=r.width/1e8,c=s.width/1e8;super({resolution:i,uRange:r,vRange:s,du:u,dv:c,extraAttrCount:0});this.vertices=[];this.fn=n=>{let r=this._fn(n),s=this.tangentInForcedDf(n,[this.du,0],r),o=this.tangentInForcedDf(n,[0,this.dv],r),i=Gp([this.du,0,s],[0,this.dv,o]);return{uv:n,f:r,normal:[i[this.perm0],i[this.perm1],i[this.perm2]],dfEast:s,dfNorth:o}};this._fn=p=>n(p[0],p[1]),this.paddedOutputDomain=new we(o.min-5*o.width,o.max+5*o.width),this.jumpTolerance=o.width/1e3,this.perm0=a[0],this.perm1=a[1],this.perm2=a[2]}getVertexCount(){return this.vertices.length}getUV(n){return this.vertices[n].uv}getNormal(n){return this.vertices[n].normal}_addVertex(n){return this.vertices.push(n)-1}copyVertex(n){return this.addVertex(this.vertices[n])}getF(n){return this.vertices[n].f}getDfNorth(n){return this.vertices[n].dfNorth}getDfEast(n){return this.vertices[n].dfEast}tangentInForcedDf(n,r,s){let o=kd(n,r);return this._fn(o)-s}tangentInForced(n,r,s){let o=kd(n,r);return[r[0],r[1],this._fn(o)-s]}getExtraAttr(){throw new Error(\"Unexpected getExtraAttr call in explicit-surface.ts\")}_isVertexAtCrease(n){let r=this.getUV(n),s=this.getDfEast(n),o=this.getDfNorth(n),i=this.getF(n),a=this.tangentInForcedDf(r,[-this.du,0],i);if((-this.duSquared+a*s)/Math.sqrt((this.duSquared+a*a)*(this.duSquared+s*s))>-ud)return!0;let p=this.tangentInForcedDf(r,[0,-this.dv],i);return(-this.dvSquared+o*p)/Math.sqrt((this.dvSquared+o*o)*(this.dvSquared+p*p))>-ud}hintedNormal(n,r){let s=this.getUV(n),o=this.getF(n),i=Gp(this.tangentInForced(s,r[0],o),this.tangentInForced(s,r[1],o));return Hp(...i)?[i[this.perm0],i[this.perm1],i[this.perm2]]:this.getNormal(n)}getVertex(n){if(!this.allowVertex(n))return;let r=this.getF(n),s=this.getUV(n);return[this.perm0===2?r:s[this.perm0],this.perm1===2?r:s[this.perm1],this.perm2===2?r:s[this.perm2]]}findJumpBetweenTwoSamples(n,r){let s=this.getUV(n),o=this.getF(n),i=0,a=this.getUV(r),u=this.getF(r),c=1,p=m=>this._fn(br(s,a,m));if(!isFinite(o)||!isFinite(u))return;let l=xR(i,o,c,u,p,this.jumpTolerance);if(l)return[this.fn(br(s,a,Ei(l[0],0,1e-5))),this.fn(br(s,a,Ei(l[1],1,1e-5)))]}findFiniteBetweenTwoSamples(n,r){let s=this.getUV(n),o=this.getF(n),i=this.getUV(r),a=this.getF(r),u=l=>{let m=this._fn(l);return m<this.paddedOutputDomain.min||m>this.paddedOutputDomain.max?NaN:m},c=l=>u(br(s,i,l)),p=ws(0,this.paddedOutputDomain.min<o&&o<this.paddedOutputDomain.max?o:NaN,1,this.paddedOutputDomain.min<a&&a<this.paddedOutputDomain.max?a:NaN,c);if(p!==void 0)return this.fn(br(s,i,p))}allowVertex(n){let r=this.getF(n);return this.paddedOutputDomain.min<r&&r<this.paddedOutputDomain.max}isDegenerate(n,r,s){let o=this.getUV(n),i=this.getUV(r),a=this.getUV(s),u=this.uRange.width*1e-6,c=this.vRange.width*1e-6;return Math.abs(o[0]-i[0])<u&&Math.abs(o[1]-i[1])<c||Math.abs(i[0]-a[0])<u&&Math.abs(i[1]-a[1])<c||Math.abs(a[0]-o[0])<u&&Math.abs(a[1]-o[1])<c}};function ux(e,t,n,r,s,o=[0,1,2]){let i=new FC(e,t,n,r,s,o);return ax(i)}var Oi=class{constructor(t){this.xtolerance=t.xtolerance||t.tolerance||0,this.ytolerance=t.ytolerance||t.tolerance||0,this.ztolerance=t.ztolerance||t.tolerance||0,this.map=t.map,this.segments=[],this.segment=[],this.pivotPoint=void 0,this.pendingPoint=void 0}colinear(t,n,r){let s=this.map(t),o=this.map(n),i=this.map(r),a=qi(i[0],i[1],i[2]||0,s[0],s[1],s[2]||0,o[0],o[1],o[2]||0);if(a<1)return!1;let u=[s[0]+a*(o[0]-s[0]),s[1]+a*(o[1]-s[1]),s.length===3?s[2]+a*(o[2]-s[2]):0];return Math.abs(i[0]-u[0])<=this.xtolerance&&Math.abs(i[1]-u[1])<=this.ytolerance&&(s.length===2||Math.abs(i[2]-u[2])<=this.ztolerance)}addPoint(t){if(this.dimensions=t.length,this.xtolerance<0&&this.ytolerance<0&&(this.dimensions===2||this.ztolerance<0)){this.segment.push.apply(this.segment,t);return}if(!this.segment.length){this.segment.push.apply(this.segment,t);return}let n=this.dimensions===2?[this.segment[this.segment.length-2],this.segment[this.segment.length-1]]:[this.segment[this.segment.length-3],this.segment[this.segment.length-2],this.segment[this.segment.length-1]];if(!(t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2])){if(!this.pivotPoint||!this.pendingPoint){this.pivotPoint=t,this.pendingPoint=t;return}(!this.colinear(n,this.pivotPoint,t)||yi(n[0]-t[0],n[1]-t[1],(n[2]||0)-(t[2]||0))<yi(n[0]-this.pendingPoint[0],n[1]-this.pendingPoint[1],(n[2]||0)-(this.pendingPoint[2]||0)))&&(this.flushPending(),this.pivotPoint=t),this.pendingPoint=t}}flushPending(){this.pendingPoint&&(this.segment.push.apply(this.segment,this.pendingPoint),this.pivotPoint=void 0,this.pendingPoint=void 0)}breakSegment(){this.flushPending(),this.segment.length>(this.dimensions||2)&&this.segments.push(this.segment),this.segment=[]}getSegments(){return this.breakSegment(),this.segments}finish(){return{segments:this.getSegments(),resolved:!0}}};var R_=5,G8=Math.pow(2,14),{abs:ea}=Math;function xy(e,t){let n=H8(e,t);return{segments:n.contours.strokeSegments,fillSegments:n.contours.fillSegments,resolved:n.quadTree.resolved}}function H8(e,t){let n=Math.pow(2,-R_),r=N_(t,n),s=N_(t,2*n),o=q8(e,r,s),i=X8(o.root,e,r),a=K8(i,e,r);return{paddedDomain:r,rootDomain:s,quadTree:o,triangles:i,contours:a}}function ld(e,t,n){return{x:e,y:t,z:n}}function el(e,t,n){return{x:e,y:t,isZero:n}}function cx(e,t,n){return{vertices:[e,t,n],visited:!1,next:void 0}}function N_(e,t){let{mathToPixels:n}=e,r=n.interpolateX(e.xmin,e.xmax,-t),s=n.interpolateX(e.xmax,e.xmin,-t),o=n.interpolateY(e.ymin,e.ymax,-t),i=n.interpolateY(e.ymax,e.ymin,-t);return{...e,xmin:r,ymin:o,xmax:s,ymax:i}}function gy(e,t){return{depth:e,vertices:t,children:void 0,center:void 0}}function VC(e,t,n){e.center=O_(e.vertices[0],e.vertices[1],e.vertices[2],e.vertices[3],t,n)}function q8(e,t,n){let r=U8(e,n),s=[],o=[];o.push(r);let i=1,a=!0;e:for(;o.length;){let u=s;s=o,o=u;let c;for(;c=s.pop();)if(k8(c,e,t)){if(z8(c,e,t),!c.children){a=!1;break e}if(o.push(c.children[0]),o.push(c.children[1]),o.push(c.children[2]),o.push(c.children[3]),i+=3,i>=G8){a=!1;break e}}else VC(c,e,t)}for(let u=0;u<s.length;u++)VC(s[u],e,t);for(let u=0;u<o.length;u++)VC(o[u],e,t);return{root:r,resolved:a}}function U8(e,t){let n=t.xmin,r=t.xmax,s=t.ymin,o=t.ymax;return gy(0,[cd(n,o,e),cd(r,o,e),cd(r,s,e),cd(n,s,e)])}function z8(e,t,n){let r=e.depth+1,s=e.vertices[0],o=e.vertices[1],i=e.vertices[2],a=e.vertices[3],u=$s(s,o,t,n),c=$s(o,i,t,n),p=$s(i,a,t,n),l=$s(a,s,t,n),m=$s(s,i,t,n);e.children=[gy(r,[s,u,m,l]),gy(r,[u,o,c,m]),gy(r,[m,c,i,p]),gy(r,[l,m,p,a])]}function k8(e,t,n){if(e.depth<R_)return!0;if(Y8(e,n)||$8(e,n))return!1;let r=e.vertices[0],s=e.vertices[1],o=e.vertices[2],i=e.vertices[3];if(isNaN(r.z)&&isNaN(s.z)&&isNaN(o.z)&&isNaN(i.z))return!1;if(isNaN(r.z)||isNaN(s.z)||isNaN(o.z)||isNaN(i.z))return!0;let a=O_(r,s,o,i,t,n),u=_u(r,s,t,n),c=_u(s,o,t,n),p=_u(o,i,t,n),l=_u(i,r,t,n);return nl(r,u,t,n)||nl(s,u,t,n)||nl(s,c,t,n)||nl(o,c,t,n)||nl(o,p,t,n)||nl(i,p,t,n)||nl(i,l,t,n)||nl(r,l,t,n)||tl(r,u,a,t,n)||tl(u,s,a,t,n)||tl(s,c,a,t,n)||tl(c,o,a,t,n)||tl(o,p,a,t,n)||tl(p,i,a,t,n)||tl(i,l,a,t,n)||tl(l,r,a,t,n)}function tl(e,t,n,r,s){if(e.z>0==t.z>0&&t.z>0==n.z>0)return!1;let o=0;isFinite(e.z)&&(o=Math.max(o,Math.abs(e.z))),isFinite(t.z)&&(o=Math.max(o,Math.abs(t.z))),isFinite(n.z)&&(o=Math.max(o,Math.abs(n.z)));let i=32*Number.EPSILON*o,a,u,c,p;if(e.z>0==t.z>0){if(a=$s(e,t,r,s),a.z>0!=e.z>0)return!0;u=Au(e,n,r,s,i),c=Au(t,n,r,s,i),p=Au(a,n,r,s,i)}else if(t.z>0==n.z>0){if(a=$s(t,n,r,s),a.z>0!=t.z>0)return!0;u=Au(t,e,r,s,i),c=Au(n,e,r,s,i),p=Au(a,e,r,s,i)}else{if(a=$s(n,e,r,s),a.z>0!=n.z>0)return!0;u=Au(n,t,r,s,i),c=Au(e,t,r,s,i),p=Au(a,t,r,s,i)}let{mathToPixels:l,map3d:m}=s;if(m){let d=m(p.x,p.y),y=m(u.x,u.y),g=m(c.x,c.y);return vN(d[0],d[1],d[2],y[0],y[1],y[2],g[0],g[1],g[2])>s.tolerance}else{let[d,y]=l.mapCoordinatePair([p.x,p.y]),[g,f]=l.mapCoordinatePair([u.x,u.y]),[h,x]=l.mapCoordinatePair([c.x,c.y]);return CN(d,y,g,f,h,x)>s.tolerance}}function nl(e,t,n,r){if(isNaN(e.z)&&isNaN(t.z))return!1;if(isNaN(e.z)||isNaN(t.z))return e.z>0||t.z>0;let o=4*$s(e,t,n,r).z-t.z-3*e.z,i=1e-4,a=(n((1-i)*e.x+i*t.x,(1-i)*e.y+i*t.y)-e.z)/i,u=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.abs(o-a)>.125*u}function $8(e,t){let{mathToPixels:n,map3d:r,tolerance:s}=t;if(r)return!1;{let[o,i]=n.mapCoordinatePair([e.vertices[1].x,e.vertices[1].y]),[a,u]=n.mapCoordinatePair([e.vertices[0].x,e.vertices[0].y]),[c,p]=n.mapCoordinatePair([e.vertices[3].x,e.vertices[3].y]);if(ea(o-a)<10*s||ea(u-p)<10*s)return!0}return!1}function Y8(e,t){return e.vertices[0].x<t.xmin||e.vertices[0].y>t.ymax||e.vertices[2].x>t.xmax||e.vertices[2].y<t.ymin}function pd(e,t){return e.x<t.xmin||e.x>t.xmax||e.y<t.ymin||e.y>t.ymax}function cd(e,t,n){return ld(e,t,n(e,t))}function $s(e,t,n,r){let{mathToPixels:s}=r;return cd(s.interpolateX(e.x,t.x,.5),s.interpolateY(e.y,t.y,.5),n)}function _u(e,t,n,r){if(pd(e,r)||pd(t,r))return $s(e,t,n,r);if(isNaN(e.z)||isNaN(t.z))return Z8(e,t,n,r);if(e.z>0!=t.z>0)return $s(e,t,n,r);let s=.01,o=n((1-s)*e.x+s*t.x,(1-s)*e.y+s*t.y)-e.z,i=t.z-n(s*e.x+(1-s)*t.x,s*e.y+(1-s)*t.y);return isNaN(o)||isNaN(i)||o>0==i>0?$s(e,t,n,r):A_(ld(e.x,e.y,o),ld(t.x,t.y,i),n,r)}function O_(e,t,n,r,s,o){let i=_u(e,n,s,o);return e.z>0==n.z>0&&i.z>0!=e.z>0||(i=_u(t,r,s,o),t.z>0==r.z>0&&i.z>0!=t.z>0)?i:$s(e,n,s,o)}function A_(e,t,n,r){if(isNaN(e.z))return t;if(isNaN(t.z))return e;if(!isFinite(e.z)&&!isFinite(t.z))return $s(e,t,n,r);if(isFinite(e.z))if(isFinite(t.z)){let s=1-e.z/t.z,o=1-t.z/e.z;return cd(e.x/s+t.x/o,e.y/s+t.y/o,n)}else return e;else return t}function Au(e,t,n,r,s){let{mathToPixels:o,map3d:i}=r,a=e.x,u=t.x,c=e.y,p=t.y,l=e.z,m=t.z;if(pd(e,r)||pd(t,r)){let d=$s(e,t,n,r);return el(d.x,d.y,!1)}if(i){let[d,y,g]=i(a,c),[f,h,x]=i(u,p);for(;ea(d-f)>r.tolerance||ea(y-h)>r.tolerance||ea(g-x)>r.tolerance;){let T=.5*(a+u),P=.5*(c+p),M=n(T,P);if(M>0==l>0?(a=T,c=P,l=M):(u=T,p=P,m=M),(T===a||T===u)&&(P===c||P===p))break;[d,y,g]=i(a,c),[f,h,x]=i(u,p)}}else{let[d,y]=o.mapCoordinatePair([a,c]),[g,f]=o.mapCoordinatePair([u,p]);for(;ea(d-g)>r.tolerance||ea(y-f)>r.tolerance;){let h=.5*(a+u),x=.5*(c+p),T=n(h,x);T>0==l>0?(a=h,c=x,l=T):(u=h,p=x,m=T),[d,y]=o.mapCoordinatePair([a,c]),[g,f]=o.mapCoordinatePair([u,p])}}if(isNaN(l))return el(u,p,!1);if(isNaN(m))return el(a,c,!1);{let d=Math.abs(l),y=Math.abs(m);if(d<s&&y>100*s)return 1/d>=y?el(a,c,!0):el(u,p,!1);if(y<s&&d>100*s)return 1/y>=d?el(u,p,!0):el(a,c,!1);let g=A_(ld(a,c,l),ld(u,p,m),n,r),f=l===0||m===0||g.z===0||g.z>=l==m>=g.z&&Math.abs(g.z)<1e250;return el(g.x,g.y,f)}}function Z8(e,t,n,r){let{mathToPixels:s,map3d:o}=r;if(isNaN(e.z)===isNaN(t.z))return $s(e,t,n,r);if(isNaN(e.z)){let l=e;e=t,t=l}let i=e.x,a=t.x,u=e.y,c=t.y,p=e.z;if(o){let[l,m,d]=o(i,u),[y,g,f]=o(a,c);for(;ea(l-y)>r.tolerance||ea(m-g)>r.tolerance||ea(d-f)>r.tolerance||isNaN(l)||isNaN(y);){let h=.5*(i+a),x=.5*(u+c),T=n(h,x);if(isNaN(T)===isNaN(p)?(i=h,u=x,p=T):(a=h,c=x),(h===i||h===a)&&(x===u||x===c))break;[l,m,d]=o(i,u),[y,g,f]=o(a,c)}}else{let[l,m]=s.mapCoordinatePair([i,u]),[d,y]=s.mapCoordinatePair([a,c]);for(;ea(l-d)>r.tolerance||ea(m-y)>r.tolerance;){let g=.5*(i+a),f=.5*(u+c),h=n(g,f);isNaN(h)===isNaN(p)?(i=g,u=f,p=h):(a=g,c=f),[l,m]=s.mapCoordinatePair([i,u]),[d,y]=s.mapCoordinatePair([a,c])}}return ld(i,u,p)}function X8(e,t,n){let r={triangles:[],edgeCache:{},domain:n,fn:t};return hy(e,r),r.triangles}function hy(e,t){e.children&&(hy(e.children[0],t),hy(e.children[1],t),hy(e.children[2],t),hy(e.children[3],t),rl(e.children[0],e.children[1],t),rl(e.children[3],e.children[2],t),sl(e.children[1],e.children[2],t),sl(e.children[0],e.children[3],t))}function rl(e,t,n){e.children&&t.children?(rl(e.children[1],t.children[0],n),rl(e.children[2],t.children[3],n)):e.children?(rl(e.children[1],t,n),rl(e.children[2],t,n)):t.children?(rl(e,t.children[0],n),rl(e,t.children[3],n)):W8(e,t,n)}function sl(e,t,n){e.children&&t.children?(sl(e.children[2],t.children[1],n),sl(e.children[3],t.children[0],n)):e.children?(sl(e.children[2],t,n),sl(e.children[3],t,n)):t.children?(sl(e,t.children[1],n),sl(e,t.children[0],n)):j8(e,t,n)}function W8(e,t,n){if(!e.center||!t.center)return;let r,s;e.depth>=t.depth?(r=_u(e.vertices[1],e.vertices[2],n.fn,n.domain),s=mx(e.vertices[1],t.center,e.vertices[2],e.center,r)):(r=_u(t.vertices[0],t.vertices[3],n.fn,n.domain),s=mx(t.vertices[0],t.center,t.vertices[3],e.center,r)),__(s,n.edgeCache,n.domain);for(let o=0;o<4;o++)n.triangles.push(s[o])}function j8(e,t,n){if(!e.center||!t.center)return;let r,s;e.depth>=t.depth?(r=_u(e.vertices[3],e.vertices[2],n.fn,n.domain),s=mx(e.vertices[2],t.center,e.vertices[3],e.center,r)):(r=_u(t.vertices[1],t.vertices[0],n.fn,n.domain),s=mx(t.vertices[1],t.center,t.vertices[0],e.center,r)),__(s,n.edgeCache,n.domain);for(let o=0;o<4;o++)n.triangles.push(s[o])}function mx(e,t,n,r,s){return[cx(e,s,t),cx(t,s,n),cx(n,s,r),cx(r,s,e)]}function by(e,t,n){return e.z>0&&!pd(e,n)&&(!(t.z>0)||pd(t,n))}function lx(e,t){return\"\"+e.x+\",\"+e.y+\",\"+t.x+\",\"+t.y}function __(e,t,n){px(e[0],e[1],e[2],lx(e[1].vertices[2],e[1].vertices[0]),t,n),px(e[1],e[2],e[3],lx(e[2].vertices[0],e[2].vertices[2]),t,n),px(e[2],e[3],e[0],lx(e[3].vertices[2],e[3].vertices[0]),t,n),px(e[3],e[0],e[1],lx(e[0].vertices[0],e[0].vertices[2]),t,n)}function px(e,t,n,r,s,o){let i=t.vertices[0],a=t.vertices[1],u=t.vertices[2];by(a,u,o)&&(t.next=n),by(i,a,o)&&(t.next=e),by(u,i,o)&&Q8(t,r,s),by(i,u,o)&&J8(t,r,s)}function J8(e,t,n){n[t]?n[t].next=e:n[t]=e}function Q8(e,t,n){n[t]?e.next=n[t]:n[t]=e}function K8(e,t,n){let{tolerance:r,mathToPixels:s,map3d:o}=n,i;if(o){let a={tolerance:r,map:u=>o(u[0],u[1])};i={fillAccumulator:new Oi(a),strokeAccumulator:new Oi(a),fn:t,domain:n}}else{let a={tolerance:r,map:u=>s.mapCoordinatePair(u)};i={fillAccumulator:new Oi(a),strokeAccumulator:new Oi(a),fn:t,domain:n}}for(let a=0;a<e.length;a++){let u=e[a];u.next&&!u.visited&&e$(u,i)}return{strokeSegments:i.strokeAccumulator.finish().segments,fillSegments:i.fillAccumulator.finish().segments}}function e$(e,t){for(;;){let n=e.vertices[0],r=e.vertices[1],s=e.vertices[2],o=0;isFinite(n.z)&&(o=Math.max(o,Math.abs(n.z))),isFinite(r.z)&&(o=Math.max(o,Math.abs(r.z))),isFinite(s.z)&&(o=Math.max(o,Math.abs(s.z)));let i=32*Number.EPSILON*o;if(BC(n,r,t,i),BC(r,s,t,i),BC(s,n,t,i),e.visited||!e.next)break;e.visited=!0,e=e.next}t.strokeAccumulator.breakSegment(),t.fillAccumulator.breakSegment()}function BC(e,t,n,r){if(by(e,t,n.domain)){let s=Au(e,t,n.fn,n.domain,r);n.fillAccumulator.addPoint([s.x,s.y]),s.isZero?n.strokeAccumulator.addPoint([s.x,s.y]):n.strokeAccumulator.breakSegment()}}function GC(e,t){return{type:\"linear\",s:e,t}}function w_(e,t){return{type:\"logarithmic\",s:e,t}}function L_(e,t){return{type:\"exponential\",s:e,t}}function HC(){return GC(1,0)}function t$([e,t],[n,r]){let s=(r-n)/(t-e),o=(n+r)/2-s*(t+e)/2;return GC(s,o)}function n$([e,t],[n,r]){let s=(r-n)/(Math.log(t)-Math.log(e)),o=(Math.log(t)*n-Math.log(e)*r)/(Math.log(t)-Math.log(e));return w_(s,o)}function r$([e,t],[n,r]){let s=(Math.log(r)-Math.log(n))/(t-e),o=(t*Math.log(n)-e*Math.log(r))/(t-e);return L_(s,o)}function qC(e,t,n){switch(e){case\"linear\":return t$(t,n);case\"logarithmic\":return n$(t,n);case\"exponential\":return r$(t,n);default:{let r=e;throw new Error(\"Unexpected scale type: \"+r)}}}function UC({type:e,s:t,t:n},r){switch(e){case\"linear\":return t*r+n;case\"logarithmic\":return t*Math.log(r)+n;case\"exponential\":return Math.exp(t*r+n);default:let s=e;throw new Error(\"Unexpected scale type: \"+s)}}function zC(e,t,n,r){switch(e){case\"linear\":return s$(t,n,r);case\"logarithmic\":return Math.pow(t,1-r)*Math.pow(n,r);case\"exponential\":return r===0?t:r===1?n:Math.log((1-r)*Math.exp(t)+r*Math.exp(n));default:let s=e;throw new Error(\"Unexpected scale type: \"+s)}}function s$(e,t,n){return(1-n)*e+n*t}function kC({type:e,s:t,t:n}){switch(e){case\"linear\":return GC(1/t,-n/t);case\"logarithmic\":return L_(1/t,-n/t);case\"exponential\":return w_(1/t,-n/t);default:let r=e;throw new Error(\"Unexpected scale type: \"+r)}}function $C(e){switch(e){case\"linear\":return\"linear\";case\"logarithmic\":return\"exponential\";case\"exponential\":return\"logarithmic\";default:let t=e;throw new Error(\"Unexpected scale type: \"+t)}}function dx({width:e,height:t}){return{left:0,right:e,top:0,bottom:t}}function fx({xmin:e,xmax:t,ymin:n,ymax:r}){return{left:e,right:t,bottom:n,top:r}}var ol=class e{constructor(t,n){this.xScale=t,this.yScale=n}static fromRects(t,n,{xAxisScale:r,yAxisScale:s}){return new e(qC(r,[t.left,t.right],[n.left,n.right]),qC(s,[t.bottom,t.top],[n.bottom,n.top]))}static fromRectsInverse(t,n,{xAxisScale:r,yAxisScale:s}){return e.fromRects(n,t,{xAxisScale:$C(r),yAxisScale:$C(s)})}inverse(){return new e(kC(this.xScale),kC(this.yScale))}mapX(t){return UC(this.xScale,t)}mapY(t){return UC(this.yScale,t)}mapPoint({x:t,y:n}){return{x:this.mapX(t),y:this.mapY(n)}}mapCoordinatePair([t,n]){return[this.mapX(t),this.mapY(n)]}mapRect({top:t,bottom:n,left:r,right:s}){return{left:this.mapX(r),right:this.mapX(s),bottom:this.mapY(n),top:this.mapY(t)}}interpolateX(t,n,r){return zC(this.xScale.type,t,n,r)}interpolateY(t,n,r){return zC(this.yScale.type,t,n,r)}dangerouslyGetXScaleFactor(){if(this.xScale.type!==\"linear\")throw new Error(`Cannot get scale factor a '${this.xScale.type}' scale`);return this.xScale.s}dangerouslyGetYScaleFactor(){if(this.yScale.type!==\"linear\")throw new Error(`Cannot get scale factor a '${this.yScale.type}' scale`);return this.yScale.s}};function yx(e,t,n,r){let s=[],o=[],i=[],a=[],{xmin:u,xmax:c,ymin:p,ymax:l,zmin:m,zmax:d}=n,y,g,f;switch(r){case\"z\":y={xmin:u,xmax:c,ymin:p,ymax:l},g=(P,M)=>[P[M],P[M+1],m,P[M],P[M+1],d],f=(P,M)=>e(P,M,0);break;case\"y\":y={xmin:u,xmax:c,ymin:m,ymax:d},g=(P,M)=>[P[M],p,P[M+1],P[M],l,P[M+1]],f=(P,M)=>e(P,0,M);break;case\"x\":y={xmin:m,xmax:d,ymin:p,ymax:l},g=(P,M)=>[u,P[M+1],P[M],c,P[M+1],P[M]],f=(P,M)=>e(0,M,P);break}let h=dx({width:500,height:500}),x={...y,mathToPixels:ol.fromRects(fx(y),h,{xAxisScale:\"linear\",yAxisScale:\"linear\"}),tolerance:ta},T=xy(f,x);for(let P of T.segments)for(let M=0;M<P.length/2;M++){let[S,E,v,D,G,j]=g(P,2*M);if(s.push(S,E,v,D,G,j),i.push(S,E,D,G),t){let Q=t(S,E,v),W=t(D,G,j);o.push(Q[0],Q[1],Q[2]),o.push(W[0],W[1],W[2])}else o.push(0,0,0),o.push(0,0,0);if(M>0){let Q=s.length/3-4;a.push(Q,Q+1,Q+2),a.push(Q+2,Q+1,Q+3)}}return id(a,s,o,i,0,[],.7),{positions:s,normals:o,faces:a,uvs:i,resolved:T.resolved,extraAttrs:[]}}var gx=[[1,2,4,21,20,18],[0,1,3,20,19,18],[2,6,7,25,21,18],[5,6,8,25,22,18],[5,9,11,23,22,18],[0,9,10,23,19,18],[10,12,14,24,23,19],[3,12,13,24,20,19],[4,13,15,24,21,20],[15,7,16,25,24,21],[11,17,14,24,23,22],[17,8,16,25,24,22]],Wr=[0,1,0,2,0,3,1,2,2,3,0,4,0,7,3,7,4,7,0,5,1,5,4,5,1,6,2,6,5,6,3,6,6,7,4,6,0,8,1,8,2,8,3,8,4,8,5,8,6,8,7,8],V_=[[0,2,3,8],[0,1,2,8],[0,3,7,8],[0,4,7,8],[0,4,5,8],[0,1,5,8],[1,5,6,8],[1,2,6,8],[2,3,6,8],[3,6,7,8],[4,5,6,8],[4,6,7,8]],B_=[[0,0,0],[0,1,0],[1,1,0],[1,0,0],[0,0,1],[0,1,1],[1,1,1],[1,0,1],[.5,.5,.5]],YC=[[1,2,4],[4,20,21],[2,18,21],[1,18,20],[0,1,3],[3,19,20],[0,18,19],[2,6,7],[7,21,25],[6,18,25],[5,6,8],[8,22,25],[5,18,22],[5,9,11],[11,22,23],[9,18,23],[0,9,10],[10,19,23],[10,12,14],[14,23,24],[12,19,24],[3,12,13],[13,20,24],[4,13,15],[15,21,24],[15,7,16],[16,24,25],[11,17,14],[17,22,24],[17,8,16]],ZC=[];for(let e=0;e<30;e++){let t=YC[e],n=new Set;for(let r of t)n.add(Wr[r*2]),n.add(Wr[r*2+1]);ZC[e]=[...n]}var G_=[[0,3,2,1],[4,6,3,5],[7,2,9,8],[10,12,9,11],[13,12,15,14],[16,6,15,17],[18,17,20,19],[21,5,20,22],[23,1,22,24],[25,24,8,26],[27,14,28,19],[29,28,11,26]],i$=1<<31,a$=1<<30,F_=1<<24,dp=1<<24,Ai=1<<24,na=65536,ra=256,sa=1;function H_(e,t,n){return n*na+t*ra+e*sa}var u$={0:0*F_,1:ra,2:sa+ra,3:sa,4:na,5:ra+na,6:sa+ra+na,7:sa+na,8:8*F_};function q_(e,t){return i$+e+u$[t]}var c$={3:2*Ai+ra,4:0*Ai+sa,7:5*Ai+sa,8:2*Ai+na,10:5*Ai+ra,11:0*Ai+na,12:6*Ai+ra,13:5*Ai+sa+ra,14:2*Ai+ra+na,15:9*Ai+sa,16:0*Ai+sa+na,17:1*Ai+na};function Ty(e,t){var n;return a$+e+((n=c$[t])!=null?n:Ai*t)}var l$={18:10*dp+ra,21:7*dp+ra,23:16*dp+sa,25:13*dp+sa,27:4*dp+na,29:0*dp+na};function XC(e,t){var n;return e+((n=l$[t])!=null?n:dp*t)}var md=class{constructor(t,n,r,s,o){this.PAConstructor=t;this.x=n;this.y=r;this.z=s;this.gridsize=o;this.i=0;this.j=0;this.k=0;this.cubeVertex=new Array(9);this.cubeVertexValue=new this.PAConstructor(9);if(o>250)throw new Error(\"Programming Error: resolution should be clamped well below 250.\");this.size=new Ke(this.x.width/o,this.y.width/o,this.z.width/o)}loopOverUnitCubes(t){let n=this.gridsize,r=n+1,s=new hx(this.x.min,this.y.min,this.z.min,this.size.x,this.size.y,this.size.z,n+1,n+1,n+1),o=new hx(this.x.min+this.size.x/2,this.y.min+this.size.y/2,this.z.min+this.size.z/2,this.size.x,this.size.y,this.size.z,n,n,n),i=s.setupArray(this.PAConstructor),a=s.setupArray(this.PAConstructor),u=o.setupArray(this.PAConstructor);this.evaluateArray(a,s,0);for(let c=0;c<n;c++){this.k=c,[i,a]=[a,i],this.evaluateArray(a,s,c+1),this.evaluateArray(u,o,c);for(let p=0;p<n;p++){this.j=p;for(let l=0;l<n;l++){this.i=l;let m=p*r+l;this.cubeVertexValue.setFrom(0,i,m),this.cubeVertexValue.setFrom(1,i,m+r),this.cubeVertexValue.setFrom(2,i,m+r+1),this.cubeVertexValue.setFrom(3,i,m+1),this.cubeVertexValue.setFrom(4,a,m),this.cubeVertexValue.setFrom(5,a,m+r),this.cubeVertexValue.setFrom(6,a,m+r+1),this.cubeVertexValue.setFrom(7,a,m+1),this.cubeVertexValue.setFrom(8,u,p*n+l),t()}}}}evaluateArray(t,n,r){let s=n.z0+r*n.dz;for(let o=0;o<n.numX;o++)for(let i=0;i<n.numY;i++){let a=n.x0+o*n.dx,u=n.y0+i*n.dy;this.setAt(t,i*n.numX+o,a,u,s)}}setVertexPositions(){for(let t=0;t<9;t++){let n=B_[t];this.cubeVertex[t]=[this.x.min+(this.i+n[0])*this.size.x,this.y.min+(this.j+n[1])*this.size.y,this.z.min+(this.k+n[2])*this.size.z]}}},hx=class{constructor(t,n,r,s,o,i,a,u,c){this.x0=t;this.y0=n;this.z0=r;this.dx=s;this.dy=o;this.dz=i;this.numX=a;this.numY=u;this.numZ=c}setupArray(t){return new t(this.numX*this.numY)}};var bx=class{constructor(t){this.length=t;this.n=1;this.buffer=new Float64Array(t)}set(t,n){this.buffer[t]=n}get(t){return this.buffer[t]}setFrom(t,n,r){if(n.n!==this.n)throw new Error(\"Programming Error: Mismatched dimensions\");this.set(t,n.get(r))}},xx=class{constructor(t){this.length=t;this.n=2;this.buffer=new Float64Array(t*2)}set(t,n,r){this.buffer[t*2]=n,this.buffer[t*2+1]=r}getX(t){return this.buffer[t*2]}getY(t){return this.buffer[t*2+1]}setFrom(t,n,r){if(n.n!==this.n)throw new Error(\"Programming Error: Mismatched dimensions\");this.set(t,n.getX(r),n.getY(r))}};function Iy(e,t,n,r,s,o=100){if(isFinite(r)||([r,s]=[s,r],[t,n]=[n,t]),isFinite(s))return WC(e,t,n,r,s,o);for(;;){let i=Si(t,n,.5),a=e(...i);if(a===0)return i;if(!isFinite(a))n=i,s=a;else if(r<0==a<0)t=i,r=a;else return n=i,s=a,WC(e,t,n,r,s,o);if(o*=.5,o<1)return}}function U_(e,t,n,r,s,o=100){if(isFinite(r)||([r,s]=[s,r],[t,n]=[n,t]),!isFinite(s))for(;;){let i=Si(t,n,.5),a=e(...i);if(a===0)return{posNeg:i};if(!isFinite(a))n=i,s=a;else if(r<0==a<0)t=i,r=a;else if(r>0){n=i,s=a;break}else return{posNeg:jC(e,i,t,a,r,o),posNaN:p$(e,i,n,o)};if(o*=.5,o<1){let u=Si(t,n,.5);return r>0?{posNaN:u}:{}}}return{posNeg:WC(e,t,n,r,s,o)}}function WC(e,t,n,r,s,o){return r>0?jC(e,t,n,r,s,o):jC(e,n,t,s,r,o)}function jC(e,t,n,r,s,o){let i=r-s;for(;;){let a=Si(t,n,.5),u=e(...a);if(u<0)n=a,s=u;else if(u>0)t=a,r=u;else return u===0?a:void 0;if(o*=.5,o<1){if(r-s<.1*i)return Si(t,n,.5);if(o<1e-6)return}}}function p$(e,t,n,r){for(;;){let s=Si(t,n,.5),o=e(...s);if(!isFinite(o))n=s;else if(o>=0)t=s;else return;if(r*=.5,r<1)return Si(t,n,.5)}}var Ey=50;function fp(e){return e!==void 0&&e!==0}function m$(e){return fp(e.posNeg)||fp(e.posNaN)}var Py={};function JC(e=Py,t=Py,n=Py){return{edge0:e,edge1:t,edge2:n}}function z_(e,t,n,r,{isInequality:s}){return new QC(e,t,new we(n.xmin,n.xmax),new we(n.ymin,n.ymax),new we(n.zmin,n.zmax),r,{isInequality:s}).fullLoopOverUnitCubes()}var QC=class extends md{constructor(n,r,s,o,i,a,{isInequality:u}){super(bx,s,o,i,a);this.f=n;this.gradient=r;this.cubeEdge=new Array(26);this.face=JC();this.cubeHasCrossing=!1;this.allNormalsFromGradient=!0;this.normalFromGradient=[];this.edgesMaybeCross=0;this.positions=[];this.uvs=[];this.normals=[];this.triangles=[];this.isInequality=u,this.sheet=Array((a+1)*(a+1)),this.strip=Array(a+1);for(let c=0;c<(a+1)*(a+1);c++)this.sheet[c]=JC();for(let c=0;c<a+1;c++)this.strip[c]=JC()}setAt(n,r,s,o,i){let a=this.f(s,o,i);n.set(r,a)}fullLoopOverUnitCubes(){this.positions=[],this.normals=[],this.triangles=[],this.loopOverUnitCubes(this.onEachCube.bind(this));let{uvs:n,positions:r,normals:s}=this;if(!this.allNormalsFromGradient)for(let o=0;o<s.length/3;o++){if(this.normalFromGradient[o])continue;let i=s[3*o],a=s[3*o+1],u=s[3*o+2],c=Math.sqrt(i*i+a*a+u*u);s[3*o]=i/c,s[3*o+1]=a/c,s[3*o+2]=u/c}return id(this.triangles,this.positions,s,n,0,[],.7),{positions:r,normals:s,faces:this.triangles,uvs:n,resolved:!0,extraAttrs:[]}}onEachCube(){this.edgesMaybeCross=0,this.cubeHasCrossing=!1;for(let n=0;n<26;n++){let r=this.cubeVertexValue.get(Wr[n*2]),s=this.cubeVertexValue.get(Wr[n*2+1]);(r===0||s===0)&&(this.cubeHasCrossing=!0),!(r>0&&s>0||r<0&&s<0)&&(isFinite(r)||isFinite(s))&&(this.edgesMaybeCross|=1<<n)}this.edgesMaybeCross&&(this.setVertexPositions(),this.setEdges()),this.saveEdges(),this.cubeHasCrossing&&this.generateTriangles()}setEdges(){let{i:n,j:r,k:s,gridsize:o}=this,i=this.sheet[(n+0)*(o+1)+r+0],a=this.sheet[(n+1)*(o+1)+r+0],u=this.sheet[(n+0)*(o+1)+r+1],c=0;s>0&&(this.cubeEdge[0]=i.edge0,this.cubeEdge[1]=i.edge1,this.cubeEdge[2]=i.edge2,this.cubeEdge[3]=u.edge2,this.cubeEdge[4]=a.edge0,c|=31),r>0&&(this.cubeEdge[5]=this.strip[n].edge0,this.cubeEdge[6]=this.strip[n].edge1,this.cubeEdge[7]=this.strip[n+1].edge0,this.cubeEdge[8]=this.strip[n].edge2,c|=480,s==0&&(this.cubeEdge[2]=i.edge2,c|=4)),n>0&&(this.cubeEdge[9]=this.face.edge0,this.cubeEdge[10]=this.face.edge1,this.cubeEdge[11]=this.face.edge2,c|=3584,s==0&&(this.cubeEdge[0]=i.edge0,c|=1),r==0&&(this.cubeEdge[5]=this.strip[n].edge0,c|=32));for(let p=0;p<26;p++){if(~this.edgesMaybeCross>>p&1){this.cubeEdge[p]=Py;continue}if(c>>p&1){!this.cubeHasCrossing&&(this.cubeEdge[p].posNeg||this.cubeEdge[p].posNaN)&&(this.cubeHasCrossing=!0);continue}let l=this.findSurfaceCrossingEDI(Wr[p*2],Wr[p*2+1]);this.cubeEdge[p]=l,m$(l)&&(this.cubeHasCrossing=!0)}}saveEdges(){let{i:n,j:r,k:s,gridsize:o}=this;s<o-1&&(this.sheet[(n+0)*(o+1)+r+0].edge0=this.cubeEdge[11],this.sheet[(n+0)*(o+1)+r+0].edge1=this.cubeEdge[17],this.sheet[(n+0)*(o+1)+r+0].edge2=this.cubeEdge[8]),r<o-1&&(this.strip[n].edge0=this.cubeEdge[10],this.strip[n].edge1=this.cubeEdge[12],this.strip[n].edge2=this.cubeEdge[14]),n<o-1&&(this.face.edge0=this.cubeEdge[15],this.face.edge1=this.cubeEdge[13],this.face.edge2=this.cubeEdge[16]),s==0&&(this.sheet[(n+0)*(o+1)+r+1].edge2=this.cubeEdge[3],this.sheet[(n+1)*(o+1)+r+0].edge0=this.cubeEdge[4]),r==0&&(this.strip[n+1].edge0=this.cubeEdge[7]),r==o-1&&(this.sheet[n*(o+1)+o].edge2=this.cubeEdge[14]),n==o-1&&(this.sheet[(o+0)*(o+1)+r].edge0=this.cubeEdge[16],this.strip[o].edge0=this.cubeEdge[13])}findSurfaceCrossingEDI(n,r){let s=this.cubeVertexValue.get(n),o=this.cubeVertexValue.get(r);if(s===0||o===0)return Py;let i=this.cubeVertex[n],a=this.cubeVertex[r];if(this.isInequality){let{posNeg:u,posNaN:c}=U_(this.f,i,a,s,o);return{posNeg:u!==void 0?this.pushPositionWithGradient(...u):void 0,posNaN:c!==void 0?this.pushPositionNoGradient(...c):void 0}}else{let u=Iy(this.f,i,a,s,o);return{posNeg:u!==void 0?this.pushPositionWithGradient(...u):void 0}}}pushPositionWithGradient(n,r,s){if(!(isFinite(n)&&isFinite(r)&&isFinite(s)))return 0;let[o,i,a]=this.computeGradient(n,r,s),u=Math.sqrt(o*o+i*i+a*a);return o/=-u,i/=-u,a/=-u,Hp(o,i,a)?(this.normalFromGradient.push(!0),this._pushPositionAndNormal(n,r,s,o,i,a)):this.pushPositionNoGradient(n,r,s)}pushPositionNoGradient(n,r,s){return isFinite(n)&&isFinite(r)&&isFinite(s)?(this.allNormalsFromGradient=!1,this.normalFromGradient.push(!1),this._pushPositionAndNormal(n,r,s,0,0,0)):0}_pushPositionAndNormal(n,r,s,o,i,a){return this.positions.push(n,r,s),this.uvs.push((n-this.x.min)/this.x.width,(r-this.y.min)/this.y.width),this.normals.push(o,i,a),this.positions.length/3}computeGradient(n,r,s){let o=NaN,i=NaN,a=NaN;if(this.gradient&&([o,i,a]=this.gradient(n,r,s),isFinite(o)&&isFinite(i)&&isFinite(a)))return[o,i,a];let u=.001*Math.min(this.size.x,this.size.y,this.size.z),c=this.f(n,r,s);if(isFinite(o)||(o=(this.f(n+u,r,s)-c)/u),isFinite(o)||(o=(c-this.f(n-u,r,s))/u),isFinite(i)||(i=(this.f(n,r+u,s)-c)/u),isFinite(i)||(i=(c-this.f(n,r-u,s))/u),isFinite(a)||(a=(this.f(n,r,s+u)-c)/u),isFinite(a)||(a=(c-this.f(n,r,s-u))/u),isFinite(o)&&isFinite(i)&&isFinite(a))return[o,i,a];let p=NaN,l=NaN,m=NaN,d=NaN,y=NaN,g=NaN,f=u/2;return(!isFinite(o)||!isFinite(i))&&(p=(this.f(n+f,r+f,s)-c)/u,isFinite(p)||(p=(c-this.f(n-f,r-f,s))/u),l=(this.f(n+f,r-f,s)-c)/u,isFinite(l)||(l=(c-this.f(n-f,r+f,s))/u),isFinite(p)&&isFinite(l)&&(isFinite(o)||(o=p+l),isFinite(i)||(i=p-l))),(!isFinite(i)||!isFinite(a))&&(m=(this.f(n,r+f,s+f)-c)/u,isFinite(m)||(m=(c-this.f(n,r-f,s-f))/u),d=(this.f(n,r+f,s-f)-c)/u,isFinite(d)||(d=(c-this.f(n,r-f,s+f))/u),isFinite(m)&&isFinite(d)&&(isFinite(i)||(i=m+d),isFinite(a)||(a=m-d))),(!isFinite(a)||!isFinite(o))&&(y=(this.f(n+f,r,s+f)-c)/u,isFinite(y)||(y=(c-this.f(n-f,r,s-f))/u),g=(this.f(n-f,r,s+f)-c)/u,isFinite(g)||(g=(c-this.f(n+f,r,s-f))/u),isFinite(y)&&isFinite(g)&&(isFinite(o)||(o=y-g),isFinite(a)||(a=y+g))),[o,i,a]}generateTriangles(){for(let n=0;n<12;n++){let r=gx[n],s=[],o=0,i=V_[n],a=0,u=i[0],c=Math.abs(this.cubeVertexValue.get(u));c>a&&isFinite(c)&&(a=c);let p=i[1],l=Math.abs(this.cubeVertexValue.get(p));l>a&&isFinite(l)&&(a=l);let m=i[2],d=Math.abs(this.cubeVertexValue.get(m));d>a&&isFinite(d)&&(a=d);let y=i[3],g=Math.abs(this.cubeVertexValue.get(y));g>a&&isFinite(g)&&(a=g);let f=a*Number.EPSILON*32;if(c<=f){o|=35;let x=this.pushPositionWithGradient(...this.cubeVertex[u]);x!==void 0&&s.push(x)}if(l<=f){o|=21;let x=this.pushPositionWithGradient(...this.cubeVertex[p]);x!==void 0&&s.push(x)}if(d<=f){o|=14;let x=this.pushPositionWithGradient(...this.cubeVertex[m]);x!==void 0&&s.push(x)}if(g<=f){o|=56;let x=this.pushPositionWithGradient(...this.cubeVertex[y]);x!==void 0&&s.push(x)}if(s.length===4)continue;let h;for(let x=0;x<4;x++){let T=i[x];if(this.cubeVertexValue.get(T)>f){h=this.cubeVertex[T];break}}if(h===void 0&&this.isInequality)for(let x=0;x<6;x++){if(o>>x&1)continue;let{posNeg:T,posNaN:P}=this.cubeEdge[r[x]];if(fp(T)&&fp(P)){h=Si(this.positions.slice((T-1)*3,T*3),this.positions.slice((P-1)*3,P*3),.5);break}}if(h===void 0)for(let x=0;x<4;x++){let T=i[x];if(!isFinite(this.cubeVertexValue.get(T))){h=this.cubeVertex[T];break}}if(h===void 0&&o&&s.length>0){let x;for(let T=0;T<4;T++){let P=i[T];if(this.cubeVertexValue.get(P)<-f){x=this.cubeVertex[P];break}}if(x){let T=s[0],P=this.positions.slice((T-1)*3,T*3);h=Si(x,P,2)}}if(h!==void 0){if(this.isInequality){let x=[],T=[],P=!1;for(let M=0;M<6;M++){if(o>>M&1)continue;let{posNeg:S,posNaN:E}=this.cubeEdge[r[M]],v=fp(S),D=fp(E);v&&x.push(S),D&&T.push(E),v&&D&&(P=!0)}if(P){x.push(...s),this.pushTriangleFromCorners(T,h),this.pushTriangleFromCorners(x,h);continue}}for(let x=0;x<6;x++){if(o>>x&1)continue;let{posNeg:T,posNaN:P}=this.cubeEdge[r[x]],M=T||P;fp(M)&&s.push(M)}this.pushTriangleFromCorners(s,h)}}}pushTriangleFromCorners(n,r){if(n.length>=3){let s=n[0]-1,o=n[1]-1,i=n[2]-1;this.pushTriangle(s,o,i,r)}if(n.length==4){let s=n[0]-1,o=n[2]-1,i=n[3]-1;this.pushTriangle(s,o,i,r)}}pushTriangle(n,r,s,o){this.allNormalsFromGradient||this.fixBadNormals(n,r,s,o),this.checkWindingOrder(n,r,s)&&([r,s]=[s,r]),this.triangles.push(n,r,s)}fixBadNormals(n,r,s,o){let i=!this.normalFromGradient[n],a=!this.normalFromGradient[r],u=!this.normalFromGradient[s];if(!(i||a||u))return;let c=this.positions,p=this.normals,l=new Ke(c[3*n],c[3*n+1],c[3*n+2]),m=new Ke(c[3*r],c[3*r+1],c[3*r+2]),d=new Ke(c[3*s],c[3*s+1],c[3*s+2]),y=new Ke().subVectors(d,l),g=new Ke().subVectors(l,m),f=y.cross(g),h=new Ke().subVectors(l,new Ke(...o));f.dot(h)<0&&f.multiply(-1),f.isFinite()&&(i&&(p[3*n+0]+=f.x,p[3*n+1]+=f.y,p[3*n+2]+=f.z),a&&(p[3*r+0]+=f.x,p[3*r+1]+=f.y,p[3*r+2]+=f.z),u&&(p[3*s+0]+=f.x,p[3*s+1]+=f.y,p[3*s+2]+=f.z))}checkWindingOrder(n,r,s){let o=this.positions,i=this.normals,a=o[3*s]-o[3*n],u=o[3*s+1]-o[3*n+1],c=o[3*s+2]-o[3*n+2],p=o[3*n]-o[3*r],l=o[3*n+1]-o[3*r+1],m=o[3*n+2]-o[3*r+2],d=u*m-c*l,y=c*p-a*m,g=a*l-u*p,f=i[3*n],h=i[3*n+1],x=i[3*n+2];return d*f+y*h+g*x<0}};var{floor:d$}=Math;function KC(e){let t=[];for(let n of e)t.push(...n),t.push(NaN,NaN,NaN);return t}function yp(e,t,n,r){(n===void 0||isNaN(n))&&(n=tv(t.min,t.max)),n=tr(d$(n),2,2e3);let{xmin:s,xmax:o,ymin:i,ymax:a,zmin:u,zmax:c}=r.viewport;u!=null||(u=Fr.zmin),c!=null||(c=Fr.zmax);let p=Tx(e,{min:t.min,max:t.max,nInitialSamples:n,xtolerance:(o-s)/1e3,ytolerance:(a-i)/1e3,ztolerance:(c-u)/1e3,map:l=>l});return KC(p.segments)}function ev(e,t,n,r){let s=r.degreeMode?Math.PI/180:1;return yp(o=>{let i=e(o),a=i[0],u=i[1],c=i[2];return[a*Fn(u*s),a*Cn(u*s),c]},t,n,r)}function k_(e,t,n,r){let s=r.degreeMode?Math.PI/180:1;return yp(o=>{let i=e(o),a=i[0],u=i[1],c=i[2];return[a*Cn(c*s)*Fn(u*s),a*Cn(c*s)*Cn(u*s),a*Fn(c*s)]},t,n,r)}function W_(e,t,n,r){let s=f$(e,t,n,r);return KC(s)}function f$(e,t,n,r){return new ov(e,t,new we(n.xmin,n.xmax),new we(n.ymin,n.ymax),new we(n.zmin,n.zmax),r).run()}var y$={},ov=class extends md{constructor(n,r,s,o,i,a){super(xx,s,o,i,a);this.f=n;this.g=r;this.vertexFGZs={};this.vertexZeroF={};this.vertexZeroG={};this.threshF=0;this.threshG=0;this.cubeID=0;this.edgesMaybeCrossF=0;this.edgesMaybeCrossG=0;this.tetEdgeCrossings=new Array(26);this.edgeFGZs=new Array(26);this.edgeCrossings=new Map;this.allFGZs=new Map}setAt(n,r,s,o,i){let a=this.f(s,o,i),u=this.g(s,o,i);n.set(r,a,u)}run(){return this.loopOverUnitCubes(this.onEachCube.bind(this)),this.traceCurves()}onEachCube(){this.cubeID=H_(this.i,this.j,this.k),this.pruneEdges(),this.edgesMaybeCrossF&&this.edgesMaybeCrossG&&(this.setVertexPositions(),this.setVertexZeros(),this.setEdgeCrossings(),this.insertCurveSegmentsFromCube())}pruneEdges(){this.edgesMaybeCrossF=0,this.edgesMaybeCrossG=0;for(let n=0;n<26;n++){let r=Wr[n*2],s=Wr[n*2+1],o=this.cubeVertexValue.getX(r),i=this.cubeVertexValue.getY(r),a=this.cubeVertexValue.getX(s),u=this.cubeVertexValue.getY(s);!(o>0&&a>0||o<0&&a<0)&&(isFinite(o)||isFinite(a))&&(this.edgesMaybeCrossF|=1<<n),!(i>0&&u>0||i<0&&u<0)&&(isFinite(i)||isFinite(u))&&(this.edgesMaybeCrossG|=1<<n)}}setVertexZeros(){let n=0,r=0;for(let i=0;i<9;i++){let a=this.cubeVertexValue.getX(i),u=this.cubeVertexValue.getY(i),c=Math.abs(a),p=Math.abs(u);c>n&&isFinite(c)&&(n=c),p>r&&isFinite(c)&&(r=p)}let s=this.threshF=n*Number.EPSILON*32,o=this.threshG=r*Number.EPSILON*32;for(let i=0;i<9;i++){let a=this.cubeVertexValue.getX(i),u=this.cubeVertexValue.getY(i),c=Math.abs(a),p=Math.abs(u);if(this.vertexZeroF[i]=c<=s,this.vertexZeroG[i]=p<=o,c<=s&&p<=o){let l=this.cubeVertex[i],m=this.createFGZ(q_(this.cubeID,i),l);this.vertexFGZs[i]=m}else this.vertexFGZs[i]=void 0}}getEdgeCrossings(n){let r=this.edgesMaybeCrossF>>n&1,s=this.edgesMaybeCrossG>>n&1;if(!r&&!s)return y$;let o=Ty(this.cubeID,n),i=this.edgeCrossings.get(o);if(i!==void 0)return i;let a=this.getEdgeCrossingsUncached(n,r,s);return this.edgeCrossings.set(o,a),a}getEdgeCrossingsUncached(n,r,s){let o=Wr[n*2],i=Wr[n*2+1],a=this.cubeVertexValue.getX(o),u=this.cubeVertexValue.getY(o),c=this.cubeVertexValue.getX(i),p=this.cubeVertexValue.getY(i),l=this.cubeVertex[o],m=this.cubeVertex[i],d=!r||a===0||c===0?void 0:Iy(this.f,l,m,a,c),y=!s||u===0||p===0?void 0:Iy(this.g,l,m,u,p),g=this.threshF;!d&&y&&Math.abs(a)<=g&&Math.abs(c)<=g&&Math.abs(this.f(y[0],y[1],y[2]))<=g&&(d=y);let f=this.threshG;return!y&&d&&Math.abs(u)<=f&&Math.abs(p)<=f&&Math.abs(this.g(d[0],d[1],d[2]))<=f&&(y=d),{f:d,g:y}}getTriangleCrossing(n){let r=XC(this.cubeID,n),s=this.allFGZs.get(r);if(s!==void 0)return s;let o=this.getTriangleCrossingUncached(n);return this.allFGZs.set(r,o),o}createFGZ(n,r){let s=this.allFGZs.get(n);if(s)return s;let o={id:n,pos:r,connections:[],visited:!1};return this.allFGZs.set(n,o),o}getTriangleCrossingUncached(n){let r=[],s=[],o=ZC[n];for(let a=0;a<3;a++){let u=o[a];if(this.vertexFGZs[u])return null;this.vertexZeroF[u]&&r.push(this.cubeVertex[u]),this.vertexZeroG[u]&&s.push(this.cubeVertex[u])}let i=YC[n];for(let a=0;a<3;a++){let u=i[a],c=this.tetEdgeCrossings[u];if(this.edgeFGZs[u]||!c)continue;let p=c.f,l=c.g,m=Wr[2*u],d=Wr[2*u+1];p&&!this.vertexZeroF[m]&&!this.vertexZeroF[d]&&r.push(p),l&&!this.vertexZeroG[m]&&!this.vertexZeroG[d]&&s.push(l)}if(r.length===2&&s.length===2){let a=g$(r[0],r[1],s[0],s[1]);return a?{id:XC(this.cubeID,n),pos:a,connections:[],visited:!1}:null}else return null}setEdgeCrossings(){for(let n=0;n<26;n++){let r=this.getEdgeCrossings(n),s=r.f,o=r.g,i=Wr[n*2],a=Wr[n*2+1];if(this.vertexFGZs[i]||this.vertexFGZs[a])this.tetEdgeCrossings[n]=void 0,this.edgeFGZs[n]=void 0;else if(s&&this.vertexZeroG[i]&&this.vertexZeroG[a]){let u=this.createFGZ(Ty(this.cubeID,n),s);this.edgeFGZs[n]=u,this.tetEdgeCrossings[n]=void 0}else if(o&&this.vertexZeroF[i]&&this.vertexZeroF[a]){let u=this.createFGZ(Ty(this.cubeID,n),o);this.edgeFGZs[n]=u,this.tetEdgeCrossings[n]=void 0}else if(s&&o&&Wu(s,o)<1e-8){let u=this.createFGZ(Ty(this.cubeID,n),s);this.edgeFGZs[n]=u,this.tetEdgeCrossings[n]=void 0}else this.edgeFGZs[n]=void 0,this.tetEdgeCrossings[n]=r}}insertCurveSegmentsFromCube(){for(let n=0;n<12;n++)this.insertCurveSegmentsFromTetrahedron(n)}insertCurveSegmentsFromTetrahedron(n){let r=[],s=G_[n];for(let p=0;p<4;p++){let l=this.getTriangleCrossing(s[p]);l&&r.push(l)}let o=[],i=gx[n];for(let p=0;p<6;p++){let l=this.edgeFGZs[i[p]];l&&o.push(l)}let a=[],u=[Wr[i[0]*2],Wr[i[0]*2+1],Wr[i[3]*2],Wr[i[3]*2+1]];for(let p of u){let l=this.vertexFGZs[p];l&&a.push(l)}let c=[...a,...o,...r];switch(c.length){case 0:case 1:break;case 2:this.connectCrossings(c[0],c[1]);break;case 3:r.length===2&&this.connectCrossings(r[0],r[1]);break;case 4:r.length===4&&(this.connectCrossings(r[0],r[1]),this.connectCrossings(r[2],r[3]));break;default:throw new Error(\"Programming error: 5 is impossible.\")}}connectCrossings(n,r){n.connections.some(s=>s.id===r.id)||r.connections.some(s=>s.id===n.id)||n.connections.length>=2||r.connections.length>=2||(n.connections.push(r),r.connections.push(n))}traceCurves(){let n={xtolerance:this.size.x*.1,ytolerance:this.size.y*.1,ztolerance:this.size.z*.1,map:s=>s},r=new Oi(n);for(let s of this.allFGZs.values())s&&!s.visited&&s.connections.length===1&&this.traceCurve(r,s);for(let s of this.allFGZs.values())s&&!s.visited&&this.traceCurve(r,s);return r.finish().segments}traceCurve(n,r){let s=r;for(;;){n.addPoint(r.pos),r.visited=!0;let o;for(let i of r.connections)i.visited||(o=i);if(!o)break;r=o}s.connections.length===2&&n.addPoint(s.pos),n.breakSegment()}},[Ix,$_,nv]=[new Ke,new Ke,new Ke],Y_=new Ke,[rv,sv,Z_]=[new Ke,new Ke,new Ke],[Px,X_,Ex]=[new Ke,new Ke,new Ke];function g$(e,t,n,r){Ix.set(e[0],e[1],e[2]),$_.set(t[0],t[1],t[2]),nv.set(n[0],n[1],n[2]),Y_.set(r[0],r[1],r[2]),rv.subVectors($_,Ix),sv.subVectors(Y_,nv),Z_.subVectors(nv,Ix),Px.crossVectors(rv,sv),X_.crossVectors(Z_,sv);let s=Px.dot(X_)/Px.dot(Px);return 0<=s&&s<=1?(Ex.addVectors(Ix,rv.multiply(s)),[Ex.x,Ex.y,Ex.z]):null}var j_=80;var iv=class extends ad{constructor(n,r,s,o,i,a){let u=s.width/1e8,c=o.width/1e8;super({resolution:i,uRange:s,vRange:o,du:u,dv:c,extraAttrCount:a});this.vertices=[];this.fn=n=>{let r=this._fn(n),s=this.tangentInForced(n,[this.du,0],r),o=this.tangentInForced(n,[0,this.dv],r),i=Gp(s,o);return{uv:n,f:r,normal:i,dfEast:s,dfNorth:o}};this._fn=p=>n(p[0],p[1]),this.xmin=r.xmin*6-r.xmax*5,this.xmax=r.xmax*6-r.xmin*5,this.ymin=r.ymin*6-r.ymax*5,this.ymax=r.ymax*6-r.ymin*5,this.zmin=r.zmin*6-r.zmax*5,this.zmax=r.zmax*6-r.zmin*5,this.distThresh=((r.xmax-r.xmin)*1e-6)**2}getVertexCount(){return this.vertices.length}getUV(n){return this.vertices[n].uv}getNormal(n){return this.vertices[n].normal}_addVertex(n){return this.vertices.push(n)-1}copyVertex(n){return this.addVertex(this.vertices[n])}getF(n){return this.vertices[n].f}getDfNorth(n){return this.vertices[n].dfNorth}getDfEast(n){return this.vertices[n].dfEast}insidePaddedDomain(n){return this.zmin<=n[2]&&n[2]<=this.zmax&&this.ymin<=n[1]&&n[1]<=this.ymax&&this.xmin<=n[0]&&n[0]<=this.xmax}tangentInForced(n,r,s){let o=kd(n,r);return xI(this._fn(o),s)}_isVertexAtCrease(n){let r=this.getUV(n),s=this.getDfEast(n),o=this.getDfNorth(n),i=this.getF(n),a=this.tangentInForced(r,[-this.du,0],i);if(TI(a,s)/Math.sqrt(Bp(a)*Bp(s))>-ud)return!0;let c=this.tangentInForced(r,[0,-this.dv],i);return TI(o,c)/Math.sqrt(Bp(o)*Bp(c))>-ud}hintedNormal(n,r){let s=this.getUV(n),o=this.getF(n),i=Gp(this.tangentInForced(s,r[0],o),this.tangentInForced(s,r[1],o));return Hp(...i)?i:this.getNormal(n)}getVertex(n){if(this.allowVertex(n))return this.getF(n)}getExtraAttr(n,r){return this.vertices[n].f[3+r]}findJumpBetweenTwoSamples(n,r){let s=this.getUV(n),o=this.getF(n),i=0,a=this.getUV(r),u=this.getF(r),c=1,p=d=>this._fn(br(s,a,d));if(!isFinite(o[0])||!isFinite(o[1])||!isFinite(o[2])||!isFinite(u[0])||!isFinite(u[1])||!isFinite(u[2]))return;let m=Ng(i,o,c,u,p,(this.xmax-this.xmin)*1e-6,0,0);if(m)return[this.fn(br(s,a,Ei(m[0],0,1e-5))),this.fn(br(s,a,Ei(m[1],1,1e-5)))]}clip(n){return this.insidePaddedDomain(n)?n:[NaN,NaN,NaN]}findFiniteBetweenTwoSamples(n,r){let s=this.getUV(n),o=this.getF(n),i=this.getUV(r),a=this.getF(r),u=p=>this.clip(this._fn(br(s,i,p))),c=Dg(0,this.clip(o),1,this.clip(a),u);if(c!==void 0)return this.fn(br(s,i,c))}allowVertex(n){return this.insidePaddedDomain(this.getF(n))}isDegenerate(n,r,s){let o=this.getF(n),i=this.getF(r);if(Wu(o,i)<this.distThresh)return!0;let a=this.getF(s);return Wu(i,a)<this.distThresh||Wu(o,a)<this.distThresh}};function Sy(e,t,n,r,s,o){let i=new iv(e,t,n,r,s,o);return ax(i)}function J_(e){return h$(e)||Mx(e)||Q_(e)}function h$(e){return e===3}function Sx(e,t,n,r){return e.is3dPolicy()&&Mx(t.graphMode)?My(t,n,r!=null?r:1):t}function Mx(e){switch(e){case 1:case 2:case 6:case 8:case 5:return!0;default:return!1}}function My(e,t,n,r=0){var i;let s=K_(e,t,r),o=dd(s,t.viewport,n);return{graphMode:128,guid:ys(),points:o,resolved:e.resolved,color:e.color,compiled:e.compiled,thickness:(i=e.lineWidth)!=null?i:1}}function cv(e,t,n){return e.is3dPolicy()&&Q_(t.graphMode)?b$(t,n):t}function Q_(e){switch(e){case 17:case 24:return!0;default:return!1}}function b$(e,t){var r;let n=K_(e,t);return{graphMode:e.graphMode===17?119:e.graphMode===24?129:128,guid:ys(),points:x$(n),color:e.color,thickness:(r=e.lineWidth)!=null?r:1}}function x$(e){let t=[];for(let[n,r,s]of e)t.push(n,r,s);return t}function K_(e,t,n=0){function r(o,i){if(e.graphMode===1)return[i,o];if(e.graphMode===6){let a=t.degreeMode?o*Math.PI/180:o;return[i*Math.cos(a),i*Math.sin(a)]}else return[o,i]}let s=[];for(let o=0;o<e.segments.length;o++){let i=e.segments[o];for(let a=0;a<i.length/2;a++){let[u,c]=r(i[2*a],i[2*a+1]);s.push([u,c,n])}o<e.segments.length-1&&s.push([NaN,NaN,0])}return s}function dd(e,t,n){if(t.zmin===void 0||t.zmax===void 0)return[];let{xmin:r,xmax:s,ymin:o,ymax:i,zmin:a,zmax:u}=t,c=s-r,p=i-o,l=u-a,m=n/200,d=[],y=1e-4;for(let h=0;h<e.length;h++){let x=e[h];if(isFinite(x[0])&&isFinite(x[1])&&isFinite(x[2])){let T=d[d.length-1];T!==void 0&&Math.abs(x[0]-T[0])<y*c&&Math.abs(x[1]-T[1])<y*p&&Math.abs(x[2]-T[2])<y*l||d.push(x)}else d.push(void 0)}let g=[],f=d.length;for(let h=0;h<f;h++){let x=d[h];if(!x){g.push(NaN,NaN,NaN);continue}let[T,P,M]=x,S=d[h-1],E=d[h+1];if(S&&E){let[v,D,G]=S,[j,Q,W]=E,K=(T-v)/c,J=(j-T)/c,re=(P-D)/p,ie=(Q-P)/p,It=(M-G)/l,Bt=(W-M)/l,xe=Bs(K,re,It),ee=Bs(J,ie,Bt);if((J*K+ie*re+Bt*It)/(xe*ee)<.7&&xe>m&&ee>m){let te=.5*(m/xe),Ce=.5*(m/ee),Ge=oa(v,T,1-te),pt=oa(D,P,1-te),Rt=oa(G,M,1-te),Mo=oa(T,j,Ce),gr=oa(P,Q,Ce),di=oa(M,W,Ce);g.push(Ge,pt,Rt),g.push(oa(Ge,T,.5),oa(pt,P,.5),oa(Rt,M,.5)),g.push(T,P,M),g.push(oa(T,Mo,.5),oa(P,gr,.5),oa(M,di,.5)),g.push(Mo,gr,di)}else g.push(T,P,M)}else g.push(T,P,M)}return g}function oa(e,t,n){return(1-n)*e+n*t}function uv(e,t){let n=t!=null?t:{};if(!Array.isArray(e))return()=>e;let r=Object.keys(n).length===0?e:e.filter((s,o)=>!n[o]);return s=>r[s]}function ew(e){var o,i;let t=e.droppedIndices,n=uv((o=e.pointSize)!=null?o:1,t),r=uv(e.color,t),s=uv((i=e.pointOpacity)!=null?i:1,t);return e.segments[0].map(([a,u],c)=>({graphMode:114,position:[a,u,0],radius:.02*n(c),guid:ys(),color:r(c),fillOpacity:s(c)}))}var ni={pointsOfInterest:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,sliders:!0};function lv(e){return Math.abs(e)<5e-8}var Cy=class extends Oi{constructor(t,n,r){let{tolerance:s,mathToPixels:o}=t;super({tolerance:s,map:i=>o.mapCoordinatePair(i)}),this.fn=n,this.mappedFn=i=>o.mapY(n(i)),this.derivative=r,this.poiData={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}},this.zeroBuffer=[],this.extremumBuffer=[]}getPOI(){return ni.pointsOfInterest?(this.poiData.intercept=this.findIntercept(this.fn),this.poiData):{zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}}}addPoint(t){this.segment.length===0&&lv(t[1])&&(this.poiData.zeros.x.push(t[0]),this.poiData.zeros.y.push(t[1])),this.updateZeroBuffer(t),this.updateExtremumBuffer(t),super.addPoint(t)}updateZeroBuffer(t){let[n,r]=this.map?this.map(t):t;if(!isFinite(n)||!isFinite(r)){this.zeroBuffer.length=0;return}switch(this.zeroBuffer.length){case 0:{if(lv(t[1]))return;this.zeroBuffer.push(t);return}case 1:if(t[1]===0){this.zeroBuffer.push(t);return}else if(t[1]>0!=this.zeroBuffer[0][1]>0){let s=MI(this.zeroBuffer[0][0],this.zeroBuffer[0][1],t[0],t[1],this.fn);s&&(this.poiData.zeros.x.push(s[0]),this.poiData.zeros.y.push(s[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}case 2:{if(t[1]===0)return;if(t[1]>0!=this.zeroBuffer[0][1]>0){let s=Yd(this.zeroBuffer[0][0],this.zeroBuffer[0][1],this.zeroBuffer[1][0],this.zeroBuffer[1][1],t[0],t[1],this.fn);s&&(this.poiData.zeros.x.push(s[0]),this.poiData.zeros.y.push(s[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}}}}updateExtremumBuffer(t){let[n,r]=this.map?this.map(t):t;if(!isFinite(n)||!isFinite(r)){this.extremumBuffer.length=0;return}switch(this.extremumBuffer.length){case 0:{this.extremumBuffer.push(t);return}case 1:{t[1]===this.extremumBuffer[0][1]&&(this.extremumBuffer.length=0),this.extremumBuffer.push(t);return}case 2:if(t[1]===this.extremumBuffer[1][1]){this.extremumBuffer.push(t);return}else if(t[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let s=this.bisectExtremumUsingDerivative(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],t[0],t[1]);s&&(this.poiData.extrema.x.push(s[0]),this.poiData.extrema.y.push(s[1]),!qp(this.extremumBuffer[0][0],this.mappedFn(this.extremumBuffer[0][0]),s[0],this.mappedFn(s[0]),t[0],this.mappedFn(t[0]),this.mappedFn,this.ytolerance)&&s[0]>this.segment[this.segment.length-2]&&(this.pendingPoint=s)),this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}else{this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}case 3:{if(t[1]===this.extremumBuffer[1][1])return;if(t[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let s,o=.5*(this.extremumBuffer[1][0]+this.extremumBuffer[2][0]),i=this.fn(o);i===this.extremumBuffer[1][1]?s=Yd(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],t[0],t[1],this.fn):s=this.bisectExtremumUsingDerivative(this.extremumBuffer[1][0],this.extremumBuffer[1][1],o,i,this.extremumBuffer[2][0],this.extremumBuffer[2][1]),s&&(this.poiData.extrema.x.push(s[0]),this.poiData.extrema.y.push(s[1])),this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}else{this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}}}}bisectExtremumUsingDerivative(t,n,r,s,o,i){let a;if(this.derivative){let u=this.derivative(t),c=this.derivative(o);if(!isNaN(u)&&!isNaN(c)&&(s>n&&u>0&&c<0||s<n&&u<0&&c>0)){let p=MI(t,u,o,c,this.derivative);p&&(a=[p[0],this.fn(p[0])])}}return a||(a=bR(t,n,r,s,o,i,this.fn)),a}breakSegment(){this.zeroBuffer.length=0,this.extremumBuffer.length=0,this.flushPending(),this.segment.length>2&&(this.segments.push(this.segment),lv(this.segment[this.segment.length-1])&&(this.poiData.zeros.x.push(this.segment[this.segment.length-2]),this.poiData.zeros.y.push(this.segment[this.segment.length-1]))),this.segment=[]}findIntercept(t){if(!t)return{x:[],y:[]};let n=t(0);return isFinite(n)?{x:[0],y:[t(0)]}:{x:[],y:[]}}finish(){return{segments:this.getSegments(),resolved:!0,poi:this.getPOI()}}};var{floor:tw}=Math,nw=1e4,Cx=5,rw=(e,t,n)=>({x:e,y:t,z:n}),sw=(e,t,n)=>({x:n,y:e,z:t}),ow=(e,t,n)=>({x:e,y:n,z:t}),vx=class{constructor(){this.xmin=Fr.xmin;this.xmax=Fr.xmax;this.ymin=Fr.ymin;this.ymax=Fr.ymax;this.zmin=Fr.zmin;this.zmax=Fr.zmax}},T$=0;function ys(){return\"result_\"+T$++}var Dx;(n=>(n.None=void 0,n.ComplexCoercion=\"ComplexCoercion\"))(Dx||(Dx={}));function I$(){return{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}}}function lw(e){return{graphMode:15,error:e,segments:[]}}function mv(e,t){let n=e[0]+t.min*e[1],r=e[0]+t.max*e[1],s={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}};if(!isFinite(n)||!isFinite(r))return{segments:[],poi:s,resolved:!0};let o=[[t.min,n,t.max,r]],i=-e[0]/e[1];return!isNaN(i)&&i>=t.min&&i<=t.max&&(s.zeros.x.push(i),s.zeros.y.push(0)),0>=t.min&&0<=t.max&&(s.intercept.x.push(0),s.intercept.y.push(e[0])),{segments:o,poi:s,resolved:!0}}function P$(e,t){let n=mv(e[0],t),r=mv(e[1],t);return n.segments.length&&r.segments.length&&n.segments[0].length===4&&r.segments[0].length===4?{segments:[[n.segments[0][1],r.segments[0][1],n.segments[0][3],r.segments[0][3]]],resolved:!0}:{segments:[],resolved:!0}}function E$(e,t){let n=e(t);return{segments:[[...n,...n]],resolved:!0}}function iw(e,t,n){let{mappedFn:r,jumpTolerance:s,screen:o}=n,[i,a]=e,[u,c]=t,p=zu(i,u),l=r(p),m=o.height;if(!(a<0&&c<0&&(a>=l||c>=l))&&!(a>m&&c>m&&(a<=l||c<=l)))return qp(i,a,p,l,u,c,r,s)}var pv=(e,t,n)=>{let{fn:r,mappedFn:s,jumpTolerance:o,accumulator:i}=n;if(!isFinite(o)||o<=0)return;let a=iw(e,t,n);if(!a)return;let u=(t[0]-e[0])/10,c=[-u,u],p;for(let l=0;l<c.length;l++){let m=e[0]+c[l],d=s(m);isFinite(d)||([m,d]=e,m=e[0],d=e[1]);let y=t[0]+c[l],g=s(y);if(isFinite(g)?p=y:[y,g]=t,iw([m,d],[y,g],n)){let[f,h]=a;i.addPoint([f,r(f)]),i.breakSegment(),i.addPoint([h,r(h)]);return}}return p},dv=class{constructor(t,n,r){let s=o=>n.mathToPixels.mapY(t(o));this.derivative=r,this.accumulator=new Cy(n,t,r),this.fn=t,this.mathToPixels=n.mathToPixels,this.mappedFn=s,this.jumpTolerance=n.tolerance||0,this.screen=n.screen}};function aw(e,t,n,r){let s=n,o=e(s),i=t.mapY(o);return r>0&&!isFinite(i)&&(s=n+r,o=e(s),i=t.mapY(o)),r>0&&!isFinite(i)&&(s=n-r,o=e(s),i=t.mapY(o)),[s,o,i]}function yv(e,t,n){let r=new dv(e,t,n),{mathToPixels:s,mappedFn:o}=r,i=t.nInitialSamples,[a,u,c]=aw(e,s,t.min,0);isFinite(c)&&r.accumulator.addPoint([a,u]);for(let p=1;p<i;p++){let l=s.interpolateX(t.min,t.max,p/(i-1)),m=p===i-1?0:Math.abs(a-l)/10,[d,y,g]=aw(e,s,l,m);if(isFinite(g)&&isFinite(c)){let f=pv([a,c],[d,g],r);f!==void 0&&(d=f,y=e(d),g=s.mapY(y)),r.accumulator.addPoint([d,y])}else if(isFinite(g)&&!isFinite(c)){let f=ws(a,c,d,g,o);if(f!==void 0){f!==d&&r.accumulator.addPoint([f,e(f)]);let h=pv([f,o(f)],[d,g],r);h!==void 0&&(d=h,y=e(d),g=s.mapY(y)),r.accumulator.addPoint([d,y])}}else if(!isFinite(g)&&isFinite(c)){let f=ws(a,c,d,g,o);if(f!==void 0){let h=pv([a,c],[f,o(f)],r);h!==void 0&&(f=h),f!==a&&r.accumulator.addPoint([f,e(f)]),r.accumulator.breakSegment()}}a=d,u=y,c=g}return r.accumulator.finish()}function pw(e){let{fn:t,min:n,max:r}=e,s=Math.floor(n),o=Math.ceil(r),i=!0;o-s+1>nw&&(o=s+(nw-1),i=!1);let a=[];for(let u=s;u<=o;u++){let c=t(u);!isFinite(u)||!isFinite(c)||a.push([u,c])}return{segments:a,resolved:i}}function S$(e,t,n,r){let s=t.min,o=t.max-t.min,i=t.rtoleranceMath,a=Math.floor(o/(Math.PI/n)),u,c,p;function l(m,d){let y=d%2===0?1:-1;if(!r&&y===-1)return!1;let g=d*(Math.PI/n),f=[s,s+1,s+2,s+3],h=!1;for(let x=0,T=f.length;x<T;x++){let P=m(f[x]),M=m(f[x]+g);if(isFinite(P)&&isFinite(M)&&(h=!0),isFinite(P)!==isFinite(M)||Math.abs(P-y*M)>i)return!1}return!!h}for(u=1;u<=a;u++)if(l(e,u)){for(p=u,c=2;c*u<=a;c++)l(e,c*u)||(p=void 0);if(p)break}return p?p*(Math.PI/n):null}function mw(e){return[e[1]*Math.cos(e[0]),e[1]*Math.sin(e[0])]}function Tx(e,t){if(t.max<t.min)return{segments:[],resolved:!0};if(t.parameterTransform){let l=t.parameterTransform,m=e;e=d=>m(l(d))}let{xtolerance:n,ytolerance:r,ztolerance:s,map:o}=t,i=new Oi({xtolerance:n,ytolerance:r,ztolerance:s,map:o}),a=10,u=t.min,c=e(u);isFinite(c[0])&&isFinite(c[1])&&i.addPoint(c);let p=t.nInitialSamples;for(let l=1;l<p;l++){let m=l/(p-1),d=(1-m)*t.min+m*t.max,y=e(d);vy(e,u,c,d,y,a,i,t.screen),u=d,c=y}return i.finish()}function M$(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function vy(e,t,n,r,s,o,i,a){if(r===t)return;let{xtolerance:u,ytolerance:c,ztolerance:p,map:l}=i,m=zu(t,r),d=e(m),y=l(n),g=l(s),f=l(d),h=isFinite(y[0])&&isFinite(y[1])&&(y.length===2||isFinite(y[2])),x=isFinite(g[0])&&isFinite(g[1])&&(g.length===2||isFinite(g[2])),T=isFinite(f[0])&&isFinite(f[1])&&(f.length===2||isFinite(f[2]));if(o===0||m===t||m===r){i.breakSegment(),x&&i.addPoint(s);return}if(!(!h&&!x)){if(h!==x){let P=t,M=r,S=n,E=s;for(;t!==m&&m!==r;)T==h?(t=m,n=d,y=f,h=T):(r=m,s=d,g=f,x=T),m=t+(r-t)/2,d=e(m),f=l(d),T=isFinite(f[0])&&isFinite(f[1])&&(f.length===2||isFinite(f[2]));h?(vy(e,P,S,t,n,o-1,i,a),i.breakSegment()):(i.breakSegment(),i.addPoint(s),vy(e,r,s,M,E,o-1,i,a));return}if(h&&T&&x){let P=M$(y,g),M=qi(f[0],f[1],f[2]||0,y[0],y[1],y[2]||0,g[0],g[1],g[2]||0),S=M>.2&&M<.8&&Math.abs(f[0]-(y[0]+M*(g[0]-y[0])))<=u&&Math.abs(f[1]-(y[1]+M*(g[1]-y[1])))<=c&&(y.length===2||Math.abs(f[2]-(y[2]+M*(g[2]-y[2])))<=p);if(P||S||a&&C$(y,f,g,a)){i.addPoint(s);return}}vy(e,t,n,m,d,o-1,i,a),vy(e,m,d,r,s,o-1,i,a)}}function C$(e,t,n,{width:r,height:s}){return e[0]<0&&n[0]<0&&(e[0]>=t[0]||n[0]>=t[0])||e[0]>r&&n[0]>r&&(e[0]<=t[0]||n[0]<=t[0])||e[1]<0&&n[1]<0&&(e[1]>=t[1]||n[1]>=t[1])||e[1]>s&&n[1]>s&&(e[1]<=t[1]||n[1]<=t[1])}function v$(){return li({positions:[],normals:[],faces:[],uvs:[],resolved:!0,extraAttrs:[]})}function gv(e,t,n,r,s,{isInequality:o}){let i=e.fn,a;return t&&!t.includes(\"z\")?a=yx(i,n,r,\"z\"):t&&!t.includes(\"x\")?a=yx(i,n,r,\"x\"):t&&!t.includes(\"y\")?a=yx(i,n,r,\"y\"):a=z_(i,n,r,s,{isInequality:o}),li(a)}function uw(e,t,n,r,s){let o=Sy(e,t,n,r,s,0);return li(o)}function D$(e,t,n){let r=e.fn,s=ux((o,i)=>r(o,i),new we(t.xmin,t.xmax),new we(t.ymin,t.ymax),new we(t.zmin,t.zmax),n);return li(s)}function N$(e,t,n){let r=e.fn,s=ux((o,i)=>r(o,i),new we(t.ymin,t.ymax),new we(t.zmin,t.zmax),new we(t.xmin,t.xmax),n,[2,0,1]);return li(s)}function R$(e,t,n){let r=e.fn,s=ux((o,i)=>r(i,o),new we(t.zmin,t.zmax),new we(t.xmin,t.xmax),new we(t.ymin,t.ymax),n,[1,2,0]);return li(s)}function O$(e,t,n,r,s,o){let i=o?Math.PI/180:1,a=e.fn,u=Sy((c,p)=>[c*Fn(p*i),c*Cn(p*i),a(c,p)],t,n,r,s,0);return li(u)}function A$(e,t,n,r,s,o){let i=o?Math.PI/180:1,a=e.fn,u=Sy((c,p)=>{let l=a(c,p);return[l*Fn(c*i),l*Cn(c*i),p,l]},t,n,r,s,1);return li(u)}function _$(e,t,n,r,s,o){let i=o?Math.PI/180:1,a=e.fn,u=Sy((c,p)=>{let l=a(c,p);return[l*Cn(p*i)*Fn(c*i),l*Cn(p*i)*Cn(c*i),l*Fn(p*i),l]},t,n,r,s,1);return li(u)}function li(e){let{positions:t,normals:n,faces:r,uvs:s,extraAttrs:o,resolved:i}=e;return{guid:ys(),positions:new Float32Array(t),normals:new Float32Array(n),faces:new Uint32Array(r),uvs:new Float32Array(s),resolved:i,extraAttrs:new Float32Array(o)}}function cw(e){for(let t of e)if(t!==0)return!1;return!0}function dw(e,t){let{min:n,max:r,mathToPixels:s,nInitialSamples:o}=t,i=s.interpolateX(n,r,0),a=e(i),u=cw(a),c=!1,p=[];for(let l=1;l<o;l++){let m=s.interpolateX(n,r,l/(o-1)),d=e(m),y=cw(d);if(u){i=m,a=d,y||(u=!1);continue}if(y){c?(u=!0,c=!1):c=!0;continue}let g=hR(i,a,m,d,e);g!==void 0&&p.push(g),i=m,a=d}return p}function fw(e){if(!e)return!1;let t=e.viewport.xmin,n=e.viewport.xmax,r=e.viewport.ymin,s=e.viewport.ymax;return!(!isFinite(t)||!isFinite(n)||n<=t||!isFinite(r)||!isFinite(s)||s<=r||!isFinite(e.screen.width)||e.screen.width<=0||!isFinite(e.screen.height)||e.screen.height<=0)}function tv(e,t){let n=t-e;return 1+Math.ceil(n/(n/1e3))}var ta=.001,al=new ol(HC(),HC());function hp(e,t,n){var j,Q,W,K,J,re,ie,It,Bt;let{viewport:r,screen:s,xAxisScale:o,yAxisScale:i,degreeMode:a}=e,u=a?Math.PI/180:1,c=e.viewport.xmin,p=e.viewport.xmax,l=e.viewport.ymin,m=e.viewport.ymax,d=(j=e.viewport.zmin)!=null?j:Fr.zmin,y=(Q=e.viewport.zmax)!=null?Q:Fr.zmax,g=((W=t.domain)==null?void 0:W.type)===\"2d\",{uMin:f,uMax:h,vMin:x,vMax:T}=((K=t.domain)==null?void 0:K.type)===\"2d\"?t.domain:{uMin:0,uMax:1,vMin:0,vMax:1},P=t.lineWidth;if(t.willConvertTo3D||P>3){let xe=t.willConvertTo3D?200:e.screen.width,ee=P*(p-c)/xe,U=t.willConvertTo3D?200:e.screen.height,te=P*(m-l)/U;c-=ee,p+=ee,l-=te,m+=te}let S=1/4,E=t.domainBound,v,D=ol.fromRects(fx(r),dx(s),{xAxisScale:o,yAxisScale:i}),G={xmin:c,xmax:p,ymin:l,ymax:m,zmin:d,zmax:y};switch(t.graphMode){case 1:switch(v=er(jo([l,m]),E),v.type){case\"empty\":return!1;case\"interval\":l=v.bounds[0],m=v.bounds[1]}let xe=Math.max(Cx,1+Math.ceil(Math.abs(D.mapY(m)-D.mapY(l))/S)),ee=new ol(D.yScale,D.xScale);return{min:l,max:m,tolerance:S,nInitialSamples:xe,mathToPixels:ee,screen:{width:s.height,height:s.width}};case 2:{switch(v=er(jo([c,p]),E),v.type){case\"empty\":return!1;case\"interval\":c=v.bounds[0],p=v.bounds[1]}let U=Math.max(Cx,1+Math.ceil(Math.abs(D.mapX(p)-D.mapX(c))/S));return{min:c,max:p,tolerance:S,nInitialSamples:U,mathToPixels:D,screen:s}}case 6:{let U=e.degreeMode?Math.PI/180:1;if(((J=t.domain)==null?void 0:J.type)!==\"1d\")throw new Error(\"Expected polar graph to have domain\");let{min:te,max:Ce}=t.domain;switch(v=er(jo([te,Ce]),E),v.type){case\"empty\":return!1;case\"interval\":te=v.bounds[0],Ce=v.bounds[1]}let Ge=Math.max(Cx,1+Math.min(Math.ceil(U*Math.abs(Ce-te)/(2*Math.PI)*1e3),12e3)),pt=Math.abs(D.mapX(p)-D.mapX(c)),Rt=Math.abs(D.mapY(m)-D.mapY(l)),Mo=Math.hypot(pt,Rt),di=Math.hypot(p-c,m-l)/Mo,fi={min:te,max:Ce,screen:s,nInitialSamples:Ge,xtolerance:S,ytolerance:S,rtoleranceMath:di,map:([Hi,yc])=>D.mapCoordinatePair(mw([U*Hi,yc]))};if(!t.domain.isExplicit){let Hi=S$(n,fi,U,t.operator===\"=\");Hi&&(fi.max=fi.min+Hi,fi.nInitialSamples=Math.max(Cx,1+Math.min(Math.ceil(U*Math.abs(fi.max-fi.min)/(2*Math.PI)*1e3),12e3)))}return fi}case 5:case 100:{let U={min:0,max:1},{min:te,max:Ce}=((re=t.domain)==null?void 0:re.type)===\"1d\"?t.domain:U;switch(v=er(jo([te,Ce]),E),v.type){case\"empty\":return!1;case\"interval\":te=v.bounds[0],Ce=v.bounds[1]}let Ge;return(!isFinite(te)||!isFinite(Ce))&&(Ge=yw,te=Nx(te),Ce=Nx(Ce)),{min:te,max:Ce,screen:s,nInitialSamples:tv(te,Ce),xtolerance:S,ytolerance:S,ztolerance:S,parameterTransform:Ge,map:([pt,Rt])=>D.mapCoordinatePair([pt,Rt])}}case 8:return{xmin:c,xmax:p,ymin:l,ymax:m,mathToPixels:D,tolerance:S};case 106:return{...G,u:new we(c,p),v:new we(l,m)};case 120:case 122:case 107:return{...G,u:new we(l,m),v:new we(d,y)};case 121:case 123:case 108:return{...G,u:new we(c,p),v:new we(d,y)};case 109:return{...G,u:new we(f,g?h:Fr.xmax),v:new we(x,g?T:2*Math.PI)};case 124:case 110:{let{min:U,max:te}=((ie=t.domain)==null?void 0:ie.type)===\"1d\"?t.domain:{min:0,max:2*Math.PI};return{...G,u:new we(U,te),v:new we(d,y)}}case 211:{let{min:U,max:te}=((It=t.domain)==null?void 0:It.type)===\"1d\"?t.domain:{min:0,max:2*Math.PI/u};return{...{xmin:U,xmax:te,ymin:d,ymax:y},u:new we(U,te),v:new we(d,y),mathToPixels:al,tolerance:ta}}case 212:{let U=g?h:2*Math.PI/u,te=g?T:Math.PI/u;return{...{xmin:f,xmax:U,ymin:x,ymax:te},u:new we(f,U),v:new we(x,te),mathToPixels:al,tolerance:ta}}case 215:case 214:return{...{xmin:f,xmax:h,ymin:x,ymax:T},u:new we(f,h),v:new we(x,x),mathToPixels:al,tolerance:ta};case 213:{let U=g?h:Fr.xmax,te=g?T:2*Math.PI/u;return{...{xmin:f,xmax:U,ymin:x,ymax:te},u:new we(f,U),v:new we(x,te),mathToPixels:al,tolerance:ta}}case 111:return{...G,u:new we(f,g?h:2*Math.PI/u),v:new we(x,g?T:Math.PI/u)};case 117:case 118:case 119:case 129:case 130:case 103:case 112:case 126:case 113:case 127:case 210:case 114:return{...G,u:new we(f,h),v:new we(x,T)};case 200:case 201:case 202:case 206:case 205:case 203:case 204:case 207:case 208:{if(t.graphMode===200&&(t.slice_coordinate===\"z\"||t.slice_coordinate===\"_implicit\"))return{xmin:c,xmax:p,ymin:l,ymax:m,mathToPixels:D,tolerance:ta};if(t.graphMode===201&&(t.slice_coordinate===\"x\"||t.slice_coordinate===\"_implicit\"))return{...{xmin:l,xmax:m,ymin:d,ymax:y},mathToPixels:al,tolerance:ta};if(t.graphMode===202&&(t.slice_coordinate===\"y\"||t.slice_coordinate===\"_implicit\"))return{...{xmin:c,xmax:p,ymin:d,ymax:y},mathToPixels:al,tolerance:ta};let{min:U,max:te}=((Bt=t.domain)==null?void 0:Bt.type)===\"1d\"?t.domain:{min:0,max:2*Math.PI};return{x:new we(c,p),y:new we(l,m),z:new we(d,y),t:new we(U,te),u:new we(f,h),v:new we(x,T)}}case 209:return t.slice_coordinate===\"z\"?{xmin:c,xmax:p,ymin:l,ymax:m,mathToPixels:D,tolerance:ta}:t.slice_coordinate===\"x\"?{...{xmin:l,xmax:m,ymin:d,ymax:y},mathToPixels:al,tolerance:ta}:t.slice_coordinate===\"y\"?{...{xmin:c,xmax:p,ymin:d,ymax:y},mathToPixels:al,tolerance:ta}:t.slice_coordinate===\"_implicit\"?{...G,u:new we(c,p),v:new we(l,m)}:!1;default:return!1}}function yw(e){return Math.sinh(10*e)/(1-e*e)}function Nx(e){if(e===1/0)return 1;if(e===-1/0)return-1;let t=Math.asinh(e);return 2*t/(10+Math.sqrt(100+4*t*t))}function w$(e){switch(e){case 120:case 122:return 107;case 121:case 123:return 108;case 124:return 110;case 126:return 112;case 127:return 113;default:return e}}function pa(e){var g,f,h,x,T,P,M,S,E,v,D,G,j,Q,W;let{viewState:t,graphInfo:n,compiled:r,derivative:s}=e,o=r.fn,{degreeMode:i}=t,a=i?Math.PI/180:1,u=hp(t,n,o),c,p,l,m=w$(n.graphMode),d=t.xAxisScale===\"linear\"&&t.yAxisScale===\"linear\";if(!u)c={segments:[],resolved:!0};else{switch(m){case 1:case 2:let K=s?s.fn:void 0;c=n.isLinear&&d&&ec(n.linearCoefficients)?mv(n.linearCoefficients,u):yv(o,u,K);break;case 6:c=Tx(xe=>[xe,o(xe)],u);break;case 8:c=xy(o,u);break;case 5:u.max===u.min?c=E$(o,u.min):c=n.isLinear&&d&&ec(n.linearCoefficients)?P$(n.linearCoefficients,u):Tx(o,u);break;case 100:let J=r.fn,{min:re,max:ie}=((g=n.domain)==null?void 0:g.type)===\"1d\"?n.domain:{min:0,max:1};if(!isFinite(re)||!isFinite(ie)){re=Nx(re),ie=Nx(ie);let xe=J;J=ee=>xe(yw(ee))}let It=new we(re,ie),Bt=yp(J,It,n.resolution,t);return{graphMode:100,guid:ys(),points:Bt,color:n.color,thickness:n.lineWidth,compiled:r};case 112:case 113:case 130:case 103:case 106:case 107:case 108:case 109:case 110:case 111:{let xe=u,{u:ee,v:U}=xe,te=m===112||m===113,Ce=n.graphMode===122||n.graphMode===123,Ge=te?Ey:Ce?2:j_,{resolution:pt}=n,Rt=pt===void 0||isNaN(pt)?Ge:tr(tw(pt),2,100),Mo=jo([ee.min,ee.max]).type!==\"empty\"&&jo([U.min,U.max]).type!==\"empty\",gr;switch(Mo&&m){case 103:{let Hi=r.fn;gr=uw(Hi,xe,ee,U,Rt);break}case 130:{gr=uw((yc,JT)=>{let[Ze,ne]=r.fn(yc,JT);return[Ze,ne,0]},xe,ee,U,Rt);break}case 106:gr=D$(r,xe,Rt);break;case 107:gr=N$(r,xe,Rt);break;case 108:gr=R$(r,xe,Rt);break;case 109:gr=O$(r,xe,ee,U,Rt,i);break;case 110:gr=A$(r,xe,ee,U,Rt,i);break;case 111:gr=_$(r,xe,ee,U,Rt,i);break;case 112:case 113:gr=gv(r,e.dependencies,e.gradient,u,Rt,{isInequality:(f=e.isImplicit3dInequality)!=null?f:!1});break;case!1:gr=v$();break}let di=n.graphMode===113||n.graphMode===127;return{meshData:gr,resolved:gr.resolved,color:n.color,surfaceOpacity:di?1:(h=n.surfaceOpacity)!=null?h:1,uvArgs:(x=Go[n.graphMode])!=null?x:[],extraMeshArgs:(T=ul[n.graphMode])!=null?T:[],graphMode:m,compiled:r,restrictionShader:e.restrictionShader3d}}case 200:case 201:case 202:case 211:case 206:case 205:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:{let xe=(Ze,ne,ln)=>{let yt=(ug,cg)=>{let vp=ln(ug,cg);return isNaN(vp[0])||isNaN(vp[1])||isNaN(vp[2])?NaN:Ze(ug,cg)},qe=t.viewport,{xmin:ct,xmax:Gn,ymin:ke,ymax:_e,zmin:tn,zmax:Cp}=qe,Fd=(ct+Gn)/2,QT=(ke+_e)/2,KT=(tn+Cp)/2,j3=Gn-ct,J3=_e-ke,Q3=Cp-tn,IN=xy(yt,{...ne,map3d:(ug,cg)=>{let[vp,PN,EN]=ln(ug,cg);return isNaN(vp)||isNaN(PN)||isNaN(EN)?[NaN,NaN,NaN]:[(vp-Fd)/j3,(PN-QT)/J3,(EN-KT)/Q3]}});return{segments:IN.segments,resolved:IN.resolved,graphMode:8,color:n.color,lineWidth:n.lineWidth,lineOpacity:n.lineOpacity,listIndex:n.listIndex,operator:n.operator,compiled:r,poi:{}}},ee=r.fn,U=(P=n.slice_value)!=null?P:0,te=(M=n.slice_coordinate)!=null?M:\"\",Ce=u,Ge,pt,Rt,Mo={},gr=!0,di=(Ze,ne)=>{let yt=xe(Ze,u,(ke,_e)=>{let{x:tn,y:Cp,z:Fd}=ne(ke,_e,Ze(ke,_e));return[tn,Cp,Fd]}),qe=n.lineWidth,ct=My(yt,t,qe,U),Gn=ct.points;for(let ke=0;ke<Gn.length/3;ke++){let _e=Gn[3*ke],tn=Gn[3*ke+1],Cp=Gn[3*ke+2],{x:Fd,y:QT,z:KT}=ne(_e,tn,Cp);Gn[3*ke]=Fd,Gn[3*ke+1]=QT,Gn[3*ke+2]=KT}return ct},fi=(Ze,ne)=>{let ln=[];for(let ct=0;ct<Ze.segments.length;ct++){let Gn=Ze.segments[ct];for(let ke=0;ke<Gn.length/2;ke++){let _e=Gn[2*ke],tn=Gn[2*ke+1];ln.push(ne(_e,tn))}ct<Ze.segments.length-1&&ln.push([NaN,NaN,0])}let yt=n.lineWidth,qe=t.viewport;return dd(ln,qe,yt)},Hi=u,yc=(Ze,ne)=>{var yt;let ln=xe(Ze,Hi,ne);return gr=(yt=ln.resolved)!=null?yt:!0,fi(ln,ne)};switch(m){case 200:{if(te===\"z\")return di((ne,ln)=>ee(ne,ln)-U,rw);if(te===\"_implicit\"){let ne=n.slice_function.fn;Rt=yc((qe,ct)=>ne(qe,ct,ee(qe,ct)),(qe,ct)=>[qe,ct,ee(qe,ct)]);break}let Ze=te===\"x\";Ge=Ze?Ce.y:Ce.x,pt=Ze?ne=>[U,ne,ee(U,ne)]:ne=>[ne,U,ee(ne,U)],Rt=yp(pt,Ge,n.resolution,t);break}case 201:{if(te===\"x\")return di((ne,ln)=>ee(ne,ln)-U,sw);if(te===\"_implicit\"){let ne=n.slice_function.fn;Rt=yc((qe,ct)=>ne(ee(qe,ct),qe,ct),(qe,ct)=>[ee(qe,ct),qe,ct]);break}let Ze=te===\"y\";Ge=Ze?Ce.z:Ce.y,pt=Ze?ne=>[ee(U,ne),U,ne]:ne=>[ee(ne,U),ne,U],Rt=yp(pt,Ge,n.resolution,t);break}case 202:{if(te===\"y\")return di((ne,ln)=>ee(ne,ln)-U,ow);if(te===\"_implicit\"){let ne=n.slice_function.fn;Rt=yc((qe,ct)=>ne(qe,ee(qe,ct),ct),(qe,ct)=>[qe,ee(qe,ct),ct]);break}let Ze=te===\"x\";Ge=Ze?Ce.z:Ce.x,pt=Ze?ne=>[U,ee(U,ne),ne]:ne=>[ne,ee(ne,U),U],Rt=yp(pt,Ge,n.resolution,t);break}case 209:{let Ze=r.fn;if(te===\"x\")return di((ne,ln)=>Ze(U,ne,ln),sw);if(te===\"y\")return di((ne,ln)=>Ze(ne,U,ln),ow);if(te===\"z\")return di((ne,ln)=>Ze(ne,ln,U),rw);if(te===\"_implicit\"){let{resolution:ne}=n,ln=ne===void 0||isNaN(ne)?Ey:tr(tw(ne),2,100);Rt=W_(r.fn,n.slice_function.fn,u,ln);let yt=t.viewport,qe=[];for(let ct=0;ct<Rt.length/3;ct++)qe.push([Rt[3*ct],Rt[3*ct+1],Rt[3*ct+2]]);Rt=dd(qe,yt,n.lineWidth),Mo=n.slice_function.executionMetadata;break}else throw new Error(\"Programming Error: unexpected slice coordinate\")}case 206:case 205:{let Ze=te===\"z\";Ge=Ze?Ce.t:Ce.z,pt=Ze?ne=>[ee(ne,U),ne,U]:ne=>[ee(U,ne),U,ne],Rt=ev(pt,Ge,n.resolution,t);break}case 211:{let Ze=r.fn,ne;switch(te){case\"x\":ne=(ke,_e)=>Ze(ke,_e)*Fn(ke*a)-U;break;case\"y\":ne=(ke,_e)=>Ze(ke,_e)*Cn(ke*a)-U;break;case\"r\":ne=(ke,_e)=>Ze(ke,_e)-U;break;case\"_implicit\":let Gn=n.slice_function.fn;ne=(ke,_e)=>Gn(Ze(ke,_e)*Fn(ke*a),Ze(ke,_e)*Cn(ke*a),_e,Ze(ke,_e),ke);break;default:throw new Error(\"Programming Error: bad slice\")}let ln=te===\"x\",yt=te===\"y\",qe=(Gn,ke)=>[ln?U:Ze(Gn,ke)*Fn(Gn*a),yt?U:Ze(Gn,ke)*Cn(Gn*a),ke],ct=xe(ne,Hi,qe);Rt=fi(ct,qe),gr=(S=ct.resolved)!=null?S:!0;break}case 213:{let Ze=te===\"x\",ne=te===\"y\",ln=te===\"z\",yt=r.fn,qe;switch(te){case\"x\":qe=(_e,tn)=>_e*Fn(tn*a)-U;break;case\"y\":qe=(_e,tn)=>_e*Cn(tn*a)-U;break;case\"z\":qe=(_e,tn)=>yt(_e,tn)-U;break;case\"_implicit\":let ke=n.slice_function.fn;qe=(_e,tn)=>ke(_e*Fn(tn*a),_e*Cn(tn*a),yt(_e,tn),_e,tn);break;default:throw new Error(\"Programming Error: bad slice\")}let ct=(ke,_e)=>[Ze?U:ke*Fn(_e*a),ne?U:ke*Cn(_e*a),ln?U:yt(ke,_e)],Gn=xe(qe,Hi,ct);Rt=fi(Gn,ct);break}case 212:{let Ze=te===\"x\",ne=te===\"y\",ln=te===\"z\",yt=r.fn,qe;switch(te){case\"x\":qe=(_e,tn)=>yt(_e,tn)*Cn(tn*a)*Fn(_e*a)-U;break;case\"y\":qe=(_e,tn)=>yt(_e,tn)*Cn(tn*a)*Cn(_e*a)-U;break;case\"z\":qe=(_e,tn)=>yt(_e,tn)*Fn(tn*a)-U;break;case\"rho\":qe=(_e,tn)=>yt(_e,tn)-U;break;case\"_implicit\":let ke=n.slice_function.fn;qe=(_e,tn)=>ke(yt(_e,tn)*Cn(tn*a)*Cn(_e*a),yt(_e,tn)*Cn(tn*a)*Fn(_e*a),yt(_e,tn)*Fn(tn*a),yt(_e,tn),_e,tn);break;default:throw new Error(\"Programming Error: bad slice\")}let ct=(ke,_e)=>[Ze?U:yt(ke,_e)*Cn(_e*a)*Fn(ke*a),ne?U:yt(ke,_e)*Cn(_e*a)*Cn(ke*a),ln?U:yt(ke,_e)*Fn(_e*a)],Gn=xe(qe,Hi,ct);Rt=fi(Gn,ct),gr=(E=Gn.resolved)!=null?E:!0;break}case 215:case 214:{let Ze=m===214?r.fn:(ln,yt)=>{let[qe,ct]=r.fn(ln,yt);return[qe,ct,0]},ne;switch(te){case\"x\":ne=(yt,qe)=>Ze(yt,qe)[0]-U;break;case\"y\":ne=(yt,qe)=>Ze(yt,qe)[1]-U;break;case\"z\":ne=(yt,qe)=>Ze(yt,qe)[2]-U;break;case\"u\":ne=(yt,qe)=>yt-U;break;case\"v\":ne=(yt,qe)=>qe-U;break;case\"_implicit\":let ln=n.slice_function.fn;ne=(yt,qe)=>{let[ct,Gn,ke]=Ze(yt,qe);return ln(ct,Gn,ke,yt,qe)};break;default:throw new Error(\"Programming Error: bad slice\")}Rt=yc(ne,Ze),Mo=(D=(v=n.slice_function)==null?void 0:v.executionMetadata)!=null?D:{};break}case 203:case 204:{let Ze=te===\"r\";Ge=Ze?Ce.v:Ce.u,pt=Ze?ne=>[U,ne,ee(U,ne)]:ne=>[ne,U,ee(ne,U)],Rt=ev(pt,Ge,n.resolution,t);break}case 207:case 208:{let Ze=te===\"theta\";Ge=Ze?Ce.v:Ce.u,pt=Ze?ne=>[ee(U,ne),U,ne]:ne=>[ee(ne,U),ne,U],Rt=k_(pt,Ge,n.resolution,t);break}}let JT={goodCoercionCount:((G=Mo.goodCoercionCount)!=null?G:0)+((j=r.executionMetadata.goodCoercionCount)!=null?j:0),badCoercionCount:((Q=Mo.badCoercionCount)!=null?Q:0)+((W=r.executionMetadata.badCoercionCount)!=null?W:0)};return{graphMode:100,guid:ys(),points:Rt,resolved:gr,color:n.color,thickness:n.lineWidth,compiled:{...r,executionMetadata:JT}}}default:throw new Error(\"Programming Error: unexpected graphmode \"+m)}l=c.poi}if((!l||l.zeros.x.length+l.extrema.x.length+l.intercept.x.length>250)&&(l=I$()),m===1)for(let K in l){if(!l.hasOwnProperty(K))continue;let J=K;p=l[J].y,l[J].y=l[J].x,l[J].x=p}let y={segments:c.segments,resolved:c.resolved,graphMode:m,color:n.color,style:n.lineStyle,lineWidth:n.lineWidth,lineOpacity:n.lineOpacity,listIndex:n.listIndex,operator:n.operator,poi:l,compiled:r};if(m===6){let K=u;y.sampledDomain={min:K.min,max:K.max}}return c.fillSegments&&(y.fillSegments=c.fillSegments),y}function L$(e,t,n){let r,s,o,i,a=[],u=null;switch(n){case 6:u=mw;break;case 1:u=function(c){return[c[1],c[0]]};break}for(r=0;r<e.length;r++)for(i=e[r],s=0;s<i.length;s+=2)o=[i[s],i[s+1]],u&&(o=u(o)),a.push(o[0],o[1]);for(r=t.length-1;r>=0;r--)for(i=t[r],s=i.length-2;s>=0;s-=2)o=[i[s],i[s+1]],u&&(o=u(o)),a.push(o[0],o[1]);return a}function yd(e,t,n){let r=p=>p[p.length-2],s=[],o=0,i=0,a=[],u=[],c=-1/0;for(;;){for(;i<e.length&&!(e[i].length>=2);)i+=1;for(;o<t.length&&!(t[o].length>=2);)o+=1;(i>=e.length||e[i][0]>c)&&(o>=t.length||t[o][0]>c)&&(a.length>0&&u.length>0&&s.push(L$(a,u,n)),a=[],u=[],c=Math.max(c,i<e.length?r(e[i]):1/0),c=Math.max(c,o<t.length?r(t[o]):1/0));let p=!1;if(i<e.length&&e[i][0]<=c&&(c=Math.max(c,r(e[i])),a.push(e[i]),i+=1,p=!0),o<t.length&&t[o][0]<=c&&(c=Math.max(c,r(t[o])),u.push(t[o]),o+=1,p=!0),!p)break}return s}function bp(e){let t=[],n={};for(let r=0;r<e.length;r++){let s=e[r],[o,i]=s;!isNaN(o)&&!isNaN(i)?t.push(s):n[r]=!0}return{points:t,droppedIndices:n}}var Go={[8]:[\"x\",\"y\"],[106]:[\"x\",\"y\"],[120]:[\"y\",\"z\"],[122]:[\"y\",\"z\"],[107]:[\"y\",\"z\"],[121]:[\"x\",\"z\"],[123]:[\"x\",\"z\"],[108]:[\"x\",\"z\"],[109]:[\"r\",\"theta\"],[124]:[\"theta\",\"z\"],[110]:[\"theta\",\"z\"],[111]:[\"theta\",\"phi\"],[130]:[\"u\",\"v\"],[103]:[\"u\",\"v\"],[126]:[\"x\",\"y\"],[112]:[\"x\",\"y\",\"z\"],[113]:[\"x\",\"y\",\"z\"],[127]:[\"x\",\"y\"],[201]:[\"y\",\"z\"],[202]:[\"x\",\"z\"],[200]:[\"x\",\"y\"],[206]:[\"theta\",\"z\"],[205]:[\"theta\",\"z\"],[211]:[\"theta\",\"z\"],[203]:[\"r\",\"theta\"],[204]:[\"r\",\"theta\"],[213]:[\"r\",\"theta\"],[207]:[\"theta\",\"phi\"],[208]:[\"theta\",\"phi\"],[212]:[\"theta\",\"phi\"],[214]:[\"u\",\"v\"],[215]:[\"u\",\"v\"],[209]:[\"x\",\"y\",\"z\"],[210]:[\"x\",\"y\",\"z\"]},ul={[110]:[\"r\"],[111]:[\"rho\"]};function Goe(e){return e.graphMode===3||e.graphMode===25||Kc(e.graphMode)}function Hoe(e){return Kc(e.graphMode)}var q$={};Ka(q$,{LinearToSRGB:()=>G$,SRGBToLinear:()=>Ox,colorString:()=>gw,colors:()=>xp,colors3d:()=>H$,convertColorStringToLinearRGB:()=>bv,getDisplayColor:()=>Li,invertColor:()=>V$,isValidHexColor:()=>Ax,mutateOpacity:()=>B$,normalizeColor:()=>hv,parseHex:()=>hw,shadeColor:()=>F$});function hv(e){return Ax(e)?(e.match(/^#([A-Fa-f0-9]{3})$/g)&&(e=\"#\"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),e.toLowerCase()):e}function Ax(e){return typeof e==\"string\"&&(e.match(/^#([A-Fa-f0-9]{3})$/g)||e.match(/^#([A-Fa-f0-9]{6})$/g))}function F$(e,t){if(e=hv(e),!Ax(e))return e;t>1&&(t=1),t<-1&&(t=-1);let n=parseInt(e.slice(1),16),r=t<0?0:255,s=t<0?t*-1:t,o=n>>16,i=n>>8&255,a=n&255;return gw(Math.round((r-o)*s)+o,Math.round((r-i)*s)+i,Math.round((r-a)*s)+a)}function gw(e,t,n){return\"#\"+(16777216+Math.round(e)*65536+Math.round(t)*256+Math.round(n)).toString(16).slice(1)}function V$(e){if(e=hv(e),!Ax(e))return e;let t=\"0123456789abcdef\";return\"#\"+e.slice(1).split(\"\").map(n=>t[15-t.indexOf(n)]).join(\"\")}function hw(e){e=e.replace(/#/,\"\");let t,n,r;return e.length===3?(t=parseInt(e.slice(0,1)+e.slice(0,1),16),n=parseInt(e.slice(1,2)+e.slice(1,2),16),r=parseInt(e.slice(2,3)+e.slice(2,3),16)):e.length===6?(t=parseInt(e.slice(0,2),16),n=parseInt(e.slice(2,4),16),r=parseInt(e.slice(4,6),16)):(t=0,n=0,r=0),{r:t,g:n,b:r}}function B$(e,t){let n=/(rgba\\([\\d]+\\,\\ ?[\\d]+\\,\\ ?[\\d]+\\,\\ ?)[\\d.]+(\\))/;return e.match(n)?e.replace(n,`$1${t}$2`):e}function Li(e,t){if(t&&t.colorLatexValue){let n=t.colorLatexValue;return Array.isArray(n)?n[0]:n}return e.color}function Ox(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function G$(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}function bv(e){let t=hw(e);return[Ox(t.r/255),Ox(t.g/255),Ox(t.b/255)]}var xp={RED:\"#c74440\",BLUE:\"#2d70b3\",GREEN:\"#348543\",PURPLE:\"#6042a6\",ORANGE:\"#fa7e19\",BLACK:\"#000000\",GRAY:\"#aaaaaa\",FOCUS_OUTLINE:\"#6a93d2\"},H$={RED:xp.RED,BLUE:xp.BLUE,GREEN:xp.GREEN,ORANGE:xp.ORANGE,PURPLE:xp.PURPLE,GRAY:xp.GRAY};function Qr(e,t,n){let r=n.getDependencies(),s,o;switch(r.length){case 0:s=bw(n),o=n.boundDomain(\"x\");break;case 1:o=n.boundDomain(r[0]),Wo(o)&&!co(o)&&(s=bw(n));break;default:o=vr();break}return{graphMode:e.getGraphMode(t,n),color:Li(e.userData,e.metaData),pointStyle:e.userData.pointStyle,lineStyle:e.userData.lineStyle,arrowMode:e.userData.arrowMode,operator:e.getOperator(),isLinear:!!s,linearCoefficients:s,domainBound:o}}function bw(e){switch(e.valueType){case b:return xv(e);case N:{let t=xv(e.slot(0)),n=xv(e.slot(1));return!t||!n?void 0:[t,n]}default:return}}function xv(e){let t=e.getDependencies();switch(t.length){case 0:return[+e.asValue(),0];case 1:if(e.polynomialOrder(t[0])>1)return;let n=e.getPolynomialCoefficients(t[0]);return[n[0]?+n[0].asValue():0,n[1]?+n[1].asValue():0];default:return}}var cl={POINT:\"POINT\",OPEN:\"OPEN\",CROSS:\"CROSS\",SQUARE:\"SQUARE\",PLUS:\"PLUS\",TRIANGLE:\"TRIANGLE\",DIAMOND:\"DIAMOND\",STAR:\"STAR\"},gd={SOLID:\"SOLID\",DASHED:\"DASHED\",DOTTED:\"DOTTED\"};var Dy=class{constructor(t){this.parentType=t;this.count=0;this.intersections=[]}addPoint(t){this.intersections.push(t),this.count+=1}addPoints(t){this.intersections.push(...t),this.count+=t.length}addIntersection(t,n){n.valueType===N?this.addPoint(n.value):this.addPoints(n.value)}getPoints(){return this.intersections}},hd=class{constructor(t){this.parentType=t;this.count=0;this.intersectionsByIndex=new Map;if(t===lr)this.scalarType=Ie;else if(t===ns)this.scalarType=De;else if(t===ts)this.scalarType=ae;else throw new Error(`Expected ListOfSegment or ListOfArc but got ${We(t)}`)}getListItemIntersections(t){let n=this.intersectionsByIndex.get(t);return n||(n=new Dy(this.scalarType),this.intersectionsByIndex.set(t,n)),n}addIntersection(t,n){let r=Ha(t);if(r!==void 0){let s=r-1,o=this.getListItemIntersections(s);n.valueType===Gt?o.addPoints(n.value):o.addPoint(n.value),this.count+=1}else{mu(n.valueType,[Gt]);for(let s=0;s<n.value.length;s++)this.getListItemIntersections(s).addPoint(n.value[s]);this.count+=n.value.length}}},Tv=class{constructor(){this.parentType=Se;this.count=0;this.intersectionsByEdgeIndex=new Map}getEdgeIntersections(t){let n=this.intersectionsByEdgeIndex.get(t);return n||(n=new Dy(Ie),this.intersectionsByEdgeIndex.set(t,n)),n}addPoint(t,n){this.getEdgeIntersections(t).addPoint(n),this.count+=1}addIntersection(t,n){if(t.type!==\"polygon-edge\")throw new Error(`Expected a polygon edge parent ref type but got ${t.type}`);let r=t.edgeIndex-1,s=this.getEdgeIntersections(r);n.valueType===Gt?(s.addPoints(n.value),this.count+=n.value.length):(s.addPoint(n.value),this.count+=1)}},Iv=class{constructor(){this.parentType=hr;this.count=0;this.intersectionsByEdgeIndex=new Map}getEdgeIntersections(t){let n=this.intersectionsByEdgeIndex.get(t);return n||(n=new hd(lr),this.intersectionsByEdgeIndex.set(t,n)),n}addIntersection(t,n){if(t.type!==\"polygon-edge\")throw new Error(`Expected a polygon edge parent ref type but got ${t.type}`);let r=t.edgeIndex-1,s=this.getEdgeIntersections(r),o=Ha(t);if(o!==void 0){let i=o-1;n.valueType===Gt?s.getListItemIntersections(i).addPoints(n.value):s.getListItemIntersections(i).addPoint(n.value),this.count+=1}else{mu(n.valueType,[Gt]);for(let i=0;i<n.value.length;i++)s.getListItemIntersections(i).addPoint(n.value[i]);this.count+=n.value.length}}},bd=class{constructor(){this.data={}}getChildIntersections(t){return this.data[t]}addChildIntersection(t,n){mu(n==null?void 0:n.valueType,[N,Gt]);let r;if(t.valueType==hr)r=this.data[t.id]||new Iv;else if(t.valueType===lr||t.valueType===ns||t.valueType===ts)r=this.data[t.id]||new hd(t.valueType);else if(t.valueType===Se)r=this.data[t.id]||new Tv;else if(t.valueType===Ie||t.valueType===De||t.valueType===ae)r=this.data[t.id]||new Dy(t.valueType);else return;this.data[t.id]=r,r.addIntersection(t.ref,n)}static compareIntersectionCounts({prevChildIntersections:t,nextChildIntersections:n}){var o,i;let r={},s=new Set([...Object.keys(t.data),...Object.keys(n.data)]);for(let a of s){let u=((o=t.data[a])==null?void 0:o.count)||0,c=((i=n.data[a])==null?void 0:i.count)||0;r[a]={prev:u,next:c}}return r}};function Pv(e,t){let n;switch(t){case\"solvedEquation\":n=2;break;case\"baseComparator\":n=4;break;default:n=1;break}return Math.floor(e/n)}var U$={lineOpacity:\"computedLineOpacity\",lineWidth:\"computedLineWidth\",color:\"colorLatexValue\",fillOpacity:\"fillOpacity\",surfaceOpacity:\"surfaceOpacity\",resolution:\"resolution\"};function z$(e){return e.startsWith(\"shader:\")}function wx(e,t){return\"colorLatex\"in e&&z$(e.colorLatex)?e.colorLatex:t}function ma(e,t,n){return Array.isArray(e)?e[Pv(t,n)]:e}function Fi(e,t,n){let r=1/0;for(let o of t){let i=e[o];Array.isArray(i)&&i.length<r&&(r=i.length)}let s=1;return n===\"solvedEquation\"?s=2:n===\"baseComparator\"&&(s=4),s*r}function Ya(e,t,n){let r=Pv(t,n),s=e.userData.lineStyle,o=ma(e.metaData.computedLineWidth,t,n),i=ma(e.metaData.computedLineOpacity,t,n),a=ma(e.metaData.computedFillOpacity,t,n),u=ma(e.metaData.computedSurfaceOpacity,t,n),c=e.metaData.colorLatexValue?ma(e.metaData.colorLatexValue,t,n):e.userData.color,p=ma(e.metaData.computedResolution,t,n);return{listIndex:r,style:s,lineWidth:o,lineOpacity:i,fillOpacity:a,surfaceOpacity:u,color:c,resolution:p}}function Kr(e,{node:t,concrete:n,graphInfo:r,styleBroadcastStrategy:s,policy:o},i){let a=Fi(t.metaData,Object.keys(e).map(c=>U$[c]),s),u=[];return Es.wrap(n).eachElement((c,p)=>{if(p>=a)return;let l=Qr(t,o,c);l.graphMode=r.graphMode;let m=Ya(t,p,s);l.listIndex=m.listIndex,l.style=m.style,\"lineWidth\"in e&&(l.lineWidth=m.lineWidth),\"lineOpacity\"in e&&(l.lineOpacity=m.lineOpacity),\"fillOpacity\"in e&&(l.fillOpacity=m.fillOpacity),\"surfaceOpacity\"in e&&(l.surfaceOpacity=m.surfaceOpacity),\"color\"in e&&(l.color=wx(t.userData,m.color)),\"resolution\"in e&&(l.resolution=m.resolution),u.push(...i(c,l))}),u}function Ev(...e){return e.some(t=>isNaN(t))}function Lx(e,t){if(!t)return[];let n=[];for(let r of e){let s=t;if(\"listIndex\"in r&&r.listIndex!==void 0&&t instanceof hd&&(s=t.getListItemIntersections(r.listIndex)),r.graphMode===17||r.graphMode===19){mu(s.parentType,[Ie,De]);let o=s.getPoints();if(!o)continue;let i=0,a,u=1,c,[p,l,m,d]=r.segments[0];for(let y=0;y<o.length;y++){let[g,f]=o[y],h=qi(g,f,0,p,l,0,m,d,0);h<i&&(i=h,a=y),r.graphMode===17&&h>u&&(u=h,c=y)}a!==void 0&&n.push(_x(r,17,[[p,l,o[a][0],o[a][1]]])),c!==void 0&&n.push(_x(r,17,[[m,d,o[c][0],o[c][1]]]))}else if(r.graphMode===21){mu(s.parentType,[ae]);let o=s.getPoints();if(!o)continue;let[i,a,u,c,p]=r.segments[0],l=p-c+(p<c?1:-1)*2*Math.PI,m=[];for(let d of o){let[y,g]=d,f=Math.atan2(g-a,y-i),h=MN(f,c,l);0<h&&h<1&&m.push(h)}if(m.length){m.push(0,1),m.sort();let d=0,y=0;for(let h=0;h<m.length-1;h++){let x=m[h+1]-m[h];(d===void 0||x>d)&&(d=x,y=h)}let g=m[y],f=m[y+1];g>0&&n.push(_x(r,21,[[i,a,u,c,c+g*l]])),f<1&&n.push(_x(r,21,[[i,a,u,p,p-(1-f)*l]]))}}}return n}function _x(e,t,n){return{resolved:!0,graphMode:t,segments:n,operator:e.operator,poi:{},color:e.color,style:gd.DASHED,lineWidth:1,lineOpacity:.5,isIntersectionExtension:!0}}function Fx(e){let t=[],n=[];for(let[r,s]of e)!isNaN(r)&&!isNaN(s)?t.push(r,s):(t.length>=4&&n.push(t),t=[]);return t.length>=4&&n.push(t),n}function xw({node:e,reconciledProps:t,styleBroadcastStrategy:n,viewState:r,concrete:s}){let o=[],i=e.userData.shouldGraph&&t.points,a=e.userData.shouldGraph&&t.lines,u=[\"colorLatexValue\"];i&&u.push(\"computedPointOpacity\",\"computedPointSize\");let c=Es.wrap(s).asValue();Dr(c);let p=Fi(e.metaData,u,n),l=Math.min(c.length,p);if(i)for(let m=0;m<l;m++){let{color:d}=Ya(e,m,n),y=ma(e.metaData.computedPointSize,m,n);o.push({graphMode:114,position:c[m],radius:.02*y,guid:ys(),color:d})}if(a){let m=ma(e.metaData.computedLineWidth,0,n),{color:d}=Ya(e,0,n);o.push({graphMode:100,points:dd(c,r.viewport,m),thickness:m,guid:ys(),color:d})}return o}function Tw({node:e,concrete:t,styleBroadcastStrategy:n,graphInfo:r,policy:s}){var M;let o=e.metaData.colorLatexValue?!Array.isArray(e.metaData.colorLatexValue):!0,i=e.metaData.computedSurfaceOpacity,a=[],u=[],c=[],p=[],l=[],[m,d,y]=[new Ke,new Ke,new Ke],[g,f,h]=[new Ke,new Ke,new Ke],x=(S,E,v,D,G,j,Q,W,K)=>{if(g.set(S,E,v),f.set(D,G,j),h.set(Q,W,K),!g.isFinite()||!f.isFinite()||!h.isFinite())return;let J=a.length/3;a.push(g.x,g.y,g.z,f.x,f.y,f.z,h.x,h.y,h.z),m.subVectors(g,h),d.subVectors(f,g),y.crossVectors(m,d),u.push(y.x,y.y,y.z,y.x,y.y,y.z,y.x,y.y,y.z),c.push(J,J+1,J+2),p.push(0,0,0,1,1,0)},T=()=>{let S={guid:ys(),resolved:!0,positions:new Float32Array(a),normals:new Float32Array(u),faces:new Uint32Array(c),uvs:new Float32Array(p),extraAttrs:new Float32Array([])};return l.length&&(S.colors=new Float32Array(l)),S};if(t.valueType===As&&!Array.isArray(i)){let S=e.metaData.computedSurfaceOpacity,E=\"\";if(o){let j=(M=e.metaData.colorLatexValue)!=null?M:e.userData.color;E=wx(e.userData,j)}let v=Vx(t._chunk),D=v.value,G=v.restriction;for(let j=0;j<D.length;j++){let[[Q,W,K],[J,re,ie],[It,Bt,xe]]=D[j];if(x(Q,W,K,J,re,ie,It,Bt,xe),!o){let ee=e.metaData.colorLatexValue[j],[U,te,Ce]=bv(ee);l.push(U,te,Ce,U,te,Ce,U,te,Ce)}}return[{meshData:T(),color:E,surfaceOpacity:S!=null?S:1,restrictionShader:G,graphMode:117}]}let P=t.getRestrictedFunctionForGLSL([\"x\",\"y\",\"z\"],Ho);return t=P.concrete,Kr({color:!0,surfaceOpacity:!0},{concrete:t,graphInfo:r,node:e,policy:s,styleBroadcastStrategy:n},(S,E)=>{var ie;let[[v,D,G],[j,Q,W],[K,J,re]]=S.asValue();return a=[],u=[],c=[],p=[],x(v,D,G,j,Q,W,K,J,re),[{meshData:T(),color:wx(e.userData,E.color),surfaceOpacity:(ie=E.surfaceOpacity)!=null?ie:1,restrictionShader:P.restriction,graphMode:117}]})}function Iw({node:e,concrete:t,graphInfo:n,policy:r,styleBroadcastStrategy:s}){var i;let o=e.metaData.colorLatexValue?!Array.isArray(e.metaData.colorLatexValue):!0;if(t.valueType===vo&&o&&!Array.isArray(e.metaData.computedLineWidth)){let a=(i=e.metaData.colorLatexValue)!=null?i:e.userData.color,u=e.metaData.computedLineWidth,c=[];return Kr({color:!0},{node:e,concrete:t,policy:r,graphInfo:n,styleBroadcastStrategy:s},p=>{if(p.valueType===Jt){let[[l,m,d],[y,g,f]]=p.asValue();c.push(l,m,d,y,g,f,NaN,NaN,NaN)}return[]}),[{graphMode:119,guid:ys(),points:c,color:a,thickness:u!=null?u:1}]}return Kr({color:!0,lineWidth:!0},{node:e,concrete:t,policy:r,graphInfo:n,styleBroadcastStrategy:s},(a,u)=>{let{lineWidth:c,color:p}=u,l=a.asValue(),[[m,d,y],[g,f,h]]=l;return Ev(m,d,y,g,f,h)?[]:[{graphMode:119,guid:ys(),points:[m,d,y,g,f,h],color:p,thickness:c}]})}function Pw({node:e,concrete:t,graphInfo:n,policy:r,styleBroadcastStrategy:s}){var i;let o=e.metaData.colorLatexValue?!Array.isArray(e.metaData.colorLatexValue):!0;if(t.valueType===Do&&o&&!Array.isArray(e.metaData.computedLineWidth)){let a=(i=e.metaData.colorLatexValue)!=null?i:e.userData.color,u=e.metaData.computedLineWidth,c=[];return Kr({color:!0},{node:e,concrete:t,policy:r,graphInfo:n,styleBroadcastStrategy:s},p=>{if(p.valueType===Fe){let[[l,m,d],[y,g,f]]=p.asValue();c.push(y,g,f,l+y,m+g,d+f)}return[]}),[{graphMode:129,guid:ys(),points:c,color:a,thickness:u!=null?u:1}]}return Kr({color:!0,lineWidth:!0},{node:e,concrete:t,policy:r,graphInfo:n,styleBroadcastStrategy:s},(a,u)=>{let{lineWidth:c,color:p}=u,l=a.asValue(),[[m,d,y],[g,f,h]]=l;return Ev(m,d,y,g,f,h)?[]:[{graphMode:129,guid:ys(),points:[g,f,h,m+g,d+f,y+h],color:p,thickness:c}]})}function Ew({node:e,concrete:t,graphInfo:n,policy:r,styleBroadcastStrategy:s}){return Kr({color:!0,resolution:!0,surfaceOpacity:!0},{node:e,concrete:t,policy:r,graphInfo:n,styleBroadcastStrategy:s},(o,i)=>{let{color:a,surfaceOpacity:u}=i,c=o.asValue(),[[p,l,m],d]=c,y=Math.abs(d);return isNaN(p)||isNaN(l)||isNaN(m)||isNaN(d)?[]:[{graphMode:118,position:[p,l,m],radius:[y,y,y],guid:ys(),color:a,surfaceOpacity:u!=null?u:1}]})}function k$(){throw new Error(\"Programming error: this function is not expected to be called\")}function Sv(e,t,n,r){let s=[];for(let o=0;o<t.otherVariableSolutionData.length;o++){let i=t.otherVariableSolutionData[o];if(!i)continue;let{coefficients:a,restriction:u}=i,c=a.argNames[0];if(c!==\"x\"&&c!==\"y\")continue;let p=a.getCompiledFunction().fn,l,m;c===\"y\"?(l=1,m=2):(l=2,m=1);let d=void 0,{listIndex:y,style:g,lineWidth:f,lineOpacity:h,color:x}=Ya(e,o,d),T=hp(n,{graphMode:l,domainBound:vr(),lineWidth:f,operator:\"=\"},k$);if(!T)continue;let P=dw(p,T);for(let M of P){let S=new Dn(u.substituteConstantArguments({[c]:M})),E=Qr(e,r,S);E={...E,graphMode:m,lineWidth:f};let D=Vu(e,r,S,n,E,void 0,t.branchMultiplier===2?\"solvedEquation\":void 0);for(let G of D)s.push({...G,listIndex:y,style:g,lineWidth:f,lineOpacity:h,color:x})}}return s.length>0?s:!1}function Sw(e,t,n,r){let s=Qr(e,t,n),o=s.graphMode,i=\"baseComparator\",a=e.userData.lines===void 0?!0:e.userData.lines;if(o===8||o===112||o===113||o===127||o===210)return Vu(e,t,n,r,s);if(o===10)return[];if(!(n instanceof A.SolvedEquation))return[];let u=e.getOperator(),c=[],p=[],l=!0;n._expression.eachElement(h=>{c.push(h.getCompiledFunction());try{p.push(h.getCompiledDerivative())}catch(x){l=!1}}),l||(p=void 0);let m=[],d=[-1,0,0,1],y=Fi(e.metaData,[\"computedLineWidth\",\"computedLineOpacity\",\"computedFillOpacity\",\"colorLatexValue\"],i),g=Math.min(c.length,y);for(let h=0;h<g;h++){let x=Qr(e,t,n._expression.args[h]);x.graphMode=o;let{listIndex:T,style:P,color:M,lineWidth:S,lineOpacity:E,fillOpacity:v}=Ya(e,h,i);x.listIndex=T,x.style=P,x.color=M,s.graphMode===6&&(x.domain={type:\"1d\",min:e.metaData.evaluatedDomainMin,max:e.metaData.evaluatedDomainMax,isExplicit:e.metaData.isExplicitDomain});let D=pa({viewState:r,graphInfo:x,compiled:c[h],derivative:p?p[h]:void 0});D.lineWidth=S,D.lineOpacity=E,D.fillOpacity=v,D.operator=Lc(Yr[u].inclusive,d[h%4]),a||(D.lineWidth=0),m.push(D)}for(let h=0;h<g;h+=4){let x=yd(m[h+1].segments,m[h+2].segments,o);m.push({graphMode:7,listIndex:m[h].listIndex,segments:x,poi:{},fillOpacity:m[h].fillOpacity,color:m[h].color})}let f=Sv(e,n,r,t);if(f){for(let h of f)h.operator=Lc(Yr[u].inclusive,0);Array.prototype.push.apply(m,f)}return m}function Mw(e,t,n,r){let s=Qr(e,t,n);if(s.graphMode===10)return[];let o=[],i=Lc(Yr[e._operators[0]].inclusive,0),a=Lc(Yr[e._operators[1]].inclusive,0),u=e.userData,c=e.metaData,p=u.lines===void 0?!0:u.lines,l=[\"colorLatexValue\",\"computedFillOpacity\"];p&&l.push(\"computedLineWidth\",\"computedLineOpacity\");let m=Fi(c,l),d=n._expressions;return Dr(d),Es.eachArgs(d,(y,g)=>{let f=g;if(f>=m)return;y[0].userData=y[1].userData=u,y[0].metaData=y[1].metaData=c;let h=void 0,{color:x,lineWidth:T,lineOpacity:P,fillOpacity:M}=Ya(e,f,h),S,E;y[0].type===\"IRExpression\"&&(S=Vu(e,t,y[0],r,s)[0],S.listIndex=f,S.operator=i,S.color=x,S.lineWidth=T,S.lineOpacity=P,o.push(S)),y[1].type===\"IRExpression\"&&(E=Vu(e,t,y[1],r,s)[0],E.listIndex=f,E.operator=a,E.color=x,E.lineWidth=T,E.lineOpacity=P,o.push(E));let v=S==null?void 0:S.segments,D=E==null?void 0:E.segments;if(Dr(v),Dr(D),S&&E){let G=yd(v,D,S.graphMode);p||(S.lineWidth=0,E.lineWidth=0),o.push({graphMode:7,listIndex:S.listIndex,segments:G,lineOpacity:P,fillOpacity:M,poi:{},color:x})}}),o}function Cw(e=void 0){let{xmin:t,xmax:n,ymin:r,ymax:s,zmin:o,zmax:i}=e!=null?e:new vx,a=[t,r,i,t,s,i,n,s,i,n,r,i,t,r,o,t,s,o,n,s,o,n,r,o,t,r,o,t,r,i,t,s,i,t,s,o,n,r,o,n,r,i,n,s,i,n,s,o,n,r,o,n,r,i,t,r,i,t,r,o,n,s,o,n,s,i,t,s,i,t,s,o],u=[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],c=[0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,0,1,1,0,1,0,1,1,1,1,1,0,1,0,0,0,0,0,1,1,1,1,0,1,0,1],p=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];return{positions:new Float32Array(a),normals:new Float32Array(u),faces:new Uint16Array(p),uvs:new Float32Array(c)}}var{abs:ll,min:Mv,max:Cv}=Math;function vv(e,t){let{xmin:n,xmax:r,ymin:s,ymax:o,zmin:i,zmax:a}=t,u=[[n,s,a],[n,o,a],[r,o,a],[r,s,a],[n,s,i],[n,o,i],[r,o,i],[r,s,i]],c=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]],p=[];for(let[v,D]of c){let G=u[v],j=u[D],Q=e(...G),W=e(...j),K=Q/(Q-W);0<=K&&K<=1&&p.push(Si(G,j,K))}if(p.length<3)return;let l=Mv(...p.map(v=>v[0])),m=Cv(...p.map(v=>v[0])),d=Mv(...p.map(v=>v[1])),y=Cv(...p.map(v=>v[1])),g=Mv(...p.map(v=>v[2])),f=Cv(...p.map(v=>v[2])),h=e(n,s,i),x=(e(r,s,i)-h)/(r-n),T=(e(n,o,i)-h)/(o-s),P=(e(n,s,a)-h)/(a-i),M,S,E;return ll(P)>=ll(x)&&ll(P)>=ll(T)?(M=(v,D)=>[v,D,i-(h+x*(v-n)+T*(D-s))/P],S=new we(l,m),E=new we(d,y)):ll(T)>=ll(P)&&ll(T)>=ll(x)?(M=(v,D)=>[v,s-(h+x*(v-n)+P*(D-i))/T,D],S=new we(l,m),E=new we(g,f)):(M=(v,D)=>[n-(h+T*(v-s)+P*(D-i))/x,v,D],S=new we(d,y),E=new we(g,f)),{explicitPlane:M,u:S,v:E}}function Ny(e,t){let n=[],r=[],s=[],o=[],i=vv(e,t);if(i){let{explicitPlane:a,u,v:c}=i;n.push(...a(u.min,c.min),...a(u.max,c.min),...a(u.min,c.max),...a(u.max,c.max));let p=new Ke(n[0],n[1],n[2]),l=new Ke(n[3],n[4],n[5]),m=new Ke(n[6],n[7],n[8]),d=new Ke().subVectors(m,p),y=new Ke().subVectors(p,l),g=d.cross(y).normalize();r.push(g.x,g.y,g.z,g.x,g.y,g.z,g.x,g.y,g.z,g.x,g.y,g.z),s.push(0,0,0,1,1,0,1,1),o.push(0,1,2,3,2,1)}return{positions:n,normals:r,faces:o,uvs:s,resolved:!0,extraAttrs:[]}}var on={NONE:\"NONE\",X:\"X\",Y:\"Y\",XY:\"XY\",AUTO:\"AUTO\"};function $$(e){return!e||e[0].type===\"none\"&&e[1].type===\"none\"?on.NONE:e[1].type===\"none\"?on.X:e[0].type===\"none\"?on.Y:on.XY}function vw(e,t){let n=$$(t);switch(e){case on.NONE:return on.NONE;case on.AUTO:return n;case on.XY:return n;case on.X:return n===on.X||n===on.XY?on.X:on.NONE;case on.Y:return n===on.Y||n===on.XY?on.Y:on.NONE;default:return on.NONE}}function pl(e,t){if(t.type!==33)return!1;let n=e.getInstruction(t.args[2]);return n.type===1&&Yi(n.valueType)&&KR(n.valueType,n.value)||pl(e,n)&&Dw(e,t.args[1])&&Dw(e,n.args[1])}function Dv(e,t){let n=[];for(;t.type===33;)n.push(t.args[0]),t=e.getInstruction(t.args[2]);return n}function*Bx(e,t){let n=e.getInstruction(t);n.type!==32?yield t:(yield*Bx(e,n.args[0]),yield*Bx(e,n.args[1]))}function Nw(e,t){return e.getInstruction(t).type===25}function Rw(e,t){let n=e.getInstruction(t);if(n.type!==25)return;let r=n.args[0],s=n.args[1],o=e.getInstruction(r),i=e.getInstruction(s),a=(i.type===41||i.type===40)&&Ue(e.getInstruction(i.args[0]));return o.type===2&&(Ue(i)||a)&&se(i.valueType,b)?{type:\"constant\",variable:e.argNames[r],index:s}:se(o.valueType,b)&&se(i.valueType,b)?{type:\"implicit\",index:e.Subtract([r,s])}:void 0}function Dw(e,t){let n=e.getInstruction(t);return n.type===1&&n.valueType===b&&w(n.value)===1}function Ow(e){let t=[];for(let r=0;r<e.instructionsLength();r++)t.push(!1);let n=[];t[e.getReturnIndex()]=!0;for(let r=e.instructionsLength()-1;r>=0;r--){if(!t[r])continue;let s=e.getInstruction(r);if(s.type===2&&n.push(e.argNames[r]),!ce(s))continue;let o=pl(e,s)?[s.args[1]]:s.args;for(let i of o)t[i]=!0}return n}var xd=class{constructor({enableGeometry:t,enable3d:n,scales:r,includeFunctionParametersInRandomSeed:s,isComplexEnabled:o,customRegressions:i,isRecursionEnabled:a,isNewStatsEnabled:u}){this._isGeometry=!1;this._is3dProduct=!1;this._isGeometry=t,this._is3dProduct=n,this._scales=r,this._includeFunctionParametersInRandomSeed=s,this._isComplexEnabled=!!o,this._customRegressions=i,this._isRecursionEnabled=!!a,this._isNewStatsEnabled=!!u}isGeometryEnabled(){return this._isGeometry}is3dProduct(){return this._is3dProduct}is3dPolicy(){return!1}isComplexEnabled(){return this._isComplexEnabled}isRecursionEnabled(){return this._isRecursionEnabled}isNewStatsEnabled(){return this._isNewStatsEnabled}polygonUnsupportedPreferTriangle(){return!1}areAllScalesLinear(){return this._scales?this._scales.xAxisScale===\"linear\"&&this._scales.yAxisScale===\"linear\":!0}assignmentForbidden(t){return t===\"x\"||t===\"y\"||t===\"theta\"||t===\"index\"||t===\"dt\"||t.slice(0,3)===\"tmp\"||rt.hasOwnProperty(t)||this.isComplexEnabled()&&t===Nr}isValidSlider(t){return t===\"x\"||t===\"y\"?!0:!(t.slice(0,3)===\"ans\"||t.slice(0,6)===\"idref_\"||this.assignmentForbidden(t))}sliderVariables(t){return t.indexOf(\"theta\")!==-1&&(t=t.filter(n=>n!==\"r\")),t.filter(n=>!(this.assignmentForbidden(n)||n.slice(0,3)===\"ans\"||n.slice(0,6)===\"idref_\"||n[0]===\"_\"||this.isGeometryEnabled()&&n[0]===\"$\"))}tooManySliderVariables(t,n,r){return r?t.length>=1:t.length>=2&&n.length>=1}graphingEnabled(){return!0}ansEnabled(){return!1}dimensionVarsEnabled(){return!0}validRegressionParameter(t){return t!==\"x\"&&t!==\"y\"}validLHS(t){return t!==\"theta\"&&t.slice(0,6)!==\"idref_\"}unplottablePolarFunction(t,n){return t!==\"theta\"?!1:n.indexOf(\"r\")!==-1}validDoubleInequalitySymbol(t){return t===\"x\"||t===\"y\"}validDoubleInequalityVariables(t){return t.length>2?!1:t.every(this.validDoubleInequalitySymbol)}validExpressionVariables(t){return t.length===1&&t[0]===\"x\"}validSolvedVariable(t){return t===\"x\"||t===\"y\"||t===\"r\"}validImplicitVariables(t){switch(t.length){case 0:return!0;case 1:return t[0]===\"x\"||t[0]===\"y\"||t[0]===\"r\";case 2:return t[0]===\"x\"&&t[1]===\"y\"||t[0]===\"y\"&&t[1]===\"x\"||t[0]===\"r\"&&t[1]===\"theta\"||t[0]===\"theta\"&&t[1]===\"r\";default:return!1}}graphableListVariables(t,n){return t===\"x\"||t===\"y\"||t===\"r\"||n===\"x\"||n===\"y\"}validParametricVariable(t){return t===\"t\"}validParametricVariables(t){return t.length===1&&this.validParametricVariable(t[0])}validInequalityVariables(t){switch(t.length){case 1:return t[0]===\"x\"||t[0]===\"y\"||t[0]===\"r\";case 2:return this.validImplicitVariables(t);default:return!1}}validFirstColumnVariable(t){return t!==\"y\"&&t!==\"r\"&&t!==\"theta\"&&!t.match(/y_(\\d+)/)}validActionVariable(t){return t===\"dt\"||t===\"index\"}complicatedPolarImplicit(t,n){return t===\"theta\"||t===\"r\"&&n!==1}graphMode(t,n,r){if(n.length===0)return t===\"x\"?1:t===\"r\"?6:t===\"y\"?2:10;let s=n[0];return s===\"y\"?1:t===\"x\"?1:t===\"r\"&&s===\"theta\"?6:this.isComplexEnabled()&&t!==\"y\"&&s!==\"x\"?10:2}functionDefinitionGraphMode(t,n){return this.graphMode(t,n)}tableableAsConstant(t){return!(t===\"x\"||t===\"r\"||t===\"theta\")}implicitIndependent(t){return\"x\"}implicitDependency(t){return t.length!==1?\"y\":t[0]===\"y\"?\"x\":t[0]===\"theta\"?\"r\":\"y\"}disabledFeatures(){return[]}shouldIncludeFunctionParametersInRandomSeed(){return this._includeFunctionParametersInRandomSeed}isCustomRegressionSupported(){return this._customRegressions}},Gx=class{constructor({beta3d:t,includeFunctionParametersInRandomSeed:n,isComplexEnabled:r,customRegressions:s,isRecursionEnabled:o,isNewStatsEnabled:i}){this._isBeta3d=!1;this._isBeta3d=t,this.policy2d=new xd({enableGeometry:!1,enable3d:!0,scales:{xAxisScale:\"linear\",yAxisScale:\"linear\"},includeFunctionParametersInRandomSeed:n,isComplexEnabled:r,customRegressions:s,isRecursionEnabled:o,isNewStatsEnabled:i})}isGeometryEnabled(){return!1}is3dProduct(){return!0}is3dPolicy(){return!0}isBeta3d(){return this._isBeta3d}isComplexEnabled(){return this.policy2d.isComplexEnabled()}isRecursionEnabled(){return this.policy2d.isRecursionEnabled()}polygonUnsupportedPreferTriangle(){return!0}areAllScalesLinear(){return!0}graphingEnabled(){return!0}ansEnabled(){return!1}dimensionVarsEnabled(){return!1}validInequalityVariables(t){return this.validImplicitVariables(t)}validFirstColumnVariable(t){return this.policy2d.validFirstColumnVariable(t)}validActionVariable(t){return this.policy2d.validActionVariable(t)}tableableAsConstant(t){return this.policy2d.tableableAsConstant(t)}implicitIndependent(t){return this.policy2d.implicitIndependent(t)}validRegressionParameter(t){return this.policy2d.validRegressionParameter(t)}assignmentForbidden(t){return t===\"x\"||t===\"y\"||t===\"z\"||t===\"r\"||t===\"rho\"||t===\"theta\"||t===\"phi\"||this.policy2d.assignmentForbidden(t)}sliderVariables(t){return t.filter(n=>!(this.assignmentForbidden(n)||n.slice(0,3)===\"ans\"||n.slice(0,6)===\"idref_\"||n[0]===\"_\"))}tooManySliderVariables(t,n,r){return r?this.isBeta3d()?n.length>=1:t.length>=1:n.length>=1}isValidSlider(t){return!(t.slice(0,3)===\"ans\"||t.slice(0,6)===\"idref_\"||this.assignmentForbidden(t))}validLHS(t){return t!==\"phi\"&&this.policy2d.validLHS(t)}unplottablePolarFunction(t,n){return!1}complicatedPolarImplicit(t,n){return!1}validDoubleInequalitySymbol(t){return Ry(t)}validDoubleInequalityVariables(t){return t.every(Ry)}validExpressionVariables(t){return t.length===2&&t.every(n=>n==\"x\"||n==\"y\")}validSolvedVariable(t){return Ry(t)||t===\"r\"||t===\"rho\"}validImplicitVariables(t){return t.every(Ry)}graphableListVariables(t,n){return t===\"x\"||t===\"y\"||t===\"z\"||t===\"r\"||t===\"rho\"||n===\"x\"||n===\"y\"}validParametricVariable(t){return t===\"t\"||t===\"u\"||t===\"v\"}validParametricVariables(t){return t.length===1&&this.validParametricVariable(t[0])||t.length===2&&t.every(Nv)}functionDefinitionGraphMode(t,n){if(n.length===1)switch(n[0]){case\"x\":return 121;case\"y\":return 120;default:return 10}else if(n.length===2&&n.every(r=>r==\"x\"||r==\"y\"))return 106;return 10}graphMode(t,n,r){if(r!=null||(r=n),n.length===0)switch(t){case\"z\":return r.some(s=>s===\"r\"||s===\"theta\")?109:106;case\"y\":return r.includes(\"z\")?108:123;case\"x\":return r.includes(\"z\")?107:122;case\"r\":return r.indexOf(\"r\")>-1?10:Aw(r);case\"rho\":return 111;default:return 10}switch(t){case\"z\":return n.every(s=>s==\"x\"||s==\"y\")?106:n.every(s=>s==\"r\"||s==\"theta\")?109:10;case\"y\":return n.every(s=>s==\"x\")?r.some(s=>s===\"z\")?108:121:n.every(s=>s==\"x\"||s==\"z\")?108:10;case\"x\":return n.every(s=>s==\"y\")?r.some(s=>s===\"z\")?107:120:n.every(s=>s==\"y\"||s==\"z\")?107:10;case\"r\":return n.every(s=>s==\"theta\")?Aw(r):n.every(s=>s==\"theta\"||s==\"z\")?110:10;case\"rho\":return n.every(s=>s==\"theta\"||s==\"phi\")?111:10;default:return 10}}implicitDependency(t){if(t.length!==2)return\"z\";let n=t[0]<t[1]?t[0]+t[1]:t[1]+t[0];return n===\"xy\"?\"z\":n===\"xz\"?\"y\":n===\"yz\"?\"x\":\"z\"}disabledFeatures(){return[]}shouldIncludeFunctionParametersInRandomSeed(){return this.policy2d.shouldIncludeFunctionParametersInRandomSeed()}isCustomRegressionSupported(){return this.policy2d.isCustomRegressionSupported()}isNewStatsEnabled(){return this.policy2d.isNewStatsEnabled()}},Ry=e=>e===\"x\"||e===\"y\"||e===\"z\",Nv=e=>e===\"u\"||e===\"v\";function Aw(e){return e.some(n=>Ry(n)||n===\"r\")?110:124}lt.prototype.getGraphMode=function(e,t){return 10};lt.prototype.graphmodeDependencies=da;function da(e,t){let n=t.getDependencies();if(e.is3dProduct()&&t instanceof Dn){let r=new Set(Ow(t._chunk));return n.filter(s=>r.has(s))}else return n}function Y$(e,t){let n;return e&&e.hasOwnProperty(\"dragMode\")?e.dragMode===on.AUTO?n=t.defaultDragMode:n=e.dragMode:n=t.defaultDragMode,vw(n,t.moveStrategy)}function _w(e,t){let n=e.is3dPolicy();if(pb(t)&&!n&&Y$(this.userData,t)!==on.NONE)return t.valueType===O?26:4;let r=da(e,t);switch(t.valueType){case zr:case F:if(n){if(r.length===0)return 114;if(e.validParametricVariables(r))return r.length==1?100:Bu(103,t)}return 10;case O:case He:case N:case Gt:{let s=se(t.valueType,O);return r.length===0?s?25:3:n&&e.validParametricVariables(r)?r.length===1?5:r.every(Nv)?Bu(130,t):10:e.validParametricVariables(r)?5:10}case b:case Y:return!e.is3dPolicy()&&r.length===1?2:n&&r.length===2&&r.indexOf(\"x\")>-1&&r.indexOf(\"y\")>-1?Bu(106,t):10}if(r.length>0)return 10;switch(t.valueType){case Ro:case xa:return 5;case No:case ga:return 5;case rs:case ki:return n?100:10;case xi:case Ta:return n?Bu(130,t):10;case hi:case ha:return n?Bu(130,t):10;case bi:case ba:return n?Bu(103,t):10;case Jt:case vo:return n?119:10;case Fe:case Do:return n?129:10;case Kn:case As:return n?117:10;case Mr:case zi:return n?118:10;case Se:case hr:return 16;case pe:case oo:return 20;case ae:case ts:return 21;case Ie:case lr:return 17;case Pe:case io:return 18;case De:case ns:return 19;case ye:case ao:return this instanceof Ve&&this.getDependencies().length===1?10:24;case ve:case Er:case Te:case Sr:return 23;default:return 10}}k.prototype.getGraphMode=_w;function ww(e,t){let n=t._expression.getDependencies();if(n.length>1)return 10;if(Im(t._expression)&&t._expression.isList&&t._expression.length===0)return 10;let r=t._symbol,s=t.getDependencies();return e.graphMode(r,n,s)}A.Equation.prototype.getGraphMode=A.CallAssignment.prototype.getGraphMode=os.prototype.getGraphMode=A.ComparatorChain.prototype.getGraphMode=function(e,t){if(t.type===\"Error\")return 10;let n=da(e,t),r=t.getDependencies();if(e.is3dPolicy()){let s=10;return n.length>0&&(r.includes(\"z\")?s=this.isInequality()?113:112:s=this.isInequality()?127:126),Bu(s,t)}return t.type===\"IRExpression\"&&t.isConstant?10:t instanceof A.SolvedEquation?ww(e,t):n.length===1||n.length===2?8:10};function Ov(e){var t;return e===106||e===200||e===107||e===201||e===108||e===202?[\"x\",\"y\",\"z\",\"_implicit\"]:e===110||e===211?[\"x\",\"y\",\"z\",\"r\",\"theta\",\"_implicit\"]:e===111||e===212?[\"x\",\"y\",\"z\",\"rho\",\"theta\",\"phi\",\"_implicit\"]:e===109||e===213?[\"x\",\"y\",\"z\",\"r\",\"theta\",\"_implicit\"]:e===103||e===214||e===130||e===215?[\"x\",\"y\",\"z\",\"u\",\"v\",\"_implicit\"]:e===113||e===210||e===112||e===209?[\"x\",\"y\",\"z\",\"_implicit\"]:(t=Go[e])!=null?t:[]}function Bu(e,t){let n=Ov(e),r=t._chunk;try{let o=uc(r,n,{allowSlices:!0}).getSliceVariablesOrImplicit();if(o.length!==1)return e;let i=o[0];return n.indexOf(i)<0?10:D_(e,i)}catch(s){return 10}}A.DoubleInequality.prototype.getGraphMode=function(e,t){let n=t.getDependencies();return e.graphMode(t._symbol,[],n)};Rn.prototype.getGraphMode=function(e,t){if(t instanceof A.SolvedEquation)return ww(e,t);if(this.isEquation(e,t))return this.asEquation().getGraphMode(e,t);let n=da(e,t),r=this._symbol,s=t.getDependencies();switch(t.valueType){case b:case Y:case Ae:switch(n.length){case 0:{let i=e.graphMode(r,[],s);return e.is3dPolicy()?Bu(i,t):i}case 1:if(t.valueType===Y&&!e.graphableListVariables(r,n[0]))return 10;if(this.type===\"Slider\")return 10;let o=e.graphMode(r,n,s);return e.is3dPolicy()?Bu(o,t):o;default:return e.is3dPolicy()?Bu(e.graphMode(r,n,s),t):10}case F:if(!e.is3dPolicy()||e.assignmentForbidden(r)||n.length>0&&!e.validParametricVariables(n))return 10;switch(n.length){case 0:return 114;case 1:return 100;case 2:return 103;default:return 10}default:return _w.call(this,e,t)}};A.FunctionDefinition.prototype.getGraphMode=function(e,t){let n=e.is3dPolicy();if(this._argSymbols.length!==1&&!n)return 10;if(this.recursionInfo){let o=t instanceof Dn?t.getRecursiveFunctionMetadata():void 0;if((o==null?void 0:o.type)===\"missing-non-recursive-branch\")return 10;if((o==null?void 0:o.recursiveStructure.domainInfo[this._symbol][0])===1)return 10}let r=e.functionDefinitionGraphMode(this._symbol,this._argSymbols),s=da(e,t);switch(t.valueType){case b:case Y:if(n)return r;switch(s.length){case 0:return r;case 1:return s[0]!==this._argSymbols[0]?10:r;default:return 10}break;default:return 10}};A.Regression.prototype.getGraphMode=function(e,t){return this.isLhsSimple?t.isModelValid?t.model.getDependencies().length!==1?10:2:10:10};function Av(e,t){return t.type===\"Error\"?10:11}A.Histogram.prototype.getGraphMode=Av;A.DotPlot.prototype.getGraphMode=Av;A.BoxPlot.prototype.getGraphMode=Av;A.Image.prototype.getGraphMode=function(e,t){return this.userData.showPoints?this.center.type===\"Error\"||this.radianAngle.type===\"Error\"||this.width.type===\"Error\"||this.height.type===\"Error\"||this.opacity.type===\"Error\"?10:3:10};function Lw(e){let t=0,n=0,r=[],s=Zr(e,e.getReturnIndex()),o=_v(e);for(let i=0;i<e.instructionsLength();i++){if(!s[i])continue;let a=e.getInstruction(i);a.type===25?r[i]=1:a.type===31||a.type===32?r[i]=r[a.args[0]]+r[a.args[1]]:r[i]=0,pl(e,a)&&o[a.args[0]]&&(t+=1,n+=r[a.args[0]])}return{numRestrictions:t,numEqualityRestrictions:n}}function Td(e,t,n){try{return Z$(e,t,n)}catch(r){return r instanceof C?r:V(r)}}function Z$(e,t,n){var p,l;if(!e.is3dProduct()||n.type===\"Error\")return n;if(!(n instanceof Dn))return V(\"Expected peel error to be checked on an IRExpression\");function r(m,d){let y=d.filter(g=>m.indexOf(g)<0);if(y.length)return jE(y[0]).allowExport().setDependencies(y)}function s(){let m=Hx(i),d=X$(e,n);return r(m,d)}function o(){let m=Fw(i);if(i===117){let y=j$(n);return y.error===wv?JE():r(m,y.mispredicted)}let d=W$(e,n,i);return r(m,d)}let i=t.getGraphMode(e,n),a=n._chunk,{numRestrictions:u,numEqualityRestrictions:c}=Lw(a);if(c!==0)if(c===1){if(u!==c&&!t.isInequality())return YP();let y=uc(a,[],{allowSlices:!0}).getSliceVariablesOrImplicit();if(y.length!==1)return gu();let g=Ov(i),f=y[0];if(g.indexOf(f)<0)return f===\"_implicit\"?gu().allowExport():KE(f).allowExport().setDependencies([f])}else return $P();return(l=(p=s())!=null?p:o())!=null?l:n}function X$(e,t){let n=da(e,t);return t.getDependencies().filter(s=>n.indexOf(s)<0)}function W$(e,t,n){let r=da(e,t),s=new Set;if(t instanceof Dn){let i=t.getRestrictedFunctionForGLSL(Hx(n),Ho).concrete;for(let a of i.getDependencies())r.indexOf(a)>-1||s.add(a)}return[...s]}function j$(e){let t=new Set,n;if(e instanceof Dn){let r=e._chunk;r.argNames.forEach(o=>t.add(o));let s=Vx(r);n=s.error,s.restriction!==void 0&&[\"x\",\"y\",\"z\"].forEach(o=>t.delete(o))}return{mispredicted:[...t],error:n}}function Hx(e){var n;if(!Ou(e))return[];let t=J$(e)?[\"x\",\"y\",\"z\"]:[];return e===211&&t.push(\"r\"),e===212&&t.push(\"rho\"),t.push(...(n=ul[e])!=null?n:[]),t.push(...Fw(e).filter(r=>t.indexOf(r)<0)),t}function J$(e){return Q$(e)||e==200||e==201||e==202||e==211||e==212||e==213||e==214||e==215}function Q$(e){if(!Ou(e))return!1;switch(e){case 106:case 107:case 108:case 110:case 111:case 109:case 122:case 123:case 112:case 113:case 127:case 130:case 103:case 210:case 117:return!0;case 124:case 120:case 121:case 126:case 114:case 118:case 119:case 129:case 128:case 100:case 200:case 201:case 202:case 206:case 205:case 211:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:return!1;default:return!1}}function Fw(e){var t;return Ou(e)?(t=Go[e])!=null?t:[]:[]}function qo(e){let t=e;if(t&&typeof t.toJSON==\"function\"&&(t=t.toJSON()),!t||typeof t!=\"object\")return t;if(Array.isArray(t))return t.map(qo);let n={};for(let r in t)t.hasOwnProperty(r)&&(n[r]=qo(t[r]));return n}var K$=e=>{let t=[],n=[],r=e.length;for(let s=0;s<r;s++)t.push(e[s][0]),n.push(e[s][1]);return{defined:{x:t,y:n}}},Po=K$;function Bw(e,t,n){switch(n){case\"left\":return[[-1/0,e]];case\"right\":return[[e,1/0]];case\"inner\":return[[e,t]];case\"outer\":return[[-1/0,e],[t,1/0]];default:throw new Error(`Unexpected tails ${n}`)}}function e5(e){let{viewState:t,graphInfo:n,compiled:r,derivative:s,bounds:o}=e,i=qo(n),a=er(n.domainBound,jo(o));if(!co(a))return i.domainBound=a,i.lineStyle=gd.SOLID,pa({graphInfo:i,viewState:t,compiled:r,derivative:s})}function Gw(e){let{viewState:t,graphInfo:n,compiled:r,maxOverride:s,showPoint:o}=e,i=r.fn,a=hp(t,n,i),u;if(!a)u={segments:[],resolved:!0};else{let{min:l,max:m}=a;u=pw({fn:i,min:Math.max(l,0),max:s!==void 0?Math.min(s,m):m})}let{points:c,droppedIndices:p}=bp(u.segments);return{segments:[c],droppedIndices:p,graphMode:3,color:n.color,style:n.pointStyle,poi:Po(u.segments),resolved:u.resolved,showPoint:o}}function qx(e){let{viewState:t,graphInfo:n,compiled:r,bounds:s,showPoint:o}=e,i=qo(n),a=er(n.domainBound,jo(s));if(!co(a))return i.domainBound=a,i.pointStyle=cl.POINT,Gw({graphInfo:i,viewState:t,compiled:r,showPoint:o,maxOverride:void 0})}function t5(e){let{viewState:t,graphInfo:n,compiled:r,cdfMin:s,cdfMax:o,tails:i,maxOverride:a,showPoint:u}=e,c=Bw(s,o,i),p=[];for(let[l,m]of c){l=Math.ceil(l),m=Math.floor(m);let d=a!==void 0?a:1/0;l===-1/0&&m>=d?p.push(qx({bounds:[l,d],viewState:t,graphInfo:n,compiled:r,showPoint:u})):l===-1/0&&m<1/0?p.push(qx({bounds:[l,m],viewState:t,graphInfo:n,compiled:r,showPoint:u})):l>-1/0&&m>=d?p.push(qx({bounds:[l,d],viewState:t,graphInfo:n,compiled:r,showPoint:u})):p.push(qx({bounds:[l,m],viewState:t,graphInfo:n,compiled:r,showPoint:u}))}return p}function n5(e){var t,n,r,s,o,i,a,u;if(e)switch(e.symbol){case\"tdist\":{let c=(t=e.evaluatedParams[0])!=null?t:1,p=(n=e.evaluatedParams[1])!=null?n:0,l=(r=e.evaluatedParams[2])!=null?r:1,m=Yh(0,c);return{type:\"continuousDistribution\",xmin:-3*l+p,xmax:3*l+p,ymin:0,ymax:m/l}}case\"normaldist\":{let c=(s=e.evaluatedParams[0])!=null?s:0,p=(o=e.evaluatedParams[1])!=null?o:1,l=Zh(c,c,p);return{type:\"continuousDistribution\",xmin:c-2*Math.abs(p),xmax:c+2*Math.abs(p),ymin:0,ymax:l}}case\"chisqdist\":{let c=e.evaluatedParams[0],p=c<2?5:V0(c-2,c);return{type:\"continuousDistribution\",xmin:c-2*Math.sqrt(2*c),xmax:c+2*Math.sqrt(2*c),ymin:0,ymax:p}}case\"poissondist\":{let c=e.evaluatedParams[0],p=Math.max(Wh(Math.floor(c),c),Wh(Math.ceil(c),c));return{type:\"discreteDistribution\",xmin:0,xmax:2.5*c,ymin:0,ymax:p}}case\"uniformdist\":{let c=(i=e.evaluatedParams[0])!=null?i:0,p=(a=e.evaluatedParams[0])!=null?a:1,l=(c+p)/2,m=p-c,d=B0(l,c,p);return{type:\"continuousDistribution\",xmin:c-m/3,xmax:p+m/3,ymin:0,ymax:d}}case\"binomialdist\":{let c=e.evaluatedParams[0],p=(u=e.evaluatedParams[1])!=null?u:.5,l=Xh(p*c,c,p);return{type:\"discreteDistribution\",xmin:0,xmax:c,ymin:0,ymax:l}}default:throw new Error(`Unhandled distribution type ${e}`)}}function Vw(e){if(e!==void 0&&e.symbol===\"binomialdist\")return e.evaluatedParams[0]}function Hw(e,t,n,r,s,o){var f,h;let i=e.metaData.evaluatedDistributionSpec,a=e.metaData.evaluatedCDFMin,u=e.metaData.evaluatedCDFMax,c=n5(i),p=i&&i.discrete,l=(h=(f=e.userData.cdf)==null?void 0:f.tails)!=null?h:\"inner\",m=a!==void 0&&!isNaN(a),d=u!==void 0&&!isNaN(u)||l===\"right\"||l===\"left\",y=m&&d&&o,g=[{...p?Gw({viewState:n,graphInfo:{...r,pointStyle:y?cl.OPEN:cl.POINT},compiled:t,showPoint:e.userData.shouldGraph,maxOverride:Vw(i)}):pa({viewState:n,graphInfo:r,compiled:t}),boundingBox:c}];if(y)if(p){let x=t5({viewState:n,graphInfo:r,compiled:t,tails:l,cdfMin:a,cdfMax:u,maxOverride:Vw(i),showPoint:e.userData.shouldGraph});g.push(...x.filter(P=>!!P));let T=[];x.forEach(P=>P==null?void 0:P.segments[0].forEach(M=>{!isNaN(M[0])&&!isNaN(M[1])&&T.push([M[0],0,M[0],M[1]])})),g.push({graphMode:5,segments:T,boundingBox:c,poi:{},color:r.color})}else Bw(a,u,l).map(T=>e5({bounds:T,viewState:n,graphInfo:r,compiled:t,derivative:s})).forEach(T=>{if(T&&T.segments.length){let P,M;for(let S=0;S<T.segments.length;S++){let E=T.segments[S];if(E.length>=4){P=E[0];break}}for(let S=T.segments.length-1;S>=0;S--){let E=T.segments[S];if(E.length>=4){M=E[E.length-2];break}}if(P!==void 0&&M!==void 0&&isFinite(P)&&isFinite(M)){let S=yd(T.segments,[[P,0,M,0]],T.graphMode);g.push({graphMode:7,segments:S,poi:{},color:r.color})}}});return g}function Uw(e,{viewState:t,node:n,concrete:r,graphInfo:s,policy:o,styleBroadcastStrategy:i}){let a=r.valueType===b;return Kr({lineOpacity:!0,lineWidth:!0,resolution:!0,fillOpacity:!0,surfaceOpacity:!0,color:!0},{node:n,concrete:r,policy:o,graphInfo:s,styleBroadcastStrategy:i},(u,c)=>{var P,M,S,E,v,D,G,j,Q,W,K,J;(e===6||e===110||e===124)&&(c.domain={type:\"1d\",min:n.metaData.evaluatedDomainMin,max:n.metaData.evaluatedDomainMax,isExplicit:n.metaData.isExplicitDomain});let p=(P=Go[e])!=null?P:[],l=u.getCompiledFunction(p);(e==130||e==103||e==111||e==109)&&(c.domain=(M=l.domain)!=null?M:{type:\"2d\",uMin:n.metaData.evaluatedDomain3DMin1,uMax:n.metaData.evaluatedDomain3DMax1,vMin:n.metaData.evaluatedDomain3DMin2,vMax:n.metaData.evaluatedDomain3DMax2});let m=[],d;try{d=u.getCompiledDerivative()}catch(re){d=void 0}if(((S=n.metaData.distributionSpec)==null?void 0:S.type)===\"distribution\"){let re=Hw(n,l,t,c,d,a);if(re)return re}let y=RC(c.graphMode),g=(E=n.userData.extendTo3D)!=null?E:!1,f=y&&!g,h=!o.is3dPolicy()||f,x=(v=n.userData.lines)!=null?v:h,T=(D=n.userData.lines)!=null?D:!f;if(c.graphMode===127&&!g&&((G=n.userData.lines)==null||G)){let re=(j=Go[c.graphMode])!=null?j:[],ie=u._chunk.copy();ie.GreaterEqual([ie.getReturnIndex(),ie.Constant(0)]);let It=u.getCompiledFunction(re),Bt=0,xe=t.viewport,U=Ny((Ge,pt,Rt)=>Rt-Bt,xe);return[{meshData:li(U),color:c.color,surfaceOpacity:(Q=c.surfaceOpacity)!=null?Q:1,uvArgs:(W=Go[c.graphMode])!=null?W:[],extraMeshArgs:(K=ul[c.graphMode])!=null?K:[],graphMode:106,compiled:It,restrictionShader:Qo(ie,Ho)}]}if(y&&(n.userData.lines===!0?(x=f,T=!f):n.userData.lines===!1&&(x=!1,T=!1)),T&&Ou(c.graphMode)){let re=Hx(c.graphMode);if(c.graphMode===113||c.graphMode===127){let{positions:ie,normals:It,faces:Bt,uvs:xe}=Cw(),ee={guid:ys(),isDomainCube:!0,resolved:!0,positions:ie,normals:It,faces:Bt,uvs:xe,extraAttrs:new Float32Array([])},U=u.toImplicitBool();m.push({meshData:ee,graphMode:113,color:c.color,surfaceOpacity:1,uvArgs:[],extraMeshArgs:[],compiled:l,restrictionShader:Qo(U._chunk,Ho)});let te=zw(U._chunk,u._chunk,re);for(let Ce of te){let Ge=qw(c,{concrete:new Dn(Ce.value),restriction:Ce.restriction&&Qo(Ce.restriction,Ho)},t);m.push(Ge)}}else{let ie=u.getRestrictedFunctionForGLSL(re,Ho),It=qw(c,ie,t);m.push(It)}}if(x&&r5(n,c),!Ou(c.graphMode)){let re=pa({viewState:t,graphInfo:c,compiled:l,derivative:d});if(o.is3dPolicy()&&x&&Mx(re.graphMode)){let ie=(J=c.lineWidth)!=null?J:1;m.push(My(re,t,ie))}else if(re.fillSegments){let{fillSegments:ie,...It}=re;x||(It.lineWidth=0),m.push(It)}else x||(re.lineWidth=0),(x||!Ou(e))&&m.push(re);c.graphMode===8&&c.operator!==\"=\"&&m.push({graphMode:7,segments:re.fillSegments,poi:{},listIndex:c.listIndex,color:c.color,fillOpacity:c.fillOpacity})}return m})}function r5(e,t){var r,s,o;if(RC(t.graphMode))switch(t.graphMode){case 121:case 123:{t.graphMode=2,t.willConvertTo3D=!0,(r=t.lineWidth)!=null||(t.lineWidth=1);break}case 120:case 122:{t.graphMode=1,t.willConvertTo3D=!0,(s=t.lineWidth)!=null||(t.lineWidth=1);break}case 124:let{min:i,max:a}=((o=t.domain)==null?void 0:o.type)===\"1d\"?t.domain:{min:0,max:2*Math.PI};t.graphMode=6,t.domain={type:\"1d\",min:i,max:a,isExplicit:e.metaData.isExplicitDomain};break;case 126:t.graphMode=8;break}}function qw(e,t,n){var c,p,l;let r=(c=Go[e.graphMode])!=null?c:[],s=t.concrete.getCompiledFunction(r),o,i,a=!1;if(e.graphMode===112||e.graphMode===126||e.graphMode===113){e.operator!==\"=\"&&(a=!0);try{o=t.concrete.gradient([\"x\",\"y\",\"z\"])._chunk,i=o.getCompiledFunction([\"x\",\"y\",\"z\"]).fn}catch(m){}}if(e.graphMode===112&&i&&o){let m=s5(s.fn,i,o,n.viewport);if(m)return{graphMode:118,position:m.center,radius:m.radii,guid:ys(),color:e.color,restrictionShader:t.restriction,surfaceOpacity:(p=e.surfaceOpacity)!=null?p:1}}let u=e.graphMode;if((u===112||u===113||u===127||u===106||u===107||u===108)&&t.concrete._chunk.isLinearIn([\"x\",\"y\",\"z\"])||u===106&&t.concrete._chunk.isConstant()){let m=n.viewport,d;switch(u){case 106:d=(f,h,x)=>x-s.fn(f,h);break;case 107:d=(f,h,x)=>f-s.fn(h,x);break;case 108:d=(f,h,x)=>h-s.fn(f,x);break;case 112:case 113:case 127:d=s.fn;break}let y=li(Ny(d,m)),g=u===113||u===127;return u===127&&(u=113),{meshData:y,color:e.color,surfaceOpacity:g?1:(l=e.surfaceOpacity)!=null?l:1,uvArgs:[],extraMeshArgs:[],graphMode:u,compiled:s,restrictionShader:t.restriction}}return pa({viewState:n,graphInfo:e,compiled:s,restrictionShader3d:t.restriction,isImplicit3dInequality:a,gradient:i,dependencies:t.concrete._dependencies})}function s5(e,t,n,r){if(r.zmin===void 0||r.zmax===void 0)return;let s=n.argNames.indexOf(\"x\"),o=n.argNames.indexOf(\"y\"),i=n.argNames.indexOf(\"z\");if(s===-1||o===-1||i===-1)return;let a=n.getInstruction(n.getReturnIndex());if(a.type!==38||a.args.length!==3)return;let[u,c,p]=a.args,l=ps(n,s,{allowRestriction:!1,allowClosedBlockReferences:!1}),m=ps(n,o,{allowRestriction:!1,allowClosedBlockReferences:!1}),d=ps(n,i,{allowRestriction:!1,allowClosedBlockReferences:!1});if(yn(l,u)!==1||yn(m,c)!==1||yn(d,p)!==1||yn(m,u)!==0||yn(d,u)!==0||yn(l,c)!==0||yn(d,c)!==0||yn(l,p)!==0||yn(m,p)!==0)return;let{xmin:y,ymin:g,zmin:f,xmax:h,ymax:x,zmax:T}=r,P=t(y,g,f),M=t(h,x,T),S=.5*(M[0]-P[0])/(h-y),E=.5*(M[1]-P[1])/(x-g),v=.5*(M[2]-P[2])/(T-f),D=(y*M[0]-h*P[0])/(M[0]-P[0]),G=(g*M[1]-x*P[1])/(M[1]-P[1]),j=(f*M[2]-T*P[2])/(M[2]-P[2]),Q=-e(D,G,j),W=Math.sqrt(Q/S),K=Math.sqrt(Q/E),J=Math.sqrt(Q/v);if(!(!isFinite(D)||!isFinite(G)||!isFinite(j)||!isFinite(W)||!isFinite(K)||!isFinite(J)||W===0||K===0||J===0))return{center:[D,G,j],radii:[W,K,J]}}var o5=!1;function i5(e,t){let n=t.viewport.xmax-t.viewport.xmin,r=t.viewport.ymax-t.viewport.ymin,s=yi(n,r),o=yi(30,30),i=Math.round(2-Math.log(s/o)/Math.LN10);if(i<=0)return Math.round(e)+\"\";{let a=Math.pow(10,i);return Math.round(e*a)/a+\"\"}}function a5(e,t){return t.degreeMode?Math.round(e/(Math.PI/180)*10)/10+\"\\xB0\":Math.round(e*100)/100+\"\"}function u5(e,t){let n=t.viewport.xmax-t.viewport.xmin,r=t.viewport.ymax-t.viewport.ymin,s=n*r,o=30*30,i=Math.round(2-Math.log(s/o)/Math.LN10);if(i<=0)return Math.round(e)+\"\";{let a=Math.pow(10,i);return Math.round(e*a)/a+\"\"}}function kw({node:e,policy:t,styleBroadcastStrategy:n,viewState:r,concrete:s,childIntersections:o}){let i=[],a=e.userData.lines===void 0?!0:e.userData.lines,u=e.userData.fill===void 0?!0:e.userData.fill;if(!u&&!a)return i;let c=Fi(e.metaData,[\"computedLineOpacity\",\"computedLineWidth\",\"colorLatexValue\",\"fillOpacity\"],n),p=s.asValue();$(s.valueType)||(p=[p]);for(let l=0;l<p.length;l++){if(l>c-1)continue;let m=p[l];if(!m.length)continue;let d=Qr(e,t,s),{listIndex:y,lineWidth:g,lineOpacity:f,fillOpacity:h,color:x}=Ya(e,l,n);!e.userData.shouldOmitLastPolygonSegment&&m.length>2&&(m=[...m,m[0]]),Dr(m);let T=Fx(m);if(T.length){if(u&&m.length>2&&i.push({segments:T,graphMode:7,poi:{},color:x,fillOpacity:h,style:d.style,listIndex:y}),a&&(i.push({segments:T,graphMode:5,poi:{},color:x,style:e.userData.lineStyle,lineWidth:g,lineOpacity:f,listIndex:y}),o))for(let P=0;P<m.length-1;P++){mu(o.parentType,[Se,hr]);let M=o.getEdgeIntersections(P);if(!M)continue;let[S,E]=m[P],[v,D]=m[P+1];i.push(...Lx([{segments:[[S,E,v,D]],resolved:!0,graphMode:17,color:x,style:e.userData.lineStyle,arrowMode:d.arrowMode,lineWidth:g,lineOpacity:f,listIndex:y,poi:{}}],M))}if(o5&&e.userData.showLabel){let P=e.computedLabels&&e.computedLabels[y||0];i.push({graphMode:22,objectType:16,segments:T,color:x,listIndex:y,showLabel:!0,labelSize:e.metaData.computedLabelSize,labelAngle:e.metaData.computedLabelAngle,labelOrientation:e.userData.labelOrientation,labels:P?[P]:[u5(k0(m),r)]})}}}return i}function $w({node:e,concrete:t,policy:n,graphInfo:r,styleBroadcastStrategy:s}){return Kr({lineOpacity:!0,lineWidth:!0,color:!0},{node:e,concrete:t,policy:n,graphInfo:r,styleBroadcastStrategy:s},(o,i)=>{let[[a,u],c]=o.asValue();return isNaN(a)||isNaN(u)||isNaN(c)?[]:[{segments:[[a,u,c]],resolved:!0,graphMode:20,color:i.color,style:i.lineStyle,lineWidth:i.lineWidth,lineOpacity:i.lineOpacity,listIndex:i.listIndex,operator:i.operator,poi:{}}]})}function Yw({node:e,concrete:t,policy:n,graphInfo:r,childIntersections:s,styleBroadcastStrategy:o}){return Kr({color:!0,lineWidth:!0,lineOpacity:!0},{node:e,concrete:t,policy:n,graphInfo:r,styleBroadcastStrategy:o},(i,a)=>{let u=nb(i.asValue());if(!u)return[];let c=[];return u.type===\"arc\"?c.push({graphMode:21,segments:[[u.center[0],u.center[1],u.radius,u.startAngle,u.endAngle]],color:a.color,style:a.lineStyle,lineWidth:a.lineWidth,lineOpacity:a.lineOpacity,listIndex:a.listIndex,operator:r.operator,poi:{}}):u.type===\"rays\"?c.push({graphMode:19,segments:[[u.start1[0],u.start1[1],u.end1[0],u.end1[1]]],color:a.color,style:a.lineStyle,lineWidth:a.lineWidth,lineOpacity:a.lineOpacity,listIndex:a.listIndex,operator:r.operator,poi:{}},{graphMode:19,segments:[[u.start2[0],u.start2[1],u.end2[0],u.end2[1]]],color:a.color,style:a.lineStyle,lineWidth:a.lineWidth,lineOpacity:a.lineOpacity,listIndex:a.listIndex,operator:r.operator,poi:{}}):c.push({graphMode:17,segments:[[u.start[0],u.start[1],u.end[0],u.end[1]]],color:a.color,style:a.lineStyle,lineWidth:a.lineWidth,lineOpacity:a.lineOpacity,listIndex:a.listIndex,operator:r.operator,poi:{}}),[...c,...Lx(c,s)]})}function Zw({node:e,concrete:t,policy:n,graphInfo:r,childIntersections:s,viewState:o,styleBroadcastStrategy:i}){return Kr({color:!0,lineWidth:!0,lineOpacity:!0},{node:e,concrete:t,policy:n,graphInfo:r,styleBroadcastStrategy:i},(a,u)=>{let[[c,p],[l,m]]=a.asValue();if(isNaN(c)||isNaN(p)||isNaN(l)||isNaN(m))return[];let d=[],y={segments:[[c,p,l,m]],resolved:!0,graphMode:u.graphMode,color:u.color,style:u.lineStyle,arrowMode:u.arrowMode,lineWidth:u.lineWidth,lineOpacity:u.lineOpacity,listIndex:u.listIndex,operator:r.operator,poi:{}};if(d.push(cv(n,y,o)),d.push(...Lx([y],s)),e.userData.showLabel&&r.graphMode===17){let g=u.listIndex,f=e.computedLabels&&e.computedLabels[g||0];d.push({graphMode:22,objectType:17,segments:[[c,p,l,m]],color:u.color,listIndex:g,showLabel:!0,labelSize:e.metaData.computedLabelSize,labelAngle:e.metaData.computedLabelAngle,labelOrientation:e.userData.labelOrientation,labels:f?[f]:[i5(yi(l-c,m-p),o)]})}return d})}function Xw({node:e,concrete:t,policy:n,graphInfo:r,viewState:s,styleBroadcastStrategy:o}){return Kr({lineOpacity:!0,lineWidth:!0,color:!0},{node:e,concrete:t,policy:n,graphInfo:r,styleBroadcastStrategy:o},(i,a)=>{let[u,c]=i.asValue(),[[p,l],[m,d]]=[c,[c[0]+u[0],c[1]+u[1]]];if(isNaN(m)||isNaN(d)||isNaN(p)||isNaN(l))return[];let y={segments:[[p,l,m,d]],resolved:!0,graphMode:24,color:a.color,style:a.lineStyle,arrowMode:a.arrowMode,lineWidth:a.lineWidth,lineOpacity:a.lineOpacity,listIndex:a.listIndex,operator:r.operator,poi:{}};return[cv(n,y,s)]})}function Ww({node:e,concrete:t,policy:n,graphInfo:r,viewState:s,styleBroadcastStrategy:o}){return Kr({lineOpacity:!0,lineWidth:!0,color:!0},{node:e,concrete:t,policy:n,graphInfo:r,styleBroadcastStrategy:o},(i,a)=>{let u=Cs(i);if(!u)return[];let{value:c,valueType:p}=u,[[l,m],d,y]=c;if(isNaN(l)||isNaN(m)||isNaN(d)||isNaN(y))return[];let g=a.listIndex,f=p===Te,h=f?y:Math.abs(y),x=[];if(x.push({graphMode:23,segments:[[l,m,d,y,f?1:0]],color:a.color,style:a.lineStyle,lineWidth:a.lineWidth,lineOpacity:a.lineOpacity,listIndex:g,operator:r.operator,poi:{}}),e.userData.showAngleLabel){let T=e.computedLabels&&e.computedLabels[g||0];x.push({graphMode:22,objectType:23,segments:[[l,m,d,y]],color:a.color,listIndex:g,showLabel:!0,labelSize:e.metaData.computedLabelSize,labelAngle:e.metaData.computedLabelAngle,labelOrientation:e.userData.labelOrientation,labels:T?[T]:[a5(h,s)]})}return x})}function c5(e,t,n){return e?t===0&&n===0?e[2].type!==\"none\"||e[3].type!==\"none\":t!==0&&n!==0?e[0].type!==\"none\"&&e[1].type!==\"none\":t!==0?e[0].type!==\"none\":n!==0?e[1].type!==\"none\":!1:!1}function jw(e,t){let n=[];if(t.center.valueType!==N||t.center.getDependencies().length!==0||t.radianAngle.type!==\"IRExpression\"||t.width.type!==\"IRExpression\"||t.height.type!==\"IRExpression\"||t.opacity.type!==\"IRExpression\"||!t.radianAngle.isConstant||!t.width.isConstant||!t.height.isConstant||!t.opacity.isConstant)return n;let r=[],s=[],o=t.width.asValue()/2,i=t.height.asValue()/2,a=t.radianAngle.asValue();for(let u=-1;u<=1;u++)for(let c=-1;c<=1;c++){let[p,l]=t.center.asValue(),m=[p+u*o*Math.cos(a)+c*i*Math.sin(a),l-u*o*Math.sin(a)+c*i*Math.cos(a)];c5(t.moveStrategy,u,c)&&(r.push(m),s.push([u,c]))}return n.push({segments:[r],scaleFactors:[s],graphMode:4,color:Li(e.userData,e.metaData),style:e.userData.style,poi:Po(r),movablePointInfo:[],pointOpacity:1}),n}function Jw({node:e,graphInfo:t,policy:n,reconciledProps:r,concrete:s,viewState:o,styleBroadcastStrategy:i}){let a=e.userData,u=e.metaData,c=Kr({color:!0,lineOpacity:!0,lineWidth:!0,resolution:!0,fillOpacity:!0},{node:e,concrete:s,policy:n,graphInfo:t,styleBroadcastStrategy:i},(l,m)=>{var y;let d=l.getDependencies();if(d.length===0&&!Ia(l.valueType)){let{points:g,droppedIndices:f}=bp([l.asValue()]);return[{segments:[g],graphMode:3,droppedIndices:f,color:Li(a,u),style:a.lineStyle,showPoint:!1,poi:Po(g)}]}else{let g=l.getCompiledFunction(d);m.domain=(y=g.domain)!=null?y:{type:\"1d\",min:e.metaData.evaluatedDomainMin,max:e.metaData.evaluatedDomainMax};let f=pa({viewState:o,graphInfo:m,compiled:g}),h=Sx(n,f,o,m.lineWidth);if(r.lines&&!r.fill)return[h];let x={segments:h.segments,color:m.color,fillOpacity:m.fillOpacity,listIndex:m.listIndex,graphMode:7,poi:{}};return r.lines?[h,x]:[x]}}),p=[];for(let l of c)l&&p.push(l);return p}function _y(e,t){let n={};for(let r in t)t.hasOwnProperty(r)&&(_s(e[r],t[r])||(n[r]=t[r]));return n}function wy(e,t){let n,r={};for(let s in t)t.hasOwnProperty(s)&&(_s(e[s],t[s])||(r[s]=t[s],n=r));return n}function Wae(e,t){t||(t={});let n={};for(let r in e)e.hasOwnProperty(r)&&!t.hasOwnProperty(r)&&(n[r]=qo(e[r]));for(let r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}var Kw={DEFAULT:\"DEFAULT\",NONE:\"NONE\",POSITIVE:\"POSITIVE\",BOTH:\"BOTH\"},jae={NONE:\"NONE\",POSITIVE:\"POSITIVE\",BOTH:\"BOTH\"};var eL={DEFAULT:\"default\",CENTER:\"center\",CENTER_AUTO:\"center_auto\",AUTO_CENTER:\"auto_center\",ABOVE:\"above\",ABOVE_LEFT:\"above_left\",ABOVE_RIGHT:\"above_right\",ABOVE_AUTO:\"above_auto\",BELOW:\"below\",BELOW_LEFT:\"below_left\",BELOW_RIGHT:\"below_right\",BELOW_AUTO:\"below_auto\",LEFT:\"left\",AUTO_LEFT:\"auto_left\",RIGHT:\"right\",AUTO_RIGHT:\"auto_right\"};var ml={LOOP_FORWARD_REVERSE:\"LOOP_FORWARD_REVERSE\",LOOP_FORWARD:\"LOOP_FORWARD\",PLAY_ONCE:\"PLAY_ONCE\",PLAY_INDEFINITELY:\"PLAY_INDEFINITELY\"};function Kae(e){switch(e){case ml.LOOP_FORWARD:return\"dcg-icon-arrow-one-way\";case ml.LOOP_FORWARD_REVERSE:return\"dcg-icon-arrow-two-way\";case ml.PLAY_ONCE:return\"dcg-icon-arrow-once\";case ml.PLAY_INDEFINITELY:return\"dcg-icon-arrow-infinite\"}}function nue({from:e,to:t,props:n}){for(let r in n)n[r]&&e.hasOwnProperty(r)&&(t[r]=qo(e[r]))}function rue(e,t){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}function tL(e,t){let n={};for(let r in t)t.hasOwnProperty(r)&&(n[r]=e[r]);return n}function sue(e){let t={};for(let n in e)e.hasOwnProperty(n)&&(t[n]=!0);return t}var Lv=mr;function uue(e){switch(e){case void 0:case\"IDLE\":case\"UNPUBLISHED\":case\"RESOLVED\":return!1;case\"ANALYZING\":case\"GRAPHING\":return!0;default:throw new Error(`Unexpected progress status: ${e}`)}}function cue(e){return{allDefinedQualifiedNames:e.allDefinedQualifiedNames,multiplyDefined:new Ts(e.multiplyDefined)}}var rL={collapsed:!1,hidden:!1,secret:!1,inFrontOfEverything:!1,readonly:!1,title:\"\"};function mue(e){return{...rL,...e}}function due(e){return _y(rL,e)}var sL=\"**dcg_geo_folder**\";function fue(e){return{type:\"module\",id:e.id,imports:l5(e.title,e.id)}}function l5(e,t){if(!e.includes(\"@\"))return[];let n=[];for(let[r,s]of nL(e,\"@import \"))n.push({from:{frameID:Lv,symbol:r},to:{frameID:t,symbol:s}});for(let[r,s]of nL(e,\"@export \"))n.push({from:{frameID:t,symbol:r},to:{frameID:Lv,symbol:s}});return n}function nL(e,t){let n=e.split(`\n`),r=[];for(let s of n){if(!s.startsWith(t))continue;let o=s.slice(t.length);for(let i of o.split(\",\")){let a=\" as \",u=i.indexOf(a);if(u!==-1){r.push([i.slice(0,u).trim(),i.slice(u+a.length).trim()]);continue}let c=i.trim();c!==\"\"&&r.push([c,c])}}return r}var Fv={show:!1,min:\"\",max:\"\",p:\"\",tails:\"inner\",compute:\"p\"},Vv={breadth:\"\",axisOffset:\"\",alignedAxis:\"x\",showBoxplotOutliers:!0,binAlignment:\"center\",dotplotXMode:\"exact\",histogramMode:\"\"},Bv={enabled:!1,latex:\"\"},zx={None:\"NONE\",Math:\"MATH\",Text:\"TEXT\"},p5={type:!0,id:!0,folderId:!0,color:!0,latex:!0,showLabel:!0,showAngleLabel:!0,label:!0,hidden:!0,secret:!0,readonly:!0,disableGraphInteractions:!0,fill:!0,points:!0,lines:!0,extendTo3D:!0,lineStyle:!0,arrowMode:!0,pointStyle:!0,dragMode:!0,labelOrientation:!0,labelSize:!0,suppressTextOutline:!0,pointOutline:!0,interactiveLabel:!0,editableLabelMode:!0,residualVariable:!0,regressionParameters:!0,isLogModeRegression:!0,displayEvaluationAsFraction:!0,slider:!0,strictIntersection:!0,inference:!0},Sue=Object.keys(p5),oL=4e3,Ux={polarDomain:{min:\"\",max:\"\"},parametricDomain:{min:\"\",max:\"\"},parametricDomain3Du:{min:\"\",max:\"\"},parametricDomain3Dv:{min:\"\",max:\"\"},parametricDomain3Dr:{min:\"\",max:\"\"},parametricDomain3Dphi:{min:\"\",max:\"\"},cdf:Fv,colorLatex:\"\",description:\"\",fillOpacity:\"\",surfaceOpacity:\"\",lineOpacity:\"\",pointOpacity:\"\",pointSize:\"\",movablePointSize:\"\",lineWidth:\"\",resolution:\"\",labelAngle:\"\",vizProps:Vv,clickableInfo:Bv},Gv={significance:{show:!1},confidence:{show:!1}},iL={folderId:\"\",latex:\"\",color:\"\",showLabel:!1,showAngleLabel:!0,label:\"\",hidden:!1,secret:!1,readonly:!1,disableGraphInteractions:!1,dragMode:on.AUTO,labelSize:\"\",labelOrientation:eL.DEFAULT,suppressTextOutline:!1,pointOutline:!1,interactiveLabel:!1,editableLabelMode:zx.None,residualVariable:\"\",isLogModeRegression:!1,pointStyle:cl.POINT,lineStyle:gd.SOLID,arrowMode:Kw.DEFAULT,regressionParameters:{},displayEvaluationAsFraction:!1,slider:{},strictIntersection:!1,extendTo3D:!1,inference:Gv,...Ux,points:void 0,lines:void 0,fill:void 0},aL={hardMin:!1,hardMax:!1,animationPeriod:oL,loopMode:ml.LOOP_FORWARD_REVERSE,playDirection:1,isPlaying:!1,min:\"-10\",max:\"10\",step:\"\"},uL={hardMin:!1,hardMax:!1,animationPeriod:oL,loopMode:ml.LOOP_FORWARD_REVERSE,playDirection:1,isPlaying:!1,min:`${Fr.xmin}`,max:`${Fr.xmax}`,step:\"\"};function Mue(e,t){return{...iL,isLogModeRegression:t.defaultLogModeRegressions,...e,slider:{...t.is3d?uL:aL,...e.slider},cdf:{...Fv,...e.cdf},vizProps:{...Vv,...e.vizProps},clickableInfo:{...Bv,...e.clickableInfo},inference:{...Gv,...e.inference}}}function Cue(e,t){let n=_y(iL,{...e,slider:_y(t.is3d?uL:aL,e.slider)}),r=wy(Fv,e.cdf);r===void 0?delete n.cdf:n.cdf=r;let s=wy(Vv,e.vizProps);s===void 0?delete n.vizProps:n.vizProps=s;let o=wy(Bv,e.clickableInfo);o===void 0?delete n.clickableInfo:n.clickableInfo=o;let i=wy(Gv,e.inference);return i===void 0?delete n.inference:n.inference=i,n}function m5(e){return tL(e,Ux)}function vue(e,t){for(let n in Ux)if(Ux.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0}function Due(e){return{type:\"statement\",id:e.id,latex:e.latex,label:e.label,color:e.color,fill:e.fill,points:e.points,lines:e.lines,extendTo3D:e.extendTo3D,pointStyle:e.pointStyle,lineStyle:e.lineStyle,arrowMode:e.arrowMode,dragMode:e.dragMode,labelSize:e.labelSize,labelOrientation:e.labelOrientation,suppressTextOutline:e.suppressTextOutline,pointOutline:e.pointOutline,interactiveLabel:e.interactiveLabel,editableLabelMode:e.editableLabelMode,residualVariable:e.residualVariable,regressionParameters:e.regressionParameters,isLogModeRegression:e.isLogModeRegression,showLabel:e.showLabel,showAngleLabel:e.showAngleLabel,shouldGraph:!e.hidden,slider:d5(e.slider),strictIntersection:e.strictIntersection,isInConstructionsFolder:e.folderId===sL,...m5(e)}}function d5(e){return{min:e.hardMin?e.min:\"\",max:e.hardMax?e.max:\"\",softMin:e.hardMin?\"\":e.min,softMax:e.hardMax?\"\":e.max,step:e.step,isPlayingOnce:e.isPlaying&&e.loopMode===ml.PLAY_ONCE}}function Hv(e){let t=e.editableLabelMode;return t===zx.Text||t===zx.Math}function cL(e,{node:t,reconciledProps:n,concrete:r}){let{points:s,droppedIndices:o}=bp([r.asValue()]),i=t.userData.shouldGraph&&n.points,a=t.userData.showLabel&&!i;if(i)return[{segments:[s],graphMode:e,droppedIndices:o,color:Li(t.userData,t.metaData),style:t.userData.pointStyle,showLabel:!!t.userData.showLabel,labelSize:t.metaData.computedLabelSize,labelAngle:t.metaData.computedLabelAngle,labelOrientation:t.userData.labelOrientation,pointOpacity:t.metaData.computedPointOpacity,pointSize:t.metaData.computedMovablePointSize,suppressTextOutline:t.userData.suppressTextOutline,pointOutline:t.userData.pointOutline,editableLabel:Hv(t.userData),labels:t.computedLabels||[],poi:Po(s),movablePointInfo:[]}];if(a){let u;switch(e){case 4:u=3;break;case 26:u=25;break;default:let c=e;throw new Error(`Unexpected graphMode: ${c}`)}return[{segments:[s],graphMode:u,color:Li(t.userData,t.metaData),style:t.userData.pointStyle,showLabel:!!t.userData.showLabel,nakedLabel:!0,labelSize:t.metaData.computedLabelSize,labelAngle:t.metaData.computedLabelAngle,labelOrientation:t.userData.labelOrientation,pointOpacity:t.metaData.computedPointOpacity,suppressTextOutline:t.userData.suppressTextOutline,pointOutline:t.userData.pointOutline,editableLabel:Hv(t.userData),labels:t.computedLabels||[],poi:Po(s),showPoint:!1}]}else return[]}function lL(e,{node:t,policy:n,styleBroadcastStrategy:r,viewState:s,reconciledProps:o,concrete:i}){let a=[],u=t.userData.shouldGraph&&o.points,c=t.userData.shouldGraph&&o.lines,p=[\"colorLatexValue\"];u&&p.push(\"computedPointOpacity\",\"computedPointSize\"),(t.userData.showLabel||u)&&p.push(\"computedLabelSize\",\"computedLabelAngle\");let l=Fi(t.metaData,p,r),m=Es.wrap(i).asValue();Dr(m),m.length>l&&(m.length=l);let d=t.userData.showLabel&&!u&&!c,y=bp(m);if(t.userData.showLabel||u){let g={segments:[y.points],graphMode:e,droppedIndices:y.droppedIndices,color:t.metaData.colorLatexValue||t.userData.color,style:t.userData.pointStyle,showLabel:!!t.userData.showLabel,showPoint:u,labelSize:t.metaData.computedLabelSize,labelAngle:t.metaData.computedLabelAngle,labelOrientation:t.userData.labelOrientation,pointSize:t.metaData.computedPointSize,pointOpacity:t.metaData.computedPointOpacity,suppressTextOutline:t.userData.suppressTextOutline,pointOutline:t.userData.pointOutline,interactiveLabel:!!t.userData.interactiveLabel,editableLabel:Hv(t.userData),nakedLabel:d,labels:t.computedLabels||[],poi:Po(m)};n.is3dPolicy()?a.push(...ew(g)):a.push(g)}if(c){let g=t.metaData.computedLineWidth,f={segments:Fx(m),graphMode:5,color:Li(t.userData,t.metaData),style:t.userData.lineStyle,lineWidth:g,lineOpacity:t.metaData.computedLineOpacity,poi:{}};a.push(Sx(n,f,s,g))}return a}function pL(e,t,n,r){var a;let s=Qr(e,t,n);if(n.model.type===\"Error\")return[];let i=Vu(e,t,n.model,r,s);for(let u of i)(a=e.tableRegressionData)!=null&&a.tableId&&(u.tableId=e.tableRegressionData.tableId);return i}function Ip(e,t){return qv(e,t).freeDependencies}function qv(e,t){let n={};if(t.type===\"FunctionDefinition\"||t.type===\"RecursiveFunctionBaseCase\"){let{freeDependencies:r,updateSymbols:s}=kx(e,t._expression,n),o=r.filter(i=>i!==t._symbol);if(t instanceof Tr||t instanceof is)for(let i of t._argSymbols)o.includes(i)||o.push(i);return{freeDependencies:o,updateSymbols:s}}return kx(e,t,n)}function mL(e,t,n){let r=[],s=[],o=[];for(let i of t.scopes){let a=mL(e,i,n);for(let u of a.freeDependencies)r.indexOf(u)===-1&&t.definitions.indexOf(u)===-1&&r.push(u);for(let u of a.updateSymbols)s.indexOf(u)===-1&&s.push(u)}for(let i of t.dependencies){if(t.definitions.indexOf(i)!==-1)continue;let a=f5(e,i,n),u=t.substitutionDependencies.indexOf(i)!==-1;for(let c of a.freeDependencies)r.indexOf(c)===-1&&t.definitions.indexOf(c)===-1&&r.push(c),u&&o.indexOf(c)===-1&&t.definitions.indexOf(c)===-1&&o.push(c);for(let c of a.updateSymbols)s.indexOf(c)===-1&&s.push(c)}return{freeDependencies:r,updateSymbols:s}}function kx(e,t,n){if(t.type===\"Slider\"||t.type===\"Assignment\")return kx(e,t._expression,n);{let{freeDependencies:r,updateSymbols:s}=mL(e,t.getScope(),n),o=t.getUpdateSymbols();if(o.length>0){s=s.slice();for(let i of o)s.indexOf(i)===-1&&s.push(i)}return{freeDependencies:r,updateSymbols:s}}}function f5(e,t,n){if(n[t])return n[t];let r=y5(e,t,n);return n[t]=r,r}function y5(e,t,n){if(rt[t])return{freeDependencies:[],updateSymbols:[]};let r=e[t];return r?(n[t]={freeDependencies:[],updateSymbols:[]},kx(e,r,n)):{freeDependencies:[t],updateSymbols:[]}}function dL(e,t){let n={},r=t.getDependencies().slice();for(;r.length;){let s=r.pop();if(n.hasOwnProperty(s))continue;if(e.isLocal(s)||e.isError(s))return;let o=e.getVisibleGlobalDefinition(s);n[s]=o,o&&o.getDependencies&&Array.prototype.push.apply(r,o.getDependencies())}return Object.entries(n)}function fL(e,t,n){yL(e,t,n,{})}function yL(e,t,n,r){let s={};for(let o of n.definitions){if(s[o])switch(n.kind){case\"Integral\":case\"RepeatedOperator\":throw V(new Error(`${n.kind} scope is not expected to define multiple symbols`));case\"FunctionDefinition\":throw AE(o);case\"ListComprehension\":throw Sh(o);case\"Substitution\":throw e0(o);default:let i=n.kind;throw V(new Error(`Unexpected scope kind ${i}`))}s[o]=!0}for(let o of n.definitions){let i=t[o];if(i){if(e.assignmentForbidden(o))switch(n.kind){case\"RepeatedOperator\":throw ch(o);case\"Integral\":throw bh(o);case\"FunctionDefinition\":throw uh(o);case\"Substitution\":case\"ListComprehension\":throw Rf(o);default:let a=n.kind;throw V(new Error(`Unexpected scope kind ${a}`))}if((n.kind===\"ListComprehension\"||n.kind===\"Substitution\")&&i.type===\"FunctionDefinition\")throw Of(o)}if(r[o])switch(n.kind){case\"RepeatedOperator\":throw ch(o);case\"Integral\":throw bh(o);case\"FunctionDefinition\":throw uh(o);case\"ListComprehension\":throw Sh(o);case\"Substitution\":throw QS(o);default:let a=n.kind;throw V(new Error(`Unexpected scope kind ${a}`))}}r=On(r);for(let o of n.definitions)r[o]=!0;for(let o of n.scopes)yL(e,t,o,r)}function gL(e,t){let{mappedArgIndex:n,mappedReturnIndex:r,solutionIndex:s}=t,o=kc(e,n),i=g5(e,o,r),a=s,u=e.NanOfType(e.getReturnType()),c=new vs(e,0,r);return c.copyUntilEnd((p,l,m)=>{if(m===n)return s;if(!o[m]&&!p.isInClosedBlock(m))return m;if(ce(l)){let d=c.mapArgs(l.args);return l.type===33&&i[m]&&(a=p.Piecewise([d[0],a,u])),p.copyInstructionWithArgs(l,d)}else return c.copyLeafOrFunctionHeader(l)}),a}function g5(e,t,n){let r=[];for(let s=0;s<n;s++)r.push(!1);r[n]=t[n];for(let s=n;s>=0;s--){if(!r[s]||!t[s])continue;let o=e.getInstruction(s);if(o.type===33)r[o.args[1]]=!0;else if(ce(o))for(let i of o.args)r[i]=!0}return r}function hL(e,t){try{return h5(e,t)}catch(n){return n instanceof C?n:V(n)}}function Uv(e,t){try{let n=new Dn(t),r=Ip({},n),s=[];for(let i=0;i<r.length;i++)s.push(b);let o=Yx({policy:e,frame:{},argNames:r,argTypes:s,selection:void 0,locals:[]});return o.chunk=t,t.fuseBroadcast(),bL({policy:e,ctx:o,isInequality:!1,allowSolvingIn3D:!0},t)}catch(n){return n instanceof C?n:V(n)}}function $x(e,t){let n=e.getInstruction(t);if(n.type!==1)return!1;switch(n.valueType){case O:return Number.isNaN(n.value[0]);case b:return Number.isNaN(n.value);case He:return n.value.length>0&&n.value.every(r=>Number.isNaN(r[0]));case Y:return n.value.length>0&&n.value.every(r=>Number.isNaN(r));case nn:return!n.value;case eu:return n.value.length>0&&n.value.every(r=>!r);case ve:case Te:return Number.isNaN(n.value[2]);case Er:case Sr:return n.value.length>0&&n.value.every(r=>Number.isNaN(r[2]));default:throw V(\"Unexpected type in isConstantNaN: \"+We(n.valueType))}}function h5({policy:e,frame:t},n){let r=!1,s=[];if(n instanceof $c){let x=n._lhs,T=x._symbol;if(!t[T]&&!e.assignmentForbidden(T)&&(r=!0,s=x._dependencies,x.args.length>1)){let M=n._dependencies.filter(E=>!s.includes(E)),S=mn([T]).setDependencies(M);throw S.silent=!0,S}}let o=n.asComparator(),i=Ip(t,o),a=[];for(let x=0;x<i.length;x++)a.push(b);let u=Yx({policy:e,frame:t,argNames:i,argTypes:a,selection:void 0,locals:[]}),{chunk:c}=u,p=o.getOperator(),l=p!==\"=\",m=Me(u,o.args[0]),d=Fo(c,m,{peelableCoerce:!0});if(d!==m&&!$x(c,m)&&$x(c,d))throw Wp(p);let y=Me(u,o.args[1]),g=Fo(c,y,{peelableCoerce:!0});if(g!==y&&!$x(c,y)&&$x(c,g))throw Wp(p);try{za(c,e,o,[d,g])}catch(x){throw x instanceof C&&r&&(x.silent=!0),x}switch(p){case\"<\":c.Less([d,g]);break;case\">\":c.Greater([d,g]);break;case\"<=\":c.LessEqual([d,g]);break;case\">=\":c.GreaterEqual([d,g]);break;case\"=\":c.Equal([d,g]);break}if(c.fuseBroadcast(),c.isConstant())return new Dn(c);let h=c.getInstruction(d).type!==2||Ip(t,o.args[1]).indexOf(c.argNames[d])!==-1;if(!ni.plotImplicits&&h)throw oS();return Yr[p].direction===-1?c.Subtract([g,d]):c.Subtract([d,g]),c.fuseBroadcast(),bL({policy:e,ctx:u,isInequality:l,allowSolvingIn3D:!1,maybeBaseCase:r,callParameters:s},c)}function bL({policy:e,ctx:t,isInequality:n,allowSolvingIn3D:r,maybeBaseCase:s,callParameters:o},i){let a=i.getLiveArgNames();if(a.length===0)throw V(`Unexpected: non-constant node with dependencies: ${a}`);if(a.length===1&&!n&&!ni.plotSingleVariableImplicitEquations)return sS();let u=g=>g===\"x\"||g===\"y\"||g===\"z\";if(e.is3dPolicy()?!a.every(u):a.length>2){let g=e.sliderVariables(a);if(s){let f=o?a.filter(x=>!o.includes(x)):a,h=mn(g).setDependencies(f);return h.silent=!0,h}else return mn(g).setDependencies(a)}if(n&&!e.validInequalityVariables(a))return nS().setDependencies(a);let{localFrames:c,effectiveOrder:p,variableOfInterest:l}=b5(t,n);if(e.complicatedPolarImplicit(l,p))return iS().setDependencies(a);if(!e.validImplicitVariables(a)){let g=ql();return s&&(g.silent=!0),g}if(e.is3dPolicy()&&r&&p!==1)return gu();if(p>2||e.is3dPolicy()&&!r)return new Dn(i);let m=[],d=[],y=1;for(let g=0;g<c.length;g++){let f=c[g],h=x5(f,n);y=h.length;for(let T of h){let P=f.chunk.copy();if(P.setReturnIndex(T),f.isRestrictedPolynomial){let{mappedArgIndex:M,mappedReturnIndex:S}=f;P.setReturnIndex(gL(P,{mappedArgIndex:M,mappedReturnIndex:S,solutionIndex:P.getReturnIndex()}))}P.fuseBroadcast(),m.push(new Dn(P))}let x=!1;for(let T of f.coefficients){let P=f.chunk.getInstruction(T);P.type===1&&P.value!==0&&(x=!0)}if(i.argNames.length!==2||x)d.push(void 0);else{let T=f.chunk.copy(),P=f.coefficients.slice();T.List(P);let M=$(i.getReturnType())?i.elementAt(g):i.copy(),E=M.argNames.indexOf(l)===0?1:0,v=M.getReturnIndex();M.Add([E,M.Multiply([M.Constant(0),v])]),d.push({coefficients:T,restriction:M})}}return new A.SolvedEquation(l,new Es(m),d,y)}function b5(e,t){let n=e.chunk,r=e.policy,s=n.argNames,o=$(n.getReturnType()),i=[];e:for(let a=0;a<s.length;a++){let u=s[a],c=s.length>1&&!r.validSolvedVariable(u);i[a]={localFrames:[],effectiveOrder:0,variableOfInterest:u};let p=!t;if(c){i[a].effectiveOrder=1/0;continue}let l=o?n.getConstantListLength():1;if(l==null)throw new Error(\"Programming error: cannot solve a variable-length list expression\");for(let m=0;m<l;m++){let d=o?n.elementAt(m):n;if(d.polynomialOrder(u,{allowRestriction:p,allowClosedBlockReferences:!1})>2){i[a].effectiveOrder=1/0;continue e}let g=d.getPolynomialCoefficients(u);i[a].localFrames.push(g),i[a].effectiveOrder=Math.max(i[a].effectiveOrder,g.coefficients.length-1)}}if(s.length===1)return i[0];if(s.length===2&&!s.includes(\"z\"))return s[0]===\"y\"&&(i=[i[1],i[0]]),i[0].effectiveOrder===0?i[1]:i[1].effectiveOrder===0?i[0]:i[i[0].effectiveOrder<i[1].effectiveOrder?0:1];{let a=i.filter(c=>c.effectiveOrder===1);if(a.length>0)return a[0];let u=i.filter(c=>c.effectiveOrder===2);return u.length>0?u[0]:i[0]}}function x5(e,t){return t?I5(e):T5(e)}function T5({chunk:e,coefficients:t}){let[n,r,s]=t,o=e.Constant(be(0,1)),i=e.Constant(NaN);if(s===void 0){r===void 0&&(r=o);let a=e.Negative([e.Divide([n,r])]),u=e.Equal([r,o]);return[e.Piecewise([u,i,a])]}else{let a=e.Constant(be(2,1)),u=e.Multiply([a,s]),c=e.Negative([e.Divide([r,u])]),p=e.Divide([n,s]),l=e.Subtract([e.Square([c]),p]),m=e.Equal([s,o]),d=e.Equal([l,o]),y=e.getInstruction(l);if(y.type===1&&w(y.value)===0)return[e.Piecewise([m,i,c])];{let g=e.NativeFunction(\"sqrt\",[l]),f=e.Greater([r,o]),h=e.Less([r,o]),x=e.Greater([c,o]),T=e.Piecewise([x,e.Add([c,g]),e.Subtract([c,g])]),P=e.Piecewise([d,T,e.Divide([p,T])]),M=e.Negative([e.Divide([n,r])]);return[e.Piecewise([m,e.Piecewise([h,M,i]),T]),e.Piecewise([m,e.Piecewise([f,M,i]),P])]}}}function I5({chunk:e,coefficients:t}){let[n,r,s]=t,o=e.Constant(be(0,1));s===void 0&&(s=o),r===void 0&&(r=o),n===void 0&&(n=o);let i=e.Constant(be(2,1)),a=e.Constant(NaN),u=e.Constant(be(1e305,1)),c=e.Negative([u]),p=e.Multiply([i,s]),l=e.Negative([e.Divide([r,p])]),m=e.Divide([n,s]),d=e.Subtract([e.Square([l]),m]),y=e.NativeFunction(\"sqrt\",[d]),g=e.Negative([e.Divide([n,r])]),f=e.Equal([s,o]),h=e.Equal([d,o]),x=e.Greater([s,o]),T=e.Equal([r,o]),P=e.Greater([r,o]),M=e.Less([r,o]),S=e.Greater([l,o]),E=e.Greater([n,o]),v=e.Less([d,o]),D=e.Piecewise([S,e.Add([l,y]),e.Subtract([l,y])]),G=e.Piecewise([h,D,e.Divide([m,D])]),j=e.Piecewise([S,G,D]),Q=e.Piecewise([S,D,G]);return[e.Piecewise([f,e.Piecewise([M,g,a]),e.Piecewise([x,j,a])]),e.Piecewise([f,e.Piecewise([T,e.Piecewise([E,c,a]),a]),e.Piecewise([x,e.Piecewise([v,c,a]),j])]),e.Piecewise([f,e.Piecewise([T,e.Piecewise([E,u,a]),a]),e.Piecewise([x,e.Piecewise([v,u,a]),Q])]),e.Piecewise([f,e.Piecewise([P,g,a]),e.Piecewise([x,Q,a])])]}function xL(e,{viewState:t,node:n,concrete:r,graphInfo:s,policy:o,styleBroadcastStrategy:i}){return Kr({color:!0,lineWidth:!0,lineOpacity:!0,resolution:!0},{node:n,concrete:r,policy:o,graphInfo:s,styleBroadcastStrategy:i},(a,u)=>{var E;let c=(E=Go[e])!=null?E:[],p=a.getCompiledFunction(c).domain;switch(e){case 206:case 211:u.domain={type:\"1d\",min:n.metaData.evaluatedDomainMin,max:n.metaData.evaluatedDomainMax,isExplicit:n.metaData.isExplicitDomain};break;case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:u.domain=p!=null?p:{type:\"2d\",uMin:n.metaData.evaluatedDomain3DMin1,uMax:n.metaData.evaluatedDomain3DMax1,vMin:n.metaData.evaluatedDomain3DMin2,vMax:n.metaData.evaluatedDomain3DMax2};break}let l={allowSlices:!0},m=uc(a._chunk,c,l),{valueChunk:d,slices:y}=m.getValueAndRestrictionChunk(),g=d.getInstruction(d.getReturnIndex()).valueType,f=Ia(g)?_b(d):d.getCompiledFunction(c),h=y[0],x=h.type===\"implicit\",T=x?NaN:h.value,P=x?\"_implicit\":h.variable,M,S=v=>pa({viewState:t,graphInfo:{...u,slice_coordinate:P,slice_value:T,slice_function:v},compiled:f});if(x){let v=[\"x\",\"y\",\"z\"],D=[\"x\",\"y\",\"z\",\"r\",\"theta\"],G=[\"x\",\"y\",\"z\",\"rho\",\"theta\",\"phi\"],j=[\"x\",\"y\",\"z\",\"u\",\"v\"],Q=h.sliceChunk;switch(e){case 200:case 201:case 202:M=Q.getCompiledFunction(v);break;case 211:case 213:M=Q.getCompiledFunction(D);break;case 212:M=Q.getCompiledFunction(G);break;case 215:case 214:M=Q.getCompiledFunction(j);break;case 209:{let W=(re,ie)=>{let It=ie.getCompiledFunction(v),Bt=re._symbol,xe=re._expression.args,ee=[];for(let U of xe){if(!(U instanceof Dn))throw V(\"Programming Error: bad type\");if(Bt===\"x\")f=U._chunk.getCompiledFunction([\"y\",\"z\"]),u.graphMode=201;else if(Bt===\"y\")f=U._chunk.getCompiledFunction([\"x\",\"z\"]),u.graphMode=202;else if(Bt===\"z\")f=U._chunk.getCompiledFunction([\"x\",\"y\"]),u.graphMode=200;else throw V(\"Programming Error: bad lhs\");ee.push(S(It))}return ee},K=(re,ie)=>{let It=t.viewport,Bt=ie.getCompiledFunction(v),xe=re.getCompiledFunction(v).fn,ee=vv(xe,It);if(ee){let{explicitPlane:U,u:te,v:Ce}=ee;return u.graphMode=214,f={args:[\"u\",\"v\"],source:\"\",constants:[],fn:U,executionMetadata:{}},u.domain={type:\"2d\",uMin:te.min,uMax:te.max,vMin:Ce.min,vMax:Ce.max},[S(Bt)]}else return[]};if(Q.isImplicitPlane())return K(Q,d);if(d.isImplicitPlane())return K(d,Q);let J=Uv(o,d);return J.type===\"SolvedEquation\"?W(J,Q):(J=Uv(o,Q),J.type===\"SolvedEquation\"?W(J,d):[S(Q.getCompiledFunction(v))])}}}return[S(M)]})}function TL({viewState:e,node:t,concrete:n,graphInfo:r,policy:s,styleBroadcastStrategy:o}){return Kr({color:!0,surfaceOpacity:!0,resolution:!0},{node:t,concrete:n,policy:s,graphInfo:r,styleBroadcastStrategy:o},(i,a)=>{var M,S,E,v,D,G,j,Q;let u=(M=Go[r.graphMode])!=null?M:[],c={allowSlices:!0},p=uc(i._chunk,u,c),{restrictionChunk:l,slices:m}=p.getSlicesAndRestrictionChunk(),d=l.getCompiledFunction(u);if(m[0].type===\"implicit\"){let W=m[0].sliceChunk,K;try{K=W.copy().gradient([\"x\",\"y\",\"z\"]).getCompiledFunction([\"x\",\"y\",\"z\"]).fn}catch(It){}let J=(S=a.resolution)!=null?S:NaN;return isNaN(J)&&(J=Ey),J=tr(J,0,100),[{meshData:gv(W.getCompiledFunction(u),void 0,K,e.viewport,J,{isInequality:!1}),color:a.color,surfaceOpacity:(E=a.surfaceOpacity)!=null?E:1,uvArgs:(v=Go[a.graphMode])!=null?v:[],extraMeshArgs:(D=ul[a.graphMode])!=null?D:[],graphMode:210,compiled:d,restrictionShader:Qo(l,Ho)}]}let y=m[0].value,g=m[0].variable,f=e.viewport,h;switch(g){case\"x\":h=(W,K,J)=>W-y;break;case\"y\":h=(W,K,J)=>K-y;break;case\"z\":h=(W,K,J)=>J-y;break;default:return[]}let x=Ny(h,f);return[{meshData:li(x),color:a.color,surfaceOpacity:(G=a.surfaceOpacity)!=null?G:1,uvArgs:(j=Go[a.graphMode])!=null?j:[],extraMeshArgs:(Q=ul[a.graphMode])!=null?Q:[],graphMode:210,compiled:d,restrictionShader:Qo(l,Ho)}]})}function P5(e){return Array.prototype.concat.apply([],e)}function IL(e){let t=[];for(let n of e)typeof n==\"number\"?t.push(n):t.push(sM(n));return t}function PL(e,t){let n={},r=t.columns[0];if(r.type===\"Error\")return n;let s=IL(r.asValueMixed());for(let o=1;o<e.columns.length;o++){let i=t.columns[o];if(i.type===\"Error\")continue;let a=IL(i.asValueMixed()),u=e.columns[o].header.userData,c=e.columns[o].header.metaData;if(u.hidden)continue;let p=Fi(c,[\"colorLatexValue\",\"computedPointSize\",\"computedPointOpacity\"]),l=u.dragMode,m=l===on.X||l===on.XY,d=l===on.Y||l===on.XY,y=!!u.points,g=!!u.lines,f=[],h=[],x=[],T=[],P=[],M=[],S=1/0,E=-1/0,v=1/0,D=-1/0,G={};for(let W=0;W<s.length;W++){let K=s[W],J=a[W];if(!isFinite(K)||!isFinite(J)){G[W]=!0,g&&(M.length>1&&P.push(M),M=[]);continue}if(y){if(W>=p)continue;let re=m&&e.isValueDraggable(t,0,W),ie=d&&e.isValueDraggable(t,o,W);re||ie?(x.push([K,J]),T.push({index:W,dragX:re,dragY:ie})):h.push([K,J])}g&&M.push([K,J]),K<S&&(S=K),K>E&&(E=K),J<v&&(v=J),J>D&&(D=J)}let j=e.columns[o],Q={type:\"table\",symbol:\"header\"in j?j.header._symbol:void 0,xmin:S,xmax:E,ymin:v,ymax:D};x.length&&f.push({graphMode:4,segments:[x],color:c.colorLatexValue||u.color,tableId:u.tableId,poi:Po(x),movablePointInfo:T,boundingBox:Q,pointOpacity:c.computedPointOpacity,pointSize:c.computedMovablePointSize,pointOutline:u.pointOutline,style:u.pointStyle}),h.length&&f.push({segments:[h],droppedIndices:G,graphMode:3,showPoint:!0,poi:Po(h),color:c.colorLatexValue||u.color,pointSize:c.computedPointSize,pointOutline:u.pointOutline,pointOpacity:c.computedPointOpacity,style:u.pointStyle,tableId:u.tableId,boundingBox:Q}),(P.length||M.length)&&(P.push(M),f.push({segments:P.map(P5),graphMode:5,poi:{},color:Li(u,c),style:u.lineStyle,lineWidth:Array.isArray(c.computedLineWidth)?c.computedLineWidth[0]:c.computedLineWidth,lineOpacity:Array.isArray(c.computedLineOpacity)?c.computedLineOpacity[0]:c.computedLineOpacity,tableId:u.tableId,boundingBox:Q})),f.length&&(n[u.id]=f)}return n}function Mce(e){return 2*E5(e*.5)}function E5(e){return e<=8?3*e:e>=16?2*e:e+16}function kv(e,t){let n=1/0,r=-1/0,s=1/0,o=-1/0;for(let i of t)for(let a=0;a<i.length;a+=2){let u=i[a],c=i[a+1];u<n&&(n=u),u>r&&(r=u),c<s&&(s=c),c>o&&(o=c)}if(isFinite(n)&&isFinite(s))return{type:e,xmin:n,ymin:s,xmax:r,ymax:o}}function ML(e,t,n){let r={};n-=.5*t;for(let s=e.length-1;s>=0;s--){let o=e[s],i=Math.floor((o-n)/t);r[i]?r[i].data.push(o):r[i]={id:i,data:[o],min:i*t+n,max:i*t+n+t,center:i*t+n+t/2}}return r}function CL(e,t,n){let r=Qr(e,t,n),s=n.args[0].asValue(),o=n.args[1].asValue(),i=e.userData.vizProps&&e.userData.vizProps.binAlignment===\"left\"?o/2:0;Dr(s);let a=ML(s,o,i),u=1;e.userData.vizProps&&e.userData.vizProps.histogramMode===\"density\"?u=1/(s.length*o):e.userData.vizProps&&e.userData.vizProps.histogramMode===\"relative\"&&(u=1/s.length);let c=[],p=[];for(let m in a){let d=a[m],y=d.data.length;p.push([d.min,0*u,d.min,y*u,d.max,y*u,d.max,0*u]);let g=0;a[d.id+1]&&(g=a[d.id+1].data.length);let f=[d.min,0*u,d.min,y*u,d.max,y*u];g<y&&f.push(d.max,g*u),c.push(f)}let l=kv(\"histogram\",p);return l&&o&&(l.binWidth=o),[{segments:p,graphMode:7,boundingBox:l,poi:{},color:r.color,fillOpacity:.4},{segments:c,graphMode:2,poi:{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}},color:r.color}]}function vL(e,t,n){let r=Qr(e,t,n),s=n.args[1].asValue(),o=e.userData.vizProps&&e.userData.vizProps.binAlignment===\"left\"?s/2:0,i=n.args[0].asValue();Dr(i);let a=ML(i,s,o),u=!1,c,p=[];for(let f in a){let h=a[f];for(let x=h.data.length-1;x>=0;x--)h.center!==h.data[x]&&(u=!0)}if(e.userData.vizProps&&e.userData.vizProps.dotplotXMode===\"exact\")for(let f in a){c=a[f].data,c.reverse();for(let x=0;x<c.length;x++)p.push([c[x],x+1])}else for(let f in a){let h=a[f];c=h.data;for(let x=0;x<c.length;x++)p.push([h.center,x+1])}let l=kv(\"dotplot\",p);l&&s&&(l.ymin=0,l.xmin-=.5*s,l.xmax+=.5*s,l.binWidth=s);let{computedPointOpacity:m,computedPointSize:d}=e.metaData,y=ma(m,0),g=e.userData.pointSize?ma(d,0):14;return[{segments:[p],graphMode:3,boundingBox:l,poi:Po(p),color:r.color,style:e.userData.pointStyle,pointSize:g,pointOpacity:y,showPoint:!0,needsDotplotXMode:u}]}function DL(e,t,n){let r=Qr(e,t,n),s=e.metaData.evaluatedAxisOffset,o=e.metaData.evaluatedBreadth,i=n.args[0].asValue();if(Dr(i),isNaN(o)||isNaN(s))return[];let a=Math.min.apply(null,i),u=Math.max.apply(null,i),c=Zl(i,1),p=Zl(i,2),l=Zl(i,3),m=s,d=m-o/2,y=m+o/2,g=o/10,f=[];if(e.userData.vizProps.showBoxplotOutliers){let T=l-c,P=c-1.5*T,M=l+1.5*T;a=1/0,u=-1/0,i.forEach(S=>{P<=S&&S<a&&(a=S),u<S&&S<=M&&(u=S),(S<P||S>M)&&f.push([S,m])})}let h=[[c,d,l,d,l,y,c,y,c,d],[p,d,p,y],[c,m,a,m],[l,m,u,m],[a,m-g,a,m+g],[u,m-g,u,m+g]];if(e.userData.vizProps&&e.userData.vizProps.alignedAxis===\"y\"){for(let T of h)for(let P=0;P<T.length;P+=2){let M=T[P];T[P]=T[P+1],T[P+1]=M}for(let T of f){let P=T[0];T[0]=T[1],T[1]=P}}let x=[{segments:h,graphMode:5,boundingBox:kv(\"boxplot\",h.concat(f)),poi:{},color:r.color}];return f.length&&x.push({segments:[f],graphMode:3,color:r.color,style:cl.OPEN,showPoint:!0,poi:Po(f)}),x}var Ho=200;function M5(e,t,n,r,s){switch(e.type){case\"Image\":return jw(e,n);case\"Table\":return PL(e,n);case\"BoxPlot\":return DL(e,t,n);case\"DotPlot\":return vL(e,t,n);case\"Histogram\":return CL(e,t,n);case\"Regression\":return pL(e,t,n,r);case\"DoubleInequality\":return Mw(e,t,n,r)}return e instanceof os?Sw(e,t,n,r):C5(e,t,n,r,s)}function Vu(e,t,n,r,s,o,i){if(n instanceof A.SolvedEquation){let l=Vu(e,t,n._expression,r,s,o,n.branchMultiplier===2?\"solvedEquation\":void 0),m=Sv(e,n,r,t);return m&&(l||(l=[]),Array.prototype.push.apply(l,m)),l}let a=n.getExpressionType(s.graphMode,n.valueType),u=NC(a,{points:e.userData.points,lines:e.userData.lines,fill:e.userData.fill}),c={node:e,concrete:n,reconciledProps:u,styleBroadcastStrategy:i,viewState:r,graphInfo:s,policy:t,childIntersections:o},p=s.graphMode;switch(p){case 20:return $w(c);case 21:return Yw(c);case 17:case 18:case 19:return Zw(c);case 24:return Xw(c);case 23:return Ww(c);case 16:return kw(c);case 114:return xw(c);case 117:return Tw(c);case 119:return Iw(c);case 129:return Pw(c);case 118:return Ew(c);case 26:case 4:return cL(p,c);case 25:case 3:return lL(p,c);case 5:case 100:return Jw(c);case 1:case 2:case 8:case 112:case 126:case 113:case 127:case 6:case 130:case 103:case 106:case 107:case 108:case 109:case 110:case 111:case 120:case 121:case 122:case 123:case 124:return Uw(p,c);case 200:case 201:case 202:case 206:case 205:case 211:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:return xL(p,c);case 210:return TL(c);case 7:case 22:case 128:case 11:case 10:case 15:return[];default:let l=p;throw new Error(`Unexpected graphMode: ${l}`)}}function NL(e,t,n,r,s){var o,i,a;try{let u=M5(e,t,n,r,s);if(Array.isArray(u))for(let c of u){if(!(\"compiled\"in c))continue;let p=(o=c.compiled)==null?void 0:o.executionMetadata;p&&(p.recursionTerminationStatus&&(c.recursionTerminationStatus=p.recursionTerminationStatus),((i=p.badCoercionCount)!=null?i:0)>=1&&((a=p.goodCoercionCount)!=null?a:0)<=2&&(c.nanBlame=Dx.ComplexCoercion))}return u}catch(u){let c=u instanceof A.Error?u.getError():V(u).getError();return[lw(c)]}}function C5(e,t,n,r,s){let o=Qr(e,t,n);return Vu(e,t,n,r,o,s)}var Yv=class{constructor(t,n,r,s){this.openChunk=t;this.returnIndex=n;this.restrictionIndex=r;this.slices=s}getSliceVariablesOrImplicit(){return this.slices.map(t=>t.type===\"constant\"?t.variable:\"_implicit\")}getPeeledSlices(){let t=[];for(let n of this.slices)if(n.type===\"constant\"){let r=this.openChunk.getInstruction(n.index);if(Ue(r)&&r.valueType===b)t.push({type:\"constant\",variable:n.variable,value:w(r.value)});else if(!(Ue(r)&&r.valueType===Y))throw gu()}else if(this.openChunk.getInstruction(n.index).valueType===b){let s=this.openChunk.copy();s.setReturnIndex(n.index),s.fuseBroadcast(),t.push({type:\"implicit\",sliceChunk:s})}else throw gu();return t}getValueAndRestrictionChunk(){let t=this.getPeeledSlices(),n=this.openChunk.copy();n.setReturnIndex(this.returnIndex),n.fuseBroadcast();let r;return this.restrictionIndex!==void 0&&(r=this.openChunk.copy(),r.setReturnIndex(this.restrictionIndex),r.fuseBroadcast()),{valueChunk:n,restrictionChunk:r,slices:t}}getSlicesAndRestrictionChunk(){let t=this.getPeeledSlices(),n=this.openChunk.copy(),r=n.GreaterEqual([this.returnIndex,n.Constant(0)]);return this.restrictionIndex!==void 0&&(r=n.And([r,this.restrictionIndex])),n.setReturnIndex(r),n.fuseBroadcast(),{restrictionChunk:n,slices:t}}},Xx=class{constructor(t,n,r){this.chunk=t;this.slices=[];this.oldIPToRestriction=[];var s,o;this.produceNumbers=(s=r==null?void 0:r.produceNumbers)!=null?s:!1,this.allowSlices=(o=r==null?void 0:r.allowSlices)!=null?o:!1,this.newChunk=new Nu({argNames:t.argNames,argTypes:t.argTypes}),this.startTrue=this.produceNumbers?this.newChunk.Constant(1/0):this.newChunk.ConstantOfType(Re,!0),this.peelable=N5(t),this.dependsOnArgs=_v(t),this.copyCtx=new vs(t,0,t.instructionsLength()-1,this.newChunk),O5(t,this.peelable,n)}selectRestriction(){return!0}};function _v(e){let t=[];for(let n=0;n<e.argNames.length;n++)t.push(n);return Su(e,t,0,e.getReturnIndex())}var Zv=class extends Xx{constructor(n,r,s){super(n,r,s);this.currSelectIndex=0;this.selectIndex=s.selectIndex}selectRestriction(){let n=this.selectIndex===this.currSelectIndex;return this.currSelectIndex++,this.produceNumbers?n:!n}};function uc(e,t,n){let r=new Xx(e,t,n);Xv(r,0,e.instructionsLength()-1);let s=r.oldIPToRestriction[e.getReturnIndex()];return new Yv(r.newChunk,r.copyCtx.mapIndex(e.getReturnIndex()),r.startTrue===s?void 0:s,r.slices)}function*zw(e,t,n){var s,o;let r=$v(e,n,{produceNumbers:!1,selectIndex:0});if(r===void 0||r.count<=1){yield{value:t,restriction:void 0};return}for(let i=0;i<r.count;i++){let a=(s=$v(e,n,{produceNumbers:!0,selectIndex:i}))==null?void 0:s.chunk,u=i===0?r.chunk:(o=$v(e,n,{produceNumbers:!1,selectIndex:i}))==null?void 0:o.chunk;if(!a||!u)throw new Error(\"Programming Error: selectIndex gave invalid chunk.\");yield{value:a,restriction:u}}}function $v(e,t,n){let r=new Zv(e,t,n);Xv(r,0,e.instructionsLength()-1);let s=r.oldIPToRestriction[e.getReturnIndex()];if(r.currSelectIndex===0)return;let o=r.copyCtx.mapIndex(e.getReturnIndex()),i=r.newChunk.getInstruction(o);if(i.type!==29)throw new Error(\"Programming Error: Expected GreaterEqual.\");let a=r.produceNumbers?r.newChunk.Subtract([i.args[0],i.args[1]]):o;return r.selectRestriction()&&(s=Wx(r,[s,a])),r.newChunk.setReturnIndex(s),{chunk:r.newChunk,count:r.currSelectIndex}}function Xv(e,t,n){let{chunk:r,newChunk:s,copyCtx:o,peelable:i,oldIPToRestriction:a}=e;for(let u=t;u<=n;u++){let c=r.getInstruction(u);if(i[u]&&(c.type===19||c.type===23)){u=D5(e,u);continue}let p,l;if(c.type===2)p=u,l=e.startTrue;else if(!ce(c))p=o.copyLeafOrFunctionHeader(c),l=e.startTrue;else if(i[u]&&pl(r,c)&&e.dependsOnArgs[c.args[0]]){p=o.mapIndex(c.args[1]);let m=c.args.map(d=>a[d]);for(let d of A5(e,c))e.selectRestriction()&&m.push(d);l=Wx(e,m)}else p=s.copyInstructionWithArgs(c,o.mapArgs(c.args)),l=Wx(e,c.args.map(m=>a[m]));o.markMappedIndex(u,p),a[u]=l}}function Wx(e,t){let r=[...new Set(t)].filter(s=>!OL(e,s));return r.length?jx(e,r).reduce((s,o)=>e.produceNumbers?e.newChunk.NativeFunction(\"listMin\",[s,o]):e.newChunk.And([s,o])):e.startTrue}function v5(e,t){let n=[...new Set(t)];return n.some(r=>!OL(e,r))?jx(e,n).reduce((r,s)=>e.produceNumbers?e.newChunk.NativeFunction(\"listMax\",[r,s]):e.newChunk.Or([r,s])):e.startTrue}function jx(e,t){if(!e.produceNumbers)return t;let n=e.newChunk;return t.map(r=>{let s=n.getInstruction(r);if(s.valueType!==Re)return r;switch(s.type){case 27:case 29:return n.Subtract([s.args[0],s.args[1]]);case 26:case 28:return n.Subtract([s.args[1],s.args[0]]);case 25:throw V(\"convertBoolsToNums on an equality.\");case 32:return n.NativeFunction(\"listMin\",jx(e,s.args));case 31:return n.NativeFunction(\"listMax\",jx(e,s.args));case 1:return n.Constant(s.value?1/0:-1/0);default:throw V(\"convertBoolsToNums on a non-opcode condition.\")}})}function OL({newChunk:e},t){let n=e.getInstruction(t);return n.type===1&&(n.valueType===b&&n.value===1/0||n.valueType===Re&&n.value)}function D5(e,t){let{chunk:n,newChunk:r,copyCtx:s,oldIPToRestriction:o,startTrue:i}=e,a=n.getInstruction(t),u=a.endIndex,c=n.getInstruction(u),p,l;if(a.type===23){let f=r.copyInstructionWithArgs(a,[s.mapIndex(a.args[0])]);s.markMappedIndex(t,f),o[t]=i,l=t+1}else{let f=s.mapArgs(a.args);f.push(i);let h=r.copyInstructionWithArgs(a,f);o[t]=i,s.markMappedIndex(t,h);for(let x=2;x<a.args.length;x++){let T=t+x-1,P=r.copyInstructionWithArgs(n.getInstruction(T),[s.mapIndex(T)]);o[T]=i,s.markMappedIndex(T,P)}p=r.BlockVar(e.produceNumbers?b:Re,[s.mapIndex(t)]),l=t+a.args.length-1}Xv(e,l,u-1);let m=s.mapArgs(c.args),d=e.slices.filter(f=>l<=f.index&&f.index<u),y=p;if(a.type===19){if(p===void 0)throw new Error(\"Expected restrictionAccumVar to be defined\");y=Wx(e,[p,o[c.args[1]]]),m.push(y)}else{m.push(o[c.args[1]]);for(let f of d)m.push(f.index)}let g=r.copyInstructionWithArgs(c,m);o[u]=i,s.markMappedIndex(u,g);for(let f=1;f<c.args.length;f++){let h=r.copyInstructionWithArgs(n.getInstruction(u+f),[s.mapIndex(u)]);s.markMappedIndex(u+f,h)}if(a.type===23){let f=r.BroadcastResult(e.produceNumbers?Y:ro,[s.mapIndex(u)]);for(let h of d)h.index=r.BroadcastResult(Y,[s.mapIndex(u)]);for(let h=1;h<c.args.length;h++)o[u+h]=f}else{let f=r.BlockVar(e.produceNumbers?b:Re,[s.mapIndex(u)]);p===y&&(f=i);for(let h=1;h<c.args.length;h++)o[u+h]=f}return u+c.args.length-1}function N5(e){let t=[];for(let r=0;r<e.instructionsLength();r++)t.push(!1);t[e.getReturnIndex()]=!0;let n=e.instructionsLength()-1;for(let r=n;r>=0;r--){if(!t[r])continue;let s=e.getInstruction(r);if(ce(s))for(let o of R5(e,s))t[o]=!0}return t}function R5(e,t){switch(t.type){case 14:case 56:case 8:case 9:case 26:case 28:case 27:case 29:case 10:case 11:case 12:case 13:case 25:case 32:case 15:case 38:case 47:case 19:case 39:case 40:case 41:case 23:case 24:case 48:case 50:return t.args;case 33:return pl(e,t)?Dv(e,t).concat([t.args[1]]):[];case 37:{let r=Wn[t.symbol];return r.noPeel?[]:r.tag===\"reducer\"||r.tag===\"doubleReducer\"||r.tag===\"never-broadcast\"||r.tag===\"parameterizedReducer\"?t.args.filter(s=>e.getInstruction(s).type!==48):t.args}case 20:return t.args.slice(1);case 51:return[t.args[1]];case 31:return[];case 16:case 42:case 21:case 22:case 44:case 49:case 53:case 54:case 55:return[];default:let n=t;throw new Error(`Unexpected opcode ${n.type}`)}}function O5(e,t,n){let r=[];for(let s=0;s<e.argNames.length;s++){let o=e.argNames[s];n.indexOf(o)<0&&r.push(s)}for(let s of r){let o=kc(e,s);for(let i=0;i<e.instructionsLength();i++)t[s]&&(t[s]=!o[i])}}function A5(e,t){let n=Dv(e.chunk,t),r=e.copyCtx.mapArgs(n);if(e.allowSlices&&r.length===1){let s=Rw(e.newChunk,r[0]);if(s)return e.slices.push(s),[]}if(r.some(s=>Nw(e.newChunk,s)))throw gu();if(r.length===1){let s=r[0];return[...Bx(e.newChunk,s)]}return[v5(e,r)]}function Vx(e){let t={value:[],error:\"unhandled restriction\"},n={value:[],error:wv},r=e.getInstruction(e.getReturnIndex());if(r.type==1){if(r.valueType===Kn)return{value:Zx([r.value])};if(r.valueType===As)return{value:Zx(r.value)}}if(r.type===33&&r.valueType===Kn){let y=e.copy(),g=RL(y,r);if(g===void 0)return t;let f=e.getInstruction(g);if(f.type===1&&f.valueType===Kn){let h=Qo(y,Ho);return{value:Zx([f.value]),restriction:h}}}if(r.type!==48)return t;let s=e.getInstruction(r.args[0]);if(s.type!==24)return t;let o=e.getInstruction(s.args[1]);if(o.type!==33)return t;let i=_5(e),a=e.copy(),u=RL(a,o,i);if(u===void 0)return n;let c=e.getInstruction(u);if(c.type!==41)return t;if(i[o.args[0]])return n;let l=e.getInstruction(c.args[0]);if(l.type!==1||l.valueType!==As)return t;let m=Zx(l.value),d=Qo(a,Ho);return{value:m,restriction:d}}function _5(e){let t=[];for(let n=0;n<e.getReturnIndex();n++)e.getInstruction(n).type===23&&t.push(n);return Su(e,t,0,e.getReturnIndex()-1)}var wv=\"restriction list on triangles\";function Zx(e){return e.map(t=>{let n=t[0].map(o=>w(o)),r=t[1].map(o=>w(o)),s=t[2].map(o=>w(o));return[n,r,s]})}function RL(e,t,n){let r=t.args[0],s=t.args[1];if(!(n&&n[r])){for(;e.getInstruction(s).type===33;){if(t=e.getInstruction(s),n&&n[t.args[0]])return;r=e.And([r,t.args[0]]),s=t.args[1]}return e.setReturnIndex(r),s}}function AL(e,t){let n=[],r=[];for(let a=0;a<e.argNames.length;a++)t.hasOwnProperty(e.argNames[a])||(n.push(e.argNames[a]),r.push(e.argTypes[a]));let s=new Nu({argNames:n,argTypes:r}),o=new vs(e,0,e.instructionsLength()-1,s),i=0;return o.copyUntilEnd((a,u,c)=>{if(c<e.argNames.length){if(t.hasOwnProperty(e.argNames[c]))return a.ConstantOfType(e.argTypes[c],t[e.argNames[c]]);{let p=i;return i+=1,p}}if(ce(u)){let p=o.mapArgs(u.args);return a.copyInstructionWithArgs(u,p)}else return o.copyLeafOrFunctionHeader(u)}),s}var Jx=class e{constructor(){this.maps={real:{},complexOne:{},complexI:{}}}clone(){let t=new e;return t.maps=qo(this.maps),t}pruneIP(t){for(let n of Object.values(this.maps))delete n[t]}truncate(t){for(let n of Object.values(this.maps))for(let r in n){let s=+r;s>=t?delete n[s]:w5(n[s],t)}}getMapEntry(t,n,r){let s=this.maps[n],o=s[r];if(o)return o;let i={maxValidReference:t.instructionsLength()-1,map:[]};return s[r]=i,i}_cachedDerivativesForTests(){let t=[];for(let[n,r]of Object.entries(this.maps))for(let s in r)t.push(`${s} ${n}`);return t.sort(),t}};function w5(e,t){e.map.length=Math.min(e.map.length,t),e.maxValidReference=Math.min(e.maxValidReference,t-1)}var L5={\"+\":!0,\"-\":!0,\"*\":!0,\"\\\\cdot\":!0,\"\\\\times\":!0,\"/\":!0,\"!\":!0,\"(\":!0,\")\":!0,\"\\\\{\":!0,\"\\\\}\":!0,\"(|\":!0,\"|)\":!0,\"[\":!0,\"]\":!0,\",\":!0,\"...\":!0,\":\":!0,\"=\":!0,\">\":!0,\"<\":!0,\">=\":!0,\"<=\":!0,\"->\":!0,\"~\":!0,\"%\":!0,\".\":!0,for:!0,with:!0,Letter:!0,Decimal:!0,Cmd:!0,TokenNode:!0,Differential:!0,End:!0,Trig:!0,Ln:!0,Log:!0,Int:!0,Sum:!0,Prod:!0,Err:!0};function ple(e){let t=cc[e];if(!t)return!0;switch(t){case\"Ln\":case\"Log\":case\"for\":case\"with\":case\"Trig\":return!0;default:return!1}}var cc={\"\\\\lt\":\"<\",\"\\\\gt\":\">\",\"\\\\le\":\"<=\",\"\\\\ge\":\">=\",\"\\\\leq\":\"<=\",\"\\\\geq\":\">=\",\"\\\\ldots\":\"...\",\"\\\\sim\":\"~\",\"\\\\to\":\"->\",\"\\\\cdot\":\"\\\\cdot\",\"\\\\times\":\"\\\\times\",\"\\\\div\":\"/\",\"\\\\ln\":\"Ln\",\"\\\\log\":\"Log\",\"\\\\int\":\"Int\",\"\\\\sum\":\"Sum\",\"\\\\prod\":\"Prod\",\"\\\\backslash\":\"Err\",\"\\\\for\":\"for\",\"\\\\with\":\"with\"},F5=[\"sin\",\"cos\",\"tan\",\"cot\",\"sec\",\"csc\"];for(let e of F5)cc[\"\\\\\"+e]=\"Trig\",cc[\"\\\\\"+e+\"h\"]=\"Trig\",cc[\"\\\\arc\"+e]=\"Trig\",cc[\"\\\\arc\"+e+\"h\"]=\"Trig\",cc[\"\\\\ar\"+e+\"h\"]=\"Trig\";function mle(e){return e===\"\\\\log\"||e===\"\\\\prod\"||e===\"\\\\sum\"||e===\"\\\\int\"}var Wv={\"+\":\"+\",\"-\":\"-\",\"*\":\"*\",\"/\":\"/\",\"!\":\"!\",\"(\":\"(\",\")\":\")\",\"[\":\"[\",\"]\":\"]\",\",\":\",\",\"...\":\"...\",\":\":\":\",\"=\":\"=\",\">=\":\">=\",\"<=\":\"<=\",\">\":\">\",\"<\":\"<\",\"~\":\"~\",\".\":\".\"},_L={\"\\\\{\":\"\\\\{\",\"\\\\}\":\"\\\\}\",\"\\\\%\":\"%\"},wL={\"|\":\"(|\",\"\\\\{\":\"\\\\{\",\"[\":\"[\",\"(\":\"(\"},LL={\"|\":\"|)\",\"\\\\}\":\"\\\\}\",\"]\":\"]\",\")\":\")\"},FL=Object.keys(L5);function VL(e){return 48<=e&&e<=57}function V5(e){return 97<=e&&e<=122}function B5(e){return 65<=e&&e<=90}function Qx(e){return V5(e)||B5(e)}function Kx(e){return e===92}function jv(e){return e===39}function BL(e){if(9<=e&&e<=13||8192<=e&&e<=8202)return!0;switch(e){case 32:case 160:case 5760:case 8232:case 8233:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}var G5={mcd:\"gcd\",gcf:\"gcd\",mcm:\"lcm\",signum:\"sign\",sgn:\"sign\",stdDevP:\"stdevp\",stddevp:\"stdevp\",stdDev:\"stdev\",stddev:\"stdev\",variance:\"var\",TTest:\"ttest\",IndependentTTest:\"ittest\",iTTest:\"ittest\",TScore:\"tscore\",TConf:\"tconf\",PTTest:\"pttest\",ZTest:\"ztest\",ZScore:\"zscore\",ZConf:\"zconf\",ZPropScore:\"zpropscore\",ZPropConf:\"zpropconf\",inverseCdf:\"quantile\",inversecdf:\"quantile\",arsinh:\"arcsinh\",arcosh:\"arccosh\",artanh:\"arctanh\",arcsch:\"arccsch\",arsech:\"arcsech\",arcoth:\"arccoth\"};function GL(e){let t=0;for(;Kx(e.charCodeAt(t));)t+=1;return t>0&&(e=e.slice(t)),G5[e]||e}function HL(e,t,n){return{type:\"Comparator\",span:e,symbol:t,args:n}}function qL(e,t,n){if(t.length<1)throw\"Programming Error: ComparatorChain must have at least one comparator.\";if(n.length!==t.length+1)throw\"Programming Error: ComparatorChain must have one more arg than symbols\";return{type:\"ComparatorChain\",span:e,args:n,symbols:t}}function UL(e,t){return{type:\"Tilde\",span:e,args:t}}function zL(e,t){return{type:\"Pos\",span:e,args:t}}function kL(e,t){return{type:\"Neg\",span:e,args:t}}function $L(e,t){return{type:\"Add\",span:e,args:t}}function YL(e,t){return{type:\"Sub\",span:e,args:t}}function ZL(e,t){return{type:\"Mul\",span:e,args:t}}function XL(e,t){return{type:\"DotMul\",span:e,args:t}}function WL(e,t){return{type:\"CrossMul\",span:e,args:t}}function jL(e,t){return{type:\"Div\",span:e,args:t}}function JL(e,t){return{type:\"Bang\",span:e,args:t}}function Ly(e,t){return{type:\"Call\",span:e,args:t}}function Jv(e,t){return{type:\"ImplicitCall\",span:e,args:t}}function QL(e,t){return{type:\"Index\",span:e,args:t}}function Qv(e,t){return{type:\"Paren\",span:e,args:t}}function Kv(e,t){return{type:\"List\",span:e,args:t}}function KL(e,t){return{type:\"Pipes\",span:e,args:t}}function eD(e,t){return{type:\"Subscript\",span:e,args:t}}function eT(e,t){return{type:\"Superscript\",span:e,args:t}}function Fy(e,t,n){return{type:\"Prime\",span:e,nprimes:t,args:n}}function tT(e,t){return{type:\"Seq\",span:e,args:t}}function eF(e,t){return{type:\"Sqrt\",span:e,args:t}}function tF(e,t){return{type:\"Nthroot\",span:e,args:t}}function nF(e,t){return{type:\"Frac\",span:e,args:t}}function rF(e,t){return{type:\"Derivative\",span:e,args:t}}function sF(e,t){return{type:\"Integral\",span:e,args:t}}function oF(e,t){return{type:\"EmptyIntegral\",span:e,args:t}}function iF(e,t){return{type:\"Sum\",span:e,args:t}}function aF(e,t){return{type:\"Product\",span:e,args:t}}function uF(e,t){return{type:\"Piecewise\",span:e,args:t}}function cF(e){return{type:\"EmptyPiecewise\",span:e}}function lF(e){return{type:\"EmptyRangeEnd\",span:e}}function pF(e,t){return{type:\"Colon\",span:e,args:t}}function tD(e,t){return{type:\"Ellipsis\",span:e,args:t}}function mF(e,t){return{type:\"For\",span:e,args:t}}function dF(e,t){return{type:\"With\",span:e,args:t}}function fF(e,t){return{type:\"Dot\",span:e,args:t}}function yF(e,t){return{type:\"PercentOf\",span:e,args:t}}function gF(e,t){return{type:\"RightArrow\",span:e,args:t}}function nD(e,t){return{type:\"Juxt\",span:e,args:t}}function hF(e,t){return{type:\"Letter\",span:e,val:t}}function nT(e,t){return{type:\"Decimal\",span:e,val:t}}function Pp(e,t){return{type:\"Cmd\",span:e,val:GL(t)}}function bF(e,t){return{type:\"Alphanumeric\",span:e,val:t}}function xF(e,t,n,r){return{type:\"MixedNumber\",span:e,whole:t,num:n,den:r}}function fr(e){if(e.type===\"Subscript\"){if(e.args[1].type!==\"Alphanumeric\")return!1;e=e.args[0]}switch(e.type){case\"Cmd\":return!0;case\"Letter\":return!0;default:return!1}}function TF(e){return e.type!==\"Superscript\"?!1:fr(e.args[0])}function IF(e,t){if(e.type!==\"Letter\"||e.val!==\"d\"||t.type!==\"Juxt\")return!1;let[n,r]=t.args;return n.type!==\"Letter\"||n.val!==\"d\"?!1:fr(r)}function Ur(e){return e.type===\"Seq\"?e.args:[e]}function PF(e,t,n,r,s,o,i,a){return{opts:e,input:t,prevSpan:n,startIndex:r,endIndex:s,token:o,mode:i,parent:a}}function Ee(e,t){return po(e.token.span,t.prevSpan)}function yr(e,t){return po(e,t.prevSpan)}function sD(e){return Ca(e.token.span.input,e.token.span.start)}function q5(e,t){return{type:\"Differential\",span:e,val:t}}function eo(e,t,n){return{type:e,span:t,val:n}}function lc(e,t){let n=Ca(e.span.input,e.span.start);return oD(t,e,0,n,void 0,void 0)}function oD(e,t,n,r,s,o){let i=t.args;if(n>i.length&&o)return EF(o,r);n=Vy(i,n);let{token:a,endIndex:u}=SF(t,n,s);if(a.type===\"End\"&&o){let c=o.input.args[o.startIndex];if(c.type===\"LeftRight\"){let p=c.right,l=LL[p.val]||\"Err\",m=eo(l,p.span,p.val);return PF(e,t,r,n,u,m,s,o)}}else a.type===\"Int\"?s=U5(s):a.type===\"Differential\"&&(s=z5(s));return PF(e,t,r,n,u,a,s,o)}function ze(e){let t=e.input.args[e.startIndex],n=e.token.span;return t&&t.type===\"LeftRight\"?oD(e.opts,t.arg,0,n,e.mode,e):EF(e,n)}function EF(e,t){let{input:n,endIndex:r,mode:s,parent:o}=e;return oD(e.opts,n,r+1,t,s,o)}function hs(e){return e.token}function U5(e){return{type:\"integral\",parent:e}}function z5(e){if(!e||e.type!==\"integral\")throw new Error(\"Programming Error: expected lexer to be in integral mode.\");return e.parent}function es(e,t){return hs(e).type===t}function oT(e){return e.startIndex>=e.input.args.length}function iD(e,t){return t.token.span.start>e.token.span.start}function Ar(e,t){return{token:t,endIndex:e}}function SF(e,t,n){let r=e.args;if(t>=r.length){let o=Ca(e.span.input,e.span.end);return Ar(t,eo(\"End\",o,\"\"))}let s=e.args[t];switch(s.type){case\"Sqrt\":case\"Frac\":case\"SupSub\":return Ar(t,s);case\"Letter\":{if(!n||n.type!==\"integral\"||s.val!=\"d\")return Ar(t,s);let{endIndex:c,token:p}=SF(e,t+1,n);if(p.type===\"Letter\"||p.type===\"Cmd\"){let l=q5(po(s.span,p.span),p.val);return Ar(c,l)}else return Ar(t,s)}case\"LeftRight\":{let c=s.left,p=wL[c.val]||\"Err\",l=po(s.span,c.span);return Ar(t,eo(p,l,c.val))}case\"OperatorName\":let o=[];for(let c of s.arg.args){if(c.type!==\"Letter\")return Ar(t,eo(\"Err\",s.span,pr(s.arg.span)));o.push(c.val)}let i=\"\\\\\"+o.join(\"\"),a=cc[i]||\"Cmd\";return Ar(t,eo(a,s.span,i));case\"TokenNode\":{let c=\"$\";if(s.arg.args.length===0)return Ar(t,eo(\"Err\",s.span,pr(s.arg.span)));for(let p of s.arg.args){if(p.type!==\"Digit\")return Ar(t,eo(\"Err\",s.span,pr(s.arg.span)));c+=p.val}return Ar(t,eo(\"TokenNode\",s.span,c))}case\"Cmd\":{let c=cc[s.val]||\"Cmd\";return Ar(t,eo(c,s.span,s.val))}case\"EscapedSymbol\":{let c=_L[s.val]||\"Err\";return Ar(t,eo(c,s.span,s.val))}case\"Symbol\":return k5(e,t,s);case\"Digit\":return MF(e,t);default:throw`Unexpected atom ${s.type}.`}}function k5(e,t,n){switch(n.val){case\".\":return $5(e,t);case\"-\":{let s=e.args[t+1];if(s&&rT(s,\">\")){let o=eo(\"->\",po(n.span,s.span),\"->\");return Ar(t+1,o)}break}case\"<\":{let s=e.args[t+1];if(s&&rT(s,\"=\")){let o=eo(\"<=\",po(n.span,s.span),\"<=\");return Ar(t+1,o)}break}case\">\":{let s=e.args[t+1];if(s&&rT(s,\"=\")){let o=eo(\">=\",po(n.span,s.span),\">=\");return Ar(t+1,o)}break}}let r=Wv[n.val]||\"Err\";return Ar(t,eo(r,n.span,n.val))}function $5(e,t){let n=e.args[t];if(n.type!==\"Symbol\"||n.val!==\".\")throw new Error(\"Programming Error: expected '.'\");if(t+2<e.args.length&&sT(e.args[t+1])&&sT(e.args[t+2])){let o=po(n.span,e.args[t+2].span);return Ar(t+2,eo(\"...\",o,pr(o)))}let r=Vy(e.args,t+1);if(r<e.args.length&&e.args[r].type===\"Digit\")return MF(e,t);let s=Wv[n.val]||\"Err\";return Ar(t,eo(s,n.span,n.val))}function MF(e,t){let n=Y5(e,t);if(n)return n;let r=e.args,s=e.args[t].span,o=[],i=!1,a=!1;for(;t<r.length;t++){let c=Vy(r,t);if(c>=r.length)break;let p=r[c];if(p.type===\"Digit\")t=c,i=!0,o.push(p.val);else if(!a&&sT(p)){if(c+1<r.length&&sT(e.args[c+1]))break;t=c,a=!0,o.push(\".\")}else break}if(!i)throw new Error(\"Programming Error: decimals must have at least one digit.\");let u=po(s,e.args[t-1].span);return Ar(t-1,eo(\"Decimal\",u,o.join(\"\")))}function Y5(e,t){let n=e.args,r=n[t].span,s=[];for(;t<n.length;t++){let c=Vy(n,t);if(c>=n.length)break;let p=n[c];if(p.type!==\"Digit\")break;t=c,s.push(p.val)}if(t=Vy(n,t),t>=n.length)return;let o=n[t];if(o.type!==\"Frac\")return;let i=[],a=[];for(let c of o.num.args)if(!rD(c)){if(c.type!==\"Digit\")return;i.push(c.val)}for(let c of o.den.args)if(!rD(c)){if(c.type!==\"Digit\")return;a.push(c.val)}let u=po(r,o.span);return Ar(t,xF(u,s.join(\"\"),i.join(\"\"),a.join(\"\")))}function rD(e){switch(e.type){case\"Sqrt\":case\"Frac\":case\"SupSub\":case\"LeftRight\":case\"OperatorName\":case\"TokenNode\":case\"Symbol\":case\"Letter\":case\"Digit\":return!1;case\"Cmd\":return e.val===\"\\\\space\";case\"EscapedSymbol\":return e.val===\"\\\\ \"||e.val===\"\\\\:\"||e.val===\"\\\\,\"||e.val===\"\\\\;\";default:throw`Unexpected atom ${e.type}.`}}function Vy(e,t){for(;t<e.length&&rD(e[t]);)t+=1;return t}function sT(e){return rT(e,\".\")}function rT(e,t){return e.type===\"Symbol\"&&e.val===t}var Id={},Z5=[\"sin\",\"cos\",\"tan\",\"cot\",\"sec\",\"csc\",\"sinh\",\"cosh\",\"tanh\",\"coth\",\"sech\",\"csch\"];Z5.forEach(e=>{Id[e]=\"arc\"+e,Id[\"arc\"+e]=e});var X5=0;function AF(e,t){return W5(e,t)}function ot(e,t){let n=[];for(let r=0;r<t.length;r++)n.push(Nn(e,t[r]));return n}function CF(e,t,n){let r=e.nodes,[s,o]=ot(e,t);if(uT(n)){let i=Ca(n.span.input,n.span.end),a=e.setInput(VF(e),i);o=e.setInput(new r.SeededFunctionCall(o,[a]),n.span)}return[s,o]}function W5(e,t){return e.setInput(j5(e,t),t.span)}function _F(e){if(e.type!==\"Call\")return;let[t,n]=e.args,r=Ur(n);if(fr(t)&&r.every(fr))return{base:t,args:r}}function vle(e){return _F(e)!==void 0}function wF(e){if(e.type!==\"Call\")return!1;let[t,n]=e.args;return fr(t)}function cD(e){return fr(e)}function j5(e,t){let n=e.nodes;switch(t.type){case\"Comparator\":if(t.symbol===\"=\"){let[r,s]=t.args,o=_F(r);if(o){let{base:i,args:a}=o,u=ot(e,a),c=e;if(e.includeFunctionParametersInRandomSeed)for(let l of u)c=Hy(c,{prefix:\"fc\",expr:l});let p=Nn(c,s);return new n.FunctionDefinition(Nn(e,i),u,p)}else{if(r.type===\"Call\"&&fr(r.args[0]))return new n.CallAssignment(Nn(e,r),Nn(e,s));if(cD(r)){let i;return s.type===\"For\"?i=e.setInput(iT(e,s,{parentIsList:!1}),s.span):i=Nn(e,s),new n.Assignment(Nn(e,r),i)}}return new n.Equation(Nn(e,r),Nn(e,s))}else return Gu(e,t);case\"Tilde\":{let[r,s]=ot(e,t.args);return new n.Regression(r,s)}case\"ComparatorChain\":{if(!e.specializeDoubleInequalities||t.symbols.length!==2)return Gu(e,t);let[r,s,o]=t.args,[i,a]=t.symbols;return!fr(s)||t.symbols.includes(\"=\")?Gu(e,t):new n.DoubleInequality([Nn(e,r),i,Nn(e,s),a,Nn(e,o)])}case\"Call\":{let[r,s]=t.args;if(r.type===\"Cmd\")switch(r.val){case\"histogram\":return new n.Histogram(ot(e,Ur(s)));case\"dotplot\":return new n.DotPlot(ot(e,Ur(s)));case\"boxplot\":return new n.BoxPlot(ot(e,Ur(s)));case\"ttest\":if(e.isNewStatsEnabled)break;return new n.TTest(ot(e,Ur(s)));case\"ittest\":return new n.IndependentTTest(ot(e,Ur(s)));case\"stats\":return new n.Stats(ot(e,Ur(s)));default:return By(e,t)}return By(e,t)}case\"For\":return iT(e,t,{parentIsList:!1});default:return By(e,t)}}function LF(e){if(e.type!==\"Paren\")return!1;let[t]=e.args;return t.type!==\"Seq\"?!1:t.args.length===2||t.args.length===3}function vF(e,t,n,r){let s=J5(e,n,r);if(s!==void 0)return e.setInput(s,po(t.args[0].span,r.span))}function J5(e,t,n){let r=e.nodes;if(n.type===\"Letter\")switch(n.val){case\"x\":case\"y\":case\"z\":case\"p\":return new r.NamedCoordinateAccess(n.val,[t])}else if(n.type===\"Cmd\")switch(n.val){case\"real\":case\"imag\":throw mP(n.val)}}function Nn(e,t){return e.setInput(By(e,t),t.span)}function By(e,t){let n=e.nodes;switch(t.type){case\"Pos\":return Nn(e,t.args[0]);case\"Neg\":let r=-1,s=t.args[0];for(;;)if(s.type===\"Pos\"||s.type===\"Paren\"&&!LF(s))s=s.args[0];else if(s.type===\"Neg\")s=s.args[0],r*=-1;else break;switch(s.type){case\"Decimal\":{let i=RF(s);return new n.Constant(r===-1?mo(i):i)}case\"MixedNumber\":{let i=OF(s);return new n.MixedNumber(r===-1?mo(i):i)}default:return r===-1?new n.Negative([Nn(e,s)]):Nn(e,s)}case\"Add\":return new n.Add(ot(e,t.args));case\"Sub\":return new n.Subtract(ot(e,t.args));case\"Mul\":return new n.Multiply(ot(e,t.args));case\"DotMul\":return new n.DotMultiply(ot(e,t.args));case\"CrossMul\":return new n.CrossMultiply(ot(e,t.args));case\"Div\":return new n.Divide(ot(e,t.args));case\"Bang\":{let[i]=t.args;return i.type===\"Call\"&&fr(i.args[0])&&!uT(i.args[0])&&Ur(i.args[1]).length===1?new n.FunctionFactorial(ot(e,i.args)):new n.FunctionCall(\"\\\\factorial\",ot(e,t.args))}case\"PercentOf\":return new n.PercentOf(ot(e,t.args));case\"Call\":return DF(e,t);case\"ImplicitCall\":return rY(t),DF(e,t);case\"Dot\":{let i=t.args[1],[a,u]=CF(e,t.args,i);if(i.type===\"Letter\")switch(i.val){case\"x\":case\"y\":case\"z\":case\"p\":return new n.NamedCoordinateAccess(i.val,[a]);default:break}else if(i.type===\"Call\"){let c=i.args[0],p=vF(e,t,a,c);if(p!==void 0)return new n.Multiply([p,Nn(e,i.args[1])])}return new n.DotAccess([a,u])}case\"Prime\":{let[i]=t.args;if(i.type===\"Call\"){let[a,u]=i.args,c=Ur(u).length;if(a.type===\"Cmd\"&&a.val===\"logbase\"){if(c!==2)throw Gl()}else if(c!==1)throw Gl();return new n.Prime(t.nprimes,ot(e,t.args))}else throw i.type===\"ImplicitCall\"?ih():oh()}case\"Index\":{let[i,a]=t.args;if(a.type===\"Seq\")return new n.ListAccess([Nn(e,i),e.setInput(new n.List(ot(e,a.args)),void 0)]);if(a.type===\"Ellipsis\"){let[u,c]=a.args;return new n.ListAccess([Nn(e,i),e.setInput(new n.Range([e.setInput(new n.List(ot(e,Ur(u))),void 0),e.setInput(new n.List(c.type===\"EmptyRangeEnd\"?[]:ot(e,Ur(c))),void 0)]),void 0)])}return Gy(a)?new n.ListAccess([Nn(e,i),e.setInput(Gu(e,a),void 0)]):new n.ListAccess(ot(e,t.args))}case\"Paren\":{let[i]=t.args;if(i.type===\"Seq\"){if(i.args.length===0)throw gf();return new n.ParenSeq(ot(e,i.args))}else return Nn(e,i)}case\"List\":{if(t.args.length===0)return new n.List([]);let i=t.args[0];if(i.type===\"Ellipsis\"){let[a,u]=i.args;return new n.Range([e.setInput(new n.List(ot(e,Ur(a))),void 0),e.setInput(new n.List(ot(e,Ur(u))),void 0)])}else if(i.type===\"For\")return iT(e,i,{parentIsList:!0});return new n.List(ot(e,Ur(i)))}case\"Pipes\":{let[i]=t.args;return new n.Norm([Nn(e,i)])}case\"Subscript\":{let[i,a]=t.args;if(a.val.length===0)throw sh();let u;switch(i.type){case\"Letter\":u=i.val;break;case\"Cmd\":u=i.val;break;default:throw IE()}if(u===\"ans\")throw Ls(\"ans\");return new n.Identifier(`${u}_${a.val}`)}case\"Superscript\":{let[i,a]=t.args;if(i.type===\"Call\"&&i.args[1].type!==\"Seq\"&&!uT(i.args[0])&&!sY(i))return new n.FunctionExponent(ot(e,[i.args[0],i.args[1],a]));if(i.type===\"Dot\"){let u=i.args[1],[c,p]=CF(e,i.args,u),l=Nn(e,a);if(u.type===\"Letter\")switch(u.val){case\"x\":case\"y\":case\"z\":return new n.Exponent([e.setInput(new n.NamedCoordinateAccess(u.val,[c]),i.span),l]);default:break}else if(u.type===\"Call\"){let m=u.args[0],d=vF(e,i,c,m);if(d!==void 0)return new n.Multiply([d,e.setInput(new n.Exponent([Nn(e,u.args[1]),l]),lo(t.span.input,u.args[0].span.end,a.span.end))])}return new n.Exponent([e.setInput(new n.DotAccess([c,p]),i.span),l])}else return new n.Exponent(ot(e,t.args))}case\"Sqrt\":return new n.FunctionCall(\"sqrt\",ot(e,t.args));case\"Nthroot\":return new n.FunctionCall(\"nthroot\",ot(e,[t.args[1],t.args[0]]));case\"Frac\":return new n.Divide(ot(e,t.args));case\"Derivative\":{let i=ot(e,t.args);if(!fr(t.args[0]))throw V(`Expected identifier in derivative, but found ${t.args[0].type}`);return new n.Derivative(i[0],[i[1]])}case\"Integral\":{let[i,a,u,c]=t.args,p=ot(e,[i,a,u,c]);return new n.Integral(p)}case\"EmptyIntegral\":{let[i,a,u]=ot(e,t.args),c=e.setInput(new n.Constant(be(1,1)),void 0);return new n.Integral([i,a,u,c])}case\"Sum\":{let[i,a,u]=t.args;if(a.type!==\"Comparator\"||!Pd(a))throw bS();let c=ot(e,[a.args[0],a.args[1],u]),p=Nn(Hy(e,{prefix:\"ro\",expr:c[0]}),i);return new n.Sum(c.concat(p))}case\"Product\":{let[i,a,u]=t.args;if(a.type!==\"Comparator\"||!Pd(a))throw xS();let c=ot(e,[a.args[0],a.args[1],u]),p=Nn(Hy(e,{prefix:\"ro\",expr:c[0]}),i);return new n.Product(c.concat(p))}case\"Juxt\":{if(e.writeIntegral){let[u,c]=t.args;if(c.type===\"Letter\"&&c.val===\"t\"&&u.type===\"Juxt\"&&([u,c]=u.args,c.type===\"Letter\"&&c.val===\"n\")){if(u.type===\"Juxt\"){if([u,c]=u.args,c.type===\"Letter\"&&c.val===\"i\")throw xh()}else if(u.type===\"Letter\"&&u.val===\"i\")throw xh()}}let[i,a]=t.args;if(i.type===\"MixedNumber\"&&!(fr(a)||a.type===\"Piecewise\"||a.type===\"Call\"||a.type===\"Paren\"))throw th(aT(i));if(a.type===\"MixedNumber\")throw th(aT(a));return new n.Multiply(ot(e,t.args))}case\"Letter\":return new n.Identifier(t.val);case\"Cmd\":{let i=t.val;switch(i){case\"ans\":{if(e.index===void 0)throw Sf(\"ans\");return new n.Ans(`ans_{${e.index-1}}`)}case\"approx\":throw zg(i);case\"dt\":{if(!e.allowDt)throw Sf(i);return new n.Identifier(i)}case\"index\":{if(!e.allowIndex)throw Sf(i);return new n.Identifier(i)}default:return new n.Identifier(i)}}case\"With\":{if(e.isSubstitutionRHS)throw Mh();let[i,a]=t.args,u={...e,isSubstitutionRHS:!0};return new n.Substitution(Nn(u,i),eY(u,a))}case\"Decimal\":return new n.Constant(RF(t));case\"MixedNumber\":return new n.MixedNumber(OF(t));case\"Piecewise\":return nY(e,t);case\"RightArrow\":return tY(e,t);case\"Seq\":return new n.BareSeq(ot(e,t.args));case\"EmptyPiecewise\":return new n.Restriction([e.setInput(new n.Constant(!0),Ca(t.span.input,t.span.start))]);case\"Comparator\":throw t.symbol===\"=\"?Ls(\"=\"):kg();case\"ComparatorChain\":throw t.symbols.includes(\"=\")?$I():kg();case\"Tilde\":throw Ls(\"~\");case\"Colon\":throw Ls(\":\");case\"Ellipsis\":throw Ls(\"...\");case\"For\":return iT(e,t,{parentIsList:!1});case\"EmptyRangeEnd\":throw yS();case\"Err\":throw oY(t.error);default:throw`Unexpected surface node ${t.type}.`}}function aD(e){return Id.hasOwnProperty(e)}function FF(e){return e===\"ln\"||e===\"log\"||e===\"logbase\"}function Q5(e){return e.type===\"Decimal\"&&e.val===\"2\"}function K5(e){return e.type!==\"Neg\"?!1:(e=e.args[0],e.type===\"Decimal\"&&e.val===\"1\")}function DF(e,t){let n=e.nodes,[r,s]=t.args,o=Nn(e,r),i=Ur(s),a=ot(e,i);if(uT(r)){let u=Ca(s.span.input,s.span.start),c=e.setInput(VF(e),u);return new n.SeededFunctionCall(o,[c].concat(a))}if(fr(r))return new n.FunctionCall(o,a);if(r.type===\"Superscript\"){let[u,c]=r.args;if(u.type===\"Cmd\"){let p=u.val;if(aD(p)||FF(p)){if(Q5(c))return new n.Exponent([e.setInput(new n.FunctionCall(p,a),void 0),Nn(e,c)]);if(K5(c)&&Id[p]!==void 0)return new n.FunctionCall(Id[p],a);throw aD(p)?vE(p):DE(p===\"logbase\"?\"log\":p)}}}return new n.Multiply([o,Nn(e,s)])}function iT(e,t,{parentIsList:n}){let r=e.nodes,[s,o]=t.args,i=e.setInput(new r.Identifier(`_comprehensionIndex_${X5++}`),void 0);if(s.type===\"For\")throw Sc(\"for\");let a=Nn(Hy(e,{prefix:\"li\",expr:i}),s),u=[];if(o.type===\"Seq\"){let l=!1,m=!1,d=!1;for(let y=0;y<o.args.length;y++){let g=o.args[y];Pd(g)||e.allowIntervalComprehensions&&g.type===\"ComparatorChain\"?l=!0:m=!0,g.type===\"Cmd\"&&g.val===\"cursor\"&&(d=!0)}if(l&&m){let y=Sc(\"for\");throw d&&y.setCursorContext({type:\"for-assignment-lhs\",allowedTypes:[N]}),y}}let c=[];for(let l of Ur(o))if(e.allowIntervalComprehensions&&l.type===\"ComparatorChain\"){let m=uD(l),{min:d,identifier:y,max:g,open:f}=m;c.push({identifier:Nn(e,y),bounds:[Nn(e,d),Nn(e,g)],open:f})}else if(l.type===\"Comparator\"&&Pd(l)){let m=e.setInput(new r.AssignmentExpression(ot(e,l.args)),l.span);u.push(m)}else{if(l.type===\"Comparator\")throw Jp(\"a\");{let m=$S();throw l.type===\"Cmd\"&&l.val===\"cursor\"&&m.setCursorContext({type:\"for-assignment-lhs\",allowedTypes:[N]}),m}}let p=n;return new r.ListComprehension(i,a,u,p,c)}function eY(e,t){let n=e.nodes;if(t.type===\"Seq\"){let o=!1,i=!1,a=!1;for(let u=0;u<t.args.length;u++){let c=t.args[u];if(c.type===\"With\")throw Sc(\"with\");if(Pd(c)||NF(c))o=!0;else if(e.allowIntervalComprehensions&&c.type===\"ComparatorChain\")try{uD(c),i=!0}catch(p){a=!0}else a=!0}if((o||i)&&a)throw Sc(\"with\");if(i)throw Ch()}if(e.allowIntervalComprehensions&&t.type===\"ComparatorChain\"){let o;try{uD(t),o=!0}catch(i){o=!1}if(o)throw Ch()}if(t.type===\"With\")throw Mh();let r=Ur(t),s=[];for(let o of r){if(o.type!=\"Comparator\"||!Pd(o)&&!NF(o))throw Nf();let i=e.setInput(new n.AssignmentExpression(ot(e,o.args)),o.span);s.push(i)}return s}function NF(e){if(e.type!==\"Comparator\"||e.symbol!==\"=\")return!1;let t=e.args[0];if(t.type!==\"Call\")return!1;let[n]=t.args;return!!fr(n)}function uD(e){if(e.symbols.length!==2)throw Jp(\"a\");let[t,n,r]=e.args,[s,o]=e.symbols;if(!fr(n))throw Jp(\"a\");if(s!==\"<\"&&s!==\"<=\"||o!==\"<\"&&o!==\"<=\"||e.symbols.includes(\"=\"))throw Jp(pr(n.span));return{min:t,identifier:n,max:r,open:[s===\"<\",o===\"<\"]}}function tY(e,t){let n=e.nodes;if(!fr(t.args[0]))throw LP();return e=Hy(e,{prefix:\"ec\",expr:e.setInput(new n.Identifier(\"globalEventCount\"),void 0)}),new n.UpdateRule(ot(e,t.args))}function nY(e,t){let n=e.nodes,[r]=t.args,s=Ur(r);if(s.length===1&&Gy(s[0])){let m=s[0];return new n.Restriction([e.setInput(Gu(e,m),m.span)])}if(s.length>1&&s.every(Gy)){let m=e.setInput(Gu(e,s[0]),s[0].span);for(let d=1;d<s.length;d++){let y=e.setInput(Gu(e,s[d]),s[d].span);m=e.setInput(new n.Or([m,y]),po(s[0].span,s[d].span))}return new n.Restriction([m])}let o,i=[];e:for(o=0;o<s.length;o++){let m=s[o];switch(m.type){case\"Colon\":{let[d,y]=m.args;if(!Gy(d))throw OE();if(y.type===\"With\"&&y.args[1].type===\"Seq\")throw Sc(\"with\");i.push({condition:e.setInput(Gu(e,d),d.span),if_expr:Nn(e,y)});break}case\"Comparator\":case\"ComparatorChain\":i.push({condition:e.setInput(Gu(e,m),m.span),if_expr:e.setInput(new n.Constant(be(1,1)),lo(\"1\",0,1))});break;case\"For\":throw Sc(\"for\");default:break e}}if(o===0)throw NE();if(o<s.length-1)throw RE();let a,u;o===s.length-1?(a=By(e,s[o]),u=s[o]):a=new n.Constant(NaN);let c=a,p=u==null?void 0:u.span,l;for(;i.length;)l=i.pop(),c=new n.Piecewise([l.condition,l.if_expr,e.setInput(c,p)]),p=void 0;return c}function Gy(e){return e.type===\"Comparator\"||e.type===\"ComparatorChain\"}function Gu(e,t){let n=e.nodes;switch(t.type){case\"Comparator\":switch(t.symbol){case\"<\":return new n[\"Comparator['<']\"](ot(e,t.args));case\"<=\":return new n[\"Comparator['<=']\"](ot(e,t.args));case\">\":return new n[\"Comparator['>']\"](ot(e,t.args));case\">=\":return new n[\"Comparator['>=']\"](ot(e,t.args));case\"=\":return new n[\"Comparator['=']\"](ot(e,t.args));default:throw new Error(`Unexpected symbol ${t.symbol}`)}case\"ComparatorChain\":return new n.ComparatorChain(t.symbols,ot(e,t.args));default:throw V(`Unexpected type for condition: ${t.type}`)}}function rY(e){let[t,n]=e.args;if(t.type===\"Superscript\"&&(t=t.args[0]),t.type===\"Cmd\"&&t.val===\"logbase\"&&n.type===\"Seq\"&&n.args.length===2){if(!Xa(n.args[0]))throw eh(\"log\")}else if(!Xa(n))throw t.type===\"Cmd\"?eh(t.val):V(`Unexpected type for args of implicit call: ${n.type}`)}function RF(e){return kl(e.val)}function OF(e){let t=kl(e.whole),n=kl(e.num),r=kl(e.den);return fo(t,Vs(n,r))}function sY(e){if(e.type!==\"Call\")return!1;let t=e.args[0];for(;t.type===\"Superscript\"||t.type===\"Subscript\"||t.type===\"Prime\";)t=t.args[0];return t.type!==\"Cmd\"?!1:aD(t.val)||FF(t.val)}function Pd(e){return e.type===\"Comparator\"&&e.symbol===\"=\"&&fr(e.args[0])}function oY(e){switch(e.type){case\"UnexpectedParseError\":case\"MissingBound\":case\"EmptyGroup\":case\"UnexpectedDifferential\":case\"UnexpectedEnd\":return V(`Unexpected error type: ${e.type}`);case\"InvalidOperatorName\":return TE();case\"UnexpectedCloseDelimiter\":case\"MissingCloseDelimiter\":return NS(e.open,e.close);case\"UnrecognizedSymbol\":return e.val===\".\"?Ls(e.val):zg(e.val);case\"EmptyInput\":return hf();case\"BinaryOperatorMissingRight\":case\"BinaryOperatorMissingLeft\":return Zp(e.val===\"%\"?\"% of\":e.val);case\"UnaryOperatorMissingLeft\":return dE(e.val);case\"UnaryOperatorMissingRight\":return fE(e.val);case\"UnexpectedSubscript\":return wE(e.base);case\"PercentMissingOf\":return OS();case\"SumMissingBound\":return gS();case\"ProductMissingBound\":return hS();case\"IntegralMissingBound\":return PS();case\"SumMissingBody\":return MS();case\"ProductMissingBody\":return CS();case\"IntegralMissingBody\":return vS();case\"DerivativeMissingBody\":return DS();case\"IntegralMissingDifferential\":return ES();case\"DifferentialWithSuperscript\":return SS();case\"FractionMissingNumerator\":return yE();case\"FractionMissingDenominator\":return gE();case\"FractionEmpty\":return hE();case\"EmptySuperscript\":return bE();case\"EmptySubscript\":return sh();case\"InvalidSubscript\":return xE(e.val);case\"SuperscriptWithPrime\":return PE();case\"PrimeWithoutParen\":return ih();case\"UnexpectedPrime\":return oh();case\"EmptyRadical\":return EE();case\"EmptyRadicalIndex\":return SE();case\"EmptySquareBracket\":return ME();case\"EmptyPipe\":return CE();case\"FunctionMissingArgument\":return Da(e.val,1,0,{includeUsageExample:!0});case\"AdjacentNumbers\":return pE(aT(e.args[0]),aT(e.args[1]));case\"TokenWithSubscript\":return mE();case\"UnexpectedFor\":return Ls(\"for\");default:throw`Unexpected surface node ${e.type}.`}}function aT(e){switch(e.type){case\"Decimal\":return e.val;case\"MixedNumber\":return`${e.whole} ${e.num}/${e.den}`;default:let t=e;throw new Error(`Unexpected node type ${t.type}`)}}function Xa(e){switch(e.type){case\"Letter\":case\"Decimal\":case\"MixedNumber\":case\"Cmd\":case\"EmptyPiecewise\":return!0;case\"Neg\":{let n=e.args[0];for(;;)if(n.type===\"Pos\"||n.type===\"Paren\"&&!LF(n))n=n.args[0];else if(n.type===\"Neg\")n=n.args[0];else break;return n.type===\"Decimal\"||n.type===\"MixedNumber\"}case\"Pos\":return Xa(e.args[0]);case\"Paren\":return Xa(e.args[0]);case\"Juxt\":case\"Mul\":case\"DotMul\":case\"CrossMul\":case\"Div\":return Xa(e.args[0])&&Xa(e.args[1]);case\"Subscript\":return Xa(e.args[0]);case\"Superscript\":case\"Frac\":case\"Add\":case\"Sub\":return Xa(e.args[0])&&Xa(e.args[1]);case\"Piecewise\":{let[n]=e.args;return Gy(n)}case\"Call\":{let[n,r]=e.args;return fr(n)||TF(n)?!1:Xa(n)&&Xa(r)}case\"Derivative\":case\"Sqrt\":case\"Nthroot\":case\"Pipes\":case\"Bang\":return!1;case\"Comparator\":case\"ComparatorChain\":case\"Tilde\":case\"ImplicitCall\":case\"Index\":case\"List\":case\"Seq\":case\"Integral\":case\"EmptyIntegral\":case\"Sum\":case\"Product\":case\"Colon\":case\"Ellipsis\":case\"For\":case\"With\":case\"Dot\":case\"PercentOf\":case\"Prime\":case\"EmptyRangeEnd\":case\"RightArrow\":return!1;default:throw`Unexpected surface node ${e.type}.`}}function uT(e){return e.type!==\"Cmd\"?!1:e.val===\"random\"||e.val===\"shuffle\"}function VF(e){let t=new e.nodes.ExtendSeed(\"\",[e.setInput(new e.nodes.Identifier(\"globalRandomSeed\"),void 0),e.setInput(new e.nodes.Seed(e.nextSeed()),void 0)]);if(!e.seedExtensions)return t;for(let{prefix:n,expr:r}of e.seedExtensions)t=new e.nodes.ExtendSeed(n,[e.setInput(t,void 0),r]);return t}function Hy(e,t){let n=e.seedExtensions||[];return{...e,seedExtensions:n.concat(t)}}function Ed(e){return{type:\"initial\",tokenType:e}}function qy(e){return{type:\"l\",tokenType:e}}function Uy(e){return{type:\"r\",tokenType:e}}function cn(e){return{type:\"la\",tokenType:e}}function Sd(e){return{type:\"ra\",tokenType:e}}function BF(e,t){for(let n of FL)if(t[n]===void 0)throw new Error(`Programming Error: token ${n} must be a assigned a ${e} precedence`)}function Ep(e,t,n,r){if(t[n]!==void 0)throw new Error(`Programming Error: duplicate ${e} entry for token ${n}.`);t[n]=r}function GF(e){let t={},n={},r={};for(let a=0;a<e.length;a++){let u=e[a];for(let{type:c,tokenType:p}of u)switch(c){case\"initial\":Ep(\"initial\",t,p,a);break;case\"l\":Ep(\"left\",n,p,a);break;case\"r\":Ep(\"right\",r,p,a);break;case\"la\":Ep(\"left\",n,p,a),Ep(\"right\",r,p,a);break;case\"ra\":Ep(\"left\",n,p,a),Ep(\"right\",r,p,a-1);break}}BF(\"left\",n),BF(\"right\",r);function s(a){return r[a]}function o(a){return n[a]}function i(a){let u=t[a];return u===void 0?s(a):u}return{rightPrec:s,leftPrec:o,initialPrec:i}}function Le(e,t){return{type:\"Err\",span:e,error:t}}function HF(){return{type:\"UnexpectedParseError\"}}function qF(){return{type:\"EmptyInput\"}}function UF(){return{type:\"EmptyGroup\"}}function lD(){return{type:\"EmptySubscript\"}}function zF(){return{type:\"EmptySuperscript\"}}function pD(){return{type:\"EmptyRadical\"}}function kF(){return{type:\"EmptySquareBracket\"}}function $F(){return{type:\"EmptyPipe\"}}function YF(){return{type:\"EmptyRadicalIndex\"}}function mD(){return{type:\"UnexpectedEnd\"}}function Sp(e){return{type:\"BinaryOperatorMissingRight\",val:e}}function ZF(e){return{type:\"BinaryOperatorMissingLeft\",val:e}}function dD(e){return{type:\"UnaryOperatorMissingRight\",val:e}}function fD(e){return{type:\"UnaryOperatorMissingLeft\",val:e}}function XF(e,t){return{type:\"MissingCloseDelimiter\",open:e,close:t}}function zy(e,t){return{type:\"UnexpectedCloseDelimiter\",open:e,close:t}}function WF(){return{type:\"UnexpectedDifferential\"}}function jF(e){return{type:\"UnrecognizedSymbol\",val:e}}function JF(e){return{type:\"InvalidSubscript\",val:e}}function QF(e){return{type:\"UnexpectedSubscript\",base:e}}function yD(e){return{type:\"FunctionMissingArgument\",val:e}}function KF(){return{type:\"PercentMissingOf\"}}function gD(){return{type:\"PrimeWithoutParen\"}}function eV(){return{type:\"SuperscriptWithPrime\"}}function cT(){return{type:\"UnexpectedPrime\"}}function tV(){return{type:\"SumMissingBound\"}}function nV(){return{type:\"ProductMissingBound\"}}function hD(){return{type:\"MissingBound\"}}function rV(){return{type:\"IntegralMissingBound\"}}function sV(){return{type:\"SumMissingBody\"}}function oV(){return{type:\"ProductMissingBody\"}}function iV(){return{type:\"IntegralMissingBody\"}}function aV(){return{type:\"DerivativeMissingBody\"}}function uV(){return{type:\"IntegralMissingDifferential\"}}function cV(){return{type:\"DifferentialWithSuperscript\"}}function lV(){return{type:\"FractionMissingNumerator\"}}function pV(){return{type:\"FractionMissingDenominator\"}}function mV(){return{type:\"FractionEmpty\"}}function bD(e){return{type:\"AdjacentNumbers\",args:e}}function dV(){return{type:\"TokenWithSubscript\"}}var aY=[[Ed(\"(\"),cn(\")\"),Ed(\"\\\\{\"),cn(\"\\\\}\"),Uy(\"[\"),cn(\"]\"),Ed(\"(|\"),cn(\"|)\"),cn(\"Differential\"),cn(\"End\")],[cn(\"for\")],[Uy(\"with\")],[Sd(\"...\")],[cn(\",\")],[Sd(\":\")],[Uy(\"->\")],[qy(\"with\")],[cn(\"=\"),cn(\">\"),cn(\"<\"),cn(\">=\"),cn(\"<=\"),cn(\"~\")],[qy(\"->\")],[cn(\"+\"),cn(\"-\")],[cn(\"*\"),cn(\"\\\\cdot\"),cn(\"\\\\times\"),cn(\"/\"),cn(\"Decimal\"),cn(\"MixedNumber\"),cn(\"Letter\"),cn(\"Cmd\"),cn(\"TokenNode\"),cn(\"%\"),Uy(\"(\"),cn(\"\\\\{\"),cn(\"(|\"),cn(\"Frac\"),cn(\"Sqrt\"),cn(\"Trig\"),cn(\"Ln\"),cn(\"Log\"),Sd(\"Int\"),Sd(\"Sum\"),Sd(\"Prod\")],[Ed(\"+\"),Ed(\"-\")],[cn(\"!\")],[cn(\"SupSub\")],[qy(\"[\"),cn(\".\")],[qy(\"(\")],[cn(\"Err\")]],{leftPrec:TD,rightPrec:fV,initialPrec:ID}=GF(aY),yV={trailingComma:!1};function bV(e,t){let n=t?{...yV,...t}:yV,r=lc(e,n),s=uY(r);return s.type===\"Err\"&&s.error.type===\"EmptyGroup\"?Le(s.span,qF()):s}function uY(e){return dl(e,{isToplevel:!0})}function dl(e,{isToplevel:t}={isToplevel:!1}){if(oT(e))return Le(Ee(e,e),UF());let{state:n,tree:r}=Pr(e,0,{isToplevel:t});return r.type!==\"Err\"&&!oT(n)?PD(n).tree:r}function B(e,t){return{state:e,tree:t}}function Pr(e,t,{isToplevel:n}={isToplevel:!1}){let r=e,s;if({state:r,tree:s}=cY(r),s.type===\"Err\")return B(r,s);if(!iD(e,r))throw new Error(\"Programming Error: parseInitial did not advance state.\");for(;!oT(r);){let o;if(es(r,\"(\")&&!mY(s)?o=fV(\"(\"):o=TD(hs(r).type),t>=o)break;let i=r,a=lY(r,s,n)?ID(\"(\"):fV(hs(r).type);if({state:r,tree:s}=pY(r,s,a),s.type===\"Err\")return B(r,s);if(!iD(i,r))throw new Error(\"Programming Error: parseSuccessor did not advance state.\")}return B(r,s)}function pi(e){return e.type===\"UnexpectedDifferential\"||e.type===\"UnexpectedCloseDelimiter\"||e.type===\"UnexpectedEnd\"}function cY(e){let t=e,n=hs(e),r=ID(n.type),s;switch(n.type){case\"+\":{if(e=ze(e),{state:e,tree:s}=Pr(e,r),s.type===\"Err\"){if(!pi(s.error))return B(e,s);let i=Ee(t,e),a=Le(i,dD(n.val));return B(e,a)}return B(e,zL(Ee(t,e),[s]))}case\"-\":if(e=ze(e),{state:e,tree:s}=Pr(e,r),s.type===\"Err\"){if(!pi(s.error))return B(e,s);let i=Ee(t,e),a=Le(i,dD(n.val));return B(e,a)}else return B(e,kL(Ee(t,e),[s]));case\"(\":return ky(e);case\"\\\\{\":return e=ze(e),es(e,\"\\\\}\")?(e=ze(e),B(e,cF(Ee(t,e)))):({state:e,tree:s}=Pr(e,r),{state:e,tree:s}=$y(t,e,s,\"\\\\{\",\"\\\\}\"),s.type===\"Err\"?B(e,s):B(e,uF(Ee(t,e),[s])));case\"[\":return e=ze(e),es(e,\"]\")?(e=ze(e),B(e,Kv(Ee(t,e),[]))):({state:e,tree:s}=Pr(e,r),{state:e,tree:s}=$y(t,e,s,\"[\",\"]\"),s.type===\"Err\"?B(e,s):B(e,Kv(Ee(t,e),[s])));case\"(|\":{if(e=ze(e),es(e,\"|)\")){e=ze(e);let i=Ee(t,e);return B(e,Le(i,$F()))}return{state:e,tree:s}=Pr(e,r),{state:e,tree:s}=$y(t,e,s,\"(|\",\"|)\"),s.type===\"Err\"?B(e,s):B(e,KL(Ee(t,e),[s]))}case\"Frac\":{if(e.opts.disallowFrac)throw Eh();e=ze(e);let i=dl(lc(n.num,e.opts)),a=dl(lc(n.den,e.opts));if(i.type===\"Err\"&&i.error.type===\"EmptyGroup\"&&a.type===\"Err\"&&a.error.type===\"EmptyGroup\"){let u=Ee(t,e),c=Le(u,mV());return B(e,c)}if(i.type===\"Err\"&&i.error.type===\"EmptyGroup\"){let u=Ee(t,e),c=Le(u,lV());return B(e,c)}if(a.type===\"Err\"&&a.error.type===\"EmptyGroup\"){let u=Ee(t,e),c=Le(u,pV());return B(e,c)}if(i.type===\"Err\")return B(e,i);if(a.type===\"Err\")return B(e,a);if(IF(i,a)&&a.type===\"Juxt\"){let u=a.args[1],c;if({state:e,tree:c}=Pr(e,TD(\"*\")-1),c.type===\"Err\"){if(pi(c.error)){let p=Ee(t,e);return B(e,Le(p,aV()))}return B(e,c)}return B(e,rF(Ee(t,e),[u,c]))}return B(e,nF(Ee(t,e),[i,a]))}case\"Sqrt\":if(e=ze(e),n.optArg){let i=dl(lc(n.optArg,e.opts));if(i.type===\"Err\")return i.error.type===\"EmptyGroup\"?B(e,Le(i.span,YF())):B(e,i);let a=dl(lc(n.arg,e.opts));return a.type===\"Err\"?a.error.type===\"EmptyGroup\"?B(e,Le(a.span,pD())):B(e,a):B(e,tF(Ee(t,e),[i,a]))}else{let i=dl(lc(n.arg,e.opts));return i.type===\"Err\"?i.error.type===\"EmptyGroup\"?B(e,Le(i.span,pD())):B(e,i):B(e,eF(Ee(t,e),[i]))}case\"Trig\":case\"Ln\":{e=ze(e);let i=Pp(Ee(t,e),n.val),a=0,u=hs(e);if(u.type===\"SupSub\"){if(e=ze(e),u.sub){let l=Ee(t,e),m=Le(l,QF(i.val));return B(e,m)}let p=lT(u,e.opts);if(p){if(p.type===\"Err\")return B(e,p);i=eT(Ee(t,e),[i,p])}a=u.nprimes}let c=es(e,\"(\");if(c){if({state:e,tree:s}=ky(e),s.type===\"Err\")return B(e,s);s=Ly(Ee(t,e),[i,s.args[0]])}else{if({state:e,tree:s}=Pr(e,r-1),s.type===\"Err\")return pi(s.error)?B(e,Le(Ee(t,e),yD(n.val))):B(e,s);s=Jv(Ee(t,e),[i,s])}if(a>0){let p=Ee(t,e);if(!c){let l=Le(p,gD());return B(e,l)}s=Fy(p,a,[s])}return B(e,s)}case\"Log\":{e=ze(e);let i=Ee(t,e),a=Pp(i,n.val),u=0,c,p,l=hs(e);if(l.type===\"SupSub\"&&(e=ze(e),c=xV(l,e.opts),p=lT(l,e.opts),u=l.nprimes),c&&c.type===\"Err\")return B(e,c);if(p&&p.type===\"Err\")return B(e,p);let m=es(e,\"(\");if(m){if({state:e,tree:s}=ky(e),s.type===\"Err\")return B(e,s);s=s.args[0]}else if({state:e,tree:s}=Pr(e,r-1),s.type===\"Err\")return pi(s.error)?B(e,Le(Ee(t,e),yD(n.val))):B(e,s);let d=c?Pp(i,\"\\\\logbase\"):a,y=c?tT(Ee(t,e),Ur(s).concat(c)):s;if(p&&(d=eT(Ee(t,e),[d,p])),m?s=Ly(Ee(t,e),[d,y]):s=Jv(Ee(t,e),[d,y]),u>0){let g=Ee(t,e);if(!m){let f=Le(g,gD());return B(e,f)}s=Fy(g,u,[s])}return B(e,s)}case\"Int\":{e=ze(e);let i=hs(e);e=ze(e);let a=xD(i,t,e);if(a.type===\"Err\")return a.error.type===\"MissingBound\"?B(e,Le(a.span,rV())):B(e,a);let{sup:u,sub:c}=a,p;if(es(e,\"Differential\"))return{state:e,tree:p}=hV(e),p.type===\"Err\"?B(e,p):B(e,oF(Ee(t,e),[p,c,u]));if({state:e,tree:s}=Pr(e,r),s.type===\"Err\")return pi(s.error)?B(e,Le(s.span,iV())):B(e,s);let l=s;return es(e,\"Differential\")?({state:e,tree:p}=hV(e),p.type===\"Err\"?B(e,p):B(e,sF(Ee(t,e),[p,c,u,l]))):B(e,Le(Ee(t,e),uV()))}case\"Sum\":{e=ze(e);let i=hs(e);e=ze(e);let a=xD(i,t,e);if(a.type===\"Err\")return a.error.type===\"MissingBound\"?B(e,Le(a.span,tV())):B(e,a);let{sup:u,sub:c}=a;return{state:e,tree:s}=Pr(e,r),s.type===\"Err\"?pi(s.error)?B(e,Le(s.span,sV())):B(e,s):B(e,iF(Ee(t,e),[s,c,u]))}case\"Prod\":{e=ze(e);let i=hs(e);e=ze(e);let a=xD(i,t,e);if(a.type===\"Err\")return a.error.type===\"MissingBound\"?B(e,Le(a.span,nV())):B(e,a);let{sup:u,sub:c}=a;return{state:e,tree:s}=Pr(e,r),s.type===\"Err\"?pi(s.error)?B(e,Le(s.span,oV())):B(e,s):B(e,aF(Ee(t,e),[s,c,u]))}case\"Cmd\":return e=ze(e),s=Pp(Ee(t,e),n.val),B(e,s);case\"TokenNode\":{e=ze(e);let i=hs(e);return i.type===\"SupSub\"&&i.sub?(e=ze(e),B(e,Le(Ee(t,e),dV()))):(s=Pp(Ee(t,e),n.val),B(e,s))}case\"Letter\":return e=ze(e),s=hF(Ee(t,e),n.val),B(e,s);case\"Decimal\":{e=ze(e);let i=nT(Ee(t,e),n.val),a=e.token;if(a.type===\"Decimal\"||a.type===\"MixedNumber\"){let u=e;e=ze(e);let c=Ee(t,e),p=a.type===\"MixedNumber\"?a:nT(Ee(u,e),a.val);return B(e,Le(c,bD([i,p])))}if(n.val.endsWith(\".\")&&a.type===\"Cmd\"&&(a.val===\"\\\\real\"||a.val===\"\\\\imag\"))throw $g();return B(e,i)}case\"MixedNumber\":{if(e.opts.disallowFrac)throw Eh();e=ze(e);let i=e.token;if(i.type===\"Decimal\"||i.type===\"MixedNumber\"){let a=e;e=ze(e);let u=Ee(t,e),c=i.type===\"MixedNumber\"?i:nT(Ee(a,e),i.val);return B(e,Le(u,bD([n,c])))}return B(e,n)}case\"*\":case\"\\\\cdot\":case\"\\\\times\":case\"/\":case\",\":case\"=\":case\">\":case\"<\":case\">=\":case\"<=\":case\"->\":case\"~\":case\":\":case\"...\":case\"%\":case\".\":case\"for\":case\"with\":{e=ze(e);let i=Ee(t,e),a=Le(i,ZF(n.val));return B(e,a)}case\"!\":{e=ze(e);let i=Ee(t,e),a=Le(i,fD(n.val));return B(e,a)}case\"SupSub\":{e=ze(e);let i=\"supsub\";n.sub?i=\"subscript\":n.sup?i=\"superscript\":n.nprimes>0&&(i=\"prime\");let a=Ee(t,e),u=Le(a,fD(i));return B(e,u)}case\")\":case\"\\\\}\":case\"]\":case\"|)\":case\"Differential\":return PD(e);case\"Err\":{e=ze(e);let i=Ee(t,e),a=Le(i,jF(n.val));return B(e,a)}case\"End\":{let i=Ee(t,e),a=Le(i,mD());return B(e,a)}default:throw`Unexpected token type ${n.type}.`}}function lY(e,t,n){return es(e,\"=\")&&n&&(wF(t)||cD(t))}function pY(e,t,n){let r=hs(e),s;switch(r.type){case\"+\":case\"-\":case\"*\":case\"\\\\cdot\":case\"\\\\times\":case\"/\":case\"~\":case\":\":case\".\":case\"->\":case\"for\":{if(e=ze(e),{state:e,tree:s}=Pr(e,n),s.type===\"Err\")if(pi(s.error)){let i=yr(t.span,e),a=Le(i,Sp(r.val));return B(e,a)}else return B(e,s);return B(e,gV(r.type,yr(t.span,e),[t,s]))}case\"with\":{if(e=ze(e),{state:e,tree:s}=Pr(e,n),s.type===\"Err\")if(pi(s.error)){let i=yr(t.span,e),a=Le(i,Sp(r.val));return B(e,a)}else return B(e,s);return B(e,gV(r.type,yr(t.span,e),[t,s]))}case\"%\":{e=ze(e);let i=hs(e);if(i.type!==\"Cmd\"||i.val!==\"of\"&&i.val!==\"\\\\of\"){let a=Le(r.span,KF());return B(e,a)}if(e=ze(e),{state:e,tree:s}=Pr(e,n),s.type===\"Err\")if(pi(s.error)){let a=yr(t.span,e),u=Le(a,Sp(r.val));return B(e,u)}else return B(e,s);return B(e,yF(yr(t.span,e),[t,s]))}case\"=\":case\">=\":case\"<=\":case\">\":case\"<\":{let i=[t],a=[];for(;;){let c=hs(e).type;if(c!==\"=\"&&c!==\">=\"&&c!==\"<=\"&&c!==\">\"&&c!==\"<\")break;if(a.push(c),e=ze(e),{state:e,tree:s}=Pr(e,n),s.type===\"Err\")if(pi(s.error)){let p=yr(t.span,e),l=Le(p,Sp(r.val));return B(e,l)}else return B(e,s);i.push(s)}let u=i[i.length-1];return u.type===\"Comparator\"?(i.pop(),Array.prototype.push.apply(i,u.args),a.push(u.symbol)):u.type===\"ComparatorChain\"&&(i.pop(),Array.prototype.push.apply(i,u.args),Array.prototype.push.apply(a,u.symbols)),i.length===2?B(e,HL(yr(t.span,e),a[0],i)):B(e,qL(yr(t.span,e),a,i))}case\"!\":return e=ze(e),B(e,JL(yr(t.span,e),[t]));case\"[\":{let i=e;if(e=ze(e),es(e,\"]\")){e=ze(e);let a=Ee(i,e);return B(e,Le(a,kF()))}return{state:e,tree:s}=Pr(e,n),{state:e,tree:s}=$y(i,e,s,\"[\",\"]\"),s.type===\"Err\"?B(e,s):B(e,QL(yr(t.span,e),[t,s]))}case\"Sqrt\":case\"Frac\":case\"Letter\":case\"Cmd\":case\"TokenNode\":case\"Trig\":case\"Ln\":case\"Log\":case\"Sum\":case\"Int\":case\"Prod\":case\"Decimal\":case\"MixedNumber\":case\"\\\\{\":case\"(|\":return{state:e,tree:s}=Pr(e,n),s.type===\"Err\"?B(e,s):B(e,nD(yr(t.span,e),[t,s]));case\"(\":if(fr(t)){if({state:e,tree:s}=ky(e),s.type===\"Err\")return B(e,s);let i=yr(t.span,e);return B(e,Ly(i,[t,s.args[0]]))}else if(t.type===\"Prime\"&&fr(t.args[0])){if({state:e,tree:s}=ky(e),s.type===\"Err\")return B(e,s);let i=yr(t.span,e);return B(e,Fy(i,t.nprimes,[Ly(i,[t.args[0],s.args[0]])]))}else return{state:e,tree:s}=Pr(e,n),s.type===\"Err\"?B(e,s):B(e,nD(yr(t.span,e),[t,s]));case\"SupSub\":{e=ze(e);let i=TV(r),a=lT(r,e.opts);if(i&&i.type===\"Err\")return B(e,i);if(a&&a.type===\"Err\")return B(e,a);if(i&&(t=eD(yr(t.span,e),[t,i])),a&&(t=eT(yr(t.span,e),[t,a])),r.nprimes>0){let u=yr(t.span,e);if(!fr(t)){let c=Le(u,cT());return B(e,c)}t=Fy(u,r.nprimes,[t])}return B(e,t)}case\",\":{let i=[t];for(;es(e,\",\")&&(e=ze(e),!(es(e,\"...\")||e.opts.trailingComma&&dY(e)));){if({state:e,tree:s}=Pr(e,n),s.type===\"Err\")if(pi(s.error)){let a=yr(t.span,e),u=Le(a,Sp(r.val));return B(e,u)}else return B(e,s);i.push(s)}return B(e,tT(yr(t.span,e),i))}case\"...\":{if(e=ze(e),es(e,\",\")&&(e=ze(e)),n>=TD(hs(e).type))return B(e,tD(yr(t.span,e),[t,lF(sD(e))]));if({state:e,tree:s}=Pr(e,n),s.type===\"Err\")if(pi(s.error)){let i=yr(t.span,e),a=Le(i,Sp(r.val));return B(e,a)}else return B(e,s);return B(e,tD(yr(t.span,e),[t,s]))}case\"]\":case\")\":case\"\\\\}\":case\"|)\":case\"Differential\":return PD(e);case\"Err\":return Pr(e,n);case\"End\":{let i=Ee(e,e),a=Le(i,mD());return B(e,a)}default:throw`Unexpected token type ${r.type}.`}}function mY(e){return!!(fr(e)||e.type===\"Prime\"&&fr(e.args[0]))}function gV(e,t,n){switch(e){case\"+\":return $L(t,n);case\"-\":return YL(t,n);case\"*\":return ZL(t,n);case\"\\\\cdot\":return XL(t,n);case\"\\\\times\":return WL(t,n);case\"/\":return jL(t,n);case\"~\":return UL(t,n);case\":\":return pF(t,n);case\".\":switch(n[0].type){case\"Decimal\":case\"MixedNumber\":throw $g();default:return fF(t,n)}case\"->\":return gF(t,n);case\"for\":return mF(t,n);case\"with\":return dF(t,n);default:throw`Unexpected token type ${e}.`}}function xV(e,t){if(!e.sub)return;let n=e.sub,r=dl(lc(n,t));return r.type===\"Err\"&&r.error.type===\"EmptyGroup\"?Le(r.span,lD()):r}function TV(e){if(!e.sub)return;let t=e.sub;if(t.args.length===0)return Le(t.span,lD());let n=[];for(let r of t.args)if(r.type===\"Digit\"||r.type===\"Letter\")n.push(r.val);else{let s=r.span;return Le(s,JF(pr(s)))}return bF(t.span,n.join(\"\"))}function lT(e,t){if(!e.sup)return;let n=dl(lc(e.sup,t));return n.type===\"Err\"?n.error.type===\"EmptyGroup\"?Le(n.span,zF()):n:e.nprimes>0?Le(e.span,eV()):n}function xD(e,t,n){if(e.type!==\"SupSub\"){let o=Ee(t,n);return Le(o,hD())}if(e.nprimes>0){let o=Ee(t,n);return Le(o,cT())}let r=xV(e,n.opts),s=lT(e,n.opts);if(!r||r.type===\"Err\"&&r.error.type===\"EmptySubscript\"||!s||s.type===\"Err\"&&s.error.type===\"EmptySuperscript\"){let o=Ee(t,n);return Le(o,hD())}return r.type===\"Err\"?r:s.type===\"Err\"?s:{type:\"Bounds\",sup:s,sub:r}}function ky(e){if(e.opts.disableParentheses)throw zS();let t=e,n=hs(e),r=ID(n.type);if(es(e,\"(\"))e=ze(e);else throw new Error(\"Programming Error: expected '(' at start of parseParen.\");if(es(e,\")\")){let o=tT(sD(e),[]);e=ze(e);let i=Ee(t,e);return B(e,Qv(i,[o]))}let s;return{state:e,tree:s}=Pr(e,r),{state:e,tree:s}=$y(t,e,s,\"(\",\")\"),s.type===\"Err\"?B(e,s):B(e,Qv(Ee(t,e),[s]))}function hV(e){let t=e,n=hs(e);if(n.type!==\"Differential\")throw new Error(\"Programming Error: expected differential\");e=ze(e);let r=Pp(n.span,n.val),s=hs(e);if(s.type===\"SupSub\"){e=ze(e);let o=Ee(t,e),i=TV(s);if(i){if(i.type===\"Err\")return B(e,i);r=eD(o,[r,i])}if(s.sup)return B(e,Le(o,cV()));if(s.nprimes>0)return B(e,Le(o,cT()))}return B(e,r)}function $y(e,t,n,r,s){if(n.type===\"Err\"&&n.error.type!==\"UnexpectedEnd\")return B(t,n);if(n.type===\"Err\"||!es(t,s)){let o=Ee(e,t),i=Le(o,XF(r,s));return B(t,i)}return t=ze(t),B(t,n)}function PD(e){let t=e;switch(hs(e).type){case\")\":{e=ze(e);let r=Ee(t,e);return B(e,Le(r,zy(\"(\",\")\")))}case\"]\":{e=ze(e);let r=Ee(t,e);return B(e,Le(r,zy(\"[\",\"]\")))}case\"\\\\}\":{e=ze(e);let r=Ee(t,e);return B(e,Le(r,zy(\"\\\\{\",\"\\\\}\")))}case\"|)\":{e=ze(e);let r=Ee(t,e);return B(e,Le(r,zy(\"|\",\"|\")))}case\"Differential\":{e=ze(e);let r=Ee(t,e);return B(e,Le(r,WF()))}default:{e=ze(e);let r=Ee(t,e);return B(e,Le(r,HF()))}}}function dY(e){return es(e,\")\")||es(e,\"]\")||es(e,\"\\\\}\")}function fl(e,t){return po(e.token.span,t.prevSpan)}function Hu(e,t,n){return{type:e,span:t,val:n}}function fY(e,t,n,r){return{input:e,prevSpan:t,pos:n,token:r}}function IV(e){return PV(e,0,Ca(e,0))}function PV(e,t,n){for(;BL(e.charCodeAt(t));)t+=1;let r=gY(e,t);return fY(e,n,t,r)}function fa(e){return PV(e.input,e.token.span.end,e.token.span)}function Wa(e){return e.token}function ja(e,t){if(Wa(e).type!==t)throw`Parse Error: expected ${t}.`;return fa(e)}function ED(e,t){return Wa(e).type===t}function pT(e){return e.pos>=e.input.length}var yY={\"[\":\"[\",\"]\":\"]\",\"{\":\"{\",\"}\":\"}\",\"^\":\"^\",_:\"_\"};function gY(e,t){let n=t;if(t>=e.length)return Hu(\"End\",Ca(e,t),\"\");let r=e.charCodeAt(t);if(VL(r)){let s=lo(e,n,t+1);return Hu(\"Digit\",s,e.charAt(n))}else if(Qx(r)){let s=lo(e,n,t+1);return Hu(\"Letter\",s,e.charAt(n))}else if(Kx(r))if(t+=1,Qx(e.charCodeAt(t))){for(;Qx(e.charCodeAt(t));)t+=1;let s=lo(e,n,t),o=pr(s);return Hu(o===\"\\\\left\"?\"Left\":o===\"\\\\right\"?\"Right\":\"Cmd\",s,o)}else{t+=1;let s=lo(e,n,t),o=pr(s);return Hu(\"EscapedSymbol\",s,o)}else if(jv(r)){for(t+=1;jv(e.charCodeAt(t));)t+=1;if(e.charAt(t)===\"^\"){t+=1;let s=lo(e,n,t),o=pr(s);return Hu(\"Primes^\",s,o)}else{let s=lo(e,n,t),o=pr(s);return Hu(\"Primes\",s,o)}}else{let s=lo(e,n,t+1),o=e.charAt(n),i=yY[o]||\"Symbol\";return Hu(i,s,o)}}function SD(e,t){return{type:\"Group\",span:e,args:t}}function EV(e,t,n){return{type:\"Sqrt\",span:e,optArg:t,arg:n}}function SV(e,t,n){return{type:\"Frac\",span:e,num:t,den:n}}function MV(e,t,n,r){return{type:\"SupSub\",span:e,sup:t,sub:n,nprimes:r}}function CV(e,t,n,r){return{type:\"LeftRight\",span:e,left:t,right:n,arg:r}}function vV(e,t){return{type:\"OperatorName\",span:e,arg:t}}function DV(e,t){return{type:\"TokenNode\",span:e,arg:t}}function NV(e,t){return{type:\"Symbol\",span:e,val:t}}var MD={type:\"primitive\",errorName:\"^\"},RV={type:\"primitive\",errorName:\"_\"},bY={\"\\\\frac\":{type:\"macro\",errorName:\"\\\\frac\",expandsToSingleAtom:!0},\"\\\\operatorname\":{type:\"macro\",errorName:\"\\\\operatorname\",expandsToSingleAtom:!1},\"\\\\token\":{type:\"macro\",errorName:\"\\\\token\",expandsToSingleAtom:!1}};function OV(e){let t=Wa(e);if(t.type===\"Cmd\")return t.val===\"\\\\sqrt\"?ED(fa(e),\"[\")?{type:\"macro\",errorName:\"\\\\sqrt[*]\",expandsToSingleAtom:!1}:{type:\"primitive\",errorName:\"\\\\sqrt\"}:bY[t.val];if(t.type===\"^\"||t.type===\"Primes^\")return MD;if(t.type===\"_\")return RV}function AV(e){let{state:t,tree:n}=mT(IV(e),!1);if(!pT(t))throw`Parse error: unexpected ${pr(Wa(t).span)}.`;return n}function Vi(e,t){return{state:e,tree:t}}function mT(e,t){let n=e,r=[];e:for(;!pT(e);){let o=Wa(e);switch(o.type){case\"Cmd\":case\"EscapedSymbol\":case\"Letter\":case\"Digit\":case\"Symbol\":case\"[\":case\"{\":case\"^\":case\"_\":case\"Primes\":case\"Primes^\":case\"Left\":case\"]\":{if(o.type===\"]\"&&t)break e;let a;if({state:e,tree:a}=_V(e),a.type===\"Group\")for(let u of a.args)r.push(u);else r.push(a);break}case\"}\":case\"Right\":case\"End\":break e;default:throw`Unexpected token type ${o.type}.`}}let s=fl(n,e);return Vi(e,SD(s,r))}function _V(e){let t=Wa(e);switch(t.type){case\"EscapedSymbol\":case\"Letter\":case\"Digit\":case\"Symbol\":return e=fa(e),Vi(e,t);case\"[\":case\"]\":return e=fa(e),Vi(e,NV(t.span,t.val));case\"{\":{e=fa(e);let r;return{state:e,tree:r}=mT(e,!1),e=ja(e,\"}\"),Vi(e,r)}case\"^\":case\"_\":case\"Primes\":case\"Primes^\":return MY(e);case\"Left\":return SY(e);case\"Cmd\":return xY(e);case\"}\":case\"Right\":throw`Parse Error: unexpected ${t.val}.`;case\"End\":throw\"Parse Error: unexpected end.\";default:throw`Unexpected token type ${t.type}.`}}function xY(e){let t=OV(e),n=Wa(e);if(!t)return e=ja(e,\"Cmd\"),Vi(e,n);switch(n.val){case\"\\\\operatorname\":return TY(e,t);case\"\\\\token\":return IY(e,t);case\"\\\\sqrt\":return PY(e,t);case\"\\\\frac\":return EY(e,t);default:throw new Error(`Unexpected command ${n.val}.`)}}function TY(e,t){let n=e;e=ja(e,\"Cmd\");let r;({state:e,tree:r}=yl(e,t));let s=fl(n,e);return Vi(e,vV(s,r))}function IY(e,t){let n=e;e=ja(e,\"Cmd\");let r;({state:e,tree:r}=yl(e,t));let s=fl(n,e);return Vi(e,DV(s,r))}function PY(e,t){let n=e;e=ja(e,\"Cmd\");let r;ED(e,\"[\")&&({state:e,tree:r}=CY(e));let s;({state:e,tree:s}=yl(e,t));let o=fl(n,e);return Vi(e,EV(o,r,s))}function EY(e,t){let n=e;e=ja(e,\"Cmd\");let r;({state:e,tree:r}=yl(e,t));let s;({state:e,tree:s}=yl(e,t));let o=fl(n,e);return Vi(e,SV(o,r,s))}function SY(e){let t=e;e=ja(e,\"Left\");let n=Wa(e);e=fa(e);let r;({state:e,tree:r}=mT(e,!1)),e=ja(e,\"Right\");let s=Wa(e);e=fa(e);let o=fl(t,e);return Vi(e,CV(o,n,s,r))}function MY(e){let t=e,n,r,s=0;e:for(;!pT(e);){let i=Wa(e);switch(i.type){case\"^\":if(e=fa(e),n)throw\"Parse Error: double superscript.\";({state:e,tree:n}=yl(e,MD));break;case\"_\":if(e=fa(e),r)throw\"Parse Error: double subscript.\";({state:e,tree:r}=yl(e,RV));break;case\"Primes\":if(e=fa(e),s>0)throw\"Parse Error: double primes.\";s=i.val.length;break;case\"Primes^\":if(e=fa(e),s>0)throw\"Parse Error: double primes.\";if(n)throw\"Parse Error: double superscript\";s=i.val.length-1,{state:e,tree:n}=yl(e,MD);break;default:break e}}let o=fl(t,e);return Vi(e,MV(o,n,r,s))}function yl(e,t){let n,r=OV(e);if(r&&(t.type!==\"primitive\"||!(r.type===\"macro\"&&r.expandsToSingleAtom)))throw`Parse Error: can't use ${r.errorName} as argument of ${t.errorName}. Use {}.`;return{state:e,tree:n}=_V(e),n.type!==\"Group\"&&(n=SD(n.span,[n])),Vi(e,n)}function CY(e){e=ja(e,\"[\");let t;return{state:e,tree:t}=mT(e,!0),e=ja(e,\"]\"),Vi(e,t)}function vY(){throw vf()}function wV(e,t){return t&&!e._inputSpan&&e.setInputSpan(t),e}function dT(e){try{let t=Uo(e);return t instanceof Ve?t:V(\"TODO-jared-module: expected an identifer here.\")}catch(t){return V(t)}}function Uo(e,t={}){let n=typeof e;if(n!==\"string\")throw new Error(`Type Error: parse can only be called with strings, got ${JSON.stringify(e)} of type ${n}`);let r=A;if(t.disabledFeatures){r=Object.create(r);for(let c of t.disabledFeatures){if(!r[c])throw new Error(`Programming Error: ${c} cannot be disabled because it is not a parsenode.`);r[c]=vY}}let s=t.seedPrefix===void 0?\"\":t.seedPrefix,o=0,i=()=>{let c=`${s}::vc${o}`;return o+=1,c},a={};t.trailingComma!==void 0&&(a.trailingComma=t.trailingComma),t.disallowFrac&&(a.disallowFrac=!0),t.disableParentheses&&(a.disableParentheses=!0);function u(c){return c.parseOptions=t,c}if(e===\"\")return u(hf());try{let c=AV(e),p=bV(c,a),l=AF({...t,nodes:r,setInput:wV,nextSeed:i},p);return l.parseOptions=t,l}catch(c){let p;return c instanceof A.Error?p=c:typeof c==\"string\"?p=new A.Error(c):p=V(c),u(p)}}var NY=[\"Sum\",\"Product\",\"Integral\",\"List\",\"Derivative\",\"Piecewise\",\"Restriction\",\"Norm\",\"Exponent\",\"PercentOf\",\"FunctionDefinition\",\"UpdateRule\",\"Substitution\",\"ListComprehension\"],RY={isGeometryEnabled(){return!1},is3dProduct(){return!1},is3dPolicy(){return!1},polygonUnsupportedPreferTriangle(){return!1},areAllScalesLinear(){return!0},assignmentForbidden(e){return!0},graphingEnabled(){return!1},isValidSlider(e){return!1},sliderVariables(e){return[]},ansEnabled(){return!1},disabledFeatures(){return NY},dimensionVarsEnabled(){return!1},shouldIncludeFunctionParametersInRandomSeed(){return!0},isComplexEnabled(){return!1},isRecursionEnabled(){return!1},isNewStatsEnabled(){return!1}},LV={...RY,isGeometryEnabled(){return!0},is3dProduct(){return!0},is3dPolicy(){return!0},isComplexEnabled(){return!1}};var Md=class e{constructor(t,n,r,s,o){this.frame=t;this.dynamic=n;this.lexical=r;this.maxBindingIndex=s;this.compiledGlobalCache=o}static empty(t){return new e(t,{},{},-1,{maxIndex:-1,entries:{}})}resolve(t){if(this.lexical[t])return this.lexical[t];if(this.dynamic[t])return this.dynamic[t];if(this.compiledGlobalCache.entries[t])return this.compiledGlobalCache.entries[t]}getSymbol(t){let n=this.resolve(t);if(n)switch(n.type){case\"lexical\":case\"dynamic\":case\"free\":return n.value;case\"global\":return n.value;case\"error\":throw n.error;default:throw new Error(\"Unexpected symbolMap entry type: \"+n.type)}}getMaxIndex(){return Math.max(this.maxBindingIndex,this.compiledGlobalCache.maxIndex)}getParseNode(t){let n=this.resolve(t);if(n)switch(n.type){case\"global\":case\"lexical\":case\"dynamic\":return n.node;case\"error\":case\"free\":return;default:throw new Error(\"Unexpected symbolMap entry type: \"+n.type)}}addLexicalBinding(t,n,r){this.addScopeEntry(t,{type:\"lexical\",value:n,node:r})}addDynamicBinding(t,n,r){this.addScopeEntry(t,{type:\"dynamic\",value:n,node:r})}cacheGlobal(t,n,r){this.compiledGlobalCache.entries[t]={type:\"global\",value:n,node:r},this.compiledGlobalCache.maxIndex=Math.max(this.compiledGlobalCache.maxIndex,n)}setFreeVariable(t,n){this.addScopeEntry(t,{type:\"free\",value:n})}setErrorIfAccessed(t,n){this.addScopeEntry(t,{type:\"error\",error:n})}addScopeEntry(t,n){var i;let r=this.lexical,s=this.dynamic,o;switch(n.type){case\"lexical\":{r[t]=n,this.frame[t]===void 0&&((i=this.dynamic[t])==null?void 0:i.type)!==\"dynamic\"?(s[t]=n,o=!0):o=!1;break}case\"dynamic\":{s[t]=n,r[t]={type:\"lexical\",value:n.value,node:n.node},o=!0;break}case\"error\":{s[t]=n,o=!0;break}case\"free\":{s[t]=n,o=!0;break}default:throw new Error(\"Unexpected symbolMap entry type: \"+n.type)}n.type!==\"error\"&&(this.maxBindingIndex=Math.max(this.maxBindingIndex,n.value)),o&&(this.compiledGlobalCache={maxIndex:-1,entries:{}})}isLocal(t){let n=this.resolve(t);return(n==null?void 0:n.type)===\"lexical\"||(n==null?void 0:n.type)===\"dynamic\"}isGlobal(t){return this.frame[t]!==void 0&&!this.isLocal(t)}isError(t){var r;let n=this.resolve(t);return n?n.type===\"error\":((r=this.frame[t])==null?void 0:r.type)===\"Error\"}isDefined(t){return this.isLocal(t)||this.isGlobal(t)}getVisibleGlobalDefinition(t){let n=this.resolve(t);if(!n)return FV(this.frame[t]);switch(n.type){case\"lexical\":case\"dynamic\":case\"free\":return;case\"global\":return FV(this.frame[t]);case\"error\":throw n.error;default:throw new Error(\"Unexpected symbolMap entry type: \"+n.type)}}childScope(){return new e(this.frame,On(this.dynamic),On(this.lexical),this.maxBindingIndex,this.compiledGlobalCache)}childScopeWithChildGlobalCache(){return new e(this.frame,On(this.dynamic),On(this.lexical),this.maxBindingIndex,{maxIndex:this.compiledGlobalCache.maxIndex,entries:On(this.compiledGlobalCache.entries)})}newLexicalScope(){return new e(this.frame,On(this.dynamic),{},this.maxBindingIndex,this.compiledGlobalCache)}newScopeAcrossModuleBoundary(t){let n=YR(this.frame).getFrame(t);return new e(n,On(this.dynamic),{},this.maxBindingIndex,{maxIndex:0,entries:{}})}};function FV(e){if((e==null?void 0:e.type)===\"Error\")throw e;return e}function pc(e,t,n,r){return gl({chunk:e,argMap:[t],start:n,unpatchedHeaderMap:new Map,processedHeaders:new Set},r)}function OY(e,t){let{chunk:n}=e,r=n.getInstruction(t),s=[];for(let o of r.recursionGroup){let i=e.unpatchedHeaderMap.get(o);if(i===void 0)throw new Error(\"Programming Error: `substitute` did not include all headers in a recursion group.\");s.push(i)}for(let o of r.recursionGroup)e.unpatchedHeaderMap.delete(o);for(let o of s)n.getInstruction(o).recursionGroup=s}function gl(e,t){let{chunk:n,argMap:r,start:s}=e;if(t<s)return t;let o=r[t-s];if(o!==void 0)return o;let i=AY(e,t);e.argMap[t-s]=i;let a=n.getInstruction(t);if(a.type===4){let u=i;e.unpatchedHeaderMap.set(t,u),e.processedHeaders.add(t);for(let c of a.recursionGroup)e.processedHeaders.has(c)||gl(e,c);return gl(e,a.endIndex),u}if(cs(a))switch(a.type){case 23:case 21:case 50:break;case 19:{let c=a.args.length-2;for(let p=0;p<c;p++)gl(e,t+1+p);break}case 53:{let p=n.getInstruction(a.args[0]).signature.argTypes.length;for(let l=0;l<p;l++)gl(e,t+1+l);break}default:let u=a;throw new Error(`Programming Error. Unexpected OpCode: ${u.type}`)}else if(Ib(a)){let u=a.args.length-1;for(let c=0;c<u;c++)gl(e,t+1+c)}return i}function AY(e,t){let{chunk:n,start:r}=e,s=n.getInstruction(t);if(Ss(s)){let a=s.args[0];for(let u=a;u<=t;u++){let c=n.getInstruction(u);if(ce(c))for(let p of c.args)p<a&&gl(e,p)}}if(s.type===4)return n.FunctionHeader(s.symbol,s.valueType,s.signature,s.parameterSymbols);if(!ce(s))return n.copyLeafInstruction(s);let o=[];for(let a of s.args)o.push(gl(e,a));let i=e.argMap[t-r];if(i!==void 0)return i;if(s.type===55&&!Sb(n,t)){let a=s.args[0];e.unpatchedHeaderMap.has(a)&&OY(e,a)}return n.copyInstructionWithArgs(s,o)}function yT(e,t,n,r){let s=pp(e,t),o=e.Constant(0);if(t<n)return o;let i=e.Constant(1),a=e.Constant(NaN),u=kc(e,n),c=OO(e,s),p=e.derivativeMaps.getMapEntry(e,r,n),{map:l,maxValidReference:m}=p;for(let x=0;x<l.length;x++){let T=l[x];T!==void 0&&T>m&&(l[x]=void 0)}let d=!1,y=e.instructionsLength()-1;for(let x=0;x<n;x++)l[x]=o;let g=new vs(e,n,y),f=Zr(e,s);return gT({chunk:e,derivativeVarIndex:n,forwardSeed:r,forwardMask:u,backwardMask:c,referenced:f,copyCtx:g,derivativeMap:l,mustCopy:d,ZERO:o,ONE:i,NAN:a},n,s),p.maxValidReference=e.instructionsLength()-1,l[s]}function gT(e,t,n){let{chunk:r,copyCtx:s,derivativeMap:o,backwardMask:i}=e;for(let a=t;a<=n;a++){let u=o[a];if(u!==void 0)if(r.getInstruction(u).type===0)o[a]=void 0;else{s.markMappedIndex(a,fT(e,a));continue}if(!i[a]){s.markMappedIndex(a,fT(e,a));continue}let c=r.getInstruction(a);if(cs(c)&&c.endIndex!==-1)switch(c.type){case 21:{a=_Y(e,a);continue}case 19:case 23:{a=FY(e,a);continue}case 53:{a=BY(e,a);continue}}s.markMappedIndex(a,fT(e,a)),o[a]=GY(e,a)}return n}function _Y(e,t){let{chunk:n,forwardMask:r,copyCtx:s,derivativeMap:o,ZERO:i}=e,a=n.getInstruction(t),u=a.endIndex,c=n.getInstruction(u),p=i;if(r[a.args[1]]){let l=s.mapIndex(a.args[1]);p=n.Add([p,n.Multiply([o[a.args[1]],pc(n,l,t,c.args[1])])])}if(r[a.args[0]]){let l=s.mapIndex(a.args[0]);p=n.Subtract([p,n.Multiply([o[a.args[0]],pc(n,l,t,c.args[1])])])}if(wY(n,t,r)){let l=s.clone(),m=n.copyInstructionWithArgs(a,l.mapArgs(a.args));l.markMappedIndex(t,m),o[t]=i,gT({...e,copyCtx:l,mustCopy:!0},t+1,u-1);let d=n.copyInstructionWithArgs(c,[l.mapIndex(c.args[0]),o[c.args[1]]]);o[u]=d,p=n.Add([p,n.copyInstructionWithArgs(n.getInstruction(u+1),[d])])}else for(let l=t;l<=u;l++)o[l]=i;if(LY(n,t,s)){let l={...e,mustCopy:!0};for(let m=t;m<=u+1;m++)s.markMappedIndex(m,fT(l,m))}else for(let l=t;l<=u+1;l++)s.markMappedIndex(l,l);return o[u+1]=p,u+c.args.length-1}function wY(e,t,n){let r=e.getInstruction(t),s=e.getInstruction(r.endIndex);if(s.args[1]<t+1)return n[s.args[1]];for(let o=t+1;o<=s.args[1];o++){let i=e.getInstruction(o);if(ce(i)){for(let a of i.args)if(a<t&&n[a])return!0}}return!1}function LY(e,t,n){let r=e.getInstruction(t);for(let s=t;s<=r.endIndex;s++){let o=e.getInstruction(s);if(ce(o)){for(let i of o.args)if(n.mapIndex(i)!==i)return!0}}return!1}function FY(e,t){let{chunk:n,derivativeMap:r,copyCtx:s,ZERO:o}=e,i=n.getInstruction(t),a=i.endIndex,u=n.getInstruction(a),c;if(i.type===23)s.markMappedIndex(t,n.copyInstructionWithArgs(i,[s.mapIndex(i.args[0])])),r[t]=o,c=t+1;else{let l=[];l.push(s.mapIndex(i.args[0]),s.mapIndex(i.args[1]));for(let m=2;m<i.args.length;m++)l.push(s.mapIndex(i.args[m]),r[i.args[m]]);s.markMappedIndex(t,n.copyInstructionWithArgs(i,l)),r[t]=o;for(let m=2;m<i.args.length;m++){let d=t+m-1;s.markMappedIndex(d,n.copyInstructionWithArgs(n.getInstruction(d),[s.mapIndex(t)])),r[d]=n.copyInstructionWithArgs(n.getInstruction(d),[s.mapIndex(t)])}c=t+i.args.length-1}gT({...e,mustCopy:!0},c,a-1);let p=[];p.push(s.mapIndex(u.args[0]));for(let l=1;l<u.args.length;l++)p.push(s.mapIndex(u.args[l]),r[u.args[l]]);s.markMappedIndex(a,n.copyInstructionWithArgs(u,p)),r[a]=o;for(let l=1;l<u.args.length;l++){let m=a+l;s.markMappedIndex(m,n.copyInstructionWithArgs(n.getInstruction(m),[s.mapIndex(a)])),r[m]=n.copyInstructionWithArgs(n.getInstruction(m),[s.mapIndex(a)])}return a+u.args.length-1}function fT(e,t){let{chunk:n,copyCtx:r,mustCopy:s,referenced:o}=e;if(!o[t])return t;let i=n.getInstruction(t);if(ce(i)){let a=[],u=!1;for(let c of i.args){let p=r.mapIndex(c);a.push(p),p!==c&&(u=!0)}return u||s?n.copyInstructionWithArgs(i,a):t}else return s?r.copyLeafOrFunctionHeader(i):t}function VY(e,t){let{chunk:n,derivativeMap:r}=e,s=n.getInstruction(t),o=[],i=s.recursionGroup;for(let a of i){let u=n.getInstruction(a),c={argTypes:[]};for(let l of u.signature.argTypes)c.argTypes.push(l,l);let p=r[a];p||(p=n.FunctionHeader(u.symbol+`_\\u2202${e.derivativeVarIndex}`,u.valueType,c,u.parameterSymbols),o.push(p)),e.derivativeMap[a]=p}for(let a of o){let u=n.getInstruction(a);u.recursionGroup=o}return e.derivativeMap[t]}function BY(e,t){let{chunk:n,copyCtx:r,derivativeMap:s}=e,i=n.getInstruction(t).args[0],a=n.getInstruction(i),u=a.endIndex,p=n.getInstruction(u).args[1],l=s[i],m=n.BeginFunction([l]);s[t]=m;let d=a.signature.argTypes,y=[];for(let T=0;T<d.length;T++){let P=d[T],M=t+T+1;y.push(M);let S=n.BlockVar(P,[m]),E=n.BlockVar(P,[m]);r.markMappedIndex(M,S),s[M]=E}let g=t+d.length+1,f=u-1,h=Su(n,y,g,f),x=r.clone();return x.markMappedIndex(i,i),gT({...e,copyCtx:x,mustCopy:!0,forwardMask:h},g,f),n.EndFunction([m,s[p]]),u}function GY(e,t){let{chunk:n,derivativeVarIndex:r,forwardSeed:s,forwardMask:o,copyCtx:i,derivativeMap:a,ZERO:u,ONE:c,NAN:p}=e,l=n.getInstruction(t);if(t===r){let d;switch(s){case\"real\":d=c;break;case\"complexOne\":d=n.NativeFunction(\"complex\",[c,u]);break;case\"complexI\":d=n.NativeFunction(\"complex\",[u,c]);break}if($(l.valueType)){let y=dr(n,t),g=n.BeginBroadcast([y]),f=n.EndBroadcast([g,d]);return n.BroadcastResult(l.valueType,[f])}else return d}if(cs(l)||Ss(l)||l.type===47||l.type===48||l.type===25||l.type===27||l.type===26||l.type===29||l.type===28||l.type===32||l.type===31||l.type===42||l.type===44||l.type===49||l.valueType===Pt)return u;if(l.type===4)return VY(e,t);if(!o[t]||NO(l))return l.valueType!==b?qY(n,[i.mapIndex(t),u]):l.type!==1||isFinite(w(l.value))?u:p;if(l.type===38||l.type===15){let d=[];for(let y of l.args)d.push(a[y]);return n.copyInstructionWithArgs(l,d)}if(l.type===33)return n.copyInstructionWithArgs(l,[i.mapIndex(l.args[0]),a[l.args[1]],a[l.args[2]]]);if(l.type===55){let d=n.getInstruction(l.args[0]);if(d.endIndex===-1)throw MP(d.symbol);let g=[a[l.args[0]]];for(let f of l.args.slice(1)){g.push(i.mapIndex(f));let h=a[f];if(h===u){let x=n.getInstruction(f).valueType;jR(x)&&(h=n.ZeroOfType(x))}g.push(h)}return n.FunctionCall(g)}let m=u;for(let d=0;d<l.args.length;d++){if(!o[l.args[d]])continue;let y=a[l.args[d]];if(y===u)continue;let g=HY(e,i.mapIndex(t),d,y);g!==u&&(m=m===u?g:UY(n,[g,m]))}return m}function HY(e,t,n,r){let{chunk:s,ZERO:o,ONE:i,NAN:a}=e,u=s.getInstruction(t);switch(u.type){case 8:return r;case 9:switch(n){case 0:return r;default:return s.Negative([r])}case 10:switch(n){case 0:return s.Multiply([r,u.args[1]]);default:return s.Multiply([u.args[0],r])}case 11:switch(n){case 0:return s.Divide([r,u.args[1]]);default:return s.Multiply([u.args[0],s.Divide([s.Negative([r]),s.Square([u.args[1]])])])}case 14:return s.Negative([r]);case 56:return s.Multiply([s.Constant(2),s.Multiply([u.args[0],r])]);case 12:case 13:switch(n){case 0:return s.Multiply([s.Multiply([u.args[1],s.Exponent([u.args[0],s.Subtract([u.args[1],i])])]),r]);default:return s.Multiply([s.Piecewise([s.Equal([u.args[0],o]),s.Piecewise([s.GreaterEqual([u.args[1],o]),o,a]),s.Multiply([s.NativeFunction(\"ln\",[u.args[0]]),t])]),r])}case 37:return zY(s,t,BV[u.symbol][n],r);case 39:case 40:case 41:switch(n){case 0:return s.copyInstructionWithArgs(u,[r,u.args[1]]);default:return o}case 16:return s.copyInstructionWithArgs(u,[r]);default:{let c=u;throw new Error(`Unimplemented derivative for opcode ${c.type}`)}}}function qY(e,t){switch(e.getInstruction(t[0]).valueType){case Ie:return e.NativeFunction(\"scaleTangentSegment\",t);case Pe:return e.NativeFunction(\"scaleTangentLine\",t);case De:return e.NativeFunction(\"scaleTangentRay\",t);case pe:return e.NativeFunction(\"scaleTangentCircle\",t);case ae:return e.NativeFunction(\"scaleTangentArc\",t);case ve:return e.NativeFunction(\"scaleTangentUndirectedAngleMarker\",t);case Te:return e.NativeFunction(\"scaleTangentDirectedAngleMarker\",t);case Se:return e.NativeFunction(\"scaleTangentPolygon\",t);case Ne:return e.NativeFunction(\"scaleTangentTransformation\",t);default:return e.Multiply(t)}}function UY(e,t){switch(e.getInstruction(t[0]).valueType){case Ie:return e.NativeFunction(\"addTangentSegment\",t);case Jt:return e.NativeFunction(\"addTangentSegmentThreeD\",t);case Pe:return e.NativeFunction(\"addTangentLine\",t);case De:return e.NativeFunction(\"addTangentRay\",t);case ye:return e.NativeFunction(\"addTangentVector\",t);case pe:return e.NativeFunction(\"addTangentCircle\",t);case ae:return e.NativeFunction(\"addTangentArc\",t);case ve:return e.NativeFunction(\"addTangentUndirectedAngleMarker\",t);case Te:return e.NativeFunction(\"addTangentDirectedAngleMarker\",t);case Se:return e.NativeFunction(\"addTangentPolygon\",t);case Ne:return e.NativeFunction(\"addTangentTransformation\",t);default:return e.Add(t)}}function zY(e,t,n,r){let s=Md.empty(rt),i=e.getInstruction(t).args;for(let a=0;a<i.length;a++){let u=kY[a];s.addLexicalBinding(u,i[a])}return s.addLexicalBinding(\"x_1\",r),s.addLexicalBinding(\"q\",t),Me(CD(LV,e,s,Yy.root,void 0,void 0),n)}var kY=[\"x\",\"y\",\"z\",\"u\",\"v\"],VV={exp:[\"q*x_1\"],complexExp:[\"q*x_1\"],ln:[\"\\\\{x >= 0: x_1/x \\\\}\"],complexLn:[\"x_1/x\"],log:[\"\\\\{x >= 0: x_1/(x*\\\\ln(10)) \\\\}\"],complexLog:[\"x_1/(x*\\\\ln(10))\"],sqrt:[\"x_1/(2*q)\"],complexSqrt:[\"x_1/(2*q)\"],complexPow:[\"y*\\\\complexPow(x,y-1)*x_1\",\"q*\\\\complexLn(x)*x_1\"],rtxsqpone:[\"x*x_1/q\"],rtxsqmone:[\"x*x_1/q\"],sin:[\"\\\\cos(x)*x_1\"],complexSin:[\"\\\\cos(x)*x_1\"],cos:[\"-\\\\sin(x)*x_1\"],complexCos:[\"-\\\\sin(x)*x_1\"],tan:[\"(1+q^2)*x_1\"],complexTan:[\"(s*s)*x_1 \\\\with s=\\\\sec(x)\"],arcsin:[\"x_1/\\\\sqrt{1 - x^2}\"],complexArcsin:[\"x_1/(\\\\complexSqrt(1+x)\\\\complexSqrt(1-x))\"],arccos:[\"-x_1/\\\\sqrt{1 - x^2}\"],complexArccos:[\"-x_1/(\\\\complexSqrt(1+x)\\\\complexSqrt(1-x))\"],sinh:[\"\\\\cosh(x)*x_1\"],complexSinh:[\"\\\\cosh(x)*x_1\"],cosh:[\"\\\\sinh(x)*x_1\"],complexCosh:[\"\\\\sinh(x)*x_1\"],tanh:[\"(\\\\sech(x))^2*x_1\"],complexTanh:[\"(s*s)*x_1 \\\\with s=\\\\sech(x)\"],arcsinh:[\"x_1/\\\\rtxsqpone(x)\"],complexArcsinh:[\"x_1/(\\\\complexSqrt(1+\\\\complex(0,1)x)\\\\complexSqrt(1-\\\\complex(0,1)x))\"],arccosh:[\"\\\\{ x > 0: x_1/\\\\rtxsqmone(x) \\\\}\"],complexArccosh:[\"x_1/(\\\\complexSqrt(x+1)\\\\complexSqrt(x-1))\"],arctanh:[\"\\\\{ \\\\abs(x) < 1: x_1/(1 - x^2) \\\\}\"],complexArctanh:[\"x_1/((1+x)(1-x))\"],csc:[\"-\\\\cot(x)*q*x_1\"],complexCsc:[\"-\\\\cot(x)*q*x_1\"],sec:[\"\\\\tan(x)*q*x_1\"],complexSec:[\"\\\\tan(x)*q*x_1\"],cot:[\"-(1+q^2)*x_1\"],complexCot:[\"-(c*c)*x_1 \\\\with c=\\\\csc(x)\"],arccsc:[\"-x_1/(\\\\abs(x)*\\\\rtxsqmone(x))\"],complexArccsc:[\"-x_1/((x\\\\complexSqrt(1-1/x))(x\\\\complexSqrt(1+1/x)))\"],arcsec:[\"x_1/(\\\\abs(x)*\\\\rtxsqmone(x))\"],complexArcsec:[\"x_1/((x\\\\complexSqrt(1-1/x))(x\\\\complexSqrt(1+1/x)))\"],arccot:[\"-x_1/(1+x^2)\"],complexArccot:[\"-x_1/((x+\\\\complex(0,1))(x-\\\\complex(0,1)))\"],csch:[\"-\\\\coth(x)*q*x_1\"],complexCsch:[\"-\\\\coth(x)*q*x_1\"],sech:[\"-\\\\tanh(x)*q*x_1\"],complexSech:[\"-\\\\tanh(x)*q*x_1\"],coth:[\"-(\\\\csch(x))^2*x_1\"],complexCoth:[\"-(c*c)*x_1 \\\\with c=\\\\csch(x)\"],arccsch:[\"-x_1/(\\\\abs(x)*\\\\rtxsqpone(x))\"],complexArccsch:[\"-x_1/((x\\\\complexSqrt(1+\\\\complex(0,1)/x))(x\\\\complexSqrt(1-\\\\complex(0,1)/x)))\"],arcsech:[\"\\\\{ x >= 0: -x_1/(x*\\\\sqrt{1 - x^2}) \\\\}\"],complexArcsech:[\"-x_1/((x\\\\complexSqrt((1-x)/(1+x)))(1+x))\"],arccoth:[\"\\\\{ \\\\abs(x) > 1 : x_1/(1 - x^2) \\\\}\"],complexArccoth:[\"x_1/((1+x)(1-x))\"],factorial:[\"q*\\\\polyGamma(0, x + 1)*x_1\"],floor:[\"\\\\{ q=x: 0/0, 0*x_1 \\\\}\"],complexFloor:[\"\\\\{ \\\\real(d) + \\\\imag(d) = 0: 0/0, \\\\imag(d) - \\\\real(d) = 1: 0/0, 0*x_1 \\\\} \\\\with d = x - q\"],ceil:[\"\\\\{ q=x: 0/0, 0*x_1 \\\\}\"],complexCeil:[\"\\\\{ \\\\real(d) + \\\\imag(d) = 0: 0/0, \\\\imag(d) - \\\\real(d) = -1: 0/0, 0*x_1 \\\\} \\\\with d = x - q\"],round:[\"\\\\{ \\\\abs(\\\\mod(x, 1) - 0.5) > 0: 0*x_1 \\\\}\"],complexRound:[\"\\\\{ \\\\real(q) - \\\\real(x) = 0.5: 0/0, \\\\imag(q) - \\\\imag(x) = 0.5: 0/0, 0*x_1 \\\\}\"],abs:[\"\\\\{ x=0: 0/0, \\\\sign(x)*x_1 \\\\}\"],sign:[\"\\\\{ x=0: 0/0, 0*x_1 \\\\}\"],distance:[\"-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q\",\"((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q\"],distanceThreeD:[\"-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q\",\"((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q\"],segmentThreeD:[\"\\\\segmentThreeD(x_1,(0,0,0))\",\"\\\\segmentThreeD((0,0,0),x_1)\"],vectorThreeD:[\"\\\\vectorThreeD(x_1,(0,0,0))\",\"\\\\vectorThreeD((0,0,0),x_1)\"],triangle:[\"\\\\triangle(x_1,(0,0,0),(0,0,0))\",\"\\\\triangle((0,0,0),x_1,(0,0,0))\",\"\\\\triangle((0,0,0),(0,0,0),x_1)\"],sphere:[\"\\\\sphere(x_1,0)\",\"\\\\sphere((0,0,0),x_1)\"],pointDet:[\"\\\\pointDet(x_1,y)\",\"\\\\pointDet(x,x_1)\"],pointDot:[\"\\\\pointDot(x_1,y)\",\"\\\\pointDot(x,x_1)\"],pointPerp:[\"\\\\pointPerp(x_1)\"],complexMultiplyPoints:[\"\\\\complexMultiplyPoints(x_1,y)\",\"\\\\complexMultiplyPoints(x,x_1)\"],segment:[\"\\\\segment(x_1,(0,0))\",\"\\\\segment((0,0),x_1)\"],line:[\"\\\\line(x_1,(0,0))\",\"\\\\line((0,0),x_1)\"],ray:[\"\\\\ray(x_1,(0,0))\",\"\\\\ray((0,0),x_1)\"],vector:[\"\\\\vector(x_1, (0,0))\",\"\\\\vector((0,0), x_1)\"],mathVector:[\"\\\\mathVector(x_1,(0,0))\",\"\\\\mathVector((0,0),x_1)\"],mathVectorThreeD:[\"\\\\mathVectorThreeD(x_1,(0,0,0))\",\"\\\\mathVectorThreeD((0,0,0),x_1)\"],rawTransform:[\"\\\\rawTransform(x_1,(0,0))\",\"\\\\rawTransform((0,0),x_1)\"],rawTransformConj:[\"\\\\rawTransformConj(x_1,(0,0))\",\"\\\\rawTransformConj((0,0),x_1)\"],transformWithoutTranslation:[\"\\\\transformWithoutTranslation(x_1)\"],transformScaleFactor:[\"\\\\transformScaleFactor(x_1)\"],vectorDisplacementAsPoint:[\"\\\\vectorDisplacementAsPoint(x_1)\"],vectorThreeDDisplacementAsPoint:[\"\\\\vectorThreeDDisplacementAsPoint(x_1)\"],basePointFromVector:[\"\\\\basePointFromVector(x_1)\"],basePointFromVectorThreeD:[\"\\\\basePointFromVectorThreeD(x_1)\"],circle:[\"\\\\circle(x_1,0)\",\"\\\\circle((0,0),x_1)\"],arc:[\"\\\\arc(x_1,(0,0),(0,0))\",\"\\\\arc((0,0),x_1,(0,0))\",\"\\\\arc((0,0),(0,0),x_1)\"],arcCenter:[\"(\\\\pointDot(q-p1,p1_1)\\\\pointPerp(v_2)+\\\\pointDot(q-p2,p2_1)\\\\pointPerp(v_3)+\\\\pointDot(q-p3,p3_1)\\\\pointPerp(v_1))/\\\\pointDet(v_2,v_1) \\\\with v_1=p2-p1,v_2=p3-p2,v_3=p1-p3\".replace(/p1_1/g,\"\\\\arcFirstPoint(x_1)\").replace(/p2_1/g,\"\\\\arcMiddlePoint(x_1)\").replace(/p3_1/g,\"\\\\arcThirdPoint(x_1)\").replace(/p1/g,\"\\\\arcFirstPoint(x)\").replace(/p2/g,\"\\\\arcMiddlePoint(x)\").replace(/p3/g,\"\\\\arcThirdPoint(x)\")],arcFirstPoint:[\"\\\\arcFirstPoint(x_1)\"],arcMiddlePoint:[\"\\\\arcMiddlePoint(x_1)\"],arcThirdPoint:[\"\\\\arcThirdPoint(x_1)\"],arcOmega:[\"2 * (X_1*Y/(Y*Y+X*X) - Y_1*X/(Y*Y+X*X))\".replace(/X_1/g,\"((v1x * v2y_1 + v1x_1 * v2y) - (v2x_1 * v1y + v2x * v1y_1))\").replace(/Y_1/g,\"((v1x * v2x_1 + v1x_1 * v2x) + (v1y_1 * v2y + v1y * v2y_1))\").replace(/X/g,\"(v1x * v2y - v2x * v1y)\").replace(/Y/g,\"(v1x * v2x + v1y * v2y)\").replace(/v1x_1/g,\"(\\\\arcMiddlePoint(x_1) - \\\\arcFirstPoint(x_1)).x\").replace(/v2x_1/g,\"(\\\\arcThirdPoint(x_1) - \\\\arcMiddlePoint(x_1)).x\").replace(/v1y_1/g,\"(\\\\arcMiddlePoint(x_1) - \\\\arcFirstPoint(x_1)).y\").replace(/v2y_1/g,\"(\\\\arcThirdPoint(x_1) - \\\\arcMiddlePoint(x_1)).y\").replace(/v1x/g,\"(\\\\arcMiddlePoint(x) - \\\\arcFirstPoint(x)).x\").replace(/v2x/g,\"(\\\\arcThirdPoint(x) - \\\\arcMiddlePoint(x)).x\").replace(/v1y/g,\"(\\\\arcMiddlePoint(x) - \\\\arcFirstPoint(x)).y\").replace(/v2y/g,\"(\\\\arcThirdPoint(x) - \\\\arcMiddlePoint(x)).y\")],center:[\"\\\\center(x_1)\"],radius:[\"\\\\radius(x_1)\"],undirectedAngleMarker:[\"\\\\undirectedAngleMarker(x_1)\"],directedAngleMarker:[\"\\\\directedAngleMarker(x_1,0,0,0)\",\"\\\\directedAngleMarker((0,0),x_1,0,0)\",\"\\\\directedAngleMarker((0,0),0,x_1,0)\",\"\\\\directedAngleMarker((0,0),0,0,x_1)\"],directedCoterminalAngle:[\"\\\\directedAngleMarker((0,0),0,\\\\directedAngleMarkerRawDelta(x_1),0)\"],undirectedCoterminalAngle:[\"\\\\undirectedAngleMarker(\\\\directedAngleMarker((0,0),0,\\\\undirectedAngleMarkerRawDelta(x_1),0))\"],supplement:[\"\\\\directedAngleMarker((0,0),0,-\\\\directedAngleMarkerRawDelta(x_1),0)\"],directedAngleMarkerMultiplier:[\"\\\\directedAngleMarkerMultiplier(x_1)\"],undirectedAngleMarkerMultiplier:[\"\\\\undirectedAngleMarkerMultiplier(x_1)\"],directedAngleMarkerRawDelta:[\"\\\\directedAngleMarkerRawDelta(x_1)\"],undirectedAngleMarkerRawDelta:[\"\\\\undirectedAngleMarkerRawDelta(x_1)\"],polygonInteriorUndirectedAngles:[\"\\\\polygonInteriorUndirectedAngles(x_1)\"],polygonInteriorDirectedAngles:[\"\\\\polygonInteriorDirectedAngles(x_1)\"],lineFromSegment:[\"\\\\lineFromSegment(x_1)\"],lineFromRay:[\"\\\\lineFromRay(x_1)\"],segmentGlider:[\"\\\\segmentGlider(x_1,y)\",\"\\\\{0<y<1:(\\\\segmentGlider(x,1)-\\\\segmentGlider(x,0))*x_1,(0,0)\\\\}\"],segmentThreeDGlider:[\"\\\\segmentThreeDGlider(x_1,y)\",\"\\\\{0<y<1:(\\\\segmentThreeDGlider(x,1)-\\\\segmentThreeDGlider(x,0))*x_1,(0,0,0)\\\\}\"],rayGlider:[\"\\\\rayGlider(x_1,y)\",\"\\\\{0<y:(\\\\rayGlider(x,1)-\\\\rayGlider(x,0))*x_1,(0,0)\\\\}\"],lineGlider:[\"\\\\lineGlider(x_1,y)\",\"(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))*x_1\"],circleGlider:[\"\\\\circleGlider(x_1,y)\",\"\\\\{0<y<1:2*\\\\pi*\\\\pointPerp(q-\\\\center(x))*x_1,(0,0)\\\\}\"],arcGlider:[\"(0/0,0/0)\",\"(0/0,0/0)\"],polygonEdgeByParameter:[\"\\\\polygonEdgeByParameter(x_1,y)\",\"\\\\{\\\\floor(y)=y:\\\\segment((0/0,0/0),(0/0,0/0)),\\\\segment((0,0),(0,0))\\\\}\"],polygonGlider:[\"\\\\polygonGlider(x_1,y)\",\"\\\\{y<0:(0,0),y>x.\\\\vertices.\\\\count:(0,0),\\\\floor(y)=y:(0/0,0/0),(x_1*(\\\\segmentGlider(s,1)-\\\\segmentGlider(s,0))\\\\with s=\\\\polygonEdgeByParameter(x,y))\\\\}\"],chooseNonIncidentPoint:[\"(0/0,0/0)\"],circleCircleIntersection:[\"(\\\\radius(x)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(x))))/\\\\pointDot(\\\\pointPerp(q-\\\\center(y)),q-\\\\center(x))*\\\\pointPerp(q-\\\\center(y))\",\"(\\\\radius(y)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(y))))/\\\\pointDot(\\\\pointPerp(q-\\\\center(x)),q-\\\\center(y))*\\\\pointPerp(q-\\\\center(x))\"],circleArcIntersection:[\"(0/0,0/0)\"],circleLineIntersection:[\"(\\\\radius(x)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(x))))/\\\\pointDot((\\\\lineGlider(y,1)-\\\\lineGlider(y,0)),q-\\\\center(x))*(\\\\lineGlider(y,1)-\\\\lineGlider(y,0))\",\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(y,1))+\\\\pointDet(\\\\lineGlider(y,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\pointPerp(q-\\\\center(x)),\\\\lineGlider(y,1)-\\\\lineGlider(y,0)))*(\\\\pointPerp(q-\\\\center(x)))\"],arcCircleIntersection:[\"(0/0,0/0)\"],arcArcIntersection:[\"(0/0,0/0)\"],arcLineIntersection:[\"(0/0,0/0)\"],lineCircleIntersection:[\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(x,1))+\\\\pointDet(\\\\lineGlider(x,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\pointPerp(q-\\\\center(y)),\\\\lineGlider(x,1)-\\\\lineGlider(x,0)))*(\\\\pointPerp(q-\\\\center(y)))\",\"(\\\\radius(y)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(y))))/\\\\pointDot((\\\\lineGlider(x,1)-\\\\lineGlider(x,0)),q-\\\\center(y))*(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))\"],lineArcIntersection:[\"(0/0,0/0)\"],lineLineIntersection:[\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(x,1))+\\\\pointDet(\\\\lineGlider(x,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\lineGlider(y,1)-\\\\lineGlider(y,0),\\\\lineGlider(x,1)-\\\\lineGlider(x,0)))*(\\\\lineGlider(y,1)-\\\\lineGlider(y,0))\",\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(y,1))+\\\\pointDet(\\\\lineGlider(y,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\lineGlider(x,1)-\\\\lineGlider(x,0),\\\\lineGlider(y,1)-\\\\lineGlider(y,0)))*(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))\"],parallel:[\"\\\\parallel(x_1,(0,0))\",\"\\\\parallel(\\\\line((0,0),(0,0)),x_1)\"],perpendicular:[\"\\\\perpendicular(x_1,(0,0))\",\"\\\\perpendicular(\\\\line((0,0),(0,0)),x_1)\"],angleVertex:[\"\\\\angleVertex(x_1)\"],angleStart:[\"\\\\angleStart(x_1)\"],directedAngleVertex:[\"\\\\directedAngleVertex(x_1)\"],directedAngleStart:[\"\\\\directedAngleStart(x_1)\"],anglebisector:[\"\\\\ray(\\\\angleVertex(x_1),\\\\angleVertex(x_1) + \\\\pointPerp( \\\\rayGlider(q,1) - \\\\angleVertex(x) ) * (s_1 + d_1 / 2)) \\\\with s_1 = \\\\angleStart(x_1), d_1 = \\\\undirectedAngleMarkerRawDelta(x_1)\"],directedanglebisector:[\"\\\\ray(\\\\directedAngleVertex(x_1),\\\\directedAngleVertex(x_1) + \\\\pointPerp( \\\\rayGlider(q,1) - \\\\directedAngleVertex(x) ) * (s_1 + d_1 / 2)) \\\\with s_1 = \\\\directedAngleStart(x_1), d_1 = \\\\directedAngleMarkerRawDelta(x_1)\"],scaleTangentTransformation:[\"\\\\scaleTangentTransformation(x_1, y)\",\"\\\\scaleTangentTransformation(x, x_1)\"],scaleTangentPolygon:[\"\\\\scaleTangentPolygon(x_1, y)\",\"\\\\scaleTangentPolygon(x, x_1)\"],scaleTangentSegment:[\"\\\\scaleTangentSegment(x_1, y)\",\"\\\\scaleTangentSegment(x, x_1)\"],scaleTangentLine:[\"\\\\scaleTangentLine(x_1, y)\",\"\\\\scaleTangentLine(x, x_1)\"],scaleTangentRay:[\"\\\\scaleTangentRay(x_1, y)\",\"\\\\scaleTangentRay(x, x_1)\"],scaleTangentCircle:[\"\\\\scaleTangentCircle(x_1, y)\",\"\\\\scaleTangentCircle(x, x_1)\"],scaleTangentArc:[\"\\\\scaleTangentArc(x_1, y)\",\"\\\\scaleTangentArc(x, x_1)\"],scaleTangentDirectedAngleMarker:[\"\\\\scaleTangentDirectedAngleMarker(x_1, y)\",\"\\\\scaleTangentDirectedAngleMarker(x, x_1)\"],scaleTangentUndirectedAngleMarker:[\"\\\\scaleTangentUndirectedAngleMarker(x_1, y)\",\"\\\\scaleTangentUndirectedAngleMarker(x, x_1)\"],addTangentPolygon:[\"x_1\",\"x_1\"],addTangentSegment:[\"x_1\",\"x_1\"],addTangentSegmentThreeD:[\"x_1\",\"x_1\"],addTangentLine:[\"x_1\",\"x_1\"],addTangentRay:[\"x_1\",\"x_1\"],addTangentVector:[\"x_1\",\"x_1\"],addTangentCircle:[\"x_1\",\"x_1\"],addTangentArc:[\"x_1\",\"x_1\"],addTangentDirectedAngleMarker:[\"x_1\",\"x_1\"],addTangentUndirectedAngleMarker:[\"x_1\",\"x_1\"],addTangentTransformation:[\"x_1\",\"x_1\"],translation:[\"\\\\rawTransform((0,0),x_1)\"],dilation:[\"\\\\rawTransform((0,0),(1-y)x_1)\",\"\\\\rawTransform((x_1,0),-x*x_1)\"],reflection:[\"\\\\rawTransformConj(a_1,p1_1-\\\\complexMultiplyPoints(a_1,(p1.x,-p1.y))-\\\\complexMultiplyPoints(qa,(p1_1.x,-p1_1.y)))\\\\with a_1=\\\\pointPerp(qa)*(\\\\pointDet(v,v_1)*2/(v.x^2+v.y^2))\".replace(/p1_1/g,\"\\\\glider(x_1,0)\").replace(/p1/g,\"\\\\glider(x,0)\").replace(/v_1/g,\"(\\\\glider(x_1,1)-\\\\glider(x_1,0))\").replace(/v/g,\"(\\\\glider(x,1)-\\\\glider(x,0))\").replace(/qa/g,\"\\\\transformScaleFactor(q)\")],rotation:[\"\\\\rawTransform((0,0),\\\\complexMultiplyPoints(p,x_1))\\\\with p=(1,0)-(\\\\cos(y),\\\\sin(y))\",\"\\\\rawTransform(p,\\\\complexMultiplyPoints(-p,x))\\\\with p=(-x_1*\\\\sin(y),x_1*\\\\cos(y))\"],compose:[\"\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))\",\"\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))\"],inverse:[\"\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))\"],transformPoint:[\"\\\\transformPoint(x_1,y)\",\"\\\\transformPoint(\\\\transformWithoutTranslation(x),x_1)\"],transformSegment:[\"\\\\transformSegment(x_1,y)\",\"\\\\transformSegment(\\\\transformWithoutTranslation(x),x_1)\"],transformVector:[\"\\\\transformVector(x_1,y)\",\"\\\\transformVector(\\\\transformWithoutTranslation(x),x_1)\"],transformLine:[\"\\\\transformLine(x_1,y)\",\"\\\\transformLine(\\\\transformWithoutTranslation(x),x_1)\"],transformRay:[\"\\\\transformRay(x_1,y)\",\"\\\\transformRay(\\\\transformWithoutTranslation(x),x_1)\"],transformCircle:[\"\\\\circle(\\\\transformPoint(x_1,y.\\\\center), y.\\\\radius * \\\\pointDot(a_1,a) / \\\\hypot(a.x,a.y))\\\\with a=\\\\transformScaleFactor(x),a_1=\\\\transformScaleFactor(x_1)\",\"\\\\transformCircle(\\\\transformWithoutTranslation(x),x_1)\"],transformArc:[\"\\\\transformArc(x_1,y)\",\"\\\\transformArc(\\\\transformWithoutTranslation(x),x_1)\"],transformPolygon:[\"\\\\transformPolygon(x_1,y)\",\"\\\\transformPolygon(\\\\transformWithoutTranslation(x),x_1)\"],transformAngleMarker:[\"\\\\angle((1,0),(0,0),(1,0))\",\"\\\\transformAngleMarker(\\\\transformWithoutTranslation(x),x_1)\"],transformDirectedAngleMarker:[\"\\\\directedangle((1,0),(0,0),(1,0))\",\"\\\\transformDirectedAngleMarker(\\\\transformWithoutTranslation(x),x_1)\"],mean:[\"\\\\mean(x_1)\"],total:[\"\\\\total(x_1)\"],count:[\"0\"],var:[\"2*\\\\cov(x, x_1)\"],varp:[\"2*\\\\cov(x, x_1)*(\\\\count(x)-1)/\\\\count(x)\"],stdev:[\"\\\\cov(x, x_1)/q\"],stdevp:[\"\\\\covp(x, x_1)/q\"],mad:[\"\\\\mean(\\\\sign(x-\\\\mean(x))*(x_1 - \\\\mean(x_1)))\"],listMin:[\"x_1[\\\\argmin(x)]\"],listMax:[\"x_1[\\\\argmax(x)]\"],min:[\"\\\\{x>y:0,x_1\\\\}\",\"\\\\{x<=y:0,x_1\\\\}\"],max:[\"\\\\{x<y:0,x_1\\\\}\",\"\\\\{x>=y:0,x_1\\\\}\"],median:[\"0.5*(x_1[\\\\lowerQuantileIndex(x, 0.5)] + x_1[\\\\upperQuantileIndex(x, 0.5)])\"],argmin:[\"0/0\"],argmax:[\"0/0\"],gcd:[\"0/0\"],complexGCD:[\"0/0\"],lcm:[\"0/0\"],complexLCM:[\"0/0\"],erf:[\"\\\\frac{2x_1}{\\\\sqrt{\\\\pi }}\\\\exp(-x^2)\"],invNorm:[\"\\\\frac{x_1}{\\\\pdf(\\\\normaldist(0,1),q)}\"],logbase:[\"\\\\{x > 0: \\\\frac{x_1}{x*\\\\ln(y)} \\\\}\",\"\\\\frac{-q*x_1}{y*\\\\ln(y)}\"],complexLogbase:[\"\\\\frac{x_1}{x*\\\\complexLn(y)}\",\"\\\\frac{-q*x_1}{y*\\\\complexLn(y)}\"],hypot:[\"x_1*x/q\",\"x_1*y/q\"],polyGamma:[\"0/0\",\"\\\\polyGamma(1 + x, y)*x_1\"],mod:[\"\\\\{ q=0: 0/0, x_1 \\\\}\",\"\\\\{ \\\\mod(x/y, 1) > 0: -\\\\floor(x/y)*x_1 \\\\}\"],complexMod:[\"\\\\{ q=0: 0/0, x_1 \\\\}\",\"\\\\{ \\\\round(r)=r: 0/0, -\\\\floor(x/y)*x_1 \\\\} \\\\with r=x/y\"],cov:[\"\\\\cov(x_1, y)\",\"\\\\cov(x, x_1)\"],covp:[\"\\\\covp(x_1, y)\",\"\\\\covp(x, x_1)\"],corr:[\"(\\\\cov(x_1, y) - (\\\\cov(x, y)*\\\\cov(x, x_1)/\\\\var(x)))/(\\\\stdevp(x)\\\\stdevp(y))\",\"(\\\\cov(x, x_1) - (\\\\cov(x, y)*\\\\cov(y, x_1)/\\\\var(y)))/(\\\\stdevp(x)\\\\stdevp(y))\"],spearman:[\"0/0\",\"0/0\"],quantile:[\"\\\\{ \\\\floor(y*(\\\\count(x)-1)) = y*(\\\\count(x)-1) :   x_1[\\\\upperQuantileIndex(x, y)],  (\\\\ceil(y*(\\\\count(x)-1)) - y*(\\\\count(x)-1))*x_1[\\\\lowerQuantileIndex(x, y)] +   (y*(\\\\count(x)-1) - \\\\floor(y*(\\\\count(x)-1)))*x_1[\\\\upperQuantileIndex(x, y)]\\\\}\",\"\\\\{ \\\\floor(y*(\\\\count(x)-1)) < y*(\\\\count(x)-1) :   (\\\\count(x)-1)*(x[\\\\upperQuantileIndex(x, y)] - x[\\\\lowerQuantileIndex(x, y)])*x_1\\\\}\"],quartile:[\"0.5*(x_1[\\\\lowerQuartileIndex(x, y)] + x_1[\\\\upperQuartileIndex(x, y)])\",\"0/0\"],tscore:[\"\\\\frac{\\\\sqrt{\\\\count(x)}(\\\\stdev(x)*\\\\mean(x_1)-(\\\\mean(x)-y)*\\\\frac{\\\\cov(x,x_1)}{\\\\stdev(x)})}{\\\\stdev(x)^2}\",\"-x_1*\\\\sqrt{\\\\count(x)}/\\\\stdev(x)\"],quartileIndex:[\"0/0\",\"0/0\"],upperQuartileIndex:[\"0/0\",\"0/0\"],lowerQuartileIndex:[\"0/0\",\"0/0\"],upperQuantileIndex:[\"0/0\",\"0/0\"],lowerQuantileIndex:[\"0/0\",\"0/0\"],nCr:[\"q*(\\\\polyGamma(0, 1 + x) - \\\\polyGamma(0, 1 + x - y))\",\"q*(\\\\polyGamma(0, 1 + x - y) - \\\\polyGamma(0, 1 + y))\"],nPr:[\"q*(\\\\polyGamma(0, 1 + x) - \\\\polyGamma(0, 1 + x - y))\",\"q*\\\\polyGamma(0, 1 + x - y)\"],arctan:[\"x_1*y/(y^2+x^2)\",\"-x_1*x/(y^2+x^2)\"],complexArctan:[\"x_1/((x+\\\\complex(0,1))(x-\\\\complex(0,1)))\"],poissonpdf:[\"0/0\",\"x_1\\\\frac{\\\\exp(-y)(\\\\floor(x)-y)y^{(\\\\floor(x)-1)}}{(\\\\floor(x))!}\"],invPoisson:[\"0/0\",\"0/0\"],tpdf:[\"x_1*q*\\\\frac{-(y+1)*x}{y+x^2}\",\"x_1*\\\\frac{1}{2}q*(  \\\\frac{x^2-1}{y + x^2} + \\\\ln(\\\\frac{y}{y + x^2}) +   \\\\polyGamma(0, \\\\frac{1+y}{2}) - \\\\polyGamma(0, y/2))\"],invT:[\"x_1/\\\\pdf(\\\\tdist(y),q)\",\"0/0\"],tcdf:[\"\\\\{x<y:-1,1\\\\}\\\\pdf(\\\\tdist(z,u,v),x)*x_1\",\"\\\\{y<x:-1,1\\\\}\\\\pdf(\\\\tdist(z,u,v),y)*x_1\",\"0/0\",\"\\\\{x<y:-1,1\\\\}(\\\\pdf(\\\\tdist(z,u,v), y) - \\\\pdf(\\\\tdist(z,u,v), x))*x_1\",\"\\\\{y<x:-1,1\\\\}(\\\\{\\\\abs(y)=1/0:0,\\\\frac{u-y}{v}\\\\pdf(\\\\tdist(z,u,v),y)\\\\} - \\\\{\\\\abs(x)=1/0:0,\\\\frac{u-x}{v}\\\\pdf(\\\\tdist(z,u,v),x)\\\\})*x_1\"],poissoncdf:[\"0/0\",\"0/0\",\"x_1\\\\sum _{n=\\\\max(0,\\\\floor(\\\\min(x,y)))}^{\\\\floor(\\\\max(x,y))}\\\\frac{\\\\exp(-z)(n-z)z^{(n-1)}}{n!}\"],normalpdf:[\"-x_1*\\\\frac{x-y}{z^2} q\",\"x_1*\\\\frac{x-y}{z^2} q\",\"x_1*(\\\\frac{(x-y-z)*(x-y+z)}{z^3}) q\"],binompdf:[\"0/0\",\"0/0\",\"\\\\{0<=z<=1: x_1*q*(\\\\frac{\\\\round(x)}{z}-\\\\frac{\\\\round(y)-\\\\round(x)}{1-z}), 0 \\\\}\"],invBinom:[\"0/0\",\"0/0\",\"0/0\"],uniformpdf:[\"0\",\"\\\\{y<=x: \\\\frac{x_1}{(z-y)^2}, 0\\\\}\",\"\\\\{z>=x: -\\\\frac{x_1}{(z-y)^2}, 0\\\\}\"],invUniform:[\"\\\\{y<=x<=z: x_1*(z-y), 0\\\\}\",\"\\\\{y<=x<=z: x_1*(1-x), 0\\\\}\",\"\\\\{y<=x<=z: x_1*x, 0\\\\}\"],normalcdf:[\"\\\\{x<y:-1,1\\\\}\\\\pdf(\\\\normaldist(z,u), x)*x_1\",\"\\\\{y<x:-1,1\\\\}\\\\pdf(\\\\normaldist(z,u), y)*x_1\",\"\\\\{x<y:-1,1\\\\}(\\\\pdf(\\\\normaldist(z,u), y) - \\\\pdf(\\\\normaldist(z,u), x))*x_1\",\"\\\\{y<x:-1,1\\\\}(\\\\{\\\\abs(y)=1/0:0,\\\\frac{z-y}{u}\\\\pdf(\\\\normaldist(z,u),y)\\\\} - \\\\{\\\\abs(x)=1/0:0,\\\\frac{z-x}{u}\\\\pdf(\\\\normaldist(z,u),x)\\\\})*x_1\"],binomcdf:[\"0/0\",\"0/0\",\"0/0\",\"\\\\{0<=u<=1: x_1*\\\\sum _{n=\\\\max(0,\\\\round(\\\\min(x,y)))}^{\\\\round(\\\\max(x,y))}(  \\\\pdf(\\\\binomialdist(z,u),n)*(\\\\frac{n}{u}-\\\\frac{\\\\round(z)-n}{1-u})), 0 \\\\}\"],uniformcdf:[\"\\\\{z>u: 0/0, \\\\{x<y:-1,1\\\\}\\\\pdf(\\\\uniformdist(z,u), x)*x_1\\\\}\",\"\\\\{z>u: 0/0, \\\\{y<x:-1,1\\\\}\\\\pdf(\\\\uniformdist(z,u), y)*x_1\\\\}\",\"\\\\{z>u: 0/0, \\\\{y<x:-1,1\\\\}(\\\\frac{\\\\{z<x<u:u-x,0\\\\} + \\\\{z<y<u:y-u,0\\\\}}{(u-z)^2})*x_1\\\\}\",\"\\\\{z>u: 0/0, \\\\{y<x:-1,1\\\\}(\\\\frac{\\\\{z<x<u:x-z,0\\\\} + \\\\{z<y<u:z-y,0\\\\}}{(u-z)^2})*x_1\\\\}\"],normalSample:[\"0/0\",\"0/0\",\"0/0\"],uniformSample:[\"0/0\",\"0/0\",\"0/0\"],tSample:[\"0/0\",\"0/0\"],poissonSample:[\"0/0\",\"0/0\"],binomSample:[\"0/0\",\"0/0\",\"0/0\"],rgb:[\"0/0\",\"0/0\",\"0/0\"],hsv:[\"0/0\",\"0/0\",\"0/0\"],polygon:[\"\\\\polygon(x_1)\"],area:[\"0/0\"],perimeter:[\"0/0\"],vertices:[\"\\\\vertices(x_1)\"],segments:[\"\\\\segments(x_1)\"],validateRangeLength:[\"0\",\"0\",\"0\",\"\\\\{q \\\\ge 1: x_1, 0\\\\}\"],validateSampleCount:[\"\\\\{x<0:0,1\\\\}*x_1\"],select:[\"\\\\select(x_1, y)\",\"0*q\"],shuffle:[\"0*y\",\"\\\\shuffle(x, x_1)\"],sortPerm:[\"0*x\"],complexSortPerm:[\"0*x\"],elementsAt:[\"\\\\elementsAt(x_1, y)\",\"0*q\"],uniquePerm:[\"0*q\"],tone:[\"\\\\tone(x_1,0)\",\"\\\\tone(0,x_1)\"],restriction:[\"0\"],restrictionToBoolean:[\"0\"],complex:[\"\\\\complex(x_1,0)\",\"\\\\complex(0,x_1)\"],arg:[\"\\\\imag(x_1/x)\"],complexDivide:[\"x_1/y\",\"-(q/y)x_1\"],wirtingerEqualOrWarning:[\"0\",\"x_1\"],coerceComplexToReal:[\"\\\\coerceComplexToReal(x_1)\"],coerceComplexToRealWithTolerance:[\"\\\\coerceComplexToRealWithTolerance(x_1)\"],peelableCoerceComplexToReal:[\"\\\\peelableCoerceComplexToReal(x_1)\"],peelableCoerceComplexToRealWithTolerance:[\"\\\\peelableCoerceComplexToRealWithTolerance(x_1)\"],coerceRealToComplex:[\"\\\\coerceRealToComplex(x_1)\"],chisqIndependenceTestInternal:[\"0/0\"],chisqcdf:[\"\\\\{x<y:-1,1\\\\}\\\\chisqpdf(x,z)*x_1\",\"\\\\{y<x:-1,1\\\\}\\\\chisqpdf(y,z)*x_1\",\"0/0\"],chisqpdf:[\"-(1/2)(1+(2-y)/x)q*x_1\",\"(1/2)(\\\\ln(x/2)-\\\\polyGamma(0,y/2))q*x_1\"],invChisq:[\"x_1/\\\\chisqpdf(q, y)\",\"0/0\"]},BV={};for(let e in VV){let t=e,n=VV[t],r=[];for(let s=0;s<n.length;s++){let o=n[s];r.push(Uo(o,{}))}BV[t]=r}function Zy(e){return se(e,b)?\"number\":se(e,O)?\"complex\":void 0}function hT(e,t,n,r){let s=e.getInstruction(n).valueType;if(Zy(s)!==r)throw V(`Incorrect derivative strategy '${r}' for type ${s}.`);let o=e.getInstruction(t).valueType;if(!$Y(o,r)){let i=e.areAllArgsConstant([t]);throw r===\"number\"?PP([oe(o)],{blockExport:i}):EP([oe(o),oe(s)],{blockExport:i})}switch(r){case\"number\":return yT(e,t,n,\"real\");case\"complex\":let i=yT(e,t,n,\"complexOne\"),a=yT(e,t,n,\"complexI\"),u=e.Multiply([e.Negative([e.ImaginaryUnit()]),a]),c=e.NativeFunction(\"wirtingerEqualOrWarning\",[i,u]);return e.Multiply([e.Constant(be(1,2)),e.Add([i,c])]);default:throw V(`Invalid derivative strategy '${r}'.`)}}function $Y(e,t){switch(t){case\"number\":return Jn(e,O)||Jn(e,He)||se(e,N)||se(e,F);case\"complex\":return Jn(e,O)||Jn(e,He);default:throw V(`Invalid derivative strategy '${t}'.`)}}function vD(e,t,n){let r=e.getInstruction(n).valueType,s=Zy(r);if(!s)throw V(`chunk.derivative called on non-number ${We(r)}.`);return hT(e,t,n,s)}function GV(e){let t=[];t.push(\"digraph {\");for(let n=0;n<e.instructionsLength();n++)e.getInstruction(n).type!==0&&t.push(`${n} [label=\"${n}: ${op(e,n)}\"];`);for(let n=0;n<e.instructionsLength();n++){let r=e.getInstruction(n);if(ce(r))for(let s of r.args)t.push(`${n} -> ${s};`)}return t.push(\"}\"),t.join(`\n`)}var Nu=class e{constructor(t){this.derivativeMaps=new Jx;if(this.instructions=[],this.blockMask=[],this.comments=[],t.argNames.length!==t.argTypes.length)throw new Error(\"Programming Error: length of argNames must match length of argTypes\");this.argNames=t.argNames,this.argTypes=t.argTypes;for(let n=0;n<this.argTypes.length;n++){let r=this.argTypes[n];this.LoadArg(r)}this.returnIndex=this.Constant(NaN)}computeNeedsThunking(){for(let t=this.returnIndex;t>=0;t--)if(this.instructions[t].type===55)return!0;return!1}setError(t){this.error=t}getError(){return this.error}setWarning(t){this.warning===void 0&&(this.warning=t)}restoreWarning(t){this.warning=t}getWarning(){return this.warning}getReturnIndex(){return this.returnIndex}setReturnIndex(t){if(!(0<=t&&t<this.instructions.length))throw new Error(`Programming Error: out of bounds return index ${t}`);this.returnIndex=t}addComments(t){for(let n in t){let r=this.comments[n]||\"\";this.comments[n]=r+t[n]}return this}instructionsLength(){return this.instructions.length}getInstruction(t){return this.instructions[t]}popInstruction(){this.unsafelyTruncate(this.instructions.length-1)}unsafelyTruncate(t){this.instructions.length=Math.min(t,this.instructions.length),this.blockMask.length=Math.min(t,this.blockMask.length),this.comments.length=Math.min(t,this.comments.length),this.derivativeMaps.truncate(t),this.setReturnIndex(this.instructions.length-1)}dereferenceFunctionHeader(t){let n=this.getInstruction(t);return n.endIndex===-1?void 0:n.endIndex}getDirectDependencies(t){if(t.type===55){let n=t.args,r=this.dereferenceFunctionHeader(n[0]);if(r!==void 0)return n.concat(r)}return t.args}getRecursionStructure(t){let n=this.getInstruction(t);if(n.endIndex===-1)throw V(\"Programming error: cannot get recursion structure before function is closed\");if(!n.__cachedRecursionStructure){let r={};for(let s of n.recursionGroup){let o=this.getInstruction(s);r[o.symbol]=s}n.__cachedRecursionStructure=YO(this,r)}return n.__cachedRecursionStructure}getRecursiveFunctionMetadata(t){let n=this.getRecursionStructure(t),r=this.getInstruction(t);return{type:n.canIterate?\"iterative\":\"general\",recursionGroup:r.recursionGroup.map(s=>this.getInstruction(s).symbol),returnType:r.valueType,signature:r.signature,recursiveStructure:n}}pushInstructionChecked(t){if(this.instructions.length>=32768)throw kP();this.instructions.push(t),this.setReturnIndex(this.instructions.length-1)}pushLeafInstruction(t){return this.pushInstructionChecked(t),this.getReturnIndex()}pushFunctionHeaderInstruction(t){return this.pushInstructionChecked(t),this.getReturnIndex()}pushInstruction(t){return this.checkInstructionArguments(t),this.pushInstructionChecked(t),this.setReturnIndex(l_(this)),this.setReturnIndex(E_(this)),this.setReturnIndex(YA(this)),OA(this,this.getReturnIndex()),this.returnIndex===this.instructions.length-1&&this.setReturnIndex(c_(this)),this.getReturnIndex()}checkInstructionArguments(t){for(let n of t.args)if(this.blockMask[n])throw new Error(\"Programming Error: cannot reference an instruction in a closed block\")}markClosedBlock(t,n){for(let r=t;r<n;r++)this.blockMask[r]=!0}LoadArg(t){return this.pushLeafInstruction({type:2,valueType:t})}BlockVar(t,n){return this.pushInstruction({type:47,valueType:t,args:n})}SymbolicVar(t,n){return this.pushLeafInstruction({type:3,valueType:t,symbol:n})}BroadcastResult(t,n){let r=n[0],o=this.instructions[r].args[0],a=this.getInstruction(o).args[0],u=this.getInstruction(a);return this.pushInstruction({type:48,valueType:t,args:n,constantLength:Ue(u)?Lr(this,a):void 0})}Constant(t){return this.ConstantOfType(b,t)}ConstantOfType(t,n){if(typeof n==\"number\"&&(n=be(n,1)),$(t)&&n.length>1e4)throw df();return this.pushLeafInstruction({type:1,valueType:t,value:n})}TupleOfType(t,n){let r;return Array.isArray(n)?r=n:r=Vd[t].map(s=>n[s]),this.pushInstruction({type:15,valueType:t,args:r})}Slot(t,n){let r=16,s=this.getInstruction(n[0]).valueType,o=Sl[s],i=o?o[t]:Pn;if(i===void 0)throw V(`Invalid slot index: ${t} for ${We(s)}.`);return this.pushInstruction({type:r,valueType:i,args:n,index:t})}NamedSlot(t,n){let r=this.getInstruction(n[0]).valueType;if(r===Ae)return n[0];let s=$(r)?Xe(r):r;return this.Slot(Bd(s,t),n)}ImaginaryUnit(){return this.ConstantOfType(O,[be(0,1),be(1,1)])}NanOfType(t){if(t===Sn){let n=this.Constant(NaN);return this.Distribution(\"uniformdist\",[n,n])}else return this.ConstantOfType(t,Is(t))}ZeroOfType(t){return this.ConstantOfType(t,JR(t))}Add(t){let n=8,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Subtract(t){let n=9,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Multiply(t){let n=10,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Divide(t){let n=11,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Exponent(t){let n=12,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}RawExponent(t){let n=13,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Negative(t){let n=14,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Square(t){let n=56,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Equal(t){let n=25,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Less(t){let n=26,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Greater(t){let n=27,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}LessEqual(t){let n=28,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}GreaterEqual(t){let n=29,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Comparator(t,n){switch(t){case\"=\":return this.Equal(n);case\">\":return this.Greater(n);case\"<\":return this.Less(n);case\"<=\":return this.LessEqual(n);case\">=\":return this.GreaterEqual(n);default:{let r=t;throw new Error(`Unexpected comparator symbol: ${r}`)}}}Or(t){let n=31,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}And(t){let n=32,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}Piecewise(t){let n=33,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}List(t){let n=38,r=wn(this,n,t);if(t.length>1e4)throw df();return this.pushInstruction({type:n,valueType:r,args:t})}ListAccess(t){let n=39,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}DeferredListAccess(t){let n=40,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}InboundsListAccess(t){let n=41,r=wn(this,n,t);return this.pushInstruction({type:n,valueType:r,args:t})}NativeFunction(t,n){let r=37,s=Wn[t].returnType,o=typeof s==\"function\"?s(n.map(i=>this.getInstruction(i).valueType)):s;return this.pushInstruction({type:r,valueType:o,args:n,symbol:t})}Distribution(t,n){let r=42,s=Sn;return this.pushInstruction({type:r,valueType:s,args:n,symbol:t})}BeginIntegral(t,n){let r=21,s=wn(this,r,[]);return this.pushInstruction({type:r,valueType:s,args:n,endIndex:-1,callData:t})}EndIntegral(t){let n=22,r=wn(this,n,t),s=t[0],o=this.getInstruction(s);this.instructions[s]={type:o.type,valueType:o.valueType,args:o.args,endIndex:this.instructionsLength(),callData:o.callData};let i=this.pushInstruction({type:n,valueType:r,args:t});return this.markClosedBlock(s,i),i}BeginBroadcast(t,n){let r=23,s=wn(this,r,[]),o=this.getInstruction(t[0]);if(Ue(o)&&Lr(this,t[0])>1e4)throw df();return this.pushInstruction({type:r,valueType:s,endIndex:-1,args:t,context:n})}EndBroadcast(t){let n=24,r=wn(this,n,t),s=t[0],o=this.getInstruction(s),i={type:o.type,valueType:o.valueType,args:o.args,endIndex:this.instructionsLength(),context:o.context};this.instructions[s]=i;let a=this.pushInstruction({type:n,valueType:r,args:t});return this.markClosedBlock(s,a),a}BeginLoop(t,n){let r=19,s=wn(this,r,n);return this.pushInstruction({type:r,valueType:s,args:n,endIndex:-1,callData:t})}EndLoop(t){let n=20,r=wn(this,n,t),s=t[0],o=this.getInstruction(s);this.instructions[s]={type:o.type,valueType:o.valueType,args:o.args,endIndex:this.instructionsLength(),callData:o.callData};let i=this.pushInstruction({type:n,valueType:r,args:t});return this.markClosedBlock(s,i),i}BeginMap(t,n){let r=50,s=wn(this,r,n);return this.pushInstruction({type:r,valueType:s,args:n,endIndex:-1,callData:t})}EndMap(t){let n=51,r=wn(this,n,t),s=t[0],o=this.getInstruction(s);this.instructions[s]={type:o.type,valueType:o.valueType,args:o.args,endIndex:this.instructionsLength(),callData:o.callData};let i=this.pushInstruction({type:n,valueType:r,args:t});return this.markClosedBlock(s,i),i}FunctionHeader(t,n,r,s){let o=4;return this.pushFunctionHeaderInstruction({type:o,valueType:n,endIndex:-1,symbol:t,signature:r,parameterSymbols:s,recursionGroup:[]})}BeginFunction(t){let n=53,r=this.getInstruction(t[0]);return this.pushInstruction({type:n,valueType:r.valueType,endIndex:-1,args:t})}EndFunction(t){let n=54,r=t[0],s=this.getInstruction(r);this.instructions[r]={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength()};let o=s.args[0],i=this.getInstruction(s.args[0]);this.instructions[o]={type:i.type,valueType:i.valueType,endIndex:this.instructionsLength(),symbol:i.symbol,signature:i.signature,parameterSymbols:i.parameterSymbols,recursionGroup:i.recursionGroup};let a=this.pushInstruction({type:n,valueType:Pn,args:t});return this.markClosedBlock(r,a),a}FunctionCall(t){let n=55;return this.pushInstruction({type:n,valueType:wn(this,n,t),args:t})}ExtendSeed(t,n){let r=44,s=Pt;return this.pushInstruction({type:r,valueType:s,args:n,tag:t})}Noop(){let t=0,n=Pn;return this.pushLeafInstruction({type:t,valueType:n})}Action(t,n){return this.pushInstruction({type:49,valueType:it,args:n,symbols:t})}replaceInstructionWithConstant(t,n){this.instructions[t]=n,this.blockMask[t]=void 0}replaceInstructionWithBlockVarOrFunctionCall(t,n){this.instructions[t]=n}reopenFinalBlock(){let t=this.getInstruction(this.getReturnIndex());if(t.type!==48)return this;let n=t.args[0],s=this.getInstruction(n).args[0];for(let o=s;o<n;o++)this.blockMask[o]=void 0;return this.unsafelyTruncate(n),this}reopenAllBlocks(){this.blockMask=[]}isInClosedBlock(t){return!!this.blockMask[t]}copy(){let t=new e({argNames:this.argNames,argTypes:this.argTypes});return t.instructions=this.instructions.slice(),t.blockMask=this.blockMask.slice(),t.comments=this.comments.slice(),t.derivativeMaps=this.derivativeMaps.clone(),t.warning=this.warning,t.setReturnIndex(this.getReturnIndex()),t}fuseBroadcast(){return this.setReturnIndex(Vr(this,this.getReturnIndex())),this}copyLeafInstruction(t){return this.pushLeafInstruction(t)}copyInstructionWithArgs(t,n){return od(this,t,n)}replaceInstructionWithNoop(t){this.instructions[t]={type:0,valueType:Pn}}getReturnType(){return this.instructions[this.getReturnIndex()].valueType}isConstant(){return Ue(this.instructions[this.getReturnIndex()])}areAllArgsConstant(t){for(let n of t)if(!Ue(this.instructions[n]))return!1;return!0}asValue(){return Lr(this,this.getReturnIndex())}asCompilerValue(){let t=this.instructions[this.getReturnIndex()];switch(t.type){case 1:return t.value;default:throw new Error(`Unexpected opcode ${t.type}.`)}}getConstantListLength(){return or(this,this.getReturnIndex())}getListLengthDependencies(){let t=this.copy(),n=dr(t,t.getReturnIndex());return Ms(t,n)}elementAt(t){let n=this.copy(),r=n.getReturnIndex();return n.setReturnIndex(ly(n,r,t)),n}substituteConstantArguments(t){return AL(this,t)}interpretWithParameters(t){return r_(this,this.getReturnIndex(),t)}getCompiledFunction(t){let n;if(t){n=t.slice();for(let i of this.argNames)n.indexOf(i)===-1&&n.push(i)}else n=this.argNames;let{source:r,constants:s}=Ab(this),o={};return{args:n,source:r,constants:s,executionMetadata:o,fn:ry(n,r,s,o)}}getRestrictedFunctionForGLSL(t,n){let r=uc(this,t,{allowSlices:!0}),{restrictionChunk:s,valueChunk:o}=r.getValueAndRestrictionChunk(),i;if(s!==void 0)try{i=Qo(s,n)}catch(a){s=void 0}return i===void 0&&r.getSliceVariablesOrImplicit().length==0?{concrete:new Dn(this),restriction:void 0,restrictionExpr:void 0}:{concrete:new Dn(o),restriction:i,restrictionExpr:s&&new Dn(s)}}polynomialOrder(t,n){return UA(this,t,n)}getPolynomialCoefficients(t){return zA(this,t)}takeDerivative(t){let n=this.argNames.indexOf(t);return n===-1?this.setReturnIndex(this.ZeroOfType(this.getReturnType())):this.setReturnIndex(vD(this,this.getReturnIndex(),n)),this}gradient(t){let n=[],r=this.getReturnIndex();for(let s of t){let o=this.argNames.indexOf(s);o===-1?n.push(this.Constant(0)):n.push(vD(this,r,o))}return this.List(n),this}deriveRegressionRestrictions(){return m_(this)}boundDomain(t){return kA(this,t,this.getReturnIndex())}findLinearSubset(t){let n=P_(this),r=[];for(let s of t){let o=this.argNames.indexOf(s);if(o===-1)throw new Error(\"Programming Error: findLinearSubset called with a non-dependency\");r.push(n[o])}return r}isLinearIn(t){let n=this.argNames.filter(r=>t.includes(r));return n.length===0?!1:this.findLinearSubset(n).every(Boolean)}isImplicitPlane(){let t=n=>n===\"x\"||n===\"y\"||n===\"z\";return this.isLinearIn([\"x\",\"y\",\"z\"])&&this.argNames.every(t)}print(t,n=this.comments){let r;return t===void 0?(t=this.instructionsLength()-1,r={printUnreferencedInstructions:!0,comments:n}):r={printUnreferencedInstructions:!1,comments:n},LO(this,t,r)}printInstruction(t){return op(this,t)}toDot(){return GV(this)}getLiveArgNames(){let t=Zr(this,this.getReturnIndex()),n=[];for(let r=0;r<this.argNames.length;r++)t[r]&&n.push(this.argNames[r]);return n}getCursorContext(){return this.cursorContext}setCursorContext(t){this.cursorContext=t}coerceToNumericIfPossible(t={}){return Fo(this,this.getReturnIndex(),t)}coerceNonComplexToNumberIfPossible(){return pp(this,this.getReturnIndex())}};var Ja={normaldist:{pdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"normalpdf\",n.concat(r.args))},cdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"normalcdf\",n.concat(r.args))},mean:function(e,t,n){return e.getInstruction(t).args[0]},median:function(e,t,n){return Ja.normaldist.mean(e,t,n)},stdev:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"abs\",[r.args[1]])},var:function(e,t,n){let r=e.getInstruction(t);return e.Square([r.args[1]])},quantile:function(e,t,n){let r=e.getInstruction(t);return e.Add([e.Multiply([e.NativeFunction(\"invNorm\",n),e.NativeFunction(\"abs\",[r.args[1]])]),r.args[0]])},random:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"normalSample\",[n[0],r.args[0],r.args[1]])}},tdist:{pdf:function(e,t,n){let r=e.getInstruction(t),s=r.args[1],o=e.NativeFunction(\"abs\",[r.args[2]]),i=e.Divide([e.Subtract([n[0],s]),o]);return e.Divide([e.NativeFunction(\"tpdf\",[i,r.args[0]]),o])},cdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"tcdf\",[n[0],n[1],r.args[0],r.args[1],r.args[2]])},mean:function(e,t,n){return e.getInstruction(t).args[1]},median:function(e,t,n){return Ja.tdist.mean(e,t,n)},stdev:function(e,t,n){return e.NativeFunction(\"sqrt\",[Ja.tdist.var(e,t,n)])},var:function(e,t,n){let r=e.getInstruction(t),s=e.Constant(1),o=e.Constant(2),i=r.args[0],a=r.args[2];return e.Piecewise([e.Greater([i,s]),e.Piecewise([e.Greater([i,o]),e.Multiply([e.Divide([i,e.Subtract([i,o])]),e.Square([a])]),e.Constant(1/0)]),e.Constant(NaN)])},quantile:function(e,t,n){let r=e.getInstruction(t),s=r.args[1],o=e.NativeFunction(\"abs\",[r.args[2]]);return e.Add([e.Multiply([e.NativeFunction(\"invT\",[n[0],r.args[0]]),o]),s])},random:function(e,t,n){let r=e.getInstruction(t),s=r.args[1],o=e.NativeFunction(\"abs\",[r.args[2]]);return e.Add([e.Multiply([e.NativeFunction(\"tSample\",[n[0],r.args[0]]),o]),s])}},poissondist:{pdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"poissonpdf\",n.concat(r.args))},cdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"poissoncdf\",n.concat(r.args))},mean:function(e,t,n){return e.getInstruction(t).args[0]},median:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"invPoisson\",[e.Constant(.5),r.args[0]])},stdev:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"sqrt\",[r.args[0]])},var:function(e,t,n){return Ja.poissondist.mean(e,t,n)},quantile:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"invPoisson\",[n[0],r.args[0]])},random:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"poissonSample\",[n[0],r.args[0]])}},binomialdist:{pdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"binompdf\",n.concat(r.args))},cdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"binomcdf\",n.concat(r.args))},mean:function(e,t,n){let r=e.getInstruction(t);return e.Multiply([r.args[0],r.args[1]])},median:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"invBinom\",[e.Constant(.5),r.args[0],r.args[1]])},stdev:function(e,t,n){return e.NativeFunction(\"sqrt\",[Ja.binomialdist.var(e,t,n)])},var:function(e,t,n){let r=e.getInstruction(t),[s,o]=r.args;return e.Multiply([s,e.Multiply([o,e.Subtract([e.Constant(1),o])])])},quantile:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"invBinom\",[n[0],r.args[0],r.args[1]])},random:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"binomSample\",[n[0],r.args[0],r.args[1]])}},uniformdist:{pdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"uniformpdf\",n.concat(r.args))},cdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"uniformcdf\",n.concat(r.args))},mean:function(e,t,n){let r=e.getInstruction(t);return e.Divide([e.Add([r.args[0],r.args[1]]),e.Constant(2)])},median:function(e,t,n){return Ja.uniformdist.mean(e,t,n)},stdev:function(e,t,n){return e.NativeFunction(\"sqrt\",[Ja.uniformdist.var(e,t,n)])},var:function(e,t,n){let r=e.getInstruction(t),s=e.Subtract([r.args[1],r.args[0]]);return e.Divide([e.Square([s]),e.Constant(12)])},quantile:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"invUniform\",[n[0],r.args[0],r.args[1]])},random:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"uniformSample\",[n[0],r.args[0],r.args[1]])}},chisqdist:{pdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"chisqpdf\",n.concat(r.args))},cdf:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"chisqcdf\",n.concat(r.args))},mean:function(e,t,n){return e.getInstruction(t).args[0]},median:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"invChisq\",[e.Constant(.5),r.args[0]])},stdev:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"sqrt\",[e.Multiply([e.Constant(2),r.args[0]])])},var:function(e,t,n){let r=e.getInstruction(t);return e.Multiply([e.Constant(2),r.args[0]])},quantile:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"invChisq\",[n[0],r.args[0]])},random:function(e,t,n){let r=e.getInstruction(t);return e.NativeFunction(\"invChisq\",[e.NativeFunction(\"uniformSample\",[n[0],e.Constant(0),e.Constant(1)]),r.args[0]])}}};function HV(e,t,n){let r=n[0],s=e.Constant(0),o=e.Constant(1);if(or(e,t)===0)return e.Constant(NaN);let a=dr(e,t);return e.InboundsListAccess([t,e.Add([e.NativeFunction(\"floor\",[e.Multiply([e.NativeFunction(\"uniformSample\",[r,s,o]),a])]),o])])}function qV(e,t,n){switch(t){case O:return e.NativeFunction(\"complex\",n);case N:case F:return e.TupleOfType(t,n);default:throw V(`Type ${We(t)} is not a supported aggregate type for building.`)}}function Xy(e){if(!e)return;let{latex:t,latexSelection:n}=e;if(t===void 0||n===void 0)return;let{start:r,end:s}=n;return{input:t,start:r,end:s}}function DD(e,t,n){if(!t)return;let r=ND(t,n._expression);r===\"start-to-end\"?e.setCursorContext({type:n.type===\"Assignment\"?\"assignment-rhs\":\"function-definition-body\",allowedTypes:[Pn]}):r===\"empty-list\"&&e.setCursorContext({type:\"expression-arguments\",expressionType:\"List\",argIndex:0,argCount:0,isLastValidArg:!1,positionWithinArg:\"start-to-end\",allowedTypesForInsertedArg:[Pn]})}function UV(e,t,n){if(t){let r=ND(t,n.args[1]);r===\"start-to-end\"?e.setCursorContext({type:\"for-assignment-rhs\",allowedTypes:[Ie,pe,ae,Pe,De,Se,...Oo.types]}):r===\"empty-list\"&&e.setCursorContext({type:\"for-assignment-rhs\",allowedTypes:[Pn]})}}function Cd(e,t,n,r,s){let o=YY(e,t,n,r,s);o&&e.setCursorContext(o)}function ND(e,t){let n=t.getInputSpan();return n?e.start===n.start&&e.end===n.end?\"start-to-end\":e.start===e.end&&e.start===n.end?\"end\":e.start===e.end&&e.start===n.start?\"start\":e.start===e.end&&t.type===\"List\"&&t.args.length===0?\"empty-list\":\"not-aligned\":\"not-aligned\"}function RD(e,t){if(!e)return;let n=!1;t instanceof qs&&t.args[1]instanceof xr&&(n=!0,t=t.args[1]);let r=t.args;if(r){if(r.length===0){let s=t.getInputSpan();if(!s)return;let o=pr(s),i=-1;return t.type===\"List\"?i=o.indexOf(\"[\"):(t.type===\"FunctionCall\"||t.type===\"SeededFunctionCall\")&&(i=o.indexOf(\"(\")),i<0?void 0:e.start===s.start+i+1?{argIndex:0,positionWithinArg:\"start-to-end\",isDotCall:n}:void 0}for(let s=0;s<r.length;s++){let o=r[s],i=o.getInputSpan();if((i==null?void 0:i.input)!==e.input)continue;if(e.start<i.start)break;let a=ND(e,o);if(a!==\"not-aligned\")return{argIndex:s,positionWithinArg:a,isDotCall:n}}}}function YY(e,t,n,r,s){if(!n||!r.args)return;let o=RD(n,r);if(o===void 0)return;o.isDotCall&&(r=r.args[1]);let i=o.positionWithinArg===\"end\"?o.argIndex+1:o.argIndex;o.isDotCall&&(i+=1);let a;o.positionWithinArg===\"empty-list\"||o.positionWithinArg===\"start-to-end\"?a=[...s.slice(0,i),void 0,...s.slice(i+1)]:r instanceof us?a=i===1?[s[0],void 0,s[1]]:[s[0],s[1],void 0]:a=[...s.slice(0,i),void 0,...s.slice(i)],a=a.map(l=>{if(!(l===void 0||e.getInstruction(l).type===2))return l});let u=[];for(let l of a)u.push(l===void 0?void 0:e.getInstruction(l).valueType);let c=Zb(t,r,u),p=c&&Ud(c,i);if(o.positionWithinArg===\"empty-list\"){let l=p==null?void 0:p.filter($).map(Xe);return(l==null?void 0:l.length)===0?void 0:{type:\"expression-arguments\",expressionType:\"List\",argIndex:0,argCount:0,isLastValidArg:!1,positionWithinArg:\"start-to-end\",allowedTypesForInsertedArg:l!=null?l:[Pn]}}else{if((p==null?void 0:p.length)===0)return;let l=!1;if(c){let y=0;for(let g of c){let f=g.maxArity!==void 0?g.maxArity-1:1/0;y=Math.max(y,f)}l=o.positionWithinArg===\"end\"&&o.argIndex===y-1||o.positionWithinArg===\"start-to-end\"&&o.argIndex===y}let m=r.args.length;if(r instanceof us&&r.args.length===3){let y=r.args[2];y instanceof Xn&&y.isNaN()&&(m=2)}let d={type:\"expression-arguments\",expressionType:r.type,argIndex:o.argIndex,argCount:m,isLastValidArg:l,positionWithinArg:o.positionWithinArg,allowedTypesForInsertedArg:p!=null?p:[Pn]};if(r instanceof xr&&(d.functionSymbol=r._symbol,d.isDotCall=o.isDotCall,r instanceof xr&&r._symbol===\"polygon\")){let y=r.args.filter(g=>!(g instanceof hn&&g._symbol===\"cursor\"));if(y.length>0){let g=y[0].getInputSpan(),f=y[y.length-1].getInputSpan();d.polygonVertices=g&&f?{firstLatex:pr(g),lastLatex:pr(f)}:void 0}}return d}}function Wy(e,t,n){if(t===n)return!0;if(t<n)return!1;let r=[!0];for(let o=n+1;o<=t;o++)r.push(!1);let s=[t];for(;s.length;){let o=s.pop();if(r[o-n])continue;r[o-n]=!0;let i=e.getInstruction(o);if(ce(i))for(let a of e.getDirectDependencies(i)){if(a===n)return!0;a<n||r[a-n]||s.push(a)}}return!1}function zV(e,t,n){return bT(e,r=>{var l,m;let{chunk:s}=r,o=[],i=[];for(let d=0;d<n.length;d++){let y=s.getInstruction(n[d]).valueType;$(y)?(o.push(2),i.push(s.SymbolicVar(y,t._argSymbols[d]))):(o.push(0),i.push(n[d]))}if(o.every(d=>d===0))return o;let a=xT(r,t,i),u=Math.min(...i),c=Zr(s,a),p=[];for(let d=0;d<i.length;d++)p[i[d]]=new Set([d]);for(let d=u;d<=a;d++){if(!c[d])continue;let y=s.getInstruction(d);if(ce(y)){if(y.type===39||y.type===40||y.type===41){let g=y.args[0],f=y.args[1],h=s.getInstruction(f);if(h.type===23){let x=h.endIndex,T=(l=p[x])!=null?l:new Set;for(let P of p[g]||[])T.add(P);p[x]=T;continue}}if(y.type===48)p[d]=p[y.args[0]];else if(y.type===37&&y.symbol===\"count\"&&y.args.length===1)p[d]=p[y.args[0]];else if(!(y.type===23&&((m=y.context)==null?void 0:m.type)===\"implicit\")){if(!(y.type===44&&y.tag===\"fc\"))for(let g of y.args){let f=p[g]||[];for(let h of f)o[h]=1}}}}return o})}function ZY(e,t,n){let r=Md.empty(t);for(let s=0;s<e.argNames.length;s++){let o=e.argNames[s];n.includes(o)?r.addLexicalBinding(o,s):r.setFreeVariable(o,s)}return r}var vd=class vd{constructor(t,n,r,s,o){if(this.kind=t,this.substitutedGlobals={...n==null?void 0:n.substitutedGlobals},this.functionBodySubstitutions={...n==null?void 0:n.functionBodySubstitutions},t&&r&&o){let i=o.filter(a=>r.isGlobal(a));for(let a of i)this.substitutedGlobals[a]||(this.substitutedGlobals[a]=t);if(s&&i.length>0){let a=this.recursionGroupKey(s.fnSymbols);this.functionBodySubstitutions[a]||(this.functionBodySubstitutions[a]={operator:t,substitutedGlobals:i})}}}recursionGroupKey(t){return[...t].sort().join(\",\")}getFunctionBodySubstitution(t){let n=this.recursionGroupKey(t);return this.functionBodySubstitutions[n]}allowsRegressionParameterDependency(){if(!this.kind)return!0;for(let t in this.substitutedGlobals)return!1;return!0}getRegressionDependencyError(t){if(this.allowsRegressionParameterDependency())return;let[n,r]=Object.entries(this.substitutedGlobals)[0];return KS(n,t,r)}getKind(){return this.kind}getSubstitutedGlobals(){return this.substitutedGlobals}with(t,n,r){return new vd(\"with\",this,t,n,r)}for(t,n,r){return new vd(\"for\",this,t,n,r)}};vd.root=new vd;var Yy=vd,_D=class{constructor(t,n){this.definitions=t;this.baseCases=n;this.type=\"type-inference\";this.argTypes={};this.returnTypes={};this.baseCaseTypes={};this.firstValidBaseCaseIdentifiers={};this.stack=[];this.isUnconditionallyRecursive=!1;this.fnSymbols=Object.keys(t)}registerFunctionCall(t,n){this.argTypes[t]||(this.argTypes[t]=n)}};function CD(e,t,n,r,s,o){return{policy:e,chunk:t,scope:n,substitutionContext:r,recursiveFunctionContext:s,selection:o}}function ko(e,t){return{...e,scope:t}}function bT(e,t){let{chunk:n,scope:r}=e,s=n.instructionsLength(),o=r.childScopeWithChildGlobalCache(),i=ko(e,o),a=t(i);return n.unsafelyTruncate(s),a}function Yx(e){let{policy:t,frame:n,argNames:r,argTypes:s,selection:o,locals:i}=e,a=new Nu({argNames:r,argTypes:s}),u=ZY(a,n,i);return CD(t,a,u,Yy.root,void 0,o)}function Dd(e,t){let{policy:n,frame:r,argNames:s,argTypes:o}=e,i=Xy(t.userData),a=qv(r,t),{freeDependencies:u,updateSymbols:c}=a;if(s||(s=u),!o){o=[];for(let m=0;m<s.length;m++)o.push(b)}let p;t.type===\"FunctionDefinition\"||t.type===\"RecursiveFunctionBaseCase\"?p=t._argSymbols:p=[];let l=Yx({policy:n,frame:r,argNames:s,argTypes:o,selection:i,locals:p});try{fL(n,r,t.getScope()),Me(l,t),e.coerceToNumber===\"all\"||se(l.chunk.getReturnType(),nn)?l.chunk.coerceToNumericIfPossible():e.coerceToNumber===\"all-except-complex\"&&l.chunk.coerceNonComplexToNumberIfPossible(),e.wrapInList&&!$(l.chunk.getReturnType())&&l.chunk.List([l.chunk.getReturnIndex()]),l.chunk.fuseBroadcast(),XY(l,t,c)}catch(m){let d=m instanceof C?m:V(m);d.setCursorContext(l.chunk.getCursorContext()),l.chunk.setError(d)}return l.chunk}function XY(e,t,n){let{chunk:r,scope:s}=e;if(t.type===\"FunctionDefinition\"){for(let i of n)if(t._argSymbols.indexOf(i)!==-1||t._symbol===i)throw Wg(i)}let o=[];for(let i of n)s.isDefined(i)||o.push(i);if(o.length){let i=LD(e,o[0]).setDependencies(r.argNames.concat(o));throw r.isConstant()&&r.getReturnType()===it&&i.setActionValue(r.asValue()),i}}function Me(e,t){let n;if(mA(),JY(e,t))cA(),n=e.chunk.copyLeafInstruction(t.__IRCache.instruction);else{lA();let r=e.chunk.instructionsLength();n=QY(e,t),n=WY(e,r,n),jY(e,t,n)}return e.chunk.setReturnIndex(n),n}function WY(e,t,n){let{chunk:r,scope:s}=e;if(n<=t)return n;let o=r.getInstruction(n);return Ue(o)?(r.unsafelyTruncate(Math.max(t,s.getMaxIndex()+1)),r.copyLeafInstruction(o)):n}function jY(e,t,n){let{chunk:r,scope:s}=e,o=r.getInstruction(n);if(!Ue(o))return;let i=dL(s,t);i&&(pA(),t.__IRCache={keys:i,instruction:o})}function JY(e,t){let{scope:n,substitutionContext:r}=e;if(!t.__IRCache)return!1;let s=t.__IRCache.keys;for(let[o,i]of s){if(n.isLocal(o)||n.isError(o))return!1;let a=n.getVisibleGlobalDefinition(o);if(a!==i||a&&a.type===\"RegressionParameter\"&&!r.allowsRegressionParameterDependency())return!1}return!0}function QY(e,t){var u,c,p,l;let{policy:n,chunk:r,scope:s,substitutionContext:o,selection:i}=e,a=t.type;switch(a){case\"Constant\":{let m=t._constantValue,d=typeof m==\"boolean\"?Re:b;return r.ConstantOfType(d,m)}case\"RegressionParameter\":return r.Constant(t.asCompilerValue());case\"MixedNumber\":return r.Constant(t._constantValue);case\"ImaginaryUnit\":return r.ImaginaryUnit();case\"Negative\":return r.Negative(TT(e,t,t.args));case\"Add\":return r.Add(ya(e,t,t.args));case\"Subtract\":return r.Subtract(ya(e,t,t.args));case\"Multiply\":return r.Multiply(ya(e,t,t.args));case\"DotMultiply\":{let[m,d]=ya(e,t,t.args);return(c=(u=YV(e,m,d))!=null?u:sc(r,[m,d])?YV(e,ks(r,m),ks(r,d)):void 0)!=null?c:r.Multiply([m,d])}case\"CrossMultiply\":{let[m,d]=ya(e,t,t.args);return ft(r,m,Fe)&&ft(r,d,Fe)?Qc(r,[ZV(e,ks(r,m),ks(r,d)),ka(r,m)]):ft(r,m,F)&&ft(r,d,F)?ZV(e,m,d):r.Multiply([m,d])}case\"Divide\":return r.Divide(ya(e,t,t.args));case\"Exponent\":{let m=ya(e,t,t.args);if(n.isComplexEnabled()){let d=t.args[1];if(fZ(d)){let y=r.getInstruction(m[0]).valueType;if(Pl(y,b)||Pl(y,Y))return d.asValue()===2?r.Square([m[0]]):r.Exponent(m)}return r.NativeFunction(\"complexPow\",m)}else return r.Exponent(m)}case\"Comparator['=']\":case\"Comparator['>']\":case\"Comparator['<']\":case\"Comparator['>=']\":case\"Comparator['<=']\":return r.Comparator(t.operator,ya(e,t,t.args));case\"ComparatorChain\":{let m=hl(e,t,t.args),d=r.Comparator(t.symbols[0],[m[0],m[1]]);for(let y=1;y<t.symbols.length;y++)d=r.And([d,r.Comparator(t.symbols[y],[m[y],m[y+1]])]);return d}case\"Or\":return r.Or(ya(e,t,t.args));case\"PercentOf\":return r.Divide([r.Multiply(ya(e,t,t.args)),r.Constant(100)]);case\"ParenSeq\":return sZ(e,t);case\"BareSeq\":return oZ(e,t);case\"NamedCoordinateAccess\":{let[m]=TT(e,t,t.args),d=t.symbol;switch(d){case\"x\":case\"y\":case\"z\":return r.NamedSlot(d,[m]);case\"p\":{let y=r.getInstruction(m).valueType;return pu(Zn(y))?r.NamedSlot(d,[rd(r,[m])]):r.NamedSlot(d,[m])}default:{let y=d;throw new Error(`Programming Error: unexpected named coordinate: '${y}'.`)}}}case\"Norm\":{let m=TT(e,t,t.args)[0];return ft(r,m,O)?PT(r,m):(l=(p=wD(e,m))!=null?p:sc(r,[m])?wD(e,ks(r,m)):void 0)!=null?l:r.NativeFunction(\"abs\",[m])}case\"UpdateRule\":{let m=t._symbol;if(s.isLocal(m))throw LD(e,m);let d=s.getVisibleGlobalDefinition(m);if(d!==void 0&&d.type!==\"Assignment\"&&d.type!==\"Slider\")throw LD(e,m);let y=Me(e,t.args[1]);return r.Action([m],[y])}case\"List\":case\"TableColumnValue\":{if(t.getDependencies().length>0)return Dr(t.args),r.List(hl(e,t,t.args));if(t.args.length===0)return Cd(r,n,i,t,[]),r.ConstantOfType(Ae,[]);{let m=r.instructionsLength(),d=[],y,g;Dr(t.args);let f=!0;for(let x of t.args){let T=Me(e,x),P=r.getInstruction(T);if(y===void 0){if(y=P.valueType,!Hn(y))throw Vl([oe(y)],{blockExport:f});g=Ln(y)}else if(P.valueType!==y){if(gc(y,P.valueType)!==void 0)return r.unsafelyTruncate(m),r.List(hl(e,t,t.args));throw mf({blockExport:f})}if(P.type!==1)throw new Error(\"Programming error: expected list with no dependencies to constant collapse.\");d.push(P.value),r.unsafelyTruncate(m)}let h=RD(e.selection,t);if(e.selection&&h!==void 0&&g!==void 0&&h.positionWithinArg!==\"empty-list\"){let x=Xe(g);r.setCursorContext({type:\"expression-arguments\",expressionType:\"List\",argIndex:h.argIndex,argCount:t.args.length,isLastValidArg:!1,positionWithinArg:h.positionWithinArg,allowedTypesForInsertedArg:[x]})}return r.ConstantOfType(g,d)}}case\"ListAccess\":{let m=Me(e,t.args[0]),d=r.getInstruction(m);if(t.args[1].type===\"Range\"&&t.args[1].args[1].length===0){if(!$(d.valueType))throw cf([oe(d.valueType),oe(b)],{blockExport:Ue(d)});let y=dr(r,m),g=FD(e,Me(e,t.args[1].args[0]),r.List([y]),{stepMustBePositive:!0});return r.ListAccess([m,g])}else{let y=Me(e,t.args[1]),g=r.getInstruction(y);if(za(r,n,t,[m,y]),g.valueType===ro)return r.NativeFunction(\"select\",[m,y]);if(g.valueType===Re&&$(d.valueType)){let f=r.ConstantOfType(d.valueType,[]);return r.Piecewise([y,m,f])}return r.ListAccess([m,y])}}case\"Range\":{let[m,d]=ya(e,t,t.args);return FD(e,m,d,{stepMustBePositive:!1})}case\"ListComprehension\":return aZ(e,t);case\"Piecewise\":{let m=Me(e,t.args[0]),d=r.getInstruction(m),y=d.type===1&&d.value===!1,g=d.type===1&&d.value===!0,f;f=r.getWarning();let h=Me(e,t.args[1]);y&&r.restoreWarning(f),f=r.getWarning();let x=Me(e,t.args[2]);g&&r.restoreWarning(f);let T=[m,h,x];Cd(e.chunk,e.policy,e.selection,t,T),za(e.chunk,e.policy,t,T);let P=r.getInstruction(T[1]),M=r.getInstruction(T[2]),S=gi(P.valueType,M.valueType)||gi(M.valueType,P.valueType);if(d.type===1&&d.valueType===Re&&S){let D=T[d.value?1:2],G=r.getInstruction(D),j=P.valueType!==Ae?P.valueType:M.valueType;return G.valueType===Ae&&j!==Ae?r.ConstantOfType(j,[]):D}let E=P.valueType,v=Zn(E);if(!S&&Ue(M)&&M.valueType===b&&Ao(M.value)&&Yi(v)){if(se(P.valueType,nn))return r.NativeFunction(\"restriction\",[r.And([T[0],r.NativeFunction(\"restrictionToBoolean\",[T[1]])])]);let D=r.NanOfType(v);T=[T[0],T[1],D]}return r.Piecewise(T)}case\"Restriction\":return r.NativeFunction(\"restriction\",TT(e,t,t.args));case\"Ans\":case\"Identifier\":{let m=t._symbol,d=t._errorSymbol;if(t.type===\"Ans\"&&r.argNames.indexOf(m)!==-1)throw wS();let y=s.getSymbol(m);if(y!==void 0)return y;let g=s.getVisibleGlobalDefinition(m);if(g===void 0)throw rt[m]?rt[m].type===\"Placeholder\"?Na(d,e.policy):Mf(d):e.recursiveFunctionContext&&e.recursiveFunctionContext.fnSymbols.includes(m)?nh(m):V(`Programming Error: reached undefined symbol ${m}`);if(s.isLocal(m)||Vc(g))throw nh(d);if(g.type===\"RegressionParameter\"){let h=o.getRegressionDependencyError(d);if(h)throw h}let f;if(g instanceof is)f=Me(e,g);else{let h=s.newLexicalScope(),x=ko(e,h);f=Me(x,g)}return s.cacheGlobal(m,f,g),f}case\"AssignmentImport\":{let{_importFrom:m}=t,d=s.newScopeAcrossModuleBoundary(m.frameID),y=ko(e,d);return Me(y,new hn(m.symbol))}case\"FunctionCall\":case\"SeededFunctionCall\":{let m=yZ(e,t);if(m!==void 0)return m;Dr(t.args);let d=hl(e,t,t.args);return Dr(d),IT(e,t._symbol,t._errorSymbol,d,t.args)}case\"Substitution\":return pZ(e,t);case\"FunctionExponent\":{let m=t.args[0]._symbol,d=s.getVisibleGlobalDefinition(m),y=s.getSymbol(m),g=y!==void 0?r.getInstruction(y):void 0;return s.isLocal(m)&&(g==null?void 0:g.type)===4||Vc(d)?Me(e,new A.Exponent([new A.FunctionCall(m,[t.args[1]]),t.args[2]])):Me(e,new A.Multiply([t.args[0],new A.Exponent([t.args[1],t.args[2]])]))}case\"FunctionFactorial\":{let m=t.args[0]._symbol,d=s.getVisibleGlobalDefinition(m),y=s.getSymbol(m),g=y!==void 0?r.getInstruction(y):void 0;return s.isLocal(m)&&(g==null?void 0:g.type)===4||Vc(d)?Me(e,new A.FunctionCall(\"\\\\factorial\",[new A.FunctionCall(m,[t.args[1]])])):Me(e,new A.Multiply([t.args[0],new A.FunctionCall(\"\\\\factorial\",[t.args[1]])]))}case\"DotAccess\":{let m=t.args[0],d=t.args[1],y=s.getVisibleGlobalDefinition(d._symbol);if(m.type===\"Identifier\"&&m._symbol===\"construction\")return mZ(e,d);if((d.type===\"Identifier\"||d.type===\"FunctionCall\")&&Vc(y)){let g=d._symbol,f=d._errorSymbol;if(ey(y))throw lf(f);let h=d.type===\"Identifier\"?[m]:[m].concat(d.args),x=hl(e,t,h);return IT(e,g,f,x,h)}else if(d.type===\"SeededFunctionCall\"){let g=d._symbol,f=d._errorSymbol,h=[d.seed,m].concat(d.args.slice(1)),x=hl(e,t,h);return IT(e,g,f,x,h)}else throw Ls(\".\")}case\"Seed\":return r.ConstantOfType(Pt,t._stringValue);case\"ExtendSeed\":return r.ExtendSeed(t.tag,ya(e,t,t.args));case\"Integral\":{let m=t._differential._symbol,d=s.childScope();d.setErrorIfAccessed(m,RS(m));let y=ko(e,d),g=Me(y,t.args[1]),f=Me(y,t.args[2]),h=r.getInstruction(g),x=r.getInstruction(f),T=r.SymbolicVar(b,m),P=s.childScope();P.addLexicalBinding(m,T);let M=Me(ko(e,P),t.args[3]);if(za(r,n,t,[g,f,M]),!Wy(r,M,T))return r.Multiply([M,r.Subtract([Fo(r,f),Fo(r,g)])]);let S=td(r,[g,f,M]);if(S!==void 0&&Wy(r,S,T))throw JS(m);let E=S!==void 0?r.BeginBroadcast([S]):void 0,v=g;E!==void 0&&$(h.valueType)&&(v=Ru(r,g,E));let D=f;E!==void 0&&$(x.valueType)&&(D=Ru(r,f,E));let G=r.getInstruction(M).valueType,j=Zn(G),Q;if(Op(j)&&j!==b){let W=[],K=j===O||j===N?2:3;for(let J=0;J<K;J++){let re=r.BeginIntegral({indexSymbol:m},[v,D]),ie=pc(r,re,T,M),It=r.getInstruction(ie);E!==void 0&&$(It.valueType)&&(ie=Ru(r,ie,E)),ie=r.Slot(J,[ie]);let Bt=r.EndIntegral([re,ie]);W.push(r.BlockVar(b,[Bt]))}Q=qV(r,j,W)}else{let W=r.BeginIntegral({indexSymbol:m},[v,D]),K=pc(r,W,T,M),J=r.getInstruction(K);E!==void 0&&$(J.valueType)&&(K=Ru(r,K,E));let re=r.EndIntegral([W,K]);Q=r.BlockVar(b,[re])}if(E!==void 0){let W=r.EndBroadcast([E,Q]);return r.BroadcastResult(Ln(j),[W])}else return Q}case\"Sum\":case\"Product\":{let m=t._index._symbol,d=t.type===\"Sum\",y=s.childScope();y.setErrorIfAccessed(m,d?TS(m):IS(m));let g=ko(e,y),f=Me(g,t.args[1]);f=Fo(g.chunk,f);let h=Me(g,t.args[2]);if(h=Fo(g.chunk,h),!ft(r,f,b)){let Ge=Wc(r,[f]),pt=r.areAllArgsConstant([f]);throw d?dP(Ge,{blockExport:pt}):gP(Ge,{blockExport:pt})}if(!ft(r,h,b)){let Ge=Wc(r,[h]),pt=r.areAllArgsConstant([h]);throw d?fP(Ge,{blockExport:pt}):hP(Ge,{blockExport:pt})}let x=r.NativeFunction(\"round\",[f]),T=r.NativeFunction(\"round\",[h]),P=r.getInstruction(x),M=r.getInstruction(T);if(P.type===1&&P.valueType===b&&!isFinite(w(P.value)))throw d?Yg():Zg();if(M.type===1&&M.valueType===b&&!isFinite(w(M.value)))throw d?Yg():Zg();let S=r.SymbolicVar(b,m),E=s.childScope();E.addLexicalBinding(m,S);let v=Me(ko(e,E),t.args[3]),D=r.getInstruction(v).valueType,G=Zn(D),Q=(t.type===\"Sum\"?Rp:mg).find(Ge=>Pl(G,Ge));if(Q===void 0){let Ge=Wc(r,[v]),pt=r.areAllArgsConstant([v]);throw d?yP(Ge,{blockExport:pt}):bP(Ge,{blockExport:pt})}if(!Wy(r,v,S)){let Ge=r.Add([r.Subtract([T,x]),r.Constant(1)]);Ge=r.NativeFunction(\"listMax\",[Ge,r.Constant(0)]);let pt=d?r.Multiply([v,Ge]):Q===O?r.NativeFunction(\"complexPow\",[v,Ge]):r.RawExponent([v,Ge]);return r.Piecewise([r.Equal([Ge,r.Constant(0)]),d?r.ZeroOfType(Q):r.Constant(1),r.Piecewise([r.Less([Ge,r.Constant(1/0)]),pt,r.NanOfType(Q)])])}let W=td(r,[x,T,v]);if(W!==void 0&&Wy(r,W,S))throw d?WS(m):jS(m);let K=W!==void 0?r.BeginBroadcast([W]):void 0,J=x;K!==void 0&&$(P.valueType)&&(J=Ru(r,x,K));let re=T;K!=null&&$(M.valueType)&&(re=Ru(r,T,K));let ie=d?r.ZeroOfType(Q):Q===O?r.NativeFunction(\"complex\",[r.Constant(1),r.Constant(0)]):r.Constant(1),It=r.BeginLoop({type:d?\"sum\":\"product\",indexSymbol:m},[J,re,ie]),Bt=r.BlockVar(Q,[It]),xe=pc(r,It,S,v),ee=r.getInstruction(xe);K!==void 0&&$(ee.valueType)&&(xe=Ru(r,xe,K));let U=d?r.Add([Bt,xe]):r.Multiply([Bt,xe]),te=r.EndLoop([It,U]),Ce=r.BlockVar(Q,[te]);if(K!==void 0){let Ge=r.EndBroadcast([K,Ce]);return r.BroadcastResult(Ln(Q),[Ge])}else return Ce}case\"Derivative\":{let m=t._symbol,d=Me(e,new A.Identifier(m)),y=pp(r,d),g=r.getInstruction(y),f=Zy(g.valueType);if(!f)throw SP(m,Wc(r,[y]),{blockExport:Ue(g)});let h,x,T=!1;if((g.type===2||g.type===3)&&g.valueType===b)h=e,x=y;else{let E=s.childScope();x=r.SymbolicVar(g.valueType),E.addDynamicBinding(m,x),T=!0,h=ko(e,E)}let P=1;for(;t.args[0].type===\"Derivative\"&&t.args[0]._symbol===t._symbol;)P+=1,t=t.args[0];let S=Vr(r,Me(h,t.args[0]));for(let E=0;E<P;E++)S=hT(r,S,x,f);return x===y?S:(T&&r.derivativeMaps.pruneIP(x),pc(r,y,x,S))}case\"Prime\":{let m=t.args[0];if(s.isLocal(m._symbol))throw rh(m._symbol);let d=s.getVisibleGlobalDefinition(m._symbol);if(!d)throw ah(m._symbol);if(!Vc(d))throw rh(m._symbol);let y=Me(e,m.args[0]),g=pp(r,y),f=r.getInstruction(g),h=Zy(f.valueType);if(!h)throw CP(m._symbol,Wc(r,[g]),{blockExport:Ue(f)});let x=!1,T;(f.type===2||f.type===3)&&f.valueType===b?T=g:(T=r.SymbolicVar(f.valueType),x=!0);let P,M;if(m._symbol===\"logbase\"){if(m.args.length!==2)throw Gl();P=[T,Me(e,m.args[1])],M=[m.args[0],m.args[1]]}else{if(m.args.length!==1)throw Gl();P=[T],M=[m.args[0]]}let E=Vr(r,IT(e,m._symbol,m._errorSymbol,P,M));for(let v=0;v<t.order;v++)E=hT(r,E,T,h);return T===g?E:(x&&r.derivativeMaps.pruneIP(T),pc(r,g,T,E))}case\"Slider\":return e.chunk.Constant(go(cp,t,n,s.frame).asCompilerValue());case\"Assignment\":return DD(r,e.selection,t),Me(e,t._expression);case\"FunctionDefinition\":{let m=t;if(DD(r,e.selection,m),m.recursionInfo)return aB(e,m,m.recursionInfo);{let d=e.policy.isRecursionEnabled()&&e.policy.assignmentForbidden(m._symbol),y=s.childScope();return y.setErrorIfAccessed(m._symbol,Hl([m._symbol],{suggestAlternativeFunctionName:d})),Me(ko(e,y),t._expression)}}case\"RecursiveFunctionBaseCase\":{let m=s.childScope(),d=t;return m.setErrorIfAccessed(d._symbol,FE(d._symbol)),Me(ko(e,m),t._expression)}case\"Construction\":throw Ls(\"construction\");case\"Placeholder\":throw new Error(\"Programming error, unexpected placeholder\");default:throw new Error(`Programming error, unimplemented node type ${a}`)}}function TT(e,t,n){let r=[Me(e,n[0])];return Cd(e.chunk,e.policy,e.selection,t,r),za(e.chunk,e.policy,t,r),r}function ya(e,t,n){let r=[Me(e,n[0]),Me(e,n[1])];return Cd(e.chunk,e.policy,e.selection,t,r),za(e.chunk,e.policy,t,r),r}function PT(e,t){return e.NativeFunction(\"hypot\",[e.Slot(0,[t]),e.Slot(1,[t])])}function KV(e,t){return ft(e,t,b)?t:e.Slot(0,[t])}function eB(e,t){return ft(e,t,b)?e.Constant(0):e.Slot(1,[t])}function tB(e,t){return ft(e,t,b)?t:e.NativeFunction(\"complex\",[e.Slot(0,[t]),e.Negative([e.Slot(1,[t])])])}function Bi(e,t){return nB(e,t,\"mean\")}function nB(e,t,n){return Ri(e,t,n,[{match:kr(ge,0),build:()=>e.NativeFunction(n,t)},{match:kr(O,1),build:()=>e.NativeFunction(\"complex\",[e.NativeFunction(n,t.map(r=>KV(e,r))),e.NativeFunction(n,t.map(r=>eB(e,r)))])},{match:kr(N,1),build:()=>{let r=s=>e.NativeFunction(n,t.map(o=>e.Slot(s,[o])));return e.TupleOfType(N,[r(0),r(1)])}},{match:kr(F,1),build:()=>{let r=s=>e.NativeFunction(n,t.map(o=>e.Slot(s,[o])));return e.TupleOfType(F,[r(0),r(1),r(2)])}}])}function jy(e,t){return Ri(e,t,\"varp\",[{match:kr(ge,0),build:()=>e.NativeFunction(\"varp\",t)},{match:kr(O,1),build:()=>{let n=Bi(e,t);return Bi(e,t.map(r=>KY(e,e.Subtract([r,n]))))}}])}function kV(e,t){return ET(e,t)?Jy(e,t,\"var\"):Ri(e,t,\"var\",[{match:kr(ge,1),build:()=>e.NativeFunction(\"var\",t)},{match:kr(O,1),build:()=>{let n=e.NativeFunction(\"count\",t);return e.Divide([e.Multiply([jy(e,t),n]),e.Subtract([n,e.Constant(1)])])}}])}function $V(e,t,n){let r=e.BeginBroadcast([n]),s=e.InboundsListAccess([t,r]),o=e.EndBroadcast([r,s]);return e.BroadcastResult(Ln(e.getInstruction(s).valueType),[o])}function OD(e,t){return Ri(e,t,\"covp\",[{match:[$i,$i],noBroadcast:!0,build:()=>e.NativeFunction(\"covp\",t)},{match:[He,He],noBroadcast:!0,build:()=>{let n=e.NativeFunction(\"listMin\",[dr(e,t[0]),dr(e,t[1])]),r=$V(e,t[0],n),s=$V(e,t[1],n),o=Bi(e,[r]),i=Bi(e,[s]);return Bi(e,[e.Multiply([e.Subtract([r,o]),tB(e,e.Subtract([s,i]))])])}}])}function KY(e,t){return e.Add([e.Square([e.Slot(0,[t])]),e.Square([e.Slot(1,[t])])])}function wD(e,t){let n=e.chunk;return ft(n,t,F)?n.NativeFunction(\"hypot\",[n.Slot(0,[t]),n.NativeFunction(\"hypot\",[n.Slot(1,[t]),n.Slot(2,[t])])]):ft(n,t,N)?n.NativeFunction(\"hypot\",[n.Slot(0,[t]),n.Slot(1,[t])]):void 0}function YV(e,t,n){let r=e.chunk;return ft(r,t,N)&&ft(r,n,N)?r.Add([r.Multiply([r.Slot(0,[t]),r.Slot(0,[n])]),r.Multiply([r.Slot(1,[t]),r.Slot(1,[n])])]):ft(r,t,F)&&ft(r,n,F)?r.Add([r.Add([r.Multiply([r.Slot(0,[t]),r.Slot(0,[n])]),r.Multiply([r.Slot(1,[t]),r.Slot(1,[n])])]),r.Multiply([r.Slot(2,[t]),r.Slot(2,[n])])]):void 0}function ZV(e,t,n){let r=e.chunk,s=r.Slot(0,[t]),o=r.Slot(1,[t]),i=r.Slot(2,[t]),a=r.Slot(0,[n]),u=r.Slot(1,[n]),c=r.Slot(2,[n]);return r.TupleOfType(F,[r.Subtract([r.Multiply([o,c]),r.Multiply([i,u])]),r.Subtract([r.Multiply([i,a]),r.Multiply([s,c])]),r.Subtract([r.Multiply([s,u]),r.Multiply([o,a])])])}function hl(e,t,n){let r=[];for(let s of n)r.push(Me(e,s));return Cd(e.chunk,e.policy,e.selection,t,r),za(e.chunk,e.policy,t,r),r}function IT(e,t,n,r,s){var m;let{chunk:o,scope:i,recursiveFunctionContext:a,substitutionContext:u,policy:c}=e;if(t=ab(c,t),a&&a.type===\"type-inference\"&&a.definitions[t]){let d=u.getFunctionBodySubstitution(a.fnSymbols);if(d&&d.substitutedGlobals.length>0)throw t0(d.operator,d.substitutedGlobals[0],t);a.registerFunctionCall(t,r.map(f=>o.getInstruction(f).valueType));let y=a.definitions[t];if(y instanceof C)throw y;let g=cB(e,a,y,r);return o.SymbolicVar(g.returnType)}let p=i.getSymbol(t);if(p!==void 0){let d=o.getInstruction(p);if(d.type===4){if(d.signature.argTypes.length!==r.length)throw Da(t,d.signature.argTypes.length,r.length,{includeUsageExample:!0});for(let y=0;y<r.length;y++){let g=o.getInstruction(r[y]).valueType,f=d.signature.argTypes[y];if(!se(g,f))throw kI(y,We(f),We(g),{blockExport:Ue(o.getInstruction(r[y]))})}return o.FunctionCall([p,...r])}else if(se(d.valueType,Ne))return MT(e.chunk,[p,...r],n,!0);if(r.length>=1)return QV(e,t,s,r);throw d.type===2?ah(n):d.valueType===Sn?hh(n):gh(n)}let l=i.getVisibleGlobalDefinition(t);if(l===void 0||!Vc(l)){if(((m=rt[t])==null?void 0:m.type)===\"Placeholder\")throw t===\"logbase\"&&i.isGlobal(\"ln\")&&i.isGlobal(\"log\")?FS():Na(n,e.policy);if(l){let d=Me(e,l);if(o.getInstruction(d).valueType===Sn)throw hh(n);if(se(o.getInstruction(d).valueType,Ne))return MT(e.chunk,[d,...r],n,!0)}if(r.length>=1)return QV(e,t,s,r);throw l?gh(n):V(`Programming Error: reached undefined symbol ${t}`)}if(ey(l)){if(r.length!==l._argSymbols.length)throw Da(n,l._argSymbols.length,r.length,{includeUsageExample:!0});if(l.getDependencies().includes(\"globalRandomSeed\")&&c.shouldIncludeFunctionParametersInRandomSeed()){let d=zV(e,l,r),y=r.filter((g,f)=>d[f]===2);if(y.length>0){let g=td(o,y);if(g===void 0)throw V(\"Programming error: expected list length to be defined\");let f=o.BeginBroadcast([g]),h=[];for(let M=0;M<r.length;M++)d[M]===2?h.push(Ru(o,r[M],f)):h.push(r[M]);let x=xT(e,l,h,s),T=o.EndBroadcast([f,x]),P=o.getInstruction(x).valueType;if(Hn(P))return o.BroadcastResult(Ln(P),[T])}}return xT(e,l,r,s)}else{if(Ra.hasOwnProperty(t))return nZ(e,t,n,r,s);if(Wn.hasOwnProperty(t))return zo(e,t,r);throw Na(n,e.policy)}}function xT(e,t,n,r){let{scope:s}=e,o=s.newLexicalScope().childScope();for(let a=0;a<t._argSymbols.length;a++)o.addLexicalBinding(t._argSymbols[a],n[a],r&&r[a]);let i=ko(e,o);return t.recursionInfo?aB(i,t,t.recursionInfo):Me(i,t._expression)}function eZ(e,t){let n=ka(e,t),r=e.Add([n,ks(e,t)]);return e.NativeFunction(\"segment\",[n,r])}function zo(e,t,n){let{chunk:r}=e,s=Wn[t],o=n.length,{minArity:i,maxArity:a}=s;if(o>a||o<i)throw V(\"Unexpected arity mismatch\");let u=rB(r,n,s);switch(s.tag){case\"default\":case\"reducer\":case\"doubleReducer\":case\"parameterizedReducer\":case\"color\":case\"never-broadcast\":return r.NativeFunction(t,u);case\"trig\":{let c=Me(e,new A.Identifier(\"trigAngleMultiplier\")),p=r.Multiply([u[0],c]);return r.NativeFunction(t,[p])}case\"trig2\":{let c=Me(e,new A.Identifier(\"trigAngleMultiplier\")),p=r.Multiply([u[1],c]);return r.NativeFunction(t,[u[0],p])}case\"inverseTrig\":{let c=Me(e,new A.Identifier(\"trigAngleMultiplier\")),p=r.NativeFunction(t,u);return r.Divide([p,c])}default:{let c=s.tag;throw new Error(`Programming Error: unexpected tag ${c}`)}}}function rB(e,t,{minArity:n,defaultArguments:r}){if(!r||!(t.length-n<r.length))return t;let s=t.slice();for(;s.length-n<r.length;)s.push(e.copyLeafInstruction(r[s.length-n]));return s}function tZ(e,t,n){let r=[n.noBroadcast?gt(n.match):q(n.match)];return Xb(r,t.map(s=>e.getInstruction(s).valueType),0).length>0}function Ri(e,t,n,r){let s=r.find(o=>tZ(e,t,o));if(!s){if(typeof n==\"string\")throw Fs(n,Ua(e,t),{blockExport:e.areAllArgsConstant(t)});return n(e,t)}return s.build(e,t)}function XV(e,t){if(t.length!==2)throw V(\"Can only take the midpoint of two points\");let n=e.Constant(be(1,2));return e.Multiply([n,e.Add(t)])}function nZ(e,t,n,r,s){var y,g;let{chunk:o,policy:i}=e,a=Ra[t],{minArity:u,maxArity:c}=a,p=r.length;if(p<u||p>c)throw ay(t)?kM(o,{symbol:t,errorSymbol:n,argsWithoutSeed:r,signatures:a.getSignatures(i),minArity:u,providedArgs:r,builtInTag:void 0,defaultArgumentCount:(g=(y=a.defaultArguments)==null?void 0:y.length)!=null?g:0,isDotCall:!1,maxArity:c}):new Error(\"Programming Error: unexpected arity mismatch\");let l;if(t===\"cdf\")p===2?l=[r[0],o.Constant(-1/0),r[1]]:l=r;else if(t===\"random\")if(p===1||p<4&&!$(o.getInstruction(r[1]).valueType)&&o.getInstruction(r[1]).valueType!==Sn){let f=o.Distribution(\"uniformdist\",[o.Constant(0),o.Constant(1)]);l=[r[0],f].concat(r.slice(1))}else l=r;else l=rB(o,r,a);let m=Zf(i,t);if(t===\"join\"){let f=[];for(let x of l)f.push(o.getInstruction(x).valueType);let h=xA(f);m=[gt({type:\"variadic\",initial:[h,h],rest:h})]}if(m){let f=nC(o,l,m);f.didCoerce&&(l=f.args)}function d(f,h=n){return Ri(o,l,h,f)}switch(t){case\"length\":if(i.isGeometryEnabled()||i.is3dPolicy()){let f=l[0];return d([{match:[Jt],build:()=>{let h=o.Constant(0),x=o.Constant(1);return o.NativeFunction(\"distanceThreeD\",[o.NativeFunction(\"segmentThreeDGlider\",[f,h]),o.NativeFunction(\"segmentThreeDGlider\",[f,x])])}},{match:[Ie],build:()=>{let h=o.Constant(0),x=o.Constant(1);return o.NativeFunction(\"distance\",[o.NativeFunction(\"segmentGlider\",[f,h]),o.NativeFunction(\"segmentGlider\",[f,x])])}},{match:[ae],build:()=>{let h=o.NativeFunction(\"abs\",[o.NativeFunction(\"arcOmega\",[l[0]])]),{radius:x,startPoint:T}=uZ(o,l[0]),P=o.NativeFunction(\"arcThirdPoint\",[l[0]]);return o.Piecewise([o.Equal([h,o.Constant(0)]),o.NativeFunction(\"distance\",[T,P]),o.Multiply([x,h])])}},{match:[oI],build:()=>wD(e,ks(o,f))}])}else return o.NativeFunction(\"count\",l);case\"round\":return d([{match:[ge],build:()=>o.NativeFunction(\"round\",l)},{match:[ge,b],build:()=>{let f=o.NativeFunction(\"round\",[l[1]]),h=o.RawExponent([o.Constant(10),f]);return o.Divide([o.NativeFunction(\"round\",[o.Multiply([l[0],h])]),h])}},{match:[O],build:()=>o.NativeFunction(\"complexRound\",l)},{match:[O,b],build:()=>{let f=o.NativeFunction(\"round\",[l[1]]),h=o.RawExponent([o.Constant(10),f]);return o.Divide([o.NativeFunction(\"complexRound\",[o.Multiply([l[0],h])]),h])}}]);case\"abs\":return d([{match:[ge],build:()=>o.NativeFunction(t,l)},{match:[O],build:()=>PT(o,l[0])}]);case\"coerceToReal\":return d([{match:[O],build:()=>o.NativeFunction(\"peelableCoerceComplexToReal\",l)},{match:[Pn],build:()=>l[0]}]);case\"real\":return KV(o,l[0]);case\"imag\":return eB(o,l[0]);case\"conj\":return tB(o,l[0]);case\"exp\":case\"sin\":case\"cos\":case\"tan\":case\"sinh\":case\"cosh\":case\"tanh\":case\"sec\":case\"csc\":case\"cot\":case\"sech\":case\"csch\":case\"coth\":case\"arccot\":case\"arcsinh\":case\"arccsch\":case\"floor\":case\"ceil\":return d([{match:[ge],build:()=>zo(e,t,l)},{match:[O],build:()=>zo(e,ym[t],l)}]);case\"arctan\":return d([{match:[ge],build:()=>zo(e,t,l.concat(o.Constant(1)))},{match:[b,b],build:()=>zo(e,t,l)},{match:[O],build:()=>zo(e,ym[t],l)}]);case\"mod\":return d([{match:[ge,ge],build:()=>zo(e,t,l)},{match:[O,O],build:()=>zo(e,ym[t],l)}]);case\"nthroot\":return o.Exponent([l[0],o.Divide([o.Constant(1),l[1]])]);case\"complexNthRoot\":return o.NativeFunction(\"complexPow\",[l[0],o.Divide([o.Constant(1),l[1]])]);case\"sign\":return d([{match:[ge],build:()=>zo(e,t,l)},{match:[O],build:()=>{let f=l[0];return o.Piecewise([o.Equal([f,o.ZeroOfType(O)]),f,o.Divide([f,PT(o,f)])])}}]);case\"midpoint\":return d([{match:[Ie],build:()=>{let f=o.Constant(be(1,2));return o.NativeFunction(\"segmentGlider\",[l[0],f])}},{match:[Jt],build:()=>{let f=o.Constant(be(1,2));return o.NativeFunction(\"segmentThreeDGlider\",[l[0],f])}},{match:[N,N],build:XV},{match:[F,F],build:XV}]);case\"circle\":return d([{match:[N,Ie],build:()=>{let f=o.Constant(0),h=o.Constant(1);return o.NativeFunction(\"circle\",[l[0],o.NativeFunction(\"distance\",[o.NativeFunction(\"segmentGlider\",[l[1],f]),o.NativeFunction(\"segmentGlider\",[l[1],h])])])}},{match:[N,N],build:()=>o.NativeFunction(\"circle\",[l[0],o.NativeFunction(\"distance\",l)])},{match:[N,b],build:()=>o.NativeFunction(\"circle\",l)}]);case\"segment\":return d(yy(\"segment\",\"segmentThreeD\"));case\"vector\":return d(yy(\"vector\",\"vectorThreeD\"));case\"sphere\":return d([{match:[F,b],build:(f,h)=>f.NativeFunction(\"sphere\",h)},{match:[N,b],build:(f,h)=>f.NativeFunction(\"sphere\",[f.TupleOfType(F,[f.Slot(0,[h[0]]),f.Slot(1,[h[0]]),f.Constant(0)]),h[1]])}]);case\"distance\":return d(yy(\"distance\",\"distanceThreeD\"));case\"center\":return d([{match:[pe],build:()=>o.NativeFunction(\"center\",[l[0]])},{match:[ae],build:()=>o.NativeFunction(\"arcCenter\",[l[0]])}]);case\"radius\":return d([{match:[pe],build:()=>o.NativeFunction(\"radius\",[l[0]])},{match:[ae],build:()=>o.NativeFunction(\"distance\",[o.NativeFunction(\"arcFirstPoint\",[l[0]]),o.NativeFunction(\"arcCenter\",[l[0]])])}]);case\"glider\":return sB(e.chunk,l);case\"intersection\":case\"strictintersection\":{let f=0;t===\"strictintersection\"&&((ft(o,l[0],Ie)||ft(o,l[0],ae))&&(f+=3),(ft(o,l[1],Ie)||ft(o,l[1],ae))&&(f+=12),ft(o,l[0],De)&&(f+=1),ft(o,l[1],De)&&(f+=4));let h=lZ(e,s,l),x=h&&Du(h);if(!h||!x)return AD(o,l,f);let T=Me(e,new A.Identifier(x)),P=Ha(h);return P!==void 0&&(T=o.ListAccess([T,o.Constant(P)])),o.NativeFunction(\"chooseNonIncidentPoint\",[T,AD(o,[l[0],l[1]],f),AD(o,[l[1],l[0]],f<<2&12|f>>2&3)])}case\"parallel\":case\"perpendicular\":return d([{match:[dg,N],build:()=>{let h=[ST(o,l[0]),l[1]];return o.NativeFunction(t,h)}}]);case\"anglebisector\":return d([{match:[ve],build:()=>o.NativeFunction(\"anglebisector\",l)},{match:[Te],build:()=>o.NativeFunction(\"directedanglebisector\",l)}]);case\"start\":return ka(o,l[0]);case\"end\":return o.Add([ka(o,l[0]),ks(o,l[0])]);case\"translate\":case\"reflect\":case\"rotate\":case\"dilate\":return cZ(e,t,l);case\"apply\":return MT(o,l,n,!1);case\"normaldist\":case\"tdist\":case\"chisqdist\":case\"poissondist\":case\"binomialdist\":case\"uniformdist\":return o.Distribution(t,l);case\"median\":case\"quantile\":return ET(o,r)?Jy(o,l,t):zo(e,t,r);case\"stdev\":return ET(o,r)?Jy(o,l,t):d([{match:kr(ge,1),build:()=>zo(e,t,r)},{match:kr(O,1),build:()=>o.NativeFunction(\"sqrt\",[kV(o,l)])}]);case\"stdevp\":return d([{match:kr(ge,1),build:()=>zo(e,t,r)},{match:kr(O,1),build:()=>o.NativeFunction(\"sqrt\",[jy(o,l)])}]);case\"var\":return kV(o,l);case\"cov\":return d([{match:[$i,$i],noBroadcast:!0,build:()=>zo(e,t,r)},{match:[He,He],noBroadcast:!0,build:()=>{let f=o.NativeFunction(\"listMin\",[dr(o,l[0]),dr(o,l[1])]);return o.Divide([o.Multiply([OD(o,l),f]),o.Subtract([f,o.Constant(1)])])}}]);case\"corr\":return d([{match:[$i,$i],noBroadcast:!0,build:()=>zo(e,t,r)},{match:[He,He],noBroadcast:!0,build:()=>o.Divide([OD(o,l),o.NativeFunction(\"sqrt\",[o.Multiply([jy(o,[l[0]]),jy(o,[l[1]])])])])}]);case\"mad\":return d([{match:kr(ge,1),build:()=>zo(e,t,r)},{match:kr(O,1),build:()=>{let f=Bi(o,l);return Bi(o,l.map(h=>PT(o,o.Subtract([h,f]))))}}]);case\"pdf\":case\"cdf\":return Jy(o,l,t);case\"varp\":return jy(o,l);case\"covp\":return OD(o,l);case\"total\":case\"mean\":return t===\"mean\"&&ET(o,r)?Jy(o,l,t):nB(o,l,t);case\"lcm\":case\"gcd\":return d([{match:kr(ge,1),build:()=>o.NativeFunction(t,l)},{match:kr(O,1),build:()=>{let f;switch(t){case\"lcm\":f=\"complexLCM\";break;case\"gcd\":f=\"complexGCD\";break}return o.NativeFunction(f,l)}}]);case\"min\":return d([{match:[b,b],build:()=>o.NativeFunction(\"min\",l)},{match:kr(b,0),build:()=>o.NativeFunction(\"listMin\",l)},{match:[Et],build:()=>o.NamedSlot(\"min\",[l[0]])}]);case\"lower\":return d([{match:[Et],build:()=>o.NamedSlot(\"min\",[l[0]])}]);case\"max\":return d([{match:[b,b],build:()=>o.NativeFunction(\"max\",l)},{match:kr(b,0),build:()=>o.NativeFunction(\"listMax\",l)},{match:[Et],build:()=>o.NamedSlot(\"max\",[l[0]])}]);case\"upper\":return d([{match:[Et],build:()=>o.NamedSlot(\"max\",[l[0]])}]);case\"random\":{let f=l[0],h=l[1],x=o.getInstruction(l[0]),T=o.getInstruction(h);if(x.valueType!==Pt)throw V(`Unexpected value type for seed arg: ${x.valueType}`);if(T.valueType===so)throw rE();let P;if($(T.valueType))P=HV;else{if(T.type!==42||T.valueType!==Sn)throw V('Expected distribution argument to \"random\"');P=Ja[T.symbol][t]}if(l.length>2){let M=l[2],S=o.getInstruction(M);if(S.valueType!==b)throw V(`Expected numSamples argument to random() to be a number but got ${S.valueType}`);if(l.length===4){if(o.getInstruction(l[3]).valueType!==b)throw V(`Expected userSeed argument to random() to be a number but got ${S.valueType}`);f=o.ExtendSeed(\"us\",[f,l[3]])}let E=o.Constant(1),v=o.NativeFunction(\"round\",[o.NativeFunction(\"validateSampleCount\",[M])]),D=o.BeginBroadcast([v]);f=o.ExtendSeed(\"lc\",[f,o.Subtract([D,E])]);let G=P(o,h,[f]),j=o.EndBroadcast([D,G]);return o.BroadcastResult(Ln(o.getInstruction(G).valueType),[j])}return P(o,h,[f])}case\"shuffle\":{let f=l[0],h=l[1],x=l[2];if(!$(o.getInstruction(h).valueType)||x!==void 0&&o.getInstruction(x).valueType!==b)throw V(`Unexpected args for \"${t}\"`);return x!==void 0&&(f=o.ExtendSeed(\"us\",[f,x])),o.NativeFunction(\"shuffle\",[f,h])}case\"sort\":return d([{match:[Y],noBroadcast:!0,build:()=>WV(e,l[0],l[0])},{match:[Oo,Y],noBroadcast:!0,build:()=>WV(e,l[0],l[1])}]);case\"join\":return cy(o,l,n,r);case\"unique\":{let f=l[0],h=o.getInstruction(f);if(!$(h.valueType)||h.valueType===so)throw V(`Unexpected types for ${t}`);return o.NativeFunction(\"elementsAt\",[f,o.NativeFunction(\"uniquePerm\",[f])])}case\"polygon\":return d([{match:[],build:()=>{let f=o.ConstantOfType(Gt,[]);return o.NativeFunction(\"polygon\",[f])}},{match:[b,b],noBroadcast:!0,build:()=>{throw ff()}},{match:[b,b],build:()=>{let f=o.TupleOfType(N,l);return o.NativeFunction(\"polygon\",[f])}},{match:{type:\"variadic\",initial:[],rest:N},build:()=>o.NativeFunction(\"polygon\",l)}]);case\"directedangle\":return jV(e,l,n);case\"angle\":return o.NativeFunction(\"undirectedAngleMarker\",[jV(e,l,n)]);case\"angles\":return o.NativeFunction(\"polygonInteriorUndirectedAngles\",[l[0],Me(e,new A.Identifier(\"trigAngleMultiplier\"))]);case\"directedangles\":return o.NativeFunction(\"polygonInteriorDirectedAngles\",[l[0],Me(e,new A.Identifier(\"trigAngleMultiplier\"))]);case\"coterminal\":{if(ft(o,l[0],Te))return o.NativeFunction(\"directedCoterminalAngle\",l);if(ft(o,l[0],ve))return o.NativeFunction(\"undirectedCoterminalAngle\",l);throw V(`Unexpected types for ${t}`)}case\"ttest\":if(!e.policy.isNewStatsEnabled())throw Ls(n);return d([{match:[Y],noBroadcast:!0,build:()=>{let f=l[0],h=o.NativeFunction(\"count\",[f]);return o.TupleOfType(St,{mean:Bi(o,[f]),stdev:o.NativeFunction(\"stdev\",[f]),count:h,dof:o.Subtract([h,o.Constant(1)])})}},{match:[b,b,b],build:()=>{let f=l[2];return o.TupleOfType(St,{mean:l[0],stdev:l[1],count:f,dof:o.Subtract([f,o.Constant(1)])})}},{match:[Y,Y],noBroadcast:!0,build:()=>{let f=l[0],h=l[1],x={mean:Bi(o,[f]),count:o.NativeFunction(\"count\",[f]),stdev:o.NativeFunction(\"stdev\",[f])},T={mean:Bi(o,[h]),count:o.NativeFunction(\"count\",[h]),stdev:o.NativeFunction(\"stdev\",[h])};return o.TupleOfType(Mt,{mean1:x.mean,stdev1:x.stdev,count1:x.count,mean2:T.mean,stdev2:T.stdev,count2:T.count,dof:Jb(o,x,T)})}},{match:[b,b,b,b,b,b],build:()=>{let f={mean:l[0],stdev:l[1],count:l[2]},h={mean:l[3],stdev:l[4],count:l[5]};return o.TupleOfType(Mt,{mean1:f.mean,stdev1:f.stdev,count1:f.count,mean2:h.mean,stdev2:h.stdev,count2:h.count,dof:Jb(o,f,h)})}}]);case\"ztest\":return d([{match:[Y,Cr(b)],noBroadcast:!0,build:()=>{let f=l[0];return o.TupleOfType(Ht,{mean:Bi(o,[f]),count:o.NativeFunction(\"count\",[f]),stdevp:l[1]})}},{match:[b,b,b],build:()=>o.TupleOfType(Ht,{mean:l[0],count:l[1],stdevp:l[2]})},{match:[Y,Cr(b),Y,Cr(b)],noBroadcast:!0,build:()=>{let f=l[0],h=l[2];return o.TupleOfType(qt,{mean1:Bi(o,[f]),count1:o.NativeFunction(\"count\",[f]),stdevp1:l[1],mean2:Bi(o,[h]),count2:o.NativeFunction(\"count\",[h]),stdevp2:l[3]})}},{match:[b,b,b,b,b,b],build:()=>o.TupleOfType(qt,{mean1:l[0],count1:l[1],stdevp1:l[2],mean2:l[3],count2:l[4],stdevp2:l[5]})}]);case\"zproptest\":return d([{match:[b,b],build:()=>o.TupleOfType($t,{successes:l[0],count:l[1]})},{match:[b,b,b,b],build:()=>o.TupleOfType(Yt,{successes1:l[0],count1:l[1],successes2:l[2],count2:l[3]})}]);case\"null\":return rd(o,l);case\"conf\":return d([{match:[St,b],build:()=>{let f={mean:o.NamedSlot(\"mean\",[l[0]]),stdev:o.NamedSlot(\"stdev\",[l[0]]),count:o.NamedSlot(\"count\",[l[0]])},h=l[1];return LA(o,f,h)}},{match:[Mt,b],build:()=>{let f={mean:o.NamedSlot(\"mean1\",[l[0]]),stdev:o.NamedSlot(\"stdev1\",[l[0]]),count:o.NamedSlot(\"count1\",[l[0]])},h={mean:o.NamedSlot(\"mean2\",[l[0]]),stdev:o.NamedSlot(\"stdev2\",[l[0]]),count:o.NamedSlot(\"count2\",[l[0]])},x=l[1];return VA(o,f,h,x)}},{match:[Ut,b],build:()=>{let f={estimate:o.NamedSlot(\"pointEstimate\",[l[0]]),standardError:o.NamedSlot(\"standardError\",[l[0]]),dof:o.NamedSlot(\"dof\",[l[0]])},h=l[1];return FA(o,f,h)}},{match:[Ht,b],build:()=>{let f={mean:o.NamedSlot(\"mean\",[l[0]]),count:o.NamedSlot(\"count\",[l[0]])},h=o.NamedSlot(\"stdevp\",[l[0]]),x=l[1];return BA(o,f,h,x)}},{match:[qt,b],build:()=>{let f={mean:o.NamedSlot(\"mean1\",[l[0]]),count:o.NamedSlot(\"count1\",[l[0]])},h=o.NamedSlot(\"stdevp1\",[l[0]]),x={mean:o.NamedSlot(\"mean2\",[l[0]]),count:o.NamedSlot(\"count2\",[l[0]])},T=o.NamedSlot(\"stdevp2\",[l[0]]),P=l[1];return GA(o,f,h,x,T,P)}},{match:[$t,b],build:()=>_A(o,{successes:o.NamedSlot(\"successes\",[l[0]]),count:o.NamedSlot(\"count\",[l[0]])},l[1])},{match:[Yt,b],build:()=>wA(o,{successes:o.NamedSlot(\"successes1\",[l[0]]),count:o.NamedSlot(\"count1\",[l[0]])},{successes:o.NamedSlot(\"successes2\",[l[0]]),count:o.NamedSlot(\"count2\",[l[0]])},l[1])}]);case\"score\":{let f=o.getInstruction(l[0]).valueType,h=pu(Zn(f))?rd(o,l):l[0];return o.NamedSlot(\"score\",[h])}case\"dof\":return d([{match:[St],build:()=>o.NamedSlot(\"dof\",[l[0]])},{match:[Mt],build:()=>o.NamedSlot(\"dof\",[l[0]])},{match:[Ut],build:()=>o.NamedSlot(\"dof\",[l[0]])},{match:[Ot],build:()=>o.NamedSlot(\"dof\",[l[0]])}]);case\"point\":return d([{match:[Ut],build:()=>o.NamedSlot(\"pointEstimate\",[l[0]])},{match:[St],build:()=>o.NamedSlot(\"mean\",[l[0]])},{match:[Ht],build:()=>o.NamedSlot(\"mean\",[l[0]])},{match:[Mt],build:()=>o.Subtract([o.NamedSlot(\"mean1\",[l[0]]),o.NamedSlot(\"mean2\",[l[0]])])},{match:[qt],build:()=>o.Subtract([o.NamedSlot(\"mean1\",[l[0]]),o.NamedSlot(\"mean2\",[l[0]])])},{match:[$t],build:()=>o.Divide([o.NamedSlot(\"successes\",[l[0]]),o.NamedSlot(\"count\",[l[0]])])},{match:[Yt],build:()=>o.Subtract([o.Divide([o.NamedSlot(\"successes1\",[l[0]]),o.NamedSlot(\"count1\",[l[0]])]),o.Divide([o.NamedSlot(\"successes2\",[l[0]]),o.NamedSlot(\"count2\",[l[0]])])])}]);case\"stderr\":return d([{match:[Ut],build:()=>o.NamedSlot(\"standardError\",[l[0]])},{match:[St],build:()=>jM(o,{stdev:o.NamedSlot(\"stdev\",[l[0]]),count:o.NamedSlot(\"count\",[l[0]])})},{match:[Mt],build:()=>JM(o,{stdev:o.NamedSlot(\"stdev1\",[l[0]]),count:o.NamedSlot(\"count1\",[l[0]])},{stdev:o.NamedSlot(\"stdev2\",[l[0]]),count:o.NamedSlot(\"count2\",[l[0]])})},{match:[Ht],build:()=>QM(o,o.NamedSlot(\"stdevp\",[l[0]]),o.NamedSlot(\"count\",[l[0]]))},{match:[qt],build:()=>KM(o,o.NamedSlot(\"stdevp1\",[l[0]]),o.NamedSlot(\"count1\",[l[0]]),o.NamedSlot(\"stdevp2\",[l[0]]),o.NamedSlot(\"count2\",[l[0]]))},{match:[$t],build:()=>ZM(o,{successes:o.NamedSlot(\"successes\",[l[0]]),count:o.NamedSlot(\"count\",[l[0]])})},{match:[Yt],build:()=>XM(o,{successes:o.NamedSlot(\"successes1\",[l[0]]),count:o.NamedSlot(\"count1\",[l[0]])},{successes:o.NamedSlot(\"successes2\",[l[0]]),count:o.NamedSlot(\"count2\",[l[0]])})}]);case\"pleft\":{let f=o.getInstruction(l[0]).valueType,h=pu(Zn(f))?rd(o,l):l[0];return o.NamedSlot(\"pleft\",[h])}case\"pright\":{let f=o.getInstruction(l[0]).valueType,h=pu(Zn(f))?rd(o,l):l[0];return o.NamedSlot(\"pright\",[h])}case\"chisqtest\":return qA(o,l,n,r);case\"chisqgof\":return d([{match:[Y],noBroadcast:!0,build:()=>{let f=o.NativeFunction(\"mean\",l),h=o.Piecewise([o.ConstantOfType(Re,!0),f,l[0]]);return tC(o,l[0],h)}},{match:[Y,Y],noBroadcast:!0,build:()=>tC(o,l[0],l[1])}]);case\"chisqscore\":return HA(o,l,n,r);case\"chisqgofscore\":return eC(o,l[0],l[1]);case\"histogram\":case\"dotplot\":case\"boxplot\":case\"stats\":case\"ittest\":case\"det\":case\"inv\":case\"transpose\":case\"rref\":case\"trace\":case\"points\":case\"lines\":case\"circles\":case\"polygons\":case\"rays\":case\"arcs\":case\"vectors\":throw Ls(n);default:{let f=t;throw new Error(`Programming Error: unexpected compiler function ${f}`)}}}function sB(e,t){return Ri(e,t,\"glider\",[{match:[Ie,b],build:()=>e.NativeFunction(\"segmentGlider\",t)},{match:[Pe,b],build:()=>e.NativeFunction(\"lineGlider\",t)},{match:[De,b],build:()=>e.NativeFunction(\"rayGlider\",t)},{match:[pe,b],build:()=>e.NativeFunction(\"circleGlider\",t)},{match:[ae,b],build:()=>e.NativeFunction(\"arcGlider\",t)},{match:[Se,b],build:()=>e.NativeFunction(\"polygonGlider\",t)}])}function WV(e,t,n){let{chunk:r}=e;if(or(r,n)===0)return n;let o=r.NativeFunction(\"listMin\",[dr(r,t),dr(r,n)]);return n=r.ListAccess([n,FD(e,r.List([r.Constant(1)]),r.List([o]),{stepMustBePositive:!0})]),r.NativeFunction(\"elementsAt\",[t,rZ(e,[n])])}function rZ(e,t){let{chunk:n}=e,r=\"sortPerm\";return Ri(n,t,\"sort\",[{match:[$i],build:()=>n.NativeFunction(r,t),noBroadcast:!0},{match:[He],build:()=>n.NativeFunction(ym[r],t),noBroadcast:!0}])}function Jy(e,t,n){let r=t[0],s=e.getInstruction(r);if(!se(s.valueType,Sn))throw V(`Unexpected args for \"${n}\"`);let o=t.slice(1);for(let i of o)if(!se(e.getInstruction(i).valueType,b))throw V(`Unexpected args for \"${n}\"`);if($(s.valueType)){let i=[],a=1/0;for(let c of t){let p=Vr(e,c);i.push(p);let l=e.getInstruction(p);if($(l.valueType)){let m=or(e,p);if(m===void 0)throw Df(Ms(e,p));a=Math.min(a,m)}}let u=[];for(let c=0;c<a;c++){let p=ly(e,i[0],c),l=e.getInstruction(p);if(l.type!==42)throw V(`Unexpected opcode for distribution arg: ${l.type}`);let m=[];for(let d of i.slice(1))$(e.getInstruction(d).valueType)?m.push(ly(e,d,c)):m.push(d);u.push(Ja[l.symbol][n](e,p,m))}return e.List(u)}else{if(s.type!==42)throw V(`Unexpected opcode for distribution arg: ${s.type}`);return Ja[s.symbol][n](e,r,o)}}function ET(e,t){return t.length!==0&&e.getInstruction(t[0]).valueType!==Ae&&se(e.getInstruction(t[0]).valueType,Sn)}function sZ(e,t){Dr(t.args);let n=hl(e,t,t.args);return oB(e,n)}function oB(e,t){let{chunk:n}=e,r=!1,s=!1;for(let o=0;o<t.length;o++){let a=n.getInstruction(t[o]).valueType;r=r||a===it,s=s||a!==it}if(r&&s)throw V(\"Unexpected mix of actions and non-actions\");if(r)return iB(e,t);if(t.length===2)return n.TupleOfType(N,t);if(t.length==3)return n.TupleOfType(F,t);throw V(`Unexpected tuple dimensions: ${t.length}`)}function oZ(e,t){let{chunk:n}=e;Dr(t.args);let r=hl(e,t,t.args);if(r.length<1)throw V(\"Empty bare sequence\");let s=n.getInstruction(r[0]).valueType;if(s===b)throw V(\"Ambiguous bare sequence\");return s===it?iB(e,r):n.List(r)}function iB(e,t){let{chunk:n}=e,r=[],s=[];for(let o of t){let i=n.getInstruction(o);switch(i.type){case 49:{Array.prototype.push.apply(r,i.symbols),Array.prototype.push.apply(s,i.args);break}case 1:{let u=i.value.updateRules;for(let c of he(u)){let p=u[c];r.push(c),s.push(n.ConstantOfType(p.valueType,p.value))}break}default:{let a=Ms(n,o);throw a.length>0?HP(a):V(`Unexpected opcode for action: ${i.type}`)}}}return n.Action(r,s)}function LD(e,t){let{scope:n,policy:r}=e;if(n.isLocal(t))return Wg(t);let s=n.getVisibleGlobalDefinition(t);return r.assignmentForbidden(t)?BP(t):s&&s.type===\"FunctionDefinition\"?GP(t):VP(t).allowExport()}function iZ(e,t){switch(e.getInstruction(t).valueType){case Ie:case pe:case ae:return[e.Constant(0),e.Constant(1)];case Pe:return[e.Constant(-1/0),e.Constant(1/0)];case De:return[e.Constant(0),e.Constant(1/0)];case Se:return[e.Constant(0),e.NativeFunction(\"count\",[e.NativeFunction(\"vertices\",[t])])];default:return}}function aZ(e,t){let{policy:n,chunk:r,scope:s,selection:o}=e;if(!(t instanceof tc))throw new Error(\"Programming error: expected a ListComprehension node but got \"+t.type);let i=t._body,a=[],u=[],c=r.Constant(1),p=s.childScope();Dr(t._inputLists);for(let{_symbol:x}of t._inputLists){let T=x;p.setErrorIfAccessed(T,YS(T))}for(let x of t.parameters){let T=x.identifier._symbol;p.setErrorIfAccessed(T,ZS(T))}let l=ko(e,p);for(let x=t._inputLists.length-1;x>=0;x--){let T=t._inputLists[x],P=T._symbol,M=Me(l,T.args[1]);UV(r,o,T);let S=r.getInstruction(M);if(!$(S.valueType)){let v=iZ(r,M);if(v){a.push({symbol:P,object:M,gliderBounds:v});continue}let D;if(Hn(S.valueType)){let G=T.args[1].getInputSpan();G&&(D=pr(G))}throw kS(P,oe(S.valueType),D,{blockExport:Ue(S)})}let E=dr(r,M);u.push({symbol:P,assignedList:M,lengthIndex:E}),c=r.Multiply([c,E])}let m=s.childScope(),d=[],y;if(u.length>0){let x=r.Constant(1);y=r.BeginBroadcast([c],{type:\"list-comprehension\",callData:{inputListSymbols:u.map(P=>P.symbol)}}),m.addLexicalBinding(t._index._symbol,y);let T=x;for(let P=u.length-1;P>=0;P--){let{symbol:M,assignedList:S,lengthIndex:E}=u[P],v;if(u.length===1)v=y;else{let D=r.NativeFunction(\"floor\",[r.Divide([r.Subtract([y,x]),T])]);v=r.Add([r.NativeFunction(\"mod\",[D,E]),x]),P>0&&(T=r.Multiply([T,E]))}m.addDynamicBinding(M,r.ListAccess([S,v])),d.push(M)}}let g;if(t.parameters.length>0||a.length>0){let x=[],T=[];for(let P of t.parameters)x.push(P.identifier._symbol),T.push(Me(l,P.bounds[0]),Me(l,P.bounds[1]));for(let P of a)x.push(P.symbol),T.push(P.gliderBounds[0],P.gliderBounds[1]);g=r.BeginMap({parameterSymbols:x},T);for(let P=0;P<t.parameters.length+a.length;P++)r.BlockVar(b,[g]);for(let P=0;P<t.parameters.length;P++){let M=t.parameters[P].identifier._symbol,E=g+P+1;m.addDynamicBinding(M,E),d.push(M)}for(let P=0;P<a.length;P++){let M=a[P].symbol,S=g+t.parameters.length+P+1;m.addDynamicBinding(M,sB(r,[a[P].object,S])),d.push(M)}}let h=Me({...ko(e,m),substitutionContext:e.substitutionContext.for(s,e.recursiveFunctionContext,d)},i);if(g!==void 0){let x=r.EndMap([g,h]),T=r.getInstruction(h).valueType;if(Ia(T))throw o0();if(!aI(T))throw r0(T);let P=n.is3dPolicy()?2:1;if(t.parameters.length+a.length>P)throw T===F&&!n.is3dPolicy()?Ec(rs):s0(T,t.parameters.length);let M=uI(T,t.parameters.length+a.length);h=r.BlockVar(M,[x])}if(y!==void 0){let x=r.getInstruction(h);if(!Hn(x.valueType))throw Vl([oe(x.valueType)],{blockExport:Ue(x)});let T=r.EndBroadcast([y,h]);h=r.BroadcastResult(Ln(x.valueType),[T])}else t.shouldCoerceToList&&(h=r.List([h]));return h}function FD(e,t,n,r){let{stepMustBePositive:s}=r,{chunk:o}=e;t=Fo(o,t),n=Fo(o,n);let i=o.getInstruction(t),a=o.getInstruction(n),u=qa(o,t,\"Programming error: expected range start list to have constant length.\"),c=qa(o,n,\"Programming error: expected range start list to have constant length.\");if(i.valueType!==Y||a.valueType!==Y)throw Pf();let p=o.Constant(1),l=o.Constant(0),m=o.ListAccess([t,p]),d=o.ListAccess([t,o.Constant(2)]),y=o.ListAccess([n,o.Constant(c)]),g=o.Subtract([y,m]),f=u>1?o.Subtract([d,m]):o.Piecewise([o.GreaterEqual([g,l]),p,o.Constant(-1)]),h=o.Add([p,o.NativeFunction(\"round\",[o.Divide([g,f])])]),x=o.NativeFunction(\"validateRangeLength\",[t,n,f,h]);s&&(x=o.Piecewise([o.GreaterEqual([f,l]),x,l]));let T=o.BeginBroadcast([x]),P=o.Add([m,o.Multiply([f,o.Subtract([T,p])])]),M=o.EndBroadcast([T,P]);return o.addComments({[m]:\"start\",[d]:\"second\",[y]:\"last\",[h]:\"proposedLength\",[f]:\"step\",[P]:\"body\"}),o.BroadcastResult(Ln(o.getInstruction(P).valueType),[M])}function ST(e,t){return ft(e,t,Ie)?e.NativeFunction(\"lineFromSegment\",[t]):ft(e,t,ye)?e.NativeFunction(\"lineFromSegment\",[eZ(e,t)]):ft(e,t,De)?e.NativeFunction(\"lineFromRay\",[t]):t}function uZ(e,t){let n=e.NativeFunction(\"arcCenter\",[t]),r=e.NativeFunction(\"arcFirstPoint\",[t]),s=e.NativeFunction(\"distance\",[n,r]);return{center:n,radius:s,startPoint:r}}function jV(e,t,n){let{chunk:r}=e;if(t.length===3&&ft(r,t[0],N)&&ft(r,t[1],N)&&ft(r,t[2],N)){let s=t[0],o=t[1],i=t[2],a=r.Subtract([s,o]),u=r.Subtract([i,o]),c=r.Slot(0,[a]),p=r.Slot(1,[a]),l=r.Slot(0,[u]),m=r.Slot(1,[u]),d=r.NativeFunction(\"arctan\",[p,c]),y=r.Subtract([r.Multiply([c,m]),r.Multiply([p,l])]),g=r.Add([r.Multiply([c,l]),r.Multiply([p,m])]),f=r.NativeFunction(\"arctan\",[y,g]),h=r.NativeFunction(\"abs\",[f]),x=r.Constant(Math.PI),T=r.Constant(Math.PI*2);f=r.Piecewise([r.Equal([h,x]),x,r.Piecewise([r.Less([h,x]),f,r.Multiply([r.Multiply([r.NativeFunction(\"sign\",[f]),r.Constant(-1)]),r.Subtract([T,h])])])]);let P=r.NativeFunction(\"directedAngleMarker\",[o,d,f,Me(e,new A.Identifier(\"trigAngleMultiplier\"))]),M=r.Constant(0),S=r.And([r.Equal([y,M]),r.Equal([g,M])]);return r.Piecewise([S,r.NanOfType(Te),P])}else throw V(`Unexpected types for ${n}`)}function ZA(e,t){return e.Divide([e.NativeFunction(\"directedAngleMarkerRawDelta\",[t]),e.NativeFunction(\"directedAngleMarkerMultiplier\",[t])])}function XA(e,t){return e.NativeFunction(\"abs\",[e.Divide([e.NativeFunction(\"undirectedAngleMarkerRawDelta\",[t]),e.NativeFunction(\"undirectedAngleMarkerMultiplier\",[t])])])}function cZ(e,t,n){let{chunk:r,policy:s}=e,o=n.slice(1),i=Zf(s,t);if(!i)throw new Error(`Unexpected transformation type: ${t}`);let a=i.map(l=>{let m=0;for(let d=1;d<n.length;d++){let y=r.getInstruction(n[d]).valueType,g=l.argTypeAtIndex(d);g&&Cl(y,g)&&m++}return{signature:l,matchedArgsCount:m,signatureArgsCount:l.maxArity===void 0?l.initial.length+1:l.argTypes.length-1,providedArgsCount:n.length-1}}).sort((l,m)=>m.matchedArgsCount!==l.matchedArgsCount?m.matchedArgsCount-l.matchedArgsCount:l.signatureArgsCount-m.signatureArgsCount),u;switch(t){case\"translate\":{u=[{match:[ye],build:()=>r.NativeFunction(\"translation\",[r.NativeFunction(\"vectorDisplacementAsPoint\",o)])},{match:[N,N],build:()=>r.NativeFunction(\"translation\",[r.Subtract([o[1],o[0]])])}];break}case\"reflect\":{u=[{match:[dg],build:()=>{let l=ST(r,o[0]);return r.NativeFunction(\"reflection\",[l])}}];break}case\"rotate\":{u=[{match:[N,b],build:()=>{let l=Me(e,new A.Identifier(\"trigAngleMultiplier\"));return r.NativeFunction(\"rotation\",[o[0],r.Multiply([o[1],l])])}}];break}case\"dilate\":{u=[{match:[N,b],build:()=>r.NativeFunction(\"dilation\",o)}];break}default:{let l=t;throw new Error(`Programming error: exhaustive check failed: ${l}`)}}let c=r.areAllArgsConstant(o),p=Ri(r,o,()=>{throw aP(t,Ua(r,o),a[0].signature,{blockExport:c})},u);return MT(r,[p,n[0]],t,!0)}function MT(e,t,n,r){let s=[[Ne,\"compose\"],[N,\"transformPoint\"],[Ie,\"transformSegment\"],[Pe,\"transformLine\"],[De,\"transformRay\"],[ye,\"transformVector\"],[pe,\"transformCircle\"],[ae,\"transformArc\"],[Se,\"transformPolygon\"],[ve,\"transformAngleMarker\"],[Te,\"transformDirectedAngleMarker\"]].map(([i,a])=>({match:[Ne,i],build:(u,c)=>u.NativeFunction(a,c)}));function o(){if(r){let i=t.slice(1);throw uP(n,Wc(e,i),{blockExport:e.areAllArgsConstant(i)})}else throw Fs(n,Wc(e,t),{blockExport:e.areAllArgsConstant(t)})}return Ri(e,t,o,s)}function AD(e,t,n){let r=ST(e,t[0]),s=ST(e,t[1]),o=[r,s,e.ConstantOfType(b,n)];if(ft(e,r,pe)){if(ft(e,s,pe))return e.NativeFunction(\"circleCircleIntersection\",o);if(ft(e,s,ae))return e.NativeFunction(\"circleArcIntersection\",o);if(ft(e,s,Pe))return e.NativeFunction(\"circleLineIntersection\",o)}if(ft(e,r,ae)){if(ft(e,s,pe))return e.NativeFunction(\"arcCircleIntersection\",o);if(ft(e,s,ae))return e.NativeFunction(\"arcArcIntersection\",o);if(ft(e,s,Pe))return e.NativeFunction(\"arcLineIntersection\",o)}if(ft(e,r,Pe)){if(ft(e,s,pe))return e.NativeFunction(\"lineCircleIntersection\",o);if(ft(e,s,ae))return e.NativeFunction(\"lineArcIntersection\",o);if(ft(e,s,Pe))return e.NativeFunction(\"lineLineIntersection\",o)}throw V(\"Invalid intersection types\")}function lZ(e,[t,n],[r,s]){let{chunk:o,scope:i}=e,a=o.getInstruction(r).valueType,u=o.getInstruction(s).valueType,c=m=>{var d;return(d=i.getParseNode(m))!=null?d:i.getVisibleGlobalDefinition(m)},p=Aa(t)?c(t._symbol):t,l=Aa(n)?c(n._symbol):n;if(!(!p||!l))return bA({getGeometryTree:m=>$b(m).tree,lookup:c,isPointOrListOfPoints:m=>{if(Vc(m))return!1;let d=Me(e,m);return se(o.getInstruction(d).valueType,N)},resolvesTo:(m,d)=>i.getVisibleGlobalDefinition(m)===d},p,a,l,u)}function pZ(e,t){let{policy:n,scope:r}=e,s=t._body,o=r.childScope(),i=[];for(let u=0;u<t._assignments.length;u++){let c=t._assignments[u]._lhs,p;if(c instanceof Ve)p=c._symbol;else throw Nf();let l=t._assignments[u].args[1],m=r.getVisibleGlobalDefinition(p);if(m){if(m.type===\"FunctionDefinition\")throw Of(p);if(n.assignmentForbidden(p))throw Rf(p)}let d=Me(e,l);o.addDynamicBinding(p,d,l),i.push(p)}return Me({...ko(e,o),substitutionContext:e.substitutionContext.with(r,e.recursiveFunctionContext,i)},s)}var JV={points:Gt,lines:io,segments:lr,polygons:hr,circles:oo,arcs:ts,angles:Er,directedangles:Sr,rays:ns,vectors:ao};function mZ(e,t){let{chunk:n,scope:r}=e,s=r.getVisibleGlobalDefinition(\"construction\");if(!s)throw V(\"Expected 'construction' to be defined in the frame\");if(s.type!==\"Construction\"||!(s instanceof k))throw V(`Expected construction node but found ${s.type}}`);if(!Aa(t))throw V(`Expected identifier but found ${t.type}`);let o=t._symbol;if(!(o in JV))throw Ls(\"construction\");let i=JV[o];if(s.args.length===0)return n.ConstantOfType(i,[]);let a=Xe(i),u=[];for(let c of s.args)try{let p=Me(e,c);n.getInstruction(p).valueType===a&&u.push(p)}catch(p){if(p instanceof C)continue;throw p}return n.List(u)}function Qy(e,t){let n=e.args,r=e instanceof En?e._symbol:e instanceof zc||e instanceof Uc?e.args[0]._symbol:void 0;if(r&&t.definitions[r])return!1;if(e instanceof us){let a=[Qy(e.args[0],t)||new Xn(!0)],u=Qy(e.args[1],t),c=Qy(e.args[2],t);return u&&a.push(u),c&&a.push(c),a.length===1?!1:(a.length===2&&a.push(a[1]),new us(a))}let s=[],o=!1;for(let i of n){let a=Qy(i,t);if(a===!1){o=!0;continue}s.push(a)}return o?!1:e.copyWithArgs(s)}function aB(e,t,n){let{chunk:r,scope:s}=e,o={},i=he(n.definitions);for(let y of i){let g=n.definitions[y];if(g instanceof C)throw g;o[y]=g}let a=t._argSymbols.map(y=>Me(e,new hn(y))),u=new _D(o,n.baseCases);try{cB(e,u,t,a)}catch(y){throw u.isUnconditionallyRecursive&&y instanceof C&&!y.blocksExport?i.length>1||uB(t,t._expression)?Hl(i,{suggestAlternativeFunctionName:!1}):qg(i):y}let c={},p={},l={},m=s.childScope();for(let y of i){let g=u.returnTypes[y];if(g===void 0)throw V(`Could not infer the return type for recursive function ${y}.`);let f=u.argTypes[y];if(f===void 0)throw V(`Could not infer the argument types for recursive function ${y}.`);p[y]={argTypes:f},c[y]=g,l[y]=r.FunctionHeader(y,g,p[y],o[y]._argSymbols),m.addLexicalBinding(y,l[y])}let d=[];for(let y of i)d.push(l[y]);for(let y of d)r.getInstruction(y).recursionGroup=d;for(let y of i){let g=m.childScope(),f=o[y],h=l[y],x=r.BeginFunction([h]);for(let M=0;M<f._argSymbols.length;M++){let S=f._argSymbols[M],E=r.BlockVar(p[y].argTypes[M],[x]);g.addLexicalBinding(S,E)}let T={...ko(e,g),recursiveFunctionContext:{type:\"compile-general\",fnSymbols:i}},P=lB(T,f,n.baseCases,Me(T,f._expression));if(r.getInstruction(P).valueType!==c[y])throw Fs(y,Ua(r,a),{blockExport:r.areAllArgsConstant(a)});P=Vr(r,P),r.EndFunction([x,P])}if(u.isUnconditionallyRecursive){let y=r.getRecursiveFunctionMetadata(l[t._symbol]),g=y==null?void 0:y.recursiveStructure;throw g!=null&&g.canIterate?new Error(\"Programming error: expected canIterate==false for unconditionally recursive function.\"):g!=null&&g.maxRecursiveCallOffsets&&i.every(f=>g.maxRecursiveCallOffsets[f]===0)?Hl(i,{suggestAlternativeFunctionName:!1}):VI(i,{type:\"missing-non-recursive-branch\",recursionGroup:i,recursiveStructure:g})}return r.FunctionCall([l[t._symbol],...a])}function uB(e,t){return t instanceof En&&t._symbol===e._symbol?t.args.every((n,r)=>n instanceof Ve&&n._symbol===e._argSymbols[r]):t.args.every(n=>uB(e,n))}function cB(e,t,n,r){let{chunk:s}=e,o=t.returnTypes[n._symbol],i=t.argTypes[n._symbol];if(o!==void 0&&i!==void 0)return{returnType:o,argTypes:i};let a=n._argSymbols.length,u=r.length;if(a!==u)throw Da(n._symbol,a,u,{includeUsageExample:!0});let c=r.map(d=>s.getInstruction(d).valueType),p=`${n._symbol}:${c.join(\",\")}:${Object.keys(t.returnTypes).join(\",\")}`;if(t.stack.includes(p))return t.isUnconditionallyRecursive=!0,{returnType:b,argTypes:c};t.stack.push(p);let l=s.getReturnIndex(),m;return bT(e,d=>{var M;let y=Qy(n._expression,t),g=n._symbol,f=(M=t.baseCases[g])!=null?M:[],h={...d,recursiveFunctionContext:t},x=h.scope,T=[];for(let S=0;S<n._argSymbols.length;S++){let E=n._argSymbols[S],v=s.SymbolicVar(c[S]);T.push(v),x.addLexicalBinding(E,v)}if(!t.baseCaseTypes.hasOwnProperty(g)){let S,E,v,D=!0;for(let G of f){let j=G.getRef();if(!G.specifiedArg.valid||!j)continue;let Q=new hn(j),W=Me(h,Q);v||(v=Q);let K=s.getInstruction(W),J=K.valueType;if(Ue(K)||(D=!1),S===void 0)S=G.specifiedArg.argIndex;else if(S!==G.specifiedArg.argIndex)throw of();let re=E;if(re===void 0)E=J;else{let ie=Yu(re,J);if(ie===void 0)throw sf({blockExport:D});E=ie}}t.baseCaseTypes[g]=E,t.firstValidBaseCaseIdentifiers[g]=v}let P=t.firstValidBaseCaseIdentifiers[g];if(y||P){let S=lB(h,n,t.baseCases,Me(h,y||P)),{someArgBroadcasts:E,inferredArgTypes:v}=dZ(s,T,l,S);if(c=v,m=s.getInstruction(S).valueType,E){if(!$(m))throw V(`TODO: expected a list type but found ${We(m)}`);m=Xe(m)}let D=t.returnTypes[n._symbol];if(D!==void 0&&m!==D)throw sf({blockExport:!1});t.argTypes[n._symbol]=v,t.returnTypes[n._symbol]=m}}),bT(e,d=>{let y={...d,recursiveFunctionContext:t},g=y.scope;for(let T=0;T<n._argSymbols.length;T++){let P=n._argSymbols[T],M=s.SymbolicVar(c[T]);g.addLexicalBinding(P,M)}let f=Me(y,n._expression);t.stack.pop();let h=s.getInstruction(f).valueType,x=m===void 0?h:Yu(m,h);if(x===void 0)throw V(`Mismatched return types: ${m&&We(m)} vs ${We(h)}`);return t.returnTypes[n._symbol]=x,{returnType:x,argTypes:c}})}function dZ(e,t,n,r){let s=[],u=[];for(let l=0;l<r-n;l++)u.push(0);if(e.getInstruction(r).type===48){u.push(1);for(let l=r;l>=0;l--){let m=u[l-n];if(m===0)continue;let d=e.getInstruction(l);if(ce(d)){if(d.type===24?s.push(l):d.type===23&&s.pop(),(d.type===48||d.type===24)&&(u[d.args[0]-n]|=m),d.type===39||d.type===41||d.type===40)for(let y of s){let f=e.getInstruction(y).args[0];if(d.args[1]===f){u[d.args[0]-n]|=m;break}}if(s.length>0){let y=s[s.length-1],f=e.getInstruction(y).args[0];for(let h of d.args)h>=f&&(u[h-n]|=m);d.type===33&&d.args[0]>=f&&(u[d.args[0]-n]|=2)}}}}let c=[],p=!1;for(let l=0;l<t.length;l++){let m=t[l],d=e.getInstruction(m).valueType;if(u[m-n]&2){if(!$(d))throw V(`Expected list type but found ${We(d)}`);p=!0,c.push(Xe(d))}else c.push(d)}return{inferredArgTypes:c,someArgBroadcasts:p}}function lB(e,t,n,r){let{chunk:s}=e,o=!0,i=n[t._symbol];for(let a of i){let u=a.specifiedArg;if(!u.valid)continue;let c=t._argSymbols[u.argIndex],p=Me(e,new hn(c)),l=s.Equal([p,s.Constant(u.argValue)]),m=Me(e,a),d=s.getInstruction(m);Ue(d)||(o=!1);let y=s.getInstruction(m).valueType,g=s.getInstruction(r).valueType;if(Yu(y,g)===void 0)throw sf({blockExport:o});r=s.Piecewise([l,m,r])}return r}function fZ(e){return e.type===\"Constant\"&&Number.isInteger(e.asValue())}function QV(e,t,n,r){var m;let{policy:s,chunk:o,scope:i}=e,a=new A.Identifier(t),u,c;r.length===1?(u=n[0],c=r[0]):(u=new A.ParenSeq(n),za(o,s,u,r),c=oB(e,r));let l=[(m=i.getSymbol(t))!=null?m:Me(e,a),c];return za(o,s,new A.Multiply([a,u]),l),o.Multiply(l)}function yZ(e,t){var d;let{chunk:n,scope:r}=e;if(t._symbol!==\"ttest\"||t.args.length!==1||t.args[0].type!==\"Identifier\"||t.args[0]._symbol===void 0)return;let s=r.getVisibleGlobalDefinition(t.args[0]._symbol);if((s==null?void 0:s.type)!==\"RegressionParameter\")return;let o=s,i=o._optimizedRegression;if(!i.scaleFactors)throw LI(\"Regression parameter inference is only supported for linear regressions.\");let a=o.asCompilerValue(),u=i.residuals.asValue(),c=u.length-Object.keys(i.parameters).length,p=(d=i.scaleFactors[o._symbol])==null?void 0:d.asValue(),l=0;for(let y of u)l+=y*y;let m=Math.sqrt(p*(l/c));return n.TupleOfType(Ut,{pointEstimate:n.Constant(a),standardError:n.Constant(m),dof:n.Constant(c)})}function Ga(e,t,n,r){var o;if(e.type===\"Error\")return e;let s=Dd({policy:t,frame:n,wrapInList:r&&r.wrapInList,coerceToNumber:r&&r.coerceToNumber},e);return t.isGeometryEnabled()&&s.argNames.some(i=>i[0]===\"$\")?n0():(o=s.getError())!=null?o:new Dn(s)}var Qa=function(e,t=\"\",n=0){let r=Array(n+1).join(\"  \"),s=r+\"  \";return`[\n`+s+e.map(o=>o.repr(t,n+1)).join(`,\n`+s)+`\n`+r+\"]\"},ur=function(e,t=\"\"){return t=t||\"\",\"new \"+t+e};k.prototype.repr=function(e,t){return ur(this.type,e)+\"(\"+Qa(this.args,e,t)+\")\"};os.prototype.repr=function(e,t){return e===\"nodes.\"?`new nodes[\"${this.type}\"](`+Qa(this.args,e,t)+\")\":ur(this.type,e)+\"(\"+Qa(this.args,e,t)+\")\"};A.IRExpression.prototype.repr=function(e,t=0){let n=Array(t+1).join(\"  \"),r=n+\"  \",s=this._chunk.print().split(`\n`);return s.pop(),ur(this.type,e)+\"(`\\n\"+r+s.join(`\n`+r)+`\n`+n+\"`)\"};A.DoubleInequality.prototype.repr=function(e,t=0){let n=Array(t+1).join(\"  \"),r=n+\"  \";return ur(this.type,e)+`([\n`+r+this.args[0].repr(e,t+1)+`,\n`+r+\"'\"+this.args[1]+`',\n`+r+this.args[2].repr(e,t+1)+`,\n`+r+\"'\"+this.args[3]+`',\n`+r+this.args[4].repr(e,t+1)+`\n`+n+\"])\"};A.ComparatorChain.prototype.repr=function(e,t=0){return ur(this.type,e)+\"([\"+this.symbols.map(n=>`'${n}'`).join(\",\")+`],\n`+Qa(this.args,e,t)+\")\"};Ve.prototype.repr=function(e){return ur(this.type,e)+\"('\"+this._symbol+\"')\"};_n.prototype.repr=function(e){return ur(this.type,e)+\"(\"+this.asValue()+\")\"};A.ExtendSeed.prototype.repr=function(e,t){return ur(this.type,e)+\"('\"+this.tag+\"', \"+Qa(this.args,e,t)+\")\"};A.Seed.prototype.repr=function(e){return ur(this.type,e)+\"(\"+this.asValue()+\")\"};En.prototype.repr=function(e,t){return ur(this.type,e)+\"('\"+this._symbol+\"', \"+Qa(this.args,e,t)+\")\"};A.RecursiveFunctionBaseCase.prototype.repr=function(e,t){return this.originalNode.repr(e,t)};Rn.prototype.repr=function(e,t){return ur(this.type,e)+\"(\"+new A.Identifier(this._symbol).repr(e,t)+\", \"+this._expression.repr(e,t)+\")\"};A.AssignmentImport.prototype.repr=function(e,t){return ur(this.type,e)+\"(\"+new A.Identifier(this._symbol).repr(e,t)+`, qualifiedName(${this._importFrom.frameID},${this._importFrom.frameID}))`};A.Regression.prototype.repr=A.Equation.prototype.repr=A.CallAssignment.prototype.repr=function(e,t){return ur(this.type,e)+\"(\"+this._lhs.repr(e,t)+\", \"+this._rhs.repr(e,t)+\")\"};A.FunctionDefinition.prototype.repr=function(e,t){return ur(this.type,e)+\"(\"+new A.Identifier(this._symbol).repr(e,t)+\", \"+Qa(this._argSymbols.map(n=>new A.Identifier(n)),e,t)+\", \"+this._expression.repr(e,t)+\")\"};A.Error.prototype.repr=function(e,t){return ur(this.type,e)+\"('\"+this._msg+\"')\"};A.Derivative.prototype.repr=function(e,t){return ur(this.type,e)+\"('\"+this._symbol+\"', \"+Qa(this.args,e,t)+\")\"};A.SolvedEquation.prototype.repr=function(e,t){return ur(this.type,e)+\"('\"+this._symbol+\"', \"+this._expression.repr(e,t)+\")\"};A.OptimizedRegression.prototype.repr=function(e,t=0){return ur(this.type,e)+\"(\"+JSON.stringify(this.parameters)+\", \"+JSON.stringify(this.residuals)+\", \"+JSON.stringify(this.statistics)+\", \"+this.model.repr(e,t+1)+\", \"+JSON.stringify({isModelValid:this.isModelValid,residualVariable:this.residualVariable,residualSuggestionId:this.residualSuggestionId,shouldSuggestLogMode:this.shouldSuggestLogMode,isLinear:this.isLinear,parameterWarning:this.parameterWarning})+\")\"};A.Table.prototype.repr=function(e,t){return ur(this.type,e)+\"(\"+Qa(this.columns,e,t)+\", \"+this.tableFrameID+\")\"};A.TableColumn.prototype.repr=function(e,t){return ur(this.type,e)+\"(\"+this.header.repr(e,t)+\", \"+this.length+\", \"+Qa(this.values,e,t)+\", \"+this.tableFrameID+\", \"+this.columnIndex+\")\"};A.TableColumnValue.prototype.repr=function(e,t){return\"TableColumnValue(\"+Qa(this.rawArgs,e,t)+\", \"+this.headerSymbol+\")\"};A.Image.prototype.repr=function(e,t=0){let n=Array(t+1).join(\"  \"),r=n+\"  \";return ur(this.type,e)+`({\n`+r+\"center: \"+this.center.repr(e,t+1)+`,\n`+r+\"radianAngle: \"+this.radianAngle.repr(e,t+1)+`,\n`+r+\"width: \"+this.width.repr(e,t+1)+`,\n`+r+\"height: \"+this.height.repr(e,t+1)+`},\n`+r+\"opacity: \"+this.opacity.repr(e,t+1)+`,\n`+r+JSON.stringify(this.moveStrategy)+`\n`+n+\"})\"};A.Ticker.prototype.repr=function(e,t=0){let n=Array(t+1).join(\"  \"),r=n+\"  \";return ur(this.type,e)+`({\n`+r+\"handler: \"+this.handler.repr(e,t+1)+`,\n`+r+\"minStep: \"+this.minStep.repr(e,t+1)+`\n`+n+\"})\"};A.Slider.prototype.repr=function(e,t=0){let n=Array(t+1).join(\"  \"),r=n+\"  \";return ur(this.type,e)+`({\n`+r+\"sliderAssignment: \"+this.sliderAssignment.repr(e,t+1)+`,\n`+r+\"sliderMin: \"+(this.sliderMin&&this.sliderMin.repr(e,t+1))+`,\n`+r+\"sliderMax: \"+(this.sliderMax&&this.sliderMax.repr(e,t+1))+`,\n`+r+\"sliderStep: \"+(this.sliderStep&&this.sliderStep.repr(e,t+1))+`},\n`+n+\")\"};A.ImaginaryUnit.prototype.repr=function(e){return ur(this.type,e)+\"()\"};A.RegressionParameter.prototype.repr=function(e,t){return ur(this.type,e)+\"('\"+this._symbol+\"', \"+this._optimizedRegression.repr(e,t)+\")\"};var CT=function(e,t){return e.map(n=>n.substitute(t))};Ve.prototype.substitute=function(e){return e[this._symbol]?e[this._symbol]:this};En.prototype.substitute=function(e){let t=e[this._symbol];if(t){if(t.type===\"Identifier\")return new A.FunctionCall(t,CT(this.args,e));if(t.type===\"Constant\")return new A.Multiply([t,this.args.length===1?this.args[0].substitute(e):new A.Constant(NaN)])}return k.prototype.substitute.call(this,e)};_n.prototype.substitute=function(e){return this};k.prototype.substitute=function(e){return this.copyWithArgs(CT(this.args,e))};A.Derivative.prototype.substitute=function(e){let t=e[this._symbol];if(t){if(t.type===\"Identifier\")return new A.Derivative(t,CT(this.args,e));throw new Error(\"Cannot substitute for a derivative variable with a non-Identifier\")}return new A.Derivative(this._symbol,CT(this.args,e))};k.prototype.simpleFunctionExpression=function(){return this};Rn.prototype.simpleFunctionExpression=function(){return this._expression};A.FunctionDefinition.prototype.simpleFunctionExpression=function(){return this._expression};A.RecursiveFunctionBaseCase.prototype.simpleFunctionExpression=function(){return this._expression};A.Equation.prototype.simpleFunctionExpression=A.CallAssignment.prototype.simpleFunctionExpression=function(){return this.asComparator().simpleFunctionExpression()};function mB(e){return e instanceof _n||e instanceof Di&&e.args.length===1&&e.args[0]instanceof _n}function pB(e){return!!(e instanceof Ve&&e._symbol===Nr||(e instanceof A.Multiply||e instanceof A.CrossMultiply||e instanceof A.DotMultiply)&&e.args.length===2&&e.args.some(t=>t instanceof Ve&&t._symbol===Nr)&&e.args.some(t=>mB(t))||e instanceof A.Negative&&e.args[0]instanceof Ve&&e.args[0]._symbol===Nr||e instanceof En&&e._symbol===Nr&&e.args.length===1&&e.args[0]instanceof _n)}function dB(e){return e instanceof Rn?eg(e._expression):eg(e)}function eg(e){return pB(e)?!0:(e instanceof A.Add||e instanceof A.Subtract)&&e.args.some(t=>pB(t))&&e.args.some(t=>mB(t))}function VD(e){let t;for(let n=0;n<e.length;n++)if(e[n].dependsOn(Nr)){if(t!==void 0)return;t=n}return t}function Ky(e,t){var n;if(t.dependsOn(Nr))switch(t.type){case\"Identifier\":return new A.Constant(1);case\"Negative\":{let r=Ky(e,t.args[0]);return r===void 0?void 0:t.copyWithArgs([r])}case\"Multiply\":case\"DotMultiply\":case\"CrossMultiply\":switch(VD(t.args)){case 0:{let s=Ky(e,t.args[0]);return s===void 0?void 0:t.copyWithArgs([s,t.args[1]])}case 1:{let s=Ky(e,t.args[1]);return s===void 0?void 0:t.copyWithArgs([t.args[0],s])}default:return}case\"Divide\":{if(VD(t.args)!==0)return;let s=Ky(e,t.args[0]);return s===void 0?void 0:t.copyWithArgs([s,t.args[1]])}case\"FunctionCall\":return t._symbol===Nr&&t.args.length===1&&!t.args[0].dependsOn(Nr)?t.args[0]:t.args.length===1&&t.args[0].type===\"Identifier\"&&t.args[0]._symbol===Nr&&t._symbol!==void 0&&((n=e[t._symbol])==null?void 0:n.type)!==\"Placeholder\"?new A.Identifier(t._symbol):void 0;default:return}}function vT(e,t){if(t.dependsOn(Nr))switch(t.type){case\"Add\":case\"Subtract\":switch(VD(t.args)){case 0:{let r=vT(e,t.args[0]);return r===void 0?void 0:[t.copyWithArgs([r[0],t.args[1]]),r[1]]}case 1:{let r=vT(e,t.args[1]);return r===void 0?void 0:[t.copyWithArgs([t.args[0],r[0]]),t.type===\"Subtract\"?new A.Negative([r[1]]):r[1]]}default:return}default:{let n=Ky(e,t);return n===void 0?void 0:[new A.Constant(0),n]}}}var fB=new A.Constant(be(0,1));Rn.prototype.getMoveStrategy=function(e,t,n,r){return this._expression.getMoveStrategy(e,t,n,r)};function gZ(e){return{type:\"updateSliderNonlinear\",id:e.id,initialValue:e.initialValue,min:e.min,max:e.max,compiled:e.compiled,isComplex:e.isComplex}}function hZ(e){return{type:\"updateGliderParameter\",span:e.span,movesOn:e.movesOn}}function bZ(e){return{type:\"updateSliderForGlider\",id:e.sliderId,movesOn:e.movesOn,min:e.min,max:e.max}}function yB(e,t,n,r,s,o){var a,u;let i=t.getDependencies();for(let c of i)if(s[c])return;for(let c=i.length-1;c>=0;c--){let p=i[c];if(o[p])continue;let l=r[p];if(l===void 0)continue;let m=n[p];if(m.order!==1)continue;let d=m.tree,y=d.type===\"IRExpression\"?d.getPolynomialCoefficients(p):void 0,g=(a=y==null?void 0:y[1])!=null?a:fB,f=(u=y==null?void 0:y[0])!=null?u:fB;if(!Pm(f)||!Pm(g)||!isFinite(f.asValue())||!isFinite(g.asValue())||g.asValue()===0)continue;let h=[-f.asValue()/g.asValue(),1/g.asValue()];return{symbol:p,id:l,coefficients:h}}}function xZ(e,t){for(let n of he(t))if(t[n].evaluationState.assignment===e)return n}function TZ(e){let t={};for(let n=0;n<e.length;n++)t[e[n]]=!0;return t}function BD(e,t){let n=TZ(e),r={};for(let s of he(t)){let o=t[s].evaluationState.assignment;t[s].evaluationState.is_slidable&&n[o]&&(r[o]=s)}return r}function gB(e,t,n,r){let s=[];for(let o=0;o<n.length;o++){let i=n[o],a={};s.push(a);for(let u=0;u<r.length;u++){let c=r[u],p=On(t);p[c]=void 0;let l=de(i,e,p);if(l.type===\"Error\"){a[c]={tree:l,order:1/0};continue}else a[c]={tree:l,order:l.polynomialOrder(c)}}}return s}function hB(e,t,n){for(let r=0;r<e.length;r++){let s=e[r];t[s].order!==0&&(n[s]=!0)}}Di.prototype.getMoveStrategy=function(e,t,n,r){return bB(this,e,t,n,r)};function bB(e,t,n,r,s){var T;let o=r.valueType===O;if(r.valueType!==N&&!o||r.getDependencies().length!==0)return;if(o&&dB(e)){let P=e.getInputSpan();return P?[{type:\"updateCoordinate\",inputSpan:P},{type:\"updateCoordinate\",inputSpan:P}]:[{type:\"none\"},{type:\"none\"}]}let i=e.getDependencies(),a=BD(i,s),u=he(a),c;o?c=vT(n,e):c=e.args;let p=[{type:\"none\"},{type:\"none\"}];if(c){let P=gB(t,n,c,u),M={},S={};for(let E=0;E<2;E++){let v=c[E],D=e.args[E];if(Pm(D)&&!o){let j=D==null?void 0:D.getInputSpan();p[E]=j?{type:\"updateCoordinate\",inputSpan:j}:{type:\"none\"};continue}let G=yB(t,v,P[E],a,M,S);G&&(p[E]={type:\"updateSlider\",id:G.id,coefficients:G.coefficients},M[G.symbol]=!0,hB(u,P[E],S)),p[E]||(p[E]={type:\"none\"})}o&&(p[0].type===\"updateSlider\"&&p[1].type===\"none\"?de(c[1],t,n).valueType!==b&&(p[0]={type:\"none\"}):p[0].type===\"none\"&&p[1].type===\"updateSlider\"&&de(c[0],t,n).valueType!==b&&(p[1]={type:\"none\"}))}let[l,m]=p,d;if(l.type===\"none\"&&m.type===\"none\"&&u.length===1&&(d=u[0]),!d)return l.type!==\"none\"||m.type!==\"none\"?p:void 0;let y=a[d],g=On(n);g[d]=void 0;let f=de(e,t,g);if(f.isError)return;let h=f.getCompiledFunction();xM(h);let x=s[y].evaluationState;return[gZ({id:y,initialValue:(T=x.typed_constant_value)==null?void 0:T.value,min:x.slider_min_number,max:x.slider_max_number,compiled:h,isComplex:o}),{type:\"none\"}]}function IZ(e,t,n,r,s){if(!Ni(r)||r.valueType!==N)return;let o,i,a;switch(e.args[1].type){case\"Constant\":{if(typeof e.args[1].asValue()!=\"number\"||(o=de(e.args[0],t,n),!Ni(o)))return;a=Cs(o);let c=e.args[1].getInputSpan();return[c?hZ({span:c,movesOn:a}):{type:\"none\"},{type:\"none\"}]}case\"Identifier\":{let u=e.args[1]._symbol;if(!u)return;let p=BD([u],s)[u];if(p===void 0)return;let l=s[p].evaluationState,m=On(n);return m[u]=void 0,o=de(e.args[0],t,m),Ni(o)?(a=Cs(o),i={min:l.slider_min_number,max:l.slider_max_number},[bZ({min:i.min,max:i.max,movesOn:a,sliderId:p}),{type:\"none\"}]):void 0}default:return}}function xB(e,t,n,r,s){if(r.valueType===O)return bB(e,t,n,r,s)}k.prototype.getMoveStrategy=function(e,t,n,r){return xB(this,e,t,n,r)};En.prototype.getMoveStrategy=function(e,t,n,r){return this._symbol==\"glider\"?IZ(this,e,t,n,r):xB(this,e,t,n,r)};A.Image.prototype.getMoveStrategy=function(e,t,n,r){if(n.center.valueType!==N||n.center.getDependencies().length!==0||n.radianAngle.type!==\"IRExpression\"||n.width.type!==\"IRExpression\"||n.height.type!==\"IRExpression\"||n.opacity.type!==\"IRExpression\"||!n.width.isConstant||!n.height.isConstant||!n.radianAngle.isConstant||!n.opacity.isConstant)return;let s=this.getDependencies(),o=BD(s,r),i=he(o),a=[this.width,this.height];this.center.type===\"ParenSeq\"?a.push(this.center.args[0],this.center.args[1]):this.center.type===\"Identifier\"&&(this.center.referencedStatementId=xZ(this.center._symbol,r));let u={},c={},p=gB(e,t,a,i),l=[{type:\"none\"},{type:\"none\"},{type:\"none\"},{type:\"none\"}],m=[2,3,0,1];for(let d=0;d<m.length;d++){let y=m[d],g=a[y];if(!g)continue;if(g.type===\"Constant\"){let h=g.getInputSpan();l[y]=h?{type:\"updateCoordinate\",inputSpan:h}:{type:\"none\"};continue}let f=yB(e,g,p[y],o,u,c);f&&(l[y]={type:\"updateSlider\",id:f.id,coefficients:f.coefficients},u[f.symbol]=!0,hB(i,p[y],c))}if(!(l[0].type===\"none\"&&l[1].type===\"none\"&&l[2].type===\"none\"&&l[3].type===\"none\"))return l};var GD=e=>e==null?void 0:e.some(t=>\"isComplex\"in t&&t.isComplex);function tg(e,t){if(e instanceof En||e instanceof Rn){if(t[0].type!==\"none\"&&t[1].type!==\"none\")return on.XY;if(t[0].type!==\"none\")return on.X;if(t[1].type!==\"none\")return on.Y}else if(e instanceof k){if(t[0].type===\"updateSlider\"&&t[1].type===\"updateSlider\")return on.XY;if(t[0].type===\"updateSlider\")return on.X;if(t[1].type===\"updateSlider\")return on.Y;if(t[0].type===\"updateSliderNonlinear\"&&t[0].isComplex)return on.X}return on.NONE}var DT={normaldist:{type:\"distribution\",symbol:\"normaldist\",params:[\"mean\",\"stdev\"],defaults:[\"0\",\"1\"],discrete:!1},tdist:{type:\"distribution\",symbol:\"tdist\",params:[\"dof\",\"shift\",\"scale\"],defaults:[void 0,\"0\",\"1\"],discrete:!1},chisqdist:{type:\"distribution\",symbol:\"chisqdist\",params:[\"dof\"],defaults:[void 0],discrete:!1},binomialdist:{type:\"distribution\",symbol:\"binomialdist\",params:[\"trials\",\"probsuccess\"],defaults:[void 0,\"0.5\"],discrete:!0},poissondist:{type:\"distribution\",symbol:\"poissondist\",params:[\"mean\"],defaults:[void 0],discrete:!0},uniformdist:{type:\"distribution\",symbol:\"uniformdist\",params:[\"min\",\"max\"],defaults:[\"0\",\"1\"],discrete:!1}},PZ={Histogram:{type:\"visualization\",symbol:\"histogram\",params:[\"data\",\"binwidth\"],defaults:[void 0,\"1\"]},DotPlot:{type:\"visualization\",symbol:\"dotplot\",params:[\"data\",\"binwidth\"],defaults:[void 0,\"1\"]},BoxPlot:{type:\"visualization\",symbol:\"boxplot\",params:[\"data\"],defaults:[void 0]}};function TB(e){let t=Uo(e,{trailingComma:!0});return bl(t)}function bl(e){let t=e,n=PZ[t.type];if(!n)switch(t.type===\"Assignment\"&&(t=t._expression),t.type){case\"FunctionCall\":{n=DT[t._symbol];break}default:return}if(!n)return;let r={},s=n.params,o=t.args;for(let i=0;i<s.length;i++){let a=o[i];r[s[i]]=a&&a.getInputString()||\"\"}return{...n,span:t.getInputSpan(),values:r}}k.prototype.tableInfo=function(e,t){return!1};Ve.prototype.tableInfo=function(e,t){return e.validFirstColumnVariable(this._symbol)?{independent_variable:this._symbol,dependent_column:this.getInputString(),by_reference:!1}:!1};k.prototype.tableInfo=function(e,t){let n=t.getDependencies();if(bl(this))return!1;switch(t.valueType){case N:case Gt:return n.length!==0||pb(t)&&(t.moveStrategy[0].type===\"updateSlider\"||t.moveStrategy[1].type===\"updateSlider\")?!1:{independent_variable:\"x\",dependent_column:\"y\",by_reference:!1,values:$(t.valueType)?t.asValue():[t.asValue()]};case b:if(n.length!==1)return!1;let s=n[0];return e.validFirstColumnVariable(s)?{independent_variable:s,dependent_column:this.getInputString(),by_reference:!1}:!1;default:return!1}};Rn.prototype.tableInfo=function(e,t){if(!this.getInputString().length||bl(this)||Gd(t.valueType))return!1;let n=t.getDependencies();if(n.length>1)return!1;let r;if(n.length===0){if(!e.tableableAsConstant(this._symbol))return!1;r=e.implicitIndependent(this._symbol)}else r=n[0];if(!e.validFirstColumnVariable(r))return!1;let s=e.assignmentForbidden(this._symbol)?Tu(this.getInputString().replace(/[^=]*=/,\"\")):Tu(this.getInputString().split(\"=\")[0]);return{independent_variable:r,dependent_column:s,by_reference:!e.assignmentForbidden(this._symbol)}};A.FunctionDefinition.prototype.tableInfo=function(e,t){if(this._argSymbols.length!==1||!this.getInputString().length||t.getDependencies().length>1)return!1;let r=this._argSymbols[0];if(!e.validFirstColumnVariable(r))return!1;let s=e.assignmentForbidden(this._symbol),o=s?Tu(this.getInputString().replace(/[^=]*=/,\"\")):Tu(this.getInputString().split(\"=\")[0]);return{independent_variable:r,dependent_column:o,by_reference:!s}};os.prototype.tableInfo=function(e,t){return!1};A.ComparatorChain.prototype.tableInfo=function(e,t){return!1};A.DoubleInequality.prototype.tableInfo=function(e,t){return!1};A.Equation.prototype.tableInfo=function(e,t){return!1};lt.prototype.tableError=function(){return this.isInequality()?I(\"shared-calculator-error-table-inequality-supplement\"):!(this instanceof k)&&!(this instanceof A.IRExpression)?I(\"shared-calculator-error-table-generic-supplement\"):!1};wo.prototype.tableError=function(){return I(\"shared-calculator-error-table-list-supplement\")};A.Equation.prototype.tableError=Rn.prototype.tableError=function(){return I(\"shared-calculator-error-table-equation-supplement\")};A.ComparatorChain.prototype.tableError=function(){return this.symbols.includes(\"=\")?I(\"shared-calculator-error-table-equation-supplement\"):I(\"shared-calculator-error-table-inequality-supplement\")};A.FunctionDefinition.prototype.tableError=function(){return I(\"shared-calculator-error-table-function-definition-supplement\")};A.Regression.prototype.tableError=function(){return I(\"shared-calculator-error-table-regression-supplement\")};function SZ(){return ss(this._symbol)+\" \"}Ve.prototype.printLatex=SZ;_n.prototype.printLatex=function(){return Xi(this.asValue())};A.Ticker.prototype.printLatex=function(){return\"\\\\ticker\\\\left(\"+this.args.map(to).join(\", \")+\"\\\\right)\"};A.Negative.prototype.printLatex=function(){return\"-\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"};A.Add.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)+\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};A.PercentOf.prototype.printLatex=function(){return this.args[0].printLatex()+\" \\\\% \\\\operatorname{of} \"+this.args[1].printLatex()};A.Subtract.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)-\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};A.Multiply.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)*\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};A.DotMultiply.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\\\\cdot\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};A.CrossMultiply.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\\\\times\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};A.Divide.prototype.printLatex=function(){return\"\\\\frac{\"+this.args[0].printLatex()+\"}{\"+this.args[1].printLatex()+\"}\"};ny.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)^{\"+this.args[1].printLatex()+\"}\"};Rn.prototype.printLatex=function(){return ss(this._symbol)+\"=\"+this._expression.printLatex()};A.Equation.prototype.printLatex=A.CallAssignment.prototype.printLatex=function(){return this._lhs.printLatex()+\"=\"+this._rhs.printLatex()};function NT(e){switch(e){case\">\":return\">\";case\"<\":return\"<\";case\">=\":return\"\\\\ge \";case\"<=\":return\"\\\\le \";case\"=\":return\"=\"}return\"\"}os.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"+NT(this.operator)+\"\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};A.ComparatorChain.prototype.printLatex=function(){let e=\"\";for(let t=0;t<this.symbols.length;t++)e+=`\\\\left(${this.args[t].printLatex()}\\\\right)${NT(this.symbols[t])}`;return e+=`\\\\left(${this.args[this.args.length-1].printLatex()}\\\\right)`,e};A.DoubleInequality.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"+NT(this.args[1])+this.args[2].printLatex()+NT(this.args[3])+\"\\\\left(\"+this.args[4].printLatex()+\"\\\\right)\"};A.Or.prototype.printLatex=function(){return this.args[0].printLatex()+\",\"+this.args[1].printLatex()};function to(e){return e.printLatex()}function MZ(){switch(this._symbol){case\"sqrt\":return\"\\\\sqrt{\"+this.args[0].printLatex()+\"}\";case\"nthroot\":return\"\\\\sqrt[\"+this.args[1].printLatex()+\"]{\"+this.args[0].printLatex()+\"}\";case\"logbase\":return\"\\\\log_{\"+this.args[1].printLatex()+\"}\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\";default:return ss(this._symbol)+\"\\\\left(\"+this.args.map(to).join(\", \")+\"\\\\right)\"}}En.prototype.printLatex=MZ;A.RecursiveFunctionBaseCase.prototype.printLatex=function(){return this.originalNode.printLatex()};A.SeededFunctionCall.prototype.printLatex=function(){return ss(this._symbol)+\"\\\\left(\"+this.args.slice(1).map(to).join(\", \")+\"\\\\right)\"};A.DotAccess.prototype.printLatex=function(){return\"(\"+this.args[0].printLatex()+\").(\"+this.args[1].printLatex()+\")\"};A.Prime.prototype.printLatex=function(){switch(this.args[0]._symbol){case\"logbase\":return\"\\\\log_{\"+this.args[0].args[1].printLatex()+\"}\"+Array(this.order+1).join(\"'\")+\"\\\\left(\"+this.args[0].args[0].printLatex()+\"\\\\right)\";default:return ss(this.args[0]._symbol)+Array(this.order+1).join(\"'\")+\"\\\\left(\"+this.args[0].args.map(to).join(\", \")+\"\\\\right)\"}};wo.prototype.printLatex=function(){return\"\\\\left[\"+this.args.map(to).join(\", \")+\"\\\\right]\"};A.Range.prototype.printLatex=function(){return\"\\\\left[\"+this.args[0].args.map(to).join(\", \")+\" ... \"+this.args[1].args.map(to).join(\", \")+\"\\\\right]\"};A.UpdateRule.prototype.printLatex=function(){return this.args[0].printLatex()+\"\\\\to(\"+this.args[1].printLatex()+\")\"};A.ListAccess.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\\\\left[\"+this.args[1].printLatex()+\"\\\\right]\"};Di.prototype.printLatex=function(){return\"\\\\left(\"+this.args.map(to).join(\", \")+\"\\\\right)\"};A.BareSeq.prototype.printLatex=function(){return this.args.map(to).join(\", \")};A.NamedCoordinateAccess.prototype.printLatex=function(){return\"\\\\left(\\\\left(\"+this.args[0].printLatex()+\"\\\\right).\"+this.symbol+\"\\\\right)\"};A.Norm.prototype.printLatex=function(){return\"\\\\left|\"+this.args[0].printLatex()+\"\\\\right|\"};A.Sum.prototype.printLatex=function(){return\"\\\\sum_{\"+this.args[0].printLatex()+\"=\"+this.args[1].printLatex()+\"}^{\"+this.args[2].printLatex()+\"}\\\\left(\"+this.args[3].printLatex()+\"\\\\right)\"};A.Product.prototype.printLatex=function(){return\"\\\\prod_{\"+this.args[0].printLatex()+\"=\"+this.args[1].printLatex()+\"}^{\"+this.args[2].printLatex()+\"}\\\\left(\"+this.args[3].printLatex()+\"\\\\right)\"};A.Integral.prototype.printLatex=function(){return\"\\\\int_{\"+this.args[1].printLatex()+\"}^{\"+this.args[2].printLatex()+\"}\\\\left(\"+this.args[3].printLatex()+\"\\\\right)d\"+this.args[0].printLatex()};A.FunctionExponent.prototype.printLatex=function(){return this.args[0].printLatex()+\"\\\\left(\"+this.args[1].printLatex()+\"\\\\right)^{\"+this.args[2].printLatex()+\"}\"};A.FunctionFactorial.prototype.printLatex=function(){return this.args[0].printLatex()+\"\\\\left(\"+this.args[1].printLatex()+\"\\\\right)!\"};function HD(e){return e instanceof _n&&e.asValue()===!0}function CZ(e){return e instanceof _n&&e.isNaN()}A.Piecewise.prototype.printLatex=function(){let e=this;if(HD(e.args[0]))return e.args[1].printLatex();let t=[\"\\\\left\\\\{\"];for(;;){if(HD(e.args[0])){t.push(e.args[1].printLatex());break}if(t.push(e.args[0].printLatex(),\": \"),CZ(e.args[2])){t.push(e.args[1].printLatex());break}if(t.push(e.args[1].printLatex(),\", \"),!(e.args[2]instanceof A.Piecewise)){t.push(e.args[2].printLatex());break}e=e.args[2]}return t.push(\"\\\\right\\\\}\"),t.join(\"\")};A.Restriction.prototype.printLatex=function(){return HD(this.args[0])?\"\\\\left\\\\{\\\\right\\\\}\":\"\\\\left\\\\{\"+this.args[0].printLatex()+\"\\\\right\\\\}\"};A.FunctionDefinition.prototype.printLatex=function(){return ss(this._symbol)+\"\\\\left(\"+this._argSymbols.map(ss).join(\", \")+\"\\\\right) = \"+this._expression.printLatex()};A.Derivative.prototype.printLatex=function(){return\"\\\\frac{d}{d\"+ss(this._symbol)+\"}\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"};A.Regression.prototype.printLatex=function(){return\"\\\\left(\"+this._lhs.printLatex()+\"\\\\right)\\\\sim\\\\left(\"+this._rhs.printLatex()+\"\\\\right)\"};A.Histogram.prototype.printLatex=function(){return\"\\\\histogram\\\\left(\"+this.args.map(to).join(\", \")+\"\\\\right)\"};A.DotPlot.prototype.printLatex=function(){return\"\\\\dotplot\\\\left(\"+this.args.map(to).join(\", \")+\"\\\\right)\"};A.BoxPlot.prototype.printLatex=function(){return\"\\\\boxplot\\\\left(\"+this.args.map(to).join(\", \")+\"\\\\right)\"};A.TTest.prototype.printLatex=function(){return\"\\\\TTest\\\\left(\"+this.args.map(to).join(\", \")+\"\\\\right)\"};A.IndependentTTest.prototype.printLatex=function(){return\"\\\\IndependentTTest\\\\left(\"+this.args.map(to).join(\", \")+\"\\\\right)\"};A.Stats.prototype.printLatex=function(){return\"\\\\Stats\\\\left(\"+this.args.map(to).join(\", \")+\"\\\\right)\"};A.AssignmentExpression.prototype.printLatex=function(){return ss(this._symbol)+\"=\"+this.args[1].printLatex()};A.ListComprehension.prototype.printLatex=function(){return\"\\\\left[\"+this._body.printLatex()+\"\\\\operatorname{for}\"+this._inputLists.map(to).join(\", \")+\"\\\\right]\"};A.Substitution.prototype.printLatex=function(){return\"\\\\left(\\\\left(\"+this._body.printLatex()+\"\\\\right)\\\\operatorname{with}\"+this._assignments.map(to).join(\", \")+\"\\\\right)\"};A.Construction.prototype.printLatex=function(){return\"\\\\construction \"};A.ImaginaryUnit.prototype.printLatex=function(){return Nr};A.MovableComplexNumber.prototype.printLatex=function(){return $f(this.asValue())};lt.prototype.getExpressionType=function(e,t){switch(e){case 114:return t&&$(t)?_.POINT3D_LIST:_.POINT3D;case 100:case 128:return _.CURVE3D_xyz_t;case 119:return _.SEGMENT3D;case 129:return _.VECTOR3D;case 130:case 103:return _.SURFACE_xyz_uv;case 110:return _.SURFACE_r_\\u03B8z;case 124:return _.SURFACE_r_\\u03B8z_AMBIGUOUS;case 109:return _.SURFACE_z_r\\u03B8;case 111:return _.SURFACE_r_\\u03B8\\u03C6;case 107:case 108:case 106:return _.SURFACE;case 118:return _.SPHERE3D;case 117:return _.TRIANGLE3D;case 120:case 121:return _.SURFACE_AMBIGUOUS;case 122:case 123:return _.SURFACE_CONSTANT_AMBIGUOUS;case 112:case 113:case 210:return _.IMPLICIT_SURFACE;case 126:case 127:return _.IMPLICIT_SURFACE_AMBIGUOUS;case 3:case 4:case 25:case 26:return t&&$(t)?_.POINT_LIST:_.SINGLE_POINT;case 1:case 2:return _.X_OR_Y;case 5:return _.PARAMETRIC;case 6:return _.POLAR;case 8:return _.IMPLICIT;case 24:case 17:return _.VECTOR2D;case 200:case 201:case 202:case 205:case 209:return _.SLICE;case 211:case 206:return _.SLICE_r\\u03B8z_at_z;case 203:return _.SLICE_zr\\u03B8_at_r;case 204:return _.SLICE_zr\\u03B8_at_\\u03B8;case 213:return _.SLICE_zr\\u03B8_at_xyz;case 207:return _.SLICE_r\\u03B8\\u03C6_at_\\u03B8;case 208:return _.SLICE_r\\u03B8\\u03C6_at_\\u03C6;case 212:return _.SLICE_r\\u03B8\\u03C6_at_xyz;case 214:case 215:return _.SLICE_xyz_uv;default:return t!==void 0&&se(t,Se)?_.POLYGON:_.X_OR_Y}};A.Histogram.prototype.getExpressionType=function(e,t){return _.HISTOGRAM};A.DotPlot.prototype.getExpressionType=function(e,t){return _.DOTPLOT};A.BoxPlot.prototype.getExpressionType=function(e,t){return _.BOXPLOT};function vZ(e){return function(n){return new e(n)}}var DZ=[Sm,Gc,Cm,vm,Dm,qs,qc,Nm,Om,Uc,zc,Am,wm,Lm,Tm,La,qm,Um,zm,km,wc,$m,us,jm,Zm,Xm,Wm,Hs,Jm,Qm];for(let e of DZ)e.prototype.copyWithArgs=vZ(e);tp.prototype.copyWithArgs=function(e){return new tp(e)};os.prototype.copyWithArgs=function(e){return ub(this.operator,e)};Hc.prototype.copyWithArgs=function(e){return new Hc(this.symbols,e)};_n.prototype.copyWithArgs=function(e){return new Xn(this._constantValue)};np.prototype.copyWithArgs=function(e){return new np(this.constructedObjectIds)};rp.prototype.copyWithArgs=function(e){return new rp(this._symbol,e)};sp.prototype.copyWithArgs=function(e){return new sp(this.tag,e)};En.prototype.copyWithArgs=function(e){return new xr(new hn(this._symbol),e)};Ve.prototype.copyWithArgs=function(e){return new hn(this._symbol)};Va.prototype.copyWithArgs=function(e){return new Va};tc.prototype.copyWithArgs=function(e){return new tc(e[0],e[1],e.slice(2),this.shouldCoerceToList,this.parameters)};Cu.prototype.copyWithArgs=function(e){return new Cu(e,this.moveStrategy,this.defaultDragMode)};Fa.prototype.copyWithArgs=function(e){return new Fa(e,this.moveStrategy,this.defaultDragMode)};Ba.prototype.copyWithArgs=function(e){return new Ba(this.symbol,e)};ip.prototype.copyWithArgs=function(e){return new ip(this.order,e)};ap.prototype.copyWithArgs=function(e){return new ap(e)};Mu.prototype.copyWithArgs=function(e){return new Mu(e[0],e.slice(1))};up.prototype.copyWithArgs=function(e){return new up(this._stringValue)};vu.prototype.copyWithArgs=function(e){return new vu(e,this.headerSymbol)};var Nd=class{constructor({id:t,statement:n,moduleID:r,origin:s}){this.id=t,this.statement=n,this.moduleID=r,this.origin=s}};var RT={};Ka(RT,{getFrame:()=>OZ});function OZ(e){let t={};return e.additionalFunctions&&e.additionalFunctions.indexOf(\"sqrt\")!==-1&&(t.sqrt=rt.sqrt),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var ng={};Ka(ng,{getFrame:()=>VZ,statsFunctionMathquillOperators:()=>MB});var IB={segment:!0,line:!0,ray:!0,circle:!0,arc:!0,vector:!0,glider:!0,parallel:!0,perpendicular:!0,center:!0,radius:!0,area:!0,perimeter:!0,start:!0,end:!0,angles:!0,angle:!0,directedangles:!0,directedangle:!0,coterminal:!0,supplement:!0,vertices:!0,segments:!0,intersection:!0,strictintersection:!0,translate:!0,dilate:!0,rotate:!0,reflect:!0,construction:!0,points:!0,lines:!0,circles:!0,arcs:!0,polygons:!0,rays:!0,anglebisector:!0};var PB={segment:!0,triangle:!0,vector:!0,start:!0,end:!0,sphere:!0};var EB=[\"csc\",\"sec\",\"cot\",\"arccsc\",\"arcsec\",\"arccot\",\"csch\",\"sech\",\"coth\",\"arccsch\",\"arcsech\",\"arccoth\",\"mad\",\"cov\",\"covp\",\"distance\",\"midpoint\"],SB=[\"histogram\",\"dotplot\",\"boxplot\"],AZ=[...SB,\"polygon\"],MB=[\"chisqtest|chi-square-test\",\"chisqgof|chi-square-goodness-of-fit\",\"chisqscore|chi-square-score\",\"chisqgofscore|chi-square-goodness-of-fit-score\",\"score\",\"conf|confidence\",\"pleft|p-left\",\"pright|p-right\",\"ztest|z-test\",\"zproptest|z-prop-test\",\"score\",\"dof|degrees-of-freedom\",\"point\",\"stderr|standard-error\",\"null\",\"upper\",\"lower\"],CB=MB.map(e=>e.split(\"|\")[0]),_Z=[\"erf\",\"ttest|t-test\",\"tscore|t-score\",\"ittest|pooled-two-sample-t-test\",\"normaldist|normal-distribution\",\"tdist|t-distribution\",\"chisqdist|chi-square-distribution\",\"poissondist|poisson-distribution\",\"binomialdist|binomial-distribution\",\"pdf\",\"cdf\",\"random\",...SB,...CB],vB=_Z.map(e=>e.split(\"|\")[0]),wZ=[\"distance\",\"midpoint\"],LZ=[\"det\",\"inv\",\"transpose\",\"rref\",\"trace\"],DB=Object.keys(IB).filter(e=>e!==\"construction\"),NB=Object.keys(rf),FZ=[\"complexMultiplyPoints\",\"rawTransform\",\"rawTransformConj\",\"transformWithoutTranslation\",\"transformScaleFactor\",\"scaleTangentTransformation\",\"addTangentVector\",\"addTangentTransformation\",\"complex\",\"complexDivide\",\"coerceComplexToReal\",\"coerceComplexToRealWithTolerance\",\"coerceRealToComplex\",\"peelableCoerceComplexToRealWithTolerance\",\"peelableCoerceRealToComplex\"];function OT(e,t){for(let n of e)if(!t.hasOwnProperty(n))throw new Error(\"Programming Error: key '\"+n+`' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}OT(EB,rt);OT(vB,rt);OT(DB,rt);OT(NB,rt);function VZ(e){let t={},n;for(n of he(rt)){if(FZ.includes(n)||e.restrictedFunctions===!0&&EB.indexOf(n)!==-1&&!(e.forceEnableGeometryFunctions===!0&&wZ.indexOf(n)!==-1)||e.distributions===!1&&vB.indexOf(n)!==-1||!e.newStatsEnabled&&CB.indexOf(n)!==-1)continue;let r=DB.indexOf(n)!==-1,s=n in PB;if(r&&s){if(!(e.isGeometryCalculator||e.is3DCalculator))continue}else if(r){if(!e.isGeometryCalculator)continue}else if(s){if(!e.is3DCalculator)continue}else if(AZ.indexOf(n)!==-1&&e.is3DCalculator)continue;NB.indexOf(n)!==-1&&!e.isComplexEnabled||LZ.indexOf(n)===-1&&(t[n]=rt[n])}return e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.globalRandomSeed&&(t.globalRandomSeed=e.globalRandomSeed),e.initialEvaluation&&(t.initialEvaluation=e.initialEvaluation),e.globalEventCount&&(t.globalEventCount=e.globalEventCount),e.width&&(t.width=e.width),e.height&&(t.height=e.height),e.isComplexEnabled&&(t[Nr]=new Va),t}var UD={};Ka(UD,{getFrame:()=>HZ});var RB=[\"pi\",\"e\",\"trigAngleMultiplier\"],OB=[\"sqrt\",\"nthroot\",\"abs\",\"ln\",\"sin\",\"cos\",\"tan\",\"log\",\"arcsin\",\"arccos\",\"arctan\",\"mean\",\"round\",\"stdev\",\"stdevp\",\"nCr\",\"nPr\",\"exp\",\"factorial\"],BZ=[\"complexMultiplyPoints\",\"complex\",\"complexDivide\",\"coerceComplexToReal\",\"coerceComplexToRealWithTolerance\",\"coerceRealToComplex\",\"complexSqrt\"],GZ=Object.keys(rf);function AB(e,t){for(let n of e)if(!t.hasOwnProperty(n))throw new Error(\"Programming Error: key '\"+n+`' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}AB(RB,rt);AB(OB,rt);function HZ(e){let t={};return RB.forEach(n=>{t[n]=rt[n]}),OB.forEach(n=>{e.replaceRoundWithReciprocal&&n===\"round\"||(t[n]=rt[n])}),e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.isComplexEnabled&&(GZ.forEach(n=>t[n]=rt[n]),BZ.forEach(n=>t[n]=rt[n]),t[Nr]=new Va),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var zD={};Ka(zD,{getFrame:()=>qZ});var _B=[\"pi\",\"e\",\"trigAngleMultiplier\"],wB=[\"sqrt\",\"nthroot\",\"abs\",\"ln\",\"sin\",\"cos\",\"tan\",\"log\",\"arcsin\",\"arccos\",\"arctan\",\"exp\",\"factorial\"];function LB(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(!t.hasOwnProperty(r))throw new Error(\"Programming Error: key '\"+r+`' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}}LB(_B,rt);LB(wB,rt);function qZ(e){let t={};return _B.forEach(n=>{t[n]=rt[n]}),wB.forEach(n=>{t[n]=rt[n]}),e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var rg=class{constructor(t){this.singleExpression=t.singleExpression,this.complexEnabled=!!t.isComplexEnabled}isGeometryEnabled(){return!1}is3dProduct(){return!1}is3dPolicy(){return!1}isComplexEnabled(){return this.complexEnabled}isRecursionEnabled(){return!1}polygonUnsupportedPreferTriangle(){return!1}areAllScalesLinear(){return!0}assignmentForbidden(t){return this.singleExpression?t.slice(0,3)!==\"ans\":t.slice(0,3)===\"tmp\"}isValidSlider(t){return!1}sliderVariables(){return[]}graphingEnabled(){return!1}ansEnabled(){return!this.singleExpression}dimensionVarsEnabled(){return!1}disabledFeatures(){return this.singleExpression?[\"Sum\",\"Product\",\"Integral\",\"Derivative\",\"Piecewise\",\"Substitution\",\"PercentOf\"]:[\"Sum\",\"Product\",\"Integral\",\"Derivative\",\"Piecewise\",\"Substitution\"]}shouldIncludeFunctionParametersInRandomSeed(){return!0}isNewStatsEnabled(){return!1}};var{Constant:Rd,Seed:FB}=A,UZ={fourFunction:RT,singleExpressionFourFunction:RT,scientific:UD,singleExpressionScientific:zD,graphing:ng,graphing_3d:ng,geometry:ng};function zZ({evaluationMode:e,is3dProduct:t,isBeta3d:n,isComplexEnabled:r,scales:s,includeFunctionParametersInRandomSeed:o,customRegressions:i,isRecursionEnabled:a,isNewStatsEnabled:u}){switch(e){case\"fourFunction\":return new wl({singleExpression:!1});case\"singleExpressionFourFunction\":return new wl({singleExpression:!0});case\"scientific\":return new rg({singleExpression:!1,isComplexEnabled:r});case\"singleExpressionScientific\":return new rg({singleExpression:!0,isComplexEnabled:r});case\"graphing\":return new xd({enableGeometry:!1,enable3d:t,scales:s,isComplexEnabled:r,includeFunctionParametersInRandomSeed:o,customRegressions:i,isRecursionEnabled:a,isNewStatsEnabled:u});case\"geometry\":return new xd({enableGeometry:!0,enable3d:!1,scales:s,includeFunctionParametersInRandomSeed:o,isComplexEnabled:r,customRegressions:i,isRecursionEnabled:a,isNewStatsEnabled:u});case\"graphing_3d\":return new Gx({beta3d:n,includeFunctionParametersInRandomSeed:o,isComplexEnabled:r,customRegressions:i,isRecursionEnabled:a,isNewStatsEnabled:u})}}var AT=class{constructor(){this.use_degrees=!1;this.initialEvaluation=!1;this.evaluationMode=\"graphing\";this.product=\"graphing\";this.beta3d=!1;this.restrictedFunctions=!1;this.forceEnableGeometryFunctions=!1;this.functionDefinition=!0;this.replaceRoundWithReciprocal=!1;this.distributions=!0;this.actions=!0;this.substitutions=!0;this.intervalComprehensions=!0;this.recursion=!0;this.dimensions={width:0,height:0};this.includeFunctionParametersInRandomSeed=!0;this.complex=!1;this.customRegressions=!0;this.newStatsEnabled=!1}setPolicy(){let t=this.viewState?{xAxisScale:this.viewState.xAxisScale,yAxisScale:this.viewState.yAxisScale}:void 0;this.policy=zZ({evaluationMode:this.evaluationMode,is3dProduct:this.product===\"graphing-3d\",isBeta3d:this.beta3d,isComplexEnabled:this.complex,scales:t,includeFunctionParametersInRandomSeed:this.includeFunctionParametersInRandomSeed,customRegressions:this.customRegressions,isRecursionEnabled:this.recursion,isNewStatsEnabled:this.newStatsEnabled})}setParentFrame(){this.parent_frame=UZ[this.evaluationMode].getFrame({restrictedFunctions:this.restrictedFunctions,forceEnableGeometryFunctions:this.forceEnableGeometryFunctions,isGeometryCalculator:this.evaluationMode===\"geometry\",is3DCalculator:this.product===\"graphing-3d\",isComplexEnabled:this.complex,replaceRoundWithReciprocal:this.replaceRoundWithReciprocal,distributions:this.distributions,additionalFunctions:this.additionalFunctions,disableParentheses:this.disableParentheses,newStatsEnabled:this.newStatsEnabled,trigAngleMultiplier:new Rd(this.use_degrees?Math.PI/180:be(1,1)),initialEvaluation:new Rd(this.initialEvaluation?1:0),globalEventCount:new Rd(0),globalRandomSeed:new FB(this.globalRandomSeedString||\"\"),width:this.policy.dimensionVarsEnabled()?new Rd(be(this.dimensions.width,1)):Ih(\"width\"),height:this.policy.dimensionVarsEnabled()?new Rd(be(this.dimensions.height,1)):Ih(\"height\")})}getParseOptions(t){return{index:this.policy.ansEnabled()?t.index:void 0,disabledFeatures:this.getDisabledFeatures(),disallowFrac:this.areFractionsDisallowed(),disableParentheses:!!this.disableParentheses,allowIntervalComprehensions:!!this.intervalComprehensions,seedPrefix:In(t.id),writeIntegral:this.evaluationMode===\"geometry\",specializeDoubleInequalities:!this.policy.is3dProduct(),includeFunctionParametersInRandomSeed:this.includeFunctionParametersInRandomSeed,isNewStatsEnabled:this.policy.isNewStatsEnabled()}}setViewState(t){if(_s(t,this.viewState))return;let n=!!(this.viewState&&t.xAxisScale===this.viewState.xAxisScale&&t.yAxisScale===this.viewState.yAxisScale);this.viewState=t,n?this.invalidateGraphsOnly():this.invalidate()}getViewState(){return this.viewState}setDegreeMode(t){this.use_degrees=t,this.invalidate()}setDimensions(t){t!==void 0&&(this.dimensions=t,this.invalidate())}setGlobalRandomSeed(t){this.globalRandomSeedString=t,this.parent_frame.globalRandomSeed=new FB(t),this.dirtyExportedSymbolRoots.add(qn(mr,\"globalRandomSeed\"))}setIncludeFunctionParametersInRandomSeed(t){this.includeFunctionParametersInRandomSeed=t,this.setPolicy()}setEvaluationMode(t){this.evaluationMode=t,this.invalidate()}setProduct(t){this.product=t,this.invalidate()}setBeta3d(t){this.beta3d=t,this.invalidate()}setAdditionalFunctions(t){this.additionalFunctions=t,this.invalidate()}setDisableParentheses(t){this.disableParentheses=t,this.invalidate()}setRestrictedFunctions(t){this.restrictedFunctions=t,this.invalidate()}setForceEnableGeometryFunctions(t){this.forceEnableGeometryFunctions=t,this.invalidate()}setDistributions(t){this.distributions=t,this.invalidate()}setFunctionDefinition(t){this.functionDefinition=t,this.invalidate()}setReplaceRoundWithReciprocal(t){this.replaceRoundWithReciprocal=t,this.invalidate()}setActions(t){t!==this.actions&&(this.actions=t,this.invalidate())}setSubstitutions(t){t!==this.substitutions&&(this.substitutions=t,this.invalidate())}setIntervalComprehensions(t){t!==this.intervalComprehensions&&(this.intervalComprehensions=t,this.invalidate())}setRecursion(t){t!==this.recursion&&(this.recursion=t,this.invalidate())}setComplex(t){t!==this.complex&&(this.complex=t,this.invalidate())}setCustomRegressions(t){t!==this.customRegressions&&(this.customRegressions=t,this.invalidate())}setNewStatsEnabled(t){t!==this.newStatsEnabled&&(this.newStatsEnabled=t,this.invalidate())}setWorkerConfigProperty(t,n){n!==ni[t]&&(ni[t]=n,this.invalidate())}processEvaluatorConfig(t){let n=!!t.isCompleteState&&!t.isUndoRedoState;n!==this.initialEvaluation&&(this.initialEvaluation=n,this.parent_frame.initialEvaluation=new Rd(n?1:0)),t.hasOwnProperty(\"logInternalErrors\")&&wI(t.logInternalErrors),t.viewState&&this.setViewState(t.viewState),t.hasOwnProperty(\"degreeMode\")&&this.setDegreeMode(t.degreeMode),t.hasOwnProperty(\"globalRandomSeed\")&&this.setGlobalRandomSeed(t.globalRandomSeed),t.hasOwnProperty(\"includeFunctionParametersInRandomSeed\")&&this.setIncludeFunctionParametersInRandomSeed(t.includeFunctionParametersInRandomSeed),t.hasOwnProperty(\"evaluationMode\")&&this.setEvaluationMode(t.evaluationMode),t.hasOwnProperty(\"additionalFunctions\")&&this.setAdditionalFunctions(t.additionalFunctions),t.hasOwnProperty(\"disableParentheses\")&&this.setDisableParentheses(t.disableParentheses),t.hasOwnProperty(\"restrictedFunctions\")&&this.setRestrictedFunctions(t.restrictedFunctions),t.hasOwnProperty(\"forceEnableGeometryFunctions\")&&this.setForceEnableGeometryFunctions(t.forceEnableGeometryFunctions),t.hasOwnProperty(\"distributions\")&&this.setDistributions(t.distributions),t.hasOwnProperty(\"functionDefinition\")&&this.setFunctionDefinition(t.functionDefinition),t.hasOwnProperty(\"replaceRoundWithReciprocal\")&&this.setReplaceRoundWithReciprocal(t.replaceRoundWithReciprocal),t.hasOwnProperty(\"pointsOfInterest\")&&this.setWorkerConfigProperty(\"pointsOfInterest\",t.pointsOfInterest),t.hasOwnProperty(\"plotSingleVariableImplicitEquations\")&&this.setWorkerConfigProperty(\"plotSingleVariableImplicitEquations\",t.plotSingleVariableImplicitEquations),t.hasOwnProperty(\"plotImplicits\")&&this.setWorkerConfigProperty(\"plotImplicits\",t.plotImplicits),t.hasOwnProperty(\"plotInequalities\")&&this.setWorkerConfigProperty(\"plotInequalities\",t.plotInequalities),t.hasOwnProperty(\"sliders\")&&this.setWorkerConfigProperty(\"sliders\",t.sliders),t.hasOwnProperty(\"actions\")&&this.setActions(!!t.actions),t.hasOwnProperty(\"substitutions\")&&this.setSubstitutions(!!t.substitutions),t.hasOwnProperty(\"intervalComprehensions\")&&this.setIntervalComprehensions(!!t.intervalComprehensions),t.hasOwnProperty(\"recursion\")&&this.setRecursion(!!t.recursion),t.hasOwnProperty(\"newStatsEnabled\")&&this.setNewStatsEnabled(!!t.newStatsEnabled);let r=t.recursionDepthLimit;if(r!==void 0&&r>0&&r<=10**6&&N0(r),t.hasOwnProperty(\"beta3d\")&&this.setBeta3d(!!t.beta3d),t.hasOwnProperty(\"product\")&&this.setProduct(t.product),t.hasOwnProperty(\"dimensions\")&&this.setDimensions(t.dimensions),t.hasOwnProperty(\"complex\")&&(this.setComplex(!!t.complex),!t.isCompleteState))throw V(\"Complex mode changed without a complete change set.\");t.hasOwnProperty(\"customRegressions\")&&this.setCustomRegressions(!!t.customRegressions)}getDisabledFeatures(){let t=this.policy.disabledFeatures();this.functionDefinition===!1&&(t=t.concat(\"FunctionDefinition\")),this.actions===!1&&(t=t.concat(\"UpdateRule\")),this.substitutions===!1&&(t=t.concat([\"Substitution\",\"ListComprehension\"]));let n=this.additionalFunctions||[];return t=t.filter(r=>!(r===\"Exponent\"&&n.indexOf(\"exponent\")!==-1||r===\"PercentOf\"&&n.indexOf(\"percent\")!==-1)),t}areFractionsDisallowed(){let{evaluationMode:t}=this;return t!==\"fourFunction\"&&t!==\"singleExpressionFourFunction\"?!1:!this.additionalFunctions||this.additionalFunctions.indexOf(\"fraction\")===-1}};function $n(e){let{value:t,valueType:n}=e;if(c0(e)){let r=[];for(let s=0;s<e.value.length;s++)r.push($n(WR(e,s)));return`\\\\left[${r.join(\",\")}\\\\right]`}switch(n){case b:return Xi(t);case O:let[r,s]=t,o=Xi(r),i=Xi(Math.abs(s));return o===\"\\\\frac{0}{0}\"||i===\"\\\\frac{0}{0}\"?\"\\\\frac{0}{0}i\":o!==\"0\"?`${o}${s>=0?\"+\":\"-\"}${i!==\"1\"?`${i}`:\"\"}i`:`${s>=0?\"\":\"-\"}${i!==\"1\"?`${i}`:\"\"}i`;case N:{let[p,l]=t;return`\\\\left(${Xi(p)},${Xi(l)}\\\\right)`}case F:{let[p,l,m]=t;return`\\\\left(${Xi(p)},${Xi(l)},${Xi(m)}\\\\right)`}case pn:return\"\\\\operatorname{rgb}\\\\left(\"+[$n({valueType:b,value:t[0]}),$n({valueType:b,value:t[1]}),$n({valueType:b,value:t[2]})].join(\",\")+\"\\\\right)\";case Se:{let p=[];for(let l of t)p.push($n({valueType:N,value:l}));return\"\\\\operatorname{polygon}\\\\left(\"+p.join(\",\")+\"\\\\right)\"}case Ie:return\"\\\\operatorname{segment}\\\\left(\"+[$n({valueType:N,value:t[0]}),$n({valueType:N,value:t[1]})].join(\",\")+\"\\\\right)\";case Pe:return\"\\\\operatorname{line}\\\\left(\"+[$n({valueType:N,value:t[0]}),$n({valueType:N,value:t[1]})].join(\",\")+\"\\\\right)\";case De:return\"\\\\operatorname{ray}\\\\left(\"+[$n({valueType:N,value:t[0]}),$n({valueType:N,value:t[1]})].join(\",\")+\"\\\\right)\";case ye:let a=t[0],u=t[1],c=[u[0]+a[0],u[1]+a[1]];return`\\\\operatorname{vector}\\\\left(${$n({valueType:N,value:u})},${$n({valueType:N,value:c})}\\\\right)`;case pe:return\"\\\\operatorname{circle}\\\\left(\"+[$n({valueType:N,value:t[0]}),$n({valueType:b,value:t[1]})].join(\",\")+\"\\\\right)\";case ae:return\"\\\\operatorname{arc}\\\\left(\"+[$n({valueType:N,value:t[0]}),$n({valueType:N,value:t[1]}),$n({valueType:N,value:t[2]})].join(\",\")+\"\\\\right)\";case ve:return\"\\\\operatorname{angle}\\\\left(\"+[$n({valueType:N,value:t[0]}),$n({valueType:b,value:t[1]}),$n({valueType:b,value:t[2]})].join(\",\")+\"\\\\right)\";case Te:return\"\\\\operatorname{directedangle}\\\\left(\"+[$n({valueType:N,value:t[0]}),$n({valueType:b,value:t[1]}),$n({valueType:b,value:t[2]})].join(\",\")+\"\\\\right)\";case Qn:return`\\\\operatorname{tone}\\\\left(${$n({valueType:b,value:t[0]})},${$n({valueType:b,value:t[1]})}\\\\right)`;default:throw new Error(\"Cannot serialize a value of type \"+oe(n)+\".\")}}function kD(e){let t={};for(let n of he(e.updateRules))t[n]=$D(e,n);return t}function $D(e,t){return`${ss(t)}=${$n(e.updateRules[t])}`}function kZ(e){return e.type!==\"List\"?!1:e.args.every(t=>lb(t))}function $Z(e){return e.type!==\"List\"?!1:e.args.every(t=>lb(t)||eg(t))}function YZ(e){return e.type!==\"List\"?!1:e.args.length===0}var ZZ=[b,N,Gt,F,zr,Ae,Y,O,He,pn,xs];function _T(e,t,n){if(t.type===\"FunctionDefinition\"||t.type===\"RecursiveFunctionBaseCase\"||t.type===\"Equation\"||t.type===\"ComparatorChain\"||!hc(e,ZZ))return!1;let r=t instanceof Rn;switch(e!==b&&r&&(t=t instanceof Rn?t._expression:t),e){case Ae:return!YZ(t);case b:return t.type!==\"Constant\"&&t.type!==\"MixedNumber\";case Y:return!kZ(t);case O:return!eg(t);case He:return!$Z(t);case N:case F:return!VB(t);case Gt:case zr:return!XZ(t);case pn:case xs:return r;default:return!1}}function VB(e){return e.type===\"ParenSeq\"&&e.args.every(t=>Pm(t))}function XZ(e){return e.type!==\"List\"?!1:e.args.every(t=>VB(t))}function WZ(e){return e.type===\"Error\"?e.getError():e.valueType===O?e.asValue():+e.asValue()}function jZ(e,t,n,r){let s=[],o=!1;for(let i=0;i<n.columns.length;i++){let a=r.columns[i],u=n.columns[i],c=a.type===\"Error\"?[]:a.rawArgs.map(WZ),p=as(a)?a.isCyclicDependencyError&&Bc(u)&&u.isFreeVariable(t):Eu(a)&&a.isIndependent,l=i>=1&&r.columns[0].type!==\"Error\"&&a.type!==\"Error\"&&!u.header.userData.hidden;l&&(o=!0);let m={computed:!p,values:c,plotted:l};a.type===\"Error\"&&(m.error=a.getError()),s.push(m)}return s[0].plotted=o,{column_data:s}}function JZ(e,t,n){let r={variables:[],errorMap:{},dimensions:{}};if(e.areAllScalesLinear()||(r.errorMap.scale=!0),n.center.isError&&(r.errorMap.center=!0),n.radianAngle.isError&&(r.errorMap.angle=!0),n.width.isError&&(r.errorMap.width=!0),n.height.isError&&(r.errorMap.height=!0),n.opacity.isError&&(r.errorMap.opacity=!0),Object.keys(r.errorMap).length>0)return r.variables=t.getSliderVariables(e,n),r;r.dimensions.x=[],r.dimensions.y=[],r.dimensions.radianAngle=[],r.dimensions.width=[],r.dimensions.height=[],r.dimensions.opacity=[];let s=[n.center,n.radianAngle,n.width,n.height,n.opacity];return s.some(i=>i&&i.valueType&&$(i.valueType))&&(r.is_concrete_list=!0),A.List.eachArgs(s,i=>{let a=i[0].asValue(),u=+i[1].asValue(),c=Math.atan2(Math.sin(u),Math.cos(u));r.dimensions.x.push(+a[0]),r.dimensions.y.push(+a[1]),r.dimensions.radianAngle.push(c),r.dimensions.width.push(+i[2].asValue()),r.dimensions.height.push(+i[3].asValue()),r.dimensions.opacity.push(Math.max(0,Math.min(1,+i[4].asValue())))}),(e.graphingEnabled()?t.getGraphMode(e,n):10)!==10&&(r.is_graphable=!0),n.moveStrategy&&(r.move_strategy=n.moveStrategy),t.center&&(t.center.type===\"Identifier\"?(r.center_reference_id=t.center.referencedStatementId,r.center_reference_symbol=t.center._symbol):t.center.type===\"ParenSeq\"&&n.center.valueType===N&&(r.center_is_point_literal=!0)),r}function QZ(e,t,n){let r=n.handler,s=n.minStep,o={},i={};for(let l of r.getDependencies())e.validActionVariable(l)||(o[l]=!0);for(let l of s.getDependencies())i[l]=!0;let a;if(as(s))a={status:\"error\",error:s.getError()};else{let l=s.asValue();typeof l==\"number\"&&!isNaN(l)&&l>=0?a={status:\"valid\",value:l}:a={status:\"error\",error:VE().getError()}}let u=Object.keys(o);u.length>0&&(r=mn(u).setDependencies(r.getDependencies()));let c;r.type===\"Error\"&&!YD(e,r)?c={status:\"error\",error:r.getError()}:r.isEmptyAction?c={status:\"empty\"}:c={status:\"maybe-valid\"};let p={handler:c,minStep:a,variables:[]};return mc(p,e,{...o,...i}),p}function KZ(){return{operator:\"=\",variables:[]}}function GB(e,t,n,r){if(Pu(n))return jZ(e,t,n,r);if(cb(n))return JZ(e,n,r);let s=KZ();if(s.evaluated_latex=n.userData.latex,n instanceof A.Ticker)return e.graphingEnabled()?QZ(e,n,r):(s.error=V(\"Ticker without graphing\").getError(),s);if(e.is3dProduct()){let u=e,c=n.getGraphMode(u,r);if((c===100||c===5)&&r.getDependencies().length===1){let p=r.getDependencies()[0];(p===\"u\"||p===\"v\"||p===\"t\")&&(s.internal_domain_dependency=p)}}let o=Xy(n.userData);if(o){let u=r.getCursorContext();if(u)s.cursor_context={...u,selection:o};else if(as(r)){let c=tX(e,t,n);c&&(s.cursor_context={...c,selection:o})}}if((n instanceof A.FunctionDefinition||n instanceof Rn||n instanceof A.RecursiveFunctionBaseCase)&&(n._symbol.startsWith(\"_\")||(s.defined_name=n._symbol)),n instanceof Tr&&r instanceof Dn?s.recursion=r.getRecursiveFunctionMetadata():n instanceof Tr&&r instanceof C&&r.recursionMetadata&&(s.recursion=r.recursionMetadata),n instanceof is&&(s.recursion_base_case={symbol:n._symbol,argValue:n.specifiedArg.valid?n.specifiedArg.argValue:void 0}),r.warning!==void 0&&(s.warning=r.warning),r.type===\"Error\"&&!((n instanceof A.FunctionDefinition||n instanceof A.RecursiveFunctionBaseCase)&&!r.blocksExport)&&!r.silent){s.error=r.getError(),s.variables=n.getSliderVariables(e,r),s.is_single_identifier=n instanceof Ve,r.actionValue&&(s.action_value=kD(r.actionValue));let u=BB(e,t,n,r);return u&&(s.geometry=u),s}if(r.valueType===pn&&r.getDependencies().length===0){let u=r.asValue();s.rgb_value=Rl(u[0],u[1],u[2]).formatHex()}r.valueType===it&&r.getDependencies().length===0&&(s.action_value=kD(r.asValue())),r.moveStrategy&&(s.move_strategy=r.moveStrategy,s.default_drag_mode=r.defaultDragMode),n.isInequality()&&(s.is_inequality=!0),s.operator=n.getOperator(),r instanceof A.SolvedEquation?r._expression.asValue()!==!0&&r._expression.asValue()!==!1&&(s.assignment=r._symbol):n instanceof Rn&&(n._symbol.startsWith(\"_\")||(s.assignment=n._symbol)),n instanceof A.FunctionDefinition&&(s.function_definition=n._symbol);let i=e.graphingEnabled()?n.getGraphMode(e,r):10;if(e.graphingEnabled()&&e.is3dPolicy()&&(!Ou(i)&&!J_(i)&&(i=10),r instanceof A.OptimizedRegression&&(i=10)),i!==10&&(s.is_graphable=!0,s.expression_type=n.getExpressionType(i,r.valueType),e.is3dPolicy()&&(s.expression_type===_.SINGLE_POINT?s.expression_type=_.POINT3D:s.expression_type===_.POINT_LIST&&(s.expression_type=_.POINT3D_LIST)),r.valueType&&Ia(r.valueType)&&(s.map_type=r.valueType),r.isShadeBetween()&&(s.is_shade_between=!0),s.expression_type!==_.POINT3D&&s.expression_type!==_.POINT3D_LIST)){let u=n.tableInfo(e,r);u&&(s.is_tableable=!0,s.table_info=u)}if(r.valueType!==void 0&&$(r.valueType)&&(s.is_concrete_list=!0,r.valueType===xs&&r.getDependencies().length===0)){let u=r.asValue();u&&(s.rgb_value=u.map(c=>Rl(c[0],c[1],c[2]).formatHex()))}if(s.variables=s.is_graphable?[]:n.getSliderVariables(e,r),s.is_single_identifier=n instanceof Ve,Ni(r)){let u=Cs(r);s.typed_constant_value=u,eX(u==null?void 0:u.valueType)&&(s.geometry=BB(e,t,n,r))}if(s.operator===\"=\"&&r.getDependencies().length===0&&_T(r.valueType,n,e)&&(s.is_evaluable=!0),r instanceof A.OptimizedRegression){let u=r,c={};for(let p of he(u.parameters))u.parameters.hasOwnProperty(p)&&(c[ss(p)]=+u.parameters[p].asValue());s.is_regression=!0,s.regression={parameters:c,displayPrecision:u.displayPrecision,residualVariable:ss(u.residualVariable),residualSuggestionId:u.residualSuggestionId,shouldSuggestLogMode:u.shouldSuggestLogMode,isLinear:u.isLinear,statistics:u.statistics,parameterWarning:u.parameterWarning}}let a=bl(n);return(a==null?void 0:a.type)===\"distribution\"&&a.discrete&&(s.is_discrete_distribution=!0),s}function eX(e){switch(e){case N:case Gt:case Pe:case io:case Ie:case lr:case De:case ns:case ye:case ao:case pe:case oo:case ae:case ts:case Se:case hr:case ve:case Er:case Te:case Sr:case Ne:case Ui:return!0;default:return!1}}function BB(e,t,n,r){let s={};r.valueType!==void 0&&(s.valueType=r.valueType),s.valueType&&se(s.valueType,N)&&e.graphingEnabled()&&Kc(n.getGraphMode(e,r))&&(s.isMovablePoint=!0);let{identifier:o,listAccess:i,tree:a}=$b(n);if(o&&(s.identifier=o),i&&(s.listAccess=i),a&&(s.call=a,r.valueType&&se(r.valueType,Ne)&&n instanceof Tr)){let c=n._expression;s.transformation_preview_info={type:a.symbol,args:c.args.slice(1).map(p=>Cs(de(p,e,t)))}}let u=r.moveStrategy&&r.moveStrategy[0];if(u&&\"initialValue\"in u&&u.initialValue!==void 0&&(s.gliderParameter=u.initialValue),Object.keys(s).length>0){let c=n.getLegalExports(e);return{parentDependencies:n.getDependencies().filter(l=>!rt[l]&&!c.includes(l)),...s}}}function tX(e,t,n){let r=Xy(n.userData);if(!r)return;let{input:s,start:o,end:i}=r;if(s.trim()===\"\")return{type:\"empty\",allowedTypes:[Pn]};let a=\"\\\\cursor\",u=s.slice(0,o)+a+\" \"+s.slice(i),c={start:o,end:o+a.length},p=Uo(u,{...n.parseOptions});return p.userData={...n.userData,latex:u,latexSelection:c},p.isError?p.getCursorContext():Dd({policy:e,frame:t},p).getCursorContext()}function mc(e,t,n){let r=e.variables;if(r&&r.length){let s={};for(let o of r)s[o]=!0;for(let o of he(n))s[o]=!0;n=s}e.variables=t.sliderVariables(he(n))}function YD(e,t){if(t.blocksExport)return!1;let n=t.getDependencies();if(n.length===0)return!1;for(let r of n)if(!e.validActionVariable(r))return!1;return!0}function nX(e){let t=e.rawTree.userData,n=e.rawTree.metaData;return!!(t.cdf&&t.cdf.show&&n.distributionSpec)}var{Constant:_r,FunctionCall:$o,Add:rX}=A;function HB(e,t,n,r,s,o,i){var p,l,m,d,y,g,f;let a,u=1/0,c=-1/0;switch(e.symbol){case\"normaldist\":{let h=(p=e.evaluatedParams[0])!=null?p:0,x=(l=e.evaluatedParams[1])!=null?l:1;t===\"left\"||t===\"right\"?a={min:h,max:void 0,p:.5}:a={min:h-x,max:h+x,p:t===\"inner\"?.6826894921370859:.31731050786291415};break}case\"tdist\":{let h=(m=e.evaluatedParams[1])!=null?m:0,x=(d=e.evaluatedParams[2])!=null?d:1;if(t===\"left\"||t===\"right\")a={min:h,max:void 0,p:.5};else{let T=h-x,P=h+x,M=new $o(\"cdf\",[s,new _r(T),new _r(P)]);a={min:h-x,max:h+x,p:t===\"inner\"?de(M,o,i).asValue():1-de(M,o,i).asValue()}}break}case\"uniformdist\":{let h=(y=e.evaluatedParams[0])!=null?y:0,x=(g=e.evaluatedParams[1])!=null?g:1;if(h>x){a={min:0,max:1,p:.5};break}u=x,c=h;let T=x-h;t===\"left\"||t===\"right\"?a={min:h+.5*T,max:void 0,p:.5}:a={min:h+.25*T,max:h+.75*T,p:.5};break}case\"poissondist\":case\"binomialdist\":case\"chisqdist\":if(c=0,e.symbol===\"binomialdist\"&&(u=(f=e.evaluatedParams[0])!=null?f:1/0),t===\"left\"||t===\"right\"){let h=new $o(\"quantile\",[s,new _r(.5)]);a={min:de(h,o,i).asValue(),max:void 0,p:.5}}else{let h=new $o(\"quantile\",[s,new _r(.25)]),x=new $o(\"quantile\",[s,new _r(3/4)]);a={min:de(h,o,i).asValue(),max:de(x,o,i).asValue(),p:.5}}break;default:throw new Error(`Unhandled distribution type ${e}`)}return(t===\"inner\"||t===\"outer\")&&(n!==void 0&&!isNaN(n)&&r===void 0?(a.max=u,a.min=n):r!==void 0&&!isNaN(r)&&n===void 0&&(a.min=c,a.max=r)),a}function qB({distributionTree:e,tails:t,minValid:n,min:r,maxValid:s,max:o,policy:i,frame:a}){let u,c=Math.min(r,o),p=Math.max(r,o);switch(t){case\"left\":n&&(u=new $o(\"cdf\",[e,new _r(-1/0),new _r(r)]));break;case\"right\":n&&(u=new $o(\"cdf\",[e,new _r(r),new _r(1/0)]));break;case\"inner\":n&&s&&(u=new $o(\"cdf\",[e,new _r(c),new _r(p)]));break;case\"outer\":n&&s&&(c===p?u=new _r(1):u=new rX([new $o(\"cdf\",[e,new _r(-1/0),new _r(c)]),u=new $o(\"cdf\",[e,new _r(p),new _r(1/0)])]));break}if(u)return de(u,i,a).asValue()}function sX(e,t,n,r){var T,P,M;let{evaluationState:s,rawTree:o}=e,i=(P=(T=o.userData.cdf)==null?void 0:T.tails)!=null?P:\"inner\",a=o.metaData.cdfMin,u=o.metaData.cdfMax,c=o.type===\"Assignment\"?o._expression:o,p=s.distribution_spec;if(!p)return;let l=mi(t,n,a,r,void 0),m=mi(t,n,u,r,void 0),d=HB(p,i,l,m,c,t,n);s.cdf_min_default=d.min,s.cdf_max_default=d.max,s.cdf_p_default=d.p,l===void 0&&(l=d.min),m===void 0&&(m=(M=d.max)!=null?M:NaN);let y=!0,g=!0;isNaN(l)&&(y=!1,l=NaN),isNaN(m)&&(g=!1,m=NaN),y?!g&&(i===\"inner\"||i===\"outer\")&&(s.cdf_error=ZE().getError()):s.cdf_error=YE().getError();let f=Math.min(l,m),h=Math.max(l,m);i===\"inner\"||i===\"outer\"?(o.metaData.evaluatedCDFMin=f,o.metaData.evaluatedCDFMax=h):(o.metaData.evaluatedCDFMin=l,o.metaData.evaluatedCDFMax=m),s.cdf_min_valid=y,s.cdf_max_valid=g,s.cdf_min=l,s.cdf_max=m;let x=qB({distributionTree:c,minValid:y,min:l,maxValid:g,max:m,policy:t,frame:n,tails:i});x!==void 0&&(s.cdf_p=x)}function oX(e,t,n,r){var d,y;let{evaluationState:s,rawTree:o}=e,i=o.type===\"Assignment\"?o._expression:o,a=o.metaData.cdfP,u=mi(t,n,o.metaData.cdfMin,r,void 0),c=mi(t,n,o.metaData.cdfMax,r,void 0),p=HB(s.distribution_spec,o.userData.cdf.tails,u,c,i,t,n);u===void 0&&(u=p.min),c===void 0&&(c=p.max),s.cdf_p_default=p.p,s.cdf_min_default=p.min,s.cdf_max_default=p.max;let l=mi(t,n,a,r,p.p);if(l===void 0||isNaN(l)||l<0||l>1){s.cdf_error=FI().getError(),s.cdf_p_valid=!1;return}else s.cdf_p=l,s.cdf_p_valid=!0;if(o.metaData.cdfMin||o.metaData.cdfMax){let g=!0,f=!0;(u===void 0||isNaN(u))&&(g=!1,u=NaN),(c===void 0||isNaN(c))&&(f=!1,c=NaN);let h=(y=(d=o.userData.cdf)==null?void 0:d.tails)!=null?y:\"inner\",x=qB({min:u,minValid:g,max:c,maxValid:f,distributionTree:i,tails:h,policy:t,frame:n});if(x!==void 0&&Math.abs(x-l)<=.001*Math.abs(l)){s.cdf_min=u,s.cdf_max=c;let T=Math.min(u,c),P=Math.max(u,c),M=h===\"inner\"||h===\"outer\";o.metaData.evaluatedCDFMin=M?T:u,o.metaData.evaluatedCDFMax=M?P:c;return}}switch(o.userData.cdf.tails){case\"inner\":{let g=new $o(\"quantile\",[i,new _r((1-l)/2)]),f=new $o(\"quantile\",[i,new _r((1+l)/2)]);s.cdf_min=+de(g,t,n).asValue(),s.cdf_max=+de(f,t,n).asValue();break}case\"outer\":{let g=new $o(\"quantile\",[i,new _r(l/2)]),f=new $o(\"quantile\",[i,new _r(1-l/2)]);s.cdf_min=+de(g,t,n).asValue(),s.cdf_max=+de(f,t,n).asValue();break}case\"left\":{let g=new $o(\"quantile\",[i,new _r(l)]);s.cdf_min=+de(g,t,n).asValue();break}case\"right\":{let g=new $o(\"quantile\",[i,new _r(1-l)]);s.cdf_min=+de(g,t,n).asValue();break}}o.metaData.evaluatedCDFMin=s.cdf_min,o.metaData.evaluatedCDFMax=s.cdf_max;let m=o.userData.cdf.tails;if((m===\"inner\"||m===\"outer\")&&s.cdf_max!==void 0){let g=Math.min(s.cdf_min,s.cdf_max),f=Math.max(s.cdf_min,s.cdf_max);o.metaData.evaluatedCDFMin=g,o.metaData.evaluatedCDFMax=f}}function iX(e,t,n,r){var u,c,p;let{evaluationState:s,rawTree:o}=e,i=o.type===\"Assignment\"?o._expression:o,a=(c=(u=i==null?void 0:i.metaData)==null?void 0:u.distributionSpec)!=null?c:bl(i);if((a==null?void 0:a.type)===\"distribution\"){let l={...a,evaluatedParams:[]};(p=i.args)==null||p.forEach((m,d)=>{let y=de(m,t,n);for(let g of y.getDependencies())r[g]=!0;y.type===\"IRExpression\"&&y.isConstant?l.evaluatedParams[d]=+y.asValue():l.evaluatedParams[d]=void 0}),s.distribution_spec=l,o.metaData.evaluatedDistributionSpec=l}}function UB(e,t,n){var o,i,a;let r=e.evaluationState,s={};iX(e,t,n,s),nX(e)&&((o=e.rawTree.metaData.distributionSpec)!=null&&o.discrete||((a=(i=e.rawTree.userData.cdf)==null?void 0:i.compute)!=null?a:\"p\")===\"p\"?sX(e,t,n,s):oX(e,t,n,s),r.is_single_identifier=!1,mc(r,t,s))}var L=function(){};L.version=\"1.2.6\";L._myIndexOf=function(t){var n=this.length,r;for(r=0;r<n;++r)if(this[r]===t)return r;return-1};L.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:L._myIndexOf;L.precision=4;L.largeArray=50;L.compile=function(){var e=Array.prototype.slice.call(arguments),t=e.pop();return t=\"return function (\"+e.join(\",\")+\") {\"+t+\"}\",new Function([\"numeric\"],t)(L)};L._dim=function(t){for(var n=[];typeof t==\"object\";)n.push(t.length),t=t[0];return n};L.dim=function(t){var n,r;return typeof t==\"object\"?(n=t[0],typeof n==\"object\"?(r=n[0],typeof r==\"object\"?L._dim(t):[t.length,n.length]):[t.length]):[]};L.mapreduce=function(t,n){return L.compile(\"x\",\"accum\",\"_s\",\"_k\",'if(typeof accum === \"undefined\") accum = '+n+`;\nif(typeof x === \"number\") { var xi = x; `+t+`; return accum; }\nif(typeof _s === \"undefined\") _s = numeric.dim(x);\nif(typeof _k === \"undefined\") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    `+t+`;\n    xi = x[i-1];\n    `+t+`;\n}\nif(i === 0) {\n    xi = x[i];\n    `+t+`\n}\nreturn accum;`)};L.mapreduce2=function(t,n){return L.compile(\"x\",`var n = x.length;\nvar i,xi;\n`+n+`\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    `+t+`\n}\nreturn accum;`)};L.rep=function(t,n,r){typeof r==\"undefined\"&&(r=0);var s=t[r],o=Array(s),i;if(r===t.length-1){for(i=s-2;i>=0;i-=2)o[i+1]=n,o[i]=n;return i===-1&&(o[0]=n),o}for(i=s-1;i>=0;i--)o[i]=L.rep(t,n,r+1);return o};L.dotMMsmall=function(t,n){var r,s,o,i,a,u,c,p,l,m,d,y,g,f;for(i=t.length,a=n.length,u=n[0].length,c=Array(i),r=i-1;r>=0;r--){for(p=Array(u),l=t[r],o=u-1;o>=0;o--){for(m=l[a-1]*n[a-1][o],s=a-2;s>=1;s-=2)d=s-1,m+=l[s]*n[s][o]+l[d]*n[d][o];s===0&&(m+=l[0]*n[0][o]),p[o]=m}c[r]=p}return c};L._getCol=function(t,n,r){var s=t.length,o;for(o=s-1;o>0;--o)r[o]=t[o][n],--o,r[o]=t[o][n];o===0&&(r[0]=t[0][n])};L.dotMMbig=function(t,n){var r=L._getCol,s=n.length,o=Array(s),i=t.length,a=n[0].length,u=new Array(i),c,p=L.dotVV,l,m,d,y;for(--s,--i,l=i;l!==-1;--l)u[l]=Array(a);for(--a,l=a;l!==-1;--l)for(r(n,l,o),m=i;m!==-1;--m)y=0,c=t[m],u[m][l]=p(c,o);return u};L.dotMV=function(t,n){var r=t.length,s=n.length,o,i=Array(r),a=L.dotVV;for(o=r-1;o>=0;o--)i[o]=a(t[o],n);return i};L.dotVM=function(t,n){var r,s,o,i,a,u,c,p,l,m,d,y,g,f,h,x,T,P,M;for(i=t.length,a=n[0].length,c=Array(a),o=a-1;o>=0;o--){for(m=t[i-1]*n[i-1][o],s=i-2;s>=1;s-=2)d=s-1,m+=t[s]*n[s][o]+t[d]*n[d][o];s===0&&(m+=t[0]*n[0][o]),c[o]=m}return c};L.dotVV=function(t,n){var r,s=t.length,o,i=t[s-1]*n[s-1];for(r=s-2;r>=1;r-=2)o=r-1,i+=t[r]*n[r]+t[o]*n[o];return r===0&&(i+=t[0]*n[0]),i};L.dot=function(t,n){var r=L.dim;switch(r(t).length*1e3+r(n).length){case 2002:return n.length<10?L.dotMMsmall(t,n):L.dotMMbig(t,n);case 2001:return L.dotMV(t,n);case 1002:return L.dotVM(t,n);case 1001:return L.dotVV(t,n);case 1e3:return L.mulVS(t,n);case 1:return L.mulSV(t,n);case 0:return t*n;default:throw new Error(\"numeric.dot only works on vectors and matrices\")}};L.diag=function(t){var n,r,s,o=t.length,i=Array(o),a;for(n=o-1;n>=0;n--){for(a=Array(o),r=n+2,s=o-1;s>=r;s-=2)a[s]=0,a[s-1]=0;for(s>n&&(a[s]=0),a[n]=t[n],s=n-1;s>=1;s-=2)a[s]=0,a[s-1]=0;s===0&&(a[0]=0),i[n]=a}return i};L.getDiag=function(e){var t=Math.min(e.length,e[0].length),n,r=Array(t);for(n=t-1;n>=1;--n)r[n]=e[n][n],--n,r[n]=e[n][n];return n===0&&(r[0]=e[0][0]),r};L.identity=function(t){return L.diag(L.rep([t],1))};L.pointwise=function(t,n,r){typeof r==\"undefined\"&&(r=\"\");var s=[],o,i=/\\[i\\]$/,a,u=\"\",c=!1;for(o=0;o<t.length;o++)i.test(t[o])?(a=t[o].substring(0,t[o].length-3),u=a):a=t[o],a===\"ret\"&&(c=!0),s.push(a);return s[t.length]=\"_s\",s[t.length+1]=\"_k\",s[t.length+2]='if(typeof _s === \"undefined\") _s = numeric.dim('+u+`);\nif(typeof _k === \"undefined\") _k = 0;\nvar _n = _s[_k];\nvar i`+(c?\"\":\", ret = Array(_n)\")+`;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+t.join(\",\")+`,_s,_k+1);\n    return ret;\n}\n`+r+`\nfor(i=_n-1;i!==-1;--i) {\n    `+n+`\n}\nreturn ret;`,L.compile.apply(null,s)};L.pointwise2=function(t,n,r){typeof r==\"undefined\"&&(r=\"\");var s=[],o,i=/\\[i\\]$/,a,u=\"\",c=!1;for(o=0;o<t.length;o++)i.test(t[o])?(a=t[o].substring(0,t[o].length-3),u=a):a=t[o],a===\"ret\"&&(c=!0),s.push(a);return s[t.length]=\"var _n = \"+u+`.length;\nvar i`+(c?\"\":\", ret = Array(_n)\")+`;\n`+r+`\nfor(i=_n-1;i!==-1;--i) {\n`+n+`\n}\nreturn ret;`,L.compile.apply(null,s)};L._biforeach=function e(t,n,r,s,o){if(s===r.length-1){o(t,n);return}var i,a=r[s];for(i=a-1;i>=0;i--)e(typeof t==\"object\"?t[i]:t,typeof n==\"object\"?n[i]:n,r,s+1,o)};L._biforeach2=function e(t,n,r,s,o){if(s===r.length-1)return o(t,n);var i,a=r[s],u=Array(a);for(i=a-1;i>=0;--i)u[i]=e(typeof t==\"object\"?t[i]:t,typeof n==\"object\"?n[i]:n,r,s+1,o);return u};L._foreach=function e(t,n,r,s){if(r===n.length-1){s(t);return}var o,i=n[r];for(o=i-1;o>=0;o--)e(t[o],n,r+1,s)};L._foreach2=function e(t,n,r,s){if(r===n.length-1)return s(t);var o,i=n[r],a=Array(i);for(o=i-1;o>=0;o--)a[o]=e(t[o],n,r+1,s);return a};L.ops2={add:\"+\",sub:\"-\",mul:\"*\",div:\"/\",mod:\"%\",and:\"&&\",or:\"||\",eq:\"===\",neq:\"!==\",lt:\"<\",gt:\">\",leq:\"<=\",geq:\">=\",band:\"&\",bor:\"|\",bxor:\"^\",lshift:\"<<\",rshift:\">>\",rrshift:\">>>\"};L.opseq={addeq:\"+=\",subeq:\"-=\",muleq:\"*=\",diveq:\"/=\",modeq:\"%=\",lshifteq:\"<<=\",rshifteq:\">>=\",rrshifteq:\">>>=\",bandeq:\"&=\",boreq:\"|=\",bxoreq:\"^=\"};L.mathfuns=[\"abs\",\"acos\",\"asin\",\"atan\",\"ceil\",\"cos\",\"exp\",\"floor\",\"log\",\"round\",\"sin\",\"sqrt\",\"tan\",\"isNaN\",\"isFinite\"];L.mathfuns2=[\"atan2\",\"pow\",\"max\",\"min\"];L.ops1={neg:\"-\",not:\"!\",bnot:\"~\",clone:\"\"};L.mapreducers={any:[\"if(xi) return true;\",\"var accum = false;\"],all:[\"if(!xi) return false;\",\"var accum = true;\"],sum:[\"accum += xi;\",\"var accum = 0;\"],prod:[\"accum *= xi;\",\"var accum = 1;\"],norm2Squared:[\"accum += xi*xi;\",\"var accum = 0;\"],norminf:[\"accum = max(accum,abs(xi));\",\"var accum = 0, max = Math.max, abs = Math.abs;\"],norm1:[\"accum += abs(xi);\",\"var accum = 0, abs = Math.abs;\"],sup:[\"accum = max(accum,xi);\",\"var accum = -Infinity, max = Math.max;\"],inf:[\"accum = min(accum,xi);\",\"var accum = Infinity, min = Math.min;\"]};(function(){var e,t;for(e=0;e<L.mathfuns2.length;++e)t=L.mathfuns2[e],L.ops2[t]=t;for(e in L.ops2)if(L.ops2.hasOwnProperty(e)){t=L.ops2[e];var n,r,s=\"\";L.myIndexOf.call(L.mathfuns2,e)!==-1?(s=\"var \"+t+\" = Math.\"+t+`;\n`,n=function(o,i,a){return o+\" = \"+t+\"(\"+i+\",\"+a+\")\"},r=function(o,i){return o+\" = \"+t+\"(\"+o+\",\"+i+\")\"}):(n=function(o,i,a){return o+\" = \"+i+\" \"+t+\" \"+a},L.opseq.hasOwnProperty(e+\"eq\")?r=function(o,i){return o+\" \"+t+\"= \"+i}:r=function(o,i){return o+\" = \"+o+\" \"+t+\" \"+i}),L[e+\"VV\"]=L.pointwise2([\"x[i]\",\"y[i]\"],n(\"ret[i]\",\"x[i]\",\"y[i]\"),s),L[e+\"SV\"]=L.pointwise2([\"x\",\"y[i]\"],n(\"ret[i]\",\"x\",\"y[i]\"),s),L[e+\"VS\"]=L.pointwise2([\"x[i]\",\"y\"],n(\"ret[i]\",\"x[i]\",\"y\"),s),L[e]=L.compile(`var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric.`+e+\"VV, VS = numeric.\"+e+\"VS, SV = numeric.\"+e+`SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === \"object\") {\n      if(typeof y === \"object\") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === \"object\") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else `+r(\"x\",\"y\")+`\n}\nreturn x;\n`),L[t]=L[e],L[e+\"eqV\"]=L.pointwise2([\"ret[i]\",\"x[i]\"],r(\"ret[i]\",\"x[i]\"),s),L[e+\"eqS\"]=L.pointwise2([\"ret[i]\",\"x\"],r(\"ret[i]\",\"x\"),s),L[e+\"eq\"]=L.compile(`var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric.`+e+\"eqV, S = numeric.\"+e+`eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === \"object\") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n`)}for(e=0;e<L.mathfuns2.length;++e)t=L.mathfuns2[e],delete L.ops2[t];for(e=0;e<L.mathfuns.length;++e)t=L.mathfuns[e],L.ops1[t]=t;for(e in L.ops1)L.ops1.hasOwnProperty(e)&&(s=\"\",t=L.ops1[e],L.myIndexOf.call(L.mathfuns,e)!==-1&&Math.hasOwnProperty(t)&&(s=\"var \"+t+\" = Math.\"+t+`;\n`),L[e+\"eqV\"]=L.pointwise2([\"ret[i]\"],\"ret[i] = \"+t+\"(ret[i]);\",s),L[e+\"eq\"]=L.compile(\"x\",'if(typeof x !== \"object\") return '+t+`x\nvar i;\nvar V = numeric.`+e+`eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n`),L[e+\"V\"]=L.pointwise2([\"x[i]\"],\"ret[i] = \"+t+\"(x[i]);\",s),L[e]=L.compile(\"x\",'if(typeof x !== \"object\") return '+t+`(x)\nvar i;\nvar V = numeric.`+e+`V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n`));for(e=0;e<L.mathfuns.length;++e)t=L.mathfuns[e],delete L.ops1[t];for(e in L.mapreducers)L.mapreducers.hasOwnProperty(e)&&(t=L.mapreducers[e],L[e+\"V\"]=L.mapreduce2(t[0],t[1]),L[e]=L.compile(\"x\",\"s\",\"k\",t[1]+`if(typeof x !== \"object\") {    xi = x;\n`+t[0]+`\n    return accum;\n}if(typeof s === \"undefined\") s = numeric.dim(x);\nif(typeof k === \"undefined\") k = 0;\nif(k === s.length-1) return numeric.`+e+`V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n`+t[0]+`\n}\nreturn accum;\n`))})();L.inv=function(g){var n=L.dim(g),r=Math.abs,s=n[0],o=n[1],i=L.clone(g),a,u,c=L.identity(s),p,l,m,d,y,g;for(d=0;d<o;++d){var f=-1,h=-1;for(m=d;m!==s;++m)y=r(i[m][d]),y>h&&(f=m,h=y);for(u=i[f],i[f]=i[d],i[d]=u,l=c[f],c[f]=c[d],c[d]=l,g=u[d],y=d;y!==o;++y)u[y]/=g;for(y=o-1;y!==-1;--y)l[y]/=g;for(m=s-1;m!==-1;--m)if(m!==d){for(a=i[m],p=c[m],g=a[d],y=d+1;y!==o;++y)a[y]-=u[y]*g;for(y=o-1;y>0;--y)p[y]-=l[y]*g,--y,p[y]-=l[y]*g;y===0&&(p[0]-=l[0]*g)}}return c};L.det=function(t){var n=L.dim(t);if(n.length!==2||n[0]!==n[1])throw new Error(\"numeric: det() only works on square matrices\");var r=n[0],s=1,o,i,a,u=L.clone(t),c,p,l,m,d,y,g;for(i=0;i<r-1;i++){for(a=i,o=i+1;o<r;o++)Math.abs(u[o][i])>Math.abs(u[a][i])&&(a=o);for(a!==i&&(m=u[a],u[a]=u[i],u[i]=m,s*=-1),c=u[i],o=i+1;o<r;o++){for(p=u[o],l=p[i]/c[i],a=i+1;a<r-1;a+=2)d=a+1,p[a]-=c[a]*l,p[d]-=c[d]*l;a!==r&&(p[a]-=c[a]*l)}if(c[i]===0)return 0;s*=c[i]}return s*u[i][i]};L.transpose=function(t){var n,r,s=t.length,o=t[0].length,i=Array(o),a,u,c;for(r=0;r<o;r++)i[r]=Array(s);for(n=s-1;n>=1;n-=2){for(u=t[n],a=t[n-1],r=o-1;r>=1;--r)c=i[r],c[n]=u[r],c[n-1]=a[r],--r,c=i[r],c[n]=u[r],c[n-1]=a[r];r===0&&(c=i[0],c[n]=u[0],c[n-1]=a[0])}if(n===0){for(a=t[0],r=o-1;r>=1;--r)i[r][0]=a[r],--r,i[r][0]=a[r];r===0&&(i[0][0]=a[0])}return i};L.negtranspose=function(t){var n,r,s=t.length,o=t[0].length,i=Array(o),a,u,c;for(r=0;r<o;r++)i[r]=Array(s);for(n=s-1;n>=1;n-=2){for(u=t[n],a=t[n-1],r=o-1;r>=1;--r)c=i[r],c[n]=-u[r],c[n-1]=-a[r],--r,c=i[r],c[n]=-u[r],c[n-1]=-a[r];r===0&&(c=i[0],c[n]=-u[0],c[n-1]=-a[0])}if(n===0){for(a=t[0],r=o-1;r>=1;--r)i[r][0]=-a[r],--r,i[r][0]=-a[r];r===0&&(i[0][0]=-a[0])}return i};L.norm2=function(t){return Math.sqrt(L.norm2Squared(t))};L.linspace=function(t,n,r){if(typeof r==\"undefined\"&&(r=Math.max(Math.round(n-t)+1,1)),r<2)return r===1?[t]:[];var s,o=Array(r);for(r--,s=r;s>=0;s--)o[s]=(s*n+(r-s)*t)/r;return o};L.getBlock=function(t,n,r){var s=L.dim(t);function o(i,a){var u,c=n[a],p=r[a]-c,l=Array(p);if(a===s.length-1){for(u=p;u>=0;u--)l[u]=i[u+c];return l}for(u=p;u>=0;u--)l[u]=o(i[u+c],a+1);return l}return o(t,0)};L.setBlock=function(t,n,r,s){var o=L.dim(t);function i(a,u,c){var p,l=n[c],m=r[c]-l;if(c===o.length-1)for(p=m;p>=0;p--)a[p+l]=u[p];for(p=m;p>=0;p--)i(a[p+l],u[p],c+1)}return i(t,s,0),t};L.getRange=function(t,n,r){var s=n.length,o=r.length,i,a,u=Array(s),c,p;for(i=s-1;i!==-1;--i)for(u[i]=Array(o),c=u[i],p=t[n[i]],a=o-1;a!==-1;--a)c[a]=p[r[a]];return u};L.blockMatrix=function(t){var n=L.dim(t);if(n.length<4)return L.blockMatrix([t]);var r=n[0],s=n[1],o,i,a,u,c;for(o=0,i=0,a=0;a<r;++a)o+=t[a][0].length;for(u=0;u<s;++u)i+=t[0][u][0].length;var p=Array(o);for(a=0;a<o;++a)p[a]=Array(i);var l=0,m,d,y,g,f;for(a=0;a<r;++a){for(m=i,u=s-1;u!==-1;--u)for(c=t[a][u],m-=c[0].length,y=c.length-1;y!==-1;--y)for(f=c[y],d=p[l+y],g=f.length-1;g!==-1;--g)d[m+g]=f[g];l+=t[a][0].length}return p};L.tensor=function(t,n){if(typeof t==\"number\"||typeof n==\"number\")return L.mul(t,n);var r=L.dim(t),s=L.dim(n);if(r.length!==1||s.length!==1)throw new Error(\"numeric: tensor product is only defined for vectors\");var o=r[0],i=s[0],a=Array(o),u,c,p,l;for(c=o-1;c>=0;c--){for(u=Array(i),l=t[c],p=i-1;p>=3;--p)u[p]=l*n[p],--p,u[p]=l*n[p],--p,u[p]=l*n[p],--p,u[p]=l*n[p];for(;p>=0;)u[p]=l*n[p],--p;a[c]=u}return a};L.epsilon=2220446049250313e-31;L.LU=function(e,t){t=t||!1;var n=Math.abs,r,s,o,i,a,u,c,p,l,m=e.length,d=m-1,y=new Array(m);for(t||(e=L.clone(e)),o=0;o<m;++o){for(c=o,u=e[o],l=n(u[o]),s=o+1;s<m;++s)i=n(e[s][o]),l<i&&(l=i,c=s);for(y[o]=c,c!=o&&(e[o]=e[c],e[c]=u,u=e[o]),a=u[o],r=o+1;r<m;++r)e[r][o]/=a;for(r=o+1;r<m;++r){for(p=e[r],s=o+1;s<d;++s)p[s]-=p[o]*u[s],++s,p[s]-=p[o]*u[s];s===d&&(p[s]-=p[o]*u[s])}}return{LU:e,P:y}};L.LUsolve=function(t,n){var r,s,o=t.LU,i=o.length,a=L.clone(n),u=t.P,c,p,l,m;for(r=i-1;r!==-1;--r)a[r]=n[r];for(r=0;r<i;++r)for(c=u[r],u[r]!==r&&(m=a[r],a[r]=a[c],a[c]=m),p=o[r],s=0;s<r;++s)a[r]-=a[s]*p[s];for(r=i-1;r>=0;--r){for(p=o[r],s=r+1;s<i;++s)a[r]-=a[s]*p[s];a[r]/=p[r]}return a};L.solve=function(t,n,r){return L.LUsolve(L.LU(t,r),n)};var sr=L;var aX=Math.pow(2,-52);function wT(e){for(let t of e)for(let n of t)if(!gn(n))return!1;return!0}function kB(e){let t=[];for(let n of e)t.push(n.slice());return t}function ZD(e){let{numRows:t,numCols:n}=Od(e),r=[];for(let s=0;s<n;s++)r.push([]);for(let s=0;s<t;s++)for(let o=0;o<n;o++)r[o].push(e[s][o]);return r}function Od(e){let t=e.length,n=t>0?e[0].length:0;return{numRows:t,numCols:n}}function $B(e){let{numRows:t,numCols:n}=Od(e);return t===n}function XD(e){if(!$B(e))return!0;let t=w(lX(e));return!isFinite(t)||t===0}function uX(){throw new Error(\"Matrix dimension mismatch\")}function cX(){throw new Error(\"Expected square matrix\")}function LT(e,t){let n=Od(e),r=Od(t);n.numCols!==r.numRows&&uX();let s=[];for(let o=0;o<n.numRows;o++){let i=[];for(let a=0;a<r.numCols;a++){let u=be(0,1);for(let c=0;c<e[o].length;c++)u=fo(u,wr(e[o][c],t[c][a]));i.push(u)}s.push(i)}return s}function lX(e){let{determinant:t}=WD(kB(e));return t}function YB(e){if($B(e)||cX(),XD(e))throw new Error(\"Cannot invert a singular matrix\");let{numRows:t,numCols:n}=Od(e),r=[];for(let o=0;o<t;o++){let i=e[o].slice();for(let a=0;a<n;a++)i.push(be(o===a?1:0,1));r.push(i)}WD(r);let s=[];for(let o of r)s.push(o.slice(n));return s}function ZB(e){let t=kB(e);return WD(t),t}function pX(e){let t=0;for(let n of e)for(let r of n){let s=Math.abs(w(r));if(!isFinite(s))return NaN;s>t&&(t=s)}return t}function zB(e){for(let t=0;t<e.length;t++)for(let n=0;n<e[t].length;n++)e[t][n]=NaN}function WD(e){let{numRows:t,numCols:n}=Od(e),r=pX(e);if(!isFinite(r))return zB(e),{determinant:NaN,rank:0};let s=Math.max(t,n)*r*aX,o=be(1,1),i=0,a=0;for(;i<t&&a<n;){let u=i,c=Math.abs(w(e[i][a]));for(let l=i+1;l<t;l++){let m=Math.abs(w(e[l][a]));(!isFinite(m)||m>c)&&(c=m,u=l)}if(!isFinite(c))return zB(e),{determinant:NaN,rank:0};if(c===0){o=be(0,1),a+=1;continue}if(!gn(e[u][a])&&c<s){for(let l=i;l<t;l++)e[i][l]=0;o=0,a+=1;continue}if(u!==i){o=mo(o);let l=e[i];e[i]=e[u],e[u]=l}for(let l=0;l<t;l++){if(l===i)continue;let m=Vs(e[l][a],e[i][a]);e[l][a]=be(0,1);for(let d=a+1;d<n;d++)e[l][d]=_o(e[l][d],wr(m,e[i][d]))}let p=e[i][a];o=wr(o,p),e[i][a]=be(1,1);for(let l=a+1;l<n;l++)e[i][l]=Vs(e[i][l],p);i+=1,a+=1}return{rank:i,determinant:i===t&&i===n?o:be(0,1)}}function dX(e,t){let n=e.length,r=t.length,s=0,o=0;for(let a=r-n;a<r;a++)s+=e[a+n-r]*t[a],o+=e[a+n-r]*e[a+n-r];let i=s/o;for(let a=r-n;a<r;a++)t[a]=2*i*e[a+n-r]-t[a]}function fX(e,t,n){let r=e.length,s=t.length,o=0,i=0;for(let u=s-r;u<s;u++)o+=e[u+r-s]*t[u][n],i+=e[u+r-s]*e[u+r-s];let a=o/i;for(let u=s-r;u<s;u++)t[u][n]=2*a*e[u+r-s]-t[u][n]}function yX(e,t,n,r){let s=Array(e.length-t);if(s.length===1)return s[0]=1,s;if(r===0){s[0]=1;for(let i=1;i<s.length;i++)s[i]=0;return s}let o=e[t][n]<0?-1:1;s[0]=e[t][n]+o*Math.sqrt(r);for(let i=t+1;i<e.length;i++)s[i-t]=e[i][n];return s}function gX(e,t,n){let r=0;for(;t<e.length;t++)r+=e[t][n]*e[t][n];return r}function FT(e,t){if(!t||!t.mutateInput){let o=e;e=Array(e.length);for(let i=0;i<o.length;i++)e[i]=o[i].slice()}let n=Math.min(e.length,e[0].length),r=Array(n),s=[];for(let o=0;o<n;o++){let i=-1/0,a=o;for(let c=o;c<e[o].length;c++){let p=gX(e,o,c);p>i&&(i=p,a=c)}if(r[o]=a,a!==o)for(let c=0;c<e.length;c++){let p=e[c][a];e[c][a]=e[c][o],e[c][o]=p}let u=yX(e,o,o,i);for(let c=o;c<e[o].length;c++)fX(u,e,c);s.push(u)}return{reflectors:s,r:e,p:r}}function XB(e,t,n){let{reflectors:r,r:s,p:o}=e,i=t.slice();for(let c=0;c<r.length;c++)dX(r[c],i);for(let c=r.length;c<s[0].length;c++)i[c]=0;i.length=s[0].length;let a=Math.pow(2,-52),u=n.regularize?a*Math.abs(s[0][0])*Math.max(s.length,s[0].length):0;for(let c=r.length-1;c>=0;c--){let p=s[c];if(Math.abs(p[c])<=u)i[c]=0;else{for(let l=c+1;l<r.length;l++)i[c]-=i[l]*p[l];i[c]/=p[c]}}for(let c=o.length-1;c>=0;c--)if(o[c]!==c){let p=i[c];i[c]=i[o[c]],i[o[c]]=p}return i}function hX(e,t,n){let r=Array(e.r[0].length);for(let o=0;o<r.length;o++)r[o]=Array(t[0].length);let s=Array(t.length);for(let o=0;o<t[0].length;o++){for(let a=0;a<t.length;a++)s[a]=t[a][o];let i=XB(e,s,n);for(let a=0;a<i.length;a++)r[a][o]=i[a]}return r}function Mp(e,t,n){return Array.isArray(t[0])?hX(e,t,n):XB(e,t,n)}function bX(e){let t=e.r,n=Math.min(t.length,t[0].length),r=t[0][0],s=t[n-1][n-1];return r===0?1/0:Math.abs(r/s)}function WB(e){let t=Math.pow(2,-52);return Math.max(e.r.length,e.r[0].length)*t*bX(e)<1}function BT(e,t){let n=[];for(let r=0;r<t;r++)n.push(e);return n}function sg(e,t){let n=xl(e,t),r=0;for(let s of n){let o=s;r+=o*o}return r/n.length}function xl(e,t){return e.apply(void 0,t)}function VT(e,t){let n=[];for(let r of e){let s=r.apply(void 0,t);n.push(s)}return n}function jB(e,t){let n=[];for(let r=0;r<e.length;r++)t[r]&&n.push(e[r]);return n}function jD(e,t,n){let r=[];for(let s=0,o=0;s<e.length;s++){let i=0;n[s]&&(i=t[o],o+=1),r.push(e[s]+i)}return r}function KD(e,t){let n=t.solution.map(u=>Math.abs(u)<1e-6?0:u),r=t.solution.map(()=>0),s=sg(e,n),o=xl(e,n),i=xl(e,r),a=0;for(let u=0;u<o.length;u++){let c=i[u]*1e-15;a+=Math.abs(o[u]*c)+c*c}return a/=o.length,isFinite(a)||(a=0),isFinite(t.MSE)&&!isFinite(s)?t:s<=t.MSE+a?{solution:n,MSE:s}:t}function eN(e,t){if(!wT(t)||!wT([e]))return;let n=ZD(t),r=LT([e],n)[0],s=LT(t,n);for(let c=0;c<r.length;c++)s[c].push(mo(r[c]));let o=ZB(s);if(!wT(o))return;let i=[],a=r.length,u=0;for(let c of o)for(;u<a;)if(w(c[u])===1){i.push(c[c.length-1]),u++;break}else i.push(be(0,1)),u++;for(;u<a;)i.push(be(0,1)),u++;return i}function tN(e){let t=LT(e,ZD(e));if(XD(t)){let s=[];for(let o=0;o<t.length;o++)s.push(NaN);return s}let n=YB(t),r=[];for(let s=0;s<n.length;s++)r.push(n[s][s]);return r}function nN(e,t){let n=BT(0,t.length),r=VT(t,n),s=FT(sr.transpose(r),{mutateInput:!0});for(let u=0;u<2;u++){let c=xl(e,n),p=sr.neg(Mp(s,c,{regularize:!1}));n=sr.add(n,p)}let o=sg(e,n);if(WB(s))return{solution:n,MSE:o};let i=BT(0,t.length);for(let u=0;u<2;u++){let c=xl(e,i),p=sr.neg(Mp(s,c,{regularize:!0}));i=sr.add(i,p)}let a=sg(e,i);return .999*a<=o?{solution:i,MSE:a}:{solution:n,MSE:o}}function JD(e,t,n,r){let s=r.maxIterations,o=r.linearSubset||BT(!1,n.length),i=sr.not(o),a=jB(t,o),u=jB(t,i),c=2,p=.1,l=n,m=0,d=.001,y;if(a.length>0){let h=sr.transpose(VT(a,l)),x=FT(h);y={Jv:h,F:x};let T=xl(e,l),P=sr.neg(Mp(x,T,{regularize:!0}));l=jD(l,P,o)}let g=!1,f=sg(e,l);for(;m<s&&!g&&isFinite(f);){let h=xl(e,l),x=VT(u,l),T=sr.transpose(x),P,M;if(y){let{F:v,Jv:D}=y;P=sr.dot(x,sr.sub(h,sr.dot(D,Mp(v,h,{regularize:!0})))),M=sr.dot(x,sr.sub(T,sr.dot(D,Mp(v,T,{regularize:!0}))))}else P=sr.dot(x,h),M=sr.dot(x,T);let S=l,E=!1;for(;m<s&&!g&&!E;){m+=1;let v=sr.add(M,sr.diag(BT(d,u.length))),D=sr.neg(sr.solve(v,P,!0));S=jD(l,D,i),g=sr.all(sr.eq(S,l));let G;if(y){let Q=sr.transpose(VT(a,S)),W=FT(Q);G={Jv:Q,F:W};let K=xl(e,S),J=sr.neg(Mp(W,K,{regularize:!0}));S=jD(S,J,o)}let j=sg(e,S);E=j<f,E?(l=S,f=j,y=G,d*=p):(d=Math.max(d,1e-64),d*=c)}}return{solution:l,MSE:f}}var QD=[18.9,.105,.0113,.089,4.414,.373,.06,.149,1.84,9.26,5,.7,.2,1.13,2.61,1,.007,30,120,1500,4e-4,7.23,-1,-.0081,-.03,-28.6,-1.71,-.4,-6.94,-.777,-500];function xX(e){let t=e*503%QD.length;return QD[t]}function TX(e){let t=[];for(let n=0;n<QD.length;n++){let r=[];for(let s=0;s<e;s++)n===0&&e!==1?r[s]=0:n===1&&e!==1?r[s]=1:r[s]=xX(n*e+s);t.push(r)}return t}function JB(e,t,n,r,s){let o=[];for(let a of n)o.push({soln:JD(e,t,a,s),initialGuess:a});o.sort((a,u)=>isNaN(a.soln.MSE)?1:isNaN(u.soln.MSE)?-1:a.soln.MSE-u.soln.MSE);let i=[];for(let a=0;a<r;a++)i.push(o[a].initialGuess);return i}function IX(e,t,n,r){if(!t||co(t))return e;let s=t.bounds;return s[0]===-1/0&&s[1]===1/0?e:s[0]===-1/0?s[1]-Math.exp(-e):s[1]===1/0?s[0]+Math.exp(e):n/(r-1)*s[1]+(r-1-n)/(r-1)*s[0]}var QB=[3,5,7,11,13,17,19];function PX(e,t){let n=[];for(let r=0;r<e.length;r++){let s=e[r],o=[];for(let i=0;i<s.length;i++){let a=QB[i%QB.length]*r%e.length;o.push(IX(s[i],t[i],a,e.length))}n.push(o)}return n}function KB(e,t,n){n||(n={});let{linearSubset:r,bounds:s,preferredInitialGuess:o}=n,i=TX(t.length);s&&(i=PX(i,s));let a=JB(e,t,i,5,{maxIterations:3,linearSubset:r}),u=JB(e,t,a,1,{maxIterations:60,linearSubset:r}),c=JD(e,t,u[0],{maxIterations:250,linearSubset:r});if(!o)return c;let p=JD(e,t,o,{maxIterations:100,linearSubset:r});return isFinite(p.MSE)&&(p.MSE<c.MSE||Co(p.MSE,c.MSE,8))?p:c}function rN(e){return{chunk:e,isLazy:!0}}function e3(e){return e.slice()}function HT(e){if(!e.isLazy)return e;let t=e.chunk.copy();return t.reopenFinalBlock(),{chunk:t,forwardParameterMap:e3,reverseParameterMap:e3,isLazy:!1,valueMap:DX(e.chunk.instructionsLength()),replacementMask:Ad(e.chunk.argNames.length)}}function t3(e){let{chunk:t,forwardParameterMap:n,reverseParameterMap:r,isLazy:s,valueMap:o,replacementMask:i,didShiftScale:a}=e;return{chunk:t.copy(),forwardParameterMap:n,reverseParameterMap:r,isLazy:s,valueMap:o.slice(),replacementMask:i.slice(),didShiftScale:a}}function EX(e){let t=1/0,n=-1/0,r=e.length;for(let s of e)t=Math.min(t,s),n=Math.max(n,s);return{min:t,max:n,length:r}}function s3(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==48)return;let n=t.args[0],r=e.getReturnIndex()-n,s=e.getInstruction(n);if(s.args.length!==2)return;let o=s.args[0],i=s.args[r],a=[],u=[];a.push(o),u.push({min:1,max:qa(e,e.getReturnIndex(),\"Programming error: cannot optimize regression on non-constant-length list\"),length:qa(e,e.getReturnIndex(),\"Programming error: cannot optimize regression on non-constant-length list\")});let c=!1,p=!1;for(let f=o+1;f<=i;f++){let h=e.getInstruction(f);if(h.type===39||h.type===41||h.type===40){if(h.args[1]!==o)continue;let x=h.args[0];if(e.getInstruction(x).valueType!==Y||!Ue(e.getInstruction(x)))continue;let T=Lr(e,x),P=EX(T);if(!isFinite(P.min)||!isFinite(P.max))continue;a.push(f),u.push(P)}else if(h.type===37)h.symbol===\"exp\"?p=!0:r3(h)&&(c=!0);else if(h.type===12||h.type===13)p=!0;else if(cs(h)||Ss(h))return}if(a.length===0||!p&&!c)return;let l=[];for(let f=0;f<=i;f++){let h=a.indexOf(f);if(h!==-1){let x=Ad(a.length);x[h]=!0,l.push(x)}else l.push(GT(e,l,a.length,f))}let m=[];for(let f=0;f<=e.getReturnIndex();f++)if(e.getInstruction(f).type===2){let x=Ad(e.argNames.length);x[f]=!0,m.push(x)}else m.push(GT(e,m,e.argNames.length,f));let d={listAccessDependencyTable:l,listAccesses:a,listStatisticsTable:u},y;for(let f=o+1;f<=e.getReturnIndex();f++){let h=e.getInstruction(f);switch(h.type){case 37:{if(h.symbol===\"exp\"){let J=h.args[0],re=sN(d,J);if(re===void 0){dc(e,m,y,f);break}let{listStatistics:ie,listAccessIndex:It}=re,Bt=og(rN(e),f,J,It,ie);Bt?y=[Bt]:dc(e,m,y,f)}break}case 12:case 13:{let[J,re]=h.args,ie=sN(d,re);if(ie===void 0||n3(d,J)){dc(e,m,y,f);break}let{listStatistics:It,listAccessIndex:Bt}=ie,xe=MX(rN(e),f,Bt,It);xe?y=[xe]:dc(e,m,y,f);break}case 10:if(y&&y.length>1){dc(e,m,y,f);break}let x=y&&y.length>0?y[0]:rN(e),[T,P]=h.args,M=x.isLazy?T:x.valueMap[T],S=x.isLazy?P:x.valueMap[P],E=x.chunk.getInstruction(M),v=x.chunk.getInstruction(S),D,G,j;if(E.type===37)D=T,j=E,G=P;else if(v.type===37)D=P,j=v,G=T;else{dc(e,m,y,f);break}let Q=sN(d,D);if(Q===void 0||n3(d,G)){dc(e,m,y,f);break}let{listAccessIndex:W,listStatistics:K}=Q;if(j.symbol===\"exp\"){let J=CX(x,f,G,D,W,K);if(J){y=J;break}}else if(r3(j)){let J=SX(x,f,G,D,W);if(J){y=[J];break}}dc(e,m,y,f);break;default:{dc(e,m,y,f);break}}}if(y===void 0||y.length===0)return;let g=[];for(let f of y)g.push({chunk:f.chunk,forwardParameterMap:f.forwardParameterMap,reverseParameterMap:f.reverseParameterMap});return g}function dc(e,t,n,r){if(n===void 0)return;let s=e.getInstruction(r);if(ce(s))for(let o of n){let{chunk:i,valueMap:a}=o,u=[],c=0;for(let p of s.args){if(a[p]!==p){if(c+=1,c>1){n.length=0;return}}else{let l=t[p];for(let m=0;m<l.length;m++)if(l[m]&&o.replacementMask[m]){n.length=0;return}}u.push(a[p])}a[r]=c>0?od(i,s,u):r}else for(let o of n)o.valueMap[r]=r}function sN(e,t){let{listAccessDependencyTable:n,listAccesses:r,listStatisticsTable:s}=e,o,i=n[t];for(let a=0;a<i.length;a++)if(i[a]){if(o)return;o={listAccessIndex:r[a],listStatistics:s[a]}}return o}function n3(e,t){let{listAccessDependencyTable:n}=e,r=n[t];for(let s of r)if(s)return!0;return!1}function oN(e,t){let n=[];for(let o=0;o<=t;o++)if(e.getInstruction(o).type===2){let a=Ad(e.argNames.length);a[o]=!0,n.push(a)}else n.push(GT(e,n,e.argNames.length,o));let r,s=n[t];for(let o=0;o<s.length;o++)if(s[o]){if(r!==void 0)return;r=o}return r}function SX(e,t,n,r,s){let o=e.chunk,i=oN(o,n);if(i===void 0)return;let a=iN(e,n,i);if(a===void 0)return;let u=o.getInstruction(r),c=u.args[0];if(a=o3(a,c,s),a===void 0)return;let{chunk:p,valueMap:l}=a,m=p.getInstruction(l[c]);if(m.type!==8)return;let d=m.args[1],y=p.getInstruction(m.args[0]);if(y.type!==10)return;let[g,f]=y.args,h=i,x=d,T=g,P=f,M=p.Multiply([T,P]),S=p.NativeFunction(\"cos\",[M]),E=p.NativeFunction(\"sin\",[M]),v=u.symbol===\"sin\"?p.Add([p.Multiply([h,E]),p.Multiply([x,S])]):p.Subtract([p.Multiply([h,S]),p.Multiply([x,E])]);l[t]=v;function D(Q){let W=a.forwardParameterMap(Q),K=W[i],J=W[d],re=K*Math.cos(J),ie=K*Math.sin(J);return W[i]=re,W[d]=ie,W}function G(Q){let W=Q.slice(),K=Q[i],J=Q[d],re=Bs(K,J),ie=Math.atan2(J,K);return W[i]=re,W[d]=ie,a.reverseParameterMap(W)}let j=a.replacementMask.slice();return j[i]=!0,j[g]=!0,j[d]=!0,{chunk:p,forwardParameterMap:D,reverseParameterMap:G,valueMap:l,replacementMask:j,isLazy:!1}}function MX(e,t,n,r){let s=e.chunk,o=s.getInstruction(t),[i,a]=o.args,u=s.getInstruction(i);if(u.type===1&&u.valueType===b&&w(u.value)>0){let x=HT(e),{chunk:T,valueMap:P}=x,M=T.Multiply([T.NativeFunction(\"ln\",[P[i]]),P[a]]);return P[a]=M,P[t]=T.NativeFunction(\"exp\",[M]),og(x,t,a,n,r)||x}let c=oN(s,i);if(c===void 0)return;let p=iN(e,i,c);if(p===void 0)return;let{chunk:l,valueMap:m}=p,d=l.Multiply([m[i],m[a]]);m[a]=d,m[t]=l.NativeFunction(\"exp\",[d]);function y(x){let T=p.forwardParameterMap(x),P=T[c],M=Math.log(P);return T[c]=M,T}function g(x){let T=x.slice(),P=T[c],M=Math.exp(P);return T[c]=M,p.reverseParameterMap(T)}let f=p.replacementMask.slice();f[c]=!0;let h={chunk:l,forwardParameterMap:y,reverseParameterMap:g,isLazy:!1,valueMap:m,replacementMask:f};return og(h,t,a,n,r)||h}function CX(e,t,n,r,s,o){if(!e.isLazy&&e.didShiftScale)return;let i=e.isLazy?e:t3(e),a=e.chunk,u=oN(a,n);if(u===void 0)return;let c=iN(e,n,u);if(c===void 0)return;let{chunk:p,valueMap:l}=c,m=p.getInstruction(l[r]).args[0],d=p.Add([m,l[n]]);l[n]=d,l[t]=p.NativeFunction(\"exp\",[d]);function y(S){let E=c.forwardParameterMap(S),v=E[u],D=Math.log(v);return E[u]=D,E}function g(S){let E=S.slice(),v=E[u],D=Math.exp(v);return E[u]=D,c.reverseParameterMap(E)}function f(S){let E=c.forwardParameterMap(S),v=E[u],D=Math.log(-v);return E[u]=D,E}function h(S){let E=S.slice(),v=E[u],D=-Math.exp(v);return E[u]=D,c.reverseParameterMap(E)}let x=c.replacementMask.slice();x[u]=!0;let T=HT(i);T.valueMap[t]=T.chunk.Multiply([T.valueMap[n],T.valueMap[r]]);let P={chunk:p,forwardParameterMap:y,reverseParameterMap:g,isLazy:!1,valueMap:l,replacementMask:x},M=t3(P);return M.forwardParameterMap=f,M.reverseParameterMap=h,P=og(P,t,n,s,o)||P,M=og(M,t,n,s,o)||M,M.valueMap[t]=M.chunk.Negative([M.valueMap[t]]),[T,P,M]}function og(e,t,n,r,s){let o=vX(e,n,r,s);if(o!==void 0)return o.valueMap[t]=o.chunk.NativeFunction(\"exp\",[o.valueMap[n]]),o}function vX(e,t,n,r){let s=o3(e,t,n);if(s===void 0)return;let{chunk:o,valueMap:i}=s,a=o.getInstruction(i[t]);if(a.type!==8)return;let u=a.args[1],c=o.getInstruction(a.args[0]);if(c.type!==10)return;let[p,l]=c.args,{min:m,max:d}=r,y=d-m,g=.5*(d+m),f=o.Divide([o.Subtract([l,o.Constant(g)]),o.Constant(y)]),h=o.Add([o.Multiply([p,f]),u]);i[t]=h;function x(P){let M=s.forwardParameterMap(P),S=M[p],E=M[u],v=S*y,D=E+g*S;return M[p]=v,M[u]=D,M}function T(P){let M=P.slice(),S=P[p],E=P[u],v=S/y,D=E-v*g;return M[p]=v,M[u]=D,s.reverseParameterMap(M)}return{chunk:o,forwardParameterMap:x,reverseParameterMap:T,isLazy:!1,valueMap:i,replacementMask:s.replacementMask,didShiftScale:!0}}function iN(e,t,n){let r=e.chunk,s=ps(r,n,{allowRestriction:!1,allowClosedBlockReferences:!1});if(yn(s,t)!==1)return;let o=Ki(s,t),[i,a]=ir(o,t);if(a===void 0)return;let u=o.newChunk.getInstruction(i);if(u.type!==1||u.valueType!==b)return;let c=o.newChunk.getInstruction(a);if(c.type!==1||c.valueType!==b)return;let p=HT(e),{chunk:l,valueMap:m}=p,d=w(u.value),y=w(c.value);m[t]=n;function g(x){let T=p.forwardParameterMap(x),P=T[n],M=d+y*P;return T[n]=M,T}function f(x){let T=x.slice(),M=(T[n]-d)/y;return T[n]=M,p.reverseParameterMap(T)}let h=p.replacementMask.slice();return h[n]=!0,{chunk:l,forwardParameterMap:g,reverseParameterMap:f,isLazy:!1,valueMap:m,replacementMask:h}}function o3(e,t,n){let r=e.chunk,s=e.isLazy?t:e.valueMap[t],o=ps(r,n,{allowRestriction:!1,allowClosedBlockReferences:!0});if(yn(o,s)!==1)return;e.isLazy&&(o=ps(r.copy().reopenFinalBlock(),n,{allowRestriction:!1,allowClosedBlockReferences:!1}));let i=Ki(o,s),[a,u]=ir(i,s);if(u===void 0)return;let c=i.newChunk,p=Math.max(u,a),l=[];for(let ee=0;ee<=p;ee++)if(c.getInstruction(ee).type===2){let te=Ad(c.argNames.length);te[ee]=!0,l.push(te)}else l.push(GT(c,l,c.argNames.length,ee));let m,d;for(let ee=0;ee<r.argNames.length;ee++)if(l[u][ee])if(m===void 0)m=ee;else return;else if(l[a][ee])if(d===void 0)d=ee;else return;if(m===void 0||d===void 0)return;let y=ps(c,m,{allowRestriction:!1,allowClosedBlockReferences:!1});if(yn(y,u)!==1)return;let g=ps(c,d,{allowRestriction:!1,allowClosedBlockReferences:!1});if(yn(g,a)!==1)return;let f=Ki(y,u),h=Ki(g,a),[x,T]=ir(f,u),P=f.newChunk.getInstruction(x);if(P.type!==1||P.valueType!==b)return;let M=f.newChunk.getInstruction(T);if(M.type!==1||M.valueType!==b)return;let S=HT(e),{chunk:E,valueMap:v}=S,D=E.Add([E.Multiply([m,n]),d]);v[t]=D;let G=c.copy();G.List([u,a]);let j=G.getCompiledFunction().fn;function Q(ee){let U=S.forwardParameterMap(ee),[te,Ce]=j.apply(null,U);return U[m]=te,U[d]=Ce,U}let W=w(P.value),K=w(M.value),[J,re]=ir(h,a),ie=h.newChunk.copy();ie.List([J,re]);let It=ie.getCompiledFunction().fn;function Bt(ee){let U=ee.slice(),te=ee[m],Ce=ee[d],Ge=(te-W)/K,pt=ee.slice();pt[m]=Ge,pt.splice(d,1);let[Rt,Mo]=It.apply(null,pt),gr=(Ce-Rt)/Mo;return U[m]=Ge,U[d]=gr,S.reverseParameterMap(U)}let xe=S.replacementMask.slice();return xe[m]=!0,xe[d]=!0,{chunk:E,forwardParameterMap:Q,reverseParameterMap:Bt,isLazy:!1,valueMap:v,replacementMask:xe}}function GT(e,t,n,r){let s=e.getInstruction(r),o=Ad(n);if(!ce(s))return o;for(let i of s.args){let a=t[i];for(let u=0;u<a.length;u++)o[u]=o[u]||a[u]}return o}function Ad(e){let t=[];for(let n=0;n<e;n++)t.push(!1);return t}function DX(e){let t=[];for(let n=0;n<e;n++)t.push(n);return t}function r3(e){return e.type===37&&(e.symbol===\"sin\"||e.symbol===\"cos\")}function h3(e,t){try{return OX(e,t)}catch(n){return n instanceof A.Error?n:V(n)}}var _d={coerceToNumber:\"all-except-complex\"},aN={..._d,wrapInList:!0};function i3(e){return e===b||e===Y||e===O||e===He}function NX(e){return!!e.tableRegressionData}function RX(e,t){return e===Ae||t===Ae?!1:i3(e)&&i3(t)}function OX(e,t){let{policy:n,frame:r,lastExportFrame:s}=e,o=Ga(t._lhs,n,r,_d),i=Ga(t._rhs,n,r,_d);if(o.isError)throw o;if(i.isError)throw i;if(!RX(o.valueType,i.valueType))throw _P([oe(o.valueType),oe(i.valueType)]);let a=Ga(t._difference,n,r,aN);if(a.isError)throw a;for(let S of a.getDependencies())if(!n.validRegressionParameter(S))throw mS(S);let u=a.valueType,p=!NX(t)?u3(a.getDependencies(),t.userData.regressionParameters,s):u3(a.getDependencies(),{},{}),{parameters:l,scaleFactors:m,residuals:d,isLinear:y,parameterWarning:g,displayPrecision:f}=g3(p,a,o),h={policy:n,frame:r},x=a3(h,t,l),T=bs.NONE;u===Y&&(T=BX(t,o,x));let P;if(t.userData.isLogModeRegression&&(T===bs.LOGLIN||T===bs.LOGLOG)){let S=Ga(t._logDifference,n,r,aN);if(S.isError)throw S;let E=Ga(t._logLhs,n,r,aN);if(E.isError)throw E;({parameters:l,isLinear:y,parameterWarning:g,displayPrecision:f}=g3(p,S,o)),x=a3(h,t,l),d=d3(h,t._difference,l);let v=d3(h,t._logDifference,l);P=p3(t,E,x,v,t.userData.isLogModeRegression,T,u)}else P=p3(t,o,x,d,t.userData.isLogModeRegression,T,u);let M={isModelValid:!!x.uniqueRHSNumberList,shouldSuggestLogMode:T!==bs.NONE,isLinear:y,scaleFactors:m,displayPrecision:f,parameterWarning:g};return{concreteDifference:a,plannedOpts:M,statistics:P,residuals:d,model:x,parameters:l}}function b3(e,t,n){let{residualVariable:r,tableStatements:s}=e,{concreteDifference:o,plannedOpts:i,statistics:a,residuals:u,model:c,parameters:p}=n,l=o.valueType,m=VX(t,r,s,u);return t.userData.residualVariable=ss(r),new A.OptimizedRegression(p,ut({valueType:l,value:u}),a,c.substituted,{...i,residualVariable:r,residualSuggestionId:m})}function AX(e){return!e.startsWith(\"dcgcolumnstmt\")}function x3(e,t,n){function r(a){var u;return!n.has(a)&&!((u=t.get(a))!=null&&u.some(AX))}if(e.userData&&e.userData.residualVariable){let a=vi(e.userData.residualVariable);if(r(a))return a}let s=e.getDependencies().filter(a=>a[0]!==\"_\"&&!a.startsWith(\"regressionparameter_\")&&!a.startsWith(\"idref_\")),o;for(let a of s){let u=a.match(/_(.*)/);if(u&&(o=\"e_\"+u[1],r(o)))return o}let i=1;for(;;){if(o=\"e_\"+i,r(o))return o;i++}}function a3({policy:e,frame:t},n,r){let s=n._rhs.getDependencies(),o,i;for(let l of s){if(r.hasOwnProperty(l))continue;let m=t[l];if(!m||m.type===\"Placeholder\")continue;m.type===\"Assignment\"&&(m=m._expression);let d=Ga(m,e,t,_d);if(!d.isError&&Jn(d.valueType,Y)){if(o!==void 0){o=void 0,i=void 0;break}d.getDependencies().length===0&&(o=l,i=d)}}let a=On(t);o!==void 0&&(a[o]=void 0);let u=Ga(n._rhs,e,a,_d),c=On(a);for(let l of he(r))c[l]=r[l];let p=Ga(n._rhs,e,c,_d);return{node:u,substituted:p,uniqueRHSNumberList:i}}function u3(e,t,n){let r=[];if(t||(t={}),n||(n={}),!e.every(s=>s in n||s in t))return e.map(s=>1);for(let s of e){let o=ss(s),i=n[s];i&&isFinite(i.asValue())?r.push(+i.asValue()):t.hasOwnProperty(o)&&isFinite(+t[o])?r.push(+t[o]):r.push(1)}return r}function lN(e,t){switch(t){case Y:return e;case He:return function(...r){let s=e.apply(void 0,r);return _X(s)};default:throw V(\"Regression with invalid value type.\")}}function c3(e,t){switch(t){case Y:return e;case He:return wX(e);default:throw V(\"Regression with invalid value type.\")}}function _X(e){let t=[];for(let[n,r]of e)t.push(n,r);return t}function wX(e){let t=[];for(let[n,r]of e)t.push(n,r);return t}function l3(e,t){let n=t.getDependencies(),r=t.getCompiledFunction(n).fn,s=t.valueType,o=lN(r,s);if(n.length){let i=t.findLinearSubset(n),a=i.every(c=>c),u=[];for(let c of n){let p=t.takeDerivative(c).getCompiledFunction(n).fn;u.push(lN(p,s))}if(a){let c=n.map(()=>be(0,1)),p=t.interpretWithParameters(c),l=c3(p,s),m=[];for(let f of n){let h=t.takeDerivative(f).interpretWithParameters(c);m.push(c3(h,s))}let d=eN(l,m);if(d){let f=t.interpretWithParameters(d);return{solution:d,scaleFactors:tN(m),residuals:f,MSE:qT(f,s),isLinear:a}}let{solution:y,MSE:g}=KD(o,nN(o,u));return{solution:y,scaleFactors:tN(m),residuals:r.apply(void 0,y),MSE:f3(g,s),isLinear:a}}else{let c=[];for(let d of n)c.push(t.boundDomain(d));let p={linearSubset:i,bounds:c,preferredInitialGuess:e},{solution:l,MSE:m}=KD(o,KB(o,u,p));return{solution:l,residuals:r.apply(void 0,l),MSE:f3(m,s),isLinear:a}}}else return{solution:[],residuals:t.interpretWithParameters([]),MSE:T3(r,[],s),isLinear:!0}}function uN(e,t){let n={},r=t.getDependencies();for(let s=0;s<r.length;s++){let o=new A.Constant(e[s]);n[r[s]]=o}return n}function p3(e,t,n,r,s,o,i){let a=qT(r,i);if(!isFinite(a))throw dS();if(t.getDependencies().length>0)return{RMSE:Math.sqrt(a)};let u=GX(t.asValue(),t.valueType);if(t.getDependencies().length||!isFinite(u)||u<=0||!e.isLhsSimple)return{RMSE:Math.sqrt(a)};{let c=1-a/u,p=LX(t,n,s,o,a);return p!==void 0?{r:p,rsquared:p*p}:{Rsquared:c}}}function m3(e){if(!Ni(e))return NaN;let t={valueType:e.valueType,value:e.asCompilerValue()},{value:n,valueType:r}=t;switch(r){case b:return n;case O:return w(n[1])===0?n[0]:NaN;default:return NaN}}function LX(e,t,n,r,s){if(!t.uniqueRHSNumberList)return;let o=[],i=[],a=n&&(r===bs.LINLOG||r===bs.LOGLOG);Es.eachArgs([t.uniqueRHSNumberList,e],p=>{let l=m3(p[0]),m=m3(p[1]);o.push(a?Math.log(w(l)):l),i.push(m)});let u=eb(o.map(w),i.map(w));if(!isFinite(u))return;let c=FX(o,i);if(Co(c.MSE,s,8))return u}function FX(e,t){let n=t,r=[e.map(a=>mo(a)),e.map(()=>be(-1,1))],s=eN(n,r);if(s){let[a,u]=s,c=[];for(let p=0;p<t.length;p++)c.push(_o(t[p],fo(wr(a,e[p]),u)));return{solution:s,MSE:qT(c,Y)}}function o(a,u){let c=[];for(let p=0;p<e.length;p++)c.push(w(t[p])-(a*w(e[p])+u));return c}return nN(o,[function(){return e.map(a=>-w(a))},function(){return e.map(()=>-1)}])}function VX(e,t,n,r){var a,u;let s=e._rhs.getDependencies(),o;(a=e.tableRegressionData)!=null&&a.tableId&&(o=(u=e.tableRegressionData)==null?void 0:u.tableId);for(let c in n){let p=n[c];if(p.columns.length===0)continue;let l=p.columns[0];o===void 0&&Bc(l)&&Aa(l.header)&&s.includes(l.header._symbol)&&(o=c);for(let m=1;m<p.columns.length;m++)if(p.columns[m].getDependencies().includes(t))return}if(!r.some(c=>Array.isArray(c)&&w(c[1])!==0))return o}function cN(e,t){let n=e.length,r=e[0],s=t[0],o=e[n-1],i=t[n-1];if(!isFinite(r)||!isFinite(o)||!isFinite(s)||!isFinite(i)||i-s===0)return!1;let a=o-r;if(a===0)return!1;for(let u=1;u<n-1;u++){let c=e[u],p=t[u],l=(i*(c-r)+s*(o-c))/a;if(!Co(p,l,5))return!1}return!0}var bs={NONE:0,LOGLIN:1,LOGLOG:2,LINLOG:3};function BX(e,t,n){if(!e.isLhsSimple||!n.uniqueRHSNumberList||se(t.valueType,O))return bs.NONE;let r=n.substituted;if(r.isError||r.valueType!==b)return bs.NONE;let s=r.getDependencies();if(s.length!==1||n.node.type===\"IRExpression\"&&isFinite(n.node.polynomialOrder(s[0])))return bs.NONE;let o=r.getCompiledFunction(s).fn,i=n.uniqueRHSNumberList;if(r.valueType!==b)return bs.NONE;let a=i.mapElements(m=>+m.asValue());if(a.length<3)return bs.NONE;a.sort((m,d)=>m-d);let u=a.map(o),c=u.map(Math.log),p=a.map(Math.log),l=!0;return Es.wrap(t).eachElement(m=>{isFinite(Math.log(+m.asValue()))||(l=!1)}),cN(a,c)&&l?bs.LOGLIN:cN(p,c)&&l?bs.LOGLOG:cN(p,u)?bs.LINLOG:bs.NONE}function d3({policy:e,frame:t},n,r){let s=On(t);for(let a of he(r))s[a]=r[a];let o=Dd({policy:e,frame:s,wrapInList:!0},n),i=o.getError();if(i)throw i;return o.asCompilerValue()}function qT(e,t){switch(t){case Y:{let n=0;for(let r of e){let s=w(r);n+=s*s}return n/e.length}case He:{let n=0;for(let[r,s]of e){let o=w(r);n+=o*o;let i=w(s);n+=i*i}return n/e.length}default:throw V(\"Regression with invalid value type.\")}}function GX(e,t){switch(t){case b:case O:return 0;case Y:return qf(e);case He:{let n=e,r=0,s=0;for(let[u,c]of n)r+=u,s+=c;let o=r/n.length,i=s/n.length,a=0;for(let[u,c]of n){let p=w(u)-o;a+=p*p;let l=w(c)-i;a+=l*l}return a/n.length}default:throw V(\"Regression with invalid value type.\")}}function T3(e,t,n){let r=e.apply(void 0,t);return qT(r,n)}function f3(e,t){switch(t){case Y:return e;case He:return e*Math.SQRT2;default:throw V(\"Regression with invalid value type.\")}}function y3(e,t,n,r){let s=5;if(!r)return s;let o=t.apply(void 0,e);for(let i=4;i<15;i++){let a=e.map(p=>parseFloat(p.toPrecision(i))),u=t.apply(void 0,a),c=0;for(let p=0;p<o.length;p++){let l=Math.abs(o[p]-u[p]);l>c&&(c=l)}if(c<n){s=i;break}}return s}function HX(e){let t=0;if($(e==null?void 0:e.valueType)){let n=e.asValue(),r=Qh(n),s=Jh(n);t=(s<0&&0<r?r-s:Math.max(Math.abs(s),Math.abs(r)))/500}return t}function g3(e,t,n){let r,s,o=t._chunk;o&&(s=s3(o));let i=$(n==null?void 0:n.valueType),a=HX(n);if(!s||s.length===0){t=t.deriveRegressionRestrictions(),r=l3(e,t);let P=t.getCompiledFunction(t.getDependencies()).fn,M=y3(r.solution.map(S=>w(S)),P,a,i);return{parameters:uN(r.solution,t),scaleFactors:r.scaleFactors?uN(r.scaleFactors,t):void 0,displayPrecision:M,residuals:r.residuals,isLinear:r.isLinear,parameterWarning:!1}}let u=t.getDependencies(),c=t.valueType,p=t.getCompiledFunction(u).fn,l=lN(p,c),m=1/0,d={},y,g=!1,f=1/0,h=5;for(let P of s){let M=new Dn(P.chunk);if(M=M.deriveRegressionRestrictions(),r=l3(P.forwardParameterMap(e),M),r.MSE<m){let S=P.reverseParameterMap(r.solution.map(v=>w(v))),E=T3(p,S,c);if(d&&(!isFinite(E)||E>=m)){isFinite(E)||(g=!0,r.MSE<f&&(f=r.MSE));continue}m=r.MSE,d=uN(S,t),y=l.apply(void 0,S),h=y3(S,l,a,i)}}let x=Object.keys(d).length,T=i?n.asValue().length:1;return{parameters:d,displayPrecision:h,residuals:y,isLinear:!1,parameterWarning:g&&f<m&&T>x}}var Z=class{constructor(t,n,r,s){this.policy=t,this.rawTree=r,this.concreteTree=s,this.evaluationState=GB(t,n,r,s)}graph(t,n){return NL(this.rawTree,this.policy,this.concreteTree,t,n)}getGraphMode(){return this.policy.graphingEnabled()?this.rawTree.getGraphMode(this.policy,this.concreteTree):10}getGraphInfo(){return Qr(this.rawTree,this.policy,this.concreteTree)}shouldIntersect(){if(!this.evaluationState.is_graphable||!this.rawTree.userData.shouldGraph||!ni.pointsOfInterest)return!1;let t=this.getGraphMode();return t===1||t===2}};function wd(e,t,n,r){switch(e.type){case\"Assignment\":return YX(e,t,n,r);case\"Equation\":case\"CallAssignment\":case\"Comparator['<']\":case\"Comparator['>']\":case\"Comparator['<=']\":case\"Comparator['>=']\":case\"Comparator['=']\":return UT(e,t,n);case\"ComparatorChain\":return nW(e,t,n);case\"DoubleInequality\":return tW(e,t,n);case\"FunctionCall\":case\"SeededFunctionCall\":return zX(e,t,n,r);case\"FunctionDefinition\":return $X(e,t,n);case\"Identifier\":case\"Ans\":return UX(e,t,n,r);case\"Image\":return oW(e,t,n,r);case\"MovablePoint\":case\"ParenSeq\":return rW(e,t,n,r);case\"RecursiveFunctionBaseCase\":return ZX(e,t,n);case\"Slider\":return iW(e,t,n);case\"Table\":return sW(e,t,n);case\"TableColumn\":return jX(e,t,n);case\"Ticker\":return JX(e,t,n);case\"Stats\":return eW(e,t,n);case\"IndependentTTest\":case\"TTest\":return KX(e,t,n);case\"Histogram\":case\"DotPlot\":case\"BoxPlot\":return QX(e,t,n);case\"Placeholder\":throw new Error(\"Unexpected placeholder\");default:return e instanceof k?kX(e,t,n,r):qX(e,t,n,r)}}function qX(e,t,n,r){return Os(e)?no(t,n,e):new Z(t,n,e,de(e,t,n))}function zT(e,t,n,r){if(r.isError)return new Z(e,t,n,r);if(!e.areAllScalesLinear()&&!Ml(r.valueType)){let u=$p(oe(r.valueType));return u.setCursorContext(r.getCursorContext()),new Z(e,t,n,u)}let s=da(e,r),o=r.getDependencies(),i,a=se(r.valueType,O)&&s.some(u=>e.validParametricVariable(u));switch(o.length>0&&!a&&(r=r.coerceToNumericIfPossibleWithTolerance()),r.valueType){case Sn:case so:case Ae:{i=r;break}case pn:case xs:case Ie:case lr:case pe:case oo:case ae:case ts:case Pe:case io:case De:case ns:case ye:case ao:case ve:case Er:case Te:case Sr:case Ne:case Ui:case it:case Se:case hr:case Jt:case vo:case Fe:case Do:case Kn:case As:case Mr:case zi:case Qn:case tu:case Et:case nu:case St:case ru:case Mt:case su:case Ut:case lu:case Ht:case ou:case qt:case iu:case $t:case au:case Yt:case uu:case Ot:case cu:!e.is3dPolicy()&&(r.valueType===Jt||r.valueType===vo)?i=Ec(Jt):!e.is3dPolicy()&&(r.valueType===Fe||r.valueType===Do)?i=Ec(Fe):s.length?i=mn(n.getSliderVariables(e,r)).setDependencies(s):i=r;break;case N:case F:case Gt:case zr:case O:case He:if(!e.is3dPolicy()&&(r.valueType===F||r.valueType===zr))r.isTypedConstant&&_T(r.valueType,n,e)?i=r:i=Ec(F);else if(s.length)if(e.validParametricVariables(s))i=r;else{let u=n.getSliderVariables(e,r);i=mn(u).setDependencies(u)}else i=r;break;case No:case Ro:case hi:case xi:case rs:case bi:case ga:case xa:case ha:case Ta:case ki:case ba:{!e.is3dPolicy()&&(r.valueType===rs||r.valueType===ki)?i=Ec(rs):s.length===0?i=r:i=mn(n.getSliderVariables(e,r)).setDependencies(s);break}case b:case Y:s.length===0?i=r:s.length<=(e.is3dPolicy()?2:1)?e.is3dPolicy()&&o.length>s.length&&!e.validImplicitVariables(o)?i=mn(n.getSliderVariables(e,r)).setDependencies(o):e.validExpressionVariables(s)?i=r:i=yh(e.implicitDependency(s)).setDependencies(s):e.validImplicitVariables(s)?i=yh().setDependencies(s):i=mn(n.getSliderVariables(e,r)).setDependencies(o);break;default:i=V(`Programming error: unexpected value type ${r.valueType}`)}return as(i)&&i.setCursorContext(r.getCursorContext()),i=Td(e,n,i),new Z(e,t,n,i)}function E3(e){return e._symbol===\"chisqdist\"?new A.FunctionCall(\"pdf\",[e,new A.Multiply([new A.Identifier(\"x\"),new A.Restriction([new A[\"Comparator['>=']\"]([new A.Identifier(\"x\"),new A.Constant(0)])])])]):new A.FunctionCall(\"pdf\",[e,new A.Identifier(\"x\")])}function UX(e,t,n,r){if(e._symbol===Nr){let i=pN(e,t,n,de(e,t,n),r);if(i)return new Z(t,n,e,i)}let s=de(e,t,n,{coerceToNumber:\"all-except-complex\"}),o=zT(t,n,e,s);return Os(e)&&!mN(o)?no(t,n,e):o}function zX(e,t,n,r){let s;DT[e._symbol]&&Ip(n,e).length===0&&!t.is3dPolicy()?s=de(E3(e),t,n):s=de(e,t,n);let o=zT(t,n,e,s);if(Os(e)&&!mN(o))return no(t,n,e);let i=e.getMoveStrategy(t,n,s,r);if(i){let a=tg(e,i),u=s.asCompilerValue(),c=[new A.Constant(u[0]),new A.Constant(u[1])];return s=kT(s,GD(i)?new Cu(c,i,a):new Fa(c,i,a)),new Z(t,n,e,s)}return o}function pN(e,t,n,r,s,o){if(r.valueType!==O)return;let i=e.getMoveStrategy(t,n,r,s);if(!i)return;let a=tg(o!=null?o:e,i),u=r.asCompilerValue(),c=kT(r,new A.MovableComplexNumber([new A.Constant(u[0]),new A.Constant(u[1])],i,a));return c.metaData=e.metaData,c}function kX(e,t,n,r){let s=zT(t,n,e,de(e,t,n));if(Os(e)&&!mN(s))return no(t,n,e);let o=pN(e,t,n,s.concreteTree,r);return o?new Z(t,n,e,o):s}function $X(e,t,n){var u;if(Os(e))return no(t,n,e);if(rt[e._symbol])return UT(e.asEquation(),t,n);let r=e._symbol.split(\"_\")[0];if(((u=rt[r])==null?void 0:u.type)===\"Placeholder\")return new Z(t,n,e,Xp(e._symbol,r));let s=de(e,t,n);if(s instanceof A.Error&&!s.blocksExport&&e._argSymbols.length===1){let c=On(n);c[e._argSymbols[0]]=new hn(\"identityTransformation\");let p=de(e._expression,t,c);if(p instanceof Dn&&se(p.valueType,Ne))return new Z(t,n,e,p)}if(t.is3dPolicy()&&t.assignmentForbidden(e._symbol))return new Z(t,n,e,Ph(e._symbol));if(s.isError)return new Z(t,n,e,s);let o=e._argSymbols,i=s.getDependencies();i.length>0&&(s=s.coerceToNumericIfPossibleWithTolerance());let a=i.filter(c=>o.indexOf(c)===-1);if(t.unplottablePolarFunction(e._symbol,i))return new Z(t,n,e,tS());if(a.some(c=>t.assignmentForbidden(c)))return new Z(t,n,e,xf(a,e._symbol,o).setDependencies(i));if(a.length){let c=e.getSliderVariables(t,s);return new Z(t,n,e,mn(c).setDependencies(c))}return!t.areAllScalesLinear()&&!Ml(s.valueType)?new Z(t,n,e,$p(oe(s.valueType))):(s=Td(t,e,s),new Z(t,n,e,s))}function YX(e,t,n,r){if(Os(e))return no(t,n,e);let s=e._symbol;if(!t.validLHS(s))return new Z(t,n,e,eS(s));if(rt.hasOwnProperty(s)||t.isComplexEnabled()&&s===Nr)return UT(e.asEquation(),t,n);let o;if(e._expression instanceof En&&DT[e._expression._symbol]&&Ip(n,e).length===0&&!t.is3dPolicy())o=de(E3(e._expression),t,n);else{let y=On(n);y[s]=t.validSolvedVariable(s)?void 0:ql(),o=de(e,t,y)}if(o.isError)return new Z(t,n,e,o);if(!t.areAllScalesLinear()&&!Ml(o.valueType))return new Z(t,n,e,$p(oe(o.valueType)));if(e.isEquation(t,o))return UT(e.asEquation(),t,n);let i=o.valueType===pn||o.valueType===xs;if(t.assignmentForbidden(s)&&i){let y=QE(s).allowExport().setDependencies([s]);return new Z(t,n,e,y)}let a=o.getDependencies(),u=da(t,o);if(!(e.getGraphMode(t,o)===5&&!t.assignmentForbidden(s))&&(a.length>0||t.graphMode(s,u,a)!==10)){let y=o._chunk,g=y.getInstruction(y.getReturnIndex());if(g.valueType===O&&Ue(g)&&w(g.value[1])!==0)return new Z(t,n,e,Wp(\"=\"));o=o.coerceToNumericIfPossibleWithTolerance()}let c=u.includes(\"x\")||u.includes(\"y\"),p=u.includes(\"r\")||u.includes(\"theta\");if(s===\"r\"&&a.includes(\"phi\")){let y=u.includes(\"z\")?lh():XE();return new Z(t,n,e,y)}if(s===\"rho\"&&u.includes(\"z\")){let y=a.includes(\"phi\")?lh():WE();return new Z(t,n,e,y)}let l=e.getSliderVariables(t,o,a);if(t.tooManySliderVariables(a,l,i)||c&&p){let y=mn(l).allowExport().setDependencies(l);return new Z(t,n,e,y)}let m=pN(e._expression,t,n,o,r,e);if(m)return new Z(t,n,e,m);let d=e.getMoveStrategy(t,n,o,r);if(d){let y=tg(e,d),g=[o.slot(0),o.slot(1)];return o=kT(o,GD(d)?new Cu(g,d,y):new Fa(g,d,y)),new Z(t,n,e,o)}return o=Td(t,e,o),new Z(t,n,e,o)}function ZX(e,t,n){if(Os(e))return no(t,n,e);if(!e.specifiedArg.valid)return new Z(t,n,e,e.specifiedArg.error);let r=de(e,t,n);if(r.isError)return new Z(t,n,e,r);let s=e._argSymbols,o=r.getDependencies();if(t.is3dPolicy()&&t.assignmentForbidden(e._symbol))return new Z(t,n,e,Ph(e._symbol));let i=o.filter(a=>s.indexOf(a)===-1);if(i.includes(e.specifiedArg.argSymbol))return new Z(t,n,e,GI(e.specifiedArg.argSymbol));for(let a of i)if(t.assignmentForbidden(a))return new Z(t,n,e,BI(a));if(i.length){let a=e.getSliderVariables(t,r);return new Z(t,n,e,mn(a).setDependencies(a))}return!t.areAllScalesLinear()&&!Ml(r.valueType)?new Z(t,n,e,$p(oe(r.valueType))):new Z(t,n,e,r)}function I3(e,t,n){let r=de(new hn(n),e,t);if(as(r))return r;if(r.isTypedConstant){let s=Cs(r);if(s!==void 0)return s}return AP()}function XX(e){return e[1]!==0&&!isNaN(e[1])}function P3(e){return e.valueType===He&&e.value.some(XX)}function WX(e,t,n){let[r,s]=n.variables,o=I3(e,t,r),i=I3(e,t,s);if(!(\"value\"in o))return o;if(!(\"value\"in i))return i;if(P3(o)||P3(i))return OP(oe(O))}function S3(e,t,n,r){if(!t.isCustomRegressionSupported()&&!e.tableRegressionData)return qS();if(Os(e))return Zp(\"=\");let s={policy:t,frame:n,lastExportFrame:r};if(e.tableRegressionData){let o=WX(t,n,e.tableRegressionData);if(o)return o}return h3(s,e)}function M3(e,t,n,r,s){if(s instanceof A.Error)return new Z(t,n,e,s);let o=b3(r,e,s);if(o.model instanceof A.IRExpression&&(o.model=o.model.coerceToNumericIfPossibleWithTolerance()),e.tableRegressionData){let i=he(o.parameters).filter(a=>!/^regressionparameter_/.test(a));if(i.length)return new Z(t,n,e,mn(i))}return new Z(t,n,e,o)}function jX(e,t,n){return Os(e)?no(t,n,e):new Z(t,n,e,go(zb,e,t,n))}function JX(e,t,n){return Os(e)?no(t,n,e):new Z(t,n,e,go(BM,e,t,n))}function QX(e,t,n){if(Os(e))return no(t,n,e);if(!t.areAllScalesLinear()){let o;switch(e.type){case\"BoxPlot\":o=zP();break;case\"DotPlot\":o=UP();break;case\"Histogram\":o=qP();break;default:throw new Error(`Unexpected node type ${e}`)}return new Z(t,n,e,o)}let r=e.type===\"BoxPlot\"?go(HM,e,t,n):go(GM,e,t,n),s=r.getDependencies();return s.length?new Z(t,n,e,mn(e.getSliderVariables(t,r)).setDependencies(s)):new Z(t,n,e,r)}function KX(e,t,n){if(Os(e))return no(t,n,e);let r=go(Ub,e,t,n),s=r.getDependencies();if(s.length)return new Z(t,n,e,mn(e.getSliderVariables(t,r)).setDependencies(s));let o=new Z(t,n,e,r);if(r.type!==\"Error\"){o.evaluationState.expression_type=_.TTEST;let i=r.args.map(a=>a.asValue());if(e.type===\"TTest\")o.evaluationState.ttest_results=G0(i[0],i[1]);else if(e.type===\"IndependentTTest\")o.evaluationState.ttest_results=H0(i[0],i[1]);else throw new Error(`Unhandled node type ${e}`)}return o}function eW(e,t,n){if(Os(e))return no(t,n,e);let r=go(Ub,e,t,n),s=r.getDependencies();if(s.length)return new Z(t,n,e,mn(e.getSliderVariables(t,r)).setDependencies(s));let o=new Z(t,n,e,r);return r.type!==\"Error\"&&(o.evaluationState.expression_type=_.STATS,o.evaluationState.stats_results=q0(r.args[0].asValue())),o}function UT(e,t,n){if(Os(e))return no(t,n,e);if(e.getOperator()!==\"=\"&&!ni.plotInequalities)return new Z(t,n,e,ph());let s=hL({policy:t,frame:n},e);if(s.type===\"Error\")return new Z(t,n,e,s);let o=da(t,s);if(s instanceof A.SolvedEquation&&o.length){let i=o.concat(s._symbol);if(!t.validImplicitVariables(i))return new Z(t,n,e,ql().setDependencies(i))}return e.getGraphMode(t,s)===8&&!t.validImplicitVariables(o)?new Z(t,n,e,ql().setDependencies(o)):(s=Td(t,e,s),new Z(t,n,e,s))}function tW(e,t,n){if(Os(e))return no(t,n,e);if(!ni.plotInequalities)return new Z(t,n,e,ph());let r=go(FM,e,t,n);if(r.type===\"Error\")return new Z(t,n,e,r);let s=r.getDependencies();return Yr[e._operators[0]].direction!==Yr[e._operators[1]].direction?new Z(t,n,e,dh()):t.validDoubleInequalitySymbol(r._symbol)?t.validDoubleInequalityVariables(s)?s.length>2?new Z(t,n,e,mn(e.getSliderVariables(t,r)).setDependencies(s)):r._expressions[0].getDependencies().indexOf(r._symbol)!==-1||r._expressions[1].getDependencies().indexOf(r._symbol)!==-1?new Z(t,n,e,fh().setDependencies(s)):new Z(t,n,e,r):new Z(t,n,e,mh().setDependencies(s)):new Z(t,n,e,mh().setDependencies(s))}function nW(e,t,n){let r=e.withArgsCoerced();if(Os(r))return no(t,n,r);let s=de(r,t,n);if(s.isError)return new Z(t,n,r,s);let o=s.getDependencies();if(o.length)if(t.is3dPolicy()){if(!t.validImplicitVariables(o))return new Z(t,n,r,(r.symbols.includes(\"=\")?rS():aS()).setDependencies(o));if(!(r.symbols.every(a=>a===\"<\"||a===\"<=\")||r.symbols.every(a=>a===\">\"||a===\">=\")||r.symbols.every(a=>a===\"=\")))return new Z(t,n,r,dh().setDependencies(o));if(r.symbols.some(a=>a===\"=\")&&!o.includes(\"z\"))return new Z(t,n,r,uS().setDependencies(o));let i=de(r.getRestrictedDifference(),t,n);return s.warning&&(i.warning=s.warning),i=Td(t,r,i),new Z(t,n,r,i)}else return r.symbols.includes(\"=\")?new Z(t,n,r,cS()):r.symbols.length>2?new Z(t,n,r,tP()):t.validDoubleInequalityVariables(o)?new Z(t,n,r,fh()):new Z(t,n,r,mn(r.getSliderVariables(t,s)).setDependencies(o));return new Z(t,n,r,s)}function rW(e,t,n,r){if(Os(e))return no(t,n,e);let s=de(e,t,n);if(s.isError)return new Z(t,n,e,s);let o=e.getMoveStrategy(t,n,s,r);if(o){let i=tg(e,o),a=s.asCompilerValue(),u=[new A.Constant(a[0]),new A.Constant(a[1])];return s=kT(s,new Fa(u,o,i)),new Z(t,n,e,s)}return zT(t,n,e,s)}function sW(e,t,n){let r=go(qM,e,t,n),s=new Z(t,n,e,r);return s.evaluationState.is_graphable=!0,s}function oW(e,t,n,r){let s=go(VM,e,t,n);if(s.type===\"Error\"||s.radianAngle.type===\"Error\"||s.center.type===\"Error\"||s.width.type===\"Error\"||s.height.type===\"Error\"||s.opacity.type===\"Error\")return new Z(t,n,e,s);let o=s.center.getDependencies(),i=s.radianAngle.getDependencies(),a=s.width.getDependencies(),u=s.height.getDependencies(),c=s.opacity.getDependencies();return o.length||i.length||a.length||u.length||c.length?new Z(t,n,e,new _m({center:o.length?mn(i).setDependencies(o):s.center,radianAngle:i.length?mn(i).setDependencies(i):s.radianAngle,width:a.length?mn(a).setDependencies(a):s.width,height:u.length?mn(u).setDependencies(u):s.height,opacity:c.length?mn(c).setDependencies(c):s.opacity})):(s.moveStrategy=e.getMoveStrategy(t,n,s,r),new Z(t,n,e,s))}function iW(e,t,n){if(Os(e))return no(t,n,e);let r=go(cp,e,t,n),s=r.type===\"IRExpression\"||r instanceof kp?r.sliderInfo:void 0,o;if(s!=null&&s.missingVars.length){let a=yI(s.missingVars);o=new Z(t,n,e,mn(t.sliderVariables(a)).setDependencies(a).allowExport())}else o=new Z(t,n,e,r);let i=o.evaluationState;if(ni.sliders){i.assignment=s==null?void 0:s.exportedSymbol,i.slider_min_number=s==null?void 0:s.values.min,i.slider_max_number=s==null?void 0:s.values.max,i.slider_step_number=s==null?void 0:s.values.step,i.slider_min_valid=s==null?void 0:s.valids.min,i.slider_max_valid=s==null?void 0:s.valids.max,i.slider_step_valid=s==null?void 0:s.valids.step;let a=i.slider_min_valid&&i.slider_max_valid&&i.slider_step_valid;i.is_slider=!0,i.raw_slider_latex=e.getInputString(),i.is_slidable=a,i.is_animatable=i.is_slidable&&!i.is_graphable,s!=null&&s.errMsg&&(i.error=s==null?void 0:s.errMsg.getError())}return delete i.is_evaluable,o}function Os(e){return e.userData&&\"latex\"in e.userData&&Tu(e.userData.latex).slice(-1)===\"=\"}function no(e,t,n){return new Z(e,t,n,Zp(\"=\"))}function mN(e){return e.concreteTree.type===\"IRExpression\"&&Ni(e.concreteTree)&&(e.concreteTree.valueType===b||e.concreteTree.valueType===O)}function kT(e,t){return t.warning=e.warning,t}function C3(e,t,n){try{return aW(e,t,n)}catch(r){if(!(r instanceof C))throw r;let s=[];for(let o of he(n))s.push({id:o,stmtAnalysis:new Z(e,t,n[o],r)});return s}}function aW(e,t,n){let r={};for(let c of he(n))r[n[c]._symbol]=n[c];let s=new dN(r),o={},i={definitions:o,baseCases:s.getBaseCases()};for(let c of he(n)){let p=n[c];uW(s,p,i)}for(let c of s.getBaseCaseExports()){let p=wd(c,e,t,{});for(let l of c.getLegalExports(e))delete t[l];p.rawTree.exportTo(e,p.concreteTree,t)}let a=On(t);for(let c of he(o))a[c]=o[c];let u=[];for(let c of he(n)){let p=n[c],l=p._symbol,m=o[l];m.userData=p.userData,m.metaData=p.metaData,m instanceof C?u.push({id:c,stmtAnalysis:new Z(e,t,p,m)}):u.push({id:c,stmtAnalysis:wd(m,e,a,{})})}return u}var dN=class{constructor(t){this.baseCases={};this.baseCaseExports=[];this.analyzedFunctions={};this.recursiveFunctionGroup=t;for(let n in t)this.baseCases[n]=[];for(let n in this.recursiveFunctionGroup)this.analyzeRecursiveFunctionDefinition(this.recursiveFunctionGroup[n])}analyzeRecursiveFunctionDefinition(t){let n;for(let r of t.getExternalBaseCases())this.addBaseCase(r);if(t._expression instanceof us){n=t._expression;do{let r=n.args[0],s=n.args[1];if(this.recursiveParameterIndex!==void 0&&r instanceof Oa){let o=t._argSymbols[this.recursiveParameterIndex],i=r.args.findIndex(l=>l instanceof Ve&&l._symbol===o);if(i===-1)break;let a=r.args[1-i];if(!(a instanceof _n))break;let u=a.asValue(),c=t._argSymbols.filter((l,m)=>m!==this.recursiveParameterIndex).map(l=>new hn(l)),p=new is(t._symbol,c,{valid:!0,argIndex:this.recursiveParameterIndex,argValue:u,functionDefArgSymbols:t._argSymbols,argSymbol:t._argSymbols[this.recursiveParameterIndex]},s,s);this.baseCaseExports.push(p),this.addBaseCase(p)}else break;n=n.args[2]}while(n instanceof us)}else if(t._expression instanceof Mu){let r=[];for(let s of t._expression._assignments){let o=is.fromCallAssignment(this.recursiveFunctionGroup,s);if((o==null?void 0:o.specifiedArg.valid)===!1)throw o.specifiedArg.error;o&&t._symbol===o._symbol?(this.baseCaseExports.push(o),this.addBaseCase(o)):r.push(s)}r.length>0?n=new Mu(t._expression._body,r):n=t._expression._body}else n=t._expression;this.analyzedFunctions[t._symbol]={recursiveExpression:n}}addBaseCase(t){this.baseCases[t._symbol].push(t)}getBaseCases(){return this.baseCases}getBaseCaseExports(){return this.baseCaseExports}getFunctionAnalysis(t){return this.analyzedFunctions[t]}};function uW(e,t,n){let r=e.getFunctionAnalysis(t._symbol);if(!r){n.definitions[t._symbol]=t;return}let s=new Tr(new hn(t._symbol),t._argSymbols.map(o=>new hn(o)),r.recursiveExpression,n);s.setExternalBaseCases(t.getExternalBaseCases()),n.definitions[t._symbol]=s}function fN(e,t,n){switch(e.type){case\"ParenSeq\":case\"MovablePoint\":return new Z(t,n,e,US());case\"Regression\":return new Z(t,n,e,HS());case\"DoubleInequality\":case\"ComparatorChain\":case\"Comparator['<']\":case\"Comparator['>']\":case\"Comparator['<=']\":case\"Comparator['>=']\":case\"Comparator['=']\":return new Z(t,n,e,GS());case\"Equation\":case\"CallAssignment\":return new Z(t,n,e,Cf())}}function v3(e,t,n){let r=fN(e,t,n);if(r)return r;if(e instanceof Tr){if(rt[e._symbol])return new Z(t,n,e,Xp(e._symbol));let s=de(e,t,n);if(s.isError)return new Z(t,n,e,s);let o=e._argSymbols,i=s.getDependencies();if(i.indexOf(e._symbol)!==-1)return new Z(t,n,e,Hl([e._symbol],{suggestAlternativeFunctionName:!1}));let a=i.filter(u=>o.indexOf(u)===-1);return a.length?new Z(t,n,e,xf(a,e._symbol,o)):new Z(t,n,e,s)}else if(e instanceof Rn){let s=e._symbol;if(rt[s])return new Z(t,n,e,Xp(s));let o=On(n);o[s]=Cf();let i=e.type===\"Slider\"?go(cp,e,t,o):de(e,t,o);if(i.isError)return new Z(t,n,e,i);let a=i.getDependencies();return e.isEquation(t,i)?new Z(t,n,e,Cf()):a.length>0?new Z(t,n,e,mn(a)):new Z(t,n,e,i)}else if(e instanceof k){let s=de(e,t,n);if(s.isError)return new Z(t,n,e,s);let o=s.getDependencies();return o.length>0?new Z(t,n,e,mn(o)):new Z(t,n,e,s)}else{let s=Zc(e,t,n);return s.type===\"Error\"?new Z(t,n,e,s):new Z(t,n,e,V(`Unexpected node type ${e.type}`))}}function $T(e,t,n){let r=fN(e,t,n);if(r)return r;switch(e.type){case\"FunctionDefinition\":return new Z(t,n,e,BS());case\"Assignment\":case\"Slider\":return new Z(t,n,e,VS())}if(e instanceof k){let o=de(e,t,n);if(o.isError)return new Z(t,n,e,o);let i=o.getDependencies();if(i.length>0){let a=i[0],u,c=rt[a];return c?u=c.type===\"Placeholder\"?Na(a,t):Mf(a):u=LS(a),new Z(t,n,e,u)}return new Z(t,n,e,o)}let s=Zc(e,t,n);return s.type===\"Error\"?new Z(t,n,e,s):new Z(t,n,e,V(`Unexpected node type ${e.type}`))}function D3(e,t,n){return $T(e,t,n)}function R3(e,t){let n=new Ul;for(let r of t.values()){let s=r.id,o=r.statement,i=o.metaData;if(ig(n,s,o.getDependencies()),ig(n,s,o.getLegalExports(e)),Jo(o)&&o.userData&&o.userData.residualVariable&&ig(n,s,[vi(o.userData.residualVariable)]),N3(n,s,i),Pu(o)&&o.columns)for(let a=0;a<o.columns.length;a++){let u=o.columns[a];if(Eu(u))throw V(\"Unexpected concrete column.\");!as(u)&&u.header&&u.header.metaData&&N3(n,s,u.header.metaData)}}return n}function ig(e,t,n){let r=mr;for(let s of n)e.getOrInsert(qn(r,s),[]).push(t)}function N3(e,t,n){if(n.extraDepNodes)for(let r of n.extraDepNodes)r&&ig(e,t,r.getDependencies());n.clickHandler&&ig(e,t,n.clickHandler.getDependencies())}function Ld(e,t,n,r,s){let o=new Ts,i={},a=[],u=[];for(let c of he(r))r[c]&&(i[c]=!0,a.push(c));for(let c of s)o.add(c),u.push(c);for(;a.length||u.length;){for(;a.length;){let c=a.pop(),p=t.get(c);if(p)for(let l of p.statement.getLegalExports(e)){let m=qn(mr,l);o.has(m)||(o.add(m),u.push(m))}}for(;u.length;){let c=u.pop(),p=n.get(c);if(p)for(let l of p)i[l]||(i[l]=!0,a.push(l))}}return{ids:i,symbols:o}}function O3(e){var t;return(t=e.get(qn(mr,\"globalRandomSeed\")))!=null?t:[]}var cW=100;function YT(e){let t=[];for(let n=0;n<e;n++)t[n]={x:[],y:[],intersects:[]};return t}function lW(e,t,n,r){return n===1&&r===1||n===2&&r===2?function(s){return t(s)-e(s)}:n===1&&r===2||n===2&&r===1?function(s){return s-t(e(s))}:!1}function A3(e,t){t instanceof A.SolvedEquation?t=t._expression:t instanceof A.OptimizedRegression&&(t=t.model);let n=[],r=[];return t instanceof Rm?Es.eachArgs(t._expressions,s=>{n.push(s[0].getCompiledFunction()),r.push(s[0].isConstant&&s[1].isNaN()),n.push(s[1].getCompiledFunction()),r.push(s[1].isConstant&&s[1].isNaN())}):Es.wrap(t).eachElement(s=>{n.push(s.getCompiledFunction()),r.push(s.isConstant&&s.isNaN())}),{functions:n,skipIntersecting:r}}function pW(e,t){let n=[];for(let r in e){if(!e.hasOwnProperty(r)||String(r)===String(t)||!e[r].shouldIntersect())continue;let s=e[r],o=A3(s.policy,s.concreteTree);n.push({id:r,graphMode:s.getGraphMode(),functions:o.functions,skipIntersecting:o.skipIntersecting})}return n}function mW(e,t){e.intersects=Array(e.x.length);for(let n=0;n<e.x.length;n++)e.intersects[n]=t}function dW(e,t){if(t===1){let n=e.y;e.y=e.x,e.x=n}}function fW(e,t){Array.prototype.push.apply(e.x,t.x),Array.prototype.push.apply(e.y,t.y),e.intersects&&t.intersects&&Array.prototype.push.apply(e.intersects,t.intersects)}function yW(e,t,n){let r=yv(e,t),s=r.poi.zeros,o=r.poi.extrema,i=[],a=0,u=0;for(a=0;a<s.x.length;a++){for(;u<o.x.length&&o.x[u]<s.x[a];u++)Co(o.y[u],0)&&i.push(o.x[u]);i.push(s.x[a])}for(;u<o.x.length;u++)Co(o.y[u],0)&&i.push(o.x[u]);return{x:i,y:i.map(n)}}function _3(e,t,n){let r=e[n],s=r.getGraphInfo(),o=r.getGraphMode(),i,a,u;try{i=A3(r.policy,r.concreteTree),a=YT(i.functions.length),u=pW(e,n)}catch(p){return YT(0)}if(!u)return a;let c=0;for(let p=0;p<u.length;p++){let l=u[p];for(let m=0;m<i.functions.length;m++){if(i.skipIntersecting[m])continue;let d=i.functions[m].fn,y=hp(t,s,d);for(let g=0;g<l.functions.length;g++){if(u[p].skipIntersecting[g])continue;let f=l.functions[g].fn,h=lW(d,f,o,l.graphMode);if(!h)continue;let x;try{x=yW(h,y,d)}catch(T){return YT(0)}if(c+=x.x.length,c>cW)return YT(i.functions.length);mW(x,l.id),dW(x,o),fW(a[m],x)}}}return a}var Tl=class e{constructor(t){this.frames=new Map;this.parentFrames=new Map;this.parentFrame=t}getFrame(t){return this._getFrame(t!=null?t:mr)}_getFrame(t){let n=this.frames.get(t);if(n)return n;let r=this.parentFrames.get(t),s=r?this._getFrame(r):this.parentFrame,o=On(s);return ZR(o,this),XR(o,t),this.frames.set(t,o),o}markDependencyOrder(t){kR(this.parentFrame,t),this.parentFrames=t.assignmentMaps.parentFrames}clone(){let t=new e(this.parentFrame);t.parentFrames=this.parentFrames;for(let[n,r]of this.frames){let s=t._getFrame(n);for(let o of he(r))s[o]=r[o]}return t}deleteTableFrame(t){return t===void 0||!this.frames.has(t)?!1:(this.frames.delete(t),!0)}deleteName(t){let n=this.getFrame(t.frameID);n&&delete n[t.symbol]}};function w3(e,t){var a;let n={},r={},s={},o=[],i={};for(let u of e.values()){let c=u.statement,p=u.id;if(c instanceof ji){let l=c.tableFrameID;if(!l)throw new Error(`Programming error: missing tableFrameID on table column ${p}`);i[l]||(i[l]=[]),i[l].push(c)}}for(let u of e.values()){let c=u.statement,p=u.id;if(!(c.type===\"Construction\"&&!t.isGeometryEnabled())&&c.type!==\"Ticker\")switch(c.type){case\"Error\":break;case\"Regression\":{s[p]=[],o.push(p);break}case\"TableColumn\":continue;default:{let l=c.getLegalExports(t);if(c.type===\"Table\"){let m=i[p]||[];for(let d of m)for(let y of d.getLegalExports(t))!y.startsWith(\"idref_\")&&!l.includes(y)&&l.push(y)}if(l){for(let d of l)c.tableFrameID!==void 0?r[d]=p:n[d]=p;let m=[];for(let d of c.getDependencies())m.push(d);s[p]=gI(m,c.getOptionalDependencies(),l)}break}}}for(let u of o){let c=(a=e.get(u))==null?void 0:a.statement;if(!c)continue;let p=vi(c.userData.residualVariable);p&&(r[p]=u);let l=c.getDependencies().slice(),m={},d;for(;d=l.pop();){if(m[d])continue;m[d]=!0;let y=n[d]||r[d];if(y){l.push(...s[y]),s[u].push(d);continue}r[d]=u}}return{exportMap:n,weakExportMap:r,dependencyMap:s}}function L3(e){if(e.length<2)return\"text\";let t=e.split(\"`\").length-1;return t<2?\"text\":t===2&&e[0]===\"`\"&&e[e.length-1]===\"`\"?\"latex\":\"mixed\"}function F3(e){if(e.length===0)return[\"\"];let t=[],n=e.split(/(`)/),r=!1,s=\"\";for(let o=0;o<n.length;o++){let i=n[o];i.length&&(i===\"`\"?(s+=\"`\",r=!r,r||(t.push(s),s=\"\")):(s+=i,r||(t.push(s),s=\"\")))}return s.length&&t.push(s),t}function yN(e){return F3(e).map(gW)}function gW(e){let n=\"\\\\$({\"+[\"[a-zA-Z][0-9]*\",\"[a-zA-Z]_[a-zA-Z0-9]+\",\"[a-zA-Z]_\\\\{[a-zA-Z0-9]+\\\\}\",\"\\\\\\\\[a-zA-Z]+\",\"\\\\\\\\[a-zA-Z]+_{[a-zA-Z0-9]+}\",\"\\\\\\\\[a-zA-Z]+_[a-zA-Z0-9]+\"].join(\"})|\\\\$({\")+\"})\",r=new RegExp(n,\"g\"),s=[],o=0,i=0,a;for(;a=r.exec(e);){i=a.index,i>o&&s.push(e.substr(o,i-o));let u=a[0],c=u.replace(/[{}\\$]/g,\"\").replace(/^([a-zA-Z])([0-9]+)$/,\"$1_$2\");s.push({symbol:c,str:u}),o=a.index+u.length}return o<e.length&&s.push(e.substr(o)),{raw:e,parts:s}}var V3={bigCutoff:1e7,digits:8};function B3(e,t){let n=t?Oc(e,V3):pm(e,V3);return t?`{${n}}`:n}function G3(e,t){let n={...cM,digits:8,scientificNotationDigits:3},r=t?$f(e,n):lM(e,n);return t?`{${r}}`:r}function gN(e,t,n,r){return e.map(s=>hW(s,t,n,r)).join(\"\")}function hW(e,t,n,r){var i,a,u,c;let s=[],o=L3(e.raw)===\"latex\";for(let p of e.parts)if(typeof p==\"string\")s.push(p);else{let l=de(new A.Identifier(p.symbol),t,n,{coerceToNumber:\"all-except-complex\"});if(l.type===\"IRExpression\"){if(l.valueType===b&&l.getDependencies().length===0){let m=l.asValue();if(typeof m==\"number\"){s.push(B3(m,o));continue}}else if(l.valueType===Y&&r<((i=l.length)!=null?i:0)&&l.getDependencies().length===0){let m=(a=l.elementAt)==null?void 0:a.call(l,r).asValue();if(typeof m==\"number\"){s.push(B3(m,o));continue}}else if(l.valueType===O&&l.getDependencies().length===0){let m=Cs(l);if((m==null?void 0:m.valueType)===O){s.push(G3(m.value,o));continue}}else if(l.valueType===He&&r<((u=l.length)!=null?u:0)&&l.getDependencies().length===0){let m=Cs((c=l.elementAt)==null?void 0:c.call(l,r));if((m==null?void 0:m.valueType)===O){s.push(G3(m.value,o));continue}}}o?s.push(\"{?}\"):s.push(\"?\")}return s.join(\"\")}function xW(e){let t=Oc(e,{bigCutoff:1e9,smallCutoff:1e-6,digits:12});return t.indexOf(\"\\\\times\")===-1?t:t[0]===\"-\"?\"-\\\\left(\"+t.substring(1)+\"\\\\right)\":\"\\\\left(\"+t+\"\\\\right)\"}function TW(e){switch(e){case\"exponential\":case\"power\":case\"logarithmic\":return!0;case\"cubic\":case\"linear\":case\"logistic\":case\"sinusoidal\":case\"quadratic\":case\"quartic\":return!1}}function IW(e,t){let n=t.parameterValues||{},[r,s]=t.variables,o=a=>{if(n===\"canonical\")return a;let u=EW(a),c=n&&n[u];return c!==void 0?xW(c):u},i;switch(e){case\"linear\":{let[a,u]=[o(\"m\"),o(\"b\")];i=`${[`${a}${r}`,`${u}`].join(\"+\")}`;break}case\"quadratic\":{let[a,u,c]=[o(\"a\"),o(\"b\"),o(\"c\")];i=`${[`${a}${r}^2`,`${u}${r}`,`${c}`].join(\"+\")}`;break}case\"cubic\":{let[a,u,c,p]=[o(\"a\"),o(\"b\"),o(\"c\"),o(\"d\")];i=`${[`${a}${r}^3`,`${u}${r}^2`,`${c}${r}`,`${p}`].join(\"+\")}`;break}case\"quartic\":{let[a,u,c,p,l]=[o(\"a\"),o(\"b\"),o(\"c\"),o(\"d\"),o(\"f\")];i=`${[`${a}${r}^4`,`${u}${r}^3`,`${c}${r}^2`,`${p}${r}`,`${l}`].join(\"+\")}`;break}case\"exponential\":{let[a,u]=[o(\"a\"),o(\"b\")];i=`${a}\\\\cdot ${u}^{${r}}`;break}case\"logarithmic\":{let[a,u]=[o(\"a\"),o(\"b\")];i=`${a}+${u}\\\\cdot \\\\ln\\\\left(${r}\\\\right)`;break}case\"logistic\":{let[a,u,c]=[o(\"a\"),o(\"b\"),o(\"c\")];i=`\\\\frac{${a}}{1+e^{-\\\\left(${u}${r}+${c}\\\\right)}}`;break}case\"power\":{let[a,u]=[o(\"a\"),o(\"b\")];i=`${a}\\\\cdot ${r}^{${u}}`;break}case\"sinusoidal\":{let[a,u,c,p]=[o(\"a\"),o(\"b\"),o(\"c\"),o(\"d\")];i=`${a}\\\\cdot \\\\sin\\\\left(${u}${r}+${c}\\\\right)+${p}`;break}default:throw new Error(`Unknown regression type: ${e}`)}return`${s}${t.operator}${PW(i)}`}function PW(e){return e.replace(/\\+-/g,\"-\").replace(/--/g,\"\")}function EW(e){return`\\\\regressionparameter_{${e}}`}var H3=/\\\\regressionparameter_{([^}]+)}/g;function Wbe(e){var n;return((n=e.match(H3))!=null?n:[]).map(r=>r.replace(H3,(s,o)=>o))}function q3(e,t,n,r){let s=e.regression;if(!s)return;TW(s.type)||(s.isLogMode=!1);let o=e.columns,{columnIds:i}=s,a=r.get(i.x),u=r.get(i.y);if(!(a&&u))return V(\"Missing columns for table regression\");let c=[{id:a.userData.id,isIdentifier:Aa(a.header),latex:o[a.columnIndex].latex},{id:u.userData.id,isIdentifier:Aa(u.header),latex:o[u.columnIndex].latex}],p=[c[0].isIdentifier?c[0].latex:`\\\\idref_{${c[0].id}}`,c[1].isIdentifier?c[1].latex:`\\\\idref_{${c[1].id}}`],l=IW(s.type,{operator:\"~\",variables:p}),m=Uo(l,n);if(as(m))return m;if(!Jo(m))return V(`Expected table regression to parse as Regression, but got ${m.type}`);let d=m;return d.tableRegressionData={tableId:t,columnInfo:c!=null?c:[],variables:p},d.metaData={extraDepNodes:[]},d.userData={id:s.id,color:s.color,lineStyle:s.lineStyle,isLogModeRegression:s.isLogMode,shouldGraph:!s.hidden,residualVariable:s.residualVariable},d}var Il=typeof performance!=\"undefined\"?()=>performance.now():()=>Date.now();function X3(){return{intersections:{},graphs:{}}}var{Constant:jT,Image:DW,Slider:NW,Construction:RW}=A,qu=Gi(\"**dcg_geo_construction_statement_id**\");function So(e,t){let n=Uo(e,t);return n.isError||n instanceof k?n:af()}function OW(e){let t=e.evaluationState.expression_type,n=e.rawTree.userData;return!n.clickableInfo||!n.clickableInfo.enabled?!1:cb(e.rawTree)?!0:Kc(e.getGraphMode())?!1:S_(t)}function In(e,t){let n=\"id\"+e;for(let[r,s]of t||[])n+=\"::\"+r+s;return n}var AW=new jT(be(0,1)),_W=new jT(be(1,1)),wW=new jT(NaN);function Eo(e,t){return e?e===\"0\"?AW:e===\"1\"?_W:So(e,t):wW}function fc(e,t){if(e)return So(e,t)}function LW(e){return e.slice(0,3)!==\"ans\"}function FW(e){return e.slice(0,6)!==\"idref_\"}function z3(e,t,n){let{cycles:r,recursiveFunctionSymbols:s,assignmentMaps:o}=e;for(let i of r){let a=[...new Set(i.map(({symbol:u})=>u))].filter(LW).filter(FW).sort();for(let u of i){let{symbol:c,frameID:p}=u;if(n&&s.has(u))continue;let l=LE(a),m=t.getFrame(p);m[c]=l}}for(let i of o.multiplyDefined){let a=t.getFrame(i.frameID);a[i.symbol]=bf(i.symbol)}}function XT(e){var t;return(t=e.statement.tableFrameID)!=null?t:e.moduleID}function Uu(e,t){return e.getFrame(XT(t))}var TN={coerceToNumber:\"all\"};function VW(e,t,n,r,s){let o={},i=!0,a=NaN,u,c=!1;if(n){let p=de(n,e,t,TN);u=p.getDependencies().length===0?p.asValue():NaN,c=Array.isArray(u),a=c?u:+u;for(let l of p.getDependencies())o[l]=!0}if(c){for(let p of a)if(!isFinite(+p)){i=!1,a=NaN;break}}else isFinite(+a)?s!==void 0&&a>s&&(a=s):(i=!1,a=NaN);return n||(i=!0,r!==void 0&&(a=r)),{value:a,valid:i,missingVarsMap:o}}var ag={lineWidth:{parseNode:\"lineWidth\",valueOutputProp:\"computedLineWidth\",formulaOutputProp:\"\",validOutputProp:\"line_width_valid\",default:(e,t,n,r)=>n.is3dPolicy()?1:2.5,transform:void 0,shouldEvaluate:void 0,seed:\"lw\"},resolution:{parseNode:\"resolution\",valueOutputProp:\"computedResolution\",formulaOutputProp:\"\",validOutputProp:\"resolution_valid\",default:()=>{},transform:void 0,shouldEvaluate:void 0,seed:\"re\"},lineOpacity:{parseNode:\"lineOpacity\",valueOutputProp:\"computedLineOpacity\",formulaOutputProp:\"\",validOutputProp:\"line_opacity_valid\",default:()=>1,transform:void 0,shouldEvaluate:void 0,seed:\"lo\"},pointOpacity:{parseNode:\"pointOpacity\",valueOutputProp:\"computedPointOpacity\",formulaOutputProp:\"\",validOutputProp:\"point_opacity_valid\",default:()=>1,transform:void 0,shouldEvaluate:void 0,seed:\"po\"},pointSize:{parseNode:\"pointSize\",valueOutputProp:\"computedPointSize\",formulaOutputProp:\"\",validOutputProp:\"point_size_valid\",default:(e,t,n)=>n.is3dProduct()?3:8,shouldEvaluate:void 0,transform:void 0,seed:\"ps\"},movablePointSize:{parseNode:\"movablePointSize\",valueOutputProp:\"computedMovablePointSize\",formulaOutputProp:\"\",validOutputProp:\"movable_point_size_valid\",default:()=>8,shouldEvaluate:void 0,transform:void 0,seed:\"ps\"},fillOpacity:{parseNode:\"fillOpacity\",valueOutputProp:\"computedFillOpacity\",formulaOutputProp:\"\",validOutputProp:\"fill_opacity_valid\",default:()=>.4,transform:void 0,shouldEvaluate:e=>{if(!e)return!1;let{expression_type:t,is_inequality:n}=e.evaluationState;return!!(t===_.POLYGON||t===_.PARAMETRIC||n)},seed:\"fo\"},surfaceOpacity:{parseNode:\"surfaceOpacity\",valueOutputProp:\"computedSurfaceOpacity\",formulaOutputProp:\"\",validOutputProp:\"surface_opacity_valid\",default:()=>1,transform:void 0,shouldEvaluate:e=>{if(!e)return!1;let{expression_type:t}=e.evaluationState;return t===_.CURVE3D_xyz_t||t===_.SURFACE||t===_.SPHERE3D||t===_.SURFACE_AMBIGUOUS||t===_.SURFACE_CONSTANT_AMBIGUOUS||t===_.IMPLICIT_SURFACE||t===_.IMPLICIT_SURFACE_AMBIGUOUS||t===_.SURFACE_xyz_uv||t===_.SURFACE_z_r\\u03B8||t===_.SURFACE_r_\\u03B8z||t===_.SURFACE_r_\\u03B8\\u03C6||t===_.SURFACE_r_\\u03B8z_AMBIGUOUS||t===_.TRIANGLE3D},seed:\"fo\"},labelSize:{parseNode:\"labelSize\",valueOutputProp:\"computedLabelSize\",formulaOutputProp:\"\",validOutputProp:\"label_size_valid\",transform:void 0,default:()=>1,shouldEvaluate:void 0,seed:\"ls\"},labelAngle:{parseNode:\"labelAngle\",valueOutputProp:\"computedLabelAngle\",formulaOutputProp:\"label_angle_value\",validOutputProp:\"label_angle_valid\",default:()=>0,transform:e=>`-\\\\trigAngleMultiplier*(${e})`,shouldEvaluate:void 0,seed:\"la\"}};function k3(e,t,n,r,s,o,i){let a=ag[o],u;e&&(u=de(e,r,s));let c=a.default&&a.default(e,u,r,i),p=[\"lineWidth\",\"pointSize\",\"movablePointSize\"].indexOf(o)>=0,l=VW(r,s,n[a.parseNode],c,p?1e4:void 0);n[a.valueOutputProp]=l.value,a.formulaOutputProp&&(t[a.formulaOutputProp]=l.value),t[a.validOutputProp]=l.valid,mc(t,r,l.missingVarsMap)}function BW(e,t,n,r){let s,o,i;if(Pu(e.rawTree)&&e.evaluationState.column_data&&e.rawTree.columns)for(let a=0;a<e.evaluationState.column_data.length;a++){s=e.evaluationState.column_data[a];let u=e.rawTree.columns[a];if(!as(u)){if(Eu(u))throw V(\"Unexpected concrete column.\");o=u.header.metaData,i=o[r],k3(i,s,o,t,n,r,e.concreteTree.valueType)}}else s=e.evaluationState,o=e.rawTree.metaData,i=o[r],k3(i,s,o,t,n,r,e.concreteTree.valueType)}function $3(e){return Rl(e[0],e[1],e[2]).formatHex()}function Y3(e,t,n,r,s){let o;if(e){let i=de(e,r,s),a=i.getDependencies().length>0?void 0:i.asValue(),{valueType:u}=i;if(o=!!(a&&(u===pn||u===xs)),o){let c=i&&i.valueType===pn?$3(a):a.map($3);t.colorLatexValue=c,n.color_latex_value=c}else delete t.colorLatexValue,delete n.color_latex_value}else o=!0;n.color_latex_valid=o}function GW(e,t,n){let r,s,o;if(Pu(e.rawTree)&&e.evaluationState.column_data&&e.rawTree.columns)for(let i=0;i<e.evaluationState.column_data.length;i++){r=e.evaluationState.column_data[i];let a=e.rawTree.columns[i];if(!as(a)){if(Eu(a))throw V(\"Unexpected concrete column.\");s=a.header.metaData,o=s.colorLatex,Y3(o,s,r,t,n)}}else r=e.evaluationState,s=e.rawTree.metaData,o=s.colorLatex,Y3(o,s,r,t,n)}function HW(e){if(e.concreteTree.valueType===pn&&e.concreteTree.getDependencies().length>0){let t=e.concreteTree._chunk;try{e.evaluationState.shader=Qo(t,0)}catch(n){e.evaluationState.error=n instanceof A.Error?n.getError():V(n).getError()}}}function qW(e,t,n){let r=e.evaluationState,s=e.rawTree,o={},i=s.metaData.clickHandler;if(!i)return;let a=de(i,t,n);!a.isError&&a.valueType!==it&&(a=pf(oe(a.valueType)));for(let c of a.getDependencies())t.validActionVariable(c)||(o[c]=!0);let u=Object.keys(o);u.length>0&&(a=mn(u).setDependencies(a.getDependencies())),a.isError&&!YD(t,a)?r.click_handler={status:\"error\",error:a.getError()}:a.isEmptyAction?r.click_handler={status:\"empty\"}:r.click_handler={status:\"maybe-valid\"},mc(r,t,o)}function UW(e,t,n){let r,s=e.evaluationState,o=e.rawTree,i,a;s.internal_domain_dependency?(r=s.internal_domain_dependency,r===\"u\"?(i=o.metaData.parametricDomain3DuMin,a=o.metaData.parametricDomain3DuMax):r===\"v\"?(i=o.metaData.parametricDomain3DvMin,a=o.metaData.parametricDomain3DvMax):(i=o.metaData.parametricDomainMin,a=o.metaData.parametricDomainMax)):s.expression_type===_.POLAR||v_(s.expression_type)?(i=o.metaData.polarDomainMin,a=o.metaData.polarDomainMax,r=\"theta\"):(i=o.metaData.parametricDomainMin,a=o.metaData.parametricDomainMax,r=\"t\");let u={},c=!!(i||a),p=mi(t,n,i,u,0),l=NaN;a?l=mi(t,n,a,u,NaN):s.expression_type===_.PARAMETRIC||s.expression_type===_.CURVE3D_xyz_t?l=1:s.expression_type===_.POLAR?l=Math.PI*12/+n.trigAngleMultiplier.asValue():(s.expression_type===_.SURFACE_r_\\u03B8z||s.expression_type===_.SURFACE_r_\\u03B8z_AMBIGUOUS||s.expression_type===_.SLICE_r\\u03B8z_at_z)&&(l=Math.PI*2/+n.trigAngleMultiplier.asValue());let m=bN(p,l,s);({min:p,max:l}=m),o.metaData.evaluatedDomainMin=p,o.metaData.evaluatedDomainMax=l,(s.expression_type===_.POLAR||s.expression_type===_.SURFACE_r_\\u03B8z||s.expression_type===_.SURFACE_r_\\u03B8z_AMBIGUOUS||s.expression_type===_.SLICE_r\\u03B8z_at_z)&&(o.metaData.isExplicitDomain=c),s.domains=[{variable:r,minNumber:p,maxNumber:l,minValid:m.minValid,maxValid:m.maxValid}],s.expression_type===_.PARAMETRIC&&delete u.t,s.expression_type===_.CURVE3D_xyz_t&&(delete u.t,delete u.u,delete u.v),mc(s,t,u)}function zW(e,t,n){let r=e.evaluationState,s=r.expression_type,o=e.rawTree,i,a,u,c,p={},l=0,m=1,d=0,y=1,g,f;M_(s)?(g=\"theta\",f=\"phi\",i=o.metaData.polarDomainMin,a=o.metaData.polarDomainMax,u=o.metaData.parametricDomain3DphiMin,c=o.metaData.parametricDomain3DphiMax,m=2*Math.PI/+n.trigAngleMultiplier.asValue(),y=Math.PI/+n.trigAngleMultiplier.asValue()):C_(s)?(g=\"r\",f=\"theta\",i=o.metaData.parametricDomain3DrMin,a=o.metaData.parametricDomain3DrMax,u=o.metaData.polarDomainMin,c=o.metaData.polarDomainMax,m=Fr.xmax,y=2*Math.PI/+n.trigAngleMultiplier.asValue()):(g=\"u\",f=\"v\",i=o.metaData.parametricDomain3DuMin,a=o.metaData.parametricDomain3DuMax,u=o.metaData.parametricDomain3DvMin,c=o.metaData.parametricDomain3DvMax),l=mi(t,n,i,p,l),m=mi(t,n,a,p,m),d=mi(t,n,u,p,d),y=mi(t,n,c,p,y);let h=bN(l,m,r);({min:l,max:m}=h);let x=bN(d,y,r);({min:d,max:y}=x),o.metaData.evaluatedDomain3DMin1=l,o.metaData.evaluatedDomain3DMax1=m,o.metaData.evaluatedDomain3DMin2=d,o.metaData.evaluatedDomain3DMax2=y,r.domains=[{variable:g,minNumber:l,minValid:h.minValid,maxNumber:m,maxValid:h.maxValid},{variable:f,minNumber:d,minValid:x.minValid,maxNumber:y,maxValid:x.maxValid}],(r.expression_type===_.SURFACE_xyz_uv||r.expression_type===_.SLICE_xyz_uv)&&(delete p.u,delete p.v),mc(r,t,p)}function mi(e,t,n,r,s){if(n){let o=de(n,e,t,TN);for(let i of o.getDependencies())r[i]=!0;return o.type===\"IRExpression\"&&o.isConstant?+o.asValue():NaN}else return s}function bN(e,t,n){let r=!0,s=!0;return isFinite(e)||(r=!1,e=NaN),isFinite(t)||(s=!1,t=NaN),r?s?e>t&&(r=!1,s=!1,n.error=$E().getError()):n.error=kE().getError():n.error=zE().getError(),{min:e,max:t,minValid:r,maxValid:s}}function kW(e,t,n){let r=e.evaluationState,s=e.rawTree,o=s.metaData.vizAxisOffset,i=s.metaData.vizBreadth,a={},u=mi(t,n,o,a,1),c=mi(t,n,i,a,1),p=!0,l=!0;isFinite(u)||(p=!1,u=NaN),isFinite(c)||(l=!1,c=NaN),p?l||(r.error=QP().getError()):r.error=JP().getError(),s.metaData.evaluatedAxisOffset=u,s.metaData.evaluatedBreadth=c,r.viz_values={axisOffset:u,breadth:c},r.viz_valids={axisOffset:p,breadth:l},mc(r,t,a)}function hN(e,t,n){if(e.type===\"Error\"||e.getDependencies().length||e.valueType!==it)return;let r=e.asValue();if(r)for(let s of he(r.updateRules))t[s]=$D(r,s),n[s]=new A.Assignment(s,ut(r.updateRules[s]))}function $W(e,t){if(e.type!==\"statement\"||t.type!==\"statement\"||_s(e.latexSelection,t.latexSelection))return!1;let n=qo(e),r=qo(t);return delete n.latexSelection,delete r.latexSelection,_s(n,r)}function YW(e,t){if(!(e instanceof Tr))return!1;let n=t[e._symbol];return n?!!n.recursionInfo:!1}function Gi(e){return e.toString()}function ZT(e){return e||mr}var WT=class{constructor(t){this.inner=new xN(t)}processChangeSet(t){return this.inner.processChangeSet(t)}getCLSymbolMap(){return this.inner.getCLSymbolMap()}get mainFrameContext(){let t=this;return{get global(){return t.inner.mainFrameContext.getFrame(mr)}}}setDegreeMode(t){this.inner.processEvaluatorConfig({degreeMode:t})}setEvaluationMode(t){this.inner.processEvaluatorConfig({evaluationMode:t})}setGlobalRandomSeed(t){this.inner.processEvaluatorConfig({globalRandomSeed:t})}get statements(){return this.inner.getStatements()}get analysis(){return this.inner.analysis}getFullStatementMap(){return this.inner.getFullStatementMap()}addStatement(t){this.inner.addStatement(t)}updateAnalysis(){this.inner.updateAnalysis()}get evaluationMode(){return this.inner.evaluationMode}get dirtyExportedSymbolRoots(){return this.inner.dirtyExportedSymbolRoots}get dirtyStatementRoots(){return this.inner.dirtyStatementRoots}get policy(){return this.inner.policy}get use_degrees(){return this.inner.use_degrees}get childIntersections(){return this.inner.childIntersections}processEvaluatorConfig(t){this.inner.processEvaluatorConfig(t)}setViewState(t){this.inner.processEvaluatorConfig({viewState:t})}removeStatement(t,n){this.inner.removeStatement(Gi(t),n!=null?n:X3())}markExportsDirty(t){this.inner.markExportsDirty(Gi(t))}getFrame(){return this.inner.updateAnalysis(),this.inner.mainFrameContext.getFrame(mr)}getAnalysis(){return this.inner.getAnalysis()}getEvaluationState(t){return this.inner.getEvaluationState(Gi(t))}buildSymbolToExpressionDirtyMap(){return this.inner.buildSymbolToExpressionDirtyMap()}getPolicy(){return this.inner.policy}},xN=class extends AT{constructor(n){super();this.sendMessageForProgressUpdate=n;this.fullStatements=new Map;this.statementGraphIDs=new Map;this.analysis={};this.currentStatus={};this.currentLabel={};this.analysisNeedsPublishIds=new Set;this.needGraphingIds=new Set;this.selectionOnlyChangeIds=new Set;this.intersectId=void 0;this.dirtyExportedSymbolRoots=new Ts;this.dirtyStatementRoots={};this.markedRegressionDirty=!1;this.childIntersections=new bd;this.globalEventCount=0;this.lastClockTickTime=void 0;this.invalidate()}getStatements(){let n={};for(let[r,s]of this.fullStatements)n[r]=s.statement;return n}_getStatement(n){var r;return(r=this.getFullStatement(n))==null?void 0:r.statement}_getOrigin(n){var r;return(r=this.getFullStatement(n))==null?void 0:r.origin}getFullStatementMap(){return this.fullStatements}getFullStatement(n){return this.fullStatements.get(n)}_deleteStatement(n){this.fullStatements.delete(n)}_allStatementIDs(){return[...this.fullStatements.keys()]}invalidate(){this._deleteStatement(qu);for(let n of this._allStatementIDs())this.markAsDirtyRoot(n);this.currentStatus={},this.analysis={},this.setPolicy(),this.setParentFrame(),this.mainFrameContext=new Tl(this.parent_frame),this.lastMainFrameContext=new Tl(this.parent_frame),this.regressionFrameContext=new Tl(this.parent_frame),this.lastClockTickTime=void 0}invalidateGraphsOnly(){for(let n of this._allStatementIDs())this.markNeedsGraphing(n)}getCLSymbolMap(){return this.updateConstruction(),w3(this.getFullStatementMap(),this.policy)}processChangeSet(n){let r=Il(),s={cacheWrites:0,cacheReads:0,cacheHits:0,cacheMisses:0};uA(s);let o=X3();if(n.isCompleteState&&this.clearState(o),n.hasOwnProperty(\"selectedIds\")){let l=n.selectedIds||{};if(this.intersectId===void 0||!l[this.intersectId]){let[m]=he(l);this.intersectId=m}}this.processEvaluatorConfig(n);let i=Il();this.processStatements(n,o);let a=Il();s.processStatements=a-i,i=a;let u=this.updateAnalysis();a=Il(),s.updateAnalysis=a-i,i=a;let c=this._publishAllStatuses();a=Il(),s.publishAllStatuses=a-i,i=a,this._computeAllLabels(),a=Il(),s.computeAllLabels=a-i,i=a,this._computeAriaDescriptions(),a=Il(),s.computeAriaDescriptions=a-i,i=a,this._graphAllChanged(o),a=Il(),s.graphAllChanges=a-i,s.updateIntersections=0;let p=this.processEvents(n.events);return this.analysisNeedsPublishIds=new Set,this.needGraphingIds=new Set,this.selectionOnlyChangeIds=new Set,s.timeInWorker=a-r,{syncId:n.syncId,isCompleteState:n.isCompleteState,intersectionChanges:o.intersections,statusChanges:c,graphChanges:o.graphs,timingData:s,eventUpdates:p,dependencyOrder:{allDefinedQualifiedNames:[...u.assignmentMaps.assignments.keys()],multiplyDefined:[...u.assignmentMaps.multiplyDefined]}}}processStatements(n,r){if(n.removes)for(let s of he(n.removes))this.removeStatement(s,r);if(n.statements)for(let s in n.statements){let o=n.statements[s];o===null||(o.id=Gi(o.id),this.addStatement(o))}}_publishAllStatuses(){let n={},r=this.currentStatus;this.currentStatus={};for(let s of this.analysisNeedsPublishIds){if(!this.analysis.hasOwnProperty(s))continue;let o=this.analysis[s].evaluationState;_s(o,r[s])||(n[s]=o),this.currentStatus[s]=o}return n}_computeAllLabels(){for(let n of he(this.currentLabel)){let r=this.getFullStatement(n);if(!r)continue;let s=Uu(this.mainFrameContext,r),o=r.statement,i=Zc(o,this.policy,s),a=1;(i.valueType===Gt||i.valueType===He||i.valueType===lr||i.valueType===hr||i.valueType===Er||i.valueType===Sr)&&(a=i.length);let u=[],c=this.currentLabel[n];if(ec(c))for(let p=0;p<a;p++)u.push(gN(c,this.policy,s,p));_s(u,o.computedLabels)||(o.computedLabels=u,this.markNeedsGraphing(n))}}_computeAriaDescriptions(){for(let n of he(this.analysis)){let r=this.getFullStatement(n);if(!r)continue;let s=this.analysis[n],o=s.evaluationState,a=s.rawTree.userData,u;if(a.description?u=a.description:a.label&&(u=a.label),u){o.computed_description=[];let c=1;s.concreteTree.isList?c=s.concreteTree.length:o.dimensions&&o.dimensions.x&&Array.isArray(o.dimensions.x)&&(c=o.dimensions.x.length);let p=Uu(this.mainFrameContext,r);for(let l=0;l<c;l++)o.computed_description.push(gN(yN(u),this.policy,p,l))}}}_graphAllChanged(n){var i;let r=this.getViewState();if(!r||!fw(r))return;let s=!1,o=!1;for(let a of this.needGraphingIds){let u=this._getOrigin(a);if((u==null?void 0:u.type)!==\"REAL\")continue;let c=(i=this.statementGraphIDs.get(a))!=null?i:[];for(let d of c)this._notifyGraphRemoved(d,n);let p=WW(this.analysis,a,r,this.postProgressUpdate.bind(this),this.childIntersections),l=[];for(let{graphID:d,graphData:y}of p)y&&(this._notifyGraphComputed(d,y,n),l.push(d));this.statementGraphIDs.set(a,l);let m=this.analysis[a];m&&!Pu(m.rawTree)&&(o=!0,a===this.intersectId&&(s=!0,this._updateIntersections(a,n)))}o&&!s&&(this.lastComputedIntersectId=void 0),this.intersectId!==void 0&&!s&&(o||this.intersectId!==this.lastComputedIntersectId)&&this._updateIntersections(this.intersectId,n)}_notifyGraphRemoved(n,r){r.graphs[n]=void 0}_notifyGraphComputed(n,r,s){_O(r),s.graphs[n]=r}_updateIntersections(n,r){if(this.lastComputedIntersectId=n,!this.viewState)return;if(!this.analysis[n]||!this.analysis[n].shouldIntersect()){r.intersections[n]=[];return}this.postProgressUpdate(\"GRAPHING\",[n]);let s=_3(this.analysis,this.viewState,n);r.intersections[n]=s,this.postProgressUpdate(\"UNPUBLISHED\",[n])}addStatement(n){if(!n)return;n.id=Gi(n.id);let r=n,s=r.id,o=this.getFullStatement(s),i=this._getOrigin(s),a=o==null?void 0:o.statement,u=a==null?void 0:a.userData,c=!!u&&!!o&&$W(u,r)&&!YW(a,Uu(this.mainFrameContext,o)),p=this.getParseOptions(r),l=XW(r,p,this.policy),m=new Set(l.map(y=>y.id));for(let{id:y,statementNode:g,moduleID:f}of l){let h=y===r.id?{type:\"REAL\",childIDs:m}:{type:\"CHILD\",parentID:r.id};this.updateSingleStatement(y,new Nd({id:y,statement:g,moduleID:f,origin:h}),{selectionOnlyChange:c})}if((i==null?void 0:i.type)===\"REAL\")for(let y of i.childIDs)m.has(y)||this.removeSingleStatement(y);let d=r.label;if(d){let y=this.currentLabel[s];(!y||y.raw!==d)&&(this.currentLabel[s]=yN(d))}else delete this.currentLabel[s]}replaceStatementParsenode(n,r){this.updateSingleStatement(n.id,new Nd({id:n.id,statement:r,moduleID:n.moduleID,origin:n.origin}),{selectionOnlyChange:!1})}updateSingleStatement(n,r,{selectionOnlyChange:s}){s?this.selectionOnlyChangeIds.add(n):(this.markExportsDirty(n),this.markAsDirtyRoot(n)),this.fullStatements.set(n,r)}clearState(n){this.invalidate(),this.currentLabel={},this.fullStatements=new Map;for(let r of this.statementGraphIDs.values())for(let s of r)this._notifyGraphRemoved(s,n);this.statementGraphIDs=new Map}removeStatement(n,r){let s=this._getOrigin(n);if((s==null?void 0:s.type)===\"REAL\"){for(let i of s.childIDs)this.removeSingleStatement(i);let o=this.statementGraphIDs.get(n);for(let i of o!=null?o:[])this._notifyGraphRemoved(i,r)}this.removeSingleStatement(n)}removeSingleStatement(n){this._getStatement(n)&&(this.markExportsDirty(n),delete this.currentLabel[n],this._deleteStatement(n),delete this.analysis[n],delete this.currentStatus[n])}markExportsDirty(n){let r=this.getFullStatement(n);if(r){Jo(r.statement)&&(this.markedRegressionDirty=!0);for(let s of r.statement.getLegalExports(this.policy)){let o=qn(r.moduleID,s);this.dirtyExportedSymbolRoots.add(o)}}}markAsDirtyRoot(n){this.dirtyStatementRoots[n]=!0}shouldPublishAndGraph(n){let r=this._getOrigin(n);return(r==null?void 0:r.type)===\"REAL\"}markNeedsGraphing(n){this.shouldPublishAndGraph(n)&&this.needGraphingIds.add(n)}getAnalysis(){return this.updateAnalysis(),this.analysis}getEvaluationState(n){if(this.updateAnalysis(),!!this.analysis[n])return this.analysis[n].evaluationState}_updateRegressions(n){var y,g;let r=this.regressionFrameContext;if(!this.policy.graphingEnabled())return;let s=[];for(let f of n.keys()){let h=this._getStatement(f);h&&Jo(h)&&s.push(f)}let o=ty(this.policy,this.getFullStatementMap(),s);r.markDependencyOrder(o),z3(o,r,this.recursion);let i=o.resolved;this.postProgressUpdate(\"RESOLVED\",i);let a={};for(let f of this._allStatementIDs()){let h=this._getStatement(f);h&&Pu(h)&&(a[f]=h)}let u=new Map,c=new Set;for(let f of i){if(f===qu){this.postProgressUpdate(\"UNPUBLISHED\",[f]);continue}if(c.has(f))continue;this.postProgressUpdate(\"ANALYZING\",[f]);let h=this.getFullStatement(f);if(!h){this.postProgressUpdate(\"UNPUBLISHED\",[f]);continue}let x=h.statement;if(Jo(x)){let T=((y=x.tableRegressionData)==null?void 0:y.tableId)===void 0?Uu(r,h):r.getFrame(x.tableRegressionData.tableId),P=Uu(this.lastMainFrameContext,h),M=S3(x,this.policy,T,P);u.set(f,M),this.postProgressUpdate(\"UNPUBLISHED\",[f])}else{let T=Uu(r,h),P=this.analyzeSingleStatementGraphing(f,this.analysis,T,o,\"regression\"),M=[];for(let S of P)this.exportTo(S,r),M.push(S.id),S.id!==f&&c.add(S.id);this.postProgressUpdate(\"UNPUBLISHED\",M)}}let p=new Ts;for(let[f,h]of u){if(h instanceof C)continue;let x=this.getFullStatement(f),T=XT(x);for(let P of he(h.parameters)){if(this.policy.assignmentForbidden(P))continue;let M=qn(T,P);p.add(M)}}let l=new Map,m=f=>{var T,P;let h=this.getFullStatement(f),x=XT(h);return x3(h.statement,(T=o.assignmentMaps.assignments.mapForFrame(x))!=null?T:new Map,(P=p.mapForFrame(x))!=null?P:new Map)},d=(f,h)=>{l.set(f,h);let x=this.getFullStatement(f);if(!this.policy.assignmentForbidden(h)){let T=XT(x);p.add(qn(T,h))}};for(let[f,h]of u){if(h instanceof C)continue;let x=this._getStatement(f);if(!((g=x.userData)!=null&&g.residualVariable))continue;let T=m(f);T===vi(x.userData.residualVariable)&&d(f,T)}for(let f of u.keys()){if(l.has(f))continue;let h=m(f);d(f,h)}for(let[f,h]of u){let x=this.getFullStatement(f),T=Uu(this.mainFrameContext,x),P=l.get(f),M=M3(x.statement,this.policy,T,{residualVariable:P,tableStatements:a},h);this.analysis[f]=M;let S=this.exportTo({id:f,stmtAnalysis:M},this.mainFrameContext);M.evaluationState.exported_variables=S,n.delete(f)}}_updateAnalysisAndFrame(n,r,s){var u;let o=this.analysis;this.mainFrameContext.markDependencyOrder(n),z3(n,this.mainFrameContext,this.recursion);let i=n.resolved.filter(c=>s.has(c));this.postProgressUpdate(\"RESOLVED\",i);let a=new Set;for(let c of i){if(c===qu){this.postProgressUpdate(\"UNPUBLISHED\",[c]);continue}if(r.has(c)){this.postProgressUpdate(\"UNPUBLISHED\",[c]);continue}if(a.has(c))continue;this.postProgressUpdate(\"ANALYZING\",[c]);let p=this.analyzeSingleStatement(c,o,n),l=[];for(let m of p){o[m.id]=m.stmtAnalysis;let d=this.exportTo(m,this.mainFrameContext),y=this._getOrigin(m.id);if((y==null?void 0:y.type)===\"REAL\"){let g=new Set(d);for(let f of y.childIDs){let h=this.analysis[f],x=(u=h==null?void 0:h.evaluationState.exported_variables)!=null?u:[];for(let T of x)g.add(T)}d=[...g]}m.stmtAnalysis.evaluationState.exported_variables=d,l.push(m.id),m.id!==c&&a.add(m.id)}this.postProgressUpdate(\"UNPUBLISHED\",l)}return{analyzedStatements:i}}exportTo(n,r){let s=this.getFullStatement(n.id);if(!s)throw V(\"Missing statement corresponding to entry that was just created.\");let{statement:o,moduleID:i}=s,a=n.stmtAnalysis.rawTree.exportTo(this.policy,n.stmtAnalysis.concreteTree,r.getFrame(i));if(o instanceof ji){let u=Uu(r,s);o.exportToLocal(this.policy,n.stmtAnalysis.concreteTree,u)}return a}buildSymbolToExpressionDirtyMap(){return R3(this.policy,this.fullStatements)}buildChildIntersectionMap(){let n=this.childIntersections,r=new bd;for(let o of he(this.analysis)){let i=this.analysis[o],{geometry:a}=i.evaluationState;if(a!=null&&a.call&&a.call.symbol===\"intersection\"&&this._getStatement(o).userData.shouldGraph&&i.concreteTree.type!==\"Error\"){let u=!!this.needGraphingIds.has(o),c=Cs(i.concreteTree);for(let p of a.call.parents){if(p.type===\"arbitrary-expression\")continue;let l=Du(p);if(!l)continue;let m=this.mainFrameContext.getFrame(mr)[l],d=m&&m.userData.id;if(d==null)continue;let y=this.analysis[d],g=Cs(y.concreteTree);g&&c&&r.addChildIntersection({id:d,valueType:g.valueType,ref:p},c),u&&this.markNeedsGraphing(d)}}}let s=bd.compareIntersectionCounts({nextChildIntersections:r,prevChildIntersections:n});for(let o of he(s)){let{prev:i,next:a}=s[o];a<i&&this.markNeedsGraphing(o)}return r}findAllRegressionExports(){let n=new Map,r=new Ts;for(let s of this._allStatementIDs()){let o=this.getFullStatement(s);if(!o||!Jo(o.statement))continue;let i=this.analysis[s];if(!i||!Jo(i.rawTree))continue;let a=i.concreteTree,u=i.rawTree.getExportsFromConcrete(this.policy,a),c=[];for(let p of u){let l=qn(o.moduleID,p);r.add(l),c.push(l)}n.set(s,c)}return{regressionExportMap:n,regressionExportRoots:r}}updateConstruction(){if(!this.policy.isGeometryEnabled){this.parent_frame.construction=vf();return}let n=[];for(let a of this._allStatementIDs())this._getStatement(a).userData.isInConstructionsFolder&&n.push(a);let r=this._getStatement(qu),s=new RW(n);s.metaData={extraDepNodes:[]},s.userData={};let o={};for(let a of(r==null?void 0:r.getDependencies())||[])o[a]=!0;let i={};for(let a of s.getDependencies())i[a]=!0;if(!r||!_s(o,i)){let a={type:\"AUX\"},u=mr;this.updateSingleStatement(qu,new Nd({id:qu,statement:s,moduleID:u,origin:a}),{selectionOnlyChange:!1}),this.parent_frame.construction=s}}analyzeExternalRecursiveBaseCases(){if(!this.recursion)return;let n=[],r={};for(let u of this._allStatementIDs()){let c=this._getStatement(u);c instanceof Tr&&!this.policy.assignmentForbidden(c._symbol)&&(n.push(u),r[c._symbol]=c)}let{recursiveFunctionGroups:s}=ty(this.policy,this.getFullStatementMap(),n),o=new Set;for(let u of n){let c=this._getStatement(u);c instanceof Tr&&s[u]&&o.add(c._symbol)}let i={},a=[];for(let u of this._allStatementIDs()){let c=this.getFullStatement(u);if(!c)continue;let p=c.statement;if(p instanceof $c&&o.has(p._lhs._symbol)){let l=is.fromCallAssignment(r,p);if(!l)continue;this.replaceStatementParsenode(c,l);let m=l._symbol;i[m]||(i[m]=[]),i[m].push(l),l.getDependencies().length&&a.push(u)}else if(p instanceof is){let l=p._symbol;o.has(p._symbol)?(i[l]||(i[l]=[]),i[l].push(p),p.getDependencies().length&&a.push(u)):this.replaceStatementParsenode(c,p.originalNode)}}for(let u of he(r)){let c=r[u],p=c.getExternalBaseCases(),l=i[u]||[];ZW(l,p)||(c.setExternalBaseCases(l),this.markExportsDirty(c.userData.id),this.markAsDirtyRoot(c.userData.id))}if(a.length){let{recursiveFunctionBaseCasesWithCycles:u}=ty(this.policy,this.getFullStatementMap(),a);for(let c of u){let p=this.getFullStatement(c);if(!p)continue;let l=p.statement;if(l instanceof is){let m=r[l._symbol];m.setExternalBaseCases(m.getExternalBaseCases().filter(d=>d!==l)),this.replaceStatementParsenode(p,l.originalNode)}}}}updateAnalysis(){var T,P,M,S;this.updateConstruction(),this.analyzeExternalRecursiveBaseCases();let n=this.getFullStatementMap(),r=this.buildSymbolToExpressionDirtyMap(),s=Ld(this.policy,this.fullStatements,r,this.dirtyStatementRoots,this.dirtyExportedSymbolRoots),o=this.markedRegressionDirty;for(let E of he(s.ids)){let v=this._getStatement(E);v&&Jo(v)&&(o=!0)}let i=new Set;if(o){for(let E of this._allStatementIDs())this._getStatement(E)&&i.add(E);this.mainFrameContext=new Tl(this.parent_frame),this.regressionFrameContext=new Tl(this.parent_frame)}else{let E=s.ids;for(let D of he(E))this._getStatement(D)&&i.add(D);let v=s.symbols;for(let D of v)this.mainFrameContext.deleteName(D),this.regressionFrameContext.deleteName(D)}let a=!1;for(let E of i.keys()){this.markNeedsGraphing(E);let v=this.mainFrameContext.deleteTableFrame(E);a||(a=v)}if(a)for(let E of this._allStatementIDs()){let v=this._getStatement(E);v.tableFrameID&&i.has(v.tableFrameID)&&i.add(E)}let u=new Set([...i,...this.selectionOnlyChangeIds]);this.analysisNeedsPublishIds=new Set;for(let E of u)this.shouldPublishAndGraph(E)&&this.analysisNeedsPublishIds.add(E);this.markedRegressionDirty=!1,this.dirtyExportedSymbolRoots=new Ts,this.dirtyStatementRoots={};let c=this.analysis;(this.evaluationMode===\"graphing\"||this.evaluationMode===\"geometry\"||this.evaluationMode===\"graphing_3d\")&&this._updateRegressions(i);let{regressionExportMap:p,regressionExportRoots:l}=this.findAllRegressionExports(),m=ty(this.policy,n,this._allStatementIDs(),p),{analyzedStatements:d}=this._updateAnalysisAndFrame(m,new Set(p.keys()),u),y=Ld(this.policy,this.fullStatements,r,{},l),g=new Ts;for(let E of m.recursiveFunctionSymbols)g.add(E);let f=Ld(this.policy,this.fullStatements,r,{},g);this.markRegressionAndRecursionDependents({regressionDependentStatements:y.ids,recursionDependentStatements:f.ids});for(let E of he(this.analysis)){let v=this.analysis[E];if(Jo(v.rawTree)&&((T=v.rawTree.tableRegressionData)!=null&&T.tableId)){let D=v.evaluationState,G=this.analysis[v.rawTree.tableRegressionData.tableId];if(!G)throw new Error(`Programming error: table ${v.rawTree.tableRegressionData.tableId} not found for table regression ${E}`);let j=G.evaluationState;if(D.regression){let W=v.rawTree.tableRegressionData.columnInfo.filter(re=>re.isIdentifier).map(re=>vi(re.latex)).filter(re=>this.policy.assignmentForbidden(re)),K=(P=v.rawTree.tableRegressionData.columnInfo.find(re=>!re.isIdentifier))==null?void 0:P.latex,J;W.length>0?J=a0(W).getError():K&&(J=i0(K).getError()),j.table_regression={status:\"success\",result:D.regression,export_info:J?{status:\"unexportable\",reason:J}:{status:\"exportable\"}}}else j.table_regression={status:\"error\",error:(M=D.error)!=null?M:V('Expected regression state to define either \"regression\" or \"error\"').getError()}}}if(this.policy.graphingEnabled()){for(let E of d)this.evaluateMetadataForStatement(E,Uu(this.mainFrameContext,this.getFullStatement(E)),this.policy);this.childIntersections=this.buildChildIntersectionMap()}O3(r).forEach(E=>{c[E].evaluationState.depends_on_random_seed=!0});let h=Ld(this.policy,this.fullStatements,r,{[qu]:!0},new Ts([qn(mr,\"construction\")]));for(let E of he(h.ids)){if(E===qu)continue;let v=c[E].evaluationState;v.geometry&&(v.geometry.unconstructable=!0)}let x;for(let E of this._allStatementIDs())if((S=this._getStatement(E).userData)!=null&&S.latexSelection){x=E;break}if(x){let E=Ld(this.policy,this.fullStatements,r,{[x]:!0},new Ts([qn(mr,`idref_${x}`)]));for(let v of he(E.ids)){if(v===qu)continue;let D=c[v].evaluationState;D.geometry&&(D.geometry.depends_on_selected=!0)}}return this.lastMainFrameContext=this.mainFrameContext.clone(),m}analyzeSingleStatement(n,r,s){let o=this.getFullStatement(n),i=Uu(this.mainFrameContext,o),a=o.statement;switch(this.evaluationMode){case\"fourFunction\":case\"singleExpressionFourFunction\":return[{id:n,stmtAnalysis:D3(a,this.policy,i)}];case\"scientific\":return[{id:n,stmtAnalysis:v3(a,this.policy,i)}];case\"singleExpressionScientific\":return[{id:n,stmtAnalysis:$T(a,this.policy,i)}];case\"graphing\":case\"graphing_3d\":case\"geometry\":return this.analyzeSingleStatementGraphing(n,r,i,s,\"main\")}}analyzeSingleStatementGraphing(n,r,s,o,i){if(!this.policy.graphingEnabled())throw V(\"Expected graphing policy\");if(i===\"main\"&&s.r){let u=On(s);u.r=void 0;let c=wd(this._getStatement(n),this.policy,u,r);if(c.getGraphMode()===6)return[{id:n,stmtAnalysis:c}]}let a=o.recursiveFunctionGroups[n];if(a&&this.recursion){if(i===\"regression\")for(let c of a){let p=this._getStatement(c),l=RP(),m={policy:this.policy,rawTree:p,concreteTree:l};return[{id:c,stmtAnalysis:m}]}let u={};for(let c of a)u[c]=this._getStatement(c);return C3(this.policy,s,u)}if(i===\"regression\"){let u=this._getStatement(n),c=Zc(u,this.policy,s),p={policy:this.policy,rawTree:u,concreteTree:c};return[{id:n,stmtAnalysis:p}]}else{let u=wd(this._getStatement(n),this.policy,s,r);return[{id:n,stmtAnalysis:u}]}}evaluateMetadataForStatement(n,r,s){if(n===qu)return;let o=this.analysis[n],i=o.evaluationState.expression_type;for(let a of he(ag)){let u=ag[a];this.evaluationMode!==\"graphing_3d\"&&a===\"resolution\"||(!u.shouldEvaluate||u.shouldEvaluate(o))&&BW(o,s,r,a)}GW(o,s,r),this.product===\"graphing-3d\"&&HW(o),this.actions&&OW(o)&&qW(o,s,r),i===_.PARAMETRIC||i===_.CURVE3D_xyz_t||i===_.POLAR||i===_.SURFACE_r_\\u03B8z||i===_.SURFACE_r_\\u03B8z_AMBIGUOUS||i===_.SLICE_r\\u03B8z_at_z?UW(o,s,r):i===_.SURFACE_xyz_uv||i===_.SLICE_xyz_uv||i===_.SURFACE_r_\\u03B8\\u03C6||i===_.SURFACE_z_r\\u03B8||i===_.SLICE_zr\\u03B8_at_r||i===_.SLICE_zr\\u03B8_at_\\u03B8||i===_.SLICE_zr\\u03B8_at_xyz||i===_.SLICE_r\\u03B8\\u03C6_at_\\u03B8||i===_.SLICE_r\\u03B8\\u03C6_at_\\u03C6||i===_.SLICE_r\\u03B8\\u03C6_at_xyz?zW(o,s,r):i===_.BOXPLOT?kW(o,s,r):o.rawTree.metaData.distributionSpec&&UB(o,s,r)}markRegressionAndRecursionDependents(n){for(let r of he(this.analysis)){let s=this.analysis[r];if(Bc(s.rawTree)){let o=this.analysis[s.rawTree.tableID];if(!o)continue;let i=o.evaluationState.column_data[s.rawTree.columnIndex];if(!i)continue;i.depends_on_regression=!!n.regressionDependentStatements[r],i.depends_on_recursive_function=!!n.recursionDependentStatements[r]}else s.evaluationState.depends_on_regression=!!n.regressionDependentStatements[r],s.evaluationState.depends_on_recursive_function=!!n.recursionDependentStatements[r]}}processEvents(n){if(!n||!this.actions)return;let r=On(this.mainFrameContext.getFrame(mr)),s={},o=!1,i=!1,a;for(let u of n)switch(this.globalEventCount+=1,r.globalEventCount=new A.Constant(this.globalEventCount),u.type){case\"step\":{let p=this._getStatement(Gi(u.expressionId));if(!p)continue;let l=Zc(p,this.policy,r);i=!0,hN(l,s,r);break}case\"click\":{let p=this._getStatement(Gi(u.expressionId));if(!p||!p.metaData.clickHandler)continue;r.index=new A.Constant(u.indexVar+1);let l=de(p.metaData.clickHandler,this.policy,r);i=!0,o=!0,hN(l,s,r);break}case\"clock-tick\":{(a===void 0||u.isFirstTick&&!a.isFirstTick)&&(a=u);break}default:return u}if(a){let u=this._getStatement(Gi(a.id));if(u&&u instanceof A.Ticker){let c=de(u.minStep,this.policy,r,TN).asValue();if(typeof c==\"number\"&&c>=0&&isFinite(c)){let l=this.lastClockTickTime;if(this.lastClockTickTime=Date.now(),!a.isFirstTick&&l!==void 0){r.dt=new A.Constant(this.lastClockTickTime-l);let m=de(u.handler,this.policy,r);hN(m,s,r)}}}}return{objectClicked:o,userAction:i,updates:s}}postProgressUpdate(n,r){var s;(s=this.sendMessageForProgressUpdate)==null||s.call(this,\"evaluatorProgressUpdate\",{update:n,ids:r})}};function ZW(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function XW(e,t,n){var i;let r=e.id,s={extraDepNodes:[]};function o(a,u){a.userData=e,a.metaData=s;let c=ZT(u);return[{id:r,statementNode:a,moduleID:c}]}switch(e.type){case\"table\":{e.shouldGraph=!0;let a=e.columns,u=[],c=new Map,p=g=>!g.replace(/\\\\space|\\\\ /g,\"\").match(/\\S/),l=ZT(e.moduleID),m=[];for(let g=0;g<a.length;g++){let f=a[g],h=Uo(f.latex,{...t,seedPrefix:In(r,[[\"tr\",0],[\"tc\",g]])}),x=[],T=-1;for(let E=0;E<a[g].values.length;E++)p(f.values[E])?x.push(new jT(NaN)):(x.push(Uo(f.values[E],{...t,seedPrefix:In(r,[[\"tr\",E+1],[\"tc\",g]])})),T=E);x=x.slice(0,T+1);let P=new ji(h,x,Gi(e.id),g),M=Gi(`dcgcolumnstmt${f.id}`);P.userData={id:M},c.set(Gi(f.id),P),m.push({id:M,statementNode:P,moduleID:l});let S=new ji(h,x,e.id,g);if(S.userData=f,S.header){if(S.header.userData=f,S.header.metaData={extraDepNodes:[]},f.colorLatex){let E=So(f.colorLatex,{...t,seedPrefix:In(r,[[\"tr\",0],[\"tc\",g],[\"cl\",g]])});S.header.metaData.colorLatex=E,S.header.metaData.extraDepNodes.push(E)}if(f.pointSize){let E=So(f.pointSize,{...t,seedPrefix:In(r,[[\"tr\",0],[\"tc\",g],[\"ps\",g]])});S.header.metaData.pointSize=E,S.header.metaData.extraDepNodes.push(E)}if(f.pointOpacity){let E=So(f.pointOpacity,{...t,seedPrefix:In(r,[[\"tr\",0],[\"tc\",g],[\"po\",g]])});S.header.metaData.pointOpacity=E,S.header.metaData.extraDepNodes.push(E)}if(f.lineWidth){let E=So(f.lineWidth,{...t,seedPrefix:In(r,[[\"tr\",0],[\"tc\",g],[\"lw\",g]])});S.header.metaData.lineWidth=E,S.header.metaData.extraDepNodes.push(E)}if(f.lineOpacity){let E=So(f.lineOpacity,{...t,seedPrefix:In(r,[[\"tr\",0],[\"tc\",g],[\"lo\",g]])});S.header.metaData.lineOpacity=E,S.header.metaData.extraDepNodes.push(E)}}u.push(S)}let d;e.regression&&(d=q3(e,r,t,c),d!==void 0&&m.push({id:Gi(e.regression.id),statementNode:d,moduleID:l}));let y=new Ku(u,[...c.values()],d,r);return y.userData=e,y.metaData=s,m.push({id:r,statementNode:y,moduleID:l}),m}case\"image\":{let a=\"-\\\\trigAngleMultiplier*(\"+e.angle+\")\",u=So(e.center,{...t,seedPrefix:In(r,[[\"ic\",r]])}),c=So(a,{...t,seedPrefix:In(r,[[\"ia\",r]])}),p=So(e.width,{...t,seedPrefix:In(r,[[\"iw\",r]])}),l=So(e.height,{...t,seedPrefix:In(r,[[\"ih\",r]])}),m=So(e.opacity,{...t,seedPrefix:In(r,[[\"io\",r]])});return Z3(s,e,t),o(new DW({center:u,radianAngle:c,width:p,height:l,opacity:m}),e.moduleID)}case\"ticker\":return o(new A.Ticker({handler:So(e.handlerLatex,{...t,allowDt:!0}),minStep:So(e.minStepLatex||\"0\",t)}),void 0);case\"geometry-toolbar-predicate\":return o(So(`\\\\{${e.latex}:1,0\\\\}`,{...t}),void 0);case\"module\":{let a=[];for(let u=0;u<e.imports.length;u++){let c=e.imports[u],p=qR(e.id,u),l=dT(c.to.symbol);if(l instanceof C){a.push({id:p,statementNode:l,moduleID:mr});continue}let m=dT(c.from.symbol);if(m instanceof C){a.push({id:p,statementNode:m,moduleID:mr});continue}a.push({id:p,moduleID:ZT(c.to.frameID),statementNode:new A.AssignmentImport(l._symbol,qn(ZT(c.from.frameID),m._symbol))})}return a}default:{e=e;let a,u=Tu(e.latex);!e.isInferenceUIExpression&&u.slice(-1)===\"=\"?a=u.substring(0,u.length-1):a=e.latex;for(let l of he(ag))if(e[l]){let m=ag[l],d=e[l];m.transform&&(d=m.transform(d));let y=Eo(d,{...t,seedPrefix:In(r,[[m.seed,r]])});s[l]=y,s.extraDepNodes.push(y)}if(e.colorLatex){let l=fc(e.colorLatex,{...t,seedPrefix:In(r,[[\"ac\",r]])});s.colorLatex=l,s.extraDepNodes.push(l)}e.polarDomain&&e.polarDomain.min&&(s.polarDomainMin=Eo(e.polarDomain.min,{...t,seedPrefix:In(r,[[\"lm\",r]])}),s.extraDepNodes.push(s.polarDomainMin)),e.polarDomain&&e.polarDomain.max&&(s.polarDomainMax=Eo(e.polarDomain.max,{...t,seedPrefix:In(r,[[\"lM\",r]])}),s.extraDepNodes.push(s.polarDomainMax)),e.parametricDomain&&e.parametricDomain.min&&(s.parametricDomainMin=Eo(e.parametricDomain.min,{...t,seedPrefix:In(r,[[\"lm\",r]])}),s.extraDepNodes.push(s.parametricDomainMin)),e.parametricDomain&&e.parametricDomain.max&&(s.parametricDomainMax=Eo(e.parametricDomain.max,{...t,seedPrefix:In(r,[[\"lM\",r]])}),s.extraDepNodes.push(s.parametricDomainMax)),e.parametricDomain3Du&&e.parametricDomain3Du.min&&(s.parametricDomain3DuMin=Eo(e.parametricDomain3Du.min,{...t,seedPrefix:In(r,[[\"lm\",r]])}),s.extraDepNodes.push(s.parametricDomain3DuMin)),e.parametricDomain3Du&&e.parametricDomain3Du.max&&(s.parametricDomain3DuMax=Eo(e.parametricDomain3Du.max,{...t,seedPrefix:In(r,[[\"lM\",r]])}),s.extraDepNodes.push(s.parametricDomain3DuMax)),e.parametricDomain3Dv&&e.parametricDomain3Dv.min&&(s.parametricDomain3DvMin=Eo(e.parametricDomain3Dv.min,{...t,seedPrefix:In(r,[[\"lm\",r]])}),s.extraDepNodes.push(s.parametricDomain3DvMin)),e.parametricDomain3Dv&&e.parametricDomain3Dv.max&&(s.parametricDomain3DvMax=Eo(e.parametricDomain3Dv.max,{...t,seedPrefix:In(r,[[\"lM\",r]])}),s.extraDepNodes.push(s.parametricDomain3DvMax)),e.parametricDomain3Dr&&e.parametricDomain3Dr.min&&(s.parametricDomain3DrMin=Eo(e.parametricDomain3Dr.min,{...t,seedPrefix:In(r,[[\"lm\",r]])}),s.extraDepNodes.push(s.parametricDomain3DrMin)),e.parametricDomain3Dr&&e.parametricDomain3Dr.max&&(s.parametricDomain3DrMax=Eo(e.parametricDomain3Dr.max,{...t,seedPrefix:In(r,[[\"lM\",r]])}),s.extraDepNodes.push(s.parametricDomain3DrMax)),e.parametricDomain3Dphi&&e.parametricDomain3Dphi.min&&(s.parametricDomain3DphiMin=Eo(e.parametricDomain3Dphi.min,{...t,seedPrefix:In(r,[[\"lm\",r]])}),s.extraDepNodes.push(s.parametricDomain3DphiMin)),e.parametricDomain3Dphi&&e.parametricDomain3Dphi.max&&(s.parametricDomain3DphiMax=Eo(e.parametricDomain3Dphi.max,{...t,seedPrefix:In(r,[[\"lM\",r]])}),s.extraDepNodes.push(s.parametricDomain3DphiMax)),e.vizProps&&(e.vizProps.axisOffset&&(s.vizAxisOffset=Eo(e.vizProps.axisOffset,{...t,seedPrefix:In(r,[[\"vo\",r]])}),s.extraDepNodes.push(s.vizAxisOffset)),e.vizProps.breadth&&(s.vizBreadth=Eo(e.vizProps.breadth,{...t,seedPrefix:In(r,[[\"vb\",r]])}),s.extraDepNodes.push(s.vizBreadth)));let c=TB(e.latex);c&&c.type===\"distribution\"&&(s.distributionSpec=c,e.cdf&&e.cdf.show&&(s.cdfMin=fc(e.cdf.min,{...t,seedPrefix:In(r,[[\"lm\",r]])}),s.extraDepNodes.push(s.cdfMin),s.cdfMax=fc(e.cdf.max,{...t,seedPrefix:In(r,[[\"lM\",r]])}),s.extraDepNodes.push(s.cdfMax),s.cdfP=fc((i=e.cdf.p)!=null?i:\"\",{...t,seedPrefix:In(r,[[\"pv\",r]])}),s.extraDepNodes.push(s.cdfP)));let p=e.isInferenceUIExpression?Eo(a,t):Uo(a,t);if(p.shouldPromoteToSlider(n)){let l=e.slider,m=!!(l&&l.isPlayingOnce),d=fc(l&&l.softMin,t),y=fc(l&&l.softMax,t),g=fc(l&&l.min,{...t,seedPrefix:In(r,[[\"lm\",r]])}),f=fc(l&&l.max,{...t,seedPrefix:In(r,[[\"lM\",r]])}),h=fc(l&&l.step,{...t,seedPrefix:In(r,[[\"ls\",r]])});p=new NW(p,{sliderMin:g,sliderMax:f,sliderStep:h,sliderIsPlayingOnce:m,sliderSoftMin:d,sliderSoftMax:y})}return Z3(s,e,t),o(p,e.moduleID)}}}function Z3(e,t,n){let r=t.clickableInfo;r&&r.enabled&&r.latex&&(e.clickHandler=So(r.latex,{...n,allowIndex:!0}))}function WW(e,t,n,r,s){var u;if(!e.hasOwnProperty(t))return[];let o=e[t],i=o.evaluationState.expression_type,a=i===_.SINGLE_POINT||i===_.POINT_LIST;if(Pu(o.rawTree)){let c=o.graph(n,void 0),p=o.rawTree.getColumnIdsForGraphing(),l=[];for(let m of p)l.push({graphID:m,graphData:c[m]});if((u=o.rawTree.regression)!=null&&u.userData){let m=o.rawTree.regression.userData.id,d=e[m];if(d!=null&&d.evaluationState.is_graphable&&o.rawTree.regression.userData.shouldGraph){let y=d.graph(n,void 0);l.push({graphID:m,graphData:y})}}return l}else if(o.evaluationState.is_graphable&&(o.rawTree.userData.shouldGraph||o.rawTree.userData.showLabel&&a)){r(\"GRAPHING\",[t]);let c=o.graph(n,s.getChildIntersections(t));return r(\"UNPUBLISHED\",[t]),[{graphID:t,graphData:c}]}return[]}var W3=class{constructor(t){this.context=new WT(t),this.sendMessage=t}processChangeSet(t){let n=this.context.processChangeSet(t);this.sendMessage(\"processChangeSet\",n)}};Object.defineProperty(__dcg_chunk_exports__, 'a', { get: () => JW });\nObject.defineProperty(__dcg_chunk_exports__, 'b', { get: () => QW });\nObject.defineProperty(__dcg_chunk_exports__, 'c', { get: () => KW });\nObject.defineProperty(__dcg_chunk_exports__, 'd', { get: () => Ka });\nObject.defineProperty(__dcg_chunk_exports__, 'e', { get: () => e4 });\nObject.defineProperty(__dcg_chunk_exports__, 'f', { get: () => qo });\nObject.defineProperty(__dcg_chunk_exports__, 'g', { get: () => oR });\nObject.defineProperty(__dcg_chunk_exports__, 'h', { get: () => MN });\nObject.defineProperty(__dcg_chunk_exports__, 'i', { get: () => lg });\nObject.defineProperty(__dcg_chunk_exports__, 'j', { get: () => b4 });\nObject.defineProperty(__dcg_chunk_exports__, 'k', { get: () => yi });\nObject.defineProperty(__dcg_chunk_exports__, 'l', { get: () => zu });\nObject.defineProperty(__dcg_chunk_exports__, 'm', { get: () => qi });\nObject.defineProperty(__dcg_chunk_exports__, 'n', { get: () => aG });\nObject.defineProperty(__dcg_chunk_exports__, 'o', { get: () => T4 });\nObject.defineProperty(__dcg_chunk_exports__, 'p', { get: () => I4 });\nObject.defineProperty(__dcg_chunk_exports__, 'q', { get: () => Co });\nObject.defineProperty(__dcg_chunk_exports__, 'r', { get: () => P4 });\nObject.defineProperty(__dcg_chunk_exports__, 's', { get: () => Zo });\nObject.defineProperty(__dcg_chunk_exports__, 't', { get: () => lR });\nObject.defineProperty(__dcg_chunk_exports__, 'u', { get: () => P6 });\nObject.defineProperty(__dcg_chunk_exports__, 'v', { get: () => v6 });\nObject.defineProperty(__dcg_chunk_exports__, 'w', { get: () => ef });\nObject.defineProperty(__dcg_chunk_exports__, 'x', { get: () => Vg });\nObject.defineProperty(__dcg_chunk_exports__, 'y', { get: () => Jn });\nObject.defineProperty(__dcg_chunk_exports__, 'z', { get: () => I });\nObject.defineProperty(__dcg_chunk_exports__, 'A', { get: () => Pn });\nObject.defineProperty(__dcg_chunk_exports__, 'B', { get: () => b });\nObject.defineProperty(__dcg_chunk_exports__, 'C', { get: () => N });\nObject.defineProperty(__dcg_chunk_exports__, 'D', { get: () => Yn });\nObject.defineProperty(__dcg_chunk_exports__, 'E', { get: () => Y });\nObject.defineProperty(__dcg_chunk_exports__, 'F', { get: () => Gt });\nObject.defineProperty(__dcg_chunk_exports__, 'G', { get: () => Ae });\nObject.defineProperty(__dcg_chunk_exports__, 'H', { get: () => pn });\nObject.defineProperty(__dcg_chunk_exports__, 'I', { get: () => xs });\nObject.defineProperty(__dcg_chunk_exports__, 'J', { get: () => Se });\nObject.defineProperty(__dcg_chunk_exports__, 'K', { get: () => Ie });\nObject.defineProperty(__dcg_chunk_exports__, 'L', { get: () => lr });\nObject.defineProperty(__dcg_chunk_exports__, 'M', { get: () => pe });\nObject.defineProperty(__dcg_chunk_exports__, 'N', { get: () => ae });\nObject.defineProperty(__dcg_chunk_exports__, 'O', { get: () => Pe });\nObject.defineProperty(__dcg_chunk_exports__, 'P', { get: () => io });\nObject.defineProperty(__dcg_chunk_exports__, 'Q', { get: () => De });\nObject.defineProperty(__dcg_chunk_exports__, 'R', { get: () => ns });\nObject.defineProperty(__dcg_chunk_exports__, 'S', { get: () => ve });\nObject.defineProperty(__dcg_chunk_exports__, 'T', { get: () => Er });\nObject.defineProperty(__dcg_chunk_exports__, 'U', { get: () => Te });\nObject.defineProperty(__dcg_chunk_exports__, 'V', { get: () => Sr });\nObject.defineProperty(__dcg_chunk_exports__, 'W', { get: () => Ne });\nObject.defineProperty(__dcg_chunk_exports__, 'X', { get: () => Ui });\nObject.defineProperty(__dcg_chunk_exports__, 'Y', { get: () => ye });\nObject.defineProperty(__dcg_chunk_exports__, 'Z', { get: () => ao });\nObject.defineProperty(__dcg_chunk_exports__, '_', { get: () => O });\nObject.defineProperty(__dcg_chunk_exports__, '$', { get: () => He });\nObject.defineProperty(__dcg_chunk_exports__, 'aa', { get: () => Qn });\nObject.defineProperty(__dcg_chunk_exports__, 'ba', { get: () => tu });\nObject.defineProperty(__dcg_chunk_exports__, 'ca', { get: () => Et });\nObject.defineProperty(__dcg_chunk_exports__, 'da', { get: () => St });\nObject.defineProperty(__dcg_chunk_exports__, 'ea', { get: () => Mt });\nObject.defineProperty(__dcg_chunk_exports__, 'fa', { get: () => Ht });\nObject.defineProperty(__dcg_chunk_exports__, 'ga', { get: () => $t });\nObject.defineProperty(__dcg_chunk_exports__, 'ha', { get: () => Ot });\nObject.defineProperty(__dcg_chunk_exports__, 'ia', { get: () => Ut });\nObject.defineProperty(__dcg_chunk_exports__, 'ja', { get: () => F });\nObject.defineProperty(__dcg_chunk_exports__, 'ka', { get: () => zr });\nObject.defineProperty(__dcg_chunk_exports__, 'la', { get: () => DN });\nObject.defineProperty(__dcg_chunk_exports__, 'ma', { get: () => cr });\nObject.defineProperty(__dcg_chunk_exports__, 'na', { get: () => pG });\nObject.defineProperty(__dcg_chunk_exports__, 'oa', { get: () => We });\nObject.defineProperty(__dcg_chunk_exports__, 'pa', { get: () => oe });\nObject.defineProperty(__dcg_chunk_exports__, 'qa', { get: () => $ });\nObject.defineProperty(__dcg_chunk_exports__, 'ra', { get: () => Xe });\nObject.defineProperty(__dcg_chunk_exports__, 'sa', { get: () => Zn });\nObject.defineProperty(__dcg_chunk_exports__, 'ta', { get: () => Gd });\nObject.defineProperty(__dcg_chunk_exports__, 'ua', { get: () => hc });\nObject.defineProperty(__dcg_chunk_exports__, 'va', { get: () => dg });\nObject.defineProperty(__dcg_chunk_exports__, 'wa', { get: () => se });\nObject.defineProperty(__dcg_chunk_exports__, 'xa', { get: () => Ia });\nObject.defineProperty(__dcg_chunk_exports__, 'ya', { get: () => pu });\nObject.defineProperty(__dcg_chunk_exports__, 'za', { get: () => Mn });\nObject.defineProperty(__dcg_chunk_exports__, 'Aa', { get: () => gG });\nObject.defineProperty(__dcg_chunk_exports__, 'Ba', { get: () => gt });\nObject.defineProperty(__dcg_chunk_exports__, 'Ca', { get: () => q });\nObject.defineProperty(__dcg_chunk_exports__, 'Da', { get: () => bg });\nObject.defineProperty(__dcg_chunk_exports__, 'Ea', { get: () => ue });\nObject.defineProperty(__dcg_chunk_exports__, 'Fa', { get: () => wp });\nObject.defineProperty(__dcg_chunk_exports__, 'Ga', { get: () => Sg });\nObject.defineProperty(__dcg_chunk_exports__, 'Ha', { get: () => SG });\nObject.defineProperty(__dcg_chunk_exports__, 'Ia', { get: () => B4 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ja', { get: () => G4 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ka', { get: () => Ap });\nObject.defineProperty(__dcg_chunk_exports__, 'La', { get: () => ZN });\nObject.defineProperty(__dcg_chunk_exports__, 'Ma', { get: () => MG });\nObject.defineProperty(__dcg_chunk_exports__, 'Na', { get: () => q4 });\nObject.defineProperty(__dcg_chunk_exports__, 'Oa', { get: () => U4 });\nObject.defineProperty(__dcg_chunk_exports__, 'Pa', { get: () => fI });\nObject.defineProperty(__dcg_chunk_exports__, 'Qa', { get: () => $4 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ra', { get: () => Y4 });\nObject.defineProperty(__dcg_chunk_exports__, 'Sa', { get: () => X4 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ta', { get: () => W4 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ua', { get: () => yI });\nObject.defineProperty(__dcg_chunk_exports__, 'Va', { get: () => gI });\nObject.defineProperty(__dcg_chunk_exports__, 'Wa', { get: () => DG });\nObject.defineProperty(__dcg_chunk_exports__, 'Xa', { get: () => OG });\nObject.defineProperty(__dcg_chunk_exports__, 'Ya', { get: () => K4 });\nObject.defineProperty(__dcg_chunk_exports__, 'Za', { get: () => n6 });\nObject.defineProperty(__dcg_chunk_exports__, '_a', { get: () => r6 });\nObject.defineProperty(__dcg_chunk_exports__, '$a', { get: () => Yo });\nObject.defineProperty(__dcg_chunk_exports__, 'ab', { get: () => zd });\nObject.defineProperty(__dcg_chunk_exports__, 'bb', { get: () => GG });\nObject.defineProperty(__dcg_chunk_exports__, 'cb', { get: () => HG });\nObject.defineProperty(__dcg_chunk_exports__, 'db', { get: () => _s });\nObject.defineProperty(__dcg_chunk_exports__, 'eb', { get: () => a6 });\nObject.defineProperty(__dcg_chunk_exports__, 'fb', { get: () => Lp });\nObject.defineProperty(__dcg_chunk_exports__, 'gb', { get: () => Fp });\nObject.defineProperty(__dcg_chunk_exports__, 'hb', { get: () => kG });\nObject.defineProperty(__dcg_chunk_exports__, 'ib', { get: () => y6 });\nObject.defineProperty(__dcg_chunk_exports__, 'jb', { get: () => h6 });\nObject.defineProperty(__dcg_chunk_exports__, 'kb', { get: () => Xi });\nObject.defineProperty(__dcg_chunk_exports__, 'lb', { get: () => zf });\nObject.defineProperty(__dcg_chunk_exports__, 'mb', { get: () => a9 });\nObject.defineProperty(__dcg_chunk_exports__, 'nb', { get: () => uM });\nObject.defineProperty(__dcg_chunk_exports__, 'ob', { get: () => Az });\nObject.defineProperty(__dcg_chunk_exports__, 'pb', { get: () => MO });\nObject.defineProperty(__dcg_chunk_exports__, 'qb', { get: () => cM });\nObject.defineProperty(__dcg_chunk_exports__, 'rb', { get: () => vO });\nObject.defineProperty(__dcg_chunk_exports__, 'sb', { get: () => sb });\nObject.defineProperty(__dcg_chunk_exports__, 'tb', { get: () => ob });\nObject.defineProperty(__dcg_chunk_exports__, 'ub', { get: () => Oc });\nObject.defineProperty(__dcg_chunk_exports__, 'vb', { get: () => ss });\nObject.defineProperty(__dcg_chunk_exports__, 'wb', { get: () => vi });\nObject.defineProperty(__dcg_chunk_exports__, 'xb', { get: () => Tu });\nObject.defineProperty(__dcg_chunk_exports__, 'yb', { get: () => $f });\nObject.defineProperty(__dcg_chunk_exports__, 'zb', { get: () => qz });\nObject.defineProperty(__dcg_chunk_exports__, 'Ab', { get: () => Uz });\nObject.defineProperty(__dcg_chunk_exports__, 'Bb', { get: () => zz });\nObject.defineProperty(__dcg_chunk_exports__, 'Cb', { get: () => va });\nObject.defineProperty(__dcg_chunk_exports__, 'Db', { get: () => tf });\nObject.defineProperty(__dcg_chunk_exports__, 'Eb', { get: () => L6 });\nObject.defineProperty(__dcg_chunk_exports__, 'Fb', { get: () => GR });\nObject.defineProperty(__dcg_chunk_exports__, 'Gb', { get: () => AP });\nObject.defineProperty(__dcg_chunk_exports__, 'Hb', { get: () => S2 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ib', { get: () => v2 });\nObject.defineProperty(__dcg_chunk_exports__, 'Jb', { get: () => mr });\nObject.defineProperty(__dcg_chunk_exports__, 'Kb', { get: () => On });\nObject.defineProperty(__dcg_chunk_exports__, 'Lb', { get: () => X6 });\nObject.defineProperty(__dcg_chunk_exports__, 'Mb', { get: () => c0 });\nObject.defineProperty(__dcg_chunk_exports__, 'Nb', { get: () => WR });\nObject.defineProperty(__dcg_chunk_exports__, 'Ob', { get: () => Is });\nObject.defineProperty(__dcg_chunk_exports__, 'Pb', { get: () => Bs });\nObject.defineProperty(__dcg_chunk_exports__, 'Qb', { get: () => Q2 });\nObject.defineProperty(__dcg_chunk_exports__, 'Rb', { get: () => tr });\nObject.defineProperty(__dcg_chunk_exports__, 'Sb', { get: () => g0 });\nObject.defineProperty(__dcg_chunk_exports__, 'Tb', { get: () => Yh });\nObject.defineProperty(__dcg_chunk_exports__, 'Ub', { get: () => Zh });\nObject.defineProperty(__dcg_chunk_exports__, 'Vb', { get: () => om });\nObject.defineProperty(__dcg_chunk_exports__, 'Wb', { get: () => cm });\nObject.defineProperty(__dcg_chunk_exports__, 'Xb', { get: () => lm });\nObject.defineProperty(__dcg_chunk_exports__, 'Yb', { get: () => X0 });\nObject.defineProperty(__dcg_chunk_exports__, 'Zb', { get: () => W0 });\nObject.defineProperty(__dcg_chunk_exports__, '_b', { get: () => I0 });\nObject.defineProperty(__dcg_chunk_exports__, '$b', { get: () => yU });\nObject.defineProperty(__dcg_chunk_exports__, 'ac', { get: () => oO });\nObject.defineProperty(__dcg_chunk_exports__, 'bc', { get: () => hU });\nObject.defineProperty(__dcg_chunk_exports__, 'cc', { get: () => nb });\nObject.defineProperty(__dcg_chunk_exports__, 'dc', { get: () => Bf });\nObject.defineProperty(__dcg_chunk_exports__, 'ec', { get: () => j0 });\nObject.defineProperty(__dcg_chunk_exports__, 'fc', { get: () => J0 });\nObject.defineProperty(__dcg_chunk_exports__, 'gc', { get: () => iO });\nObject.defineProperty(__dcg_chunk_exports__, 'hc', { get: () => TU });\nObject.defineProperty(__dcg_chunk_exports__, 'ic', { get: () => aO });\nObject.defineProperty(__dcg_chunk_exports__, 'jc', { get: () => IU });\nObject.defineProperty(__dcg_chunk_exports__, 'kc', { get: () => uO });\nObject.defineProperty(__dcg_chunk_exports__, 'lc', { get: () => PU });\nObject.defineProperty(__dcg_chunk_exports__, 'mc', { get: () => FU });\nObject.defineProperty(__dcg_chunk_exports__, 'nc', { get: () => GU });\nObject.defineProperty(__dcg_chunk_exports__, 'oc', { get: () => HU });\nObject.defineProperty(__dcg_chunk_exports__, 'pc', { get: () => Zi });\nObject.defineProperty(__dcg_chunk_exports__, 'qc', { get: () => Zt });\nObject.defineProperty(__dcg_chunk_exports__, 'rc', { get: () => rz });\nObject.defineProperty(__dcg_chunk_exports__, 'sc', { get: () => sz });\nObject.defineProperty(__dcg_chunk_exports__, 'tc', { get: () => sM });\nObject.defineProperty(__dcg_chunk_exports__, 'uc', { get: () => k });\nObject.defineProperty(__dcg_chunk_exports__, 'vc', { get: () => Xn });\nObject.defineProperty(__dcg_chunk_exports__, 'wc', { get: () => hn });\nObject.defineProperty(__dcg_chunk_exports__, 'xc', { get: () => rt });\nObject.defineProperty(__dcg_chunk_exports__, 'yc', { get: () => Yr });\nObject.defineProperty(__dcg_chunk_exports__, 'zc', { get: () => Hs });\nObject.defineProperty(__dcg_chunk_exports__, 'Ac', { get: () => ec });\nObject.defineProperty(__dcg_chunk_exports__, 'Bc', { get: () => yJ });\nObject.defineProperty(__dcg_chunk_exports__, 'Cc', { get: () => ok });\nObject.defineProperty(__dcg_chunk_exports__, 'Dc', { get: () => Dn });\nObject.defineProperty(__dcg_chunk_exports__, 'Ec', { get: () => hM });\nObject.defineProperty(__dcg_chunk_exports__, 'Fc', { get: () => Cs });\nObject.defineProperty(__dcg_chunk_exports__, 'Gc', { get: () => Fr });\nObject.defineProperty(__dcg_chunk_exports__, 'Hc', { get: () => ate });\nObject.defineProperty(__dcg_chunk_exports__, 'Ic', { get: () => Gb });\nObject.defineProperty(__dcg_chunk_exports__, 'Jc', { get: () => dA });\nObject.defineProperty(__dcg_chunk_exports__, 'Kc', { get: () => Yc });\nObject.defineProperty(__dcg_chunk_exports__, 'Lc', { get: () => go });\nObject.defineProperty(__dcg_chunk_exports__, 'Mc', { get: () => Zc });\nObject.defineProperty(__dcg_chunk_exports__, 'Nc', { get: () => Ha });\nObject.defineProperty(__dcg_chunk_exports__, 'Oc', { get: () => Du });\nObject.defineProperty(__dcg_chunk_exports__, 'Pc', { get: () => ay });\nObject.defineProperty(__dcg_chunk_exports__, 'Qc', { get: () => bA });\nObject.defineProperty(__dcg_chunk_exports__, 'Rc', { get: () => Ure });\nObject.defineProperty(__dcg_chunk_exports__, 'Sc', { get: () => le });\nObject.defineProperty(__dcg_chunk_exports__, 'Tc', { get: () => Qre });\nObject.defineProperty(__dcg_chunk_exports__, 'Uc', { get: () => Kre });\nObject.defineProperty(__dcg_chunk_exports__, 'Vc', { get: () => _ });\nObject.defineProperty(__dcg_chunk_exports__, 'Wc', { get: () => NC });\nObject.defineProperty(__dcg_chunk_exports__, 'Xc', { get: () => S_ });\nObject.defineProperty(__dcg_chunk_exports__, 'Yc', { get: () => M_ });\nObject.defineProperty(__dcg_chunk_exports__, 'Zc', { get: () => C_ });\nObject.defineProperty(__dcg_chunk_exports__, '_c', { get: () => v_ });\nObject.defineProperty(__dcg_chunk_exports__, '$c', { get: () => Ou });\nObject.defineProperty(__dcg_chunk_exports__, 'ad', { get: () => Kc });\nObject.defineProperty(__dcg_chunk_exports__, 'bd', { get: () => lse });\nObject.defineProperty(__dcg_chunk_exports__, 'cd', { get: () => Ke });\nObject.defineProperty(__dcg_chunk_exports__, 'dd', { get: () => w8 });\nObject.defineProperty(__dcg_chunk_exports__, 'ed', { get: () => qC });\nObject.defineProperty(__dcg_chunk_exports__, 'fd', { get: () => UC });\nObject.defineProperty(__dcg_chunk_exports__, 'gd', { get: () => zC });\nObject.defineProperty(__dcg_chunk_exports__, 'hd', { get: () => dx });\nObject.defineProperty(__dcg_chunk_exports__, 'id', { get: () => fx });\nObject.defineProperty(__dcg_chunk_exports__, 'jd', { get: () => ol });\nObject.defineProperty(__dcg_chunk_exports__, 'kd', { get: () => Ey });\nObject.defineProperty(__dcg_chunk_exports__, 'ld', { get: () => j_ });\nObject.defineProperty(__dcg_chunk_exports__, 'md', { get: () => vx });\nObject.defineProperty(__dcg_chunk_exports__, 'nd', { get: () => Dx });\nObject.defineProperty(__dcg_chunk_exports__, 'od', { get: () => Goe });\nObject.defineProperty(__dcg_chunk_exports__, 'pd', { get: () => Hoe });\nObject.defineProperty(__dcg_chunk_exports__, 'qd', { get: () => hv });\nObject.defineProperty(__dcg_chunk_exports__, 'rd', { get: () => Ax });\nObject.defineProperty(__dcg_chunk_exports__, 'sd', { get: () => F$ });\nObject.defineProperty(__dcg_chunk_exports__, 'td', { get: () => gw });\nObject.defineProperty(__dcg_chunk_exports__, 'ud', { get: () => V$ });\nObject.defineProperty(__dcg_chunk_exports__, 'vd', { get: () => hw });\nObject.defineProperty(__dcg_chunk_exports__, 'wd', { get: () => Ox });\nObject.defineProperty(__dcg_chunk_exports__, 'xd', { get: () => G$ });\nObject.defineProperty(__dcg_chunk_exports__, 'yd', { get: () => bv });\nObject.defineProperty(__dcg_chunk_exports__, 'zd', { get: () => xp });\nObject.defineProperty(__dcg_chunk_exports__, 'Ad', { get: () => H$ });\nObject.defineProperty(__dcg_chunk_exports__, 'Bd', { get: () => q$ });\nObject.defineProperty(__dcg_chunk_exports__, 'Cd', { get: () => cl });\nObject.defineProperty(__dcg_chunk_exports__, 'Dd', { get: () => gd });\nObject.defineProperty(__dcg_chunk_exports__, 'Ed', { get: () => z$ });\nObject.defineProperty(__dcg_chunk_exports__, 'Fd', { get: () => Cw });\nObject.defineProperty(__dcg_chunk_exports__, 'Gd', { get: () => on });\nObject.defineProperty(__dcg_chunk_exports__, 'Hd', { get: () => vw });\nObject.defineProperty(__dcg_chunk_exports__, 'Id', { get: () => xd });\nObject.defineProperty(__dcg_chunk_exports__, 'Jd', { get: () => _y });\nObject.defineProperty(__dcg_chunk_exports__, 'Kd', { get: () => wy });\nObject.defineProperty(__dcg_chunk_exports__, 'Ld', { get: () => Wae });\nObject.defineProperty(__dcg_chunk_exports__, 'Md', { get: () => Kw });\nObject.defineProperty(__dcg_chunk_exports__, 'Nd', { get: () => jae });\nObject.defineProperty(__dcg_chunk_exports__, 'Od', { get: () => eL });\nObject.defineProperty(__dcg_chunk_exports__, 'Pd', { get: () => ml });\nObject.defineProperty(__dcg_chunk_exports__, 'Qd', { get: () => Kae });\nObject.defineProperty(__dcg_chunk_exports__, 'Rd', { get: () => nue });\nObject.defineProperty(__dcg_chunk_exports__, 'Sd', { get: () => rue });\nObject.defineProperty(__dcg_chunk_exports__, 'Td', { get: () => tL });\nObject.defineProperty(__dcg_chunk_exports__, 'Ud', { get: () => sue });\nObject.defineProperty(__dcg_chunk_exports__, 'Vd', { get: () => uue });\nObject.defineProperty(__dcg_chunk_exports__, 'Wd', { get: () => cue });\nObject.defineProperty(__dcg_chunk_exports__, 'Xd', { get: () => mue });\nObject.defineProperty(__dcg_chunk_exports__, 'Yd', { get: () => due });\nObject.defineProperty(__dcg_chunk_exports__, 'Zd', { get: () => sL });\nObject.defineProperty(__dcg_chunk_exports__, '_d', { get: () => fue });\nObject.defineProperty(__dcg_chunk_exports__, '$d', { get: () => zx });\nObject.defineProperty(__dcg_chunk_exports__, 'ae', { get: () => p5 });\nObject.defineProperty(__dcg_chunk_exports__, 'be', { get: () => Sue });\nObject.defineProperty(__dcg_chunk_exports__, 'ce', { get: () => oL });\nObject.defineProperty(__dcg_chunk_exports__, 'de', { get: () => Ux });\nObject.defineProperty(__dcg_chunk_exports__, 'ee', { get: () => iL });\nObject.defineProperty(__dcg_chunk_exports__, 'fe', { get: () => aL });\nObject.defineProperty(__dcg_chunk_exports__, 'ge', { get: () => uL });\nObject.defineProperty(__dcg_chunk_exports__, 'he', { get: () => Mue });\nObject.defineProperty(__dcg_chunk_exports__, 'ie', { get: () => Cue });\nObject.defineProperty(__dcg_chunk_exports__, 'je', { get: () => m5 });\nObject.defineProperty(__dcg_chunk_exports__, 'ke', { get: () => vue });\nObject.defineProperty(__dcg_chunk_exports__, 'le', { get: () => Due });\nObject.defineProperty(__dcg_chunk_exports__, 'me', { get: () => Mce });\nObject.defineProperty(__dcg_chunk_exports__, 'ne', { get: () => E5 });\nObject.defineProperty(__dcg_chunk_exports__, 'oe', { get: () => ple });\nObject.defineProperty(__dcg_chunk_exports__, 'pe', { get: () => cc });\nObject.defineProperty(__dcg_chunk_exports__, 'qe', { get: () => mle });\nObject.defineProperty(__dcg_chunk_exports__, 're', { get: () => vle });\nObject.defineProperty(__dcg_chunk_exports__, 'se', { get: () => bV });\nObject.defineProperty(__dcg_chunk_exports__, 'te', { get: () => IV });\nObject.defineProperty(__dcg_chunk_exports__, 'ue', { get: () => fa });\nObject.defineProperty(__dcg_chunk_exports__, 've', { get: () => pT });\nObject.defineProperty(__dcg_chunk_exports__, 'we', { get: () => AV });\nObject.defineProperty(__dcg_chunk_exports__, 'xe', { get: () => Uo });\nObject.defineProperty(__dcg_chunk_exports__, 'ye', { get: () => RY });\nObject.defineProperty(__dcg_chunk_exports__, 'ze', { get: () => TB });\nObject.defineProperty(__dcg_chunk_exports__, 'Ae', { get: () => qD });\nObject.defineProperty(__dcg_chunk_exports__, 'Be', { get: () => n4 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ce', { get: () => ZZ });\nObject.defineProperty(__dcg_chunk_exports__, 'De', { get: () => KZ });\nObject.defineProperty(__dcg_chunk_exports__, 'Ee', { get: () => IB });\nObject.defineProperty(__dcg_chunk_exports__, 'Fe', { get: () => PB });\nObject.defineProperty(__dcg_chunk_exports__, 'Ge', { get: () => MB });\nObject.defineProperty(__dcg_chunk_exports__, 'He', { get: () => sr });\nObject.defineProperty(__dcg_chunk_exports__, 'Ie', { get: () => FT });\nObject.defineProperty(__dcg_chunk_exports__, 'Je', { get: () => bX });\nObject.defineProperty(__dcg_chunk_exports__, 'Ke', { get: () => L3 });\nObject.defineProperty(__dcg_chunk_exports__, 'Le', { get: () => F3 });\nObject.defineProperty(__dcg_chunk_exports__, 'Me', { get: () => TW });\nObject.defineProperty(__dcg_chunk_exports__, 'Ne', { get: () => IW });\nObject.defineProperty(__dcg_chunk_exports__, 'Oe', { get: () => H3 });\nObject.defineProperty(__dcg_chunk_exports__, 'Pe', { get: () => Wbe });\nObject.defineProperty(__dcg_chunk_exports__, 'Qe', { get: () => WT });\nObject.defineProperty(__dcg_chunk_exports__, 'Re', { get: () => W3 });\n\n    return __dcg_chunk_exports__;\n  })();"
  const __dcg_shared_module_exports__ = eval(__dcg_shared_module_source__);
  const __dcg_worker_source_exports__ = (function () {
    // worker.js
    const __dcg_worker_source__ = `
      // store the code for the worker module as a function that takes the shared module exports as an argument
      const __dcg_worker_module__ = (__dcg_shared_module_exports__) => {
` + "var n={};__dcg_shared_module_exports__['Be'].log=function(e){self.postMessage({log:JSON.stringify(e)})};var o=self;o.window=o;o.onmessage=function(e){let s=e.data&&e.data.connectionId;if(s)if(e.data.originalMessage.type===\"destroy\")delete n[s];else{let a=n[s];a||(a=new __dcg_shared_module_exports__['Re']((r,g)=>{o.postMessage({connectionId:s,originalMessage:{type:r,payload:g}})}),n[s]=a),a.processChangeSet(e.data.originalMessage)}};o.loadMessageQueue&&(o.loadMessageQueue.forEach(e=>{o.onmessage(e)}),delete o.loadMessageQueue);\n" + `
      };
      // execute the shared module store its exports
      const __dcg_worker_shared_module_exports__ = ${__dcg_shared_module_source__};
      // call the worker module, passing in the shared module exports
      __dcg_worker_module__(__dcg_worker_shared_module_exports__);`

    let createWorker;
    if (typeof Blob !== 'undefined' && URL && typeof URL.createObjectURL === 'function') {
      createWorker = () => {
        const workerURL = URL.createObjectURL(new Blob([__dcg_worker_source__], { type: 'application/javascript' }))
        const worker = new Worker(workerURL);
        worker.revokeObjectURL = () => {
          URL.revokeObjectURL(workerURL);
        }
        return worker;
      }
    } else {
      // Just for testing in Node
      createWorker = () => {
        (new Function(__dcg_worker_source__))();
      }
    }

    return {createWorker, default: {createWorker}};
  })();
  function X8(r){return typeof r=="string"&&["graphing","geometry-calculator","graphing-3d"].includes(r)}function hg(r){switch(r){case"graphing-3d":return"3d";case"geometry-calculator":return"geometry";case"graphing":return"2d"}}function $8(r){switch(r){case"2d":return"graphing";case"3d":return"graphing-3d";case"geometry":return"geometry-calculator";default:return}}var j8,Lu,J8,zse,EEe,Z8,Q8,LR,Hs,Yf,IEe,EE=__dcg_shared_module_exports__['b'](()=>{j8="v1.11",Lu=["graphing","geometry-calculator","graphing-3d"];J8={graphing:"/assets/img/apps/graphing/favicon.ico","graphing-3d":"/assets/img/apps/3d/favicon.ico","geometry-calculator":"/assets/img/apps/geometry/favicon.ico"},zse=["education","commercial","generic","prospect"],EEe=[...zse,"uncategorized"],Z8="inactive",Q8=r=>!!r&&["open","closed","inactive"].includes(r),LR=[2024,2023,2022,2021,2020],Hs=2024,Yf=Hs-1,IEe=["/art",LR.map(r=>`/art-${r}`),LR.map(r=>`/certificate-${r}`),LR.map(r=>`/winner-certificate-${r}`)].flat()});var AEe,eK=__dcg_shared_module_exports__['b'](()=>{EE();AEe=[...Lu,"recovery"]});function PR(r){let e={};for(let t in r)e[t]=r[t].getAuthoringConfig();return e}function t0(r,e,t={}){let o=t[r]||r==="validation";return`"${r}"${o?"?":""}:${e}`}var r0,gg,at,fi,IE,o0,ME,GR,rp,tK=__dcg_shared_module_exports__['b'](()=>{r0=class{},gg=class extends r0{constructor(){super(...arguments);this._conditionalAttributes=new Map;this.arrayBoundsChecks=[];this.latexs=[];this.labels=[]}ensureNumber(){return this.validation="number",this}ensureString(){return this.validation="string",this}ensureEnum(t){return this.validation=t,this}conditionalAttributes(t,o){return this._conditionalAttributes.set(t,o),this}ensureWithinArrayBounds(t){return this.arrayBoundsChecks.push(t),this}ensureWithinRange(t,o){return this.numberRange={min:t,max:o},this}latex(t){return this.latexs.push(t),this}label(t){return this.labels.push(t),this}validateReferences({validator:t,path:o,value:i,concreteCtx:n}){if(this.arrayBoundsChecks.length)if(!(typeof i=="number"&&i>=1&&Number.isInteger(i)))t.reportError(o,"array index must be an integer of at least 1. Got: "+i);else for(let s of this.arrayBoundsChecks){let c=[];for(let d of n.nodes)d.type==="array"&&d.node===s&&c.push(d.rawValue.length);if(c.length!==1)t.reportError(o,"expected exactly 1 array reference. got: "+c.length);else{let d=c[0];i>d&&t.reportError(o,"expected to be at most "+d+", got: "+i)}}}addGraphMutations({validator:t,path:o,value:i,graphMutations:n}){for(let a of this.latexs)typeof i=="string"||typeof i=="number"?n.push({type:"value",identifier:a,value:i+""}):typeof i=="boolean"?n.push({type:"value",identifier:a,value:i?"1":"0"}):t.reportError(o,"unexpected latexValue mutation value type:  "+typeof i);for(let a of this.labels)typeof i=="string"?n.push({type:"label",identifier:a,value:i+""}):t.reportError(o,"unexpected label mutation value type:  "+typeof i)}parseString({path:t,subData:o,validator:i}){let n=o;if(!this.validation)return i.reportError(t,'has no validation. Use "string" for no validation'),n;if(i.shouldSkipParsingDataVariable(n))return n;if(typeof this.validation=="object")return n in this.validation?this.validation[n]:(i.reportError(t,"unknown type: "+n),n);switch(this.validation){case"string":return n;case"number":if(!/^-?[0-9]*[.]?[0-9]*$/.test(n)||!/[0-9]/g.test(n))return i.reportError(t,"expected to be a number but it was not: "+n),NaN;let a=parseFloat(n);return this.numberRange&&(a<this.numberRange.min||a>this.numberRange.max)?(i.reportError(t,"expected to be between "+this.numberRange.min+" and "+this.numberRange.max+" but was: "+n),NaN):a;default:this.validation;break}return n}};at=class extends r0{constructor(t){super();this.config=t;this.computedConditionalAttributes=[];for(let i in this.config.attributes){let n=this.config.attributes[i];if(n instanceof gg){let a=n._conditionalAttributes;if(a.size>0){let s=[];for(let[c,d]of a.entries())s.push({value:c,attributes:d});this.computedConditionalAttributes.push({attribute_key:i,conditions:s})}}}let o=[];for(let i of this.computedConditionalAttributes){let n=[];for(let a of i.conditions){for(let s in a.attributes){let c=a.attributes[s];if(c instanceof gg&&c._conditionalAttributes.size)throw new Error("cannot have nested conditional attributes. Must route through object")}n.push({value:a.value,attributes:PR(a.attributes)})}o.push({attribute_key:i.attribute_key,conditions:n})}this.authoringConfig={type:"object",name:t.name,attributes:PR(t.attributes),conditional_attributes:o}}getAuthoringConfig(){return this.authoringConfig}getTypescriptType(t){let o=[],i=[];for(let n in this.config.attributes)i.push(t0(n,this.config.attributes[n].getTypescriptType(t)));o.push(`{
`+i.join(`,
`)+`
}`);for(let n of this.computedConditionalAttributes){let a=[],s=this.config.attributes[n.attribute_key];if(!s)throw new Error("did not find attribute_key in attributes");if(!(s instanceof gg))throw new Error("attribute_key must be a primitive attribute");let c=s.getEnumerableValues(t);if(!c)throw new Error("attribute_key must have a finite, enumerable set of values");let d=new Set(c);for(let p of n.conditions){if(t){let u=this.config.attributes[n.attribute_key];u instanceof o0&&typeof u.validation=="object"&&(p={...p,value:u.validation[p.value]})}if(i=[],i.push(t0(n.attribute_key,JSON.stringify(p.value))),d.has(p.value))d.delete(p.value);else throw new Error("conditional_attribute specified value multiple times: "+p.value);for(let u in p.attributes)i.push(t0(u,p.attributes[u].getTypescriptType(t)));a.push(`{
`+i.join(`,
`)+`
}`)}if(d.size)for(let p of d)a.push(`{
${t0(n.attribute_key,JSON.stringify(p))}}`);o.push("("+a.join(" | ")+")")}return o.length>1?"("+o.join(" & ")+")":o[0]}toConcrete({validator:t,path:o,rawValue:i,concreteCtx:n}){if(!i||typeof i!="object"){t.reportError(o,"should be an object");return}let a={};for(let d in this.config.attributes)a[d]=this.config.attributes[d].toConcrete({path:o+"."+d,validator:t,rawValue:i[d],concreteCtx:n});for(let{attribute_key:d,conditions:p}of this.computedConditionalAttributes)for(let{attributes:u,value:g}of p)if(i[d]===g)for(let h in u)a[h]=u[h].toConcrete({path:o+"."+h,validator:t,rawValue:i[h],concreteCtx:n});let s={};for(let d in a){let p=a[d];p?s[d]=p.parsedValue:s[d]=void 0}let c={type:"object",path:o,rawValue:a,parsedValue:s,node:this};return n.nodes.push(c),c}},fi=class extends r0{constructor(t){super();this.config=t;let o;("minimum"in t||"maximum"in t)&&(o={maximum:t.maximum,minimum:t.minimum}),this.authoringConfig={type:"array",required:!0,name:t.name,count:o,items:t.items.getAuthoringConfig()}}getAuthoringConfig(){return this.authoringConfig}getTypescriptType(t){return`(${this.config.items.getTypescriptType(t)})[]`}toConcrete({validator:t,path:o,rawValue:i,concreteCtx:n}){if(!Array.isArray(i)){t.reportError(o,"should be an array");return}let a=i.map((d,p)=>this.config.items.toConcrete({path:o+"["+p+"]",validator:t,rawValue:d,concreteCtx:n})),s=a.map(d=>{if(d)return d.parsedValue}),c={type:"array",path:o,rawValue:a,parsedValue:s,node:this};return n.nodes.push(c),c}},IE=class extends gg{constructor(e){super(),this.authoringConfig={type:"string",element:"editor",required:!0,name:e.name,default:e.default}}getAuthoringConfig(){return this.authoringConfig}getEnumerableValues(e){if(typeof this.validation=="object")return e?Object.values(this.validation):Object.keys(this.validation)}getTypescriptType(e){let t=this.getEnumerableValues(e);return t?t.map(o=>JSON.stringify(o)).join(" | "):e&&this.validation==="number"?"number":"string"}toConcrete({validator:e,path:t,rawValue:o,concreteCtx:i}){if(typeof o!="string"){e.reportError(t,"should be a string");return}let n=this.parseString({path:t,subData:o,validator:e}),a={type:"string",path:t,rawValue:o,parsedValue:n,node:this};return i.nodes.push(a),a}},o0=class extends gg{constructor(e){super(),this.authoringConfig={type:"string",element:"select",required:!0,name:e.name,default:e.default,options:e.options}}getAuthoringConfig(){return this.authoringConfig}getEnumerableValues(e){return typeof this.validation=="object"?e?Object.values(this.validation):Object.keys(this.validation):this.authoringConfig.options.map(t=>t.value)}getTypescriptType(e){return this.getEnumerableValues(e).map(t=>JSON.stringify(t)).join(" | ")}toConcrete({validator:e,path:t,rawValue:o,concreteCtx:i}){if(typeof o!="string"){e.reportError(t,"should be a string");return}if(!this.authoringConfig.options.find(s=>s.value===o)){e.reportError(t,"value must be one of the select options: "+o);return}let n=this.parseString({path:t,subData:o,validator:e}),a={type:"select",path:t,rawValue:o,parsedValue:n,node:this};return i.nodes.push(a),a}},ME=class extends gg{constructor(e){super(),this.authoringConfig={type:"boolean",required:!0,name:e.name,default:e.default}}getAuthoringConfig(){return this.authoringConfig}getEnumerableValues(){return[!0,!1]}getTypescriptType(){return"boolean"}toConcrete({validator:e,path:t,rawValue:o,concreteCtx:i}){if(typeof o!="boolean"){e.reportError(t,"should be a boolean");return}let n={type:"boolean",path:t,rawValue:o,parsedValue:o,node:this};return i.nodes.push(n),n}},GR=class{constructor(e){this.shouldExpectDataVariables=e;this.errors=[]}hasErrors(){return!!this.errors.length}getErrors(){return this.errors}reportError(e,t){this.errors.push(e+" - "+t)}shouldSkipParsingDataVariable(e){return this.shouldExpectDataVariables?!!(typeof e=="string"&&e.includes("{{var:")):!1}};rp=class{constructor(e){this.optionalSections={};this.config={};for(let t in e){let o=e[t],i=t;i.endsWith("?")&&(i=i.slice(0,t.length-1),this.optionalSections[i]=!0),this.config[i]=o}this.authoringConfig=PR(this.config)}getAuthoringConfig(){return this.authoringConfig}inflateWithData(e,t){var c;let o=new GR(e),i={nodes:[]},n={};for(let d in this.config)n[d]=this.config[d].toConcrete({path:d,rawValue:t[d],validator:o,concreteCtx:i});if(o.hasErrors())return{type:"errors",errors:o.getErrors()};let a=[];for(let d of i.nodes)switch(d.type){case"array":case"object":break;case"boolean":case"select":case"string":d.node.validateReferences({path:d.path,validator:o,value:d.parsedValue,concreteCtx:i}),d.node.addGraphMutations({path:d.path,value:d.parsedValue,validator:o,graphMutations:a});break}if(o.hasErrors())return{type:"errors",errors:o.getErrors()};let s={};for(let d in n)s[d]=(c=n[d])==null?void 0:c.parsedValue;return{type:"results",graphMutations:a,parsedValue:s}}getTypescriptType(e){let t=[];for(let o in this.config)t.push(t0(o,this.config[o].getTypescriptType(e==="Parsed"),this.optionalSections));return`{
`+t.join(`,
`)+`
}`}}});function ip(r,e){return new IE({name:r,default:e})}function vt(r,e){return ip(r,e).ensureNumber()}function ct(r,e){return ip(r,e).ensureString()}function rK(r,e){return ip(r,e).ensureNumber().ensureWithinRange(-1,1)}function VR(r,e){return ip(r,e).ensureEnum({left:1,mid:2,right:3})}function i0(r,e){return ip(r,e).ensureEnum({lowest:1,lower:2,low:3,mid:4,high:5,higher:6,highest:7})}function qse(r,e){return ip(r,e).ensureEnum({small:1,medium:2,large:3})}function bt(r,e){return new ME({name:r,default:e})}function Pu(r,e,t){return new o0({name:r,default:e,options:t}).ensureString()}function Wo(r,e){return Pu(r,e||"blue",[{label:"Blue",value:"blue"},{label:"Green",value:"green"},{label:"Orange",value:"orange"},{label:"Purple",value:"purple"},{label:"Black",value:"black"},{label:"Red",value:"red"},{label:"Gray",value:"gray"}]).ensureEnum({red:"1",blue:"2",green:"3",orange:"4",purple:"5",black:"6",gray:"7"})}function Hse(r){return Pu(r,"solid",[{label:"Solid",value:"solid"},{label:"Dashed",value:"dashed"},{label:"Dotted",value:"dotted"}]).ensureEnum({solid:"1",dashed:"2",dotted:"3"})}function oK(r){return ip(r,"attainable").ensureEnum({attainable:1,unattainable:2,efficient:3})}function uc(r){return ip(r,"none").ensureEnum({none:0,negative:-1,positive:1})}function DE(r){return ip(r,"standard").ensureEnum({horizontal:"1",gradual:"2",standard:"3",steep:"4",vertical:"5"})}function op(r,e){return Pu(r,e||"none",[{label:"None",value:"none"},{label:"X",value:"x"},{label:"Y",value:"y"},{label:"Both",value:"both"}]).ensureEnum({none:"0",x:"1",y:"2",both:"3"})}var Bf,Kf,zf,aK,iK,nK,sK,lK,cK,dK,Wse,jse,Xse,$se,Jse,_x,Zse,Qse,ele,tle,rle,ole,VEe,pK=__dcg_shared_module_exports__['b'](()=>{tK();Bf=new at({name:"Horizontal Axis",attributes:{min:vt("X Min","0").latex("x_{min}"),max:vt("X Max","10").latex("x_{max}"),res:vt("X Res","1").latex("x_{res}"),major_grid:vt("X Major Grid","1").latex("x_{majorGrid}"),label:ct("X Axis Label","x-Axis").label("x_{label}"),tickmark_interval:vt("X Tickmarks","1").latex("x_{tick}"),label_interval:vt("X Labels","1").latex("x_{labelInt}")}}),Kf=new at({name:"Vertical Axis",attributes:{min:vt("Y Min","0").latex("y_{min}"),max:vt("Y Max","10").latex("y_{max}"),res:vt("Y Res","1").latex("y_{res}"),major_grid:vt("Y Major Grid","1").latex("y_{majorGrid}"),label:ct("Y Axis Label","y-Axis").label("y_{label}"),tickmark_interval:vt("Y Tickmarks","1").latex("y_{tick}"),label_interval:vt("Y Labels","1").latex("y_{labelInt}")}}),zf=new at({name:"Graph Properties",attributes:{title:ct("Graph Title","Graph Title").label("p_{Title}")}}),aK=new at({name:"Endpoint Mover",attributes:{appearance:Pu("Appearance","concaveDown",[{label:"Concave Downward",value:"concaveDown"},{label:"Linear",value:"linear"},{label:"Concave Upward",value:"concaveUp"}]).ensureEnum({concaveDown:"1",linear:"2",concaveUp:"3"}),color:Wo("Color"),style:Hse("Style"),given:bt("Given",!0).conditionalAttributes(!0,{x_shift:uc("xShift"),y_shift:uc("yShift"),label:ct("Label","")}).conditionalAttributes(!1,{group_label:ct("Label",""),validation:new at({attributes:{x_shift:uc("xShift"),y_shift:uc("yShift")}})}),group_points:new fi({name:"Endpoint Mover Points",maximum:3,items:new at({attributes:{color:Wo("Color"),label:ct("Label",""),given:bt("Given",!0).conditionalAttributes(!0,{type:oK("Type")}).conditionalAttributes(!1,{validation:new at({attributes:{type:oK("Type")}})}),show_coords:bt("Show Coords",!1)}})})}}),iK=new fi({name:"Increasing Lines",items:new at({attributes:{color:Wo("Color","orange"),scale:vt("Scale","1"),type:DE("Type"),label:ct("Label",""),ghost_label:ct("Ghost Label",""),post_shift_label:ct("Post Shift Label",""),given:bt("Given",!0).conditionalAttributes(!1,{validation:new at({attributes:{shift:uc("Shift")}}),shifter_point:new at({attributes:{show:bt("Shifter Point",!1).conditionalAttributes(!0,{drop_lines:op("Drop Lines","none"),label:ct("Label",""),ghost_label:ct("Ghost Label",""),post_shift_label:ct("Post Shift Label",""),validation:new at({attributes:{shift:uc("Shift")}})})}})}).conditionalAttributes(!0,{shift:uc("Shift"),shifter_point:new at({attributes:{show:bt("Shifter Point",!1).conditionalAttributes(!0,{drop_lines:op("Drop Lines","none"),label:ct("Label",""),ghost_label:ct("Ghost Label",""),post_shift_label:ct("Post Shift Label",""),shift:uc("Shift")})}})})}})}),nK=new fi({name:"Decreasing Lines",items:new at({attributes:{color:Wo("Color"),scale:vt("Scale","1"),type:DE("Type"),label:ct("Label",""),ghost_label:ct("Ghost Label",""),post_shift_label:ct("Post Shift Label",""),given:bt("Given",!0).conditionalAttributes(!1,{validation:new at({attributes:{shift:uc("Shift")}}),shifter_point:new at({attributes:{show:bt("Shifter Point",!1).conditionalAttributes(!0,{drop_lines:op("Drop Lines","none"),label:ct("Label",""),ghost_label:ct("Ghost Label",""),post_shift_label:ct("Post Shift Label",""),validation:new at({attributes:{shift:uc("Shift")}})})}})}).conditionalAttributes(!0,{shift:uc("Shift"),shifter_point:new at({attributes:{show:bt("Shifter Point",!1).conditionalAttributes(!0,{drop_lines:op("Drop Lines","none"),label:ct("Label",""),ghost_label:ct("Ghost Label",""),post_shift_label:ct("Post Shift Label",""),shift:uc("Shift")})}})})}})}),sK=new at({name:"Shifter",attributes:{increasing_lines:iK,decreasing_lines:nK,shifter_intersections:new fi({name:"Intersections",items:new at({attributes:{increasing_line:vt("Increasing Line","1").ensureWithinArrayBounds(iK),decreasing_line:vt("Decreasing Line","1").ensureWithinArrayBounds(nK),drop_lines:op("Drop Lines","both"),show_coords:bt("Show Coords",!1),show_point:bt("Show Point",!0)}})})}}),lK=new at({name:"Cost Curves",attributes:{role:Pu("Role","taker",[{label:"Price Taker",value:"taker"},{label:"Price Setter Upward MC",value:"setter-upward"},{label:"Price Setter Constant MC",value:"setter-constant"}]).conditionalAttributes("taker",{mc:new at({attributes:{horizontal:VR("MC Horizontal Alignment","mid"),vertical:i0("MC Vertical Alignment","mid"),show:bt("Show MC",!0).conditionalAttributes(!0,{label:ct("MC Label","MC"),color:Wo("MC Color","orange")})}}),avc:new at({attributes:{vertical:i0("AVC Vertical Alignment","mid"),show:bt("Show AVC",!0).conditionalAttributes(!0,{label:ct("AVC Label","AVC"),color:Wo("AVC Color","purple")})}}),atc:new at({attributes:{show:bt("Show ATC",!0).conditionalAttributes(!0,{label:ct("ATC Label","ATC"),color:Wo("ATC Color","green")})}})}).conditionalAttributes("setter-upward",{mc:new at({attributes:{horizontal:VR("MC Horizontal Alignment","mid"),vertical:i0("MC Vertical Alignment","mid"),show:bt("Show MC",!0).conditionalAttributes(!0,{label:ct("MC Label","MC"),color:Wo("MC Color","orange")})}}),avc:new at({attributes:{show:bt("Show AVC",!0).conditionalAttributes(!0,{label:ct("AVC Label","AVC"),color:Wo("AVC Color","purple")})}}),atc:new at({attributes:{horizontal:VR("ATC Horizontal Alignment","mid"),vertical:i0("ATC Vertical Alignment","mid"),show:bt("Show ATC",!0).conditionalAttributes(!0,{label:ct("ATC Label","ATC"),color:Wo("ATC Color","green")})}})}).conditionalAttributes("setter-constant",{mc:new at({attributes:{vertical:i0("MC Vertical Alignment","mid"),show:bt("Show MC",!0).conditionalAttributes(!0,{label:ct("MC Label","MC"),color:Wo("MC Color","orange")})}}),atc:new at({attributes:{show:bt("Show ATC",!0).conditionalAttributes(!0,{label:ct("ATC Label","ATC"),color:Wo("ATC Color","green")})}}),fc_scale:qse("FC Scale","medium")})}}),cK=new at({attributes:{curves:new fi({name:"Indifference Curves",minimum:1,items:new at({attributes:{color:Wo("Color","blue"),x_coord:vt("X",""),y_coord:vt("Y",""),slope:vt("Slope","").ensureWithinRange(-1/0,0),substitutability:vt("Substitutability",""),label:ct("Label",""),point:new at({attributes:{role:Pu("Role","hidden",[{value:"hidden",label:"Hidden"},{value:"given",label:"Given"},{value:"required",label:"Required"}]).conditionalAttributes("given",{label:ct("Label",""),color:Wo("Color","blue"),drop_lines:op("Drop Lines","none"),show_coords:bt("Show Coords",!0)}).conditionalAttributes("required",{label:ct("Label",""),color:Wo("Color","blue"),drop_lines:op("Drop Lines","none"),show_coords:bt("Show Coords",!0)})}}),line:new at({attributes:{role:Pu("Role","hidden",[{value:"hidden",label:"Hidden"},{value:"given",label:"Given"},{value:"required",label:"Required"}]).conditionalAttributes("given",{label:ct("Label",""),color:Wo("Color","blue"),show_coords:bt("Show Coords",!0),show_x_int:bt("Show X Intercept",!1),show_y_int:bt("Show Y Intercept",!1),show_slope:bt("Show Slope",!1)}).conditionalAttributes("required",{label:ct("Label",""),color:Wo("Color","blue"),show_coords:bt("Show Coords",!0),show_x_int:bt("Show X Intercept",!1),show_y_int:bt("Show Y Intercept",!1),show_slope:bt("Show Slope",!1)})}})}})})}}),dK=new at({name:"Input Driven Market",attributes:{input_variable:Pu("Input Variable","Y",[{label:"X",value:"X"},{label:"Y",value:"Y"}]).ensureEnum({X:2,Y:1}).conditionalAttributes("X",{editorOnly_x_below:ct("Left Equilibrium",""),editorOnly_x_above:ct("Right Equilibrium","")}).conditionalAttributes("Y",{editorOnly_y_below:ct("Below Equilibrium",""),editorOnly_y_above:ct("Above Equilibrium","")}),input_value:vt("Default Value",""),input_color:Wo("Input Color","green"),input_decimals:vt("Input Decimals","2"),market_label:ct("Market Label",""),input_label:ct("Input Label",""),input_units:ct("Input Units",""),increasing_line:new at({attributes:{show:bt("Show",!0).conditionalAttributes(!0,{color:Wo("Color","orange"),type:DE("Type"),label:ct("Label",""),ghost_label:ct("Ghost Label",""),post_shift_label:ct("Post Shift Label",""),output_label:ct("Output Label",""),output_units:ct("Output Units",""),output_decimals:vt("Output Decimals","2"),shift:new at({attributes:{show:bt("Allow Shift",!1).conditionalAttributes(!0,{default_value:vt("Shift Default Value","0"),shift_coefficient:vt("Shift Coefficient","1"),shift_decimals:vt("Shift Decimals","2"),title:ct("Shift Title",""),label:ct("Shift Label",""),units:ct("Shift Units","")})}})})}}),decreasing_line:new at({attributes:{show:bt("Show",!0).conditionalAttributes(!0,{color:Wo("Color","blue"),type:DE("Type"),label:ct("Label",""),ghost_label:ct("Ghost Label",""),post_shift_label:ct("Post Shift Label",""),output_label:ct("Output Label",""),output_units:ct("Output Units",""),output_decimals:vt("Output Decimals","2"),shift:new at({attributes:{show:bt("Allow Shift",!1).conditionalAttributes(!0,{default_value:vt("Shift Default Value","0"),shift_coefficient:vt("Shift Coefficient","1"),shift_decimals:vt("Shift Decimals","2"),title:ct("Shift Title",""),label:ct("Shift Label",""),units:ct("Shift Units","")})}})})}}),shifter_intersection:new at({attributes:{show:bt("Show",!0).conditionalAttributes(!0,{drop_lines:op("Drop Lines","both")})}}),below_eqm:new at({attributes:{show:bt("Show",!0).conditionalAttributes(!0,{label:ct("Label",""),units:ct("Units",""),eqm_decimals:vt("Decimals","2")})}}),above_eqm:new at({attributes:{show:bt("Show",!0).conditionalAttributes(!0,{label:ct("Label",""),units:ct("Units",""),eqm_decimals:vt("Decimals","2")})}})}}),Wse=new at({attributes:{color:Wo("Color"),connected:bt("Connected",!1),given:bt("Given",!0).conditionalAttributes(!0,{when_given:new at({attributes:{group_points:new fi({name:"Group Points",minimum:1,items:new at({name:"Group Points",attributes:{x_coord:vt("X",""),y_coord:vt("Y",""),label:ct("Label",""),drop_lines:op("Drop Lines"),show_point:bt("Show Point",!0).conditionalAttributes(!0,{show_coords:bt("Show Coords",!1)})}})})}})}).conditionalAttributes(!1,{when_required:new at({attributes:{group_label:ct("Group Label",""),group_points:new fi({name:"Group Points",minimum:1,items:new at({name:"Group Points",attributes:{drop_lines:op("Drop Lines"),show_coords:bt("Show Coords",!1),validation:new at({attributes:{x_coord:vt("X",""),y_coord:vt("Y","")}})}})})}})})}}),jse=new at({attributes:{color:Wo("Color"),given:bt("Given",!0).conditionalAttributes(!0,{when_given:new at({attributes:{group_lines:new fi({name:"Group Lines",minimum:1,items:new at({attributes:{show_x_int:bt("Show X Intercept",!1),show_y_int:bt("Show Y Intercept",!1),show_slope:bt("Show Slope",!1),use_slope:bt("Use Slope",!0).conditionalAttributes(!0,{when_slope:new at({attributes:{x_coord_1:vt("X1",""),y_coord_1:vt("Y1",""),label_1:ct("Label",""),slope:vt("Slope","")}})}).conditionalAttributes(!1,{when_not_slope:new at({attributes:{x_coord_1:vt("X1",""),y_coord_1:vt("Y1",""),label_1:ct("Label",""),x_coord_2:vt("X2",""),y_coord_2:vt("Y2",""),label_2:ct("Label","")}})}),show_points:bt("Show Points",!0).conditionalAttributes(!0,{show_coords:bt("Show Coords",!1)})}})})}})}).conditionalAttributes(!1,{when_required:new at({attributes:{group_label:ct("Group Label",""),group_lines:new fi({name:"Group Lines",minimum:1,items:new at({attributes:{show_coords:bt("Show Coords",!1),show_x_int:bt("Show X Intercept",!1),show_y_int:bt("Show Y Intercept",!1),show_slope:bt("Show Slope",!1),use_slope:bt("Use Slope",!0).conditionalAttributes(!0,{when_slope:new at({attributes:{validation:new at({attributes:{x_coord_1:vt("X1",""),y_coord_1:vt("Y1",""),slope:vt("Slope","")}})}})}).conditionalAttributes(!1,{when_not_slope:new at({attributes:{validation:new at({attributes:{x_coord_1:vt("X1",""),y_coord_1:vt("Y1",""),x_coord_2:vt("X2",""),y_coord_2:vt("Y2","")}})}})})}})})}})})}}),Xse=new at({attributes:{color:Wo("Color"),given:bt("Given",!0).conditionalAttributes(!0,{when_given:new at({attributes:{group_curves:new fi({name:"Group Curves",minimum:1,items:new at({attributes:{curve_points:new fi({name:"Curve Points",minimum:3,maximum:6,items:new at({attributes:{x_coord:vt("X",""),y_coord:vt("Y",""),label:ct("Label","")}})}),show_points:bt("Show Points",!0).conditionalAttributes(!0,{show_coords:bt("Show Coords",!1)})}})})}})}).conditionalAttributes(!1,{when_required:new at({attributes:{group_label:ct("Group Label",""),group_curves:new fi({minimum:1,name:"Group Curves",items:new at({attributes:{show_coords:bt("Show Coords",!1),curve_points:new fi({name:"Curve Points",minimum:3,maximum:6,items:new at({attributes:{validation:new at({attributes:{x_coord:vt("X",""),y_coord:vt("Y","")}})}})})}})})}})})}}),$se=new at({attributes:{color:Wo("Color"),given:bt("Given",!0).conditionalAttributes(!0,{when_given:new at({attributes:{group_mono_arcs:new fi({name:"Group Monotonic Arcs",minimum:1,items:new at({attributes:{concavity:rK("Concavity",""),x_coord_1:vt("X1",""),y_coord_1:vt("Y1",""),label_1:ct("Label 1",""),x_coord_2:vt("X2",""),y_coord_2:vt("Y2",""),label_2:ct("Label 2",""),show_points:bt("Show Points",!0).conditionalAttributes(!0,{show_coords:bt("Show Coords",!1)})}})})}})}).conditionalAttributes(!1,{when_required:new at({attributes:{group_label:ct("Group Label",""),group_mono_arcs:new fi({minimum:1,name:"Group Monotonic Arcs",items:new at({attributes:{show_coords:bt("Show Coords",!1),concavity:rK("Concavity",""),validation:new at({attributes:{x_coord_1:vt("X1",""),y_coord_1:vt("Y1",""),x_coord_2:vt("X2",""),y_coord_2:vt("Y2","")}})}})})}})})}}),Jse=new at({attributes:{color:Wo("Color"),given:bt("Given",!0).conditionalAttributes(!0,{when_given:new at({attributes:{group_polygons:new fi({name:"Group Polygons",minimum:1,items:new at({attributes:{show_area:bt("Show Area",!1),show_perimeter:bt("Show Perimeter",!1),fill_pattern:bt("Fill Pattern",!0),polygon_points:new fi({name:"Polygon Points",minimum:3,maximum:10,items:new at({attributes:{x_coord:vt("X",""),y_coord:vt("Y",""),label:ct("Label","")}})}),show_points:bt("Show Points",!0).conditionalAttributes(!0,{show_coords:bt("Show Coords",!1)})}})})}})}).conditionalAttributes(!1,{when_required:new at({attributes:{group_label:ct("Group Label",""),group_polygons:new fi({minimum:1,name:"Group Polygons",items:new at({attributes:{show_coords:bt("Show Coords",!1),show_area:bt("Show Area",!1),show_perimeter:bt("Show Perimeter",!1),fill_pattern:bt("Fill Pattern",!0),polygon_points:new fi({name:"Polygon Points",minimum:3,maximum:10,items:new at({attributes:{validation:new at({attributes:{x_coord:vt("X",""),y_coord:vt("Y","")}})}})})}})})}})})}}),_x=new fi({name:"Common Components",items:new at({name:"Common Component",attributes:{notes:ip("Notes:","").ensureString(),object_type:Pu("Component Type","common_point",[{label:"Point",value:"common_point"},{label:"Line",value:"common_line"},{label:"Curve",value:"common_curve"},{label:"Monotonic Arc",value:"common_mono_arc"},{label:"Polygon",value:"common_polygon"}]).conditionalAttributes("common_point",{when_point:Wse}).conditionalAttributes("common_line",{when_line:jse}).conditionalAttributes("common_curve",{when_curve:Xse}).conditionalAttributes("common_mono_arc",{when_mono_arc:$se}).conditionalAttributes("common_polygon",{when_polygon:Jse})}})}),Zse=new rp({dcg_x_axis:Bf,dcg_y_axis:Kf,dcg_graph_properties:zf,dcg_common_components:_x}),Qse=new rp({dcg_x_axis:Bf,dcg_y_axis:Kf,dcg_graph_properties:zf,dcg_common_components:_x,dcg_endpoint_mover:aK}),ele=new rp({dcg_x_axis:Bf,dcg_y_axis:Kf,dcg_graph_properties:zf,dcg_common_components:_x,dcg_shifter:sK}),tle=new rp({dcg_x_axis:Bf,dcg_y_axis:Kf,dcg_graph_properties:zf,dcg_common_components:_x,dcg_cost_curves:lK}),rle=new rp({dcg_x_axis:Bf,dcg_y_axis:Kf,dcg_graph_properties:zf,dcg_common_components:_x,dcg_indifference_curves:cK}),ole=new rp({dcg_x_axis:Bf,dcg_y_axis:Kf,dcg_graph_properties:zf,dcg_input_driven_market:dK}),VEe=new rp({dcg_x_axis:Bf,dcg_y_axis:Kf,dcg_graph_properties:zf,"dcg_common_components?":_x,"dcg_endpoint_mover?":aK,"dcg_shifter?":sK,"dcg_cost_curves?":lK,"dcg_indifference_curves?":cK,"dcg_input_driven_market?":dK})});var OR=__dcg_shared_module_exports__['b'](()=>{pK()});var uK=__dcg_shared_module_exports__['b'](()=>{OR()});var hK=__dcg_shared_module_exports__['b'](()=>{uK();OR()});var qf,gK=__dcg_shared_module_exports__['b'](()=>{qf=async(r,e)=>{try{return{type:"resolved",value:await r()}}catch(t){return{type:"error",error:e?e(t):t instanceof Error?t:new Error(String(t))}}}});var mK=__dcg_shared_module_exports__['b'](()=>{});var fK,bK,yK=__dcg_shared_module_exports__['b'](()=>{fK=r=>["3d","art-contest","authenticate"].includes(r),bK=r=>["art-contest"].includes(r)});function xK(r){var o;let[e,t]=(o=ale.exec(r))!=null?o:[];return t}function RR(r){let e=xK(r);return e?sle.test(e):!0}function vK(r=window.location.href){let e=xK(r);return e?lle.test(e):!1}function AE(r,e){var i;let t="";if(e!==void 0?t=e:typeof window!="undefined"&&(t=(i=new URLSearchParams(window.location.search).get("lang"))!=null?i:""),r===""||t===""||ile.test(r)||nle.test(r)||!RR(r))return r;let o=encodeURIComponent(t);if(r.length){let n=r.split("#"),a=/\?/.test(r)?`${n[0]}&lang=${o}`:`${n[0]}?lang=${o}`;return n[1]!==void 0?`${a}#${n[1]}`:a}else return`?lang=${o}`}var ile,nle,ale,sle,lle,wK=__dcg_shared_module_exports__['b'](()=>{ile=/lang=[A-Za-z]+/,nle=/(cl|learn|help).desmos.com/,ale=/^(?:https?:)?(?:\/\/)?([^\s:\/\?]+)/i,sle=/(^desmos\.com$)|(\.desmos.com$)/,lle=/^(local|knox-pr-\d+)\.desmos\.com$/});var SK=__dcg_shared_module_exports__['b'](()=>{});var kK=__dcg_shared_module_exports__['b'](()=>{gK();mK();yK();wK();SK()});var cle,dle,rIe,_K,CK=__dcg_shared_module_exports__['b'](()=>{cle={"knox-app-config":{title:"App configuration"},calculatorBeta:{title:"Beta tester"},apStemRFI:{title:"AP Stem RFI"},artExpo:{title:"Art Expo testing"},savedGraphsRedesign:{title:"Saved graphs redesign"},newStats:{title:"New stats functionality"},desNotebook:{title:"Notebook product"}},dle={"dcg-actions":{add:!0,remove:!0}},rIe=[...Object.keys(cle),...Object.keys(dle)],_K=["newStats"]});var TK=__dcg_shared_module_exports__['b'](()=>{});var EK=__dcg_shared_module_exports__['b'](()=>{});var IK=__dcg_shared_module_exports__['b'](()=>{});var MK=__dcg_shared_module_exports__['b'](()=>{});var DK=__dcg_shared_module_exports__['b'](()=>{});var AK=__dcg_shared_module_exports__['b'](()=>{});var LK=__dcg_shared_module_exports__['b'](()=>{});var PK=__dcg_shared_module_exports__['b'](()=>{});var GK=__dcg_shared_module_exports__['b'](()=>{});var VK=__dcg_shared_module_exports__['b'](()=>{});var OK=__dcg_shared_module_exports__['b'](()=>{CK();TK();EK();IK();MK();DK();AK();LK();PK();GK();VK()});var Cx,RK=__dcg_shared_module_exports__['b'](()=>{Cx=()=>{}});var FK,Tx,yIe,NK=__dcg_shared_module_exports__['b'](()=>{EE();FK=j8.replace(/\./g,"_"),Tx=`dcg-calculator-api-container-${FK}`,yIe=`dcg-matrix-api-container-${FK}`});var jo=__dcg_shared_module_exports__['b'](()=>{eK();EE();hK();kK();OK();RK();NK()});function RE(r){return r==null?r+"":typeof r=="object"||typeof r=="function"?OE[JK.call(r)]||"object":typeof r}function FR(r){var e=!!r&&"length"in r&&r.length,t=RE(r);return Ru(r)||Ax(r)?!1:t==="array"||e===0||typeof e=="number"&&e>0&&e-1 in r}function Ex(r,e){return r.nodeName&&r.nodeName.toLowerCase()===e.toLowerCase()}function xle(r,e){return e.toUpperCase()}function Gu(r){return r.replace(ble,"ms-").replace(yle,xle)}function s0(){this.expando=me.expando+s0.uid++}function Sle(r){return r==="true"?!0:r==="false"?!1:r==="null"?null:r===+r+""?+r:vle.test(r)?JSON.parse(r):r}function UK(r,e,t){var o;if(t===void 0&&r.nodeType===1)if(o="data-"+e.replace(wle,"-$&").toLowerCase(),t=r.getAttribute(o),typeof t=="string"){try{t=Sle(t)}catch(i){}Vu.set(r,e,t)}else t=void 0;return t}function _le(r,e,t,o){var i,n,a=20,s=o?function(){return o.cur()}:function(){return me.css(r,e,"")},c=s(),d=t&&t[3]||(me.cssNumber[e]?"":"px"),p=r.nodeType&&(me.cssNumber[e]||d!=="px"&&+c)&&FE.exec(me.css(r,e));if(p&&p[3]!==d){for(c=c/2,d=d||p[3],p=+c||1;a--;)me.style(r,e,p+d),(1-n)*(1-(n=s()/c||.5))<=0&&(a=0),p=p/n;p=p*2,me.style(r,e,p+d),t=t||[]}return t&&(p=+p||+c||0,i=t[1]?p+(t[1]+1)*t[2]:+t[2],o&&(o.unit=d,o.start=p,o.end=i)),i}function Mx(){return!0}function Dx(){return!1}function Cle(r,e){return r===Tle()==(e==="focus")}function Tle(){try{return _n.activeElement}catch(r){}}function YR(r,e,t,o,i,n){var a,s;if(typeof e=="object"){typeof t!="string"&&(o=o||t,t=void 0);for(s in e)YR(r,s,t,o,e[s],n);return r}if(o==null&&i==null?(i=t,o=t=void 0):i==null&&(typeof t=="string"?(i=o,o=void 0):(i=o,o=t,t=void 0)),i===!1)i=Dx;else if(!i)return r;return n===1&&(a=i,i=function(c){return me().off(c),a.apply(this,arguments)},i.guid=a.guid||(a.guid=me.guid++)),r.each(function(){me.event.add(this,e,i,o,t)})}function VE(r,e,t){if(!t){Xo.get(r,e)===void 0&&me.event.add(r,e,Mx);return}Xo.set(r,e,!1),me.event.add(r,e,{namespace:!1,handler:function(o){var i,n,a=Xo.get(this,e);if(o.isTrigger&1&&this[e]){if(a.length)(me.event.special[e]||{}).delegateType&&o.stopPropagation();else if(a=LE.call(arguments),Xo.set(this,e,a),i=t(this,e),this[e](),n=Xo.get(this,e),a!==n||i?Xo.set(this,e,!1):n={},a!==n)return o.stopImmediatePropagation(),o.preventDefault(),n&&n.value}else a.length&&(Xo.set(this,e,{value:me.event.trigger(me.extend(a[0],me.Event.prototype),a.slice(1),this)}),o.stopImmediatePropagation())}})}function n0(r,e,t){var o,i,n,a,s=r.style;return t=t||NE(r),t&&(a=t.getPropertyValue(e)||t[e],a===""&&!rz(r)&&(a=me.style(r,e)),!Cn.pixelBoxStyles()&&zR.test(a)&&Ele.test(e)&&(o=s.width,i=s.minWidth,n=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=t.width,s.width=o,s.minWidth=i,s.maxWidth=n)),a!==void 0?a+"":a}function iz(r,e){return{get:function(){if(r()){delete this.get;return}return(this.get=e).apply(this,arguments)}}}function Ile(r){for(var e=r[0].toUpperCase()+r.slice(1),t=BK.length;t--;)if(r=BK[t]+e,r in nz)return r}function zK(r){var e=me.cssProps[r]||KK[r];return e||(r in nz?r:KK[r]=Ile(r)||r)}function az(r,e,t){var o=FE.exec(e);return o?Math.max(0,o[2]-(t||0))+(o[3]||"px"):e}function BR(r,e,t,o,i,n){var a=e==="width"?1:0,s=0,c=0;if(t===(o?"border":"content"))return 0;for(;a<4;a+=2)t==="margin"&&(c+=me.css(r,t+mg[a],!0,i)),o?(t==="content"&&(c-=me.css(r,"padding"+mg[a],!0,i)),t!=="margin"&&(c-=me.css(r,"border"+mg[a]+"Width",!0,i))):(c+=me.css(r,"padding"+mg[a],!0,i),t!=="padding"?c+=me.css(r,"border"+mg[a]+"Width",!0,i):s+=me.css(r,"border"+mg[a]+"Width",!0,i));return!o&&n>=0&&(c+=Math.max(0,Math.ceil(r["offset"+e[0].toUpperCase()+e.slice(1)]-n-c-s-.5))||0),c}function WK(r,e,t){var o=NE(r),i=!Cn.boxSizingReliable()||t,n=i&&me.css(r,"boxSizing",!1,o)==="border-box",a=n,s=n0(r,e,o),c="offset"+e[0].toUpperCase()+e.slice(1);if(zR.test(s)){if(!t)return s;s="auto"}return(!Cn.boxSizingReliable()&&n||!Cn.reliableTrDimensions()&&Ex(r,"tr")||s==="auto"||!parseFloat(s)&&me.css(r,"display",!1,o)==="inline")&&r.getClientRects().length&&(n=me.css(r,"boxSizing",!1,o)==="border-box",a=c in r,a&&(s=r[c])),s=parseFloat(s)||0,s+BR(r,e,t||(n?"border":"content"),a,o,s)+"px"}function KR(r,e,t,o){var i;if(Array.isArray(e))me.each(e,function(n,a){t||Ale.test(r)?o(r,a):KR(r+"["+(typeof a=="object"&&a!=null?n:"")+"]",a,t,o)});else if(!t&&RE(e)==="object")for(i in e)KR(r+"["+i+"]",e[i],t,o);else o(r,e)}var Ou,ple,LE,ule,$K,hle,OE,JK,PE,ZK,gle,Cn,Ru,Ax,_n,QK,me,mle,ez,fle,UR,a0,ble,yle,GE,Xo,Vu,vle,wle,tz,FE,mg,Ix,rz,kle,NR,YK,zR,NE,oz,Ele,BK,nz,KK,Mle,qK,Dle,HK,jK,XK,Ale,Lle,Ple,Gle,re,Ut=__dcg_shared_module_exports__['b'](()=>{"use strict";Ou=[],ple=Object.getPrototypeOf,LE=Ou.slice,ule=Ou.flat?function(r){return Ou.flat.call(r)}:function(r){return Ou.concat.apply([],r)},$K=Ou.push,hle=Ou.indexOf,OE={},JK=OE.toString,PE=OE.hasOwnProperty,ZK=PE.toString,gle=ZK.call(Object),Cn={},Ru=function(e){return typeof e=="function"&&typeof e.nodeType!="number"&&typeof e.item!="function"},Ax=function(e){return e!=null&&e===e.window},_n=window.document;QK="3.6.0",me=function(r,e){return new me.fn.init(r,e)};me.fn=me.prototype={jquery:QK,constructor:me,length:0,toArray:function(){return LE.call(this)},get:function(r){return r==null?LE.call(this):r<0?this[r+this.length]:this[r]},pushStack:function(r){var e=me.merge(this.constructor(),r);return e.prevObject=this,e},each:function(r){return me.each(this,r)},map:function(r){return this.pushStack(me.map(this,function(e,t){return r.call(e,t,e)}))},slice:function(){return this.pushStack(LE.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(me.grep(this,function(r,e){return(e+1)%2}))},odd:function(){return this.pushStack(me.grep(this,function(r,e){return e%2}))},eq:function(r){var e=this.length,t=+r+(r<0?e:0);return this.pushStack(t>=0&&t<e?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:$K,sort:Ou.sort,splice:Ou.splice};me.extend=me.fn.extend=function(){var r,e,t,o,i,n,a=arguments[0]||{},s=1,c=arguments.length,d=!1;for(typeof a=="boolean"&&(d=a,a=arguments[s]||{},s++),typeof a!="object"&&!Ru(a)&&(a={}),s===c&&(a=this,s--);s<c;s++)if((r=arguments[s])!=null)for(e in r)o=r[e],!(e==="__proto__"||a===o)&&(d&&o&&(me.isPlainObject(o)||(i=Array.isArray(o)))?(t=a[e],i&&!Array.isArray(t)?n=[]:!i&&!me.isPlainObject(t)?n={}:n=t,i=!1,a[e]=me.extend(d,n,o)):o!==void 0&&(a[e]=o));return a};me.extend({expando:"jQuery"+(QK+Math.random()).replace(/\D/g,""),isReady:!0,error:function(r){throw new Error(r)},noop:function(){},isPlainObject:function(r){var e,t;return!r||JK.call(r)!=="[object Object]"?!1:(e=ple(r),e?(t=PE.call(e,"constructor")&&e.constructor,typeof t=="function"&&ZK.call(t)===gle):!0)},isEmptyObject:function(r){var e;for(e in r)return!1;return!0},each:function(r,e){var t,o=0;if(FR(r))for(t=r.length;o<t&&e.call(r[o],o,r[o])!==!1;o++);else for(o in r)if(e.call(r[o],o,r[o])===!1)break;return r},makeArray:function(r,e){var t=e||[];return r!=null&&(FR(Object(r))?me.merge(t,typeof r=="string"?[r]:r):$K.call(t,r)),t},inArray:function(r,e,t){return e==null?-1:hle.call(e,r,t)},merge:function(r,e){for(var t=+e.length,o=0,i=r.length;o<t;o++)r[i++]=e[o];return r.length=i,r},grep:function(r,e,t){for(var o,i=[],n=0,a=r.length,s=!t;n<a;n++)o=!e(r[n],n),o!==s&&i.push(r[n]);return i},map:function(r,e,t){var o,i,n=0,a=[];if(FR(r))for(o=r.length;n<o;n++)i=e(r[n],n,t),i!=null&&a.push(i);else for(n in r)i=e(r[n],n,t),i!=null&&a.push(i);return ule(a)},guid:1,support:Cn});typeof Symbol=="function"&&(me.fn[Symbol.iterator]=Ou[Symbol.iterator]);me.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(r,e){OE["[object "+e+"]"]=e.toLowerCase()});mle=function(r){var e,t,o,i,n,a,s,c=r.document,d=[],p=d.push,u=d.push,g=d.slice,h=/HTML$/i,b=/^[^{]+\{\s*\[native \w/,v=function(){o()};try{u.apply(d=g.call(c.childNodes),c.childNodes),d[c.childNodes.length].nodeType}catch(I){u={apply:d.length?function(_,C){p.apply(_,g.call(C))}:function(_,C){for(var D=_.length,P=0;_[D++]=C[P++];);_.length=D-1}}}function T(){}function E(I){var _=i.createElement("fieldset");try{return!!I(_)}catch(C){return!1}finally{_.parentNode&&_.parentNode.removeChild(_),_=null}}return e=T.support={},t=T.isXML=function(I){var _=I&&I.namespaceURI,C=I&&(I.ownerDocument||I).documentElement;return!h.test(_||C&&C.nodeName||"HTML")},o=T.setDocument=function(I){var _,C,D=I?I.ownerDocument||I:c;return D==i||D.nodeType!==9||!D.documentElement||(i=D,n=i.documentElement,a=!t(i),c!=i&&(C=i.defaultView)&&C.top!==C&&(C.addEventListener?C.addEventListener("unload",v,!1):C.attachEvent&&C.attachEvent("onunload",v)),e.attributes=E(function(P){return P.className="i",!P.getAttribute("className")}),e.getElementsByTagName=E(function(P){return P.appendChild(i.createComment("")),!P.getElementsByTagName("*").length}),_=b.test(n.compareDocumentPosition),s=_||b.test(n.contains)?function(P,F){var N=P.nodeType===9?P.documentElement:P,Y=F&&F.parentNode;return P===Y||!!(Y&&Y.nodeType===1&&(N.contains?N.contains(Y):P.compareDocumentPosition&&P.compareDocumentPosition(Y)&16))}:function(P,F){if(F){for(;F=F.parentNode;)if(F===P)return!0}return!1}),i},T.contains=function(I,_){return(I.ownerDocument||I)!=i&&o(I),s(I,_)},o(),e.sortDetached=E(function(I){return I.compareDocumentPosition(i.createElement("fieldset"))&1}),T}(window);me.contains=mle.contains;fle=me.fn.init=function(r,e,t){if(!r)return this;if(t=t||ez,typeof r=="string")throw new Error("$(string) implementation has been removed");if(r.nodeType)return this[0]=r,this.length=1,this;if(Ru(r))throw new Error("$(function) implementation has been removed");return me.makeArray(r,this)};fle.prototype=me.fn;ez=me(_n);UR=/[^\x20\t\r\n\f]+/g,a0=function(r,e,t,o,i,n,a){var s=0,c=r.length,d=t==null;if(RE(t)==="object"){i=!0;for(s in t)a0(r,e,s,t[s],!0,n,a)}else if(o!==void 0&&(i=!0,Ru(o)||(a=!0),d&&(a?(e.call(r,o),e=null):(d=e,e=function(p,u,g){return d.call(me(p),g)})),e))for(;s<c;s++)e(r[s],t,a?o:o.call(r[s],s,e(r[s],t)));return i?r:d?e.call(r):c?e(r[0],t):n},ble=/^-ms-/,yle=/-([a-z])/g;GE=function(r){return r.nodeType===1||r.nodeType===9||!+r.nodeType};s0.uid=1;s0.prototype={cache:function(r){var e=r[this.expando];return e||(e={},GE(r)&&(r.nodeType?r[this.expando]=e:Object.defineProperty(r,this.expando,{value:e,configurable:!0}))),e},set:function(r,e,t){var o,i=this.cache(r);if(typeof e=="string")i[Gu(e)]=t;else for(o in e)i[Gu(o)]=e[o];return i},get:function(r,e){return e===void 0?this.cache(r):r[this.expando]&&r[this.expando][Gu(e)]},access:function(r,e,t){return e===void 0||e&&typeof e=="string"&&t===void 0?this.get(r,e):(this.set(r,e,t),t!==void 0?t:e)},remove:function(r,e){var t,o=r[this.expando];if(o!==void 0){if(e!==void 0)for(Array.isArray(e)?e=e.map(Gu):(e=Gu(e),e=e in o?[e]:e.match(UR)||[]),t=e.length;t--;)delete o[e[t]];(e===void 0||me.isEmptyObject(o))&&(r.nodeType?r[this.expando]=void 0:delete r[this.expando])}},hasData:function(r){var e=r[this.expando];return e!==void 0&&!me.isEmptyObject(e)}};Xo=new s0,Vu=new s0,vle=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,wle=/[A-Z]/g;me.extend({hasData:function(r){return Vu.hasData(r)||Xo.hasData(r)},data:function(r,e,t){return Vu.access(r,e,t)},removeData:function(r,e){Vu.remove(r,e)},_data:function(r,e,t){return Xo.access(r,e,t)},_removeData:function(r,e){Xo.remove(r,e)}});me.fn.extend({data:function(r,e){var t,o,i,n=this[0],a=n&&n.attributes;if(r===void 0){if(this.length&&(i=Vu.get(n),n.nodeType===1&&!Xo.get(n,"hasDataAttrs"))){for(t=a.length;t--;)a[t]&&(o=a[t].name,o.indexOf("data-")===0&&(o=Gu(o.slice(5)),UK(n,o,i[o])));Xo.set(n,"hasDataAttrs",!0)}return i}return typeof r=="object"?this.each(function(){Vu.set(this,r)}):a0(this,function(s){var c;if(n&&s===void 0)return c=Vu.get(n,r),c!==void 0||(c=UK(n,r),c!==void 0)?c:void 0;this.each(function(){Vu.set(this,r,s)})},null,e,arguments.length>1,null,!0)},removeData:function(r){return this.each(function(){Vu.remove(this,r)})}});tz=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,FE=new RegExp("^(?:([+-])=|)("+tz+")([a-z%]*)$","i"),mg=["Top","Right","Bottom","Left"],Ix=_n.documentElement,rz=function(r){return me.contains(r.ownerDocument,r)},kle={composed:!0};Ix.getRootNode&&(rz=function(r){return me.contains(r.ownerDocument,r)||r.getRootNode(kle)===r.ownerDocument});NR=/^(?:checkbox|radio)$/i;(function(){var r=_n.createDocumentFragment(),e=r.appendChild(_n.createElement("div")),t=_n.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),Cn.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",Cn.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,e.innerHTML="<option></option>",Cn.option=!!e.lastChild})();YK=/^([^.]*)(?:\.(.+)|)/;me.event={global:{},add:function(r,e,t,o,i){var n,a,s,c,d,p,u,g,h,b,v,T=Xo.get(r);if(GE(r)){if(t.handler&&(n=t,t=n.handler,i=n.selector),i)throw new Error("Support for event delegation has been removed");for(t.guid||(t.guid=me.guid++),(c=T.events)||(c=T.events=Object.create(null)),(a=T.handle)||(a=T.handle=function(E){return typeof me!="undefined"&&me.event.triggered!==E.type?me.event.dispatch.apply(r,arguments):void 0}),e=(e||"").match(UR)||[""],d=e.length;d--;)if(s=YK.exec(e[d])||[],h=v=s[1],b=(s[2]||"").split(".").sort(),!!h){if(u=me.event.special[h]||{},h=(i?u.delegateType:u.bindType)||h,u=me.event.special[h]||{},p=me.extend({type:h,origType:v,data:o,handler:t,guid:t.guid,selector:i,namespace:b.join(".")},n),(g=c[h])||(g=c[h]=[],g.delegateCount=0,(!u.setup||u.setup.call(r,o,b,a)===!1)&&r.addEventListener&&r.addEventListener(h,a)),u.add&&(u.add.call(r,p),p.handler.guid||(p.handler.guid=t.guid)),i)throw new Error("Support for event delegation has been removed");g.push(p),me.event.global[h]=!0}}},remove:function(r,e,t,o,i){var n,a,s,c,d,p,u,g,h,b,v,T=Xo.hasData(r)&&Xo.get(r);if(!(!T||!(c=T.events))){for(e=(e||"").match(UR)||[""],d=e.length;d--;){if(s=YK.exec(e[d])||[],h=v=s[1],b=(s[2]||"").split(".").sort(),!h){for(h in c)me.event.remove(r,h+e[d],t,o,!0);continue}for(u=me.event.special[h]||{},h=(o?u.delegateType:u.bindType)||h,g=c[h]||[],s=s[2]&&new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=n=g.length;n--;)p=g[n],(i||v===p.origType)&&(!t||t.guid===p.guid)&&(!s||s.test(p.namespace))&&(!o||o===p.selector||o==="**"&&p.selector)&&(g.splice(n,1),p.selector&&g.delegateCount--,u.remove&&u.remove.call(r,p));a&&!g.length&&((!u.teardown||u.teardown.call(r,b,T.handle)===!1)&&me.removeEvent(r,h,T.handle),delete c[h])}me.isEmptyObject(c)&&Xo.remove(r,"handle events")}},dispatch:function(r){var e,t,o,i,n,a,s=new Array(arguments.length),c=me.event.fix(r),d=(Xo.get(this,"events")||Object.create(null))[c.type]||[],p=me.event.special[c.type]||{};for(s[0]=c,e=1;e<arguments.length;e++)s[e]=arguments[e];if(c.delegateTarget=this,!(p.preDispatch&&p.preDispatch.call(this,c)===!1)){for(a=me.event.handlers.call(this,c,d),e=0;(i=a[e++])&&!c.isPropagationStopped();)for(c.currentTarget=i.elem,t=0;(n=i.handlers[t++])&&!c.isImmediatePropagationStopped();)(!c.rnamespace||n.namespace===!1||c.rnamespace.test(n.namespace))&&(c.handleObj=n,c.data=n.data,o=((me.event.special[n.origType]||{}).handle||n.handler).apply(i.elem,s),o!==void 0&&(c.result=o)===!1&&(c.preventDefault(),c.stopPropagation()));return p.postDispatch&&p.postDispatch.call(this,c),c.result}},handlers:function(r,e){var t=[],o=e.delegateCount,i=r.target;if(o)throw new Error("Support for event delegtaion has been removed");return i=this,o<e.length&&t.push({elem:i,handlers:e.slice(o)}),t},addProp:function(r,e){Object.defineProperty(me.Event.prototype,r,{enumerable:!0,configurable:!0,get:Ru(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[r]},set:function(t){Object.defineProperty(this,r,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(r){return r[me.expando]?r:new me.Event(r)},special:{load:{noBubble:!0},click:{setup:function(r){var e=this||r;return NR.test(e.type)&&e.click&&Ex(e,"input")&&VE(e,"click",Mx),!1},trigger:function(r){var e=this||r;return NR.test(e.type)&&e.click&&Ex(e,"input")&&VE(e,"click"),!0},_default:function(r){var e=r.target;return NR.test(e.type)&&e.click&&Ex(e,"input")&&Xo.get(e,"click")||Ex(e,"a")}},beforeunload:{postDispatch:function(r){r.result!==void 0&&r.originalEvent&&(r.originalEvent.returnValue=r.result)}}}};me.removeEvent=function(r,e,t){r.removeEventListener&&r.removeEventListener(e,t)};me.Event=function(r,e){if(!(this instanceof me.Event))return new me.Event(r,e);r&&r.type?(this.originalEvent=r,this.type=r.type,this.isDefaultPrevented=r.defaultPrevented||r.defaultPrevented===void 0&&r.returnValue===!1?Mx:Dx,this.target=r.target&&r.target.nodeType===3?r.target.parentNode:r.target,this.currentTarget=r.currentTarget,this.relatedTarget=r.relatedTarget):this.type=r,e&&me.extend(this,e),this.timeStamp=r&&r.timeStamp||Date.now(),this[me.expando]=!0};me.Event.prototype={constructor:me.Event,isDefaultPrevented:Dx,isPropagationStopped:Dx,isImmediatePropagationStopped:Dx,isSimulated:!1,preventDefault:function(){var r=this.originalEvent;this.isDefaultPrevented=Mx,r&&!this.isSimulated&&r.preventDefault()},stopPropagation:function(){var r=this.originalEvent;this.isPropagationStopped=Mx,r&&!this.isSimulated&&r.stopPropagation()},stopImmediatePropagation:function(){var r=this.originalEvent;this.isImmediatePropagationStopped=Mx,r&&!this.isSimulated&&r.stopImmediatePropagation(),this.stopPropagation()}};me.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},me.event.addProp);me.each({focus:"focusin",blur:"focusout"},function(r,e){me.event.special[r]={setup:function(){return VE(this,r,Cle),!1},trigger:function(){return VE(this,r),!0},_default:function(){return!0},delegateType:e}});me.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(r,e){me.event.special[r]={delegateType:e,bindType:e,handle:function(t){var o,i=this,n=t.relatedTarget,a=t.handleObj;return(!n||n!==i&&!me.contains(i,n))&&(t.type=a.origType,o=a.handler.apply(this,arguments),t.type=e),o}}});me.fn.extend({on:function(r,e,t,o){return YR(this,r,e,t,o)},one:function(r,e,t,o){return YR(this,r,e,t,o,1)},off:function(r,e,t){var o,i;if(r&&r.preventDefault&&r.handleObj)return o=r.handleObj,me(r.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this;if(typeof r=="object"){for(i in r)this.off(i,e,r[i]);return this}return(e===!1||typeof e=="function")&&(t=e,e=void 0),t===!1&&(t=Dx),this.each(function(){me.event.remove(this,r,t,e)})}});zR=new RegExp("^("+tz+")(?!px)[a-z%]+$","i"),NE=function(r){var e=r.ownerDocument.defaultView;return(!e||!e.opener)&&(e=window),e.getComputedStyle(r)},oz=function(r,e,t){var o,i,n={};for(i in e)n[i]=r.style[i],r.style[i]=e[i];o=t.call(r);for(i in e)r.style[i]=n[i];return o},Ele=new RegExp(mg.join("|"),"i");(function(){function r(){if(d){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",d.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Ix.appendChild(c).appendChild(d);var p=window.getComputedStyle(d);t=p.top!=="1%",s=e(p.marginLeft)===12,d.style.right="60%",n=e(p.right)===36,o=e(p.width)===36,d.style.position="absolute",i=e(d.offsetWidth/3)===12,Ix.removeChild(c),d=null}}function e(p){return Math.round(parseFloat(p))}var t,o,i,n,a,s,c=_n.createElement("div"),d=_n.createElement("div");d.style&&(d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",Cn.clearCloneStyle=d.style.backgroundClip==="content-box",me.extend(Cn,{boxSizingReliable:function(){return r(),o},pixelBoxStyles:function(){return r(),n},pixelPosition:function(){return r(),t},reliableMarginLeft:function(){return r(),s},scrollboxSize:function(){return r(),i},reliableTrDimensions:function(){var p,u,g,h;return a==null&&(p=_n.createElement("table"),u=_n.createElement("tr"),g=_n.createElement("div"),p.style.cssText="position:absolute;left:-11111px;border-collapse:separate",u.style.cssText="border:1px solid",u.style.height="1px",g.style.height="9px",g.style.display="block",Ix.appendChild(p).appendChild(u).appendChild(g),h=window.getComputedStyle(u),a=parseInt(h.height,10)+parseInt(h.borderTopWidth,10)+parseInt(h.borderBottomWidth,10)===u.offsetHeight,Ix.removeChild(p)),a}}))})();BK=["Webkit","Moz","ms"],nz=_n.createElement("div").style,KK={};Mle=/^(none|table(?!-c[ea]).+)/,qK=/^--/,Dle={position:"absolute",visibility:"hidden",display:"block"},HK={letterSpacing:"0",fontWeight:"400"};me.extend({cssHooks:{opacity:{get:function(r,e){if(e){var t=n0(r,"opacity");return t===""?"1":t}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(r,e,t,o){if(!(!r||r.nodeType===3||r.nodeType===8||!r.style)){var i,n,a,s=Gu(e),c=qK.test(e),d=r.style;if(c||(e=zK(s)),a=me.cssHooks[e]||me.cssHooks[s],t!==void 0){if(n=typeof t,n==="string"&&(i=FE.exec(t))&&i[1]&&(t=_le(r,e,i),n="number"),t==null||t!==t)return;n==="number"&&!c&&(t+=i&&i[3]||(me.cssNumber[s]?"":"px")),!Cn.clearCloneStyle&&t===""&&e.indexOf("background")===0&&(d[e]="inherit"),(!a||!("set"in a)||(t=a.set(r,t,o))!==void 0)&&(c?d.setProperty(e,t):d[e]=t)}else return a&&"get"in a&&(i=a.get(r,!1,o))!==void 0?i:d[e]}},css:function(r,e,t,o){var i,n,a,s=Gu(e),c=qK.test(e);return c||(e=zK(s)),a=me.cssHooks[e]||me.cssHooks[s],a&&"get"in a&&(i=a.get(r,!0,t)),i===void 0&&(i=n0(r,e,o)),i==="normal"&&e in HK&&(i=HK[e]),t===""||t?(n=parseFloat(i),t===!0||isFinite(n)?n||0:i):i}});me.each(["height","width"],function(r,e){me.cssHooks[e]={get:function(t,o,i){if(o)return Mle.test(me.css(t,"display"))&&(!t.getClientRects().length||!t.getBoundingClientRect().width)?oz(t,Dle,function(){return WK(t,e,i)}):WK(t,e,i)},set:function(t,o,i){var n,a=NE(t),s=!Cn.scrollboxSize()&&a.position==="absolute",c=s||i,d=c&&me.css(t,"boxSizing",!1,a)==="border-box",p=i?BR(t,e,i,d,a):0;return d&&s&&(p-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(a[e])-BR(t,e,"border",!1,a)-.5)),p&&(n=FE.exec(o))&&(n[3]||"px")!=="px"&&(t.style[e]=o,o=me.css(t,e)),az(t,o,p)}}});me.cssHooks.marginLeft=iz(Cn.reliableMarginLeft,function(r,e){if(e)return(parseFloat(n0(r,"marginLeft"))||r.getBoundingClientRect().left-oz(r,{marginLeft:0},function(){return r.getBoundingClientRect().left}))+"px"});me.each({margin:"",padding:"",border:"Width"},function(r,e){me.cssHooks[r+e]={expand:function(t){for(var o=0,i={},n=typeof t=="string"?t.split(" "):[t];o<4;o++)i[r+mg[o]+e]=n[o]||n[o-2]||n[0];return i}},r!=="margin"&&(me.cssHooks[r+e].set=az)});me.fn.extend({css:function(r,e){return a0(this,function(t,o,i){var n,a,s={},c=0;if(Array.isArray(o)){for(n=NE(t),a=o.length;c<a;c++)s[o[c]]=me.css(t,o[c],!1,n);return s}return i!==void 0?me.style(t,o,i):me.css(t,o)},r,e,arguments.length>1)}});(function(){var r=_n.createElement("input"),e=_n.createElement("select"),t=e.appendChild(_n.createElement("option"));r.type="checkbox",Cn.checkOn=r.value!=="",Cn.optSelected=t.selected,r=_n.createElement("input"),r.value="t",r.type="radio",Cn.radioValue=r.value==="t"})();Cn.focusin="onfocusin"in window;jK=/^(?:focusinfocus|focusoutblur)$/,XK=function(r){r.stopPropagation()};me.extend(me.event,{trigger:function(r,e,t,o){var i,n,a,s,c,d,p,u,g=[t||_n],h=PE.call(r,"type")?r.type:r,b=PE.call(r,"namespace")?r.namespace.split("."):[];if(n=u=a=t=t||_n,!(t.nodeType===3||t.nodeType===8)&&!jK.test(h+me.event.triggered)&&(h.indexOf(".")>-1&&(b=h.split("."),h=b.shift(),b.sort()),c=h.indexOf(":")<0&&"on"+h,r=r[me.expando]?r:new me.Event(h,typeof r=="object"&&r),r.isTrigger=o?2:3,r.namespace=b.join("."),r.rnamespace=r.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,r.result=void 0,r.target||(r.target=t),e=e==null?[r]:me.makeArray(e,[r]),p=me.event.special[h]||{},!(!o&&p.trigger&&p.trigger.apply(t,e)===!1))){if(!o&&!p.noBubble&&!Ax(t)){for(s=p.delegateType||h,jK.test(s+h)||(n=n.parentNode);n;n=n.parentNode)g.push(n),a=n;a===(t.ownerDocument||_n)&&g.push(a.defaultView||a.parentWindow||window)}for(i=0;(n=g[i++])&&!r.isPropagationStopped();)u=n,r.type=i>1?s:p.bindType||h,d=(Xo.get(n,"events")||Object.create(null))[r.type]&&Xo.get(n,"handle"),d&&d.apply(n,e),d=c&&n[c],d&&d.apply&&GE(n)&&(r.result=d.apply(n,e),r.result===!1&&r.preventDefault());return r.type=h,!o&&!r.isDefaultPrevented()&&(!p._default||p._default.apply(g.pop(),e)===!1)&&GE(t)&&c&&Ru(t[h])&&!Ax(t)&&(a=t[c],a&&(t[c]=null),me.event.triggered=h,r.isPropagationStopped()&&u.addEventListener(h,XK),t[h](),r.isPropagationStopped()&&u.removeEventListener(h,XK),me.event.triggered=void 0,a&&(t[c]=a)),r.result}},simulate:function(r,e,t){var o=me.extend(new me.Event,t,{type:r,isSimulated:!0});me.event.trigger(o,null,e)}});me.fn.extend({trigger:function(r,e){return this.each(function(){me.event.trigger(r,e,this)})},triggerHandler:function(r,e){var t=this[0];if(t)return me.event.trigger(r,e,t,!0)}});Cn.focusin||me.each({focus:"focusin",blur:"focusout"},function(r,e){var t=function(o){me.event.simulate(e,o.target,me.event.fix(o))};me.event.special[e]={setup:function(){var o=this.ownerDocument||this.document||this,i=Xo.access(o,e);i||o.addEventListener(r,t,!0),Xo.access(o,e,(i||0)+1)},teardown:function(){var o=this.ownerDocument||this.document||this,i=Xo.access(o,e)-1;i?Xo.access(o,e,i):(o.removeEventListener(r,t,!0),Xo.remove(o,e))}}});Ale=/\[\]$/;me.param=function(r,e){var t,o=[],i=function(n,a){var s=Ru(a)?a():a;o[o.length]=encodeURIComponent(n)+"="+encodeURIComponent(s==null?"":s)};if(r==null)return"";if(Array.isArray(r)||r.jquery&&!me.isPlainObject(r))me.each(r,function(){i(this.name,this.value)});else for(t in r)KR(t,r[t],e,i);return o.join("&")};me.offset={setOffset:function(r,e,t){var o,i,n,a,s,c,d,p=me.css(r,"position"),u=me(r),g={};p==="static"&&(r.style.position="relative"),s=u.offset(),n=me.css(r,"top"),c=me.css(r,"left"),d=(p==="absolute"||p==="fixed")&&(n+c).indexOf("auto")>-1,d?(o=u.position(),a=o.top,i=o.left):(a=parseFloat(n)||0,i=parseFloat(c)||0),Ru(e)&&(e=e.call(r,t,me.extend({},s))),e.top!=null&&(g.top=e.top-s.top+a),e.left!=null&&(g.left=e.left-s.left+i),"using"in e?e.using.call(r,g):u.css(g)}};me.fn.extend({offset:function(r){if(arguments.length)return r===void 0?this:this.each(function(i){me.offset.setOffset(this,r,i)});var e,t,o=this[0];if(o)return o.getClientRects().length?(e=o.getBoundingClientRect(),t=o.ownerDocument.defaultView,{top:e.top+t.pageYOffset,left:e.left+t.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var r,e,t,o=this[0],i={top:0,left:0};if(me.css(o,"position")==="fixed")e=o.getBoundingClientRect();else{for(e=this.offset(),t=o.ownerDocument,r=o.offsetParent||t.documentElement;r&&(r===t.body||r===t.documentElement)&&me.css(r,"position")==="static";)r=r.parentNode;r&&r!==o&&r.nodeType===1&&(i=me(r).offset(),i.top+=me.css(r,"borderTopWidth",!0),i.left+=me.css(r,"borderLeftWidth",!0))}return{top:e.top-i.top-me.css(o,"marginTop",!0),left:e.left-i.left-me.css(o,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var r=this.offsetParent;r&&me.css(r,"position")==="static";)r=r.offsetParent;return r||Ix})}});me.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(r,e){var t=e==="pageYOffset";me.fn[r]=function(o){return a0(this,function(i,n,a){var s;if(Ax(i)?s=i:i.nodeType===9&&(s=i.defaultView),a===void 0)return s?s[e]:i[n];s?s.scrollTo(t?s.pageXOffset:a,t?a:s.pageYOffset):i[n]=a},r,o,arguments.length)}});me.each(["top","left"],function(r,e){me.cssHooks[e]=iz(Cn.pixelPosition,function(t,o){if(o)return o=n0(t,e),zR.test(o)?me(t).position()[e]+"px":o})});me.each({Height:"height",Width:"width"},function(r,e){me.each({padding:"inner"+r,content:e,"":"outer"+r},function(t,o){me.fn[o]=function(i,n){var a=arguments.length&&(t||typeof i!="boolean"),s=t||(i===!0||n===!0?"margin":"border");return a0(this,function(c,d,p){var u;return Ax(c)?o.indexOf("outer")===0?c["inner"+r]:c.document.documentElement["client"+r]:c.nodeType===9?(u=c.documentElement,Math.max(c.body["scroll"+r],u["scroll"+r],c.body["offset"+r],u["offset"+r],u["client"+r])):p===void 0?me.css(c,d,s):me.style(c,d,p,s)},e,a?i:void 0,a)}})});me.fn.extend({bind:function(r,e,t){return this.on(r,null,e,t)},unbind:function(r,e){return this.off(r,null,e)},delegate:function(r,e,t,o){return this.on(e,r,t,o)},undelegate:function(r,e,t){return arguments.length===1?this.off(r,"**"):this.off(e,r||"**",t)},hover:function(r,e){return this.mouseenter(r).mouseleave(e||r)}});me.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(r,e){me.fn[e]=function(t,o){return arguments.length>0?this.on(e,null,t,o):this.trigger(e)}});Lle=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;me.isArray=Array.isArray;me.parseJSON=JSON.parse;me.nodeName=Ex;me.isFunction=Ru;me.isWindow=Ax;me.camelCase=Gu;me.type=RE;me.now=Date.now;me.isNumeric=function(r){var e=me.type(r);return(e==="number"||e==="string")&&!isNaN(r-parseFloat(r))};me.trim=function(r){return r==null?"":(r+"").replace(Lle,"")};Ple=window.jQuery,Gle=window.$;me.noConflict=function(r){return window.$===me&&(window.$=Gle),r&&window.jQuery===me&&(window.jQuery=Ple),me};typeof noGlobal=="undefined"&&(window.jQuery=window.$=me);re=me});function Yz(r){Ml=r}function Er(r,e){Ml==null||Ml.notify(r,e)}function Xf(r,e,t){Ml==null||Ml.leaveBreadcrumb(r,e,t)}function Bz(r){Ml==null||Ml.setBeforeSendCB(r)}function Kz(r){Ml==null||Ml.setAttachWebGLReport(r)}var Ml,En=__dcg_shared_module_exports__['b'](()=>{});var TX=__dcg_shared_module_exports__['b'](()=>{});function uk(r=void 0){let e=()=>r;return e.isDCGViewConst=!0,e}function Ln(r){return typeof r=="function"&&!!r.isDCGViewConst}var ad=__dcg_shared_module_exports__['b'](()=>{});function EX(r){let e=r();if(typeof e=="string")return e;if(typeof e!="object")throw new Error(`Unsupported type returned from class getter: ${typeof e}`);return Object.keys(e).filter(t=>e.hasOwnProperty(t)&&e[t]).join(" ")}function Ome(r,e,t){let o=r.className.replace(IX,"").split(MX),i=e.replace(IX,"").split(MX),n={};for(let s of i)n[s]=!0;let a=o.filter(s=>!n.hasOwnProperty(s));return t?`${t} ${a.join(" ")}`.trim():a.join(" ")}function DX(r){let e=EX(r),t=Ln(r)?void 0:{onUpdate:o=>{let i=EX(r);e!==i&&(o.className=o.className===e?i:Ome(o,e,i),e=i)}};return{value:e,bindings:t}}var IX,MX,AX=__dcg_shared_module_exports__['b'](()=>{ad();IX=/^\s+|\s+$/g,MX=/\s+/});function LX(r){return e=>{if(typeof e!="function")throw new Error(`The ${r} attribute expects a function for the value`);if(Ln(e))throw new Error(`The ${r} attribute does not expect a const for the value`);return{bindings:{[r]:e}}}}var PX=__dcg_shared_module_exports__['b'](()=>{ad()});function gD(r,e,t){return t===void 0?r.removeAttribute(e):r.setAttribute(e,`${t}`)}var bN=__dcg_shared_module_exports__['b'](()=>{});function GX(r){let e=r();if(typeof e=="string")return e;if(!e||typeof e!="object")throw new Error(`Unsupported type returned from style getter: ${typeof e}`);return Object.entries(e).filter(([t,o])=>e.hasOwnProperty(t)&&o!==null&&o!==void 0).map(([t,o])=>`${t}:${o}`).join(";")}function VX(r){let e=GX(r),t=Ln(r)?void 0:{onUpdate:o=>{let i=GX(r);e!==i&&(gD(o,"style",i),e=i)}};return{value:e,bindings:t}}var OX=__dcg_shared_module_exports__['b'](()=>{bN();ad()});function ks(r,e){yN[r]=e}function RX(r){return yN.hasOwnProperty(r)}function FX(r,e){let t=yN[r];return t(e)}var yN,mD=__dcg_shared_module_exports__['b'](()=>{yN={}});function NX(r,e){if(e!=null){if(typeof r!="string")throw new Error("Must pass a string for an EventHandler name");if(typeof e!="function")throw new Error("Must pass a function for an EventHandler callback");return{bindings:{onMount(t){t&&(t[r.toLowerCase()]=(o,...i)=>{o&&e.apply(t,[o,...i])})}}}}}var UX=__dcg_shared_module_exports__['b'](()=>{});function YX(r,e){let t=e(),o;return Ln(e)||(o={onUpdate(i){if(!i)return;let n=e();n!==t&&(t=n,gD(i,r,n))}}),{value:t,bindings:o}}var BX=__dcg_shared_module_exports__['b'](()=>{bN();ad()});function KX(r){return r.startsWith("on")&&r[2]===r[2].toUpperCase()}var zX=__dcg_shared_module_exports__['b'](()=>{});function qX(r,e){if(typeof e!="function")throw new Error(`Expected the "${r}" attribute to be a function, but got ${JSON.stringify(e)} instead.`);return RX(r)?FX(r,e):KX(r)?NX(r,e):YX(r,e)}var HX=__dcg_shared_module_exports__['b'](()=>{UX();BX();mD();zX()});function WX(r,e,t){let o=r._bindings[e];r._bindings[e]=o?[...o,t]:[t]}function sd(r,e){var o;((o=r._bindings[e])!=null?o:[]).forEach(i=>i())}var xN=__dcg_shared_module_exports__['b'](()=>{});function jX(r,e,t,o){r.forEach(i=>{if(rl(i)){let n=Ep(i);n.renderTo(t,e),n._parentElement=o;return}if(Ln(i)){t.appendChild(document.createTextNode(String(i())));return}if(typeof i=="function"){e.bindText(t,()=>{let n=i();return n==null?"":typeof n=="string"?n:String(n)});return}t.appendChild(document.createTextNode(String(i)))})}var r1,fD,bD,vN=__dcg_shared_module_exports__['b'](()=>{ad();Ip();r1=class{},fD=class extends r1{constructor(t,o){super();this.tagName=t;this.props=o}findFirstRootDOMNode(){return this._element}findLastRootDOMNode(){return this._element}renderTo(t,o){if(this._element=document.createElement(this.tagName),o.bindAttributesTo(this._element,this.props),t.appendChild(this._element),"children"in this.props){let i=Array.isArray(this.props.children)?this.props.children:[this.props.children];jX(i,o,this._element,this)}}},bD=class extends r1{constructor(t=[]){super();this.children=t;this._startPlaceholder=document.createTextNode(""),t.length?this._endPlaceholder=document.createTextNode(""):this._endPlaceholder=this._startPlaceholder}findFirstRootDOMNode(){return this._startPlaceholder}findLastRootDOMNode(){return this._endPlaceholder}renderTo(t,o){t.appendChild(this._startPlaceholder),jX(this.children,o,t,this),this._endPlaceholder!==this._startPlaceholder&&t.appendChild(this._endPlaceholder)}}});function rl(r){return!!(r!=null&&r.isDCGElementSpec)}function Ep(r){switch(r.type){case"fragment":return new bD(r.children);case"element":return new fD(r.tagName,r.props);case"view":let e=new r.viewClass(r.props)._construct();return r.viewName&&(e._viewName=r.viewName),e;default:}throw new Error("could not init DCGElementSpec.")}function ld(r,e={}){let t=[];if("children"in e&&(Array.isArray(e.children)?e.children:[e.children]).forEach(n=>XX(n,t)),r===Hg)return{isDCGElementSpec:!0,type:"fragment",children:t};if(typeof r=="string")return{isDCGElementSpec:!0,type:"element",tagName:r,props:{...e,children:t}};let o;return t.length===1?o=t[0]:t.length>1&&(o=t),{isDCGElementSpec:!0,type:"view",viewClass:r,props:{...e,children:o}}}var Hg,XX,Ip=__dcg_shared_module_exports__['b'](()=>{vN();Hg=Symbol(),XX=(r,e)=>{r!=null&&(Array.isArray(r)?r.forEach(t=>XX(t,e)):e.push(r))}});function gk(r){hk.push(r)}function wN(r){let e=hk.filter(t=>t!==r);hk.length=0,hk.push(...e)}function SN(r,e){if(yD(e)){let o=`[${e._viewName}]`,i=e.traceViewHierarchy(),n=i.ancestors.length>0?`
View Hierarchy:
${i.formatted}`:"";r=`${r} ${o}${n}`}let t=new Error(r);console.warn(t),hk.forEach(o=>o(t))}var hk,kN=__dcg_shared_module_exports__['b'](()=>{lh();hk=[]});var yD,dn,lh=__dcg_shared_module_exports__['b'](()=>{HX();xN();ad();Ip();vN();kN();yD=r=>r instanceof dn,dn=class extends r1{constructor(t){var o,i;super();this.props=t;this._childViews=[];this._bindings={};this._isMounted=!1;this._willBeUnmounted=!1;this.const=uk;this.createElement=ld;this._viewName=(i=(o=this.constructor)==null?void 0:o.name)!=null?i:"Anonymous DCGView"}init(){}template(){throw new Error("template() must be implemented")}_construct(){var o;(o=this.init)==null||o.call(this);let t=this.template();if(!rl(t))throw new Error("template() must return a DCGElement");return this._elementSpec=t,this}bindFn(t){return t.bind(this)}bindIfMounted(t){return this.bindFn((...o)=>{if(this._isMounted)return t.apply(this,o)})}traceViewHierarchy(){let t=[],o=this._parentElement;for(;o;)t.unshift(o),o=o._parentElement;let i=a=>yD(a)&&!(a._viewName==="Switch"&&yD(a._parentElement)&&a._parentElement._viewName==="If")&&!["ForWrapper","SwitchWrapper"].includes(a._viewName),n=[...t,this].filter(i).map((a,s)=>"  ".repeat(s)+"<"+a._viewName+">").join(`
`);return{ancestors:t,formatted:n}}renderTo(t,o){o&&o._childViews.push(this),this._element=Ep(this._elementSpec),this._element._parentElement=this,this._element.renderTo(t,this)}findFirstRootDOMNode(){return this._element.findFirstRootDOMNode()}findLastRootDOMNode(){return this._element.findLastRootDOMNode()}findAllRootDOMNodes(){let t=this.findFirstRootDOMNode(),o=this.findLastRootDOMNode(),i=[],n=t;for(;n&&(i.push(n),n!==o);)n=n.nextSibling;return i}update(){var t,o,i;if(!this._isMounted)return SN("Trying to update view that is not mounted. Ignoring update.",this);this.shouldUpdate&&!this.shouldUpdate()||((t=this.willUpdate)==null||t.call(this),sd(this,"willUpdate"),sd(this,"onUpdate"),(o=this.onUpdate)==null||o.call(this),this.updateChildren(),sd(this,"didUpdate"),(i=this.didUpdate)==null||i.call(this))}updateChildren(){this._childViews.forEach(t=>t.update())}bindText(t,o){let i=o(),n=document.createTextNode(i);t.appendChild(n),WX(this,"onUpdate",()=>{let a=o();i!==a&&(n.nodeValue=a,i=a)})}addAttributeBindingsTo(t,o){Object.entries(o).forEach(([i,n])=>{if(!n)return;if(["onMount","didMount","willUnmount","willUpdate","onUpdate","didUpdate"].includes(i)&&(n=n.bind(null,t)),["willMount","onMount","didMount","willUnmount","onUnmount","didUnmount"].includes(i)){let d=!1,p=n;n=(...u)=>{if(d){SN(`${i} is a one-time binding but was called multiple times`,this);return}d=!0,p(...u)}}let c=this._bindings[i];this._bindings[i]=c?[...c,n]:[n]})}bindAttributesTo(t,o){Object.keys(o).filter(i=>i!=="children").forEach(i=>{let n=qX(i,o[i]);n&&("value"in n&&n.value!==void 0&&t.setAttribute(i,String(n.value)),n.bindings&&this.addAttributeBindingsTo(t,n.bindings))})}}});var xD,$X=__dcg_shared_module_exports__['b'](()=>{lh();xD=class extends dn{constructor(){super(...arguments),this._viewName="Checkbox"}computeChecked(){return!!this.props.checked()}template(){if(!this.props.checked)throw new Error('<Checkbox> expects a "checked={}" prop');if(!this.props.onChange)throw new Error('<Checkbox> expects an "onChange={}" prop');let e={...this.props,type:this.const("checkbox"),checked:this.const(this.computeChecked()?!0:void 0),onChange:t=>{this.props.onChange(t.target.checked),this._isMounted&&this.update()},onMount:t=>{this.rootDOM=t,this.props.onMount&&this.props.onMount(t)}};return this.createElement("input",e)}didUpdate(){let e=this.computeChecked();this.rootDOM.checked!==e&&(this.rootDOM.checked=e)}}});var JX,ZX=__dcg_shared_module_exports__['b'](()=>{JX=r=>{let e=r.length,t=new Array(e),o=new Array(e+1),i=0,n;for(let c=0;c<e;c++){if(r[o[i]]<r[c])n=i+1;else{let d=1,p=i-1;for(;d<=p;){let u=Math.ceil((d+p)/2);r[o[u]]<r[c]?d=u+1:p=u-1}n=d}t[c]=o[n-1],o[n]=c,n>i&&(i=n)}let a=new Array(i),s=o[i];for(let c=i-1;c>=0;c--)a[c]=r[s],s=t[s];return a}});function QX(r,e){let t={};for(let c=0;c<e.length;c++)t[e[c]]=c;let o=r.filter(c=>t[c]===void 0),i=r.map(c=>t[c]).filter(c=>c!==void 0),n=JX(i),a={};for(let c=0;c<n.length;c++){let d=n[c];a[e[d]]=!0}let s=[];for(let c=e.length-1;c>=0;c--){let d=e[c];a[d]||s.push({key:d,beforeKey:e[c+1]})}return{removes:o,inserts:s}}var e$=__dcg_shared_module_exports__['b'](()=>{ZX()});function _N(r,e,t){if(!e||e.nodeType!==1)throw new Error("Must pass an HTMLElement for the node");if(e._mountedDCGView)throw new Error("This node is already mounted by a view");let o=new r(t)._construct(),i=document.createDocumentFragment();return o.renderTo(i),e.innerHTML="",o1(o),e._mountedDCGView=o,e.appendChild(i),i1(o),n1(o),o}function CN(r){let e=r._mountedDCGView;if(!e)throw new Error("This node is not mounted by a DCGView");a1(e),r.innerHTML="",delete r._mountedDCGView,s1(e),l1(e)}function o1(r){r.willMount&&r.willMount(),sd(r,"willMount"),r._childViews.forEach(o1)}function i1(r){r._isMounted=!0,r.onMount&&r.onMount(),sd(r,"onMount"),r._childViews.forEach(i1)}function n1(r){r.didMount&&r.didMount(),sd(r,"didMount"),r._childViews.forEach(n1)}function a1(r){r.willUnmount&&r.willUnmount(),sd(r,"willUnmount"),r._childViews.forEach(a1)}function s1(r){r._isMounted=!1,r._childViews.forEach(s1),sd(r,"onUnmount"),r.onUnmount&&r.onUnmount()}function l1(r){r._childViews.forEach(l1),sd(r,"didUnmount"),r.didUnmount&&r.didUnmount()}function vD(r,e){let t=document.createDocumentFragment();return r.renderTo(t,e),t}var wD=__dcg_shared_module_exports__['b'](()=>{xN()});var TN,SD,t$=__dcg_shared_module_exports__['b'](()=>{e$();ad();Ip();wD();lh();TN=class extends dn{constructor(){super(...arguments),this._viewName="ForWrapper"}template(){return this.props.children}},SD=class extends dn{constructor(){super(...arguments),this._viewName="For"}getKeys(){this._keyToItem={};let e=this.props.each();if(!Array.isArray(e))throw new Error("<For each={}> must return an array");let t=this.props.key?e.map(this.props.key):[...e];if(!this._chosenKeyType&&t.length){let o=typeof t[0];if(o!=="string"&&o!=="number")throw new Error(`The key: ${JSON.stringify(t[0])} is not a string or number`);this._chosenKeyType=o}return t.forEach((o,i)=>{if(typeof o!==this._chosenKeyType)throw new Error(`Keys must be the same type. ${JSON.stringify(o)} is not a ${this._chosenKeyType}`);let n=o;if(n in this._keyToItem)throw new Error(`The key: ${JSON.stringify(o)} is not unique`);this._keyToItem[n]=e[i]}),t}createViewForKey(e){let t=this._keyToItem[e],o=this._viewFunction.call(this,t,e);if(rl(o)&&o.type==="view"){let n=Ep(o);return this._keyToView[e]=n,n}let i=Ep(this.createElement(TN,{children:o}));return this._keyToView[e]=i,i}template(){if(typeof this.props.each!="function")throw new Error("<For each={}> must be a function");if(!("children"in this.props))throw new Error("<For> expects a child.");let{children:e}=this.props;if(Array.isArray(e))throw new Error(`<For> expects a single child. You passed ${e.length}.`);if(rl(e))throw new Error("<For> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof e!="function"){let t=JSON.stringify(e);throw new Error(`<For> expects a function that constructs a DCGElement. You passed ${t}`)}if(Ln(e))throw new Error("<For> expects a function that constructs a DCGElement. You passed a constant");return this._viewFunction=e,this._keyToView={},this._keys=this.getKeys(),this._keys.map(t=>{let o=this.createViewForKey(t);return o._parentElement=this,o}),this.createElement(Hg)}detachAllRemovedViews(){let e=this._childViews,t=0;for(let o=0;o<e.length;o++){let i=e[o];i._willBeUnmounted?t++:e[o-t]=i}e.splice(e.length-t,t)}findFirstRootDOMNode(){return this._startPlaceholder.findFirstRootDOMNode()}findLastRootDOMNode(){return this._endPlaceholder.findLastRootDOMNode()}updateChildren(){let e=this._keys,t=this.getKeys();this._keys=t;let o=QX(e,t),i=[];for(let a=o.removes.length-1;a>=0;a--){let s=o.removes[a],c=this._keyToView[s];a1(c),delete this._keyToView[s],c._willBeUnmounted=!0,c.findAllRootDOMNodes().forEach(d=>d.remove()),i.push(c)}i.length>0&&(this.detachAllRemovedViews(),i.forEach(s1),i.forEach(l1));let n=[];for(let a=o.inserts.length-1;a>=0;a--){let s=o.inserts[a].key;if(s in this._keyToView)continue;let c=this.createViewForKey(s);vD(c,this),n.push(c)}n.forEach(o1),o.inserts.forEach(a=>{let s=this._keyToView[a.key].findAllRootDOMNodes(),c;a.beforeKey?c=this._keyToView[a.beforeKey].findFirstRootDOMNode():c=this.findLastRootDOMNode(),s.forEach(d=>{c.before(d)})}),n.forEach(i1),n.forEach(n1);for(let a=0;a<this._childViews.length-n.length;a++)this._childViews[a].update()}renderTo(e,t){super.renderTo(e,t),this._startPlaceholder=this._element;for(let o of this._keys)this._keyToView[o].renderTo(e,this);this._endPlaceholder=Ep(this.createElement(Hg)),this._endPlaceholder.renderTo(e,t)}}});var EN,Mp,mk=__dcg_shared_module_exports__['b'](()=>{ad();Ip();wD();lh();EN=class extends dn{constructor(){super(...arguments),this._viewName="SwitchWrapper"}template(){return this.props.children}},Mp=class extends dn{constructor(){super(...arguments),this._viewName="Switch"}updateKey(){this._key=this.props.key()}createViewSpec(){var t;let e=(t=this._viewFunction(this._key))!=null?t:this.createElement(Hg);return this.createElement(EN,{children:e})}createView(){let e=this.createViewSpec(),t=Ep(e);return t._parentElement=this,t}template(){if(typeof this.props.key!="function")throw new Error("<Switch key={}> must be a function");if(!("children"in this.props))throw new Error("<Switch> expects a child.");let{children:e}=this.props;if(Array.isArray(e))throw new Error(`<Switch> expects a single child. You passed ${e.length}.`);if(rl(e))throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof e!="function"){let t=JSON.stringify(e);throw new Error("<Switch> expects a function that constructs a DCGElement. You passed "+t)}if(Ln(e))throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a constant");return this._viewFunction=e,this.updateKey(),this.createViewSpec()}updateChildren(){let e=this._key;this.updateKey();let t=this._key;if(e===t){this._element.update();return}let o=this.findAllRootDOMNodes(),i=document.createTextNode("");o[0].before(i),a1(this._element),this._childViews=[],o.forEach(a=>a.remove()),s1(this._element),l1(this._element),this._element=this.createView();let n=vD(this._element,this);o1(this._element),i.before(n),i.remove(),i1(this._element),n1(this._element)}}});var kD,r$=__dcg_shared_module_exports__['b'](()=>{ad();Ip();mk();lh();kD=class extends dn{constructor(){super(...arguments),this._viewName="If"}template(){let{predicate:e}=this.props;if(typeof e!="function")throw new Error("<If predicate={}> must be a function");if(!("children"in this.props))throw new Error("<If> expects a child.");if(Array.isArray(this.props.children))throw new Error(`<If> expects a single child. You passed ${this.props.children.length}.`);let t=this.props.children;if(rl(t))throw new Error("<If> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof t!="function"){let n=JSON.stringify(t);throw new Error(`<If> expects a function that constructs a DCGElement. You passed ${n}`)}if(Ln(t))throw new Error("<If> expects a function that constructs a DCGElement. You passed a constant");let o=()=>!!e(),i=n=>n?t():void 0;return this.createElement(Mp,{key:o,children:i})}}});function o$(r,e,t){return{...ld(Mp,{key:()=>{let i=r();return i!=null},children:i=>i?e(r):t==null?void 0:t()}),viewName:"IfDefined"}}var i$=__dcg_shared_module_exports__['b'](()=>{Ip();mk()});function _D(r,e,t){let o=typeof t=="undefined",i,n;return o?(i=r,n=a=>{var c;let s=e;return(c=s[a])==null?void 0:c.call(s,()=>a)}):(i=()=>{let a=r();return a&&a[e]},n=a=>{var c;let s=t;return(c=s[a])==null?void 0:c.call(s,r)}),{...ld(Mp,{key:i,children:n}),viewName:"SwitchUnion"}}var IN=__dcg_shared_module_exports__['b'](()=>{Ip();mk()});function n$(r,e){return{..._D(()=>r()?"true":"false",e),viewName:"IfElse"}}var a$=__dcg_shared_module_exports__['b'](()=>{IN()});var CD,s$=__dcg_shared_module_exports__['b'](()=>{lh();CD=class extends dn{constructor(){super(...arguments),this._viewName="Input"}computeValue(){let e=this.props.value();return e==null?"":`${e}`}template(){let{value:e,onInput:t,onEnterPressed:o,disabled:i,readOnly:n}=this.props;if(!e)throw new Error('<Input> expects a "value={}" prop');let a={...this.props,value:this.const(this.computeValue()),onInput:(s=>{t==null||t(s.target.value),this._isMounted&&this.update()}).bind(this)};return o&&(a.onKeyPress=s=>{s.which===13&&o()}),i&&(a.disabled=()=>i()?!0:void 0),n&&(a.readOnly=()=>n()?!0:void 0),a.hasOwnProperty("tabIndex")||(a.tabIndex=()=>i&&i()?"-1":"0"),a.onMount=s=>{this.rootDOM=s,this.props.onMount&&this.props.onMount(s)},this.createElement("input",a)}didUpdate(){let e=this.computeValue();this.rootDOM.value!==e&&(this.rootDOM.value=e)}}});var TD,l$=__dcg_shared_module_exports__['b'](()=>{lh();TD=class extends dn{constructor(){super(...arguments),this._viewName="Textarea"}computeValue(){let e=this.props.value();return e==null?"":`${e}`}template(){let{value:e,onInput:t,disabled:o,readOnly:i}=this.props;if(!e)throw new Error('<Textarea> expects a "value={}" prop');if(!t)throw new Error('<Textarea> expects an "onInput={}" prop');let n={...this.props,children:this.const(this.computeValue()),onInput:(a=>{this.props.onInput(a.target.value),this._isMounted&&this.update()}).bind(this)};return o&&(n.disabled=()=>o()?!0:void 0),i&&(n.readOnly=()=>i()?!0:void 0),n.onMount=a=>{this.rootDOM=a,this.props.onMount&&this.props.onMount(a)},delete n.value,this.createElement("textarea",n)}didUpdate(){let e=this.computeValue();this.rootDOM.value!==e&&(this.rootDOM.value=e)}}});var fk={};__dcg_shared_module_exports__['d'](fk,{Checkbox:()=>xD,For:()=>SD,If:()=>kD,IfDefined:()=>o$,IfElse:()=>n$,Input:()=>CD,Switch:()=>Mp,SwitchUnion:()=>_D,Textarea:()=>TD});var c$=__dcg_shared_module_exports__['b'](()=>{$X();t$();r$();i$();a$();s$();mk();IN();l$()});var MN={};__dcg_shared_module_exports__['d'](MN,{Components:()=>fk,View:()=>dn,addCustomAttribute:()=>ks,addWarningHandler:()=>gk,const:()=>uk,createElement:()=>ld,isConst:()=>Ln,isSpec:()=>rl,mountToNode:()=>_N,removeWarningHandler:()=>wN,unmountFromNode:()=>CN});var DN=__dcg_shared_module_exports__['b'](()=>{AX();PX();OX();mD();c$();ad();Ip();mD();wD();lh();kN();ks("style",VX);ks("class",DX);["willMount","onMount","didMount","willUnmount","onUnmount","didUnmount","willUpdate","onUpdate","didUpdate"].forEach(r=>ks(r,LX(r)))});var AN={};__dcg_shared_module_exports__['d'](AN,{Components:()=>fk,View:()=>dn,addCustomAttribute:()=>ks,addWarningHandler:()=>gk,const:()=>uk,createElement:()=>ld,default:()=>Rme,isConst:()=>Ln,isSpec:()=>rl,mountToNode:()=>_N,removeWarningHandler:()=>wN,unmountFromNode:()=>CN});var Rme,d$=__dcg_shared_module_exports__['b'](()=>{DN();DN();Rme=MN});var j=__dcg_shared_module_exports__['c']((k2e,p$)=>{TX();jo();En();d$();Ut();gk(r=>Er(r));ks("href",r=>{let e=AE(r());return{value:`${AE(r())}`,bindings:{onMount(t){if(!["a","use"].includes(t.tagName.toLowerCase()))throw new Error("Cannot have an href on a non-link element.")},onUpdate(t){let o=AE(r());e!==o&&(e=o,t.setAttribute("href",o))}}}});ks("onTap",r=>({value:"",bindings:{onMount(e){re(e).on("dcg-tap",r)}}}));ks("onTapStart",r=>({bindings:{onMount(e){re(e).on("dcg-tapstart",r)}}}));ks("onTapMove",r=>({bindings:{onMount(e){re(e).on("dcg-tapmove",r)}}}));ks("onTapEnd",r=>({bindings:{onMount(e){re(e).on("dcg-tapend",r)}}}));ks("onLongHold",r=>({bindings:{onMount(e){re(e).on("dcg-longhold",r)}}}));ks("manageFocus",r=>r()===void 0?{}:{bindings:{onMount(e){r().shouldBeFocused()&&e.focus(),e.onfocus=function(t){r().shouldBeFocused()||r().onFocusedChanged(!0,t)},e.onblur=function(t){r().shouldBeFocused()&&t.target!==document.activeElement&&r().onFocusedChanged(!1,t)}},onUpdate(e){let t=r().shouldBeFocused(),o=document.activeElement===e;t&&!o?e.focus():o&&!t&&e.blur()},willUnmount(e){e.onfocus=null,e.onblur=null}}});p$.exports=AN});var u$=__dcg_shared_module_exports__['c'](bk=>{var yt=bk&&bk.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,i){o.__proto__=i}||function(o,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(o[n]=i[n])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function o(){this.constructor=e}e.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}}(),ED=bk&&bk.__assign||function(){return ED=Object.assign||function(r){for(var e,t=1,o=arguments.length;t<o;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},ED.apply(this,arguments)};(function(){var r=-1,e=1,t=Math.min,o=Math.max;function i(){}function n(M){for(;M;){if(!M.parent)return M;M=M.parent}}function a(M,w,m){if(!w){var y=new Error("prayer failed: "+M);if(m){var f={};y.dcgExtraErrorMetaData=f;for(var k in m){var L=m[k],G=f[k]={};if(L){G.localLatex=L.latex();var U=n(L);U&&(G.rootLatex=U.latex())}else G.emptyNode=!0}}throw y}}function s(M){a("a direction was passed",M===r||M===e)}function c(M){var w=document.implementation.createHTMLDocument("");if(w.body.innerHTML=M,w.body.children.length===1)return w.body.children[0];for(var m=document.createDocumentFragment();w.body.firstChild;)m.appendChild(w.body.firstChild);return m}var d=function(w,m,y){var f;switch(w){case"svg":case"path":f=document.createElementNS("http://www.w3.org/2000/svg",w);break;default:f=document.createElement(w)}for(var k in m){var L=m[k];L!==void 0&&f.setAttribute(k,typeof L=="string"?L:String(L))}if(y)for(var G=0;G<y.length;G++)f.appendChild(y[G]);return f};d.text=function(M){return document.createTextNode(M)},d.block=function(M,w,m,y){var f=[m.html()];y!=null&&y.beforeChild&&f.unshift(y.beforeChild),y!=null&&y.afterChild&&f.push(y.afterChild);var k=d(M,w,f);return m.setDOM(k),A.linkElementByBlockNode(k,m),k},d.entityText=function(M){var w=c(M);return a("entity parses to a single text node",w instanceof DocumentFragment&&w.childNodes.length===1&&w.childNodes[0]instanceof Text),w.childNodes[0]};function p(M,w){var m,y;if(typeof(M==null?void 0:M.closest)=="function")return M.closest(w);if(!(M instanceof HTMLElement))return null;var f=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,k=M;do{if(f.call(k,w))return k;k=(y=(m=k==null?void 0:k.parentElement)!==null&&m!==void 0?m:k==null?void 0:k.parentNode)!==null&&y!==void 0?y:null}while(k!==null&&k.nodeType===1);return null}var u="\xA0",g="\u200B",h="\u02D9",b="\u2211",v="\u220F",T="\u2210",E="\u222B";function I(M){return M.getClientRects().length?M.getBoundingClientRect():{top:0,left:0,height:0,width:0,x:0,y:0,bottom:0,right:0}}function _(){return window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft}function C(){return window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}var D=function(){var M,w;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(M=requestAnimationFrame,w=cancelAnimationFrame):(M=function(m){return setTimeout(m,13)},w=clearTimeout),function(m,y){var f=Date.now(),k,L=0;function G(){var Q=(Date.now()-f)/m;Q<=L?H():L=Q,y(L,H,U)}function U(){k!==void 0&&w(k),k=void 0}function H(){U(),k=M(G)}y(m<=0?1:0,H,U)}}(),P=function(){function M(w){this.span=d("span",{class:"dcg-mq-aria-alert","aria-live":"assertive","aria-atomic":"true"}),this.msg="",this.items=[],this.controller=w}return M.prototype.attach=function(){var w=this.controller.container;this.span.parentNode!==w&&N(w).prepend(N(this.span))},M.prototype.queue=function(w,m){m===void 0&&(m=!1);var y="";if(w instanceof Et){var f=w.mathspeak({ignoreShorthand:!0});m&&(w.parent&&w.parent.ariaLabel&&w.ariaLabel==="block"?y=w.parent.ariaLabel+" "+f:w.ariaLabel&&(y=w.ariaLabel+" "+f)),y===""&&(y=f)}else y=w||"";return this.items.push(y),this},M.prototype.queueDirOf=function(w){return s(w),this.queue(w===r?"before":"after")},M.prototype.queueDirEndOf=function(w){return s(w),this.queue(w===r?"beginning of":"end of")},M.prototype.alert=function(w){return this.attach(),w&&this.queue(w),this.items.length&&(this.msg=this.items.join(" ").replace(/ +(?= )/g,"").trim(),this.controller.containerHasFocus()&&(this.controller.options.logAriaAlerts&&this.msg&&console.log(this.msg),this.span.textContent=this.msg)),this.clear()},M.prototype.clear=function(w){return this.items.length=0,w!=null&&w.emptyContent&&(this.span.textContent=""),this},M}(),F=function(){function M(w,m){var y;arguments.length===1&&(m=w),!(!w||!m)&&(this.ends=(y={},y[r]=w,y[e]=m,y))}return M.create=function(w,m){arguments.length===1&&(m=w),a("No half-empty DOMFragments",!!w==!!m);var y=new M(w,m);return a("last is a forward sibling of first",y.isValid()),y},M.prototype.isEmpty=function(){return this.ends===void 0},M.prototype.isOneNode=function(){return!!(this.ends&&this.ends[r]===this.ends[e])},M.prototype.isValid=function(){if(!this.ends||this.ends[r]===this.ends[e])return!0;var w;return this.eachNode(function(m){return w=m}),w===this.ends[e]},M.prototype.firstNode=function(){return a("Fragment is not empty",this.ends),this.ends[r]},M.prototype.lastNode=function(){return a("Fragment is not empty",this.ends),this.ends[e]},M.prototype.children=function(){var w=this.oneNode(),m=w.firstChild,y=w.lastChild;return m&&y?new M(m,y):new M},M.prototype.join=function(w){if(!this.ends)return w;if(!w.ends)return this;for(var m=!1,y=this.ends[e].nextSibling;y;){if(y===w.ends[r]){m=!0;break}y=y.nextSibling}return a("sibling must be a forward DOM sibling of this fragment",m),new M(this.ends[r],w.ends[e])},M.prototype.oneNode=function(){return a("Fragment has a single node",this.ends&&this.ends[r]===this.ends[e]),this.ends[r]},M.prototype.oneElement=function(){var w=this.oneNode();return a("Node is an Element",w.nodeType===Node.ELEMENT_NODE),w},M.prototype.oneText=function(){var w=this.oneNode();return a("Node is Text",w.nodeType===Node.TEXT_NODE),w},M.prototype.eachNode=function(w){if(!this.ends)return this;for(var m=this.ends[e],y=this.ends[r],f=void 0;y&&(f=y.nextSibling,w(y),y!==m);y=f);return this},M.prototype.eachElement=function(w){return this.eachNode(function(m){m.nodeType===Node.ELEMENT_NODE&&w(m)}),this},M.prototype.text=function(){var w="";return this.eachNode(function(m){w+=m.textContent||""}),w},M.prototype.toNodeArray=function(){var w=[];return this.eachNode(function(m){return w.push(m)}),w},M.prototype.toElementArray=function(){var w=[];return this.eachElement(function(m){return w.push(m)}),w},M.prototype.toDocumentFragment=function(){var w=document.createDocumentFragment();return this.eachNode(function(m){return w.appendChild(m)}),w},M.prototype.insertBefore=function(w){return this.insDirOf(r,w)},M.prototype.insertAfter=function(w){return this.insDirOf(e,w)},M.prototype.append=function(w){return w.appendTo(this.oneElement()),this},M.prototype.prepend=function(w){return w.prependTo(this.oneElement()),this},M.prototype.appendTo=function(w){return this.insAtDirEnd(e,w)},M.prototype.prependTo=function(w){return this.insAtDirEnd(r,w)},M.prototype.parent=function(){if(!this.ends)return this;var w=this.ends[r].parentNode;return w?new M(w):new M},M.prototype.wrapAll=function(w){if(w.textContent="",!this.ends)return this;var m=this.ends[r].parentNode,y=this.ends[e].nextSibling;return this.appendTo(w),m&&m.insertBefore(w,y),this},M.prototype.replaceWith=function(w){var m,y=(m=this.ends)===null||m===void 0?void 0:m[e],f=y==null?void 0:y.parentNode,k=y==null?void 0:y.nextSibling;this.detach();var L=w.toDocumentFragment();return!y||!f?this:(f.insertBefore(L,k||null),this)},M.prototype.nthElement=function(w){if(this.ends&&!(w<0||w!==Math.floor(w)))for(var m=this.ends[r];m;){if(m.nodeType===Node.ELEMENT_NODE){if(w<=0)return m;w-=1}if(m===this.ends[e])return;m=m.nextSibling}},M.prototype.firstElement=function(){return this.nthElement(0)},M.prototype.lastElement=function(){if(this.ends)for(var w=this.ends[e];w;){if(w.nodeType===Node.ELEMENT_NODE)return w;if(w===this.ends[r])return;w=w.previousSibling}},M.prototype.first=function(){return new M(this.firstElement())},M.prototype.last=function(){return new M(this.lastElement())},M.prototype.eq=function(w){return new M(this.nthElement(w))},M.prototype.slice=function(w){if(!this.ends)return this;var m=this.nthElement(w);return m?new M(m,this.ends[e]):new M},M.prototype.next=function(){for(var w=this.oneNode();w;)if(w=w.nextSibling,w&&w.nodeType===Node.ELEMENT_NODE)return new M(w);return new M},M.prototype.prev=function(){for(var w=this.oneNode();w;)if(w=w.previousSibling,w&&w.nodeType===Node.ELEMENT_NODE)return new M(w);return new M},M.prototype.empty=function(){return this.eachElement(function(w){w.textContent=""}),this},M.prototype.remove=function(){return this.toDocumentFragment(),this},M.prototype.detach=function(){return this.remove()},M.prototype.insDirOf=function(w,m){var y;if(!this.ends)return this;var f=(y=m.ends)===null||y===void 0?void 0:y[w];return!f||!f.parentNode?this.detach():(Y(w,f.parentNode,this.toDocumentFragment(),f),this)},M.prototype.insAtDirEnd=function(w,m){return this.ends?(z(w,this.toDocumentFragment(),m),this):this},M.prototype.hasClass=function(w){var m=!1;return this.eachElement(function(y){y.classList.contains(w)&&(m=!0)}),m},M.prototype.addClass=function(w){for(var m=function(G){if(!G)return"continue";y.eachElement(function(U){U.classList.add(G)})},y=this,f=0,k=w.split(/\s+/);f<k.length;f++){var L=k[f];m(L)}return this},M.prototype.removeClass=function(w){for(var m=function(G){if(!G)return"continue";y.eachElement(function(U){U.classList.remove(G)})},y=this,f=0,k=w.split(/\s+/);f<k.length;f++){var L=k[f];m(L)}return this},M.prototype.toggleClass=function(w,m){if(m===!0)return this.addClass(w);if(m===!1)return this.removeClass(w);for(var y=function(U){if(!U)return"continue";f.eachElement(function(H){H.classList.toggle(U)})},f=this,k=0,L=w.split(/\s+/);k<L.length;k++){var G=L[k];y(G)}return this},M}(),N=F.create;function Y(M,w,m,y){w.insertBefore(m,M===r?y:y.nextSibling)}function z(M,w,m){M===r?m.insertBefore(w,m.firstChild):m.appendChild(w)}var X=function(){function M(w,m,y){this.init(w,m,y)}return M.prototype.init=function(w,m,y){this.parent=w,this[r]=m,this[e]=y},M.copy=function(w){return new M(w.parent,w[r],w[e])},M}();function q(M,w){var m=M[r];if(m){var y=M[e];if(y)for(y=y[e];m!==y;m=m[e]){var f=w(m);if(f===!1)break}}}function S(M,w,m){var y=M[r];if(!y)return w;var f=M[e];if(!f)return w;for(f=f[e];y!==f;y=y[e])w=m(w,y);return w}var A=function(){function M(){var y;this[w]=0,this[m]=0,this.parent=0,this.ends=(y={},y[r]=0,y[e]=0,y),this.id=M.uniqueNodeId()}M.uniqueNodeId=function(){return M.idCounter+=1},M.getNodeOfElement=function(y){if(y){if(!y.nodeType)throw new Error("must pass an Element to NodeBase.getNodeOfElement");var f=y;return f.mqBlockNode||f.mqCmdNode}},M.linkElementByBlockNode=function(y,f){y.mqBlockNode=f},M.linkElementByCmdNode=function(y,f){y.mqCmdNode=f},M.prototype.setEnds=function(y){this.ends=y,a("No half-empty node ends",!!this.ends[r]==!!this.ends[e])},M.prototype.getEnd=function(y){return this.ends[y]},M.prototype.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},M.prototype.setDOM=function(y){return y&&a("DOM is an element or a text node",y.nodeType===Node.ELEMENT_NODE||y.nodeType===Node.TEXT_NODE),this._el=y,this},M.prototype.domFrag=function(){return N(this._el)},M.prototype.createDir=function(y,f){s(y);var k=this;return k.html(),k.domFrag().insDirOf(y,f.domFrag()),f[y]=k.adopt(f.parent,f[r],f[e]),k},M.prototype.createLeftOf=function(y){this.createDir(r,y)},M.prototype.selectChildren=function(y,f){return new ue(y,f)},M.prototype.bubble=function(y){for(var f=this.getSelfNode(),k=f;k;k=k.parent){var L=y(k);if(L===!1)break}return this},M.prototype.postOrder=function(y){var f=this.getSelfNode();return function k(L){return L?(L.eachChild(k),y(L),!0):!1}(f),f},M.prototype.isEmpty=function(){return this.ends[r]===0&&this.ends[e]===0},M.prototype.isQuietEmptyDelimiter=function(y){if(!this.isEmpty()||!y||!this.parent||this.parent.ctrlSeq===void 0)return!1;var f=this.parent.ctrlSeq.replace(/^\\(left|right)?/,"");return y.hasOwnProperty(f)},M.prototype.isStyleBlock=function(){return!1},M.prototype.isTextBlock=function(){return!1},M.prototype.children=function(){return new B(this.getEnd(r),this.getEnd(e))},M.prototype.eachChild=function(y){return q(this.ends,y),this},M.prototype.foldChildren=function(y,f){return S(this.ends,y,f)},M.prototype.withDirAdopt=function(y,f,k,L){var G=this.getSelfNode();return new B(G,G).withDirAdopt(y,f,k,L),this},M.prototype.adopt=function(y,f,k){var L=this.getSelfNode();return new B(L,L).adopt(y,f,k),this.getSelfNode()},M.prototype.disown=function(){var y=this.getSelfNode();return new B(y,y).disown(),this},M.prototype.remove=function(){return this.domFrag().remove(),this.disown()},M.prototype.shouldIgnoreSubstitutionInSimpleSubscript=function(y){var f=y.disableAutoSubstitutionInSubscripts;if(!f||!this.parent||!(this.parent.parent instanceof Ys))return!1;var k=this.parent.parent[r];return!(typeof f=="object"&&k instanceof qt&&k.endsWord&&f.except[k.endsWord]||!this.parent.domFrag().hasClass("dcg-mq-sub"))},M.prototype.getSelfNode=function(){return this},M.prototype.parser=function(){a("Abstract parser() method is never called",!1)},M.prototype.html=function(){throw new Error("html() unimplemented in NodeBase")},M.prototype.text=function(){return""},M.prototype.latex=function(){var y={latex:"",startIndex:-1,endIndex:-1};return this.latexRecursive(y),y.latex},M.prototype.latexRecursive=function(y){},M.prototype.checkCursorContextOpen=function(y){y.startSelectionBefore===this&&(y.startIndex=y.latex.length),y.endSelectionBefore===this&&(y.endIndex=y.latex.length)},M.prototype.checkCursorContextClose=function(y){y.startSelectionAfter===this&&(y.startIndex=y.latex.length),y.endSelectionAfter===this&&(y.endIndex=y.latex.length)},M.prototype.finalizeTree=function(y,f){},M.prototype.contactWeld=function(y,f){},M.prototype.blur=function(y){},M.prototype.focus=function(){},M.prototype.intentionalBlur=function(){},M.prototype.reflow=function(){},M.prototype.registerInnerField=function(y,f){},M.prototype.chToCmd=function(y,f){a("Abstract chToCmd() method is never called",!1)},M.prototype.mathspeak=function(y){return""},M.prototype.seek=function(y,f){},M.prototype.siblingDeleted=function(y,f){},M.prototype.siblingCreated=function(y,f){},M.prototype.finalizeInsert=function(y,f){},M.prototype.fixDigitGrouping=function(y){},M.prototype.writeLatex=function(y,f){},M.prototype.write=function(y,f){};var w,m;return w=r,m=e,M.idCounter=0,M}();function O(M,w,m){a("a parent is always present",M),a("leftward is properly set up",function(){return w?w[e]===m&&w.parent===M:M.getEnd(r)===m}(),{parent:M,leftward:w,leftwardL:w&&w[r],leftwardR:w&&w[e],rightwardL:m&&m[r],rightwardR:m&&m[e]}),a("rightward is properly set up",function(){return m?m[r]===w&&m.parent===M:M.getEnd(e)===w}(),{parent:M,rightward:m,leftwardL:w&&w[r],leftwardR:w&&w[e],rightwardL:m&&m[r],rightwardR:m&&m[e],rightwardParent:m&&m.parent})}var B=function(){function M(w,m,y){var f,k;if(this.disowned=!1,y===void 0&&(y=r),s(y),a("no half-empty fragments",!w==!m,{withDir:w,oppDir:m}),!w||!m){this.setEnds((f={},f[r]=0,f[e]=0,f));return}a("withDir is passed to Fragment",w instanceof Et),a("oppDir is passed to Fragment",m instanceof Et),a("withDir and oppDir have the same parent",w.parent===m.parent);var L=(k={},k[y]=w,k[-y]=m,k);this.setEnds(L);var G=0;this.each(function(U){G=U}),a("following direction siblings from start reaches end",G===L[e])}return M.prototype.getDOMFragFromEnds=function(){var w=this.ends[r],m=this.ends[e];return w===0||m===0?N():w===m?w.domFrag():w.domFrag().join(m.domFrag())},M.prototype.setEnds=function(w){this.ends=w},M.prototype.getEnd=function(w){return this.ends?this.ends[w]:0},M.prototype.domFrag=function(){return this.getDOMFragFromEnds()},M.prototype.withDirAdopt=function(w,m,y,f){return w===r?this.adopt(m,y,f):this.adopt(m,f,y)},M.prototype.adopt=function(w,m,y){var f;O(w,m,y);var k=this;this.disowned=!1;var L=k.ends[r];if(!L)return this;var G=k.ends[e];if(!G)return this;var U=(f={},f[r]=w.getEnd(r),f[e]=w.getEnd(e),f);return m||(U[r]=L),y?y[r]=G:U[e]=G,w.setEnds(U),G[e]=y,k.each(function(H){return H[r]=m,H.parent=w,m&&(m[e]=H),m=H,!0}),k},M.prototype.disown=function(){var w,m=this,y=m.ends[r];if(!y||m.disowned)return m;this.disowned=!0;var f=m.ends[e];if(!f)return m;var k=y.parent;O(k,y[r],y),O(k,f,f[e]);var L=(w={},w[r]=k.getEnd(r),w[e]=k.getEnd(e),w);if(y[r]){var G=y[r];G[e]=f[e]}else L[r]=f[e];if(f[e]){var U=f[e];U[r]=y[r]}else L[e]=y[r];return L[r]&&L[e]?k.setEnds(L):k.ends=L,m},M.prototype.remove=function(){return this.domFrag().remove(),this.disown()},M.prototype.each=function(w){return q(this.ends,w),this},M.prototype.fold=function(w,m){return S(this.ends,w,m)},M}(),V={},K={};function oe(M){return M&&M.prototype instanceof Et}var Z=function(M){yt(w,M);function w(m,y,f){var k=M.call(this,m,y,f)||this;return k.ancestors={},k}return w.fromCursor=function(m){return new w(m.parent,m[r],m[e])},w}(X),ee=function(M){yt(w,M);function w(m,y,f){var k=M.call(this,m,0,0)||this;return k.upDownCache={},k.cursorElement=d("span",{class:"dcg-mq-cursor"},[d.text(g)]),k._domFrag=N(),k.controller=f,k.options=y,k.setDOMFrag(N(k.cursorElement)),k.blink=function(){N(k.cursorElement).toggleClass("dcg-mq-blink")},k}return w.prototype.setDOMFrag=function(m){return this._domFrag=m,this},w.prototype.domFrag=function(){return this._domFrag},w.prototype.show=function(){if(N(this.cursorElement).removeClass("dcg-mq-blink"),this.setDOMFrag(N(this.cursorElement)),this.intervalId)clearInterval(this.intervalId);else{var m=this[e];if(m){var y=this.selection;y&&y.getEnd(r)[r]===this[r]?this.domFrag().insertBefore(y.domFrag()):this.domFrag().insertBefore(m.domFrag())}else this.domFrag().appendTo(this.parent.domFrag().oneElement());this.parent.focus()}return this.intervalId=setInterval(this.blink,500),this},w.prototype.hide=function(){return this.intervalId&&clearInterval(this.intervalId),this.intervalId=0,this.domFrag().detach(),this.setDOMFrag(N()),this},w.prototype.withDirInsertAt=function(m,y,f,k){var L=this.parent;this.parent=y,this[m]=f,this[-m]=k,L!==y&&L.blur&&L.blur(this)},w.prototype.insDirOf=function(m,y){return s(m),this.domFrag().insDirOf(m,y.domFrag()),this.withDirInsertAt(m,y.parent,y[m],y),this.parent.domFrag().addClass("dcg-mq-hasCursor"),this},w.prototype.insLeftOf=function(m){return this.insDirOf(r,m)},w.prototype.insRightOf=function(m){return this.insDirOf(e,m)},w.prototype.insAtDirEnd=function(m,y){return s(m),this.domFrag().insAtDirEnd(m,y.domFrag().oneElement()),this.withDirInsertAt(m,y,0,y.getEnd(m)),y.focus(),this},w.prototype.insAtLeftEnd=function(m){return this.insAtDirEnd(r,m)},w.prototype.insAtRightEnd=function(m){return this.insAtDirEnd(e,m)},w.prototype.jumpUpDown=function(m,y){var f=this;f.upDownCache[m.id]=X.copy(f);var k=f.upDownCache[y.id];if(k){var L=k[e];L?f.insLeftOf(L):f.insAtRightEnd(k.parent)}else{var G=f.getBoundingClientRectWithoutMargin().left;y.seek(G,f)}f.controller.aria.queue(y,!0)},w.prototype.getBoundingClientRectWithoutMargin=function(){var m=this.domFrag();m.removeClass("dcg-mq-cursor");var y=I(m.oneElement()),f=y.left,k=y.right;return m.addClass("dcg-mq-cursor"),{left:f,right:k}},w.prototype.unwrapGramp=function(){var m=this.parent.parent,y=m.parent,f=m[e],k=this,L=m[r];if(m.disown().eachChild(function(ne){return ne.isEmpty()||(ne.children().adopt(y,L,f).each(function(fe){return fe.domFrag().insertBefore(m.domFrag()),!0}),L=ne.getEnd(e)),!0}),!this[e]){var G=this[r];if(G)this[e]=G[e];else for(;!this[e];){var U=this.parent[e];if(U)this.parent=U,this[e]=U.getEnd(r);else{this[e]=m[e],this.parent=y;break}}}var H=this[e];H?this.insLeftOf(H):this.insAtRightEnd(y),m.domFrag().remove();var Q=m[r],pe=m[e];Q&&Q.siblingDeleted(k.options,e),pe&&pe.siblingDeleted(k.options,r)},w.prototype.startSelection=function(){for(var m=this.anticursor=Z.fromCursor(this),y=m.ancestors,f=m;f.parent;f=f.parent)y[f.parent.id]=f},w.prototype.endSelection=function(){delete this.anticursor},w.prototype.select=function(){var m,y=this.anticursor;if(this[r]===y[r]&&this.parent===y.parent)return!1;for(var f=this;f.parent;f=f.parent)if(f.parent.id in y.ancestors){m=f.parent;break}a("cursor and anticursor in the same tree",m);var k=m,L=y.ancestors[k.id],G,U,H=e;if(f[r]!==L){for(var Q=f;Q;Q=Q[e])if(Q[e]===L[e]){H=r,G=f,U=L;break}}H===e&&(G=L,U=f),G instanceof X&&(G=G[e]),U instanceof X&&(U=U[r]),this.hide().selection=k.selectChildren(G,U);var pe=this.selection.getEnd(H);return this.insDirOf(H,pe),this.selectionChanged(),!0},w.prototype.resetToEnd=function(m){this.clearSelection();var y=m.root;this[e]=0,this[r]=y.getEnd(e),this.parent=y},w.prototype.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},w.prototype.deleteSelection=function(){var m=this.selection;m&&(this[r]=m.getEnd(r)[r],this[e]=m.getEnd(e)[e],m.remove(),this.selectionChanged(),delete this.selection)},w.prototype.replaceSelection=function(){var m=this.selection;return m&&(this[r]=m.getEnd(r)[r],this[e]=m.getEnd(e)[e],delete this.selection),m},w.prototype.depth=function(){for(var m=this,y=0;m=m.parent;)y+=m instanceof De?1:0;return y},w.prototype.isTooDeep=function(m){return this.options.maxDepth!==void 0?this.depth()+(m||0)>this.options.maxDepth:!1},w.prototype.selectionChanged=function(){},w}(X),ue=function(M){yt(w,M);function w(m,y,f){var k=M.call(this,m,y,f)||this;return k._el=d("span",{class:"dcg-mq-selection"}),k.getDOMFragFromEnds().wrapAll(k._el),k}return w.prototype.isCleared=function(){return this._el===void 0},w.prototype.domFrag=function(){return this.isCleared()?this.getDOMFragFromEnds():N(this._el)},w.prototype.setEnds=function(m){a("Selection ends are never empty",m[r]&&m[e]),this.ends=m},w.prototype.getEnd=function(m){return this.ends[m]},w.prototype.adopt=function(m,y,f){return this.clear(),M.prototype.adopt.call(this,m,y,f)},w.prototype.clear=function(){var m=this.getDOMFragFromEnds();return this.domFrag().replaceWith(m),this._el=void 0,this},w.prototype.join=function(m,y){return y===void 0&&(y=""),this.fold("",function(f,k){return f+y+k[m]()})},w}(B),he=function(){function M(w,m,y){this.textareaEventListeners={},this.id=w.id,this.data={},this.root=w,this.container=m,this.options=y,this.aria=new P(this.getControllerSelf()),this.ariaLabel="Math Input",this.ariaPostLabel="",w.controller=this.getControllerSelf(),this.cursor=w.cursor=new ee(w,y,this.getControllerSelf())}return M.prototype.getControllerSelf=function(){return this},M.prototype.handle=function(w,m){var y,f=this.options.handlers,k=(y=this.options.handlers)===null||y===void 0?void 0:y.fns[w];if(k){var L=f==null?void 0:f.APIClasses[this.KIND_OF_MQ];a("APIClass is defined",L);var G=new L(this);m===r||m===e?k(m,G):k(G)}},M.onNotify=function(w){M.notifyees.push(w)},M.prototype.notify=function(w){for(var m=0;m<M.notifyees.length;m+=1)M.notifyees[m](this.cursor,w);return this},M.prototype.setAriaLabel=function(w){var m=this.getAriaLabel();return!w&&this.editable?this.ariaLabel="Math Input":this.ariaLabel=w,w!==m&&!this.containerHasFocus()&&this.updateMathspeak(),this},M.prototype.getAriaLabel=function(){return this.ariaLabel!=="Math Input"?this.ariaLabel:this.editable?"Math Input":""},M.prototype.setAriaPostLabel=function(w,m){var y=this;return w&&typeof w=="string"&&w!==""?(w!==this.ariaPostLabel&&typeof m=="number"&&(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this._ariaAlertTimeout=setTimeout(function(){y.containerHasFocus()?y.aria.alert(y.root.mathspeak().trim()+" "+w.trim()):y.updateMathspeak()},m)),this.ariaPostLabel=w):(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this.ariaPostLabel=""),this},M.prototype.getAriaPostLabel=function(){return this.ariaPostLabel||""},M.prototype.containerHasFocus=function(){return document.activeElement&&this.container.contains(document.activeElement)},M.prototype.getTextarea=function(){var w=this.textarea;return a("textarea initialized",w),w},M.prototype.getTextareaSpan=function(){var w=this.textareaSpan;return a("textareaSpan initialized",w),w},M.prototype.addTextareaEventListeners=function(w){if(this.textarea)for(var m in w){var y=m;this.removeTextareaEventListener(y),this.textarea.addEventListener(y,w[y])}},M.prototype.removeTextareaEventListener=function(w){if(this.textarea){var m=this.textareaEventListeners[w];m&&this.textarea.removeEventListener(w,m)}},M.prototype.exportMathSpeak=function(){return this.root.mathspeak()},M.prototype.updateMathspeak=function(w){},M.prototype.scrollHoriz=function(){},M.prototype.selectionChanged=function(){},M.prototype.setOverflowClasses=function(){},M.notifyees=[],M}(),ae={},$={},se={handlers:!0,autoCommands:!0,quietEmptyDelimiters:!0,autoParenthesizedFunctions:!0,autoOperatorNames:!0,infixOperatorNames:!0,prefixOperatorNames:!0,leftRightIntoCmdGoes:!0,maxDepth:!0,interpretTildeAsSim:!0,disableAutoSubstitutionInSubscripts:!0},J={},ye=function(){function M(w){this.version=w}return M.prototype.assertJquery=function(){return a("Interface versions > 2 do not depend on JQuery",this.version<=2),a("JQuery is set for interface v < 3",this.jQuery),this.jQuery},M}(),Se=function(){function M(){}return M}(),Ce=function(){window.console&&console.warn(`You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},Te;function Ae(M){return Ce(),Te||(Te=te(1)),Te(M)}Ae.prototype=Se.prototype,Ae.VERSION="v0.10.1",Ae.interfaceVersion=function(M){if(M!==1)throw"Only interface version 1 supported. You specified: "+M;return Ce=function(){window.console&&console.warn(`You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},Ce(),Ae},Ae.getInterface=te;var je=te.MIN=1,ie=te.MAX=3;function te(M){if(M!==1&&M!==2&&M!==3)throw"Only interface versions between "+je+" and "+ie+" supported. You specified: "+M;var w=M;if(w<3){var m=window.jQuery;if(!m)throw"MathQuill interface version ".concat(w," requires jQuery 1.5.2+ to be loaded first");ye.prototype.jQuery=m}var y=ED(ED({},J),{handlers:function(pe){return{fns:pe||{},APIClasses:U}}});function f(pe,ne){for(var fe in ne)if(ne.hasOwnProperty(fe)){if(fe==="substituteKeyboardEvents"&&w>=3)throw new Error(["As of interface version 3, the 'substituteKeyboardEvents'","option is no longer supported. Use 'overrideTypedText' and","'overrideKeystroke' instead."].join(" "));var xe=ne[fe],Re=y[fe];pe[fe]=Re?Re(xe):xe}}var k=w<3?ye:function(pe){yt(ne,pe);function ne(){return pe!==null&&pe.apply(this,arguments)||this}return ne}(ye),L=function(pe){yt(ne,pe);function ne(fe){var xe=pe.call(this)||this;return xe.__controller=fe,xe.__options=fe.options,xe.id=fe.id,xe.data=fe.data,xe}return ne.prototype.mathquillify=function(fe){var xe=this.__controller,Re=xe.root,Ve=xe.container;xe.createTextarea();var Le=N(Ve).addClass(fe).children().detach();Re.setDOM(N(d("span",{class:"dcg-mq-root-block","aria-hidden":!0})).appendTo(Ve).oneElement()),A.linkElementByBlockNode(Re.domFrag().oneElement(),Re),this.latex(Le.text()),this.revert=function(){return xe.removeMouseEventListener(),N(Ve).removeClass("dcg-mq-editable-field dcg-mq-math-mode dcg-mq-text-mode").empty().append(Le),w<3?this.__options.assertJquery()(Ve):Ve}},ne.prototype.setAriaLabel=function(fe){return this.__controller.setAriaLabel(fe),this},ne.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},ne.prototype.config=function(fe){return f(this.__options,fe),fe.tabindex!==void 0&&this.__controller.setTabindex(fe.tabindex),this},ne.prototype.el=function(){return this.__controller.container},ne.prototype.text=function(){return this.__controller.exportText()},ne.prototype.mathspeak=function(){return this.__controller.exportMathSpeak()},ne.prototype.latex=function(fe){if(arguments.length>0){this.__controller.renderLatexMath(fe);var xe=this.__controller.cursor;return this.__controller.blurred&&xe.hide().parent.blur(xe),this}return this.__controller.exportLatex()},ne.prototype.selection=function(){return this.__controller.exportLatexSelection()},ne.prototype.html=function(){return this.__controller.root.domFrag().oneElement().innerHTML.replace(/ jQuery\d+="(?:\d+|null)"/g,"").replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?dcg-mq-cursor( dcg-mq-blink)?"?>.?<\/span>/i,"").replace(/ dcg-mq-hasCursor|dcg-mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},ne.prototype.reflow=function(){return this.__controller.root.postOrder(function(fe){fe.reflow()}),this},ne.prototype.focus=function(){return this.__controller.getTextarea().focus(),this.__controller.editable&&this.__controller.scrollHoriz(),this},ne.prototype.select=function(){return this.__controller.selectAll(),this},ne.prototype.blur=function(){return this.__controller.getTextarea().blur(),this},ne}(Se),G=function(pe){yt(ne,pe);function ne(){return pe!==null&&pe.apply(this,arguments)||this}return ne.prototype.mathquillify=function(fe){return pe.prototype.mathquillify.call(this,fe),this.__controller.editable=!0,this.__controller.addMouseEventListener(),this.__controller.editablesTextareaEvents(),this},ne.prototype.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},ne.prototype.write=function(fe){this.__controller.writeLatex(fe),this.__controller.scrollHoriz();var xe=this.__controller.cursor;return this.__controller.blurred&&xe.hide().parent.blur(xe),this},ne.prototype.empty=function(){var fe,xe=this.__controller.root,Re=this.__controller.cursor;return xe.setEnds((fe={},fe[r]=0,fe[e]=0,fe)),xe.domFrag().empty(),delete Re.selection,Re.insAtRightEnd(xe),this},ne.prototype.cmd=function(fe){var xe=this.__controller.notify(void 0),Re=xe.cursor;if(/^\\[a-z]+$/i.test(fe)&&!Re.isTooDeep()){fe=fe.slice(1);var Ve=V[fe],Le;Ve&&(Ve.constructor?Le=new Ve(fe):Le=Ve(fe),Re.selection&&Le.replaces(Re.replaceSelection()),Le.createLeftOf(Re.show()))}else Re.parent.write(Re,fe);return xe.scrollHoriz(),xe.blurred&&Re.hide().parent.blur(Re),this},ne.prototype.moveToDirEnd=function(fe){return this.__controller.notify("move").cursor.insAtDirEnd(fe,this.__controller.root),this},ne.prototype.moveToLeftEnd=function(){return this.moveToDirEnd(r)},ne.prototype.moveToRightEnd=function(){return this.moveToDirEnd(e)},ne.prototype.keystroke=function(fe,xe){for(var Re=fe.replace(/^\s+|\s+$/g,"").split(/\s+/),Ve=0;Ve<Re.length;Ve+=1)this.__controller.keystroke(Re[Ve],xe);return this},ne.prototype.typedText=function(fe){for(var xe=0;xe<fe.length;xe+=1)this.__controller.typedText(fe.charAt(xe));return this},ne.prototype.dropEmbedded=function(fe,xe,Re){var Ve=fe-_(),Le=xe-C(),et=document.elementFromPoint(Ve,Le);this.__controller.seek(et,Ve,Le);var Wt=new jd().setOptions(Re);Wt.createLeftOf(this.__controller.cursor)},ne.prototype.setAriaPostLabel=function(fe,xe){return this.__controller.setAriaPostLabel(fe,xe),this},ne.prototype.getAriaPostLabel=function(){return this.__controller.getAriaPostLabel()},ne.prototype.clickAt=function(fe,xe,Re){Re=Re||document.elementFromPoint(fe,xe);var Ve=this.__controller,Le=Ve.root,et=Le.domFrag().oneElement();return et.contains(Re)||(Re=et),Ve.seek(Re,fe,xe),Ve.blurred&&this.focus(),this},ne.prototype.ignoreNextMousedown=function(fe){return this.__controller.cursor.options.ignoreNextMousedown=fe,this},ne}(L),U={AbstractMathQuill:L,EditableField:G};a("API.StaticMath defined",ae.StaticMath),U.StaticMath=ae.StaticMath(U),a("API.MathField defined",ae.MathField),U.MathField=ae.MathField(U),a("API.InnerMathField defined",ae.InnerMathField),U.InnerMathField=ae.InnerMathField(U),ae.TextField&&(U.TextField=ae.TextField(U));var H=function(pe){if(!pe||!pe.nodeType)return null;for(var ne,fe=N(pe).children().toElementArray(),xe=0,Re=fe;xe<Re.length;xe++){var Ve=Re[xe];if(Ve.classList.contains("dcg-mq-root-block")){ne=Ve;break}}var Le=A.getNodeOfElement(ne),et=Le&&Le.controller,Wt=et&&U[et.KIND_OF_MQ];return et&&Wt?new Wt(et):null};H.L=r,H.R=e,H.config=function(pe){return f(k.prototype,pe),this},H.registerEmbed=function(pe,ne){if(!/^[a-z][a-z0-9]*$/i.test(pe))throw"Embed name must start with letter and be only letters and digits";$[pe]=ne},H.StaticMath=Q("StaticMath",U.StaticMath),H.MathField=Q("MathField",U.MathField),H.InnerMathField=Q("InnerMathField",U.InnerMathField),U.TextField&&(H.TextField=Q("TextField",U.TextField)),H.prototype=L.prototype,H.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"},H.EditableField.prototype=G.prototype,w<3&&(H.saneKeyboardEvents=Ni);function Q(pe,ne){a(pe+" is defined",ne);function fe(xe,Re){if(!xe||!xe.nodeType)return null;var Ve=H(xe);if(Ve instanceof ne)return Ve;var Le=new Xr(new ne.RootBlock,xe,new k(w));return Le.KIND_OF_MQ=pe,new ne(Le).__mathquillify(Re||{},w)}return fe.prototype=ne.prototype,fe}return H}Ae.noConflict=function(){return window.MathQuill=we,Ae};var we=window.MathQuill;window.MathQuill=Ae;function Ie(M){M.moveOutOf=function(w){a("controller is defined",this.controller),this.controller.handle("moveOutOf",w)},M.deleteOutOf=function(w){a("controller is defined",this.controller),this.controller.handle("deleteOutOf",w)},M.selectOutOf=function(w){a("controller is defined",this.controller),this.controller.handle("selectOutOf",w)},M.upOutOf=function(){a("controller is defined",this.controller),this.controller.handle("upOutOf")},M.downOutOf=function(){a("controller is defined",this.controller),this.controller.handle("downOutOf")},M.reflow=function(){a("controller is defined",this.controller),this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}function He(M,w){throw M?M="'"+M+"'":M="EOF","Parse Error: "+w+" at "+M}var ge=function(){function M(w){this._=w}return M.prototype.parse=function(w){return this.skip(M.eof)._(""+w,m,He);function m(y,f){return f}},M.prototype.or=function(w){a("or is passed a parser",w instanceof M);var m=this;return new M(function(y,f,k){return m._(y,f,L);function L(G){return w._(y,f,k)}})},M.prototype.then=function(w){var m=this;return new M(function(y,f,k){return m._(y,L,k);function L(G,U){var H=w instanceof M?w:w(U);return a("a parser is returned",H instanceof M),H._(G,f,k)}})},M.prototype.many=function(){var w=this;return new M(function(m,y,f){for(var k=[];w._(m,L,G););return y(m,k);function L(U,H){return m=U,k.push(H),!0}function G(){return!1}})},M.prototype.times=function(w,m){arguments.length<2&&(m=w);var y=this;return new M(function(f,k,L){for(var G=[],U=!0,H,Q=0;Q<w;Q+=1)if(U=!!y._(f,pe,ne),!U)return L(f,H);for(;Q<m&&U;Q+=1)y._(f,pe,fe);return k(f,G);function pe(xe,Re){return G.push(Re),f=xe,!0}function ne(xe,Re){return H=Re,f=xe,!1}function fe(xe,Re){return!1}})},M.prototype.result=function(w){return this.then(M.succeed(w))},M.prototype.atMost=function(w){return this.times(0,w)},M.prototype.atLeast=function(w){var m=this;return m.times(w).then(function(y){return m.many().map(function(f){return y.concat(f)})})},M.prototype.map=function(w){return this.then(function(m){return M.succeed(w(m))})},M.prototype.skip=function(w){return this.then(function(m){return w.result(m)})},M.string=function(w){var m=w.length,y="expected '"+w+"'";return new M(function(f,k,L){var G=f.slice(0,m);return G===w?k(f.slice(m),G):L(f,y)})},M.regex=function(w){a("regexp parser is anchored",w.toString().charAt(1)==="^");var m="expected "+w;return new M(function(y,f,k){var L=w.exec(y);if(L){var G=L[0];return f(y.slice(G.length),G)}else return k(y,m)})},M.succeed=function(w){return new M(function(m,y){return y(m,w)})},M.fail=function(w){return new M(function(m,y,f){return f(m,w)})},M.letter=M.regex(/^[a-z]/i),M.letters=M.regex(/^[a-z]*/i),M.digit=M.regex(/^[0-9]/),M.digits=M.regex(/^[0-9]*/),M.whitespace=M.regex(/^\s+/),M.optWhitespace=M.regex(/^\s*/),M.any=new M(function(w,m,y){return w?m(w.slice(1),w.charAt(0)):y(w,"expected any character")}),M.all=new M(function(w,m,y){return m("",w)}),M.eof=new M(function(w,m,y){return w?y(w,"expected EOF"):m(w,w)}),M}(),nt=function(){function M(){this.fn=i}return M.prototype.listen=function(w){this.fn=w,clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.fn)},M.prototype.listenOnce=function(w){var m=this;this.listen(function(){for(var y=[],f=0;f<arguments.length;f++)y[f]=arguments[f];m.clearListener(),w.apply(void 0,y)})},M.prototype.clearListener=function(){this.fn=i,clearTimeout(this.timeoutId)},M.prototype.trigger=function(){for(var w=[],m=0;m<arguments.length;m++)w[m]=arguments[m];this.fn.apply(this,w)},M}(),lt=function(){var M={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"},w={ArrowRight:"Right",ArrowLeft:"Left",ArrowDown:"Down",ArrowUp:"Up",Delete:"Del",Escape:"Esc"," ":"Spacebar"};function m(L){switch(f(L)){case"Right":case"Left":case"Down":case"Up":return!0}return!1}function y(L){return L.length===1&&L>="a"&&L<="z"}function f(L){var G;if(L.key===void 0){var U=L.which||L.keyCode;return M[U]||String.fromCharCode(U)}return y(L.key)?L.key.toUpperCase():(G=w[L.key])!==null&&G!==void 0?G:L.key}function k(L){var G=f(L),U=[];return L.ctrlKey&&U.push("Ctrl"),L.metaKey&&U.push("Meta"),L.altKey&&U.push("Alt"),L.shiftKey&&U.push("Shift"),U.length?(G!=="Alt"&&G!=="Control"&&G!=="Meta"&&G!=="Shift"&&U.push(G),U.join("-")):G}return function(G,U){var H=null,Q=null,pe=new nt;function ne(){try{G instanceof HTMLTextAreaElement&&G.select()}catch(Pt){}}function fe(Pt){pe.trigger(),pe.clearListener(),G instanceof HTMLTextAreaElement&&(G.value=Pt),Pt&&ne(),xe=!!Pt}var xe=!1;function Re(){return!("selectionStart"in G)||!(G instanceof HTMLTextAreaElement)?!1:G.selectionStart!==G.selectionEnd}function Ve(){U.options&&U.options.overrideKeystroke?U.options.overrideKeystroke(k(H),H):U.keystroke(k(H),H)}function Le(Pt){pe.trigger(Pt),Pt.target===G&&(H=Pt,Q=null,xe&&pe.listenOnce(function(Ao){Ao&&Ao.type==="focusout"||ne()}),Ve())}function et(Pt){pe.trigger(Pt),Pt.target===G&&(H&&Q&&Ve(),Q=Pt,m(Pt)?pe.listenOnce(St):pe.listen($e))}function Wt(Pt){pe.trigger(Pt),Pt.target===G&&H&&!Q&&(m(Pt)?pe.listenOnce(St):pe.listen($e))}function $e(){if(!Re()&&G instanceof HTMLTextAreaElement){var Pt=G.value;H&&(H.key==="Unidentified"||!H.altKey&&H.ctrlKey&&!H.metaKey&&H.shiftKey&&(H.key==="U"||H.key==="Process"))||(Pt.length===1?(G.value="",U.options&&U.options.overrideTypedText?U.options.overrideTypedText(Pt):U.typedText(Pt)):St())}}function St(){G instanceof HTMLTextAreaElement&&G.value.length>1&&ne()}function Cr(){H=null,Q=null,pe.clearListener(),G instanceof HTMLTextAreaElement&&(G.value="")}function yr(Pt){pe.trigger(),Pt.target===G&&(document.activeElement!==G&&G.focus(),pe.listen(function(){if(G instanceof HTMLTextAreaElement){var hi=G.value;G.value="",hi&&U.paste(hi)}}))}function Do(Pt){pe.trigger(Pt)}return U.KIND_OF_MQ==="StaticMath"?(U.addTextareaEventListeners({keydown:function(Pt){var Ao,hi;(hi=(Ao=U.options).overrideKeystroke)===null||hi===void 0||hi.call(Ao,k(Pt),Pt)}}),{select:fe}):(U.options&&U.options.disableCopyPaste?U.addTextareaEventListeners({keydown:Le,keypress:et,keyup:Wt,focusout:Cr,copy:function(Pt){Pt.preventDefault()},cut:function(Pt){Pt.preventDefault()},paste:function(Pt){pe.trigger(),Pt.preventDefault()},input:Do}):U.addTextareaEventListeners({keydown:Le,keypress:et,keyup:Wt,focusout:Cr,cut:function(){pe.listenOnce(function(){U.cut()})},copy:function(){pe.listenOnce(function(){U.copy()})},paste:yr,input:Do}),{select:fe})}}(),Me=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.exportText=function(){return this.root.foldChildren("",function(m,y){return m+y.text()})},w}(he);he.onNotify(function(M,w){if(w==="edit"||w==="replace"||w===void 0){var m=M.controller;if(!m||!m.options.enableDigitGrouping||m.blurred!==!1)return;m.disableGroupingForSeconds(1)}});var Nt=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.handleTextareaFocusEditable=function(){var y=m.cursor;m.updateMathspeak(),m.blurred=!1,clearTimeout(m.blurTimeout),N(m.container).addClass("dcg-mq-focused"),y.parent||y.insAtRightEnd(m.root),y.selection?(y.selection.domFrag().removeClass("dcg-mq-blur"),m.selectionChanged()):y.show(),m.setOverflowClasses()},m.handleTextareaBlurEditable=function(){m.textareaSelectionTimeout&&(clearTimeout(m.textareaSelectionTimeout),m.textareaSelectionTimeout=0),m.disableGroupingForSeconds(0),m.blurred=!0,m.blurTimeout=setTimeout(function(){m.root.postOrder(function(y){y.intentionalBlur()}),m.cursor.clearSelection().endSelection(),m.blur(),m.updateMathspeak({emptyContent:!0}),m.scrollHoriz()}),window.addEventListener("blur",m.handleWindowBlur)},m.handleTextareaFocusStatic=function(){m.cursor.selection||m.cursor.controller.selectAll(),m.blurred=!1},m.handleTextareaBlurStatic=function(){m.cursor.clearSelection(),m.updateMathspeak({emptyContent:!0})},m.handleWindowBlur=function(){clearTimeout(m.blurTimeout),m.cursor.selection&&m.cursor.selection.domFrag().addClass("dcg-mq-blur"),m.blurWithoutResettingCursor(),m.updateMathspeak({emptyContent:!0})},m}return w.prototype.disableGroupingForSeconds=function(m){var y=this;clearTimeout(this.__disableGroupingTimeout),m===0?this.root.domFrag().removeClass("dcg-mq-suppress-grouping"):(this.root.domFrag().addClass("dcg-mq-suppress-grouping"),this.__disableGroupingTimeout=setTimeout(function(){y.root.domFrag().removeClass("dcg-mq-suppress-grouping")},m*1e3))},w.prototype.blur=function(){this.blurWithoutResettingCursor(),this.options&&this.options.resetCursorOnBlur&&this.cursor.resetToEnd(this)},w.prototype.blurWithoutResettingCursor=function(){this.cursor.hide().parent.blur(this.cursor),N(this.container).removeClass("dcg-mq-focused"),window.removeEventListener("blur",this.handleWindowBlur)},w.prototype.addEditableFocusBlurListeners=function(){var m=this,y=m.cursor;this.addTextareaEventListeners({focus:this.handleTextareaFocusEditable,blur:this.handleTextareaBlurEditable}),m.blurred=!0,y.hide().parent.blur(y)},w.prototype.addStaticFocusBlurListeners=function(){this.addTextareaEventListeners({focus:this.handleTextareaFocusStatic,blur:this.handleTextareaBlurStatic})},w}(Me),Tt=!1,Et=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.keystroke=function(m,y,f){var k=f.cursor;switch(m){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":f.ctrlDeleteDir(r);break;case"Shift-Backspace":case"Backspace":f.backspace();break;case"Esc":case"Tab":f.escapeDir(e,m,y);return;case"Shift-Tab":case"Shift-Esc":f.escapeDir(r,m,y);return;case"End":f.notify("move").cursor.insAtRightEnd(k.parent),f.aria.queue("end of").queue(k.parent,!0);break;case"Ctrl-End":f.notify("move").cursor.insAtRightEnd(f.root),f.aria.queue("end of").queue(f.ariaLabel).queue(f.root).queue(f.ariaPostLabel);break;case"Shift-End":f.selectToBlockEndInDir(e);break;case"Ctrl-Shift-End":f.selectToRootEndInDir(e);break;case"Home":f.notify("move").cursor.insAtLeftEnd(k.parent),f.aria.queue("beginning of").queue(k.parent,!0);break;case"Ctrl-Home":f.notify("move").cursor.insAtLeftEnd(f.root),f.aria.queue("beginning of").queue(f.ariaLabel).queue(f.root).queue(f.ariaPostLabel);break;case"Shift-Home":f.selectToBlockEndInDir(r);break;case"Ctrl-Shift-Home":f.selectToRootEndInDir(r);break;case"Left":f.moveLeft();break;case"Shift-Left":f.selectLeft();break;case"Ctrl-Left":break;case"Right":f.moveRight();break;case"Shift-Right":f.selectRight();break;case"Ctrl-Right":break;case"Up":f.moveUp();break;case"Down":f.moveDown();break;case"Shift-Up":f.withIncrementalSelection(function(L){if(k[r])for(;k[r];)L(r);else L(r)});break;case"Shift-Down":f.withIncrementalSelection(function(L){if(k[e])for(;k[e];)L(e);else L(e)});break;case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":f.ctrlDeleteDir(e);break;case"Shift-Del":case"Del":f.deleteForward();break;case"Meta-A":case"Ctrl-A":f.selectAll();break;case"Ctrl-Alt-Up":k.parent.parent&&k.parent.parent instanceof w?f.aria.queue(k.parent.parent):f.aria.queue("nothing above");break;case"Ctrl-Alt-Down":k.parent&&k.parent instanceof w?f.aria.queue(k.parent):f.aria.queue("block is empty");break;case"Ctrl-Alt-Left":k.parent.parent&&k.parent.parent.getEnd(r)?f.aria.queue(k.parent.parent.getEnd(r)):f.aria.queue("nothing to the left");break;case"Ctrl-Alt-Right":k.parent.parent&&k.parent.parent.getEnd(e)?f.aria.queue(k.parent.parent.getEnd(e)):f.aria.queue("nothing to the right");break;case"Ctrl-Alt-Shift-Down":k.selection?f.aria.queue(k.selection.join("mathspeak"," ").trim()+" selected"):f.aria.queue("nothing selected");break;case"Ctrl-Alt-=":case"Ctrl-Alt-Shift-Right":f.ariaPostLabel.length?f.aria.queue(f.ariaPostLabel):f.aria.queue("no answer");break;default:return}f.aria.alert(),y==null||y.preventDefault(),f.scrollHoriz()},w.prototype.moveOutOf=function(m,y,f){a("overridden or never called on this node",!1)},w.prototype.moveTowards=function(m,y,f){a("overridden or never called on this node",!1)},w.prototype.deleteOutOf=function(m,y){a("overridden or never called on this node",!1)},w.prototype.deleteTowards=function(m,y){a("overridden or never called on this node",!1)},w.prototype.unselectInto=function(m,y){a("overridden or never called on this node",!1)},w.prototype.selectOutOf=function(m,y){a("overridden or never called on this node",!1)},w.prototype.selectTowards=function(m,y){a("overridden or never called on this node",!1)},w}(A);he.onNotify(function(M,w){(w==="move"||w==="upDown")&&M.show().clearSelection()}),J.leftRightIntoCmdGoes=function(M){if(M&&M!=="up"&&M!=="down")throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+M+'"';return M},he.onNotify(function(M,w){w!=="upDown"&&(M.upDownCache={})}),he.onNotify(function(M,w){w==="edit"&&M.show().deleteSelection()}),he.onNotify(function(M,w){w!=="select"&&M.endSelection()});var gr=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.keystroke=function(m,y){this.cursor.parent.keystroke(m,y,this.getControllerSelf())},w.prototype.escapeDir=function(m,y,f){s(m);var k=this.cursor;if(k.parent!==this.root&&(f==null||f.preventDefault()),k.parent!==this.root)return k.clearSelection(),k.parent.moveOutOf(m,k),k.controller.aria.alert(),this.notify("move")},w.prototype.moveDir=function(m){s(m);var y=this.cursor,f=y.options.leftRightIntoCmdGoes,k=y[m];return y.selection?y.insDirOf(m,y.selection.getEnd(m)):k?k.moveTowards(m,y,f):y.parent.moveOutOf(m,y,f),this.notify("move")},w.prototype.moveLeft=function(){return this.moveDir(r)},w.prototype.moveRight=function(){return this.moveDir(e)},w.prototype.moveUp=function(){return this.moveUpDown("up")},w.prototype.moveDown=function(){return this.moveUpDown("down")},w.prototype.moveUpDown=function(m){var y=this,f=y.notify("upDown").cursor,k,L;m==="up"?(k="upInto",L="upOutOf"):(k="downInto",L="downOutOf");var G=f[r],U=f[e],H=U&&U[k],Q=G&&G[k];return H?f.insAtLeftEnd(H):Q?f.insAtRightEnd(Q):f.parent.bubble(function(pe){var ne=pe[L];if(ne&&(typeof ne=="function"&&(ne=ne.call(pe,f)),ne instanceof Et&&f.jumpUpDown(pe,ne),ne!==!0))return!1}),y},w.prototype.deleteDir=function(m){s(m);var y=this.cursor,f=y[m],k=y.parent.parent,L=y.controller;if(f&&f instanceof Et)f.sides?L.aria.queue(f.parent.chToCmd(f.sides[-m].ch).mathspeak({createdLeftOf:y})):!f.blocks&&f.parent.ctrlSeq!=="\\text"&&L.aria.queue(f);else if(k&&k instanceof Et)if(k.sides)L.aria.queue(k.parent.chToCmd(k.sides[m].ch).mathspeak({createdLeftOf:y}));else if(k.blocks&&k.mathspeakTemplate)if(k.upInto&&k.downInto)L.aria.queue(k.mathspeakTemplate[1]);else{var G=k.mathspeakTemplate,U=m===r?G[0]:G[G.length-1];L.aria.queue(U)}else L.aria.queue(k);var H=y.selection;if(this.notify("edit"),!H){var Q=y[m];Q?Q.deleteTowards(m,y):y.parent.deleteOutOf(m,y)}var pe=y[r],ne=y[e];return pe.siblingDeleted&&pe.siblingDeleted(y.options,e),ne.siblingDeleted&&ne.siblingDeleted(y.options,r),y.parent.bubble(function(fe){fe.reflow()}),this},w.prototype.ctrlDeleteDir=function(m){s(m);var y=this.cursor;if(!y[m]||y.selection)return this.deleteDir(m);this.notify("edit");var f;m===r?f=new B(y.parent.getEnd(r),y[r]):f=new B(y[e],y.parent.getEnd(e)),y.controller.aria.queue(f),f.remove(),y.insAtDirEnd(m,y.parent);var k=y[r],L=y[e];return k&&k.siblingDeleted(y.options,e),L&&L.siblingDeleted(y.options,r),y.parent.bubble(function(G){G.reflow()}),this},w.prototype.backspace=function(){return this.deleteDir(r)},w.prototype.deleteForward=function(){return this.deleteDir(e)},w.prototype.startIncrementalSelection=function(){a("Multiple selections can't be simultaneously open",!Tt),Tt=!0,this.notify("select");var m=this.cursor;m.anticursor||m.startSelection()},w.prototype.selectDirIncremental=function(m){a("A selection is open",Tt),Tt=!0;var y=this.cursor,f=y.selection;s(m);var k=y[m];k?f&&f.getEnd(m)===k&&y.anticursor[-m]!==k?k.unselectInto(m,y):k.selectTowards(m,y):y.parent.selectOutOf(m,y)},w.prototype.finishIncrementalSelection=function(){a("A selection is open",Tt);var m=this.cursor;m.clearSelection(),m.select()||m.show();var y=m.selection;y&&m.controller.aria.clear().queue(y.join("mathspeak"," ").trim()+" selected"),Tt=!1},w.prototype.withIncrementalSelection=function(m){var y=this;try{this.startIncrementalSelection();try{m(function(f){return y.selectDirIncremental(f)})}finally{this.finishIncrementalSelection()}}finally{Tt=!1}},w.prototype.selectDir=function(m){this.withIncrementalSelection(function(y){return y(m)})},w.prototype.selectLeft=function(){return this.selectDir(r)},w.prototype.selectRight=function(){return this.selectDir(e)},w.prototype.selectAll=function(){this.notify("move");var m=this.cursor;m.insAtRightEnd(this.root),this.withIncrementalSelection(function(y){for(;m[r];)y(r)})},w.prototype.selectToBlockEndInDir=function(m){var y=this.cursor;this.withIncrementalSelection(function(f){for(;y[m];)f(m)})},w.prototype.selectToRootEndInDir=function(m){var y=this,f=this.cursor;this.withIncrementalSelection(function(k){for(;f[m]||f.parent!==y.root;)k(m)})},w}(Nt),de=function(M){yt(w,M);function w(m){return M.call(this)||this}return w}(Et),le=function(){function M($e){var St=new De;return $e.adopt(St,0,0),St}function w($e){for(var St=$e[0]||new De,Cr=1;Cr<$e.length;Cr+=1)$e[Cr].children().adopt(St,St.getEnd(e),0);return St}var m=ge.string,y=ge.regex,f=ge.letter,k=ge.digit,L=ge.any,G=ge.optWhitespace,U=ge.succeed,H=ge.fail,Q=f.map(function($e){return new qt($e)}),pe=k.map(function($e){return new Yt($e)}),ne=y(/^[^${}\\_^]/).map(function($e){return new ke($e)}),fe=y(/^[^\\a-eg-zA-Z]/).or(m("\\").then(y(/^[a-z]+/i).or(y(/^\s+/).result(" ")).or(L))).then(function($e){var St=V[$e];if(St)if(St.constructor){var Cr=St;return new Cr($e).parser()}else{var yr=St;return yr($e).parser()}else return H("unknown command: \\"+$e)}),xe=fe.or(Q).or(pe).or(ne),Re=m("{").then(function(){return Le}).skip(m("}")),Ve=G.then(Re.or(xe.map(M))),Le=Ve.many().map(w).skip(G),et=m("[").then(Ve.then(function($e){return $e.join("latex")!=="]"?U($e):H("")}).many().map(w).skip(G)).skip(m("]")),Wt=Le;return Wt.block=Ve,Wt.optBlock=et,Wt}();J.maxDepth=function(M){return typeof M=="number"?M:void 0};var Fe=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.cleanLatex=function(m){return m.replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},w.prototype.exportLatex=function(){return this.cleanLatex(this.root.latex())},w.prototype.writeLatex=function(m){var y=this.notify("edit").cursor;return y.parent.writeLatex(y,m),this},w.prototype.exportLatexSelection=function(){var m={latex:"",startIndex:-1,endIndex:-1},y=this.cursor.selection;if(y)m.startSelectionBefore=y.getEnd(r),m.endSelectionAfter=y.getEnd(e);else{var f=this.cursor[r];f?m.startSelectionAfter=f:m.startSelectionBefore=this.cursor.parent;var k=this.cursor[e];k?m.endSelectionBefore=k:m.endSelectionAfter=this.cursor.parent}this.root.latexRecursive(m);for(var L=m.latex,G=this.cleanLatex(L),U=m.startIndex,H=m.endIndex,Q=0,pe=0;pe<m.endIndex;pe++)L[pe]!==G[Q]?(pe<m.startIndex&&(U-=1),H-=1):Q+=1;return{latex:G,startIndex:U,endIndex:H}},w.prototype.classifyLatexForEfficientUpdate=function(m){if(typeof m=="string"){var y=m.match(/-?[0-9.]+$/g);if(y&&y.length===1)return{latex:m,prefix:m.substr(0,m.length-y[0].length),digits:y[0]}}},w.prototype.updateLatexMathEfficiently=function(m,y){var f,k,L,G,U=this.root,H,Q=this.classifyLatexForEfficientUpdate(m);if(Q){if(H=this.classifyLatexForEfficientUpdate(y),!H||H.prefix!==Q.prefix)return!1}else return!1;var pe=H.digits,ne=Q.digits,fe=!1,xe=!1;pe[0]==="-"&&(fe=!0,pe=pe.substr(1)),ne[0]==="-"&&(xe=!0,ne=ne.substr(1));for(var Re=this.root.getEnd(e),Ve=[],Le=pe.length-1;Le>=0;Le--){if(!Re||Re.ctrlSeq!==pe[Le]||Re.parent!==U)return!1;Ve.unshift(Re),Re=Re[r]}if(fe&&!xe){var et=Re;if(!et||et.ctrlSeq!=="-"||et[e]!==Ve[0]||et.parent!==U)return!1;var Wt=et[r];if(Wt&&Wt.parent!==U)return!1;Ve[0][r]=et[r],U.getEnd(r)===et&&U.setEnds((f={},f[r]=Ve[0],f[e]=U.getEnd(e),f)),Wt&&(Wt[e]=Ve[0]),et.domFrag().remove()}if(!fe&&xe){var $e=new Hd("-"),St=document.createElement("span");St.textContent="-",$e.setDOM(St);var Cr=Ve[0][r];Cr&&(Cr[e]=$e),U.getEnd(r)===Ve[0]&&U.setEnds((k={},k[r]=$e,k[e]=U.getEnd(e),k)),$e.parent=U,$e[r]=Ve[0][r],$e[e]=Ve[0],Ve[0][r]=$e,$e.contactWeld(this.cursor),$e.domFrag().insertBefore(Ve[0].domFrag())}var yr=Math.min(pe.length,ne.length);for(Le=0;Le<yr;Le++){var Do=ne[Le];Re=Ve[Le],Re.ctrlSeq!==Do&&(Re.ctrlSeq=Do,Re.domFrag().oneElement().textContent=Do,Re.mathspeakName=Do)}if(pe.length>ne.length)for(Re=Ve[ne.length-1],U.setEnds((L={},L[r]=U.getEnd(r),L[e]=Re,L)),Re[e]=0,Le=pe.length-1;Le>=yr;Le--)Ve[Le].domFrag().remove();if(ne.length>pe.length){var Pt=document.createDocumentFragment();for(Le=yr;Le<ne.length;Le++){var Ao=document.createElement("span");Ao.className="dcg-mq-digit",Ao.textContent=ne[Le];var hi=new Yt(ne[Le]);hi.parent=U,hi.setDOM(Ao),Pt.appendChild(Ao),hi[r]=U.getEnd(e),hi[e]=0;var pR=hi[r];pR[e]=hi,U.setEnds((G={},G[r]=U.getEnd(r),G[e]=hi,G))}U.domFrag().oneElement().appendChild(Pt)}var A6=this.exportLatex();if(A6!==m)return console.warn("tried updating latex efficiently but did not work. Attempted: "+m+" but wrote: "+A6),!1;var L6=U.getEnd(e);return L6&&L6.fixDigitGrouping(this.cursor.options),!0},w.prototype.renderLatexMathFromScratch=function(m){var y,f=this.root,k=this.cursor,L=ge.all,G=ge.eof,U=le.skip(G).or(L.result(!1)).parse(m);if(f.setEnds((y={},y[r]=0,y[e]=0,y)),U&&U.children().adopt(f,0,0),U){var H=f.domFrag();H.children().remove(),H.oneElement().appendChild(U.html()),f.finalizeInsert(k.options,k)}else f.domFrag().empty()},w.prototype.renderLatexMath=function(m){var y=this.cursor,f=this.root;this.notify("replace"),y.clearSelection();var k=this.exportLatex();(!f.getEnd(r)||!f.getEnd(e)||k!==m)&&(this.updateLatexMathEfficiently(m,k)||this.renderLatexMathFromScratch(m),this.updateMathspeak()),y.insAtRightEnd(f)},w.prototype.renderLatexText=function(m){var y,f=this.root,k=this.cursor;f.domFrag().children().slice(1).remove(),f.setEnds((y={},y[r]=0,y[e]=0,y)),delete k.selection,k.show().insAtRightEnd(f);var L=ge.regex,G=ge.string,U=ge.eof,H=ge.all,Q=G("$").then(le).skip(G("$").or(U)).map(function(Ve){var Le=new RootMathCommand(k);Le.createBlocks();var et=Le.getEnd(r);return Ve.children().adopt(et,0,0),Le}),pe=G("\\$").result("$"),ne=pe.or(L(/^[^$]/)).map(function(Ve){return new ke(Ve)}),fe=Q.or(ne).many(),xe=fe.skip(U).or(H.result(!1)).parse(m);if(xe){for(var Re=0;Re<xe.length;Re+=1)xe[Re].adopt(f,f.getEnd(e),0);N(f.html()).appendTo(f.domFrag().oneElement()),f.finalizeInsert(k.options,k)}},w}(gr),be=function(M){return!1};ye.prototype.ignoreNextMousedown=be;var it;(function(){he.onNotify(function(M,w){(w==="edit"||w==="replace")&&it&&it.cursor===M&&it.cb()})})();var Ye=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.handleMouseDown=function(y){var f=p(y.target,".dcg-mq-root-block"),k=f&&A.getNodeOfElement(f)||A.getNodeOfElement(m.root.domFrag().oneElement()),L=k.domFrag().firstNode().ownerDocument,G=k.controller,U=G.cursor,H=U.blink,Q=G.getTextarea();if(y.preventDefault(),y.target.unselectable=!0,U.options.ignoreNextMousedown(y)||p(y.target,".dcg-mq-ignore-mousedown"))return;var pe=null;function ne(et){pe=et.target}function fe(et){U.anticursor||U.startSelection(),G.seek(pe,et.clientX,et.clientY).cursor.select(),U.selection&&U.controller.aria.clear().queue(U.selection.join("mathspeak")+" selected").alert(),pe=null}function xe(){f==null||f.removeEventListener("mousemove",ne),L==null||L.removeEventListener("mousemove",fe),L==null||L.removeEventListener("mouseup",Ve),it=void 0}function Re(){G.editable&&(U.show(),U.controller.aria.queue(U.parent).alert())}function Ve(){U.blink=H,U.selection||Re(),xe()}var Le;it={cursor:U,cb:function(){Le=!0,U.blink=H,U.clearSelection(),Re(),xe()}},!(G.blurred&&(m.editable&&Q.focus(),Le))&&(U.blink=i,G.seek(y.target,y.clientX,y.clientY).cursor.startSelection(),f==null||f.addEventListener("mousemove",ne),L==null||L.addEventListener("mousemove",fe),L==null||L.addEventListener("mouseup",Ve))},m}return w.prototype.addMouseEventListener=function(){this.container.addEventListener("mousedown",this.handleMouseDown)},w.prototype.removeMouseEventListener=function(){this.container.removeEventListener("mousedown",this.handleMouseDown)},w.prototype.seek=function(m,y,f){for(var k=this.notify("select").cursor,L;m&&(L=A.getNodeOfElement(m),!L);)m=m.parentElement;return L||(L=this.root),k.clearSelection().show(),L.seek(y,k),this.scrollHoriz(),this},w}(Fe),_r=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.setOverflowClasses=function(){var m=this.root.domFrag().oneElement(),y=!1,f=!1;if(!this.blurred){var k=I(m).width,L=m.scrollWidth,G=m.scrollLeft;y=L>k+G,f=G>0}m.classList.contains("dcg-mq-editing-overflow-right")!==y&&m.classList.toggle("dcg-mq-editing-overflow-right"),m.classList.contains("dcg-mq-editing-overflow-left")!==f&&m.classList.toggle("dcg-mq-editing-overflow-left")},w.prototype.scrollHoriz=function(){var m=this,y=this.cursor,f=y.selection,k=I(this.root.domFrag().oneElement());if(y.domFrag().isEmpty()&&!f){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var L=this.root.domFrag().oneElement(),G=L.scrollLeft;D(this.getScrollAnimationDuration(),function(Ve,Le,et){Ve>=1?(m.cancelScrollHoriz=void 0,L.scrollLeft=0,m.setOverflowClasses()):(m.cancelScrollHoriz=et,Le(),L.scrollLeft=Math.round((1-Ve)*G))});return}else if(f){var Q=I(f.domFrag().oneElement()),pe=Q.left-(k.left+20),ne=Q.right-(k.right-20);if(f.getEnd(r)===y[e])if(pe<0)var H=pe;else if(ne>0)if(Q.left-ne<k.left+20)var H=pe;else var H=ne;else return;else if(ne>0)var H=ne;else if(pe<0)if(Q.right-pe>k.right-20)var H=ne;else var H=pe;else return}else{var U=I(y.domFrag().oneElement()).left;if(U>k.right-20)var H=U-(k.right-20);else if(U<k.left+20)var H=U-(k.left+20);else return}var fe=this.root.domFrag().oneElement();if(!(H<0&&fe.scrollLeft===0)&&!(H>0&&fe.scrollWidth<=fe.scrollLeft+k.width)){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var xe=this.root.domFrag().oneElement(),Re=xe.scrollLeft;D(this.getScrollAnimationDuration(),function(Ve,Le,et){Ve>=1?(m.cancelScrollHoriz=void 0,xe.scrollLeft=Math.round(Re+H),m.setOverflowClasses()):(m.cancelScrollHoriz=et,Le(),xe.scrollLeft=Math.round(Re+Ve*H))})}},w.prototype.getScrollAnimationDuration=function(){var m;return(m=this.options.scrollAnimationDuration)!==null&&m!==void 0?m:100},w}(Ye);ye.prototype.substituteTextarea=function(){return d("textarea",{autocapitalize:"off",autocomplete:"off",autocorrect:"off",spellcheck:!1,"x-palm-disable-ste-all":!0})};function ht(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(M){var w=Math.random()*16|0,m=M==="x"?w:w&3|8;return m.toString(16)})}function Ni(M,w){return lt(M[0],w)}ye.prototype.substituteKeyboardEvents=Ni;var Xr=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.selectFn=i,m}return w.prototype.createTextarea=function(){this.textareaSpan=d("span",{class:"dcg-mq-textarea"});var m=this.options.substituteTextarea();if(!m.nodeType)throw"substituteTextarea() must return a DOM element, got "+m;this.textarea=N(m).appendTo(this.textareaSpan).oneElement(),this.mathspeakSpan||(this.mathspeakId=ht(),this.mathspeakSpan=d("span",{class:"dcg-mq-mathspeak",id:this.mathspeakId}),N(this.textareaSpan).prepend(N(this.mathspeakSpan))),this.mathspeakId&&(m==null||m.setAttribute("aria-labelledby",this.mathspeakId));var y=this;y.cursor.selectionChanged=function(){y.selectionChanged()};var f=this.options.tabindex!==void 0?this.options.tabindex:this.KIND_OF_MQ==="StaticMath"?-1:0;this.setTabindex(f)},w.prototype.setTabindex=function(m){var y,f,k,L,G;m===this.previousTabindex||!this.textarea||(this.previousTabindex=m,(y=this.textarea)===null||y===void 0||y.setAttribute("tabindex",""+m),m<0&&this.KIND_OF_MQ==="StaticMath"?(f=this.textarea)===null||f===void 0||f.setAttribute("aria-hidden","true"):(k=this.textarea)===null||k===void 0||k.removeAttribute("aria-hidden"),m>=0?(L=this.mathspeakSpan)===null||L===void 0||L.setAttribute("aria-hidden","true"):(G=this.mathspeakSpan)===null||G===void 0||G.removeAttribute("aria-hidden"))},w.prototype.selectionChanged=function(){var m=this;m.textareaSelectionTimeout||(m.textareaSelectionTimeout=setTimeout(function(){m.setTextareaSelection()}))},w.prototype.setTextareaSelection=function(){this.textareaSelectionTimeout=0;var m="";this.cursor.selection&&(m=this.cleanLatex(this.cursor.selection.join("latex")),this.options.statelessClipboard&&(m="$"+m+"$")),this.selectFn(m)},w.prototype.staticMathTextareaEvents=function(){var m=this;this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste"),m.options.disableCopyPaste?this.removeTextareaEventListener("copy"):this.addTextareaEventListeners({copy:function(){m.setTextareaSelection()}}),this.addStaticFocusBlurListeners();var y=this.getTextarea(),f=lt(y,this).select;this.selectFn=f;var k=this.getTextareaSpan();N(this.container).prepend(N(k))},w.prototype.editablesTextareaEvents=function(){var m=this,y=m.getTextarea(),f=m.getTextareaSpan();if(this.options.version<3){var k=this.options.assertJquery(),L=this.options.substituteKeyboardEvents(k(y),this);this.selectFn=function(U){L.select(U)}}else{var G=lt(y,this).select;this.selectFn=G}N(this.container).prepend(N(f)),this.addEditableFocusBlurListeners(),this.updateMathspeak()},w.prototype.unbindEditablesEvents=function(){var m=this,y=m.getTextarea(),f=m.getTextareaSpan();this.selectFn=function(k){y instanceof HTMLTextAreaElement&&(y.value=k,k&&y.select())},N(f).remove(),this.removeTextareaEventListener("focus"),this.removeTextareaEventListener("blur"),m.blurred=!0,this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste")},w.prototype.typedText=function(m){if(m===`
`)return this.handle("enter");var y=this.notify(void 0).cursor;y.parent.write(y,m),this.scrollHoriz()},w.prototype.cut=function(){var m=this,y=m.cursor;y.selection&&setTimeout(function(){m.notify("edit"),y.parent.bubble(function(f){f.reflow()}),m.options&&m.options.onCut&&m.options.onCut()})},w.prototype.copy=function(){this.setTextareaSelection()},w.prototype.paste=function(m){this.options.statelessClipboard&&(m.slice(0,1)==="$"&&m.slice(-1)==="$"?m=m.slice(1,-1):m="\\text{"+m+"}"),this.writeLatex(m).cursor.show(),this.scrollHoriz(),this.options&&this.options.onPaste&&this.options.onPaste()},w.prototype.setupStaticField=function(){this.updateMathspeak(),this.blurred=!0,this.cursor.hide().parent.blur(this.cursor)},w.prototype.updateMathspeak=function(m){var y=this,f=y.getAriaLabel(),k=/[A-Za-z0-9]$/.test(f)?f+":":f,L=y.root.mathspeak().trim(),G=!!(m!=null&&m.emptyContent);this.aria.clear({emptyContent:G}),y.mathspeakSpan&&(y.mathspeakSpan.textContent=(k+" "+L+" "+y.ariaPostLabel).trim())},w}(_r),mo=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.finalizeInsert=function(m,y){var f=this;f.postOrder(function(G){G.finalizeTree(m)}),f.postOrder(function(G){G.contactWeld(y)}),f.postOrder(function(G){G.blur(y)}),f.postOrder(function(G){G.reflow()});var k=f[e],L=f[r];k&&k.siblingCreated(m,r),L&&L.siblingCreated(m,e),f.bubble(function(G){G.reflow()})},w.prototype.prepareInsertionAt=function(m){var y=m.options.maxDepth;if(y!==void 0){var f=m.depth();if(f>y)return!1;this.removeNodesDeeperThan(y-f)}return!0},w.prototype.removeNodesDeeperThan=function(m){for(var y=0,f=[[this,y]],k;k=f.shift();){var L=k;L[0].children().each(function(G){var U=G instanceof De?1:0;y=L[1]+U,y<=m?f.push([G,y]):(U?G.children():G).remove()})}},w}(Et),Ze=function(){function M(w,m){this.childCount=w,this.render=m}return M}(),pt=function(M){yt(w,M);function w(m,y,f){var k=M.call(this)||this;return k.textTemplate=[""],k.mathspeakTemplate=[""],k.setCtrlSeqHtmlAndText(m,y,f),k}return w.prototype.setEnds=function(m){a("MathCommand ends are never empty",m[r]&&m[e]),this.ends=m},w.prototype.getEnd=function(m){return this.ends[m]},w.prototype.setCtrlSeqHtmlAndText=function(m,y,f){this.ctrlSeq||(this.ctrlSeq=m),y&&(this.domView=y),f&&(this.textTemplate=f)},w.prototype.replaces=function(m){m.disown(),this.replacedFragment=m},w.prototype.isEmpty=function(){return this.foldChildren(!0,function(m,y){return m&&y.isEmpty()})},w.prototype.parser=function(){var m=this,y=le.block;return y.times(this.numBlocks()).map(function(f){m.blocks=f;for(var k=0;k<f.length;k+=1)f[k].adopt(m,m.getEnd(e),0);return m})},w.prototype.createLeftOf=function(m){var y=this,f=y.replacedFragment;if(y.createBlocks(),M.prototype.createLeftOf.call(this,m),f){var k=y.getEnd(r);f.adopt(k,0,0),f.domFrag().appendTo(k.domFrag().oneElement()),y.placeCursor(m),y.prepareInsertionAt(m)}y.finalizeInsert(m.options,m),y.placeCursor(m)},w.prototype.createBlocks=function(){for(var m=this,y=m.numBlocks(),f=m.blocks=Array(y),k=0;k<y;k+=1){var L=f[k]=new De;L.adopt(m,m.getEnd(e),0)}},w.prototype.placeCursor=function(m){m.insAtRightEnd(this.foldChildren(this.getEnd(r),function(y,f){return y.isEmpty()?y:f}))},w.prototype.moveTowards=function(m,y,f){var k;f==="up"?k=this.upInto:f==="down"&&(k=this.downInto);var L=k||this.getEnd(-m);y.insAtDirEnd(-m,L),y.controller.aria.queueDirEndOf(-m).queue(y.parent,!0)},w.prototype.deleteTowards=function(m,y){this.isEmpty()?y[m]=this.remove()[m]:this.moveTowards(m,y)},w.prototype.selectTowards=function(m,y){y[-m]=this,y[m]=this[m]},w.prototype.selectChildren=function(){return new ue(this,this)},w.prototype.unselectInto=function(m,y){var f=y.anticursor,k=f.ancestors[this.id];y.insAtDirEnd(-m,k)},w.prototype.seek=function(m,y){function f(U){var H,Q=U.domFrag().oneElement(),pe=I(Q).left,ne=pe+Q.offsetWidth;return H={},H[r]=pe,H[e]=ne,H}var k=this,L=f(k);if(m<L[r])return y.insLeftOf(k);if(m>L[e])return y.insRightOf(k);var G=L[r];k.eachChild(function(U){var H=f(U);if(m<H[r])return m-G<H[r]-m?U[r]?y.insAtRightEnd(U[r]):y.insLeftOf(k):y.insAtLeftEnd(U),!1;if(m>H[e]){U[e]?G=H[e]:L[e]-m<m-H[e]?y.insRightOf(k):y.insAtRightEnd(U);return}else return U.seek(m,y),!1})},w.prototype.numBlocks=function(){return this.domView.childCount},w.prototype.html=function(){var m=this.blocks;a("domView is defined",this.domView);var y=this.domView,f=y.render(m||[]);return this.setDOM(f),A.linkElementByCmdNode(f,this),f},w.prototype.latexRecursive=function(m){this.checkCursorContextOpen(m),m.latex+=this.ctrlSeq||"",this.eachChild(function(y){m.latex+="{";var f=m.latex.length;y.latexRecursive(m);var k=m.latex.length;f===k&&(m.latex+=" "),m.latex+="}"}),this.checkCursorContextClose(m)},w.prototype.text=function(){var m=this,y=0;return m.foldChildren(m.textTemplate[y],function(f,k){y+=1;var L=k.text();return f&&m.textTemplate[y]==="("&&L[0]==="("&&L.slice(-1)===")"?f+L.slice(1,-1)+m.textTemplate[y]:f+L+(m.textTemplate[y]||"")})},w.prototype.mathspeak=function(){var m=this,y=0;return m.foldChildren(m.mathspeakTemplate[y]||"Start"+m.ctrlSeq+" ",function(f,k){return y+=1,f+" "+k.mathspeak()+" "+(m.mathspeakTemplate[y]+" "||"End"+m.ctrlSeq+" ")})},w}(mo),xt=function(M){yt(w,M);function w(m,y,f,k){var L=M.call(this)||this;return L.setCtrlSeqHtmlTextAndMathspeak(m,y?new Ze(0,function(){return y.cloneNode(!0)}):void 0,f,k),L}return w.prototype.setCtrlSeqHtmlTextAndMathspeak=function(m,y,f,k){!f&&m&&(f=m.replace(/^\\/,"")),this.mathspeakName=k||f,M.prototype.setCtrlSeqHtmlAndText.call(this,m,y,[f||""])},w.prototype.parser=function(){return ge.succeed(this)},w.prototype.numBlocks=function(){return 0},w.prototype.replaces=function(m){m.remove()},w.prototype.createBlocks=function(){},w.prototype.moveTowards=function(m,y){y.domFrag().insDirOf(m,this.domFrag()),y[-m]=this,y[m]=this[m],y.controller.aria.queue(this)},w.prototype.deleteTowards=function(m,y){y[m]=this.remove()[m]},w.prototype.seek=function(m,y){var f=this.domFrag().oneElement(),k=I(f).left;return m-k<f.offsetWidth/2?y.insLeftOf(this):y.insRightOf(this),y},w.prototype.latexRecursive=function(m){this.checkCursorContextOpen(m),m.latex+=this.ctrlSeq||"",this.checkCursorContextClose(m)},w.prototype.text=function(){return this.textTemplate.join("")},w.prototype.mathspeak=function(m){return this.mathspeakName||""},w.prototype.placeCursor=function(){},w.prototype.isEmpty=function(){return!0},w}(pt),ke=function(M){yt(w,M);function w(m,y,f){return M.call(this,m,d("span",{},[y||d.text(m)]),void 0,f)||this}return w}(xt);function ce(M,w,m){return function(){return new ke(M,w?d.entityText(w):void 0,m)}}var ve=function(M){yt(w,M);function w(m,y,f,k,L){var G=this;return L?G=M.call(this,m,d("span",{},[y||d.text(m||"")]),void 0,k)||this:G=M.call(this,m,d("span",{class:"dcg-mq-binary-operator"},y?[y]:[]),f,k)||this,G}return w.prototype.isBinaryOperator=function(){return!0},w}(xt);function We(M,w,m,y){return function(){return new ve(M,w?d.entityText(w):void 0,m,y)}}var De=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.ariaLabel="block",m}return w.prototype.join=function(m){return this.foldChildren("",function(y,f){return y+f[m]()})},w.prototype.html=function(){var m=document.createDocumentFragment();return this.eachChild(function(y){var f=y.html();m.appendChild(f)}),m},w.prototype.latexRecursive=function(m){this.checkCursorContextOpen(m),this.eachChild(function(y){return y.latexRecursive(m)}),this.checkCursorContextClose(m)},w.prototype.text=function(){var m=this.getEnd(r),y=this.getEnd(e);return m===y&&m!==0?m.text():this.join("text")},w.prototype.mathspeak=function(){var m="",y={};return this.controller&&(y=this.controller.options.autoOperatorNames),this.foldChildren([],function(f,k){if(k.isPartOfOperator)m+=k.mathspeak();else{if(m!==""){if(y._maxLength>0){var L=y[m.toLowerCase()];typeof L=="string"&&(m=L)}f.push(m+" "),m=""}var G=k.mathspeak(),U=k.ctrlSeq;isNaN(U)&&U!=="."&&(!k.parent||!k.parent.parent||!k.parent.parent.isTextBlock())&&(G=" "+G+" "),f.push(G)}return f}).join("").replace(/ +(?= )/g,"").replace(/(\.)([0-9]+)/g,function(f,k,L){return k+L.split("").join(" ").trim()})},w.prototype.keystroke=function(m,y,f){if(f.options.spaceBehavesLikeTab&&(m==="Spacebar"||m==="Shift-Spacebar")){y==null||y.preventDefault(),f.escapeDir(m==="Shift-Spacebar"?r:e,m,y);return}return M.prototype.keystroke.call(this,m,y,f)},w.prototype.moveOutOf=function(m,y,f){var k;if(f==="up"?k=this.parent.upInto:f==="down"&&(k=this.parent.downInto),!k&&this[m]){var L=-m;y.insAtDirEnd(L,this[m]),y.controller.aria.queueDirEndOf(L).queue(y.parent,!0)}else y.insDirOf(m,this.parent),y.controller.aria.queueDirOf(m).queue(this.parent)},w.prototype.selectOutOf=function(m,y){y.insDirOf(m,this.parent)},w.prototype.deleteOutOf=function(m,y){y.unwrapGramp()},w.prototype.seek=function(m,y){var f=this.getEnd(e);if(!f)return y.insAtRightEnd(this);var k=f.domFrag().oneElement(),L=I(k).left;if(L+k.offsetWidth<m)return y.insAtRightEnd(this);var G=this.getEnd(r);if(m<I(G.domFrag().oneElement()).left)return y.insAtLeftEnd(this);for(;m<I(f.domFrag().oneElement()).left;)f=f[r];return f.seek(m,y)},w.prototype.chToCmd=function(m,y){var f;return m.match(/^[a-eg-zA-Z]$/)?new qt(m):/^\d$/.test(m)?new Yt(m):y&&y.typingSlashWritesDivisionSymbol&&m==="/"?V["\xF7"](m):y&&y.typingAsteriskWritesTimesSymbol&&m==="*"?V["\xD7"](m):y&&y.typingPercentWritesPercentOf&&m==="%"?V.percentof(m):(f=K[m]||V[m])?f.constructor?new f(m):f(m):new ke(m)},w.prototype.write=function(m,y){var f=this.chToCmd(y,m.options);m.selection&&f.replaces(m.replaceSelection()),m.isTooDeep()||(f.createLeftOf(m.show()),y==="/"?m.controller.aria.alert("over"):m.controller.aria.alert(f.mathspeak({createdLeftOf:m})))},w.prototype.writeLatex=function(m,y){var f=ge.all,k=ge.eof,L=le.skip(k).or(f.result(!1)).parse(y);if(L&&!L.isEmpty()&&L.prepareInsertionAt(m)){L.children().adopt(m.parent,m[r],m[e]),N(L.html()).insertBefore(m.domFrag()),m[r]=L.getEnd(e),L.finalizeInsert(m.options,m);var G=L.getEnd(e),U=L.getEnd(r),H=G[e],Q=U[r];H&&H.siblingCreated(m.options,r),Q&&Q.siblingCreated(m.options,e),m.parent.bubble(function(pe){pe.reflow()})}},w.prototype.focus=function(){return this.domFrag().addClass("dcg-mq-hasCursor"),this.domFrag().removeClass("dcg-mq-empty"),this},w.prototype.blur=function(m){return this.domFrag().removeClass("dcg-mq-hasCursor"),this.isEmpty()&&(this.domFrag().addClass("dcg-mq-empty"),m&&this.isQuietEmptyDelimiter(m.options.quietEmptyDelimiters)&&this.domFrag().addClass("dcg-mq-quiet-delimiter")),this},w}(mo);ye.prototype.mouseEvents=!0,ae.StaticMath=function(M){var w;return w=function(m){yt(y,m);function y(f){var k=m.call(this,f)||this,L=k.innerFields=[];return k.__controller.root.postOrder(function(G){G.registerInnerField(L,M.InnerMathField)}),k}return y.prototype.__mathquillify=function(f,k){return this.config(f),m.prototype.mathquillify.call(this,"dcg-mq-math-mode"),this.__controller.setupStaticField(),this.__options.mouseEvents&&this.__controller.addMouseEventListener(),this.__controller.staticMathTextareaEvents(),this},y.prototype.latex=function(f){var k=m.prototype.latex.apply(this,arguments);if(arguments.length>0){var L=this.innerFields=[];this.__controller.root.postOrder(function(G){G.registerInnerField(L,M.InnerMathField)}),this.__controller.updateMathspeak()}return k},y.prototype.setAriaLabel=function(f){return this.__controller.setAriaLabel(f),this},y.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},y}(M.AbstractMathQuill),w.RootBlock=De,w};var mt=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w}(De);Ie(mt.prototype),ae.MathField=function(M){var w;return w=function(m){yt(y,m);function y(){return m!==null&&m.apply(this,arguments)||this}return y.prototype.__mathquillify=function(f,k){return this.config(f),k>1&&(this.__controller.root.reflow=i),m.prototype.mathquillify.call(this,"dcg-mq-editable-field dcg-mq-math-mode"),delete this.__controller.root.reflow,this},y}(M.EditableField),w.RootBlock=mt,w},ae.InnerMathField=function(M){return a("MathField class is defined",M.MathField),function(w){yt(m,w);function m(){return w!==null&&w.apply(this,arguments)||this}return m.prototype.makeStatic=function(){this.__controller.editable=!1,this.__controller.root.blur(),this.__controller.unbindEditablesEvents(),N(this.__controller.container).removeClass("dcg-mq-editable-field")},m.prototype.makeEditable=function(){this.__controller.editable=!0,this.__controller.editablesTextareaEvents(),this.__controller.cursor.insAtRightEnd(this.__controller.root),N(this.__controller.container).addClass("dcg-mq-editable-field")},m}(M.MathField)};var gt="\\ ",Vt=".",ir=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.finalizeTree=function(m,y){this.sharedSiblingMethod(m,y)},w.prototype.siblingDeleted=function(m,y){this.sharedSiblingMethod(m,y)},w.prototype.siblingCreated=function(m,y){this.sharedSiblingMethod(m,y)},w.prototype.sharedSiblingMethod=function(m,y){y!==r&&this[e]instanceof w||this.fixDigitGrouping(m)},w.prototype.fixDigitGrouping=function(m){if(m.enableDigitGrouping){var y=this,f=y;do if(/^[0-9]$/.test(f.ctrlSeq))y=f;else if(f.ctrlSeq===gt)y=f;else if(f.ctrlSeq===Vt)y=f;else break;while(f=y[r]);w.fixDigitGroupingFromLeft(m,y)}},w.fixDigitGroupingFromLeft=function(m,y){for(;y&&y.ctrlSeq===gt;){if(!y[e])return;y=y[e]}if(y instanceof w){var f=y;a("node",f);var k=y,L=0,G=0,U=[];do{if(/^[0-9]$/.test(f.ctrlSeq))k=f,G=0;else if(f.ctrlSeq===gt)k=f,L+=1,G=0;else if(f.ctrlSeq===Vt&&f instanceof w)k=f,U.push(f),m.tripleDotsAreEllipsis&&(G+=1);else break;if(G==3)break}while(f=k[e]);if(G===3){var H=U.pop(),Q=U.pop(),pe=U.pop();if(H[e]instanceof w&&w.fixDigitGroupingFromLeft(m,H[e]),H.setGroupingClass("dcg-mq-ellipsis-end"),Q.setGroupingClass("dcg-mq-ellipsis-middle"),pe.setGroupingClass("dcg-mq-ellipsis-start"),k=pe[r],y===pe)return}for(;k!==y&&k&&k.ctrlSeq===gt;)k=k[r],L-=1;if(!(y===k&&y&&y.ctrlSeq===gt)){var ne=L>0||U.length>1;ne?w.removeGroupingBetween(y,k):U[0]?(U[0]!==y&&w.addGroupingBetween(U[0][r],y),U[0]!==k&&w.removeGroupingBetween(U[0],k)):w.addGroupingBetween(k,y)}}},w.removeGroupingBetween=function(m,y){var f=m;do if(f instanceof w&&f.setGroupingClass(void 0),!f||f===y)break;while(f=f[e])},w.addGroupingBetween=function(m,y){for(var G=m,f=0,k=0;G&&(k+=1,a("digit",G instanceof w),G!==y);)G=G[r];var L=k%3;L===0&&(L=3);for(var G=m;G;){f+=1;var U=void 0;if(k>=4&&(f===k?U="dcg-mq-group-leading-"+L:f%3===0&&f!==k&&(U="dcg-mq-group-start"),U||(U="dcg-mq-group-other")),G instanceof w&&G.setGroupingClass(U),G===y)break;G=G[r]}},w.prototype.setGroupingClass=function(m){this._groupingClass!==m&&(this._groupingClass&&this.domFrag().removeClass(this._groupingClass),m&&this.domFrag().addClass(m),this._groupingClass=m)},w}(xt),Yt=function(M){yt(w,M);function w(m,y){return M.call(this,m,d("span",{class:"dcg-mq-digit"},[d.text(m)]),void 0,y)||this}return w.prototype.createLeftOf=function(m){var y=m[r],f=y&&y[r],k=m.parent.parent instanceof Ys?m.parent.parent.sub:void 0;m.options.autoSubscriptNumerals&&m.parent!==k&&(y instanceof Ht&&y.isItalic!==!1||y instanceof Ys&&f instanceof Ht&&f.isItalic!==!1)?(new qT().createLeftOf(m),M.prototype.createLeftOf.call(this,m),m.insRightOf(m.parent.parent)):M.prototype.createLeftOf.call(this,m)},w.prototype.mathspeak=function(m){if(m&&m.createdLeftOf){var y=m.createdLeftOf,f=y[r],k=f&&f[r],L=y.parent.parent instanceof Ys?y.parent.parent.sub:void 0;if(y.options.autoSubscriptNumerals&&y.parent!==L&&(f instanceof Ht&&f.isItalic!==!1||y[r]instanceof Ys&&k instanceof Ht&&k.isItalic!==!1))return"Subscript "+M.prototype.mathspeak.call(this)+" Baseline"}return M.prototype.mathspeak.call(this)},w}(ir),Ht=function(M){yt(w,M);function w(m,y){return M.call(this,m,d("var",{},[y||d.text(m)]))||this}return w.prototype.text=function(){var m=this.ctrlSeq||"";return this.isPartOfOperator?m[0]=="\\"?m=m.slice(1,m.length):m[m.length-1]==" "&&(m=m.slice(0,-1)):(this[r]&&!(this[r]instanceof w)&&!(this[r]instanceof ve)&&this[r].ctrlSeq!=="\\ "&&(m="*"+m),this[e]&&!(this[e]instanceof ve)&&!(this[e]instanceof Ys)&&(m+="*")),m},w.prototype.mathspeak=function(){var m=this.ctrlSeq||"";return this.isPartOfOperator||m.length>1||this.parent&&this.parent.parent&&this.parent.parent.isTextBlock()?M.prototype.mathspeak.call(this):'"'+m+'"'},w}(xt);function Lt(M,w,m){return function(){return new Ht(M,d.entityText(w))}}ye.prototype.autoCommands={_maxLength:0},J.autoCommands=function(M){if(typeof M!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(M))throw'"'+M+'" not a space-delimited list of only letters';for(var w=M.split(" "),m={},y=0,f=0;f<w.length;f+=1){var k=w[f];if(k.length<2)throw'autocommand "'+k+'" not minimum length of 2';if(V[k]===$r)throw'"'+k+'" is a built-in operator name';m[k]=1,y=o(y,k.length)}return m._maxLength=y,m},ye.prototype.quietEmptyDelimiters={},J.quietEmptyDelimiters=function(M){M===void 0&&(M="");for(var w=M.split(" "),m={},y=0;y<w.length;y+=1){var f=w[y];m[f]=1}return m},ye.prototype.autoParenthesizedFunctions={_maxLength:0},J.autoParenthesizedFunctions=function(M){if(typeof M!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(M))throw'"'+M+'" not a space-delimited list of only letters';for(var w=M.split(" "),m={},y=0,f=0;f<w.length;f+=1){var k=w[f];if(k.length<2)throw'autocommand "'+k+'" not minimum length of 2';m[k]=1,y=o(y,k.length)}return m._maxLength=y,m};function ur(M,w){for(var m="",y=0;M instanceof qt&&M.ctrlSeq===M.letter&&y<w;)m=M.letter+m,M=M[r],y+=1;return m}var qt=function(M){yt(w,M);function w(m){var y=M.call(this,m)||this;return y.letter=m,y}return w.prototype.checkAutoCmds=function(m){var y;if(!this.shouldIgnoreSubstitutionInSimpleSubscript(m.options)){var f=m.options.autoCommands,k=f._maxLength||0;if(k>0)for(var L=(y=ur(this,k))!==null&&y!==void 0?y:"";L.length;){if(f.hasOwnProperty(L)){for(var G=this,U=1;G&&U<L.length;U+=1,G=G[r]);new B(G,this).remove(),m[r]=G[r];var H=V[L],Q;return oe(H)?Q=new H(L):Q=H(L),Q.createLeftOf(m)}L=L.slice(1)}}},w.prototype.autoParenthesize=function(m){var y=m.parent.getEnd(e);if(!(y&&y instanceof Bs&&y.ctrlSeq==="\\left(")&&!this.shouldIgnoreSubstitutionInSimpleSubscript(m.options)){for(var f="",k=this,L=0,G=m.options.autoParenthesizedFunctions,U=G._maxLength||0,H=m.options.autoOperatorNames;k instanceof w&&L<U;)f=k.letter+f,k=k[r],L+=1;for(;f.length;){if(G.hasOwnProperty(f)&&H.hasOwnProperty(f))return m.parent.write(m,"(");f=f.slice(1)}}},w.prototype.createLeftOf=function(m){M.prototype.createLeftOf.call(this,m),this.checkAutoCmds(m),this.autoParenthesize(m)},w.prototype.italicize=function(m){return this.isItalic=m,this.isPartOfOperator=!m,m&&(delete this.endsCategory,delete this.endsWord),this.domFrag().toggleClass("dcg-mq-operator-name",!m),this},w.prototype.finalizeTree=function(m,y){this.sharedSiblingMethod(m,y)},w.prototype.siblingDeleted=function(m,y){this.sharedSiblingMethod(m,y)},w.prototype.siblingCreated=function(m,y){this.sharedSiblingMethod(m,y)},w.prototype.sharedSiblingMethod=function(m,y){y!==r&&this[e]instanceof w||this.autoUnItalicize(m)},w.prototype.autoUnItalicize=function(m){var y=m.autoOperatorNames;if(y._maxLength!==0&&!this.shouldIgnoreSubstitutionInSimpleSubscript(m)){for(var f=this.letter,k=this[r];k instanceof w;k=k[r])f=k.letter+f;for(var L=this[e];L instanceof w;L=L[e])f+=L.letter;var G=k&&k[e],U=L&&L[r];new B(G||this.parent.getEnd(r),U||this.parent.getEnd(e)).each(function(yr){yr instanceof w&&(yr.italicize(!0).domFrag().removeClass("dcg-mq-first dcg-mq-last dcg-mq-followed-by-supsub"),yr.ctrlSeq=yr.letter)});var H=y._maxLength||0;e:for(var Q=0,pe=k[e]||this.parent.getEnd(r);pe&&Q<f.length;Q+=1,pe=pe[e])for(var ne=t(H,f.length-Q);ne>0;ne-=1){var fe=f.slice(Q,Q+ne),xe=void 0;if(y.hasOwnProperty(fe)){for(var Re=0,Ve=pe;Re<ne;Re+=1,Ve=Ve[e])Ve instanceof w&&(Ve.italicize(!1),xe=Ve);var Le=Mo.hasOwnProperty(fe);if(pe.ctrlSeq=(Le?"\\":"\\operatorname{")+pe.ctrlSeq,xe.ctrlSeq+=Le?" ":"}",xe.endsWord=fe,m.infixOperatorNames[fe]?xe.endsCategory="infix":m.prefixOperatorNames[fe]&&(xe.endsCategory="prefix"),Ci.hasOwnProperty(fe)){var et=xe[r],Wt=et&&et[r],$e=Wt&&Wt[r];$e.domFrag().addClass("dcg-mq-last")}if(this.shouldOmitPadding(pe[r])||pe.domFrag().addClass("dcg-mq-first"),!this.shouldOmitPadding(xe[e]))if(xe[e]instanceof Ys){var St=xe[e],Cr=St.siblingCreated=St.siblingDeleted=function(){St.domFrag().toggleClass("dcg-mq-after-operator-name",!(St[e]instanceof Bs))};Cr()}else xe.domFrag().toggleClass("dcg-mq-last",!(xe[e]instanceof Bs));Q+=ne-1,pe=xe;continue e}}}},w.prototype.shouldOmitPadding=function(m){return!!(!m||m.ctrlSeq==="."||m instanceof ve&&m.isBinaryOperator()||m instanceof ku)},w}(Ht),Mo={};ye.prototype.autoOperatorNames=wn();var Ci={limsup:1,liminf:1,projlim:1,injlim:1};function wn(){for(var M={_maxLength:9},w="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "),m=0;m<w.length;m+=1)Mo[w[m]]=M[w[m]]=1;for(var y="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" "),m=0;m<y.length;m+=1)Mo[y[m]]=1;for(var f="sin cos tan sec cosec csc cotan cot ctg".split(" "),m=0;m<f.length;m+=1)M[f[m]]=M["arc"+f[m]]=M[f[m]+"h"]=M["ar"+f[m]+"h"]=M["arc"+f[m]+"h"]=1;for(var k="gcf hcf lcm proj span".split(" "),m=0;m<k.length;m+=1)M[k[m]]=1;return M}J.autoOperatorNames=function(M){if(typeof M!="string")throw'"'+M+'" not a space-delimited list';if(!/^[a-z\|\-]+(?: [a-z\|\-]+)*$/i.test(M))throw'"'+M+'" not a space-delimited list of letters or "|"';for(var w=M.split(" "),m={},y=0,f=0;f<w.length;f+=1){var k=w[f];if(k.length<2)throw'"'+k+'" not minimum length of 2';if(k.indexOf("|")<0)m[k]=k,y=o(y,k.length);else{var L=k.split("|");if(L.length>2)throw'"'+k+'" has more than 1 mathspeak delimiter';if(L[0].length<2)throw'"'+k[0]+'" not minimum length of 2';m[L[0]]=L[1].replace(/-/g," "),y=o(y,L[0].length)}}return m._maxLength=y,m},ye.prototype.infixOperatorNames={},J.infixOperatorNames=di,ye.prototype.prefixOperatorNames={},J.prefixOperatorNames=di,ye.prototype.disableAutoSubstitutionInSubscripts=!1,J.disableAutoSubstitutionInSubscripts=function(M){if(typeof M=="boolean")return M;if(typeof M!="object"||M===null||!("except"in M))throw'"'+M+'" not an object with property "except"';return{except:di(M.except)}};function di(M){if(typeof M!="string")throw'"'+M+'" not a space-delimited list';if(!/^[a-z]+(?: [a-z]+)*$/i.test(M))throw'"'+M+'" not a space-delimited list of letters';for(var w=M.split(" "),m={},y=0;y<w.length;y+=1){var f=w[y];if(f.length<2)throw'"'+f+'" not minimum length of 2';m[f]=!0}return m}var $r=function(M){yt(w,M);function w(m){return M.call(this,m||"")||this}return w.prototype.createLeftOf=function(m){for(var y=this.ctrlSeq,f=0;f<y.length;f+=1)new qt(y.charAt(f)).createLeftOf(m)},w.prototype.parser=function(){for(var m=this.ctrlSeq,y=new De,f=0;f<m.length;f+=1)new qt(m.charAt(f)).adopt(y,y.getEnd(e),0);return ge.succeed(y.children())},w}(xt);for(var pi in ye.prototype.autoOperatorNames)ye.prototype.autoOperatorNames.hasOwnProperty(pi)&&(V[pi]=$r);V.operatorname=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.createLeftOf=function(){},w.prototype.numBlocks=function(){return 1},w.prototype.parser=function(){return le.block.map(function(m){var y=!0,f="",k=m.children();return k.each(function(L){L instanceof qt?f+=L.letter:y=!1}),y&&f==="ans"?vf():k})},w}(pt),V.f=function(M){yt(w,M);function w(){var m=this,y="f";return m=M.call(this,y)||this,m.letter=y,m.domView=new Ze(0,function(){return d("var",{class:"dcg-mq-f"},[d.text("f")])}),m}return w.prototype.italicize=function(m){return this.domFrag().eachElement(function(y){return y.textContent="f"}),this.domFrag().toggleClass("dcg-mq-f",m),M.prototype.italicize.call(this,m)},w}(qt),V[" "]=V.space=function(){return new ir("\\ ",d("span",{},[d.text(u)])," ")},V["."]=function(){return new ir(".",d("span",{class:"dcg-mq-digit"},[d.text(".")]),".")},V["'"]=V.prime=ce("'","&prime;","prime"),V["\u2033"]=V.dprime=ce("\u2033","&Prime;","double prime"),V.backslash=ce("\\backslash ","\\","backslash"),K["\\"]||(K["\\"]=V.backslash),V.$=ce("\\$","$","dollar"),V["\u25A1"]=V.square=ce("\\square ","\u25A1","square"),V.mid=ce("\\mid ","\u2223","mid");var Cl=function(M){yt(w,M);function w(m,y){return M.call(this,m,d("span",{class:y},[d.text(m)]))||this}return w}(xt);V[","]=function(){return new Cl(",","dcg-mq-comma")};var Ui=function(M){yt(w,M);function w(m,y,f){return M.call(this,m,d("span",{class:"dcg-mq-nonSymbola"},[y||d.text(m)]))||this}return w}(xt);V["@"]=function(){return new Ui("@")},V["&"]=function(){return new Ui("\\&",d.entityText("&amp;"),"and")},V["%"]=function(M){yt(w,M);function w(){return M.call(this,"\\%",d.text("%"),"percent")||this}return w.prototype.parser=function(){var m=ge.optWhitespace,y=ge.string;return m.then(y("\\operatorname{of}").map(function(){return WT()})).or(M.prototype.parser.call(this))},w}(Ui),V["\u2225"]=V.parallel=ce("\\parallel ","&#x2225;","parallel"),V["\u2226"]=V.nparallel=ce("\\nparallel ","&#x2226;","not parallel"),V["\u27C2"]=V.perp=ce("\\perp ","&#x27C2;","perpendicular");function Yi(M){return Lt("\\"+M+" ","&"+M+";",M)}V.\u03B1=V.alpha=Yi("alpha"),V.\u03B2=V.beta=Yi("beta"),V.\u03B3=V.gamma=Yi("gamma"),V.\u03B4=V.delta=Yi("delta"),V.\u03B6=V.zeta=Yi("zeta"),V.\u03B7=V.eta=Yi("eta"),V.\u03B8=V.theta=Yi("theta"),V.\u03B9=V.iota=Yi("iota"),V.\u03BA=V.kappa=Yi("kappa"),V.\u03BC=V.mu=Yi("mu"),V.\u03BD=V.nu=Yi("nu"),V.\u03BE=V.xi=Yi("xi"),V.\u03C1=V.rho=Yi("rho"),V.\u03C3=V.sigma=Yi("sigma"),V.\u03C4=V.tau=Yi("tau"),V.\u03C7=V.chi=Yi("chi"),V.\u03C8=V.psi=Yi("psi"),V.\u03C9=V.omega=Yi("omega"),V.\u03D5=V.phi=Lt("\\phi ","&#981;","phi"),V.\u03C6=V.phiv=V.varphi=Lt("\\varphi ","&phi;","phi"),V["\u03F5"]=V.epsilon=Lt("\\epsilon ","&#1013;","epsilon"),V.\u03B5=V.epsiv=V.varepsilon=Lt("\\varepsilon ","&epsilon;","epsilon"),V.\u03D6=V.piv=V.varpi=Lt("\\varpi ","&piv;","piv"),V.\u03C2=V.sigmaf=V.sigmav=V.varsigma=Lt("\\varsigma ","&sigmaf;","sigma"),V.\u03D1=V.thetav=V.vartheta=V.thetasym=Lt("\\vartheta ","&thetasym;","theta"),V.\u03C5=V.upsilon=V.upsi=Lt("\\upsilon ","&upsilon;","upsilon"),V.\u03DC=V.gammad=V.Gammad=V.digamma=Lt("\\digamma ","&#989;","gamma"),V.\u03F0=V.kappav=V.varkappa=Lt("\\varkappa ","&#1008;","kappa"),V.\u03F1=V.rhov=V.varrho=Lt("\\varrho ","&#1009;","rho"),V.pi=V.\u03C0=function(){return new Ui("\\pi ",d.entityText("&pi;"),"pi")},V.\u03BB=V.lambda=function(){return new Ui("\\lambda ",d.entityText("&lambda;"),"lambda")},V.\u03A5=V.Upsilon=V.Upsi=V.upsih=V.Upsih=function(){return new xt("\\Upsilon ",d("var",{style:"font-family: serif"},[d.entityText("&upsih;")]),"capital upsilon")};function zn(M){return function(){return new ke("\\"+M+" ",d.entityText("&"+M+";"))}}V.\u0393=V.Gamma=zn("Gamma"),V.\u0394=V.Delta=zn("Delta"),V.\u0398=V.Theta=zn("Theta"),V.\u039B=V.Lambda=zn("Lambda"),V.\u039E=V.Xi=zn("Xi"),V.\u03A0=V.Pi=zn("Pi"),V.\u03A3=V.Sigma=zn("Sigma"),V.\u03A6=V.Phi=zn("Phi"),V.\u03A8=V.Psi=zn("Psi"),V.\u03A9=V.Omega=zn("Omega"),V["\u2200"]=V.forall=zn("forall");var ui=function(M){yt(w,M);function w(m){var y=M.call(this)||this;return y.latexStr=m,y}return w.prototype.createLeftOf=function(m){var y=le.parse(this.latexStr);y.children().adopt(m.parent,m[r],m[e]),m[r]=y.getEnd(e),N(y.html()).insertBefore(m.domFrag()),y.finalizeInsert(m.options,m);var f=y.getEnd(e),k=f&&f[e];k&&k.siblingCreated(m.options,r);var L=y.getEnd(r),G=L&&L[r];G&&G.siblingCreated(m.options,e),m.parent.bubble(function(U){U.reflow()})},w.prototype.mathspeak=function(){return le.parse(this.latexStr).mathspeak()},w.prototype.parser=function(){var m=le.parse(this.latexStr).children();return ge.succeed(m)},w}(pt);V["\u2070"]=function(){return new ui("^0")},V["\xB9"]=function(){return new ui("^1")},V["\xB2"]=function(){return new ui("^2")},V["\xB3"]=function(){return new ui("^3")},V["\u2074"]=function(){return new ui("^4")},V["\u2075"]=function(){return new ui("^5")},V["\u2076"]=function(){return new ui("^6")},V["\u2077"]=function(){return new ui("^7")},V["\u2078"]=function(){return new ui("^8")},V["\u2079"]=function(){return new ui("^9")},V["\xBC"]=function(){return new ui("\\frac14")},V["\xBD"]=function(){return new ui("\\frac12")},V["\xBE"]=function(){return new ui("\\frac34")},V["\u221A"]=function(){return new ui("\\sqrt{}")};function qd(M){return M instanceof ve||M instanceof qt&&M.endsCategory=="infix"}function da(M){if(!M)return!1;var w=M[r];if(w){if(qd(w)||w instanceof qt&&w.endsCategory=="prefix"||!(w instanceof Bs)&&/^(\\ )|[,;:\(\[]$/.test(w.ctrlSeq))return!1}else return M.parent&&M.parent.parent&&M.parent.parent.isStyleBlock()?da(M.parent.parent):!1;return!0}var Hd=function(M){yt(w,M);function w(m,y,f){return M.call(this,m,y,void 0,f,!0)||this}return w.prototype.isBinaryOperator=function(){return da(this)},w.prototype.contactWeld=function(m,y){this.sharedSiblingMethod(m.options,y)},w.prototype.siblingCreated=function(m,y){this.sharedSiblingMethod(m,y)},w.prototype.siblingDeleted=function(m,y){this.sharedSiblingMethod(m,y)},w.prototype.sharedSiblingMethod=function(m,y){if(y!==e)return this.domFrag().oneElement().className=da(this)?"dcg-mq-binary-operator":"",this},w}(ve);V["+"]=function(M){yt(w,M);function w(){return M.call(this,"+",d.text("+"))||this}return w.prototype.mathspeak=function(){return da(this)?"plus":"positive"},w}(Hd);var wu=function(M){yt(w,M);function w(){return M.call(this,"-",d.entityText("&minus;"))||this}return w.prototype.mathspeak=function(){return da(this)?"minus":"negative"},w}(Hd);V["\u2212"]=V["\u2014"]=V["\u2013"]=V["-"]=wu,V["\xB1"]=V.pm=V.plusmn=V.plusminus=function(){return new Hd("\\pm ",d.entityText("&plusmn;"),"plus-or-minus")},V.mp=V.mnplus=V.minusplus=function(){return new Hd("\\mp ",d.entityText("&#8723;"),"minus-or-plus")},K["*"]=V.sdot=V.cdot=We("\\cdot ","&middot;","*","times");var Su=function(M){yt(w,M);function w(){return M.call(this,"\\to ",d.entityText("&rarr;"),"to")||this}return w.prototype.deleteTowards=function(m,y){if(m===r){var f=y[r];new B(f,this).remove(),y[r]=f[r],new wu().createLeftOf(y),y[r].bubble(function(k){k.reflow()});return}M.prototype.deleteTowards.call(this,m,y)},w}(ve);V["\u2192"]=V.to=Su;var qn=function(M){yt(w,M);function w(m,y){var f=this,k=y?"Strict":"";return f=M.call(this,m["ctrlSeq".concat(k)],d.entityText(m["htmlEntity".concat(k)]),m["text".concat(k)],m["mathspeak".concat(k)])||this,f.data=m,f.strict=y,f}return w.prototype.swap=function(m){this.strict=m;var y=m?"Strict":"";this.ctrlSeq=this.data["ctrlSeq".concat(y)],this.domFrag().children().replaceWith(N(d.entityText(this.data["htmlEntity".concat(y)]))),this.textTemplate=[this.data["text".concat(y)]],this.mathspeakName=this.data["mathspeak".concat(y)]},w.prototype.deleteTowards=function(m,y){if(m===r&&!this.strict){this.swap(!0),this.bubble(function(f){f.reflow()});return}M.prototype.deleteTowards.call(this,m,y)},w}(ve),YT={ctrlSeq:"\\le ",htmlEntity:"&le;",text:"\u2264",mathspeak:"less than or equal to",ctrlSeqStrict:"<",htmlEntityStrict:"&lt;",textStrict:"<",mathspeakStrict:"less than"},GS={ctrlSeq:"\\ge ",htmlEntity:"&ge;",text:"\u2265",mathspeak:"greater than or equal to",ctrlSeqStrict:">",htmlEntityStrict:"&gt;",textStrict:">",mathspeakStrict:"greater than"},lR=function(M){yt(w,M);function w(){return M.call(this,GS,!0)||this}return w.prototype.createLeftOf=function(m){var y=m[r];if(y instanceof ve&&y.ctrlSeq==="-"){var f=y;m[r]=f[r],f.remove(),new Su().createLeftOf(m),m[r].bubble(function(k){k.reflow()});return}M.prototype.createLeftOf.call(this,m)},w}(qn);V["<"]=V.lt=function(){return new qn(YT,!0)},V[">"]=V.gt=lR,V["\u2264"]=V.le=V.leq=function(){return new qn(YT,!1)},V["\u2265"]=V.ge=V.geq=function(){return new qn(GS,!1)},V["\u221E"]=V.infty=V.infin=V.infinity=ce("\\infty ","&infin;","infinity"),V["\u2260"]=V.ne=V.neq=We("\\ne ","&ne;","not equal");var BT=function(M){yt(w,M);function w(){return M.call(this,"=",d.text("="),"=","equals")||this}return w.prototype.createLeftOf=function(m){var y=m[r];if(y instanceof qn&&y.strict){y.swap(!1),y.bubble(function(f){f.reflow()});return}M.prototype.createLeftOf.call(this,m)},w}(ve);V["="]=BT,V["\xD7"]=V.times=V.cross=We("\\times ","&times;","[x]","times"),V["\xF7"]=V.div=V.divide=V.divides=We("\\div ","&divide;","[/]","over");var KT=function(M){yt(w,M);function w(){return M.call(this,"\\sim ",d.text("~"),"~","tilde")||this}return w.prototype.createLeftOf=function(m){if(m[r]instanceof w){var y=m[r];m[r]=y[r],y.remove(),new zT().createLeftOf(m),m[r].bubble(function(f){f.reflow()});return}M.prototype.createLeftOf.call(this,m)},w}(ve),zT=function(M){yt(w,M);function w(){return M.call(this,"\\approx ",d.entityText("&approx;"),"\u2248","approximately equal")||this}return w.prototype.deleteTowards=function(m,y){if(m===r){var f=y[r];new B(f,this).remove(),y[r]=f[r],new KT().createLeftOf(y),y[r].bubble(function(k){k.reflow()});return}M.prototype.deleteTowards.call(this,m,y)},w}(ve);V.tildeNbsp=ce("~",u," "),V.sim=KT,V["\u2248"]=V.approx=zT,K["~"]=V.sim,V["~"]=V.tildeNbsp,J.interpretTildeAsSim=function(M){var w=!!M;return w?V["~"]=V.sim:V["~"]=V.tildeNbsp,w},V["\u25EF"]=V.bigcirc=ce("\\bigcirc ","&#9711;","circle"),V["\u2220"]=V.ang=V.angle=ce("\\angle ","&ang;","angle"),V["\xB0"]=V.degree=ce("\\degree ","&deg;","degrees"),V["\u25B3"]=V.triangle=ce("\\triangle ","&#9651;","triangle"),V["\u2245"]=V.cong=We("\\cong ","&cong;","cong","congruent"),V["\u2221"]=V.measuredangle=ce("\\measuredangle ","&#8737;","measured angle"),V["\u25B1"]=V.parallelogram=ce("\\parallelogram ","&#9649;","parallelogram"),V["\u2247"]=V.ncong=We("\\ncong ","&ncong;","ncong","not congruent"),V["\u2241"]=V.nsim=We("\\nsim ","&nsim;","nsim","not similar");var ig={sqrt:{width:"",html:function(){return d("svg",{preserveAspectRatio:"none",viewBox:"0 0 32 54"},[d("path",{d:"M0 33 L7 27 L12.5 47 L13 47 L30 0 L32 0 L13 54 L11 54 L4.5 31 L0 33"})])}},"|":{width:".4em",html:function(){return d("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[d("path",{d:"M4.4 0 L4.4 54 L5.6 54 L5.6 0"})])}},"[":{width:".55em",html:function(){return d("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[d("path",{d:"M8 0 L3 0 L3 24 L8 24 L8 23 L4 23 L4 1 L8 1"})])}},"]":{width:".55em",html:function(){return d("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[d("path",{d:"M3 0 L8 0 L8 24 L3 24 L3 23 L7 23 L7 1 L3 1"})])}},"(":{width:".55em",html:function(){return d("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[d("path",{d:"M85 0 A61 101 0 0 0 85 186 L75 186 A75 101 0 0 1 75 0"})])}},")":{width:".55em",html:function(){return d("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[d("path",{d:"M24 0 A61 101 0 0 1 24 186 L34 186 A75 101 0 0 0 34 0"})])}},"{":{width:".7em",html:function(){return d("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[d("path",{d:"M170 0 L170 6 A47 52 0 0 0 123 60 L123 127 A35 48 0 0 1 88 175 A35 48 0 0 1 123 223 L123 290 A47 52 0 0 0 170 344 L170 350 L160 350 A58 49 0 0 1 102 301 L103 220 A45 40 0 0 0 58 180 L58 170 A45 40 0 0 0 103 130 L103 49 A58 49 0 0 1 161 0"})])}},"}":{width:".7em",html:function(){return d("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[d("path",{d:"M60 0 L60 6 A47 52 0 0 1 107 60 L107 127 A35 48 0 0 0 142 175 A35 48 0 0 0 107 223 L107 290 A47 52 0 0 1 60 344 L60 350 L70 350 A58 49 0 0 0 128 301 L127 220 A45 40 0 0 1 172 180 L172 170 A45 40 0 0 1 127 130 L127 49 A58 49 0 0 0 70 0"})])}},"&#8741;":{width:".7em",html:function(){return d("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[d("path",{d:"M3.2 0 L3.2 54 L4 54 L4 0 M6.8 0 L6.8 54 L6 54 L6 0"})])}},"&lang;":{width:".55em",html:function(){return d("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[d("path",{d:"M6.8 0 L3.2 27 L6.8 54 L7.8 54 L4.2 27 L7.8 0"})])}},"&rang;":{width:".55em",html:function(){return d("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[d("path",{d:"M3.2 0 L6.8 27 L3.2 54 L2.2 54 L5.8 27 L2.2 0"})])}}},Qy="\u27A4",Us=function(M){yt(w,M);function w(m,y,f,k,L){var G=M.call(this,m,new Ze(1,function(U){var H,Q;return d.block(y,f,U[0],{beforeChild:(H=L==null?void 0:L.beforeChild)===null||H===void 0?void 0:H.call(L),afterChild:(Q=L==null?void 0:L.afterChild)===null||Q===void 0?void 0:Q.call(L)})}))||this;return G.ariaLabel=k||m.replace(/^\\/,""),G.mathspeakTemplate=["Start"+G.ariaLabel+",","End"+G.ariaLabel],G.shouldNotSpeakDelimiters=L&&L.shouldNotSpeakDelimiters,G}return w.prototype.mathspeak=function(m){return!this.shouldNotSpeakDelimiters||m&&m.ignoreShorthand?M.prototype.mathspeak.call(this):this.foldChildren("",function(y,f){return y+" "+f.mathspeak(m)}).trim()},w}(pt);V.mathrm=function(M){yt(w,M);function w(){return M.call(this,"\\mathrm","span",{class:"dcg-mq-roman dcg-mq-font"},"Roman Font",{shouldNotSpeakDelimiters:!0})||this}return w.prototype.isTextBlock=function(){return!0},w}(Us),V.mathit=function(){return new Us("\\mathit","i",{class:"dcg-mq-font"},"Italic Font")},V.mathbf=function(){return new Us("\\mathbf","b",{class:"dcg-mq-font"},"Bold Font")},V.mathsf=function(){return new Us("\\mathsf","span",{class:"dcg-mq-sans-serif dcg-mq-font"},"Serif Font")},V.mathtt=function(){return new Us("\\mathtt","span",{class:"dcg-mq-monospace dcg-mq-font"},"Math Text")},V.underline=function(){return new Us("\\underline","span",{class:"dcg-mq-non-leaf dcg-mq-underline"},"Underline")},V.overline=V.bar=function(){return new Us("\\overline","span",{class:"dcg-mq-non-leaf dcg-mq-overline"},"Overline")},V.overrightarrow=function(){return new Us("\\overrightarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow"},"Over Right Arrow",{afterChild:function(){return d("span",{class:"dcg-mq-arrow-right-content"},[d.text(Qy)])}})},V.overleftarrow=function(){return new Us("\\overleftarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow"},"Over Left Arrow",{beforeChild:function(){return d("span",{class:"dcg-mq-arrow-left-content"},[d.text(Qy)])}})},V.overleftrightarrow=function(){return new Us("\\overleftrightarrow ","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow"},"Over Left and Right Arrow",{beforeChild:function(){return d("span",{class:"dcg-mq-arrow-left-content"},[d.text(Qy)])},afterChild:function(){return d("span",{class:"dcg-mq-arrow-right-content"},[d.text(Qy)])}})},V.overarc=function(){return new Us("\\overarc","span",{class:"dcg-mq-non-leaf dcg-mq-overarc"},"Over Arc")},V.dot=function(){return new pt("\\dot",new Ze(1,function(M){return d("span",{class:"dcg-mq-non-leaf"},[d("span",{class:"dcg-mq-dot-recurring-inner"},[d("span",{class:"dcg-mq-dot-recurring"},[d.text(h)]),d.block("span",{class:"dcg-mq-empty-box"},M[0])])])}))},V.textcolor=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.setColor=function(m){this.color=m,this.domView=new Ze(1,function(y){return d.block("span",{class:"dcg-mq-textcolor",style:"color:"+m},y[0])}),this.ariaLabel=m.replace(/^\\/,""),this.mathspeakTemplate=["Start "+this.ariaLabel+",","End "+this.ariaLabel]},w.prototype.latexRecursive=function(m){this.checkCursorContextOpen(m);var y=this.blocks[0];m.latex+="\\textcolor{"+this.color+"}{",y.latexRecursive(m),m.latex+="}",this.checkCursorContextClose(m)},w.prototype.parser=function(){var m=this,y=ge.optWhitespace,f=ge.string,k=ge.regex;return y.then(f("{")).then(k(/^[#\w\s.,()%-]*/)).skip(f("}")).then(function(L){return m.setColor(L),M.prototype.parser.call(m)})},w.prototype.isStyleBlock=function(){return!0},w}(pt);var cR=V.class=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.parser=function(){var m=this,y=ge.string,f=ge.regex;return ge.optWhitespace.then(y("{")).then(f(/^[-\w\s\\\xA0-\xFF]*/)).skip(y("}")).then(function(k){return m.cls=k||"",m.domView=new Ze(1,function(L){return d.block("span",{class:"dcg-mq-class ".concat(k)},L[0])}),m.ariaLabel=k+" class",m.mathspeakTemplate=["Start "+m.ariaLabel+",","End "+m.ariaLabel],M.prototype.parser.call(m)})},w.prototype.latexRecursive=function(m){this.checkCursorContextOpen(m);var y=this.blocks[0];m.latex+="\\class{"+this.cls+"}{",y.latexRecursive(m),m.latex+="}",this.checkCursorContextClose(m)},w.prototype.isStyleBlock=function(){return!0},w}(pt),ex=/^[\+\-]?[\d]+$/;function xf(M){if(!M)return"";var w="";return M.eachChild(function(m){m.ctrlSeq!==void 0&&(w+=m.ctrlSeq)}),w}ye.prototype.charsThatBreakOutOfSupSub="";var Ys=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.ctrlSeq="_{...}^{...}",m}return w.prototype.setEnds=function(m){a("SupSub ends must be MathBlocks",m[r]instanceof De&&m[e]instanceof De),this.ends=m},w.prototype.getEnd=function(m){return this.ends[m]},w.prototype.createLeftOf=function(m){if(!(!this.replacedFragment&&!m[r]&&m.options.supSubsRequireOperand))return M.prototype.createLeftOf.call(this,m)},w.prototype.contactWeld=function(m){for(var y=r;y;y=y===r?e:!1){var f=this[y],k=void 0;if(f instanceof w){for(var L="sub";L;L=L==="sub"?"sup":!1){var G=this[L],U=f[L];if(G){if(!U)f.addBlock(G.disown());else if(G.isEmpty())k=new X(U,0,U.getEnd(r));else{G.domFrag().children().insAtDirEnd(-y,U.domFrag().oneElement());var H=G.children().disown();k=new X(U,H.getEnd(e),U.getEnd(r)),y===r?H.adopt(U,U.getEnd(e),0):H.adopt(U,0,U.getEnd(r))}this.placeCursor=function(Q,pe){return function(ne){ne.insAtDirEnd(-y,Q||pe)}}(U,G)}}this.remove(),m&&m[r]===this&&(y===e&&k?k[r]?m.insRightOf(k[r]):m.insAtLeftEnd(k.parent):m.insRightOf(f));break}}},w.prototype.finalizeTree=function(){var m=this.getEnd(r);m.write=function(y,f){if(y.options.autoSubscriptNumerals&&this===this.parent.sub&&"0123456789".indexOf(f)>=0){var k=this.chToCmd(f,y.options);k instanceof xt?y.deleteSelection():y.clearSelection().insRightOf(this.parent),k.createLeftOf(y.show()),y.controller.aria.queue("Baseline").alert(k.mathspeak({createdLeftOf:y}));return}y[r]&&!y[e]&&!y.selection&&y.options.charsThatBreakOutOfSupSub.indexOf(f)>-1&&(y.insRightOf(this.parent),y.controller.aria.queue("Baseline")),De.prototype.write.call(this,y,f)}},w.prototype.moveTowards=function(m,y,f){y.options.autoSubscriptNumerals&&!this.sup?y.insDirOf(m,this):M.prototype.moveTowards.call(this,m,y,f)},w.prototype.deleteTowards=function(m,y){if(y.options.autoSubscriptNumerals&&this.sub){var f=this.sub.getEnd(-m);f instanceof xt?f.remove():f&&f.deleteTowards(m,y.insAtDirEnd(-m,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(r,y.insAtLeftEnd(this.sub)),this.sup&&y.insDirOf(-m,this))}else M.prototype.deleteTowards.call(this,m,y)},w.prototype.latexRecursive=function(m){if(this.checkCursorContextOpen(m),this.sub){m.latex+="_{";var y=m.latex.length;this.sub.latexRecursive(m);var f=m.latex.length;y===f&&(m.latex+=" "),m.latex+="}"}if(this.sup){m.latex+="^{";var y=m.latex.length;this.sup.latexRecursive(m);var f=m.latex.length;y===f&&(m.latex+=" "),m.latex+="}"}this.checkCursorContextClose(m)},w.prototype.text=function(){function m(y,f){var k=f&&f.text()||"";return f?y+(k.length===1?k:"("+(k||" ")+")"):""}return m("_",this.sub)+m("^",this.sup)},w.prototype.addBlock=function(m){this.supsub==="sub"?(this.sup=this.upInto=this.sub.upOutOf=m,m.adopt(this,this.sub,0).downOutOf=this.sub,m.setDOM(N(d("span",{class:"dcg-mq-sup"})).append(m.domFrag().children()).prependTo(this.domFrag().oneElement()).oneElement()),A.linkElementByBlockNode(m.domFrag().oneElement(),m)):(this.sub=this.downInto=this.sup.downOutOf=m,m.adopt(this,0,this.sup).upOutOf=this.sup,this.domFrag().removeClass("dcg-mq-sup-only"),m.setDOM(N(d("span",{class:"dcg-mq-sub"})).append(m.domFrag().children()).appendTo(this.domFrag().oneElement()).oneElement()),A.linkElementByBlockNode(m.domFrag().oneElement(),m),this.domFrag().append(N(d("span",{style:"display:inline-block;width:0"},[d.text(g)]))));for(var y=0;y<2;y+=1)(function(f,k,L,G){var U=f[k];U.deleteOutOf=function(H,Q){if(Q.insDirOf(this[H]?-H:H,this.parent),!this.isEmpty()){var pe=this.getEnd(H);this.children().disown().withDirAdopt(H,Q.parent,Q[H],Q[-H]).domFrag().insDirOf(-H,Q.domFrag()),Q[-H]=pe}f.supsub=L,delete f[k],delete f["".concat(G,"Into")];var ne=f[L];ne["".concat(G,"OutOf")]=VS,delete ne.deleteOutOf,k==="sub"&&f.domFrag().addClass("dcg-mq-sup-only").children().last().remove(),this.remove()}})(this,"sub sup".split(" ")[y],"sup sub".split(" ")[y],"down up".split(" ")[y])},w}(pt);function VS(M){var w=this.parent,m=M;do{if(m[e])return M.insLeftOf(w);m=m.parent.parent}while(m!==w);M.insRightOf(w)}var qT=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.supsub="sub",m.domView=new Ze(1,function(y){return d("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[d.block("span",{class:"dcg-mq-sub"},y[0]),d("span",{style:"display:inline-block;width:0"},[d.text(g)])])}),m.textTemplate=["_"],m.mathspeakTemplate=["Subscript,",", Baseline"],m.ariaLabel="subscript",m}return w.prototype.finalizeTree=function(){this.downInto=this.sub=this.getEnd(r),this.sub.upOutOf=VS,M.prototype.finalizeTree.call(this)},w}(Ys);V.subscript=V._=qT,V.superscript=V.supscript=V["^"]=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.supsub="sup",m.domView=new Ze(1,function(y){return d("span",{class:"dcg-mq-supsub dcg-mq-non-leaf dcg-mq-sup-only"},[d.block("span",{class:"dcg-mq-sup"},y[0])])}),m.textTemplate=["^(",")"],m.ariaLabel="superscript",m.mathspeakTemplate=["Superscript,",", Baseline"],m}return w.prototype.mathspeak=function(m){var y=this.upInto;if(y!==void 0){var f=xf(y);if((!m||!m.ignoreShorthand)&&ex.test(f)){if(f==="0")return"to the 0 power";if(f==="2")return"squared";if(f==="3")return"cubed";var k="";/^[+-]?\d{1,3}$/.test(f)&&(/(11|12|13|4|5|6|7|8|9|0)$/.test(f)?k="th":/1$/.test(f)?k="st":/2$/.test(f)?k="nd":/3$/.test(f)&&(k="rd"));var L=typeof y=="object"?y.mathspeak():f;return"to the "+L+k+" power"}}return M.prototype.mathspeak.call(this)},w.prototype.finalizeTree=function(){this.upInto=this.sup=this.getEnd(e),this.sup.downOutOf=VS,M.prototype.finalizeTree.call(this)},w}(Ys);var ku=function(M){yt(w,M);function w(m,y,f){var k=M.call(this)||this;k.ariaLabel=f||m.replace(/^\\/,"");var L=new Ze(2,function(G){return d("span",{class:"dcg-mq-large-operator dcg-mq-non-leaf"},[d("span",{class:"dcg-mq-to"},[d.block("span",{},G[1])]),d("big",{},[d.text(y)]),d("span",{class:"dcg-mq-from"},[d.block("span",{},G[0])])])});return xt.prototype.setCtrlSeqHtmlTextAndMathspeak.call(k,m,L),k}return w.prototype.createLeftOf=function(m){M.prototype.createLeftOf.call(this,m),m.options.sumStartsWithNEquals&&(new qt("n").createLeftOf(m),new BT().createLeftOf(m))},w.prototype.latexRecursive=function(m){this.checkCursorContextOpen(m),m.latex+=this.ctrlSeq+"_{";var y=m.latex.length;this.getEnd(r).latexRecursive(m);var f=m.latex.length;f===y&&(m.latex+=" "),m.latex+="}^{",y=m.latex.length,this.getEnd(e).latexRecursive(m),f=m.latex.length,y===f&&(m.latex+=" "),m.latex+="}",this.checkCursorContextClose(m)},w.prototype.mathspeak=function(){return"Start "+this.ariaLabel+" from "+this.getEnd(r).mathspeak()+" to "+this.getEnd(e).mathspeak()+", end "+this.ariaLabel+", "},w.prototype.parser=function(){for(var m=ge.string,y=ge.optWhitespace,f=ge.succeed,k=le.block,L=this,G=L.blocks=[new De,new De],U=0;U<G.length;U+=1)G[U].adopt(L,L.getEnd(e),0);return y.then(m("_").or(m("^"))).then(function(H){var Q=G[H==="_"?0:1];return k.then(function(pe){return pe.children().adopt(Q,Q.getEnd(e),0),f(L)})}).many().result(L)},w.prototype.finalizeTree=function(){var m=this.getEnd(r),y=this.getEnd(e);m.ariaLabel="lower bound",y.ariaLabel="upper bound",this.downInto=m,this.upInto=y,m.upOutOf=y,y.downOutOf=m},w}(pt);V["\u2211"]=V.sum=V.summation=function(){return new ku("\\sum ",b,"sum")},V["\u220F"]=V.prod=V.product=function(){return new ku("\\prod ",v,"product")},V.coprod=V.coproduct=function(){return new ku("\\coprod ",T,"co product")},V["\u222B"]=V.int=V.integral=function(M){yt(w,M);function w(){var m=M.call(this,"\\int ","","integral")||this;return m.ariaLabel="integral",m.domView=new Ze(2,function(y){return d("span",{class:"dcg-mq-int dcg-mq-non-leaf"},[d("big",{},[d.text(E)]),d("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[d("span",{class:"dcg-mq-sup"},[d.block("span",{class:"dcg-mq-sup-inner"},y[1])]),d.block("span",{class:"dcg-mq-sub"},y[0]),d("span",{style:"display:inline-block;width:0"},[d.text(g)])])])}),m}return w.prototype.createLeftOf=function(m){pt.prototype.createLeftOf.call(this,m)},w}(ku);var OS=V.frac=V.dfrac=V.cfrac=V.fraction=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.ctrlSeq="\\frac",m.domView=new Ze(2,function(y){return d("span",{class:"dcg-mq-fraction dcg-mq-non-leaf"},[d.block("span",{class:"dcg-mq-numerator"},y[0]),d.block("span",{class:"dcg-mq-denominator"},y[1]),d("span",{style:"display:inline-block;width:0"},[d.text(g)])])}),m.textTemplate=["(",")/(",")"],m}return w.prototype.finalizeTree=function(){var m=this.getEnd(r),y=this.getEnd(e);this.upInto=y.upOutOf=m,this.downInto=m.downOutOf=y,m.ariaLabel="numerator",y.ariaLabel="denominator",this.getFracDepth()>1?this.mathspeakTemplate=["StartNestedFraction,","NestedOver",", EndNestedFraction"]:this.mathspeakTemplate=["StartFraction,","Over",", EndFraction"]},w.prototype.mathspeak=function(m){if(m&&m.createdLeftOf){var y=m.createdLeftOf;return y.parent.mathspeak()}var f=xf(this.getEnd(r)),k=xf(this.getEnd(e));if((!m||!m.ignoreShorthand)&&ex.test(f)&&ex.test(k)){var L=f==="1"||f==="-1",G="";if(k==="2"?G=L?"half":"halves":k==="3"?G=L?"third":"thirds":k==="4"?G=L?"quarter":"quarters":k==="5"?G=L?"fifth":"fifths":k==="6"?G=L?"sixth":"sixths":k==="7"?G=L?"seventh":"sevenths":k==="8"?G=L?"eighth":"eighths":k==="9"&&(G=L?"ninth":"ninths"),G!==""){for(var U="",H=!1,Q=this[r];Q&&Q[r]!==void 0;Q=Q[r])if(Q.ctrlSeq!=="\\ ")if(ex.test(Q.ctrlSeq||""))H=!0;else{H=!1;break}return H&&(U+="and "),U+=this.getEnd(r).mathspeak()+" "+G,U}}return M.prototype.mathspeak.call(this)},w.prototype.getFracDepth=function(){var m=0,y=function(f,k){return f instanceof Et&&f.ctrlSeq&&f.ctrlSeq.toLowerCase().search("frac")>=0&&(k+=1),f&&f.parent?y(f.parent,k):k};return y(this,m)},w}(pt),HT=V.over=K["/"]=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.createLeftOf=function(m){if(!this.replacedFragment){var y=m[r],f=m.options.typingSlashCreatesNewFraction&&this instanceof OS;if(!f)for(;y&&!(qd(y)||y instanceof ir&&y._groupingClass==="dcg-mq-ellipsis-end"||y instanceof(V.text||i)||y instanceof ku||y.ctrlSeq==="\\ "||/^[,;:]$/.test(y.ctrlSeq));)y=y[r];if(y instanceof ku&&y[e]instanceof Ys){y=y[e];var k=y[e];k instanceof Ys&&k.ctrlSeq!=y.ctrlSeq&&(y=y[e])}if(y!==m[r]&&!m.isTooDeep(1)){var k=y[e],L=m[r];this.replaces(new B(k||m.parent.getEnd(r),L)),m[r]=y}}M.prototype.createLeftOf.call(this,m)},w}(OS),vf=function(){return new xt("\\operatorname{ans}",d("span",{class:"dcg-mq-ans"},[d.text("ans")]),"ans")};V.ans=vf;var WT=function(){return new xt("\\%\\operatorname{of}",d("span",{class:"dcg-mq-nonSymbola dcg-mq-operator-name"},[d.text("% of ")]),"percent of")};V.percent=V.percentof=WT;var jT=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.tokenId="",m.ctrlSeq="\\token",m.textTemplate=["token(",")"],m.mathspeakTemplate=["StartToken,",", EndToken"],m.ariaLabel="token",m}return w.prototype.html=function(){var m=d("span",{class:"dcg-mq-token dcg-mq-ignore-mousedown","data-dcg-mq-token":this.tokenId});return this.setDOM(m),A.linkElementByCmdNode(m,this),m},w.prototype.latexRecursive=function(m){this.checkCursorContextOpen(m),m.latex+="\\token{"+this.tokenId+"}",this.checkCursorContextClose(m)},w.prototype.mathspeak=function(){var m=[];return this.domFrag().children().eachElement(function(y){var f=y.getAttribute("aria-label");typeof f=="string"&&f!==""&&m.push(f)}),m.length>0?m.join(" ").trim():"token "+this.tokenId},w.prototype.parser=function(){var m=this;return le.block.map(function(y){var f=y.getEnd(r);if(f)for(m.tokenId+=f.ctrlSeq;f=f[e];)m.tokenId+=f.ctrlSeq;return m})},w}(xt);V.token=jT;var RS=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.ctrlSeq="\\sqrt",m.domView=new Ze(1,function(y){return d("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-container"},[d("span",{class:"dcg-mq-scaled dcg-mq-sqrt-prefix"},[ig.sqrt.html()]),d.block("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-stem"},y[0])])}),m.textTemplate=["sqrt(",")"],m.mathspeakTemplate=["StartRoot,",", EndRoot"],m.ariaLabel="root",m}return w.prototype.parser=function(){return le.optBlock.then(function(m){return le.block.map(function(y){var f=new Wd;return f.blocks=[m,y],m.adopt(f,0,0),y.adopt(f,m,0),f})}).or(M.prototype.parser.call(this))},w.prototype.deleteTowards=function(m,y){if(!this.isEmpty()&&m===1){this.moveTowards(e,y),y.parent.deleteOutOf(r,y);return}M.prototype.deleteTowards.call(this,m,y)},w}(pt);V.sqrt=RS,V.hat=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.ctrlSeq="\\hat",m.domView=new Ze(1,function(y){return d("span",{class:"dcg-mq-non-leaf"},[d("span",{class:"dcg-mq-hat-prefix"},[d.text("^")]),d.block("span",{class:"dcg-mq-hat-stem"},y[0])])}),m.textTemplate=["hat(",")"],m}return w}(pt);var Wd=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.domView=new Ze(2,function(y){return d("span",{class:"dcg-mq-nthroot-container dcg-mq-non-leaf"},[d.block("sup",{class:"dcg-mq-nthroot dcg-mq-non-leaf"},y[0]),d("span",{class:"dcg-mq-scaled dcg-mq-sqrt-container"},[d("span",{class:"dcg-mq-sqrt-prefix dcg-mq-scaled"},[ig.sqrt.html()]),d.block("span",{class:"dcg-mq-sqrt-stem dcg-mq-non-leaf"},y[1])])])}),m.textTemplate=["sqrt[","](",")"],m}return w.prototype.latexRecursive=function(m){this.checkCursorContextOpen(m),m.latex+="\\sqrt[",this.getEnd(r).latexRecursive(m),m.latex+="]{",this.getEnd(e).latexRecursive(m),m.latex+="}",this.checkCursorContextClose(m)},w.prototype.mathspeak=function(){var m=this.getEnd(r).mathspeak(),y=this.getEnd(e).mathspeak();return this.getEnd(r).ariaLabel="Index",this.getEnd(e).ariaLabel="Radicand",m==="3"?"Start Cube Root, "+y+", End Cube Root":"Root Index "+m+", Start Root, "+y+", End Root"},w.prototype.deleteTowards=function(m,y){pt.prototype.deleteTowards.call(this,m,y)},w}(RS);V.nthroot=Wd,V.cbrt=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.createLeftOf=function(m){M.prototype.createLeftOf.call(this,m),new Yt("3").createLeftOf(m),m.controller.moveRight()},w}(Wd);var XT=function(M){yt(w,M);function w(m,y,f){var k=new Ze(1,function(L){return d("span",{class:"dcg-mq-non-leaf"},[d("span",{class:"dcg-mq-diacritic-above"},[y]),d.block("span",{class:"dcg-mq-diacritic-stem"},L[0])])});return M.call(this,m,k,f)||this}return w}(pt);V.vec=function(){return new XT("\\vec",d.entityText("&rarr;"),["vec(",")"])},V.tilde=function(){return new XT("\\tilde",d.text("~"),["tilde(",")"])};var wf=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.setDOM=function(m){var y;M.prototype.setDOM.call(this,m);var f=this.domFrag().children();return f.isEmpty()||(this.delimFrags=(y={},y[r]=f.first(),y[e]=f.last(),y)),this},w}(pt),Bs=function(M){yt(w,M);function w(m,y,f,k,L){var G,U=M.call(this,"\\left"+k,void 0,[y,f])||this;return U.side=m,U.sides=(G={},G[r]={ch:y,ctrlSeq:k},G[e]={ch:f,ctrlSeq:L},G),U}return w.prototype.numBlocks=function(){return 1},w.prototype.html=function(){var m=this,y=this.getSymbol(r),f=this.getSymbol(e);return this.domView=new Ze(1,function(k){return d("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[d("span",{style:"width:"+y.width,class:"dcg-mq-scaled dcg-mq-bracket-l dcg-mq-paren"+(m.side===e?" dcg-mq-ghost":"")},[y.html()]),d.block("span",{style:"margin-left:"+y.width+";margin-right:"+f.width,class:"dcg-mq-bracket-middle dcg-mq-non-leaf"},k[0]),d("span",{style:"width:"+f.width,class:"dcg-mq-scaled dcg-mq-bracket-r dcg-mq-paren"+(m.side===r?" dcg-mq-ghost":"")},[f.html()])])}),M.prototype.html.call(this)},w.prototype.getSymbol=function(m){var y=this.sides[m||e].ch;return ig[y]||{width:"0",html:""}},w.prototype.latexRecursive=function(m){this.checkCursorContextOpen(m),m.latex+="\\left"+this.sides[r].ctrlSeq,this.getEnd(r).latexRecursive(m),m.latex+="\\right"+this.sides[e].ctrlSeq,this.checkCursorContextClose(m)},w.prototype.mathspeak=function(m){var y=this.sides[r].ch,f=this.sides[e].ch;if(y==="|"&&f==="|")this.mathspeakTemplate=["StartAbsoluteValue,",", EndAbsoluteValue"],this.ariaLabel="absolute value";else if(m&&m.createdLeftOf&&this.side){var k="";return this.side===r?k=this.textTemplate[0]:this.side===e&&(k=this.textTemplate[1]),(this.side===r?"left ":"right ")+ng[k]}else this.mathspeakTemplate=["left "+ng[y]+",",", right "+ng[f]],this.ariaLabel=ng[y]+" block";return M.prototype.mathspeak.call(this)},w.prototype.matchBrack=function(m,y,f){return f instanceof w&&f.side&&f.side!==-y&&(!m.restrictMismatchedBrackets||Sf[this.sides[this.side].ch]===f.sides[f.side].ch||m.restrictMismatchedBrackets!=="none"&&{"(":"]","[":")"}[this.sides[r].ch]===f.sides[e].ch)&&f},w.prototype.closeOpposing=function(m){m.side=0,m.sides[this.side]=this.sides[this.side];var y=m.delimFrags[this.side===r?r:e].removeClass("dcg-mq-ghost");this.replaceBracket(y,this.side)},w.prototype.createLeftOf=function(m){var y;if(!this.replacedFragment){var f=m.options;this.sides[r].ch==="|"?y=this.matchBrack(f,e,m[e])||this.matchBrack(f,r,m[r])||this.matchBrack(f,0,m.parent.parent):y=this.matchBrack(f,-this.side,m[-this.side])||this.matchBrack(f,-this.side,m.parent.parent)}if(y){var k=this.side=-y.side;this.closeOpposing(y),y===m.parent.parent&&m[k]&&new B(m[k],m.parent.getEnd(k),-k).disown().withDirAdopt(-k,y.parent,y,y[k]).domFrag().insDirOf(k,y.domFrag()),y.bubble(function(L){L.reflow()})}else y=this,k=y.side,y.replacedFragment?y.side=0:m[-k]&&(y.replaces(new B(m[-k],m.parent.getEnd(-k),k)),m[-k]=0),M.prototype.createLeftOf.call(this,m);k===r?m.insAtLeftEnd(y.getEnd(r)):m.insRightOf(y)},w.prototype.placeCursor=function(){},w.prototype.unwrap=function(){this.getEnd(r).children().disown().adopt(this.parent,this,this[e]).domFrag().insertAfter(this.domFrag()),this.remove()},w.prototype.deleteSide=function(m,y,f){var k=this.parent,L=this[m],G=k.getEnd(m);if(m===this.side){this.unwrap(),L?f.insDirOf(-m,L):f.insAtDirEnd(m,k);return}var U=f.options,H=!this.side;if(this.side=-m,this.matchBrack(U,m,this.getEnd(r).getEnd(this.side))){this.closeOpposing(this.getEnd(r).getEnd(this.side));var Q=this.getEnd(r).getEnd(m);this.unwrap(),Q&&Q.siblingCreated(f.options,m),L?f.insDirOf(-m,L):f.insAtDirEnd(m,k)}else{if(this.matchBrack(U,m,this.parent.parent))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else if(y&&H){this.unwrap(),L?f.insDirOf(-m,L):f.insAtDirEnd(m,k);return}else{this.sides[m]=FS(this),this.delimFrags[r].removeClass("dcg-mq-ghost"),this.delimFrags[e].removeClass("dcg-mq-ghost");var pe=this.delimFrags[m].addClass("dcg-mq-ghost");this.replaceBracket(pe,m)}if(L){var ne=this.getEnd(r),Q=ne.getEnd(m);ne.domFrag().removeClass("dcg-mq-empty"),new B(L,G,-m).disown().withDirAdopt(-m,ne,Q,0).domFrag().insAtDirEnd(m,ne.domFrag().oneElement()),Q&&Q.siblingCreated(f.options,m),f.insDirOf(-m,L)}else y?f.insDirOf(m,this):f.insAtDirEnd(m,this.getEnd(r))}},w.prototype.replaceBracket=function(m,y){var f=this.getSymbol(y);if(m.children().replaceWith(N(f.html())),m.oneElement().style.width=f.width,y===r){var k=m.next();k.isEmpty()||(k.oneElement().style.marginLeft=f.width)}else{var L=m.prev();L.isEmpty()||(L.oneElement().style.marginRight=f.width)}},w.prototype.deleteTowards=function(m,y){this.deleteSide(-m,!1,y)},w.prototype.finalizeTree=function(){this.getEnd(r).deleteOutOf=function(m,y){this.parent.deleteSide(m,!0,y)},this.finalizeTree=this.intentionalBlur=function(){this.delimFrags[this.side===r?e:r].removeClass("dcg-mq-ghost"),this.side=0}},w.prototype.siblingCreated=function(m,y){y===-this.side&&this.finalizeTree()},w}(wf);function FS(M){var w=M.side,m=M.sides[w];return{ch:Sf[m.ch],ctrlSeq:Sf[m.ctrlSeq]}}var Sf={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|","\\lVert ":"\\rVert ","\\rVert ":"\\lVert "},ng={"&lang;":"angle-bracket","&rang;":"angle-bracket","|":"pipe"};function tx(M,y,m){var y=y||M,f=Sf[M],k=Sf[y];K[M]=function(){return new Bs(r,M,f,y,k)},K[f]=function(){return new Bs(e,M,f,y,k)},ng[M]=ng[f]=m}tx("(","","parenthesis"),tx("[","","bracket"),tx("{","\\{","brace"),V.langle=function(){return new Bs(r,"&lang;","&rang;","\\langle ","\\rangle ")},V.rangle=function(){return new Bs(e,"&lang;","&rang;","\\langle ","\\rangle ")},K["|"]=function(){return new Bs(r,"|","|","|","|")},V.lVert=function(){return new Bs(r,"&#8741;","&#8741;","\\lVert ","\\rVert ")},V.rVert=function(){return new Bs(e,"&#8741;","&#8741;","\\lVert ","\\rVert ")},V.left=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.parser=function(){var m=ge.regex,y=ge.string,f=ge.optWhitespace;return f.then(m(/^(?:[([|]|\\\{|\\langle(?![a-zA-Z])|\\lVert(?![a-zA-Z]))/)).then(function(k){var L=k.replace(/^\\/,"");return k=="\\langle"&&(L="&lang;",k=k+" "),k=="\\lVert"&&(L="&#8741;",k=k+" "),le.then(function(G){return y("\\right").skip(f).then(m(/^(?:[\])|]|\\\}|\\rangle(?![a-zA-Z])|\\rVert(?![a-zA-Z]))/)).map(function(U){var H=U.replace(/^\\/,"");U=="\\rangle"&&(H="&rang;",U=U+" "),U=="\\rVert"&&(H="&#8741;",U=U+" ");var Q=new Bs(0,L,H,k,U);return Q.blocks=[G],G.adopt(Q,0,0),Q})})})},w}(pt),V.right=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.parser=function(){return ge.fail("unmatched \\right")},w}(pt);var kf=ig["("],NS=ig[")"],$T=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.ctrlSeq="\\binom",m.domView=new Ze(2,function(y){return d("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[d("span",{style:"width:"+kf.width,class:"dcg-mq-paren dcg-mq-bracket-l dcg-mq-scaled"},[kf.html()]),d("span",{style:"margin-left:"+kf.width+"; margin-right:"+NS.width,class:"dcg-mq-non-leaf dcg-mq-bracket-middle"},[d("span",{class:"dcg-mq-array dcg-mq-non-leaf"},[d.block("span",{},y[0]),d.block("span",{},y[1])])]),d("span",{style:"width:"+NS.width,class:"dcg-mq-paren dcg-mq-bracket-r dcg-mq-scaled"},[NS.html()])])}),m.textTemplate=["choose(",",",")"],m.mathspeakTemplate=["StartBinomial,","Choose",", EndBinomial"],m.ariaLabel="binomial",m}return w.prototype.finalizeTree=function(){var m=this.getEnd(r),y=this.getEnd(e);this.upInto=y.upOutOf=m,this.downInto=m.downOutOf=y,m.ariaLabel="upper index",y.ariaLabel="lower index"},w}(wf);V.binom=V.binomial=$T,V.choose=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.createLeftOf=function(m){HT.prototype.createLeftOf.call(this,m)},w}($T);var dR=function(M){yt(w,M);function w(){var m=M!==null&&M.apply(this,arguments)||this;return m.ctrlSeq="\\MathQuillMathField",m.domView=new Ze(1,function(y){return d("span",{class:"dcg-mq-editable-field"},[d.block("span",{class:"dcg-mq-root-block","aria-hidden":"true"},y[0])])}),m}return w.prototype.parser=function(){var m=this,y=ge.string,f=ge.regex,k=ge.succeed;return y("[").then(f(/^[a-z][a-z0-9]*/i)).skip(y("]")).map(function(L){m.name=L}).or(k(void 0)).then(M.prototype.parser.call(this))},w.prototype.finalizeTree=function(m){var y=new Xr(this.getEnd(r),this.domFrag().oneElement(),m);y.KIND_OF_MQ="MathField",y.editable=!0,y.createTextarea(),y.editablesTextareaEvents(),y.cursor.insAtRightEnd(y.root),Ie(y.root);function f(k){if(k.parentNode&&!N(k).hasClass("dcg-mq-root-block")&&f(k.parentNode),k.nodeType===Node.ELEMENT_NODE){var L=k;L.getAttribute("aria-hidden")==="true"&&(L.removeAttribute("aria-hidden"),N(k).children().eachElement(function(G){G.setAttribute("aria-hidden","true")}))}}f(this.domFrag().parent().oneElement()),this.domFrag().oneElement().removeAttribute("aria-hidden")},w.prototype.registerInnerField=function(m,y){var f=this.getEnd(r).controller,k=new y(f);m[this.name]=k,m.push(k)},w.prototype.latexRecursive=function(m){this.checkCursorContextOpen(m),this.getEnd(r).latexRecursive(m),this.checkCursorContextClose(m)},w.prototype.text=function(){return this.getEnd(r).text()},w}(pt);V.editable=V.MathQuillMathField=dR;var jd=function(M){yt(w,M);function w(){return M!==null&&M.apply(this,arguments)||this}return w.prototype.setOptions=function(m){function y(){return""}return this.text=m.text||y,this.domView=new Ze(0,function(){return d("span",{},[c(m.htmlString||"")])}),this.latex=m.latex||y,this},w.prototype.latexRecursive=function(m){this.checkCursorContextOpen(m),m.latex+=this.latex(),this.checkCursorContextClose(m)},w.prototype.parser=function(){var m=this,y=ge.string,f=ge.regex,k=ge.succeed;return y("{").then(f(/^[a-z][a-z0-9]*/i)).skip(y("}")).then(function(L){return y("[").then(f(/^[-\w\s]*/)).skip(y("]")).or(k(void 0)).map(function(G){return m.setOptions($[L](G))})})},w}(xt);if(V.embed=jd,window.jQuery){Te=te(1);for(var JT in Te)(function(M,w){typeof w=="function"?(Ae[M]=function(){return Ce(),w.apply(this,arguments)},Ae[M].prototype=w.prototype):Ae[M]=w})(JT,Te[JT])}})()});var gZ=__dcg_shared_module_exports__['c']((X8e,hZ)=>{hZ.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}});var fZ=__dcg_shared_module_exports__['c'](($8e,mZ)=>{var kye=/([\w-]+)|=|(['"])([.\s\S]*?)\2/g,_ye=gZ();mZ.exports=function(r){var e=0,t,o=!0,i={type:"tag",name:"",voidElement:!1,attrs:{},children:[]};return r.replace(kye,function(n){if(n==="="){o=!0,e++;return}o?e===0?((_ye[n]||r.charAt(r.length-2)==="/")&&(i.voidElement=!0),i.name=n):(i.attrs[t]=n.replace(/^['"]|['"]$/g,""),t=void 0):(t&&(i.attrs[t]=t),t=n),e++,o=!1}),i}});var yZ=__dcg_shared_module_exports__['c']((J8e,bZ)=>{var Cye=/(?:<!--[\S\s]*?-->|<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>)/g,Tye=fZ(),Eye=Object.create?Object.create(null):{};function wU(r,e,t,o,i){var n=e.indexOf("<",o),a=e.slice(o,n===-1?void 0:n);/^\s*$/.test(a)&&(a=" "),(!i&&n>-1&&t+r.length>=0||a!==" ")&&r.push({type:"text",content:a})}bZ.exports=function(e,t){t||(t={}),t.components||(t.components=Eye);var o=[],i,n=-1,a=[],s={},c=!1;return e.replace(Cye,function(d,p){if(c){if(d!=="</"+i.name+">")return;c=!1}var u=d.charAt(1)!=="/",g=d.indexOf("<!--")===0,h=p+d.length,b=e.charAt(h),v;u&&!g&&(n++,i=Tye(d),i.type==="tag"&&t.components[i.name]&&(i.type="component",c=!0),!i.voidElement&&!c&&b&&b!=="<"&&wU(i.children,e,n,h,t.ignoreWhitespace),s[i.tagName]=i,n===0&&o.push(i),v=a[n-1],v&&v.children.push(i),a[n]=i),(g||!u||i.voidElement)&&(g||n--,!c&&b!=="<"&&b&&(v=n===-1?o:a[n].children,wU(v,e,n,h,t.ignoreWhitespace)))}),!o.length&&e.length&&wU(o,e,0,0,t.ignoreWhitespace),o}});var wZ=__dcg_shared_module_exports__['c']((Z8e,vZ)=>{function Iye(r){var e=[];for(var t in r)e.push(t+'="'+r[t]+'"');return e.length?" "+e.join(" "):""}function xZ(r,e){switch(e.type){case"text":return r+e.content;case"tag":return r+="<"+e.name+(e.attrs?Iye(e.attrs):"")+(e.voidElement?"/>":">"),e.voidElement?r:r+e.children.reduce(xZ,"")+"</"+e.name+">"}}vZ.exports=function(r){return r.reduce(function(e,t){return e+xZ("",t)},"")}});var kZ=__dcg_shared_module_exports__['c']((Q8e,SZ)=>{SZ.exports={parse:yZ(),stringify:wZ()}});var Vse=__dcg_shared_module_exports__['c']((Gse,D6)=>{(function(r){if(typeof Gse=="object"&&typeof D6!="undefined")D6.exports=r();else{var e;typeof window!="undefined"?e=window:typeof global!="undefined"?e=global:typeof self!="undefined"?e=self:e=this,e.Bugsnag=r()}})(function(){var r,e,t,o=["navigation","request","process","log","user","state","error","manual"],i=function(f,k,L){for(var G=L,U=0,H=f.length;U<H;U++)G=k(G,f[U],U,f);return G},n=function(f,k){return i(f,function(L,G,U,H){return k(G,U,H)?L.concat(G):L},[])},a=function(f,k){return i(f,function(L,G,U,H){return L===!0||G===k},!1)},s=function(f){return Object.prototype.toString.call(f)==="[object Array]"},c=!{toString:null}.propertyIsEnumerable("toString"),d=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],p=function(f){var k=[],L;for(L in f)Object.prototype.hasOwnProperty.call(f,L)&&k.push(L);if(!c)return k;for(var G=0,U=d.length;G<U;G++)Object.prototype.hasOwnProperty.call(f,d[G])&&k.push(d[G]);return k},u=function(f,k){return f===void 0&&(f=1),k===void 0&&(k=1/0),function(L){return typeof L=="number"&&parseInt(""+L,10)===L&&L>=f&&L<=k}},g=function(f){return typeof f=="function"||s(f)&&n(f,function(k){return typeof k=="function"}).length===f.length},h=function(f){return typeof f=="string"&&!!f.length},b={},v=function(){return{unhandledExceptions:!0,unhandledRejections:!0}};b.schema={apiKey:{defaultValue:function(){return null},message:"is required",validate:h},appVersion:{defaultValue:function(){},message:"should be a string",validate:function(f){return f===void 0||h(f)}},appType:{defaultValue:function(){},message:"should be a string",validate:function(f){return f===void 0||h(f)}},autoDetectErrors:{defaultValue:function(){return!0},message:"should be true|false",validate:function(f){return f===!0||f===!1}},enabledErrorTypes:{defaultValue:function(){return v()},message:"should be an object containing the flags { unhandledExceptions:true|false, unhandledRejections:true|false }",allowPartialObject:!0,validate:function(f){if(typeof f!="object"||!f)return!1;var k=p(f),L=p(v());return!(n(k,function(G){return a(L,G)}).length<k.length||n(p(f),function(G){return typeof f[G]!="boolean"}).length>0)}},onError:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:g},onSession:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:g},onBreadcrumb:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:g},endpoints:{defaultValue:function(f){return typeof f=="undefined"?{notify:"https://notify.bugsnag.com",sessions:"https://sessions.bugsnag.com"}:{notify:null,sessions:null}},message:"should be an object containing endpoint URLs { notify, sessions }",validate:function(f){return f&&typeof f=="object"&&h(f.notify)&&h(f.sessions)&&n(p(f),function(k){return!a(["notify","sessions"],k)}).length===0}},autoTrackSessions:{defaultValue:function(f){return!0},message:"should be true|false",validate:function(f){return f===!0||f===!1}},enabledReleaseStages:{defaultValue:function(){return null},message:"should be an array of strings",validate:function(f){return f===null||s(f)&&n(f,function(k){return typeof k=="string"}).length===f.length}},releaseStage:{defaultValue:function(){return"production"},message:"should be a string",validate:function(f){return typeof f=="string"&&f.length}},maxBreadcrumbs:{defaultValue:function(){return 25},message:"should be a number \u2264100",validate:function(f){return u(0,100)(f)}},enabledBreadcrumbTypes:{defaultValue:function(){return o},message:"should be null or a list of available breadcrumb types ("+o.join(",")+")",validate:function(f){return f===null||s(f)&&i(f,function(k,L){return k===!1?k:a(o,L)},!0)}},context:{defaultValue:function(){},message:"should be a string",validate:function(f){return f===void 0||typeof f=="string"}},user:{defaultValue:function(){return{}},message:"should be an object with { id, email, name } properties",validate:function(f){return f===null||f&&i(p(f),function(k,L){return k&&a(["id","email","name"],L)},!0)}},metadata:{defaultValue:function(){return{}},message:"should be an object",validate:function(f){return typeof f=="object"&&f!==null}},logger:{defaultValue:function(){},message:"should be null or an object with methods { debug, info, warn, error }",validate:function(f){return!f||f&&i(["debug","info","warn","error"],function(k,L){return k&&typeof f[L]=="function"},!0)}},redactedKeys:{defaultValue:function(){return["password"]},message:"should be an array of strings|regexes",validate:function(f){return s(f)&&f.length===n(f,function(k){return typeof k=="string"||k&&typeof k.test=="function"}).length}},plugins:{defaultValue:function(){return[]},message:"should be an array of plugin objects",validate:function(f){return s(f)&&f.length===n(f,function(k){return k&&typeof k=="object"&&typeof k.load=="function"}).length}},featureFlags:{defaultValue:function(){return[]},message:'should be an array of objects that have a "name" property',validate:function(f){return s(f)&&f.length===n(f,function(k){return k&&typeof k=="object"&&typeof k.name=="string"}).length}},reportUnhandledPromiseRejectionsAsHandled:{defaultValue:function(){return!1},message:"should be true|false",validate:function(f){return f===!0||f===!1}},sendPayloadChecksums:{defaultValue:function(){return!1},message:"should be true|false",validate:function(f){return f===!0||f===!1}}};var T=function(f){for(var k=1;k<arguments.length;k++){var L=arguments[k];for(var G in L)Object.prototype.hasOwnProperty.call(L,G)&&(f[G]=L[G])}return f},E=function(f,k){return i(f,function(L,G,U,H){return L.concat(k(G,U,H))},[])};function I(){return I=Object.assign?Object.assign.bind():function(f){for(var k=1;k<arguments.length;k++){var L=arguments[k];for(var G in L)Object.prototype.hasOwnProperty.call(L,G)&&(f[G]=L[G])}return f},I.apply(this,arguments)}var _=b.schema,C={releaseStage:T({},_.releaseStage,{defaultValue:function(){return/^localhost(:\d+)?$/.test(window.location.host)?"development":"production"}}),appType:I({},_.appType,{defaultValue:function(){return"browser"}}),logger:T({},_.logger,{defaultValue:function(){return typeof console!="undefined"&&typeof console.debug=="function"?D():void 0}})},D=function(){var f={},k=console.log;return E(["debug","info","warn","error"],function(L){var G=console[L];f[L]=typeof G=="function"?G.bind(console,"[bugsnag]"):k.bind(console,"[bugsnag]")}),f},P=function(){function f(L,G,U,H){H===void 0&&(H=new Date),this.type=U,this.message=L,this.metadata=G,this.timestamp=H}var k=f.prototype;return k.toJSON=function(){return{type:this.type,name:this.message,timestamp:this.timestamp,metaData:this.metadata}},f}(),F=P,N={};(function(f,k){"use strict";typeof r=="function"&&r.amd?r("stackframe",[],k):typeof N=="object"?N=k():f.StackFrame=k()})(this,function(){"use strict";function f(Le){return!isNaN(parseFloat(Le))&&isFinite(Le)}function k(Le){return Le.charAt(0).toUpperCase()+Le.substring(1)}function L(Le){return function(){return this[Le]}}var G=["isConstructor","isEval","isNative","isToplevel"],U=["columnNumber","lineNumber"],H=["fileName","functionName","source"],Q=["args"],pe=["evalOrigin"],ne=G.concat(U,H,Q,pe);function fe(Le){if(Le)for(var et=0;et<ne.length;et++)Le[ne[et]]!==void 0&&this["set"+k(ne[et])](Le[ne[et]])}fe.prototype={getArgs:function(){return this.args},setArgs:function(Le){if(Object.prototype.toString.call(Le)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=Le},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(Le){if(Le instanceof fe)this.evalOrigin=Le;else if(Le instanceof Object)this.evalOrigin=new fe(Le);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var Le=this.getFileName()||"",et=this.getLineNumber()||"",Wt=this.getColumnNumber()||"",$e=this.getFunctionName()||"";return this.getIsEval()?Le?"[eval] ("+Le+":"+et+":"+Wt+")":"[eval]:"+et+":"+Wt:$e?$e+" ("+Le+":"+et+":"+Wt+")":Le+":"+et+":"+Wt}},fe.fromString=function(et){var Wt=et.indexOf("("),$e=et.lastIndexOf(")"),St=et.substring(0,Wt),Cr=et.substring(Wt+1,$e).split(","),yr=et.substring($e+1);if(yr.indexOf("@")===0)var Do=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(yr,""),Pt=Do[1],Ao=Do[2],hi=Do[3];return new fe({functionName:St,args:Cr||void 0,fileName:Pt,lineNumber:Ao||void 0,columnNumber:hi||void 0})};for(var xe=0;xe<G.length;xe++)fe.prototype["get"+k(G[xe])]=L(G[xe]),fe.prototype["set"+k(G[xe])]=function(Le){return function(et){this[Le]=!!et}}(G[xe]);for(var Re=0;Re<U.length;Re++)fe.prototype["get"+k(U[Re])]=L(U[Re]),fe.prototype["set"+k(U[Re])]=function(Le){return function(et){if(!f(et))throw new TypeError(Le+" must be a Number");this[Le]=Number(et)}}(U[Re]);for(var Ve=0;Ve<H.length;Ve++)fe.prototype["get"+k(H[Ve])]=L(H[Ve]),fe.prototype["set"+k(H[Ve])]=function(Le){return function(et){this[Le]=String(et)}}(H[Ve]);return fe});var Y={};(function(f,k){"use strict";typeof r=="function"&&r.amd?r("stack-generator",["stackframe"],k):typeof Y=="object"?Y=k(N):f.StackGenerator=k(f.StackFrame)})(this,function(f){return{backtrace:function(L){var G=[],U=10;typeof L=="object"&&typeof L.maxStackSize=="number"&&(U=L.maxStackSize);for(var H=arguments.callee;H&&G.length<U&&H.arguments;){for(var Q=new Array(H.arguments.length),pe=0;pe<Q.length;++pe)Q[pe]=H.arguments[pe];/function(?:\s+([\w$]+))+\s*\(/.test(H.toString())?G.push(new f({functionName:RegExp.$1||void 0,args:Q})):G.push(new f({args:Q}));try{H=H.caller}catch(ne){break}}return G}}});var z={};(function(f,k){"use strict";typeof r=="function"&&r.amd?r("error-stack-parser",["stackframe"],k):typeof z=="object"?z=k(N):f.ErrorStackParser=k(f.StackFrame)})(this,function(k){"use strict";var L=/(^|@)\S+:\d+/,G=/^\s*at .*(\S+:\d+|\(native\))/m,U=/^(eval@)?(\[native code])?$/;return{parse:function(Q){if(typeof Q.stacktrace!="undefined"||typeof Q["opera#sourceloc"]!="undefined")return this.parseOpera(Q);if(Q.stack&&Q.stack.match(G))return this.parseV8OrIE(Q);if(Q.stack)return this.parseFFOrSafari(Q);throw new Error("Cannot parse given Error object")},extractLocation:function(Q){if(Q.indexOf(":")===-1)return[Q];var pe=/(.+?)(?::(\d+))?(?::(\d+))?$/,ne=pe.exec(Q.replace(/[()]/g,""));return[ne[1],ne[2]||void 0,ne[3]||void 0]},parseV8OrIE:function(Q){var pe=Q.stack.split(`
`).filter(function(ne){return!!ne.match(G)},this);return pe.map(function(ne){ne.indexOf("(eval ")>-1&&(ne=ne.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));var fe=ne.replace(/^\s+/,"").replace(/\(eval code/g,"("),xe=fe.match(/ (\((.+):(\d+):(\d+)\)$)/);fe=xe?fe.replace(xe[0],""):fe;var Re=fe.split(/\s+/).slice(1),Ve=this.extractLocation(xe?xe[1]:Re.pop()),Le=Re.join(" ")||void 0,et=["eval","<anonymous>"].indexOf(Ve[0])>-1?void 0:Ve[0];return new k({functionName:Le,fileName:et,lineNumber:Ve[1],columnNumber:Ve[2],source:ne})},this)},parseFFOrSafari:function(Q){var pe=Q.stack.split(`
`).filter(function(ne){return!ne.match(U)},this);return pe.map(function(ne){if(ne.indexOf(" > eval")>-1&&(ne=ne.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),ne.indexOf("@")===-1&&ne.indexOf(":")===-1)return new k({functionName:ne});var fe=/((.*".+"[^@]*)?[^@]*)(?:@)/,xe=ne.match(fe),Re=xe&&xe[1]?xe[1]:void 0,Ve=this.extractLocation(ne.replace(fe,""));return new k({functionName:Re,fileName:Ve[0],lineNumber:Ve[1],columnNumber:Ve[2],source:ne})},this)},parseOpera:function(Q){return!Q.stacktrace||Q.message.indexOf(`
`)>-1&&Q.message.split(`
`).length>Q.stacktrace.split(`
`).length?this.parseOpera9(Q):Q.stack?this.parseOpera11(Q):this.parseOpera10(Q)},parseOpera9:function(Q){for(var pe=/Line (\d+).*script (?:in )?(\S+)/i,ne=Q.message.split(`
`),fe=[],xe=2,Re=ne.length;xe<Re;xe+=2){var Ve=pe.exec(ne[xe]);Ve&&fe.push(new k({fileName:Ve[2],lineNumber:Ve[1],source:ne[xe]}))}return fe},parseOpera10:function(Q){for(var pe=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,ne=Q.stacktrace.split(`
`),fe=[],xe=0,Re=ne.length;xe<Re;xe+=2){var Ve=pe.exec(ne[xe]);Ve&&fe.push(new k({functionName:Ve[3]||void 0,fileName:Ve[2],lineNumber:Ve[1],source:ne[xe]}))}return fe},parseOpera11:function(Q){var pe=Q.stack.split(`
`).filter(function(ne){return!!ne.match(L)&&!ne.match(/^Error created at/)},this);return pe.map(function(ne){var fe=ne.split("@"),xe=this.extractLocation(fe.pop()),Re=fe.shift()||"",Ve=Re.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,Le;Re.match(/\(([^)]*)\)/)&&(Le=Re.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var et=Le===void 0||Le==="[arguments not available]"?void 0:Le.split(",");return new k({functionName:Ve,args:et,fileName:xe[0],lineNumber:xe[1],columnNumber:xe[2],source:ne})},this)}}});var X=z,q=function(f,k,L,G){var U=G&&G.redactedKeys?G.redactedKeys:[],H=G&&G.redactedPaths?G.redactedPaths:[];return JSON.stringify(ae(f,U,H),k,L)},S=20,A=25e3,O=8,B="...";function V(f){return f instanceof Error||/^\[object (Error|(Dom)?Exception)\]$/.test(Object.prototype.toString.call(f))}function K(f){return"[Throws: "+(f?f.message:"?")+"]"}function oe(f,k){for(var L=0,G=f.length;L<G;L++)if(f[L]===k)return!0;return!1}function Z(f,k){for(var L=0,G=f.length;L<G;L++)if(k.indexOf(f[L])===0)return!0;return!1}function ee(f,k){for(var L=0,G=f.length;L<G;L++)if(typeof f[L]=="string"&&f[L].toLowerCase()===k.toLowerCase()||f[L]&&typeof f[L].test=="function"&&f[L].test(k))return!0;return!1}function ue(f){return Object.prototype.toString.call(f)==="[object Array]"}function he(f,k){try{return f[k]}catch(L){return K(L)}}function ae(f,k,L){var G=[],U=0;function H(Q,pe){function ne(){return pe.length>O&&U>A}if(U++,pe.length>S||ne())return B;if(Q===null||typeof Q!="object")return Q;if(oe(G,Q))return"[Circular]";if(G.push(Q),typeof Q.toJSON=="function")try{U--;var fe=H(Q.toJSON(),pe);return G.pop(),fe}catch(St){return K(St)}var xe=V(Q);if(xe){U--;var Re=H({name:Q.name,message:Q.message},pe);return G.pop(),Re}if(ue(Q)){for(var Ve=[],Le=0,et=Q.length;Le<et;Le++){if(ne()){Ve.push(B);break}Ve.push(H(Q[Le],pe.concat("[]")))}return G.pop(),Ve}var Wt={};try{for(var $e in Q)if(Object.prototype.hasOwnProperty.call(Q,$e)){if(Z(L,pe.join("."))&&ee(k,$e)){Wt[$e]="[REDACTED]";continue}if(ne()){Wt[$e]=B;break}Wt[$e]=H(he(Q,$e),pe.concat($e))}}catch(St){}return G.pop(),Wt}return H(f,[])}function $(f,k,L,G){if(typeof L=="string"){G===void 0?G=null:G!==null&&typeof G!="string"&&(G=q(G));var U=k[L];if(typeof U=="number"){f[U]={name:L,variant:G};return}f.push({name:L,variant:G}),k[L]=f.length-1}}function se(f,k,L){if(s(k)){for(var G=0;G<k.length;++G){var U=k[G];U===null||typeof U!="object"||$(f,L,U.name,U.variant)}return f}}function J(f){return E(n(f,Boolean),function(k){var L=k.name,G=k.variant,U={featureFlag:L};return typeof G=="string"&&(U.variant=G),U})}function ye(f,k,L){var G=k[L];typeof G=="number"&&(f[G]=null,delete k[L])}var Se={add:$,clear:ye,merge:se,toEventApi:J},Ce=function(f){return!!f&&(!!f.stack||!!f.stacktrace||!!f["opera#sourceloc"])&&typeof(f.stack||f.stacktrace||f["opera#sourceloc"])=="string"&&f.stack!==f.name+": "+f.message},Te=Ae;function Ae(f){switch(Object.prototype.toString.call(f)){case"[object Error]":return!0;case"[object Exception]":return!0;case"[object DOMException]":return!0;default:return f instanceof Error}}var je=Te,ie=function(f,k,L,G){var U;if(k){var H;if(L===null)return we(f,k);typeof L=="object"&&(H=L),typeof L=="string"&&(H=(U={},U[L]=G,U)),H&&(k==="__proto__"||k==="constructor"||k==="prototype"||(f[k]||(f[k]={}),f[k]=T({},f[k],H)))}},te=function(f,k,L){if(typeof k=="string"){if(!L)return f[k];if(f[k])return f[k][L]}},we=function(f,k,L){if(typeof k=="string"){if(!L){delete f[k];return}k==="__proto__"||k==="constructor"||k==="prototype"||f[k]&&delete f[k][L]}},Ie={add:ie,get:te,clear:we};function He(){return He=Object.assign?Object.assign.bind():function(f){for(var k=1;k<arguments.length;k++){var L=arguments[k];for(var G in L)Object.prototype.hasOwnProperty.call(L,G)&&(f[G]=L[G])}return f},He.apply(this,arguments)}var ge=function(){function f(L,G,U,H,Q){U===void 0&&(U=[]),H===void 0&&(H=Me()),this.apiKey=void 0,this.context=void 0,this.groupingHash=void 0,this.originalError=Q,this._handledState=H,this.severity=this._handledState.severity,this.unhandled=this._handledState.unhandled,this.app={},this.device={},this.request={},this.breadcrumbs=[],this.threads=[],this._metadata={},this._features=[],this._featuresIndex={},this._user={},this._session=void 0,this._correlation=void 0,this.errors=[Tt(L,G,f.__type,U)]}var k=f.prototype;return k.addMetadata=function(G,U,H){return Ie.add(this._metadata,G,U,H)},k.setTraceCorrelation=function(G,U){typeof G=="string"&&(this._correlation=He({traceId:G},typeof U=="string"?{spanId:U}:{}))},k.getMetadata=function(G,U){return Ie.get(this._metadata,G,U)},k.clearMetadata=function(G,U){return Ie.clear(this._metadata,G,U)},k.addFeatureFlag=function(G,U){U===void 0&&(U=null),Se.add(this._features,this._featuresIndex,G,U)},k.addFeatureFlags=function(G){Se.merge(this._features,G,this._featuresIndex)},k.getFeatureFlags=function(){return Se.toEventApi(this._features)},k.clearFeatureFlag=function(G){Se.clear(this._features,this._featuresIndex,G)},k.clearFeatureFlags=function(){this._features=[],this._featuresIndex={}},k.getUser=function(){return this._user},k.setUser=function(G,U,H){this._user={id:G,email:U,name:H}},k.toJSON=function(){return{payloadVersion:"4",exceptions:E(this.errors,function(G){return T({},G,{message:G.errorMessage})}),severity:this.severity,unhandled:this._handledState.unhandled,severityReason:this._handledState.severityReason,app:this.app,device:this.device,request:this.request,breadcrumbs:this.breadcrumbs,context:this.context,groupingHash:this.groupingHash,metaData:this._metadata,user:this._user,session:this._session,featureFlags:this.getFeatureFlags(),correlation:this._correlation}},f}(),nt=function(f){var k={file:f.fileName,method:lt(f.functionName),lineNumber:f.lineNumber,columnNumber:f.columnNumber,code:void 0,inProject:void 0};return k.lineNumber>-1&&!k.file&&!k.method&&(k.file="global code"),k},lt=function(f){return/^global code$/i.test(f)?"global code":f},Me=function(){return{unhandled:!1,severity:"warning",severityReason:{type:"handledException"}}},Nt=function(f){return typeof f=="string"?f:""};function Tt(f,k,L,G){return{errorClass:Nt(f),errorMessage:Nt(k),type:L,stacktrace:i(G,function(U,H){var Q=nt(H);try{return JSON.stringify(Q)==="{}"?U:U.concat(Q)}catch(pe){return U}},[])}}function Et(f){return f.cause?[f].concat(Et(f.cause)):[f]}ge.getStacktrace=function(f,k,L){if(Ce(f))return X.parse(f).slice(k);try{return n(Y.backtrace(),function(G){return(G.functionName||"").indexOf("StackGenerator$$")===-1}).slice(1+L)}catch(G){return[]}},ge.create=function(f,k,L,G,U,H){U===void 0&&(U=0);var Q=de(f,k,G,H),pe=Q[0],ne=Q[1],fe;try{var xe=ge.getStacktrace(pe,ne>0?1+ne+U:0,1+U);fe=new ge(pe.name,pe.message,xe,L,f)}catch(et){fe=new ge(pe.name,pe.message,[],L,f)}if(pe.name==="InvalidError"&&fe.addMetadata(""+G,"non-error parameter",gr(f)),pe.cause){var Re,Ve=Et(pe).slice(1),Le=E(Ve,function(et){var Wt=je(et)&&Ce(et)?X.parse(et):[],$e=de(et,!0,"error cause"),St=$e[0];return St.name==="InvalidError"&&fe.addMetadata("error cause",gr(et)),Tt(St.name,St.message,ge.__type,Wt)});(Re=fe.errors).push.apply(Re,Le)}return fe};var gr=function(f){return f===null?"null":f===void 0?"undefined":f},de=function(f,k,L,G){var U,H=0,Q=function(pe){var ne=L==="error cause"?"was":"received";G&&G.warn(L+" "+ne+' a non-error: "'+pe+'"');var fe=new Error(L+" "+ne+' a non-error. See "'+L+'" tab for more detail.');return fe.name="InvalidError",fe};if(!k)je(f)?U=f:(U=Q(typeof f),H+=2);else switch(typeof f){case"string":case"number":case"boolean":U=new Error(String(f)),H+=1;break;case"function":U=Q("function"),H+=2;break;case"object":f!==null&&je(f)?U=f:f!==null&&le(f)?(U=new Error(f.message||f.errorMessage),U.name=f.name||f.errorClass,H+=1):(U=Q(f===null?"null":"unsupported object"),H+=2);break;default:U=Q("nothing"),H+=2}if(!Ce(U))try{throw U}catch(pe){Ce(pe)&&(U=pe,H=1)}return[U,H]};ge.__type="browserjs";var le=function(f){return(typeof f.name=="string"||typeof f.errorClass=="string")&&(typeof f.message=="string"||typeof f.errorMessage=="string")},Fe=ge,be=function(f,k,L){var G=0,U=function(){if(G>=f.length)return L(null,!0);k(f[G],function(H,Q){if(H)return L(H);if(Q===!1)return L(null,!1);G++,U()})};U()},it=function(f,k,L,G){var U=function(H,Q){if(typeof H!="function")return Q(null);try{if(H.length!==2){var pe=H(k);return pe&&typeof pe.then=="function"?pe.then(function(ne){return setTimeout(function(){return Q(null,ne)})},function(ne){setTimeout(function(){return L(ne),Q(null,!0)})}):Q(null,pe)}H(k,function(ne,fe){if(ne)return L(ne),Q(null);Q(null,fe)})}catch(ne){L(ne),Q(null)}};be(f,U,G)},Ye=function(f,k,L,G){for(var U=!1,H=f.slice();!U&&H.length;)try{U=H.pop()(k)===!1}catch(Q){G.error("Error occurred in "+L+" callback, continuing anyway\u2026"),G.error(Q)}return U},_r=function(k,L){var G="000000000"+k;return G.substr(G.length-L)},ht=typeof window=="object"?window:self,Ni=0;for(var Xr in ht)Object.hasOwnProperty.call(ht,Xr)&&Ni++;var mo=navigator.mimeTypes?navigator.mimeTypes.length:0,Ze=_r((mo+navigator.userAgent.length).toString(36)+Ni.toString(36),4),pt=function(){return Ze},xt=function(k){return typeof k=="string"&&/^c[a-z0-9]{20,32}$/.test(k)},ke=0,ce=4,ve=36,We=Math.pow(ve,ce);function De(){return _r((Math.random()*We<<0).toString(ve),ce)}function mt(){return ke=ke<We?ke:0,ke++,ke-1}function gt(){var f="c",k=new Date().getTime().toString(ve),L=_r(mt().toString(ve),ce),G=pt(),U=De()+De();return f+k+L+G+U}gt.fingerprint=pt,gt.isCuid=xt;var Vt=gt,ir=function(){function f(){this.id=Vt(),this.startedAt=new Date,this._handled=0,this._unhandled=0,this._user={},this.app={},this.device={}}var k=f.prototype;return k.getUser=function(){return this._user},k.setUser=function(G,U,H){this._user={id:G,email:U,name:H}},k.toJSON=function(){return{id:this.id,startedAt:this.startedAt,events:{handled:this._handled,unhandled:this._unhandled}}},k._track=function(G){this[G._handledState.unhandled?"_unhandled":"_handled"]+=1},f}(),Yt=ir,Ht=Se.add,Lt=Se.clear,ur=Se.merge,qt=function(){},Mo=function(){function f(L,G,U,H){var Q=this;G===void 0&&(G=b.schema),U===void 0&&(U=[]),this._notifier=H,this._config={},this._schema=G,this._delivery={sendSession:qt,sendEvent:qt},this._logger={debug:qt,info:qt,warn:qt,error:qt},this._plugins={},this._breadcrumbs=[],this._session=null,this._metadata={},this._featuresIndex={},this._features=[],this._context=void 0,this._user={},this._cbs={e:[],s:[],sp:[],b:[]},this.Client=f,this.Event=Fe,this.Breadcrumb=F,this.Session=Yt,this._config=this._configure(L,U),E(U.concat(this._config.plugins),function(fe){fe&&Q._loadPlugin(fe)}),this._depth=1;var pe=this,ne=this.notify;this.notify=function(){return ne.apply(pe,arguments)}}var k=f.prototype;return k.addMetadata=function(G,U,H){return Ie.add(this._metadata,G,U,H)},k.getMetadata=function(G,U){return Ie.get(this._metadata,G,U)},k.clearMetadata=function(G,U){return Ie.clear(this._metadata,G,U)},k.addFeatureFlag=function(G,U){U===void 0&&(U=null),Ht(this._features,this._featuresIndex,G,U)},k.addFeatureFlags=function(G){ur(this._features,G,this._featuresIndex)},k.clearFeatureFlag=function(G){Lt(this._features,this._featuresIndex,G)},k.clearFeatureFlags=function(){this._features=[],this._featuresIndex={}},k.getContext=function(){return this._context},k.setContext=function(G){this._context=G},k._configure=function(G,U){var H=i(U,function(fe,xe){return xe&&xe.configSchema?T({},fe,xe.configSchema):fe},this._schema);G.endpoints||(G.sendPayloadChecksums="sendPayloadChecksums"in G?G.sendPayloadChecksums:!0);var Q=i(p(H),function(fe,xe){var Re=H[xe].defaultValue(G[xe]);if(G[xe]!==void 0){var Ve=H[xe].validate(G[xe]);Ve?H[xe].allowPartialObject?fe.config[xe]=T(Re,G[xe]):fe.config[xe]=G[xe]:(fe.errors[xe]=H[xe].message,fe.config[xe]=Re)}else fe.config[xe]=Re;return fe},{errors:{},config:{}}),pe=Q.errors,ne=Q.config;if(H.apiKey){if(!ne.apiKey)throw new Error("No Bugsnag API Key set");/^[0-9a-f]{32}$/i.test(ne.apiKey)||(pe.apiKey="should be a string of 32 hexadecimal characters")}return this._metadata=T({},ne.metadata),ur(this._features,ne.featureFlags,this._featuresIndex),this._user=T({},ne.user),this._context=ne.context,ne.logger&&(this._logger=ne.logger),ne.onError&&(this._cbs.e=this._cbs.e.concat(ne.onError)),ne.onBreadcrumb&&(this._cbs.b=this._cbs.b.concat(ne.onBreadcrumb)),ne.onSession&&(this._cbs.s=this._cbs.s.concat(ne.onSession)),p(pe).length&&this._logger.warn(Ci(pe,G)),ne},k.getUser=function(){return this._user},k.setUser=function(G,U,H){this._user={id:G,email:U,name:H}},k._loadPlugin=function(G){var U=G.load(this);G.name&&(this._plugins["~"+G.name+"~"]=U)},k.getPlugin=function(G){return this._plugins["~"+G+"~"]},k._setDelivery=function(G){this._delivery=G(this)},k.startSession=function(){var G=new Yt;G.app.releaseStage=this._config.releaseStage,G.app.version=this._config.appVersion,G.app.type=this._config.appType,G._user=T({},this._user);var U=Ye(this._cbs.s,G,"onSession",this._logger);return U?(this._logger.debug("Session not started due to onSession callback"),this):this._sessionDelegate.startSession(this,G)},k.addOnError=function(G,U){U===void 0&&(U=!1),this._cbs.e[U?"unshift":"push"](G)},k.removeOnError=function(G){this._cbs.e=n(this._cbs.e,function(U){return U!==G})},k._addOnSessionPayload=function(G){this._cbs.sp.push(G)},k.addOnSession=function(G){this._cbs.s.push(G)},k.removeOnSession=function(G){this._cbs.s=n(this._cbs.s,function(U){return U!==G})},k.addOnBreadcrumb=function(G,U){U===void 0&&(U=!1),this._cbs.b[U?"unshift":"push"](G)},k.removeOnBreadcrumb=function(G){this._cbs.b=n(this._cbs.b,function(U){return U!==G})},k.pauseSession=function(){return this._sessionDelegate.pauseSession(this)},k.resumeSession=function(){return this._sessionDelegate.resumeSession(this)},k.leaveBreadcrumb=function(G,U,H){if(G=typeof G=="string"?G:"",H=typeof H=="string"&&a(o,H)?H:"manual",U=typeof U=="object"&&U!==null?U:{},!!G){var Q=new F(G,U,H),pe=Ye(this._cbs.b,Q,"onBreadcrumb",this._logger);if(pe){this._logger.debug("Breadcrumb not attached due to onBreadcrumb callback");return}this._breadcrumbs.push(Q),this._breadcrumbs.length>this._config.maxBreadcrumbs&&(this._breadcrumbs=this._breadcrumbs.slice(this._breadcrumbs.length-this._config.maxBreadcrumbs))}},k._isBreadcrumbTypeEnabled=function(G){var U=this._config.enabledBreadcrumbTypes;return U===null||a(U,G)},k.notify=function(G,U,H){H===void 0&&(H=qt);var Q=Fe.create(G,!0,void 0,"notify()",this._depth+1,this._logger);this._notify(Q,U,H)},k._notify=function(G,U,H){var Q=this;if(H===void 0&&(H=qt),G.app=T({},G.app,{releaseStage:this._config.releaseStage,version:this._config.appVersion,type:this._config.appType}),G.context=G.context||this._context,G._metadata=T({},G._metadata,this._metadata),G._user=T({},G._user,this._user),G.breadcrumbs=this._breadcrumbs.slice(),ur(G._features,this._features,G._featuresIndex),this._config.enabledReleaseStages!==null&&!a(this._config.enabledReleaseStages,this._config.releaseStage))return this._logger.warn("Event not sent due to releaseStage/enabledReleaseStages configuration"),H(null,G);var pe=G.severity,ne=function(xe){Q._logger.error("Error occurred in onError callback, continuing anyway\u2026"),Q._logger.error(xe)},fe=[].concat(this._cbs.e).concat(U);it(fe,G,ne,function(xe,Re){if(xe&&ne(xe),!Re)return Q._logger.debug("Event not sent due to onError callback"),H(null,G);Q._isBreadcrumbTypeEnabled("error")&&f.prototype.leaveBreadcrumb.call(Q,G.errors[0].errorClass,{errorClass:G.errors[0].errorClass,errorMessage:G.errors[0].errorMessage,severity:G.severity},"error"),pe!==G.severity&&(G._handledState.severityReason={type:"userCallbackSetSeverity"}),G.unhandled!==G._handledState.unhandled&&(G._handledState.severityReason.unhandledOverridden=!0,G._handledState.unhandled=G.unhandled),Q._session&&(Q._session._track(G),G._session=Q._session),Q._delivery.sendEvent({apiKey:G.apiKey||Q._config.apiKey,notifier:Q._notifier,events:[G]},function(Ve){return H(Ve,G)})})},f}(),Ci=function(f,k){var L=new Error(`Invalid configuration
`+E(p(f),function(G){return"  - "+G+" "+f[G]+", got "+wn(k[G])}).join(`

`));return L},wn=function(f){switch(typeof f){case"string":case"number":case"object":return JSON.stringify(f);default:return String(f)}},di=Mo,$r={},pi=["events.[].metaData","events.[].breadcrumbs.[].metaData","events.[].request"];$r.event=function(f,k){var L=q(f,null,null,{redactedPaths:pi,redactedKeys:k});return L.length>1e6&&(f.events[0]._metadata={notifier:`WARNING!
Serialized payload was `+L.length/1e6+`MB (limit = 1MB)
metadata was removed`},L=q(f,null,null,{redactedPaths:pi,redactedKeys:k})),L},$r.session=function(f,k){var L=q(f,null,null);return L};var Cl={};Cl=function(f,k){return k===void 0&&(k=window),{sendEvent:function(L,G){if(G===void 0&&(G=function(){}),f._config.endpoints.notify===null){var U=new Error("Event not sent due to incomplete endpoint configuration");return G(U)}var H=Ui(f._config,"notify","4",k),Q=$r.event(L,f._config.redactedKeys),pe=new k.XDomainRequest;pe.onload=function(){G(null)},pe.onerror=function(){var ne=new Error("Event failed to send");f._logger.error("Event failed to send\u2026",ne),Q.length>1e6&&f._logger.warn("Event oversized ("+(Q.length/1e6).toFixed(2)+" MB)"),G(ne)},pe.open("POST",H),setTimeout(function(){try{pe.send(Q)}catch(ne){f._logger.error(ne),G(ne)}},0)},sendSession:function(L,G){if(G===void 0&&(G=function(){}),f._config.endpoints.sessions===null){var U=new Error("Session not sent due to incomplete endpoint configuration");return G(U)}var H=Ui(f._config,"sessions","1",k),Q=new k.XDomainRequest;Q.onload=function(){G(null)},Q.open("POST",H),setTimeout(function(){try{Q.send($r.session(L,f._config.redactedKeys))}catch(pe){f._logger.error(pe),G(pe)}},0)}}};var Ui=function(f,k,L,G){var U=JSON.parse(JSON.stringify(new Date)),H=Yi(f.endpoints[k],G.location.protocol);return H+"?apiKey="+encodeURIComponent(f.apiKey)+"&payloadVersion="+L+"&sentAt="+encodeURIComponent(U)},Yi=Cl._matchPageProtocol=function(f,k){return k==="http:"?f.replace(/^https:/,"http:"):f};function zn(f,k){if(f.isSecureContext&&f.crypto&&f.crypto.subtle&&f.crypto.subtle.digest&&typeof TextEncoder=="function"){var L=new TextEncoder().encode(k);return f.crypto.subtle.digest("SHA-1",L).then(function(G){var U=Array.from(new Uint8Array(G)),H=U.map(function(Q){return Q.toString(16).padStart(2,"0")}).join("");return"sha1 "+H})}return Promise.resolve()}var ui=function(f,k){return k===void 0&&(k=window),{sendEvent:function(L,G){G===void 0&&(G=function(){});try{var U=f._config.endpoints.notify;if(U===null){var H=new Error("Event not sent due to incomplete endpoint configuration");return G(H)}var Q=new k.XMLHttpRequest,pe=$r.event(L,f._config.redactedKeys);Q.onreadystatechange=function(){if(Q.readyState===k.XMLHttpRequest.DONE){var ne=Q.status;if(ne===0||ne>=400){var fe=new Error("Request failed with status "+ne);f._logger.error("Event failed to send\u2026",fe),pe.length>1e6&&f._logger.warn("Event oversized ("+(pe.length/1e6).toFixed(2)+" MB)"),G(fe)}else G(null)}},Q.open("POST",U),Q.setRequestHeader("Content-Type","application/json"),Q.setRequestHeader("Bugsnag-Api-Key",L.apiKey||f._config.apiKey),Q.setRequestHeader("Bugsnag-Payload-Version","4"),Q.setRequestHeader("Bugsnag-Sent-At",new Date().toISOString()),f._config.sendPayloadChecksums&&typeof Promise!="undefined"&&Promise.toString().indexOf("[native code]")!==-1?zn(k,pe).then(function(ne){ne&&Q.setRequestHeader("Bugsnag-Integrity",ne),Q.send(pe)}).catch(function(ne){f._logger.error(ne),Q.send(pe)}):Q.send(pe)}catch(ne){f._logger.error(ne)}},sendSession:function(L,G){G===void 0&&(G=function(){});try{var U=f._config.endpoints.sessions;if(U===null){var H=new Error("Session not sent due to incomplete endpoint configuration");return G(H)}var Q=new k.XMLHttpRequest,pe=$r.session(L,f._config.redactedKeys);Q.onreadystatechange=function(){if(Q.readyState===k.XMLHttpRequest.DONE){var ne=Q.status;if(ne===0||ne>=400){var fe=new Error("Request failed with status "+ne);f._logger.error("Session failed to send\u2026",fe),G(fe)}else G(null)}},Q.open("POST",U),Q.setRequestHeader("Content-Type","application/json"),Q.setRequestHeader("Bugsnag-Api-Key",f._config.apiKey),Q.setRequestHeader("Bugsnag-Payload-Version","1"),Q.setRequestHeader("Bugsnag-Sent-At",new Date().toISOString()),f._config.sendPayloadChecksums&&typeof Promise!="undefined"&&Promise.toString().indexOf("[native code]")!==-1?zn(k,pe).then(function(ne){ne&&Q.setRequestHeader("Bugsnag-Integrity",ne),Q.send(pe)}).catch(function(ne){f._logger.error(ne),Q.send(pe)}):Q.send(pe)}catch(ne){f._logger.error(ne)}}}},qd=new Date,da=function(){qd=new Date},Hd={name:"appDuration",load:function(f){return f.addOnError(function(k){var L=new Date;k.app.duration=L-qd},!0),{reset:da}}},wu=function(f){return f===void 0&&(f=window),{load:function(k){k.addOnError(function(L){L.context===void 0&&(L.context=f.location.pathname)},!0)}}},Su="bugsnag-anonymous-id",qn=function(f){try{var k=f.localStorage,L=k.getItem(Su);return L&&/^c[a-z0-9]{20,32}$/.test(L)||(L=Vt(),k.setItem(Su,L)),L}catch(G){}},YT=function(f,k){return f===void 0&&(f=navigator),k===void 0&&(k=window),{load:function(L){var G={locale:f.browserLanguage||f.systemLanguage||f.userLanguage||f.language,userAgent:f.userAgent};k&&k.screen&&k.screen.orientation&&k.screen.orientation.type?G.orientation=k.screen.orientation.type:k&&k.document&&(G.orientation=k.document.documentElement.clientWidth>k.document.documentElement.clientHeight?"landscape":"portrait"),L._config.generateAnonymousId&&(G.id=qn(k)),L.addOnSession(function(U){U.device=T({},U.device,G),L._config.collectUserIp||GS(U)}),L.addOnError(function(U){U.device=T({},U.device,G,{time:new Date}),L._config.collectUserIp||GS(U)},!0)},configSchema:{generateAnonymousId:{validate:function(L){return L===!0||L===!1},defaultValue:function(){return!0},message:"should be true|false"}}}},GS=function(f){var k=f.getUser();(!k||!k.id)&&f.setUser(f.device.id)},lR=function(f){return f===void 0&&(f=window),{load:function(k){k.addOnError(function(L){L.request&&L.request.url||(L.request=T({},L.request,{url:f.location.href}))},!0)}}},BT={load:function(f){f._sessionDelegate=KT}},KT={startSession:function(f,k){var L=f;return L._session=k,L._pausedSession=null,L._config.enabledReleaseStages!==null&&!a(L._config.enabledReleaseStages,L._config.releaseStage)?(L._logger.warn("Session not sent due to releaseStage/enabledReleaseStages configuration"),L):(L._delivery.sendSession({notifier:L._notifier,device:k.device,app:k.app,sessions:[{id:k.id,startedAt:k.startedAt,user:k._user}]}),L)},resumeSession:function(f){return f._session?f:f._pausedSession?(f._session=f._pausedSession,f._pausedSession=null,f):f.startSession()},pauseSession:function(f){f._pausedSession=f._session,f._session=null}},zT={load:function(f){f._config.collectUserIp||f.addOnError(function(k){k._user&&typeof k._user.id=="undefined"&&delete k._user.id,k._user=T({id:"[REDACTED]"},k._user),k.request=T({clientIp:"[REDACTED]"},k.request)})},configSchema:{collectUserIp:{defaultValue:function(){return!0},message:"should be true|false",validate:function(f){return f===!0||f===!1}}}},ig={};ig.load=function(f){var k=/^(local-)?dev(elopment)?$/.test(f._config.releaseStage);k||!f._isBreadcrumbTypeEnabled("log")||E(Qy,function(L){var G=console[L];console[L]=function(){for(var U=arguments.length,H=new Array(U),Q=0;Q<U;Q++)H[Q]=arguments[Q];f.leaveBreadcrumb("Console output",i(H,function(pe,ne,fe){var xe="[Unknown value]";try{xe=String(ne)}catch(Re){}if(xe==="[object Object]")try{xe=JSON.stringify(ne)}catch(Re){}return pe["["+fe+"]"]=xe,pe},{severity:L.indexOf("group")===0?"log":L}),"log"),G.apply(console,H)},console[L]._restore=function(){console[L]=G}})};var Qy=n(["log","debug","info","warn","error"],function(f){return typeof console!="undefined"&&typeof console[f]=="function"}),Us=200,cR=5e5,ex=function(f,k){return f===void 0&&(f=document),k===void 0&&(k=window),{load:function(L){if(!L._config.trackInlineScripts)return;var G=k.location.href,U="",H=!!f.attachEvent,Q=H?f.readyState==="complete":f.readyState!=="loading",pe=function(){return f.documentElement.outerHTML};U=pe();var ne=f.onreadystatechange;f.onreadystatechange=function(){f.readyState==="interactive"&&(U=pe(),Q=!0);try{ne.apply(this,arguments)}catch($e){}};var fe=null,xe=function($e){fe=$e},Re=function(){var $e=f.currentScript||fe;if(!$e&&!Q){var St=f.scripts||f.getElementsByTagName("script");$e=St[St.length-1]}return $e},Ve=function($e){(!Q||!U)&&(U=pe());var St=["<!-- DOC START -->"].concat(U.split(`
`)),Cr=$e-1,yr=Math.max(Cr-3,0),Do=Math.min(Cr+3,St.length);return i(St.slice(yr,Do),function(Pt,Ao,hi){return Pt[yr+1+hi]=Ao.length<=Us?Ao:Ao.substr(0,Us),Pt},{})};L.addOnError(function($e){$e.errors[0].stacktrace=n($e.errors[0].stacktrace,function(Pt){return!/__trace__$/.test(Pt.method)});var St=$e.errors[0].stacktrace[0],Cr=function(Pt){return Pt.replace(/#.*$/,"").replace(/\?.*$/,"")};if(!(St&&St.file&&Cr(St.file)!==Cr(G))){var yr=Re();if(yr){var Do=yr.innerHTML;$e.addMetadata("script","content",Do.length<=cR?Do:Do.substr(0,cR)),St&&St.lineNumber&&(St.code=Ve(St.lineNumber))}}},!0);var Le=E(["setTimeout","setInterval","setImmediate","requestAnimationFrame"],function($e){return xf(k,$e,function(St){return Wt(St,function(Cr){return{get:function(){return Cr[0]},replace:function(yr){Cr[0]=yr}}})})}),et=Le[0];E(["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],function($e){!k[$e]||!k[$e].prototype||!Object.prototype.hasOwnProperty.call(k[$e].prototype,"addEventListener")||(xf(k[$e].prototype,"addEventListener",function(St){return Wt(St,Ys)}),xf(k[$e].prototype,"removeEventListener",function(St){return Wt(St,Ys,!0)}))});function Wt($e,St,Cr){return Cr===void 0&&(Cr=!1),function(){var yr=[].slice.call(arguments);try{var Do=St(yr),Pt=Do.get();if(Cr&&$e.apply(this,yr),typeof Pt!="function")return $e.apply(this,yr);if(Pt.__trace__)Do.replace(Pt.__trace__);else{var Ao=Re();Pt.__trace__=function(){xe(Ao),et(function(){xe(null)},0);var pR=Pt.apply(this,arguments);return xe(null),pR},Pt.__trace__.__trace__=Pt.__trace__,Do.replace(Pt.__trace__)}}catch(hi){}if($e.apply)return $e.apply(this,yr);switch(yr.length){case 1:return $e(yr[0]);case 2:return $e(yr[0],yr[1]);default:return $e()}}}},configSchema:{trackInlineScripts:{validate:function(L){return L===!0||L===!1},defaultValue:function(){return!0},message:"should be true|false"}}}};function xf(f,k,L){var G=f[k];if(!G)return G;var U=L(G);return f[k]=U,G}function Ys(f){var k=!!f[1]&&typeof f[1].handleEvent=="function";return{get:function(){return k?f[1].handleEvent:f[1]},replace:function(L){k?f[1].handleEvent=L:f[1]=L}}}var VS=function(f){return f===void 0&&(f=window),{load:function(k){"addEventListener"in f&&k._isBreadcrumbTypeEnabled("user")&&f.addEventListener("click",function(L){var G,U;try{G=ku(L.target),U=OS(L.target,f)}catch(H){G="[hidden]",U="[hidden]",k._logger.error("Cross domain error when tracking click event. See docs: https://tinyurl.com/yy3rn63z")}k.leaveBreadcrumb("UI click",{targetText:G,targetSelector:U},"user")},!0)}}},qT=/^\s*([^\s][\s\S]{0,139}[^\s])?\s*/;function ku(f){var k=f.textContent||f.innerText||"";return!k&&(f.type==="submit"||f.type==="button")&&(k=f.value),k=k.replace(qT,"$1"),k.length>140?k.slice(0,135)+"(...)":k}function OS(f,k){var L=[f.tagName];if(f.id&&L.push("#"+f.id),f.className&&f.className.length&&L.push("."+f.className.split(" ").join(".")),!k.document.querySelectorAll||!Array.prototype.indexOf)return L.join("");try{if(k.document.querySelectorAll(L.join("")).length===1)return L.join("")}catch(U){return L.join("")}if(f.parentNode.childNodes.length>1){var G=Array.prototype.indexOf.call(f.parentNode.childNodes,f)+1;L.push(":nth-child("+G+")")}return k.document.querySelectorAll(L.join("")).length===1?L.join(""):f.parentNode?OS(f.parentNode,k)+" > "+L.join(""):L.join("")}var HT={};HT=function(f){f===void 0&&(f=window);var k={load:function(L){if("addEventListener"in f&&L._isBreadcrumbTypeEnabled("navigation")){var G=function(U){return function(){return L.leaveBreadcrumb(U,{},"navigation")}};f.addEventListener("pagehide",G("Page hidden"),!0),f.addEventListener("pageshow",G("Page shown"),!0),f.addEventListener("load",G("Page loaded"),!0),f.document.addEventListener("DOMContentLoaded",G("DOMContentLoaded"),!0),f.addEventListener("load",function(){return f.addEventListener("popstate",G("Navigated back"),!0)}),f.addEventListener("hashchange",function(U){var H=U.oldURL?{from:vf(U.oldURL,f),to:vf(U.newURL,f),state:RS(f)}:{to:vf(f.location.href,f)};L.leaveBreadcrumb("Hash changed",H,"navigation")},!0),f.history.pushState&&jT(L,f.history,"pushState",f,!0),f.history.replaceState&&jT(L,f.history,"replaceState",f)}}};return k};var vf=function(f,k){var L=k.document.createElement("A");return L.href=f,""+L.pathname+L.search+L.hash},WT=function(f,k,L,G){var U=vf(f.location.href,f);return{title:L,state:k,prevState:RS(f),to:G||U,from:U}},jT=function(f,k,L,G,U){U===void 0&&(U=!1);var H=k[L];k[L]=function(Q,pe,ne){f.leaveBreadcrumb("History "+L,WT(G,Q,pe,ne),"navigation"),U&&typeof f.resetEventCount=="function"&&f.resetEventCount(),H.apply(k,[Q,pe].concat(ne!==void 0?ne:[]))}},RS=function(f){try{return f.history.state}catch(k){}},Wd="request",XT=function(f,k){f===void 0&&(f=[]),k===void 0&&(k=window);var L=[],G={load:function(U){if(!U._isBreadcrumbTypeEnabled("request"))return;var H=[U._config.endpoints.notify,U._config.endpoints.sessions].concat(f);Q(),fe();function Q(){if(!(!("addEventListener"in k.XMLHttpRequest.prototype)||!("WeakMap"in k))){var Ve=new WeakMap,Le=new WeakMap,et=k.XMLHttpRequest.prototype.open;k.XMLHttpRequest.prototype.open=function(St,Cr){this&&Ve.set(this,{method:St,url:Cr}),et.apply(this,arguments)};var Wt=k.XMLHttpRequest.prototype.send;k.XMLHttpRequest.prototype.send=function(St){var Cr=this,yr=Ve.get(this);if(yr){var Do=Le.get(this);Do&&(this.removeEventListener("load",Do.load),this.removeEventListener("error",Do.error));var Pt=new Date,Ao=function(){return ne(yr.method,yr.url,wf(Pt))},hi=function(){return pe(yr.method,yr.url,Cr.status,wf(Pt))};this.addEventListener("load",hi),this.addEventListener("error",Ao),this&&Le.set(this,{load:hi,error:Ao})}Wt.apply(this,arguments)}}}function pe(Ve,Le,et,Wt){if(Le===void 0){U._logger.warn("The request URL is no longer present on this XMLHttpRequest. A breadcrumb cannot be left for this request.");return}if(!(typeof Le=="string"&&a(H,Le.replace(/\?.*$/,"")))){var $e={status:et,method:String(Ve),url:String(Le),duration:Wt};et>=400?U.leaveBreadcrumb("XMLHttpRequest failed",$e,Wd):U.leaveBreadcrumb("XMLHttpRequest succeeded",$e,Wd)}}function ne(Ve,Le,et){if(Le===void 0){U._logger.warn("The request URL is no longer present on this XMLHttpRequest. A breadcrumb cannot be left for this request.");return}typeof Le=="string"&&a(H,Le.replace(/\?.*$/,""))||U.leaveBreadcrumb("XMLHttpRequest error",{method:String(Ve),url:String(Le),duration:et},Wd)}function fe(){if(!(!("fetch"in k)||k.fetch.polyfill)){var Ve=k.fetch;k.fetch=function(){var et=arguments,Wt=arguments[0],$e=arguments[1],St,Cr=null;return Wt&&typeof Wt=="object"?(Cr=Wt.url,$e&&"method"in $e?St=$e.method:Wt&&"method"in Wt&&(St=Wt.method)):(Cr=Wt,$e&&"method"in $e&&(St=$e.method)),St===void 0&&(St="GET"),new Promise(function(yr,Do){var Pt=new Date;Ve.apply(void 0,et).then(function(Ao){xe(Ao,St,Cr,wf(Pt)),yr(Ao)}).catch(function(Ao){Re(St,Cr,wf(Pt)),Do(Ao)})})}}}var xe=function(Ve,Le,et,Wt){var $e={method:String(Le),status:Ve.status,url:String(et),duration:Wt};Ve.status>=400?U.leaveBreadcrumb("fetch() failed",$e,Wd):U.leaveBreadcrumb("fetch() succeeded",$e,Wd)},Re=function(Ve,Le,et){U.leaveBreadcrumb("fetch() error",{method:String(Ve),url:String(Le),duration:et},Wd)}}};return G},wf=function(f){return f&&new Date-f},Bs={load:function(f){var k=0;f.addOnError(function(L){if(k>=f._config.maxEvents)return f._logger.warn("Cancelling event send due to maxEvents per session limit of "+f._config.maxEvents+" being reached"),!1;k++}),f.resetEventCount=function(){k=0}},configSchema:{maxEvents:{defaultValue:function(){return 10},message:"should be a positive integer \u2264100",validate:function(f){return u(1,100)(f)}}}},FS={};FS={load:function(f){f.addOnError(function(k){var L=i(k.errors,function(G,U){return G.concat(U.stacktrace)},[]);E(L,function(G){G.file=Sf(G.file)})})}};var Sf=FS._strip=function(f){return typeof f=="string"?f.replace(/\?.*$/,"").replace(/#.*$/,""):f},ng=function(f,k){return f===void 0&&(f=window),k===void 0&&(k="window onerror"),{load:function(L){if(!L._config.autoDetectErrors||!L._config.enabledErrorTypes.unhandledExceptions)return;function G(H,Q,pe,ne,fe){if(pe===0&&/Script error\.?/.test(H))L._logger.warn("Ignoring cross-domain or eval script error. See docs: https://tinyurl.com/yy3rn63z");else{var xe={severity:"error",unhandled:!0,severityReason:{type:"unhandledException"}},Re;if(fe)Re=L.Event.create(fe,!0,xe,k,1),tx(Re.errors[0].stacktrace,Q,pe,ne);else if(typeof H=="object"&&H!==null&&(!Q||typeof Q!="string")&&!pe&&!ne&&!fe){var Ve=H.type?"Event: "+H.type:"Error",Le=H.message||H.detail||"";Re=L.Event.create({name:Ve,message:Le},!0,xe,k,1),Re.originalError=H,Re.addMetadata(k,{event:H,extraParameters:Q})}else Re=L.Event.create(H,!0,xe,k,1),tx(Re.errors[0].stacktrace,Q,pe,ne);L._notify(Re)}typeof U=="function"&&U.apply(this,arguments)}var U=f.onerror;f.onerror=G}}},tx=function(f,k,L,G){f[0]||f.push({});var U=f[0];!U.file&&typeof k=="string"&&(U.file=k),!U.lineNumber&&kf(L)&&(U.lineNumber=L),U.columnNumber||(kf(G)?U.columnNumber=G:window.event&&kf(window.event.errorCharacter)&&(U.columnNumber=window.event.errorCharacter))},kf=function(f){return typeof f=="number"&&String.call(f)!=="NaN"},NS,$T=function(f){f===void 0&&(f=window);var k={load:function(L){if(!(!L._config.autoDetectErrors||!L._config.enabledErrorTypes.unhandledRejections)){var G=function(U){var H=U.reason,Q=!1;try{U.detail&&U.detail.reason&&(H=U.detail.reason,Q=!0)}catch(fe){}var pe=!L._config.reportUnhandledPromiseRejectionsAsHandled,ne=L.Event.create(H,!1,{severity:"error",unhandled:pe,severityReason:{type:"unhandledPromiseRejection"}},"unhandledrejection handler",1,L._logger);Q&&E(ne.errors[0].stacktrace,dR(H)),L._notify(ne,function(fe){if(je(fe.originalError)&&!fe.originalError.stack){var xe;fe.addMetadata("unhandledRejection handler",(xe={},xe[Object.prototype.toString.call(fe.originalError)]={name:fe.originalError.name,message:fe.originalError.message,code:fe.originalError.code},xe))}})};"addEventListener"in f?f.addEventListener("unhandledrejection",G):f.onunhandledrejection=function(U,H){G({detail:{reason:U,promise:H}})},NS=G}}};return k},dR=function(f){return function(k){k.file!==f.toString()&&k.method&&(k.method=k.method.replace(/^\s+/,""))}},jd={},JT="Bugsnag JavaScript",M="8.2.0",w="https://github.com/bugsnag/bugsnag-js",m=T({},b.schema,C),y={_client:null,createClient:function(f){typeof f=="string"&&(f={apiKey:f}),f||(f={});var k=[Hd,YT(),wu(),lR(),Bs,BT,zT,FS,ng(),$T(),HT(),VS(),XT(),ig,ex()],L=new di(f,m,k,{name:JT,version:M,url:w});return L._setDelivery(window.XDomainRequest?Cl:ui),L._logger.debug("Loaded!"),L.leaveBreadcrumb("Bugsnag loaded",{},"state"),L._config.autoTrackSessions?L.startSession():L},start:function(f){return y._client?(y._client._logger.warn("Bugsnag.start() was called more than once. Ignoring."),y._client):(y._client=y.createClient(f),y._client)},isStarted:function(){return y._client!=null}};return E(["resetEventCount"].concat(p(di.prototype)),function(f){/^_/.test(f)||(y[f]=function(){if(!y._client)return console.log("Bugsnag."+f+"() was called before Bugsnag.start()");y._client._depth+=1;var k=y._client[f].apply(y._client,arguments);return y._client._depth-=1,k})}),jd=y,jd.Client=di,jd.Event=Fe,jd.Session=Yt,jd.Breadcrumb=F,jd.default=y,jd})});jo();Ut();var rr={};__dcg_shared_module_exports__['d'](rr,{ALT:()=>XR,BACKSPACE:()=>Ox,CAPSLOCK:()=>JR,CONTROL:()=>jR,DELETE:()=>kz,DOWN:()=>Mi,END:()=>Wc,ENTER:()=>Yu,ESCAPE:()=>Wi,HOME:()=>Bu,LEFT:()=>np,META:()=>$R,PAGEDOWN:()=>bg,PAGEUP:()=>fg,RIGHT:()=>ap,SHIFT:()=>l0,SPACEBAR:()=>ZR,TAB:()=>us,UP:()=>Tn,isBacktick:()=>Ole,isEnterOrSpace:()=>Rx,isHelp:()=>HR,isModKeyDown:()=>Rle,isModifierKey:()=>c0,isRedo:()=>Wf,isSelectAll:()=>Vle,isSwitchPanes:()=>WR,isUndo:()=>Hf,lookup:()=>Pe,lookupChar:()=>Jr});jo();var sz=r=>RR(r)||r==="localhost",Lx=r=>{let{search:e,hostname:t}=typeof location!="undefined"?location:typeof window!="undefined"?window.location:new Location;return sz(t)?new URLSearchParams(r!=null?r:e):new URLSearchParams},lz=r=>{let e=Lx(r),t=new Map;for(let[o,i]of e)t.set(o,i||"");return t},Hi=(r,e=Lx())=>e.get(r)||void 0;var cz=(r,e=Lx())=>{let t=e.get(r)||void 0;return t?parseInt(t,10):void 0},Uo=(r,e=Lx())=>e.has(r)&&e.get(r)!=="false";var dz=(r,e,t)=>{let o=new URLSearchParams(r);return o.set(e,t),`?${o.toString()}`};function Px(r,e=window.location.toString()){let t=r.toString();t=t.split("&").map(i=>i.replace(/=(true)?$/,"")).join("&");let o=new URL(e);o.search=t,sz(o.hostname)&&history.replaceState({},"",o.toString())}var GIe=navigator.userAgent.match(/MSIE 8.0/i)!==null,VIe=navigator.userAgent.match(/MSIE 9.0/i)!==null,uz=navigator.userAgent.match(/MSIE/i)!==null||navigator.userAgent.match(/Trident/i)!==null&&navigator.userAgent.match(/rv:11/i)!==null,OIe=navigator.userAgent.match(/Edge/i)!==null,ha=navigator.userAgent.match(/iPad/i)!==null,jn=navigator.userAgent.match(/Mobile|Android/i)!==null||Uo("forceMobile"),Nu=navigator.userAgent.match(/Android/i)!==null,Ws=navigator.userAgent.match(/(iPad|iPhone|iPod)/i)!==null||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,hz=navigator.userAgent.match(/Chrome/i)!==null,Gx=navigator.userAgent.match(/Firefox/i)!==null,UE=navigator.userAgent.match(/^((?!chrome|android).)*safari/i)!==null,qr=navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)!==null,gz=navigator.platform.match(/(Win32)/i)!==null,mz=navigator.userAgent.match(/Touch/i)!==null,RIe=navigator.userAgent.match(/Kindle/i)!==null||navigator.userAgent.match(/Silk/i)!==null,FIe=navigator.userAgent.match(/KeyWeb/i)!==null,Uu=window.parent!==window;var qR=Ws||Nu||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)||Uo("forceTouchDevice"),Hc=qR,Fu=(()=>{let r=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return r?[parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3]||"0",10)]:null})(),NIe=(()=>{let r=navigator.appVersion.match(/OS X (\d+)_(\d+)_?(\d+)?/);return r?[parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3]||"0",10)]:null})(),UIe=(()=>{let r=navigator.appVersion.match(/Chrom(e|ium)\/([0-9]+)\.([0-9]+)\.?([0-9]+)?/);return r?[parseInt(r[2],10),parseInt(r[3],10),parseInt(r[4]||"0",10)]:null})(),YE=!(!("inputMode"in document.createElement("textarea"))||Ws&&Fu&&Fu[0]<15),YIe=(()=>{let r=document.createElement("canvas");return!!(r.getContext&&r.getContext("2d"))})(),Vx=window.matchMedia("(prefers-reduced-motion: reduce)").matches||document.location.search.indexOf("prefersReducedMotion")>=0,fz=()=>document.createElement("video"),BIe=(()=>{let r=fz();return r.canPlayType&&!!r.canPlayType('video/webm; codecs="vp8, vorbis"')})(),KIe=(async()=>{if(Hi("autoplay")!==void 0)return Uo("autoplay");let r=fz();r.src="data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAAAu1tZGF0AAACrQYF//+p3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE1NSByMjkwMSA3ZDBmZjIyIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxOCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTMgbG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRlcmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJfcHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD00MCByYz1jcmYgbWJ0cmVlPTEgY3JmPTI4LjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IGlwX3JhdGlvPTEuNDAgYXE9MToxLjAwAIAAAAAwZYiEAD//8m+P5OXfBeLGOfKE3xkODvFZuBflHv/+VwJIta6cbpIo4ABLoKBaYTkTAAAC7m1vb3YAAABsbXZoZAAAAAAAAAAAAAAAAAAAA+gAAAPoAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIYdHJhawAAAFx0a2hkAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAPoAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAACgAAAAWgAAAAAAJGVkdHMAAAAcZWxzdAAAAAAAAAABAAAD6AAAAAAAAQAAAAABkG1kaWEAAAAgbWRoZAAAAAAAAAAAAAAAAAAAQAAAAEAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAATttaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAD7c3RibAAAAJdzdHNkAAAAAAAAAAEAAACHYXZjMQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAACgAFoASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAADFhdmNDAWQACv/hABhnZAAKrNlCjfkhAAADAAEAAAMAAg8SJZYBAAZo6+JLIsAAAAAYc3R0cwAAAAAAAAABAAAAAQAAQAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAC5QAAAAEAAAAUc3RjbwAAAAAAAAABAAAAMAAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTguMTIuMTAw",r.muted=!0,r.playsInline=!0,r.style.display="none";let e=await new Promise(t=>{document.readyState!=="loading"?t(document.body):document.addEventListener("DOMContentLoaded",()=>t(document.body))});e.appendChild(r);try{await r.play()}catch(t){return!1}finally{e.removeChild(r)}return!0})(),pz,BE=(pz=window.matchMedia("(forced-colors: active)"))==null?void 0:pz.matches;var Hf=r=>!r.altKey&&!r.shiftKey&&(r.ctrlKey||r.metaKey)&&(r.key=="z"||r.which==90),Wf=r=>!r.altKey&&(r.ctrlKey||r.metaKey)&&(r.key==="y"||r.which==89||r.shiftKey&&(r.key==="Z"||r.key==="z"||r.which===90)),Vle=r=>!r.altKey&&(r.ctrlKey||r.metaKey)&&(r.key==="a"||r.key==="A"||r.which==65),Ole=r=>!r.altKey&&!r.ctrlKey&&!r.metaKey&&!r.shiftKey&&(r.key==="`"||r.which==192),HR=r=>!r.altKey&&(r.ctrlKey||r.metaKey)&&(r.key==="/"||r.which==191),WR=r=>r.key==="F6"||r.key==="f6"||r.which===117||r.keyCode===117,Ox="Backspace",us="Tab",Yu="Enter",l0="Shift",jR="Control",XR="Alt",$R="Meta",JR="CapsLock",Wi="Esc",ZR="Space",fg="PageUp",bg="PageDown",Wc="End",Bu="Home",np="Left",Tn="Up",ap="Right",Mi="Down",kz="Del",bz={8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",46:"Del",91:"Meta",93:"Meta"},yz={Backspace:Ox,Tab:us,Enter:Yu,Shift:l0,Control:jR,Alt:XR,Meta:$R,CapsLock:JR,Escape:Wi," ":ZR,PageUp:fg,PageDown:bg,End:Wc,Home:Bu,ArrowLeft:np,ArrowUp:Tn,ArrowRight:ap,ArrowDown:Mi,Delete:kz};function Rle(r){return qr?r.metaKey:r.ctrlKey}var c0=r=>{let e=[l0,XR,jR,JR,$R];return!!r.key&&e.includes(r.key)},Rx=r=>Pe(r)===Yu||Pe(r)===ZR,xz={UIKeyInputUpArrow:Tn,UIKeyInputDownArrow:Mi,UIKeyInputLeftArrow:np,UIKeyInputRightArrow:ap,UIKeyInputEscape:Wi,UIKeyInputPageUp:fg,UIKeyInputPageDown:bg},QR=["0123456789abcdefghijklmnopqrstuvwxyz","\xBA\xA1\u2122\xA3\xA2\u221E\xA7\xB6\u2022\xAA\xE5\u222B\xE7\u2202 \u0192\xA9\u02D9 \u2206\u02DA\xAC\xB5 \xF8\u03C0\u0153\xAE\xDF\u2020 \u221A\u2211\u2248\xA5\u03A9","\u201A\u2044\u20AC\u2039\u203A\uFB01\uFB02\u2021\xB0\xB7\xC5\u0131\xC7\xCE\xB4\xCF\u02DD\xD3\u02C6\xD4\uF8FF\xD2\xC2\u02DC\xD8\u220F\u0152\u2030\xCD\u02C7\xA8\u25CA\u201E\u02DB\xC1\xB8"].map(r=>r.split("")),vz=QR[0],wz=QR[1],Sz=QR[2],_z={},Cz={};for(let r=0;r<vz.length;r++){let e=vz[r];wz[r]!==" "&&(_z[wz[r]]=e.toUpperCase()),Sz[r]!==" "&&(Cz[Sz[r]]=e.toUpperCase())}var Pe=r=>{if(r.key&&yz[r.key])return yz[r.key];if(r.which&&bz[r.which])return bz[r.which];if(r.key&&xz[r.key])return xz[r.key]},Jr=r=>{if(!r.key)return String.fromCharCode(r.which||-1);if(qr&&r.altKey){let e=r.shiftKey?Cz:_z;if(e[r.key])return e[r.key]}if(r.key.length===1)return r.key.toUpperCase();if(r.key==="Enter")return"\r";if(r.key==="Tab")return"	"};var yo=function(r){if(!r)return;let e=r.getBoundingClientRect();return{top:e.top+window.scrollY,left:e.left+window.scrollX}},Yo=function(r,e){Object.assign(r.style,e)};function Ku(r){return!!(r&&(r.offsetWidth||r.offsetHeight||r.getClientRects().length))}function KE(r){if(document.readyState!=="loading")r();else{let e=function(){document.removeEventListener("DOMContentLoaded",e),r()};document.addEventListener("DOMContentLoaded",e)}}function zE(){var r;try{let e=document.activeElement;return e&&e.value?e.selectionStart===e.selectionEnd:!((r=window.getSelection())!=null&&r.toString())}catch(e){return!1}}var Fle=document.location.href.indexOf("dcgDebugTouchTracking=dcgYES")!==-1,yg,Fx;window._touchtracking_id_counter==null&&(window._touchtracking_id_counter=0);window._touchtracking_id_counter+=1;var p0="touchtracking_id_"+window._touchtracking_id_counter,ni=function(r){Fx&&(Fx.value="("+Date.now()+") "+r+`
`+Fx.value)};function jf(r){if(r.classList.add("dcg-tap-container",p0),Ws&&r.style.setProperty("--dcg-minimum-input-font-size","16px"),Fle){yg&&yg.remove(),yg=document.createElement("div"),Yo(yg,{position:"absolute",bottom:"10px",right:"10px"});let e=document.createElement("textarea");e.setAttribute("rows","30"),e.setAttribute("cols","40"),yg.append(e);let t=document.createElement("div");t.id="dcg-touchtracking-debug-copy",t.classList.add("dcg-btn-blue"),t.innerText="COPY LOGS",yg.append(t),Fx=yg.querySelector("textarea"),r.append(yg),t.addEventListener("mousedown",()=>{Fx&&(Fx.select(),document.execCommand("copy"))},!0),ni("monitor touches")}}var Yx=0,hc=1,u0=2,Nx=3,qu=4,wr=Yx,eF={},jc={},zu=[],tF=0,d0=null,HE=null,xg=!1,qE=null,Tz=xg,vg=function(r){let e=document.activeElement;r.type.startsWith("key")?c0(r)||(xg=!0):r.type.startsWith("pointer")&&(xg=!1);let t=!!(e&&Hu(e));e&&!e.closest(".dcg-tap-container."+p0)&&(e=null),e!==qE?(qE&&qE.classList.remove("dcg-focus-visible"),e&&(xg||t)&&e.classList.add("dcg-focus-visible")):Tz!==xg&&e&&!t&&(xg?e.classList.add("dcg-focus-visible"):e.classList.remove("dcg-focus-visible")),Tz=xg,qE=e};document.addEventListener("keydown",vg,{capture:!0});document.addEventListener("keydown",vg);document.addEventListener("pointerdown",vg);document.addEventListener("pointerdown",vg,{capture:!0});document.addEventListener("focusin",vg,{capture:!0});document.addEventListener("focusin",vg);document.addEventListener("focusout",vg,{capture:!0});document.addEventListener("focusout",vg);var Ez,js=[],Az=function(r){let e=[],t=!1;for(let o=r.length-1;o>=0;o--){let i=r[o];i.classList.contains("dcg-touchtracking-prevent-dom-mutations")?t=!0:i.classList.contains("dcg-touchtracking-allow-dom-mutations")&&(t=!1),t||e.push(i)}return e.reverse(),e},rF=function(r){if(!(r instanceof Element))return[];let e=r.closest(".dcg-tap-container."+p0);if(!e)return[];let t=r,o=[];for(;t;){if(o.push(t),t===e)return o;t=t.parentNode}return[]},WE=function(r,e){HE=null,wr=r,ni("beginMode:"+wr),wr===hc?zu=rF(e.originalEvent.touches[0].target):zu=rF(e.target),Az(zu).forEach(o=>{o.classList.add("dcg-depressed")}),zu.forEach(o=>{let i=re(o);i.data({originalScrollTop:i.scrollTop(),originalScrollLeft:i.scrollLeft()})}),jc={}};function Hu(r){let e=["text","password","email","number","url","search"];return r.matches("input")&&e.indexOf(r.type)>=0||r.matches('textarea, [role="textbox"], [contenteditable=true]')||r.classList.contains("dcg-mathquill-input-span")}var Bx=function(r){if(!(r instanceof Element))return!1;let e=r.closest(".dcg-tap-container");return e?e.matches(".dcg-tap-container."+p0):!1},Nle=function(r){return wr!==Nx&&!Hu(r)&&Bx(r)},Kx=function(r,e){HE=null;let t=!1;ni("endMode:"+wr),document.querySelectorAll(".dcg-depressed").forEach(i=>{i.classList.remove("dcg-depressed")});let o=document.activeElement;if(!Vz(r.target)&&o&&Nle(o))try{o.blur()}catch(i){}if(zu.forEach(i=>{let n=re(i),a=n.data("originalScrollTop")-n.scrollTop(),s=n.data("originalScrollLeft")-n.scrollLeft();(a||s)&&(jc.scroll=!0)}),jc["dcg-tapstart"]===1&&jc["dcg-tapend"]===1&&!jc["dcg-tapcancel"]&&!jc.scroll){ni("potential dcg-tap");let i=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;if(r&&!r.device&&i===0&&n===0){ni("event appears to be simulated"),t=!0,wr=Nx;let c=r.target.getBoundingClientRect();i=(c.left+c.right)/2,n=(c.top+c.bottom)/2}ni("potential dcg-tap coords:"+i+":"+n);let a=!1,s=!1;for(let c of zu){if(a)break;let d;if(typeof c.getBoundingClientRect=="function"&&(d=c.getBoundingClientRect()),typeof c.getAttribute=="function"&&c.getAttribute("tapboundary")==="true"&&(a=!0),!(d&&(i<d.left||n<d.top||i>d.right||n>d.bottom))){HE=c,s=!0,hs("dcg-tap",r,{target:HE,touches:e.touches,changedTouches:e.changedTouches});break}}ni("result of dcg-tap:  did_dispatch="+s+"  did_escape="+a)}wr===hc||wr===qu?d0=setTimeout(()=>{d0=null,tF=new Date().getTime()},1e3):t&&(d0=setTimeout(()=>{d0=null,tF=new Date().getTime()},100)),zu=[],wr=Yx},Ux=function(){return d0||new Date().getTime()-tF<500},Lz=function(r){return r.identifier!==void 0?r.identifier:r.pointerId},Iz=function(r){let e=[];for(let t of r)e.push({identifier:Lz(t),x:t.pageX,y:t.pageY,screenX:t.screenX,screenY:t.screenY,pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY});return e},hs=function(r,e,t){let o=Lz(e),i=Iz(t.touches),n=Iz(t.changedTouches);if(ni("dispatchEvent:"+r),r==="dcg-tapstart")eF[o]={type:r,pageX:n[0].pageX,pageY:n[0].pageY};else if(r==="dcg-tapmove"){let d=n[0],p=eF[o];if(p&&d.pageX===p.pageX&&d.pageY===p.pageY||(wr===hc||wr===qu)&&p&&p.type==="dcg-tapstart"&&Math.abs(p.pageX-d.pageX)+Math.abs(p.pageY-d.pageY)<2)return;eF[o]={type:r,pageX:n[0].pageX,pageY:n[0].pageY}}let a=r.toLowerCase();jc[a]===void 0?jc[a]=1:jc[a]+=1;let s=re.event.fix(e.originalEvent);s.type=r,s.device=wr===hc||wr===qu?"touch":wr===Nx?"keyboard":"mouse",s.touches=i,s.changedTouches=n,s.target=t.target?t.target:e.target;let c=s.device!=="keyboard"&&jc["dcg-longhold"]>0;s.wasLongheld=function(){return c},s.preventTap=function(){jc["dcg-tapcancel"]=1},clearTimeout(Ez),s.type==="dcg-tapstart"&&s.device!=="keyboard"&&s.touches.length===1&&(Ez=setTimeout(()=>{hs("dcg-longhold",e,t)},500)),s.target&&s.target.nodeName&&s.target.nodeName.toLowerCase()==="a"&&s.type==="dcg-tap"&&s.device==="keyboard"&&s.target.click&&s.target.click(),ni("trigger event:"+s.type),re(s.target).trigger(s)},jE=function(r){let e=zu,t=!!zu.length,o=document.querySelectorAll(".dcg-tap-container."+p0+" .dcg-hovered"),i=Array.from(o).filter(Bx),n=[],a=[],s=[];if(r){let c=rF(r);Az(c).forEach(p=>{(!t||e.indexOf(p)!==-1)&&(i.indexOf(p)===-1&&s.push(p),n.push(p))})}for(let c of i)n.indexOf(c)===-1&&a.push(c);a.forEach(c=>{c&&c.classList.remove("dcg-hovered"),re(c).trigger("tipsyhide")}),s.forEach(c=>{c&&c.classList.add("dcg-hovered"),re(c).trigger("tipsyshow")})},XE=function(r){for(let e of js)if(e.pointerId===r)return!0;return!1},oF=function(r){for(let e=0;e<js.length;e++)js[e].pointerId===r&&js.splice(e,1)},Pz=function(r){wr===Yx&&WE(qu,r),iF(),jE(null),js.push(r.originalEvent),hs("dcg-tapstart",r,{touches:js,changedTouches:[r.originalEvent]})},Mz=function(r){oF(r.originalEvent.pointerId);let e={touches:js,changedTouches:[r.originalEvent]};hs("dcg-tapcancel",r,e),js.length===0&&Kx(r,e)},Dz=function(r){oF(r.originalEvent.pointerId);let e={touches:js,changedTouches:[r.originalEvent]};hs("dcg-tapend",r,e),js.length===0&&Kx(r,e)},$E=function(r){return r.originalEvent.pointerType==="touch"},zx=function(r,e){r.trim().split(/\s+/).forEach(t=>{let o=Ule?{passive:!1}:void 0;document.addEventListener(t,i=>{ni("document.on:"+i.type),e(re.event.fix(i))},o)})};zx("pointerdown MSPointerDown",r=>{if(!(wr===u0||wr===hc||!$E(r))){if(XE(r.originalEvent.pointerId)){ni("exit. pointer id already exists: "+r.originalEvent.pointerId);return}Pz(r)}});zx("pointermove MSPointerMove",r=>{wr===u0||wr===hc||!$E(r)||(XE(r.originalEvent.pointerId)||(ni("pointer id already exists: "+r.originalEvent.pointerId),Pz(r)),oF(r.originalEvent.pointerId),js.push(r.originalEvent),hs("dcg-tapmove",r,{touches:js,changedTouches:[r.originalEvent]}))});re(document).on("pointercancel MSPointerCancel",r=>{if(ni("document.on:"+r.type),wr!==qu||!$E(r)||!XE(r.originalEvent.pointerId))return;Mz(r);let e;for(;e=js.pop();){let t=re.Event(e,{originalEvent:e});Mz(t)}});re(document).on("pointerup MSPointerUp",r=>{if(ni("document.on:"+r.type),wr!==qu||!$E(r)||!XE(r.originalEvent.pointerId))return;Dz(r);let e;for(;e=js.pop();){let t=re.Event(e,{originalEvent:e});Dz(t)}});var Ule=function(){let r=!1;try{let e=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("test",()=>{},e),window.removeEventListener("test",()=>{},e)}catch(e){}return r}();zx("touchstart",r=>{wr===u0||wr===qu||(iF(),wr===Yx&&WE(hc,r),jE(null),hs("dcg-tapstart",r,{touches:r.originalEvent.touches,changedTouches:r.originalEvent.changedTouches}))});zx("touchmove",r=>{wr===hc&&hs("dcg-tapmove",r,{touches:r.originalEvent.touches,changedTouches:r.originalEvent.changedTouches})});zx("touchcancel",r=>{if(wr!==hc)return;let e={touches:r.originalEvent.touches,changedTouches:r.originalEvent.changedTouches};hs("dcg-tapcancel",r,e),r.originalEvent.touches.length===0&&Kx(r,e)});zx("touchend",r=>{if(wr!==hc)return;let e={touches:r.originalEvent.touches,changedTouches:r.originalEvent.changedTouches};hs("dcg-tapend",r,e),r.originalEvent.touches.length===0&&Kx(r,e)});function Gz(){return!!(wr===hc||wr===qu||Ux())}re(document).on("mousedown",r=>{if(ni("document.on:"+r.type),!(r.button===1||r.button===2)){if(Gz()){!r.target.matches("input, textarea, select")&&Bx(r.target)&&r.preventDefault(),ni("abort mousedown: "+wr+":"+Ux());return}WE(u0,r),hs("dcg-tapstart",r,{touches:[r],changedTouches:[r]})}});var Vz=function(r){return!(r instanceof Element)||!Bx(r)||r.closest(".dcg-do-blur")||r.closest(".dcg-text-selectable")?!1:!!r.closest(".dcg-do-not-blur")},iF=function(){try{let r=window.getSelection();if((r==null?void 0:r.rangeCount)===1){let e=r.getRangeAt(0).commonAncestorContainer;e.nodeType===Node.TEXT_NODE&&(e=e.parentNode),e&&e.closest(".dcg-text-selectable")&&r.removeAllRanges()}}catch(r){}};re(document).on("mousedown",r=>{ni("document.on:"+r.type),Vz(r.target)&&r.preventDefault(),iF()});re(document).on("mouseleave",r=>{if(ni("document.on:"+r.type),wr===Yx){if(Ux()){ni("abort mouseleave: "+wr+":"+Ux());return}jE(null)}});re(document).on("mousemove",r=>{if(ni("document.on:"+r.type),!(r.button===1||r.button===2)&&!(wr===hc||wr===qu)){if(Ux()){ni("abort mousemove: "+wr+":"+Ux());return}jE(r.target),hs("dcg-tapmove",r,{touches:[r],changedTouches:[r]})}});re(document).on("mouseup",r=>{if(ni("document.on:"+r.type),r.button===1||r.button===2||wr!==u0)return;let e={touches:[],changedTouches:[r]};hs("dcg-tapend",r,e),Kx(r,e)});re(document).on("keydown",r=>{if(ni("document.on:"+r.type),!(!Rx(r)||!Bx(r.target))&&wr!==Nx){if(r.target.matches('a:not([ontap]), button:not([ontap]), input, textarea, select, [role="textbox"], [contenteditable="true"], summary'))return;r.preventDefault(),WE(Nx,r),hs("dcg-tapstart",r,{touches:[r],changedTouches:[r]})}});re(document).on("keyup",r=>{if(ni("document.on:"+r.type),!Rx(r)||!Bx(r.target)||wr!==Nx)return;let e={touches:[],changedTouches:[r]};hs("dcg-tapend",r,e),Kx(r,e)});function nF(){return wr!==Yx}function Oz(){return xg}var Rz={monitor:jf,isTapActive:nF,elIsTypeable:Hu,shouldIgnoreMouseDown:Gz};var Fz=`[
  {
    "hash": "6d977245c9",
    "parent_hash": "78ce1cdc68",
    "title": "Function of x,y",
    "created": "2023-09-20T22:46:36.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/6d977245c9",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/6d977245c9.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-f-xy",
    "example": true
  },
  {
    "hash": "c10082024b",
    "parent_hash": "a73e7ccdd5",
    "title": "Function of r,\u03B8",
    "created": "2023-09-20T23:16:57.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/c10082024b",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/c10082024b.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-f-rtheta",
    "example": true
  },
  {
    "hash": "833a710c61",
    "parent_hash": "008929b749",
    "title": "Magic List of Points",
    "created": "2023-09-27T15:10:35.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/833a710c61",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/833a710c61.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-magic-list-of-points",
    "example": true
  },
  {
    "hash": "9acde5ba63",
    "parent_hash": "3662a19e7f",
    "title": "Ellipsoid",
    "created": "2023-09-27T23:51:32.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/9acde5ba63",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/9acde5ba63.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-ellipsoid",
    "example": true
  },
  {
    "hash": "4a160b1f3e",
    "parent_hash": "c27a55e763",
    "title": "Spheres",
    "created": "2023-09-27T23:50:44.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/4a160b1f3e",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/4a160b1f3e.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-spheres",
    "example": true
  },
  {
    "hash": "2965f1a6e9",
    "parent_hash": "4604348977",
    "title": "Parametric Curve",
    "created": "2023-09-27T15:04:02.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/2965f1a6e9",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/2965f1a6e9.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-parametric-curve",
    "example": true
  },
  {
    "hash": "05e48c1687",
    "parent_hash": "72f2ac8225",
    "title": "Parametric Surface",
    "created": "2023-09-20T22:52:08.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/05e48c1687",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/05e48c1687.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-parametric-surface",
    "example": true
  },
  {
    "hash": "9eb92bb6e2",
    "parent_hash": "5bc3b0caca",
    "title": "Implicit surface",
    "created": "2023-09-28T04:06:55.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/9eb92bb6e2",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/9eb92bb6e2.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-implicit",
    "example": true
  },
  {
    "hash": "c7642334f4",
    "parent_hash": "132e0b456c",
    "title": "Goursat's Tangle",
    "created": "2023-09-20T23:03:16.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/c7642334f4",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/c7642334f4.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-goursat",
    "example": true
  },
  {
    "hash": "2605f26636",
    "parent_hash": "fa87a1b65e",
    "title": "Octahedron",
    "created": "2023-09-20T23:04:46.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/2605f26636",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/2605f26636.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-octahedron",
    "example": true
  },
  {
    "hash": "14d147bd67",
    "parent_hash": "a300003cb0",
    "title": "Parametric curves",
    "created": "2023-09-20T22:49:50.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/14d147bd67",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/14d147bd67.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-parametric",
    "example": true
  },
  {
    "hash": "0b83611338",
    "parent_hash": "4bccb591d1",
    "title": "Osculating circle",
    "created": "2023-09-20T22:50:45.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/0b83611338",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/0b83611338.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-osculating-circle",
    "example": true
  },
  {
    "hash": "1a7f86ac77",
    "parent_hash": "bc36dae4d9",
    "title": "Surface of revolution",
    "created": "2023-09-20T22:55:31.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/1a7f86ac77",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/1a7f86ac77.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-surface-of-revolution",
    "example": true
  },
  {
    "hash": "5eefa398fa",
    "parent_hash": "53754c0852",
    "title": "Surface of revolution",
    "created": "2023-09-28T02:34:44.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/5eefa398fa",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/5eefa398fa.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-parametric-surface-of-revolution",
    "example": true
  },
  {
    "hash": "f0c82fea0b",
    "parent_hash": "fe7e9a5f82",
    "title": "Solid of Revolution - Inequalities",
    "created": "2023-09-27T15:23:02.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/f0c82fea0b",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/f0c82fea0b.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-solids-of-revolution",
    "example": true
  },
  {
    "hash": "bea84671c7",
    "parent_hash": "6b2acb1551",
    "title": "Conic Sections: Hyperbola",
    "created": "2023-09-28T17:55:36.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/bea84671c7",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/bea84671c7.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-conic-sections-hyperbola",
    "example": true
  },
  {
    "hash": "a92807f241",
    "parent_hash": "a779d83313",
    "title": "Contour Plot",
    "created": "2023-09-27T15:12:42.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/a92807f241",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/a92807f241.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-contour-plot",
    "example": true
  },
  {
    "hash": "f7561f1632",
    "parent_hash": "f696aa31ee",
    "title": "Vectors",
    "created": "2023-09-28T04:15:32.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/f7561f1632",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/f7561f1632.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-vectors",
    "example": true
  },
  {
    "hash": "1513142bf3",
    "parent_hash": "6ecaf6082c",
    "title": "Frenet Frame",
    "created": "2023-09-27T15:01:18.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/1513142bf3",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/1513142bf3.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-frenet-frame",
    "example": true
  },
  {
    "hash": "218980df26",
    "parent_hash": "d032e2f881",
    "title": "Double Helix",
    "created": "2023-09-28T17:57:29.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/218980df26",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/218980df26.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-3d-double-helix",
    "example": true
  },
  {
    "hash": "6aeedc5ff7",
    "parent_hash": "e2e82d3b5d",
    "title": "PRIDE flag",
    "created": "2023-09-20T23:12:18.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/6aeedc5ff7",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/6aeedc5ff7.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-pride-flag",
    "example": true,
    "easterEgg": "pride"
  },
  {
    "hash": "6bee4296a3",
    "parent_hash": "abfa8d9a0e",
    "title": "Utah Teapot",
    "created": "2023-09-20T23:14:05.000Z",
    "stateUrl": "https://www.desmos.com/calc-3d-states/production/6bee4296a3",
    "thumbUrl": "https://www.desmos.com/calc-3d-thumbs/production/6bee4296a3.png",
    "product": "graphing-3d",
    "i18nKey": "graphing-calculator-label-example-graph-teapot",
    "example": true,
    "easterEgg": "teapot"
  }
]
`;var Nz=`[
  {
    "hash": "2rnqgoa6a4",
    "parent_hash": "89ndqgh5id",
    "title": "Lines: Slope Intercept Form",
    "created": "2015-08-18T19:24:05.378Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/2rnqgoa6a4",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/2rnqgoa6a4.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-lines-slope-intercept-form",
    "example": true
  },
  {
    "hash": "onfy0dzx2o",
    "parent_hash": "kha6fgxhaf",
    "title": "Lines: Point Slope Form",
    "created": "2015-08-18T20:21:16.780Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/onfy0dzx2o",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/onfy0dzx2o.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-lines-point-slope-form",
    "example": true
  },
  {
    "hash": "md6buy4efz",
    "parent_hash": "fi71u8ej0q",
    "title": "Lines: Two Point Form",
    "created": "2015-08-18T20:21:39.575Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/md6buy4efz",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/md6buy4efz.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-lines-two-point-form",
    "example": true
  },
  {
    "hash": "zukjgk9iry",
    "parent_hash": "jv9fmw2qz8",
    "title": "Parabolas: Standard Form",
    "created": "2015-08-18T20:22:02.411Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/zukjgk9iry",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/zukjgk9iry.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-parabolas-standard-form",
    "example": true
  },
  {
    "hash": "8keeh1pt5l",
    "parent_hash": "klodq5d0ph",
    "title": "Parabolas: Vertex Form",
    "created": "2015-08-18T20:22:22.626Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/8keeh1pt5l",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/8keeh1pt5l.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-parabolas-vertex-form",
    "example": true
  },
  {
    "hash": "dxkknajdqb",
    "parent_hash": "t6auzqijzl",
    "title": "Parabolas: Standard Form + Tangent",
    "created": "2015-08-18T20:24:05.891Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/dxkknajdqb",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/dxkknajdqb.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-parabolas-standard-form-plus-tangent",
    "example": true
  },
  {
    "hash": "kihjluohq9",
    "parent_hash": "vpnnmvncdb",
    "title": "Trigonometry: Period and Amplitude",
    "created": "2015-08-18T20:24:32.570Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/kihjluohq9",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/kihjluohq9.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-trig-period-and-amplitude",
    "example": true
  },
  {
    "hash": "l3u8133jwj",
    "parent_hash": "51d9lso1ia",
    "title": "Trigonometry: Phase",
    "created": "2015-08-18T20:24:53.936Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/l3u8133jwj",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/l3u8133jwj.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-trig-phase",
    "example": true
  },
  {
    "hash": "7eeumgl7it",
    "parent_hash": "7rnv0erick",
    "title": "Trigonometry: Wave Interference",
    "created": "2019-12-03T18:14:54.000Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/7eeumgl7it",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/7eeumgl7it.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-trig-wave-interference",
    "example": true
  },
  {
    "hash": "qmzx2skkzy",
    "parent_hash": "s9myfmvujr",
    "title": "Trigonometry: Unit Circle",
    "created": "2015-08-18T20:26:18.276Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/qmzx2skkzy",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/qmzx2skkzy.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-trig-unit-circle",
    "example": true
  },
  {
    "hash": "ivud1auwvw",
    "parent_hash": "8dsmqe5ycc",
    "title": "Conic Sections: Circle",
    "created": "2015-08-18T20:27:04.445Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/ivud1auwvw",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/ivud1auwvw.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-conic-sections-circle",
    "example": true
  },
  {
    "hash": "djcrjdfiif",
    "parent_hash": "0jwlvn9hcs",
    "title": "Conic Sections: Parabola and Focus",
    "created": "2015-08-18T20:27:50.487Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/djcrjdfiif",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/djcrjdfiif.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-conic-sections-parabola-and-focus",
    "example": true
  },
  {
    "hash": "afja7ee9mh",
    "parent_hash": "duajwxdopa",
    "title": "Conic Sections: Ellipse with Foci",
    "created": "2015-08-18T20:28:08.499Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/afja7ee9mh",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/afja7ee9mh.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-conic-sections-ellipse-with-foci",
    "example": true
  },
  {
    "hash": "vgfqbejegx",
    "parent_hash": "k6xcbueze5",
    "title": "Conic Sections: Hyperbola",
    "created": "2015-08-18T20:28:27.874Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/vgfqbejegx",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/vgfqbejegx.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-conic-sections-hyperbola",
    "example": true
  },
  {
    "hash": "0ovfwwmfrb",
    "parent_hash": "scuci1750d",
    "title": "Polar: Rose",
    "created": "2015-08-18T20:28:48.832Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/0ovfwwmfrb",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/0ovfwwmfrb.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-polar-rose",
    "example": true
  },
  {
    "hash": "qlbdlxyrza",
    "parent_hash": "nicremwert",
    "title": "Polar: Logarithmic Spiral",
    "created": "2015-08-18T20:29:08.282Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/qlbdlxyrza",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/qlbdlxyrza.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-polar-logarithmic-spiral",
    "example": true
  },
  {
    "hash": "rayzacuktw",
    "parent_hash": "21pbohd07u",
    "title": "Polar: Limacon",
    "created": "2015-08-18T20:29:25.878Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/rayzacuktw",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/rayzacuktw.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-polar-limacon",
    "example": true
  },
  {
    "hash": "gxnu7fbgks",
    "parent_hash": "kk3axf8oon",
    "title": "Polar: Conic Sections",
    "created": "2015-08-18T20:29:42.487Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/gxnu7fbgks",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/gxnu7fbgks.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-polar-conic-sections",
    "example": true
  },
  {
    "hash": "rnyjcjpouf",
    "parent_hash": "ogvj2tzgjj",
    "title": "Parametric: Introduction",
    "created": "2015-08-18T20:30:31.353Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/rnyjcjpouf",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/rnyjcjpouf.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-parametric-introduction",
    "example": true
  },
  {
    "hash": "eg5he4xpg9",
    "parent_hash": "pwjl3pe4da",
    "title": "Parametric: Cycloid",
    "created": "2015-08-18T20:30:46.372Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/eg5he4xpg9",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/eg5he4xpg9.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-parametric-cycloid",
    "example": true
  },
  {
    "hash": "nyterjs0uf",
    "parent_hash": "nqxx2mhknn",
    "title": "Transformations: Translating a Function",
    "created": "2017-09-29T00:47:36.436Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/nyterjs0uf",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/nyterjs0uf.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-transformations-translating-a-function",
    "example": true
  },
  {
    "hash": "vdkjrpznnu",
    "parent_hash": "doxva7ciht",
    "title": "Transformations: Scaling a Function",
    "created": "2015-08-18T21:23:20.484Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/vdkjrpznnu",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/vdkjrpznnu.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-transformations-scaling-a-function",
    "example": true
  },
  {
    "hash": "fcjhdt1xdw",
    "parent_hash": "tif5liedlj",
    "title": "Transformations: Inverse of a Function",
    "created": "2015-08-18T21:23:36.776Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/fcjhdt1xdw",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/fcjhdt1xdw.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-transformations-inverse-of-a-function",
    "example": true
  },
  {
    "hash": "jwquvmikhr",
    "parent_hash": "2l0r87hkmq",
    "title": "Statistics: Linear Regression",
    "created": "2015-08-18T21:24:01.998Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/jwquvmikhr",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/jwquvmikhr.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-stats-linear-regression",
    "example": true
  },
  {
    "hash": "qrdbrcfnsl",
    "parent_hash": "paknt6oneh",
    "title": "Statistics: Anscombe's Quartet",
    "created": "2020-07-13T20:40:16.000Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/qrdbrcfnsl",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/qrdbrcfnsl.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-stats-anscombes-quartet",
    "example": true
  },
  {
    "hash": "sanlujpfmc",
    "parent_hash": "tyszvsmelo",
    "title": "Statistics: 4th Order Polynomial",
    "created": "2015-08-18T21:25:02.018Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/sanlujpfmc",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/sanlujpfmc.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-stats-fourth-order-polynomial",
    "example": true
  },
  {
    "hash": "iwfjdrhdyr",
    "parent_hash": "4n11jtzki0",
    "title": "Lists: Family of sin Curves",
    "created": "2015-08-18T21:25:30.069Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/iwfjdrhdyr",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/iwfjdrhdyr.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-lists-family-of-sin-curves",
    "example": true
  },
  {
    "hash": "ib4qkln029",
    "parent_hash": "1flkupc1yt",
    "title": "Lists: Curve Stitching",
    "created": "2016-05-05T06:33:59.891Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/ib4qkln029",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/ib4qkln029.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-lists-curve-stitching",
    "example": true
  },
  {
    "hash": "zdv2kras4n",
    "parent_hash": "fqhp5hq3ka",
    "title": "Lists: Plotting a List of Points",
    "created": "2015-08-18T21:27:01.962Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/zdv2kras4n",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/zdv2kras4n.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-lists-plotting-a-list-of-points",
    "example": true
  },
  {
    "hash": "qtzamwcdrk",
    "parent_hash": "aqgbwm3qfd",
    "title": "Calculus: Derivatives",
    "created": "2015-08-18T21:27:17.187Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/qtzamwcdrk",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/qtzamwcdrk.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-derivatives",
    "example": true
  },
  {
    "hash": "mekfho0w38",
    "parent_hash": "irip8pnpdf",
    "title": "Calculus: Secant Line",
    "created": "2015-08-18T21:27:32.274Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/mekfho0w38",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/mekfho0w38.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-secant-line",
    "example": true
  },
  {
    "hash": "fs3lx8gptb",
    "parent_hash": "dlzhsldcgo",
    "title": "Calculus: Tangent Line",
    "created": "2015-08-18T21:27:46.455Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/fs3lx8gptb",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/fs3lx8gptb.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-tangent-line",
    "example": true
  },
  {
    "hash": "noanuckuli",
    "parent_hash": "gkjridbqfj",
    "title": "Calculus: Taylor Expansion of sin(x)",
    "created": "2015-08-18T21:28:02.855Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/noanuckuli",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/noanuckuli.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-taylor-expansion-of-sin-x",
    "example": true
  },
  {
    "hash": "qigfpckugc",
    "title": "Calculus: Integrals",
    "created": "2016-04-19T14:03:33.013Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/qigfpckugc",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/qigfpckugc.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-integrals",
    "example": true
  },
  {
    "hash": "u2qz73ufju",
    "parent_hash": "o3pwn3vkgh",
    "title": "Calculus: Integral with adjustable bounds",
    "created": "2016-04-19T14:12:40.336Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/u2qz73ufju",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/u2qz73ufju.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-integral-with-adjustable-bounds",
    "example": true
  },
  {
    "hash": "gaa5aqyb5s",
    "title": "Calculus: Fundamental Theorem of Calculus",
    "created": "2016-04-19T14:15:45.211Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/gaa5aqyb5s",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/gaa5aqyb5s.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-fundamental-theorem-of-calculus",
    "example": true
  },
  {
    "hash": "8hxtdephtf",
    "parent_hash": "xova2bfhj5",
    "title": "hungry pac-man",
    "created": "2015-04-20T14:47:01.468Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/8hxtdephtf",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/8hxtdephtf.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-pac-man",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "qbaliml2om",
    "parent_hash": "8mmk4hrmqg",
    "title": "PRIDE flag",
    "created": "2021-06-02T01:46:57.000Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/qbaliml2om",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/qbaliml2om.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-pride-flag",
    "example": true,
    "easterEgg": "pride"
  },
  {
    "hash": "ieellz6qbr",
    "parent_hash": "velayq9vsr",
    "title": "PRIDE flag",
    "created": "2021-06-02T01:51:23.000Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/ieellz6qbr",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/ieellz6qbr.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-pride-flag",
    "example": true,
    "easterEgg": "pride"
  },
  {
    "hash": "dhzndt8brx",
    "parent_hash": "brei8peg52",
    "title": "3D World",
    "created": "2016-06-03T01:50:06.425Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/dhzndt8brx",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/dhzndt8brx.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-3d-world",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "zzhx3zzlns",
    "parent_hash": "ccmfndxptv",
    "title": "Checkerboard Inversion",
    "created": "2016-06-02T22:06:08.277Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/zzhx3zzlns",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/zzhx3zzlns.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-checkerboard-inversion",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "c1u72uowae",
    "title": "desmos graph of awesomeness",
    "created": "2013-08-18T06:25:20.605Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/c1u72uowae",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/c1u72uowae.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-regular-sine-wave",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "2mwse3jtff",
    "parent_hash": "msmdonti4c",
    "title": "Fastest path to point",
    "created": "2016-06-02T22:02:44.839Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/2mwse3jtff",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/2mwse3jtff.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-fastest-path-to-a-point",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "8ytrg3nyln",
    "parent_hash": "d7qrsg2hxg",
    "title": "Fireworks!",
    "created": "2016-06-03T01:50:52.464Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/8ytrg3nyln",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/8ytrg3nyln.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-fireworks",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "9ed6k6wexp",
    "parent_hash": "9ed6k6wexp",
    "title": "Sierpinski Valentine",
    "created": "2015-02-14T18:42:18.283Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/9ed6k6wexp",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/version/9ed6k6wexp/d0523c80-eb0c-11ef-82fc-91537002f86f.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-fractal-valentine",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "am6ab20tmw",
    "parent_hash": "hvycjwscfq",
    "title": "Outstretched Arm",
    "created": "2016-06-03T01:45:50.594Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/am6ab20tmw",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/am6ab20tmw.png",
    "access": "link",
    "product": "graphing",
    "i18nKey": "graphing-calculator-label-example-graph-outstretched-arm",
    "example": true,
    "easterEgg": "betchacant"
  }
]
`;var Uz=`[
  {
    "hash": "dxurmxrsl4",
    "parent_hash": "xfjg07t0fu",
    "title": "Equilateral Triangle",
    "created": "2024-09-26T01:01:15.702Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/dxurmxrsl4",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/dxurmxrsl4.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-equilateral-triangle",
    "example": true
  },
  {
    "hash": "i76sllwkzd",
    "parent_hash": "3a8r9da53c",
    "title": "Pythagorean Theorem",
    "created": "2024-09-17T14:29:54.698Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/i76sllwkzd",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/i76sllwkzd.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-pythagorean-theorem",
    "example": true
  },
  {
    "hash": "yymq25cpl3",
    "parent_hash": "2zihbxflnw",
    "title": "Triangles and Transversals",
    "created": "2024-07-16T18:11:55.053Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/yymq25cpl3",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/yymq25cpl3.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-triangles-and-transversals",
    "example": true
  },
  {
    "hash": "wef12odylw",
    "parent_hash": "icj1vah6ta",
    "title": "Sierpinski Triangle",
    "created": "2024-09-26T00:50:25.896Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/wef12odylw",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/wef12odylw.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-sierpinksi-triangle",
    "example": true
  },
  {
    "hash": "ulwew6of7a",
    "parent_hash": "njwmqhcagx",
    "title": "Vector Addition",
    "created": "2024-07-16T16:57:02.750Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/ulwew6of7a",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/ulwew6of7a.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-vector-addition",
    "example": true
  },
  {
    "hash": "wzktu0xkuk",
    "parent_hash": "i2qcnksqab",
    "title": "Rotating with a Slider",
    "created": "2024-09-30T22:11:09.260Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/wzktu0xkuk",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/wzktu0xkuk.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-rotation-with-a-slider",
    "example": true
  },
  {
    "hash": "zcx2m4nzzo",
    "parent_hash": "tj959czvpb",
    "title": "Regular Sided n-gon",
    "created": "2024-09-26T01:09:25.549Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/zcx2m4nzzo",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/zcx2m4nzzo.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-regular-sided-n-gon",
    "example": true
  },
  {
    "hash": "ewmxg5duu3",
    "parent_hash": "tpbst3h2yc",
    "title": "Pentagon Spiral",
    "created": "2024-09-26T00:52:02.679Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/ewmxg5duu3",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/ewmxg5duu3.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-pentagon-spiral",
    "example": true
  },
  {
    "hash": "gp3g8twd32",
    "parent_hash": "ipz9r8bhie",
    "title": "Angles of a Quadrilateral",
    "created": "2024-09-26T01:02:18.414Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/gp3g8twd32",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/gp3g8twd32.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-angles-of-a-quadrilateral",
    "example": true
  },
  {
    "hash": "cbquydiypr",
    "parent_hash": "dpyvbzed13",
    "title": "Tangent to a Circle",
    "created": "2024-09-26T01:10:06.587Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/cbquydiypr",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/cbquydiypr.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-tangent-to-a-circle",
    "example": true
  },
  {
    "hash": "ecwiwnjqqi",
    "parent_hash": "4pkq5rayb9",
    "title": "Inscribed Quadrilateral",
    "created": "2024-09-17T14:30:18.448Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/ecwiwnjqqi",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/ecwiwnjqqi.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-inscribed-quadrilateral",
    "example": true
  },
  {
    "hash": "nkwxgwhxrl",
    "parent_hash": "kjp62nfcis",
    "title": "Angle Bisector",
    "created": "2024-09-17T14:31:29.931Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/nkwxgwhxrl",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/nkwxgwhxrl.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-angle-bisector",
    "example": true
  },
  {
    "hash": "tjtt82sxwi",
    "parent_hash": "v9swpeuxzm",
    "title": "Perimeter and Area",
    "created": "2024-09-30T22:16:06.725Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/tjtt82sxwi",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/tjtt82sxwi.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-perimeter-and-area",
    "example": true
  },
  {
    "hash": "t9ognxlses",
    "parent_hash": "ueuubwvxa7",
    "title": "Inscribed Right Triangle",
    "created": "2023-05-12T01:31:40.000Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/t9ognxlses",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/t9ognxlses.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-inscribed-triangle",
    "example": true
  },
  {
    "hash": "oi5hhmdzvz",
    "parent_hash": "mlu6i5utvq",
    "title": "Rainbow Pinwheel",
    "created": "2024-09-26T01:06:05.725Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/oi5hhmdzvz",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/oi5hhmdzvz.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-rainbow-pinwheel",
    "example": true
  },
  {
    "hash": "tgtho4s7tz",
    "parent_hash": "xgzjfcnzpl",
    "title": "Perpendicular Bisector",
    "created": "2024-09-26T00:57:13.960Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/tgtho4s7tz",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/tgtho4s7tz.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-perpendicular-bisector",
    "example": true
  },
  {
    "hash": "r9sa7rbd5q",
    "parent_hash": "xomv1xh15b",
    "title": "String Art",
    "created": "2024-09-26T00:59:01.256Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/r9sa7rbd5q",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/r9sa7rbd5q.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-string-art",
    "example": true
  },
  {
    "hash": "nzp5jnt9pe",
    "parent_hash": "hjavae62i7",
    "title": "The Euler Line",
    "created": "2024-09-26T01:00:16.622Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/nzp5jnt9pe",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/nzp5jnt9pe.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-euler-line",
    "example": true
  },
  {
    "hash": "akkwop6h4u",
    "parent_hash": "z7iuegt8w1",
    "title": "Two Reflections",
    "created": "2023-05-12T01:15:57.000Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/akkwop6h4u",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/akkwop6h4u.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-two-reflections",
    "example": true
  },
  {
    "hash": "40alvsykqe",
    "parent_hash": "j9uvqpektb",
    "title": "30-60-90 Animation",
    "created": "2024-09-30T22:14:47.381Z",
    "stateUrl": "https://www.desmos.com/calc-states/production/40alvsykqe",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/40alvsykqe.png",
    "access": "link",
    "product": "geometry-calculator",
    "i18nKey": "geometry-label-example-construction-30-60-90-animation",
    "example": true
  }
]
`;jo();En();var zle=1;function Sr(r){JE&&qle(r)}var JE=!1;function qz(){JE=!0}function qle(r){var t,o;if(!JE)return;let e=["trackEvent",r.category,r.action,r.name,r.value];Uo("testing")?(t=window.paqTest)==null||t.push(e):(o=window._paq)==null||o.push(e)}var zz;function qx(){if(!JE)return;let r=document.location.href,e=document.referrer,t=window._paq=window._paq||[];zz!==r&&(zz=r,Uo("testing")||(t==null||t.push(["setReferrerUrl",e]),t==null||t.push(["setDocumentTitle",window.document.title]),t==null||t.push(["setCustomDimension",zle,window.location!==window.parent.location]),t==null||t.push(["trackPageView"])))}function Hz(r=window.location.pathname){let e=r.split("/");return e.length>1?`/${e[1]}`:"/"}var Ra={},gc=lz(),Hle={sciKeypad:1,"4fnKeypad":1,singleExpression:1,restrictedEditing:1,degreeMode:1,decimalToFraction:1};typeof Desmos!="undefined"&&Desmos.config&&Object.keys(Hle).forEach(r=>{Desmos.config[r]&&gc.set(r,"true"),Ra[r]=Desmos.config[r]});var Hx=function(r){return Uo(r,gc)},lr=function(r){Ra[r]=Hx(r)},Qr=function(r){Ra[r]=!Hx(`no${r}`)};lr("testing");lr("maintenance");lr("disableScrollFix");lr("nativeOnscreenKeypad");lr("hidden");lr("disableMouseInteractions");lr("advancedStyling");lr("outofdom");lr("beta3d");gc.has("cacheRenderedSvgs")&&(Ra.cacheRenderedSvgs=!0);var Wle=["lang","fontSize","translucentOpacity","peelUpsample","debugScale","debugPeelLayers","debug3dRender","debugPixelRatio","recursionDepthLimit"];Wle.forEach(r=>{gc.has(r)&&(Ra[r]=gc.get(r))});gc.has("backgroundColor")&&(Ra.backgroundColor="#"+gc.get("backgroundColor"));gc.has("textColor")&&(Ra.textColor="#"+gc.get("textColor"));lr("lockViewport");lr("authorFeatures");lr("degreeMode");lr("clearIntoDegreeMode");lr("plaidMode");lr("wireframe");lr("editOnWeb");lr("crossOriginSaveTest");lr("showResetButtonOnGraphpaper");lr("debugProgressUpdates");lr("folderModules");lr("transparentBackground");lr("forceLogModeRegressions");lr("defaultLogModeRegressions");lr("reflectionArc");lr("logInternalErrors");Qr("links");Qr("trace");Qr("zoomFit");lr("expressionsCollapsed");lr("invertedColors");lr("projectorMode");Qr("images");Qr("folders");Qr("settingsMenu");Qr("expressionsTopbar");Qr("zoomButtons");Qr("keypad");Qr("graphpaper");Qr("expressions");Qr("branding");Qr("pointsOfInterest");Qr("plotSingleVariableImplicitEquations");Qr("plotImplicits");Qr("plotInequalities");Qr("notes");Qr("sliders");lr("pauseWhenOffscreen");Qr("brailleControls");lr("audioTraceKeypad");lr("audioTraceSimult");Qr("audio");Qr("qwertyKeyboard");lr("restrictedFunctions");lr("forceEnableGeometryFunctions");Qr("functionDefinition");lr("singleExpression");lr("restrictedEditing");lr("replaceCommaWith10Exp");lr("replaceRoundWithReciprocal");Hx("typingAsteriskWritesTimesSymbol")&&(Ra.typingAsteriskWritesTimesSymbol=!0);Qr("substitutions");Qr("intervalComprehensions");Qr("recursion");Qr("logScales");Qr("tableRegressions");Qr("distributions");Ra["4fnKeypad"]?lr("decimalToFraction"):Qr("decimalToFraction");lr("translucentSurfaces");lr("3d");lr("disableWorkerOnZoom");lr("disableLighting");lr("showPerformanceMeter");lr("peelFloatTexture");Qr("adaptivePeeling");lr("complex");Qr("allowComplex");Qr("customRegressions");var Wz;gc.has("additionalFunctions")&&(Ra.additionalFunctions=(Wz=gc.get("additionalFunctions"))==null?void 0:Wz.split(","));gc.has("disableParentheses")&&(Ra.disableParentheses=!0);Hx("actions")?Ra.actions=!0:Hx("noactions")?Ra.actions=!1:Hx("clickableObjects")&&(Ra.actions=!0);function Xc(r){return Ra[r]}function jz(){return __dcg_shared_module_exports__['f'](Ra)}var S3={};__dcg_shared_module_exports__['d'](S3,{expressionCount:()=>bpe,expressionErrors:()=>Spe,folderCount:()=>ype,hasAction:()=>gpe,hasCustomColors:()=>fpe,hasMovablePoints:()=>mpe,hasRegression:()=>hpe,hasSlider:()=>upe,imageCount:()=>xpe,tableCount:()=>vpe,textCount:()=>wpe});En();function Wx(r){let e=__dcg_shared_module_exports__['xe'](r);if(e.type!=="Assignment")return NaN;if(e._expression.type!=="Constant")return NaN;if(!new __dcg_shared_module_exports__['Id']({enableGeometry:!1,enable3d:!1,scales:void 0,includeFunctionParametersInRandomSeed:!0,isComplexEnabled:!1,customRegressions:!0,isNewStatsEnabled:!1}).validLHS(e._symbol))return NaN;if(__dcg_shared_module_exports__['xc'][e._symbol])return NaN;let o=e._expression.asValue();return typeof o=="number"?o:NaN}function jle(r){return __dcg_shared_module_exports__['w'](r)!==null}var jx=jle;function Xle(r){switch(r.type){case"TokenNode":case"Letter":return!0;case"OperatorName":{for(let e of r.arg.args)if(e.type!=="Letter")return!1;return!0}case"Cmd":return __dcg_shared_module_exports__['oe'](r.val);default:return!1}}function aF(r){let e;try{e=__dcg_shared_module_exports__['we'](r)}catch(i){return}if(e.args.length===0||e.args.length>2)return;let t=e.args[0];if(!Xle(t))return;let o;if(e.args.length>1){let i=e.args[1];if(i.type!=="SupSub")return;let{sup:n,sub:a}=i;if(n!==void 0||a===void 0)return;for(let s of a.args)if(s.type!=="Letter"&&s.type!=="Digit")return;o=a}return{base:t,subscript:o}}function Fa(r){return aF(r)!==void 0}function Zz(r){let e=__dcg_shared_module_exports__['we'](r),t=__dcg_shared_module_exports__['se'](e);switch(t.type){case"Letter":return t.val;case"Cmd":return t.val;default:return}}function Xz(r){return r.replace(/^(\\? )+|(\\? )+$/g,"")}function m0(r){let e=r.indexOf("=");if(e===-1)return;let t=Xz(r.slice(0,e));if(Fa(t))return t;try{let o=__dcg_shared_module_exports__['we'](`${t}=0`),i=__dcg_shared_module_exports__['se'](o);if(i.type==="Comparator"&&i.symbol==="="&&__dcg_shared_module_exports__['re'](i.args[0])){let n=r.indexOf("\\left(");if(n===-1&&(n=r.indexOf("(")),n===-1)return;let a=Xz(r.slice(0,n));if(Fa(a))return a}}catch(o){}}function $x(r,e){let t=aF(e);if(t===void 0)return[];let o=[],i;try{i=__dcg_shared_module_exports__['we'](r)}catch(n){return o}return Xx(i,t,o,{wrapInBraces:!1}),o}function mc(r,e){return $x(r,e).length!==0}function ZE(r,e,t){return aF(t)===void 0?r:sF(r,e,t)}function sF(r,e,t){let o=$x(r,e);if(o.length===0)return r;let i="",n=0;for(let a of o){if(i+=r.slice(n,a.base.start),/[a-z]$/i.test(i)&&e[0]=="\\"&&t[0]!=="\\"&&(i+=" "),a.wrapInBraces&&(i+="{"),i+=t,n=a.base.end,a.subscript){let s=0,c=0;for(let d=a.subscript.start;d>=0;d--)if(r[d]==="{"&&(s+=1),r[d]==="_"){c=d;break}i+=r.slice(n,c),n=a.subscript.end;for(let d=a.subscript.end;d<r.length&&!(s<=0);d++)r[d]==="}"&&(s-=1,n=d+1)}a.wrapInBraces&&(i+="}")}return i+=r.slice(n,r.length),i}function $z(r,e){if(r.args.length!==e.args.length)return!1;for(let t=0;t<r.args.length;t++){let o=r.args[t],i=e.args[t];if(!(o.type==="Letter"&&i.type==="Letter"&&o.val===i.val)&&!(o.type==="Digit"&&i.type==="Digit"&&o.val===i.val))return!1}return!0}function $le(r,e,t){let o=r.arg.args,i=e.arg.args;if(o.length===i.length){for(let n=0;n<o.length;n++){let a=o[n],s=i[n];if(a.type!=="Digit"||a.type!==s.type||a.val!==s.val)return}t.push({base:e.span,wrapInBraces:!1})}}function Xx(r,e,t,{wrapInBraces:o}){let{base:i,subscript:n}=e;for(let a=0;a<r.args.length;a++){let s=a-1>=0?r.args[a-1]:void 0,c=r.args[a],d;if(a+1<r.args.length){let p=r.args[a+1];p.type==="SupSub"&&p.sub!==void 0&&(d=p.sub)}switch(c.type){case"Letter":case"Cmd":if(i.type!==c.type||i.val!==c.val)break;if(n&&d&&$z(n,d))t.push({base:c.span,subscript:d.span,wrapInBraces:o});else if(!n&&!d){if((s==null?void 0:s.type)==="Symbol"&&s.val==="."&&c.type==="Letter"&&(i.val==="x"||i.val==="y"||i.val==="z"))break;t.push({base:c.span,wrapInBraces:o})}break;case"OperatorName":{if(i.type!==c.type||i.arg.args.length!==c.arg.args.length)break;let p=!0;for(let u=0;u<i.arg.args.length;u++){let g=i.arg.args[u],h=c.arg.args[u];if(g.type!=="Letter"||h.type!=="Letter"||g.val!==h.val){p=!1;break}}if(!p)break;n&&d&&$z(n,d)?t.push({base:c.span,subscript:d.span,wrapInBraces:o}):!n&&!d&&t.push({base:c.span,wrapInBraces:o});break}case"Digit":case"Symbol":case"EscapedSymbol":break;case"LeftRight":case"Sqrt":Xx(c.arg,e,t,{wrapInBraces:!1});break;case"Frac":Xx(c.num,e,t,{wrapInBraces:!1}),Xx(c.den,e,t,{wrapInBraces:!1});break;case"SupSub":(s==null?void 0:s.type)==="Cmd"&&__dcg_shared_module_exports__['qe'](s.val)&&c.sub&&Xx(c.sub,e,t,{wrapInBraces:!Jz(c.sub,"_")}),c.sup&&Xx(c.sup,e,t,{wrapInBraces:!Jz(c.sup,"^")});break;case"TokenNode":{if(i.type!==c.type)break;$le(i,c,t)}break;default:{let p=c;throw new Error("Unexpected token type: "+p.type)}}}}function Jz(r,e){for(let t=r.span.start;t>=0;t--){let o=r.span.input[t];if(o===e)break;if(o==="{")return!0}return!1}var cF=1e6;function QE(r){let e=$f(r);if(!e)return!1;switch(e){case"anonymous-function":case"function-reference":case"point-list-reference":case"recursive-function":return!0;case"point-list":return!1}}function $f(r){if(!r||r.type!=="expression")return;let e=r.formula,t=r.formula.recursion,o=r.formula.function_definition,i=rq(r,o);if(t&&t.type==="iterative"&&t.signature.argTypes.length===1&&t.returnType===__dcg_shared_module_exports__['B']&&r.formula.function_definition&&i!==void 0&&isFinite(i)&&Math.abs(i)<cF)return"recursive-function";if(e.is_tableable&&e.table_info)return $c(r)?e.table_info.by_reference?"point-list-reference":"point-list":e.table_info.by_reference?"function-reference":"anonymous-function"}function Qz(r){let e=r.formula.table_info;if(!e)return;let t=[],o=[];if(e.values)for(let i=0;i<e.values.length;i++){let n=e.values[i][0];t.push(isNaN(n)?"":__dcg_shared_module_exports__['kb'](n));let a=e.values[i][1];o.push(isNaN(a)?"":__dcg_shared_module_exports__['kb'](a))}return{headers:[e.independent_variable,e.dependent_column],values:[t,o]}}function eq(r){let e=r.formula.table_info;if(e)return{headers:[e.dependent_column+".x",e.dependent_column+".y"],values:[[],[]]}}var lF=["-2","-1","0","1","2"];function tq(r){let e=r.formula.table_info;if(e)return e.dependent_column===e.independent_variable?{headers:["x","1x"],values:[lF,[]]}:{headers:[e.independent_variable,e.dependent_column],values:[lF,[]]}}function rq(r,e){var t,o,i;if(e)return(i=(o=(t=r.formula.recursion)==null?void 0:t.recursiveStructure)==null?void 0:o.baseCaseInfo[e])==null?void 0:i.min}function oq(r){let e=r.formula.function_definition,t=r.formula.recursion;if(!e||!t)return;let o=rq(r,e);if(o===void 0)return;let i=[];for(let n=o;n<=o+4;n++)i.push(`${n}`);return{headers:["x",`${__dcg_shared_module_exports__['vb'](e)}\\left(x\\right)`],values:[i,[]]}}function iq(r){let e=r.formula.function_definition;return e?{headers:["x",`${__dcg_shared_module_exports__['vb'](e)}\\left(x\\right)`],values:[lF,[]]}:void 0}var wg=r=>{if((r==null?void 0:r.type)!=="expression")return;let e=r==null?void 0:r.formula.typed_constant_value;if(!e)return;let t=aq(r);if(t)return t;if(__dcg_shared_module_exports__['ya'](e.valueType))return __dcg_shared_module_exports__['ua'](e.valueType,[__dcg_shared_module_exports__['da'],__dcg_shared_module_exports__['ea'],__dcg_shared_module_exports__['ia']])?"t":"z"},eI=r=>{var e;if(!((r==null?void 0:r.type)!=="expression"||!__dcg_shared_module_exports__['ya']((e=r.formula.typed_constant_value)==null?void 0:e.valueType)))return __dcg_shared_module_exports__['ua'](r.formula.typed_constant_value.valueType,[__dcg_shared_module_exports__['ga'],__dcg_shared_module_exports__['da'],__dcg_shared_module_exports__['fa'],__dcg_shared_module_exports__['ia']])?1:2};var tI=r=>{var t;if((r==null?void 0:r.type)!=="expression"||!__dcg_shared_module_exports__['ya']((t=r.formula.typed_constant_value)==null?void 0:t.valueType))return;let{valueType:e}=r.formula.typed_constant_value;return __dcg_shared_module_exports__['zb'](__dcg_shared_module_exports__['Lb'](e))},nq=r=>{var t;let{inferenceType:e}=r;switch(e){case"t":return`\\operatorname{tdist}\\left(${(t=r.dof)!=null?t:2}\\right)`;case"z":case"zprop":return"\\operatorname{normaldist}\\left(0,1\\right)";default:throw new Error(`Unexpected inference type ${e}`)}},dF=r=>r<0?0:r>10?r%10+dF(Math.floor(r/10))/10:r;var rI=class{constructor(e,t){this.cb=e;this.document=t;this.observedAriaLiveElements=new WeakMap;this.destroyed=!1;this.onAriaLabelFocus=e=>{let t=e.target;if(this.isElement(t)){let o=t.getAttribute("aria-label");o&&this.cb(o,"label")}};this.document.documentElement.addEventListener("focus",this.onAriaLabelFocus,!0),this.ariaLiveContentObserver=new MutationObserver(o=>this.handleAriaLiveContentMutations(o)),t.documentElement.querySelectorAll('[aria-live="assertive"]').forEach(o=>this.startObservingAriaLiveElement(o)),this.treeObserver=new MutationObserver(o=>this.handleDocumentTreeMutations(o)),this.treeObserver.observe(t.documentElement,{childList:!0,subtree:!0,attributeFilter:["aria-live"]})}destroy(){this.destroyed=!0,this.document.documentElement.removeEventListener("focus",this.onAriaLabelFocus,!0),this.ariaLiveContentObserver.disconnect()}isObservingElement(e){return!!this.observedAriaLiveElements.get(e)}handleAriaLiveContentMutations(e){var o;let t=new Map;for(let i of e){if(!this.observedAriaLiveElements.get(i.target))continue;let n=t.get(i.target);n||(n=[],t.set(i.target,n)),n.push(i)}for(let[i,n]of t){let a=i.cloneNode(!0),s=[a.textContent||""];for(let c=n.length-1;c>=0;c--){let d=n[c];switch(d.type){case"attributes":{d.attributeName!==null&&a.setAttribute(d.attributeName,d.oldValue||""),s.push(a.textContent||"");break}case"characterData":{d.oldValue!==null&&(a.textContent=d.oldValue),a.textContent&&a.textContent!==s[s.length-1]&&s.push(a.textContent);break}case"childList":{if(d.addedNodes.length>1||d.removedNodes.length>1)throw new Error(`Expected at most one removed node and one added node, but got ${d.removedNodes.length} removed nodes and ${d.addedNodes.length} added nodes`);d.addedNodes.length===1&&((o=a.firstChild)==null||o.remove()),d.removedNodes.length===1&&d.removedNodes.forEach(p=>a.appendChild(p.cloneNode(!0))),a.textContent&&a.textContent!==s[s.length-1]&&s.push(a.textContent);break}}}for(let c of s.reverse())this.cb(c,"alert")}}startObservingAriaLiveElement(e){this.destroyed||e.getAttribute("aria-live")==="assertive"&&(this.observedAriaLiveElements.get(e)||(this.observedAriaLiveElements.set(e,!0),e.textContent&&this.cb(e.textContent,"alert"),this.ariaLiveContentObserver.observe(e,{attributes:!0,characterData:!0,childList:!0,attributeOldValue:!0,characterDataOldValue:!0})))}stopObservingAriaLiveElement(e){this.observedAriaLiveElements.set(e,!1)}handleDocumentTreeMutations(e){for(let t of e)t.addedNodes.forEach(o=>{this.isElement(o)&&o.getAttribute("aria-live")==="assertive"&&this.startObservingAriaLiveElement(o)}),this.isElement(t.target)&&t.attributeName==="aria-live"&&(t.target.getAttribute("aria-live")==="assertive"?this.startObservingAriaLiveElement(t.target):this.stopObservingAriaLiveElement(t.target)),t.removedNodes.forEach(o=>{this.isElement(o)&&(this.stopObservingAriaLiveElement(o),o.querySelectorAll('[aria-live="assertive"]').forEach(i=>this.stopObservingAriaLiveElement(i)))})}isElement(e){var o;let t=(o=this.document.defaultView)==null?void 0:o.Element;return t?e instanceof t:!1}};var sp,oI=[],sq="",Jle;function bi(){sp&&(sp.textContent="")}function It(r){oI.push(r)}function _e(r){if(r!==void 0&&It(r),sp&&oI.length>0){let e=oI.join(" ").replace(/ +(?= )/g,"");sp.setAttribute("aria-relevant",sq===e&&qr?"all":"additions text"),sp.textContent=e,sq=e}oI.length=0}function Zle(){sp=document.createElement("p"),sp.setAttribute("aria-live","assertive"),sp.setAttribute("aria-atomic","true"),sp.classList.add("dcg-aria-alert"),document.body.appendChild(sp),Uo("logAria")&&(Jle=new rI((r,e)=>__dcg_shared_module_exports__['Be'].log(`[aria ${e}] ${r}`),document))}KE(Zle);function Qle(r){return r.replace(new RegExp("(?<!\\\\left|\\\\sqrt)(\\[|\\(|\\\\\\{)","g"),"\\left$1").replace(new RegExp("(?<!\\\\right)(\\]|\\)|\\\\\\})(?!{)","g"),"\\right$1")}function ece(r){return r.replace(/\\ |\\space(?![a-zA-Z])/g," ")}function iI(r){if(!r||r.args.length===0)return;let e=r.args[r.args.length-1];switch(e.isTrailing=!0,e.type){case"Sqrt":case"LeftRight":iI(e.arg);break;case"Frac":iI(e.num),iI(e.den);break;case"TokenNode":case"SupSub":case"Other":break;default:}}function pF(r){return{type:"Other",originalType:r.type,val:r.val}}function tce(r){switch(r.type){case"Cmd":{if(!__dcg_shared_module_exports__['oe'](r.val))return pF(r);let e=r.val.match(/^\\([a-zA-Z]+)/);if(!e)return pF(r);let t=e[1],o=[];for(let i of t)o.push({type:"Other",originalType:"Letter",val:i});return o}case"OperatorName":return lp(r.arg).args;case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":return pF(r);case"Sqrt":return{type:"Sqrt",optArg:r.optArg&&lp(r.optArg),arg:lp(r.arg)};case"Frac":return{type:"Frac",num:lp(r.num),den:lp(r.den)};case"TokenNode":return{type:"TokenNode",arg:lp(r.arg)};case"SupSub":return{type:"SupSub",sup:r.sup&&lp(r.sup),sub:r.sub&&lp(r.sub),nprimes:r.nprimes};case"LeftRight":return{type:"LeftRight",left:r.left,right:r.right,arg:lp(r.arg)};default:throw new Error(`Programming Error: Invalid atom type ${r.type}`)}}function lp(r){let e=[];for(let t of r.args){let o=tce(t);Array.isArray(o)?e.push(...o):e.push(o)}return{type:"Group",args:e}}function lq(r){try{let e=Qle(ece(r)),t=__dcg_shared_module_exports__['we'](e);return lp(t)}catch(e){return}}function dq(r){let e=lq(r);if(e===void 0)return()=>!1;let t=e;iI(t);function o(i){let n=lq(i);return n===void 0?!1:kg(t,n)}return o}function kg(r,e){if(!e)return!1;for(let t=0;t<e.args.length;t++)if(pq(r,e,t)||rce(r,e.args[t]))return!0;return!1}function rce(r,e){switch(e.type){case"Sqrt":return kg(r,e.arg)||kg(r,e.optArg);case"Frac":return kg(r,e.num)||kg(r,e.den);case"SupSub":return kg(r,e.sup)||kg(r,e.sub);case"LeftRight":return kg(r,e.arg);case"TokenNode":return!1;case"Other":return!1;default:throw new Error(`Programming Error: Invalid atom type ${e.type}`)}}function pq(r,e,t){if(r.args.length>e.args.length-t)return!1;for(let o=0;o<r.args.length;o++)if(!oce(r.args[o],e.args[o+t]))return!1;return!0}function Sg(r,e,t){return!r&&!e?!0:!r||!e?!1:r.args.length===0?!0:r.args.length>e.args.length||!(t!=null&&t.allowPrefix)&&r.args.length<e.args.length?!1:pq(r,e,0)}function oce(r,e){let t=!!r.isTrailing;switch(r.type){case"Sqrt":return e.type==="Sqrt"&&Sg(r.optArg,e.optArg)&&Sg(r.arg,e.arg);case"Frac":return e.type==="Frac"&&Sg(r.num,e.num)&&Sg(r.den,e.den);case"SupSub":return e.type==="SupSub"&&r.nprimes<=e.nprimes&&(!r.sup||Sg(r.sup,e.sup))&&Sg(r.sub,e.sub,{allowPrefix:t});case"LeftRight":return e.type==="LeftRight"&&cq(r.left,e.left)&&cq(r.right,e.right)&&Sg(r.arg,e.arg,{allowPrefix:t});case"TokenNode":return e.type==="TokenNode"&&Sg(r.arg,e.arg);case"Other":return r.type===e.type&&r.val===e.val}}function cq(r,e){return r.type===e.type&&r.val===e.val}function ice(r){return r.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")}function uq(r){let e=ice(r);return e=e.replace(/\\\\ /g,"\\\\? "),e=e.replace(/\\\\([A-Za-z]+) ?/g,"\\\\?$1 ?"),new RegExp(e)}var hq={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function hF(r){let e=[],t=r.toLowerCase();if(t.slice(0,3)==="rgb")try{e=t.replace(/[^\d,]/g,"").split(",").slice(0,3).map(o=>parseInt(o,10))}catch(o){uF(r)}else if(t[0]==="#"){let o=/^#?([a-f\d])([a-f\d])([a-f\d])$/;t=t.replace(o,(i,n,a,s)=>n+n+a+a+s+s);try{e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/.exec(t).slice(1).map(i=>parseInt(i,16))}catch(i){uF(r)}}else e=hq[t];return nce(e)||uF(r),{R:e[0],G:e[1],B:e[2]}}function nce(r){return!__dcg_shared_module_exports__['fb'](r)||r.length!==3?!1:__dcg_shared_module_exports__['Ia'](r,e=>Number.isInteger(e)&&e>=0&&e<=255)}function uF(r){throw new Error("Invalid color string: "+r)}function gq(r){let e=r.R/255,t=r.G/255,o=r.B/255,i=[];return i[0]=.49*e+.31*t+.2*o,i[1]=.17697*e+.8124*t+.01063*o,i[2]=.01*t+.99*o,i=__dcg_shared_module_exports__['Ga'](i,n=>n/.17697),{X:i[0],Y:i[1],Z:i[2]}}function mq(r){let i=r.X,n=r.Y,a=r.Z,s=[];return s[0]=116*f0(n/100)-16,s[1]=500*(f0(i/95.047)-f0(n/100)),s[2]=200*(f0(n/100)-f0(a/108.883)),{L:s[0],a:s[1],b:s[2]}}function f0(r){let e=.20689655172413793;return r>Math.pow(e,3)?Math.pow(r,1/3):r/(3*e*e)+4/29}function ace(r,e){let c=r.L,d=r.a,p=r.b,u=e.L,g=e.a,h=e.b,b=c-u,v=Math.sqrt(d*d+p*p),T=Math.sqrt(g*g+h*h),E=v-T,I=d-g,_=p-h,C=Math.sqrt(I*I+_*_-E*E),D=1+.045*v,P=1+.015*v,F=b/(1*1),N=E/(1*D),Y=C/(1*P);return Math.sqrt(F*F+N*N+Y*Y)}function sce(r,e){let t=mq(gq(hF(r))),o=mq(gq(hF(e)));return ace(t,o)}function fq(r,e){let t=__dcg_shared_module_exports__['Ga'](e,i=>sce(r,i)),o=__dcg_shared_module_exports__['Na'](t);return e[t.indexOf(o)]}function lce({R:r,G:e,B:t}){return .2126729*(r/255)**2.4+.7151522*(e/255)**2.4+.072175*(t/255)**2.4}var gF=.342;function mF(r,e=!1,t=gF){if(typeof r!="string"||!r)return!1;try{let o=hF(r);return lce(o)>t?!e:e}catch(o){return!1}}var yq={folderId:"",secret:!1,readonly:!1},Wu={latex:"",color:"",hidden:!1,values:[],points:!0,lines:!1,dragMode:__dcg_shared_module_exports__['Gd'].NONE,pointStyle:__dcg_shared_module_exports__['Cd'].POINT,pointOutline:!1,lineStyle:__dcg_shared_module_exports__['Dd'].SOLID,colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:"",disableGraphInteractions:!1};function Jx(r){let e=(r.columns||[]).map(t=>({...Wu,...t}));return{...yq,...r,columns:e}}function xq(r){return r={...r,columns:r.columns.map(e=>__dcg_shared_module_exports__['Jd'](Wu,e))},__dcg_shared_module_exports__['Jd'](yq,r)}function nI(r){return{type:"table",id:r.id,columns:r.columns.map(t=>({...t,tableId:r.id})),regression:r.regression}}function eo(r,e){if(/^\s*(\-|\+)?([0-9]+(\.[0-9]+)?)\s*$/.test(r))return parseFloat(r);let o=__dcg_shared_module_exports__['Kb'](__dcg_shared_module_exports__['xc']);return o.trigAngleMultiplier=new __dcg_shared_module_exports__['vc'](e?Math.PI/180:1),+__dcg_shared_module_exports__['Lc'](__dcg_shared_module_exports__['Kc'],__dcg_shared_module_exports__['xe'](r),__dcg_shared_module_exports__['ye'],o).asValue()}function wq(r,e){let t=__dcg_shared_module_exports__['Qb'](r),o=__dcg_shared_module_exports__['Qb'](e);if(!__dcg_shared_module_exports__['q'](t.n/t.d,r)||!__dcg_shared_module_exports__['q'](o.n/o.d,e))return;let i=__dcg_shared_module_exports__['Sb'](t.d,o.d),n=t.n*(i/t.d),s=o.n*(i/o.d)-n;return{nstart:n,nstep:s,lcm:i}}function dce(r){return isFinite(r)?__dcg_shared_module_exports__['ub'](r,{digits:8,bigCutoff:1e6,smallCutoff:.001}):"\\mathrm{undefined}"}function pce(r){return!isFinite(r[0])||!isFinite(r[1])?"\\mathrm{undefined}":__dcg_shared_module_exports__['yb'](r,{digits:5,bigCutoff:1e6,smallCutoff:.001})}function uce(r){return Array.isArray(r)?r[1]!==0:!1}function kq(r){return r.length>=1&&r.every(uce)}function hce(r,e,t,o){let i=r.columnModels[e];i.error=t.error,i.computed=t.computed&&!!i.latex,i.draggable=!t.error&&!t.computed,i.dependsOnRegression=!!t.depends_on_regression,i.dependsOnRecursion=!!t.depends_on_recursive_function,i.packedErrors=[],i.computedValues=[],i.hasNanOrErrorValue=!1,i.hasComplexValue=!1;for(let n=t.values.length-1;n>=0;n--){let a=t.values[n];typeof a=="number"?(i.computedValues[n]=dce(a),isNaN(a)&&(i.hasNanOrErrorValue=!0)):Array.isArray(a)?(i.computedValues[n]=pce(a),(isNaN(a[0])||isNaN(a[1]))&&(i.hasNanOrErrorValue=!0),a[1]!==0&&(i.hasComplexValue=!0)):(i.computedValues[n]="",i.packedErrors[n]=a,i.hasNanOrErrorValue=!0)}if(i.suppressIcon=o||e>0&&kq(t.values),t.plotted&&!i.suppressIcon)for(let n=0;n<t.values.length;n++){if(i.packedErrors[n])continue;let a=t.values[n];Array.isArray(a)&&a[1]!==0&&!isNaN(a[1])&&(i.packedErrors[n]=__dcg_shared_module_exports__['Ib']().getError())}}function _q(r){let e=gs(r);if(!e)return;let t=Zf(r);if(!t){r.isExpanded||Qx(r,!0);return}e.row>=t.min&&e.row<t.max&&Qx(r,!0)}function Zf(r){if(r.isExpanded)return;let e=Xn(r);if(!(e<30))return{min:8,max:e-4}}function Cq(r,e){let t=r.columnModels[e];return{values:t.values.slice(),dragMode:t.dragMode,hidden:t.hidden,id:t.id,color:t.color,points:t.points,lines:t.lines,pointStyle:t.pointStyle,lineStyle:t.lineStyle,latex:t.latex,colorLatex:t.colorLatex,lineOpacity:t.lineOpacity,lineWidth:t.lineWidth,pointSize:t.pointSize,pointOutline:t.pointOutline,pointOpacity:t.pointOpacity,disableGraphInteractions:t.disableGraphInteractions}}var gce=0;function mce(){return"table_guid_"+gce++}function fce(r,e,t){r.columnModels[e].values.splice(t,0,"")}function bce(r,e,t){r.columnModels[e].values.splice(t,1)}function Tq(r,e,t){let{color:o}=t;(!o||!jx(o))&&(o=r.controller.getNextColor());let i={...t,type:"table-column",guid:mce(),index:e,error:void 0,table:r,color:o,packedErrors:[],computedValues:[],shouldGraph:void 0,computed:void 0,draggable:void 0,hasNanOrErrorValue:!1,dependsOnRegression:!1,dependsOnRecursion:!1,hasComplexValue:!1,suppressIcon:!1};return e===0&&(i.hidden=!0),i}function b0(r,e){let t=r.table.formula;if(!t)return!1;let o=t.column_data[r.index];return o?!!o[e]:!1}function Eq(r){return b0(r,"color_latex_valid")}function Iq(r){return b0(r,"line_opacity_valid")}function Mq(r){return b0(r,"line_width_valid")}function Dq(r){return b0(r,"point_size_valid")}function Aq(r){return b0(r,"point_opacity_valid")}function Lq(r){let e=r.table.formula;if(!e)return;let t=e.column_data[r.index];if(t)return t.color_latex_value}function Pq(r){r.draggingOnGraphpaper?r.preTransientState||(r.preTransientState={columns:ev(r,{stripDefaults:!1}).columns}):delete r.preTransientState,dp(r);let e=Ua(r),t=e&&e.hidden;__dcg_shared_module_exports__['Fa'](r.columnModels,o=>{o.shouldGraph=!t&&!o.hidden&&!r.controller.is3dProduct()}),xce(r),vce(r),yce(r)}function Xn(r){let e=2,t,o=gs(r);return o&&o.row>e&&(e=o.row),r.columnModels.forEach(i=>{t=i.computed?i.computedValues.length:i.values.length+1,t>e&&(e=t)}),e}function Qf(r){return r.columnModels.length}function Gq(r,e){var o;r.formula=e;let t=r.controller.is3dProduct()||kq(e.column_data[0].values);for(let i=0;i<e.column_data.length&&i<Qf(r);i++){let n=e.column_data[i];hce(r,i,n,t)}((o=e.table_regression)==null?void 0:o.status)==="success"&&r.regression&&(r.regression.residualVariable=e.table_regression.result.residualVariable)}function fF(r,e){for(let t=0;t<r.columnModels.length;t++)fce(r,t,e)}function Vq(r,e){let t=Zf(r);t&&e===t.max-1&&Qx(r,!0);for(let o=0;o<r.columnModels.length;o++)bce(r,o,e),o>0&&tH(r.columnModels[o])}function aI(r,e){let t={id:r.controller.generateId(),latex:e?e.latex:"",color:r.controller.getNextColor()},o=e?e.columnIndex:r.columnModels.length,i={...Wu,...t,values:[]},n=Tq(r,o,i);r.columnModels.splice(o,0,n);for(let a=o+1;a<r.columnModels.length;a++)r.columnModels[a].index=a}function y0(r,e){var o;let[t]=r.columnModels.splice(e,1);for(let i=e;i<r.columnModels.length;i++)r.columnModels[i].index=i;t&&((o=r.regression)==null?void 0:o.columnIds.y)===t.id&&w0(r,void 0)}function Oq(r,e){let t,o=r.columnModels.length,i=[];for(t=0;t<o;t++)i.push("");let n=r.columnModels[0].values;if(e>1){let a=r.controller.getDegreeMode(),s=eo(n[0],a),c=eo(n[1],a);if(isFinite(s)&&isFinite(c)){let d=wq(s,c);if(d){let p=d.nstart,u=p/d.lcm;for(t=0;t<e;t++){let g=eo(n[t],a);if(!__dcg_shared_module_exports__['q'](g,u))return i;p+=d.nstep,u=p/d.lcm}(""+s).length<8&&(""+c).length<8?i[0]=""+u:i[0]="\\frac{"+p+"}{"+d.lcm+"}"}}}return i}function x0(r,e,t){for(let o=0;o<r.columnModels.length;o++){let i=r.columnModels[o],n={cellLocation:{column:o,row:0}};if(e(i.latex,"tableHeader",n),t!=null&&t.headersOnly)continue;e(i.colorLatex,"tableColumnColorLatex",n),e(i.pointSize,"tableColumnPointSize",n),e(i.pointOpacity,"tableColumnPointOpacity",n),e(i.lineWidth,"tableColumnLineWidth",n),e(i.lineOpacity,"tableColumnLineOpacity",n);let a=r.columnModels[o];for(let s=0;s<a.values.length;s++)a.values[s]&&e(a.values[s],"tableCellValue",{cellLocation:{column:o,row:s+1}})}}function yce(r){let e=nI({type:"table",id:r.id,secret:r.secret,readonly:r.readonly,folderId:r.folderId,columns:r.columnModels.map(o=>Cq(r,o.index)),regression:__dcg_shared_module_exports__['f'](r.regression)});for(let o=0;o<e.columns.length;o++)e.columns[o].hidden=!r.columnModels[o].shouldGraph;e.moduleID=rv(r),r.cachedParsableState=e;let t=r.regression;if(e.regression&&t){let o=Ua(r);o&&o.hidden&&(e.regression={...e.regression,hidden:!0})}}function Rq(r){return r.slice(0,r.length-1)}function ev(r,e){let t={...r.cachedViewState,columns:Rq(r.cachedViewState.columns)};return e.stripDefaults?xq(t):(t.regression===void 0&&delete t.regression,t)}function xce(r){let e=r.columnModels.map((t,o)=>Cq(r,o));r.cachedViewState={id:r.id,type:r.type,folderId:r.folderId,columns:e,secret:r.secret,readonly:r.readonly,regression:__dcg_shared_module_exports__['f'](r.regression)}}function Fq(r,e){r.draggingOnGraphpaper=e}function vce(r){let e={...r.cachedViewState,columns:Rq(r.cachedViewState.columns),regression:__dcg_shared_module_exports__['f'](r.regression)};r.cachedUndoRedoFullState=e,r.preTransientState&&(e={...e,...r.preTransientState}),r.cachedUndoRedoDiffState=e}var wce={id:!1,type:!1,columns:!1,regression:!0,folderId:!0,secret:!0,readonly:!0,disableGraphInteractions:!0};function Nq(r,e){__dcg_shared_module_exports__['Rd']({from:e,to:r,props:wce}),Yq(r,e.columns)}function Uq(r,e){let t=__dcg_shared_module_exports__['f'](Jx(r)),o={...t,...cp(e),columnModels:void 0,formula:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},isExpanded:!1};return Yq(o,t.columns),o}function Yq(r,e){r.columnModels=e.map((t,o)=>Tq(r,o,t)),aI(r)}var Sq=["x","y","z","u","v","w"];function bF(r,e,t){let o=[],i=Math.min(e.length,Sq.length);for(let n=0;n<i;n++)o.push({id:t.generateId(),latex:__dcg_shared_module_exports__['vb'](Sq[n]+"_"+r),values:e[n],color:t.getNextColor(),hidden:!1,points:!0,lines:!1,dragMode:__dcg_shared_module_exports__['Gd'].NONE,pointStyle:__dcg_shared_module_exports__['Cd'].POINT,pointOutline:!1,lineStyle:__dcg_shared_module_exports__['Dd'].SOLID,colorLatex:"",lineWidth:"",lineOpacity:"",pointOpacity:"",pointSize:"",disableGraphInteractions:!1});return{id:t.generateId(),type:"table",folderId:"",secret:!1,readonly:!1,columns:o}}function Bq(r,e){let t=ev(r,{stripDefaults:!1});if(!t.columns||!e.columns)return e;for(let o=0;o<e.columns.length;o++){let i=t.columns[o],n=e.columns[o];if(i)for(let a in i)i.hasOwnProperty(a)&&(n.hasOwnProperty(a)||(n[a]=i[a]))}return e}function gs(r){if(!r)return;let e=r.controller.getFocusLocation();if(e&&e.type==="table"&&e.id===r.id)return e.location}function lo(r,e){for(let t=0;t<r.columnModels.length;t++){let o=r.columnModels[t];if(o.id===e)return o}}function yF(r,e,t){let o=lo(r,e);o&&(o.points=t,t||(o.dragMode=__dcg_shared_module_exports__['Gd'].NONE))}function Kq(r,e,t){let o=lo(r,e);o&&(o.pointStyle=t)}function zq(r,e,t){let o=lo(r,e);o&&(o.lines=t)}function qq(r,e,t){let o=lo(r,e);o&&(o.lineStyle=t)}function sI(r,e,t){let o=lo(r,e);o&&(o.lineWidth=t)}function lI(r,e,t){let o=lo(r,e);o&&(o.lineOpacity=t)}function cI(r,e,t){let o=lo(r,e);o&&(o.pointSize=t)}function Hq(r,e,t){let o=lo(r,e);o&&(o.pointOutline=t)}function dI(r,e,t){let o=lo(r,e);o&&(o.pointOpacity=t)}function Wq(r,e,t){let o=lo(r,e);if(o)if(t.type==="inert")o.disableGraphInteractions=t.disableGraphInteractions,t.disableGraphInteractions&&(o.dragMode=__dcg_shared_module_exports__['Gd'].NONE);else{let i=t.dragMode;o.dragMode=i,i!==__dcg_shared_module_exports__['Gd'].NONE&&!o.points&&(o.points=!0),i!==__dcg_shared_module_exports__['Gd'].NONE&&(o.disableGraphInteractions=!1)}}function jq(r,e,t){Wq(r,e,{type:"draggable",dragMode:t})}function Xq(r,e,t){let o=lo(r,e);!o||!jx(t)||(o.color=t,o.colorLatex="")}function $q(r,e){r.regression&&(r.regression.color=e)}function Jq(r,e){r.regression&&(r.regression.isLogMode=e)}function pI(r,e,t){let o=lo(r,e);o&&(o.colorLatex=t)}function Qx(r,e){r.isExpanded=e}function Zq(r,e,t){let o=lo(r,e);o&&(o.hidden=t,t&&eH(r))}function Qq(r,e,t){let o=lo(r,e);o&&(o.boundingBoxes=t,eH(r))}function eH(r){let e=[];r.columnModels.forEach(t=>{t.boundingBoxes&&!t.hidden&&(e=e.concat(t.boundingBoxes))}),r.boundingBoxes=e}function uI(r,e){let t=lo(r,e);return t?!t.points&&!t.lines:!0}function Cg(r,e,t){if(e.row===0){let i=r.columnModels[e.column].id,n=lo(r,i);if(!n)return;n.latex=t,e.column>=r.columnModels.length-1&&aI(r);return}let o=r.columnModels[e.column];for(let i=o.values.length;i<e.row-1;i++)o.values[i]="";r.columnModels[o.index].values[e.row-1]=t,e.column>0&&tH(r.columnModels[o.index])}function tH(r){for(;r.values.length>0&&!r.values[r.values.length-1];)r.values.pop()}function rH(r,e){return!!r.columnModels[e.column]&&e.row>=0}function oH(r){let e;if(r.values){for(e of r.values)if(e!=="")return!1}if(r.computedValues){for(e of r.computedValues)if(e!=="")return!1}return!0}function iH(r){return r.computed}function tv(r){return r.computed||r.index===r.table.columnModels.length-1}function nH(r,e){Wq(r.table,r.id,{type:"inert",disableGraphInteractions:e})}function v0(r,e,t){let o=r.columnModels[t];return o.computed?o.computedValues[e]||"":o.values[e]||""}function aH(r){let e=Xn(r),t=Qf(r);for(let o=0;o<t;o++)if(v0(r,e-1,o)!=="")return!1;return!0}function w0(r,e){var o,i;let t=!__dcg_shared_module_exports__['db']((o=r.regression)==null?void 0:o.columnIds,e==null?void 0:e.columnIds)||((i=r.regression)==null?void 0:i.type)!==(e==null?void 0:e.type);r.regression=e,r.regression&&t&&(r.regression.residualVariable=void 0)}function ju(r){return!!r.latex&&!r.error&&!r.dependsOnRegression&&!r.dependsOnRecursion}function Tg(r){return r.computedValues.length>=2&&!r.hasNanOrErrorValue&&!r.hasComplexValue}function sH(r){var i,n;let e=r.regression;if(!e)return;let t=(i=r.columnModels.find(a=>a.id===e.columnIds.x))==null?void 0:i.latex,o=(n=r.columnModels.find(a=>a.id===e.columnIds.y))==null?void 0:n.latex;return t&&o?[t,o]:void 0}var Sce=30,kce=10,hI=__dcg_shared_module_exports__['zd'].RED,gI=__dcg_shared_module_exports__['zd'].BLUE,mI=__dcg_shared_module_exports__['zd'].GREEN,fI=__dcg_shared_module_exports__['zd'].PURPLE,bI=__dcg_shared_module_exports__['zd'].ORANGE,ov=__dcg_shared_module_exports__['zd'].BLACK;function up(r,e){switch(e){case __dcg_shared_module_exports__['zd'].RED:return r.s("graphing-calculator-text-color-red");case __dcg_shared_module_exports__['zd'].BLUE:return r.s("graphing-calculator-text-color-blue");case __dcg_shared_module_exports__['zd'].GREEN:return r.s("graphing-calculator-text-color-green");case __dcg_shared_module_exports__['zd'].PURPLE:return r.s("graphing-calculator-text-color-purple");case __dcg_shared_module_exports__['zd'].ORANGE:return r.s("graphing-calculator-text-color-orange");case __dcg_shared_module_exports__['zd'].BLACK:return r.s("graphing-calculator-text-color-black");case __dcg_shared_module_exports__['zd'].GRAY:return r.s("graphing-calculator-text-color-gray");default:let{r:t,g:o,b:i}=__dcg_shared_module_exports__['vd'](e),n=Math.max(t,o,i),a=Math.min(t,o,i),s=n/255,c=n===0?0:(n-a)/n,d=0;n!==a&&(n===t?d=(o-i)/(n-a)+(o<i?6:0):n===o?d=(i-t)/(n-a)+2:d=(t-o)/(n-a)+4,d/=6),d*=360,c*=100;let p=s*100;return p<10?r.s("graphing-calculator-text-color-black"):c<10?p>90?r.s("graphing-calculator-text-color-white"):p>75?r.s("graphing-calculator-text-color-light-gray"):p>50?r.s("graphing-calculator-text-color-gray"):r.s("graphing-calculator-text-color-dark-gray"):d>=0&&d<15?p<50?r.s("graphing-calculator-text-color-dark-red"):p<75?r.s("graphing-calculator-text-color-red"):r.s("graphing-calculator-text-color-light-red"):d>=15&&d<45?p<50?r.s("graphing-calculator-text-color-dark-orange"):p<75?r.s("graphing-calculator-text-color-orange"):r.s("graphing-calculator-text-color-light-orange"):d>=45&&d<75?p<50?r.s("graphing-calculator-text-color-dark-yellow"):p<75?r.s("graphing-calculator-text-color-yellow"):r.s("graphing-calculator-text-color-light-yellow"):d>=75&&d<105?p<50?r.s("graphing-calculator-text-color-dark-lime"):p<75?r.s("graphing-calculator-text-color-lime"):r.s("graphing-calculator-text-color-light-lime"):d>=105&&d<135?p<50?r.s("graphing-calculator-text-color-dark-green"):p<75?r.s("graphing-calculator-text-color-green"):r.s("graphing-calculator-text-color-light-green"):d>=135&&d<165?p<50?r.s("graphing-calculator-text-color-dark-cyan"):p<75?r.s("graphing-calculator-text-color-cyan"):r.s("graphing-calculator-text-color-light-cyan"):d>=165&&d<195?p<50?r.s("graphing-calculator-text-color-dark-teal"):p<75?r.s("graphing-calculator-text-color-teal"):r.s("graphing-calculator-text-color-light-teal"):d>=195&&d<225?p<50?r.s("graphing-calculator-text-color-dark-blue"):p<75?r.s("graphing-calculator-text-color-blue"):r.s("graphing-calculator-text-color-light-blue"):d>=225&&d<255?p<50?r.s("graphing-calculator-text-color-dark-indigo"):p<75?r.s("graphing-calculator-text-color-indigo"):r.s("graphing-calculator-text-color-light-indigo"):d>=255&&d<285?p<50?r.s("graphing-calculator-text-color-dark-violet"):p<75?r.s("graphing-calculator-text-color-violet"):r.s("graphing-calculator-text-color-light-violet"):d>=285&&d<315?p<50?r.s("graphing-calculator-text-color-dark-magenta"):p<75?r.s("graphing-calculator-text-color-magenta"):r.s("graphing-calculator-text-color-light-magenta"):d>=315&&d<345?p<50?r.s("graphing-calculator-text-color-dark-pink"):p<75?r.s("graphing-calculator-text-color-pink"):r.s("graphing-calculator-text-color-light-pink"):d>=345&&d<=360?p<50?r.s("graphing-calculator-text-color-dark-red"):p<75?r.s("graphing-calculator-text-color-red"):r.s("graphing-calculator-text-color-light-red"):r.s("graphing-calculator-text-color-unknown")}}var xF=r=>{if(!Array.isArray(r))return[r];let e=Array(Math.min(r.length,kce));for(let t=0;t<e.length;t++)e[t]=r[Math.round(t*r.length/e.length)];return e};function lH(r,e){switch(r.type){case"single-color":case"color-array":return xF(r.value).every(o=>mF(o,e));case"shader":case"image":return!1;default:let t=r;throw new Error("Unexpected ColorSwatchSpec type: "+t.type)}}function iv(r,e,t=gF){switch(r.type){case"single-color":case"color-array":return xF(r.value).some(i=>mF(i,e,t));case"shader":case"image":return!0;default:let o=r;throw new Error("Unexpected ColorSwatchSpec type: "+o.type)}}var nv=r=>{switch(r.type){case"single-color":return r.value;case"color-array":let e=xF(r.value);if(e.length===0)return __dcg_shared_module_exports__['zd'].BLACK;if(e.length===1)return r.value[0];let t=Sce/e.length;return`linear-gradient(to right${e.reduce((i,n,a)=>`${i}, ${n} ${a*t}px, ${n} ${(a+1)*t}px`,"")})`;case"shader":return"#808080";case"image":return'url("'+r.value+'")';default:let o=r;throw new Error("Unexpected ColorSwatchSpec type: "+o.type)}};var _ce=0;function Cce(){return"abstract_item_"+_ce++}function cp(r){return{guid:Cce(),controller:r,index:-1,displayIndex:"-1",secretIndex:"-1",isHiddenFromUI:!0,renderShell:!0}}function yI(r,e){r.secret=e}function S0(r,e){r.readonly=e}function In(r,e){r.type!=="folder"&&(r.folderId=e)}function dp(r){r.isHiddenFromUI=vF(r)}function xI(r){return r.isHiddenFromUI||r.filteredBySearch?"none":r.renderShell?"shell":"render"}function Eg(r){let e=k0(r),t=e.type==="color-array"?{type:"single-color",value:e.value[0]}:e;return nv(t)}function k0(r){if(!r.colorLatex)return{type:"single-color",value:r.color};if(/^data:image/.test(r.colorLatex))return{type:"image",value:r.colorLatex};let e,t,o=!1;return r.type==="expression"?(e=wI(r),t=vI(r),o=r.formula.color_latex_valid===void 0):r.type==="table-column"&&(e=Lq(r),t=Eq(r)),t&&e?Array.isArray(e)?{type:"color-array",value:e}:{type:"single-color",value:e}:o?{type:"single-color",value:"#999"}:{type:"single-color",value:r.color}}function $n(r){return r.type==="expression"||r.type==="image"||r.type==="table-column"?!!r.disableGraphInteractions:!1}function Tce(r){var e;return!!((e=r.title)!=null&&e.includes("@"))}function rv(r){if(!r.controller.getGraphSettings().config.folderModules)return;let e=r.controller.getItemModel(r.folderId);if((e==null?void 0:e.type)==="folder"&&Tce(e))return r.folderId}var _0=class{constructor(e,t){this.exports=new Map;if(!t)return;let o=Ece(e);for(let i of t.allDefinedQualifiedNames)i.frameID===__dcg_shared_module_exports__['Jb']&&this.exports.set(i.symbol,{name:i.symbol,isRegressionExport:o.has(i.symbol),isMultiplyDefined:!!t.multiplyDefined.has(i)})}optimisticallyRegisterColumnName(e){this.cachedLastSubscripts=void 0,!this.exports.get(e)&&this.exports.set(e,{name:e,isMultiplyDefined:!1,isRegressionExport:!1})}isDefined(e,t){let o=this.exports.get(e);return t.includeRegressionExports?!!o:o&&!o.isRegressionExport}isMultiplyDefined(e,t){var o;return this.isDefined(e,t)&&!!((o=this.exports.get(e))!=null&&o.isMultiplyDefined)}getLastSubscriptForName(e,t){var o,i;if(e.includes("_"))throw new Error(`Programming error: ${e} already has a subscript`);this.cachedLastSubscripts===void 0&&(this.cachedLastSubscripts={});for(let n of this.exports.values()){if(!t.includeRegressionExports&&n.isRegressionExport)continue;let[a,s]=n.name.split("_"),c=parseInt(s,10);isNaN(c)||a===e&&(this.cachedLastSubscripts[e]=Math.max((o=this.cachedLastSubscripts[e])!=null?o:0,c))}return(i=this.cachedLastSubscripts[e])!=null?i:-1}};function Ece(r){var t,o,i,n,a;let e=new Set;for(let s of r)if(s.type==="table"&&((o=(t=s.formula)==null?void 0:t.table_regression)==null?void 0:o.status)==="success"){let c=s.formula.table_regression.result.residualVariable,d=__dcg_shared_module_exports__['wb'](c);e.add(d)}else if(s.type==="expression"&&s.formula.is_regression){let c=(i=s.formula.regression)==null?void 0:i.residualVariable,d=c?__dcg_shared_module_exports__['wb'](c):void 0;d&&e.add(d);for(let p of(a=(n=s.formula)==null?void 0:n.exported_variables)!=null?a:[])p!==d&&e.add(p)}return e}function SI(r,e){let t=r.cachedViewState;return e.stripDefaults?__dcg_shared_module_exports__['Yd'](t):t}function Ice(r){r.cachedViewState={type:r.type,id:r.id,title:r.title,hidden:r.hidden,inFrontOfEverything:r.inFrontOfEverything,readonly:r.readonly,collapsed:r.collapsed,secret:r.secret}}function Mce(r){r.cachedUndoRedoDiffState=r.cachedViewState,r.cachedUndoRedoFullState=r.cachedViewState}function dH(r,e){return{...__dcg_shared_module_exports__['f'](__dcg_shared_module_exports__['Xd'](r)),...cp(e),cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},cachedViewState:{}}}function Dce(r){if(!r.controller.getGraphSettings().config.folderModules)return;let e=__dcg_shared_module_exports__['_d'](r);r.cachedParsableState=e}function pH(r){Ace(r),dp(r),Ice(r),Mce(r),Dce(r)}function Ace(r){let t=r.controller.getAllSelectedItems();r.collapsedChildIsSelected=r.collapsed&&__dcg_shared_module_exports__['Ja'](t,o=>o.type!=="folder"&&o.folderId===r.id)}var Lce={id:!1,type:!1,hidden:!0,secret:!0,inFrontOfEverything:!0,collapsed:!0,title:!0,readonly:!0,disableGraphInteractions:!0};function uH(r,e){__dcg_shared_module_exports__['Rd']({from:e,to:r,props:Lce})}function av(r,e){r.collapsed=e}function wF(r,e){r.title=e}function hH(r,e){r.hidden=e}function gH(r){return r.hidden}function mH(r,e){r.inFrontOfEverything=e}var Ig={cb20221031:"1"};Ut();function SF(r){let e={};return re.extend(!0,e,r),re.param(e)}var C0="";function Xu(){return C0}var yH=[];function xH(r){yH.push(r)}function Pce(r){if(r.status===401)for(let e of yH)e()}var Gce=r=>typeof r=="object"&&!!r&&"routeDeprecated"in r&&"js"in r&&typeof r.js=="string";function vH(r){let e=new URLSearchParams;return Object.entries(r).forEach(([t,o])=>{Array.isArray(o)?o.forEach(i=>e.append(t,String(i))):e.set(t,String(o))}),e}function Vce(){throw{status:0,responseJSON:{errors:[{key:"connection_failed",message:"Connection failed. Check your internet connection?"}]}}}var bH=async r=>{try{return await r.json()}catch(e){return}};async function kI(r){let e=await r.catch(Vce);if(Pce(e),!e.ok)throw{status:e.status,statusText:e.statusText,responseJSON:await bH(e)};let t=await bH(e);if(Gce(t))throw t.js&&new Function(t.js)(),t;return t}var kF=(r,e,t,o)=>{let i={method:r,credentials:"include",headers:{Accept:"application/json, text/javascript, */*; q=0.01"}};t&&(i.body=SF(t),i.headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8");let n="";return o!==void 0&&(n=`?${vH(o).toString()}}`),kI(fetch(`${C0}${e}${n}`,i))},Di=(r,e,t)=>kF("POST",r,e,t),wH=(r,e,t)=>kF("PUT",r,e,t),SH=async(r,e,t)=>kF("PATCH",r,e,t);async function _I(r,e){let t={method:"DELETE",credentials:"include",headers:{Accept:"application/json, text/javascript, */*; q=0.01",...e?{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}:{}},body:e?SF(e):void 0};return await kI(fetch(C0+r,t))}async function kH(r,e){let t={method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json, text/javascript, */*; q=0.01"},body:JSON.stringify(e||null)};return await kI(fetch(C0+r,t))}async function Jc(r,e){let t={method:"GET",credentials:"include",headers:{Accept:"application/json, text/javascript, */*; q=0.01"}},o=/\?/.test(String(r))?"&":"?";return await kI(fetch(`${C0}${r}${o}${vH({...e,...Ig})}`,t))}function eb(r){return async e=>Jc(r,e)}function sv(r){return async e=>Di(r,e)}var _F=r=>e=>_I(r,e);function E0(r){let e=[];for(let t of r){if(!t||typeof t!="string")continue;let o=t.split("-")[0];e.push(t),e.push(o);for(let i in Zc){let n=Zc[i];i.split("-")[0]===o&&n.useAsRoot&&e.push(i)}}return e}function _H(){let r={},e=Object.keys(Zc);for(let t in e){let o=e[t];r[o]={code:o,display_name:Zc[o].displayName}}return r}var Zc={en:{displayName:"English (US)",userGuideURL:"https://docs.google.com/document/d/1gV-WgDjgR9hKKb32ffeUpjwggNAgfqxl0Gsg6xocbok/preview",useAsRoot:!1},es:{displayName:"Espa\xF1ol (LATAM)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ES-ES.pdf",useAsRoot:!0},et:{displayName:"Eesti",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ru:{displayName:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_RU.pdf",useAsRoot:!1},da:{displayName:"Dansk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},de:{displayName:"Deutsch",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_DE.pdf",useAsRoot:!1},"pt-BR":{displayName:"Portugu\xEAs (Brasil)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},"pt-PT":{displayName:"Portugu\xEAs (Portugal)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ca:{displayName:"Catal\xE0",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},fr:{displayName:"Fran\xE7ais",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_FR.pdf",useAsRoot:!0},"fr-CA":{displayName:"Fran\xE7ais (Canada)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_FR.pdf",useAsRoot:!0},it:{displayName:"Italiano",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_IT.pdf",useAsRoot:!1},is:{displayName:"\xCDslenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},nl:{displayName:"Nederlands",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},no:{displayName:"Norsk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},"sv-SE":{displayName:"Svenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},hu:{displayName:"Magyar",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},cs:{displayName:"\u010Ce\u0161tina",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},pl:{displayName:"Polski",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_PL.pdf",useAsRoot:!1},id:{displayName:"Bahasa Indonesia",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},vi:{displayName:"Ti\u1EBFng Vi\u1EC7t",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_VI.pdf",useAsRoot:!1},el:{displayName:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_EL.pdf",useAsRoot:!1},uk:{displayName:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ka:{displayName:"\u10E5\u10D0\u10E0\u10D7\u10E3\u10DA\u10D8",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},th:{displayName:"\u0E20\u0E32\u0E29\u0E32\u0E44\u0E17\u0E22",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},tr:{displayName:"T\xFCrk\xE7e",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_TR.pdf",useAsRoot:!1},"zh-CN":{displayName:"\u7B80\u4F53\u4E2D\u6587",useAsRoot:!0,userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-CN.pdf"},"zh-TW":{displayName:"\u7E41\u9AD4\u4E2D\u6587",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-TW.pdf",useAsRoot:!1},ko:{displayName:"\uD55C\uAD6D\uC5B4",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ja:{displayName:"\u65E5\u672C\u8A9E",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_JA.pdf",useAsRoot:!1}};var CH=`account-shell-button-cancel = Cancel
account-shell-button-contact-us = Contact Us
account-shell-button-download-braille = Download Braille Equations
account-shell-button-download-png = Download PNG
account-shell-button-download-svg = Download SVG
account-shell-button-duplicate = Duplicate
account-shell-button-edit = Edit
account-shell-button-embed = Embed
account-shell-button-export-image = Export Image
account-shell-button-hide-browser-warning = Hide this warning.
account-shell-button-line-medium = Medium
account-shell-button-line-thick = Thick
account-shell-button-line-thin = Thin
account-shell-button-log-in = Log In
account-shell-button-mygraphs-attempt-recovery = Attempt recovery.
account-shell-button-mygraphs-cancel = Cancel
account-shell-button-mygraphs-close-graph-list = Close Graph List
account-shell-button-mygraphs-close-graph-preview = Close Graph Preview
account-shell-button-mygraphs-delete-confirm = Yes, Delete
account-shell-button-mygraphs-delete-construction = Delete Construction
account-shell-button-mygraphs-delete-graph = Delete Graph
account-shell-button-mygraphs-delete-title = Delete { $graphTitle }
account-shell-button-mygraphs-grid = Grid
account-shell-button-mygraphs-list = List
account-shell-button-mygraphs-move = Move
account-shell-button-mygraphs-new-3d = New 3D
account-shell-button-mygraphs-new-folder = New Folder
account-shell-button-mygraphs-new-geometry = New Geometry
account-shell-button-mygraphs-new-graph = New Graph
account-shell-button-mygraphs-save = Save
account-shell-button-mygraphs-try-again = Try again
account-shell-button-open-construction = Open Construction
account-shell-button-open-graph = Open Graph
account-shell-button-print = Print
account-shell-button-rename = Rename
account-shell-button-retry-now = Retry now
account-shell-button-save = Save
account-shell-button-save-copy = Save Copy
account-shell-button-sign-up = Sign Up
account-shell-button-submit-graph = Submit this graph
account-shell-button-update-graph = Replace with your current graph
account-shell-error-art-contest-logged-out = Log in to participate in the art contest
account-shell-error-connection-failed = Connection failed. Try checking your internet connection.
account-shell-error-graph-too-large = This graph is too large to save. The maximum allowable size is 5 MB.
account-shell-error-logging-out = Error logging out.
account-shell-error-mygraphs-check-connection = Check your internet connection?
account-shell-error-mygraphs-error-deleting = Error deleting.
account-shell-error-mygraphs-error-loading = Error loading graph
account-shell-error-save-art-contest = Error saving. Please try again later.
account-shell-error-sharing-link = Sorry, there was an error generating a link to your graph.
account-shell-error-something-went-wrong = Something went wrong, please report this to desmos.com support. (Error { $error_num })
account-shell-error-submitting = Error submitting. Please try again later.
account-shell-error-unexpected-server = Unexpected server error. Try again, or e-mail { $email }.
account-shell-error-unknown = Sorry! Something went wrong. Please try again later.
account-shell-heading-3dcalc-page-title = Desmos | 3D Graphing Calculator
account-shell-heading-artist-statement = Your Artist Statement
account-shell-heading-birth-year = Your Birth Year
account-shell-heading-contact-us = Contact Us
account-shell-heading-country = Your Country
account-shell-heading-desmos-art-expo = Desmos Art Expo
account-shell-heading-download-instructions = Download Instructions
account-shell-heading-duplicate-construction = Duplicate This Construction
account-shell-heading-duplicate-graph = Duplicate This Graph
account-shell-heading-email = Your Email
account-shell-heading-email-details = This will never be shared, but please provide an email where we can reach you!
account-shell-heading-embossing-instructions = Embossing Instructions
account-shell-heading-export-image = Export Image
account-shell-heading-export-size = Size
account-shell-heading-file-format = File Format
account-shell-heading-geometry-page-title = Desmos | Geometry
account-shell-heading-graphingcalc-page-title = Desmos | Graphing Calculator
account-shell-heading-line-thickness = Line Thickness
account-shell-heading-mygraphs-copy-share-link = Copy Share Link
account-shell-heading-mygraphs-delete = Delete
account-shell-heading-mygraphs-examples = Examples
account-shell-heading-mygraphs-recovered-graphs = Recovered Graphs
account-shell-heading-mygraphs-recovered-work = Recovered Work
account-shell-heading-mygraphs-saved-constructions = Saved Constructions
account-shell-heading-mygraphs-saved-graphs = Saved Graphs
account-shell-heading-mygraphs-saved-graphs-count =
    { $count ->
        [one] { $count } graph selected
       *[other] { $count } graphs selected
    }
account-shell-heading-name = Your Name
account-shell-heading-name-details = This will be public.
account-shell-heading-named-graph = { $title } | Desmos
account-shell-heading-rename-construction = Rename This Construction
account-shell-heading-rename-graph = Rename This Graph
account-shell-heading-resources = Resources
account-shell-heading-save-construction = Save This Construction
account-shell-heading-save-graph = Save This Graph
account-shell-heading-share-construction = Share Your Construction
account-shell-heading-share-graph = Share Your Graph
account-shell-heading-submit-graph = Submit This Graph
account-shell-heading-title-mygraphs-search = Search
account-shell-heading-tours = Tours
account-shell-heading-unsupported-browser = Unsupported Browser
account-shell-label-account-information = Account Information
account-shell-label-advanced-preferences = Advanced
account-shell-label-artist-statement-description = In 2-3 sentences, tell us what you learned about math, Desmos, or yourself as you worked on your entry.
account-shell-label-artist-statement-placeholder = Tell us about this graph and your learning...
account-shell-label-artist-statement-placeholder-someone-else = Tell us about this graph...
account-shell-label-betchacant-loading = Challenge accepted...
account-shell-label-birth-year-placeholder = Birth Year
account-shell-label-confirm-graph-delete =
    { $count ->
        [one] Are you sure you want to delete this graph?
       *[other] Are you sure you want to delete these graphs?
    }
account-shell-label-country-placeholder = Country
account-shell-label-created-days-ago = { $number } days ago
account-shell-label-created-hours-ago = { $number } hours ago
account-shell-label-created-last-week = last week
account-shell-label-created-minutes-ago = { $number } minutes ago
account-shell-label-created-on-date = { $month } { $day }, { $year }
account-shell-label-created-one-hour-ago = one hour ago
account-shell-label-created-one-minute-ago = one minute ago
account-shell-label-created-seconds-ago = less than a minute ago
account-shell-label-created-weeks-ago = { $number } weeks ago
account-shell-label-created-yesterday = yesterday
account-shell-label-email-address = Email Address
account-shell-label-email-placeholder = email@example.com
account-shell-label-export-size-large-rectangle = Large Rectangle
account-shell-label-export-size-large-square = Large Square
account-shell-label-export-size-medium-rectangle = Medium Rectangle
account-shell-label-export-size-medium-square = Medium Square
account-shell-label-export-size-small-square = Small Square
account-shell-label-feature-flag-actions = Actions
account-shell-label-feedback = Feedback
account-shell-label-feedback-email = Email address so we can respond! (optional)
account-shell-label-feedback-message = Questions? Feedback?
account-shell-label-feedback-placeholder = Write to us!
account-shell-label-feedback-sending = Sending...
account-shell-label-graph-actions = Graph actions
account-shell-label-graph-title = Title
account-shell-label-help = Help
account-shell-label-help-menu = Help Menu
account-shell-label-language = Language
account-shell-label-loading = Loading...
account-shell-label-log-in-and-save = Log in and save
account-shell-label-math-art-expo = Math Art Expo
account-shell-label-month-apr = Apr
account-shell-label-month-aug = Aug
account-shell-label-month-dec = Dec
account-shell-label-month-feb = Feb
account-shell-label-month-jan = Jan
account-shell-label-month-jul = Jul
account-shell-label-month-jun = Jun
account-shell-label-month-mar = Mar
account-shell-label-month-may = May
account-shell-label-month-nov = Nov
account-shell-label-month-oct = Oct
account-shell-label-month-sep = Sep
account-shell-label-mygraphs-example = example
account-shell-label-mygraphs-last-edited = Last Edited
account-shell-label-mygraphs-last-saved = last saved: { $date }
account-shell-label-mygraphs-no-unsaved-changes = no unsaved changes
account-shell-label-mygraphs-unsaved-graph = unsaved graph
account-shell-label-no-unsaved-changes = No Unsaved Changes
account-shell-label-open-graph-mac = { $open_graph } (cmd+o)
account-shell-label-open-graph-pc = { $open_graph } (ctrl+o)
account-shell-label-save-changes-mac = Save Changes (cmd+s)
account-shell-label-save-changes-pc = Save Changes (ctrl+s)
account-shell-label-save-graph-before-share = Save this graph before sharing
account-shell-label-saving-graph = Saving graph...
account-shell-label-share = share
account-shell-label-share-construction = Share Construction
account-shell-label-share-graph = Share Graph
account-shell-label-share-link = Share this link:
account-shell-label-share-your-save = Share Your Save
account-shell-label-share-your-snapshot = Share a Snapshot
account-shell-label-submission-already-received = Your Submission
account-shell-label-submission-already-received-with-email = Submitted using <1>{$v0}</1>. You can edit your submission anytime before <2>January 15th, 2025</2>. Learn more at <3>desmos.com/art</3>.
account-shell-label-submission-received = Submission Received!
account-shell-label-submitting = Submitting...
account-shell-label-success = Success
account-shell-label-tool-menu = Tool Options Menu
account-shell-label-tools = Tools
account-shell-label-try-a-quest-title = Try a Quest
account-shell-label-zoom = Zoom: { $value }%
account-shell-link-account-settings = Account Settings
account-shell-link-download-chrome = Click here to download Google Chrome.
account-shell-link-email-support = Email Our Support Team
account-shell-link-help = Help
account-shell-link-help-center = Help Center
account-shell-link-keyboard-shortcuts = Keyboard Shortcuts
account-shell-link-learn-more = Learn More
account-shell-link-privacy = Privacy Policy
account-shell-link-read-blog = Read our blog
account-shell-link-send-feedback = Send Feedback and Questions
account-shell-link-sign-out = Sign Out
account-shell-link-terms = Terms of Service
account-shell-link-try-a-quest = Try a quest
account-shell-link-try-next-quest = Try another
account-shell-link-user-guide = User Guide
account-shell-narration-delete-selected-graphs = Delete selected graphs
account-shell-narration-deselect-all-graphs = Deselect all graphs
account-shell-narration-edit-selected-country = Edit Selected Country
account-shell-narration-edit-selected-year = Edit Selected Year
account-shell-narration-example-gallery-filter = Example Gallery Filter
account-shell-narration-graph-options = Options for { $graphTitle }
account-shell-narration-graph-preview = Graph Preview
account-shell-narration-language-menu = Language Options Menu
account-shell-narration-my-graphs-close-search = Close Search
account-shell-narration-my-graphs-layout = Graph Layout
account-shell-narration-my-graphs-modal = My Graphs
account-shell-narration-my-graphs-search = Search Graphs
account-shell-narration-mygraphs-open-graph = Open graph
account-shell-narration-new-graph-options = New Graph Options
account-shell-narration-saved-graphs-options = Saved Graphs Options
account-shell-narration-selected-graphs-options = Selected graphs options
account-shell-narration-share-options = Share Options
account-shell-text-3d-expression-list-notice = Please share any bugs, questions, or suggestions at: <1>feedback@desmos.com</1>
account-shell-text-advanced-preferences-instructions = Try these advanced features. Feel free to send any questions or feedback to support@desmos.com.
account-shell-text-art-contest-copyright-agreement = I pledge that this (a) is my original work and (b) isn't based on copyrighted material.
account-shell-text-art-contest-create-construction-notice = Create a new construction or open one of your constructions to participate in the art expo.
account-shell-text-art-contest-create-graph-notice = Create a new graph or open one of your graphs to participate in the art expo.
account-shell-text-art-contest-deadline-notice = Submissions are open until January 15th.
account-shell-text-art-contest-has-arrived = Have a graph that you're proud of? We'd love to see it! Learn more at <1>desmos.com/art<2> (opens in new tab)</2></1>.
account-shell-text-art-contest-has-arrived-construction = Have a construction that you're proud of? We'd love to see it! Learn more at <1>desmos.com/art<2> (opens in new tab)</2></1>.
account-shell-text-art-contest-has-closed = Submissions are now closed. Check out <1>desmos.com/art<2> (opens in new tab)</2></1> for announcements about the 2024 featured graph gallery.
account-shell-text-art-contest-last-year-link = See your submission from last year:
account-shell-text-art-contest-legal-disclaimer = By submitting this graph, you agree to the terms of the 2024 Desmos Studio Art Expo, and agree that we can share your submission publicly.
account-shell-text-art-contest-loading-submissions = Loading your submissions...
account-shell-text-art-contest-notice-non-participant = <1/> <2>Join the 2024 Art Expo</2> <3/><4/>Do you have a graph that you're proud of? We'd love to see it!
account-shell-text-art-contest-notice-participant = <1><2/></1><3>Great work in last year's Art Expo\u2014<4>join this year's too</4>! <5/></3>
account-shell-text-art-contest-someone-else-artist-statement = Participant's Artist Statement
account-shell-text-art-contest-someone-else-artist-statement-description = In 2-3 sentences, please have the participant tell us what they learned about math, Desmos, or themselves as they worked on their entry.
account-shell-text-art-contest-someone-else-birth-year = Participant's Birth Year
account-shell-text-art-contest-someone-else-copyright-agreement = I pledge that (a) I am 18 or older and legally allowed to submit on behalf of this participant and that this (b) is original work and (c) isn't based on copyrighted material.
account-shell-text-art-contest-someone-else-country = Participant's Country
account-shell-text-art-contest-someone-else-email = Adult's (Your) Email
account-shell-text-art-contest-someone-else-name = Participant's Name
account-shell-text-art-contest-submit-construction = Submit your current construction
account-shell-text-art-contest-submit-graph = Submit your current graph
account-shell-text-art-contest-success-paragraph-someone-else = Submitted for <1>{$v0}</1> by <2>{$v1}</2>. You can delete and resubmit any time before <3>January 15th, 2025</3>. Learn more at <4>desmos.com/art</4>.
account-shell-text-art-contest-view-or-update-submission = View or change your submission
account-shell-text-art-contest-view-submission = View your submission
account-shell-text-art-contest-your-2d-submission = View your graphing calculator submission
account-shell-text-art-contest-your-3d-submission = View your 3D submission
account-shell-text-art-contest-your-geometry-submission = View your geometry submission
account-shell-text-artcontest-ineligible = <1><2>Based on the provided age, we aren\u2019t able to accept this graph submission this year.</2><3>Keep up the awesome graphing! There will be new contests every year.</3></1>
account-shell-text-artcontest-someone-else = <1><2>Based on your age and location, you need a teacher, parent, or guardian over the age of 18 to submit your graph for you.</2><3>Here is the link to your graph: </3><graphlink/><4>Please share it with one of them and have them submit it at <5>desmos.com/art</5>.</4></1>
account-shell-text-authenticate-notice = <1>Log in</1> or <2>sign up</2> to save your beautiful math!
account-shell-text-confirm-leave = Are you sure you want to leave this graph? Your unsaved work will be lost.
account-shell-text-construction-cleared = Construction cleared.
account-shell-text-continue-with-quest = ...or <1>keep playing with this quest</1>.
account-shell-text-copy-of-title = [Copy of] { $originalTitle }
account-shell-text-download-instructions = To download, right click on the image of the graph select "Save As." You might also be able to click and drag the image onto your desktop.
account-shell-text-embossing-etc-print = Set paper size to { $size }. Then click "Edit" and select File > Emboss.
account-shell-text-embossing-etc-save = Save this image. Open Firebird, select File > Open > Image File, and open the image.
account-shell-text-embossing-vpmax-print = Right click image and select "print". Set paper size to { $size }.
account-shell-text-embossing-vpmax-save = Right click graph image and save to desktop.
account-shell-text-error = error
account-shell-text-error-loading-geometry-state = Error loading construction
account-shell-text-example-gallery-2d = 2D Example Gallery
account-shell-text-example-gallery-3d = 3D Example Gallery
account-shell-text-example-gallery-description-2d = Investigate the behavior of functions, patterns in data, and so much more with the Graphing Calculator.
account-shell-text-example-gallery-description-3d = Explore curves, surfaces, and points in all three dimensions.
account-shell-text-example-gallery-description-geometry = Work with transformations and other dynamic constructions in the Geometry Tool.
account-shell-text-example-gallery-geometry = Geometry Example Gallery
account-shell-text-feature-flag-actions-description = Make graphs interactive by defining rules for responding to clicks or to the passage of time.
account-shell-text-feedback-sent = Thank you! We'll be in touch soon.
account-shell-text-graph-cleared = Graph cleared.
account-shell-text-graph-migrated-from-geometry = '{ $title }' was auto-migrated from the old geometry tool.
account-shell-text-logged-in = Logged in successfully!
account-shell-text-login-window-blocked-apple = Login window blocked. Please allow popups from desmos.com to sign in with Apple
account-shell-text-login-window-blocked-google = Login window blocked. Please allow popups from desmos.com to sign in with Google.
account-shell-text-maintenance-mode = Desmos is currently undergoing maintenance.
account-shell-text-my-graphs-folder-items = { $count } items
account-shell-text-mygraphs-attempting-recovery = Attempting recovery...
account-shell-text-mygraphs-contest-submit-to-contest = <1>Submit this graph to the <2>Art Expo</2>!</1>
account-shell-text-mygraphs-count-more = { $count } more...
account-shell-text-mygraphs-current-construction = Current Construction
account-shell-text-mygraphs-current-graph = Current Graph
account-shell-text-mygraphs-currently-open = Currently open
account-shell-text-mygraphs-deleting = Deleting...
account-shell-text-mygraphs-examples-2d = 2D Examples
account-shell-text-mygraphs-examples-3d = 3D Examples
account-shell-text-mygraphs-examples-geometry = Geometry Examples
account-shell-text-mygraphs-load-more = Load more
account-shell-text-mygraphs-loading = Loading...
account-shell-text-mygraphs-lost-work = Lost work?
account-shell-text-mygraphs-new-blank-graph = New Blank Graph
account-shell-text-mygraphs-new-construction = New Blank Construction
account-shell-text-mygraphs-no-construction-search-results = No saved constructions match your search.
account-shell-text-mygraphs-no-examples-match-search = No examples match your search.
account-shell-text-mygraphs-no-graph-search-results = No saved graphs match your search.
account-shell-text-mygraphs-no-saved-constructions = No saved constructions yet.
account-shell-text-mygraphs-no-saved-graphs = No saved graphs yet.
account-shell-text-mygraphs-no-unsaved-constructions = Couldn't find any unsaved constructions.
account-shell-text-mygraphs-no-unsaved-graphs = Couldn't find any unsaved graphs.
account-shell-text-mygraphs-opened-graph = Opened '{ $graphTitle }'
account-shell-text-mygraphs-or = or
account-shell-text-mygraphs-search-by-title = Search by title
account-shell-text-mygraphs-to-save-constructions = to save your constructions!
account-shell-text-mygraphs-to-save-graphs = to save your graphs!
account-shell-text-mygraphs-version = Version
account-shell-text-new-construction-created = New construction created.
account-shell-text-new-graph-created = New graph created.
account-shell-text-or = or
account-shell-text-saved = saved
account-shell-text-share-menu-log-in-prompt = Log in to save so others can see your future edits.
account-shell-text-share-menu-my-graph-description = <1>Note</1>: No one but you can edit this graph, but other people will see your updates.
account-shell-text-share-menu-quick-link = or <1>generate a snapshot</1>.
account-shell-text-share-menu-saved-snapshot-description = <1>Note</1>: You can't edit or delete a graph that is shared as a snapshot. If you want to come back to it, <2>share your save</2> instead.
account-shell-text-share-menu-unsaved-snapshot-description = <1>Note</1>: You can't edit or delete a graph that is shared as a snapshot. <2>Save this graph</2> before sharing if you want to come back to it.
account-shell-text-unsupported-browser-android = Desmos works best on your version of Android if you use the Chrome Browser.
account-shell-text-untitled = Untitled
account-shell-text-untitled-folder = Untitled Folder
account-shell-text-untitled-graph = Untitled Graph
account-shell-text-welcome-to-3d = Welcome to Desmos 3D (Beta)
shared-button-back = Back
shared-button-cancel = Cancel
shared-button-change-email-address = Change email address
shared-button-change-email-and-password = Change email and password
shared-button-close-dialog = Close Dialog
shared-button-close-message = Close Message
shared-button-confirm-name = Confirm Name
shared-button-continue-to-desmos = Continue to Desmos
shared-button-delete-account-question = Delete your Desmos account?
shared-button-fun-classification = I'm here for fun
shared-button-hide-password = Hide Password
shared-button-learn-more-capitalized = Learn More
shared-button-login-capitalized = Log In
shared-button-next = Next
shared-button-non-education-classification = I work outside of education
shared-button-recover-password = Recover Password
shared-button-save = Save
shared-button-send-delete-account-email = Send Delete Account Email
shared-button-send-email = Send Email
shared-button-show-password = Show Password
shared-button-sign-up = Sign Up
shared-button-student-classification = I'm a student
shared-button-teacher-classification = I'm an educator
shared-button-try-again = Didn't work? Try again!
shared-calculator-button-braille-mode-nemeth = Nemeth
shared-calculator-button-braille-mode-ueb = UEB
shared-calculator-button-clear = clear
shared-calculator-button-go = Go
shared-calculator-button-hide-options = Hide Options
shared-calculator-button-mac = Mac Shortcuts
shared-calculator-button-settings-toolbar-show-all = All
shared-calculator-button-settings-toolbar-show-custom = Custom
shared-calculator-button-settings-toolbar-show-none = None
shared-calculator-button-show-options = Show Options
shared-calculator-button-windows-chrome = Windows / ChromeOS Shortcuts
shared-calculator-error-3d-bad-equality-slice = We don't support this type of equality restriction.
shared-calculator-error-3d-length-type-error = Function '{ $fn }' cannot be applied to { $arg } in the 3d calculator. Use '{ $alternativeFn }' to find the number of elements in a list.
shared-calculator-error-3d-mixed-restriction-equation = Cannot apply both an inequality restriction and an equality restriction to this expression.
shared-calculator-error-3d-multiple-equality-restrictions = Cannot apply more than one equality restriction.
shared-calculator-error-3d-object-in-2d = This calculator cannot plot { $type }.
shared-calculator-error-action-merge-free-variable = Cannot combine an action that depends on free variable '{ $symbol }'.
shared-calculator-error-add-arguments-to-definition-many = Try including '{ $symbols }' and '{ $lastSymbol }' as arguments by defining the function as '{ $newSignature }'.
shared-calculator-error-add-arguments-to-definition-one = Try including '{ $lastSymbol }' as an argument by defining the function as '{ $newSignature }'.
shared-calculator-error-add-type-error = Cannot add { $symbol1 } and { $symbol2 }.
shared-calculator-error-adjacent-mixed-number = Sorry, I don't know what to do with mixed number '{ $mixedNumber }'. Try using a '*' symbol around it.
shared-calculator-error-adjacent-numbers = Sorry, I don't know what to do with adjacent numbers '{ $left }' and '{ $right }'. Try using parentheses or a '*' symbol.
shared-calculator-error-ans-undefined = The previous expression didn't define any value for ans.
shared-calculator-error-assignments-unsupported = This calculator does not support defining variables.
shared-calculator-error-bad-for-input-list-dependency = A definition on the right-hand side of 'for' can't depend on input variable '{ $symbol }'.
shared-calculator-error-bad-for-interval-dependency = Parameter bounds on the right-hand side of 'for' can't depend on input variable '{ $symbol }'.
shared-calculator-error-bad-implicit-call = Use parentheses around the argument of '{ $symbol }'.
shared-calculator-error-bad-integral-bound-dependency = Integration bounds can't depend on integration variable '{ $symbol }'.
shared-calculator-error-bad-interval-comprehension-arity =
    { $count ->
        [one] You can't use 'for' to parameterize { $type } using 1 parameter.
       *[other] You can't use 'for' to parameterize { $type } using { $count } parameters.
    }
shared-calculator-error-bad-log-exponent = Only { $form } is supported. Otherwise, use parens.
shared-calculator-error-bad-product-bound-dependency = Product bounds can't depend on product index '{ $symbol }'.
shared-calculator-error-bad-sample-size = Sample size must be a finite, non-negative number.
shared-calculator-error-bad-sum-bound-dependency = Summation bounds can't depend on summation index '{ $symbol }'.
shared-calculator-error-bad-symbol-context = You can't use '{ $symbol }' in this context.
shared-calculator-error-bad-trig-exponent = Only { $form1 } and { $form2 } are supported. Otherwise, use parens.
shared-calculator-error-bad-tuple-dimensions = Points may only have { $symbol } coordinates.
shared-calculator-error-binary-operator-missing-operand = You need something on both sides of the '{ $symbol }' symbol.
shared-calculator-error-blank-expression = You haven't written anything yet.
shared-calculator-error-boxplot-breadth-invalid = Invalid height. Try using any number.
shared-calculator-error-boxplot-offset-invalid = Invalid offset. Try using any number.
shared-calculator-error-cannot-assign-color = Cannot assign a color to '{ $variable }'.
shared-calculator-error-cannot-redefine = You can't redefine '{ $symbol }' because it's already defined.
shared-calculator-error-cannot-redefine-root = You can't define '{ $symbol }' because '{ $symbolRoot }' is already defined.
shared-calculator-error-cannot-restrict = Cannot create a restriction based on '{ $variable }' in this type of expression.
shared-calculator-error-cannot-restrict-triangles-with-list = Cannot use a list of restrictions on 3d triangles.
shared-calculator-error-cannot-restrict-with-equality = Cannot create an equality restriction based on '{ $variable }' in this type of expression.
shared-calculator-error-cannot-subscript = '{ $symbol }' cannot have a subscript.
shared-calculator-error-cant-combine-spherical-and-cylindrical = Can't combine spherical and cylindrical coordinates.
shared-calculator-error-cdf-max-invalid = Invalid cdf max. Try using any number.
shared-calculator-error-cdf-max-less-than-min = Invalid cdf limits. Min should be less than max.
shared-calculator-error-cdf-min-invalid = Invalid cdf min. Try using any number.
shared-calculator-error-cdf-too-many-arguments = 'cdf' should be called on a distribution with at most two numbers. { $recommendation }
shared-calculator-error-cdf-too-many-arguments-recommendation = For example, try typing: D.cdf(-1,1) where D=normaldist().
shared-calculator-error-cdf-wrong-arity = 'cdf' should be called on a distribution with at least one number. { $recommendation }
shared-calculator-error-cdf-wrong-arity-recommendation = For example, try typing: D.cdf(x) where D=normaldist().
shared-calculator-error-clickable-object-assignment-not-defined = "{ $symbol }" is not defined. Try using a different variable or adding a slider.
shared-calculator-error-clickable-object-assignment-not-identifier = Invalid symbol. Try using a single letter.
shared-calculator-error-clickable-object-invalid-expression = Can't evaluate this. Try a number or simple expression.
shared-calculator-error-colon-missing-condition = The left side of a ':' must be a condition, like 'x>1'.
shared-calculator-error-color-arity = '{ $symbol }' should be called with 3 arguments. { $recommendation }
shared-calculator-error-color-arity-recommendation = For example, try typing: { $recommendation }.
shared-calculator-error-color-not-assigned = To use a color, you must assign it to a variable.
shared-calculator-error-combine-type-error = Cannot combine { $symbol1 } and { $symbol2 }.
shared-calculator-error-comparator-type-error = Cannot compare { $symbol1 } to { $symbol2 }.
shared-calculator-error-complex-list-access = Indexing a list with a complex number is not well-defined.
shared-calculator-error-complex-operation-undefined = Note: '{ $symbol }' isn't well-defined for complex numbers.
shared-calculator-error-complex-operation-unimplemented = Note: '{ $symbol }' is not yet implemented for complex numbers.
shared-calculator-error-complex-point-coordinate = Points with complex coordinates are not supported.
shared-calculator-error-complex-round = Note: '{ $symbol }' with complex precision is not well-defined.
shared-calculator-error-complex-sort = Note: '{ $symbol }' uses lexicographic ordering for complex numbers.
shared-calculator-error-complex-table-point-coordinate = Only real-valued coordinate pairs can be plotted.
shared-calculator-error-complex-wirtinger-differs = The derivative of a non-holomorphic function is treated as the Wirtinger derivative.
shared-calculator-error-complicated-double-inequality = We only support solved double inequalities. Try deleting one side of the inequality.
shared-calculator-error-complicated-polar-implicit = Polar equations must be linear in r.
shared-calculator-error-constant-unsupported = This calculator does not support the constant '{ $symbol }'.
shared-calculator-error-coordinate-access-type-error = Cannot access coordinate '{ $coordinate }' of { $symbol }.
shared-calculator-error-custom-regressions-unsupported = This calculator does not support custom regressions.
shared-calculator-error-custom-toolbar-not-condition = Please write a valid condition and make sure every referenced variable is defined.
shared-calculator-error-deeply-nested = Definitions are nested too deeply.
shared-calculator-error-dependency-cycle = '{ $symbols }' and '{ $lastSymbol }' can't be defined in terms of each other.
shared-calculator-error-depends-on-deleted-geo-object = This depends on a geometric object that's no longer defined.
shared-calculator-error-derivative-missing-body = What do you want to take the derivative of?
shared-calculator-error-derivative-recursive-cycle = Cannot take the derivative of { $symbol1 } inside its own definition.
shared-calculator-error-derivative-type-error = Cannot take the derivative of { $symbol }.
shared-calculator-error-derivative-type-error-respect = Cannot take the derivative of { $symbol1 } with respect to { $symbol2 }.
shared-calculator-error-derivative-variable-type-error = Cannot take derivative with respect to '{ $symbol1 }' because it is { $symbol2 }.
shared-calculator-error-differential-with-superscript = Integration variable cannot have a superscript.
shared-calculator-error-distribution-as-function = Cannot call distribution '{ $symbol }' as a function. Try '{ $symbol }.pdf(x)'.
shared-calculator-error-divide-type-error = Cannot divide { $symbol1 } by { $symbol2 }.
shared-calculator-error-domain-max-invalid = Invalid domain max. Try using any number.
shared-calculator-error-domain-max-less-than-min = Invalid domain limits. Min should be less than max.
shared-calculator-error-domain-min-invalid = Invalid domain min. Try using any number.
shared-calculator-error-dot-lhs-constant-number = Sorry, I don't understand this use of '.' after a constant number.
shared-calculator-error-dot-lhs-type-error = Cannot call '.{ $symbol }' on { $type }.
shared-calculator-error-dot-rhs-property-error = '.{ $symbol }' cannot be followed by parentheses.
shared-calculator-error-duplicate-function-parameter = Cannot use '{ $dependency }' for multiple parameters of this function.
shared-calculator-error-duplicate-update-rules = An action cannot specify multiple update rules for '{ $symbol }'.
shared-calculator-error-empty-paren = Parentheses cannot be empty.
shared-calculator-error-empty-pipe = Absolute value symbol cannot be empty.
shared-calculator-error-empty-radical = Radical cannot be empty.
shared-calculator-error-empty-radical-index = Radical index cannot be empty.
shared-calculator-error-empty-square-bracket = Square brackets cannot be empty.
shared-calculator-error-empty-subscript = Subscripts cannot be empty.
shared-calculator-error-empty-superscript = Superscripts cannot be empty.
shared-calculator-error-equation-required = Try adding an equals sign to turn this into an equation.
shared-calculator-error-equation-required-symbol = Try adding '{ $lhs }' to the beginning of this equation.
shared-calculator-error-equations-unsupported = This calculator does not support this type of equation.
shared-calculator-error-event-handler-type-error = This should be an action. Try '{ $example }'.
shared-calculator-error-exponent-type-error = Cannot raise { $symbol1 } to { $symbol2 }.
shared-calculator-error-feature-unavailable = This feature is not available in the current calculator.
shared-calculator-error-fraction-empty = You need a numerator and denominator for your fraction.
shared-calculator-error-fraction-missing-denominator = You need a denominator for the bottom of your fraction.
shared-calculator-error-fraction-missing-numerator = You need a numerator for the top of your fraction.
shared-calculator-error-function-definition-unsupported = This calculator does not support function definitions.
shared-calculator-error-function-name-as-parameter = Cannot use function name '{ $dependency }' as a function parameter.
shared-calculator-error-function-not-defined = Function '{ $dependency }' is not defined.
shared-calculator-error-function-only-works-in-complex = The '{ $symbol }' function is only available in complex mode.
shared-calculator-error-function-type-error-1 = Function '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-function-type-error-2 = Function '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-function-type-error-many = Function '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-function-unsupported = This calculator does not support the '{ $symbol }' function.
shared-calculator-error-geometry-length-type-error = Function '{ $fn }' cannot be applied to { $arg } in the geometry calculator. Use '{ $alternativeFn }' to find the number of elements in a list.
shared-calculator-error-gpu-expression-too-complex = We encountered a GPU error while plotting this expression.
shared-calculator-error-gpu-function-unsupported = Cannot use the '{ $symbol }' function here.
shared-calculator-error-gpu-integral-unsupported = Cannot use integrals here.
shared-calculator-error-gpu-long-product = Products may not have more than { $maxTermCount } terms here.
shared-calculator-error-gpu-long-sum = Sums may not have more than { $maxTermCount } terms here.
shared-calculator-error-gpu-max-list-size = Lists may not have more than { $maxListSize } elements here.
shared-calculator-error-gpu-recursion-unsupported = Cannot use recursive functions here.
shared-calculator-error-gpu-variable-list-length = List length cannot depend on variable '{ $symbol }' here.
shared-calculator-error-gpu-variable-product = Product bound cannot depend on variable '{ $symbol }' here.
shared-calculator-error-gpu-variable-sum = Sum bound cannot depend on variable '{ $symbol }' here.
shared-calculator-error-heterogeneous-list = All elements of a list must have the same type.
shared-calculator-error-identifier-as-function = '{ $symbol }' is a function. Try using parentheses.
shared-calculator-error-identifier-is-not-function = '{ $symbol }' is not a function. Try defining it as '{ $symbol }(x) = x^2' instead.
shared-calculator-error-illegal-bin-width = The second argument to '{ $symbol }' must be a positive number.
shared-calculator-error-illegal-dot-call = Function '{ $symbol }' cannot be called with dot notation.
shared-calculator-error-implicits-disabled = Plotting implicit equations and inequalities is disabled.
shared-calculator-error-incorrect-list-comprehension-input = Definitions on the right-hand side of 'for' must set a variable equal to a list. Try i=[1...10].
shared-calculator-error-incorrect-product-lower-bound = Lower bound of a product must set a variable equal to a number. Try n=1.
shared-calculator-error-incorrect-sum-lower-bound = Lower bound of a sum must set a variable equal to a number. Try n=1.
shared-calculator-error-index-type-error = Cannot index { $symbol1 } with { $symbol2 }.
shared-calculator-error-inequalities-disabled = Plotting inequalities is disabled.
shared-calculator-error-inequalities-unsupported = This calculator does not support inequalities.
shared-calculator-error-integral-argument-type-error = Cannot take the integral of { $symbol }.
shared-calculator-error-integral-lower-bound-type-error = Lower bound of an integral cannot be { $symbol }.
shared-calculator-error-integral-missing-body = What do you want to take the integral of?
shared-calculator-error-integral-missing-bound = Integrals must have upper and lower bounds.
shared-calculator-error-integral-missing-differential = Integrand must end with an integration variable, like dx.
shared-calculator-error-integral-upper-bound-type-error = Upper bound of an integral cannot be { $symbol }.
shared-calculator-error-internal-error = [internal] { $msg }
shared-calculator-error-invalid-dependent-first-table-column = This column header can't be defined elsewhere in the calculator.
shared-calculator-error-invalid-double-equality-3d = Sorry, we only plot double equalities that contain z. Try adding 0*z to one side.
shared-calculator-error-invalid-double-inequality-3d = We only plot double inequalities of x, y, and z.
shared-calculator-error-invalid-double-inequality-variables = We only plot double inequalities of x and y.
shared-calculator-error-invalid-first-table-column = First column may not be { $most } or { $last }.
shared-calculator-error-invalid-half-empty-range = Range must have an upper and lower bound.
shared-calculator-error-invalid-implicit-variables = We only support implicit equations of x and y.
shared-calculator-error-invalid-implicit-variables-3d = We only support implicit equations of x, y, and z.
shared-calculator-error-invalid-inequality-variables = We only plot inequalities of x and y, or r and \u03B8.
shared-calculator-error-invalid-interval-comprehension-invalid-bound = Parameter bounds on the right-hand side of 'for' must be of the form '0<{ $identifier }<1'.
shared-calculator-error-invalid-interval-comprehension-return-type = You can't use 'for' to parameterize { $type }.
shared-calculator-error-invalid-lhs = Sorry, you can't graph { $symbol } as a function of anything yet.
shared-calculator-error-invalid-operator-name = Operator names may only contain letters.
shared-calculator-error-invalid-regression-parameter = '{ $symbol }' may not be used as a regression parameter. Try using a different variable name.
shared-calculator-error-invalid-subscript = Subscripts may only contain letters and digits. '{ $symbol }' is not allowed.
shared-calculator-error-invalid-table-entry = Table entries must be simple expressions. { $supplement }
shared-calculator-error-invalid-table-header = Table headers must be simple expressions. { $supplement }
shared-calculator-error-list-comprehension-input-type-error = A definition on the right-hand side of 'for' must be a list, but { $identifier } is { $actual }. Try { $identifier }={ $example }.
shared-calculator-error-list-type-error = Cannot store { $symbol1 } in a list.
shared-calculator-error-log-scale-box-plot = Cannot plot a box plot on a log scale.
shared-calculator-error-log-scale-dot-plot = Cannot plot a dot plot on a log scale.
shared-calculator-error-log-scale-histogram = Cannot plot a histogram on a log scale.
shared-calculator-error-log-scale-type-error = Cannot plot { $symbol } on a log scale.
shared-calculator-error-logbase-unsupported = This calculator does not support specifying the base of a logarithm. Try 'log' or 'ln'.
shared-calculator-error-malformed-list = Lists are written like this: [1, 2, 3].
shared-calculator-error-malformed-point = Points are written like this: (1, 2).
shared-calculator-error-matrix-add-dimensions = Cannot add matrices with different dimensions.
shared-calculator-error-matrix-assignment = This calculator does not support this type of variable definition. Try using 'New Matrix'.
shared-calculator-error-matrix-element-type-error = Cannot use { $arg } as an element of a matrix.
shared-calculator-error-matrix-fractional-power = A matrix can only be raised to integer powers.
shared-calculator-error-matrix-invalid-variable = Cannot use '{ $symbol }' as a variable.
shared-calculator-error-matrix-multiply-dimensions = Cannot multiply matrices with incompatible dimensions.
shared-calculator-error-matrix-power-dimensions = Only square matrices can be raised to a power.
shared-calculator-error-matrix-subtract-dimensions = Cannot subtract matrices with different dimensions.
shared-calculator-error-max-list-size = Lists may not have more than { $maxListSize } elements.
shared-calculator-error-method-requires-list = '{ $symbol }' requires a list. For example, try typing: { $recommendation }.
shared-calculator-error-mismatched-braces = Expected '{ $symbol1 }' to match '{ $symbol2 }'.
shared-calculator-error-mismatched-double-inequality = Double inequalities must both go the same way, e.g. { $example }.
shared-calculator-error-mixed-comparator-chain = Cannot mix inequalities and equations in a chain of comparisons.
shared-calculator-error-multiply-defined = You've defined '{ $dependency }' in more than one place. Try deleting some of the definitions of '{ $dependency }'.
shared-calculator-error-multiply-type-error = Cannot multiply { $symbol1 } by { $symbol2 }.
shared-calculator-error-multiply-type-error-2d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2) * (2, 1).
shared-calculator-error-multiply-type-error-3d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2, 3) cross (2, 1, 0).
shared-calculator-error-multiply-type-error-cross = Cannot take the cross product of { $symbol1 } and { $symbol2 }.
shared-calculator-error-negative-type-error = Cannot negate { $symbol }.
shared-calculator-error-nested-interval-comprehension = You can't yet use 'for' to introduce a new parameter to an already parameterized point.
shared-calculator-error-non-arithmetic-range = Ranges must be arithmetic sequences.
shared-calculator-error-non-list-double-reducer = Both arguments of '{ $symbol }' must be lists. For example, try typing: { $recommendation }.
shared-calculator-error-non-list-parameterized-reducer = The first argument of '{ $symbol }' must be a list. For example, try typing: { $recommendation }.
shared-calculator-error-non-singular-inverse = Singular matrices do not have an inverse.
shared-calculator-error-non-square-determinant = Only square matrices have a determinant.
shared-calculator-error-non-square-inverse = Only square matrices have an inverse.
shared-calculator-error-non-square-trace = Only square matrices have a trace.
shared-calculator-error-operator-type-error = Cannot apply { $symbol } to { $symbol1 } and { $symbol2 }.
shared-calculator-error-optimization-error = We couldn't find any region where this model is defined.
shared-calculator-error-parameter-already-defined = You can't use '{ $dependency }' as a parameter of this function because '{ $dependency }' is already defined.
shared-calculator-error-parse-error = Sorry, I don't understand this.
shared-calculator-error-pdf-wrong-arity = 'pdf' should be called on a distribution with a number. { $recommendation }
shared-calculator-error-pdf-wrong-arity-recommendation = For example, try typing: D.pdf(x) where D=normaldist().
shared-calculator-error-percent-missing-of = '%' must be used with 'of'. Try '25% of 12'.
shared-calculator-error-piecewise-branch-type-error = Cannot use { $symbol1 } and { $symbol2 } as the branches in a piecewise. Every branch must have the same type.
shared-calculator-error-piecewise-condition-type-error = The condition in a piecewise expression must be { $symbol1 } but was { $symbol2 }.
shared-calculator-error-piecewise-missing-condition = A piecewise expression must have at least one condition.
shared-calculator-error-piecewise-part-missing-condition = Every part of a piecewise expression must have a condition except the last.
shared-calculator-error-point-type-error = Cannot use { $symbol1 } as a coordinate of { $symbol2 }.
shared-calculator-error-points-unsupported = This calculator does not support points.
shared-calculator-error-polygon-unsupported-in-3d = This calculator does not support the 'polygon' function. Try 'triangle' instead.
shared-calculator-error-prime-variable-type-error = Cannot take derivative of '{ $symbol1 }' with respect to { $symbol2 }.
shared-calculator-error-prime-without-paren = Primed function calls must use parentheses.
shared-calculator-error-primed-function-arity = Prime notation can only be used for functions of a single argument.
shared-calculator-error-product-argument-type-error = Cannot take the product of { $symbol }.
shared-calculator-error-product-infinite-bound-type-error = Product bounds must be finite numbers.
shared-calculator-error-product-lower-bound-type-error = Lower bound of a product cannot be { $symbol }.
shared-calculator-error-product-missing-body = What do you want to take the product of?
shared-calculator-error-product-missing-bound = Products must have upper and lower bounds.
shared-calculator-error-product-upper-bound-type-error = Upper bound of a product cannot be { $symbol }.
shared-calculator-error-random-arity = 'random' should be called with no arguments, or an optional number of samples. For example, try random() or random(10).
shared-calculator-error-random-from-broadcast-distribution = Cannot sample from a list of distributions
shared-calculator-error-recursion-argument-type = Expected argument { $index } to be { $expectedType } but found { $foundType }.
shared-calculator-error-recursion-base-case-argument-non-number = Base case arguments must be simple numbers. Try using piecewise syntax.
shared-calculator-error-recursion-base-case-free-variable = This recursion's base case can't depend on variable '{ $freeVariable }'.
shared-calculator-error-recursion-base-case-same-type = Base cases must all have the same return type.
shared-calculator-error-recursion-base-case-too-complicated = For a recursion with multiple parameters, try using piecewise syntax.
shared-calculator-error-recursion-depth-limit-exceeded = Recursive depth limit exceeded without reaching a base case.
shared-calculator-error-recursion-does-not-terminate = This recursion doesn't reach a base case.
shared-calculator-error-recursion-missing-base-case =
    { $count ->
        [one] The definition of function '{ $lastSymbol }' depends on itself. If '{ $lastSymbol }' is meant to be a recursive function, try adding a valid base case.
       *[other] The definitions of functions '{ $symbols }' and '{ $lastSymbol }' depend on each other. If they are meant to be mutually recursive functions, try adding a valid base case.
    }
shared-calculator-error-recursion-wrong-arity =
    { $count ->
        [one] Function '{ $fnSymbol }' requires 1 argument.
       *[other] Function '{ $fnSymbol }' requires { $count } arguments.
    }
shared-calculator-error-regression-recursion = Recursive functions may not be used inside regressions.
shared-calculator-error-regression-type-error = Cannot regress { $symbol1 } against { $symbol2 }.
shared-calculator-error-regressions-unsupported = This calculator does not support regressions.
shared-calculator-error-required-arguments-area = Function '{ $symbol }' requires a polygon.
shared-calculator-error-required-arguments-circle = Function 'circle' requires a center point and another point, segment, or radius value.
shared-calculator-error-required-arguments-coterminal = Function '{ $symbol }' requires an angle.
shared-calculator-error-required-arguments-dilate = Function '{ $symbol }' requires an object, then a point and a number.
shared-calculator-error-required-arguments-glider = Function 'glider' requires an object, then a number.
shared-calculator-error-required-arguments-intersection = Function 'intersection' requires 2 objects (lines, circles, or arcs).
shared-calculator-error-required-arguments-length = Function 'length' requires a segment.
shared-calculator-error-required-arguments-midpoint = Function 'midpoint' requires a segment or 2 points.
shared-calculator-error-required-arguments-perpendicular = Function '{ $symbol }' requires a line and a point.
shared-calculator-error-required-arguments-points = Function '{ $symbol }' requires { $count } points.
shared-calculator-error-required-arguments-polygon = Function 'polygon' requires several points.
shared-calculator-error-required-arguments-radius = Function '{ $symbol }' requires a circle or arc.
shared-calculator-error-required-arguments-reflect = Function 'reflect' requires an object, then a line, segment, ray, or vector.
shared-calculator-error-required-arguments-sphere = Function 'sphere' requires a center point and a radius value.
shared-calculator-error-required-arguments-start = Function '{ $symbol }' requires a vector.
shared-calculator-error-required-arguments-supplement = Function 'supplement' requires a directed angle.
shared-calculator-error-required-arguments-translate = Function 'translate' requires an object, then 2 points or a vector.
shared-calculator-error-required-arguments-triangle = Function 'triangle' requires three 3d points.
shared-calculator-error-required-arguments-vector = Function 'vector' requires a start point and end point.
shared-calculator-error-self-referential-base-case = A base case for recursive function '{ $symbol }' cannot depend on '{ $symbol }'.
shared-calculator-error-self-referential-functions =
    { $count ->
        [one] The definition of function '{ $lastSymbol }' depends on itself.
       *[other] The definitions of functions '{ $symbols }' and '{ $lastSymbol }' depend on each other.
    }
shared-calculator-error-self-referential-suggest-alternative = '{ $symbol }' cannot be defined recursively. Try renaming this function.
shared-calculator-error-shadowed-index = You can't use '{ $symbol }' as an index because it's already defined.
shared-calculator-error-shadowed-integration-variable = You can't use '{ $symbol }' as an integration variable because it's already defined.
shared-calculator-error-shadowed-list-comprehension-input = You can't define '{ $symbol }' more than once on the right-hand side of 'for'.
shared-calculator-error-single-variable-implicit-equations-disabled = Plotting single-variable implicit equations is disabled.
shared-calculator-error-slider-limit-references-export = Slider limits cannot depend on the slider variable '{ $symbol }'.
shared-calculator-error-slider-max-invalid = Invalid slider max. Try using any number.
shared-calculator-error-slider-max-less-than-min = Invalid slider limits. Min should be less than max.
shared-calculator-error-slider-min-invalid = Invalid slider min. Try using any number.
shared-calculator-error-slider-step-invalid = Invalid slider step. Try using any number.
shared-calculator-error-slow-evaluation = This is taking a long time to evaluate. Try editing or deleting this expression.
shared-calculator-error-substitution-ambiguous-comma = Ambiguous use of ',' and '{ $operation }'. Add parentheses around the '{ $operation }' expression.
shared-calculator-error-substitution-body-action = The left hand side of a 'with' substitution cannot be an action.
shared-calculator-error-substitution-body-regression-parameter-dependency = Can't use '{ $operator }' to substitute for the existing variable '{ $globalVariable }' because the expression on the left-hand side depends on '{ $regressionParameter }', which is a regression parameter.
shared-calculator-error-substitution-duplicate-assignment = A 'with' expression cannot make multiple substitutions for '{ $symbol }'.
shared-calculator-error-substitution-function-lhs = Substituting for '{ $symbol }' is not allowed because it is a function.
shared-calculator-error-substitution-illegal-lhs = Substituting for '{ $symbol }' is not allowed.
shared-calculator-error-substitution-invalid-assignments = 'with' must be followed by one or more variable definitions.
shared-calculator-error-substitution-local-lhs = Substituting for variable '{ $symbol }' is not allowed because it is locally defined.
shared-calculator-error-substitution-nested = Using one 'with' expression inside another 'with' expression is not allowed.
shared-calculator-error-substitution-recursive-call-lhs = Can't use '{ $operator }' to substitute for the existing variable '{ $globalVariable }' because the expression on the left-hand side depends on a recursive function call to '{ $fnSymbol }'.
shared-calculator-error-substitution-type-error = Cannot substitute { $actual } for { $expected }.
shared-calculator-error-substitution-unsupported-interval = Intervals are not allowed on the right-hand side of 'with'. You might want to try using 'for' instead.
shared-calculator-error-subtract-type-error = Cannot subtract { $symbol2 } from { $symbol1 }.
shared-calculator-error-sum-argument-type-error = Cannot take the sum of { $symbol }.
shared-calculator-error-sum-infinite-bound-type-error = Summation bounds must be finite numbers.
shared-calculator-error-sum-lower-bound-type-error = Lower bound of a sum cannot be { $symbol }.
shared-calculator-error-sum-missing-body = What do you want to take the sum of?
shared-calculator-error-sum-missing-bound = Sums must have upper and lower bounds.
shared-calculator-error-sum-upper-bound-type-error = Upper bound of a sum cannot be { $symbol }.
shared-calculator-error-superscript-with-prime = Superscripts and primes cannot be combined.
shared-calculator-error-table-entry-type-error = Table entry cannot be { $symbol }.
shared-calculator-error-table-equation-supplement = Equations are not allowed.
shared-calculator-error-table-function-definition-supplement = Function definitions are not allowed.
shared-calculator-error-table-generic-supplement = This type of expression is not allowed.
shared-calculator-error-table-header-type-error = Table header cannot be { $symbol }.
shared-calculator-error-table-inequality-supplement = Inequalities are not allowed.
shared-calculator-error-table-list-supplement = Lists are not allowed.
shared-calculator-error-table-regression-invalid-data = There's an error in the provided data.
shared-calculator-error-table-regression-invalid-export-identifier = The headers need to be simple identifiers to export as a custom regression. Try assigning { $latex } to a variable and then referencing it in the table header.
shared-calculator-error-table-regression-log-with-negative = Logarithmic regressions only work if the first column is all positive numbers.
shared-calculator-error-table-regression-supplement = Regressions are not allowed.
shared-calculator-error-table-regression-type-error = The data contains { $symbol }.
shared-calculator-error-tdist-wrong-arity = 'tdist' requires 1 argument. For example, try typing: tdist(1).
shared-calculator-error-ticker-min-step-nonnegative = Min step must evaluate to a non-negative number.
shared-calculator-error-token-with-subscript = Tokens may not have subscripts.
shared-calculator-error-too-many-arguments = '{ $symbol }' accepts at most { $max } arguments.
shared-calculator-error-too-many-variables-many-symbols = Too many variables. Try defining '{ $variables }' or '{ $lastVariable }'.
shared-calculator-error-too-many-variables-no-symbols = Too many variables, I don't know what to do with this.
shared-calculator-error-too-many-variables-one-symbol = Too many variables. Try defining '{ $variable }'.
shared-calculator-error-transformation-definition-expected-types-1 = Try using { $arg }.
shared-calculator-error-transformation-definition-expected-types-2 = Try using { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-definition-expected-types-use-fewer-1 = Try using just { $arg }.
shared-calculator-error-transformation-definition-expected-types-use-fewer-2 = Try using just { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-definition-type-error-1 = A { $fn } cannot be defined using { $arg }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-2 = A { $fn } cannot be defined using { $arg1 } and { $arg2 }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-many = A '{ $fn }' cannot be defined with these arguments.
shared-calculator-error-transformation-definition-type-error-use-more-1 = A { $fn } cannot be defined using just { $arg }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-use-more-2 = A { $fn } cannot be defined using just { $arg1 } and { $arg2 }. { $expectedTypeMessage }
shared-calculator-error-transformation-type-error-1 = Transformation '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-transformation-type-error-2 = Transformation '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-type-error-many = Transformation '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-ttest-list-too-short = Lists for '{ $symbol }' must have at least 2 elements.
shared-calculator-error-two-numbers-error = Cannot make a polygon from two numbers.
shared-calculator-error-unary-operator-missing-left = You need something before the '{ $symbol }' symbol.
shared-calculator-error-unary-operator-missing-right = You need something after the '{ $symbol }' symbol.
shared-calculator-error-unexpected-equality = Cannot use an equality here.
shared-calculator-error-unexpected-inequality = Cannot use an inequality here.
shared-calculator-error-unexpected-prime = Sorry, I don't understand this use of prime notation.
shared-calculator-error-unexpected-subscript = Only functions and variables may have subscripts.
shared-calculator-error-unexpected-symbol = Sorry, I don't understand the way that '{ $symbol }' is used here.
shared-calculator-error-unplottable-chained-equality = This calculator cannot plot chained equations.
shared-calculator-error-unplottable-long-inequality-chain = This calculator cannot plot chains of more than 2 inequalities.
shared-calculator-error-unplottable-polar-function = We can't plot \u03B8 as a function of r. Try plotting r(\u03B8) instead.
shared-calculator-error-unrecognized-symbol = Sorry, I don't understand the '{ $symbol }' symbol.
shared-calculator-error-update-rule-function-lhs = '{ $symbol }' cannot be updated because it is a function.
shared-calculator-error-update-rule-illegal-lhs = Variable '{ $symbol }' cannot be updated.
shared-calculator-error-update-rule-local-lhs = Variable '{ $symbol }' cannot be updated because it is locally defined.
shared-calculator-error-update-rule-non-identifier-lhs = The left hand side of '{ $arrow }' should be a variable name like '{ $example }'.
shared-calculator-error-update-rule-type-error = Cannot update a variable to { $symbol }.
shared-calculator-error-update-rule-undefined-lhs = Variable '{ $symbol }' must be defined to be updated.
shared-calculator-error-use-r-for-cylindrical-coordinates = Can't combine '\u03C1' and 'z'. Try 'r' for cylindrical coordinates.
shared-calculator-error-use-rho-for-spherical-coordinates = Can't combine 'r' and '\u03C6'. Try '\u03C1' (rho) for spherical coordinates.
shared-calculator-error-variable-as-function = Variable '{ $dependency }' can't be used as a function.
shared-calculator-error-variable-invalid-function-name = This calculator can not use '{ $symbol }' as a function name.
shared-calculator-error-variable-length-distribution-list = The length of a list of distributions can't depend on free variable '{ $symbol }'.
shared-calculator-error-variable-length-integral-depends-on-integration-var = Can't integrate a list whose length depends on integration variable '{ $symbol }'.
shared-calculator-error-variable-length-product-body-depends-on-index = Can't take the product of a list whose length depends on product index '{ $symbol }'.
shared-calculator-error-variable-length-sum-body-depends-on-index = Can't sum a list whose length depends on summation index '{ $symbol }'.
shared-calculator-error-variable-length-top-level-list = Can't plot a list whose length depends on free variable '{ $symbol }'.
shared-calculator-error-variable-seed = Random seed cannot depend on free variable '{ $symbol }'.
shared-calculator-error-variable-unsupported = This calculator does not support the '{ $symbol }' variable.
shared-calculator-error-variables-unsupported = This calculator does not support variables like '{ $variable }'.
shared-calculator-error-write-integral = Type '{ $command }' for { $symbol }.
shared-calculator-error-wrong-arity-many-arg = Function '{ $dependency }' requires { $assignment_arity } arguments. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-few = Function '{ $dependency }' requires an argument. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-many = Function '{ $dependency }' requires only 1 argument. { $supplement }
shared-calculator-error-wrong-arity-supplement = For example, try typing: { $recommendation }.
shared-calculator-error-wrong-two-arg-arity = Function '{ $symbol }' requires 2 arguments. For example, try typing: { $recommendation }.
shared-calculator-error-zero-arg-reducer = Function '{ $symbol }' requires at least one argument. For example, try typing: { $symbol }(1, 2).
shared-calculator-heading-function-table-column-header = Function
shared-calculator-heading-keyboard-shortcuts = Keyboard Shortcuts
shared-calculator-heading-keyboard-shortcuts-audio-tracing = Audio Tracing
shared-calculator-heading-keyboard-shortcuts-braille = Braille
shared-calculator-heading-keyboard-shortcuts-common-actions = Common Actions
shared-calculator-heading-keyboard-shortcuts-common-symbols = Common Symbols
shared-calculator-heading-keyboard-shortcuts-desmos-com-only = Desmos.com Only
shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation = Expression Entry and Navigation
shared-calculator-heading-keyboard-shortcuts-geometry-expression-edit = Expression Edit
shared-calculator-heading-keyboard-shortcuts-geometry-graph-navigation-during-construction = Graph Navigation During Construction
shared-calculator-heading-keyboard-shortcuts-geometry-token-navigator = Token Navigator
shared-calculator-heading-keyboard-shortcuts-geometry-tool-selection = Tool Selection
shared-calculator-heading-keyboard-shortcuts-interactive-points = Interactive Points
shared-calculator-heading-keyboard-shortcuts-slider-trace = Slider Trace
shared-calculator-heading-keyboard-shortcuts-sliders = Sliders
shared-calculator-heading-keyboard-shortcuts-symbols-and-supported-functions = <1>Common Symbols and <2>Supported Functions</2></1>
shared-calculator-heading-keyboard-shortcuts-tables = Tables
shared-calculator-heading-mac-table-column-header = Mac Shortcut
shared-calculator-heading-windows-chrome-table-column-header = Windows / ChromeOS Shortcut
shared-calculator-label-accessibility = Accessibility
shared-calculator-label-empty-list = empty list
shared-calculator-label-for = for
shared-calculator-label-hide-custom-colors = Hide custom colors from geo toolbar
shared-calculator-label-list-of-count-items-suffix =
    { $count ->
        [0] empty
        [one] 1 item
       *[other] { $count } items
    }
shared-calculator-label-os = Operating System
shared-calculator-label-saved = Saved!
shared-calculator-label-saving = Saving...
shared-calculator-label-search-results = Search Results
shared-calculator-label-slow-plotting = This expression is currently being plotted and may take a long time
shared-calculator-label-toast-learn-more = Learn more
shared-calculator-label-toast-undo = Undo
shared-calculator-label-undefined = undefined
shared-calculator-label-value-type-action = an action
shared-calculator-label-value-type-angle = an angle
shared-calculator-label-value-type-any = an unknown object
shared-calculator-label-value-type-arc = an arc
shared-calculator-label-value-type-bool = a true/false value
shared-calculator-label-value-type-circle = a circle
shared-calculator-label-value-type-color = a color
shared-calculator-label-value-type-complex = a complex number
shared-calculator-label-value-type-confidence-interval = a confidence interval
shared-calculator-label-value-type-directed-angle = a directed angle
shared-calculator-label-value-type-distribution = a distribution
shared-calculator-label-value-type-empty-list = an empty list
shared-calculator-label-value-type-error = an error object
shared-calculator-label-value-type-hypothesis-test = a hypothesis test
shared-calculator-label-value-type-lambda-complex = a parameterized complex number
shared-calculator-label-value-type-lambda-point = a parameterized point
shared-calculator-label-value-type-lambda-point3d = a parameterized 3d point
shared-calculator-label-value-type-line = a line
shared-calculator-label-value-type-list-of-2d-points = a list of 2d points
shared-calculator-label-value-type-list-of-3d-points = a list of 3d points
shared-calculator-label-value-type-list-of-angles = a list of angles
shared-calculator-label-value-type-list-of-any = a list of unknown objects
shared-calculator-label-value-type-list-of-arcs = a list of arcs
shared-calculator-label-value-type-list-of-bool = a list of true/false values
shared-calculator-label-value-type-list-of-circles = a list of circles
shared-calculator-label-value-type-list-of-colors = a list of colors
shared-calculator-label-value-type-list-of-complex = a list of complex numbers
shared-calculator-label-value-type-list-of-confidence-interval = a list of confidence intervals
shared-calculator-label-value-type-list-of-directed-angles = a list of directed angles
shared-calculator-label-value-type-list-of-distributions = a list of distributions
shared-calculator-label-value-type-list-of-hypothesis-test = a list of hypothesis tests
shared-calculator-label-value-type-list-of-lambda-complex = a list of parameterized complex numbers
shared-calculator-label-value-type-list-of-lambda-point = a list of parameterized points
shared-calculator-label-value-type-list-of-lambda-point3d = a list of parameterized 3d points
shared-calculator-label-value-type-list-of-lines = a list of lines
shared-calculator-label-value-type-list-of-numbers = a list of numbers
shared-calculator-label-value-type-list-of-one-proportion-z-inference = a list of one-proportion z-inference objects
shared-calculator-label-value-type-list-of-one-sample-t-inference = a list of one-sample t-inference objects
shared-calculator-label-value-type-list-of-one-sample-z-inference = a list of one-sample z-inference objects
shared-calculator-label-value-type-list-of-points = a list of points
shared-calculator-label-value-type-list-of-polygons = a list of polygons
shared-calculator-label-value-type-list-of-rays = a list of rays
shared-calculator-label-value-type-list-of-regression-t-inference = a list of regression t-inference objects
shared-calculator-label-value-type-list-of-restrictions = a list of restrictions
shared-calculator-label-value-type-list-of-segment3d = a list of 3d segments
shared-calculator-label-value-type-list-of-segments = a list of segments
shared-calculator-label-value-type-list-of-sphere3d = a list of 3d sphere
shared-calculator-label-value-type-list-of-tone = a list of tones
shared-calculator-label-value-type-list-of-transformations = a list of transformations
shared-calculator-label-value-type-list-of-triangle3d = a list of 3d triangles
shared-calculator-label-value-type-list-of-two-proportion-z-inference = a list of two-proportion z-inference objects
shared-calculator-label-value-type-list-of-two-sample-t-inference = a list of two-sample t-inference objects
shared-calculator-label-value-type-list-of-two-sample-z-inference = a list of two-sample z-inference objects
shared-calculator-label-value-type-list-of-vector3d = a list of 3d vectors
shared-calculator-label-value-type-list-of-vectors = a list of vectors
shared-calculator-label-value-type-number = a number
shared-calculator-label-value-type-one-proportion-z-inference = a one-proportion z-inference object
shared-calculator-label-value-type-one-sample-t-inference = a one-sample t-inference object
shared-calculator-label-value-type-one-sample-z-inference = a one-sample z-inference object
shared-calculator-label-value-type-point = a point
shared-calculator-label-value-type-point2d = a 2d point
shared-calculator-label-value-type-point3d = a 3d point
shared-calculator-label-value-type-polygon = a polygon
shared-calculator-label-value-type-ray = a ray
shared-calculator-label-value-type-regression-t-inference = a regression t-inference object
shared-calculator-label-value-type-restriction = a restriction
shared-calculator-label-value-type-seed = a string
shared-calculator-label-value-type-segment = a segment
shared-calculator-label-value-type-segment3d = a 3d segment
shared-calculator-label-value-type-sphere3d = a 3d sphere
shared-calculator-label-value-type-tone = a tone
shared-calculator-label-value-type-transformation = a transformation
shared-calculator-label-value-type-triangle3d = a 3d triangle
shared-calculator-label-value-type-two-proportion-z-inference = a two-proportion z-inference object
shared-calculator-label-value-type-two-sample-t-inference = a two-sample t-inference object
shared-calculator-label-value-type-two-sample-z-inference = a two-sample z-inference object
shared-calculator-label-value-type-vector = a vector
shared-calculator-label-value-type-vector3d = a 3d vector
shared-calculator-narration-author-mode = Author Mode
shared-calculator-narration-author-mode-off = Author mode off
shared-calculator-narration-author-mode-on = Author mode on
shared-calculator-narration-braille-mode = Braille Mode
shared-calculator-narration-disable-tool = Disable { $tool } when this condition is true
shared-calculator-narration-display-as-decimal = Displaying as fraction. Press Enter to display as Decimal
shared-calculator-narration-display-as-fraction = Displaying as decimal. Press Enter to display as Fraction
shared-calculator-narration-expression-index = Expression { $index }
shared-calculator-narration-expression-list = Expression List
shared-calculator-narration-hotkey-braille-mode-nemeth = Braille mode Nemeth
shared-calculator-narration-hotkey-braille-mode-off = Braille mode off
shared-calculator-narration-hotkey-braille-mode-ueb = Braille mode UEB
shared-calculator-narration-input-error = input has an error
shared-calculator-narration-item-clickable = { $item } clickable
shared-calculator-narration-item-selected = { $item } selected
shared-calculator-narration-item-unknown = Unknown
shared-calculator-narration-item-unselected = { $item } unselected
shared-calculator-narration-keypad = keypad
shared-calculator-narration-keypad-controlbar = Control Bar
shared-calculator-narration-keypad-key-10-n = Times ten to the power of
shared-calculator-narration-keypad-key-abs = Absolute Value
shared-calculator-narration-keypad-key-action-to = Set Value To
shared-calculator-narration-keypad-key-action-with = Substitute With
shared-calculator-narration-keypad-key-alpha = Alpha
shared-calculator-narration-keypad-key-angle = Angle
shared-calculator-narration-keypad-key-angles = Angles
shared-calculator-narration-keypad-key-ans = Answer
shared-calculator-narration-keypad-key-arc = Arc
shared-calculator-narration-keypad-key-arccos = Inverse Cosine
shared-calculator-narration-keypad-key-arccot = Inverse Cotangent
shared-calculator-narration-keypad-key-arccsc = Inverse Cosecant
shared-calculator-narration-keypad-key-arcsec = Inverse Secant
shared-calculator-narration-keypad-key-arcsin = Inverse Sine
shared-calculator-narration-keypad-key-arctan = Inverse Tangent
shared-calculator-narration-keypad-key-area = Area
shared-calculator-narration-keypad-key-arg = Argument
shared-calculator-narration-keypad-key-backspace = Backspace
shared-calculator-narration-keypad-key-beta = Beta
shared-calculator-narration-keypad-key-binomialdist = Binomial Distribution
shared-calculator-narration-keypad-key-boxplot = Box Plot
shared-calculator-narration-keypad-key-ceil = Ceiling
shared-calculator-narration-keypad-key-center = Center
shared-calculator-narration-keypad-key-chisqdist = Chi-Square Distribution
shared-calculator-narration-keypad-key-circle = Circle
shared-calculator-narration-keypad-key-conj = Complex conjugate
shared-calculator-narration-keypad-key-corr = Correlation
shared-calculator-narration-keypad-key-cos = Cosine
shared-calculator-narration-keypad-key-cosh = Hyperbolic Cosine
shared-calculator-narration-keypad-key-cot = Cotangent
shared-calculator-narration-keypad-key-coterminal = Coterminal
shared-calculator-narration-keypad-key-coth = Hyperbolic Cotangent
shared-calculator-narration-keypad-key-cov = Co Variance
shared-calculator-narration-keypad-key-covp = Population Co Variance
shared-calculator-narration-keypad-key-csc = Cosecant
shared-calculator-narration-keypad-key-csch = Hyperbolic Cosecant
shared-calculator-narration-keypad-key-cubed = Cubed
shared-calculator-narration-keypad-key-decimal = Decimal
shared-calculator-narration-keypad-key-dilate = Dilate
shared-calculator-narration-keypad-key-directed-angle = Directed Angle
shared-calculator-narration-keypad-key-directed-angles = Directed Angles
shared-calculator-narration-keypad-key-distance = Distance
shared-calculator-narration-keypad-key-divide = Divide
shared-calculator-narration-keypad-key-dotplot = Dot Plot
shared-calculator-narration-keypad-key-enter = Enter
shared-calculator-narration-keypad-key-erf = Error Function
shared-calculator-narration-keypad-key-exp = Exponent
shared-calculator-narration-keypad-key-factorial = Factorial
shared-calculator-narration-keypad-key-floor = Floor
shared-calculator-narration-keypad-key-fraction = A over B
shared-calculator-narration-keypad-key-glider = Glider
shared-calculator-narration-keypad-key-histogram = Histogram
shared-calculator-narration-keypad-key-imag = Imaginary
shared-calculator-narration-keypad-key-int = Integral
shared-calculator-narration-keypad-key-intersection = Intersection
shared-calculator-narration-keypad-key-inversecdf = Inverse CDF function
shared-calculator-narration-keypad-key-ittest = Independent T Test
shared-calculator-narration-keypad-key-left-arrow = Left Arrow
shared-calculator-narration-keypad-key-left-bracket = Left Bracket
shared-calculator-narration-keypad-key-left-paren = Left Parenthesis
shared-calculator-narration-keypad-key-line = Line
shared-calculator-narration-keypad-key-ln = Natural Log
shared-calculator-narration-keypad-key-log = Log
shared-calculator-narration-keypad-key-loga = Log A
shared-calculator-narration-keypad-key-mean = Mean
shared-calculator-narration-keypad-key-median = Median
shared-calculator-narration-keypad-key-midpoint = Midpoint
shared-calculator-narration-keypad-key-minus = Minus
shared-calculator-narration-keypad-key-normaldist = Normal Distribution
shared-calculator-narration-keypad-key-nthroot = Nth Root
shared-calculator-narration-keypad-key-parallel = Parallel
shared-calculator-narration-keypad-key-pdf = Probability Density Function
shared-calculator-narration-keypad-key-percent-of = Percent Of
shared-calculator-narration-keypad-key-perimeter = Perimeter
shared-calculator-narration-keypad-key-perpendicular = Perpendicular
shared-calculator-narration-keypad-key-phi = Phi
shared-calculator-narration-keypad-key-pi = Pi
shared-calculator-narration-keypad-key-plus = Plus
shared-calculator-narration-keypad-key-poissondist = Poisson Distribution
shared-calculator-narration-keypad-key-polygon = Polygon
shared-calculator-narration-keypad-key-prime = Function derivative
shared-calculator-narration-keypad-key-product = Product
shared-calculator-narration-keypad-key-quantile = Quantile
shared-calculator-narration-keypad-key-quartile = Quartile
shared-calculator-narration-keypad-key-radius = Radius
shared-calculator-narration-keypad-key-random = Random Number
shared-calculator-narration-keypad-key-ray = Ray
shared-calculator-narration-keypad-key-real = Real
shared-calculator-narration-keypad-key-reciprocal = Reciprocal
shared-calculator-narration-keypad-key-reflect = Reflect
shared-calculator-narration-keypad-key-rho = Rho
shared-calculator-narration-keypad-key-right-arrow = Right Arrow
shared-calculator-narration-keypad-key-right-bracket = Right Bracket
shared-calculator-narration-keypad-key-right-paren = Right Parenthesis
shared-calculator-narration-keypad-key-rotate = Rotate
shared-calculator-narration-keypad-key-round = Round
shared-calculator-narration-keypad-key-sec = Secant
shared-calculator-narration-keypad-key-segment = Segment
shared-calculator-narration-keypad-key-segments = Segments
shared-calculator-narration-keypad-key-shift = Shift
shared-calculator-narration-keypad-key-sin = Sine
shared-calculator-narration-keypad-key-sinh = Hyperbolic Sine
shared-calculator-narration-keypad-key-spearman = Spearman Rank Correlation
shared-calculator-narration-keypad-key-sphere = Sphere
shared-calculator-narration-keypad-key-sqrt = Square Root
shared-calculator-narration-keypad-key-squared = Squared
shared-calculator-narration-keypad-key-stats = Summary statistics
shared-calculator-narration-keypad-key-stdev = Standard Deviation
shared-calculator-narration-keypad-key-stdevp = Standard Deviation of Population
shared-calculator-narration-keypad-key-subscript = Subscript
shared-calculator-narration-keypad-key-sum = Sum
shared-calculator-narration-keypad-key-superscript = Superscript
shared-calculator-narration-keypad-key-supplement = Supplement
shared-calculator-narration-keypad-key-tan = Tangent
shared-calculator-narration-keypad-key-tanh = Hyperbolic Tangent
shared-calculator-narration-keypad-key-tau = Tau
shared-calculator-narration-keypad-key-tdist = Student-t Distribution
shared-calculator-narration-keypad-key-theta = Theta
shared-calculator-narration-keypad-key-times = Times
shared-calculator-narration-keypad-key-toggle-audio-trace = Toggle Audio Trace
shared-calculator-narration-keypad-key-toggle-letters = Toggle Letters
shared-calculator-narration-keypad-key-toggle-numbers = Toggle Numbers
shared-calculator-narration-keypad-key-tone = Tone
shared-calculator-narration-keypad-key-translate = Translate
shared-calculator-narration-keypad-key-triangle = Triangle
shared-calculator-narration-keypad-key-tscore = T Score
shared-calculator-narration-keypad-key-ttest = T Test
shared-calculator-narration-keypad-key-uniformdist = Uniform Distribution
shared-calculator-narration-keypad-key-vector = Vector
shared-calculator-narration-keypad-key-vertices = Vertices
shared-calculator-narration-keypad-key-ythroot = Yth Root
shared-calculator-narration-keypad-plus-minus = Plus-Minus
shared-calculator-narration-math-input-error-message = expression has error
shared-calculator-narration-settings-display-size = Display Size
shared-calculator-narration-settings-display-size-default = Display size: default
shared-calculator-narration-settings-display-size-large = Display size: large
shared-calculator-narration-show-as-decimal = Show as Decimal
shared-calculator-narration-show-as-fraction = Show as Fraction
shared-calculator-narration-six-key-mode-off = Six Key Braille Input off
shared-calculator-narration-six-key-mode-on = Six Key Braille Input on
shared-calculator-text-complex-enabled-note = Hint: try writing { $eq1 } or { $eq2 }.
shared-calculator-text-complex-radian-mode = Complex mode uses radians
shared-calculator-text-customize-toolbar = Customize the Toolbar
shared-calculator-text-keyboard-shortcut-add-expression = Add an Expression
shared-calculator-text-keyboard-shortcut-add-folder = Add a Folder
shared-calculator-text-keyboard-shortcut-add-image = Add an Image
shared-calculator-text-keyboard-shortcut-add-note = Add a Note
shared-calculator-text-keyboard-shortcut-add-table = Add a Table
shared-calculator-text-keyboard-shortcut-add-table-regression = Add Regression from within the Active Table
shared-calculator-text-keyboard-shortcut-adjust-playback-speed = Adjust Playback Speed (1 = slowest, 5 = fastest)
shared-calculator-text-keyboard-shortcut-announce-slider-animations = Announce Active Slider Animations
shared-calculator-text-keyboard-shortcut-beginning-of-block = Beginning of Current Block
shared-calculator-text-keyboard-shortcut-beginning-of-expression = Beginning of Current Expression
shared-calculator-text-keyboard-shortcut-close-a-dialog = Close a Dialog
shared-calculator-text-keyboard-shortcut-collapse-all-folders = Collapse All Folders
shared-calculator-text-keyboard-shortcut-collapse-folder = Collapse Selected Folder
shared-calculator-text-keyboard-shortcut-decrease-volume = Decrease Volume
shared-calculator-text-keyboard-shortcut-decrease-x = Decrease X
shared-calculator-text-keyboard-shortcut-decrease-x-larger = Decrease X by Larger Amount
shared-calculator-text-keyboard-shortcut-decrease-y = Decrease Y
shared-calculator-text-keyboard-shortcut-decrease-y-larger = Decrease Y by Larger Amount
shared-calculator-text-keyboard-shortcut-degrees-toggle = Toggle Between Degrees and Radians
shared-calculator-text-keyboard-shortcut-delete-expression = Delete the Expression that has Keyboard Focus
shared-calculator-text-keyboard-shortcut-delete-selection = Delete Selection
shared-calculator-text-keyboard-shortcut-describe-axes = Describe the graph axes
shared-calculator-text-keyboard-shortcut-end-of-block = End of Current Block
shared-calculator-text-keyboard-shortcut-end-of-expression = End of Current Expression
shared-calculator-text-keyboard-shortcut-exit-block = Exit Current Block
shared-calculator-text-keyboard-shortcut-expand-all-folders = Expand All Folders
shared-calculator-text-keyboard-shortcut-expand-folder = Expand Selected Folder
shared-calculator-text-keyboard-shortcut-first-point = First Point
shared-calculator-text-keyboard-shortcut-focus-expression-list = Focus the Expression List
shared-calculator-text-keyboard-shortcut-focus-first-interactive-point = Focus First Interactive Point On Screen
shared-calculator-text-keyboard-shortcut-focus-graph-paper = Focus the Graph Paper
shared-calculator-text-keyboard-shortcut-geometry-add-object-to-selection = Add Object that has Keyboard Focus to Group of Selected Items (when box-select is active)
shared-calculator-text-keyboard-shortcut-geometry-add-object-token-to-selection = Add an Object Token to Selection
shared-calculator-text-keyboard-shortcut-geometry-cancel-active-tool = Cancel Active Tool
shared-calculator-text-keyboard-shortcut-geometry-choose-toolbar-item-and-focus-graph = Select a Tool and Focus the Graph
shared-calculator-text-keyboard-shortcut-geometry-close-token-navigator = Close Token navigator
shared-calculator-text-keyboard-shortcut-geometry-delete-selected-objects = Delete Selected Object(s)
shared-calculator-text-keyboard-shortcut-geometry-describe-object = Describe Object that has Keyboard Focus
shared-calculator-text-keyboard-shortcut-geometry-deselect-all-objects = Deselect All Objects
shared-calculator-text-keyboard-shortcut-geometry-drag-movable-objects = Drag All Movable Objects
shared-calculator-text-keyboard-shortcut-geometry-expression-edit-add-object = Add Object that has Keyboard Focus to Expression
shared-calculator-text-keyboard-shortcut-geometry-expression-edit-complete = Finish Editing and Return to Expression List (When All Required Objects Have Been Added)
shared-calculator-text-keyboard-shortcut-geometry-expression-edit-next-object = Move to Next Valid Object for the Active Expression
shared-calculator-text-keyboard-shortcut-geometry-expression-edit-previous-object = Move to Previous Valid Object for the Active Expression
shared-calculator-text-keyboard-shortcut-geometry-focus-selected-objects-toolbar = Focus the Toolbar for the Selected Object(s)
shared-calculator-text-keyboard-shortcut-geometry-focus-toolbar = Focus the Geometry Toolbar
shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-categories = Move Between Categories in the Toolbar
shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-dropdown-items = Move Through Tools in a Dropdown
shared-calculator-text-keyboard-shortcut-geometry-move-to-bottom-of-graph = Move to Bottom Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-to-left-of-graph = Move to Left Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-to-right-of-graph = Move to Right Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-to-top-of-graph = Move to Top Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-token-between-expression-list-and-navigator = Move an Object Token Between the Expression List and Navigator
shared-calculator-text-keyboard-shortcut-geometry-navigate-graph = Move to Add Point
shared-calculator-text-keyboard-shortcut-geometry-navigate-object-levels = Navigate Between Object Levels
shared-calculator-text-keyboard-shortcut-geometry-navigate-tokens-at-current-level = Move Between Object Tokens at Current Level
shared-calculator-text-keyboard-shortcut-geometry-next-object = Give Attention to Next Valid Object for the Active Tool
shared-calculator-text-keyboard-shortcut-geometry-open-options = Open Options for the Selected Object(s)
shared-calculator-text-keyboard-shortcut-geometry-open-token-navigator = Open Token navigator
shared-calculator-text-keyboard-shortcut-geometry-open-transformation-options = Open Transformation Options for Selected Object
shared-calculator-text-keyboard-shortcut-geometry-previous-object = Give Attention to Previous Valid Object for the Active Tool
shared-calculator-text-keyboard-shortcut-geometry-repeat-active-tool-prompt = Repeat Active Tool Prompt
shared-calculator-text-keyboard-shortcut-geometry-select-next-category = Select Next Construction Tool Category
shared-calculator-text-keyboard-shortcut-geometry-select-next-tool-within-category = Select Next Tool within Active Category
shared-calculator-text-keyboard-shortcut-geometry-select-previous-category = Select Previous Construction Tool Category
shared-calculator-text-keyboard-shortcut-geometry-select-previous-tool-within-category = Select Previous Tool within Active Category
shared-calculator-text-keyboard-shortcut-geometry-select-single-object-token = Select a Single Object Token
shared-calculator-text-keyboard-shortcut-geometry-select-tool-by-number = Select the nth Construction Tool Category
shared-calculator-text-keyboard-shortcut-hear-graph = Hear Graph
shared-calculator-text-keyboard-shortcut-hear-specific-branch = Hear Only Branch 1 Through 10
shared-calculator-text-keyboard-shortcut-increase-selection-left = Increase Selection Left
shared-calculator-text-keyboard-shortcut-increase-selection-right = Increase Selection Right
shared-calculator-text-keyboard-shortcut-increase-volume = Increase Volume
shared-calculator-text-keyboard-shortcut-increase-x = Increase X
shared-calculator-text-keyboard-shortcut-increase-x-larger = Increase X by Larger Amount
shared-calculator-text-keyboard-shortcut-increase-y = Increase Y
shared-calculator-text-keyboard-shortcut-increase-y-larger = Increase Y by Larger Amount
shared-calculator-text-keyboard-shortcut-keypad-toggle = Show or Hide the Keypad
shared-calculator-text-keyboard-shortcut-last-point = Last Point
shared-calculator-text-keyboard-shortcut-move-to-denominator = Move to Denominator Within Fraction
shared-calculator-text-keyboard-shortcut-move-to-numerator = Move to Numerator Within Fraction
shared-calculator-text-keyboard-shortcut-move-to-origin = Move to Origin
shared-calculator-text-keyboard-shortcut-mute-toggle = Mute or Unmute Audio Playback
shared-calculator-text-keyboard-shortcut-nemeth-mode = Toggle Nemeth
shared-calculator-text-keyboard-shortcut-next-character = Next Character
shared-calculator-text-keyboard-shortcut-next-curve = Move to Next Curve
shared-calculator-text-keyboard-shortcut-next-expression = Move to Next Expression
shared-calculator-text-keyboard-shortcut-next-interactive-point = Go to Next Interactive Point
shared-calculator-text-keyboard-shortcut-next-item = Move to Next Item (skips table cells)
shared-calculator-text-keyboard-shortcut-next-poi = Next Point of Interest
shared-calculator-text-keyboard-shortcut-next-point = Next Point
shared-calculator-text-keyboard-shortcut-open-a-graph = Open a Graph
shared-calculator-text-keyboard-shortcut-open-expression-options = Open Options for the Expression that has Keyboard Focus
shared-calculator-text-keyboard-shortcut-open-shortcuts-dialog = Open Keyboard Shortcuts Dialog
shared-calculator-text-keyboard-shortcut-pan-graph = Pan Graph in Given Direction (when focused)
shared-calculator-text-keyboard-shortcut-previous-character = Previous Character
shared-calculator-text-keyboard-shortcut-previous-curve = Move to Previous Curve
shared-calculator-text-keyboard-shortcut-previous-expression = Move to Previous Expression
shared-calculator-text-keyboard-shortcut-previous-interactive-point = Go to Previous Interactive Point
shared-calculator-text-keyboard-shortcut-previous-item = Move to Previous Item (skips table cells)
shared-calculator-text-keyboard-shortcut-previous-poi = Previous Point of Interest
shared-calculator-text-keyboard-shortcut-previous-point = Previous Point
shared-calculator-text-keyboard-shortcut-print-a-graph = Print a Graph
shared-calculator-text-keyboard-shortcut-print-mode = Exit Braille Mode
shared-calculator-text-keyboard-shortcut-redo = Redo
shared-calculator-text-keyboard-shortcut-remove-empty-expression = Remove Selected Empty Expression
shared-calculator-text-keyboard-shortcut-rotate-3d-cube = Rotate Cube in Given Direction (when focused)
shared-calculator-text-keyboard-shortcut-rotate-3d-cube-command = <key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, or <key>RIGHT ARROW</key>
shared-calculator-text-keyboard-shortcut-save-a-graph = Save a Graph
shared-calculator-text-keyboard-shortcut-select-all = Select All
shared-calculator-text-keyboard-shortcut-show-answer-as-decimal-or-fraction = Show Answer as Decimal or Fraction
shared-calculator-text-keyboard-shortcut-show-or-hide-expression = Show or Hide the Selected Expression
shared-calculator-text-keyboard-shortcut-show-or-hide-expression-list = Show or Hide the Expression List
shared-calculator-text-keyboard-shortcut-slider-decrease = Decrease Value
shared-calculator-text-keyboard-shortcut-slider-decrease-larger = Decrease Value by Larger Increment
shared-calculator-text-keyboard-shortcut-slider-increase = Increase Value
shared-calculator-text-keyboard-shortcut-slider-increase-larger = Increase Value by Larger Increment
shared-calculator-text-keyboard-shortcut-slider-maximum = Highest Value
shared-calculator-text-keyboard-shortcut-slider-minimum = Lowest Value
shared-calculator-text-keyboard-shortcut-slider-trace-decrease = Decrease Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-decrease-larger = Decrease Value of Selected Slider by Larger Increment When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-increase = Increase Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-increase-larger = Increase Value of Selected Slider by Larger Increment When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-maximum = Move to Highest Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-minimum = Move to Lowest Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-next-slider = Select Next Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-previous-slider = Select Previous Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-speak-answer = Speak Answer
shared-calculator-text-keyboard-shortcut-speak-branch = Speak Branch
shared-calculator-text-keyboard-shortcut-speak-color = Speak Color
shared-calculator-text-keyboard-shortcut-speak-focused-block = Speak Block that has Keyboard Focus
shared-calculator-text-keyboard-shortcut-speak-label = Speak Label
shared-calculator-text-keyboard-shortcut-speak-left-adjacent-block = Speak Left-Adjacent Block
shared-calculator-text-keyboard-shortcut-speak-parent-block = Speak Parent Block
shared-calculator-text-keyboard-shortcut-speak-poi-count = Speak Point of Interest Count
shared-calculator-text-keyboard-shortcut-speak-point-type = Speak Type of Selected Point
shared-calculator-text-keyboard-shortcut-speak-right-adjacent-block = Speak Right-Adjacent Block
shared-calculator-text-keyboard-shortcut-speak-selection = Speak Selection
shared-calculator-text-keyboard-shortcut-speak-x = Speak X Coordinate
shared-calculator-text-keyboard-shortcut-speak-y = Speak Y Coordinate
shared-calculator-text-keyboard-shortcut-spin-3d-cube = Spin Cube in Given Direction (when focused)
shared-calculator-text-keyboard-shortcut-spin-3d-cube-command = Press and hold <key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, or <key>RIGHT ARROW</key>
shared-calculator-text-keyboard-shortcut-summarize-graph = Summarize Selected Curve
shared-calculator-text-keyboard-shortcut-switch-pane-in-3d-quest = Move Between Expression List and Quest Instruction Pane
shared-calculator-text-keyboard-shortcut-table-first-column = First Column in Row
shared-calculator-text-keyboard-shortcut-table-first-row = First Row in Column
shared-calculator-text-keyboard-shortcut-table-last-column = Last Column in Row
shared-calculator-text-keyboard-shortcut-table-last-row = Last Row in Column
shared-calculator-text-keyboard-shortcut-table-next-cell = Next Cell
shared-calculator-text-keyboard-shortcut-table-next-column = Next Column
shared-calculator-text-keyboard-shortcut-table-next-row = Next Row
shared-calculator-text-keyboard-shortcut-table-previous-cell = Previous Cell
shared-calculator-text-keyboard-shortcut-table-previous-column = Previous Column
shared-calculator-text-keyboard-shortcut-table-previous-row = Previous Row
shared-calculator-text-keyboard-shortcut-table-speak-column-header = Speak Column Header
shared-calculator-text-keyboard-shortcut-toggle-account-menu = Open or Close the Account Menu
shared-calculator-text-keyboard-shortcut-toggle-audio-trace = Enable or Disable Audio Trace Mode
shared-calculator-text-keyboard-shortcut-toggle-author-mode = Toggle Author Mode Features
shared-calculator-text-keyboard-shortcut-toggle-braille-typing = Toggle 6-key Braille Input
shared-calculator-text-keyboard-shortcut-toggle-edit-list-mode = Turn Edit List Mode On or Off
shared-calculator-text-keyboard-shortcut-toggle-graph-settings-menu = Open or Close the Graph Settings Menu
shared-calculator-text-keyboard-shortcut-toggle-help-menu = Open or Close the Help Menu
shared-calculator-text-keyboard-shortcut-toggle-language-menu = Open or Close the Language Menu
shared-calculator-text-keyboard-shortcut-toggle-share-menu = Open or Close the Share Menu
shared-calculator-text-keyboard-shortcut-toggle-slider-trace = Toggle Slider Trace Mode
shared-calculator-text-keyboard-shortcut-ueb-mode = Toggle UEB
shared-calculator-text-keyboard-shortcut-undo = Undo
shared-calculator-text-keyboard-shortcut-zoom-fit = Zoom to Fit
shared-calculator-text-keyboard-shortcut-zoom-in = Zoom In
shared-calculator-text-keyboard-shortcut-zoom-out = Zoom Out
shared-calculator-text-keyboard-shortcut-zoom-restore-default = Restore Default Viewport
shared-calculator-text-search-results =
    { $count ->
        [0] No results.
        [one] 1 result.
       *[other] { $count } results.
    }
shared-heading-keyboard-shortcuts-supported-functions = Supported Functions
shared-label-choose-all-that-describe = Choose all that describe you:
shared-label-continue-with-email = Continue with email:
shared-label-create-password = Create Password
shared-label-email = Email
shared-label-enter-password = Enter password:
shared-label-family-name = Last Name (optional)
shared-label-first-name = First Name
shared-label-given-name-or-nickname = First Name or Nickname
shared-label-last-name = Last Name
shared-label-name = Name
shared-label-new-email-address = New Email Address
shared-label-opens-in-new-tab-suffix = { $title } (opens in new tab)
shared-label-optional = (optional)
shared-label-password = Password
shared-label-to = to
shared-label-tool = Tool
shared-message-account-reactivated = You previously requested to delete your account, but because you logged back in within 30 days, we will not delete your account. Welcome back!
shared-message-change-password-email-sent = We will send a link to your email address ({ $emailAddress }) so you can change your password.
shared-message-check-email-for-delete-link = Please check your email ({ $emailAddress }) for the link to delete your account.
shared-message-check-email-for-link = Please check { $emailAddress } for the Change Email link.
shared-message-check-email-for-password-link = Please check your email ({ $emailAddress }) for the link to change your password.
shared-message-check-email-for-password-recovery-link = Message sent. Please check your email for a password recovery link.
shared-message-delete-account-notice = When you delete your account, <1>we will retain your data for 30 days.</1> You can reactivate your account at any time during those 30 days by logging back in. If there's something about Desmos we can improve, please <2>let us know.</2>
shared-message-delete-account-will-send-email = We will send you a link to your email address ({ $email }) so you can delete your account.
shared-message-email-sent = Email sent
shared-message-email-settings-will-send-email = We will send a Change Email link to { $emailAddress }.
shared-message-google-login-not-available = Google Login is not available on this device.
shared-message-information-saved = Saved!
shared-message-maintenance-starts-at = Saving, sharing, and signing in will be temporarily disabled on { $localizedStartDate } starting at approximately { $localizedStartTime }.
shared-message-maintenance-window = Saving, sharing, and signing in will be temporarily disabled on { $localizedStartDate } between approximately { $localizedStartTime } and { $localizedEndTime }.
shared-message-please-review-name = We tried to split your name into first and last name. Please review your name below and edit any mistakes.
shared-message-set-new-email-address = Set a new email address and password.
shared-prompt-continue-with-apple = Continue with Apple
shared-prompt-continue-with-google = Continue with Google
shared-prompt-enter-email-for-password-recovery-link = Enter your email address to get a password recovery link.
shared-prompt-forgot-password = Forgot password?
shared-prompt-set-password = Set a password instead
shared-text-cookie-notice = We use cookies only for logged in users. Please stay logged out to use Desmos without cookies.
shared-text-or = or
shared-text-previous-apple = You've previously signed in with Apple. Click the button below to sign in.
shared-text-previous-google = You've previously signed in with Google. Click the button below to sign in.
shared-text-privacy-notice = By signing up, you agree to our <1>Privacy Policy</1> & <2>Terms</2>.
shared-title-account-finish-set-up = You signed up with <1>{$v0}</1>. Finish setting up your account below.
shared-title-account-reactivated = Your account has been reactivated.
shared-title-account-settings = Account Settings
shared-title-authenticate = Log In or Sign Up
shared-title-change-email-address = Change your Desmos email address
shared-title-change-password-narrow = Password
shared-title-change-password-wide = Change Password
shared-title-delete-account = Are you sure you want to delete your account?
shared-title-email-settings = Email
shared-title-language-menu = Language
shared-title-login = Log In
shared-title-profile-information-narrow = Profile
shared-title-profile-information-wide = Profile Information
shared-title-recover-password = Recover Password
shared-title-using-for-sign-up = You're signing up with <1>{$v0}</1>.
shared-title-welcome = Welcome!
shared-title-welcome-with-name = Welcome, { $name }!
basic-calculator-button-controlbar-abc = abc
basic-calculator-button-controlbar-clear = clear
basic-calculator-button-controlbar-clear-all = clear all
basic-calculator-button-controlbar-func = func
basic-calculator-button-controlbar-main = main
basic-calculator-button-turn-braille-mode-off = Turn { $mode } off
basic-calculator-error-fractions-unavailable = Fractions are not available in the current calculator.
basic-calculator-error-parentheses-unavailable = Parentheses are not available in this calculator.
basic-calculator-heading-braille-table-type-this = Type this
basic-calculator-heading-braille-table-typeset = Typeset
basic-calculator-label-answer-hint = Your answers show up on this side.
basic-calculator-label-controlbar-deg = deg
basic-calculator-label-controlbar-rad = rad
basic-calculator-label-convert-to-decimal = Convert to decimal.
basic-calculator-label-convert-to-fraction = Convert to fraction.
basic-calculator-label-reverse-contrast = Reverse Contrast
basic-calculator-link-download-braille-equations = Download Braille Equations
basic-calculator-link-view-braille-examples = View more examples
basic-calculator-narration-calc-description-fourfunction = Desmos Four-Function Calculator
basic-calculator-narration-calc-description-scientific = Desmos Scientific Calculator
basic-calculator-narration-controlbar-abc = A B C
basic-calculator-narration-controlbar-backspace = backspace
basic-calculator-narration-controlbar-clear = clear
basic-calculator-narration-controlbar-clear-all = clear all
basic-calculator-narration-controlbar-degrees = Degrees
basic-calculator-narration-controlbar-functions = Functions
basic-calculator-narration-controlbar-main = main
basic-calculator-narration-controlbar-radians = Radians
basic-calculator-narration-controlbar-redo = Redo
basic-calculator-narration-controlbar-settings = settings
basic-calculator-narration-controlbar-undo = Undo
basic-calculator-narration-convert-to-decimal = Displaying as fraction. Press Enter to display as Decimal
basic-calculator-narration-convert-to-fraction = Displaying as decimal. Press Enter to display as Fraction
basic-calculator-narration-hotkey-six-key-input-off = Six Key Braille Input off
basic-calculator-narration-hotkey-six-key-input-on = Six Key Braille Input on
basic-calculator-text-braille-mode-is-on = { $mode } is on!
basic-calculator-text-how-to-type-braille = Use a Refreshable Braille display, or just type Braille with a keyboard.
geometry-label-construct-instruction = Click down here to construct
geometry-label-example-construction-30-60-90-animation = 30-60-90 Animation
geometry-label-example-construction-angle-bisector = Angle Bisector
geometry-label-example-construction-angles-of-a-quadrilateral = Angles of a Quadrilateral
geometry-label-example-construction-equilateral-triangle = Equilateral Triangle
geometry-label-example-construction-euler-line = The Euler Line
geometry-label-example-construction-inscribed-quadrilateral = Inscribed Quadrilateral
geometry-label-example-construction-inscribed-triangle = Inscribed Triangle
geometry-label-example-construction-pentagon-spiral = Pentagon Spiral
geometry-label-example-construction-perimeter-and-area = Perimeter and Area
geometry-label-example-construction-perpendicular-bisector = Perpendicular Bisector
geometry-label-example-construction-pythagorean-theorem = Pythagorean Theorem
geometry-label-example-construction-rainbow-pinwheel = Rainbow Pinwheel
geometry-label-example-construction-regular-sided-n-gon = Regular sided n-gon
geometry-label-example-construction-rotation-with-a-slider = Rotating with a Slider
geometry-label-example-construction-sierpinksi-triangle = Sierpinski Triangle
geometry-label-example-construction-string-art = String Art
geometry-label-example-construction-tangent-to-a-circle = Tangent to a Circle
geometry-label-example-construction-triangles-and-transversals = Triangles and Transversals
geometry-label-example-construction-two-reflections = Two Reflections
geometry-label-example-construction-vector-addition = Vector Addition
geometry-label-pick-tool-instruction = Pick a tool to get started
graphing-calculator-button-add-table-regression = Add Regression
graphing-calculator-button-audio-trace-hear-graph = Hear Graph
graphing-calculator-button-audio-trace-stop-graph = Stop Graph
graphing-calculator-button-cdf-footer-title = Cumulative Probability
graphing-calculator-button-change-image = Change Image
graphing-calculator-button-clear-graph = Delete All
graphing-calculator-button-copy-poi-coordinates = Export point to expression list
graphing-calculator-button-copy-table-regression-model-to-expression-list = Export as custom regression
graphing-calculator-button-delete-table-regression = Delete regression
graphing-calculator-button-done = Done
graphing-calculator-button-draggable = Draggable
graphing-calculator-button-draggable-points = Draggable Points
graphing-calculator-button-edit-graph-on-desmos-logo = edit graph on
graphing-calculator-button-editable-math = Editable Math
graphing-calculator-button-editable-text = Editable Text
graphing-calculator-button-funcs = funcs
graphing-calculator-button-functions = functions
graphing-calculator-button-functions-menu-custom-colors = Custom Colors
graphing-calculator-button-functions-menu-number-theory = Number Theory
graphing-calculator-button-geometry-label-points = Label Points
graphing-calculator-button-hide-folder-from-students-2 = Hide this folder from students.
graphing-calculator-button-in-front-of-everything = In front of everything
graphing-calculator-button-keypad-audio-trace-off = Audio Trace Off
graphing-calculator-button-keypad-describe-axes = Describe Axes
graphing-calculator-button-keypad-describe-curve = Describe Curve
graphing-calculator-button-keypad-describe-curve-short = Curve
graphing-calculator-button-keypad-describe-point = Describe Point
graphing-calculator-button-keypad-describe-point-short = Point
graphing-calculator-button-label = Label
graphing-calculator-button-label-editable = Editable
graphing-calculator-button-label-point-outline = Point outline
graphing-calculator-button-label-show-on-hover = Show on hover
graphing-calculator-button-label-text-outline = Text outline
graphing-calculator-button-load-image-retry = Retry.
graphing-calculator-button-move-to-expression-list-action = Move
graphing-calculator-button-place-image-behind-graphs = Place behind graphs
graphing-calculator-button-regression-log-mode = Log Mode
graphing-calculator-button-regression-plot-residuals = plot
graphing-calculator-button-replace = Replace
graphing-calculator-button-reset-graph = Reset
graphing-calculator-button-settings-degrees = Degrees
graphing-calculator-button-settings-radians = Radians
graphing-calculator-button-settings-zoom-square = Zoom Square
graphing-calculator-button-share-graph-link-copy = Copy
graphing-calculator-button-show-all-table-rows = Show all
graphing-calculator-button-slider-add-all-variables = all
graphing-calculator-button-visual-parameters-binned = Binned
graphing-calculator-button-visual-parameters-center = Center
graphing-calculator-button-visual-parameters-count = Count
graphing-calculator-button-visual-parameters-density = Density
graphing-calculator-button-visual-parameters-exact = Exact
graphing-calculator-button-visual-parameters-exclude-outliers = Exclude Outliers
graphing-calculator-button-visual-parameters-left = Left
graphing-calculator-button-visual-parameters-relative = Relative
graphing-calculator-error-equation-contains-unresolved-details = This plot contains fine detail that has not been fully resolved.
graphing-calculator-error-expression-replacement = Replacement must be a valid function or variable name.
graphing-calculator-error-expression-search = Can only rename a valid function or variable name.
graphing-calculator-error-failed-to-load-image = Failed to load image.
graphing-calculator-error-image-invalid-angle = Invalid angle. Try using any number.
graphing-calculator-error-image-invalid-center = Invalid center. Try, for example, (0,0).
graphing-calculator-error-image-invalid-file = The file "{ $file }" is not an image
graphing-calculator-error-image-invalid-height = Invalid height. Try using any number.
graphing-calculator-error-image-invalid-opacity = Invalid opacity. Try using any number.
graphing-calculator-error-image-invalid-width = Invalid width. Try using any number.
graphing-calculator-error-inference-invalid-cdf-p-value = Target area needs to be between 0 and 1.
graphing-calculator-error-inference-invalid-confidence = Confidence level must be a number between 0 and 1.
graphing-calculator-error-inference-invalid-hypothesis = There is an error in the hypothesis value.
graphing-calculator-error-invalid-exportable-evaluation = Error computing this value.
graphing-calculator-error-legacy-random-seed-behavior = This graph uses legacy randomization behavior.
graphing-calculator-error-log-axes-image = Cannot plot images on a log scale.
graphing-calculator-error-nan-blame-complex-coercion = Plotted values are non-real at all input values. Try using absolute value to convert complex numbers to real.
graphing-calculator-error-reached-maximum-recursion-depth = Reached maximum recursion depth while plotting this expression.
graphing-calculator-error-table-regression-unexportable-reserved-variable-single = Column { $variable } can't be referenced outside of the table. To create a standalone regression, first try renaming that column.
graphing-calculator-error-table-regression-unexportable-reserved-variables-many = These columns can't be referenced outside of the table. To export the regression model, first try renaming the columns.
graphing-calculator-error-tone-frequency-out-of-range = Tones can only play for frequencies between { $min }Hz and { $max }Hz.
graphing-calculator-heading-advanced = Advanced
graphing-calculator-heading-audio-trace-describe = Describe
graphing-calculator-heading-audio-trace-navigation = Navigation
graphing-calculator-heading-audio-trace-screen-reader = Screen Reader
graphing-calculator-heading-calculus = Calculus
graphing-calculator-heading-clickable = Clickable
graphing-calculator-heading-dist-tab-distributions = Distributions
graphing-calculator-heading-dist-tab-visualizations = Visualizations
graphing-calculator-heading-drag = Drag
graphing-calculator-heading-fill = Fill
graphing-calculator-heading-functions-menu-advanced = Advanced
graphing-calculator-heading-functions-menu-complex = Complex
graphing-calculator-heading-functions-menu-polar = Polar Coordinates
graphing-calculator-heading-functions-menu-sound = Sound
graphing-calculator-heading-geometry = Geometry
graphing-calculator-heading-geometry-measurements = Properties & Measurements
graphing-calculator-heading-geometry-tools = Geometry Tools
graphing-calculator-heading-geometry-transformations = Transformations
graphing-calculator-heading-hyperbolic-trig = Hyperbolic Trig Functions
graphing-calculator-heading-image-opacity = Opacity
graphing-calculator-heading-inverse-trig = Inverse Trig Functions
graphing-calculator-heading-keypad-audio-trace-point-of-interest = <1>Point</1><2>of Interest</2>
graphing-calculator-heading-label = Label
graphing-calculator-heading-label-orientation = Orientation
graphing-calculator-heading-lines = Lines
graphing-calculator-heading-lists = List Operations
graphing-calculator-heading-points = Points
graphing-calculator-heading-quest = Quest: { $title }
graphing-calculator-heading-regression-equation = Equation
graphing-calculator-heading-regression-parameters = Regression Parameters
graphing-calculator-heading-regression-residuals = Residuals
graphing-calculator-heading-regression-statistics = Statistics
graphing-calculator-heading-slider-animation-mode = Animation Mode
graphing-calculator-heading-slider-speed = Speed
graphing-calculator-heading-stat-tests = Statistical Tests
graphing-calculator-heading-stats = Statistics
graphing-calculator-heading-style = Style
graphing-calculator-heading-surfaces = Surfaces
graphing-calculator-heading-table-regression-model-structure = Regression model structure
graphing-calculator-heading-trig = Trig Functions
graphing-calculator-heading-visual-parameters-bar-heights = Bar Heights
graphing-calculator-heading-visual-parameters-bin-alignment = Bin Alignment
graphing-calculator-heading-visual-parameters-display-properties = Display Properties
graphing-calculator-heading-visual-parameters-x-values = X Values
graphing-calculator-label-adaptive-peel-warning = This graph has many transparent layers, which may result in degraded performance or visual innacuracies.
graphing-calculator-label-add-base-case = add base case:
graphing-calculator-label-add-depressed-image-tooltip = Add Depressed Image
graphing-calculator-label-add-hovered-image-tooltip = Add Hovered Image
graphing-calculator-label-add-item-tooltip = Add Item
graphing-calculator-label-add-slider = add slider:
graphing-calculator-label-allow-rotation = Allow rotation
graphing-calculator-label-alt-text = Alt:
graphing-calculator-label-angle-tooltip = Angle
graphing-calculator-label-animation-properties-tooltip = Animation Properties
graphing-calculator-label-audio-trace-curve = Curve
graphing-calculator-label-audio-trace-need-screen-reader = Your Screen Reader needs to be on to hear these.
graphing-calculator-label-audio-trace-point = Point
graphing-calculator-label-audio-trace-speed = Speed
graphing-calculator-label-audio-trace-volume = Volume
graphing-calculator-label-axes = Axes
graphing-calculator-label-braille-nemeth = Braille Nemeth
graphing-calculator-label-braille-size-etc11 = ETC Romeo/Juliet (11.5 x 11 in)
graphing-calculator-label-braille-size-etc8 = ETC Romeo/Juliet (8.5 x 11 in)
graphing-calculator-label-braille-size-vpmax11 = VP Max (11.5 x 11 in)
graphing-calculator-label-braille-size-vpmax8 = VP Max (8.5 x 11 in)
graphing-calculator-label-braille-ueb = Braille UEB
graphing-calculator-label-change-depressed-image-tooltip = Change Depressed Image
graphing-calculator-label-change-hovered-image-tooltip = Change Hovered Image
graphing-calculator-label-convert-to-table-tooltip = Convert to Table
graphing-calculator-label-create-table = Create Table
graphing-calculator-label-depressed = Depressed
graphing-calculator-label-disable-graph-interactions = Disable Graph Interactions
graphing-calculator-label-disable-rotation = Disable rotation
graphing-calculator-label-display-properties = Local Display Preferences
graphing-calculator-label-distributions-ui-area = Area
graphing-calculator-label-distributions-ui-bounds = Bounds
graphing-calculator-label-distributions-ui-compute = Compute
graphing-calculator-label-distributions-ui-region = Region
graphing-calculator-label-drop-image-here = Drop Image Here
graphing-calculator-label-duplicate-expression-tooltip = Duplicate
graphing-calculator-label-edit-graph-bounds = Graph Bounds
graphing-calculator-label-edit-list-tooltip = Edit List
graphing-calculator-label-evaluation-list = { $count } element list
graphing-calculator-label-example-graph-3d-conic-sections-hyperbola = Conic sections: Hyperbola
graphing-calculator-label-example-graph-3d-contour-plot = Contour plot
graphing-calculator-label-example-graph-3d-double-helix = Double helix
graphing-calculator-label-example-graph-3d-ellipsoid = Ellipsoid
graphing-calculator-label-example-graph-3d-f-rtheta = Function of r,\u03B8
graphing-calculator-label-example-graph-3d-f-xy = Function of x,y
graphing-calculator-label-example-graph-3d-frenet-frame = Frenet frame
graphing-calculator-label-example-graph-3d-goursat = Goursat's Tangle
graphing-calculator-label-example-graph-3d-implicit = Implicit surface
graphing-calculator-label-example-graph-3d-magic-list-of-points = Magic list of points
graphing-calculator-label-example-graph-3d-octahedron = Octahedron
graphing-calculator-label-example-graph-3d-osculating-circle = Osculating circle
graphing-calculator-label-example-graph-3d-parametric = Space curves
graphing-calculator-label-example-graph-3d-parametric-curve = Parametric curve
graphing-calculator-label-example-graph-3d-parametric-surface = Parametric surface
graphing-calculator-label-example-graph-3d-parametric-surface-of-revolution = Parametric surface of revolution
graphing-calculator-label-example-graph-3d-solids-of-revolution = Solids of revolution
graphing-calculator-label-example-graph-3d-spheres = Spheres
graphing-calculator-label-example-graph-3d-surface-of-revolution = Surface of revolution
graphing-calculator-label-example-graph-3d-vectors = Vectors
graphing-calculator-label-example-graph-3d-world = 3D World
graphing-calculator-label-example-graph-calculus-derivatives = Calculus: Derivatives
graphing-calculator-label-example-graph-calculus-fundamental-theorem-of-calculus = Calculus: Fundamental Theorem of Calculus
graphing-calculator-label-example-graph-calculus-integral-with-adjustable-bounds = Calculus: Integral with adjustable bounds
graphing-calculator-label-example-graph-calculus-integrals = Calculus: Integrals
graphing-calculator-label-example-graph-calculus-secant-line = Calculus: Secant Line
graphing-calculator-label-example-graph-calculus-tangent-line = Calculus: Tangent Line
graphing-calculator-label-example-graph-calculus-taylor-expansion-of-sin-x = Calculus: Taylor Expansion of sin(x)
graphing-calculator-label-example-graph-checkerboard-inversion = Checkerboard Inversion
graphing-calculator-label-example-graph-conic-sections-circle = Conic Sections: Circle
graphing-calculator-label-example-graph-conic-sections-ellipse-with-foci = Conic Sections: Ellipse with Foci
graphing-calculator-label-example-graph-conic-sections-hyperbola = Conic Sections: Hyperbola
graphing-calculator-label-example-graph-conic-sections-parabola-and-focus = Conic Sections: Parabola and Focus
graphing-calculator-label-example-graph-fastest-path-to-a-point = Fastest Path to a Point
graphing-calculator-label-example-graph-fireworks = Fireworks!
graphing-calculator-label-example-graph-fractal-valentine = Fractal Valentine
graphing-calculator-label-example-graph-lines-point-slope-form = Lines: Point Slope Form
graphing-calculator-label-example-graph-lines-slope-intercept-form = Lines: Slope Intercept Form
graphing-calculator-label-example-graph-lines-two-point-form = Lines: Two Point Form
graphing-calculator-label-example-graph-lists-curve-stitching = Lists: Curve Stitching
graphing-calculator-label-example-graph-lists-family-of-sin-curves = Lists: Family of sin Curves
graphing-calculator-label-example-graph-lists-plotting-a-list-of-points = Lists: Plotting a List of Points
graphing-calculator-label-example-graph-outstretched-arm = Outstretched Arm
graphing-calculator-label-example-graph-pac-man = Pac Man
graphing-calculator-label-example-graph-parabolas-standard-form = Parabolas: Standard Form
graphing-calculator-label-example-graph-parabolas-standard-form-plus-tangent = Parabolas: Standard Form + Tangent
graphing-calculator-label-example-graph-parabolas-vertex-form = Parabolas: Vertex Form
graphing-calculator-label-example-graph-parametric-cycloid = Parametric: Cycloid
graphing-calculator-label-example-graph-parametric-introduction = Parametric: Introduction
graphing-calculator-label-example-graph-polar-conic-sections = Polar: Conic Sections
graphing-calculator-label-example-graph-polar-limacon = Polar: Limacon
graphing-calculator-label-example-graph-polar-logarithmic-spiral = Polar: Logarithmic Spiral
graphing-calculator-label-example-graph-polar-rose = Polar: Rose
graphing-calculator-label-example-graph-pride-flag = PRIDE flag
graphing-calculator-label-example-graph-regular-sine-wave = Regular Sine Wave?
graphing-calculator-label-example-graph-stats-anscombes-quartet = Statistics: Anscombe's Quartet
graphing-calculator-label-example-graph-stats-fourth-order-polynomial = Statistics: 4th Order Polynomial
graphing-calculator-label-example-graph-stats-linear-regression = Statistics: Linear Regression
graphing-calculator-label-example-graph-teapot = Utah teapot
graphing-calculator-label-example-graph-transformations-inverse-of-a-function = Transformations: Inverse of a Function
graphing-calculator-label-example-graph-transformations-scaling-a-function = Transformations: Scaling a Function
graphing-calculator-label-example-graph-transformations-translating-a-function = Transformations: Translating a Function
graphing-calculator-label-example-graph-trig-period-and-amplitude = Trigonometry: Period and Amplitude
graphing-calculator-label-example-graph-trig-phase = Trigonometry: Phase
graphing-calculator-label-example-graph-trig-unit-circle = Trigonometry: Unit Circle
graphing-calculator-label-example-graph-trig-wave-interference = Trigonometry: Wave Interference
graphing-calculator-label-expression-delete-tooltip = Delete
graphing-calculator-label-expression-lowercase = expression
graphing-calculator-label-extend-to-3d = Extend to 3D
graphing-calculator-label-folder-lowercase = folder
graphing-calculator-label-geometry-dilation-by-point = Dilate at <parent1/> by <parent2/>
graphing-calculator-label-geometry-move-to-folder-placeholder = Folder name
graphing-calculator-label-geometry-reflection-over-point = Reflect over <parent1/>
graphing-calculator-label-geometry-rotation-around-point-by-angle = Rotate around <parent1/> by <parent2/>
graphing-calculator-label-geometry-tool-disabled-when = Disabled when:
graphing-calculator-label-geometry-tools = Geometry Tools
graphing-calculator-label-geometry-tools-dropdown-menu-angle = Angle tools
graphing-calculator-label-geometry-tools-dropdown-menu-circle = Circle tools
graphing-calculator-label-geometry-tools-dropdown-menu-line = Line tools
graphing-calculator-label-geometry-tools-dropdown-menu-point = Point tools
graphing-calculator-label-geometry-tools-dropdown-menu-polygon = Polygon tools
graphing-calculator-label-geometry-tools-dropdown-menu-selection = Selection tools
graphing-calculator-label-geometry-tools-dropdown-menu-transformation = Transformation tools
graphing-calculator-label-geometry-translation-by-two-points = Translate from <parent1/> to <parent2/>
graphing-calculator-label-geometry-translation-by-vector = Translate by <parent1/>
graphing-calculator-label-hide-expression-list-tooltip = Hide Expression List
graphing-calculator-label-hide-keypad = Hide Keypad
graphing-calculator-label-hovered = Hovered
graphing-calculator-label-image-angle = Angle:
graphing-calculator-label-image-center = Center:
graphing-calculator-label-image-height = Height:
graphing-calculator-label-image-lowercase = image
graphing-calculator-label-image-opacity = Opacity:
graphing-calculator-label-image-width = Width:
graphing-calculator-label-inference-count = count
graphing-calculator-label-inference-estimate = estimate
graphing-calculator-label-inference-list = list
graphing-calculator-label-inference-lowercase = inference
graphing-calculator-label-inference-mean = mean
graphing-calculator-label-inference-output-confidence-diagram = Confidence diagram
graphing-calculator-label-inference-output-confidence-lower = Lower
graphing-calculator-label-inference-output-confidence-upper = Upper
graphing-calculator-label-inference-output-degrees-of-freedom = DoF
graphing-calculator-label-inference-output-p = \`p\`-value
graphing-calculator-label-inference-output-point-estimate = Pt. Est.
graphing-calculator-label-inference-output-significance-diagram = Significance diagram
graphing-calculator-label-inference-output-standard-error = StdErr
graphing-calculator-label-inference-output-t = \`t\`-score
graphing-calculator-label-inference-output-z = \`z\`-score
graphing-calculator-label-inference-pop-stdev = pop. stdev
graphing-calculator-label-inference-stdev = stdev
graphing-calculator-label-inference-successes = successes
graphing-calculator-label-inference-ui-confidence-interval = Confidence Interval
graphing-calculator-label-inference-ui-confidence-level = Level:
graphing-calculator-label-inference-ui-export-confidence-diagram = Export confidence interval diagram
graphing-calculator-label-inference-ui-export-significance-diagram = Export significance diagram
graphing-calculator-label-inference-ui-hypothesis = Hypothesis:
graphing-calculator-label-inference-ui-significance-test = Significance Test
graphing-calculator-label-inference-ui-tails = Tails
graphing-calculator-label-inference-wizard-1-mean = 1 mean
graphing-calculator-label-inference-wizard-1-proportion = 1 proportion
graphing-calculator-label-inference-wizard-2-means = 2 means
graphing-calculator-label-inference-wizard-2-proportions = 2 proportions
graphing-calculator-label-inference-wizard-data = Data
graphing-calculator-label-inference-wizard-sample-label = Sample { $index }
graphing-calculator-label-inference-wizard-sample-type = Sample Type
graphing-calculator-label-inference-wizard-stats = Stats
graphing-calculator-label-label-size-tooltip = Label Scale Factor
graphing-calculator-label-line-thickness-3d-tooltip = Line Thickness
graphing-calculator-label-line-thickness-tooltip = Line Thickness (px)
graphing-calculator-label-list-index = Use <1>index</1> to reference the clicked index in the list.
graphing-calculator-label-lock-expression-tooltip = Prevent Editing
graphing-calculator-label-more-viewport-options = More Options
graphing-calculator-label-note-lowercase = note
graphing-calculator-label-opacity-tooltip = Opacity (0 to 1)
graphing-calculator-label-open-graph-tooltip = Open Graph
graphing-calculator-label-open-graph-with-shortcut-tooltip = Open Graph (CTRL+O)
graphing-calculator-label-png = PNG
graphing-calculator-label-poi-unknown-coordinates = unknown coordinates
graphing-calculator-label-point-size-3d-tooltip = Point Size
graphing-calculator-label-point-size-tooltip = Point Size (px)
graphing-calculator-label-powered-by = powered by
graphing-calculator-label-randomize-tooltip = Randomize
graphing-calculator-label-recent-transformations = Recent Transformations
graphing-calculator-label-recenter = Center Origin
graphing-calculator-label-redo-tooltip = Redo
graphing-calculator-label-redo-with-shortcut-tooltip = Redo (CTRL+Y)
graphing-calculator-label-reference-count =
    { $count ->
        [one] (1 reference)
       *[other] ({ $count } references)
    }
graphing-calculator-label-reference-count-in-folder =
    { $count ->
        [one] (1 reference in folder)
       *[other] ({ $count } references in folder)
    }
graphing-calculator-label-regression-log-mode-help-tooltip = Log mode help
graphing-calculator-label-regression-parameters-not-exact = Parameters might not be exact. Click to learn more.
graphing-calculator-label-regression-what-is-rmse-tooltip = What is RMSE? Click to learn more.
graphing-calculator-label-regression-why-is-negative-tooltip = Why is this negative? Click to learn more.
graphing-calculator-label-remove-depressed-image = Remove depressed image
graphing-calculator-label-remove-hovered-image = Remove hovered image
graphing-calculator-label-rename = rename
graphing-calculator-label-resolution-tooltip = 3D Grid Sample Resolution
graphing-calculator-label-search-expressions = Search this graph
graphing-calculator-label-settings-3d-perspective-distortion-ratio = Perspective Distortion Ratio
graphing-calculator-label-settings-3d-perspective-max = Most distortion (Perspective view)
graphing-calculator-label-settings-3d-perspective-min = No distortion (Orthographic view)
graphing-calculator-label-settings-all-axes = All axes:
graphing-calculator-label-settings-arrows = Arrows
graphing-calculator-label-settings-axis-labels-3d = Labels
graphing-calculator-label-settings-axis-numbers = Axis Numbers
graphing-calculator-label-settings-complex-mode = Complex Mode
graphing-calculator-label-settings-domain-plane = XY plane
graphing-calculator-label-settings-grid = Grid
graphing-calculator-label-settings-hidden-objects = Reveal { $count } hidden objects
graphing-calculator-label-settings-lock-viewport = Lock Viewport
graphing-calculator-label-settings-minor-gridlines = Minor Gridlines
graphing-calculator-label-settings-numbers-3d = Numbers
graphing-calculator-label-settings-one-quadrant = One Quadrant
graphing-calculator-label-settings-reverse-contrast = Reverse contrast
graphing-calculator-label-settings-six-key-braille = Six Key Braille Input
graphing-calculator-label-settings-step = Step:
graphing-calculator-label-settings-translucent-surfaces = Translucent surfaces
graphing-calculator-label-settings-x-axis = X-Axis
graphing-calculator-label-settings-y-axis = Y-Axis
graphing-calculator-label-show-keypad = Show Keypad
graphing-calculator-label-slider-disabled-while-ticker-playing = Sliders are disabled while the ticker is running.
graphing-calculator-label-slider-step = Step:
graphing-calculator-label-stats-first-quartile = Q1
graphing-calculator-label-stats-maximum = Max
graphing-calculator-label-stats-median = Median
graphing-calculator-label-stats-minimum = Min
graphing-calculator-label-stats-third-quartile = Q3
graphing-calculator-label-svg = SVG
graphing-calculator-label-table-lowercase = table
graphing-calculator-label-table-regression-type-cubic = Cubic Regression
graphing-calculator-label-table-regression-type-exponential = Exponential Regression
graphing-calculator-label-table-regression-type-linear = Linear Regression
graphing-calculator-label-table-regression-type-logarithmic = Logarithmic Regression
graphing-calculator-label-table-regression-type-logistic = Logistic Regression
graphing-calculator-label-table-regression-type-power = Power Regression
graphing-calculator-label-table-regression-type-quadratic = Quadratic Regression
graphing-calculator-label-table-regression-type-quartic = Quartic Regression
graphing-calculator-label-table-regression-type-sinusoidal = Sinusoidal Regression
graphing-calculator-label-ticker-close = cancel
graphing-calculator-label-ticker-help-tooltip = On slow computers, this might run slower. Use local variable "dt" to capture the actual update speed.
graphing-calculator-label-ticker-lowercase = ticker
graphing-calculator-label-ticker-min-step = Min Step Time
graphing-calculator-label-ticker-pause = pause
graphing-calculator-label-ticker-play = play
graphing-calculator-label-tooltip-geometry-settings = Geometry Settings
graphing-calculator-label-tooltip-graph-settings = Graph Settings
graphing-calculator-label-tooltip-open-graph = Open Graph
graphing-calculator-label-tooltip-reset = Reset
graphing-calculator-label-tooltip-show-list = Show List
graphing-calculator-label-tooltip-viewport-default = Default Viewport
graphing-calculator-label-tooltip-zoom-default-orientation = Default Orientation
graphing-calculator-label-tooltip-zoom-in = Zoom In
graphing-calculator-label-tooltip-zoom-out = Zoom Out
graphing-calculator-label-tooltip-zoom-xy-orientation = XY Orientation
graphing-calculator-label-undo-tooltip = Undo
graphing-calculator-label-undo-with-shortcut-tooltip = Undo (CTRL+Z)
graphing-calculator-label-unlock-expression-tooltip = Allow Editing
graphing-calculator-label-update-on-click = On click:
graphing-calculator-label-update-to-new-behavior = Update to new behavior
graphing-calculator-link-edit-on-desmos = edit graph on
graphing-calculator-link-learn-more = Learn more.
graphing-calculator-link-view-braille-examples = View examples
graphing-calculator-narration-3d-graphpaper-label = three-dimensional graph paper
graphing-calculator-narration-3d-orientation-options-label = Orientation
graphing-calculator-narration-3d-rotate-down = Tilt forward.
graphing-calculator-narration-3d-rotate-left = Rotate left.
graphing-calculator-narration-3d-rotate-right = Rotate right.
graphing-calculator-narration-3d-rotate-up = Tilt backward.
graphing-calculator-narration-3d-rotation-speed = Speed { $speed } \xB0 per second
graphing-calculator-narration-3d-rotation-stopped = Stopped.
graphing-calculator-narration-add-base-case-prompt =
    { $count ->
        [one] Add 1 base case
       *[other] Add { $count } base cases
    }
graphing-calculator-narration-add-expression = Add expression
graphing-calculator-narration-add-folder = Add folder
graphing-calculator-narration-add-image = Add image
graphing-calculator-narration-add-inference = Add inference object
graphing-calculator-narration-add-item-menu = Add Item Menu
graphing-calculator-narration-add-note = Add note
graphing-calculator-narration-add-slider-prompt = Add slider for { $vars }
graphing-calculator-narration-add-table = Add table
graphing-calculator-narration-add-ticker = Add Ticker
graphing-calculator-narration-all-folders-collapsed = all folders collapsed
graphing-calculator-narration-all-folders-expanded = all folders expanded
graphing-calculator-narration-audio-instructions-enter-audio-trace-mac = Press OPTION+T for audio trace.
graphing-calculator-narration-audio-instructions-enter-audio-trace-windows = Press ALT+T for audio trace.
graphing-calculator-narration-audio-trace-branch-not-found = Branch { $branch } does not exist.
graphing-calculator-narration-audio-trace-cannot-change-slider-value = Unable to adjust slider
graphing-calculator-narration-audio-trace-description-branch-count = Branches: { $branches }.
graphing-calculator-narration-audio-trace-description-color = Color: { $color }.
graphing-calculator-narration-audio-trace-description-multiple-extrema = { $count } extrema.
graphing-calculator-narration-audio-trace-description-multiple-intercepts = { $count } intercepts.
graphing-calculator-narration-audio-trace-description-multiple-intersections = { $count } intersections.
graphing-calculator-narration-audio-trace-description-multiple-labels = { $count } point labels.
graphing-calculator-narration-audio-trace-description-multiple-roots = { $count } zero crossings.
graphing-calculator-narration-audio-trace-description-no-curve-selected = No curve selected.
graphing-calculator-narration-audio-trace-description-one-extremum = 1 extremum.
graphing-calculator-narration-audio-trace-description-one-intercept = 1 intercept.
graphing-calculator-narration-audio-trace-description-one-intersection = 1 intersection.
graphing-calculator-narration-audio-trace-description-one-label = 1 point label.
graphing-calculator-narration-audio-trace-description-one-root = 1 zero crossing.
graphing-calculator-narration-audio-trace-description-shading-above = Shading above.
graphing-calculator-narration-audio-trace-description-shading-below = Shading below.
graphing-calculator-narration-audio-trace-description-shading-in-regions = Shading in regions.
graphing-calculator-narration-audio-trace-description-shading-left = Shading on the left.
graphing-calculator-narration-audio-trace-description-shading-right = Shading on the right.
graphing-calculator-narration-audio-trace-description-visible-grid = Grid lines are visible.
graphing-calculator-narration-audio-trace-description-visible-x-axis = X axis visible.
graphing-calculator-narration-audio-trace-description-visible-x-axis-and-label = X axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-x-axis-range = X axis visible from { $xmin } to { $xmax }.
graphing-calculator-narration-audio-trace-description-visible-x-axis-range-and-label = X axis visible from { $xmin } to { $xmax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-xyz-axis-range = X Y and Z axes visible from { $xmin } to { $xmax }.
graphing-calculator-narration-audio-trace-description-visible-y-axis = Y axis visible.
graphing-calculator-narration-audio-trace-description-visible-y-axis-and-label = Y axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-y-axis-range = Y axis visible from { $ymin } to { $ymax }.
graphing-calculator-narration-audio-trace-description-visible-y-axis-range-and-label = Y axis visible from { $ymin } to { $ymax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-z-axis = Z axis visible.
graphing-calculator-narration-audio-trace-description-visible-z-axis-and-label = Z axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-z-axis-range = Z axis visible from { $zmin } to { $zmax }.
graphing-calculator-narration-audio-trace-description-visible-z-axis-range-and-label = Z axis visible from { $zmin } to { $zmax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-expression-with-column = Expression { $index } column { $column }
graphing-calculator-narration-audio-trace-first-point = First point
graphing-calculator-narration-audio-trace-first-slider = First slider.
graphing-calculator-narration-audio-trace-instructions-disable-mac = To disable audio trace, press OPTION+T.
graphing-calculator-narration-audio-trace-instructions-disable-windows = To disable audio trace, press ALT+T.
graphing-calculator-narration-audio-trace-instructions-expression-navigation-mac = To move between expressions, press COMMAND+Up-Arrow or COMMAND+Down-Arrow.
graphing-calculator-narration-audio-trace-instructions-expression-navigation-windows = To move between expressions, press ALT+Up-Arrow or ALT+Down-Arrow.
graphing-calculator-narration-audio-trace-instructions-hear-graph = To hear the graph, press H.
graphing-calculator-narration-audio-trace-instructions-use-arrow-keys = Use Arrow keys to navigate.
graphing-calculator-narration-audio-trace-last-point = Last point
graphing-calculator-narration-audio-trace-last-slider = Last slider.
graphing-calculator-narration-audio-trace-multiple-sliders-paused = { $sliders } animating sliders were paused.
graphing-calculator-narration-audio-trace-no-more-pois = No more points of interest
graphing-calculator-narration-audio-trace-no-sliders-paused = No animating sliders were paused.
graphing-calculator-narration-audio-trace-one-slider-paused = One animating slider was paused.
graphing-calculator-narration-audio-trace-playback-speed = Graph playback speed { $speed }
graphing-calculator-narration-audio-trace-poi-count = Points of interest, { $x }.
graphing-calculator-narration-audio-trace-point-type-definition = Definition
graphing-calculator-narration-audio-trace-point-type-extremum = Extremum
graphing-calculator-narration-audio-trace-point-type-intercept = Intercept
graphing-calculator-narration-audio-trace-point-type-intersection = Intersection
graphing-calculator-narration-audio-trace-point-type-intersection-with-curves = Intersection with { $curves }
graphing-calculator-narration-audio-trace-point-type-label = Label
graphing-calculator-narration-audio-trace-point-type-not-a-poi = Not a P O I
graphing-calculator-narration-audio-trace-point-type-root = Zero
graphing-calculator-narration-audio-trace-point-type-trace = Trace
graphing-calculator-narration-audio-trace-property-branch-number = Branch { $branch }.
graphing-calculator-narration-audio-trace-property-type-before-coordinates = { $type } at
graphing-calculator-narration-audio-trace-property-x = X: { $x }.
graphing-calculator-narration-audio-trace-property-y = Y: { $y }.
graphing-calculator-narration-audio-trace-slider-value-unknown = Unable to determine slider value
graphing-calculator-narration-audio-trace-sound-effects-disabled = Sound effects have been disabled.
graphing-calculator-narration-audio-trace-traceable-curves =
    { $sketchCount ->
        [one] 1 audio traceable curve.
       *[other] { $sketchCount } audio traceable curves.
    }
graphing-calculator-narration-audio-trace-tracing-different-expression = Tracing { $expression }.
graphing-calculator-narration-audio-trace-unable-to-play = Unable to play audio.
graphing-calculator-narration-audio-trace-unable-to-trace-this-expression = Unable to audio trace this expression.
graphing-calculator-narration-audio-trace-unsupported-expression = { $expression } cannot be audio traced.
graphing-calculator-narration-audio-trace-volume = Volume { $volume } percent
graphing-calculator-narration-cdf-maximum = Upper Bound:
graphing-calculator-narration-cdf-minimum = Lower Bound:
graphing-calculator-narration-click-action = Click Action
graphing-calculator-narration-clickable-image-options = Clickable Image Options
graphing-calculator-narration-collapse = Collapse
graphing-calculator-narration-collapse-folder-index = Collapse Folder { $index }
graphing-calculator-narration-collapse-folder-title = Collapse { $folder } folder
graphing-calculator-narration-color-picker-custom-colors-label = Custom
graphing-calculator-narration-color-picker-label = Color Picker
graphing-calculator-narration-color-picker-standard-colors-label = Standard
graphing-calculator-narration-color-unknown = unknown
graphing-calculator-narration-computed-cell-role-description = computed cell
graphing-calculator-narration-configure-toolbar = Geometry Toolbar Configuration
graphing-calculator-narration-create-table = Create Table
graphing-calculator-narration-create-table-expression = Create Table from Expression { $index }
graphing-calculator-narration-create-table-secret-expression = Create Table from Secret Expression { $index }
graphing-calculator-narration-delete = Delete
graphing-calculator-narration-delete-expression = Delete Expression { $index }
graphing-calculator-narration-delete-folder-index = Delete Folder { $index }
graphing-calculator-narration-delete-folder-title = Delete { $folder } folder
graphing-calculator-narration-delete-image = Delete Image { $index }
graphing-calculator-narration-delete-secret-expression = Delete Secret Expression { $index }
graphing-calculator-narration-delete-table = Delete Table { $index }
graphing-calculator-narration-delete-text = Delete Note { $index }
graphing-calculator-narration-describe = Unknown object
graphing-calculator-narration-describe-expression = Expression { $index }
graphing-calculator-narration-describe-folder-index = Folder { $index }
graphing-calculator-narration-describe-folder-title = { $folder } folder
graphing-calculator-narration-describe-image = Image { $index }
graphing-calculator-narration-describe-secret-expression = Secret expression { $index }
graphing-calculator-narration-describe-table = Table { $index }
graphing-calculator-narration-describe-text = Note { $index }
graphing-calculator-narration-description-collapsed-folder = Collapsed Folder
graphing-calculator-narration-description-collapsed-readonly-folder = Collapsed Locked Folder
graphing-calculator-narration-description-collapsed-secret-folder = Collapsed Secret Folder
graphing-calculator-narration-description-collapsed-secret-readonly-folder = Collapsed Secret Locked Folder
graphing-calculator-narration-description-folder = Folder
graphing-calculator-narration-description-hidden-collapsed-folder = Hidden Collapsed Folder
graphing-calculator-narration-description-hidden-collapsed-readonly-folder = Hidden Collapsed Locked Folder
graphing-calculator-narration-description-hidden-collapsed-secret-folder = Hidden Collapsed Secret Folder
graphing-calculator-narration-description-hidden-collapsed-secret-readonly-folder = Hidden Collapsed Secret Locked Folder
graphing-calculator-narration-description-hidden-folder = Hidden Folder
graphing-calculator-narration-description-hidden-readonly-folder = Hidden Locked Folder
graphing-calculator-narration-description-hidden-secret-folder = Hidden Secret Folder
graphing-calculator-narration-description-hidden-secret-readonly-folder = Hidden Secret Locked Folder
graphing-calculator-narration-description-readonly-folder = Locked Folder
graphing-calculator-narration-description-secret-folder = Secret Folder
graphing-calculator-narration-description-secret-readonly-folder = Secret Locked Folder
graphing-calculator-narration-dist-tab-distributions = Distributions
graphing-calculator-narration-dist-tab-visualizations = Visualizations
graphing-calculator-narration-distributions-ui-p-value = Cumulative Probability:
graphing-calculator-narration-domain3d-maximum = domain { $term } Maximum:
graphing-calculator-narration-domain3d-minimum = domain { $term } Minimum:
graphing-calculator-narration-drag-mode-x = X
graphing-calculator-narration-drag-mode-xy = X and Y
graphing-calculator-narration-drag-mode-y = Y
graphing-calculator-narration-draggable-image-off-screen-prompt = { " " }not completely visible on screen
graphing-calculator-narration-duplicate = Duplicate
graphing-calculator-narration-duplicate-expression = Duplicate Expression { $index }
graphing-calculator-narration-duplicate-folder-index = Duplicate Folder { $index }
graphing-calculator-narration-duplicate-folder-title = Duplicate { $folder } folder
graphing-calculator-narration-duplicate-image = Duplicate Image { $index }
graphing-calculator-narration-duplicate-secret-expression = Duplicate Secret Expression { $index }
graphing-calculator-narration-duplicate-table = Duplicate Table { $index }
graphing-calculator-narration-duplicate-text = Duplicate Note { $index }
graphing-calculator-narration-edit-action = Edit Action
graphing-calculator-narration-edit-expression-list = Edit Expression List
graphing-calculator-narration-edit-folder-title = Edit Folder { $index } Title
graphing-calculator-narration-edit-graph-on-desmos = Edit graph on Desmos
graphing-calculator-narration-edit-image-title = Edit Image { $index } Title
graphing-calculator-narration-edit-list-mode-off = Edit list mode off.
graphing-calculator-narration-edit-list-mode-on = Edit list mode on.
graphing-calculator-narration-edit-on-desmos = Edit graph on Desmos
graphing-calculator-narration-edit-slider-variable-limits = Edit { $variable } Limits
graphing-calculator-narration-edit-text-title = Note { $index }
graphing-calculator-narration-edit-title = Edit Title
graphing-calculator-narration-editable-label-mode = Editable label mode
graphing-calculator-narration-editable-point-label = Editable point label
graphing-calculator-narration-expand = Expand
graphing-calculator-narration-expand-folder-index = Expand Folder { $index }
graphing-calculator-narration-expand-folder-title = Expand { $folder } folder
graphing-calculator-narration-expression-audio-trace-mac = To audio trace, press OPTION+T.
graphing-calculator-narration-expression-audio-trace-windows = To audio trace, press ALT+T.
graphing-calculator-narration-expression-bar = Expression Bar
graphing-calculator-narration-expression-evaluation-has-graph = Has graph.
graphing-calculator-narration-expression-evaluation-has-graph-and-regression = Has graph and regression. To access statistics, press Tab.
graphing-calculator-narration-expression-evaluation-has-regression = Has regression. To access statistics, press Tab.
graphing-calculator-narration-expression-evaluation-is-distribution = is distribution.
graphing-calculator-narration-expression-evaluation-is-t-test = is T test. To access statistics, press Tab.
graphing-calculator-narration-expression-hidden-label = Hidden { $label }
graphing-calculator-narration-expression-index-table = Expression { $index } table
graphing-calculator-narration-expression-label = Label
graphing-calculator-narration-expression-tone-muted = Muted tone.
graphing-calculator-narration-expression-tone-unmuted = Unmuted tone.
graphing-calculator-narration-fill-opacity = Fill Opacity:
graphing-calculator-narration-fill-visible = Fill visible
graphing-calculator-narration-folder-collapsed = folder collapsed
graphing-calculator-narration-folder-expanded = folder expanded
graphing-calculator-narration-folder-has-items = { $folder } has { $count } items
graphing-calculator-narration-functions = Functions
graphing-calculator-narration-geometry-added-object-type = Added { $type }.
graphing-calculator-narration-geometry-added-object-type-and-point = Added { $type } and 1 point.
graphing-calculator-narration-geometry-added-object-type-and-points = Added { $type } and { $points } points.
graphing-calculator-narration-geometry-added-points = Added { $points } points.
graphing-calculator-narration-geometry-angle-of-polygon = { $itemDescription } of { $parent }
graphing-calculator-narration-geometry-angle-through-points = { $itemDescription } through { $parent1 }, { $parent2 }, and { $parent3 }
graphing-calculator-narration-geometry-anglebisector-of-item = { $bisectorDescription }, bisector of { $item }
graphing-calculator-narration-geometry-arc-through-points = { $arcDescription } starting at { $start }. Middle at { $middle }. End at { $end }.
graphing-calculator-narration-geometry-arc-with-assignment = Arc { $label }
graphing-calculator-narration-geometry-circle-with-assignment = Circle { $label }
graphing-calculator-narration-geometry-circle-with-center-and-radius = { $circleDescription } with center at { $center } and radius { $radius }.
graphing-calculator-narration-geometry-construct-menu = Construct
graphing-calculator-narration-geometry-construction-icon-label = Token Count
graphing-calculator-narration-geometry-construction-role-description = construction
graphing-calculator-narration-geometry-decagon-with-assignment = Decagon { $label }
graphing-calculator-narration-geometry-dilated-item = dilated { $item }
graphing-calculator-narration-geometry-edge-of-polygon = Edge { $polygonEdge } of { $item }
graphing-calculator-narration-geometry-glider-on-item = { $gliderDescription } on { $item }
graphing-calculator-narration-geometry-glider-with-assignment = Glider { $assignment }
graphing-calculator-narration-geometry-heptagon-with-assignment = Heptagon { $label }
graphing-calculator-narration-geometry-hexagon-with-assignment = Hexagon { $label }
graphing-calculator-narration-geometry-hidden-construction-description = Hidden { $description }
graphing-calculator-narration-geometry-hidden-line = Hidden line
graphing-calculator-narration-geometry-hidden-parallel = Hidden parrallel
graphing-calculator-narration-geometry-hidden-perpendicular = Hidden perpendicular
graphing-calculator-narration-geometry-hidden-ray = Hidden ray
graphing-calculator-narration-geometry-hidden-segment = Hidden segment
graphing-calculator-narration-geometry-hidden-vector = Hidden vector
graphing-calculator-narration-geometry-intersection-of-items = { $intersectionDescription } of { $item1 } and { $item2 }
graphing-calculator-narration-geometry-intersection-with-assignment = Intersection { $assignment }
graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates = { $itemDescription } from { $x1 } { $y1 } to { $x2 } { $y2 }
graphing-calculator-narration-geometry-label-options = Label Options
graphing-calculator-narration-geometry-labeled-angle = Angle { $label }
graphing-calculator-narration-geometry-labeled-directed-angle = Directed Angle { $label }
graphing-calculator-narration-geometry-line-with-assignment = Line { $label }
graphing-calculator-narration-geometry-list-of-angles = List of { $count } angles
graphing-calculator-narration-geometry-list-of-any = List of { $count } unknown objects
graphing-calculator-narration-geometry-list-of-arcs = List of { $count } arcs
graphing-calculator-narration-geometry-list-of-circles = List of { $count } circles
graphing-calculator-narration-geometry-list-of-directed-angles = List of { $count } directed angles
graphing-calculator-narration-geometry-list-of-lines = List of { $count } lines
graphing-calculator-narration-geometry-list-of-points = List of { $count } points
graphing-calculator-narration-geometry-list-of-polygons = List of { $count } polygons
graphing-calculator-narration-geometry-list-of-rays = List of { $count } rays
graphing-calculator-narration-geometry-list-of-segments = List of { $count } segments
graphing-calculator-narration-geometry-midpoint-of-item = { $midpointDescription } of { $item }
graphing-calculator-narration-geometry-midpoint-with-assignment = Midpoint { $assignment }
graphing-calculator-narration-geometry-near-item = Near { $item }.
graphing-calculator-narration-geometry-no-tool-inputs = No inputs exist
graphing-calculator-narration-geometry-nonagon-with-assignment = Nonagon { $label }
graphing-calculator-narration-geometry-nothing-selected = Nothing selected.
graphing-calculator-narration-geometry-octagon-with-assignment = Octagon { $label }
graphing-calculator-narration-geometry-parallel-to-line-through-point = { $parallelDescription } to { $line }, passing through { $point }
graphing-calculator-narration-geometry-parallel-with-assignment = Parallel line { $label }
graphing-calculator-narration-geometry-pentagon-with-assignment = Pentagon { $label }
graphing-calculator-narration-geometry-perpendicular-to-line-through-point = { $perpendicularDescription } to { $line }, passing through { $point }
graphing-calculator-narration-geometry-perpendicular-with-assignment = Perpendicular line { $label }
graphing-calculator-narration-geometry-point-with-assignment = Point { $assignment }
graphing-calculator-narration-geometry-polygon-through-vertices = { $itemDescription } through vertices { $vertices }
graphing-calculator-narration-geometry-polygon-with-sides = { $polygonDescription } with { $sideCount } sides
graphing-calculator-narration-geometry-quadrilateral-with-assignment = Quadrilateral { $label }
graphing-calculator-narration-geometry-ray-with-assignment = Ray { $label }
graphing-calculator-narration-geometry-reflected-item = reflected { $item }
graphing-calculator-narration-geometry-rotated-item = rotated { $item }
graphing-calculator-narration-geometry-segment-length = { $segmentDescription } with length { $length }
graphing-calculator-narration-geometry-segment-with-assignment = Segment { $assignment }
graphing-calculator-narration-geometry-straight-from-item-to-item = { $straightType } from { $start } to { $end }
graphing-calculator-narration-geometry-straight-index-of-item = { $straightType } { $index } of { $item }
graphing-calculator-narration-geometry-style-menu = Style
graphing-calculator-narration-geometry-token-navigator-depth = Depth: { $depth }
graphing-calculator-narration-geometry-token-navigator-label = Token Navigator
graphing-calculator-narration-geometry-tool-cancelled = Cancelled.
graphing-calculator-narration-geometry-tool-disabled = The { $tool } tool is disabled.
graphing-calculator-narration-geometry-transformed-item = transformed { $item }
graphing-calculator-narration-geometry-translated-item = translated { $item }
graphing-calculator-narration-geometry-triangle-with-assignment = Triangle { $label }
graphing-calculator-narration-geometry-unable-to-move = Unable to move.
graphing-calculator-narration-geometry-unlabeled-angle = Angle { $index }
graphing-calculator-narration-geometry-unlabeled-angle-with-measurement = { $measurementText } Angle { $index }
graphing-calculator-narration-geometry-unlabeled-arc = Arc { $index }
graphing-calculator-narration-geometry-unlabeled-circle = Circle { $index }
graphing-calculator-narration-geometry-unlabeled-decagon = Decagon { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle = Directed Angle { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement = { $measurementText } Directed Angle { $index }
graphing-calculator-narration-geometry-unlabeled-glider = Glider { $index }
graphing-calculator-narration-geometry-unlabeled-heptagon = Heptagon { $index }
graphing-calculator-narration-geometry-unlabeled-hexagon = Hexagon { $index }
graphing-calculator-narration-geometry-unlabeled-intersection = Intersection { $index }
graphing-calculator-narration-geometry-unlabeled-line = Line
graphing-calculator-narration-geometry-unlabeled-line-with-index = Line { $index }
graphing-calculator-narration-geometry-unlabeled-midpoint = Midpoint { $index }
graphing-calculator-narration-geometry-unlabeled-nonagon = Nonagon { $index }
graphing-calculator-narration-geometry-unlabeled-octagon = Octagon { $index }
graphing-calculator-narration-geometry-unlabeled-parallel = Parallel line
graphing-calculator-narration-geometry-unlabeled-parallel-with-index = Parallel line { $index }
graphing-calculator-narration-geometry-unlabeled-pentagon = Pentagon { $index }
graphing-calculator-narration-geometry-unlabeled-perpendicular = Perpendicular line
graphing-calculator-narration-geometry-unlabeled-perpendicular-with-index = Perpendicular line { $index }
graphing-calculator-narration-geometry-unlabeled-point = Point { $index }
graphing-calculator-narration-geometry-unlabeled-polygon = Polygon { $index }
graphing-calculator-narration-geometry-unlabeled-quadrilateral = Quadrilateral { $index }
graphing-calculator-narration-geometry-unlabeled-ray = Ray
graphing-calculator-narration-geometry-unlabeled-ray-with-index = Ray { $index }
graphing-calculator-narration-geometry-unlabeled-segment = Segment
graphing-calculator-narration-geometry-unlabeled-segment-with-index = Segment { $index }
graphing-calculator-narration-geometry-unlabeled-triangle = Triangle { $index }
graphing-calculator-narration-geometry-unlabeled-vector = Vector
graphing-calculator-narration-geometry-unlabeled-vector-with-index = Vector { $index }
graphing-calculator-narration-geometry-vector-with-assignment = Vector { $label }
graphing-calculator-narration-graph-settings-controls = Graph Settings Controls
graphing-calculator-narration-graphpaper-label = graph paper
graphing-calculator-narration-hide = Hide
graphing-calculator-narration-hide-animation-properties = Hide Animation Properties
graphing-calculator-narration-hide-expression = Hide Expression { $index }
graphing-calculator-narration-hide-expression-list = Hide expression list
graphing-calculator-narration-hide-folder-index = Hide Folder { $index }
graphing-calculator-narration-hide-folder-title = Hide { $folder } folder
graphing-calculator-narration-hide-image = Hide Image { $index }
graphing-calculator-narration-hide-options = Hide Options
graphing-calculator-narration-hide-options-expression = Hide Options for Expression { $index }
graphing-calculator-narration-hide-options-image = Hide Options for Image { $index }
graphing-calculator-narration-hide-options-secret-expression = Hide Options for Secret Expression { $index }
graphing-calculator-narration-hide-secret-expression = Hide Secret Expression { $index }
graphing-calculator-narration-hide-table = Hide Table { $index }
graphing-calculator-narration-hide-table-column = Hide Column
graphing-calculator-narration-hide-table-regression = Hide Regression
graphing-calculator-narration-hide-text = Hide Note { $index }
graphing-calculator-narration-image-styles = Styles
graphing-calculator-narration-inference-wizard-create-inference = Create
graphing-calculator-narration-inference-wizard-title = Inference
graphing-calculator-narration-item-at-coordinates = { $itemDescription } at { $coordinates }
graphing-calculator-narration-item-hidden = Item hidden.
graphing-calculator-narration-item-visible = Item visible.
graphing-calculator-narration-item-with-list-index = index { $listIndex } of { $item }
graphing-calculator-narration-items-deleted =
    { $count ->
        [one] { $count } item deleted.
       *[other] { $count } items deleted.
    }
graphing-calculator-narration-keypad-hidden = Keypad hidden
graphing-calculator-narration-keypad-key-next-curve = Next Curve
graphing-calculator-narration-keypad-key-next-poi = Next Point of Interest
graphing-calculator-narration-keypad-key-next-point = Next Point
graphing-calculator-narration-keypad-key-previous-curve = Previous Curve
graphing-calculator-narration-keypad-key-previous-poi = Previous Point of Interest
graphing-calculator-narration-keypad-key-previous-point = Previous Point
graphing-calculator-narration-keypad-key-speed-down = Speed Down
graphing-calculator-narration-keypad-key-speed-up = Speed Up
graphing-calculator-narration-keypad-key-volume-down = Volume Down
graphing-calculator-narration-keypad-key-volume-up = Volume Up
graphing-calculator-narration-keypad-visible = Keypad visible
graphing-calculator-narration-label-angle = Label Angle:
graphing-calculator-narration-label-menu = Label
graphing-calculator-narration-label-size = Label Size:
graphing-calculator-narration-label-text = Label Text
graphing-calculator-narration-label-visible = Label visible
graphing-calculator-narration-line-opacity = Line Opacity:
graphing-calculator-narration-line-style-dashed = Dashed
graphing-calculator-narration-line-style-dotted = Dotted
graphing-calculator-narration-line-style-solid = Solid
graphing-calculator-narration-lines-visible = Lines visible
graphing-calculator-narration-locked-items-not-deleted =
    { $count ->
        [one] { $count } locked item could not be deleted.
       *[other] { $count } locked items could not be deleted.
    }
graphing-calculator-narration-main-desmos-geometry = Desmos Geometry
graphing-calculator-narration-main-desmos-graphing-calculator = Desmos Graphing Calculator
graphing-calculator-narration-make-clickable = make clickable
graphing-calculator-narration-menu-drag-enabled = Drag Enabled
graphing-calculator-narration-movable-point-off-screen-prompt = { " " }not visible on screen
graphing-calculator-narration-movable-point-prefix = Point
graphing-calculator-narration-movable-point-suffix-usage-instructions = { " " }is movable. Press Arrows or Shift+Arrows to adjust.
graphing-calculator-narration-mute = Mute
graphing-calculator-narration-mute-all = Mute all
graphing-calculator-narration-mute-expression = Mute Expression { $index }
graphing-calculator-narration-mute-secret-expression = Mute Secret Expression { $index }
graphing-calculator-narration-muted = Muted
graphing-calculator-narration-no-geometry-tools-available = No geometry tools available.
graphing-calculator-narration-no-playing-tones = No currently playing tones
graphing-calculator-narration-no-tone-expressions = No tones in this graph
graphing-calculator-narration-options-menu = Options Menu
graphing-calculator-narration-options-menu-closed = Options menu closed.
graphing-calculator-narration-options-menu-open = Options menu open.
graphing-calculator-narration-pause-variable-animation = Pause { $variable } Animation
graphing-calculator-narration-play-variable-animation = Play { $variable } Animation
graphing-calculator-narration-poi-graph-point = Point
graphing-calculator-narration-point-size = Point Size:
graphing-calculator-narration-point-style-cross = Cross
graphing-calculator-narration-point-style-diamond = Diamond
graphing-calculator-narration-point-style-open = Open
graphing-calculator-narration-point-style-plus = Plus
graphing-calculator-narration-point-style-point = Point
graphing-calculator-narration-point-style-square = Square
graphing-calculator-narration-point-style-star = Star
graphing-calculator-narration-point-style-triangle = Triangle
graphing-calculator-narration-points-visible = Points visible
graphing-calculator-narration-powered-by-desmos = Powered by Desmos
graphing-calculator-narration-redo = Redo
graphing-calculator-narration-rename = Rename
graphing-calculator-narration-rename-expression = Rename in Expression { $index }
graphing-calculator-narration-rename-secret-expression = Rename in Secret Expression { $index }
graphing-calculator-narration-rename-table = Rename in Table { $index }
graphing-calculator-narration-run-action-icon = Run Action
graphing-calculator-narration-settings-all-axes-max = Max for x, y, and z
graphing-calculator-narration-settings-all-axes-min = Min for x, y, and z
graphing-calculator-narration-settings-angle = Angle Settings
graphing-calculator-narration-settings-cartesian-grid = Cartesian Grid
graphing-calculator-narration-settings-polar-grid = Polar Grid
graphing-calculator-narration-settings-show-both = Show Both
graphing-calculator-narration-settings-show-positive = Show Positive
graphing-calculator-narration-settings-x-axis-label-placeholder = e.g. \u201Cx\u201D
graphing-calculator-narration-settings-x-axis-max = X Axis Maximum:{ " " }
graphing-calculator-narration-settings-x-axis-min = X Axis Minimum:{ " " }
graphing-calculator-narration-settings-x-axis-step = X Axis Step Size:{ " " }
graphing-calculator-narration-settings-y-axis-label-placeholder = e.g. \u201Cy\u201D
graphing-calculator-narration-settings-y-axis-max = Y Axis Maximum:{ " " }
graphing-calculator-narration-settings-y-axis-min = Y Axis Minimum:{ " " }
graphing-calculator-narration-settings-y-axis-step = Y Axis Step Size:{ " " }
graphing-calculator-narration-settings-z-axis-max = Z Axis Maximum:{ " " }
graphing-calculator-narration-settings-z-axis-min = Z Axis Minimum:{ " " }
graphing-calculator-narration-share-graph-link = Link to this graph
graphing-calculator-narration-share-graph-link-copied = Link copied
graphing-calculator-narration-share-graph-link-unable-to-copy = Unable to copy link
graphing-calculator-narration-show = Show
graphing-calculator-narration-show-animation-properties = Show Animation Properties
graphing-calculator-narration-show-expression = Show Expression { $index }
graphing-calculator-narration-show-folder-index = Show Folder { $index }
graphing-calculator-narration-show-folder-title = Show { $folder } folder
graphing-calculator-narration-show-image = Show Image { $index }
graphing-calculator-narration-show-options = Show Options
graphing-calculator-narration-show-options-expression = Show Options for Expression { $index }
graphing-calculator-narration-show-options-image = Show Options for Image { $index }
graphing-calculator-narration-show-options-secret-expression = Show Options for Secret Expression { $index }
graphing-calculator-narration-show-secret-expression = Show Secret Expression { $index }
graphing-calculator-narration-show-table = Show Table { $index }
graphing-calculator-narration-show-table-column = Show Column
graphing-calculator-narration-show-table-regression = Show Regression
graphing-calculator-narration-show-text = Show Note { $index }
graphing-calculator-narration-slider-animate-faster = Animate Faster
graphing-calculator-narration-slider-animate-slower = Animate Slower
graphing-calculator-narration-slider-animating-at-speed = Animating at { $speed }x
graphing-calculator-narration-slider-loop-forwards-and-backwards = Loop forwards and backwards
graphing-calculator-narration-slider-maximum = Slider Maximum:
graphing-calculator-narration-slider-minimum = Slider Minimum:
graphing-calculator-narration-slider-play-indefinitely = Play indefinitely
graphing-calculator-narration-slider-play-once = Play once
graphing-calculator-narration-slider-repeat-one-direction = Repeat in one direction
graphing-calculator-narration-slider-step = Slider Step Size:
graphing-calculator-narration-slider-trace-no-sliders = No sliders to trace.
graphing-calculator-narration-slider-trace-off = Slider trace off.
graphing-calculator-narration-slider-trace-on = Slider trace on.
graphing-calculator-narration-slider-variable-paused = { $variable } paused
graphing-calculator-narration-slider-variable-playing = { $variable } playing
graphing-calculator-narration-slider-variable-restarted = { $variable } restarted
graphing-calculator-narration-slow-compute = Is taking a long time to compute.
graphing-calculator-narration-slow-evaluation = Is taking a long time to evaluate.
graphing-calculator-narration-style-menu = Style Menu
graphing-calculator-narration-surface-opacity = Surface Opacity:
graphing-calculator-narration-surfaces-visible = Surfaces visible
graphing-calculator-narration-table-no-column-header = No column header
graphing-calculator-narration-table-regression-equation = Regression Equation
graphing-calculator-narration-tick-action = Tick Action
graphing-calculator-narration-toggle-audio-trace = Toggle Audio Trace
graphing-calculator-narration-toggle-letters = Toggle Letters
graphing-calculator-narration-unable-to-add-expression = Unable to add expression
graphing-calculator-narration-unable-to-add-note = Unable to add note
graphing-calculator-narration-unable-to-add-table = Unable to add table
graphing-calculator-narration-unable-to-add-table-regression = Unable to add regression
graphing-calculator-narration-undo = Undo
graphing-calculator-narration-unmute = Unmute
graphing-calculator-narration-unmute-all = Unmute all
graphing-calculator-narration-unmute-expression = Unmute Expression { $index }
graphing-calculator-narration-unmute-secret-expression = Unmute Secret Expression { $index }
graphing-calculator-narration-unmuted = Unmuted
graphing-calculator-narration-viewport-default = Graph viewport default
graphing-calculator-narration-viewport-pan-down = Graph pan down
graphing-calculator-narration-viewport-pan-left = Graph pan left
graphing-calculator-narration-viewport-pan-right = Graph pan right
graphing-calculator-narration-viewport-pan-up = Graph pan up
graphing-calculator-narration-viewport-updated = Graph viewport updated.
graphing-calculator-narration-viewport-zoom-3d-default = Graph set to default orientation
graphing-calculator-narration-viewport-zoom-3d-xy = Graph set to X Y orientation
graphing-calculator-narration-viewport-zoom-in = Graph zoom in
graphing-calculator-narration-viewport-zoom-out = Graph zoom out
graphing-calculator-narration-viewport-zoom-recenter = Graph recenter
graphing-calculator-narration-viewport-zoom-square = Graph zoom square
graphing-calculator-narration-visual-parameters-height = Height
graphing-calculator-narration-visual-parameters-offset = Offset
graphing-calculator-narration-visual-parameters-width = Width
graphing-calculator-narration-x-percentage-coordinate = { $x } percent from left.
graphing-calculator-narration-y-percentage-coordinate = { $y } percent from top.
graphing-calculator-narration-zoom-options-label = Zoom
graphing-calculator-text-add-screen-reader-label-placeholder = Add screen reader label
graphing-calculator-text-arrow-mode-both = Both
graphing-calculator-text-arrow-mode-default = Default
graphing-calculator-text-arrow-mode-none = None
graphing-calculator-text-arrow-mode-positive = Positive
graphing-calculator-text-audio-trace-no-implicit-support = Sorry, but I can't trace implicit curves yet.
graphing-calculator-text-audio-trace-no-parametric-support = Sorry, but I can't trace parametric curves yet.
graphing-calculator-text-audio-trace-no-polar-support = Sorry, but I can't trace polar curves yet.
graphing-calculator-text-audio-trace-off = Audio trace off.
graphing-calculator-text-audio-trace-on = Audio trace on.
graphing-calculator-text-color-black = black
graphing-calculator-text-color-blue = blue
graphing-calculator-text-color-cyan = cyan
graphing-calculator-text-color-dark-blue = dark blue
graphing-calculator-text-color-dark-cyan = dark cyan
graphing-calculator-text-color-dark-gray = dark gray
graphing-calculator-text-color-dark-green = dark green
graphing-calculator-text-color-dark-indigo = dark indigo
graphing-calculator-text-color-dark-lime = dark lime
graphing-calculator-text-color-dark-magenta = dark magenta
graphing-calculator-text-color-dark-orange = dark orange
graphing-calculator-text-color-dark-pink = dark pink
graphing-calculator-text-color-dark-red = dark red
graphing-calculator-text-color-dark-teal = dark teal
graphing-calculator-text-color-dark-violet = dark violet
graphing-calculator-text-color-dark-yellow = dark yellow
graphing-calculator-text-color-gray = gray
graphing-calculator-text-color-green = green
graphing-calculator-text-color-indigo = indigo
graphing-calculator-text-color-light-blue = light blue
graphing-calculator-text-color-light-cyan = light cyan
graphing-calculator-text-color-light-gray = light gray
graphing-calculator-text-color-light-green = light green
graphing-calculator-text-color-light-indigo = light indigo
graphing-calculator-text-color-light-lime = light lime
graphing-calculator-text-color-light-magenta = light magenta
graphing-calculator-text-color-light-orange = light orange
graphing-calculator-text-color-light-pink = light pink
graphing-calculator-text-color-light-red = light red
graphing-calculator-text-color-light-teal = light teal
graphing-calculator-text-color-light-violet = light violet
graphing-calculator-text-color-light-yellow = light yellow
graphing-calculator-text-color-lime = lime
graphing-calculator-text-color-magenta = magenta
graphing-calculator-text-color-orange = orange
graphing-calculator-text-color-pink = pink
graphing-calculator-text-color-purple = purple
graphing-calculator-text-color-red = red
graphing-calculator-text-color-teal = teal
graphing-calculator-text-color-unknown = color unknown
graphing-calculator-text-color-violet = violet
graphing-calculator-text-color-white = white
graphing-calculator-text-color-yellow = yellow
graphing-calculator-text-complex-plotting-note = Note: complex values will be plotted as (real, imag)
graphing-calculator-text-distribution-tails-both = Both
graphing-calculator-text-distribution-tails-left = Left
graphing-calculator-text-distribution-tails-right = Right
graphing-calculator-text-enter-pareneter = Enter the { $param }.
graphing-calculator-text-export-braille-email-accessibility = Feedback? Email <1>accessibility@desmos.com</1>.
graphing-calculator-text-export-snapshot = Export a snapshot to the expression list
graphing-calculator-text-folder-placeholder = Untitled folder
graphing-calculator-text-geometry-arrow-mode = Arrow Mode: { $mode }
graphing-calculator-text-geometry-delete-selected-objects =
    { $count ->
        [one] Delete 1 object
       *[other] Delete { $count } objects
    }
graphing-calculator-text-geometry-delete-selected-unlocked-objects =
    { $count ->
        [one] Delete 1 unlocked object
       *[other] Delete { $count } unlocked objects
    }
graphing-calculator-text-geometry-glider = glider
graphing-calculator-text-geometry-hide-objects = Hide
graphing-calculator-text-geometry-intersection = intersection
graphing-calculator-text-geometry-move-to-expression-list-message = Move to expression list
graphing-calculator-text-geometry-multi-select-more-dropdown = More
graphing-calculator-text-geometry-no-constructed-objects = No constructed objects yet.
graphing-calculator-text-geometry-select-hint = Select a { $type }
graphing-calculator-text-geometry-selected-objects =
    { $count ->
        [one] 1 object selected
       *[other] { $count } objects selected
    }
graphing-calculator-text-geometry-show-objects = Show
graphing-calculator-text-geometry-tool-angle-bisector-display-name = Angle bisector
graphing-calculator-text-geometry-tool-angle-bisector-hint-angle = Choose an angle to bisect
graphing-calculator-text-geometry-tool-angle-display-name = Angle
graphing-calculator-text-geometry-tool-angle-hint-1 = Choose a starting point
graphing-calculator-text-geometry-tool-angle-hint-2 = Choose a vertex point
graphing-calculator-text-geometry-tool-angle-hint-3 = Choose an endpoint
graphing-calculator-text-geometry-tool-angles-hint-1 = Choose a starting point or a polygon
graphing-calculator-text-geometry-tool-arc-display-name = Arc
graphing-calculator-text-geometry-tool-arc-hint-1 = Choose a point (start)
graphing-calculator-text-geometry-tool-arc-hint-2 = Choose a point (middle)
graphing-calculator-text-geometry-tool-arc-hint-3 = Choose a point (end)
graphing-calculator-text-geometry-tool-box-selection-display-name = Box Select
graphing-calculator-text-geometry-tool-circle-by-length-display-name = Circle by length
graphing-calculator-text-geometry-tool-circle-display-name = Circle
graphing-calculator-text-geometry-tool-circle-hint-center = Choose a point (center)
graphing-calculator-text-geometry-tool-circle-hint-radius = Choose a point (radius)
graphing-calculator-text-geometry-tool-compass-hint-center = Choose a center point
graphing-calculator-text-geometry-tool-compass-hint-segment = Choose a segment to set the radius
graphing-calculator-text-geometry-tool-dilate-display-name = Dilate
graphing-calculator-text-geometry-tool-dilation-hint-center = Choose point (center)
graphing-calculator-text-geometry-tool-dilation-hint-scale-factor = Scale factor
graphing-calculator-text-geometry-tool-directed-angle-display-name = Directed Angle
graphing-calculator-text-geometry-tool-directedangle-display-name = Directed angle
graphing-calculator-text-geometry-tool-expression-edit-display-name = Insert into current expression.
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-0 = No valid inputs
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-1 = Choose { $type }
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-2 = Choose { $type1 } or { $type2 }
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-any-object = Choose any object
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-many = Choose one of the following: { $types }
graphing-calculator-text-geometry-tool-expression-edit-starting-transformation-hint = Choose an object to transform
graphing-calculator-text-geometry-tool-line-display-name = Line
graphing-calculator-text-geometry-tool-line-hint-end = Choose a 2nd point
graphing-calculator-text-geometry-tool-line-hint-start = Choose a 1st point
graphing-calculator-text-geometry-tool-midpoint-display-name = Midpoint
graphing-calculator-text-geometry-tool-midpoint-hint = Choose a segment
graphing-calculator-text-geometry-tool-parallel-display-name = Parallel
graphing-calculator-text-geometry-tool-parallel-hint-point = Choose a point to pass through
graphing-calculator-text-geometry-tool-parallel-hint-straight-line = Choose a line to be parallel to
graphing-calculator-text-geometry-tool-perpendicular-display-name = Perpendicular
graphing-calculator-text-geometry-tool-perpendicular-hint-point = Choose a point to pass through
graphing-calculator-text-geometry-tool-perpendicular-hint-straight-line = Choose a line to be perpendicular to
graphing-calculator-text-geometry-tool-point-display-name = Point
graphing-calculator-text-geometry-tool-point-hint = Select or create a point
graphing-calculator-text-geometry-tool-polygon-display-name = Polygon
graphing-calculator-text-geometry-tool-polygon-hint-finish-point = Choose another point, or click an existing point to finish
graphing-calculator-text-geometry-tool-polygon-hint-first-point = Choose a point
graphing-calculator-text-geometry-tool-polygon-hint-next-point = Choose another point
graphing-calculator-text-geometry-tool-ray-display-name = Ray
graphing-calculator-text-geometry-tool-ray-hint-end = Choose a point (direction)
graphing-calculator-text-geometry-tool-ray-hint-start = Choose a point (vertex)
graphing-calculator-text-geometry-tool-reflect-display-name = Reflect
graphing-calculator-text-geometry-tool-reflection-hint-choose-line = Choose line of reflection
graphing-calculator-text-geometry-tool-rotate-display-name = Rotate
graphing-calculator-text-geometry-tool-rotation-hint-angle = Choose angle
graphing-calculator-text-geometry-tool-rotation-hint-angle-end = Choose angle end point
graphing-calculator-text-geometry-tool-rotation-hint-angle-start = Construct or choose angle
graphing-calculator-text-geometry-tool-rotation-hint-center = Choose point (center)
graphing-calculator-text-geometry-tool-segment-display-name = Segment
graphing-calculator-text-geometry-tool-segment-hint-end = Choose another point
graphing-calculator-text-geometry-tool-segment-hint-start = Choose a point
graphing-calculator-text-geometry-tool-selection-display-name = Select
graphing-calculator-text-geometry-tool-translate-display-name = Translate
graphing-calculator-text-geometry-tool-translation-hint-from-with-vector = Choose start point or a vector
graphing-calculator-text-geometry-tool-translation-hint-to = Choose end point
graphing-calculator-text-geometry-tool-vector-copy-display-name = Copy of Vector
graphing-calculator-text-geometry-tool-vector-copy-hint-end = Choose new start point for copy
graphing-calculator-text-geometry-tool-vector-display-name = Vector
graphing-calculator-text-geometry-tool-vector-end-point-display-name = Vector End Point
graphing-calculator-text-geometry-tool-vector-hint-end = Choose end point
graphing-calculator-text-geometry-tool-vector-hint-start = Choose start point or a vector to copy
graphing-calculator-text-geometry-tool-vector-start-point-display-name = Vector Start Point
graphing-calculator-text-image-placeholder = Unnamed image
graphing-calculator-text-label-orientation-above = Above
graphing-calculator-text-label-orientation-above-left = Above Left
graphing-calculator-text-label-orientation-above-right = Above Right
graphing-calculator-text-label-orientation-below = Below
graphing-calculator-text-label-orientation-below-left = Below Left
graphing-calculator-text-label-orientation-below-right = Below Right
graphing-calculator-text-label-orientation-default = Default
graphing-calculator-text-label-orientation-left = Left
graphing-calculator-text-label-orientation-right = Right
graphing-calculator-text-loading-image = Loading image...
graphing-calculator-text-make-custom-regression = Make a custom regression model in a new line using <1>~</1>. <2>Learn how</2>.
graphing-calculator-text-note-placeholder = Empty note
graphing-calculator-text-parameter-name-binwidth = Bin Width
graphing-calculator-text-parameter-name-data = Data Set
graphing-calculator-text-parameter-name-dof = Degrees of Freedom
graphing-calculator-text-parameter-name-height = Height
graphing-calculator-text-parameter-name-max = Maximum
graphing-calculator-text-parameter-name-mean = Mean
graphing-calculator-text-parameter-name-min = Minimum
graphing-calculator-text-parameter-name-offset = Offset
graphing-calculator-text-parameter-name-probsuccess = Success Probability
graphing-calculator-text-parameter-name-scale = Scale
graphing-calculator-text-parameter-name-shift = Shift
graphing-calculator-text-parameter-name-stddev = Standard Deviation
graphing-calculator-text-parameter-name-trials = Trials
graphing-calculator-text-refreshable-braille-display-note = Use a refreshable Braille display, or just type Braille with a keyboard.
graphing-calculator-text-regression-potentially-inaccurate-parameters = Some parameters may be too large or small to represent accurately.
graphing-calculator-text-share-graph-link = Link to this graph
graphing-calculator-text-table-created = Table created.
graphing-calculator-text-table-creation-error = Error creating table.
graphing-calculator-text-table-more-rows = { $rowCount } more rows
graphing-calculator-text-toast-choose-one-file = You can only choose one file as a replacement
graphing-calculator-text-toast-error-importing-graph = Error importing graph. Check the URL?
graphing-calculator-text-toast-error-no-folders = Only graphs without folders can be inserted into a folder.
graphing-calculator-text-toast-expression-size-limit = Maximum expression size reached.
graphing-calculator-text-toast-graph-cleared = Graph cleared.
graphing-calculator-text-toast-graph-reset = Graph reset.
graphing-calculator-text-toast-image-upload-failed = Image upload failed.
graphing-calculator-text-toast-imported-graph = Graph imported!
graphing-calculator-text-toast-importing-graph = Importing graph...
graphing-calculator-text-toast-no-file-selected = You did not select a file
graphing-calculator-text-toast-uploading-images = Uploading images...
graphing-calculator-text-toast-zoom-to-fit = We zoomed to fit your data.
graphing-calculator-text-undefined-parameter = { $parameter } is undefined
graphing-calculator-text-view-regression-options = Regression options
graphing-calculator-text-zoom-fit = Zoom Fit
graphing-tours-heading-quest-success = You completed the "{ $title }" quest.
graphing-tours-heading-regressions = Regressions
graphing-tours-heading-restrictions = Restrictions
graphing-tours-heading-sliders = Sliders
graphing-tours-heading-tables = Tables
graphing-tours-label-add-regression = Click here to add a regression.
graphing-tours-label-add-slider = Add a slider
graphing-tours-label-awesome = Awesome!
graphing-tours-label-brilliant = Brilliant!
graphing-tours-label-change-color = Change color
graphing-tours-label-check-progress = Check my progress
graphing-tours-label-close-quest = Exit quest
graphing-tours-label-close-quests = Exit quests
graphing-tours-label-close-tour = Close tour
graphing-tours-label-new-item = Click here to add a new item.
graphing-tours-label-next-step-countdown = Continuing in { $seconds }...
graphing-tours-label-nice = Nice!
graphing-tours-label-quest-back-to-quest = Back to quest
graphing-tours-label-quest-take-a-tour = Take a tour
graphing-tours-label-quest-tours = Looking around? Try a quick tour.
graphing-tours-label-quest-tours-aria = Tours that might help with this quest
graphing-tours-label-regressions-better-fit = Edit this equation to find a better fit. Try, for example:<br>{ $equation }
graphing-tours-label-regressions-check-model = Nice. Let's check the model.
graphing-tours-label-regressions-data = First, let's get some data.
graphing-tours-label-regressions-data-2 = Let's start with some data!
graphing-tours-label-regressions-docs = Head over to Google Docs and copy and paste this { $sample_data_link }.
graphing-tours-label-regressions-equation = Now type: { $equation }
graphing-tours-label-regressions-expression-option = ... and select the "expression" option.
graphing-tours-label-regressions-fill-sample-data = Fill in the sample data:
graphing-tours-label-regressions-hint-1 = Hint #1: to get { $y_1 } type { $y1 }.
graphing-tours-label-regressions-hint-2 = Hint #2: { $twiddle } is in our onscreen keypad in the 'A B C' section.
graphing-tours-label-regressions-keep-exploring = Nice work \u2013 Keep exploring!
graphing-tours-label-regressions-new-model = Now, let's try a new model.
graphing-tours-label-regressions-new-table = Click here to add a new table.
graphing-tours-label-regressions-own-data = Note: you can add your own data instead by clicking the { $plus_icon } button.
graphing-tours-label-regressions-residuals = Residuals are the difference between your data and your model. Click here to add them to your table and plot them on the graph.
graphing-tours-label-regressions-sample-data = sample data
graphing-tours-label-require-expressions-visible = Click to show the list of expressions.
graphing-tours-label-require-not-edit-list-mode = Click to return to your expressions.
graphing-tours-label-require-resources-not-open = Click to return to this graph.
graphing-tours-label-restrictions-abc = Hint: press the 'A B C' button on the keypad to find the { $buttons } buttons
graphing-tours-label-restrictions-blank-expression = Click here to make a new blank expression.
graphing-tours-label-restrictions-change-equation = Change this equation to { $sample_expression }
graphing-tours-label-restrictions-change-model = Use this menu to switch to a different regression model.
graphing-tours-label-restrictions-domain = Restrict the domain of this line by adding { $sample_expression } to the end.
graphing-tours-label-restrictions-dont-forget = Don't forget the "y="!
graphing-tours-label-restrictions-graph-parabola = Now graph: { $sample_expression }
graphing-tours-label-restrictions-move-parabola = Move the parabola.
graphing-tours-label-restrictions-new-expression = Click here to create a new expression.
graphing-tours-label-restrictions-range = Now let's restrict the range. Add { $sample_expression } to the end.
graphing-tours-label-restrictions-star = You're a restrictions star!
graphing-tours-label-restrictions-start = Let's get started!
graphing-tours-label-restrictions-straight-line = Try graphing a straight line, like { $sample_expression }
graphing-tours-label-restrictions-type-all = Try typing all of { $sample_expression }
graphing-tours-label-restrictions-typing-hint = Hint: you can type { $suggestion1 }, or use the { $suggestion2 } button on the keypad below.
graphing-tours-label-self-destruct = This message will self-destruct in { $seconds }...
graphing-tours-label-show-surface = Show 3D surface
graphing-tours-label-sliders-add = Now click here to add the sliders.
graphing-tours-label-sliders-blank-expression = Click here to create a new blank expression.
graphing-tours-label-sliders-change-value = Type in here to change the value.
graphing-tours-label-sliders-drag-handle = Drag the handle to change the value.
graphing-tours-label-sliders-hands-free = Go "Hands-free"
graphing-tours-label-sliders-make-sliders = Let's make some sliders!
graphing-tours-label-sliders-press-play = Press play to animate the slider.
graphing-tours-label-sliders-pro = You're a slider pro!
graphing-tours-label-sliders-try-typing = Try typing { $sample_expression }
graphing-tours-label-tables-back = Click back to continue editing.
graphing-tours-label-tables-close-options = Click anywhere to close the drawing options.
graphing-tours-label-tables-dots = Click here to connect the dots.
graphing-tours-label-tables-enter = Now try pressing Enter.
graphing-tours-label-tables-fill-another = Just fill in one more...
graphing-tours-label-tables-fill-cell = Fill it in.
graphing-tours-label-tables-fill-row = Fill in this whole row.
graphing-tours-label-tables-last-trick = Last trick!
graphing-tours-label-tables-next-row = Go down to the next row to add more data.
graphing-tours-label-tables-open-options = Click and hold on this icon until the options menu opens up.
graphing-tours-label-tables-scroll = Scroll back up to the table.
graphing-tours-label-tables-select-table = ... and select the "table" option.
graphing-tours-label-tables-start = Let's make a table!
graphing-tours-label-tables-type-number = Type any number here.
graphing-tours-label-tables-valid-number = Uh-oh! Type a valid number here.
graphing-tours-label-tables-whiz = You're a tables whiz!
graphing-tours-label-turn-off-axes = Turn off axes
graphing-tours-narration-exiting-quest = Exiting quest.
graphing-tours-narration-quest-goal-complete = { $goal }. Complete.
graphing-tours-narration-quest-goal-incomplete = { $goal }. Incomplete.
graphing-tours-narration-quest-started = Started "{ $title }" quest.
graphing-tours-narration-quest-thumbnail = Thumbnail for '{ $title }' quest
graphing-tours-narration-tour-thumbnail = Thumbnail for '{ $title }' tour
matrix-calculator-narration-keypad-key-det = Determinant
matrix-calculator-narration-keypad-key-inverse = Inverse
matrix-calculator-narration-keypad-key-rref = Reduced row echelon form
matrix-calculator-narration-keypad-key-trace = Trace
matrix-calculator-narration-keypad-key-transpose = Transpose
frontpage-error-something-went-wrong-try-again-later = Sorry! Something went wrong. Please try again later.
frontpage-link-art-contest-age-range-13-14 = Ages 13-14
frontpage-link-art-contest-age-range-15-16 = Ages 15-16
frontpage-link-art-contest-age-range-17-18 = Ages 17-18
frontpage-link-art-contest-age-range-19 = Ages 19+
frontpage-link-header-math-tools = Math Tools
frontpage-link-header-resources = Resources
frontpage-link-shared-3d-calculator = 3D Calculator
frontpage-link-shared-3d-calculator-short = 3D
frontpage-link-shared-about-us = About Us
frontpage-link-shared-assessments = Assessments
frontpage-link-shared-blog = Des-Blog
frontpage-link-shared-careers = Careers
frontpage-link-shared-design-principles = Design Principles
frontpage-link-shared-four-function-calculator = Four-Function Calculator
frontpage-link-shared-four-function-calculator-short = Four Function
frontpage-link-shared-geometry-short = Geometry
frontpage-link-shared-geometry-tool = Geometry Tool
frontpage-link-shared-graphing-calculator = Graphing Calculator
frontpage-link-shared-graphing-calculator-short = Graphing
frontpage-link-shared-guiding-principles = Guiding Principles
frontpage-link-shared-help-center = Help Center
frontpage-link-shared-matrix-calculator = Matrix Calculator
frontpage-link-shared-matrix-calculator-short = Matrix
frontpage-link-shared-partnerships = Partnerships
frontpage-link-shared-scientific-calculator = Scientific Calculator
frontpage-link-shared-scientific-calculator-short = Scientific
frontpage-link-shared-store = Desmos Store
frontpage-link-shared-test-practice = Test Practice
frontpage-narration-art-contest-image-of-graph = Image of { $graphTitle }
frontpage-narration-art-contest-image-of-graph-by = Image of graph by { $name }
frontpage-narration-shared-assessment-calculator = Assessment { $calculatorType }
frontpage-narration-shared-desmos-logo = Desmos Logo
frontpage-text-art-contest-name-and-country = by { $name }, { $country }
frontpage-text-header-terms-update = We've updated our Terms of Service.































































































































































































































































































































































































































































































































































































































































































































































































































































































`;var Mg=class{constructor(e){this.value=e}valueOf(){return this.value}},Bo=class extends Mg{constructor(e="???"){super(e)}toString(e){return`{${this.value}}`}},Xs=class extends Mg{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),this.value.toString(10)}}},hp=class extends Mg{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),new Date(this.value).toISOString()}}};var TH=100,Rce="\u2068",Fce="\u2069";function Nce(r,e,t){if(t===e||t instanceof Xs&&e instanceof Xs&&t.value===e.value)return!0;if(e instanceof Xs&&typeof t=="string"){let o=r.memoizeIntlObject(Intl.PluralRules,e.opts).select(e.value);if(t===o)return!0}return!1}function EH(r,e,t){return e[t]?lv(r,e[t].value):(r.reportError(new RangeError("No default")),new Bo)}function CF(r,e){let t=[],o=Object.create(null);for(let i of e)i.type==="narg"?o[i.name]=I0(r,i.value):t.push(I0(r,i));return{positional:t,named:o}}function I0(r,e){switch(e.type){case"str":return e.value;case"num":return new Xs(e.value,{minimumFractionDigits:e.precision});case"var":return Uce(r,e);case"mesg":return Yce(r,e);case"term":return Bce(r,e);case"func":return Kce(r,e);case"select":return zce(r,e);default:return new Bo}}function Uce(r,{name:e}){let t;if(r.params)if(Object.prototype.hasOwnProperty.call(r.params,e))t=r.params[e];else return new Bo(`$${e}`);else if(r.args&&Object.prototype.hasOwnProperty.call(r.args,e))t=r.args[e];else return r.reportError(new ReferenceError(`Unknown variable: $${e}`)),new Bo(`$${e}`);if(t instanceof Mg)return t;switch(typeof t){case"string":return t;case"number":return new Xs(t);case"object":if(t instanceof Date)return new hp(t.getTime());default:return r.reportError(new TypeError(`Variable type not supported: $${e}, ${typeof t}`)),new Bo(`$${e}`)}}function Yce(r,{name:e,attr:t}){let o=r.bundle._messages.get(e);if(!o)return r.reportError(new ReferenceError(`Unknown message: ${e}`)),new Bo(e);if(t){let i=o.attributes[t];return i?lv(r,i):(r.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Bo(`${e}.${t}`))}return o.value?lv(r,o.value):(r.reportError(new ReferenceError(`No value: ${e}`)),new Bo(e))}function Bce(r,{name:e,attr:t,args:o}){let i=`-${e}`,n=r.bundle._terms.get(i);if(!n)return r.reportError(new ReferenceError(`Unknown term: ${i}`)),new Bo(i);if(t){let s=n.attributes[t];if(s){r.params=CF(r,o).named;let c=lv(r,s);return r.params=null,c}return r.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Bo(`${i}.${t}`)}r.params=CF(r,o).named;let a=lv(r,n.value);return r.params=null,a}function Kce(r,{name:e,args:t}){let o=r.bundle._functions[e];if(!o)return r.reportError(new ReferenceError(`Unknown function: ${e}()`)),new Bo(`${e}()`);if(typeof o!="function")return r.reportError(new TypeError(`Function ${e}() is not callable`)),new Bo(`${e}()`);try{let i=CF(r,t);return o(i.positional,i.named)}catch(i){return r.reportError(i),new Bo(`${e}()`)}}function zce(r,{selector:e,variants:t,star:o}){let i=I0(r,e);if(i instanceof Bo)return EH(r,t,o);for(let n of t){let a=I0(r,n.key);if(Nce(r,i,a))return lv(r,n.value)}return EH(r,t,o)}function TF(r,e){if(r.dirty.has(e))return r.reportError(new RangeError("Cyclic reference")),new Bo;r.dirty.add(e);let t=[],o=r.bundle._useIsolating&&e.length>1;for(let i of e){if(typeof i=="string"){t.push(r.bundle._transform(i));continue}if(r.placeables++,r.placeables>TH)throw r.dirty.delete(e),new RangeError(`Too many placeables expanded: ${r.placeables}, max allowed is ${TH}`);o&&t.push(Rce),t.push(I0(r,i).toString(r)),o&&t.push(Fce)}return r.dirty.delete(e),t.join("")}function lv(r,e){return typeof e=="string"?r.bundle._transform(e):TF(r,e)}var CI=class{constructor(e,t,o){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=e,this.errors=t,this.args=o}reportError(e){if(!this.errors||!(e instanceof Error))throw e;this.errors.push(e)}memoizeIntlObject(e,t){let o=this.bundle._intls.get(e);o||(o={},this.bundle._intls.set(e,o));let i=JSON.stringify(t);return o[i]||(o[i]=new e(this.bundle.locales,t)),o[i]}};function TI(r,e){let t=Object.create(null);for(let[o,i]of Object.entries(r))e.includes(o)&&(t[o]=i.valueOf());return t}var IH=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function DH(r,e){let t=r[0];if(t instanceof Bo)return new Bo(`NUMBER(${t.valueOf()})`);if(t instanceof Xs)return new Xs(t.valueOf(),{...t.opts,...TI(e,IH)});if(t instanceof hp)return new Xs(t.valueOf(),{...TI(e,IH)});throw new TypeError("Invalid argument to NUMBER")}var MH=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function AH(r,e){let t=r[0];if(t instanceof Bo)return new Bo(`DATETIME(${t.valueOf()})`);if(t instanceof hp)return new hp(t.valueOf(),{...t.opts,...TI(e,MH)});if(t instanceof Xs)return new hp(t.valueOf(),{...TI(e,MH)});throw new TypeError("Invalid argument to DATETIME")}var LH=new Map;function PH(r){let e=Array.isArray(r)?r.join(" "):r,t=LH.get(e);return t===void 0&&(t=new Map,LH.set(e,t)),t}var M0=class{constructor(e,{functions:t,useIsolating:o=!0,transform:i=n=>n}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(e)?e:[e],this._functions={NUMBER:DH,DATETIME:AH,...t},this._useIsolating=o,this._transform=i,this._intls=PH(e)}hasMessage(e){return this._messages.has(e)}getMessage(e){return this._messages.get(e)}addResource(e,{allowOverrides:t=!1}={}){let o=[];for(let i=0;i<e.body.length;i++){let n=e.body[i];if(n.id.startsWith("-")){if(t===!1&&this._terms.has(n.id)){o.push(new Error(`Attempt to override an existing term: "${n.id}"`));continue}this._terms.set(n.id,n)}else{if(t===!1&&this._messages.has(n.id)){o.push(new Error(`Attempt to override an existing message: "${n.id}"`));continue}this._messages.set(n.id,n)}}return o}formatPattern(e,t=null,o=null){if(typeof e=="string")return this._transform(e);let i=new CI(this,o,t);try{return TF(i,e).toString(i)}catch(n){if(i.errors&&n instanceof Error)return i.errors.push(n),new Bo().toString(i);throw n}}};var EF=/^(-?[a-zA-Z][\w-]*) *= */gm,GH=/\.([a-zA-Z][\w-]*) *= */y,qce=/\*?\[/y,IF=/(-?[0-9]+(?:\.([0-9]+))?)/y,Hce=/([a-zA-Z][\w-]*)/y,VH=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,Wce=/^[A-Z][A-Z0-9_-]*$/,EI=/([^{}\n\r]+)/y,jce=/([^\\"\n\r]*)/y,OH=/\\([\\"])/y,RH=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,Xce=/^\n+/,FH=/ +$/,$ce=/ *\r?\n/g,Jce=/( *)$/,Zce=/{\s*/y,NH=/\s*}/y,Qce=/\[\s*/y,ede=/\s*] */y,tde=/\s*\(\s*/y,rde=/\s*->\s*/y,ode=/\s*:\s*/y,ide=/\s*,?\s*/y,nde=/\s+/y,cv=class{constructor(e){this.body=[],EF.lastIndex=0;let t=0;for(;;){let Y=EF.exec(e);if(Y===null)break;t=EF.lastIndex;try{this.body.push(c(Y[1]))}catch(z){if(z instanceof SyntaxError)continue;throw z}}function o(Y){return Y.lastIndex=t,Y.test(e)}function i(Y,z){if(e[t]===Y)return t++,!0;if(z)throw new z(`Expected ${Y}`);return!1}function n(Y,z){if(o(Y))return t=Y.lastIndex,!0;if(z)throw new z(`Expected ${Y.toString()}`);return!1}function a(Y){Y.lastIndex=t;let z=Y.exec(e);if(z===null)throw new SyntaxError(`Expected ${Y.toString()}`);return t=Y.lastIndex,z}function s(Y){return a(Y)[1]}function c(Y){let z=p(),X=d();if(z===null&&Object.keys(X).length===0)throw new SyntaxError("Expected message value or attributes");return{id:Y,value:z,attributes:X}}function d(){let Y=Object.create(null);for(;o(GH);){let z=s(GH),X=p();if(X===null)throw new SyntaxError("Expected attribute value");Y[z]=X}return Y}function p(){let Y;if(o(EI)&&(Y=s(EI)),e[t]==="{"||e[t]==="}")return u(Y?[Y]:[],1/0);let z=P();return z?Y?u([Y,z],z.length):(z.value=F(z.value,Xce),u([z],z.length)):Y?F(Y,FH):null}function u(Y=[],z){for(;;){if(o(EI)){Y.push(s(EI));continue}if(e[t]==="{"){Y.push(g());continue}if(e[t]==="}")throw new SyntaxError("Unbalanced closing brace");let A=P();if(A){Y.push(A),z=Math.min(z,A.length);continue}break}let X=Y.length-1,q=Y[X];typeof q=="string"&&(Y[X]=F(q,FH));let S=[];for(let A of Y)A instanceof II&&(A=A.value.slice(0,A.value.length-z)),A&&S.push(A);return S}function g(){n(Zce,SyntaxError);let Y=h();if(n(NH))return Y;if(n(rde)){let z=T();return n(NH,SyntaxError),{type:"select",selector:Y,...z}}throw new SyntaxError("Unclosed placeable")}function h(){if(e[t]==="{")return g();if(o(VH)){let[,Y,z,X=null]=a(VH);if(Y==="$")return{type:"var",name:z};if(n(tde)){let q=b();if(Y==="-")return{type:"term",name:z,attr:X,args:q};if(Wce.test(z))return{type:"func",name:z,args:q};throw new SyntaxError("Function names must be all upper-case")}return Y==="-"?{type:"term",name:z,attr:X,args:[]}:{type:"mesg",name:z,attr:X}}return I()}function b(){let Y=[];for(;;){switch(e[t]){case")":return t++,Y;case void 0:throw new SyntaxError("Unclosed argument list")}Y.push(v()),n(ide)}}function v(){let Y=h();return Y.type!=="mesg"?Y:n(ode)?{type:"narg",name:Y.name,value:I()}:Y}function T(){let Y=[],z=0,X;for(;o(qce);){i("*")&&(X=z);let q=E(),S=p();if(S===null)throw new SyntaxError("Expected variant value");Y[z++]={key:q,value:S}}if(z===0)return null;if(X===void 0)throw new SyntaxError("Expected default variant");return{variants:Y,star:X}}function E(){n(Qce,SyntaxError);let Y;return o(IF)?Y=_():Y={type:"str",value:s(Hce)},n(ede,SyntaxError),Y}function I(){if(o(IF))return _();if(e[t]==='"')return C();throw new SyntaxError("Invalid expression")}function _(){let[,Y,z=""]=a(IF),X=z.length;return{type:"num",value:parseFloat(Y),precision:X}}function C(){i('"',SyntaxError);let Y="";for(;;){if(Y+=s(jce),e[t]==="\\"){Y+=D();continue}if(i('"'))return{type:"str",value:Y};throw new SyntaxError("Unclosed string literal")}}function D(){if(o(OH))return s(OH);if(o(RH)){let[,Y,z]=a(RH),X=parseInt(Y||z,16);return X<=55295||57344<=X?String.fromCodePoint(X):"\uFFFD"}throw new SyntaxError("Unknown escape sequence")}function P(){let Y=t;switch(n(nde),e[t]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return N(e.slice(Y,t))}return e[t-1]===" "?N(e.slice(Y,t)):!1}function F(Y,z){return Y.replace(z,"")}function N(Y){let z=Y.replace($ce,`
`),X=Jce.exec(Y)[1].length;return new II(z,X)}}},II=class{constructor(e,t){this.value=e,this.length=t}};var sde=["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"],MI=class r{constructor(e,t){this.bundles=e;this.onError=t}static fromSources(e,t,o){let i=[];for(let{lang:n,source:a}of e){let s=n.split("-")[0],c=new M0(n,{...o,useIsolating:sde.indexOf(s)>=0});c.addResource(new cv(a),{allowOverrides:!1}),c.addResource(new cv(`
l10n-internal-date-day-month-year = {DATETIME($d, month: "short", day: "numeric", year: "numeric")}
l10n-internal-date-day-month = {DATETIME($d, month: "short", day: "numeric")}
l10n-internal-time = {DATETIME($d, minute: "numeric", hour: "numeric")}
      `),{allowOverrides:!1}),i.push(c)}return new r(i,t)}format(e,t){for(let o of this.bundles){if(!o.hasMessage(e))continue;let i=o.getMessage(e);if(!(i!=null&&i.value))return;let n=[],a=o.formatPattern(i.value,this.coerceNumericVariables(t),n);for(let s of n)this.onError(`Error formatting ${e} for locale ${o.locales.join(",")}: ${s}`);return a}this.onError(`Couldn't find message for key ${e} for locales ${this.getLocales().join(",")}`)}formatDate(e,t){return t.showYear?this.format("l10n-internal-date-day-month-year",{d:e}):this.format("l10n-internal-date-day-month",{d:e})}formatTime(e){let t=this.format("l10n-internal-time",{d:e});return this.getLocales()[0]==="en"?t==null?void 0:t.toLowerCase():t}hasTranslation(e,t){for(let o of this.bundles)if(o.locales.indexOf(t)>=0)return o.hasMessage(e);return!1}coerceNumericVariables(e){let t={};for(let o in e){let i=e[o];__dcg_shared_module_exports__['Eb'](i)?t[o]=i.value:typeof i=="number"?t[o]=`${i}`:t[o]=i}return t}getLocales(){return this.bundles.reduce((e,t)=>e.concat(t.locales),[])}};var DI="",MF={},UH={},DF={},lde=["ar","hy-AM","hi","tr","xx-XX"];function AI(r){DI=r||""}function AF(r){for(let e in r)delete DF[e],UH[e]=r[e]}function LF(r,e){let t=e!=null?e:DI;return BH(t).hasTranslation(r,t)}function $s(r,e){if(e)for(let t in e)e.hasOwnProperty(t)&&(r=r.split("__"+t+"__").join(e[t]));return r}function wt(r,e,t){return YH(r,e!=null?e:{},t!=null?t:DI)}function Qc(r){return function(t,o){return YH(t,o!=null?o:{},r())}}function cde(r){let e={};for(let t in r){let o=r[t];o!==void 0&&(e[t]=o)}return e}function YH(r,e,t){let i=BH(t).format(r,cde(e));return i==null?(__dcg_shared_module_exports__['Be'].warn(`Could not format string ${r}`),""):i}function BH(r){let e=DF[r];if(!e){MF[r]||(MF[r]=E0([r]));let t=[];for(let i of MF[r]){let n=UH[i];n&&t.push({lang:i,source:n})}let o={};r==="xx-XX"&&(o.transform=i=>i.replace(/[a-z]/gi,"\u2666")),e=DF[r]=MI.fromSources([...t,{lang:"en",source:CH}],i=>{__dcg_shared_module_exports__['Be'].warn(i)},o)}return e}function D0(){return DI}function PF(r){return Zc.hasOwnProperty(r)||__dcg_shared_module_exports__['Ka'](lde,r)}function fc(r,e){if(r==null)return"";if(typeof r=="string")return r;if(typeof r=="number")return""+r;let t=r.vars,o;if(t){o={};for(let i in t){if(!t.hasOwnProperty(i))continue;let n=t[i];__dcg_shared_module_exports__['Eb'](n)?o[i]=n:o[i]=fc(n,e)}}return wt(r.key,o,e)}var dv=typeof desmosLocaleData=="object"?desmosLocaleData:{};function tb(){let r=E0([Hi("lang"),navigator.userLanguage,navigator.language]);for(let e=0;e<r.length;e++){let t=r[e];if(PF(t))return t}return"en"}async function pv(r){if(dv[r]||r==="en"||r==="xx-XX")return AI(r),!0;if(!PF(r)){let e=r.indexOf("-")!==-1?r.split("-")[0]:r;for(let t in Zc)if(e===t.split("-")[0]&&Zc[t].useAsRoot){r=t;break}}try{let e=await Jc(`/api/v1/calculator/language/${r}.ftl`);return dv[r]=e[r],AF(dv),AI(r),!0}catch(e){throw e.status===404&&__dcg_shared_module_exports__['Be'].warn(r+" is not an available language."),e}}function LI(r){if(dv[r])return!0;let e=E0([r]);for(let t of e)if(dv[t])return!0;return!1}AF(dv);AI(tb());var uv="dcg_geometry_toolbar_",KH={selection:{visible:!0},"box-selection":{visible:!0},"expression-edit":{visible:!0},point:{visible:!1},line:{visible:!1},segment:{visible:!1},ray:{visible:!1},vector:{visible:!1},circle:{visible:!1},arc:{visible:!1},parallel:{visible:!1},perpendicular:{visible:!1},anglebisector:{visible:!1},midpoint:{visible:!1},polygon:{visible:!1},compass:{visible:!1},angle:{visible:!1},directedangle:{visible:!1},reflect:{visible:!1},translate:{visible:!1},rotate:{visible:!1},dilate:{visible:!1}};function zH(r){if(r.toolbar!=="all"){if(r.toolbar==="custom"){let e=__dcg_shared_module_exports__['Kd'](KH,r.toolbarState),t={toolbar:"custom"};return e!==void 0&&(t.toolbarState=e),t}return r}}function qH(r){return r===void 0?{toolbar:"all"}:r.toolbar==="custom"?{toolbar:"custom",toolbarState:__dcg_shared_module_exports__['Ld'](KH,r.toolbarState)}:r}function HH(r,e){return e.stripDefaults?zH(r.cachedViewState):r.cachedViewState}function GF(r){return r.cachedUndoRedoDiffState}function dde(r){r.toolbar==="custom"?r.cachedViewState={toolbar:"custom",toolbarState:__dcg_shared_module_exports__['f'](r.toolbarState)}:r.cachedViewState={toolbar:r.toolbar}}function WH(r){dde(r),pde(r),r.__cachedToolbarState=void 0}function jH(r){let e=[];for(let t in r.toolbarState){let o=t,i=r.toolbarState[o];i.visible&&i.disabledLatex&&e.push({type:"geometry-toolbar-predicate",id:`${uv}${o}`,latex:i.disabledLatex})}return e}function XH(r,e){if(!r.toolbarState[e].disabledLatex)return;let t=r.formulas[e];if(t!=null&&t.error)return{key:"shared-calculator-error-custom-toolbar-not-condition",vars:{}}}function $H(r,e,t){let o=e.replace(uv,"");o in r.toolbarState&&(r.formulas[o]=t)}function pde(r){let e=r.cachedViewState;r.cachedUndoRedoDiffState=e,r.cachedUndoRedoFullState=e}function PI(r){let e=qH(r);return{toolbar:e.toolbar,toolbarState:e.toolbar==="custom"?e.toolbarState:ude(),formulas:{},selectedToolForGroup:{},__cachedToolbarState:void 0,cachedViewState:e,cachedUndoRedoDiffState:e,cachedUndoRedoFullState:e}}function JH(){return PI(void 0)}function ude(){return{selection:{visible:!0},"box-selection":{visible:!0},"expression-edit":{visible:!0},point:{visible:!0},line:{visible:!0},segment:{visible:!0},ray:{visible:!0},vector:{visible:!1},circle:{visible:!0},arc:{visible:!1},parallel:{visible:!1},perpendicular:{visible:!1},anglebisector:{visible:!1},midpoint:{visible:!1},polygon:{visible:!1},compass:{visible:!1},angle:{visible:!1},directedangle:{visible:!1},reflect:{visible:!1},translate:{visible:!1},rotate:{visible:!1},dilate:{visible:!1}}}function ZH(r,e){r.toolbar=e,r.__cachedToolbarState=void 0}function QH(r,e,t){let{groups:o,items:i}=A0(r,t);for(let n of o){let a=i[n];a!=null&&a.dropdown&&a.dropdown.indexOf(e)!==-1&&(r.selectedToolForGroup[a.group]=e),e!=="box-selection"&&(a==null?void 0:a.group)==="selection"&&(a!=null&&a.dropdown)&&(r.selectedToolForGroup.selection=a.dropdown[0])}r.__cachedToolbarState=void 0}function GI(r,e,t){r.toolbarState[e]={visible:t.visible,disabledLatex:t.disabledLatex},r.__cachedToolbarState=void 0}function rb(r,e){return r.toolbar==="all"?!0:r.toolbar==="none"?!1:r.toolbarState[e].visible}function hv(r,e){var o;if(r.toolbar==="all")return!0;let t=rb(r,e);if(t&&r.formulas[e]){let i=r.formulas[e],n=(o=i==null?void 0:i.typed_constant_value)==null?void 0:o.value;return typeof n=="number"?!n:!0}return t||e==="selection"}function A0(r,e){var i;if(((i=r.__cachedToolbarState)==null?void 0:i.authorMode)===e)return r.__cachedToolbarState.state;let t={};for(let n of VF())if(n.dropdown){let a=n.dropdown.filter(s=>e||rb(r,s));if(a.sort((s,c)=>{let d=hv(r,s),p=hv(r,c),u=rb(r,s),g=rb(r,c);return(d?0:u?1:2)-(p?0:g?1:2)}),a.length>0){let s=r.selectedToolForGroup[n.group];(!s||a.indexOf(s)===-1)&&(s=a[0]),!e&&!hv(r,s)&&(s=a.find(c=>hv(r,c))||a[0]),t[n.group]={group:n.group,current:s,dropdown:a.length>1?a:void 0}}}else(e||rb(r,n.current))&&(t[n.group]=n);let o=Object.keys(t);r.__cachedToolbarState={authorMode:e,state:{groups:o,items:t}};for(let n of o){let a=t[n];r.selectedToolForGroup[n]=a==null?void 0:a.current}return{groups:o,items:t}}function VF(){return[{group:"selection",current:"selection",dropdown:["selection","box-selection"]},{group:"point",current:"point",dropdown:["point","midpoint"]},{group:"line",current:"segment",dropdown:["segment","line","ray","vector","parallel","perpendicular","anglebisector"]},{group:"circle",current:"circle",dropdown:["circle","compass","arc"]},{group:"angle",current:"angle",dropdown:["angle","directedangle"]},{group:"polygon",current:"polygon"}]}function L0(r){switch(r){case"selection":return wt("graphing-calculator-label-geometry-tools-dropdown-menu-selection");case"point":return wt("graphing-calculator-label-geometry-tools-dropdown-menu-point");case"line":return wt("graphing-calculator-label-geometry-tools-dropdown-menu-line");case"circle":return wt("graphing-calculator-label-geometry-tools-dropdown-menu-circle");case"angle":return wt("graphing-calculator-label-geometry-tools-dropdown-menu-angle");case"polygon":return wt("graphing-calculator-label-geometry-tools-dropdown-menu-polygon");case"transformation":return wt("graphing-calculator-label-geometry-tools-dropdown-menu-transformation")}}var hde=0;function gde(){return"helper_item_"+hde++}function eW(r){return{...r,formula:__dcg_shared_module_exports__['De'](),guid:gde(),cachedParsableState:{type:"statement",id:r.id,latex:r.latex,shouldGraph:!1}}}function tW(r,e,t){var d;e.formula=t;let{proxy:o}=e,i=(d=t.typed_constant_value)==null?void 0:d.value,n=__dcg_shared_module_exports__['hb'](i)?i:NaN,a=__dcg_shared_module_exports__['fb'](i)&&__dcg_shared_module_exports__['Ia'](i,__dcg_shared_module_exports__['hb'])?i.slice(0):void 0,s=o.listValue,c=o.numericValue;o.setPropertyWithoutNotifying("numericValue",n),o.setPropertyWithoutNotifying("listValue",a),__dcg_shared_module_exports__['db'](n,c)||r.runAfterDispatch(()=>{o.notifyPropertyChange("numericValue")}),__dcg_shared_module_exports__['db'](a,s)||r.runAfterDispatch(()=>{o.notifyPropertyChange("listValue")})}var RF={enabled:!1,latex:"",hoveredImage:"",depressedImage:""},VI={center:"\\left(0,0\\right)",angle:"0",width:"10",height:"10",opacity:"1",clickableInfo:RF,description:"",draggable:!1},rW={folderId:"",hidden:!1,secret:!1,readonly:!1,disableGraphInteractions:!1,foreground:!1,name:"",...VI};function gv(r){return{...rW,...r,clickableInfo:{...RF,...r.clickableInfo}}}function oW(r){let e=__dcg_shared_module_exports__['Jd'](rW,r),t=__dcg_shared_module_exports__['Kd'](RF,r.clickableInfo);return t===void 0?delete e.clickableInfo:e.clickableInfo=t,e}function FF(r){return __dcg_shared_module_exports__['Td'](r,VI)}function OI(r){return{type:"image",id:r.id,...FF(r),moduleID:void 0,guid:"",index:0,color:"",shouldGraph:r.hidden,showPoints:!1}}Ut();function nW(r,e){r.hidden=e}function ed(r,e,t){r[e]=t}function P0(r,e){return r[e]}function aW(r,e){r.description=e}function sW(r,e){r.name=e}function FI(r,e){e.type==="inert"?(r.disableGraphInteractions=e.disableGraphInteractions,e.disableGraphInteractions&&(r.draggable=!1,r.clickableInfo={...r.clickableInfo,enabled:!1})):e.type==="draggable"?(r.draggable=e.draggable,e.draggable&&(r.disableGraphInteractions=!1)):e.type==="clickable"&&(r.clickableInfo=e.clickableInfo,e.clickableInfo.enabled&&(r.disableGraphInteractions=!1))}function NF(r,e){FI(r,{type:"draggable",draggable:e})}function mv(r){if(!r.formula)return;let e=r.formula.center_reference_id,t=r.formula.center_reference_symbol;if(!e||!t)return;let o=r.controller.getItemModel(e);if(!(!o||o.type!=="expression")&&o.formula.assignment===t&&Dn(o))return o}function fde(r){let e=mv(r);if(!e)return!1;let t=co(e);return!(!t||t===__dcg_shared_module_exports__['Gd'].NONE)}function td(r){return!r.draggable||$n(r)?!1:fde(r)}function lW(r){if(!r.formula||!r.formula.center_is_point_literal)return!1;let e=r.formula.move_strategy;if(!e)return!1;let t=e[2],o=e[3],i=t&&t.type!=="none",n=o&&o.type!=="none";return!!(i||n)}function cW(r,e){r.opacity=e}function UF(r,e){r.foreground=e}function dW(r,e){r.image_url=e}function NI(r,e){e(r.opacity,"imageOpacity"),e(r.center,"imageCenter"),e(r.height,"imageHeight"),e(r.width,"imageWidth"),e(r.angle,"imageAngle")}function bde(r){let e=OI(r);e.moduleID=rv(r),e.color=r.color,e.index=r.index,e.guid=r.guid,e.shouldGraph=r.shouldGraph,e.showPoints=r.showPoints,r.cachedParsableState=e}function pW(r){r.draggingOnGraphpaper?r.preTransientState||(r.preTransientState={center:r.center,width:r.width,height:r.height}):delete r.preTransientState,dp(r);let e=Ua(r);r.shouldGraph=e&&e.hidden?!1:!r.hidden,r.showPoints=r.shouldGraph&&Mn(r)&&r.loadStatus==="loaded"&&!td(r)&&r.controller.isTraceEnabled(),xde(r),vde(r),bde(r)}function uW(r,e){r.formula=e,r.error=yde(r)}function UI(r){return r.formula?r.formula.variables.map(t=>__dcg_shared_module_exports__['vb'](t))||[]:[]}function yde(r){let e={scale:r.controller.s("graphing-calculator-error-log-axes-image"),center:r.controller.s("graphing-calculator-error-image-invalid-center"),angle:r.controller.s("graphing-calculator-error-image-invalid-angle"),width:r.controller.s("graphing-calculator-error-image-invalid-width"),height:r.controller.s("graphing-calculator-error-image-invalid-height"),opacity:r.controller.s("graphing-calculator-error-image-invalid-opacity")};for(let t in r.formula.errorMap)if(r.formula.errorMap[t])return e[t]}function hW(r,e){return!r.formula||!r.formula.errorMap?!1:!!r.formula.errorMap[e]}function YI(r,e){let t=r.cachedViewState;return e.stripDefaults?oW(t):t}function xde(r){let e=r.cachedViewState.clickableInfo,t=!0,o=!0;if(e&&(e.depressedImage===r.clickableInfo.depressedImage&&(o=!1),e.hoveredImage===r.clickableInfo.hoveredImage&&(t=!1)),t&&(r.hoveredImageObj&&(re(r.hoveredImageObj).off("load"),delete r.hoveredImageObj),r.clickableInfo.hoveredImage)){r.hoveredImageObj=new Image;let i=function(){r.controller.requestRedrawGraph()},n=function(){};RI(r.hoveredImageObj,r.clickableInfo.hoveredImage,i,n)}if(o&&(r.depressedImageObj&&(re(r.depressedImageObj).off("load"),delete r.depressedImageObj),r.clickableInfo.depressedImage)){r.depressedImageObj=new Image;let i=function(){r.controller.requestRedrawGraph()},n=function(){};RI(r.depressedImageObj,r.clickableInfo.depressedImage,i,n)}if(r.cachedViewState.image_url!==r.image_url){re(r.imageObj).off("load"),r.imageObj=new Image;let i=function(){r.controller.dispatch({type:"image-load-success",id:r.id})},n=function(){r.controller.dispatch({type:"image-load-error",id:r.id})},s=r.controller.getGraphSettings().config.cacheRenderedSvgs?{fetchMimeType:{imageModel:r}}:void 0;RI(r.imageObj,r.image_url,i,n,s)}r.cachedViewState={type:r.type,id:r.id,folderId:r.folderId,image_url:r.image_url,name:r.name,hidden:r.hidden,foreground:r.foreground,secret:r.secret,readonly:r.readonly,disableGraphInteractions:r.disableGraphInteractions,...FF(r)}}function gW(r,e){r.draggingOnGraphpaper=e}function vde(r){let e=r.cachedViewState;r.cachedUndoRedoFullState=r.cachedViewState,r.preTransientState&&(e={...e,...r.preTransientState}),r.cachedUndoRedoDiffState=e}function wde(r){let e=document.createElement("canvas");return e.width=2,e.height=2,e.getContext("2d").drawImage(r,0,0,2,2),e.toDataURL()}function RI(r,e,t,o,i={}){re(r).on("load.initial-image-load",()=>{let s=r.width,c=r.height;s===1&&c===1?(re(r).off(".initial-image-load"),re(r).on("load",t),r.src=wde(r)):t()}).on("error",o);let n=/^data:/.test(e);n||(r.crossOrigin="anonymous");let{fetchMimeType:a}=i;a?n?(r.src=e,a.imageModel.mimeType=e.substring(5,e.indexOf(";"))):fetch(e).then(s=>{let c=s.headers.get("Content-type");return c&&(a.imageModel.mimeType=c),s.blob()}).then(s=>{let c=URL.createObjectURL(s);r.src=c}):r.src=e}function mW(r,e){return{...__dcg_shared_module_exports__['f'](gv(r)),...cp(e),color:__dcg_shared_module_exports__['zd'].BLUE,loadStatus:"loading",failures:0,imageObj:new Image,hoveredImageObj:void 0,depressedImageObj:void 0,mimeType:void 0,shouldGraph:void 0,showPoints:void 0,error:void 0,formula:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{}}}var Sde={id:!1,type:!1,image_url:!0,name:!0,folderId:!0,hidden:!0,secret:!0,readonly:!0,disableGraphInteractions:!0,foreground:!0,...__dcg_shared_module_exports__['Ud'](VI)};function fW(r,e){__dcg_shared_module_exports__['Rd']({from:e,to:r,props:Sde})}function bW(r){let{controller:e,files:t,id:o}=r,i={errors:[],tokens:[]};for(let n=0;n<t.length;n++){let a=t[n];if(!a.type.match("image/*")){i.errors.push(e.s("graphing-calculator-error-image-invalid-file",{file:a.name}));continue}i.tokens.push(_de({controller:e,file:a,id:o}))}return i}var kde=0;function _de(r){let{controller:e,file:t,id:o}=r,i=""+kde++;return e.getGraphSettings().config.imageUploadCallback(t,(n,a)=>{setTimeout(()=>{if(n)e.dispatch({type:"image-upload-error",token:i,error:n});else{let s=new Image;RI(s,a,function(){let p=s.width,u=s.height,g=Math.max(p,u)/Math.min(p,u);p<u?(u=10,p=Math.round(10*u/g)/10):(p=10,u=Math.round(10*p/g)/10),e.dispatch({type:"image-upload-success",token:i,url:a,width:p+"",height:u+"",name:t.name,id:o})},function(){e.dispatch({type:"image-upload-error",token:i,error:!0})})}})}),i}function BI(r,e){r.loadStatus=e,e==="loaded"&&(r.failures=0),e==="failed"&&(r.failures+=1)}function YF(r){r.imageObj.src=r.imageObj.src,BI(r,"loading")}function KI(r,e,t){FI(r,{type:"clickable",clickableInfo:{...r.clickableInfo,[e]:t}})}function yW(r,e){FI(r,{type:"clickable",clickableInfo:{...r.clickableInfo,latex:e}})}function ob(r){var e;return!!(r.clickableInfo.enabled&&r.formula&&((e=r.formula.click_handler)==null?void 0:e.status)==="maybe-valid")}function BF(r,e){FI(r,{type:"inert",disableGraphInteractions:e})}var zI=class{invalidate(){this.suggestedIdentifierRename=void 0}suggestionForId(e){if(this.suggestedIdentifierRename&&this.suggestedIdentifierRename.id===e)return this.suggestedIdentifierRename}updateForSelectedItem(e,t){function o(d){return Dg(e,d).length}function i(d,p){return Dg(e,d).filter(u=>u.folderId===p).length}if(!t||t.type!=="expression"){this.invalidate();return}this.suggestedIdentifierRename&&this.suggestedIdentifierRename.id!==t.id&&(this.suggestedIdentifierRename=void 0),this.suggestedIdentifierRename&&G0(e,this.suggestedIdentifierRename.from)===0&&(this.suggestedIdentifierRename=void 0);let n=t.formula.defined_name||"",a=n?__dcg_shared_module_exports__['vb'](n):"";if(!this.suggestedIdentifierRename){a&&(this.suggestedIdentifierRename={id:t.id,from:a,to:a,countOfChanges:0,folderId:void 0});return}if(a===this.suggestedIdentifierRename.to)return;if(this.suggestedIdentifierRename.to=a,this.suggestedIdentifierRename.from===this.suggestedIdentifierRename.to||!this.suggestedIdentifierRename.from||!this.suggestedIdentifierRename.to){this.suggestedIdentifierRename.countOfChanges=0;return}if(o(n)>1){this.suggestedIdentifierRename.countOfChanges=0;return}let s=__dcg_shared_module_exports__['wb'](this.suggestedIdentifierRename.from);if(this.suggestedIdentifierRename.folderId=void 0,o(s)>0){let d;if(t.folderId&&(d=i(s,t.folderId))===0)this.suggestedIdentifierRename.folderId=t.folderId,this.suggestedIdentifierRename.countOfChanges=d;else{this.suggestedIdentifierRename.countOfChanges=0;return}}let c=G0(e,this.suggestedIdentifierRename.from,this.suggestedIdentifierRename.folderId);this.suggestedIdentifierRename.countOfChanges=c}};function no(r,e){if(!isFinite(r))return r;if(!isFinite(e))return e;let t=__dcg_shared_module_exports__['l'](r,e);if(r>0!=e>0||r===0||e===0)return 0;let o=r>0?1:-1,i=Math.abs(r).toExponential().split("e"),n=Math.abs(e).toExponential().split("e"),a=i[0],s=n[0],c=i[1],d=n[1];if(d!==c)return o*Math.pow(10,Math.max(parseFloat(c),parseFloat(d)));if(a[0]!==s[0])return parseFloat(t.toPrecision(1));let p=1;for(let u=2;u<Math.min(a.length,s.length)&&(p++,a[u]===s[u]);u++);return parseFloat(t.toPrecision(p))}function vW(r){return __dcg_shared_module_exports__['nb'](r).latex}function qI(r){return r.slider.hardMin?r.slider.min:vW(Zs(r))}function HI(r){return r.slider.hardMax?r.slider.max:vW(bc(r))}function Zs(r){if(r.slider.hardMin){let e=r.formula.slider_min_number;return isFinite(e)?e:NaN}else{let e=r.controller.getDegreeMode(),t=eo(r.slider.min,e),o=Qs(r),i=od(r),n=r.slider.hardMax?r.formula.slider_max_number:void 0,s=r.controller.is3dProduct()?__dcg_shared_module_exports__['Gc'].xmin:-10;if(t<s&&(s=t),o<s&&(s=o),n<s&&(s=n),i){let c=__dcg_shared_module_exports__['Ic']({target:s,hardMin:void 0,hardMax:n,step:i});c<=s?s=c:s=c-i}return s}}function bc(r){if(r.slider.hardMax){let e=r.formula.slider_max_number;return isFinite(e)?e:NaN}else{let e=r.controller.getDegreeMode(),t=eo(r.slider.max,e),o=Qs(r),i=od(r),n=r.slider.hardMin?r.formula.slider_min_number:void 0;return __dcg_shared_module_exports__['Jc']({storedMax:t,sliderValue:o,step:i,hardMin:n,is3d:r.controller.is3dProduct()})}}function od(r){return r.formula.slider_step_number}function KF(r){var t;if(!r.formula||!r.formula.is_slider)return;let e=(t=r.formula.typed_constant_value)==null?void 0:t.value;if(e!==void 0)return+e}function Qs(r){let e=r.formula&&r.formula.raw_slider_latex;if(r.latex!==e)return Wx(r.latex);let t=KF(r);return isFinite(t)?t:NaN}function WI(r){return r.slider.loopMode!==__dcg_shared_module_exports__['Pd'].PLAY_ONCE?!1:Qs(r)>=bc(r)}function $u(r,e){if(!isFinite(e))return r;let t=r.indexOf("=")+1;return eo(r.slice(t),!1)===e?r:r.slice(0,t)+__dcg_shared_module_exports__['lb'](e)}function rd(r,e,t){if(!r.sliderExists)return NaN;let o=Zs(r),i=bc(r),n=od(r);if(t&&t.overwriteStep!==void 0&&(n=t.overwriteStep),e=__dcg_shared_module_exports__['Ic']({target:e,hardMin:r.slider.hardMin?o:void 0,hardMax:r.slider.hardMax?i:void 0,step:n}),!t||!t.ignoreSoftLimits){if(!r.slider.hardMin&&e<o)return o;if(!r.slider.hardMax&&e>i)return i}return e}function jI(r,e,t={}){if(!r.sliderExists)return NaN;let o=Qs(r),i=Zs(r),n=bc(r),a=od(r);t.overwriteStep===void 0&&(t.overwriteStep=a||(n-i)/20);let s=0;switch(e){case"min":return rd(r,i);case"max":return rd(r,n);case"up":s=1;break;case"down":s=-1;break;case"bigup":s=5;break;case"bigdown":s=-5;break;default:return e}let c=o;for(let d=0;d<20;d++){let p=d/3*t.overwriteStep,u=o;if(s>0)o=rd(r,c+p,t),o>u&&(s-=1);else if(s<0)o=rd(r,c-p,t),o<u&&(s+=1);else break}return o}function zF(r,e){if(!r.sliderExists)return;r.slider.isPlaying&&fs(r,!1);let t=rd(r,e,{ignoreSoftLimits:!0});r.latex=$u(r.latex,t)}function qF(r,e,t){if(!r.sliderExists)return;r.slider.isPlaying&&fs(r,!1),sb(r);let o=jI(r,e,t);r.latex=$u(r.latex,o)}function HF(r,e){if(!r.sliderExists)return;r.slider.isPlaying&&fs(r,!1);let t=rd(r,e);r.latex=$u(r.latex,t)}function WF(r,e){if(!r.sliderExists||r.resetSliderAnimationTargetValue)return;let t=r.sliderLastTickTime;if(r.sliderLastTickTime=e,t===void 0)return;let o=e-t,i=Zs(r),n=bc(r),a=od(r),s=r.slider.animationPeriod,c=r.slider.loopMode;if(isNaN(r.sliderAnimationTargetValue)){let g=Qs(r);isNaN(g)||(r.sliderAnimationTargetValue=g)}let d=a?a/2:0;if(c===__dcg_shared_module_exports__['Pd'].LOOP_FORWARD_REVERSE)r.sliderAnimationTargetValue>=n?Js(r,{playDirection:-1}):r.sliderAnimationTargetValue<=i&&Js(r,{playDirection:1});else if(c===__dcg_shared_module_exports__['Pd'].LOOP_FORWARD)Js(r,{playDirection:1}),r.sliderAnimationTargetValue>=n+d&&(r.sliderAnimationTargetValue=i-d);else if(c===__dcg_shared_module_exports__['Pd'].PLAY_ONCE)Js(r,{playDirection:1});else if(c===__dcg_shared_module_exports__['Pd'].PLAY_INDEFINITELY)Js(r,{playDirection:1});else throw new Error("Unexpected slider loop mode: "+c);isFinite(o)||(o=0);let p,u;if(c===__dcg_shared_module_exports__['Pd'].PLAY_INDEFINITELY)p=o/(s/4),a&&(p*=a),r.sliderAnimationTargetValue+=p,u=r.sliderAnimationTargetValue,a||(u=no(u-p*.1,u+p*.1)),u=rd(r,u,{ignoreSoftLimits:!0}),r.latex=$u(r.latex,u);else{if(o=Math.min(o,s/10),p=(n-i)*o/s,r.sliderAnimationTargetValue+=p*r.slider.playDirection,r.sliderAnimationTargetValue=Math.max(i-d,Math.min(n+d,r.sliderAnimationTargetValue)),u=r.sliderAnimationTargetValue,!a){let g=p/o*16.666666666666668;u=no(u-g*.1,u+g*.1)}u=rd(r,u),r.latex=$u(r.latex,u)}}function nb(r,e){e?Js(r,{hardMin:!0,min:e}):Js(r,{hardMin:!1,min:r.controller.is3dProduct()?`${__dcg_shared_module_exports__['Gc'].xmin}`:"-10"})}function ab(r,e){e?Js(r,{hardMax:!0,max:e}):Js(r,{hardMax:!1,max:r.controller.is3dProduct()?`${__dcg_shared_module_exports__['Gc'].xmax}`:"10"})}function V0(r,e){Js(r,{step:e})}function Js(r,e){r.slider={...r.slider,...e}}function fs(r,e){!r||r.slider.isPlaying===e||(Js(r,{isPlaying:e}),e&&(sb(r),r.sliderAnimationTargetValue=Qs(r)))}function sb(r){if(!r.slider.hardMin){let e=__dcg_shared_module_exports__['kb'](Zs(r));e!==r.slider.min&&Js(r,{min:e})}if(!r.slider.hardMax){let e=__dcg_shared_module_exports__['kb'](bc(r));e!==r.slider.max&&Js(r,{max:e})}}function lb(r){return r.formula&&r.formula.assignment}function XI(r){return!!(r.formula&&r.formula.slider_min_valid)}function $I(r){return!!(r.formula&&r.formula.slider_max_valid)}function JI(r){return!!(r.formula&&r.formula.slider_step_valid)}function ZI(r,e){e&&sb(r),r.sliderDragging=e}function wW(r,e){Js(r,{animationPeriod:e})}var SW={folderId:"",text:"",secret:!1,readonly:!1};function QI(r){return{...SW,...r}}function kW(r){return __dcg_shared_module_exports__['Jd'](SW,r)}function jF(r,e){r.text=e}function _W(r,e){return{...__dcg_shared_module_exports__['f'](QI(r)),...cp(e),cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},cachedViewState:{}}}function CW(r){dp(r),Ede(r),Ide(r)}var Tde={id:!1,type:!1,folderId:!0,text:!0,secret:!0,readonly:!0};function TW(r,e){__dcg_shared_module_exports__['Rd']({from:e,to:r,props:Tde})}function eM(r,e){let t=r.cachedViewState;return e.stripDefaults?kW(t):t}function Ede(r){r.cachedViewState={type:r.type,id:r.id,folderId:r.folderId,text:r.text,secret:r.secret,readonly:r.readonly}}function Ide(r){r.cachedUndoRedoDiffState=r.cachedViewState,r.cachedUndoRedoFullState=r.cachedViewState}var yv={handlerLatex:"",minStepLatex:"",open:!1,playing:!1};function tM(r){return{type:"ticker",id:r.id,handlerLatex:r.handlerLatex,minStepLatex:r.minStepLatex,shouldGraph:!1}}function IW(r){return __dcg_shared_module_exports__['Kd'](yv,r)}function rM(r){return{...yv,...r}}var MW="dcg_ticker_guid_internal",Dde=MW;function DW(){return XF(yv)}function Ade(r){r.cachedParsableState=tM(r)}function AW(r,e){return e.stripDefaults?IW(r.cachedViewState):r.cachedViewState}function LW(r){return r.cachedUndoRedoDiffState}function PW(r){return r.cachedUndoRedoFullState}function Lde(r){r.cachedViewState={handlerLatex:r.handlerLatex,minStepLatex:r.minStepLatex,playing:r.playing,open:r.open}}function Pde(r){let e=r.cachedViewState;r.cachedUndoRedoDiffState=e,r.cachedUndoRedoFullState=e}function XF(r){return{...rM(r),type:"ticker",guid:MW,id:Dde,avgDelta:0,lastTickTime:void 0,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},filteredBySearch:!1}}function GW(r,e){__dcg_shared_module_exports__['Sd'](e,r)}function VW(r,e){r.formula=e}function OW(r){Lde(r),Pde(r),Ade(r)}function RW(r,{currentFrameTime:e,previousFrameTime:t}){var a,s;if(!r.playing||((a=r.formula)==null?void 0:a.handler.status)!=="maybe-valid")return!1;if(r.lastTickTime==null||t==null)return!0;if(((s=r.formula)==null?void 0:s.minStep.status)!=="valid")return!1;let o=r.formula.minStep.value,i=r.lastTickTime+o;if(e>=i)return!0;let n=e-t;return i-e<n/2}function FW(r,e){r.lastTickTime=e}function NW(r){if(r.formula)return r.formula.handler.status==="error"?r.formula.handler.error:void 0}function UW(r){if(r.formula)return r.formula.minStep.status==="error"?r.formula.minStep.error:void 0}function O0(r){var e;return(((e=r.formula)==null?void 0:e.variables)||[]).map(t=>__dcg_shared_module_exports__['vb'](t))}function oM(r,e){e(r.handlerLatex,"tickerHandler"),e(r.minStepLatex,"tickerMinStep")}var wv="**dcg_geo_expression_edit_tool_preview**";function YW(r){return{controller:r,__itemModelArray:[],__itemIdToModel:{},__helperIdToModel:{},__toolPreviewIdToModel:{},__inferenceUiIdToModel:new Map,__anyDependsOnRandomSeed:!1,__anyFunctionDefinitionsDependOnRandomSeed:!1,__anyUnmutedTones:!1,__anyTones:!1,__anyIsAction:!1,selectedItemMap:{},tabOrder:[],drawLayers:[],colorIdx:0,expressionAnalysis:{},nextDisplayIndex:"1",ticker:DW(),renamePrompt:new zI,__exportedVariables:new _0([],void 0)}}function BW(r){for(let e=0;e<r.__itemModelArray.length;e++){let t=r.__itemModelArray[e];if(t.type==="image"&&t.loadStatus==="loading")return!0}return!1}function KW(r){let e=__dcg_shared_module_exports__['Ha'](__dcg_shared_module_exports__['ab'](r.controller.getColors()),o=>o!=__dcg_shared_module_exports__['zd'].ORANGE),t=e[r.colorIdx];return r.colorIdx=(r.colorIdx+1)%e.length,t}function Ju(r,e){return r.__itemModelArray[e]}function Sv(r){for(let e=0;e<r.__itemModelArray.length;e++){let t=r.__itemModelArray[e];if(kv(t))return t}}function aM(r){for(let e=r.__itemModelArray.length-1;e>=0;e--){let t=r.__itemModelArray[e];if(kv(t))return t}}function R0(r,e){let t;do{if(e--,e===-1)return;t=Ju(r,e)}while(t&&!kv(t));return t}function F0(r,e){let t,o=Y0(r);do{if(e++,e===o)return;t=Ju(r,e)}while(t&&!kv(t));return t}function Ua(r){if(r.type!=="folder"&&r.folderId){let e=r.controller.getListModel(),t=id(e,r.folderId);if(t&&t.type==="folder")return t}}function zW(r,e){let t=id(r,e);if(!t||t.type!=="folder")return 0;let o=0,i=r.__itemModelArray.length;for(let n=t.index+1;n<i;n++){let a=r.__itemModelArray[n];if(a.type==="folder"||a.folderId!==e)break;o+=1}return o}function qW(r,e){let t=id(r,e);if(!t||t.type!=="folder")return[];let o=[],i=r.__itemModelArray.length;for(let n=t.index+1;n<i;n++){let a=r.__itemModelArray[n];if(a.type==="folder"||a.folderId!==e)break;o.push(a.id)}return o}function sM(r,e){let t=[],o=id(r,e);if(!o||o.type!=="folder")return t;let i=r.__itemModelArray.length;for(let n=o.index+1;n<i;n++){let a=r.__itemModelArray[n];if(a.type==="folder"||a.folderId!==e)break;t.push(a)}return t}function HW(r){return!!(r&&r.readonly)}function xv(r){if(!r)return!1;if(r.secret)return!0;let e=Ua(r);return!!(e&&e.secret&&e.id!==__dcg_shared_module_exports__['Zd'])}function kv(r){return!vF(r)}function WW(r){return r.id===__dcg_shared_module_exports__['Zd']||r.type!=="folder"&&r.folderId===__dcg_shared_module_exports__['Zd']}function vF(r){if(!r||r.filteredBySearch||WW(r))return!0;if(r.controller.isItemBeingDragged(r.id))return!!r.controller.shouldRenderDraggedItemAsToken();if(!r.controller.shouldShowAuthorFeatures()&&xv(r))return!0;let t=Ua(r);return!!(t&&t.collapsed&&!r.controller.getExpressionSearchStr())}function lM(r){return r.__itemModelArray}function jW(r){return __dcg_shared_module_exports__['ab'](r.__helperIdToModel)}function N0(r){return __dcg_shared_module_exports__['ab'](r.__toolPreviewIdToModel)}function _v(r,e){for(let t=0;t<r.__itemModelArray.length;t++){let o=r.__itemModelArray[t];cb(o,e)}for(let t in r.__toolPreviewIdToModel)cb(r.__toolPreviewIdToModel[t],e);for(let t of r.__inferenceUiIdToModel.values())cb(t,e);if(r.ticker.open&&(e(r.ticker.handlerLatex,{type:"item",location:"tickerHandler",item:r.ticker}),e(r.ticker.minStepLatex,{type:"item",location:"tickerMinStep",item:r.ticker})),r.controller.isGeometry()){let o=r.controller.getGeometryToolbarModel().toolbarState;for(let i in o){let n=i,a=o[n];a.visible&&a.disabledLatex&&e(a.disabledLatex,{type:"geometry-toolbar",tool:n})}}}function cb(r,e){switch(r.type){case"expression":xM(r,(o,i)=>e(o,{type:"item",location:i,item:r}));break;case"table":x0(r,(o,i,n)=>e(o,{type:"item",location:i,item:r,...n}));break;case"image":NI(r,(o,i)=>e(o,{type:"item",location:i,item:r}));break;case"ticker":oM(r,(o,i)=>e(o,{type:"item",location:i,item:r}));break;case"folder":case"text":break;default:return r}}function XW(r,e){if(!Fa(e))return!1;let o=!1;return _v(r,i=>{mc(i,e)&&(o=!0)}),o}function $W(r,e){let t=!1;for(let o of r.__itemModelArray)if(o.type==="table"&&(x0(o,i=>{mc(i,e)&&(t=!0)},{headersOnly:!0}),t))return!0;return!1}function JW(r,e){let t=0,o=Fa(e);r.ticker.filteredBySearch=r.ticker.open&&!mc(r.ticker.handlerLatex,e)&&!mc(r.ticker.minStepLatex,e);for(let i of r.__itemModelArray){if(!o){i.filteredBySearch=!1,t++;continue}switch(i.filteredBySearch=!0,i.type){case"expression":xM(i,s=>{mc(s,e)&&(i.filteredBySearch=!1,t++)});let n=ws(i);i.label&&n&&i.label.match(nM(e))&&(i.filteredBySearch=!1,t++);break;case"table":x0(i,s=>{mc(s,e)&&(i.filteredBySearch=!1,t++)});break;case"image":NI(i,s=>{mc(s,e)&&(i.filteredBySearch=!1,t++)});break;case"folder":case"text":break;default:return i}!i.filteredBySearch&&i.type!=="folder"&&i.folderId&&(r.__itemIdToModel[i.folderId].filteredBySearch=!1,t++)}return t}function ZW(r){var e,t;return $n(r)?!1:r.controller.isGeometry()&&xs(r)?!0:r.type==="expression"?Z0(r)&&((e=r.clickableInfo)==null?void 0:e.enabled)||co(r)!==__dcg_shared_module_exports__['Gd'].NONE:r.type==="image"?((t=r.clickableInfo)==null?void 0:t.enabled)||td(r):!1}function $F(r){return r.description?ZW(r):!1}function cM(r){return ZW(r)}function QW(r,e){let t=0,o=dq(e),i=uq(e),n=a=>$F(a)?e==="\\operatorname{alt}"&&a.description?!0:i.test(a.description):!1;r.ticker.filteredBySearch=!!e&&r.ticker.open&&!o(r.ticker.handlerLatex)&&!o(r.ticker.minStepLatex);for(let a=0;a<r.__itemModelArray.length;a++){if(!e){r.__itemModelArray[a].filteredBySearch=!1;continue}let s=r.__itemModelArray[a];switch(s.filteredBySearch=!0,s.type){case"expression":xM(s,p=>{o(p)&&(s.filteredBySearch=!1,t++)});let c=ws(s);Av(s)&&(s.label||c)&&(e==="\\operatorname{label}"||e.length>1&&"label".indexOf(e)===0||o(s.label))&&(s.filteredBySearch=!1,t++),n(s)&&(s.filteredBySearch=!1,t++);break;case"table":x0(s,p=>{o(p)&&(s.filteredBySearch=!1,t++)});break;case"image":e==="\\operatorname{image}"||e.length>1&&"image".indexOf(e)===0?(s.filteredBySearch=!1,t++):NI(s,p=>{o(p)&&(s.filteredBySearch=!1,t++)}),n(s)&&(s.filteredBySearch=!1,t++);break;case"folder":s.title&&s.title.indexOf(e)>=0&&(s.filteredBySearch=!1,t++);break;case"text":i.test(s.text)&&(s.filteredBySearch=!1,t++);break;default:return s}!s.filteredBySearch&&s.type!=="folder"&&s.folderId&&(r.__itemIdToModel[s.folderId].filteredBySearch=!1,t++)}return t}function nM(r,e){return new RegExp("\\$\\{"+r.replace("{","\\{?").replace("}","\\}?").replace("_","\\_?")+"\\}",e)}function G0(r,e,t){let o=0;for(let i=0;i<r.__itemModelArray.length;i++){let n=r.__itemModelArray[i];if(n.type!=="expression"||t&&n.folderId!==t)continue;if(ws(n)&&n.label){let s=n.label.match(nM(e,"g"));s&&(o+=s.length)}}return _v(r,(i,n)=>{t&&(n.type!=="item"||n.item.type==="ticker"||n.item.type==="folder"||n.item.folderId!==t)||(o+=$x(i,e).length)}),o}function mp(r,e,t,o){r.renamePrompt.invalidate(),t=t.trim().replace(/_\{([a-zA-Z0-9])\}/g,"_$1");for(let i=0;i<r.__itemModelArray.length;i++){let n=r.__itemModelArray[i];if(n.type==="expression"){if((o==null?void 0:o.limitToFolder)!==void 0&&o.limitToFolder!==n.folderId)continue;let a=ws(n);n.label&&a&&n.label.match(nM(e))&&fp(n,n.label.replace(nM(e,"g"),"${"+t.trim()+"}"))}}_v(r,(i,n)=>{if(o&&o.limitToItem!==void 0&&(n.type!=="item"||o.limitToItem!==n.item.id)||o&&o.limitToFolder!==void 0&&(n.type!=="item"||n.item.type==="ticker"||n.item.type==="folder"||o.limitToFolder!==n.item.folderId))return;let a=ZE(i,e,t);if(n.type==="geometry-toolbar"){let c=r.controller.getGeometryToolbarModel();GI(c,n.tool,{visible:!0,disabledLatex:a});return}let s=n.item;if(a!==i){let c;switch(n.cellLocation!==void 0&&s.columnModels&&(c=s.columnModels[n.cellLocation.column].id),n.location){case"latex":{Zn(s,a);break}case"cdfMin":{G9(s,a);break}case"cdfMax":{V9(s,a);break}case"cdfP":{O9(s,a);break}case"colorLatex":{$0(s,a);break}case"lineWidth":{Mv(s,a);break}case"resolution":{vM(s,a);break}case"clickableInfoLatex":{bM(s,a);break}case"fillOpacity":{H0(s,a);break}case"surfaceOpacity":{W0(s,a);break}case"lineOpacity":{Iv(s,a);break}case"pointOpacity":{j0(s,a);break}case"pointSize":case"movablePointSize":X0(s,a);break;case"labelAngle":{wM(s,a);break}case"labelSize":{J0(s,a);break}case"polarDomainMin":{bs(s,a,"theta");break}case"polarDomainMax":{ys(s,a,"theta");break}case"parametricDomainMin":{bs(s,a,"t");break}case"parametricDomainMax":{ys(s,a,"t");break}case"parametricDomain3DuMin":{bs(s,a,"u");break}case"parametricDomain3DuMax":{ys(s,a,"u");break}case"parametricDomain3DvMin":{bs(s,a,"v");break}case"parametricDomain3DvMax":{ys(s,a,"v");break}case"parametricDomain3DrMin":{bs(s,a,"r");break}case"parametricDomain3DrMax":{ys(s,a,"r");break}case"parametricDomain3DphiMin":{bs(s,a,"phi");break}case"parametricDomain3DphiMax":{ys(s,a,"phi");break}case"sliderMin":{nb(s,a);break}case"sliderMax":{ab(s,a);break}case"sliderStep":{V0(s,a);break}case"imageOpacity":{ed(s,"opacity",a);break}case"imageCenter":{ed(s,"center",a);break}case"imageHeight":{ed(s,"height",a);break}case"imageWidth":{ed(s,"width",a);break}case"imageAngle":{ed(s,"angle",a);break}case"tickerHandler":{s.handlerLatex=a;break}case"tickerMinStep":{s.minStepLatex=a;break}case"tableHeader":case"tableCellValue":if(!n.cellLocation||s.type!=="table")break;Cg(s,n.cellLocation,a);break;case"tableColumnColorLatex":{c&&pI(s,c,a);break}case"tableColumnPointSize":{c&&cI(s,c,a);break}case"tableColumnPointOpacity":{c&&dI(s,c,a);break}case"tableColumnLineWidth":{c&&sI(s,c,a);break}case"tableColumnLineOpacity":{c&&lI(s,c,a);break}case"residualVariable":break;case"inferenceConfidenceLevel":{s.inference.confidence={...s.inference.confidence,confidenceLevel:a};break}case"inferenceHypothesis":{s.inference.significance={tails:"outer",...s.inference.significance,hypothesis:a};break}default:{let d=n.location;throw new Error(`Unexpected latex location ${d}`)}}}})}function dM(r){let e=[];_v(r,o=>{if(o.indexOf("~")!==-1||o.indexOf("\\sim")!==-1)return;let i=/_(\d)|_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g;for(;;){let n=i.exec(o);if(!n)break;e.push(parseInt(n[1]||n[2],10))}}),e.sort((o,i)=>o-i);let t=1;for(let o=0;o<e.length;o++)e[o]===t&&t++;return t}function e9(r){let e=0;return _v(r,t=>{let o=/\\token\{(\d+)\}/g;for(;;){let i=o.exec(t);if(!i)break;let n=parseInt(i[1],10);n>e&&(e=n)}}),e}function t9(r){let e={};return _v(r,t=>{if(t.indexOf("~")!==-1||t.indexOf("\\sim")!==-1)return;let o=/(\\?[a-zA-Z]+)_(\d)|(\\?[a-zA-Z]+)_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g;for(;;){let i=o.exec(t);if(!i)break;let n=i[1]||i[3],a=i[2]||i[4];n[0]!=="\\"&&(n=n[n.length-1]);let s=parseInt(a,10);e[n]||(e[n]=0),s>e[n]&&(e[n]=s)}}),e}function r9(r,e){let t=[],o=[],i=[],n=[],a={points:[],angles:[],polygons:[],other:[]};function s(d){if(Nde(r,d.id)&&e!=="actual")return;if(d.id===wv&&e!=="preview")return;if(d.type==="expression"&&d.folderId===__dcg_shared_module_exports__['Zd']){$c(d)?a.points.push(d.id):Lg(d)?a.angles.push(d.id):Dv(d)?a.polygons.push(d.id):a.other.push(d.id);return}let p=!1;if(d.type!=="folder"&&d.folderId){let g=r.__itemIdToModel[d.folderId];g&&g.type==="folder"&&g.inFrontOfEverything&&(p=!0)}let u=i;p?u=n:d.type==="image"&&!d.foreground&&(u=o),d.type==="table"?(d.regression&&(t.push(d.regression.id),u.push(d.regression.id)),__dcg_shared_module_exports__['Fa'](d.columnModels,g=>{t.push(g.id),u.push(g.id)})):(t.push(d.id),u.push(d.id))}r.__itemModelArray.forEach(s),N0(r).forEach(s);let c=[...a.polygons,...a.other,...a.angles,...a.points];t.push(...c),i.push(...c),r.tabOrder=t,r.drawLayers=[],o.length&&r.drawLayers.push({layer:-1,drawOrder:o,drawSet:new Set(o)}),r.drawLayers.push({layer:0,drawOrder:i,drawSet:new Set(i)}),n.length&&r.drawLayers.push({layer:1,drawOrder:n,drawSet:new Set(n)})}function o9(r,e){return r.__itemModelArray.findIndex(t=>t.id===e)}function id(r,e,t){let o=r.__itemIdToModel[e];if(o)return o;if(t&&t.includePreviewItems)return r.__toolPreviewIdToModel[e]}function i9(r,e){return!!r.__toolPreviewIdToModel[e]}function Gde(r,e){return r.__toolPreviewIdToModel[e]}function Dg(r,e){var o;let t=[];for(let i=0;i<r.__itemModelArray.length;i++){let n=r.__itemModelArray[i];n.type==="expression"&&((o=Go(n))==null?void 0:o.identifier)===e&&t.push(n)}return t}function Vde(r,e){return r.__helperIdToModel[e]}function n9(r){return __dcg_shared_module_exports__['ab'](r.__helperIdToModel)}function a9(r,e){let t=eW(e);r.__helperIdToModel[t.id]=t,Object.defineProperty(e.proxy,"isActive",{get:()=>{var o;return((o=r.__helperIdToModel[t.id])==null?void 0:o.proxy)===t.proxy}})}function JF(r,e){r.__inferenceUiIdToModel.set(e.id,e)}function pM(r,e){r.__inferenceUiIdToModel.delete(e)}function Zu(r,e){if(e!==void 0)return r.__inferenceUiIdToModel.get(e)}function s9(r){return r.__inferenceUiIdToModel.values()}function U0(r){r.__anyUnmutedTones=r.__itemModelArray.some(e=>z0(e)),r.__anyTones=r.__anyUnmutedTones||r.__itemModelArray.some(e=>el(e))}function l9(r,e){r.__exportedVariables=new _0(lM(r),e)}function ZF(r){r.__anyDependsOnRandomSeed=!1,r.__anyFunctionDefinitionsDependOnRandomSeed=!1;for(let e=0;e<r.__itemModelArray.length;e++){let t=r.__itemModelArray[e];t&&"formula"in t&&t.formula&&t.formula.depends_on_random_seed&&(r.__anyDependsOnRandomSeed=!0,t.type==="expression"&&t.formula.function_definition&&(r.__anyFunctionDefinitionsDependOnRandomSeed=!0))}}function c9(r){r.__anyIsAction=!1}function uM(r){if(!r.__anyIsAction){if(r.ticker.open){r.__anyIsAction=!0;return}for(let e=0;e<r.__itemModelArray.length;e++){let t=r.__itemModelArray[e];if(t&&"formula"in t&&t.formula){if(t.type!=="expression"&&t.type!=="image")continue;let{formula:o}=t;if(o.hasOwnProperty("action_value")||o.hasOwnProperty("click_handler")){r.__anyIsAction=!0;return}}}}}function db(r){Uo("showIDs")?Rde(r):Ode(r);for(let e in r.selectedItemMap)r.__itemIdToModel[e]||delete r.selectedItemMap[e]}function Ode(r){let e=!r.controller.shouldShowAuthorFeatures(),t=1,o=1;for(let i=0;i<r.__itemModelArray.length;i++){let n=r.__itemModelArray[i];n.index=i,n.displayIndex=""+t,xv(n)&&(n.secretIndex=""+o,o+=1),!WW(n)&&(!e||!xv(n))&&(t+=1)}r.nextDisplayIndex=""+t}function Rde(r){for(let e=0;e<r.__itemModelArray.length;e++){let t=r.__itemModelArray[e];t.index=e;let o=t.id.length<=6?t.id:t.id.substring(0,4)+"\u2026";t.displayIndex=o,xv(t)&&(t.secretIndex=o)}r.nextDisplayIndex=""}function Fde(r){r.renamePrompt.invalidate(),r.__itemModelArray=[],r.__itemIdToModel={},r.__helperIdToModel={},r.__toolPreviewIdToModel={},r.__anyDependsOnRandomSeed=!1,r.__anyFunctionDefinitionsDependOnRandomSeed=!1,r.__anyUnmutedTones=!1,r.__anyTones=!1}function Y0(r){return r.__itemModelArray.length}function d9(r){return r.__itemModelArray.filter(e=>e.type==="expression"&&e.folderId===__dcg_shared_module_exports__['Zd']&&!!ji(e)).length}function p9(r){return r.nextDisplayIndex==="1"}function u9(r){let e=[];for(let t=0;t<r.__itemModelArray.length;t++){let o=r.__itemModelArray[t];o.type==="expression"&&o.sliderExists&&e.push(o)}return e}function pb(r){let e;for(let t in r.selectedItemMap){if(e!==void 0)return;e=t}if(e!==void 0)return r.__itemIdToModel[e]}function Nde(r,e){return!!r.selectedItemMap[e]}function h9(r){return Object.keys(r.selectedItemMap)}function hM(r){let e=[];for(let t in r.selectedItemMap)e.push(r.__itemIdToModel[t]);return e}function g9(r){return{list:r.__itemModelArray.map(e=>e.cachedUndoRedoDiffState),ticker:LW(r.ticker)}}function QF(r){return{list:r.__itemModelArray.map(e=>e.cachedUndoRedoFullState),ticker:PW(r.ticker)}}function gM(r,e){switch(r.type){case"expression":return q0(r,e);case"image":return YI(r,e);case"table":return ev(r,e);case"folder":return SI(r,e);case"text":return eM(r,e);default:return r}}function m9(r,e){let t={list:r.__itemModelArray.map(i=>gM(i,e))},o=AW(r.ticker,e);return o&&(t.ticker=o),t}function*Ude(r){for(let e=r.list.length-1;e>=0;e--){let t=r.list[e];if(yield t.id,t.type==="table"&&t.columns)for(let o=t.columns.length-1;o>=0;o--)yield t.columns[o].id;t.type==="table"&&t.regression&&(yield t.regression.id)}}function e3(r){if(/^[0-9]+$/.test(r))return parseInt(r,10)}function f9(r){let e=0;for(let t of Ude(r)){let o=e3(t);o!==void 0&&o>e&&(e=o)}return e}function b9(r,e,t){t||(t={});let o,i;for(r.colorIdx=0,Fde(r),r.expressionAnalysis={},o=0;o<e.list.length;o++){if(i=vv(r,e.list[o]),t.remapColors&&"color"in i&&i.color){let n=__dcg_shared_module_exports__['ab'](r.controller.getColors());__dcg_shared_module_exports__['Ka'](n,i.color)||(i.color=fq(i.color,n))}r.__itemModelArray.push(i),r.__itemIdToModel[i.id]=i}if(r.ticker=XF(e.ticker),db(r),r.nextDisplayIndex==="1"){let n=vv(r,{type:"expression",id:r.controller.generateId(),color:r.controller.getNextColor()});cn(r,n,r.__itemModelArray.length)}}function vv(r,e){switch(e.type){case"expression":return yM(e,r.controller);case"table":return Uq(e,r.controller);case"image":return mW(e,r.controller);case"folder":return dH(e,r.controller);case"text":return _W(e,r.controller);default:return e}}function y9(r,e){let t,o,i=r.__itemIdToModel;for(r.__itemModelArray=[],r.__itemIdToModel={},r.renamePrompt.invalidate(),t=0;t<e.list.length;t++){let n=e.list[t];if(o=i[n.id],o&&o.type===n.type)switch(o.type){case"expression":if(n.type!==o.type)throw new Error("invalid restoration");P9(o,n);break;case"table":if(n.type!==o.type)throw new Error("invalid restoration");Nq(o,n);break;case"image":if(n.type!==o.type)throw new Error("invalid restoration");fW(o,n);break;case"folder":{if(n.type!==o.type)throw new Error("invalid restoration");uH(o,n)}break;case"text":if(n.type!==o.type)throw new Error("invalid restoration");TW(o,n);break;default:return o}else o=vv(r,n);r.__itemModelArray.push(o),r.__itemIdToModel[o.id]=o}e.ticker&&GW(r.ticker,e.ticker),ZF(r),uM(r),U0(r),l9(r,void 0),db(r)}function x9(r,e,t){let o=t[0]&&"tableId"in t[0]&&t[0].tableId,i=id(r,o||e);if(!i)return;let n;switch(i.type){case"expression":let a=!1,s=!1,c;i.__workerNeedsDotplotXMode=!1;for(let u=0;u<t.length;u++){let g=t[u];if("recursionTerminationStatus"in g&&g.recursionTerminationStatus===1&&(s=!0),"nanBlame"in g&&g.nanBlame!==void 0&&(c=g.nanBlame),g.graphMode===15){i.error=g.error;continue}"resolved"in g&&!g.resolved&&(a=!0),"boundingBox"in g&&g.boundingBox&&(n||(n=[]),n.push(g.boundingBox)),g.needsDotplotXMode&&(i.__workerNeedsDotplotXMode=!0)}i.unresolved=a,i.boundingBoxes=n,i.recursiveDepthPlottingError=s,i.nanBlame=c;let d=1/0,p=-1/0;for(let u of t){if(u.graphMode!==6)continue;let g=u.sampledDomain;g&&(d=Math.min(d,g.min),p=Math.max(p,g.max))}isFinite(d)&&(i.__workerSampledDomainMin=d),isFinite(p)&&(i.__workerSampledDomainMax=p);return;case"table":for(let u=0;u<t.length;u++){let g=t[u];"boundingBox"in g&&g.boundingBox&&(n||(n=[]),n.push(g.boundingBox))}n&&Qq(i,e,n);return;default:return}}function v9(r,e,t){var a,s,c,d;let o,i,n=__dcg_shared_module_exports__['f'](r.expressionAnalysis);for(o in e){if(!e.hasOwnProperty(o))continue;i=e[o];let p={isGraphable:!!i.is_graphable,isError:!!i.error,errorMessage:i.error?r.controller.unpack(i.error):void 0},u=(c=(s=(a=id(r,o))!=null?a:Vde(r,o))!=null?s:Gde(r,o))!=null?c:Zu(r,o);if((u==null?void 0:u.type)==="helper-expression")tW(r.controller,u,i);else if(u)switch(u.type){case"expression":L9(u,i);let{value:g,valueType:h}=(d=i.typed_constant_value)!=null?d:{};g!==void 0&&(h===__dcg_shared_module_exports__['E']?p.evaluation={type:"ListOfNumber",value:g.slice()}:__dcg_shared_module_exports__['y'](h,__dcg_shared_module_exports__['B'])&&(p.evaluation={type:"Number",value:g}),p.evaluationDisplayed=!!i.is_evaluable);break;case"image":uW(u,i);break;case"table":Gq(u,i);break;case"folder":case"text":break;default:return u}else o===r.ticker.id&&VW(r.ticker,i);o.startsWith(uv)&&$H(r.controller.getGeometryToolbarModel(),o,i),o!==r.ticker.id&&!o.startsWith(uv)&&(n[o]=p)}ZF(r),U0(r),uM(r),l9(r,__dcg_shared_module_exports__['Wd'](t)),r.expressionAnalysis=n}function Ir(r,e){r.selectedItemMap={},e&&(r.selectedItemMap[e.id]="selected")}function w9(r){return Object.values(r.selectedItemMap).some(e=>e==="tentatively-selected")}function S9(r,e){r.selectedItemMap={},e&&(r.selectedItemMap[e.id]="tentatively-selected")}function k9(r){for(let e in r.selectedItemMap)r.selectedItemMap[e]==="tentatively-selected"&&(r.selectedItemMap[e]="selected")}function _9(r){for(let e in r.selectedItemMap)r.selectedItemMap[e]==="tentatively-selected"&&delete r.selectedItemMap[e]}function t3(r,e,t){r.selectedItemMap[e]?delete r.selectedItemMap[e]:r.selectedItemMap[e]=t}function r3(r,e){r.selectedItemMap={};for(let t in e)r.selectedItemMap[t]="selected"}function Ag(r,e,t,o){if(e===t)return;let i=r.__itemModelArray.splice(e,o);e<t&&(t=t-o+1),r.__itemModelArray.splice.apply(r.__itemModelArray,[t,0,...i]),db(r)}function cn(r,e,t){let o=String(e.id);if(r.__itemIdToModel.hasOwnProperty(o))throw Error("Item with id '"+o+"' is already in list");r.__itemIdToModel[o]=e,r.__itemModelArray.splice(t,0,e),db(r)}function Dl(r,e){cn(r,e,Y0(r))}function Cv(r,e){let t=[],o=r.__itemModelArray[e];if(o.type==="folder"){let i=0,n=e+1;for(let a=n;a<r.__itemModelArray.length;a++){let s=r.__itemModelArray[a];if(s.type==="folder"||s.folderId!==o.id)break;Mn(s)&&Ir(r,void 0),s.readonly?(a>n&&(r.__itemModelArray[a]=r.__itemModelArray[n],r.__itemModelArray[n]=s),In(s,""),n+=1):(delete r.__itemIdToModel[s.id],delete r.expressionAnalysis[o.id],i+=1)}i>0&&t.push(...r.__itemModelArray.splice(n,i))}return Mn(o)&&Ir(r,void 0),t.push(...r.__itemModelArray.splice(e,1)),delete r.__itemIdToModel[o.id],delete r.expressionAnalysis[o.id],ZF(r),t.some(i=>el(i))&&U0(r),db(r),t}function C9(r){return r.__anyDependsOnRandomSeed}function T9(r){return r.__anyFunctionDefinitionsDependOnRandomSeed}function E9(r){return r.__anyIsAction}function I9(r){return r.__anyUnmutedTones}function ub(r,e){let t=id(r,e);return t?Cv(r,t.index):[]}function mM(r){let e=pb(r);if(!e)return!1;let t=R0(r,e.index);return t?(Ir(r,t),t.index===Y0(r)-1&&e.type==="expression"&&vs(e)&&Cv(r,t.index),!0):!1}function fM(r){let e=pb(r);if(!e)return!1;let t=F0(r,e.index);return t?(Ir(r,t),!0):!1}function M9(r,e){let t=r.selectedItemMap;return e in t?t[e]:void 0}function Mn(r){return!!r.controller.getListModel().selectedItemMap[r.id]}function D9(r){if(!r.controller.shouldShowAuthorFeatures()){r.renamePrompt.invalidate();return}let e=pb(r);r.renamePrompt.updateForSelectedItem(r,e)}function B0(r,e){r.dragState=e}function K0(r){switch(r.type){case"expression":return Ev(r);case"image":return UI(r);case"table":return[];case"text":return[];case"folder":return[];default:return r}}function A9(r,e){for(let t of lM(r))t.type==="folder"&&av(t,e)}function Tv(r){return r?r.type==="image"&&ob(r)||r.type==="expression"&&Jn(r):!1}function o3(r){return r.__exportedVariables}En();var Lv=class{suspend(){return new Promise((e,t)=>{if(this.audioContext)this.audioContext.suspend().then(()=>{e()}).catch(o=>{Er(o),t(o)});else{e();return}})}getResumedAudioContext(){return new Promise((e,t)=>{if(!this.audioContext){let o=window.AudioContext||window.webkitAudioContext;if(!o){t();return}try{this.audioContext=new o({latencyHint:"interactive",sampleRate:44100})}catch(i){t(i)}}this.audioContext&&(this.audioContext.state!=="running"?this.audioContext.resume().then(()=>{e({audioContext:this.audioContext,poiBuffer:this.poiBuffer})}).catch(o=>{Er(o),t(o)}):this.audioContext.resume().then(()=>{e({audioContext:this.audioContext,poiBuffer:this.poiBuffer})}).catch(o=>{Er(o),t(o)}))})}};var Yde=.25;function R9(r,e){return Yde*__dcg_shared_module_exports__['t'](r,0,Bde(e))}function Bde(r){return r<=0||!isFinite(r)?0:__dcg_shared_module_exports__['t'](660/r,0,10)}var Qn,Kde="data:audio/mpeg;base64,//uQx"+"A".repeat(23)+"WGluZwAAAA8AAAACAAACcQCA"+"gICA".repeat(16)+"/".repeat(66)+"8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkI"+"A".repeat(320)+"//sQxAADgnABGiAAQBCqgCRMAAgEAH"+"/".repeat(15)+"7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq"+"/".repeat(18)+"9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAw"+"V".repeat(97)+"Q==";function zde(){Qn&&(Qn.src="about:blank",Qn.load(),Qn=void 0)}function SM(){if(!(!ha&&!Ws)){if(!Qn){let r=document.createElement("div");Qn=document.createElement("audio"),r.appendChild(Qn),Qn.setAttribute("x-webkit-airplay","deny"),Qn.controls=!1,Qn.disableRemotePlayback=!0,Qn.preload="auto",Qn.loop=!0,Qn.src=Kde,Qn.load()}Qn.paused&&Qn.play().catch(zde)}}function kM(){Qn&&Qn.pause()}var F9=44100,bp=Gx?.02:0,Q0=class{constructor(e){this.expressionSynthMap=new Map;this.useOfflineContext=!1;this.globalUnmuteState=!1;this.hasEverInteractedWithMute=!1;this.eventListenerCleanupCbs=[];this.maxGain=.5;this.handleVisibilityChange=()=>{!this.audioContext||this.isGlobalMuted()||document.visibilityState==="hidden"&&this.controller.dispatch({type:"mute-global"})};this.handleDestroyOrUnload=()=>{if(this.eventListenerCleanupCbs.forEach(t=>{t()}),this.eventListenerCleanupCbs=[],!this.audioContext||this.isGlobalMuted())return;let e=this.audioContext;e instanceof AudioContext&&setTimeout(()=>{if(e.state!=="closed")try{e.close()}catch(t){}},100),this.handleAction({type:"mute-global"}),this.clearAudioContext()};this.audioContextManager=new Lv,this.controller=e,document.addEventListener("visibilitychange",this.handleVisibilityChange),this.eventListenerCleanupCbs.push(()=>{document.removeEventListener("visibilitychange",this.handleVisibilityChange)}),window.addEventListener("beforeunload",this.handleDestroyOrUnload),this.eventListenerCleanupCbs.push(()=>{window.removeEventListener("beforeunload",this.handleDestroyOrUnload)})}destroy(){this.handleDestroyOrUnload()}setOfflineAudio(){this.useOfflineContext=!0}prepareToRenderAudio(e){this.useOfflineContext&&(this.offlineBuffer=void 0,this.audioContext=new OfflineAudioContext(1,e*F9,F9),this.audioContext.addEventListener("complete",async t=>{this.offlineBuffer=t.renderedBuffer,this.clearAudioContext()}),this.createMainNodes(),this.recomputeAudio())}getHasEverInteractedWithMute(){return this.hasEverInteractedWithMute}registerMuteInteraction(){this.hasEverInteractedWithMute=!0}async startRendering(){return this.audioContext.startRendering()}getRenderedBuffer(){return this.offlineBuffer}clearAudioContext(){for(let e of this.expressionSynthMap.values())e.tearDown();this.audioContext=void 0,this.expressionSynthMap=new Map}async spinUpAudioContext(){if(!this.useOfflineContext){if(this.audioContext)this.audioContext.state==="suspended"&&!this.useOfflineContext&&await this.audioContext.resume();else{let e=await this.audioContextManager.getResumedAudioContext();this.audioContext=e.audioContext}this.gainNode||this.createMainNodes()}}createMainNodes(){this.audioContext&&(this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=0,this.compressor=this.audioContext.createDynamicsCompressor(),this.compressor.threshold.value=-10,this.compressor.knee.value=4,this.compressor.ratio.value=20,this.compressor.attack.value=.01,this.compressor.release.value=.01,this.gainNode.connect(this.compressor),this.compressor.connect(this.audioContext.destination))}async _recomputeAudio(e){var t,o,i,n,a,s,c;if(e.length!==0&&!(this.nothingShouldSound()&&((t=this.audioContext)==null?void 0:t.state)!=="running")){if(this.useOfflineContext){if(!this.audioContext)return}else await this.spinUpAudioContext();if(this.nothingShouldSound()){if(this.expressionSynthMap.size>0){for(let d of this.expressionSynthMap.values())d.tearDown();this.expressionSynthMap.clear()}}else for(let d of e){let p=d.type==="expression"?d.formula.typed_constant_value:void 0,u=d.id;p&&!this.expressionSynthMap.has(u)&&this.expressionSynthMap.set(u,new _M(this,this.gainNode)),(o=this.expressionSynthMap.get(u))==null||o.updateFromValues(p),d.type==="remove"&&this.expressionSynthMap.has(u)?((i=this.expressionSynthMap.get(u))==null||i.tearDown(),this.expressionSynthMap.delete(u)):d.type==="expression"&&(ek(d)?(a=this.expressionSynthMap.get(u))==null||a.setGain(0):(n=this.expressionSynthMap.get(u))==null||n.setGain(this.maxGain))}this.audioContext&&(this.expressionSynthMap.size>0&&!this.isGlobalMuted()?(s=this.gainNode)==null||s.gain.setTargetAtTime(1,this.audioContext.currentTime+bp,Qu):(c=this.gainNode)==null||c.gain.setTargetAtTime(0,this.audioContext.currentTime+bp,Qu))}}nothingShouldSound(){return!this.globalUnmuteState||!this.hasAnyUnmutedTones()}recomputeAudio(){U0(this.controller.getListModel());let t=this.controller.getAllItemModels().filter(n=>z0(n)),o=[],i=new Set(t.map(n=>n.id));for(let n of this.expressionSynthMap.keys())i.has(n)||o.push({id:n,type:"remove"});this._recomputeAudio([...t,...o])}isGlobalMuted(){return!this.globalUnmuteState}someExpressionsShouldPlayTones(){var e,t;return(t=(e=this.controller)==null?void 0:e.getAllItemModels())==null?void 0:t.some(o=>z0(o))}hasAnyUnmutedTones(){return I9(this.controller.getListModel())}handleAction(e){var t,o,i,n;switch(e.type){case"mute-global":{kM(),this.globalUnmuteState=!1,(o=(t=this.controller).logEvent)==null||o.call(t,{category:"tone",action:"mute-global"});break}case"unmute-global":{SM(),this.globalUnmuteState=!0,this.hasEverInteractedWithMute=!0,(n=(i=this.controller).logEvent)==null||n.call(i,{category:"tone",action:"unmute-global"});break}default:return e}this.recomputeAudio()}handleMuteKeyShortcut(){this.controller.toneItemsExist()?this.isGlobalMuted()?(this.controller.dispatch({type:"unmute-global"}),It(this.controller.s("graphing-calculator-narration-unmuted")),this.someExpressionsShouldPlayTones()||It(this.controller.s("graphing-calculator-narration-no-playing-tones"))):(this.controller.dispatch({type:"mute-global"}),It(this.controller.s("graphing-calculator-narration-muted"))):It(this.controller.s("graphing-calculator-narration-no-tone-expressions")),_e()}};var Qu=.005,qde=15e-5,Pv=20,Gv=2e4,i3=class{constructor(e,t){e.audioContext&&(this.audioContext=e.audioContext,this.oscillator=this.audioContext.createOscillator(),this.oscillator.type="sine",this.gain=this.audioContext.createGain(),this.gain.gain.value=0,this.oscillator.connect(this.gain),this.gain.connect(t),this.oscillator.start())}stop(e=0){this.gain.gain.setTargetAtTime(0,this.audioContext.currentTime+e+bp,Qu),setTimeout(()=>{this.oscillator.stop()},1e3*(2*Qu+e+bp)+1)}setFrequencyAndGain(e,t){(!isFinite(e)||!isFinite(t)||e>Gv||e<Pv)&&(t=0);let o=R9(t,e);o>0&&this.oscillator.frequency.setTargetAtTime(__dcg_shared_module_exports__['t'](e,Pv,Gv),this.audioContext.currentTime+bp,qde),this.gain.gain.setTargetAtTime(o,this.audioContext.currentTime+bp,Qu)}},_M=class{constructor(e,t){e.audioContext&&(this.audioContext=e.audioContext,this.gain=this.audioContext.createGain(),this.gain.gain.value=0,this.gain.connect(t),this.synthesizers=[])}updateFromValues(e){var t,o,i;if(e&&e.valueType===__dcg_shared_module_exports__['aa'])this.synthesizers.length>1?(this.tearDownSynthesizers(this.synthesizers.slice(1)),this.synthesizers.length=1):this.synthesizers.length===0&&(this.synthesizers=[this.makeSynth()]),(t=this.synthesizers[0])==null||t.setFrequencyAndGain(e.value[0],e.value[1]);else if(e&&e.valueType===__dcg_shared_module_exports__['ba']){if(this.synthesizers.length>e.value.length&&(this.tearDownSynthesizers(this.synthesizers.slice(e.value.length)),this.synthesizers.length=e.value.length),e.value.length>this.synthesizers.length)for(let n=this.synthesizers.length;n<e.value.length;n++)this.synthesizers.push(this.makeSynth());for(let n=0;n<e.value.length;n++)this.synthesizers[n].setFrequencyAndGain(e.value[n][0],e.value[n][1])}else this.tearDownSynthesizers(this.synthesizers),this.synthesizers=[];this.synthesizers.length>0?(o=this.gain)==null||o.gain.setTargetAtTime(1,this.audioContext.currentTime+bp,Qu):(i=this.gain)==null||i.gain.setTargetAtTime(0,this.audioContext.currentTime+bp,Qu)}makeSynth(){return new i3(this,this.gain)}tearDownSynthesizers(e){if(e)for(let t of e)t.stop()}setGain(e){this.gain.gain.setTargetAtTime(e,this.audioContext.currentTime+bp,Qu)}tearDown(){this.tearDownSynthesizers(this.synthesizers),this.synthesizers=[]}};var yp=4;function Wde(r){return r===void 0?NaN:+r}function xs(r){return!!r&&r.type==="expression"&&!!r.formula&&!!r.formula.typed_constant_value&&!!r.formula.geometry}function jde(r){var t,o;let e=r.formula;return e?r.controller.isDecimalToFractionEnabled()&&((t=e.typed_constant_value)==null?void 0:t.valueType)===__dcg_shared_module_exports__['B']&&__dcg_shared_module_exports__['rb'](Wde((o=e.typed_constant_value)==null?void 0:o.value)):!1}function eh(r){return!!(r.formula&&r.formula.is_graphable)}function N9(r){return!(!Hv(r)||!ppe(r)||!dpe(r))}function U9(r){var s,c,d;let e=r.formula;if(!e)return!1;if(e.warning){let p=(s=r.formula.typed_constant_value)==null?void 0:s.value;if(p===void 0||Number.isNaN(p))return!1}let o=!(e.operator==="="&&r.controller.isThreeDMode()&&(e.assignment==="x"||e.assignment==="y"||e.assignment==="z"||e.assignment==="r"))&&e.is_evaluable&&((c=e.typed_constant_value)==null?void 0:c.value)!==void 0,n=[__dcg_shared_module_exports__['E'],__dcg_shared_module_exports__['$']].includes((d=e.typed_constant_value)==null?void 0:d.valueType),a=jde(r)&&Gg(r);return!!(o||a||n)}function th(r){var a,s,c;let e=(a=r.formula)==null?void 0:a.recursion;if(!e||e.type==="iterative"||!e.recursiveStructure)return[];if(e.recursionGroup.length>1)return[];let{maxRecursiveCallOffsets:t,parameterSymbols:o,baseCaseInfo:i}=e.recursiveStructure,n=[];for(let d in t){if(((s=o[d])==null?void 0:s.length)!==1)continue;let p=i[d];if(p&&Math.abs(p.min)>cF)continue;let u=t[d],g,h;p?(g=p.min+u-1,h=p.min+p.consecutiveCount):(g=u,h=1);for(let b=h;b<=g;b++)if(!((c=p==null?void 0:p.additional)!=null&&c.includes(b))&&(n.push(`${__dcg_shared_module_exports__['vb'](d)}\\left(${b}\\right)`),n.length>yp))return[]}return n}function Vv(r){let e=r.formula.ttest_results;if(!(!e||!isFinite(e.lessThan)))return{lessThan:e.lessThan,greaterThan:e.greaterThan,notEqual:e.notEqual}}function Y9(r){let e=r.formula.stats_results;if(!(!e||!isFinite(e.min)))return{min:e.min,q1:e.q1,median:e.median,q3:e.q3,max:e.max}}function vs(r){let e=r.latex||"",t=r.label||"";return(e+t).split(" ").join("")===""}function co(r,e={isReverseDrag:!1}){let t=r.dragMode===__dcg_shared_module_exports__['Gd'].AUTO&&r.formula.default_drag_mode!==void 0?r.formula.default_drag_mode:r.dragMode;return r.controller.isThreeDMode()&&(t=__dcg_shared_module_exports__['Gd'].NONE),r.dragMode===__dcg_shared_module_exports__['Gd'].AUTO&&!e.isReverseDrag&&ji(r)&&(t=__dcg_shared_module_exports__['Gd'].NONE),__dcg_shared_module_exports__['Hd'](t,r.formula.move_strategy)}function Xde(r){let e=co(r);r.interactiveLabel&&e!==__dcg_shared_module_exports__['Gd'].NONE&&rk(r,!1)}function Ev(r){let e=r.formula;return e?e.is_single_identifier?[]:e.variables.map(t=>__dcg_shared_module_exports__['vb'](t)):[]}function L9(r,e){r.formula=e,r.error=e.error,r.unresolved=!1,r.expressionTooComplex=!1,r.recursiveDepthPlottingError=!1,r.nanBlame=__dcg_shared_module_exports__['nd'].None,e.is_slider?(!r.sliderExists||r.resetSliderAnimationTargetValue)&&(r.sliderAnimationTargetValue=Qs(r),r.sliderDragging=!1,r.sliderExists=!0):r.sliderExists=!1,r.resetSliderAnimationTargetValue=!1;let t={};e.is_regression&&(t=e.regression.parameters,r.residualVariable=e.regression.residualVariable,r.controller.areLogModeRegressionsForced()&&(r.isLogModeRegression=!0)),__dcg_shared_module_exports__['db'](r.regressionParameters,t)||(r.regressionParameters=t)}function el(r){var e,t;return r.type==="expression"&&(((e=r.formula.typed_constant_value)==null?void 0:e.valueType)===__dcg_shared_module_exports__['aa']||((t=r.formula.typed_constant_value)==null?void 0:t.valueType)===__dcg_shared_module_exports__['ba'])}function B9(r){var t,o,i,n;if(!el(r)||((t=r.formula.typed_constant_value)==null?void 0:t.valueType)===__dcg_shared_module_exports__['ba']||((o=r.formula.typed_constant_value)==null?void 0:o.valueType)===__dcg_shared_module_exports__['aa']&&((i=r.formula.typed_constant_value)==null?void 0:i.value[0])>=Pv&&((n=r.formula.typed_constant_value)==null?void 0:n.value[0])<=Gv)return!1;let e=__dcg_shared_module_exports__['xe'](r.latex);return!!(e&&e._dependencies&&e._dependencies.length===1)}function ek(r){var e;return!!r.hidden||!!((e=Ua(r))!=null&&e.hidden)}function z0(r){return!el(r)||ek(r)?!1:r.formula.typed_constant_value.valueType===__dcg_shared_module_exports__['aa']?r.formula.typed_constant_value.value[1]>0:r.formula.typed_constant_value.valueType===__dcg_shared_module_exports__['ba']?r.formula.typed_constant_value.value.some(e=>e[1]>0):!1}function $de(r){if(r.shouldGraph=!ji(r),r.folderId===__dcg_shared_module_exports__['Zd']){let e=r.controller.getExpressionIdForIdentifier(r.controller.getHoveredOrFocusedTokenIdentifier())===r.id,t=r.controller.isItemSelected(r.id);(e||t||r.controller.getGhostMode())&&(r.shouldGraph=!0)}}function ji(r){var t;if(!r)return!1;if(r.hidden)return!0;if((t=r==null?void 0:r.formula)!=null&&t.expression_type&&Uv(r))return!0;let e=Ua(r);return!!(e&&e.hidden)}function Jde(r){let e=r.formula&&r.formula.raw_slider_latex;if(!r.sliderExists||r.latex!==e){r.cachedDisplayLatex={storedLatex:r.latex,valueLatex:r.latex};return}let{latex:t}=r;if(r.cachedDisplayLatex.storedLatex!==t){r.cachedDisplayLatex={storedLatex:r.latex,valueLatex:r.latex};return}let o=KF(r);if(isFinite(o)){let i=r.controller.getFocusLocation();i&&i.type==="expression"&&i.id===r.id||(r.cachedDisplayLatex.valueLatex=$u(r.latex,o))}}function n3(r){return r.cachedDisplayLatex.valueLatex}function K9(r,e){return r.formula.viz_valids?!!r.formula.viz_valids[e]:!1}function rh(r,e){return r.vizProps[e]}function z9(r,e,t){r.vizProps={...r.vizProps,[e]:t}}function Ov(r,e){if(e.type==="inert")r.disableGraphInteractions=e.disableGraphInteractions,e.disableGraphInteractions&&(r.dragMode=__dcg_shared_module_exports__['Gd'].NONE,r.clickableInfo={...r.clickableInfo,enabled:!1},r.editableLabelMode=__dcg_shared_module_exports__['$d'].None,r.interactiveLabel=!1);else if(e.type==="drag-mode"){let t=e.dragMode;r.dragMode=t,t!==__dcg_shared_module_exports__['Gd'].NONE&&(r.disableGraphInteractions=!1),r.movablePointSize!==r.pointSize&&(t===__dcg_shared_module_exports__['Gd'].NONE?r.pointSize=r.movablePointSize:r.movablePointSize=r.pointSize)}else e.type==="clickable"?(r.clickableInfo=e.clickableInfo,e.clickableInfo.enabled&&(r.disableGraphInteractions=!1)):e.type==="editable-label"?(r.editableLabelMode=e.editable,e.editable!==__dcg_shared_module_exports__['$d'].None&&(r.disableGraphInteractions=!1)):e.type==="interactive-label"&&(r.interactiveLabel=e.interactive,e.interactive&&(r.disableGraphInteractions=!1))}function q9(r,e,t){Ov(r,{type:"clickable",clickableInfo:{...r.clickableInfo,[e]:t}})}function bM(r,e){Ov(r,{type:"clickable",clickableInfo:{...r.clickableInfo,latex:e}})}function Jn(r){var e;return!!(r.clickableInfo.enabled&&Z0(r)&&((e=r.formula.click_handler)==null?void 0:e.status)==="maybe-valid")}function Rv(r){return!!(r&&r.type==="expression"&&Jn(r))}function H9(r){return!!r.__workerNeedsDotplotXMode}function CM(r,e){var t;if(!e)throw new Error("Programming Error in test. Pass domain variable");return(t=r.formula.domains)==null?void 0:t.find(o=>o.variable===e)}function W9(r,e){if(!r.formula)return NaN;if(zv(r)&&isFinite(r.__workerSampledDomainMin))return r.__workerSampledDomainMin;let t=CM(r,e),o=t==null?void 0:t.minNumber;return o!==void 0&&isFinite(o)?o:NaN}function j9(r,e){if(!r.formula)return NaN;if(zv(r)&&isFinite(r.__workerSampledDomainMax))return r.__workerSampledDomainMax;let t=CM(r,e),o=t==null?void 0:t.maxNumber;return o!==void 0&&isFinite(o)?o:NaN}function X9(r,e){let t=CM(r,e);return t?t.minValid:!1}function $9(r,e){let t=CM(r,e);return t?t.maxValid:!1}function q0(r,e){let t=r.cachedViewState;if((!e.stripDefaults||r.parametricDomain.min!==""||r.parametricDomain.max!=="")&&(t={...t,domain:{min:r.parametricDomain.min===""?"0":r.parametricDomain.min,max:r.parametricDomain.max===""?"1":r.parametricDomain.max}}),e.stripDefaults)return __dcg_shared_module_exports__['ie'](t,{is3d:r.controller.is3dProduct()});if(t.points===void 0||t.lines===void 0||t.fill===void 0){let o=__dcg_shared_module_exports__['f'](t);return o.points===void 0&&delete o.points,o.lines===void 0&&delete o.lines,o.fill===void 0&&delete o.fill,o}return t}function Zde(r){let e=r.cachedViewState;e&&__dcg_shared_module_exports__['ke'](e,r)&&__dcg_shared_module_exports__['be'].every(t=>e[t]===r[t])||(r.cachedViewState={...__dcg_shared_module_exports__['bb'](r,__dcg_shared_module_exports__['be']),...__dcg_shared_module_exports__['je'](r)})}function J9(r,e){e&&sb(r),r.draggingOnGraphpaper=e}function Qde(r){let e=r.memoizedUndoRedoStateParams,t=r.cachedViewState,o=r.preTransientState;if(r.cachedUndoRedoFullState=t,e&&e.viewState===t&&e.preTransientState===o)return;r.memoizedUndoRedoStateParams={viewState:t,preTransientState:o};let i;o?i={...t,latex:o.latex,slider:{...t.slider,...o.slider}}:i={...t},delete i.regressionParameters,delete i.residualVariable,r.cachedUndoRedoDiffState=i}function yM(r,e){let t=__dcg_shared_module_exports__['f'](__dcg_shared_module_exports__['he'](r,{is3d:e.is3dProduct(),defaultLogModeRegressions:e.areLogModeRegressionsDefault()})),{color:o}=t;return(!o||!jx(o))&&(o=e.getNextColor()),{...t,...cp(e),labelDropdownOpen:!1,formula:{error:void 0,operator:"=",variables:[]},error:void 0,unresolved:!1,expressionTooComplex:!1,color:o,pointStyle:t.pointStyle,lineStyle:t.lineStyle,arrowMode:t.arrowMode,displayEvaluationAsFraction:t.displayEvaluationAsFraction,shouldGraph:void 0,sliderDragging:void 0,sliderAnimationTargetValue:void 0,resetSliderAnimationTargetValue:!1,sliderLastTickTime:void 0,draggingOnGraphpaper:!1,cachedUndoRedoDiffState:void 0,cachedUndoRedoFullState:void 0,cachedParsableState:void 0,cachedViewState:void 0,cachedDisplayLatex:{storedLatex:"",valueLatex:""}}}function epe(r){let e=Ua(r),t=!!(e&&e.hidden),o=r.cachedViewState,i=r.index,n=r.showLabel&&!t,a=r.showAngleLabel,s=r.shouldGraph,c=r.memoizedParsableStateParams;if(c&&c.viewState===o&&c.index===i&&c.showLabel===n&&c.showAngleLabel===a&&c.shouldGraph===s)return;r.memoizedParsableStateParams={viewState:o,index:i,showLabel:n,showAngleLabel:a,shouldGraph:s};let d=__dcg_shared_module_exports__['le'](o);d.moduleID=rv(r),d.index=i,d.showLabel=n,d.showAngleLabel=a,d.shouldGraph=s,d.isInConstructionsFolder=r.folderId===__dcg_shared_module_exports__['Zd'],d.shouldExportToNotebook=/export/i.test((e==null?void 0:e.title)||""),r.cachedParsableState=d}function xM(r,e){e(r.latex,"latex"),e(r.clickableInfo.latex,"clickableInfoLatex"),e(r.lineWidth,"lineWidth"),e(r.fillOpacity,"fillOpacity"),e(r.surfaceOpacity,"surfaceOpacity"),e(r.lineOpacity,"lineOpacity"),e(r.pointOpacity,"pointOpacity"),e(r.pointSize,"pointSize"),e(r.movablePointSize,"movablePointSize"),e(r.labelSize,"labelSize"),e(r.labelAngle,"labelAngle"),e(r.colorLatex,"colorLatex"),Kv(r)&&(e(r.parametricDomain.min,"parametricDomainMin"),e(r.parametricDomain.max,"parametricDomainMax")),(k7(r)||S7(r))&&(e(r.parametricDomain3Du.min,"parametricDomain3DuMin"),e(r.parametricDomain3Du.max,"parametricDomain3DuMax"),e(r.parametricDomain3Dv.min,"parametricDomain3DvMin"),e(r.parametricDomain3Dv.max,"parametricDomain3DvMax")),(zv(r)||LM(r))&&(e(r.polarDomain.min,"polarDomainMin"),e(r.polarDomain.max,"polarDomainMax")),(g3(r)||npe(r))&&e(r.resolution,"resolution"),Hv(r)&&(e(r.cdf.min,"cdfMin"),e(r.cdf.max,"cdfMax"),r.cdf.p&&e(r.cdf.p,"cdfP")),r.sliderExists&&(e(r.slider.min,"sliderMin"),e(r.slider.max,"sliderMax"),e(r.slider.step,"sliderStep")),r.residualVariable&&e(r.residualVariable,"residualVariable"),ea(r)&&(r.inference.significance.hypothesis&&e(r.inference.significance.hypothesis,"inferenceHypothesis"),r.inference.confidence.confidenceLevel&&e(r.inference.confidence.confidenceLevel,"inferenceConfidenceLevel"))}function Pg(r){return r.formula&&r.formula.assignment}function a3(r){return r.formula&&r.formula.shader}function Go(r){let e=r.cachedAssignmentOrFunctionName;if(e&&e.latex===r.latex)return e.result;let t=m0(r.latex),o=t?{latex:t,identifier:__dcg_shared_module_exports__['wb'](t)}:void 0;return r.cachedAssignmentOrFunctionName={latex:r.latex,result:o},o}function Z9(r){var t,o;let e=(o=(t=r.formula)==null?void 0:t.typed_constant_value)==null?void 0:o.valueType;return e==null?!1:__dcg_shared_module_exports__['qa'](e)}function TM(r){var o;let e=(o=Go(r))==null?void 0:o.latex,t=e==null?void 0:e.match(/^(\\token\{\d+\})$/);if(t)return t[1]}function Q9(r){var o,i;let e=(i=(o=r.formula)==null?void 0:o.typed_constant_value)==null?void 0:i.valueType,t=!1;if(e&&__dcg_shared_module_exports__['qa'](e)&&(t=!0,e=__dcg_shared_module_exports__['ra'](e)),e==null||!__dcg_shared_module_exports__['ta'](e))return"U";switch(e){case __dcg_shared_module_exports__['C']:return t?"P":"p";case __dcg_shared_module_exports__['K']:case __dcg_shared_module_exports__['Q']:case __dcg_shared_module_exports__['O']:return t?"L":"l";case __dcg_shared_module_exports__['Y']:return t?"V":"v";case __dcg_shared_module_exports__['N']:case __dcg_shared_module_exports__['M']:return t?"C":"c";case __dcg_shared_module_exports__['S']:case __dcg_shared_module_exports__['U']:return t?"A":"a";case __dcg_shared_module_exports__['J']:return"P";case __dcg_shared_module_exports__['W']:return"T";default:return e}}function tpe(r){var t,o;let e=(o=(t=r.formula)==null?void 0:t.typed_constant_value)==null?void 0:o.valueType;if(e==null||(__dcg_shared_module_exports__['qa'](e)&&(e=__dcg_shared_module_exports__['ra'](e)),!__dcg_shared_module_exports__['ta'](e)))return"unknown";switch(e){case __dcg_shared_module_exports__['C']:return"point";case __dcg_shared_module_exports__['K']:return"segment";case __dcg_shared_module_exports__['Q']:return"ray";case __dcg_shared_module_exports__['O']:return"line";case __dcg_shared_module_exports__['Y']:return"vector";case __dcg_shared_module_exports__['N']:return"arc";case __dcg_shared_module_exports__['M']:return"circle";case __dcg_shared_module_exports__['S']:return"angle";case __dcg_shared_module_exports__['U']:return"directedangle";case __dcg_shared_module_exports__['J']:return"polygon";case __dcg_shared_module_exports__['W']:return"transformation";default:return e}}function s3(r){var t,o;let e=(o=(t=r.formula)==null?void 0:t.typed_constant_value)==null?void 0:o.valueType;if(e==null||(__dcg_shared_module_exports__['qa'](e)&&(e=__dcg_shared_module_exports__['ra'](e)),!__dcg_shared_module_exports__['ta'](e)))return"unknown";switch(e){case __dcg_shared_module_exports__['C']:return"point";case __dcg_shared_module_exports__['K']:case __dcg_shared_module_exports__['Q']:case __dcg_shared_module_exports__['O']:case __dcg_shared_module_exports__['Y']:return"line";case __dcg_shared_module_exports__['N']:return"arc";case __dcg_shared_module_exports__['M']:return"circle";case __dcg_shared_module_exports__['S']:return"angle";case __dcg_shared_module_exports__['U']:return"directedangle";case __dcg_shared_module_exports__['J']:return"polygon";case __dcg_shared_module_exports__['W']:return"transformation";default:return e}}function e7(r){return r.indexOf("\\token{")!==-1}function t7(r){var o,i,n,a;let e=(i=(o=r.formula.geometry)==null?void 0:o.call)==null?void 0:i.symbol,t=(a=(n=r.formula)==null?void 0:n.typed_constant_value)==null?void 0:a.valueType;return!e||e==="apply"||__dcg_shared_module_exports__['Pc'](e)&&t!==void 0&&!__dcg_shared_module_exports__['wa'](t,__dcg_shared_module_exports__['W'])?tpe(r):e==="segments"?"segment":e}function rpe(r){return!!(r.sliderExists&&(r.slider.isPlaying||r.sliderDragging)||r.draggingOnGraphpaper)}function r7(r){return!!(r.sliderExists&&r.sliderDragging||r.draggingOnGraphpaper)}function EM(r){rpe(r)?r.preTransientState||(r.preTransientState={latex:r.latex,slider:{min:r.slider.min,max:r.slider.max,playDirection:r.slider.playDirection}}):delete r.preTransientState,(!r.sliderExists||!r.slider.isPlaying)&&(r.sliderLastTickTime=void 0),dp(r),$de(r),Xde(r),Zde(r),Qde(r),epe(r),Jde(r)}var ope={...__dcg_shared_module_exports__['ae'],extendTo3D:!1,id:!1,type:!1,...__dcg_shared_module_exports__['Ud'](__dcg_shared_module_exports__['de'])};function P9(r,e){__dcg_shared_module_exports__['Rd']({from:e,to:r,props:ope}),r.resetSliderAnimationTargetValue=!0,r.sliderAnimationTargetValue=void 0}function tk(r,e){r.slider={...r.slider,...e}}function Zn(r,e){let t=Wx(e);if(isFinite(t)){let o=__dcg_shared_module_exports__['Hc']({target:t,step:od(r),hardMin:r.slider.hardMin?Zs(r):void 0,hardMax:r.slider.hardMax?bc(r):void 0});o.min||tk(r,{hardMin:!1,min:"-10"}),o.max||tk(r,{hardMax:!1,max:"10"}),o.step||tk(r,{step:""})}r.latex=e}function o7(r,e){tk(r,{loopMode:e,playDirection:1}),e===__dcg_shared_module_exports__['Pd'].PLAY_INDEFINITELY&&tk(r,{hardMin:!1,hardMax:!1,min:"",max:""}),r.sliderAnimationTargetValue=Zs(r)}function Gg(r){var e;return((e=r.formula.typed_constant_value)==null?void 0:e.valueType)===__dcg_shared_module_exports__['_']?!1:r.displayEvaluationAsFraction}function i7(r,e){r.displayEvaluationAsFraction=e}function fp(r,e){r.label=e}function Vg(r,e){Lg(r)?r.showAngleLabel=e:r.showLabel=e}function n7(r,e){r.description=e}function bs(r,e,t){switch(t){case"theta":r.polarDomain={...r.polarDomain,min:e};break;case"t":r.parametricDomain={...r.parametricDomain,min:e};break;case"u":r.parametricDomain3Du={...r.parametricDomain3Du,min:e};break;case"v":r.parametricDomain3Dv={...r.parametricDomain3Dv,min:e};break;case"r":r.parametricDomain3Dr={...r.parametricDomain3Dr,min:e};break;case"phi":r.parametricDomain3Dphi={...r.parametricDomain3Dphi,min:e};break;default:return t}}function ys(r,e,t){switch(t){case"theta":r.polarDomain={...r.polarDomain,max:e};break;case"t":r.parametricDomain={...r.parametricDomain,max:e};break;case"u":r.parametricDomain3Du={...r.parametricDomain3Du,max:e};break;case"v":r.parametricDomain3Dv={...r.parametricDomain3Dv,max:e};break;case"r":r.parametricDomain3Dr={...r.parametricDomain3Dr,max:e};break;case"phi":r.parametricDomain3Dphi={...r.parametricDomain3Dphi,max:e};break;default:return t}}function l3(r,e){r.isLogModeRegression=e}function IM(r,e){jx(e)&&(r.color=e,r.colorLatex="")}function c3(r,e){r.fill=e}function H0(r,e){r.fillOpacity!==e&&(r.fillOpacity=e)}function W0(r,e){r.surfaceOpacity!==e&&(r.surfaceOpacity=e)}function Iv(r,e){r.lineOpacity!==e&&(r.lineOpacity=e)}function j0(r,e){r.pointOpacity!==e&&(r.pointOpacity=e)}function X0(r,e){r.pointSize===e&&r.movablePointSize===e||(r.pointSize=e,r.movablePointSize=e)}function Mv(r,e){r.lineWidth!==e&&(r.lineWidth=e)}function vM(r,e){r.resolution!==e&&(r.resolution=e)}function $0(r,e){r.colorLatex!==e&&(r.colorLatex=e)}function a7(r,e){r.labelDropdownOpen=e}function Fv(r,e){Ov(r,{type:"drag-mode",dragMode:e})}function d3(r,e){r.points=e}function p3(r,e){r.pointStyle!==e&&(r.pointStyle=e)}function u3(r,e){r.lines=e}function s7(r,e){r.extendTo3D=e}function MM(r,e){r.lineStyle!==e&&(r.lineStyle=e)}function l7(r,e){r.arrowMode=e===ipe(r)?__dcg_shared_module_exports__['Md'].DEFAULT:e}function ipe(r){return __dcg_shared_module_exports__['Md'].NONE}function J0(r,e){r.labelSize=e}function wM(r,e){r.labelAngle=e}function h3(r,e){r.labelOrientation=e}function c7(r,e){r.suppressTextOutline=e}function d7(r,e){r.pointOutline=e}function rk(r,e){Ov(r,{type:"interactive-label",interactive:e})}function DM(r,e){Ov(r,{type:"editable-label",editable:e})}function p7(r){return r.editableLabelMode}function Nv(r){let{editableLabelMode:e}=r;return e===__dcg_shared_module_exports__['$d'].Math||e===__dcg_shared_module_exports__['$d'].Text}function u7(r,e){r.strictIntersection=e}function h7(r){return!!(co(r)!==__dcg_shared_module_exports__['Gd'].NONE&&ji(r))}function g7(r,e){r.hidden=e,!e&&Uv(r)&&(r.lines=r.points=r.fill=void 0)}function Uv(r){if(xp(r)&&!r.controller.isThreeDMode())return!1;let{points:e,lines:t,fill:o}=r,i=__dcg_shared_module_exports__['Wc'](r.formula.expression_type,{points:e,lines:t,fill:o},n=>{Er("getReconciledExpressionProps [Chrome Switch Bug]",{metaData:{method:"areAllVisibilityPropsOff",type:n}})});return!i.points&&!i.lines&&!i.fill}function Og(r){return r.formula.map_type!==void 0?!1:Kv(r)||zv(r)||LM(r)}function oh(r){return r.formula.map_type!==void 0?!1:k7(r)||S7(r)||m3(r)}function m7(r,e){switch(e){case"theta":return r.polarDomain.min;case"t":return r.parametricDomain.min;case"u":return r.parametricDomain3Du.min;case"v":return r.parametricDomain3Dv.min;case"r":return r.parametricDomain3Dr.min;case"phi":return r.parametricDomain3Dphi.min;default:return e}}function f7(r,e){switch(e){case"theta":return r.polarDomain.max;case"t":return r.parametricDomain.max;case"u":return r.parametricDomain3Du.max;case"v":return r.parametricDomain3Dv.max;case"r":return r.parametricDomain3Dr.max;case"phi":return r.parametricDomain3Dphi.max;default:return e}}function Yv(r){return!!r.formula.action_value&&Object.keys(r.formula.action_value).length>0}function b7(r){return!!r.sliderExists}function Dv(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].POLYGON}function xp(r){return!!r.formula.is_inequality}function Bv(r){return!!r.formula.is_regression}function Kv(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].PARAMETRIC||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].CURVE3D_xyz_t&&!lpe(r)&&!cpe(r)}function hb(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].POINT3D}function npe(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].CURVE3D_xyz_t||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE_r\u03B8z_at_z||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE_zr\u03B8_at_r||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE_zr\u03B8_at_\u03B8||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE_zr\u03B8_at_xyz||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE_r\u03B8\u03C6_at_\u03B8||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE_r\u03B8\u03C6_at_\u03C6||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE_r\u03B8\u03C6_at_xyz||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE_xyz_uv}function y7(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE_zr\u03B8_at_r||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE_r\u03B8\u03C6_at_\u03B8}function x7(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE_zr\u03B8_at_\u03B8||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE_r\u03B8\u03C6_at_\u03C6}function g3(r){switch(r.formula.expression_type){case __dcg_shared_module_exports__['Vc'].SURFACE_xyz_uv:case __dcg_shared_module_exports__['Vc'].SURFACE_z_r\u03B8:case __dcg_shared_module_exports__['Vc'].SURFACE_r_\u03B8z:case __dcg_shared_module_exports__['Vc'].SURFACE_r_\u03B8z_AMBIGUOUS:case __dcg_shared_module_exports__['Vc'].SURFACE_r_\u03B8\u03C6:case __dcg_shared_module_exports__['Vc'].SURFACE:case __dcg_shared_module_exports__['Vc'].SURFACE_AMBIGUOUS:case __dcg_shared_module_exports__['Vc'].SURFACE_CONSTANT_AMBIGUOUS:case __dcg_shared_module_exports__['Vc'].IMPLICIT_SURFACE:case __dcg_shared_module_exports__['Vc'].IMPLICIT_SURFACE_AMBIGUOUS:case __dcg_shared_module_exports__['Vc'].TRIANGLE3D:case __dcg_shared_module_exports__['Vc'].SPHERE3D:return!0;default:return!1}}function AM(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].TRIANGLE3D}function v7(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SPHERE3D}function w7(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].IMPLICIT_SURFACE||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].IMPLICIT_SURFACE_AMBIGUOUS}function ok(r){return ape(r)||spe(r)}function ape(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].X_OR_Y||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].IMPLICIT||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SURFACE_AMBIGUOUS||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SURFACE_CONSTANT_AMBIGUOUS||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].IMPLICIT_SURFACE_AMBIGUOUS}function spe(r){return!r.formula.is_inequality&&(r.formula.expression_type===__dcg_shared_module_exports__['Vc'].POLAR||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SURFACE_r_\u03B8z_AMBIGUOUS)}function zv(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].POLAR}function LM(r){return __dcg_shared_module_exports__['_c'](r.formula.expression_type)}function m3(r){return __dcg_shared_module_exports__['Zc'](r.formula.expression_type)}function S7(r){return __dcg_shared_module_exports__['Yc'](r.formula.expression_type)}function k7(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SURFACE_xyz_uv||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SLICE_xyz_uv}function Lg(r){let e=r.formula.typed_constant_value;if(!e)return!1;let t=e.valueType;return t===__dcg_shared_module_exports__['S']||t===__dcg_shared_module_exports__['T']||t===__dcg_shared_module_exports__['U']||t===__dcg_shared_module_exports__['V']}function ws(r){let e=Lg(r);return e&&r.showAngleLabel||!e&&r.showLabel}function Av(r){if($c(r))return!0;let e=r.formula.typed_constant_value;if(!e)return!1;let t=e.valueType;return t===__dcg_shared_module_exports__['K']||t===__dcg_shared_module_exports__['L']||t===__dcg_shared_module_exports__['S']||t===__dcg_shared_module_exports__['T']||t===__dcg_shared_module_exports__['U']||t===__dcg_shared_module_exports__['V']}function lpe(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SEGMENT3D}function cpe(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].VECTOR3D}function Dn(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SINGLE_POINT}function Rg(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].POINT_LIST}function $c(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].POINT_LIST||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].SINGLE_POINT}function Fg(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].POINT3D_LIST}function Ng(r){let e=wp(r);return!!(e&&e.type==="visualization"&&e.symbol==="boxplot")}function ih(r){let e=wp(r);return!!(e&&e.type==="visualization"&&e.symbol==="dotplot")}function gb(r){let e=wp(r);return!!(e&&e.type==="visualization"&&e.symbol==="histogram")}function PM(r){return Ng(r)||ih(r)||gb(r)}function GM(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].TTEST}function VM(r){return r.formula.expression_type===__dcg_shared_module_exports__['Vc'].STATS}function mb(r){let e=wp(r);return!!(e&&e.type==="distribution")}function _7(r){let{formula:e}=r;return e?!!e.is_discrete_distribution:!1}function Ug(r){var o;if(!r.controller.isInferenceEnabled())return;if(((o=r.cachedInferenceType)==null?void 0:o.latex)===r.latex)return r.cachedInferenceType.symbol;let e=__dcg_shared_module_exports__['xe'](r.latex,{trailingComma:!0,isNewStatsEnabled:r.controller.isInferenceEnabled()});e.type==="Assignment"&&(e=e._expression);let t;return e.type!=="FunctionCall"?t=void 0:["ttest","ztest","zproptest"].indexOf(e._symbol)!==-1?t=e._symbol:t=void 0,r.cachedInferenceType={latex:r.latex,symbol:t},t}function ea(r){return!!Ug(r)}function vp(r){var e;return((e=r.formula.typed_constant_value)==null?void 0:e.valueType)===__dcg_shared_module_exports__['ha']}function fb(r){var e;return((e=r.formula.typed_constant_value)==null?void 0:e.valueType)===__dcg_shared_module_exports__['ca']}function qv(r){var t;if(!r.controller.isInferenceEnabled())return;let e=(t=r.formula)==null?void 0:t.typed_constant_value;if((e==null?void 0:e.valueType)===__dcg_shared_module_exports__['ha'])switch(__dcg_shared_module_exports__['Aa'](e,"testStatisticType")){case __dcg_shared_module_exports__['za'].MEAN_T_INFERENCE:case __dcg_shared_module_exports__['za'].DIFFERENCE_OF_MEANS_T_INFERENCE:return"ttest";case __dcg_shared_module_exports__['za'].MEAN_Z_INFERENCE:case __dcg_shared_module_exports__['za'].DIFFERENCE_OF_MEANS_Z_INFERENCE:return"ztest";case __dcg_shared_module_exports__['za'].PROPORTION:case __dcg_shared_module_exports__['za'].DIFFERENCE_OF_PROPORTIONS:return"zproptest"}}function aq(r){var t;let e=(t=r.formula)==null?void 0:t.typed_constant_value;if((e==null?void 0:e.valueType)===__dcg_shared_module_exports__['ha'])switch(__dcg_shared_module_exports__['Aa'](e,"testStatisticType")){case __dcg_shared_module_exports__['za'].MEAN_T_INFERENCE:case __dcg_shared_module_exports__['za'].DIFFERENCE_OF_MEANS_T_INFERENCE:return"t";case __dcg_shared_module_exports__['za'].MEAN_Z_INFERENCE:case __dcg_shared_module_exports__['za'].DIFFERENCE_OF_MEANS_Z_INFERENCE:case __dcg_shared_module_exports__['za'].PROPORTION:case __dcg_shared_module_exports__['za'].DIFFERENCE_OF_PROPORTIONS:return"z"}}function wp(r){if(r.controller.areDistributionsEnabled()&&r.latex)return(!r.cachedParseToplevelFunction||r.cachedParseToplevelFunction.latex!==r.latex)&&(r.cachedParseToplevelFunction={latex:r.latex,spec:__dcg_shared_module_exports__['ze'](r.latex)}),r.cachedParseToplevelFunction.spec}function f3(r){return bb(r)&&mb(r)}function bb(r){return!!r.formula.expression_type}function ik(r){return!!r.formula.is_concrete_list}function Hv(r){return!f3(r)||ik(r)?!1:r.cdf.show}function C7(r){return r.cdf.min}function T7(r){return r.cdf.max}function nk(r){return r.cdf.tails}function E7(r,e){r.cdf={...r.cdf,...e}}function G9(r,e){r.cdf={...r.cdf,min:e}}function V9(r,e){r.cdf={...r.cdf,max:e}}function O9(r,e){r.cdf={...r.cdf,p:e}}function dpe(r){return!!r.formula&&r.formula.cdf_min_valid!==!1}function ppe(r){return!!r.formula&&r.formula.cdf_max_valid!==!1}function b3(r){return!!r.formula&&r.formula.fill_opacity_valid!==!1}function y3(r){return!!r.formula&&r.formula.surface_opacity_valid!==!1}function I7(r){return!!r.formula&&r.formula.line_opacity_valid!==!1}function M7(r){return!!r.formula&&r.formula.point_opacity_valid!==!1}function x3(r){return!!r.formula&&r.formula.label_size_valid!==!1}function v3(r){return!!r.formula&&r.formula.label_angle_valid!==!1}function D7(r){return!!r.formula&&r.formula.movable_point_size_valid!==!1}function OM(r){return!!r.formula&&r.formula.point_size_valid!==!1}function RM(r){return!!r.formula&&r.formula.line_width_valid!==!1}function A7(r){return!!r.formula&&r.formula.resolution_valid!==!1}function vI(r){return!!r.formula&&r.formula.color_latex_valid!==!1}function wI(r){return r.formula&&r.formula.color_latex_value}function L7(r){return r.formula&&r.formula.label_angle_value}function Z0(r){if(!r||!__dcg_shared_module_exports__['Xc'](r.formula.expression_type))return!1;let e=co(r);return!(e&&e!==__dcg_shared_module_exports__['Gd'].NONE)}function P7(r){r.showLabel=__dcg_shared_module_exports__['ee'].showLabel,r.showAngleLabel=__dcg_shared_module_exports__['ee'].showAngleLabel,r.label=__dcg_shared_module_exports__['ee'].label,r.hidden=__dcg_shared_module_exports__['ee'].hidden,r.dragMode=__dcg_shared_module_exports__['ee'].dragMode,r.fill=__dcg_shared_module_exports__['ee'].fill,r.points=__dcg_shared_module_exports__['ee'].points,r.pointStyle=__dcg_shared_module_exports__['ee'].pointStyle,r.lines=__dcg_shared_module_exports__['ee'].lines,r.lineStyle=__dcg_shared_module_exports__['ee'].lineStyle,r.slider=r.controller.is3dProduct()?__dcg_shared_module_exports__['ge']:__dcg_shared_module_exports__['fe'],r.latex="",r.labelSize="",r.labelOrientation=__dcg_shared_module_exports__['Od'].DEFAULT,r.displayEvaluationAsFraction=__dcg_shared_module_exports__['ee'].displayEvaluationAsFraction,r.strictIntersection=__dcg_shared_module_exports__['ee'].strictIntersection,r.suppressTextOutline=__dcg_shared_module_exports__['ee'].suppressTextOutline,r.pointOutline=__dcg_shared_module_exports__['ee'].pointOutline,r.interactiveLabel=__dcg_shared_module_exports__['ee'].interactiveLabel,r.editableLabelMode=__dcg_shared_module_exports__['ee'].editableLabelMode,__dcg_shared_module_exports__['Sd'](__dcg_shared_module_exports__['de'],r)}function FM(r){return!!r.formula.move_strategy}function w3(r,e){Ov(r,{type:"inert",disableGraphInteractions:e})}function G7(r){if((r==null?void 0:r.type)!=="expression")return;let e=r.formula.typed_constant_value;if(e)switch(e.valueType){case __dcg_shared_module_exports__['C']:return{x:__dcg_shared_module_exports__['Aa'](e,"x"),y:__dcg_shared_module_exports__['Aa'](e,"y")};case __dcg_shared_module_exports__['_']:return{x:__dcg_shared_module_exports__['Aa'](e,"real"),y:__dcg_shared_module_exports__['Aa'](e,"imag")}}}function tl(r,e){var t;return r.type!=="expression"&&r.type!=="image"?"":((t=r.formula.computed_description)==null?void 0:t[e||0])||""}function V7(r,e){if("significance"in e&&e.significance!==void 0){let o=Ug(r)==="zproptest"&&eI(r)===1?"0.5":"0";r.inference={...r.inference,...e,significance:{tails:"outer",hypothesis:o,show:!0,...r.inference.significance,...e.significance}}}else"confidence"in e&&e.confidence!==void 0?r.inference={...r.inference,...e,confidence:{confidenceLevel:"0.95",show:!0,...r.inference.confidence,...e.confidence}}:r.inference={...r.inference,...e}}function yb(r){var e;if((e=r.formula)!=null&&e.is_evaluable)return r.formula.rgb_value}function upe(r){return r.getAllModelsWithSliders().length>0}function hpe(r){for(let e of r.getAllItemModels())if(e.type==="expression"&&Bv(e))return!0;return!1}function gpe(r){if(r.getListModel().ticker.open)return!0;for(let e of r.getAllItemModels())if(e&&"formula"in e&&e.formula){if(e.type!=="expression"&&e.type!=="image")continue;let{formula:t}=e;if(t.hasOwnProperty("action_value")||t.hasOwnProperty("click_handler"))return!0}return!1}function mpe(r){return r.getAllItemModels().some(e=>e.type==="expression"&&co(e)!==__dcg_shared_module_exports__['Gd'].NONE)}function fpe(r){return r.getAllItemModels().some(e=>e.type==="expression"&&!!yb(e))}function bpe(r){return r.getAllItemModels().filter(e=>e.type==="expression").length}function ype(r){return r.getAllItemModels().filter(e=>e.type==="folder").length}function xpe(r){return r.getAllItemModels().filter(e=>e.type==="image").length}function vpe(r){return r.getAllItemModels().filter(e=>e.type==="table").length}function wpe(r){return r.getAllItemModels().filter(e=>e.type==="text").length}function Spe(r){let e=new Set;for(let t of r.getAllItemModels())t.type==="expression"&&t.error&&e.add(t.error.key);return Array.from(e)}function yc(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{let e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}var kpe=50,NM=class{constructor(e,t){this.throttledFlushBatchedLogs=__dcg_shared_module_exports__['Za'](async()=>{if(this.requestInFlight||this.batchedLogs.length==0)return;let e=this.batchedLogs.splice(0,kpe);this.requestInFlight=!0;try{await fetch(this.apiUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:e})})}catch(t){}this.requestInFlight=!1,this.throttledFlushBatchedLogs()},1e3,{leading:!1});this.batchedLogs=[],this.requestInFlight=!1,this.getSessionData=t,this.apiUrl=e}log(e){this.batchedLogs.push({...this.getSessionData(),...e}),this.throttledFlushBatchedLogs()}};var _pe={event_type:"eventType",page_load_id:window.pageLoadId||yc(),source:"browser",app:"knox",user_agent:navigator.userAgent},Cpe=new NM("/usage-stats",()=>_pe);function O7(r,e){Cpe.log({event_type:r,url:document.location.href,payload:JSON.stringify(e)})}var Tpe="usage-ping",R7=15*1e3,Epe=60*1e3,Ipe=60*1e3,Mpe={scientific:.03,matrix:.6,graphing:.02,"geometry-calculator":.5,fourfunction:.6,"graphing-3d":.4,"assessment-scientific":.3,"assessment-graphing":.1,"assessment-fourfunction":.5,practice:.7},ak=class{constructor(e,t={}){this.samplingInterval={current:R7,lessFrequent:Epe,moreFrequent:R7,moreFrequentPeriod:3*60*1e3};this.sampleStartTime=0;this.minutesOfMathData={lastCheckedMinutesOfMath:Date.now(),lastChangeEventTime:void 0,minutesOfMath:0};this.minutesOfMathCheckInterval=Ipe;this.samplingProbability=Mpe[e],this.shouldSample=Math.random()<this.samplingProbability,this.pageLoadTime=Date.now(),this.graphLoadTime=Date.now(),this.calcController=t.calcController,this.graphsController=t.graphsController,this.featureQueryMap={"graph-feature":[]},this.focused=document.hasFocus(),this.focused&&(this.focusIntervalStart=Date.now()),this.totalTimeFocused=0,window.addEventListener("focus",()=>{this.focused=!0,this.focusIntervalStart=Date.now()}),window.addEventListener("blur",()=>{this.focused=!1,this.addTimeFocused(),this.focusIntervalStart=void 0}),document.visibilityState==="visible"&&(this.visibleIntervalStart=Date.now()),this.totalTimeVisible=0,document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?(this.addTimeVisible(),this.visibleIntervalStart=void 0):this.visibleIntervalStart=Date.now()}),this.graphsController&&this.graphsController.observeEvent("onLoadGraph",()=>{this.graphLoadTime=Date.now()}),Xc("testing")&&(window.usageMonitor=this)}handleUserChangeEvent(){this.minutesOfMathData.lastChangeEventTime=Date.now(),this.getTotalMinutesOfMath()}getUsageData(){return{...this.getSharedUsageData(),...this.getGraphFeatureUsageData(),version:2}}getSharedUsageData(){let e={timeSincePageload:this.getTimeSincePageload(),totalTimeFocused:this.getTotalTimeFocused(),totalTimeVisible:this.getTotalTimeVisible(),...this.getTotalMinutesOfMath(),samplingInterval:this.samplingInterval.current,samplingProbability:this.samplingProbability};return this.graphsController&&(e.timeSinceGraphLoaded=Date.now()-this.graphLoadTime),e}getDataFromController(e,t,o){let i={};for(let n of this.featureQueryMap[e]){let a=t[n];if(!a)throw new Error(`'${n}' is not a valid feature name.`);let s=a(o);(Array.isArray(s)&&s.length>0||typeof s=="boolean"&&s||typeof s=="number")&&(i[n]=s)}return i}getGraphFeatureUsageData(){return this.getDataFromController("graph-feature",S3,this.calcController)}addTimeFocused(){if(this.focusIntervalStart===void 0)return;let e=Date.now(),t=e-this.focusIntervalStart;this.totalTimeFocused+=t,this.focusIntervalStart=e}addTimeVisible(){if(this.visibleIntervalStart===void 0)return;let e=Date.now(),t=e-this.visibleIntervalStart;this.totalTimeVisible+=t,this.visibleIntervalStart=e}getTotalTimeFocused(){return this.focused?(this.addTimeFocused(),this.totalTimeFocused):this.totalTimeFocused}getTotalTimeVisible(){return document.visibilityState==="hidden"?this.totalTimeVisible:(this.addTimeVisible(),this.totalTimeVisible)}start(){if(!this.shouldSample)return;this.sampleStartTime=Date.now();let e=()=>{this.sampleTimeout!==void 0&&clearTimeout(this.sampleTimeout),this.shouldSample&&(Date.now()-this.sampleStartTime>this.samplingInterval.moreFrequentPeriod&&(this.samplingInterval.current=this.samplingInterval.lessFrequent),this.sampleTimeout=setTimeout(e,this.samplingInterval.current),this.callLogger())};this.sampleTimeout=setTimeout(e)}stop(){this.sampleTimeout!==void 0&&clearTimeout(this.sampleTimeout),this.sampleTimeout=void 0}callLogger(){O7(Tpe,this.getUsageData())}trackFeatureUsage(e,t){if(!this.calcController)throw new Error("Monitoring graph feature usage requires a calculator controller.");this.featureQueryMap[e].push(t)}getTimeSincePageload(){return Date.now()-this.pageLoadTime}setMinutesOfMathCheckInterval(e){this.minutesOfMathCheckInterval=e}overrideSamplingInterval(e){this.samplingInterval={...this.samplingInterval,...e}}setShouldSample(e){this.shouldSample=e,this.start()}getTotalMinutesOfMath(){var t;let e=Date.now();return(!this.minutesOfMathData.lastCheckedMinutesOfMath||e-this.minutesOfMathData.lastCheckedMinutesOfMath>=this.minutesOfMathCheckInterval)&&(((t=this.minutesOfMathData.lastChangeEventTime)!=null?t:0)>e-this.minutesOfMathCheckInterval&&(this.minutesOfMathData.minutesOfMath+=this.minutesOfMathCheckInterval*1/(60*1e3)),this.minutesOfMathData.lastCheckedMinutesOfMath=e),{minutesOfMath:this.minutesOfMathData.minutesOfMath}}};var _p={};__dcg_shared_module_exports__['d'](_p,{UnicodeBraille:()=>ma,latexToNemeth:()=>nh,latexToUeb:()=>ah,nemethToLatex:()=>K3,uebToLatex:()=>z3,version:()=>yhe});var Z7=Object.defineProperty,Dpe=Object.getOwnPropertyNames,F7=Object.getOwnPropertySymbols,Ape=Object.prototype.hasOwnProperty,Lpe=Object.prototype.propertyIsEnumerable,N7=(r,e,t)=>e in r?Z7(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Wv=(r,e)=>{for(var t in e||(e={}))Ape.call(e,t)&&N7(r,t,e[t]);if(F7)for(var t of F7(e))Lpe.call(e,t)&&N7(r,t,e[t]);return r},jv=(r=>typeof __dcg_shared_module_exports__['a']!="undefined"?__dcg_shared_module_exports__['a']:typeof Proxy!="undefined"?new Proxy(r,{get:(e,t)=>(typeof __dcg_shared_module_exports__['a']!="undefined"?__dcg_shared_module_exports__['a']:e)[t]}):r)(function(r){if(typeof __dcg_shared_module_exports__['a']!="undefined")return __dcg_shared_module_exports__['a'].apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')}),L3=(r,e)=>function(){return e||(0,r[Dpe(r)[0]])((e={exports:{}}).exports,e),e.exports},P3=(r,e)=>{for(var t in e)Z7(r,t,{get:e[t],enumerable:!0})},Ppe=L3({"generated/latex.jison.js"(r,e){"use strict";var t=function(){var o=function(q,S,A,O){for(A=A||{},O=q.length;O--;A[q[O]]=S);return A},i=[1,13],n=[1,14],a=[1,15],s=[1,16],c=[1,17],d=[1,21],p=[1,18],u=[1,19],g=[1,20],h=[1,22],b=[1,23],v=[1,28],T=[1,30],E=[1,31],I=[1,32],_=[1,33],C=[1,29],D=[5,21,27,38],P=[5,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],F=[5,10,12,13,14,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],N=[5,10,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],Y={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,level:6,expression:7,subscript:8,superscript:9,_:10,atom:11,"^":12,"PRIMES^":13,PRIMES:14,delimited_group:15,typeform:16,frac:17,radical:18,LEFT:19,delimiter:20,RIGHT:21,FRAC:22,OPERATOR_NAME:23,MATHRM:24,TEXT:25,RADICAL_OPTARG:26,CLOSE_OPTARG:27,RADICAL:28,curly_group:29,greek:30,command:31,SYMBOL:32,DELIMITER:33,DELIMITER_COMMAND:34,GREEK:35,COMMAND:36,"{":37,"}":38,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"_",12:"^",13:"PRIMES^",14:"PRIMES",19:"LEFT",21:"RIGHT",22:"FRAC",23:"OPERATOR_NAME",24:"MATHRM",25:"TEXT",26:"RADICAL_OPTARG",27:"CLOSE_OPTARG",28:"RADICAL",32:"SYMBOL",33:"DELIMITER",34:"DELIMITER_COMMAND",35:"GREEK",36:"COMMAND",37:"{",38:"}"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[6,2],[6,2],[6,1],[6,1],[8,2],[9,2],[9,2],[9,1],[7,1],[7,1],[7,1],[7,1],[7,1],[15,5],[15,4],[17,3],[16,2],[16,2],[16,2],[18,4],[18,3],[18,2],[18,2],[11,1],[11,1],[11,1],[11,1],[11,1],[20,1],[20,1],[30,1],[31,1],[29,3],[29,2]],performAction:function(S,A,O,B,V,K,oe){var Z=K.length-1;switch(V){case 1:return K[Z-1];case 2:return B.group();case 3:this.$=B.group(K[Z-2],K[Z-1],K[Z]);break;case 4:case 6:this.$=B.group(K[Z-1],K[Z]);break;case 5:case 7:this.$=B.group(K[Z]);break;case 8:this.$=B.level({_:B.group(K[Z-1]),"^":B.group(K[Z])});break;case 9:this.$=B.level({_:B.group(K[Z]),"^":B.group(K[Z-1])});break;case 10:this.$=B.level({"^":B.group(K[Z])});break;case 11:this.$=B.level({_:B.group(K[Z])});break;case 12:case 13:this.$=K[Z];break;case 14:this.$=B.processPrimes(K[Z-1],K[Z]);break;case 15:this.$=B.processPrimes(K[Z],B.group());break;case 21:this.$=B.group(K[Z-3],K[Z-2],K[Z]);break;case 22:this.$=B.group(K[Z-2],K[Z]);break;case 23:this.$=B.fraction(B.group(K[Z-1]),B.group(K[Z]));break;case 24:this.$=B.typeform("operator_name",B.group(K[Z]));break;case 25:this.$=B.typeform("mathrm",B.group(K[Z]));break;case 26:this.$=B.typeform("text",B.group(K[Z]));break;case 27:this.$=B.radical(K[Z],B.group(K[Z-2]));break;case 28:this.$=B.radical(B.group(K[Z]),B.group());break;case 29:case 30:this.$=B.radical(B.group(K[Z]));break;case 35:case 36:this.$=B.terminal(K[Z]);break;case 37:case 39:this.$=B.command(K[Z]);break;case 38:this.$=B.greek(K[Z]);break;case 40:this.$=K[Z-1];break;case 41:this.$=B.group();break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,10:i,11:12,12:n,13:a,14:s,15:8,16:9,17:10,18:11,19:c,20:25,22:d,23:p,24:u,25:g,26:h,28:b,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},{1:[3]},{5:[1,34]},{1:[2,2]},o(D,[2,5],{15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,7:35,19:c,22:d,23:p,24:u,25:g,26:h,28:b,32:v,33:T,34:E,35:I,36:_,37:C}),o(D,[2,7],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,4:36,10:i,12:n,13:a,14:s,19:c,22:d,23:p,24:u,25:g,26:h,28:b,32:v,33:T,34:E,35:I,36:_,37:C}),o(P,[2,11],{9:37,12:n,13:a,14:s}),o(P,[2,10],{8:38,10:i}),o(F,[2,16]),o(F,[2,17]),o(F,[2,18]),o(F,[2,19]),o(F,[2,20]),{11:39,20:25,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},{11:40,20:25,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},{11:41,20:25,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},o(N,[2,15]),{20:42,33:T,34:E},{11:43,20:25,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},{11:44,20:25,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},{11:45,20:25,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},{11:46,20:25,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},{4:47,6:4,7:5,8:6,9:7,10:i,11:12,12:n,13:a,14:s,15:8,16:9,17:10,18:11,19:c,20:25,22:d,23:p,24:u,25:g,26:h,27:[1,48],28:b,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},{11:49,17:50,20:25,22:d,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},o(F,[2,31]),o(F,[2,32]),o(F,[2,33]),o(F,[2,34]),o(F,[2,35]),{4:51,6:4,7:5,8:6,9:7,10:i,11:12,12:n,13:a,14:s,15:8,16:9,17:10,18:11,19:c,20:25,22:d,23:p,24:u,25:g,26:h,28:b,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C,38:[1,52]},o(F,[2,36]),o(F,[2,37]),o(F,[2,38]),o(F,[2,39]),{1:[2,1]},o(D,[2,4],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,4:53,10:i,12:n,13:a,14:s,19:c,22:d,23:p,24:u,25:g,26:h,28:b,32:v,33:T,34:E,35:I,36:_,37:C}),o(D,[2,6]),o(P,[2,8]),o(P,[2,9]),o([5,12,13,14,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],[2,12]),o(N,[2,13]),o(N,[2,14]),{4:54,6:4,7:5,8:6,9:7,10:i,11:12,12:n,13:a,14:s,15:8,16:9,17:10,18:11,19:c,20:25,21:[1,55],22:d,23:p,24:u,25:g,26:h,28:b,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},o(F,[2,24]),o(F,[2,25]),o(F,[2,26]),{11:56,20:25,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},{27:[1,57]},{11:58,20:25,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},o(F,[2,29]),o(F,[2,30]),{38:[1,59]},o(F,[2,41]),o(D,[2,3]),{21:[1,60]},{20:61,33:T,34:E},o(F,[2,23]),{11:62,20:25,29:24,30:26,31:27,32:v,33:T,34:E,35:I,36:_,37:C},o(F,[2,28]),o(F,[2,40]),{20:63,33:T,34:E},o(F,[2,22]),o(F,[2,27]),o(F,[2,21])],defaultActions:{3:[2,2],34:[2,1]},parseError:function(S,A){if(A.recoverable)this.trace(S);else{var O=new Error(S);throw O.hash=A,O}},parse:function(S){var A=this,O=[0],B=[],V=[null],K=[],oe=this.table,Z="",ee=0,ue=0,he=0,ae=2,$=1,se=K.slice.call(arguments,1),J=Object.create(this.lexer),ye={yy:{}};for(var Se in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Se)&&(ye.yy[Se]=this.yy[Se]);J.setInput(S,ye.yy),ye.yy.lexer=J,ye.yy.parser=this,typeof J.yylloc=="undefined"&&(J.yylloc={});var Ce=J.yylloc;K.push(Ce);var Te=J.options&&J.options.ranges;typeof ye.yy.parseError=="function"?this.parseError=ye.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function Ae(gr){O.length=O.length-2*gr,V.length=V.length-gr,K.length=K.length-gr}for(var je=function(){var gr;return gr=J.lex()||$,typeof gr!="number"&&(gr=A.symbols_[gr]||gr),gr},ie,te,we,Ie,He,ge,nt={},lt,Me,Nt,Tt;;){if(we=O[O.length-1],this.defaultActions[we]?Ie=this.defaultActions[we]:((ie===null||typeof ie=="undefined")&&(ie=je()),Ie=oe[we]&&oe[we][ie]),typeof Ie=="undefined"||!Ie.length||!Ie[0]){var Et="";Tt=[];for(lt in oe[we])this.terminals_[lt]&&lt>ae&&Tt.push("'"+this.terminals_[lt]+"'");J.showPosition?Et="Parse error on line "+(ee+1)+`:
`+J.showPosition()+`
Expecting `+Tt.join(", ")+", got '"+(this.terminals_[ie]||ie)+"'":Et="Parse error on line "+(ee+1)+": Unexpected "+(ie==$?"end of input":"'"+(this.terminals_[ie]||ie)+"'"),this.parseError(Et,{text:J.match,token:this.terminals_[ie]||ie,line:J.yylineno,loc:Ce,expected:Tt})}if(Ie[0]instanceof Array&&Ie.length>1)throw new Error("Parse Error: multiple actions possible at state: "+we+", token: "+ie);switch(Ie[0]){case 1:O.push(ie),V.push(J.yytext),K.push(J.yylloc),O.push(Ie[1]),ie=null,te?(ie=te,te=null):(ue=J.yyleng,Z=J.yytext,ee=J.yylineno,Ce=J.yylloc,he>0&&he--);break;case 2:if(Me=this.productions_[Ie[1]][1],nt.$=V[V.length-Me],nt._$={first_line:K[K.length-(Me||1)].first_line,last_line:K[K.length-1].last_line,first_column:K[K.length-(Me||1)].first_column,last_column:K[K.length-1].last_column},Te&&(nt._$.range=[K[K.length-(Me||1)].range[0],K[K.length-1].range[1]]),ge=this.performAction.apply(nt,[Z,ue,ee,ye.yy,Ie[1],V,K].concat(se)),typeof ge!="undefined")return ge;Me&&(O=O.slice(0,-1*Me*2),V=V.slice(0,-1*Me),K=K.slice(0,-1*Me)),O.push(this.productions_[Ie[1]][0]),V.push(nt.$),K.push(nt._$),Nt=oe[O[O.length-2]][O[O.length-1]],O.push(Nt);break;case 3:return!0}}return!0}},z=function(){var q={EOF:1,parseError:function(A,O){if(this.yy.parser)this.yy.parser.parseError(A,O);else throw new Error(A)},setInput:function(S,A){return this.yy=A||this.yy||{},this._input=S,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var S=this._input[0];this.yytext+=S,this.yyleng++,this.offset++,this.match+=S,this.matched+=S;var A=S.match(/(?:\r\n?|\n).*/g);return A?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),S},unput:function(S){var A=S.length,O=S.split(/(?:\r\n?|\n)/g);this._input=S+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-A),this.offset-=A;var B=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),O.length-1&&(this.yylineno-=O.length-1);var V=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:O?(O.length===B.length?this.yylloc.first_column:0)+B[B.length-O.length].length-O[0].length:this.yylloc.first_column-A},this.options.ranges&&(this.yylloc.range=[V[0],V[0]+this.yyleng-A]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(S){this.unput(this.match.slice(S))},pastInput:function(){var S=this.matched.substr(0,this.matched.length-this.match.length);return(S.length>20?"...":"")+S.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var S=this.match;return S.length<20&&(S+=this._input.substr(0,20-S.length)),(S.substr(0,20)+(S.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var S=this.pastInput(),A=new Array(S.length+1).join("-");return S+this.upcomingInput()+`
`+A+"^"},test_match:function(S,A){var O,B,V;if(this.options.backtrack_lexer&&(V={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(V.yylloc.range=this.yylloc.range.slice(0))),B=S[0].match(/(?:\r\n?|\n).*/g),B&&(this.yylineno+=B.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:B?B[B.length-1].length-B[B.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+S[0].length},this.yytext+=S[0],this.match+=S[0],this.matches=S,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(S[0].length),this.matched+=S[0],O=this.performAction.call(this,this.yy,this,A,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),O)return O;if(this._backtrack){for(var K in V)this[K]=V[K];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var S,A,O,B;this._more||(this.yytext="",this.match="");for(var V=this._currentRules(),K=0;K<V.length;K++)if(O=this._input.match(this.rules[V[K]]),O&&(!A||O[0].length>A[0].length)){if(A=O,B=K,this.options.backtrack_lexer){if(S=this.test_match(O,V[K]),S!==!1)return S;if(this._backtrack){A=!1;continue}else return!1}else if(!this.options.flex)break}return A?(S=this.test_match(A,V[B]),S!==!1?S:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var A=this.next();return A||this.lex()},begin:function(A){this.conditionStack.push(A)},popState:function(){var A=this.conditionStack.length-1;return A>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(A){return A=this.conditionStack.length-1-Math.abs(A||0),A>=0?this.conditionStack[A]:"INITIAL"},pushState:function(A){this.begin(A)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(A,O,B,V){var K=V;switch(B){case 0:break;case 1:return this.begin("optarg"),26;break;case 2:return this.popState(),27;break;case 3:return 23;case 4:return 24;case 5:return 25;case 6:return 28;case 7:return 22;case 8:return 13;case 9:return 14;case 10:return 12;case 11:return 10;case 12:return 19;case 13:return 21;case 14:return 34;case 15:return 33;case 16:return 37;case 17:return 38;case 18:return 32;case 19:return 32;case 20:return 32;case 21:return 35;case 22:return 35;case 23:return 36;case 24:return 32;case 25:return 5}},rules:[/^(?:\s+)/,/^(?:(\\sqrt)\s*\[)/,/^(?:\])/,/^(?:(\\operatorname))/,/^(?:(\\mathrm))/,/^(?:(\\text))/,/^(?:(\\sqrt))/,/^(?:(\\frac))/,/^(?:'+\^)/,/^(?:'+)/,/^(?:\^)/,/^(?:[_])/,/^(?:(\\left))/,/^(?:(\\right))/,/^(?:(\\langle|\\rangle|\\vert|\\Vert))/,/^(?:\[|\]|\\\{|\\\}|\(|\)|\||\\\|)/,/^(?:\{)/,/^(?:\})/,/^(?:\\(infty))/,/^(?:\\(int))/,/^(?:!)/,/^(?:\\(alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|omicron|pi|rho|sigma|tau|xi|upsilon|phi|chi|psi|omega))/,/^(?:\\(Alpha|Beta|Gamma|Delta|Epsilon|Zeta|Eta|Theta|Iota|Kappa|Lambda|Mu|Nu|Omicron|Pi|Rho|Sigma|Tau|Xi|Upsilon|Phi|Chi|Psi|Omega))/,/^(?:\\[A-Za-z]+)/,/^(?:\\.|.)/,/^(?:$)/],conditions:{optarg:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0},INITIAL:{rules:[0,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0}}};return q}();Y.lexer=z;function X(){this.yy={}}return X.prototype=Y,Y.Parser=X,new X}();typeof jv!="undefined"&&typeof r!="undefined"&&(r.parser=t,r.Parser=t.Parser,r.parse=function(){return t.parse.apply(t,arguments)},r.main=function(){},typeof e!="undefined"&&jv.main===e&&r.main(process.argv.slice(1)))}}),Q7=L3({"generated/nemeth-to-latex.jison.js"(r,e){"use strict";var t=function(){var o=function(gr,de,le,Fe){for(le=le||{},Fe=gr.length;Fe--;le[gr[Fe]]=de);return le},i=[1,11],n=[1,12],a=[1,13],s=[1,79],c=[1,80],d=[1,77],p=[1,78],u=[1,39],g=[1,40],h=[1,67],b=[1,68],v=[1,69],T=[1,70],E=[1,71],I=[1,72],_=[1,73],C=[1,74],D=[1,75],P=[1,76],F=[1,41],N=[1,35],Y=[1,36],z=[1,37],X=[1,38],q=[1,42],S=[1,43],A=[1,44],O=[1,45],B=[1,46],V=[1,47],K=[1,48],oe=[1,49],Z=[1,50],ee=[1,51],ue=[1,52],he=[1,53],ae=[1,54],$=[1,55],se=[1,56],J=[1,57],ye=[1,58],Se=[1,59],Ce=[1,60],Te=[1,61],Ae=[1,17],je=[1,62],ie=[1,63],te=[1,64],we=[1,65],Ie=[1,66],He=[5,12,13,14,18,24,25],ge=[5,11,12,13,14,15,17,18,20,21,23,24,25,27,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91],nt=[1,84],lt=[5,11,12,13,14,15,17,18,20,21,23,24,25,27,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,91],Me=[5,11,12,13,14,15,17,18,20,21,23,24,25,27,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91],Nt={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,element:6,index_element:7,modified_expression:8,radical:9,primes:10,OPEN_MODEXP:11,MODEXP_UNDER:12,MODEXP_OVER:13,CLOSE_MODEXP:14,RADICAL_INDEX:15,index_group:16,OPEN_RADICAL:17,CLOSE_RADICAL:18,level:19,LEVEL:20,BASELINE:21,frac:22,OPEN_FRAC:23,SLASH:24,CLOSE_FRAC:25,geo_token:26,GEO_TOKEN:27,number:28,subscript_head:29,atom:30,command:31,greek:32,letter:33,comma:34,period:35,space:36,operation:37,comparison:38,level_with_comparison:39,ellipsis:40,colon:41,infinity:42,integral:43,factorial:44,ampersand:45,question_mark:46,bracket:47,",":48,".":49,"[":50,"{":51,"(":52,"]":53,"}":54,")":55,LANGLE:56,RANGLE:57,PIPE:58,DOUBLE_PIPE:59,SPACE:60,COMMAND:61,GREEK:62,LETTER:63,CAPITAL_LETTER:64,"+":65,"-":66,CDOT:67,TIMES:68,"*":69,"/":70,DIV:71,PERCENT_OF:72,PERCENT:73,MEASURED_ANGLE:74,ANGLE:75,CIRCLE:76,PARALLELOGRAM:77,TO:78,TRIANGLE:79,DEGREE:80,COMPARISON:81,LEVEL_WITH_COMPARISON:82,ELLIPSIS:83,COLON:84,NUMBER:85,INFINITY:86,INTEGRAL:87,FACTORIAL:88,"&":89,PRIMES:90,"?":91,unknown:92,UNKNOWN:93,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",11:"OPEN_MODEXP",12:"MODEXP_UNDER",13:"MODEXP_OVER",14:"CLOSE_MODEXP",15:"RADICAL_INDEX",17:"OPEN_RADICAL",18:"CLOSE_RADICAL",20:"LEVEL",21:"BASELINE",23:"OPEN_FRAC",24:"SLASH",25:"CLOSE_FRAC",27:"GEO_TOKEN",48:",",49:".",50:"[",51:"{",52:"(",53:"]",54:"}",55:")",56:"LANGLE",57:"RANGLE",58:"PIPE",59:"DOUBLE_PIPE",60:"SPACE",61:"COMMAND",62:"GREEK",63:"LETTER",64:"CAPITAL_LETTER",65:"+",66:"-",67:"CDOT",68:"TIMES",69:"*",70:"/",71:"DIV",72:"PERCENT_OF",73:"PERCENT",74:"MEASURED_ANGLE",75:"ANGLE",76:"CIRCLE",77:"PARALLELOGRAM",78:"TO",79:"TRIANGLE",80:"DEGREE",81:"COMPARISON",82:"LEVEL_WITH_COMPARISON",83:"ELLIPSIS",84:"COLON",85:"NUMBER",86:"INFINITY",87:"INTEGRAL",88:"FACTORIAL",89:"&",90:"PRIMES",91:"?",93:"UNKNOWN"},productions_:[0,[3,2],[3,1],[4,2],[4,1],[6,1],[6,1],[6,2],[6,1],[8,7],[8,6],[8,5],[8,6],[8,5],[8,5],[8,4],[8,4],[8,3],[8,4],[8,4],[8,4],[8,4],[8,3],[8,3],[8,2],[9,5],[9,4],[9,4],[9,3],[9,3],[9,2],[19,1],[19,1],[22,5],[22,4],[22,4],[22,3],[26,2],[16,2],[16,1],[7,3],[7,2],[7,2],[7,3],[7,2],[7,2],[7,1],[7,1],[7,1],[29,1],[29,1],[29,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[34,1],[35,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[36,1],[31,1],[32,1],[33,1],[33,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[37,1],[38,1],[39,1],[40,1],[41,1],[28,1],[42,1],[43,1],[44,1],[45,1],[10,1],[46,1],[92,1]],performAction:function(de,le,Fe,be,it,Ye,_r){var ht=Ye.length-1;switch(it){case 1:return Ye[ht-1];case 2:return be.group();case 3:case 38:case 42:case 44:case 45:this.$=be.group(Ye[ht-1],Ye[ht]);break;case 4:case 39:this.$=be.group(Ye[ht]);break;case 7:this.$=be.group(Ye[ht-1],Ye[ht]);break;case 9:this.$=be.modified_expression(Ye[ht-5],Ye[ht-3],Ye[ht-1]);break;case 10:this.$=be.modified_expression(Ye[ht-4],Ye[ht-2]);break;case 11:this.$=be.modified_expression(Ye[ht-3],Ye[ht-1]);break;case 12:this.$=be.modified_expression(Ye[ht-4],be.group(),Ye[ht-1]);break;case 13:this.$=be.modified_expression(Ye[ht-3],be.group(),Ye[ht-1]);break;case 14:this.$=be.modified_expression(Ye[ht-3],be.group(),be.group());break;case 15:case 16:this.$=be.modified_expression(Ye[ht-2],be.group());break;case 17:this.$=be.modified_expression(Ye[ht-1]);break;case 18:case 19:case 22:case 23:case 24:this.$=be.modified_expression(be.group());break;case 20:case 21:be.warnOrError("Multi-level modified expressions are not supported."),this.$=be.modified_expression(be.group());break;case 25:this.$=be.radical(Ye[ht-1],Ye[ht-3]);break;case 26:this.$=be.radical(Ye[ht-1],be.group());break;case 27:this.$=be.radical(be.group(),Ye[ht-2]);break;case 28:this.$=be.radical(be.group(),be.group());break;case 29:this.$=be.radical(Ye[ht-1]);break;case 30:this.$=be.radical(be.group());break;case 31:this.$=be.level(Ye[ht]);break;case 32:this.$=be.baseline();break;case 33:this.$=be.fraction(Ye[ht-3],Ye[ht-1]);break;case 34:this.$=be.fraction(Ye[ht-2],be.group());break;case 35:this.$=be.fraction(be.group(),Ye[ht-1]);break;case 36:this.$=be.fraction(be.group(),be.group());break;case 37:this.$=be.geo_token(Ye[ht]);break;case 40:this.$=be.group(be.simple_subscript(Ye[ht-2],Ye[ht]),Ye[ht-1]);break;case 41:this.$=be.simple_subscript(Ye[ht-1],Ye[ht]);break;case 43:be.warnOrError("Illegal use of Nemeth primes"),this.$=be.group(be.simple_subscript(Ye[ht-2],Ye[ht-1]),Ye[ht]);break;case 69:this.$=be.terminal(",");break;case 70:this.$=be.terminal(".");break;case 71:this.$=be.terminal("[");break;case 72:this.$=be.terminal("\\{");break;case 73:this.$=be.terminal("(");break;case 74:this.$=be.terminal("]");break;case 75:this.$=be.terminal("\\}");break;case 76:this.$=be.terminal(")");break;case 77:this.$=be.terminal("\\langle ");break;case 78:this.$=be.terminal("\\rangle ");break;case 79:this.$=be.terminal("|");break;case 80:this.$=be.terminal("\\|");break;case 81:this.$=be.terminal(" ");break;case 82:this.$=be.command(Ye[ht].toLowerCase());break;case 83:this.$=be.terminal(be.greek(Ye[ht]));break;case 84:this.$=be.terminal(Ye[ht].toLowerCase());break;case 85:this.$=be.terminal(Ye[ht].toUpperCase());break;case 86:this.$=be.terminal("+");break;case 87:this.$=be.terminal("-");break;case 88:this.$=be.terminal("\\cdot ");break;case 89:this.$=be.terminal("\\times ");break;case 90:this.$=be.terminal("*");break;case 91:this.$=be.terminal("/");break;case 92:this.$=be.terminal("\\div ");break;case 93:this.$=be.terminal("\\%\\operatorname{of}");break;case 94:this.$=be.terminal("\\%");break;case 95:this.$=be.terminal("\\measuredangle ");break;case 96:this.$=be.terminal("\\angle ");break;case 97:this.$=be.terminal("\\bigcirc ");break;case 98:this.$=be.terminal("\\parallelogram ");break;case 99:this.$=be.terminal("\\to ");break;case 100:this.$=be.terminal("\\triangle ");break;case 101:this.$=be.terminal("\\degree ");break;case 102:this.$=be.comparison(Ye[ht].trim());break;case 103:this.$=be.level_with_comparison(Ye[ht].trim());break;case 104:this.$=be.terminal("\\ldots ");break;case 105:this.$=be.terminal(":");break;case 106:this.$=be.terminal(Ye[ht]);break;case 107:this.$=be.terminal("\\infty ");break;case 108:this.$=be.terminal("\\int ");break;case 109:this.$=be.terminal("!");break;case 110:this.$=be.terminal("\\&");break;case 111:this.$=be.primes(Ye[ht]);break;case 112:this.$=be.terminal("?");break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,11:i,15:n,17:a,19:34,20:s,21:c,22:32,23:d,26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},{1:[3]},{5:[1,81]},{1:[2,2]},o(He,[2,4],{6:4,7:5,8:6,9:7,29:8,28:9,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,22:32,26:33,19:34,4:82,11:i,15:n,17:a,20:s,21:c,23:d,27:p,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie}),o(ge,[2,5]),o(ge,[2,6]),o(ge,[2,8],{10:83,90:nt}),o(lt,[2,46],{10:85,28:86,85:Ae,90:nt}),o(ge,[2,47],{10:87,90:nt}),o(ge,[2,48],{10:88,90:nt}),{4:89,6:4,7:5,8:6,9:7,11:i,12:[1,91],13:[1,90],14:[1,92],15:n,17:a,19:34,20:s,21:c,22:32,23:d,26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},{7:95,16:93,17:[1,94],19:34,20:s,21:c,22:32,23:d,26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},{4:96,6:4,7:5,8:6,9:7,11:i,15:n,17:a,18:[1,97],19:34,20:s,21:c,22:32,23:d,26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},o(Me,[2,49]),o(Me,[2,50]),o(Me,[2,51]),o(Me,[2,106]),o(Me,[2,52]),o(Me,[2,53]),o(Me,[2,54]),o(Me,[2,55]),o(Me,[2,56]),o(Me,[2,57]),o(Me,[2,58]),o(Me,[2,59]),o(Me,[2,60]),o(Me,[2,61]),o(Me,[2,62]),o(Me,[2,63]),o(Me,[2,64]),o(Me,[2,65]),o(Me,[2,66]),o(Me,[2,67]),o(Me,[2,68]),o(Me,[2,82]),o(Me,[2,83]),o(Me,[2,84]),o(Me,[2,85]),o(Me,[2,69]),o(Me,[2,70]),o(Me,[2,81]),o(Me,[2,86]),o(Me,[2,87]),o(Me,[2,88]),o(Me,[2,89]),o(Me,[2,90]),o(Me,[2,91]),o(Me,[2,92]),o(Me,[2,93]),o(Me,[2,94]),o(Me,[2,95]),o(Me,[2,96]),o(Me,[2,97]),o(Me,[2,98]),o(Me,[2,99]),o(Me,[2,100]),o(Me,[2,101]),o(Me,[2,102]),o(Me,[2,103]),o(Me,[2,104]),o(Me,[2,105]),o(Me,[2,107]),o(Me,[2,108]),o(Me,[2,109]),o(Me,[2,110]),o(Me,[2,112]),o(Me,[2,71]),o(Me,[2,72]),o(Me,[2,73]),o(Me,[2,74]),o(Me,[2,75]),o(Me,[2,76]),o(Me,[2,77]),o(Me,[2,78]),o(Me,[2,79]),o(Me,[2,80]),{4:98,6:4,7:5,8:6,9:7,11:i,15:n,17:a,19:34,20:s,21:c,22:32,23:d,24:[1,99],26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},{28:100,85:Ae},o(Me,[2,31]),o(Me,[2,32]),{1:[2,1]},o(He,[2,3]),o(ge,[2,7]),o(ge,[2,111]),o(lt,[2,42],{28:101,85:Ae}),o(ge,[2,41],{10:102,90:nt}),o(ge,[2,44]),o(ge,[2,45]),{12:[1,103],13:[1,104],14:[1,105]},{12:[1,106],13:[1,107],14:[1,108]},{12:[1,110],13:[1,109],14:[1,111]},o(ge,[2,24]),{17:[1,112]},{4:113,6:4,7:5,8:6,9:7,11:i,15:n,17:a,18:[1,114],19:34,20:s,21:c,22:32,23:d,26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},{7:95,16:115,17:[2,39],19:34,20:s,21:c,22:32,23:d,26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},{18:[1,116]},o(Me,[2,30]),{24:[1,117]},{4:118,6:4,7:5,8:6,9:7,11:i,15:n,17:a,19:34,20:s,21:c,22:32,23:d,25:[1,119],26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},o(Me,[2,37]),o(ge,[2,40]),o(ge,[2,43]),{4:120,6:4,7:5,8:6,9:7,11:i,13:[1,121],14:[1,122],15:n,17:a,19:34,20:s,21:c,22:32,23:d,26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},{4:123,6:4,7:5,8:6,9:7,11:i,14:[1,124],15:n,17:a,19:34,20:s,21:c,22:32,23:d,26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},o(ge,[2,17]),{14:[1,125]},{14:[1,126]},o(ge,[2,22]),{14:[1,127]},{14:[1,128]},o(ge,[2,23]),{4:129,6:4,7:5,8:6,9:7,11:i,15:n,17:a,18:[1,130],19:34,20:s,21:c,22:32,23:d,26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},{18:[1,131]},o(Me,[2,28]),{17:[2,38]},o(Me,[2,29]),{4:132,6:4,7:5,8:6,9:7,11:i,15:n,17:a,19:34,20:s,21:c,22:32,23:d,25:[1,133],26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},{25:[1,134]},o(Me,[2,36]),{13:[1,135],14:[1,136]},{4:137,6:4,7:5,8:6,9:7,11:i,14:[1,138],15:n,17:a,19:34,20:s,21:c,22:32,23:d,26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},o(ge,[2,16]),{14:[1,139]},o(ge,[2,15]),o(ge,[2,18]),o(ge,[2,20]),o(ge,[2,19]),o(ge,[2,21]),{18:[1,140]},o(Me,[2,27]),o(Me,[2,26]),{25:[1,141]},o(Me,[2,34]),o(Me,[2,35]),{4:142,6:4,7:5,8:6,9:7,11:i,14:[1,143],15:n,17:a,19:34,20:s,21:c,22:32,23:d,26:33,27:p,28:9,29:8,30:10,31:14,32:15,33:16,34:18,35:19,36:20,37:21,38:22,39:23,40:24,41:25,42:26,43:27,44:28,45:29,46:30,47:31,48:u,49:g,50:h,51:b,52:v,53:T,54:E,55:I,56:_,57:C,58:D,59:P,60:F,61:N,62:Y,63:z,64:X,65:q,66:S,67:A,68:O,69:B,70:V,71:K,72:oe,73:Z,74:ee,75:ue,76:he,77:ae,78:$,79:se,80:J,81:ye,82:Se,83:Ce,84:Te,85:Ae,86:je,87:ie,88:te,89:we,91:Ie},o(ge,[2,11]),{14:[1,144]},o(ge,[2,14]),o(ge,[2,13]),o(Me,[2,25]),o(Me,[2,33]),{14:[1,145]},o(ge,[2,10]),o(ge,[2,12]),o(ge,[2,9])],defaultActions:{3:[2,2],81:[2,1],115:[2,38]},parseError:function(de,le){if(le.recoverable)this.trace(de);else{var Fe=new Error(de);throw Fe.hash=le,Fe}},parse:function(de){var le=this,Fe=[0],be=[],it=[null],Ye=[],_r=this.table,ht="",Ni=0,Xr=0,mo=0,Ze=2,pt=1,xt=Ye.slice.call(arguments,1),ke=Object.create(this.lexer),ce={yy:{}};for(var ve in this.yy)Object.prototype.hasOwnProperty.call(this.yy,ve)&&(ce.yy[ve]=this.yy[ve]);ke.setInput(de,ce.yy),ce.yy.lexer=ke,ce.yy.parser=this,typeof ke.yylloc=="undefined"&&(ke.yylloc={});var We=ke.yylloc;Ye.push(We);var De=ke.options&&ke.options.ranges;typeof ce.yy.parseError=="function"?this.parseError=ce.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function mt(pi){Fe.length=Fe.length-2*pi,it.length=it.length-pi,Ye.length=Ye.length-pi}for(var gt=function(){var pi;return pi=ke.lex()||pt,typeof pi!="number"&&(pi=le.symbols_[pi]||pi),pi},Vt,ir,Yt,Ht,Lt,ur,qt={},Mo,Ci,wn,di;;){if(Yt=Fe[Fe.length-1],this.defaultActions[Yt]?Ht=this.defaultActions[Yt]:((Vt===null||typeof Vt=="undefined")&&(Vt=gt()),Ht=_r[Yt]&&_r[Yt][Vt]),typeof Ht=="undefined"||!Ht.length||!Ht[0]){var $r="";di=[];for(Mo in _r[Yt])this.terminals_[Mo]&&Mo>Ze&&di.push("'"+this.terminals_[Mo]+"'");ke.showPosition?$r="Parse error on line "+(Ni+1)+`:
`+ke.showPosition()+`
Expecting `+di.join(", ")+", got '"+(this.terminals_[Vt]||Vt)+"'":$r="Parse error on line "+(Ni+1)+": Unexpected "+(Vt==pt?"end of input":"'"+(this.terminals_[Vt]||Vt)+"'"),this.parseError($r,{text:ke.match,token:this.terminals_[Vt]||Vt,line:ke.yylineno,loc:We,expected:di})}if(Ht[0]instanceof Array&&Ht.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Yt+", token: "+Vt);switch(Ht[0]){case 1:Fe.push(Vt),it.push(ke.yytext),Ye.push(ke.yylloc),Fe.push(Ht[1]),Vt=null,ir?(Vt=ir,ir=null):(Xr=ke.yyleng,ht=ke.yytext,Ni=ke.yylineno,We=ke.yylloc,mo>0&&mo--);break;case 2:if(Ci=this.productions_[Ht[1]][1],qt.$=it[it.length-Ci],qt._$={first_line:Ye[Ye.length-(Ci||1)].first_line,last_line:Ye[Ye.length-1].last_line,first_column:Ye[Ye.length-(Ci||1)].first_column,last_column:Ye[Ye.length-1].last_column},De&&(qt._$.range=[Ye[Ye.length-(Ci||1)].range[0],Ye[Ye.length-1].range[1]]),ur=this.performAction.apply(qt,[ht,Xr,Ni,ce.yy,Ht[1],it,Ye].concat(xt)),typeof ur!="undefined")return ur;Ci&&(Fe=Fe.slice(0,-1*Ci*2),it=it.slice(0,-1*Ci),Ye=Ye.slice(0,-1*Ci)),Fe.push(this.productions_[Ht[1]][0]),it.push(qt.$),Ye.push(qt._$),wn=_r[Fe[Fe.length-2]][Fe[Fe.length-1]],Fe.push(wn);break;case 3:return!0}}return!0}},Tt=function(){var gr={EOF:1,parseError:function(le,Fe){if(this.yy.parser)this.yy.parser.parseError(le,Fe);else throw new Error(le)},setInput:function(de,le){return this.yy=le||this.yy||{},this._input=de,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var de=this._input[0];this.yytext+=de,this.yyleng++,this.offset++,this.match+=de,this.matched+=de;var le=de.match(/(?:\r\n?|\n).*/g);return le?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),de},unput:function(de){var le=de.length,Fe=de.split(/(?:\r\n?|\n)/g);this._input=de+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-le),this.offset-=le;var be=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),Fe.length-1&&(this.yylineno-=Fe.length-1);var it=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:Fe?(Fe.length===be.length?this.yylloc.first_column:0)+be[be.length-Fe.length].length-Fe[0].length:this.yylloc.first_column-le},this.options.ranges&&(this.yylloc.range=[it[0],it[0]+this.yyleng-le]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(de){this.unput(this.match.slice(de))},pastInput:function(){var de=this.matched.substr(0,this.matched.length-this.match.length);return(de.length>20?"...":"")+de.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var de=this.match;return de.length<20&&(de+=this._input.substr(0,20-de.length)),(de.substr(0,20)+(de.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var de=this.pastInput(),le=new Array(de.length+1).join("-");return de+this.upcomingInput()+`
`+le+"^"},test_match:function(de,le){var Fe,be,it;if(this.options.backtrack_lexer&&(it={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(it.yylloc.range=this.yylloc.range.slice(0))),be=de[0].match(/(?:\r\n?|\n).*/g),be&&(this.yylineno+=be.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:be?be[be.length-1].length-be[be.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+de[0].length},this.yytext+=de[0],this.match+=de[0],this.matches=de,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(de[0].length),this.matched+=de[0],Fe=this.performAction.call(this,this.yy,this,le,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),Fe)return Fe;if(this._backtrack){for(var Ye in it)this[Ye]=it[Ye];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var de,le,Fe,be;this._more||(this.yytext="",this.match="");for(var it=this._currentRules(),Ye=0;Ye<it.length;Ye++)if(Fe=this._input.match(this.rules[it[Ye]]),Fe&&(!le||Fe[0].length>le[0].length)){if(le=Fe,be=Ye,this.options.backtrack_lexer){if(de=this.test_match(Fe,it[Ye]),de!==!1)return de;if(this._backtrack){le=!1;continue}else return!1}else if(!this.options.flex)break}return le?(de=this.test_match(le,it[be]),de!==!1?de:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var le=this.next();return le||this.lex()},begin:function(le){this.conditionStack.push(le)},popState:function(){var le=this.conditionStack.length-1;return le>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(le){return le=this.conditionStack.length-1-Math.abs(le||0),le>=0?this.conditionStack[le]:"INITIAL"},pushState:function(le){this.begin(le)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(le,Fe,be,it){var Ye=it;switch(be){case 0:return this.begin("modexp"),11;break;case 1:return 21;case 2:return this.begin("modexp"),11;break;case 3:return 12;case 4:return 13;case 5:return this.popState(),14;break;case 6:return 65;case 7:return 66;case 8:return 67;case 9:return 68;case 10:return 69;case 11:return 70;case 12:return 71;case 13:return 56;case 14:return 50;case 15:return 51;case 16:return 52;case 17:return 57;case 18:return 53;case 19:return 54;case 20:return 55;case 21:return 59;case 22:return 58;case 23:return 84;case 24:return 72;case 25:return 73;case 26:return 74;case 27:return 75;case 28:return 76;case 29:return 77;case 30:return 78;case 31:return 79;case 32:return 80;case 33:return 82;case 34:return 82;case 35:return 82;case 36:return 82;case 37:return 82;case 38:return 82;case 39:return 82;case 40:return 82;case 41:return 82;case 42:return 81;case 43:return 82;case 44:return 82;case 45:return 81;case 46:return 81;case 47:return 81;case 48:return 81;case 49:return 81;case 50:return 81;case 51:return 81;case 52:return 81;case 53:return 81;case 54:return 81;case 55:return 81;case 56:return 83;case 57:return 20;case 58:return 49;case 59:return 21;case 60:return 90;case 61:return 62;case 62:return 15;case 63:return this.begin("radical"),17;break;case 64:return this.popState(),18;break;case 65:return 18;case 66:return 87;case 67:return 89;case 68:return 88;case 69:return 61;case 70:return 61;case 71:return 27;case 72:return Fe.yytext=this.matches[1],85;break;case 73:return 23;case 74:return 24;case 75:return 25;case 76:return Fe.yytext=this.matches[1],64;break;case 77:return 63;case 78:return 86;case 79:return 91;case 80:return 48;case 81:return 49;case 82:return 60;case 83:return 5;case 84:return 93}},rules:[/^(?:"(?=[^>\]]+%))/,/^(?:")/,/^(?:"(?=[^>\]]+\]|[^>\]]+%))/,/^(?:%)/,/^(?:<)/,/^(?:\])/,/^(?:[+])/,/^(?:[-])/,/^(?:[*])/,/^(?:[@][*])/,/^(?:[@][\#])/,/^(?:[_][/])/,/^(?:[.][/])/,/^(?:[.][.][(])/,/^(?:[@][(])/,/^(?:[.][(])/,/^(?:[(])/,/^(?:[.][.][)])/,/^(?:[@][)])/,/^(?:[.][)])/,/^(?:[)])/,/^(?:[\\][\\])/,/^(?:[\\])/,/^(?:[_][3])/,/^(?:[@][0][O][F][ ]?)/,/^(?:[@][0])/,/^(?:[M][$][\[][ ])/,/^(?:[$][\[][ ])/,/^(?:[$]C[ ])/,/^(?:[$]G[ ])/,/^(?:[ ][$]O[ ])/,/^(?:[$]T[ ])/,/^(?:[^][.][*])/,/^(?:[ ][\^;]+[.]K[ ])/,/^(?:[\^;]+[=])/,/^(?:[ ][\^;]+[/][.]K[ ])/,/^(?:[ ][\^;]+[@][:][@][:][ ])/,/^(?:[ ][\^;]+["]K[:][ ])/,/^(?:[ ][\^;]+[.]1[:][ ])/,/^(?:[ ][\^;]+["]K[ ])/,/^(?:[ ][\^;]+[.]1[ ])/,/^(?:[ ][\^;]+[/][$][L][ ])/,/^(?:[ ][.]K[ ])/,/^(?:[ ][\^;]+[/]?[$][L][ ])/,/^(?:[ ][\^;]+[$]P[ ])/,/^(?:[=])/,/^(?:[ ][/][.]K[ ])/,/^(?:[ ][@][:][@][:][ ])/,/^(?:[ ][/]?[@][:][.][K][ ])/,/^(?:[ ]["]K[:][ ])/,/^(?:[ ][.]1[:][ ])/,/^(?:[ ]["]K[ ])/,/^(?:[ ][.]1[ ])/,/^(?:[/]?[@][:])/,/^(?:[ ][/]?[$][L][ ])/,/^(?:[ ][$]P[ ])/,/^(?:[ ]['][']['][ ])/,/^(?:[\^;]+)/,/^(?:[.]["])/,/^(?:["])/,/^(?:[']+)/,/^(?:[.][,]?[ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[.]*[<])/,/^(?:[.]*[>])/,/^(?:[.]*\])/,/^(?:[.]*\])/,/^(?:!)/,/^(?:[_]&)/,/^(?:&)/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|INF|LIM|LN|LOG|MAX|MIN|MOD|SUP))/,/^(?:(TOKEN)[ ]?)/,/^(?:#?(\d*\.?\d+))/,/^(?:[,]*[?])/,/^(?:[,]*[/])/,/^(?:[,]*#)/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,][=])/,/^(?:[_][8])/,/^(?:[,][ ]?)/,/^(?:[.])/,/^(?:[ ])/,/^(?:$)/,/^(?:.)/],conditions:{radical:{rules:[0,1,2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0},modexp:{rules:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0},INITIAL:{rules:[2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0}}};return gr}();Nt.lexer=Tt;function Et(){this.yy={}}return Et.prototype=Nt,Nt.Parser=Et,new Et}();typeof jv!="undefined"&&typeof r!="undefined"&&(r.parser=t,r.Parser=t.Parser,r.parse=function(){return t.parse.apply(t,arguments)},r.main=function(){},typeof e!="undefined"&&jv.main===e&&r.main(process.argv.slice(1)))}}),ej=L3({"generated/ueb-to-latex.jison.js"(r,e){"use strict";var t=function(){var o=function(mo,Ze,pt,xt){for(pt=pt||{},xt=mo.length;xt--;pt[mo[xt]]=Ze);return pt},i=[1,15],n=[1,16],a=[1,17],s=[1,37],c=[1,38],d=[1,39],p=[1,40],u=[1,45],g=[1,14],h=[1,49],b=[1,50],v=[1,41],T=[1,42],E=[1,43],I=[1,59],_=[1,44],C=[1,46],D=[1,47],P=[1,48],F=[1,57],N=[1,58],Y=[1,60],z=[1,61],X=[1,62],q=[1,63],S=[1,64],A=[1,65],O=[1,66],B=[1,67],V=[1,68],K=[1,69],oe=[1,70],Z=[1,71],ee=[1,72],ue=[1,73],he=[1,74],ae=[1,75],$=[1,76],se=[1,77],J=[1,78],ye=[1,79],Se=[1,80],Ce=[1,81],Te=[1,82],Ae=[1,83],je=[1,84],ie=[1,85],te=[1,86],we=[1,87],Ie=[1,88],He=[1,89],ge=[1,51],nt=[1,52],lt=[1,53],Me=[1,54],Nt=[1,55],Tt=[1,90],Et=[1,56],gr=[5,14,18,19,32,55,56,57],de=[5,10,13,14,15,18,19,32,55,56,57],le=[5,10,13,14,15,17,18,19,21,23,24,26,31,32,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],Fe=[1,98],be=[1,99],it=[1,100],Ye=[2,40],_r=[10,13,15,17,21,23,24,26,31,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],ht={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,expression_group:6,delimited_expression:7,level:8,radical:9,LEVEL:10,basic_token:11,bracketed_expression:12,RADICAL_WITH_INDEX:13,CLOSE_RADICAL:14,RADICAL:15,frac:16,OPEN_FRAC:17,OVER:18,CLOSE_FRAC:19,simple_frac:20,NUMBER:21,NUMBER_FRAC_DENOMINATOR:22,NUMBER_FRAC_NUMERATOR_BAD:23,NUMBER_FRAC_DENOMINATOR_BAD:24,geo_token:25,GEO_TOKEN:26,number:27,atom:28,lbracket:29,rbracket:30,OPEN_GROUP:31,CLOSE_GROUP:32,command:33,greek:34,letter:35,comma:36,period:37,colon:38,infinity:39,integral:40,factorial:41,ampersand:42,question_mark:43,bracket:44,space:45,operation:46,comparison:47,ellipsis:48,primes:49,",":50,".":51,"[":52,"{":53,"(":54,"]":55,"}":56,")":57,SPACE:58,COMMAND:59,GREEK:60,CAPITAL_LETTER:61,LETTER:62,PIPE:63,DOUBLE_PIPE:64,"+":65,"-":66,CDOT:67,TIMES:68,"*":69,DIV:70,SLASH:71,PERCENT_OF:72,PERCENT:73,TO:74,ANGLE:75,MEASURED_ANGLE:76,DEGREE:77,CIRCLE:78,PARALLELOGRAM:79,TRIANGLE:80,"=":81,NEQ:82,"<":83,">":84,LEQ:85,APPROX:86,GEQ:87,SIM:88,NSIM:89,PARALLEL:90,PERPENDICULAR:91,CONG:92,NCONG:93,ELLIPSIS:94,COLON:95,INFINITY:96,INTEGRAL:97,FACTORIAL:98,"&":99,PRIMES:100,"?":101,unknown:102,UNKNOWN:103,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"LEVEL",13:"RADICAL_WITH_INDEX",14:"CLOSE_RADICAL",15:"RADICAL",17:"OPEN_FRAC",18:"OVER",19:"CLOSE_FRAC",21:"NUMBER",22:"NUMBER_FRAC_DENOMINATOR",23:"NUMBER_FRAC_NUMERATOR_BAD",24:"NUMBER_FRAC_DENOMINATOR_BAD",26:"GEO_TOKEN",31:"OPEN_GROUP",32:"CLOSE_GROUP",50:",",51:".",52:"[",53:"{",54:"(",55:"]",56:"}",57:")",58:"SPACE",59:"COMMAND",60:"GREEK",61:"CAPITAL_LETTER",62:"LETTER",63:"PIPE",64:"DOUBLE_PIPE",65:"+",66:"-",67:"CDOT",68:"TIMES",69:"*",70:"DIV",71:"SLASH",72:"PERCENT_OF",73:"PERCENT",74:"TO",75:"ANGLE",76:"MEASURED_ANGLE",77:"DEGREE",78:"CIRCLE",79:"PARALLELOGRAM",80:"TRIANGLE",81:"=",82:"NEQ",83:"<",84:">",85:"LEQ",86:"APPROX",87:"GEQ",88:"SIM",89:"NSIM",90:"PARALLEL",91:"PERPENDICULAR",92:"CONG",93:"NCONG",94:"ELLIPSIS",95:"COLON",96:"INFINITY",97:"INTEGRAL",98:"FACTORIAL",99:"&",100:"PRIMES",101:"?",103:"UNKNOWN"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[7,1],[7,1],[8,2],[8,2],[8,2],[9,4],[9,3],[9,3],[9,2],[9,4],[9,3],[9,2],[16,5],[16,4],[16,4],[16,3],[16,2],[20,2],[20,1],[20,1],[25,2],[11,1],[11,1],[11,1],[6,2],[6,2],[6,1],[6,1],[12,3],[12,2],[12,3],[12,2],[27,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[36,1],[37,1],[29,1],[29,1],[29,1],[30,1],[30,1],[30,1],[45,1],[33,1],[34,1],[35,1],[35,1],[44,1],[44,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[46,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[47,1],[48,1],[38,1],[39,1],[40,1],[41,1],[42,1],[49,1],[43,1],[102,1]],performAction:function(Ze,pt,xt,ke,ce,ve,We){var De=ve.length-1;switch(ce){case 1:return ve[De-1];case 2:return ke.group();case 3:case 36:this.$=ke.group(ve[De-2],ve[De-1],ve[De]);break;case 4:case 6:case 32:case 33:case 37:this.$=ke.group(ve[De-1],ve[De]);break;case 5:case 7:case 34:case 35:this.$=ke.group(ve[De]);break;case 10:case 11:case 12:this.$=ke.basic_level(ve[De-1],ke.group(ve[De]));break;case 13:case 17:this.$=ke.radical(ve[De-1],ke.group(ve[De-2]));break;case 14:case 15:this.$=ke.radical(ke.group(),ke.group(ve[De-1]));break;case 16:this.$=ke.radical(ke.group(),ke.group());break;case 18:this.$=ke.radical(ve[De-1]);break;case 19:this.$=ke.radical(ke.group());break;case 20:this.$=ke.fraction(ve[De-3],ve[De-1]);break;case 21:this.$=ke.fraction(ve[De-2],ke.group());break;case 22:this.$=ke.fraction(ke.group(),ve[De-1]);break;case 23:case 24:this.$=ke.fraction(ke.group(),ke.group());break;case 25:this.$=ke.fraction(ke.group(ke.terminal(ke.to_number(ve[De-1]))),ke.group(ke.terminal(ke.to_number(ve[De]))));break;case 26:this.$=ke.fraction(ke.group(ke.terminal(ke.to_number(ve[De]))),ke.group());break;case 27:this.$=ke.fraction(ke.group(),ke.group(ke.terminal(ke.to_number(ve[$01]))));break;case 28:this.$=ke.geo_token(ve[De]);break;case 38:this.$=ke.group(ve[De-1]);break;case 39:this.$=ke.group();break;case 40:this.$=ke.terminal(ke.to_number(ve[De]));break;case 60:this.$=ke.terminal(",");break;case 61:this.$=ke.terminal(".");break;case 62:this.$=ke.terminal("[");break;case 63:this.$=ke.terminal("\\{");break;case 64:this.$=ke.terminal("(");break;case 65:this.$=ke.terminal("]");break;case 66:this.$=ke.terminal("\\}");break;case 67:this.$=ke.terminal(")");break;case 68:this.$=ke.terminal(" ");break;case 69:this.$=ke.command("\\"+ve[De].trim().toLowerCase());break;case 70:this.$=ke.terminal(ke.greek(ve[De]));break;case 71:this.$=ke.terminal(ve[De].toUpperCase());break;case 72:this.$=ke.terminal(ve[De].toLowerCase());break;case 73:this.$=ke.terminal("|");break;case 74:this.$=ke.terminal("\\|");break;case 75:this.$=ke.terminal("+");break;case 76:this.$=ke.terminal("-");break;case 77:this.$=ke.terminal("\\cdot ");break;case 78:this.$=ke.terminal("\\times ");break;case 79:this.$=ke.terminal("*");break;case 80:this.$=ke.terminal("\\div ");break;case 81:this.$=ke.terminal("/");break;case 82:this.$=ke.terminal("\\%\\operatorname{of}");break;case 83:this.$=ke.terminal("\\%");break;case 84:this.$=ke.terminal("\\to ");break;case 85:this.$=ke.terminal("\\angle ");break;case 86:this.$=ke.terminal("\\measuredangle ");break;case 87:this.$=ke.terminal("\\degree ");break;case 88:this.$=ke.terminal("\\bigcirc ");break;case 89:this.$=ke.terminal("\\parallelogram ");break;case 90:this.$=ke.terminal("\\triangle ");break;case 91:this.$=ke.terminal("=");break;case 92:this.$=ke.terminal("\\neq ");break;case 93:this.$=ke.terminal("<");break;case 94:this.$=ke.terminal(">");break;case 95:this.$=ke.terminal("\\leq ");break;case 96:this.$=ke.terminal("\\approx ");break;case 97:this.$=ke.terminal("\\geq ");break;case 98:this.$=ke.terminal("\\sim ");break;case 99:this.$=ke.terminal("\\nsim ");break;case 100:this.$=ke.terminal("\\parallel ");break;case 101:this.$=ke.terminal("\\perp ");break;case 102:this.$=ke.terminal("\\cong ");break;case 103:this.$=ke.terminal("\\ncong ");break;case 104:this.$=ke.terminal("\\ldots ");break;case 105:this.$=ke.terminal(":");break;case 106:this.$=ke.terminal("\\infty ");break;case 107:this.$=ke.terminal("\\int ");break;case 108:this.$=ke.terminal("!");break;case 109:this.$=ke.terminal("\\&");break;case 110:this.$=ke.primes(ve[De]);break;case 111:this.$=ke.terminal("?");break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:n,15:a,16:11,17:s,20:12,21:c,23:d,24:p,25:20,26:u,27:18,28:10,29:13,31:g,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et},{1:[3]},{5:[1,91]},{1:[2,2]},o(gr,[2,5],{8:8,9:9,7:92,10:i,13:n,15:a}),o(gr,[2,7],{6:4,7:5,11:6,12:7,8:8,9:9,28:10,16:11,20:12,29:13,27:18,33:19,25:20,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,4:93,10:i,13:n,15:a,17:s,21:c,23:d,24:p,26:u,31:g,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et}),o(de,[2,34],{11:6,12:7,28:10,16:11,20:12,29:13,27:18,33:19,25:20,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,6:94,17:s,21:c,23:d,24:p,26:u,31:g,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et}),o(de,[2,35],{11:6,12:7,28:10,16:11,20:12,29:13,27:18,33:19,25:20,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,6:95,17:s,21:c,23:d,24:p,26:u,31:g,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et}),o(le,[2,8]),o(le,[2,9]),o(le,[2,29]),o(le,[2,30]),o(le,[2,31]),{4:96,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:n,15:a,16:11,17:s,20:12,21:c,23:d,24:p,25:20,26:u,27:18,28:10,29:13,30:97,31:g,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:h,51:b,52:v,53:T,54:E,55:Fe,56:be,57:it,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et},{4:101,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:n,15:a,16:11,17:s,20:12,21:c,23:d,24:p,25:20,26:u,27:18,28:10,29:13,31:g,32:[1,102],33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et},{9:105,11:103,12:104,13:n,15:a,16:11,17:s,20:12,21:c,23:d,24:p,25:20,26:u,27:18,28:10,29:13,31:g,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et},{11:106,12:107,14:[1,108],16:11,17:s,20:12,21:c,23:d,24:p,25:20,26:u,27:18,28:10,29:13,31:g,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et},{4:109,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:n,14:[1,110],15:a,16:11,17:s,20:12,21:c,23:d,24:p,25:20,26:u,27:18,28:10,29:13,31:g,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et},o(le,[2,41]),o(le,[2,42]),o(le,[2,43]),o(le,[2,44]),o(le,[2,45]),o(le,[2,46]),o(le,[2,47]),o(le,[2,48]),o(le,[2,49]),o(le,[2,50]),o(le,[2,51]),o(le,[2,52]),o(le,[2,53]),o(le,[2,54]),o(le,[2,55]),o(le,[2,56]),o(le,[2,57]),o(le,[2,58]),o(le,[2,59]),{4:111,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:n,15:a,16:11,17:s,18:[1,112],19:[1,113],20:12,21:c,23:d,24:p,25:20,26:u,27:18,28:10,29:13,31:g,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et},o(le,Ye,{22:[1,114]}),o(le,[2,26]),o(le,[2,27]),o(_r,[2,62]),o(_r,[2,63]),o(_r,[2,64]),o(le,[2,69]),{21:[1,116],27:115},o(le,[2,70]),o(le,[2,71]),o(le,[2,72]),o(le,[2,60]),o(le,[2,61]),o(le,[2,105]),o(le,[2,106]),o(le,[2,107]),o(le,[2,108]),o(le,[2,109]),o(le,[2,111]),o(le,[2,73]),o(le,[2,74]),o(le,[2,68]),o(le,[2,75]),o(le,[2,76]),o(le,[2,77]),o(le,[2,78]),o(le,[2,79]),o(le,[2,80]),o(le,[2,81]),o(le,[2,82]),o(le,[2,83]),o(le,[2,84]),o(le,[2,85]),o(le,[2,86]),o(le,[2,87]),o(le,[2,88]),o(le,[2,89]),o(le,[2,90]),o(le,[2,91]),o(le,[2,92]),o(le,[2,93]),o(le,[2,94]),o(le,[2,95]),o(le,[2,96]),o(le,[2,97]),o(le,[2,98]),o(le,[2,99]),o(le,[2,100]),o(le,[2,101]),o(le,[2,102]),o(le,[2,103]),o(le,[2,104]),o(le,[2,110]),{1:[2,1]},o(gr,[2,4],{6:4,7:5,11:6,12:7,8:8,9:9,28:10,16:11,20:12,29:13,27:18,33:19,25:20,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,4:117,10:i,13:n,15:a,17:s,21:c,23:d,24:p,26:u,31:g,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et}),o(gr,[2,6]),o(de,[2,32]),o(de,[2,33]),{30:118,55:Fe,56:be,57:it},o(le,[2,37]),o(le,[2,65]),o(le,[2,66]),o(le,[2,67]),{32:[1,119]},o(le,[2,39]),o(le,[2,10]),o(le,[2,11]),o(le,[2,12]),{4:120,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:n,14:[1,121],15:a,16:11,17:s,20:12,21:c,23:d,24:p,25:20,26:u,27:18,28:10,29:13,31:g,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et},{4:123,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:n,14:[1,122],15:a,16:11,17:s,20:12,21:c,23:d,24:p,25:20,26:u,27:18,28:10,29:13,31:g,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et},o(le,[2,16]),{14:[1,124]},o(le,[2,19]),{18:[1,125]},{4:126,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:n,15:a,16:11,17:s,19:[1,127],20:12,21:c,23:d,24:p,25:20,26:u,27:18,28:10,29:13,31:g,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et},o(le,[2,24]),o(le,[2,25]),o(le,[2,28]),o(le,Ye),o(gr,[2,3]),o(le,[2,36]),o(le,[2,38]),{14:[1,128]},o(le,[2,15]),o(le,[2,14]),{14:[1,129]},o(le,[2,18]),{4:130,6:4,7:5,8:8,9:9,10:i,11:6,12:7,13:n,15:a,16:11,17:s,19:[1,131],20:12,21:c,23:d,24:p,25:20,26:u,27:18,28:10,29:13,31:g,33:19,34:21,35:22,36:23,37:24,38:25,39:26,40:27,41:28,42:29,43:30,44:31,45:32,46:33,47:34,48:35,49:36,50:h,51:b,52:v,53:T,54:E,58:I,59:_,60:C,61:D,62:P,63:F,64:N,65:Y,66:z,67:X,68:q,69:S,70:A,71:O,72:B,73:V,74:K,75:oe,76:Z,77:ee,78:ue,79:he,80:ae,81:$,82:se,83:J,84:ye,85:Se,86:Ce,87:Te,88:Ae,89:je,90:ie,91:te,92:we,93:Ie,94:He,95:ge,96:nt,97:lt,98:Me,99:Nt,100:Tt,101:Et},{19:[1,132]},o(le,[2,23]),o(le,[2,13]),o(le,[2,17]),{19:[1,133]},o(le,[2,21]),o(le,[2,22]),o(le,[2,20])],defaultActions:{3:[2,2],91:[2,1]},parseError:function(Ze,pt){if(pt.recoverable)this.trace(Ze);else{var xt=new Error(Ze);throw xt.hash=pt,xt}},parse:function(Ze){var pt=this,xt=[0],ke=[],ce=[null],ve=[],We=this.table,De="",mt=0,gt=0,Vt=0,ir=2,Yt=1,Ht=ve.slice.call(arguments,1),Lt=Object.create(this.lexer),ur={yy:{}};for(var qt in this.yy)Object.prototype.hasOwnProperty.call(this.yy,qt)&&(ur.yy[qt]=this.yy[qt]);Lt.setInput(Ze,ur.yy),ur.yy.lexer=Lt,ur.yy.parser=this,typeof Lt.yylloc=="undefined"&&(Lt.yylloc={});var Mo=Lt.yylloc;ve.push(Mo);var Ci=Lt.options&&Lt.options.ranges;typeof ur.yy.parseError=="function"?this.parseError=ur.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function wn(qn){xt.length=xt.length-2*qn,ce.length=ce.length-qn,ve.length=ve.length-qn}for(var di=function(){var qn;return qn=Lt.lex()||Yt,typeof qn!="number"&&(qn=pt.symbols_[qn]||qn),qn},$r,pi,Cl,Ui,Yi,zn,ui={},qd,da,Hd,wu;;){if(Cl=xt[xt.length-1],this.defaultActions[Cl]?Ui=this.defaultActions[Cl]:(($r===null||typeof $r=="undefined")&&($r=di()),Ui=We[Cl]&&We[Cl][$r]),typeof Ui=="undefined"||!Ui.length||!Ui[0]){var Su="";wu=[];for(qd in We[Cl])this.terminals_[qd]&&qd>ir&&wu.push("'"+this.terminals_[qd]+"'");Lt.showPosition?Su="Parse error on line "+(mt+1)+`:
`+Lt.showPosition()+`
Expecting `+wu.join(", ")+", got '"+(this.terminals_[$r]||$r)+"'":Su="Parse error on line "+(mt+1)+": Unexpected "+($r==Yt?"end of input":"'"+(this.terminals_[$r]||$r)+"'"),this.parseError(Su,{text:Lt.match,token:this.terminals_[$r]||$r,line:Lt.yylineno,loc:Mo,expected:wu})}if(Ui[0]instanceof Array&&Ui.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Cl+", token: "+$r);switch(Ui[0]){case 1:xt.push($r),ce.push(Lt.yytext),ve.push(Lt.yylloc),xt.push(Ui[1]),$r=null,pi?($r=pi,pi=null):(gt=Lt.yyleng,De=Lt.yytext,mt=Lt.yylineno,Mo=Lt.yylloc,Vt>0&&Vt--);break;case 2:if(da=this.productions_[Ui[1]][1],ui.$=ce[ce.length-da],ui._$={first_line:ve[ve.length-(da||1)].first_line,last_line:ve[ve.length-1].last_line,first_column:ve[ve.length-(da||1)].first_column,last_column:ve[ve.length-1].last_column},Ci&&(ui._$.range=[ve[ve.length-(da||1)].range[0],ve[ve.length-1].range[1]]),zn=this.performAction.apply(ui,[De,gt,mt,ur.yy,Ui[1],ce,ve].concat(Ht)),typeof zn!="undefined")return zn;da&&(xt=xt.slice(0,-1*da*2),ce=ce.slice(0,-1*da),ve=ve.slice(0,-1*da)),xt.push(this.productions_[Ui[1]][0]),ce.push(ui.$),ve.push(ui._$),Hd=We[xt[xt.length-2]][xt[xt.length-1]],xt.push(Hd);break;case 3:return!0}}return!0}},Ni=function(){var mo={EOF:1,parseError:function(pt,xt){if(this.yy.parser)this.yy.parser.parseError(pt,xt);else throw new Error(pt)},setInput:function(Ze,pt){return this.yy=pt||this.yy||{},this._input=Ze,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var Ze=this._input[0];this.yytext+=Ze,this.yyleng++,this.offset++,this.match+=Ze,this.matched+=Ze;var pt=Ze.match(/(?:\r\n?|\n).*/g);return pt?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),Ze},unput:function(Ze){var pt=Ze.length,xt=Ze.split(/(?:\r\n?|\n)/g);this._input=Ze+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-pt),this.offset-=pt;var ke=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),xt.length-1&&(this.yylineno-=xt.length-1);var ce=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:xt?(xt.length===ke.length?this.yylloc.first_column:0)+ke[ke.length-xt.length].length-xt[0].length:this.yylloc.first_column-pt},this.options.ranges&&(this.yylloc.range=[ce[0],ce[0]+this.yyleng-pt]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(Ze){this.unput(this.match.slice(Ze))},pastInput:function(){var Ze=this.matched.substr(0,this.matched.length-this.match.length);return(Ze.length>20?"...":"")+Ze.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var Ze=this.match;return Ze.length<20&&(Ze+=this._input.substr(0,20-Ze.length)),(Ze.substr(0,20)+(Ze.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var Ze=this.pastInput(),pt=new Array(Ze.length+1).join("-");return Ze+this.upcomingInput()+`
`+pt+"^"},test_match:function(Ze,pt){var xt,ke,ce;if(this.options.backtrack_lexer&&(ce={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(ce.yylloc.range=this.yylloc.range.slice(0))),ke=Ze[0].match(/(?:\r\n?|\n).*/g),ke&&(this.yylineno+=ke.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:ke?ke[ke.length-1].length-ke[ke.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+Ze[0].length},this.yytext+=Ze[0],this.match+=Ze[0],this.matches=Ze,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(Ze[0].length),this.matched+=Ze[0],xt=this.performAction.call(this,this.yy,this,pt,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),xt)return xt;if(this._backtrack){for(var ve in ce)this[ve]=ce[ve];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var Ze,pt,xt,ke;this._more||(this.yytext="",this.match="");for(var ce=this._currentRules(),ve=0;ve<ce.length;ve++)if(xt=this._input.match(this.rules[ce[ve]]),xt&&(!pt||xt[0].length>pt[0].length)){if(pt=xt,ke=ve,this.options.backtrack_lexer){if(Ze=this.test_match(xt,ce[ve]),Ze!==!1)return Ze;if(this._backtrack){pt=!1;continue}else return!1}else if(!this.options.flex)break}return pt?(Ze=this.test_match(pt,ce[ke]),Ze!==!1?Ze:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var pt=this.next();return pt||this.lex()},begin:function(pt){this.conditionStack.push(pt)},popState:function(){var pt=this.conditionStack.length-1;return pt>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(pt){return pt=this.conditionStack.length-1-Math.abs(pt||0),pt>=0?this.conditionStack[pt]:"INITIAL"},pushState:function(pt){this.begin(pt)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(pt,xt,ke,ce){var ve=ce;switch(ke){case 0:this.begin("captext");return;case 1:return 61;case 2:return this.popState(),61;break;case 3:return 65;case 4:return 66;case 5:return 67;case 6:return 68;case 7:return 69;case 8:return 70;case 9:return 52;case 10:return 53;case 11:return 54;case 12:return 55;case 13:return 56;case 14:return 57;case 15:return 82;case 16:return 85;case 17:return 86;case 18:return 87;case 19:return 81;case 20:return 83;case 21:return 84;case 22:return 89;case 23:return 88;case 24:return 72;case 25:return 73;case 26:return 74;case 27:return 76;case 28:return 75;case 29:return 78;case 30:return 79;case 31:return 80;case 32:return 93;case 33:return 92;case 34:return 94;case 35:return 13;case 36:return 15;case 37:return 14;case 38:return 10;case 39:return 31;case 40:return 32;case 41:return 97;case 42:return 98;case 43:return 99;case 44:return 17;case 45:return 18;case 46:return 19;case 47:return 90;case 48:return 91;case 49:return 96;case 50:return xt.yytext=this.matches[1],21;break;case 51:return xt.yytext=this.matches[1],22;break;case 52:return xt.yytext=this.matches[1],24;break;case 53:return 71;case 54:return 50;case 55:return 51;case 56:return 100;case 57:return 64;case 58:return 63;case 59:return 95;case 60:return 59;case 61:return 59;case 62:return 26;case 63:return 60;case 64:return 77;case 65:return xt.yytext=this.matches[1],61;break;case 66:return 62;case 67:return;case 68:return 101;case 69:return;case 70:return 58;case 71:return 5;case 72:return 103}},rules:[/^(?:([,][,])(?=[A-Z]))/,/^(?:[A-Z](?=[A-Z]))/,/^(?:[A-Z])/,/^(?:["][6])/,/^(?:["][-])/,/^(?:["][4])/,/^(?:["][8])/,/^(?:["][9])/,/^(?:["][/])/,/^(?:[.][<])/,/^(?:[_][<])/,/^(?:["][<])/,/^(?:[.][>])/,/^(?:[_][>])/,/^(?:["][>])/,/^(?:["][7][@][:])/,/^(?:[_][@][<])/,/^(?:[\^][9])/,/^(?:[_][@][>])/,/^(?:["][7])/,/^(?:[@][<])/,/^(?:[@][>])/,/^(?:[@][9][@][:])/,/^(?:[@][9])/,/^(?:[.][0][O][F][ ]?)/,/^(?:[.][0])/,/^(?:[:][O])/,/^(?:[.][_][\[])/,/^(?:[_][\[])/,/^(?:[$][=])/,/^(?:[$][@][#][D])/,/^(?:[$][#][C])/,/^(?:["][_][9][@][:])/,/^(?:["][_][9])/,/^(?:[4][4][4])/,/^(?:[%][9])/,/^(?:[%])/,/^(?:[\+])/,/^(?:[95]+(?=.))/,/^(?:[<])/,/^(?:[>])/,/^(?:!)/,/^(?:[6])/,/^(?:[@]&)/,/^(?:[(])/,/^(?:[.][/])/,/^(?:[)])/,/^(?:#[L])/,/^(?:#-)/,/^(?:#=)/,/^(?:#([A-J4]+))/,/^(?:[/]([A-J4]+))/,/^(?:[#][/]([A-J4]+))/,/^(?:[_]?[/])/,/^(?:[1])/,/^(?:[4])/,/^(?:[7]+)/,/^(?:[_][\\][_][\\])/,/^(?:[_][\\])/,/^(?:[3])/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|INF|LIM|LN|LOG|MAX|MIN|MOD|SUP))/,/^(?:(TOKEN)[ ]?)/,/^(?:[,]?[.][ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[^][J])/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,]['])/,/^(?:[8])/,/^(?:[;])/,/^(?:[ ])/,/^(?:$)/,/^(?:.)/],conditions:{captext:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72],inclusive:!0},INITIAL:{rules:[0,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72],inclusive:!0}}};return mo}();ht.lexer=Ni;function Xr(){this.yy={}}return Xr.prototype=ht,ht.Parser=Xr,new Xr}();typeof jv!="undefined"&&typeof r!="undefined"&&(r.parser=t,r.Parser=t.Parser,r.parse=function(){return t.parse.apply(t,arguments)},r.main=function(){},typeof e!="undefined"&&jv.main===e&&r.main(process.argv.slice(1)))}}),G3=["abs","ans","arccosh","arccot","arccoth","arccsc","arccsch","arcsec","arcsech","arcsinh","arctanh","binomialdist","boxplot","cdf","ceil","corr","cov","csch","distance","dotplot","erf","floor","gcf","histogram","IndependentTTest","iTTest","ittest","lcm","length","mad","mcd","mcm","mean","median","midpoint","mod","nCr","normaldist","nPr","pdf","poissondist","polygon","quantile","quartile","random","round","sech","sign","signum","sgn","stdDev","stddev","stdDevP","stddevp","stdev","stdevp","tdist","total","TScore","TScore","Tscore","tscore","tscore","TTest","ttest","var","variance","varp"],jM=G3,Gpe=rj(G3),V3;function tj(r){let e=!1,t=0,o="",i="";for(let n of r)if(n.type==="terminal"&&/[A-Za-z]/.test(n.value))o+=n.value,t++;else break;return i=o.replace(V3,"\\operatorname{$1}"),e=t>0&&i!==o,{modified:e,terminalCount:t,value:i}}function O3(r){return jM.indexOf(r.toLowerCase())!==-1}function XM(r){if(!Array.isArray(r))throw new Error("Operator names must be an array, got "+typeof r);for(let e of r)if(typeof e!="string")throw new Error("Operator names must be strings, found "+typeof e);jM=r,Vpe()}function $M(){jM=G3,V3=Gpe}function Vpe(){V3=rj(jM)}function rj(r){let e=r.sort((t,o)=>o.length-t.length||o.localeCompare(t)).join("|");return new RegExp("("+e+")","g")}var oj={};P3(oj,{command:()=>R3,fraction:()=>Fpe,greek:()=>Ope,group:()=>F3,level:()=>nj,processPrimes:()=>Rpe,radical:()=>Npe,terminal:()=>ij,typeform:()=>aj});function ij(r){return{type:"terminal",value:r}}function R3(r){return{type:"command",value:r}}function Ope(r){return{type:"greek",value:r}}function nj(r){return{subscript:r._,superscript:r["^"],type:"level"}}function Rpe(r,e){let t=[],o=r.match(/'+/);if(o!==null){let i=o[0].length;for(let n=0;n<i;n++)t.push(R3("\\prime"))}return F3(t,e)}function Fpe(r,e){return{type:"fraction",numerator:r,denominator:e}}function aj(r,e){return{name:r,type:"typeform",value:e}}function Npe(r,e){return{type:"radical",index:e,radicand:r}}function F3(...r){return Array.prototype.concat.apply([],r)}var UM={"~":"\\ ","\\,":"\\ ","\\:":"\\ ","\\;":"\\ ","\\!":"\\ "},U7={"\\Vert":"\\|","\\ge":"\\geq","\\le":"\\leq","\\vert":"|"},Upe={"\\space":!0};function Yg(r){let e=[];for(let t=0;t<r.length;t++){let o=r[t];switch(o.type){case"command":let i=o.value.slice(1).trim();U7.hasOwnProperty(o.value)?e.push(R3(U7[o.value])):O3(i)?e.push(aj("operator_name",Ype(i))):Upe[o.value]||e.push(o);break;case"level":let n={subscript:o.subscript&&o.subscript.length>0?Yg(o.subscript):void 0,superscript:o.superscript&&o.superscript.length>0?Yg(o.superscript):void 0,type:o.type};(n.subscript||n.superscript)&&e.push(n);break;case"fraction":e.push({denominator:Yg(o.denominator),numerator:Yg(o.numerator),type:o.type});break;case"radical":e.push({index:o.index?Yg(o.index):void 0,radicand:Yg(o.radicand),type:o.type});break;case"terminal":Bpe(r.slice(t))?(e.push({type:"command",value:"\\ldots"}),t+=2):e.push({type:o.type,value:UM.hasOwnProperty(o.value)?UM[o.value]:o.value});break;case"typeform":e.push(o);break;case"greek":e.push({type:o.type,value:UM.hasOwnProperty(o.value)?UM[o.value]:o.value});break;default:throw new Error(`Unexpected item:
`+JSON.stringify({group:r,item:o}))}}return e}function Ype(r){let e=[];for(let t of r)e.push(ij(t));return e}function Bpe(r){let e=0;for(let t=0;t<Math.min(3,r.length);t++){let o=r[t];o.type==="terminal"&&o.value==="."&&e++}return e===3}function N3(r){if(!r.hash)throw r;return{_diagnostic:{expected:r.hash.expected,message:r.message,text:r.hash.text,token:r.hash.token},location:r.hash.loc}}var sj=Ppe();sj.parser.yy=oj;function lj(r){try{return{isError:!1,value:sj.parser.parse(r)}}catch(e){return{isError:!0,error:N3(e)}}}function Kpe(r){return r.isError}function zpe(r,e){return Kpe(r)?r:{isError:!1,value:e(r.value)}}function Xv(r,e){let t=zpe(r,e);return r.warnings&&(t.warnings=r.warnings),t}function qpe(r){return Xv(lj(r),e=>rue(Yg(e)))}var Y7={"!":"&","*":"@#",",":", ","/":"_/",":":"_3","<":' "K ',"=":" .K ",">":" .1 ","?":"_8","[":"@(","\\ ":" ","\\%":"@0","\\&":"_&","\\,":" ","\\infty":",=","\\int":"!","\\{":".(","\\|":"\\\\","\\}":".)","]":"@)","|":"\\"};function k3(r){return/^[a-z]$/.test(r.value)?r.value.toUpperCase():/^[A-Z]$/.test(r.value)?","+r.value:/^[0-9.]$/.test(r.value)||/^[+\-()]$/.test(r.value)?r.value:Y7.hasOwnProperty(r.value)?Y7[r.value]:"[terminal: "+r.value+"]"}var B7={"\\Vert":"\\\\","\\angle":"$[ ","\\approx":" @:@: ","\\bigcirc":"$C ","\\cong":" @:.K ","\\cdot":"*","\\degree":"~.*","\\div":"./","\\ge":" .1: ","\\geq":" .1: ","\\langle":"..(","\\ldots":" ''' ","\\le":' "K: ',"\\leq":' "K: ',"\\measuredangle":"M$[ ","\\ncong":" /@:.K ","\\ne":" /.K ","\\neq":" /.K ","\\nparallel":" /$L ","\\nsim":"/@:","\\parallel":" $L ","\\parallelogram":"$G ","\\perp":" $P ","\\prime":"'","\\prod":".,P","\\rangle":"..)","\\sim":"@:","\\sum":".,S","\\times":"@*","\\to":" $O ","\\triangle":"$T ","\\vert":"\\"},K7={"\\Alpha":".,A","\\Beta":".,B","\\Chi":".,&","\\Delta":".,D","\\Epsilon":".,E","\\Eta":".,:","\\Gamma":".,G","\\Iota":".,I","\\Kappa":".,K","\\Lambda":".,L","\\Mu":".,M","\\Nu":".,N","\\Omega":".,W","\\Omicron":".,O","\\Phi":".,F","\\Pi":".,P","\\Psi":".,Y","\\Rho":".,R","\\Sigma":".,S","\\Tau":".,T","\\Theta":".,?","\\Upsilon":".,U","\\Xi":".,X","\\Zeta":".,Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"};function z7(r){return B7.hasOwnProperty(r.value)?B7[r.value]:r.value.slice(1).toUpperCase()+" "}function Hpe(r){return K7.hasOwnProperty(r.value)?K7[r.value]:r.value.slice(1).toUpperCase()+" "}function Wpe(r){return r.value==="\\space"}function jpe(r,e){return r.isStartOfLine&&/^-?$/.test(e)||/\s-?$/.test(e)||r.wasFraction}function Xpe(r){return r.value==="\\sum"||r.value==="\\prod"}function $pe(r,e){if(e>=r.length)return!1;let t=r[e];if(t.type==="terminal"){if(/^[0-9]$/.test(t.value))return!0;if(t.value!=="."||e+1>=r.length)return!1;if(t=r[e+1],t.type==="terminal")return/^[0-9]$/.test(t.value)}return!1}function Kg(r,e){let t="",o=r.levelIndicator,i=0,n=!1;for(let a=0;a<e.length;a++){$pe(e,a)&&(o===""&&/[A-Z]$/.test(t)?t+=Sp(o):jpe(r,t)&&(t+="#"));let s=e[a],c=a<e.length-1?e[a+1]:null;switch(s.type!=="level"&&o!==r.levelIndicator&&(_3(s)?o="":(r.wasModifiedExpression&&r.levelIndicator===""?r=Al(r,{wasModifiedExpression:!1}):t+=Sp(r.levelIndicator),o=r.levelIndicator)),s.type){case"terminal":!r.wasModifiedExpression&&o!==""&&_3(s)?t+=" "+Sp(o)+k3(s).trim()+" ":t+=k3(s),s.value==="."&&c&&(c.type==="terminal"&&/^[^_\d,]/.test(k3(c))||c.type==="greek")&&(t+='"'),r=Al(r,{wasFraction:!1,wasRomanCommand:!1});break;case"command":if(!Wpe(s)){let h=Xpe(s);h&&(t+='"'),!h&&o!==""&&_3(s)?t+=" "+Sp(o)+z7(s).trim()+" ":t+=z7(s),r=Al(r,{wasFraction:!1,wasModifiedExpression:h,wasRomanCommand:!0})}break;case"greek":t+=Hpe(s),r=Al(r,{wasFraction:!1});break;case"fraction":let d=Jpe(r,s);t+=d.value,i=Math.max(i,d.fractionLevel),r=Al(r,{wasFraction:!0,wasRomanCommand:!1});break;case"radical":let p=Zpe(r,s);t+=p.value,i=Math.max(i,p.fractionLevel),r=Al(r,{wasFraction:!1,wasRomanCommand:!1});break;case"level":!r.wasModifiedExpression&&r.wasRomanCommand?(n=/\s$/.test(t),n&&(t=t.replace(/\s$/,""))):n=!1;let u=t.length>0&&/[A-Za-z]/.test(t[t.length-1])===!0,g=Qpe(r,u,n,s);t+=g.value,o=g.levelIndicator,r=Al(r,{wasFraction:!1,wasRomanCommand:!1});break;case"typeform":t+=Kg(r,s.value).value,s.name==="operator_name"&&(t+=" "),r=Al(r,{wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1});break}}return{fractionLevel:i,levelIndicator:o,value:t}}function Jpe(r,e){r=Al(r,{isStartOfLine:!1});let t=Kg(r,e.numerator),o=Kg(r,e.denominator),i=Math.max(t.fractionLevel,o.fractionLevel),n="";for(let s=0;s<i;s++)n+=",";let a=n+"?"+t.value;return t.levelIndicator!==r.levelIndicator&&(a+=Sp(r.levelIndicator)),/\.$/.test(t.value)&&(a+='"'),a+=n+"/"+o.value,o.levelIndicator!==r.levelIndicator&&(a+=Sp(r.levelIndicator)),/\.$/.test(o.value)&&(a+='"'),a+=n+"#",{fractionLevel:i+1,value:a}}function Zpe(r,e){let t=r.radicalLevel,o="",i="";for(let a=0;a<t;a++)i+=".";if(e.index){o+=i+"<";let a=Kg(Al(r,{isStartOfLine:!1}),e.index);o+=a.value,/\.$/.test(a.value)&&(o+='"'),a.levelIndicator!==r.levelIndicator&&(o+=Sp(r.levelIndicator)),o+=">"}else o+=i+">";let n=Kg(Al(r,{isStartOfLine:!1,radicalLevel:t+1}),e.radicand);return o+=n.value,/\.$/.test(n.value)&&(o+='"'),n.levelIndicator!==r.levelIndicator&&(o+=Sp(r.levelIndicator)),o+=i+"]",{fractionLevel:n.fractionLevel,value:o}}function Qpe(r,e,t,o){let i=r.levelIndicator,n="",a=eue(o.superscript);if(n+=a,o.subscript){r.wasModifiedExpression&&(n+="%"),i=r.levelIndicator+";";let s=Kg(Al(r,{isStartOfLine:!1,levelIndicator:i}),o.subscript);e&&/^[0-9]*(\.|\,)?[0-9]+$/.test(s.value)&&i.length<=1?i=r.levelIndicator:!r.wasModifiedExpression&&o.subscript[0]&&o.subscript[0].type!=="level"&&(n+=Sp(i)),n+=s.value,/\.$/.test(s.value)&&(n+='"')}if(o.superscript){r.wasModifiedExpression&&(n+="<"),i=r.levelIndicator+"^";let s=Kg(Al(r,{isStartOfLine:!1,levelIndicator:i}),o.superscript.slice(a.length));!r.wasModifiedExpression&&o.superscript[0]&&o.superscript[0].type!=="level"&&s.value!==""&&(n+=Sp(i)),n+=s.value,/\.$/.test(s.value)&&(n+='"')}return r.wasModifiedExpression?n+="]":r.wasRomanCommand&&t&&(n+=" ",i=i.slice(0,i.length-1)),{levelIndicator:i,value:n}}function eue(r){let e="";if(r)for(let t of r)if(t.type==="command"&&t.value==="\\prime")e+="'";else break;return e}function Sp(r){return r||'"'}function tue(){return{isStartOfLine:!0,levelIndicator:"",radicalLevel:0,wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1}}function Al(r,e){return Wv(Wv({},r),e)}function _3(r){return r.type==="terminal"||r.type==="command"?/^<|>|\=|\\leq?|\\geq?|\\neq?$/.test(r.value):!1}function rue(r){let e=tue();return Kg(e,r).value}function oue(r){return Xv(lj(r),e=>mue(Yg(e)))}var q7={"!":"6","(":'"<',")":'">',"*":'"9',"+":'"6',",":"1","-":'"-',".":"4","/":"_/",":":"3","<":"@<","=":'"7',">":"@>","?":"8","[":".<","\\ ":" ","\\%":".0","\\&":"@&","\\,":" ","\\infty":"#=","\\int":"!","\\{":"_<","\\|":"_\\_\\","\\}":"_>","]":".>","|":"_\\"};function iue(r,e,t){let o="",i=e.value,n=t&&t.type==="terminal"?t.value:"";return cj(i,r)&&(o+=";"),/^[\D]/.test(i)&&(r=kp(r,{wasNumber:!1})),/^[a-z]$/.test(i)?r.capsLock?(r=kp(r,{capsLock:!1}),o+=",'"+i.toUpperCase()):o+=i.toUpperCase():/^[A-Z]$/.test(i)?r.capsLock?o+=i:/[A-Z]/.test(n)?(r=kp(r,{capsLock:!0}),o+=",,"+i):o+=","+i:(r=kp(r,{capsLock:!1}),/^[0-9.]$/.test(i)?o+=cue(i):q7.hasOwnProperty(i)?o+=q7[i]:o+="[terminal: "+i+"]"),{value:o,ctx:r}}var H7={"\\Vert":"_\\_\\","\\angle":"_{","\\approx":"^9","\\bigcirc":"$=","\\cdot":'"4',"\\cong":'"_9',"\\degree":"~J","\\div":'"/',"\\ge":"_@>","\\geq":"_@>","\\langle":"@<","\\ldots":"444","\\le":"_@<","\\leq":"_@<","\\measuredangle":"._{","\\ncong":'"_9@:',"\\ne":'"7@:',"\\neq":'"7@:',"\\nsim":"@9@:","\\parallel":"#L","\\parallelogram":"$@#D","\\perp":"#-","\\prime":"7","\\prod":",.P","\\rangle":"@>","\\sim":"@9","\\sum":",.S","\\times":'"8',"\\to":":O","\\triangle":"$#C","\\vert":"_\\"},W7={"\\Alpha":",.A","\\Beta":",.B","\\Chi":",.&","\\Delta":",.D","\\Epsilon":",.E","\\Eta":",.:","\\Gamma":",.G","\\Iota":",.I","\\Kappa":",.K","\\Lambda":",.L","\\Mu":",.M","\\Nu":",.N","\\Omega":",.W","\\Omicron":",.O","\\Phi":",.F","\\Pi":",.P","\\Psi":",.Y","\\Rho":",.R","\\Sigma":",.S","\\Tau":",.T","\\Theta":",.?","\\Upsilon":",.U","\\Xi":",.X","\\Zeta":",.Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"};function nue(r,e){let t;return H7.hasOwnProperty(r.value)?t=H7[r.value]:t=r.value.slice(1).toUpperCase()+" ",cj(t,e)&&(t=";"+t),/^[\D]/.test(t)&&(e=kp(e,{wasNumber:!1})),{value:t,ctx:e}}function aue(r){return W7.hasOwnProperty(r.value)?W7[r.value]:r.value.slice(1).toUpperCase()+" "}function sue(r){return r.value==="\\space"}function lue(r,e){if(e<r.length){let t=r[e];if(t.type==="terminal"){if(/^\d$/.test(t.value))return!0;if(t.value!=="."||e+1>=r.length)return!1;if(t=r[e+1],t.type==="terminal")return/^\d$/.test(t.value)}}return!1}function cue(r){let e="";for(let o of r)o===","?e+="1":o==="."?e+="4":o==="0"?e+="J":e+=String.fromCharCode(64+Number(o));return e}function zg(r,e){let t,o,i="",n=!0;for(let a=0;a<e.length;a++){lue(e,a)?(r=kp(r,{wasNumber:!0}),n&&(i+="#",n=!1)):n=!0;let s=e[a];switch(s.type){case"terminal":let c=a<e.length-1?e[a+1]:void 0;t=iue(r,s,c),r=t.ctx,i+=t.value,i[i.length-1]===" "&&(n=!0);break;case"command":sue(s)||(o=nue(s,r),r=o.ctx,i+=o.value,i[i.length-1]===" "&&(n=!0));break;case"greek":i+=aue(s),i[i.length-1]===" "&&(n=!0);break;case"fraction":let d=due(r,s);i+=d.value,r=d.ctx,n=!1;break;case"radical":let p=pue(r,s);i+=p.value,n=!0;break;case"level":let u=uue(r,s);i+=u.value,r=u.ctx,n=!0;break;case"typeform":let g=zg(r,s.value).value;i+=g,/(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?/.test(g)&&(i+=" ");break}}return{ctx:r,value:i}}function cj(r,e){return e.wasNumber&&/^[A-Ja-j]/.test(r)}function due(r,e){let t=zg(r,e.numerator),o=zg(r,e.denominator),i;return E3(t.value)&&E3(o.value)?(r=kp(r,{wasNumber:!0}),i=t.value+"/"+o.value.slice(1)):(r=kp(r,{wasNumber:!1}),i="("+t.value+"./"+o.value+")"),{ctx:r,value:i}}function E3(r){return/^\#[A-J41]+$/.test(r)}function pue(r,e){let t="%",o=zg(r,e.radicand);if(e.index){let i=zg(r,F3(nj({"^":e.index})));t+=i.value,/\#[A-J]$/.test(i.value)&&/^[A-J]/.test(o.value)&&(t+=";")}return t+=o.value+"+",{ctx:r,value:t}}function uue(r,e){let t="",o=hue(e.superscript);t+=o;let i;if(e.subscript){let n=zg(r,e.subscript);X7(e.subscript,n.value,0)?i="<"+j7(n.value)+">":i=n.value,r=kp(r,{wasNumber:n.ctx.wasNumber}),i!==""&&(t+="5"+i)}if(e.superscript){let n=zg(r,e.superscript.slice(o.length));X7(e.superscript,n.value,o.length)?i="<"+j7(n.value)+">":i=n.value,r=kp(r,{wasNumber:n.ctx.wasNumber}),(o===""||i!=="")&&(t+="9"+i)}return{ctx:r,value:t}}function j7(r){return/^;/.test(r)?r.slice(1):r}function hue(r){let e="";if(r)for(let t of r)if(t.type==="command"&&t.value==="\\prime")e+="7";else break;return e}function X7(r,e,t){let o=r[0],i=(e.match(/\</g)||[]).length,n=/^["|\.|_]?\</.test(e),a=(e.match(/\>/g)||[]).length,s=/["|\.|_]?\>$/.test(e);return!E3(e)&&r.length-t>1&&i===0&&a===0||i>0&&a>0&&(!n||!s)||i>1||a>1||o&&o.type==="typeform"}function gue(){return{capsLock:!1,wasNumber:!1}}function kp(r,e){return Wv(Wv({},r),e)}function mue(r){let e=gue();return zg(e,r).value}var I3={};P3(I3,{baseline:()=>wue,command:()=>bue,comparison:()=>vue,expression:()=>Tue,fraction:()=>kue,geo_token:()=>yue,greek:()=>Iue,group:()=>Mue,level:()=>U3,level_with_comparison:()=>xue,modified_expression:()=>_ue,primes:()=>Sue,radical:()=>Cue,simple_subscript:()=>Eue,terminal:()=>fue});function fue(r){return{type:"terminal",value:r}}function bue(r){return{type:"command",value:"\\"+r.trim()+" "}}function yue(r){return{type:"geo_token",index:r}}var dj={'"K':"<",'"K:':"\\leq ",$L:"\\parallel ",$O:"\\to ",$P:"\\perp ",".1":">",".1:":"\\geq ",".K":"=","@:.K":"\\cong ","/@:.K":"\\ncong ","@:@:":"\\approx","/$L":"\\nparallel ","/.K":"\\neq ","=":"=","@:":"\\sim ","/@:":"\\nsim "};function xue(r){let e=/[\^;]+/.exec(r),t=e?e.toString():"",o=r.slice(U3.length);return{type:"level_with_comparison",level:t,value:dj[o]}}function vue(r){return{type:"comparison",value:dj[r]}}function U3(r){return{type:"level",value:r}}function wue(){return U3("")}function Sue(r){return{type:"primes",value:r}}function kue(r,e){return{type:"fraction",numerator:r,denominator:e}}function _ue(r,e,t){return{type:"modified_expression",expression:r,under:e,over:t}}function Cue(r,e){return{type:"radical",value:r,index:e}}function Tue(r){return{type:"expression",value:r}}function Eue(r,e){return{type:"simple_subscript",base:r,subscript:e}}var $7={".&":"\\chi",".,&":"\\Chi",".,:":"\\Eta",".,?":"\\Theta",".,A":"\\Alpha",".,B":"\\Beta",".,D":"\\Delta",".,E":"\\Epsilon",".,F":"\\Phi",".,G":"\\Gamma",".,I":"\\Iota",".,K":"\\Kappa",".,L":"\\Lambda",".,M":"\\Mu",".,N":"\\Nu",".,O":"\\Omicron",".,P":"\\prod",".,R":"\\Rho",".,S":"\\sum",".,T":"\\Tau",".,U":"\\Upsilon",".,W":"\\Omega",".,X":"\\Xi",".,Y":"\\Psi",".,Z":"\\Zeta",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};function Iue(r){if($7.hasOwnProperty(r))return $7[r]+" ";throw new Error("Unknown Greek letter")}function Mue(...r){return Array.prototype.concat.apply([],r)}var Y3=Q7(),qM=Y3.parser.lexer,vb=Object.create(qM),Due=vb,lk=Y3.parser.terminals_,Ai=Y3.parser.symbols_;vb.setInput=function(r,e){this.delimiterStack=[],this.outputQueue=[],this.canAcceptPrimes=!1,qM.setInput.call(this,r,e)};vb.lex=function(){let r=-1;if(!this)return r;if(this.outputQueue.length)return this.outputQueue.shift();let e=qM.lex.call(this);for(;lk[e]==="UNKNOWN"||!this.canAcceptPrimes&&lk[e]==="PRIMES";)this.warn(),e=qM.lex.call(this);this.canAcceptPrimes=!0;let t,o,i=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(lk[e]){case"OPEN_FRAC":case"OPEN_MODEXP":this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"RADICAL_INDEX":i===Ai.RADICAL_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(i)),this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"OPEN_RADICAL":i===Ai.RADICAL_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"SLASH":for(t=!1;this.delimiterStack.length;)if(o=this.delimiterStack.pop()||-1,o===Ai.OPEN_FRAC){t=!0;break}else this.pushCloseTokens(o);t||this.pushOpenTokens(e),this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"CLOSE_FRAC":for(t=!1;this.delimiterStack.length;)if(o=this.delimiterStack.pop()||-1,o===Ai.SLASH){t=!0;break}else if(o===Ai.OPEN_FRAC){this.addMissingToken(Ai.SLASH),t=!0;break}else this.pushCloseTokens(o);if(!t)return this.warn(),this.canAcceptPrimes=!1,this.lex();break;case"CLOSE_RADICAL":for(t=!1;this.delimiterStack.length;)if(o=this.delimiterStack.pop()||-1,o===Ai.OPEN_RADICAL){t=!0;break}else if(o===Ai.RADICAL_INDEX){t=!0,this.addMissingToken(Ai.OPEN_RADICAL);break}else this.pushCloseTokens(o);t||this.pushOpenTokens(e);break;case"CLOSE_MODEXP":for(t=!1;this.delimiterStack.length;)if(o=this.delimiterStack.pop()||-1,o===Ai.OPEN_MODEXP){t=!0;break}else this.pushCloseTokens(o);t||this.pushOpenTokens(e);break;case"EOF":for(;this.delimiterStack.length;)o=this.delimiterStack.pop()||-1,this.pushCloseTokens(o);break}return this.outputQueue.push(e),r=this.outputQueue.shift()||-1,r};vb.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})};vb.addMissingToken=function(r){this.outputQueue.push(r),this.warn()};vb.pushCloseTokens=function(r){switch(lk[r]){case"OPEN_FRAC":this.addMissingToken(Ai.SLASH),this.addMissingToken(Ai.CLOSE_FRAC);break;case"SLASH":this.addMissingToken(Ai.CLOSE_FRAC);break;case"RADICAL_INDEX":this.addMissingToken(Ai.OPEN_RADICAL),this.addMissingToken(Ai.CLOSE_RADICAL);break;case"OPEN_RADICAL":this.addMissingToken(Ai.CLOSE_RADICAL);break;case"OPEN_MODEXP":this.addMissingToken(Ai.CLOSE_MODEXP);break}};vb.pushOpenTokens=function(r){switch(lk[r]){case"SLASH":this.addMissingToken(Ai.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(Ai.OPEN_FRAC),this.addMissingToken(Ai.SLASH);break;case"CLOSE_RADICAL":this.addMissingToken(Ai.OPEN_RADICAL);break;case"CLOSE_MODEXP":this.addMissingToken(Ai.OPEN_MODEXP);break}};var Aue=Q7();function Lue(r,e){e||(e={});let t=Aue.parser,o=Object.create(t);o.yy=I3,o.yy.warnOrError=n=>{o.parseError(n,{recoverable:!1})};let i=Object.create(t);i.yy=Wv({warnings:[]},I3),i.yy.warnOrError=n=>{i.yy.warnings.push(n)},i.lexer=Due,e.strict?t=o:t=i;try{return{isError:!1,value:t.parse(r),warnings:t.yy.warnings||[]}}catch(n){return{error:N3(n),isError:!0}}}function Bg(r,e){let t="",o=e,i="",n=!1,a="",s="",c=Pue(r);for(let d=0;d<r.length;d++){let p=r[d],u=d+1<r.length?r[d+1]:null;switch(p.type){case"terminal":let g=tj(r.slice(d));g.value!==""?(t+=g.value,d+=g.terminalCount-1,n=n||g.modified):p.value===" "?(n?(i=a,t+=sk(o,i),o=i):t+="\\ ",n=!1):(c[d]===KM?t+="\\left":c[d]===M3&&(t+="\\right"),t+=p.value);break;case"comparison":i="",t+=sk(o,i),o=i,n=!1,t+=p.value;break;case"level_with_comparison":t+=sk(o,p.level),o=p.level,n=!1,t+=p.value;break;case"command":let h=p.value.slice(1).trim();u&&u.type==="terminal"&&/[a-z]/.test(u.value)?(t+=h,n=!1):O3(h)?(t+="\\operatorname{"+h+"}",n=!0):(t+=p.value,n=!0),a=o;break;case"expression":t+=p.value;break;case"fraction":t+=Rue(p.numerator,p.denominator,o);break;case"geo_token":t+="\\token{"+p.index.value+"}";break;case"modified_expression":t+=Bg(p.expression,o)+" ",p.under&&(t+="_{"+Bg(p.under,o)+"}"),p.over&&(t+="^{"+Bg(p.over,o)+"}");break;case"radical":t+="\\sqrt",p.index&&(t+="["+Bg(p.index,o)+"]"),t+="{"+Bg(p.value,o)+"}";break;case"simple_subscript":o===""?(t+=p.base.value+"_{"+p.subscript.value+"}",p.base.type==="command"&&(n=!0,a=o)):t+=p.base.value+p.subscript.value;break;case"level":t+=sk(o,p.value,s),o=p.value,p.value==="^"&&s!==""&&(s="");break;case"primes":u&&u.type==="level"&&u.value===";"?s=p.value:o!==""?(t+=Array(p.value.length+1).join("\\prime "),s=""):(t+=p.value,s="");break}}return t+=sk(o,e)+s,t.replace(/([^\\])( )$/,"$1")}var KM=1,M3=-1,YM=0,C3=2;function Pue(r){let e=[],t=[];for(let o=0;o<r.length;o++){let i=r[o];if(Gue(i))e.push({direction:KM,index:o}),t.push(YM);else if(Vue(i)){for(;e.length&&e[e.length-1].direction===C3;)e.pop();if(e.length){let n=e.pop();if(n){let a=n.index;t[a]=KM,t.push(M3)}}else t.push(YM)}else if(Oue(i))if(e.length&&e[e.length-1].direction===C3){let n=e.pop();if(n){let a=n.index;t[a]=KM,t.push(M3)}}else e.push({direction:C3,index:o}),t.push(YM);else t.push(YM)}return t}function Gue(r){return r.type==="terminal"?/^(\\langle |\[|\(|\\{)$/.test(r.value):!1}function Vue(r){return r.type==="terminal"?/^(\\rangle |\]|\)|\\})$/.test(r.value):!1}function Oue(r){return r.type==="terminal"?/^(\\\||\|)$/.test(r.value):!1}function Rue(r,e,t){return"\\frac{"+Bg(r,t)+"}{"+Bg(e,t)+"}"}function sk(r,e,t){let o="",i,n,a,s=Math.max(r.length,e.length);for(i=0;i<s&&r[i]===e[i];i++);for(n=r.length-1;n>=i;n--)o+="}";for(a=i;a<e.length;a++)e[a]==="^"&&(t&&(o+=t),o+="^{"),e[a]===";"&&(o+="_{");return o}function Fue(r){return Bg(r,"")}function Nue(r,e){return e&&e.operatorNames?XM(e.operatorNames):$M(),Xv(Lue(r,e),Fue)}var B3=ej(),HM=B3.parser.lexer,wb=Object.create(HM),Uue=wb,WM=B3.parser.terminals_,An=B3.parser.symbols_;wb.setInput=function(r,e){this.delimiterStack=[],this.outputQueue=[],HM.setInput.call(this,r,e)};wb.lex=function(){let r=-1;if(this.outputQueue.length)return this.outputQueue.shift();let e=HM.lex.call(this);for(;WM[e]==="UNKNOWN";)this.warn(),e=HM.lex.call(this);let t,o,i=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(WM[e]){case"OPEN_FRAC":this.delimiterStack.push(e);break;case"OPEN_GROUP":this.delimiterStack.push(e);break;case"RADICAL_WITH_INDEX":i===An.RADICAL_WITH_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(i)),this.delimiterStack.push(e);break;case"RADICAL":i===An.RADICAL_WITH_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(e);break;case"OVER":for(t=!1;this.delimiterStack.length;)if(o=this.delimiterStack.pop()||-1,o===An.OPEN_FRAC){t=!0;break}else this.pushCloseTokens(o);t||this.pushOpenTokens(e),this.delimiterStack.push(e);break;case"CLOSE_FRAC":for(t=!1;this.delimiterStack.length;)if(o=this.delimiterStack.pop()||-1,o===An.OVER){t=!0;break}else if(o===An.OPEN_FRAC){this.outputQueue.push(An.OVER),t=!0;break}else this.pushCloseTokens(o);t||this.pushOpenTokens(e);break;case"CLOSE_GROUP":for(t=!1;this.delimiterStack.length;)if(o=this.delimiterStack.pop()||-1,o===An.OPEN_GROUP){t=!0;break}else this.pushCloseTokens(o);t||this.pushOpenTokens(e);break;case"CLOSE_RADICAL":for(t=!1;this.delimiterStack.length;)if(o=this.delimiterStack.pop()||-1,o===An.RADICAL||o===An.RADICAL_WITH_INDEX){t=!0;break}else this.pushCloseTokens(o);t||this.pushOpenTokens(e);break;case"EOF":for(;this.delimiterStack.length;)o=this.delimiterStack.pop()||-1,this.pushCloseTokens(o);break}return this.outputQueue.push(e),r=this.outputQueue.shift()||-1,r};wb.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})};wb.addMissingToken=function(r){this.outputQueue.push(r),this.warn()};wb.pushCloseTokens=function(r){switch(WM[r]){case"OPEN_FRAC":this.addMissingToken(An.OVER),this.addMissingToken(An.CLOSE_FRAC);break;case"OVER":this.addMissingToken(An.CLOSE_FRAC);break;case"OPEN_GROUP":this.addMissingToken(An.CLOSE_GROUP);break;case"RADICAL_WITH_INDEX":case"RADICAL":this.addMissingToken(An.CLOSE_RADICAL);break}};wb.pushOpenTokens=function(r){switch(WM[r]){case"OVER":this.addMissingToken(An.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(An.OPEN_FRAC),this.addMissingToken(An.OVER);break;case"CLOSE_GROUP":this.addMissingToken(An.OPEN_GROUP);break;case"CLOSE_RADICAL":this.addMissingToken(An.RADICAL);break}};var D3={};P3(D3,{basic_level:()=>Kue,bracketed_level:()=>zue,command:()=>Bue,expression:()=>Xue,fraction:()=>Hue,geo_token:()=>jue,greek:()=>Jue,group:()=>$ue,primes:()=>que,radical:()=>Wue,terminal:()=>Yue,to_number:()=>Zue});function Yue(r){return{type:"terminal",value:r}}function Bue(r){return{type:"command",value:r}}function Kue(r,e){return{type:"basic_level",level:r,value:e}}function zue(r,e,t,o){return{type:"bracketed_level",level:r,lbrack:e,value:t,rbrack:o}}function que(r){return{type:"primes",value:r.length>0?Array(r.length+1).join("'"):""}}function Hue(r,e){return{type:"fraction",numerator:r,denominator:e}}function Wue(r,e){return{type:"radical",value:r,index:e}}function jue(r){return{type:"geo_token",index:r}}function Xue(r){return{type:"expression",value:r}}function $ue(...r){return Array.prototype.concat.apply([],r)}var J7={",.&":"\\Chi",",.:":"\\Eta",",.?":"\\Theta",",.A":"\\Alpha",",.B":"\\Beta",",.D":"\\Delta",",.E":"\\Epsilon",",.F":"\\Phi",",.G":"\\Gamma",",.I":"\\Iota",",.K":"\\Kappa",",.L":"\\Lambda",",.M":"\\Mu",",.N":"\\Nu",",.O":"\\Omicron",",.P":"\\prod",",.R":"\\Rho",",.S":"\\sum",",.T":"\\Tau",",.U":"\\Upsilon",",.W":"\\Omega",",.X":"\\Xi",",.Y":"\\Psi",",.Z":"\\Zeta",".&":"\\chi",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};function Jue(r){if(J7.hasOwnProperty(r))return J7[r]+" ";throw new Error("Unknown Greek letter")}function Zue(r){let e="";for(let o of r)o==="4"?e+=".":o==="J"?e+="0":e+=o.charCodeAt(0)-64;return e}var Que=ej();function ehe(r,e){e||(e={});let t=Que.parser,o=Object.create(t);o.yy=D3;let i=Object.create(t);i.yy=Wv({warnings:[]},D3),i.lexer=Uue,e.strict?t=o:t=i;try{return{isError:!1,value:t.parse(r),warnings:t.yy.warnings||[]}}catch(n){return{error:N3(n),isError:!0}}}function xb(r,e){let t="",o=!1,i="",n=the(r);for(let a=0;a<r.length;a++){let s=r[a],c=a+1<r.length?r[a+1]:null;switch(s.type){case"terminal":let d=tj(r.slice(a));d.value!==""?(t+=d.value,a+=d.terminalCount-1):s.value===" "&&!o?t+="\\ ":(n[a]===zM?t+="\\left":n[a]===A3&&(t+="\\right"),t+=s.value),o=!1;break;case"command":let p=s.value.slice(1).trim();c&&c.type==="terminal"&&/[a-z]/.test(c.value)?(t+=p,o=!1):O3(p)?(t+="\\operatorname{"+p+"}",o=!0):(t+=s.value,o=!0);break;case"expression":t+=s.value;break;case"fraction":t+=nhe(s.numerator,s.denominator);break;case"radical":t+="\\sqrt",s.index&&(t+="["+xb(s.index)+"]"),t+="{"+xb(s.value)+"}";break;case"geo_token":t+="\\token{"+s.index.value+"}";break;case"basic_level":t+=ahe(s.level,s.value,i),s.level==="9"&&(i="");break;case"bracketed_level":t+=she(s.level,s.lbrack,s.value,s.rbrack,i),s.level==="9"&&(i="");break;case"primes":c&&(c.type==="basic_level"||c.type==="bracketed_level")&&c.level==="5"?i=s.value:e&&e!==""?(t+=Array(s.value.length+1).join("\\prime "),i=""):(t+=s.value,i="");break}}return t+=i,t.replace(/([^\\])( )$/,"$1")}var zM=1,A3=-1,BM=0,T3=2;function the(r){let e=[],t=[];for(let o=0;o<r.length;o++){let i=r[o];if(rhe(i))e.push({direction:zM,index:o}),t.push(BM);else if(ohe(i)){for(;e.length&&e[e.length-1].direction===T3;)e.pop();if(e.length){let n=e.pop();if(n){let a=n.index;t[a]=zM,t.push(A3)}}else t.push(BM)}else if(ihe(i))if(e.length&&e[e.length-1].direction===T3){let n=e.pop();if(n){let a=n.index;t[a]=zM,t.push(A3)}}else e.push({direction:T3,index:o}),t.push(BM);else t.push(BM)}return t}function rhe(r){return r.type==="terminal"?/^(\\langle |\[|\(|\\{)$/.test(r.value):!1}function ohe(r){return r.type==="terminal"?/^(\\rangle |\]|\)|\\})$/.test(r.value):!1}function ihe(r){return r.type==="terminal"?/^(\\\||\|)$/.test(r.value):!1}function nhe(r,e){return"\\frac{"+xb(r)+"}{"+xb(e)+"}"}function ahe(r,e,t){let o="",i="{"+xb(e,r)+"}";return r==="9"?o+=t+"^"+i:r==="5"&&(o+="_"+i),o}function she(r,e,t,o,i){let n="",a="{"+e+xb(t,r)+o+"}";return r==="9"?n+=i+"^"+a:r==="5"&&(n+="_"+a),n}var lhe=xb;function che(r,e){return e&&e.operatorNames?XM(e.operatorNames):$M(),Xv(ehe(r,e),t=>lhe(t,""))}var pj=` A1B'K2L@CIF/MSP"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=`,uj=10240;function dhe(r){return String.fromCharCode(uj+r)}function phe(r){return r.charCodeAt(0)-uj}function uhe(r){return pj[r]}function hhe(r){return pj.indexOf(r)}function ghe(r){let e="";for(let t of r)e+=dhe(hhe(t));return e}function hj(r){let e="";for(let t of r)e+=uhe(phe(t));return e}function mhe(r){return hj(r).replace(/[@-^]/g,e=>String.fromCharCode(e.charCodeAt(0)+32))}function fhe(r){let e="";if(r)for(let t of r){let o=t.charCodeAt(0);96<=o&&o<=127&&(o-=32,t=String.fromCharCode(o)),32<=o&&o<=95&&(t=ghe(t),o=t.charCodeAt(0)),10305<=o&&o<=10495&&(o=10240+(o-1024)%64,t=String.fromCharCode(o)),10240<=o&&o<=10304?e+=t:e+="\u2800"}return e}function bhe(r){for(let e=0;e<r.length;e++){let t=r.charCodeAt(e);if(t<10240||t>10304)return!1}return!0}function gj(r){if(!bhe(r))throw new Error("EncodingError: Expected input to be six-dot unicode braille characters.")}function K3(r,e){return gj(r),Nue(ma.toBrailleAscii(r),e)}function nh(r,e){return e&&e.operatorNames?XM(e.operatorNames):$M(),Xv(qpe(r),ma.coerceToSixDotCells)}function z3(r,e){return gj(r),che(ma.toBrailleAscii(r),e)}function ah(r,e){return e&&e.operatorNames?XM(e.operatorNames):$M(),Xv(oue(r),ma.coerceToSixDotCells)}var ma={coerceToSixDotCells:fhe,toBrailleAscii:hj,toExpandedBrailleAscii:mhe},yhe="1.0.3";var mj=1,fj=2,bj=4,yj=8,QM=15,xj=12,vj=3,wj=1,Sj=2,kj=3,_j=4,Sb=5,$v=6;function qg(r,e,t){let o=[],i=r.length;if(t===Sb)for(let n=0;n<i;n+=2){let a=e.mapX(r[n]),s=e.mapY(r[n+1]);o.push(a,s)}else if(t===$v)for(let n=0;n<i;n+=2){let a=e.mapX(r[n+1]),s=e.mapY(r[n]);o.push(a,s)}else if(t===wj)for(let n=0;n<r.length;n+=2){let a=r[n],s=r[n+1],c=e.mapX(s*Math.cos(a)),d=e.mapY(s*Math.sin(a));o.push(c,d)}else if(t===Sj)for(let n=0;n<r.length;n+=2){let a=r[n],s=r[n+1];s<0&&(s=0);let c=e.mapX(s*Math.cos(a)),d=e.mapY(s*Math.sin(a));o.push(c,d)}else if(t===kj)for(let n=0;n<r.length;n+=2){let a=r[n]*Math.PI/180,s=r[n+1],c=e.mapX(s*Math.cos(a)),d=e.mapY(s*Math.sin(a));o.push(c,d)}else if(t===_j)for(let n=0;n<r.length;n+=2){let a=r[n]*Math.PI/180,s=r[n+1];s<0&&(s=0);let c=e.mapX(s*Math.cos(a)),d=e.mapY(s*Math.sin(a));o.push(c,d)}return o}function Cj(r,e){return q3(r,e,QM,!0)}function Tj(r,e){return xhe(r,e,QM,!0)}function JM(r,e,t,o){let i=[],n,a,s,c;o?(a=r[0],s=r[1],n=2,c=e(a,s),c&&i.push(a,s)):(a=r[r.length-2],s=r[r.length-1],n=0,c=e(a,s));for(let d=n;d<r.length;d+=2){let p=a,u=s,g=c;a=r[d],s=r[d+1],c=e(a,s),!(!c&&!g)&&(c&&g&&i.push(a,s),c&&!g&&(i.push(...t(a,s,p,u)),i.push(a,s)),!c&&g&&i.push(...t(p,u,a,s)))}return i}function ZM(r,e,t,o){let i=[[]],n=0,a,s,c,d;o?(s=r[0],c=r[1],a=2,d=e(s,c),d&&i[n].push(s,c)):(s=r[r.length-2],c=r[r.length-1],a=0,d=e(s,c));for(let p=a;p<r.length;p+=2){let u=s,g=c,h=d;s=r[p],c=r[p+1],d=e(s,c),!(!d&&!h)&&(d&&h&&i[n].push(s,c),d&&!h&&(i[n].push(...t(s,c,u,g)),i[n].push(s,c)),!d&&h&&(i[n].push(...t(u,g,s,c)),n++,i[n]=[]))}return i.filter(p=>p.length>0)}var Ej=r=>function(e,t){return e>=r},Ij=r=>function(e,t){return e<=r},Mj=r=>function(e,t){return t>=r},Dj=r=>function(e,t){return t<=r},Aj=r=>function(e,t,o,i){let n=i-t;return[r,t+n*(r-e)/(o-e)]},Lj=r=>function(e,t,o,i){let n=i-t;return[r,t+n*(r-e)/(o-e)]},Pj=r=>function(e,t,o,i){let n=o-e;return[e+n*(r-t)/(i-t),r]},Gj=r=>function(e,t,o,i){let n=o-e;return[e+n*(r-t)/(i-t),r]};function q3(r,e,t,o){let i=r;return t&bj&&(i=JM(r,Ej(e.xmin),Aj(e.xmin),o)),t&fj&&(i=JM(i,Mj(e.ymin),Pj(e.ymin),o)),t&yj&&(i=JM(i,Ij(e.xmax),Lj(e.xmax),o)),t&mj&&(i=JM(i,Dj(e.ymax),Gj(e.ymax),o)),i}function xhe(r,e,t,o){let i=[r];return t&bj&&(i=__dcg_shared_module_exports__['Sa'](i.map(n=>ZM(n,Ej(e.xmin),Aj(e.xmin),o)),!0)),t&fj&&(i=__dcg_shared_module_exports__['Sa'](i.map(n=>ZM(n,Mj(e.ymin),Pj(e.ymin),o)),!0)),t&yj&&(i=__dcg_shared_module_exports__['Sa'](i.map(n=>ZM(n,Ij(e.xmax),Lj(e.xmax),o)),!0)),t&mj&&(i=__dcg_shared_module_exports__['Sa'](i.map(n=>ZM(n,Dj(e.ymax),Gj(e.ymax),o)),!0)),i}function Vj(r,e,t){let o=[],i=r[0],n=i+t,a=[];o.push(a);for(let s=0;s<r.length;s+=2){let c=r[s],d=r[s+1];if(d<0&&(d=0),c>=n){for(a=[],o.push(a),i=r[s-2],n=i;c>=n;)n+=t;s-=4}else a.push(c,d)}if(e===0)for(let s=0;s<o.length;s++)o[s].push(0,0);else{let s=t/16,c=e;for(let d=0;d<o.length;d++){let p=o[d];i=p[0],n=p[p.length-2];for(let u=n;u>i;u-=s)p.push(u,c);p.push(i,c)}}return o}function H3(r,e){return r=r.slice(),r.push(r[r.length-2],e),r.push(r[0],e),[r]}function ck(r,e,t){switch(r){case 1:return $v;case 8:case 5:case 2:return Sb;case 6:return t.degreeMode?e?_j:kj:e?Sj:wj}}function W3(){return{type:"folder",id:__dcg_shared_module_exports__['Zd'],title:"geometry",secret:!0}}var eD={version:xc,randomSeed:"",graph:{viewport:{xmin:-10,ymin:-13.25,xmax:10,ymax:13.25},showGrid:!1,product:"geometry-calculator",showXAxis:!1,showYAxis:!1,degreeMode:!0},expressions:{list:[W3(),{id:"1",type:"expression"}]}};function whe(r){typeof r.min=="number"&&(r.min=""+r.min),typeof r.max=="number"&&(r.max=""+r.max),typeof r.step=="number"&&(r.step=""+r.step)}function She(r){r.slider&&whe(r.slider),typeof r.id!="string"&&(r.id=""+r.id)}function khe(r,e){let t=_he(r)+1,o={},i,n;for(let a of r)if(She(a),a.type==="folder")i=a.id,o[a.id]&&(a.id=""+t,t+=1),n=a.id,o[a.id]=!0,a.hasOwnProperty("folderId")&&delete a.folderId;else{if(i!==void 0&&a.folderId===i?a.folderId=n:(a.folderId&&(a.folderId=""),i=void 0,n=void 0),a.type==="table"&&Array.isArray(a.columns))for(let s of a.columns)o[s.id]&&(s.id=""+t,t+=1),o[s.id]=!0;o[a.id]&&(a.id=""+t,t+=1),o[a.id]=!0}e==="geometry-calculator"&&!o[__dcg_shared_module_exports__['Zd']]&&r.push(W3())}function Oj(r,e){let t=parseFloat(e);return t!==Math.floor(t)?r:Math.max(r,t)}function _he(r){let e=0;for(let t of r)if(e=Oj(e,t.id),t.type==="table"&&Array.isArray(t.column))for(let o of t.columns)Oj(e,o.id);return e}function tD(r){var i,n;let e=__dcg_shared_module_exports__['f'](r),t=e.graph&&e.graph.product,o=e.expressions.list;return Array.isArray(o)&&khe(o,t),(i=e.graph)!=null&&i.complex&&((n=e.graph)!=null&&n.degreeMode)&&(e.graph.degreeMode=!1),e}var j3={NONE:"NONE",POSITIVE:"POSITIVE",BOTH:"BOTH"},Che={expression:!0,table:!0,image:!0,folder:!0,text:!0};function The(r){if(r.type){if(Che.hasOwnProperty(r.type))return r.type;throw new Error("Invalid item type: '"+r.type+"'.")}return r.text!==void 0?"text":r.columns!==void 0||r.headings!==void 0?"table":"expression"}function rD(r){return r.replace(/\\(total|length|mean|median|quantile|stdev|stddev|stdDev|stdevp|stddevp|stdDevP|var|variance|cov|corr|ceil|floor|round|abs|mod|lcm|mcm|mcd|nCr|nPr|signum|sign|arcsinh|arccosh|arctanh|arccsch|arcsech|arccoth|arccsc|arcsec|arccot)/g,"\\operatorname{$1}")}function Ehe(r){let e={};for(let t in r)r.hasOwnProperty(t)&&(t==="latex"?e[t]=rD(r[t]):t==="values"?e[t]=r[t].map(rD):e[t]=r[t]);return e}function Ihe(r){let e=The(r),t={},o;switch(e){case"expression":for(o in r)r.hasOwnProperty(o)&&(o==="latex"?t[o]=rD(r[o]):t[o]=r[o]);return t.type=e,t;case"table":for(o in r)r.hasOwnProperty(o)&&(o==="columns"?t[o]=r[o].map(Ehe):t[o]=r[o]);return t.type=e,t;case"image":for(o in r)r.hasOwnProperty(o)&&(o==="width"||o==="height"||o==="x"||o==="y"?t[o]=rD(r[o]):t[o]=r[o]);return t.type=e,t;case"text":case"folder":for(o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);return t.type=e,t}}var Rj={none:j3.NONE,both:j3.BOTH,positive:j3.POSITIVE};function Mhe(r){let e={};for(let t in r)r.hasOwnProperty(t)&&(t==="xAxisArrows"||t==="yAxisArrows"||(e[t]=r[t]));return e.xAxisArrowMode=Rj[r.xAxisArrows||"none"],e.yAxisArrowMode=Rj[r.yAxisArrows||"none"],e}function Fj(r){if(r.version)throw new Error("Unexpected version: "+r.version);let e={};return e.graph=Mhe(r.graph),e.expressions={list:r.expressions.list.map(Ihe)},e.version=0,e}function oD(r){return r.replace(/\\(sech|csch)/g,"\\operatorname{$1}")}function Dhe(r){let e={};for(let t in r)r.hasOwnProperty(t)&&(t==="latex"?e[t]=oD(r[t]):t==="values"?e[t]=r[t].map(oD):e[t]=r[t]);return e}function Ahe(r){let e=r.type,t={},o;switch(e){case"expression":for(o in r)r.hasOwnProperty(o)&&(o==="latex"?t[o]=oD(r[o]):t[o]=r[o]);return t;case"table":for(o in r)r.hasOwnProperty(o)&&(o==="columns"?t[o]=r[o].map(Dhe):t[o]=r[o]);return t;case"image":for(o in r)r.hasOwnProperty(o)&&(o==="width"||o==="height"||o==="x"||o==="y"?t[o]=oD(r[o]):t[o]=r[o]);return t;case"text":case"folder":for(o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);return t;default:throw new Error("Unexpected expression type: "+e)}}function Nj(r){if(r.version)throw new Error("Unexpected version: "+r.version);let e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(Ahe)},e.version=1,e}var Lhe=2,Phe="#C0504D",Ghe="#4F81BD",Vhe="#9BBB59",Ohe="#8064A2",Rhe="#F79646",Fhe="#000000";function Uj(r){switch(r){case Phe:return __dcg_shared_module_exports__['zd'].RED;case Ghe:return __dcg_shared_module_exports__['zd'].BLUE;case Vhe:return __dcg_shared_module_exports__['zd'].GREEN;case Ohe:return __dcg_shared_module_exports__['zd'].PURPLE;case Rhe:return __dcg_shared_module_exports__['zd'].ORANGE;case Fhe:return __dcg_shared_module_exports__['zd'].BLACK;default:return r}}function Nhe(r){let e={};for(let t in r)r.hasOwnProperty(t)&&(t==="color"?e[t]=Uj(r[t]):e[t]=r[t]);return e}function Uhe(r){let e=r.type,t={},o;switch(e){case"expression":for(o in r)r.hasOwnProperty(o)&&(o==="color"?t[o]=Uj(r[o]):t[o]=r[o]);return t;case"table":for(o in r)r.hasOwnProperty(o)&&(o==="columns"?t[o]=r[o].map(Nhe):t[o]=r[o]);return t;case"image":case"text":case"folder":for(o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);return t;default:throw new Error("Unexpected expression type: "+e)}}function Yj(r){if(r.version>1)throw new Error("Unexpected version: "+r.version);let e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(Uhe)},e.version=Lhe,e}function X3(r){if(typeof r=="string")return r;if(r===void 0)return"";let e=r+"";return e=e.replace(/1e\+?([-\d]+)/,"10^{$1}"),e=e.replace(/([-\d\.]+)e\+?([-\d]+)/,"$1\\cdot 10^{$2}"),e}function Yhe(r){let e=r.type,t={},o;switch(e){case"expression":for(o in r)r.hasOwnProperty(o)&&(o==="sliderMax"||o==="sliderMin"||o==="sliderInterval"?t[o]=X3(r[o]):o==="domain"?t[o]={max:X3(r[o].max),min:X3(r[o].min)}:t[o]=r[o]);return t.hasOwnProperty("sliderMin")&&t.sliderInterval===void 0&&(t.sliderInterval=""),t;case"image":case"table":case"text":case"folder":for(o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);return t;default:throw new Error("Unexpected expression type: "+e)}}function Bj(r){if(r.version>2)throw new Error("Unexpected version: "+r.version);let e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(Yhe)},e.version=3,e}function Kj(r){switch(r){case"point":return"POINT";case"cross":return"CROSS";case"open":return"OPEN";case"normal":return"SOLID";case"dashed":return"DASHED";case"dotted":return"DOTTED";default:return r}}function Bhe(r){let e={};for(let t in r)r.hasOwnProperty(t)&&(t==="style"?e[t]=Kj(r[t]):e[t]=r[t]);return e}function Khe(r){let e=r.type,t={},o;switch(e){case"expression":for(o in r)r.hasOwnProperty(o)&&(o==="style"?t[o]=Kj(r[o]):t[o]=r[o]);return t;case"table":for(o in r)r.hasOwnProperty(o)&&(o==="columns"?t[o]=r[o].map(Bhe):t[o]=r[o]);return t;case"image":case"text":case"folder":for(o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);return t;default:throw new Error("Unexpected expression type: "+e)}}function zj(r){if(r.version!==3)throw new Error("Unexpected version: "+r.version);let e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(Khe)},e.version=4,e}function zhe(r){let e={},t;for(let o in r)if(r.hasOwnProperty(o))switch(t=r[o],o){case"showAxes":e.showXAxis=t,e.showYAxis=t;break;case"showLabels":e.xAxisNumbers=t,e.yAxisNumbers=t,e.polarNumbers=t;break;case"labelXMode":e.xAxisStep=t==="pi"?Math.PI:0;break;case"labelYMode":e.yAxisStep=t==="pi"?Math.PI:0;break;default:e[o]=t}return e}function qhe(r){let e={};for(let t in r)r.hasOwnProperty(t)&&(t==="showPoints"||t==="showLine"||(e[t]=r[t]));return(r.showPoints!==void 0||r.showLine!==void 0)&&(r.showPoints&&r.showLine?e.columnMode="POINTS_AND_LINES":r.showPoints?e.columnMode="POINTS":r.showLine?e.columnMode="LINES":(e.hidden=!0,e.columnMode="POINTS")),e}function Hhe(r){let e=r.type,t={},o;switch(e){case"expression":r.hidden===void 0?r.hasOwnProperty("graphed")?t.hidden=!r.graphed:r.hasOwnProperty("userRequestedGraphing")?t.hidden=r.userRequestedGraphing==="never":t.hidden=!1:t.hidden=r.hidden;for(o in r)if(r.hasOwnProperty(o)&&!(o==="graphed"||o==="userRequestedGraphing"||o==="hidden")&&o!=="slider"){if(o==="color"){typeof r.color=="object"?t.color=r.color.value:t.color=r.color;continue}if(o==="style"){t.style=r.style==="normal"?"SOLID":r.style;continue}if(o==="sliderInterval"){t.sliderInterval=r.sliderInterval==="undefined"?"":r.sliderInterval;continue}t[o]=r[o]}return t;case"table":if(r.headings||r.columns){let i=r.headings?r.headings:r.columns;if(t.columns=i.map(qhe),r.rows)for(let n=0;n<t.columns.length;n++){let a=t.columns[n];a.values=[];for(let s=0;s<r.rows.length;s++)a.values.push(r.rows[s][n])}}for(o in r)r.hasOwnProperty(o)&&(o==="rows"||o==="headings"||o==="columns"||(t[o]=r[o]));return t;case"image":case"text":case"folder":for(o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);return t;default:throw new Error("Unexpected expression type: "+e)}}function qj(r){if(r.version!==4)throw new Error("Unexpected version: "+r.version);return{version:5,graph:zhe(r.graph),expressions:{list:r.expressions.list.map(Hhe)}}}var Whe=6;function jhe(r){return r.length<2?!1:r[0]==="`"&&r[r.length-1]==="`"}function Xhe(r){if(jhe(r))return{raw:r,parts:[r]};let t="({"+["[a-zA-Z][0-9]*","[a-zA-Z]_[a-zA-Z0-9]+","[a-zA-Z]_\\{[a-zA-Z0-9]+\\}"].join("})|({")+"})",o=new RegExp(t,"g"),i=[],n=0,a=0,s;for(;s=o.exec(r);){a=s.index,a>n&&i.push(r.substr(n,a-n));let c=s[0],d=c.replace(/[{}\$]/g,"").replace(/^([a-zA-Z])([0-9]+)$/,"$1_$2");i.push({symbol:d,str:c}),n=s.index+c.length}return n<r.length&&i.push(r.substr(n)),{raw:r,parts:i}}function $he(r){let e={};for(let t in r)if(r.hasOwnProperty(t)&&t!=="style")if(t==="values"&&(e[t]=r[t].map(o=>o?""+o:"")),t==="columnMode"&&!r.hasOwnProperty("points")&&!r.hasOwnProperty("lines"))switch(r[t]){case"LINES":e.points=!1,e.lines=!0;break;case"POINTS_AND_LINES":e.points=!0,e.lines=!0;break;default:e.points=!0,e.lines=!1}else e[t]=r[t];return e.hasOwnProperty("pointStyle")||(e.pointStyle="POINT"),e.hasOwnProperty("lineStyle")||(e.lineStyle="SOLID"),e.id=""+e.id,e}var Hj={sliderMin:"min",sliderMax:"max",sliderInterval:"step",sliderHardMin:"hardMin",sliderHardMax:"hardMax",sliderAnimationPeriod:"animationPeriod",sliderLoopMode:"loopMode",sliderPlayDirection:"playDirection",sliderIsPlaying:"isPlaying"};function Jhe(r){let e=Xhe(r),t="";return __dcg_shared_module_exports__['Fa'](e.parts,o=>{t+=typeof o=="object"&&o.str?"$"+o.str:o}),t}function Zhe(r,e){let t=r.latex.split("=");if(t.length!==2)return;let o=eo(t[1],e);if(!isFinite(o))return;let i=r.slider.hardMin?eo(r.slider.min||"-10",e):void 0,n=r.slider.hardMax?eo(r.slider.max||"10",e):void 0,a=r.slider.step?eo(r.slider.step,e):void 0,s=__dcg_shared_module_exports__['Hc']({target:o,step:a,hardMin:i,hardMax:n});s.min||(delete r.slider.hardMin,delete r.slider.min),s.max||(delete r.slider.hardMax,delete r.slider.max),s.step||delete r.slider.step}function Qhe(r,e,t,o){let i=r.type,n={},a;switch(i){case"folder":for(a in r)r.hasOwnProperty(a)&&(a==="memberIds"||(n[a]=r[a]));break;case"expression":for(a in r)if(r.hasOwnProperty(a)){if(a==="style"&&!r.hasOwnProperty("pointStyle")&&!r.hasOwnProperty("lineStyle")){let s=r[a];__dcg_shared_module_exports__['Ka'](["POINT","OPEN","CROSS"],s)?(n.pointStyle=s,n.lineStyle="SOLID"):__dcg_shared_module_exports__['Ka'](["SOLID","DASHED","DOTTED"],s)?(n.pointStyle="POINT",n.lineStyle=s):(n.pointStyle="POINT",n.lineStyle="SOLID");continue}Hj.hasOwnProperty(a)?(n.slider=n.slider||{},n.slider[Hj[a]]=r[a]):n[a]=r[a],r.label&&(n.label=Jhe(r.label))}n.latex&&n.slider&&!n.slider.isPlaying&&Zhe(n,o),n.hasOwnProperty("fillOpacity")||(n.fillOpacity=.4),n.label===!1&&(n.label=""),n.labelSize||(n.labelSize="medium"),n.labelOrientation||(n.labelOrientation="default"),n.verticalLabel||(n.verticalLabel=!1),n.interactiveLabel||(n.interactiveLabel=!1);break;case"image":for(a in r)!r.hasOwnProperty(a)||a==="x"||a==="y"||(n[a]=r[a]);n.center="\\left("+(r.x||"0")+","+(r.y||"0")+"\\right)",n.angle=r.angle||"0",n.foreground=!!n.foreground;break;case"text":for(a in r)r.hasOwnProperty(a)&&(n[a]=r[a]);break;case"table":for(a in r)r.hasOwnProperty(a)&&(a==="columns"?n[a]=r[a].map($he):n[a]=r[a]);break;default:throw new Error("Unexpected expression type: "+i)}if(n.id=""+n.id,r.type==="folder")e.folderId=n.id,e.memberIds=r.memberIds,n.folderId="";else{let s=t[n.id];e.memberIds&&e.memberIds[s]?n.folderId=e.folderId:(n.folderId="",e.folderId=void 0,e.memberIds=void 0)}return n}function ege(r){let e=0,t=/^[0-9]+$/;for(let o=r.length-1;o>=0;o--){let i=r[o],n=i.id,a;if(t.test(n)&&(a=parseInt(n,10),a>e&&(e=a)),i.type==="table"&&i.columns)for(let s=i.columns.length-1;s>=0;s--)n=i.columns[s].id,t.test(n)&&(a=parseInt(n,10),a>e&&(e=a))}return e+1}function Wj(r){if(r.version!==5)throw new Error("Unexpected version: "+r.version);let e=!!(r.graph&&r.graph.degreeMode),t=r.expressions.list,o=-1,i={},n={},a={};return{version:Whe,graph:r.graph,expressions:{list:t.map(c=>(i[c.id]?(o===-1&&(o=ege(t)),n[o]=c.id,c=__dcg_shared_module_exports__['f'](c),c.id=o+"",o+=1):n[c.id]=c.id,i[c.id]=!0,Qhe(c,a,n,e)))}}}function $3(r){if(r.version!==6)throw new Error(`Unexpected version: ${r.version}`);let e=r.expressions.list.map(t=>{if(t.type==="expression"&&t.domain){let o={...t,parametricDomain:{min:t.domain.min,max:t.domain.max}};return delete o.domain,o}return t});return{version:7,randomSeed:r.randomSeed,graph:r.graph,expressions:{list:e}}}function tge(r){return r.length===1?`0${r}`:r}function Cp(){let r=new Uint8Array(16);if(typeof crypto!="undefined")crypto.getRandomValues(r);else if(typeof msCrypto!="undefined")msCrypto.getRandomValues(r);else return __dcg_shared_module_exports__['g'](Date.now().toString()+Math.random().toString());return Array.prototype.slice.call(r).map(t=>tge(t.toString(16))).join("")}function J3(r){let e=r.split("_");return e.length===2&&e[1]&&e[1].length===1?e[0]+"_{"+e[1]+"}":r}function jj(r){return r=__dcg_shared_module_exports__['f'](r),!r.rules&&(r.assignment||r.expression)&&(r.rules=[{id:"1",assignment:r.assignment||"",expression:r.expression||""}]),delete r.assignment,delete r.expression,r}function dk(r){let e=/\\operatorname(?:\{stdev\}p|\{stddev\}p|\{stdDev\}P|\{var\}iance)/g;return r.replace(e,t=>{switch(t){case"\\operatorname{stdev}p":return"\\operatorname{stdevp}";case"\\operatorname{stddev}p":return"\\operatorname{stddevp}";case"\\operatorname{stdDev}P":return"\\operatorname{stdDevP}";case"\\operatorname{var}iance":return"\\operatorname{variance}";default:return""}})}function rge(r){return r.columns?{...r,columns:r.columns.map(oge)}:r}function oge(r){let{latex:e,values:t}=r,o={...r};return e&&(o.latex=dk(e),o.latex=J3(o.latex)),t&&(o.values=t.map(i=>i?dk(i):"")),o}function Z3(r){if(r.version!==7)throw new Error(`Unexpected version: ${r.version}`);let e=r.expressions.list.map(t=>{if(t.type==="image"){let o={...t,opacity:""};t.hasOwnProperty("stringOpacity")?o.opacity=t.stringOpacity:t.hasOwnProperty("opacity")?o.opacity=t.opacity+"":delete o.opacity,t.clickableInfo&&(o.clickableInfo=jj(t.clickableInfo)),delete o.stringOpacity;for(let i in t)if(i==="x"||i==="y"||i==="width"||i==="height"){let n=t[i];n&&(o[i]=dk(n))}return o}else if(t.type==="expression"){let o={...t,fillOpacity:"",lineStyle:"SOLID"};if(t.lineStyle==="SINGLE_PIXEL"?o.lineWidth="1":t.hasOwnProperty("lineStyle")?o.lineStyle=t.lineStyle:delete o.lineStyle,o.hasOwnProperty("lineWidth")||(o.lineWidth=""),o.hasOwnProperty("lineOpacity")||(o.lineOpacity=""),o.hasOwnProperty("pointOpacity")||(o.pointOpacity=""),o.hasOwnProperty("pointSize")||(o.pointSize=""),o.hasOwnProperty("colorLatex")||(o.colorLatex=""),typeof t.latex=="string"&&(o.latex=dk(t.latex)),t.latex&&(o.latex=dk(t.latex)),t.hasOwnProperty("stringFillOpacity")?o.fillOpacity=t.stringFillOpacity:t.hasOwnProperty("fillOpacity")?o.fillOpacity=t.fillOpacity+"":delete o.fillOpacity,o.slider&&t.slider&&t.slider.newLoopMode&&(o.slider=__dcg_shared_module_exports__['f'](o.slider),o.slider.loopMode=t.slider.newLoopMode,delete o.slider.newLoopMode),o.residualVariable&&(o.residualVariable=J3(o.residualVariable)),o.regressionParameters){o.regressionParameters={};for(let i in t.regressionParameters){let n=J3(i),a=t.regressionParameters[i];o.regressionParameters[n]=a}}return t.clickableInfo&&(o.clickableInfo=jj(t.clickableInfo)),o}else if(t.type==="table")return rge(t);return t});return{version:8,randomSeed:r.randomSeed||Cp(),graph:r.graph,expressions:{list:e}}}function ige(r,e,t){if(r.verticalLabel)switch(delete e.verticalLabel,t?e.labelAngle="90":e.labelAngle="\\frac{\\pi}{2}",r.labelOrientation){case"above":e.labelOrientation="right";break;case"below":e.labelOrientation="left";break;case"left":e.labelOrientation="above";break;case"right":e.labelOrientation="below";break}r.extendedLabelOrientation&&(e.labelOrientation=r.extendedLabelOrientation,delete e.extendedLabelOrientation)}function nge(r,e){if(r.vizProps)switch(r.vizProps.dotplotSize){case"small":e.pointSize="9";break;case"large":e.pointSize="20";break}if(r.vizProps){let t={...r.vizProps};delete t.dotplotSize,Object.keys(t).length?e.vizProps=t:delete e.vizProps}}function Q3(r){return r.filter(({assignment:e,expression:t})=>!!e&&!!t)}function eN(r){return r.map(({assignment:e,expression:t})=>`${e}\\to ${t}`).join(",")||""}function tN(r){let e=JSON.stringify(r),t=/_(\d)|_\{(\d+)\}/g,o,i={};for(;(o=t.exec(e))!==null;){let n=o[1]!==void 0?o[1]:o[2];i[n]=!0}return i}function rN(r,e){for(let t=e+1;;t++)if(!r[t])return t}function Xj(r){let e=JSON.stringify(r),t=/"(\d+)"/g,o,i={};for(;(o=t.exec(e))!==null;){let n=o[1]!==void 0?o[1]:o[2];i[n]=!0}return i}function $j(r,e){for(let t=e+1;;t++)if(!r[t])return t}function age(r){if(/^\d+$/.test(r)){let e=parseInt(r,10);return e===0?"\\infty":""+Math.round(1e3/e)}else return`\\frac{1000}{${r}}`}function sge(r,e){let t={handlerLatex:r,playing:!0,open:!0};return e!==void 0&&(t.minStepLatex=age(e)),t}function oN(r){if(r.version!==8)throw new Error(`Unexpected version: ${r.version}`);let e=!1;r.graph&&r.graph.degreeMode&&(e=!0);let t=r.expressions.ticker||yv,o=0,i,n=0,a,s=[];for(let c of r.expressions.list)switch(c.type){case"expression":{let d={...c};ige(c,d,e),nge(c,d);let p;if(c.clickableInfo&&c.clickableInfo.rules){let{rules:u,...g}=c.clickableInfo,h=g,b=Q3(u),v=eN(b);if(b.length>1){i||(i=tN(r)),o=rN(i,o),a||(a=Xj(r)),n=$j(a,n);let T=`A_{${o}}`;h.latex=T,p={type:"expression",id:""+n,latex:`${T}=${v}`},c.folderId!==void 0&&(p.folderId=c.folderId)}else h.latex=v;d.clickableInfo=h}d.clickableInfo&&d.clickableInfo.enabled&&d.hidden&&(d.clickableInfo.enabled=!1),s.push(d),p&&s.push(p);break}case"image":{if(c.clickableInfo&&c.clickableInfo.rules){let d={...c},{rules:p,...u}=c.clickableInfo,g=u,h=Q3(p),b=eN(h),v;if(h.length>1){i||(i=tN(r)),o=rN(i,o),a||(a=Xj(r)),n=$j(a,n);let T=`A_{${o}}`;g.latex=T,v={type:"expression",id:""+n,latex:`${T}=${b}`},c.folderId!==void 0&&(v.folderId=c.folderId)}else g.latex=b;d.clickableInfo=g,s.push(d),v&&s.push(v)}else s.push(c);break}case"simulation":{let d;if(c.clickableInfo&&c.clickableInfo.rules){let u=Q3(c.clickableInfo.rules);d=eN(u)}else d="";if(c.isPlaying&&d!==""){i||(i=tN(r)),o=rN(i,o);let u=`A_{${o}}`;d=`${u}=${d}`,t=sge(u,c.fps)}let p={type:"expression",id:c.id,latex:d};c.folderId!==void 0&&(p.folderId=c.folderId),s.push(p);break}default:s.push(c);break}return{version:9,randomSeed:r.randomSeed||Cp(),graph:r.graph,expressions:{list:s,ticker:t}}}function Jj(r){r.clickableInfo&&(r.description===void 0&&r.clickableInfo.description!==void 0&&(r.description=r.clickableInfo.description),delete r.clickableInfo.description,Object.keys(r.clickableInfo).length===0&&delete r.clickableInfo)}function lge(r){switch(r.labelSize){case"small":r.labelSize="0.85";break;case"medium":r.labelSize="1";break;case"large":r.labelSize="1.35";break;default:break}}function cge(r){let e=0,t=/^[0-9]+$/;for(let o=r.length-1;o>=0;o--){let i=r[o],n=i.id;if(t.test(n)){let a=parseInt(n,10);a>e&&(e=a)}if(i.type==="table"&&i.columns){for(let a=i.columns.length-1;a>=0;a--)if(n=i.columns[a].id,!!n&&t.test(n)){let s=parseInt(n,10);s>e&&(e=s)}}}return e}function iN(r){if(r.version!==9)throw new Error(`Unexpected version: ${r.version}`);let e=[],t={},o=cge(r.expressions.list);for(let n of r.expressions.list)switch(n.type){case"expression":{let c={...n};Jj(c),lge(c),e.push(c);break}case"image":{let c={...n};Jj(c);let d=c.description;(d===void 0||d==="")&&c.draggable&&c.center!==void 0&&c.center!==""&&(t[c.center]===void 0?t[c.center]=[c]:t[c.center].push(c)),e.push(c);break}case"table":let a={...n};if(!a.columns||!Fa(a.columns[0].latex)){e.push(a);break}let s=a.columns[0].latex;for(let c=1;c<a.columns.length;c++){let d=a.columns[c];if(!d.lines||!mc(d.latex,s))continue;delete d.lines,o++;let p={type:"expression",latex:"y="+ZE(d.latex,s,"x"),id:`${o}`};d.color&&(p.color=d.color),d.lineStyle&&(p.lineStyle=d.lineStyle),d.lineWidth&&(p.lineWidth=d.lineWidth),d.lineOpacity&&(p.lineOpacity=d.lineOpacity),e.push(p)}e.push(a);break;default:e.push(n);break}for(let n of e){if(n.type!=="expression"||n.latex===void 0||n.latex===""||n.latex.indexOf("=")===-1||n.dragMode===void 0||n.dragMode==="NONE"||n.label===void 0||n.label==="")continue;let a=n.latex.slice(0,n.latex.indexOf("=")),s=t[a];if(s!==void 0)for(let c of s)c.description=n.label}return{...r,version:10,expressions:{...r.expressions,list:e}}}function dge(r){let e=/[ \\]*=[ \\]*\\operatorname\{(dilation|reflection|rotation|translation)\}\\left\(/g;return r.type!=="expression"||!r.latex||(r.latex=r.latex.replace(e,(t,o)=>{switch(o){case"dilation":return"\\left(x\\right)=\\operatorname{dilate}\\left(x,";case"rotation":return"\\left(x\\right)=\\operatorname{rotate}\\left(x,";case"reflection":return"\\left(x\\right)=\\operatorname{reflect}\\left(x,";case"translation":return"\\left(x\\right)=\\operatorname{translate}\\left(x,";default:return""}})),r}function pge(r,e){var t;if(r.type==="image"&&r.folderId&&!r.draggable&&!((t=r.clickableInfo)!=null&&t.enabled)&&e.has(r.folderId)&&r.disableGraphInteractions!==!1){let o={...r};return o.disableGraphInteractions=!0,o}else return r}function uge(r){var a;if(r.type!=="expression")return r;let e={...r},t=(a=(r.latex||"").split("=")[0])==null?void 0:a.trim(),o=r.parametricDomain3Du,i=r.parametricDomain3Dv,n=r.parametricDomain;return t==="r"||(t==="z"?(o&&(e.parametricDomain3Dr={...o}),i&&(e.polarDomain={...i})):t==="\\rho"?(o&&(e.polarDomain={...o}),i&&(e.parametricDomain3Dphi={...i})):r.polarDomain||n&&(e.parametricDomain3Du={...n},e.parametricDomain3Dv={...n})),e}function nN(r){if(r.version!==10)throw new Error(`Unexpected version: ${r.version}`);let e={...r.graph};delete e.projectorMode;let t=r.expressions.list,o=[],i=new Set;for(let a of t)a.type==="folder"&&a.collapsed&&i.add(a.id);for(let a of t)switch(a.type){case"expression":{if((e==null?void 0:e.product)==="geometry-calculator"){let s={...a};dge(s),o.push(s)}else if((e==null?void 0:e.product)==="graphing-3d"){let s=uge(a);o.push(s)}else o.push(a);break}case"image":{o.push(pge(a,i));break}default:o.push(a)}let n={...r.expressions,list:o};return{...r,version:11,graph:e,expressions:n}}var Zv="#388c46",Qv="#348543";function aN(r){var i,n,a;if(r.version!==11)throw new Error(`Unexpected version: ${r.version}`);let e=(i=r.includeFunctionParametersInRandomSeed)!=null?i:!1,t={...r.expressions},o=[];for(let s of t.list)switch(s.type){case"expression":{let{__stashed_V12PointStyle:c,...d}=s,p=d;c&&(p.pointStyle=c),((n=r.graph)==null?void 0:n.product)==="graphing-3d"&&!r.doNotMigrate3dLineWidthZero&&(p=hge(p)),r.doNotMigrateMovablePointStyle||(p=mge(p)),s.color===Zv&&(p.color=Qv),o.push(p)}break;case"table":{let c={...s,columns:(a=s.columns)==null?void 0:a.map(d=>{let{__stashed_V12PointStyle:p,...u}=d,g=u;return p&&(g.pointStyle=p),d.color===Zv&&(g.color=Qv),g})};c.regression&&c.regression.color===Zv&&(c.regression={...c.regression,color:Qv}),r.doNotMigrateMovablePointStyle||(c=gge(c)),o.push(c)}break;default:o.push(s)}return{...r,expressions:{...t,list:o},includeFunctionParametersInRandomSeed:e,version:12}}function hge(r){return r.type!=="expression"||r.lineWidth!=="0"?r:{...r,lineWidth:"0.1"}}function Zj(r){return r==="X"||r==="Y"||r==="XY"}function Qj(r){return r!=="POINT"&&r!==void 0}function eX(r){switch(r){case"POINT":case"CROSS":case"OPEN":case void 0:return!0;default:return!1}}function gge(r){var e;return{...r,columns:(e=r.columns)==null?void 0:e.map(t=>(t={...t},Zj(t.dragMode)&&Qj(t.pointStyle)&&(t.pointStyle="POINT"),t))}}function mge(r){return r.type!=="expression"?r:Zj(r.dragMode)&&Qj(r.pointStyle)?{...r,pointStyle:"POINT"}:r}function fge(r){let e;return eX(r.pointStyle)?e={...r,pointStyle:r.pointStyle}:e={...r,pointStyle:void 0,__stashed_V12PointStyle:r.pointStyle},e.pointStyle===void 0&&delete e.pointStyle,e}function bge(r){let e;return eX(r.pointStyle)?e={...r,pointStyle:r.pointStyle}:e={...r,pointStyle:void 0,__stashed_V12PointStyle:r.pointStyle},e.pointStyle===void 0&&delete e.pointStyle,e}function yge(r){var e;return r.type==="expression"?fge(r):r.type==="table"?{...r,columns:(e=r.columns)==null?void 0:e.map(t=>bge(t))}:r}function Ll(r){var i,n;let e=(i=r.includeFunctionParametersInRandomSeed)!=null?i:!0,t=[];for(let a of r.expressions.list){let s=yge(a);switch(s.type){case"expression":s.color===Qv&&(s.color=Zv);break;case"table":s.columns&&(s={...s,columns:s.columns.map(c=>c.color===Qv?{...c,color:Zv}:c)}),s.regression&&s.regression.color===Qv&&(s.regression={...s.regression,color:Zv});break}t.push(s)}let o={...r,version:11,includeFunctionParametersInRandomSeed:e,expressions:{...r.expressions,list:t}};return((n=r.graph)==null?void 0:n.product)==="graphing-3d"&&(o.doNotMigrate3dLineWidthZero=!0),o.includeFunctionParametersInRandomSeed===!1&&delete o.includeFunctionParametersInRandomSeed,o.doNotMigrateMovablePointStyle=!0,o}var sN=[Fj,Nj,Yj,Bj,zj,qj,Wj,$3,Z3,oN,iN,nN,aN];var xc=12;function zo(r){if(r.version>xc)return typeof console!="undefined"&&console.warn&&console.warn("Loading saved state with version "+r.version+" but last known version is "+xc+". States saved in a newer version of the calculator may not load correctly in an older version of the calculator."),tD(r);if(r.hasOwnProperty("version")&&!sN[r.version])return typeof console!="undefined"&&console.warn&&console.warn("State has invalid version "+r.version+". If a version is present, it should be a non-negative integer less than or equal to "+xc+"."),tD(r);for(r.hasOwnProperty("version")||(r=sN[0](r));r.version<xc;)r=sN[r.version+1](r);return tD(r)}function xge(r){return Ll(r)}function iD(r){return xge(zo(r))}function tX(r){let e=zo(r),t={},o=e.graph.degreeMode,i=e.graph.complex,n=e.randomSeed,a=e.graph.product==="geometry-calculator"?"geometry":e.graph.product==="graphing-3d"?"graphing_3d":"graphing";function s(c){switch(c.type){case void 0:case"expression":{let p=__dcg_shared_module_exports__['le'](__dcg_shared_module_exports__['he'](c,{is3d:!1,defaultLogModeRegressions:!1}));t[p.id]=p}break;case"table":{let p=nI(Jx(c));t[p.id]=p}break;case"image":{let p=OI(gv(c));t[p.id]=p;break}case"folder":case"text":break;default:return c}}for(let c of e.expressions.list)s(c);if(e.version>=10&&e.expressions.ticker){let c="dcg_ticker_guid_internal",d={...rM(e.expressions.ticker),id:c};t[c]=tM(d)}return{setExpression(c){s(c)},getChangeSet(){return{statements:t,isCompleteState:!0,degreeMode:o,complex:i,globalRandomSeed:n,evaluationMode:a}}}}function oX(r,e){let t=__dcg_shared_module_exports__['f'](r);return nD(t,e)}function nD(r,e){for(let t of __dcg_shared_module_exports__['$a'](e)){let o=e[t];Sge(o)?r[t]=o.s:kge(o)?delete r[t]:_ge(o)?r[t]=wge(r[t],o.l):Cge(o)&&(r[t]=nD(r[t],o.e))}return r}function wge(r,e){let t=[];for(let i=0;i<r.length;i++){let n=e[i];n&&n.a&&t.push(...rX(r,n.a)),n&&n.e?t.push(nD(r[i],n.e)):(!n||!n.d)&&t.push(r[i])}let o=e[r.length];return o&&o.a&&t.push(...rX(r,o.a)),t}function rX(r,e){let t=[];for(let o of e)if(Tge(o))t.push(o.s);else if(Ege(o)){let i=r[o.m.f];o.m.e?t.push(nD(i,o.m.e)):t.push(i)}return t}function Sge(r){return r.hasOwnProperty("s")}function kge(r){return r.hasOwnProperty("d")}function _ge(r){return r.hasOwnProperty("l")}function Cge(r){return r.hasOwnProperty("e")}function Tge(r){return r.hasOwnProperty("s")}function Ege(r){return r.hasOwnProperty("m")}function iX(r){let e=r.length,t=new Array(e),o=new Array(e+1),i=0;for(let s=0;s<e;s++){let c;if(r[o[i]]<r[s])c=i+1;else{let d=1,p=i-1;for(;d<=p;){let u=Math.ceil((d+p)/2);r[o[u]]<r[s]?d=u+1:p=u-1}c=d}t[s]=o[c-1],o[c]=s,c>i&&(i=c)}let n=new Array(i),a=o[i];for(let s=i-1;s>=0;s--)n[s]=r[a],a=t[a];return n}function aX(r,e){return aD(r,e,0)}function aD(r,e,t){let o={};for(let i in r){if(!r.hasOwnProperty(i))continue;if(!e.hasOwnProperty(i)){o[i]={d:1};continue}let n=r[i],a=e[i],s=Ige(n,a,t,i);s&&(o[i]=s)}for(let i in e)e.hasOwnProperty(i)&&!r.hasOwnProperty(i)&&(o[i]={s:e[i]});return o}function Ige(r,e,t,o){if(__dcg_shared_module_exports__['fb'](r)&&__dcg_shared_module_exports__['fb'](e)){if(t===1&&o==="list"||t===2&&o==="columns")return Dge(r,e);if(!__dcg_shared_module_exports__['db'](r,e))return{s:e}}else if(__dcg_shared_module_exports__['gb'](r)&&__dcg_shared_module_exports__['gb'](e)){let i=aD(r,e,Mge(t,o));if(!__dcg_shared_module_exports__['eb'](i))return{e:i}}else if(!__dcg_shared_module_exports__['db'](r,e))return{s:e}}function Mge(r,e){return r===0&&e==="expressions"?1:3}function Dge(r,e){let t={},o={};for(let s=0;s<r.length;s++){if(o[r[s].id]!==void 0)return{s:e};o[r[s].id]=s}let i={};for(let s=0;s<e.length;s++){if(i[e[s].id]!==void 0)return{s:e};i[e[s].id]=s}let n=Age(r,e,o),a=0;for(let s=0;s<r.length;s++){let c=r[s];if(!n[c.id])t[s]={d:1};else{let d=i[c.id],p=e[d],u={};if(a!==d&&(u.a=e.slice(a,d).map(g=>nX(r,o,g))),!__dcg_shared_module_exports__['db'](c,p)){let g=c.type==="table"&&p.type==="table";u.e=aD(c,p,g?2:3)}__dcg_shared_module_exports__['eb'](u)||(t[s]=u),a=d+1}}if(a<e.length&&(t[r.length]={a:e.slice(a,e.length).map(s=>nX(r,o,s))}),!__dcg_shared_module_exports__['eb'](t))return{l:t}}function nX(r,e,t){if(e[t.id]){let o=r[e[t.id]],i={f:e[t.id]};return __dcg_shared_module_exports__['db'](o,t)||(i.e=aD(o,t,3)),{m:i}}return{s:t}}function Age(r,e,t){let o={},i=e.filter(a=>t[a.id]!==void 0).map(a=>t[a.id]),n=iX(i);for(let a of n)o[r[a].id]=!0;return o}function sX(r){return r.location==="expression"||r.location==="object"?`${r.location}:${r.id}:${r.path}`:`${r.location}:${r.path}`}function lN(r){let e=()=>new Error(`Invalid key: ${r}`),t=r.split(":"),o=t[0];if(!o||o!="expression"&&o!="settings"&&o!="object")throw e();if(o=="settings"){if(t.length!=2)throw e();return{location:o,path:t[1]}}if(t.length!=3)throw e();return{location:o,id:t[1],path:t[2]}}function sD(r,e,t){if(!r)return;let o=e.split("."),i=r;for(let n=0;n<o.length;n++){let a=o[n];if(!i[a])break;n==o.length-1&&typeof i[a]=="string"?i[a]=t:i=i[a]}}function cN(r,e){return(t,o,i,n)=>{if(t){let a=sX({...e,path:o});r[a]={value:t,type:i,context:n}}}}function Lge(r){var o,i;let e={},t=cN(e,{location:"expression",id:r.id});switch(r.type){case"expression":t(r.label,"label","interpolated-string","expression-list-expression-label"),t(r.description,"description","string","expression-list-expression-clickable-description");break;case"image":t(r.image_url,"image_url","image","expression-list-image-url"),t(r.description,"description","string","expression-list-image-clickable-description"),t((o=r.clickableInfo)==null?void 0:o.hoveredImage,"clickableInfo.hoveredImage","image","expression-list-image-clickable-hovered"),t((i=r.clickableInfo)==null?void 0:i.depressedImage,"clickableInfo.depressedImage","image","expression-list-image-clickable-depressed");break;case"text":t(r.text,"text","string","expression-list-note-text");break;case"folder":t(r.title,"title","string","expression-list-folder-title");break}return e}function Pge(r){let e={},t=cN(e,{location:"settings"});return t(r.graph.xAxisLabel,"xAxisLabel","string","settings-xaxis-label"),t(r.graph.yAxisLabel,"yAxisLabel","string","settings-yaxis-label"),e}function Gge(r){let e={},t=cN(e,{location:"object",id:r.id});return t(r.label,"label","string","geometry-object-label"),r.type==="image"&&t(r.url,"url","image","geometry-object-image-url"),e}function dN(r){let e={};if(r.type=="graph"){let t=r.graphState.expressions.list;for(let i of t){let n=Lge(i);for(let a in n)e[a]=n[a]}let o=Pge(r.graphState);for(let i in o)e[i]=o[i]}else{let t=r.geometryState.objects;for(let o in t){let i=Gge(t[o]);for(let n in i)e[n]=i[n]}}return e}function lX(r,e,t){var i;let o=__dcg_shared_module_exports__['f'](r);if(t==="graph"){let n={},a=(i=o.expressions)==null?void 0:i.list,s=Array.isArray(a)?a:[];for(let c of s)n[c.id]=c;for(let c in e){let d=lN(c);d.location=="expression"?sD(n[d.id],d.path,e[c].value):sD(o.graph,d.path,e[c].value)}}else if(o.objects)for(let n in e){let a=lN(n);a.location=="object"&&sD(o.objects[a.id],a.path,e[n].value)}return o}function Vge(r){return{...r,version:"0"}}var cX=Vge;var Oge={centerX:0,centerY:0,size:15},Rge={scale:1,unit:"",visible:!1,showLegend:!1};function Fge(r){let e=r.objects||{},t=__dcg_shared_module_exports__['f'](e);for(let o in t){let i=t[o];i.label&&(i.showLabel=!0)}return{version:"1",objects:t,viewport:r.viewport||Oge,customTools:r.customTools||{},grid:r.grid||Rge}}var dX=Fge;function Nge(r){return(r.type==="point"||r.type==="glider")&&!r.draggable}function Uge(r){let e=r.objects||{},t=__dcg_shared_module_exports__['f'](e),o=__dcg_shared_module_exports__['f'](r.grid);for(let i in t){let n=t[i];Nge(n)&&(n.draggable=!0),n.type==="angle"&&n.showLabel&&!n.label&&(n.label="{angle}"),n.type==="segment"&&n.showLabel&&!n.label&&(n.label="{length}")}return o.unit="",o.scale=1,{version:"2",objects:t,viewport:r.viewport,customTools:r.customTools||{},grid:o}}var pX=Uge;function pN(r){return r&&(r.type==="circle"||r.type==="compass")}function Yge(r){let e=__dcg_shared_module_exports__['f'](r.objects||{});for(let t in e){let o=e[t];if(o.type==="point")o.y=-o.y;else if(o.type==="glider"){let i=e[o.parents.host];pN(i)&&(o.t=-o.t)}else if(o.type==="intersection"){let i=e[o.parents.host1],n=e[o.parents.host2];pN(i)&&pN(n)&&(o.negRoot=!o.negRoot)}}return{version:"3",objects:e,viewport:r.viewport,customTools:r.customTools||{},graphSettings:{showGrid:!!(r.grid||{}).visible,showAxes:!1,showAxisNumbers:!1}}}var uX=Yge;function Bge(r){let e=__dcg_shared_module_exports__['f'](r.objects||{});for(let t in e){let o=e[t];o.draggable===!1&&(o.locked=!0),delete o.draggable}return{...r,version:"4",objects:e}}var hX=Bge;var lD=[cX,dX,pX,uX,hX],Kge="4";function uN(r){let e=parseInt(Kge,10),t=parseInt(r.version||"0",10);for(t>e&&typeof console!="undefined"&&console.warn&&console.warn(`Loading saved state with version ${t}, but last known version is ${e}. States saved in a newer version of the geometry tool may not load correctly in older versions of the tool.`),lD[t]||typeof console!="undefined"&&console.warn&&console.warn(`State has invalid version: ${t}. If a version is present, it should be a non-negative integer less than or equal to ${e}.`),t===0&&(r=lD[0](r));t<e;)t+=1,lD[t]&&(r=lD[t](r));return r}var zge=!1;function kb(r,e){let t=e[r];return t.type==="transformed-object"?kb(t.parents.object,e):t.type}function gX(r){switch(r){case"circle":case"compass":case"arc":return!0}return!1}function qge(r,e,t){let o=kb(e,t);if(o==="circle"||o==="compass"){let i=r/(2*Math.PI);return i<0?i+1:i}return r}function mX(r){switch(r){case"scaled-rotation":case"vector":return!0}return!1}function Hge(r){switch(r){case"point":case"midpoint":case"glider":case"intersection":case"polygon":return"P";case"line":case"segment":case"ray":case"vector":case"parallel":case"perpendicular":return"L";case"circle":case"compass":return"C";case"arc":case"angle":return"A";case"image":return"I";case"dilation":case"rotation":case"translation":case"reflection":case"scaled-rotation":return"T";case"transformed-object":return"T";default:return r}}function fX(r){return r.hasOwnProperty("objects")&&!r.hasOwnProperty("expressions")}function sh(r){let e=!zge,t=uN(r),o={},i={},n=_=>{if(i.hasOwnProperty(_))return i[_];let C=kb(_,t.objects);if(e&&!mX(C)){let N=o.token||1;o.token=N+1;let Y="\\token{"+N+"}";return i[_]=Y,Y}let D=Hge(C),P=o[D]||1;o[D]=P+1;let F=D+"_{"+P+"}";return i[_]=F,F};function a(_){let C=o[_]||1;return o[_]=C+1,_+"_{"+C+"}"}let s=(_,C,D)=>n(_)+"=\\operatorname{"+C+"}\\left("+D.map(n).join(",")+"\\right)",c=_=>`\\operatorname{segment}\\left(${_}.\\operatorname{start},${_}.\\operatorname{end}\\right)`,{centerX:d,centerY:p,size:u}=t.viewport;u*=1.25;let g=1,h=u/(1+g),b=h*g,v={version:11,randomSeed:"",expressions:{list:[]},graph:{product:"geometry-calculator",viewport:{xmin:d-h,xmax:d+h,ymin:p-b,ymax:p+b},showGrid:!1,showXAxis:!1,showYAxis:!1,squareAxes:!0,degreeMode:!0}};t.graphSettings.showGrid&&(v.graph.showGrid=!0,v.graph.xAxisMinorSubdivisions=1,v.graph.yAxisMinorSubdivisions=1,v.graph.xAxisStep=1,v.graph.yAxisStep=1);let T=v.expressions.list,E=[],I=[];for(let _ in t.objects){let C=t.objects[_],D=kb(C.id,t.objects),P={id:C.id,type:"expression",color:C.color,hidden:!!C.hidden};if(e&&!mX(D)&&(P.folderId=__dcg_shared_module_exports__['Zd']),C.locked&&(P.dragMode="NONE"),!C.hidden&&C.label&&C.showLabel){if(P.label=C.label,P.showLabel=!0,D==="segment"&&C.label.indexOf("{length}")!==-1)if(C.label==="{length}")P.label="";else{let F=a("l"),N=F+"=\\operatorname{round}\\left(\\operatorname{length}\\left("+n(C.id)+"\\right),2\\right)";I.push({id:"len-"+P.id,type:"expression",latex:N}),P.label=P.label.replace(/\{length\}/g,"${"+F+"}")}if(D==="angle"&&C.label.indexOf("{angle}")!==-1)if(C.label==="{angle}")P.label="";else{let F=a("a"),N=F+"=\\operatorname{round}\\left("+n(C.id)+"\\right)";I.push({id:"angle-"+P.id,type:"expression",latex:N}),P.label=P.label.replace(/\{angle}/g,"${"+F+"}\xB0")}if(D==="polygon"&&C.label.indexOf("{area}")!==-1)if(C.label==="{area}")P.label="";else{let F=a("a"),N=F+"=\\operatorname{round}\\left(\\operatorname{area}\\left("+n(C.id)+"\\right),2\\right)";I.push({id:"area-"+P.id,type:"expression",latex:N}),P.label=P.label.replace(/\{area\}/g,"${"+F+"}")}if(D==="polygon"&&C.label.indexOf("{perimeter}")!==-1){let F=a("p"),N=F+"=\\operatorname{round}\\left(\\operatorname{perimeter}\\left("+n(C.id)+"\\right),2\\right)";I.push({id:"perim-"+P.id,type:"expression",latex:N}),P.label=P.label.replace(/\{perimeter\}/g,"${"+F+"}")}}switch(C.type){case"point":{let V=C.x===null?0:C.x,K=C.y===null?0:C.y;P.latex=n(C.id)+"=\\left("+__dcg_shared_module_exports__['lb'](V)+","+__dcg_shared_module_exports__['lb'](K)+"\\right)";break}case"glider":{let V=kb(C.parents.host,t.objects),K=n(C.parents.host);V==="vector"&&(K=c(K)),P.latex=n(C.id)+"=\\operatorname{glider}\\left("+K+","+__dcg_shared_module_exports__['lb'](qge(C.t,C.parents.host,t.objects))+"\\right)";break}case"intersection":let F=kb(C.parents.host1,t.objects),N=kb(C.parents.host2,t.objects),Y=n(C.parents.host1),z=n(C.parents.host2);F==="vector"&&(Y=c(Y)),N==="vector"&&(z=c(z));let X=C.negRoot;(gX(F)&&!gX(N)||N==="arc")&&(X=!X);let q=X?[Y,z]:[z,Y];P.latex=n(_)+"=\\operatorname{intersection}\\left("+q.join(",")+"\\right)";break;case"midpoint":P.latex=s(C.id,C.type,[C.parents.straight]);break;case"circle":P.latex=s(C.id,C.type,[C.parents.point1,C.parents.point2]);break;case"arc":P.latex=s(C.id,C.type,[C.parents.point1,C.parents.point2,C.parents.point3]);break;case"compass":P.latex=s(C.id,"circle",[C.parents.center,C.parents.straight]);break;case"line":case"segment":case"ray":case"vector":P.latex=s(C.id,C.type,[C.parents.point1,C.parents.point2]);break;case"parallel":case"perpendicular":P.latex=s(C.id,C.type,[C.parents.straight,C.parents.point]);break;case"polygon":P.latex=s(C.id,C.type,C.parents.points);break;case"angle":P.latex=s(C.id,C.type,[C.parents.point1,C.parents.point2,C.parents.point3]);break;case"transformed-object":P.latex=n(C.id)+"="+n(C.parents.transformation)+"\\left("+n(C.parents.object)+"\\right)";break;case"dilation":P.latex=n(C.id)+"\\left(x\\right)=\\operatorname{dilate}\\left(x,"+n(C.parents.center)+","+(C.scaleFactor||"0/0")+"\\right)";break;case"reflection":P.latex=n(C.id)+"\\left(x\\right)=\\operatorname{reflect}\\left(x,"+n(C.parents.straight)+"\\right)";break;case"translation":P.latex=n(C.id)+"\\left(x\\right)=\\operatorname{translate}\\left(x,"+n(C.parents.from)+","+n(C.parents.to)+"\\right)";break;case"rotation":P.latex=n(C.id)+"\\left(x\\right)=\\operatorname{rotate}\\left(x,"+n(C.parents.center)+","+(C.angle||"0/0")+"\\right)";break;case"scaled-rotation":let S=n(C.parents.center),A=n(C.parents.from),O=n(C.parents.to);P.latex=n(C.id)+`\\left(x\\right)=\\operatorname{rotate}\\left(\\operatorname{dilate}\\left(x,${S},\\frac{\\left|${O}-${S}\\right|}{\\left|${A}-${S}\\right|}\\right),${S},\\operatorname{directedangle}\\left(${A},${S},${O}\\right)\\right)`;break;case"image":break;default:return C}P.latex&&(P.folderId===__dcg_shared_module_exports__['Zd']?E.push(P):I.push(P))}return T.push({type:"folder",id:__dcg_shared_module_exports__['Zd'],title:"geometry",secret:!0}),T.push.apply(T,E),T.push.apply(T,I),v}var cD=class r{constructor(e){this.node=e;this.internal=e}isError(){return this.internal.type==="Error"}isList(){return __dcg_shared_module_exports__['Ec'](this.internal)}isTicker(){return this.internal.type==="Ticker"}getValueType(){return this.internal.valueType}getConstantValue(){return __dcg_shared_module_exports__['Fc'](this.internal)}getDependencies(){return this.internal.getDependencies()}getExports(e){return this.internal.getExports(e)}getLegalExports(e){return this.internal.getLegalExports(e)}tryGetConcreteTree(e,t){let o=__dcg_shared_module_exports__['Mc'](this.internal,e,t);return new r(o)}getConcreteTree(e,t){return new r(__dcg_shared_module_exports__['Mc'](this.internal,e,t))}printLatex(){if(this.internal.printLatex)return this.internal.printLatex()}substitute(e){if(!this.internal.substitute)return;let t={};for(let i in e)t[i]=e[i].internal;let o=this.internal.substitute(t);return new r(o)}simpleFunctionExpression(){var t,o;let e=(o=(t=this.internal).simpleFunctionExpression)==null?void 0:o.call(t);if(e)return new r(e)}getDefinitionInfo(){if(this.internal.type==="FunctionDefinition"){let e=this.internal;return{type:"FunctionDefinition",symbol:e._symbol,parameters:e._argSymbols}}else if(this.internal.type==="Assignment")return{type:"Assignment",symbol:this.internal._symbol}}convertXYRelationToExpression(e,t="y"){let o=this.internal;if(o.type==="Error")return;let i;switch(o.type){case"Assignment":i=new __dcg_shared_module_exports__['zc']([new __dcg_shared_module_exports__['wc'](o._symbol),o._expression]);break;case"CallAssignment":{let n=o;i=new __dcg_shared_module_exports__['zc']([n._lhs,n._rhs]);break}case"Equation":i=o._difference;break;case"FunctionDefinition":{let n=o;if(n._argSymbols.length!==1)return;i=new __dcg_shared_module_exports__['zc']([new __dcg_shared_module_exports__['wc'](t),n._expression]);break}default:{let n=this.tryGetConcreteTree(e,nd.builtInFrame);if(n.internal.valueType!==__dcg_shared_module_exports__['B']||n.getDependencies().some(s=>s.toLowerCase()===t.toLowerCase())||!(o instanceof __dcg_shared_module_exports__['uc']))return;i=new __dcg_shared_module_exports__['zc']([new __dcg_shared_module_exports__['wc'](t),o])}}return new r(i)}getConicCoefficientsForExpression(e,t,o){var p;let n=this.getConcreteTree(e,nd.builtInFrame).internal;if(n.type==="Error"||n.valueType!==__dcg_shared_module_exports__['B'])return;let a=n.getDependencies();if(a.length>2)return;for(let u of a)if(u.toLowerCase()===t.toLowerCase())t=u;else if(u.toLowerCase()===o.toLowerCase())o=u;else return;function s(u){if(u==null||u==null)return 0;if(u.getDependencies().length!==0)throw new Error("Did not expect coefficient to have dependencies");return+u.asValue()}let c=n.type==="IRExpression"?n.getPolynomialCoefficients(t):[],d=[[0,0,0],[0,0,0],[0,0,0]];for(let u of[0,1,2]){let g=(p=c[u])==null?void 0:p.getPolynomialCoefficients(o);for(let h of[0,1,2])d[u][h]=s(g==null?void 0:g[h])}return d}repr(e,t){return this.internal.repr(e,t)}getCompiledFunction(e){if(this.internal instanceof __dcg_shared_module_exports__['Dc'])return this.internal.getCompiledFunction(e)}getAllUpdateSymbols(){var t;let e=[];return e.push(...this.internal.getUpdateSymbols()),this.internal.type==="Ticker"&&e.push(...this.internal.handler.getUpdateSymbols()),(t=this.internal.metaData)!=null&&t.clickHandler&&e.push(...this.internal.metaData.clickHandler.getUpdateSymbols()),e}static parseFunctionSignature(e){let t=nd.parser.parse(e);if(t.type!=="FunctionCall")return;let o=t;if(o.args.every(i=>i.type==="Identifier"))return{functionName:o._identifier._symbol,parameters:o.args.map(i=>i._symbol)}}};var hN={showGrid:!0,showXAxis:!0,showYAxis:!0,xAxisStep:0,yAxisStep:0,xAxisScale:"linear",yAxisScale:"linear",xAxisMinorSubdivisions:0,yAxisMinorSubdivisions:0,xAxisArrowMode:__dcg_shared_module_exports__['Nd'].NONE,yAxisArrowMode:__dcg_shared_module_exports__['Nd'].NONE,xAxisLabel:"",yAxisLabel:"",xAxisNumbers:!0,yAxisNumbers:!0,polarMode:!1,polarNumbers:!0,degreeMode:!1,randomSeed:"",restrictGridToFirstQuadrant:!1,userLockedViewport:!1,complex:!1},dD={threeDMode:!1,worldRotation3D:[],axis3D:[0,0,1],speed3D:0,userLockedRotation:!1,showPlane3D:!0,showNumbers3D:!0,plane3dOpacity:"",backgroundColor3d:"#FFF",showAxis3D:!0,showAxisLabels3D:!0,showBox3D:!0},Wge={squareAxes:!0},jge={...dD,...Wge,product:"graphing",includeFunctionParametersInRandomSeed:!0,hideCustomColors:!1};function bX(r){return r in dD}var Li={...hN,...jge},yX=Object.keys(hN);function xX(r){return r in hN}var e1=r=>isFinite(r)&&(r>0||r===0);function Tp(r,e){return typeof r!="string"?!1:r in e}var gN={OPEN:!0,CROSS:!0,POINT:!0,SQUARE:!0,PLUS:!0,TRIANGLE:!0,DIAMOND:!0,STAR:!0},mN={SOLID:!0,DASHED:!0,DOTTED:!0},wX={NONE:!0,AUTO:!0,X:!0,Y:!0,XY:!0},Xge={POINTS:!0,LINES:!0,POINTS_AND_LINES:!0},pD={POINTS:"POINTS",LINES:"LINES",POINTS_AND_LINES:"POINTS_AND_LINES"},$ge={default:!0,center:!0,center_auto:!0,auto_center:!0,above:!0,above_left:!0,above_right:!0,above_auto:!0,below:!0,below_left:!0,below_right:!0,below_auto:!0,left:!0,auto_left:!0,right:!0,auto_right:!0};function Jge(r){return{id:r.id,type:r.type,columns:r.columns.map(Zge)}}function Zge(r){return{id:r.id,latex:r.latex,color:r.color,hidden:r.hidden,pointStyle:r.pointStyle,pointOutline:r.pointOutline,pointSize:r.pointSize,pointOpacity:r.pointOpacity,lineStyle:r.lineStyle,lineWidth:r.lineWidth,lineOpacity:r.lineOpacity,points:r.points,lines:r.lines,dragMode:r.dragMode,values:r.values.slice()}}function Qge(r){let e=["latex","color","lineStyle","lineWidth","lineOpacity","pointStyle","pointSize","movablePointSize","pointOpacity","points","lines","fill","fillOpacity","hidden","secret","dragMode","label","showLabel","labelSize","labelOrientation","interactiveLabel","readonly"],t={id:r.id,type:r.type};return e.forEach(o=>{r.hasOwnProperty(o)&&(t[o]=r[o])}),r.hasOwnProperty("parametricDomain")&&(t.parametricDomain={min:r.parametricDomain.min,max:r.parametricDomain.max}),r.hasOwnProperty("parametricDomain3Du")&&(t.parametricDomain3Du={min:r.parametricDomain3Du.min,max:r.parametricDomain3Du.max}),r.hasOwnProperty("parametricDomain3Dv")&&(t.parametricDomain3Dv={min:r.parametricDomain3Dv.min,max:r.parametricDomain3Dv.max}),r.hasOwnProperty("parametricDomain3Dr")&&(t.parametricDomain3Dr={min:r.parametricDomain3Dr.min,max:r.parametricDomain3Dr.max}),r.hasOwnProperty("parametricDomain3Dphi")&&(t.parametricDomain3Dphi={min:r.parametricDomain3Dphi.min,max:r.parametricDomain3Dphi.max}),r.hasOwnProperty("polarDomain")&&(t.polarDomain={min:r.polarDomain.min,max:r.polarDomain.max}),r.hasOwnProperty("domain")&&(t.domain={min:r.domain.min,max:r.domain.max}),r.slider&&(r.slider.hardMin&&(t.sliderBounds=t.sliderBounds||{},t.sliderBounds.min=r.slider.min),r.slider.hardMax&&(t.sliderBounds=t.sliderBounds||{},t.sliderBounds.max=r.slider.max),r.slider.step&&(t.sliderBounds=t.sliderBounds||{},t.sliderBounds.step=r.slider.step),t.playing=!!r.slider.isPlaying),t}function eme(r){return{id:r.id,type:r.type,hidden:r.hidden,secret:r.secret}}function tme(r){return{id:r.id,type:r.type,hidden:r.hidden,secret:r.secret,title:r.title}}function rme(r){return{id:r.id,type:r.type,secret:r.secret,text:r.text}}function _b(r){switch(r.type){case"expression":return Qge(r);case"table":return Jge(r);case"folder":return tme(r);case"image":return eme(r);case"text":return rme(r);default:return r}}function t1(r,e){return r.hasOwnProperty("id")?r.id+"":e.generateId()}function ome(r,e){var o,i,n,a,s,c,d,p,u,g;let t={type:"expression",id:t1(r,e)};if(r.hasOwnProperty("latex")&&(t.latex=r.latex+""),r.hasOwnProperty("color")&&(t.color=r.color+""),r.hasOwnProperty("points")&&(t.points=!!r.points),r.hasOwnProperty("lines")&&(t.lines=!!r.lines),r.hasOwnProperty("style")){(o=console==null?void 0:console.warn)==null||o.call(console,"As of API v1.1 the 'style' property is deprecated and has been split into 'pointStyle' and 'lineStyle'.");let h=r.style;Tp(h,gN)?t.pointStyle=h:Tp(h,mN)?t.lineStyle=h:(i=console==null?void 0:console.warn)==null||i.call(console,"Invalid style: '"+h+"'.")}if(r.hasOwnProperty("pointStyle")&&(Tp(r.pointStyle,gN)?t.pointStyle=r.pointStyle:(n=console==null?void 0:console.warn)==null||n.call(console,"Invalid pointStyle: '"+r.pointStyle+"'.")),r.hasOwnProperty("pointSize")&&(t.pointSize=""+r.pointSize),r.hasOwnProperty("movablePointSize")&&(t.movablePointSize=""+r.movablePointSize),r.hasOwnProperty("pointOpacity")&&(t.pointOpacity=""+r.pointOpacity),r.hasOwnProperty("lineStyle")&&(Tp(r.lineStyle,mN)?t.lineStyle=r.lineStyle:(a=console==null?void 0:console.warn)==null||a.call(console,"Invalid lineStyle: '"+r.lineStyle+"'.")),r.hasOwnProperty("lineWidth")&&(t.lineWidth=""+r.lineWidth),r.hasOwnProperty("lineOpacity")&&(t.lineOpacity=""+r.lineOpacity),r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),r.hasOwnProperty("readonly")&&(t.readonly=!!r.readonly),r.hasOwnProperty("secret")&&(t.secret=!!r.secret),r.hasOwnProperty("sliderBounds")&&r.sliderBounds&&(t.slider={min:__dcg_shared_module_exports__['kb'](r.sliderBounds.min),max:__dcg_shared_module_exports__['kb'](r.sliderBounds.max),step:__dcg_shared_module_exports__['kb'](r.sliderBounds.step)},t.slider.min&&(t.slider.hardMin=!0),t.slider.max&&(t.slider.hardMax=!0)),r.hasOwnProperty("playing")){let{playing:h}=r;typeof h!="boolean"?(s=console==null?void 0:console.warn)==null||s.call(console,`Invalid value for 'playing'. Expected a boolean but got '${h}'.`):(t.slider||(t.slider={}),t.slider.isPlaying=h)}return r.hasOwnProperty("parametricDomain3Du")&&r.parametricDomain3Du&&(t.parametricDomain3Du={min:__dcg_shared_module_exports__['kb'](r.parametricDomain3Du.min),max:__dcg_shared_module_exports__['kb'](r.parametricDomain3Du.max)}),r.hasOwnProperty("parametricDomain3Dv")&&r.parametricDomain3Dv&&(t.parametricDomain3Dv={min:__dcg_shared_module_exports__['kb'](r.parametricDomain3Dv.min),max:__dcg_shared_module_exports__['kb'](r.parametricDomain3Dv.max)}),r.hasOwnProperty("parametricDomain3Dr")&&r.parametricDomain3Dr&&(t.parametricDomain3Dr={min:__dcg_shared_module_exports__['kb'](r.parametricDomain3Dr.min),max:__dcg_shared_module_exports__['kb'](r.parametricDomain3Dr.max)}),r.hasOwnProperty("parametricDomain3Dphi")&&r.parametricDomain3Dphi&&(t.parametricDomain3Dphi={min:__dcg_shared_module_exports__['kb'](r.parametricDomain3Dphi.min),max:__dcg_shared_module_exports__['kb'](r.parametricDomain3Dphi.max)}),r.hasOwnProperty("parametricDomain")&&r.parametricDomain?(t.parametricDomain={min:__dcg_shared_module_exports__['kb'](r.parametricDomain.min),max:__dcg_shared_module_exports__['kb'](r.parametricDomain.max)},r.hasOwnProperty("domain")&&((c=console==null?void 0:console.warn)==null||c.call(console,"Both 'parametricDomain' and the deprecated 'domain' property were specified. Using 'parametricDomain'."))):r.hasOwnProperty("domain")&&((d=console==null?void 0:console.warn)==null||d.call(console,"The 'domain' property is deprecated.Use 'parametricDomain' to specify the domain for parametric functions"),t.parametricDomain={min:__dcg_shared_module_exports__['kb'](r.domain.min),max:__dcg_shared_module_exports__['kb'](r.domain.max)}),r.hasOwnProperty("polarDomain")&&r.polarDomain&&(t.polarDomain={min:__dcg_shared_module_exports__['kb'](r.polarDomain.min),max:__dcg_shared_module_exports__['kb'](r.polarDomain.max)}),r.hasOwnProperty("dragMode")&&(Tp(r.dragMode,wX)?t.dragMode=r.dragMode:(p=console==null?void 0:console.warn)==null||p.call(console,"Invalid dragMode: '"+r.dragMode+"'.")),r.hasOwnProperty("label")&&(t.label=r.label+""),r.hasOwnProperty("showLabel")&&(t.showLabel=!!r.showLabel),r.hasOwnProperty("showAngleLabel")&&(t.showAngleLabel=!!r.showAngleLabel),r.hasOwnProperty("labelSize")&&(typeof r.labelSize=="string"?t.labelSize=r.labelSize:(u=console==null?void 0:console.warn)==null||u.call(console,"Invalid labelSize: "+r.labelSize)),r.hasOwnProperty("labelOrientation")&&(Tp(r.labelOrientation,$ge)?t.labelOrientation=r.labelOrientation:(g=console==null?void 0:console.warn)==null||g.call(console,"Invalid labelOrientation: "+r.labelOrientation)),r.hasOwnProperty("fill")&&(t.fill=!!r.fill),r.hasOwnProperty("fillOpacity")&&(t.fillOpacity=""+r.fillOpacity),t}function ime(r,e){var o,i,n,a,s,c;let t={id:t1(r,e)};return r.hasOwnProperty("latex")&&(t.latex=r.latex+""),r.hasOwnProperty("color")&&(t.color=r.color+""),r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),r.hasOwnProperty("points")&&(t.points=!!r.points),r.hasOwnProperty("lines")&&(t.lines=!!r.lines),r.hasOwnProperty("values")&&r.values&&(t.values=r.values.map(d=>d+"")),r.hasOwnProperty("pointStyle")&&(Tp(r.pointStyle,gN)?t.pointStyle=r.pointStyle:(o=console==null?void 0:console.warn)==null||o.call(console,"Invalid pointStyle: '"+r.pointStyle+"'.")),r.hasOwnProperty("pointSize")&&(t.pointSize=""+r.pointSize),r.hasOwnProperty("pointOpacity")&&(t.pointOpacity=""+r.pointOpacity),r.hasOwnProperty("lineStyle")&&(Tp(r.lineStyle,mN)?t.lineStyle=r.lineStyle:(i=console==null?void 0:console.warn)==null||i.call(console,"Invalid lineStyle: '"+r.lineStyle+"'.")),r.hasOwnProperty("lineWidth")&&(t.lineWidth=""+r.lineWidth),r.hasOwnProperty("lineOpacity")&&(t.lineOpacity=""+r.lineOpacity),r.hasOwnProperty("columnMode")&&((n=console==null?void 0:console.warn)==null||n.call(console,"As of API v1.1 the 'columnMode' property is deprecated and has been split into individual 'points' and 'lines' properties."),r.columnMode===pD.POINTS_AND_LINES?(t.points=!0,t.lines=!0):r.columnMode===pD.LINES?(t.points=!1,t.lines=!0):(t.points=!0,t.lines=!1),t.lines&&!t.points&&r.hasOwnProperty("dragMode")&&r.dragMode!==__dcg_shared_module_exports__['Gd'].NONE&&((a=console==null?void 0:console.warn)==null||a.call(console,"A 'lines' value of true and 'points' value of false is only compatible with a dragMode of 'NONE'. Proceeding by setting 'points' to true."),t.points=!0),Tp(r.columnMode,Xge)||(s=console==null?void 0:console.warn)==null||s.call(console,"Invalid columnMode: '"+r.columnMode+"'.")),r.hasOwnProperty("dragMode")&&(Tp(r.dragMode,wX)?t.dragMode=r.dragMode===__dcg_shared_module_exports__['Gd'].AUTO?__dcg_shared_module_exports__['Gd'].NONE:r.dragMode:(c=console==null?void 0:console.warn)==null||c.call(console,"Invalid dragMode: '"+r.dragMode+"'.")),t}function nme(r,e){let t={type:"table",id:t1(r,e)};return r.hasOwnProperty("columns")&&r.columns&&(t.columns=r.columns.map(o=>ime(o,e))),t}function ame(r,e){let t={type:"folder",id:t1(r,e)};return r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),r.hasOwnProperty("title")&&(t.title=r.title),t}function vX(r,e){let t={type:"text",id:t1(r,e)};return r.hasOwnProperty("text")&&(t.text=r.text),r.hasOwnProperty("secret")&&(t.secret=!!r.secret),r.hasOwnProperty("readonly")&&(t.readonly=!!r.readonly),t}function sme(r,e){let t={type:"image",id:t1(r,e)};return r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),t}function uD(r,e,t){var i,n,a;let o=r.type;if(e&&o&&o!==e){(i=console==null?void 0:console.warn)==null||i.call(console,"Cannot change type of expression from '"+e+"' to '"+o+"'.");return}if(e==="text"&&o===void 0)return vX(r,t);switch(o){case void 0:case"expression":return ome(r,t);case"image":return sme(r,t);case"table":return nme(r,t);case"folder":return ame(r,t);case"text":return vX(r,t);default:if(e){(n=console==null?void 0:console.warn)==null||n.call(console,"Cannot modify expressions of type: '"+e+"' through the API.");return}else{(a=console==null?void 0:console.warn)==null||a.call(console,"Invalid expression type: '"+o+"'.");return}}}var pk=class{constructor(e){this.usedIds=new Set;this.nextId=0;var t;if(e){for(let o of e.expressions.list)if(this.usedIds.add(o.id),o.type==="table")for(let i of(t=o.columns)!=null?t:[])i.id&&this.usedIds.add(i.id)}}generateId(){let e;do e=(this.nextId++).toString();while(this.usedIds.has(e));return this.usedIds.add(e),e}};function hD(r,e){var t,o,i,n,a,s;switch(r.type){case"expression":return{...r,id:(t=r.id)!=null?t:e.generateId()};case"folder":return{...r,id:(o=r.id)!=null?o:e.generateId()};case"text":return{...r,id:(i=r.id)!=null?i:e.generateId()};case"image":return{...r,id:(n=r.id)!=null?n:e.generateId()};case"table":return{...r,id:(a=r.id)!=null?a:e.generateId(),columns:(s=r.columns)==null?void 0:s.map(c=>{var d;return{...Wu,...c,id:(d=c.id)!=null?d:e.generateId()}})};default:throw new Error("Unknown item type")}}function lme(r=[],e){var n,a,s,c,d,p,u,g,h,b;let t=[],o=new pk;if((e==null?void 0:e.product)==="geometry-calculator"){t.push({type:"folder",id:__dcg_shared_module_exports__['Zd'],title:"geometry",secret:!0});for(let v of(n=e==null?void 0:e.constructions)!=null?n:[]){let T=hD(v,o);T.type!=="folder"&&(T={...T,folderId:__dcg_shared_module_exports__['Zd']}),t.push(T)}}for(let v of r)t.push(hD(v,o));let i={version:12,randomSeed:(a=e==null?void 0:e.randomSeed)!=null?a:"",expressions:{list:t},graph:{viewport:(s=e==null?void 0:e.viewport)!=null?s:{xmax:10,xmin:-10,ymax:10,ymin:-10},degreeMode:(c=e==null?void 0:e.degreeMode)!=null?c:!0,squareAxes:(d=e==null?void 0:e.squareAxes)!=null?d:!0,showGrid:(p=e==null?void 0:e.showGrid)!=null?p:!0,showXAxis:(u=e==null?void 0:e.showXAxis)!=null?u:!0,showYAxis:(g=e==null?void 0:e.showYAxis)!=null?g:!0,product:(h=e==null?void 0:e.product)!=null?h:"graphing",complex:(b=e==null?void 0:e.complex)!=null?b:!1,threeDMode:(e==null?void 0:e.product)==="graphing-3d"}};return e!=null&&e.xAxisLabel&&(i.graph.xAxisLabel=e.xAxisLabel),e!=null&&e.yAxisLabel&&(i.graph.yAxisLabel=e.yAxisLabel),e!=null&&e.ticker&&(i.expressions.ticker=e.ticker),e!=null&&e.geometryToolbar&&(i.geometryToolbar=e.geometryToolbar),Ll(i)}function cme(r,e){let t=zo(r),o=new pk(t),i=e.map(a=>hD(a,o)),n=__dcg_shared_module_exports__['f'](t);return Ll({...n,expressions:{...n.expressions,list:i}})}function dme(r,e,t){let o=i=>{switch(t.strategy){case"exact":return i;case"expressions-only":return i.expressions.list;case"expressions-only-omit-empty":return i.expressions.list.filter(n=>n.type!=="expression"||!!n.latex);case"normalize-viewport-and-expressions":{let n=pme(i.graph),a={...i.expressions,list:ume(i.expressions.list)};return{...i,graph:n,expressions:a}}default:return t.strategy,i}};return __dcg_shared_module_exports__['db'](o(r),o(e))}function pme(r){if(r.squareAxes!==!1){let{viewport:e}=r;return{...r,squareAxes:!0,viewport:{...e,ymin:void 0,ymax:void 0,yCenter:(e.ymax+e.ymin)/2}}}return r}function ume(r){let e=1,t={},o=i=>(t[i]||(e++,t[i]=e),t[i].toString());return r.map(i=>{let n={...i,id:o(i.id)};if(n.type==="expression"&&n.latex){let a=nd.parser.parse(n.latex),s=new nd.ParseNodeQuery(a).printLatex();s&&(n.latex=s)}return"folderId"in n&&n.folderId&&(n.folderId=o(n.folderId)),n})}function hme(r){var o,i;let e=zo(r),t=new Map;for(let n of e.expressions.list)n.type==="image"&&t.set(n.id,{image:n.image_url,depressedImage:(o=n.clickableInfo)==null?void 0:o.depressedImage,hoveredImage:(i=n.clickableInfo)==null?void 0:i.hoveredImage});return t}function gme(r,e){var o,i;let t=__dcg_shared_module_exports__['f'](Ll(zo(r)));for(let n of t.expressions.list)n.type==="image"&&(n.image_url=e(n.image_url),(o=n.clickableInfo)!=null&&o.depressedImage&&(n.clickableInfo.depressedImage=e(n.clickableInfo.depressedImage)),(i=n.clickableInfo)!=null&&i.hoveredImage&&(n.clickableInfo.hoveredImage=e(n.clickableInfo.hoveredImage)));return t}function mme(r){let e=zo(r),t=__dcg_shared_module_exports__['f'](e);return Ll({...t,graph:{product:"product"in r.graph?r.graph.product:"graphing"}})}function kX(r,e){switch(r.type){case"expression":{let t=fN(e)==="graphing-3d";return __dcg_shared_module_exports__['he'](r,{is3d:t,defaultLogModeRegressions:!1})}case"folder":return __dcg_shared_module_exports__['Xd'](r);case"text":return QI(r);case"image":return gv(r);case"table":return Jx(r);default:throw new Error("Unknown item type")}}function fme(r,e){let t=zo(r),o=__dcg_shared_module_exports__['f'](t);return Ll({...o,expressions:{...o.expressions,list:o.expressions.list.filter(i=>e(_b(kX(i,r))))}})}function bme(r,e){let t=zo(r),o=new pk(t),i=__dcg_shared_module_exports__['f'](t);return Ll({...i,expressions:{...i.expressions,list:[...i.expressions.list,...e.map(n=>hD(n,o))]}})}function yme(r,e){let t=zo(r),o=__dcg_shared_module_exports__['f'](t);return Ll({...o,graph:{...o.graph,degreeMode:e}})}function xme(r,e){let t=zo(r),o=__dcg_shared_module_exports__['f'](t);return Ll({...o,graph:{...o.graph,complex:e}})}function SX(r,e){r=r.replace(/#/,"");let t=0,o=0,i=0;return r.length==3?(t=parseInt(r.slice(0,1)+r.slice(0,1),16),o=parseInt(r.slice(1,2)+r.slice(1,2),16),i=parseInt(r.slice(2,3)+r.slice(2,3),16)):r.length==6&&(t=parseInt(r.slice(0,2),16),o=parseInt(r.slice(2,4),16),i=parseInt(r.slice(4,6),16)),`rgba(${t},${o},${i},${e})`}function vme(r,e){let t=__dcg_shared_module_exports__['f'](zo(r));for(let o of t.expressions.list)if(o.type=="expression")o.showLabel=!1,o.color!=null&&(o.color=SX(o.color,e));else if(o.type=="table"&&o.columns)for(let i of o.columns)i.color!==void 0&&(i.color=SX(i.color,e));for(let o of t.expressions.list)o.type=="image"&&(o.opacity!==void 0?o.opacity=`(${o.opacity}) * ${e}`:o.opacity=e+"");return Ll(t)}function fN(r){var e;switch(r.version){case 9:case 10:case 11:case 12:return(e=r.graph.product)!=null?e:"graphing";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case void 0:return"graphing";default:return"graphing"}}function wme(r){switch(r.version){case 11:case 12:return!!r.graph.complex;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case void 0:return!1;default:return!1}}function Sme(r){var e,t,o,i,n,a,s;return{degreeMode:(e=r.graph.degreeMode)!=null?e:Li.degreeMode,complex:wme(r),geometryToolbar:Cme(r),product:fN(r),showGrid:(t=r.graph.showGrid)!=null?t:Li.showGrid,showXAxis:(o=r.graph.showXAxis)!=null?o:Li.showXAxis,showYAxis:(i=r.graph.showYAxis)!=null?i:Li.showYAxis,xAxisLabel:(n=r.graph.xAxisLabel)!=null?n:Li.xAxisLabel,yAxisLabel:(a=r.graph.yAxisLabel)!=null?a:Li.yAxisLabel,squareAxes:(s=r.graph.squareAxes)!=null?s:Li.squareAxes,viewport:r.graph.viewport}}function kme(r,e){let t=zo(r);for(let o of t.expressions.list)if(o.type==="expression"&&o.latex&&nd.parser.parse(o.latex).getExports(__dcg_shared_module_exports__['ye'])[0]===e)return _b(kX(o,r))}function _me(r,e){if(fN(r)!=="geometry-calculator")return r;let t=zo(r);return Ll({...t,geometryToolbar:e})}function Cme(r){if(r)switch(r.version){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case void 0:return;default:return r.graph.product!=="geometry-calculator"?void 0:r.geometryToolbar}}function Tme(r){let e=new Map,t=1;for(let o=0;o<r.expressions.list.length;o++){let i=r.expressions.list[o];i.id===__dcg_shared_module_exports__['Zd']||"folderId"in i&&i.folderId===__dcg_shared_module_exports__['Zd']?e.set(i.id,{location:"constructions"}):(e.set(i.id,{location:"expression-list",displayIndex:t}),t+=1)}return e}function Eme(r){switch(r.version){case void 0:case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:return;case 8:case 9:case 10:case 11:case 12:return r.expressions.ticker;default:return}}var _X={makeCalculatorState:lme,replaceExpressionList:cme,replaceImageUrls:gme,resetGraphSettingsAndUnsetViewport:mme,filterExpressions:fme,appendExpressions:bme,setDegreeMode:yme,setComplexMode:xme,scaleAllOpacities:vme,setGeometryToolbar:_me,findExpressionExportingIdentifier:kme,getAllImageUrls:hme,getGraphSettings:Sme,getItemIdToLocationMap:Tme,getTicker:Eme,calcStatesEqual:dme};function Ime(r,e){return r==null&&(r=""),__dcg_shared_module_exports__['xe'](r,e)}var Mme={parse:Ime};function CX(r){let e=__dcg_shared_module_exports__['qc'](r[0],r[1]);return{real:__dcg_shared_module_exports__['rc'](e),imag:__dcg_shared_module_exports__['sc'](e)}}var Dme={types:__dcg_shared_module_exports__['Ea'],getValueType:r=>r.valueType,isTypeOrListOfType:__dcg_shared_module_exports__['wa'],isType:(r,e)=>r===e,isList:__dcg_shared_module_exports__['qa'],getNumber:function(r){return r.valueType===__dcg_shared_module_exports__['B']?r.value:r.valueType===__dcg_shared_module_exports__['_']?__dcg_shared_module_exports__['tc'](__dcg_shared_module_exports__['qc'](r.value[0],r.value[1])):void 0},getNumberList:function(r){return r.valueType===__dcg_shared_module_exports__['E']?r.value:r.valueType===__dcg_shared_module_exports__['$']?r.value.map(e=>__dcg_shared_module_exports__['tc'](__dcg_shared_module_exports__['qc'](e[0],e[1]))):void 0},getComplex:function(r){return r.valueType===__dcg_shared_module_exports__['_']?CX(r.value):r.valueType===__dcg_shared_module_exports__['B']?{real:r.value,imag:0}:void 0},getComplexList:function(r){return r.valueType===__dcg_shared_module_exports__['$']?r.value.map(CX):r.valueType===__dcg_shared_module_exports__['E']?r.value.map(e=>({real:e,imag:0})):void 0},getPoint:function(r){if(r.valueType===__dcg_shared_module_exports__['C'])return r.value},getPointList:function(r){if(r.valueType===__dcg_shared_module_exports__['F'])return r.value}};function Ame(r){return{viewState:r.viewState,degreeMode:r.degreeMode,complex:r.complex}}function Lme(r){return{addedGraphs:r.graphData.addedGraphs,removedGraphs:r.graphData.removedGraphs}}function Pme(r){let e=r;return e.graphMode==4?{...e,graphMode:3,showPoint:!0}:r}var Gme={Label:__dcg_shared_module_exports__['Cb'],parser:Mme,ParseNodeQuery:cD,context:__dcg_shared_module_exports__['Qe'],builtInFrame:__dcg_shared_module_exports__['xc'],TypedValue:Dme,stateHelpers:_X,CLCalculator:tX,colorHelpers:__dcg_shared_module_exports__['Bd'],calculateDiff:aX,applyDiff:oX,migrateToStable:iD,extractLocalizationMap:r=>r.type==="graph"?dN({type:"graph",graphState:zo(r.graphState)}):dN(r),applyLocalizationMap:lX,numberToDecimalString:__dcg_shared_module_exports__['lb'],numberToLatex:__dcg_shared_module_exports__['kb'],replaceIdentifierWithLatex:sF,migrateGeoStateToCalcState:sh,makeEvaluatorConfig:Ame,getGraphData:Lme,replaceMovablePointWithStaticPoint:Pme},nd=Gme;var IB=__dcg_shared_module_exports__['e'](j());Ip();function l(r,e,...t){return ld(r,!("key"in e)&&t.length>=1?{...e,key:t[0]}:e)}function x(r,e,...t){return l(r,e,...t)}var Dp=Hg;var Wg=__dcg_shared_module_exports__['e'](j()),ft=class extends Wg.View{template(){return x("div",{role:Wg.const("checkbox"),tabIndex:()=>this.props.disabled&&this.props.disabled()?-1:0,"aria-label":()=>{var e,t;return(t=(e=this.props).ariaLabel)==null?void 0:t.call(e)},"aria-labelledby":()=>{var e,t;return(t=(e=this.props).labelledBy)==null?void 0:t.call(e)},"aria-describedby":()=>{var e,t;return(t=(e=this.props).describedBy)==null?void 0:t.call(e)},"aria-disabled":()=>this.props.disabled&&this.props.disabled()?!0:void 0,"aria-checked":()=>this.props.checked(),"aria-required":()=>this.props.required?this.props.required():void 0,manageFocus:()=>{var e,t;return(t=(e=this.props).manageFocus)==null?void 0:t.call(e)},class:()=>({"dcg-component-checkbox":!0,"dcg-checked":this.props.checked(),"dcg-disabled":this.props.disabled&&this.props.disabled(),"dcg-small":this.props.small&&this.props.small(),[this.props.class===void 0?"":this.props.class()]:this.props.class!==void 0}),style:()=>this.props.style?this.props.style():{},onTap:this.bindFn(this.onChange),children:[l("span",{class:Wg.const("dcg-checkbox"),children:l("i",{class:Wg.const("dcg-icon-check"),"aria-hidden":Wg.const("true")})}),l("span",{class:Wg.const("dcg-checkbox-children"),children:this.props.children})]})}onChange(e){let t=e.target;t&&t.getAttribute("href")||this.props.disabled&&this.props.disabled()||this.props.onChange(!this.props.checked())}};var Pb=__dcg_shared_module_exports__['e'](j());Ut();var K2e=__dcg_shared_module_exports__['e'](u$());Ut();var h$=["exp|exponent ln|natural-log log","total length count mean median quantile quartile nCr nPr stats","stdev|standard-deviation stddev|standard-deviation","stdDev|standard-deviation stdevp|standard-deviation-population","stddevp|standard-deviation-population stdDevP|standard-deviation-population mad var|variance","varp|variance-population variance cov|co-variance covp|co-variance-population corr|correlation spearman","lcm mcm gcd mcd gcf mod ceil|ceiling floor round abs|absolute-value min max sign|signum signum sgn","sin|sine cos|cosine tan|tangent csc|co-secant sec|secant cot|co-tangent","sinh|hyperbolic-sine cosh|hyperbolic-cosine tanh|hyperbolic-tangent csch|hyperbolic-co-secant","sech|hyperbolic-secant coth|hyperbolic-co-tangent","arcsin|arc-sine arccos|arc-cosine arctan|arc-tangent arccsc|arc-co-secant arcsec|arc-secant","arccot|arc-co-tangent","arcsinh|hyperbolic-arc-sine arccosh|hyperbolic-arc-cosine arctanh|hyperbolic-arc-co-tangent","arccsch|hyperbolic-arc-co-secant arcsech|hyperbolic-arc-secant","arccoth|hyperbolic-arc-co-tangent","arsinh|hyperbolic-ar-sine arcosh|hyperbolic-ar-cosine artanh|hyperbolic-ar-co-tangent","arcsch|hyperbolic-ar-co-secant arsech|hyperbolic-ar-secant","arcoth|hyperbolic-ar-co-tangent","polygon","distance midpoint","sort shuffle join unique","erf|error-function","TTest|t-test ttest|t-test TScore|t-score tscore|t-score","iTTest|independent-t-test ittest|independent-t-test IndependentTTest","normaldist|normal-distribution tdist|t-distribution poissondist|poisson-distribution","binomialdist|binomial-distribution","uniformdist|uniform-distribution","chisqdist|chi-square-distribution","pdf cdf random inverseCdf inversecdf","histogram dotplot boxplot","pdf cdf","rgb hsv","for","width height","with",...__dcg_shared_module_exports__['Fb']].join(" "),Fme=["det|determinant","inv|inverse","transpose","rref|reduced-row-echelon-form","trace"].join(" ");h$+=" "+Fme;var Nme="alpha beta sqrt theta phi rho pi tau nthroot cbrt sum prod integral percent infinity infty cross";function jg(r){r||(r={});let e=[Nme];return r.disallowAns||e.push("ans"),r.disallowFrac||e.push("frac"),r.additionalCommands&&(e=e.concat(r.additionalCommands)),e.join(" ")}function LN(r){r||(r={});let e=h$;return r.additionalOperators&&r.additionalOperators.length&&(e=`${e} ${r.additionalOperators.join(" ")}`),r.includeGeometryFunctions&&(e+=" "+Object.keys(__dcg_shared_module_exports__['Ee']).join(" ")),r.include3DFunctions&&(e+=" "+Object.keys(__dcg_shared_module_exports__['Fe']).join(" ")),r.newStats&&(e+=" "+__dcg_shared_module_exports__['Ge'].join(" ")),e}function Ume(){return"for with"}function Yme(){let r="ln log";for(let[e,t]of Object.entries(__dcg_shared_module_exports__['pe']))t=="Trig"&&(r+=" "+e.replace(/^\\/,""));return r}function c1(r){return{autoOperatorNames:LN(r),infixOperatorNames:Ume(),prefixOperatorNames:Yme()}}var g$=window.MathQuill.noConflict().getInterface(3);g$.config({leftRightIntoCmdGoes:"up",sumStartsWithNEquals:!0,supSubsRequireOperand:!0,charsThatBreakOutOfSupSub:"+-=<>*",autoCommands:jg(),autoSubscriptNumerals:!0,restrictMismatchedBrackets:!0,typingPercentWritesPercentOf:!0,substituteTextarea:function(){if(!YE&&(Ws||Nu)){let e=document.createElement("span");return e.classList.add("dcg-mathquill-input-span"),e.setAttribute("role","textbox"),Yo(e,{display:"inline-block",height:"1px",width:"1px"}),e}if(gz&&mz){let e=document.createElement("textarea");return e.setAttribute("readonly",""),e.setAttribute("inputmode","none"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","none"),e.setAttribute("spellcheck","false"),e.setAttribute("autocomplete","off"),re(e).on("keydown",function(){this.readOnly=!1,this.select()}).on("blur",function(){this.readOnly=!0}),e}let r=document.createElement("textarea");return r.setAttribute("inputmode","none"),r.setAttribute("autocorrect","off"),r.setAttribute("autocapitalize","none"),r.setAttribute("spellcheck","false"),r.setAttribute("autocomplete","off"),r},...c1(),quietEmptyDelimiters:"( [",resetCursorOnBlur:!0,enableDigitGrouping:!0,tripleDotsAreEllipsis:!0,disableAutoSubstitutionInSubscripts:{except:"log"},interpretTildeAsSim:!0});var Pl=g$;function d1(r){let e=__dcg_shared_module_exports__['te'](r),t=0;for(;!__dcg_shared_module_exports__['ve'](e);)t+=1,e=__dcg_shared_module_exports__['ue'](e);return t}var p1=class{constructor(e,t,o){this.mathField=e;this.$mathField=t;this.props=o;this.wasFocusedLastUpdate=!1;this.$mathField.on("focusin.view focusout.view",i=>this.onFocusEvent(i))}willUnmount(){this.$mathField.off(".view")}updateMathquillFocused(){var o,i,n,a,s,c;if(!this.mathField)return;let e=this.isFocused(),t=this.shouldBeFocused();if(t&&t!==this.wasFocusedLastUpdate&&(i=(o=this.props).selectOnFocus)!=null&&i.call(o)&&((a=(n=this.mathField).select)==null||a.call(n)),this.wasFocusedLastUpdate=t,e!==t&&(t?this.mathField.focus():this.mathField.blur()),t){let d=(c=(s=this.props).focusPosition)==null?void 0:c.call(s);d==="start"?this.mathField.moveToLeftEnd():d==="end"&&this.mathField.moveToRightEnd()}}isFocused(){var e;return!!(document.activeElement&&((e=this.mathField)!=null&&e.el().contains(document.activeElement)))}shouldBeFocused(){return this.props.isFocused()}onFocusEvent(e){let t=this.isFocused();t!==this.shouldBeFocused()&&this.props.onFocusedChanged(t,e)}};var IJ=__dcg_shared_module_exports__['e'](j());var Lb=__dcg_shared_module_exports__['e'](j());var ID={IS_HOVERED:1.25,IS_PRESSED:1.125,IS_GHOSTED:.4},yk={IS_HOVERED:.5,IS_DEPRESSED:.3},PN={IS_GHOSTED:.4},GN={IS_HOVERED:.3,IS_DEPRESSED:.5},MD={IS_GHOSTED:.4},xk=1;function ol(r,e,t){let o=Intl.ListFormat;if(typeof o=="function")try{return new o(r,t).format(e)}catch(i){}return e.join(", ")}var Kme=/`[^`]*`/g,zme=/^[\+\-]?[\d]*(\.\d+)?$/,qme=r=>{if(r!=null){let e=r.match(/`/g);return(e!=null&&e.length||0)%2==0}return!0},Hme=r=>{let e=[];if(r==null||r.length==0)return e;let t=0,o;for(;o=Kme.exec(r);){let n=r.slice(t,o.index);n.length>0&&e.push({from:t,to:o.index,type:"text",text:n}),t=o.index+o[0].length,e.push({from:o.index,to:t,type:"math",text:o[0].slice(1,-1)})}let i=r.slice(t);return i.length>0&&e.push({from:t,to:r.length,type:"text",text:i}),e},f$=Pl.StaticMath(document.createElement("span"));function po(r){let e="",t=[];qme(r)?t=Hme(r):t=[{from:0,to:r.length,type:"text",text:r}];for(let o of t)e+=o.type==="text"?o.text:Mr(o.text);return e}function Mr(r){let e="";return zme.test(r)?(/^\+/.test(r)?(e="positive ",r=r.slice(1)):/^\-/.test(r)&&(e="negative ",r=r.slice(1)),e+=r.replace(/(\.)([0-9]+)/g,(t,o,i)=>o+i.split("").join(" ").trim())):(f$.latex(r),e=f$.mathspeak().trim()),e}function DD(r,e,t){let o=r.formula.typed_constant_value;if(__dcg_shared_module_exports__['ua'](o==null?void 0:o.valueType,__dcg_shared_module_exports__['Ce'])){if(__dcg_shared_module_exports__['Mb'](o))return`${fc(__dcg_shared_module_exports__['pa'](o.valueType),e.getLanguage())}. ${e.s("shared-calculator-label-list-of-count-items-suffix",{count:o.value.length})}`;switch(o.valueType){case __dcg_shared_module_exports__['B']:return Mr(__dcg_shared_module_exports__['ub'](+o.value,t));case __dcg_shared_module_exports__['_']:return Mr(__dcg_shared_module_exports__['yb'](o.value,t));case __dcg_shared_module_exports__['C']:return Mr(__dcg_shared_module_exports__['Ab'](o.value,t));case __dcg_shared_module_exports__['ja']:return Mr(__dcg_shared_module_exports__['Bb'](o.value,t));case __dcg_shared_module_exports__['H']:return up(e,r.formula.rgb_value);default:throw new Error(`Unexpected valueType ${o}`)}}}var pn=1;function u1(r,e){let t=[],o=r.formula.geometry&&r.formula.geometry.call;if(!o||!o.parents)return[];for(let i of o.parents)if(i.type==="arbitrary-expression")t.push(void 0);else{let n=__dcg_shared_module_exports__['Oc'](i),a=e.getGeoTokenInfoFromIdentifier(n);t.push(a?e.getItemModel(a.calcId):void 0)}return t}function ch(r,e={}){let t=r.formula.typed_constant_value.value,o=r.formula.typed_constant_value.valueType;return e.listIndex!==void 0&&__dcg_shared_module_exports__['qa'](o)&&(o=__dcg_shared_module_exports__['ra'](o),t=t[e.listIndex]),{value:t,valueType:o}}function AD(r,e,t){var T,E;let o=t.depth?t.depth:0,i=t.listIndex||0,n,a=[],s=(T=r.formula.geometry.call)==null?void 0:T.symbol,c=u1(r,e),[d,p]=c,{value:u}=ch(r,t),[g,h]=u,b=tl(r,i)||((E=t.poi)==null?void 0:E.ariaLabel),v=b!==void 0&&b!==""?b:r.label;if(r.hidden&&o>=pn&&typeof g=="number"&&typeof h=="number")return[Gl(e,g,h)];switch(s){case"intersection":v?n=e.s("graphing-calculator-narration-geometry-intersection-with-assignment",{assignment:po(v)}):n=e.s("graphing-calculator-narration-geometry-unlabeled-intersection",{index:r.id}),o<pn&&d!==void 0&&p!==void 0?a.push(e.s("graphing-calculator-narration-geometry-intersection-of-items",{intersectionDescription:n,item1:Vo(d,e,{includeDetails:!1,depth:o+1}),item2:Vo(p,e,{includeDetails:!1,depth:o+1})})):a.push(n);break;case"midpoint":v?n=e.s("graphing-calculator-narration-geometry-midpoint-with-assignment",{assignment:po(v)}):n=e.s("graphing-calculator-narration-geometry-unlabeled-midpoint",{index:r.id}),o<pn&&d!==void 0?a.push(e.s("graphing-calculator-narration-geometry-midpoint-of-item",{midpointDescription:n,item:Vo(d,e,{includeDetails:!1,depth:o+1})})):a.push(n);break;case"glider":v?n=e.s("graphing-calculator-narration-geometry-glider-with-assignment",{assignment:po(v)}):n=e.s("graphing-calculator-narration-geometry-unlabeled-glider",{index:r.id}),o<pn&&d!==void 0?a.push(e.s("graphing-calculator-narration-geometry-glider-on-item",{gliderDescription:n,item:Vo(d,e,{includeDetails:!1,depth:o+1})})):a.push(n);break;default:v?n=e.s("graphing-calculator-narration-geometry-point-with-assignment",{assignment:po(v)}):n=e.s("graphing-calculator-narration-geometry-unlabeled-point",{index:r.id}),t.includeDetails&&typeof g=="number"&&typeof h=="number"?a.push(e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:n,coordinates:Gl(e,g,h)})):a.push(n)}return a}function b$(r,e,t){var b,v;let o=t.listIndex?t.listIndex:0,i=t.depth?t.depth:0,n=tl(r,o),a=n?e.s("graphing-calculator-narration-geometry-circle-with-assignment",{label:po(n)}):e.s("graphing-calculator-narration-geometry-unlabeled-circle",{index:r.id}),s=[],c=u1(r,e),[d]=c,{value:p}=ch(r,t),u=p[1],g=e.get2dProjection(),h=g&&g.viewport;return i<pn&&d!==void 0&&xs(d)&&!__dcg_shared_module_exports__['Pc']((v=(b=d.formula.geometry)==null?void 0:b.call)==null?void 0:v.symbol)&&typeof u=="number"&&h!==void 0?s.push(e.s("graphing-calculator-narration-geometry-circle-with-center-and-radius",{circleDescription:a,center:Vo(d,e,{includeDetails:!1,depth:i+1}),radius:Mr(__dcg_shared_module_exports__['nb'](u,h.xmax-h.xmin).latex)})):s.push(a),s}function y$(r,e,t){let o=t.depth?t.depth:0,i=t.listIndex?t.listIndex:0,n=tl(r,i),a=n?e.s("graphing-calculator-narration-geometry-arc-with-assignment",{label:po(n)}):e.s("graphing-calculator-narration-geometry-unlabeled-arc",{index:r.id}),s=[],c=u1(r,e),[d,p,u]=c;return o<pn&&d!==void 0&&p!==void 0&&u!==void 0?s.push(e.s("graphing-calculator-narration-geometry-arc-through-points",{arcDescription:a,start:Vo(d,e,{includeDetails:!1,depth:o+1}),middle:Vo(p,e,{includeDetails:!1,depth:o+1}),end:Vo(u,e,{includeDetails:!1,depth:o+1})})):s.push(a),s}function x$(r,e,t){let o=t.depth?t.depth:0,i=t.listIndex?t.listIndex:0,n=tl(r,i),a=n?po(n):void 0,{value:s}=ch(r,t),c=s.length;if(t.polygonEdge!==void 0)if(t.polygonEdge>=0&&t.polygonEdge<s.length){let u=s[t.polygonEdge],g=s[(t.polygonEdge+1)%s.length];s=[u,g]}else return[e.s("shared-calculator-narration-item-unknown")];let d,p=[];if(c===3)d=a?e.s("graphing-calculator-narration-geometry-triangle-with-assignment",{label:a}):e.s("graphing-calculator-narration-geometry-unlabeled-triangle",{index:r.id});else if(c===4)d=a?e.s("graphing-calculator-narration-geometry-quadrilateral-with-assignment",{label:a}):e.s("graphing-calculator-narration-geometry-unlabeled-quadrilateral",{index:r.id});else if(c===5)d=a?e.s("graphing-calculator-narration-geometry-pentagon-with-assignment",{label:a}):e.s("graphing-calculator-narration-geometry-unlabeled-pentagon",{index:r.id});else if(c===6)d=a?e.s("graphing-calculator-narration-geometry-hexagon-with-assignment",{label:a}):e.s("graphing-calculator-narration-geometry-unlabeled-hexagon",{index:r.id});else if(c===7)d=a?e.s("graphing-calculator-narration-geometry-heptagon-with-assignment",{label:a}):e.s("graphing-calculator-narration-geometry-unlabeled-heptagon",{index:r.id});else if(c===8)d=a?e.s("graphing-calculator-narration-geometry-octagon-with-assignment",{label:a}):e.s("graphing-calculator-narration-geometry-unlabeled-octagon",{index:r.id});else if(c===9)d=a?e.s("graphing-calculator-narration-geometry-nonagon-with-assignment",{label:a}):e.s("graphing-calculator-narration-geometry-unlabeled-nonagon",{index:r.id});else if(c===10)d=a?e.s("graphing-calculator-narration-geometry-decagon-with-assignment",{label:a}):e.s("graphing-calculator-narration-geometry-unlabeled-decagon",{index:r.id});else{let u=a||e.s("graphing-calculator-narration-geometry-unlabeled-polygon",{index:r.id});d=e.s("graphing-calculator-narration-geometry-polygon-with-sides",{polygonDescription:u,sideCount:c})}if(t.polygonEdge!==void 0){let u=s.length>0?s[0][0]:void 0,g=s.length>0?s[0][1]:void 0,h=s.length>1?s[1][0]:void 0,b=s.length>1?s[1][1]:void 0;t.includeDetails&&o<pn&&typeof u=="number"&&typeof g=="number"&&typeof h=="number"&&typeof b=="number"?p.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates",{itemDescription:d,x1:cd(e,u),y1:dd(e,g),x2:cd(e,h),y2:dd(e,b)})):p.push(d)}else if(t.includeDetails&&o<pn){let u=[];if(c<=10){let g=u1(r,e).filter(h=>xs(h)&&h.type==="expression"&&!h.hidden&&ch(h,t).valueType===__dcg_shared_module_exports__['C']);g.length===c&&g.forEach(h=>{u.push(Vo(h,e,{includeDetails:!1,depth:o+1}))})}u.length?p.push(e.s("graphing-calculator-narration-geometry-polygon-through-vertices",{itemDescription:d,vertices:ol(e.getLanguage(),u)})):p.push(d)}else p.push(d);return p}function v$(r,e,t){var F,N,Y;let o=t.depth?t.depth:0,i="",n=[],a=(F=r.formula.geometry.call)==null?void 0:F.symbol,s=r.formula.geometry.listAccess,{value:c,valueType:d}=ch(r,t),[p,u]=c[0],[g,h]=c[1],b=u1(r,e),v=t.listIndex||0,T=tl(r,v)||r.label,E=T?po(T):void 0,[I,_]=b,C=e.get2dProjection(),D=C&&C.viewport,P=I!==void 0&&_===void 0&&s!==void 0;if(a==="parallel"){let z=E?e.s("graphing-calculator-narration-geometry-parallel-with-assignment",{label:E}):e.s("graphing-calculator-narration-geometry-unlabeled-parallel-with-index",{index:r.id});o<pn&&I!==void 0&&_!==void 0?n.push(e.s("graphing-calculator-narration-geometry-parallel-to-line-through-point",{parallelDescription:z,line:Vo(I,e,{includeDetails:!1,depth:o+1}),point:Vo(_,e,{includeDetails:!1,depth:o+1})})):r.hidden&&o>=pn?n.push(e.s("graphing-calculator-narration-geometry-hidden-parallel")):P?i=e.s("graphing-calculator-narration-geometry-unlabeled-parallel"):n.push(z)}else if(a==="perpendicular"){let z=E?e.s("graphing-calculator-narration-geometry-perpendicular-with-assignment",{label:E}):e.s("graphing-calculator-narration-geometry-unlabeled-perpendicular-with-index",{index:r.id});o<pn&&I!==void 0&&_!==void 0?n.push(e.s("graphing-calculator-narration-geometry-perpendicular-to-line-through-point",{perpendicularDescription:z,line:Vo(I,e,{includeDetails:!1,depth:o+1}),point:Vo(_,e,{includeDetails:!1,depth:o+1})})):r.hidden&&o>=pn?n.push(e.s("graphing-calculator-narration-geometry-hidden-perpendicular")):P?i=e.s("graphing-calculator-narration-geometry-unlabeled-perpendicular"):n.push(z)}else if(d===__dcg_shared_module_exports__['O']){let z=E?e.s("graphing-calculator-narration-geometry-line-with-assignment",{label:E}):e.s("graphing-calculator-narration-geometry-unlabeled-line-with-index",{index:r.id});r.hidden&&o>=pn?n.push(e.s("graphing-calculator-narration-geometry-hidden-line")):P?i=e.s("graphing-calculator-narration-geometry-unlabeled-line"):i=z}else if(d===__dcg_shared_module_exports__['Q']){let z=E?e.s("graphing-calculator-narration-geometry-ray-with-assignment",{label:E}):e.s("graphing-calculator-narration-geometry-unlabeled-ray-with-index",{index:r.id});if(r.hidden&&o>=pn?n.push(e.s("graphing-calculator-narration-geometry-hidden-ray")):P?i=e.s("graphing-calculator-narration-geometry-unlabeled-ray"):i=z,b.length===1&&(I==null?void 0:I.type)==="expression"&&(((N=I==null?void 0:I.formula.geometry)==null?void 0:N.valueType)===__dcg_shared_module_exports__['S']||((Y=I==null?void 0:I.formula.geometry)==null?void 0:Y.valueType)===__dcg_shared_module_exports__['U'])){let X=Vo(I,e,{includeDetails:!1,depth:o+1});i=e.s("graphing-calculator-narration-geometry-anglebisector-of-item",{bisectorDescription:i,item:X})}}else if(d===__dcg_shared_module_exports__['K']){if(r.hidden&&o>=pn?n.push(e.s("graphing-calculator-narration-geometry-hidden-segment")):E?i=e.s("graphing-calculator-narration-geometry-segment-with-assignment",{assignment:E}):P?i=e.s("graphing-calculator-narration-geometry-unlabeled-segment"):i=e.s("graphing-calculator-narration-geometry-unlabeled-segment-with-index",{index:r.id}),t.includeDetails&&o<pn&&!E&&s===void 0&&D!==void 0&&typeof p=="number"&&typeof u=="number"&&typeof g=="number"&&typeof h=="number"){let z=g-p,X=h-u,q=Math.sqrt(z*z+X*X);isNaN(q)||(i=e.s("graphing-calculator-narration-geometry-segment-length",{segmentDescription:i,length:Mr(__dcg_shared_module_exports__['nb'](q,D.xmax-D.xmin).latex)}))}}else if(d===__dcg_shared_module_exports__['Y']){let z=E?e.s("graphing-calculator-narration-geometry-vector-with-assignment",{label:E}):e.s("graphing-calculator-narration-geometry-unlabeled-vector-with-index",{index:r.id});r.hidden&&o>=pn?n.push(e.s("graphing-calculator-narration-geometry-hidden-vector")):P?i=e.s("graphing-calculator-narration-geometry-unlabeled-vector"):i=z}return i!==""&&o<pn&&(I!==void 0&&_!==void 0?n.push(e.s("graphing-calculator-narration-geometry-straight-from-item-to-item",{straightType:i,start:Vo(I,e,{includeDetails:!1,depth:o+1}),end:Vo(_,e,{includeDetails:!1,depth:o+1})})):P&&n.push(e.s("graphing-calculator-narration-geometry-straight-index-of-item",{straightType:i,index:s,item:Vo(I,e,{includeDetails:!1,depth:o+1})}))),!n.length&&i&&n.push(i),n}function w$(r,e,t){var v;let o=t.depth?t.depth:0,i=t.listIndex?t.listIndex:0,n="",a=[],{valueType:s}=ch(r,t),c=tl(r,i)||r.label,d="",p=(v=e.getGrapher())==null?void 0:v.getGraphSketch(r.id);if(p&&"labels"in p){let E=p.labels[i];E&&"text"in E&&(d=po(E.text))}s===__dcg_shared_module_exports__['S']?c?n=e.s("graphing-calculator-narration-geometry-labeled-angle",{label:po(c)}):d?n=e.s("graphing-calculator-narration-geometry-unlabeled-angle-with-measurement",{index:r.id,measurementText:d}):n=e.s("graphing-calculator-narration-geometry-unlabeled-angle",{index:r.id}):s===__dcg_shared_module_exports__['U']&&(c?n=e.s("graphing-calculator-narration-geometry-labeled-directed-angle",{label:po(c)}):d?n=e.s("graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement",{index:r.id,measurementText:d}):n=e.s("graphing-calculator-narration-geometry-unlabeled-directed-angle",{index:r.id}));let u=u1(r,e),[g,h,b]=u;return o<pn&&g!==void 0&&"hidden"in g&&!g.hidden&&h!==void 0&&"hidden"in h&&!h.hidden&&b!==void 0&&"hidden"in b&&!b.hidden?a.push(e.s("graphing-calculator-narration-geometry-angle-through-points",{itemDescription:n,parent1:Vo(g,e,{includeDetails:!1,depth:o+1}),parent2:Vo(h,e,{includeDetails:!1,depth:o+1}),parent3:Vo(b,e,{includeDetails:!1,depth:o+1})})):o<pn&&g!==void 0&&"hidden"in g&&!g.hidden&&h===void 0&&b===void 0?a.push(e.s("graphing-calculator-narration-geometry-angle-of-polygon",{itemDescription:n,parent:Vo(g,e,{includeDetails:!1,depth:o+1})})):a.push(n),a}function S$(r,e,t){if(r.description)return[r.description];let{value:o,valueType:i}=ch(r,t),n=[],a=o.length;switch(__dcg_shared_module_exports__['ra'](i)){case __dcg_shared_module_exports__['C']:n.push(e.s("graphing-calculator-narration-geometry-list-of-points",{count:a}));break;case __dcg_shared_module_exports__['M']:n.push(e.s("graphing-calculator-narration-geometry-list-of-circles",{count:a}));break;case __dcg_shared_module_exports__['N']:n.push(e.s("graphing-calculator-narration-geometry-list-of-arcs",{count:a}));break;case __dcg_shared_module_exports__['J']:n.push(e.s("graphing-calculator-narration-geometry-list-of-polygons",{count:a}));break;case __dcg_shared_module_exports__['O']:n.push(e.s("graphing-calculator-narration-geometry-list-of-lines",{count:a}));break;case __dcg_shared_module_exports__['Q']:n.push(e.s("graphing-calculator-narration-geometry-list-of-rays",{count:a}));break;case __dcg_shared_module_exports__['K']:n.push(e.s("graphing-calculator-narration-geometry-list-of-segments",{count:a}));break;case __dcg_shared_module_exports__['S']:n.push(e.s("graphing-calculator-narration-geometry-list-of-angles",{count:a}));break;case __dcg_shared_module_exports__['U']:n.push(e.s("graphing-calculator-narration-geometry-list-of-directed-angles",{count:a}));break;default:n.push(e.s("graphing-calculator-narration-geometry-list-of-any",{count:a}));break}return n[0]=`${n[0]}.`,n}var k$="/assets/build/black-CV4E5OZL.png";var _$="/assets/build/blue-33SYOKM2.png";var C$="/assets/build/green-KBJSCNW5.png";var T$="/assets/build/orange-RGY7S4SD.png";var E$="/assets/build/purple-RF7XMBOC.png";var I$="/assets/build/red-D46AFSKB.png";function Cb(r,e,t,o=3){let[i,n,a,s]=r,{x:c,y:d}=e.mathToPixels.mapPoint({x:i,y:n}),{x:p,y:u}=e.mathToPixels.mapPoint({x:a,y:s}),g=Math.min(o,Math.max(e.screen.width,e.screen.height)),h={xmin:-g,ymin:-g,xmax:e.screen.width+g,ymax:e.screen.height+g},b=c-p,v=d-u,T=-b,E=-v,I=c-h.xmin,_=h.xmax-c,C=d-h.ymin,D=h.ymax-d,P=[],F=[];if(b!==0){let A=I/b,O=_/T;b<0?(P.push(A),F.push(O)):(P.push(O),F.push(A))}if(v!==0){let A=C/v,O=D/E;v<0?(P.push(A),F.push(O)):(P.push(O),F.push(A))}(t===17||t===24)&&(P.push(0),F.push(1)),t===19&&P.push(0);let N=Math.max(...P),Y=Math.min(...F);if(N>Y)return{mapped:[c,d,p,u],clipped:[]};let z=c+T*N,X=d+E*N,q=c+T*Y,S=d+E*Y;return z<h.xmin&&q<h.xmin||z>h.xmax&&q>h.xmax||X<h.ymin&&S<h.ymin||X>h.ymax&&S>h.ymax?{mapped:[c,d,p,u],clipped:[]}:{mapped:[c,d,p,u],clipped:[z,X,q,S]}}var ya=class{constructor(e,t,o){this.pattern=o,this.replen=this.pattern[0]+this.pattern[1],t/this.replen>1e3&&(this.pattern[0]=t*this.pattern[0]/this.replen/1e3,this.pattern[1]=t*this.pattern[1]/this.replen/1e3),this.pstate=0,this.dstaccum=0,this.px=null,this.py=null,this.ctx=e}static getDashedPattern(e,t){let o=e.lineWidth*11/(t?3.5:2.5),i=o*7/11;return[o,i]}static getDottedPattern(e,t,o){let i=.5*e.lineWidth*.1/(o?3.5:2.5),n=i*8/.1;return t&&(n*=2),[i,n]}static getTotalSegmentLength(e){if(e.length<4)return 0;let t=0,o=0,i=e[0],n=e[1];for(;isNaN(i)||isNaN(n);){if(o+=2,o>=e.length)return 0;i=e[o],n=e[o+1]}let a,s;for(o+=2;o<e.length;o+=2)a=e[o],s=e[o+1],!(isNaN(a)||isNaN(s))&&(t+=__dcg_shared_module_exports__['k'](a-i,s-n),i=a,n=s);return t}start(e,t){this.px=e,this.py=t}next(e,t){if(this.px===null||this.py===null)throw new Error("Must call start before calling next");let o=this.pattern[this.pstate],i=Math.sqrt(Math.pow(e-this.px,2)+Math.pow(t-this.py,2));if(i>1e-5){for(;i+this.dstaccum>=o;){let n=e-this.px,a=t-this.py,s=o-this.dstaccum;n*=s/i,a*=s/i,this.pstate===0&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(this.px+n,this.py+a)),this.dstaccum=0,this.px+=n,this.py+=a,this.pstate=this.pstate===0?1:0,o=this.pattern[this.pstate],i-=s}this.pstate===0&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(e,t))}this.px=e,this.py=t,this.dstaccum+=i}close(){this.pstate=0,this.dstaccum=0,this.px=null,this.py=null}drawSegment(e){let t=0,o=e[0],i=e[1];for(;isNaN(o)||isNaN(i);){if(t+=2,t>=e.length)return;o=e[t],i=e[t+1]}this.start(o,i);let n,a;for(t+=2;t<e.length;t+=2)n=e[t],a=e[t+1],!(isNaN(n)||isNaN(a))&&this.next(n,a);this.close()}};function h1(r){let e=[[r.x0,r.y0],[r.x1,r.y1],[r.x2,r.y2]],[t,o]=__dcg_shared_module_exports__['Wb'](e),i=__dcg_shared_module_exports__['Pb'](r.x0-t,r.y0-o);return{x:t,y:o,radius:i}}function PD(r){let e=[[r.x0,r.y0],[r.x1,r.y1],[r.x2,r.y2]],[t,o]=__dcg_shared_module_exports__['Wb'](e);return{startAngle:Math.atan2(r.y0-o,r.x0-t),deltaAngle:__dcg_shared_module_exports__['Xb'](e)}}var Qme=Math.hypot&&Math.hypot(1/0,NaN)===1/0;function M$(r){return r===1/0||r===-1/0}var Xg=Qme?Math.hypot:function(r,e){if(M$(r)||M$(e))return 1/0;if(isNaN(r)||isNaN(e))return NaN;if(r===0&&e===0)return 0;if(Math.abs(r)>Math.abs(e)){let t=e/r;return Math.abs(r)*Math.sqrt(t*t+1)}else{let t=r/e;return Math.abs(e)*Math.sqrt(t*t+1)}};var D$=(r,e)=>({x:r.x-e.x,y:r.y-e.y}),efe=(r,e)=>r.x*e.x+r.y*e.y;function VD(r,e){return Xg(r.x-e.x,r.y-e.y)}function A$(r,e){let t={x:r.x1,y:r.y1},o={x:r.x2,y:r.y2},i=D$(e,t),n=D$(o,t),a=VD(t,o),s=a*a;return efe(i,n)/s}function RN(r){return[{x1:r.left,y1:r.top,x2:r.left,y2:r.bottom,extendStart:!1,extendEnd:!1},{x1:r.left,y1:r.top,x2:r.right,y2:r.top,extendStart:!1,extendEnd:!1},{x1:r.right,y1:r.top,x2:r.right,y2:r.bottom,extendStart:!1,extendEnd:!1},{x1:r.left,y1:r.bottom,x2:r.right,y2:r.bottom,extendStart:!1,extendEnd:!1}]}function tfe(r){let{angle:e,width:t,height:o,center:i}=r,n=i.x,a=i.y,s=Math.cos(-e),c=Math.sin(-e),d=t/2,p=o/2,u={x:n+s*-d-c*-p,y:a+c*-d+s*-p},g={x:n+s*d-c*-p,y:a+c*d+s*-p},h={x:n+s*d-c*p,y:a+c*d+s*p},b={x:n+s*-d-c*p,y:a+c*-d+s*p};return[{x1:u.x,y1:u.y,x2:g.x,y2:g.y,extendStart:!1,extendEnd:!1},{x1:g.x,y1:g.y,x2:h.x,y2:h.y,extendStart:!1,extendEnd:!1},{x1:h.x,y1:h.y,x2:b.x,y2:b.y,extendStart:!1,extendEnd:!1},{x1:b.x,y1:b.y,x2:u.x,y2:u.y,extendStart:!1,extendEnd:!1}]}function rfe(r,e){let t=RN(r);return!!(OD(e,t[0])||OD(e,t[1])||OD(e,t[2])||OD(e,t[3]))}function ofe(r,e){let t=RN(r);return!!(Ap(e,t[0],!1)||Ap(e,t[1],!1)||Ap(e,t[2],!1)||Ap(e,t[3],!1)||Ap(e,t[0],!0)||Ap(e,t[1],!0)||Ap(e,t[2],!0)||Ap(e,t[3],!0))}function ife(r,e){let t=RN(r);return!!($g(e,t[0],!1)||$g(e,t[1],!1)||$g(e,t[2],!1)||$g(e,t[3],!1)||$g(e,t[0],!0)||$g(e,t[1],!0)||$g(e,t[2],!0)||$g(e,t[3],!0))}function nfe(r,e){return r.left<=e.left&&r.right>=e.right&&r.top<=e.top&&r.bottom>=e.bottom}function afe(r,e){return r.left<=e.x&&e.x<=r.right&&r.top<=e.y&&e.y<=r.bottom}function RD(r,e){if(!e.extendStart){let t=r.left<=e.x1&&e.x1<=r.right,o=r.top<=e.y1&&e.y1<=r.bottom;if(t&&o)return!0}return rfe(r,e)}function R$(r,e){let t={x:e.x0,y:e.y0};return!!(afe(r,t)||ife(r,e))}function F$(r,e){let t={left:e.x-e.radius,right:e.x+e.radius,top:e.y-e.radius,bottom:e.y+e.radius};return!!(nfe(r,t)||ofe(r,e))}function sfe(r,e){let t=r.x-e.center.x,o=r.y-e.center.y,i=Math.atan2(o,t),n=Xg(t,o),a={x:n*Math.cos(i+e.angle),y:n*Math.sin(i+e.angle)};return Math.abs(a.x)<=e.width/2&&Math.abs(a.y)<=e.height/2}function N$(r,e){if(e.length<4)return!1;let t={x1:NaN,y1:NaN,x2:e[0],y2:e[1],extendStart:!1,extendEnd:!1};for(let o=2;o<e.length;o+=2)if(t.x1=t.x2,t.y1=t.y2,t.x2=e[o],t.y2=e[o+1],RD(r,t))return!0;return!1}function FD(r,e){let t=tfe(e);for(let o of t)if(RD(r,o))return!0;return!!sfe({x:r.left,y:r.top},e)}function lfe(r,e,t){let o=e.x1-r.x,i=e.x2-r.x,n=e.y1-r.y,a=e.y2-r.y,s=r.radius,c=i-o,d=a-n,p=c*c+d*d,u=o*a-i*n,g=Math.sqrt(s*s*p-u*u);if(g<0)return;let h=d>=0?1:-1,b=t?-1*h:1*h;return{x:r.x+(u*d+b*h*c*g)/p,y:r.y+(-u*c+b*Math.abs(d)*g)/p}}function cfe(r,e){let t=r.y2-r.y1,o=r.x1-r.x2,i=e.y2-e.y1,n=e.x1-e.x2,a=t*r.x1+o*r.y1,s=i*e.x1+n*e.y1,c=t*n-i*o;if(c!==0)return{x:(n*a-o*s)/c,y:(t*s-i*a)/c}}function ON(r,e){let t=A$(e,r);return!(isNaN(t)||t<0&&!e.extendStart||t>1&&!e.extendEnd)}function dfe(r,e){let{x:t,y:o}=h1(e),{startAngle:i,deltaAngle:n}=PD(e),a=Math.atan2(r.y-o,r.x-t);return __dcg_shared_module_exports__['i'](a,i,n)}function Ap(r,e,t){let o=lfe(r,e,t);if(o!=null&&ON(o,e))return o}function $g(r,e,t){let o=Ap(h1(r),e,!1)||P$,i=G$(t,V$(r,o),O$(e));if(i||(o=Ap(h1(r),e,!0)||P$,i=G$(t,V$(r,o),O$(e))),i&&dfe(o,r))return o}var P$={x:NaN,y:NaN};function OD(r,e){let t=cfe(r,e);if(t!=null&&ON(t,r)&&ON(t,e))return t}function G$(r,e,t){let o=e.x*t.y-e.y*t.x;return o>0&&r||o<0&&!r}function V$(r,e){let{x:t,y:o}=h1(r),{deltaAngle:i}=PD(r);return i>0?{x:o-e.y,y:e.x-t}:{x:e.y-o,y:t-e.x}}function O$(r){return{x:r.x2-r.x1,y:r.y2-r.y1}}function Oo(r,e){let t=r;t._dcgSaveClassName&&t._dcgSaveClassName(e)}function xo(r){let e=r;e._dcgRestoreClassName&&e._dcgRestoreClassName()}var ph,Tb=new Map,ND=0;function U$(r,e,t){let o=r.imageObj;if(ph&&ph.color===e&&ph.img===o)return ph.canvas;ph?(ph.color=e,ph.img=o):ph={color:e,img:o,canvas:document.createElement("canvas")};let i=ph.canvas,n=r.mimeType==="image/svg+xml";i.width=0,i.width=n?t.width:o.width,i.height=n?t.height:o.height;let a=i.getContext("2d");return a.drawImage(o,0,0,i.width,i.height),a.fillStyle=e,a.globalCompositeOperation="source-atop",a.fillRect(0,0,i.width,i.height),i}function ufe(r,e){if(e.width*e.height>1e3*1e3*window.devicePixelRatio*window.devicePixelRatio)return r.imageObj;let t=r.image_url,o=Tb.get(t),i;if(!o||e.width!==o.size.width||e.height!==o.size.height){o&&(Tb.delete(t),ND-=o.canvas.width*o.canvas.height);let n=r.imageObj,a=document.createElement("canvas");a.width=e.width,a.height=e.height,a.getContext("2d").drawImage(n,0,0,a.width,a.height);let c=20*1e3*1e3;if(a.width*a.height>c)return r.imageObj;for(ND+=a.width*a.height;ND>c;){let[d,p]=Array.from(Tb)[0];Tb.delete(d),ND-=p.canvas.width*p.canvas.height}Tb.set(t,{canvas:a,size:e}),i=a}else Tb.delete(t),Tb.set(t,o),i=o.canvas;return i}function Y$(r,e,t,o={cacheRenderedSvgs:!1}){let{ctx:i,projection:n}=r,a=e.formula;if(!a||!a.dimensions.x)return;let s=a.dimensions;for(let c=0;c<s.x.length;c++){let d=s.x[c],p=s.y[c],u=s.width[c],g=s.height[c],h=s.radianAngle[c];if(!isFinite(d)||!isFinite(p)||!isFinite(u)||!isFinite(g)||!isFinite(h))continue;Oo(i,"dcg-svg-image"),i.save(),xo(i),i.globalAlpha=s.opacity[c];let b=n.mapy(g)-n.mapy(0),v=n.mapx(u)-n.mapx(0),T=h===0?1:Math.abs(v/u*(g/b)),E=n.mapx(d),I=n.mapy(p),_=E-v/2,C=I+b*T/2,D=g<0?-1:1,P=u<0?-1:1,F=_*P,N=C*D,Y=Math.abs(v),z=Math.abs(b);h!==0&&(i.translate(E,I),i.scale(1,1/T),i.rotate(h),i.translate(-E,-I)),i.scale(P,D);let X=t.shouldDrawHovered(r,e.id,c),q=t.shouldDrawPressed(e.id,c),S=o.currentKeyboardAttention&&o.currentKeyboardAttention.calcId===e.id&&(o.currentKeyboardAttention.listIndex===void 0||o.currentKeyboardAttention.listIndex===c),O=e.imageObj,B=window.devicePixelRatio*(n.screen.width/n.screen.height),V={width:Math.floor(Y*B),height:Math.floor(z*B)};q?e.depressedImageObj?O=e.depressedImageObj:O=U$(e,"rgba(50,50,50,0.2)",V):X?e.hoveredImageObj?O=e.hoveredImageObj:O=U$(e,"rgba(200,200,200,0.2)",V):o.cacheRenderedSvgs&&e.mimeType==="image/svg+xml"&&V.width>0&&V.height>0&&(O=ufe(e,V)),i.drawImage(O,F,N,Y,z*T);let K=0,oe=3;if(Mn(e)&&e.controller.isTraceEnabled()&&(i.beginPath(),i.rect(F-K,N-K,Y+2*K,z*T+2*K),i.restore(),i.save(),i.strokeStyle="#6993C7",i.lineWidth=oe,i.stroke()),S){let Z=i.globalAlpha;K=5,i.beginPath(),i.roundRect?i.roundRect(F-K,N-K,Y+2*K,z*T+2*K,K):i.rect(F-K,N-K,Y+2*K,z*T+2*K),i.restore(),i.save(),i.strokeStyle=__dcg_shared_module_exports__['zd'].FOCUS_OUTLINE,i.globalAlpha=1,i.lineWidth=oe,i.stroke(),i.globalAlpha=Z}i.restore()}}function UD(r,e,t=0){let o=e.formula;if(!o||!o.dimensions.x)return!1;let i=o.dimensions,n=i.x[t],a=i.y[t],s=i.width[t],c=i.height[t],d=i.radianAngle[t];if(!isFinite(n)||!isFinite(a)||!isFinite(s)||!isFinite(c)||!isFinite(d))return!1;let p=r.mapx(n),u=r.mapy(a),g=Math.abs(r.mapx(s)-r.mapx(0)),h=Math.abs(r.mapy(c)-r.mapy(0)),b={center:{x:p,y:u},width:g,height:h,angle:d},v={left:0,top:0,right:r.screen.width,bottom:r.screen.height};return FD(v,b)}function B$(r){return r.uncommitted?"#ccc":!r.selected&&!r.hovered&&K$(r)===1?__dcg_shared_module_exports__['sd'](r.color,.2):r.color}function K$(r){let e=.6;return r.hidden?r.selected?e=.4:e=.25:r.selected||r.isPoint?e=1:r.hovered&&(e=.8),r.isTransparentObject&&(e*=.3),e}function hfe(r){return r.hidden?r.isPoint?0:r.selected?.3:.2:r.selected||r.isPoint||r.hovered?1:.7}function z$(r,e){r=r.replace(/#/,"");let t,o,i;return r.length===3?(t=parseInt(r.slice(0,1)+r.slice(0,1),16),o=parseInt(r.slice(1,2)+r.slice(1,2),16),i=parseInt(r.slice(2,3)+r.slice(2,3),16)):r.length===6?(t=parseInt(r.slice(0,2),16),o=parseInt(r.slice(2,4),16),i=parseInt(r.slice(4,6),16)):(t=0,o=0,i=0),`rgba(${t}, ${o}, ${i}, ${e})`}function vk(r){return z$(B$(r),hfe(r))}function YD(r){return z$(B$(r),K$(r))}function BD(r){return Math.abs(Math.abs(r)-Math.PI/2)<1e-6}function _s(r,e){let t=r;t._dcgStartNamedGroup&&t._dcgStartNamedGroup(e)}function wk(r,e){let t=r;t._dcgSetTitle&&t._dcgSetTitle(e)}function Cs(r){let e=r;e._dcgEndNamedGroup&&e._dcgEndNamedGroup()}var Jg=10,Zg=3;function zD(r,e){return r+1e-8*(e-r)>r&&e-r>1e-300&&e-r<1e300}function q$(r,e){return r>1e-300&&zD(r,e)}var Or=class r{constructor(e=-10,t=10,o=-10,i=10,n=-2,a=2){this.xmin=e,this.xmax=t,this.ymin=o,this.ymax=i,this.zmin=n,this.zmax=a}static fromObject({xmin:e,xmax:t,ymin:o,ymax:i,zmin:n,zmax:a}){return new r(e,t,o,i,n,a)}toObject(){return{xmin:this.xmin,ymin:this.ymin,zmin:this.zmin,xmax:this.xmax,ymax:this.ymax,zmax:this.zmax}}equals(e){return!(this.xmin!==e.xmin||this.ymin!==e.ymin||this.zmin!==e.zmin||this.xmax!==e.xmax||this.ymax!==e.ymax||this.zmax!==e.zmax)}isXValid(e){return e==="linear"?zD(this.xmin,this.xmax):q$(this.xmin,this.xmax)}isYValid(e){return e==="linear"?zD(this.ymin,this.ymax):q$(this.ymin,this.ymax)}isZValid(){return this.zmin===void 0||this.zmax===void 0?!1:zD(this.zmin,this.zmax)}isValid(e){return this.isXValid(e.xAxisScale)&&this.isYValid(e.yAxisScale)}isSquare(e,t){return Math.abs(e.height-e.width*this.aspectRatio(t))<1}isSquare3D(){let{xmin:e,xmax:t,ymin:o,ymax:i,zmin:n,zmax:a}=this;if(n===void 0||a===void 0)return!1;let s=[t-e,i-o,a-n];return Math.min(...s)/Math.max(...s)>.99999}aspectRatio(e){let t=Jg/Zg,o=e.yAxisScale==="linear"?this.ymax-this.ymin:Math.log10(this.ymax/this.ymin)*t,i=e.xAxisScale==="linear"?this.xmax-this.xmin:Math.log10(this.xmax/this.xmin)*t;return o/i}getSquaredAxisLimits({axis:e,screen:t,settings:o}){let[i,n,a,s,c]=e==="y"?[{min:this.ymin,max:this.ymax},{min:this.xmin,max:this.xmax},t.height/t.width,o.yAxisScale,o.xAxisScale]:[{min:this.xmin,max:this.xmax},{min:this.ymin,max:this.ymax},t.width/t.height,o.xAxisScale,o.yAxisScale];if(s==="logarithmic"){let p=c==="logarithmic"?Math.log(n.max)-Math.log(n.min):(n.max-n.min)*Zg/(Jg*Math.LOG10E),{min:u,max:g}=H$({min:Math.log(i.min),max:Math.log(i.max)},a*p);return{min:Math.exp(u),max:Math.exp(g)}}let d=c==="logarithmic"?(Math.log10(n.max)-Math.log10(n.min))*Jg/Zg:n.max-n.min;return H$(i,d*a)}squareXAxis(e,t){let{min:o,max:i}=this.getSquaredAxisLimits({axis:"x",screen:e,settings:t}),n=new r(o,i,this.ymin,this.ymax);return n.isXValid(t.xAxisScale)?n:this}squareYAxis(e,t){let{min:o,max:i}=this.getSquaredAxisLimits({axis:"y",screen:e,settings:t}),n=new r(this.xmin,this.xmax,o,i);return n.isYValid(t.yAxisScale)?n:this}squareCrop(e,t){return this.aspectRatio({xAxisScale:t.xAxisScale,yAxisScale:t.yAxisScale})>e.height/e.width?this.squareYAxis(e,t):this.squareXAxis(e,t)}polarDiameter(){let e=Math.abs(this.xmax),t=Math.abs(this.xmin),o=Math.abs(this.ymax),i=Math.abs(this.ymin);return 1.5*Math.max(e,t,o,i)}largestR(){return Math.sqrt(Math.pow(Math.max(-this.xmin,this.xmax),2)+Math.pow(Math.max(-this.ymin,this.ymax),2))}smallestR(){return this.xmin<=0&&this.xmax>=0&&this.ymin<=0&&this.ymax>=0?0:this.xmin<=0&&this.xmax>=0?Math.min(Math.abs(this.ymin),Math.abs(this.ymax)):this.ymin<=0&&this.ymax>=0?Math.min(Math.abs(this.xmin),Math.abs(this.xmax)):Math.sqrt(Math.pow(Math.max(this.xmin,-this.xmax),2)+Math.pow(Math.max(this.ymin,-this.ymax),2))}};function H$(r,e){let t=.5*(r.min+r.max),[o,i]=[t-.5*e,t+.5*e];return Math.abs((i-o)/e-1)>.1?{min:-.5*e,max:.5*e}:{min:o,max:i}}var NN=1.4,j$=1.5,qD={};function bfe(){return!!Object.keys(qD).length}var Z$=function(r,e){let t=3;return e&&(t+=e),new Or(-t,r.width+t,-t,r.height+t)};function X$(r,e){let{displayAsRightAngle:t,rx:o,ry:i,startAngle:n,deltaAngle:a,yscreen:s,xscreen:c}=r;if(t){let d=o*Math.cos(-n),p=o*Math.cos(-n-a),u=i*Math.sin(-n),g=i*Math.sin(-n-a);e.moveTo(c+d,s+u),e.lineTo(c+d+p,s+u+g),e.lineTo(c+p,s+g)}else e.ellipse(c,s,o,i,0,-n,-n-a,a>0)}var ud=class r{constructor(e,t,o){if(this.controller=e,this.getExpressionAriaLabel=o,t.config.plaidMode){let i=["RED","BLUE","GREEN","PURPLE","ORANGE","BLACK"],n={RED:I$,BLUE:_$,GREEN:C$,PURPLE:E$,ORANGE:T$,BLACK:k$};for(let a of i)qD[__dcg_shared_module_exports__['zd'][a]]=document.createElement("img"),qD[__dcg_shared_module_exports__['zd'][a]].setAttribute("src",n[a])}}redrawToCtx(e,t,o,i,n,a){let{ctx:s,projection:c}=e;_s(s,"expressions");let d=c.settings.highlight,p=this.controller.isGeometry();i.forEach(u=>{let g=t[u],h=o[u];g!==void 0&&(p&&c.settings.setProperty("highlight",g.showHighlight),_s(s,"sketch"),c.settings.takingScreenshot&&wk(s,this.getExpressionAriaLabel(u)),r.drawSketchToCtx({sketch:t[u],drawContext:e,poiLabelsLayer:n,clickableObjectsLayer:a,geometryContext:this.controller.getGeoModel()}),Cs(s)),h&&h.shouldGraph&&Y$(e,h,a,{currentKeyboardAttention:this.controller.get2dPOIController().keyboardAttentionManager.getKeyboardAttention(),cacheRenderedSvgs:this.controller.getGraphSettings().config.cacheRenderedSvgs})}),Cs(s),c.settings.setProperty("highlight",d)}static eachSegment(e,t){for(let o of e.branches)if(o.graphMode!==15)for(let i of o.segments)t(o,i)}static drawSketchToCtx({sketch:e,drawContext:t,poiLabelsLayer:o,clickableObjectsLayer:i,geometryContext:n}){var h,b,v,T,E;if(!e.branches||!e.branches.length)return;let{ctx:a,projection:s}=t,c=a.lineWidth,d=a.globalAlpha,p=s.settings.globalCurveColor?s.settings.globalCurveColor:e.color,u=qD[p],g;u&&u.complete&&u.naturalWidth>0?g=a.createPattern(u,"repeat"):g=p,a.lineJoin="round",a.lineCap="round";for(let I of e.branches){if(__dcg_shared_module_exports__['od'](I)||I.graphMode===15||I.graphMode===22)continue;let _=1;i.shouldDrawHovered(t,e.id,I.listIndex)&&(_=ID.IS_HOVERED),i.shouldDrawPressed(e.id,I.listIndex)&&(_=ID.IS_PRESSED),i.shouldDrawGhosted(e.id)&&(_=ID.IS_GHOSTED),_*=(h=n==null?void 0:n.getToolFadeOpacity(e.id))!=null?h:1,_*=s.settings.getFillOpacityMultiplier(),a.strokeStyle=p,a.fillStyle=I.color&&!s.settings.globalCurveColor&&!bfe()?I.color:g,I.graphMode!==6&&(a.desmos_batching=!0,a.beginPath());let C=I.graphMode===6?.2:(b=I.fillOpacity)!=null?b:NaN;a.globalAlpha=r._clampedOpacity(C*_,.4);let D=UN(s,I);for(let P of D)r.fillPolygonFillToCtx(a,P);I.graphMode!==6&&(a.fill(),a.desmos_batching=!1),a.globalAlpha=1;for(let P of I.segments){let F=2;I.graphMode&&(F=I.graphMode);let N=P,Y=I.lineWidth!==void 0,z=I.lineWidth,X=2.5,q=(v=I.arrowMode)!=null?v:__dcg_shared_module_exports__['Md'].DEFAULT;if(a.strokeStyle=I.color,a.fillStyle=I.color,Y&&(z<=0||!isFinite(z)))continue;a.lineWidth=Y?z:X;let S=s.settings.graphLineWidth/X,A=1.3;s.settings.highlight&&(A*=5/7),e.tokenSelected?(S*=j$,A/=j$):e.tokenHovered&&(S*=NN,A/=NN),a.lineWidth*=S,a.globalAlpha*=s.settings.curveOpacity,a.globalAlpha=r._clampedOpacity(s.settings.curveOpacity===1?1:I.lineOpacity,1);let O=I.operator,B="default";O==="<"||O===">"||O==="!="?B=__dcg_shared_module_exports__['Dd'].DASHED:O==="<="||O===">="?B=__dcg_shared_module_exports__['Dd'].SOLID:e.style===__dcg_shared_module_exports__['Dd'].DASHED||I.style===__dcg_shared_module_exports__['Dd'].DASHED?B=__dcg_shared_module_exports__['Dd'].DASHED:(e.style===__dcg_shared_module_exports__['Dd'].DOTTED||I.style===__dcg_shared_module_exports__['Dd'].DOTTED)&&(B=__dcg_shared_module_exports__['Dd'].DOTTED,Y&&(a.lineWidth*=2)),a.globalAlpha*=(T=n==null?void 0:n.getToolFadeOpacity(e.id))!=null?T:1;let V=!I.isIntersectionExtension&&i.shouldDrawHovered(t,e.id,I.listIndex),K=!I.isIntersectionExtension&&i.shouldDrawPressed(e.id,I.listIndex),oe=i.shouldDrawGhosted(e.id);oe?a.globalAlpha*=PN.IS_GHOSTED:(K||V)&&(a.save(),a.lineWidth+=4.5,a.globalAlpha*=K?yk.IS_DEPRESSED:yk.IS_HOVERED,r.drawGraphStrokeToCtx(a,s,N,{type:B,graphMode:F,op:O,arrowMode:q,arrowHeadBaseWidth:(a.lineWidth-4.5)*A,opacityMultiplier:K?yk.IS_DEPRESSED:yk.IS_HOVERED}),a.restore()),r.drawGraphStrokeToCtx(a,s,N,{type:B,graphMode:F,op:O,arrowMode:q,arrowHeadBaseWidth:a.lineWidth*A,opacityMultiplier:((E=n==null?void 0:n.getToolFadeOpacity(e.id))!=null?E:1)*(oe?PN.IS_GHOSTED:xk)})}}a.lineWidth=c,a.globalAlpha=d,a.strokeStyle=p,a.fillStyle=p,r.eachSegment(e,(I,_)=>{var C,D;if((I.graphMode===3||I.graphMode===25)&&I.showPoint){let P=_,F=[],N;if(I.interactiveLabel&&e.labels)for(let Z=0,ee=e.labels.length;Z<ee;Z++){let ue=e.labels[Z];if(ue.type==="poi"){let he=o.isOpenPOI(ue.poi),ae=o.getHoveredPOI()===ue.poi;F.push(he||ae),!he&&ae&&(N=Z)}}let Y=1;typeof I.pointSize=="number"?Y=I.pointSize/8:Array.isArray(I.pointSize)&&(Y=I.pointSize.map(Z=>Z/8));let z;Array.isArray(I.color)&&(z=I.color);let X=Array.isArray(I.pointOutline)?!!I.pointOutline[0]:!!I.pointOutline,q=i.shouldDrawGhosted(e.id),S=!q&&i.shouldDrawHovered(t,e.id,void 0),A=i.getHoveredObjectById(e.id),O=i.getPressedObject(),B=O==null?void 0:O.listIndex,V=!q&&i.shouldDrawPressed(e.id,B);V||(B=void 0);let K=I.droppedIndices,oe=S?A==null?void 0:A.listIndexes:void 0;r.drawPointsToCtx({ctx:a,projection:s,segment:P,style:(C=I.style)!=null?C:__dcg_shared_module_exports__['Cd'].POINT,sizeOverrideIdxs:F,opacityOverrideIdx:N,sizeFactor:Y,opacityFactor:((D=n==null?void 0:n.getToolFadeOpacity(e.id))!=null?D:1)*(q?MD.IS_GHOSTED:xk),colorOverrides:z,baseOpacity:I.pointOpacity,droppedIndices:K,sketch:e,enableWhiteOutlines:X,showHovered:S,showDepressed:V,hoveredIndexes:oe,pressedIndex:B})}})}static drawGraphStrokeToCtx(e,t,o,i){let n={arrowHeadBaseWidth:e.lineWidth},{type:a,graphMode:s,op:c,arrowMode:d,arrowHeadBaseWidth:p}=Object.assign({},n,i);if(s===20||s===21){let[v,T,E]=o,I=t.mathToPixels.mapX(v),_=t.mathToPixels.mapY(T),C=t.mathToPixels.dangerouslyGetXScaleFactor(),D=t.mathToPixels.dangerouslyGetYScaleFactor(),P=Math.abs(E*C),F=Math.abs(E*D),N,Y;if(s===21?(N=-o[3],Y=-o[4]):(N=0,Y=2*Math.PI),e.save(),Oo(e,"dcg-svg-curve"),e.desmos_batching||e.beginPath(),a===__dcg_shared_module_exports__['Dd'].DASHED){let z=ya.getDashedPattern(e,!!t.settings.highlight);e.setLineDash(z)}else if(a===__dcg_shared_module_exports__['Dd'].DOTTED){let z=ya.getDottedPattern(e,!!t.settings.config.projectorMode,!!t.settings.highlight);e.setLineDash(z)}e.ellipse(I,_,P,F,0,N,Y,N>Y),e.desmos_batching||e.stroke(),xo(e),e.restore();return}else if(s===23){let[v,T,E,I,_]=o,C=!_&&BD(I),D=tm(I,t),P=t.mathToPixels.mapX(v),F=t.mathToPixels.mapY(T),N=t.mathToPixels.dangerouslyGetXScaleFactor(),Y=t.mathToPixels.dangerouslyGetYScaleFactor(),z=N>Y?N/Y:1,X=N>Y?1:Y/N,q=Math.abs(z*D),S=Math.abs(X*D);if(e.save(),Oo(e,"dcg-svg-curve"),e.globalAlpha=.4*i.opacityMultiplier,e.desmos_batching||e.beginPath(),e.moveTo(P,F),e.lineTo(P+q*Math.cos(-E),F+S*Math.sin(-E)),X$({displayAsRightAngle:C,rx:q,ry:S,startAngle:E,deltaAngle:I,yscreen:F,xscreen:P},e),e.lineTo(P,F),!e.desmos_batching&&!_&&e.fill(),e.globalAlpha=i.opacityMultiplier,e.desmos_batching||e.beginPath(),X$({displayAsRightAngle:C,rx:q,ry:S,startAngle:E,deltaAngle:I,yscreen:F,xscreen:P},e),_){let A=-E-I,O=P+q*Math.cos(A),B=F+S*Math.sin(A);YN(e,O,B,-E,-I,10,q)}e.globalAlpha=i.opacityMultiplier,e.desmos_batching||e.stroke(),e.lineWidth=1.5,e.globalAlpha=.2*i.opacityMultiplier,e.moveTo(P+1.5*q*Math.cos(-E),F+1.5*S*Math.sin(-E)),e.lineTo(P,F),e.lineTo(P+1.5*q*Math.cos(-E-I),F+1.5*S*Math.sin(-E-I)),e.stroke(),xo(e),e.restore()}else if(s===17||s===18||s===19||s===24){let{clipped:v,mapped:T}=Cb(o,t,s,e.lineWidth);if(v.length===0)return;let[E,I,_,C]=v,[D,P,F,N]=T;e.save(),Oo(e,"dcg-svg-curve");let Y;if(e.desmos_batching||e.beginPath(),a==__dcg_shared_module_exports__['Dd'].DASHED?(Y=new ya(e,ya.getTotalSegmentLength(v),ya.getDashedPattern(e,!!t.settings.highlight)),Y.drawSegment(v)):a==__dcg_shared_module_exports__['Dd'].DOTTED?(Y=new ya(e,ya.getTotalSegmentLength(v),ya.getDottedPattern(e,!!t.settings.config.projectorMode,!!t.settings.highlight)),Y.drawSegment(v)):(e.moveTo(E,I),e.lineTo(_,C)),s===17){let z=$$(a)*p,{startArrow:X,endArrow:q}=wfe(vfe(s,d));X&&pd(e,F,N,D,P,z),q&&pd(e,D,P,F,N,z)}else if(s===24&&(D!==F||P!==N)){let z=$$(a)*p;pd(e,D,P,F,N,z)}e.desmos_batching||e.stroke(),xo(e),e.restore();return}let u=ck(s,c!=="=",t.settings),g=qg(o,t.mathToPixels,u),h=Cj(g,Z$(t.screen,e.lineWidth));if(h.length===0)return;e.save(),Oo(e,"dcg-svg-curve");let b;if(e.desmos_batching||e.beginPath(),a==__dcg_shared_module_exports__['Dd'].DASHED)b=new ya(e,ya.getTotalSegmentLength(h),ya.getDashedPattern(e,!!t.settings.highlight)),b.drawSegment(h);else if(a==__dcg_shared_module_exports__['Dd'].DOTTED)b=new ya(e,ya.getTotalSegmentLength(h),ya.getDottedPattern(e,!!t.settings.config.projectorMode,!!t.settings.highlight)),b.drawSegment(h);else if((a===__dcg_shared_module_exports__['Dd'].SOLID||a==="default")&&e.lineWidth===1)if(h.length>4||h[0]!==h[2]&&h[1]!==h[3]){e.moveTo(h[0],h[1]);for(let T=0;T<h.length;T+=2)e.lineTo(h[T],h[T+1])}else{e.moveTo(__dcg_shared_module_exports__['r'](h[0]),__dcg_shared_module_exports__['r'](h[1]));for(let T=0;T<h.length;T+=2)e.lineTo(__dcg_shared_module_exports__['r'](h[T]),__dcg_shared_module_exports__['r'](h[T+1]))}else{e.moveTo(h[0],h[1]);for(let v=0;v<h.length;v+=2)e.lineTo(h[v],h[v+1])}e.desmos_batching||e.stroke(),xo(e),e.restore()}static mapPointToScreen(e,t,o){let n=e.mapx(t);if(n<-20||n>e.screen.width+20)return null;let a=e.mapy(o);return a<-20||a>e.screen.height+20?null:{x:n,y:a}}static drawPoint(e,t,o,i,n,a,s){let c={type:"animation",percent:0};if(a||s){let d=e.globalAlpha;s?e.globalAlpha*=GN.IS_DEPRESSED:a&&(e.globalAlpha*=GN.IS_HOVERED);let p=this.hoveredRadius(i,t);n&&(p+=1.5),this.drawPointShape(e,t,o,p,i,c),e.globalAlpha=d}if(n){let d=e.fillStyle;e.fillStyle="white";let p={type:"outline"};this.drawPointShape(e,t,o,i,i,p),e.fillStyle=d}this.drawPointShape(e,t,o,i,i,c)}static drawMoveablePoint(e,t,o,i,n,a,s){if(n){let p=e.fillStyle;e.fillStyle="white",this.drawPointShape(e,t,o,i,i,{type:"outline"}),e.fillStyle=p}let c=e.globalAlpha;e.globalAlpha*=.35,this.drawPointShape(e,t,o,i,i,{type:"halo"}),e.globalAlpha=c;let d=a?.7*i+.3*__dcg_shared_module_exports__['ne'](i):i;this.drawPointShape(e,t,o,d,i,{type:"animation",percent:s})}static hoveredRadius(e,t){switch(t){case __dcg_shared_module_exports__['Cd'].CROSS:case __dcg_shared_module_exports__['Cd'].PLUS:case __dcg_shared_module_exports__['Cd'].TRIANGLE:case __dcg_shared_module_exports__['Cd'].DIAMOND:case __dcg_shared_module_exports__['Cd'].STAR:return 1.5*1.1*e;default:return 1.5*e}}static moveablePointHalo(e,t){let o=__dcg_shared_module_exports__['ne'](e);return t===__dcg_shared_module_exports__['Cd'].CROSS?o*=1.1:t===__dcg_shared_module_exports__['Cd'].SQUARE?o*=.93:t===__dcg_shared_module_exports__['Cd'].STAR&&(o*=1.05),o}static outlineWidth(e){return e===__dcg_shared_module_exports__['Cd'].CROSS?2:e===__dcg_shared_module_exports__['Cd'].SQUARE?1.4:e===__dcg_shared_module_exports__['Cd'].PLUS?2.25:e===__dcg_shared_module_exports__['Cd'].STAR?3.5:e===__dcg_shared_module_exports__['Cd'].DIAMOND?2:e===__dcg_shared_module_exports__['Cd'].TRIANGLE?2.25:1.5}static drawPointShape(e,t,o,i,n,a){if(i<=0)return;let s=this.moveablePointHalo(i,t),c=i>n,d=i;a.type==="animation"?d=i+(s-i)*a.percent:a.type=="halo"?d=s:a.type==="outline"&&(d=i+this.outlineWidth(t));let p=a.type==="halo"||a.type==="animation"&&a.percent>0,u=a.type==="outline"?i:void 0,g=c||p;if(t===__dcg_shared_module_exports__['Cd'].STAR){let h=0;c&&(h=.4,d*=1.1),p&&(h=.5),this.drawStar(e,o,h,d,u)}else if(t===__dcg_shared_module_exports__['Cd'].SQUARE){let h=[[-1,-1],[-1,1],[1,1],[1,-1]];this.drawFilledPoint(e,h,o,d,g?.2:0,u)}else if(t===__dcg_shared_module_exports__['Cd'].TRIANGLE){let h=[[0,-1.4],[-1.212442,.7],[1.212442,.7]];this.drawFilledPoint(e,h,o,d,g?.2:0,u)}else if(t===__dcg_shared_module_exports__['Cd'].DIAMOND){let h=[[-1.2,0],[0,1.2],[1.2,0],[0,-1.2]];this.drawFilledPoint(e,h,o,d,g?.2:0,u)}else if(t===__dcg_shared_module_exports__['Cd'].PLUS){let h=n,b=(d*1.2-n*.5)/2;p&&(h=Math.max(h,b)),e.beginPath(),this.drawPlus(e,o,h,b);let v=(i*1.2-n*.5)/2;a.type==="outline"&&this.drawPlus(e,o,h,v),e.closePath(),e.fill("evenodd")}else if(t===__dcg_shared_module_exports__['Cd'].CROSS){let h=n*Math.SQRT1_2,b=(d*1.2-n*.5)/2;p&&(h=Math.max(h,b/1.5)),e.beginPath(),this.drawCross(e,o,h,b);let v=(i*1.2-n*.5)/2;a.type==="outline"&&this.drawCross(e,o,h,v),e.closePath(),e.fill("evenodd")}else if(t===__dcg_shared_module_exports__['Cd'].OPEN){let h=a.type==="outline"?i:i/2;if(this.drawCircle(e,o,d,h),a.type==="animation"){let b=i+(s-i)*a.percent*.5,v=e.fillStyle;e.fillStyle="white",this.drawCircle(e,o,b/2),e.fillStyle=v}}else this.drawCircle(e,o,d,u)}static drawFilledPoint(e,t,o,i,n,a){let s=t.length;if(e.beginPath(),n>0){let c=1-n,d=t[0][0]+n*(t[1][0]-t[0][0]),p=t[0][1]+n*(t[1][1]-t[0][1]);e.moveTo(o.x+d*i,o.y+p*i);for(let u=1;u<=s;u++){let g=i*t[u-1][0],h=i*t[u-1][1],b=i*t[(u+1)%s][0],v=i*t[(u+1)%s][1],T=i*t[u%s][0],E=i*t[u%s][1];this.drawRoundedCorner(e,o,c,g,h,b,v,T,E)}}else{e.moveTo(o.x+t[0][0]*i,o.y+t[0][1]*i);for(let c=1;c<s;c++)e.lineTo(o.x+t[c][0]*i,o.y+t[c][1]*i)}if(a){e.moveTo(o.x+t[s-1][0]*a,o.y+t[s-1][1]*a);for(let c=s-2;c>=0;c--)e.lineTo(o.x+t[c][0]*a,o.y+t[c][1]*a)}e.closePath(),e.fill()}static drawStar(e,t,o,i,n){let a=o>0,s=[[0,.5],[.76942,1.059015],[.47553,.15451],[1.24495,-.40451],[.293895,-.40451],[0,-1.309015],[-.293895,-.40451],[-1.24495,-.40451],[-.47553,.15451],[-.76942,1.059015]];if(a){e.beginPath(),e.moveTo(t.x+s[0][0]*i,t.y+s[0][1]*i);let c=s.length;for(let d=1;d<c;d++)if(d%2===0)e.lineTo(t.x+s[d][0]*i,t.y+s[d][1]*i);else{let p=1-o,u=i*s[d-1][0],g=i*s[d-1][1],h=i*s[(d+1)%c][0],b=i*s[(d+1)%c][1],v=i*s[d][0],T=i*s[d][1];this.drawRoundedCorner(e,t,p,u,g,h,b,v,T)}e.closePath(),e.fill()}else this.drawFilledPoint(e,s,t,i,0,n)}static drawRoundedCorner(e,t,o,i,n,a,s,c,d){let p=i+o*(c-i),u=n+o*(d-n),g=c+(1-o)*(a-c),h=d+(1-o)*(s-d),b=(p+g)/2,v=(u+h)/2,T=Math.hypot(p-b,u-v),E=Math.hypot(c-b,d-v),I=T*T/E,_=b+I*(b-c)/E,C=v+I*(v-d)/E,D=Math.atan2(u-C,p-_),P=Math.atan2(h-C,g-_),F=Math.hypot(_-p,C-u);e.lineTo(t.x+p,t.y+u),e.arc(t.x+_,t.y+C,F,D,P,!0)}static drawPlus(e,t,o,i){let n=Math.PI;e.moveTo(t.x+i,t.y-i),e.arc(t.x+o,t.y,i,-n/2,n/2),e.lineTo(t.x+i,t.y+i),e.arc(t.x,t.y+o,i,0,n),e.lineTo(t.x-i,t.y+i),e.arc(t.x-o,t.y,i,n/2,-n/2),e.lineTo(t.x-i,t.y-i),e.arc(t.x,t.y-o,i,n,0)}static drawCross(e,t,o,i){let n=Math.PI;e.moveTo(t.x+i*Math.SQRT2,t.y),e.arc(t.x+o,t.y+o,i,-n/4,-5*n/4),e.lineTo(t.x,t.y+i*Math.SQRT2),e.arc(t.x-o,t.y+o,i,-7*n/4,-3*n/4),e.lineTo(t.x-i*Math.SQRT2,t.y),e.arc(t.x-o,t.y-o,i,3*n/4,-n/4),e.lineTo(t.x,t.y-i*Math.SQRT2),e.arc(t.x+o,t.y-o,i,-3*n/4,n/4)}static drawCircle(e,t,o,i){e.beginPath(),e.arc(t.x,t.y,o,0,2*Math.PI),i&&e.arc(t.x,t.y,i,0,2*Math.PI,!0),e.closePath(),e.fill()}static drawPointToCtx(e){let{ctx:t,projection:o,sketch:i,x:n,y:a}=e,{sizeFactor:s,hovered:c,pressed:d}=e,p=t.globalAlpha,u=r.mapPointToScreen(o,n,a);if(!u||e.sizeFactor!==void 0&&(e.sizeFactor<=0||!isFinite(e.sizeFactor)))return!1;Oo(t,"dcg-svg-point"),e.alpha!==void 0?t.globalAlpha=e.alpha:t.globalAlpha=.9,e.opacityFactor!==void 0&&(t.globalAlpha*=e.opacityFactor);let g=o.settings.pointLineWidth;e.overrideSize&&(g=o.settings.config.projectorMode?17:11),s!=null||(s=1),i.tokenSelected?s*=1.5:i.tokenHovered&&(s*=NN),g*=s,e.colorOverride&&(t.fillStyle=e.colorOverride,t.strokeStyle=e.colorOverride);let h=g*.5,b=e.style,v=e.enableWhiteOutline;return this.drawPoint(t,b,u,h,v,c,d),xo(t),t.globalAlpha=p,!0}static drawPointsToCtx(e){let{ctx:t,projection:o,segment:i,style:n,droppedIndices:a}=e,{sizeOverrideIdxs:s,opacityOverrideIdx:c,baseOpacity:d}=e,{showHovered:p,showDepressed:u,hoveredIndexes:g}=e,{colorOverrides:h,sizeFactor:b,opacityFactor:v,pressedIndex:T}=e,E=n!=null?n:__dcg_shared_module_exports__['Cd'].POINT,I=t.lineWidth;t.lineWidth=o.settings.pointLineWidth;let _;Array.isArray(d)?_=d.map(D=>r._clampedOpacity(D,.9)):_=r._clampedOpacity(d,.9);let C=[];if(a){let D=i.length+Object.keys(a).length;for(let P=0;P<D;P++)a[P]||C.push(P)}for(let D=0;D<i.length;D++){let P=a?C[D]:D,F=u&&(T===void 0||T===P),N=p&&(g===void 0||g[P]);r.drawPointToCtx({ctx:t,projection:o,sketch:e.sketch,x:i[D][0],y:i[D][1],alpha:c===P?.6:Array.isArray(_)?_[P]:_,style:E,overrideSize:s[P],sizeFactor:Array.isArray(b)?b[P]:b,opacityFactor:Array.isArray(v)?v[P]:v,colorOverride:h&&h[P],enableWhiteOutline:e.enableWhiteOutlines,hovered:N,pressed:F})}t.lineWidth=I}static fillPolygonFillToCtx(e,t){if(t.length>=6){Oo(e,"dcg-svg-region"),e.desmos_batching||e.beginPath(),e.moveTo(t[0],t[1]);for(let o=2;o<t.length;o+=2)e.lineTo(t[o],t[o+1]);e.lineTo(t[0],t[1]),e.desmos_batching||e.fill(),xo(e)}}static _clampedOpacity(e,t){return typeof e!="number"?t:e<0?0:e>1?1:isFinite(e)?e:t}};function*yfe(r,e){let t=e.graphMode,o=e.operator,i=o=="<"||o==">"||o=="<="||o==">=",n=!r.settings.disableFill&&(t===7||i),a=o=="<="||o=="<";if(n)for(let s of e.segments)switch(t){case 6:{let c=a?0:r.viewport.polarDiameter(),d=r.settings.degreeMode?180:2*Math.PI;yield*Vj(s,c,d);break}case 2:{let c=a?r.viewport.ymin:r.viewport.ymax;yield*H3(s,c);break}case 1:{let c=a?r.viewport.xmin:r.viewport.xmax;yield*H3(s,c);break}case 7:yield s}}function xfe(r){switch(r){case 2:return vj;case 1:return xj;case 6:case 7:default:return QM}}function*UN(r,e){let t=e.graphMode;if(t!==1&&t!==2&&t!==6&&t!==7)return;let o=Z$(r.screen);for(let i of yfe(r,e)){let n=t===7?Sb:ck(t,!0,r.settings),a=qg(i,r.mathToPixels,n);yield q3(a,o,xfe(e.graphMode),!1)}}function vfe(r,e){return r===17?e===__dcg_shared_module_exports__['Md'].DEFAULT?__dcg_shared_module_exports__['Md'].NONE:e:__dcg_shared_module_exports__['Md'].NONE}function wfe(r){switch(r){case __dcg_shared_module_exports__['Md'].NONE:return{startArrow:!1,endArrow:!1};case __dcg_shared_module_exports__['Md'].POSITIVE:return{startArrow:!1,endArrow:!0};case __dcg_shared_module_exports__['Md'].BOTH:return{startArrow:!0,endArrow:!0};default:let e=r;throw new Error("Unexpected arrowMode: "+e)}}function $$(r){switch(r){case"default":case __dcg_shared_module_exports__['Dd'].SOLID:case __dcg_shared_module_exports__['Dd'].DASHED:return 4;case __dcg_shared_module_exports__['Dd'].DOTTED:return 2;default:let e=r;throw new Error("Unexpected line style "+e)}}function pd(r,e,t,o,i,n){let a=Math.atan2(i-t,o-e),s=o-n*Math.cos(a-Math.PI/9),c=i-n*Math.sin(a-Math.PI/9),d=o-n*Math.cos(a+Math.PI/9),p=i-n*Math.sin(a+Math.PI/9),u=o-(n-2)*Math.cos(a-Math.PI/18),g=i-(n-2)*Math.sin(a-Math.PI/18),h=o-(n-2)*Math.cos(a+Math.PI/18),b=i-(n-2)*Math.sin(a+Math.PI/18);r.moveTo(o,i),r.lineTo(s,c),r.lineTo(d,p),r.lineTo(o,i),r.lineTo(u,g),r.lineTo(h,b),r.lineTo(o,i)}function YN(r,e,t,o,i,n,a){let s=o+i,c=n*Math.min(1,Math.max(.5,Math.abs(i)/.8)),d=i<=0,p=Math.PI/2;a<25?p+=.25:p+=.1,d||(p*=-1);let u=e+Math.cos(s+p),g=t+Math.sin(s+p);pd(r,u,g,e,t,c)}function tm(r,e){let t=20;return e.settings.config.projectorMode&&(t*=1.4),t}var il=__dcg_shared_module_exports__['e'](j());function Sfe(r,e){let t=document.createRange();t.selectNode(r);let o=t.getBoundingClientRect();if(!(o.width>0&&o.height>0))return;let n=window.getComputedStyle(r.parentElement),a=r.nodeValue||"";if(!a)return;let c=-.228*parseFloat(n.fontSize),d=n.fontStyle+" "+n.fontWeight+" "+n.fontSize+" "+n.fontFamily,p=o.left-e.originX,u=o.top-e.originY,g;if(n.transform!=="none"){let h=n.transform.match(/^matrix\(([\d.-]+), *([\d.-]+), *([\d.-]+), *([\d.-]+), *([\d.-]+), *([\d.-]+)\)$/);if(h){let b=n.transformOrigin.match(/^([\d.-]+)px ([\d.-]+)px$/);b&&(g={matrix:[parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3]),parseFloat(h[4]),parseFloat(h[5]),parseFloat(h[6])],origin:{x:parseFloat(b[1]),y:parseFloat(b[2])}})}}return{type:"text",text:a,color:n.color||"#000",font:d,x:p,y:u+o.height+c,hasOutline:e.hasOutline,transform:g}}function eJ(r,e){r.beginPath();for(let t of e.instructions)switch(t.type){case"moveTo":r.moveTo(t.x,t.y);break;case"lineTo":r.lineTo(t.x,t.y);break;case"arcTo":r.arcTo(t.cx,t.cy,t.x,t.y,t.radius);break;case"ellipse":r.ellipse(t.centerX,t.centerY,t.radiusX,t.radiusY,t.rotation,t.startAngle,t.endAngle,t.anticlockwise);break}r.closePath()}function kfe(r,e){let t=r.getBoundingClientRect();if(!(t.width>0&&t.height>0))return;let i=5,n=3,a=t.left-e.originX,s=t.top-e.originY,c=-i+a,d=t.width+i+a,p=-i+s,u=t.height+i+s;return{type:"path",hasOutline:!1,instructions:[{type:"moveTo",x:c+n,y:p},{type:"lineTo",x:d-n,y:p},{type:"arcTo",cx:d,cy:p,x:d,y:p+n,radius:n},{type:"lineTo",x:d,y:u-n},{type:"arcTo",cx:d,cy:u,x:d-n,y:u,radius:n},{type:"lineTo",x:c+n,y:u},{type:"arcTo",cx:c,cy:u,x:c,y:u-n,radius:n},{type:"lineTo",x:c,y:p+n},{type:"arcTo",cx:c,cy:p,x:c+n,y:p,radius:n}],strokeColor:"#C2C2C2",fillColor:"rgba(255,255,255,.75)"}}function _fe(r,e){let t=r.getBoundingClientRect();if(!(t.width>0&&t.height>0))return;let i=15,n=5,a=2,s="#5a87cd",c=3,d=t.left-e.originX-i,p=t.top-e.originY-n,u=d+t.width+2*i,g=p+t.height+2*n,h=d+c,b=u-c,v=p+c,T=g-c,E=[{type:"moveTo",x:h,y:p},{type:"lineTo",x:b,y:p},{type:"arcTo",x:u,y:v,radius:c,cx:u,cy:p},{type:"lineTo",x:u,y:T},{type:"arcTo",x:b,y:g,radius:c,cx:u,cy:g},{type:"lineTo",x:h,y:g},{type:"arcTo",x:d,y:T,radius:c,cx:d,cy:g},{type:"lineTo",x:d,y:v},{type:"arcTo",x:h,y:p,radius:c,cx:d,cy:p}];c-=a,d+=a,p+=a,u-=a,g-=a,h=d+c,b=u-c,v=p+c,T=g-c;let I=[{type:"moveTo",x:h,y:p},{type:"arcTo",x:d,y:v,radius:c,cx:d,cy:p},{type:"lineTo",x:d,y:T},{type:"arcTo",x:h,y:g,radius:c,cx:d,cy:g},{type:"lineTo",x:b,y:g},{type:"arcTo",x:u,y:T,radius:c,cx:u,cy:g},{type:"lineTo",x:u,y:v},{type:"arcTo",x:b,y:p,radius:c,cx:u,cy:p},{type:"lineTo",x:h,y:p}];return{type:"path",instructions:E.concat(I),fillColor:s,hasOutline:!1}}function tJ(r,e){if(r==="0px 0px")return;let t=r.match(/^([^ ]+) +(.+)$/);if(!t)return;let o=t[1],i=t[2],n=parseFloat(o),a=parseFloat(i);if(o.endsWith("%")&&(n*=e.width/100),o.endsWith("%")&&(a*=e.height/100),!(n===0||a===0))return[n,a]}function Cfe(r,e,t){if(e.borderTopWidth==="0px")return;let o=r.getBoundingClientRect();if(!(o.width>0&&o.height>0))return;let n=o.left-t.originX,a=o.top-t.originY,s=o.width,c=parseFloat(e.borderTopWidth||"1px"),d=e.borderTopColor||"#000",p,u=tJ(e.borderTopLeftRadius,o),g=tJ(e.borderTopRightRadius,o);return u&&g?p=[{type:"ellipse",centerX:n+u[0],centerY:a+u[1],radiusX:u[0],radiusY:u[1],rotation:0,startAngle:Math.PI,endAngle:3*Math.PI/2,anticlockwise:!1},{type:"lineTo",x:n+o.width-g[0],y:a},{type:"ellipse",centerX:n+o.width-g[0],centerY:a+g[1],radiusX:g[0],radiusY:g[1],rotation:0,startAngle:3*Math.PI/2,endAngle:0,anticlockwise:!1},{type:"lineTo",x:n+o.width,y:a+g[1]+c},{type:"ellipse",centerX:n+g[0],centerY:a+g[1]+c,radiusX:g[0],radiusY:g[1],rotation:0,startAngle:0,endAngle:3*Math.PI/2,anticlockwise:!0},{type:"lineTo",x:n+u[0],y:a+c},{type:"ellipse",centerX:n+u[0],centerY:a+u[1]+c,radiusX:u[0],radiusY:u[1],rotation:0,startAngle:3*Math.PI/2,endAngle:Math.PI,anticlockwise:!0}]:p=[{type:"moveTo",x:n,y:a},{type:"lineTo",x:s+n,y:a},{type:"lineTo",x:s+n,y:c+a},{type:"lineTo",x:n,y:c+a}],{type:"path",instructions:p,fillColor:d,hasOutline:t.hasOutline}}function rJ(r,e){let t=Math.sqrt(r[0]*r[0]+r[1]*r[1]),o=Math.sqrt(e[0]*e[0]+e[1]*e[1]),i=r[0]*e[0]+r[1]*e[1],n=Math.acos(i/(t*o));return r[0]*e[1]-r[1]*e[0]<0&&(n*=-1),n}function Tfe(r,e,t,o,i,n,a,s,c){let d=Math.cos(i),p=Math.sin(i),u=(r-s)/2,g=(e-c)/2,h=d*u+p*g,b=-p*u+d*g,v=t*t,T=o*o,E=h*h,I=b*b,_=Math.sqrt((v*T-v*I-T*E)/(v*I+T*E));n===a&&(_*=-1);let C=_*t*b/o,D=-_*o*h/t,P=(r+s)/2,F=(e+c)/2,N=d*C-p*D+P,Y=p*C+d*D+F,z=[1,0],X=[(h-C)/t,(b-D)/o],q=[(-h-C)/t,(-b-D)/o],S=rJ(z,X),A=rJ(z,q);return{centerX:N,centerY:Y,radiusX:t,radiusY:o,startAngle:S,endAngle:A,rotation:i,anticlockwise:a===0}}var oJ={};function Efe(r,e){let t=r+"-"+e,o=oJ[t];if(o)return o;o=[],oJ[t]=o;let i=e.split(" ");if(i.length!==4)return o;let n=parseFloat(i[0]),a=parseFloat(i[2]),s=parseFloat(i[1]),c=parseFloat(i[3]),d=a-n,p=c-s;function u(D){return(D-n)/d}function g(D){return(D-s)/p}let h="[0-9-.]+",b="(M"+h+" "+h+")",v="(L"+h+" "+h+")",T="(A"+h+" "+h+" "+h+" "+h+" "+h+" "+h+" "+h+")",E=new RegExp(b+"|"+v+"|"+T,"g"),I=r.match(E);if(!I||!I.length)return o;let _=NaN,C=NaN;for(let D of I){let P=D.substr(1).split(" ").map(parseFloat);switch(D[0]){case"M":_=u(P[0]),C=g(P[1]),o.push({type:"moveTo",x:_,y:C});break;case"L":_=u(P[0]),C=g(P[1]),o.push({type:"lineTo",x:_,y:C});break;case"A":let F=P[0]/d,N=P[1]/p,Y=P[2],z=P[3],X=P[4],q=u(P[5]),S=g(P[6]),A=Tfe(_,C,F,N,Y,z,X,q,S);_=q,C=S,o.push({type:"ellipse",...A});break}}return o}function Ife(r,e){let t=r.childNodes[0];if(!t||t.nodeName!=="path")return;let o=r.getBoundingClientRect();if(!(o.width>0&&o.height>0))return;let n=t.getAttribute("d")||"",a=r.getAttribute("viewBox")||"",s=Efe(n,a),c=window.getComputedStyle(r),d=o.width,p=o.height,u=o.left-e.originX,g=o.top-e.originY;s=__dcg_shared_module_exports__['f'](s);for(let h of s)switch(h.type){case"moveTo":case"lineTo":h.x=h.x*d+u,h.y=h.y*p+g;break;case"arcTo":h.x=h.x*d+u,h.y=h.y*p+g,h.cx=h.x*d+u,h.cy=h.y*p+g,h.radius*=d;break;case"ellipse":h.centerX=h.centerX*d+u,h.centerY=h.centerY*p+g,h.radiusX*=d,h.radiusY*=p;break;default:return h}return{type:"path",fillColor:c.color||"#000",instructions:s,hasOutline:e.hasOutline}}function nJ(r,e,t){if(r.classList.contains("dcg-mq-mathspeak"))return;let o=window.getComputedStyle(r),i=Cfe(r,o,e);i&&t.push(i);let n=r.childNodes;for(let a=0;a<n.length;a++){let s=n[a];if(s.nodeType===3){let c=Sfe(s,e);c&&t.push(c)}else if(s.nodeName==="svg"){let c=Ife(s,e);c&&t.push(c)}else s.nodeType===1&&nJ(s,e,t)}}function WD(r,e){let t=[];if(e.hasBorder){let o=kfe(r,e);o&&t.push(o)}if(e.hasFocus){let o=_fe(r,e);o&&t.push(o)}return nJ(r,e,t),t}function jD(r,e){Oo(e,"dcg-svg-label"),e.save(),xo(e);for(let t of r)switch(t.type){case"path":t.hasOutline&&(e.strokeStyle="#FFF",e.lineWidth=3,e.miterLimit=10,eJ(e,t),e.stroke());break;case"text":t.hasOutline&&(e.font=t.font,e.strokeStyle="#FFF",e.lineWidth=3,e.miterLimit=2,t.transform?(e.save(),iJ(e,t),e.strokeText(t.text,0,0),e.restore()):e.strokeText(t.text,t.x,t.y));break;default:return t}for(let t of r)switch(t.type){case"path":eJ(e,t),t.strokeColor&&(e.strokeStyle=t.strokeColor,e.lineWidth=1,e.miterLimit=10,e.stroke()),t.fillColor&&(e.fillStyle=t.fillColor,e.fill());break;case"text":e.font=t.font,e.fillStyle=t.color,t.transform?(e.save(),iJ(e,t),e.fillText(t.text,0,0),e.restore()):e.fillText(t.text,t.x,t.y);break;default:return t}e.restore()}function iJ(r,e){if(!e.transform)return;let t=Math.abs(e.transform.matrix[0]),o=Math.abs(e.transform.matrix[3]);r.translate(e.x+e.transform.origin.x,e.y+e.transform.origin.y),r.transform.apply(r,e.transform.matrix),r.translate(-e.transform.origin.x/t,-e.transform.origin.y/o)}var Ib=__dcg_shared_module_exports__['e'](j());var aJ=__dcg_shared_module_exports__['e'](j());var dt=class extends aJ.View{template(){return this.props.children?this.props.children:l("div",{onMount:e=>this.onMountMathquill(e)})}onMount(){if(this.props.children){let e=this.findAllRootDOMNodes();if(e.length!==1)throw new Error(`StaticMathquillView expects exactly 1 child DOM Node. Got: ${e.length}`);let t=e[0];if(t instanceof HTMLElement)this.onMountMathquill(t);else throw new Error("StaticMathquillView expects an HTMLElement as child DOM node")}}onMountMathquill(e){var o,i,n,a,s,c,d,p;let t=(i=(o=this.props).tokenController)==null?void 0:i.call(o);t&&(this.mathquillTokenHelper=new b1(t,e,!0)),this.staticMath=Pl.StaticMath(e,{...(a=(n=this.props).config)==null?void 0:a.call(n),tabindex:(c=(s=this.props).tabbable)!=null&&c.call(s)?0:-1,overrideKeystroke:(u,g)=>{var h,b;(b=(h=this.props).onUserPressedKey)!=null&&b.call(h,u,g)&&g.stopPropagation()}}),this.updateMathquill(),e.classList.add("dcg-static-mathquill-view"),(p=(d=this.props).didMountMathquill)==null||p.call(d,this.staticMath)}didUpdate(){this.updateMathquill()}updateMathquill(){var e;this.updateTabbable(),this.updateMathquillAria(),this.updateMathquillLatex(),(e=this.mathquillTokenHelper)==null||e.updateTokens(this.props.latex())}updateTabbable(){var e;this.props.tabbable&&((e=this.staticMath)==null||e.config({tabindex:this.props.tabbable()?0:-1}))}updateMathquillLatex(){if(!this.staticMath)return;let e=this.props.latex();this.lastLatex!==e&&(this.staticMath.latex(e),this.lastLatex=e,this.props.onReflow&&this.props.onReflow())}updateMathquillAria(){this.staticMath&&this.props.getAriaLabel&&this.staticMath.setAriaLabel(this.props.getAriaLabel())}};var{For:Mfe,IfElse:Dfe}=Ib.Components,Xi=class extends Ib.View{template(){return l("span",{class:Ib.const("dcg-mixed-text-math"),children:l(Mfe,{each:()=>__dcg_shared_module_exports__['Le'](this.props.content()),children:e=>Dfe(()=>__dcg_shared_module_exports__['Ke'](e)==="latex",{true:()=>l(dt,{latex:()=>e.substring(1,e.length-1),config:this.props.mqConfig}),false:()=>l("span",{class:Ib.const("dcg-label-raw-text"),children:()=>e})})},(e,t)=>`${e}|${t}`)})}};var Fl=__dcg_shared_module_exports__['e'](j());Ut();Ut();function XD(r){return Array.from(r.querySelectorAll('input:enabled, button:enabled, select:enabled, textarea:enabled, [tabindex="0"], a[href]')).filter(e=>!e.matches('[aria-hidden="true"], [aria-hidden="true"] *, [aria-disabled="true"], [aria-disabled="true"] *')&&Ku(e))}function sJ(r){return function(t){if(Pe(t)==us&&r){let o=XD(r);if(o.length===0)return;let i=o[0],n=o[o.length-1];t.shiftKey&&document.activeElement===i?(t.preventDefault(),re(n).trigger("focus")):!t.shiftKey&&document.activeElement===n?(t.preventDefault(),re(i).trigger("focus")):document.activeElement&&!r.contains(document.activeElement)&&(t.preventDefault(),re(i).trigger("focus"))}}}var{IfElse:Afe}=Fl.Components,Lfe=500,Lp=5,Sk=2,BN=class extends Fl.View{constructor(){super(...arguments),this.offsetLeft=0}init(){this.uuid=this.props.uuid()}gravity(){var e,t;return((t=(e=this.props).gravity)==null?void 0:t.call(e))||"s"}template(){return x("div",{class:()=>{var e,t,o,i;return{"dcg-tooltip-positioning-container":!0,"dcg-tooltip-gravity-n-s":this.gravity()==="n"||this.gravity()==="s","dcg-tooltip-gravity-e-w":this.gravity()==="e"||this.gravity()==="w","dcg-tooltip-theme-light":((t=(e=this.props).theme)==null?void 0:t.call(e))==="light","dcg-tooltip-theme-dark":((i=(o=this.props).theme)==null?void 0:i.call(o))!=="light"}},style:()=>{var e,t,o,i;return{top:`${this.props.hitAreaRect().top+(((t=(e=this.props).offset)==null?void 0:t.call(e).top)||0)}px`,left:`${this.props.hitAreaRect().left+(((i=(o=this.props).offset)==null?void 0:i.call(o).left)||0)}px`,width:`${this.props.hitAreaRect().width}px`,height:`${this.props.hitAreaRect().height}px`}},children:[l("div",{class:Fl.const("dcg-tooltip-message-container"),style:this.bindFn(this.getMessageStyle),children:l("div",{role:Fl.const("tooltip"),id:this.const(this.uuid),class:()=>{var e,t;return{"dcg-tooltip-message":!0,"dcg-text-selectable":(t=(e=this.props).sticky)==null?void 0:t.call(e),"dcg-sticky-not-stuck":this.props.isStickyAndNotStuck()}},onMount:e=>this.tooltipMessage=e,style:()=>({left:`${Math.round(this.offsetLeft)}px`}),children:Afe(()=>!!this.props.customTooltipView,{true:()=>this.props.customTooltipView(),false:()=>l("span",{children:this.props.tooltip})})})}),l("div",{class:()=>({"dcg-tooltip-arrow":!0,[this.getTooltipGravityClass()]:!0}),style:()=>{var e,t;return((t=(e=this.props).theme)==null?void 0:t.call(e))==="light"?this.getArrowWithBorderStyle():this.getSolidArrowStyle()}})]})}updatePositionIfNecessary(){if(this.gravity()!=="s"&&this.gravity()!=="n")return;let e=this.tooltipMessage.getBoundingClientRect(),t=this.tooltipMessage.closest(".dcg-tap-container");if(!t)return;let o=t.getBoundingClientRect();e.right+Sk>o.right?this.offsetLeft=o.right-e.right-Sk:e.left-Sk<o.left&&(this.offsetLeft=o.left-e.left+Sk),this.offsetLeft!==0&&this.update()}didMount(){this.updatePositionIfNecessary()}getTooltipGravityClass(){switch(this.gravity()){case"n":return"dcg-tooltip-gravity-n";case"s":return"dcg-tooltip-gravity-s";case"e":return"dcg-tooltip-gravity-e";case"w":return"dcg-tooltip-gravity-w"}}getArrowWithBorderStyle(){let e=this.gravity(),t=this.getBackgroundColor(),o="#bbb",i="8px",n={width:i,height:i,border:`1px solid ${o}`,background:t};switch(e){case"s":return{...n,top:"100%",left:"50%","margin-top":"1px","border-right":"0","border-bottom":"0"};case"n":return{...n,bottom:"100%",left:"50%","margin-bottom":"1px","border-left":"0","border-top":"0"};case"e":return{...n,top:"50%",left:"100%","margin-left":"1px","border-right":"0","border-top":"0"};case"w":return{...n,top:"50%",right:"100%","margin-right":"1px","border-left":"0","border-bottom":"0"};default:return e}}getSolidArrowStyle(){let e=this.gravity(),t=this.getBackgroundColor(),o=`transparent transparent ${t} transparent`,i=`${t} transparent transparent transparent`,n=`transparent ${t} transparent transparent`,a=`transparent transparent transparent ${t}`,s=`-${Lp}px`;switch(e){case"s":return{top:"100%",left:"50%",border:`${Lp}px solid transparent`,"border-color":o,"margin-top":s,"margin-left":s};case"n":return{bottom:"100%",left:"50%",border:`${Lp}px solid transparent`,"border-color":i,"margin-bottom":s,"margin-left":s};case"e":return{top:"50%",left:"100%",border:`${Lp}px solid transparent`,"border-color":n,"margin-left":`-${Lp}px`,"margin-top":s};case"w":return{top:"50%",right:"100%",border:`${Lp}px solid transparent`,"border-color":a,"margin-right":s,"margin-top":s};default:return e}}getBackgroundColor(){var e,t;return((t=(e=this.props).theme)==null?void 0:t.call(e))==="light"?"#fff":this.props.isStickyAndNotStuck()?"#666":"#000"}getMessageStyle(){let e=this.props.hitAreaRect(),t=this.gravity(),o=this.props.maxWidth();switch(t){case"s":return{top:"100%",width:`${o}px`,transform:"translate(-50%, 0)",left:`${.5*e.width}px`,"margin-top":`${Lp}px`,"text-align":"center"};case"n":return{bottom:"100%",width:`${o}px`,transform:"translate(-50%, 0)",left:`${.5*e.width}px`,"margin-bottom":`${Lp}px`,"text-align":"center"};case"e":return{transform:"translate(0, -50%)",left:"100%",width:`${o}px`,top:`${.5*e.height}px`,"margin-left":`${Lp}px`,"text-align":"left"};case"w":return{transform:"translate(0, -50%)",right:"100%",width:`${o}px`,top:`${.5*e.height}px`,"margin-right":`${Lp}px`,"text-align":"right"};default:return t}}};function Pfe(){return document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}var Oe=class extends Fl.View{init(){this.uuid=`dcg-tooltip-${yc()}`}template(){return l("div",{class:()=>{var e,t,o,i;return{"dcg-tooltip-hit-area-container":!0,"dcg-display-block":(t=(e=this.props).displayBlock)==null?void 0:t.call(e),"dcg-do-not-blur":!0,"dcg-sticky-tooltip":this.isSticky(),"dcg-tooltip-disabled":this.props.disabled&&this.props.disabled(),"dcg-cursor-default":!this.isSticky(),[((i=(o=this.props).additionalClass)==null?void 0:i.call(o))||""]:!!this.props.additionalClass}},handleEvent:Fl.const("true"),didMount:e=>{this.isMounted=!0,this.hitAreaNode=e,this.setupEventListeners(this.hitAreaNode)},tabIndex:()=>this.isSticky()?"0":"-1","aria-label":()=>this.isSticky()?this.props.tooltip():void 0,role:()=>this.isSticky()?"note":void 0,onFocus:()=>{this.isSticky()&&(this.showTooltip(),this.stickTooltip())},onTap:e=>{var t,o,i,n,a;if(this.isSticky())if(e.stopPropagation(),this.isStuck)this.hideTooltipImmediately();else{if((o=(t=this.props).disabled)!=null&&o.call(t))return;this.showTooltip(),this.stickTooltip(),(i=this.hitAreaNode)==null||i.focus()}else if(this.shouldShowOnTapstart()){if((a=(n=this.props).disabled)!=null&&a.call(n))return;this.showTooltip(),this.setUpHideOnExternalMousedown()}else this.hideTooltipImmediately()},children:this.props.children})}isSticky(){var e,t,o,i;return!!((t=(e=this.props).sticky)!=null&&t.call(e))&&!((i=(o=this.props).disabled)!=null&&i.call(o))}shouldShowOnTapstart(){var e,t;return!!((t=(e=this.props).showOnTapstart)!=null&&t.call(e))}didUpdate(){this.updateTooltip()}updateTooltip(){if(!this.wrapperRef)return;if(!this.props.tooltip()){this.hideTooltip();return}let e=this.hitAreaNode.getBoundingClientRect(),t=this.wrapperRef.elt.getBoundingClientRect(),{originalTop:o,originalLeft:i}=this.wrapperRef,n=e.top-t.top,a=e.left-t.left;Math.abs(n-o)>3||Math.abs(a-i)>3?this.hideTooltip():this.wrapperRef.view.update()}handleShowEvent(e){var o,i;if((i=(o=this.props).disabled)!=null&&i.call(o))return;let t=this.props.delay?this.props.delay():Lfe;this.clearTimeouts(),this.showTooltipTimeout=setTimeout(e,t)}hideTooltipImmediately(){this.clearTimeouts(),this.hideTooltip()}handleHideEvent(){this.clearTimeouts(),this.hideTooltipTimeout=setTimeout(this.bindFn(this.hideTooltip),150)}setupEventListeners(e){re(e).on("tipsyshow",t=>{t.target===e&&this.handleShowEvent(()=>{this.showTooltip()})}).on("tipsyhide",t=>{t.target!==e||this.isStuck||this.handleHideEvent()}).on("keydown",t=>{!c0(t)&&!Rx(t)&&this.isStuck&&this.hideTooltipImmediately()})}willUnmount(){this.clearTimeouts(),this.isMounted=!1,this.hideTooltip()}setUpHideOnExternalMousedown(){re(document).on(`mousedown.dcg-tooltip-${this.uuid} touchstart.dcg-tooltip-${this.uuid} pointerdown.dcg-tooltip-${this.uuid}`,e=>{this.wrapperRef&&(this.hitAreaNode.contains(e.target)||this.wrapperRef.elt.contains(e.target)||this.hideTooltip())})}stickTooltip(){this.isMounted&&this.wrapperRef&&(this.isStuck||(this.setUpHideOnExternalMousedown(),this.isStuck=!0,this.updateTooltip()))}clearTimeouts(){clearTimeout(this.showTooltipTimeout),clearTimeout(this.hideTooltipTimeout)}showTooltip(){var h,b,v;if(!this.isMounted||this.wrapperRef||!this.props.tooltip())return;let e=this.hitAreaNode.getBoundingClientRect(),t=document.createElement("div");t.className="dcg-tooltip-mount-pt";let o=this.hitAreaNode.closest(".dcg-tap-container"),i=Pfe();(!!i&&i.contains(this.hitAreaNode)&&i.closest(".dcg-tap-container")?i:o).appendChild(t);let a=t.getBoundingClientRect(),s=e.left-a.left,c=e.top-a.top,d=200;if((b=(h=this.props).noWrap)!=null&&b.call(h)){let T=(v=t.closest(".dcg-tap-container"))==null?void 0:v.getBoundingClientRect();T&&(d=T.width-2*Sk)}let p={...this.props,isStickyAndNotStuck:()=>this.isSticky()&&!this.isStuck,maxWidth:()=>d,hitAreaRect:()=>({top:c||0,left:s||0,width:e.width||0,height:e.height||0}),uuid:()=>this.uuid};this.setupEventListeners(t),re(t).on("dcg-tap",()=>{this.isSticky()&&this.stickTooltip()});let u=Fl.mountToNode(BN,t,p);re(document).on(`keydown.dcg-tooltip-${this.uuid}`,T=>{Pe(T)===Wi&&this.hideTooltip()});let g=()=>this.updateTooltip();window.addEventListener("scroll",g,!0),this.wrapperRef={elt:t,view:u,originalLeft:s,originalTop:c,onScroll:g},this.assignAriaDescribedBy()}hideTooltip(){this.clearTimeouts(),this.wrapperRef&&(this.isStuck=!1,re(document).off(`.dcg-tooltip-${this.uuid}`),window.removeEventListener("scroll",this.wrapperRef.onScroll,!0),this.restoreAriaDescribedBy(),Fl.unmountFromNode(this.wrapperRef.elt),this.wrapperRef.elt.parentNode&&this.wrapperRef.elt.parentNode.removeChild(this.wrapperRef.elt),this.wrapperRef=void 0)}assignAriaDescribedBy(){var t,o;if((o=(t=this.props).sticky)!=null&&o.call(t))return;let e=XD(this.hitAreaNode)[0]||this.hitAreaNode;this.originalDescribedBy=e.getAttribute("aria-describedby"),e.setAttribute("aria-describedby",this.uuid)}restoreAriaDescribedBy(){var t,o;if((o=(t=this.props).sticky)!=null&&o.call(t))return;let e=XD(this.hitAreaNode)[0]||this.hitAreaNode;this.originalDescribedBy?e.setAttribute("aria-describedby",this.originalDescribedBy):e.removeAttribute("aria-describedby")}};function $D(r,e,t){return Math.max(e,Math.min(t,r))}var y1=class{constructor(e){let t=e.data,o=e.width,i=e.height;this.imageData=e;for(let s=1;s<o;s++)t[s]+=t[s-1];for(let s=1;s<i;s++)t[s*o]+=t[s*o-o];let n=o*i-o-i+1,a=o-1;for(let s=0;s<n;s++){let c=1+s%a,p=(1+Math.floor(s/a))*o,u=c-1+p,g=c+p-o,h=c-1+p-o;t[p+c]+=t[u]+t[g]-t[h]}}getSumForValidRect(e){let t=e.left-1,o=e.right-1,i=e.top-1,n=e.bottom-1,a=this.imageData.width,s=this.imageData.data,c=s[t+i*a],d=s[o+i*a],p=s[t+n*a],u=s[o+n*a];return t>=0&&i>=0?u-d-p+c:t>=0?u-p:i>=0?u-d:u}getSum(e){let t={left:$D(Math.floor(e.left),0,this.imageData.width),right:$D(Math.ceil(e.right),0,this.imageData.width),top:$D(Math.floor(e.top),0,this.imageData.height),bottom:$D(Math.ceil(e.bottom),0,this.imageData.height)};return t.left>=t.right||t.top>=t.bottom?0:this.getSumForValidRect(t)}};var om=1/2,rm=document.createElement("canvas"),KN=[];function Gfe(r,e){if(!(e.width*e.height>0))return new y1({width:0,height:0,data:[]});rm.width=0,rm.width=Math.round(e.width*om),rm.height=Math.round(e.height*om);let o=rm.getContext("2d");o.save(),o.scale(rm.width/r.canvas.width,rm.height/r.canvas.height),o.drawImage(r.canvas,0,0),o.restore();let i=o.getImageData(0,0,rm.width,rm.height),n=i.data;n.length/4,KN.length,KN=new Array(n.length/4);let a=KN;for(let c=0;c<a.length;c++)a[c]=n[c*4+3];return new y1({width:i.width,height:i.height,data:a})}function lJ(r){for(let e=0;e<r.length;e++){let t=Vfe(e,r);r[e]=[t]}return r.map(e=>e[0])}function Vfe(r,e){let t=1/0,o=-1,i=e[r];if(i.length===1)return i[0];for(let n=0;n<i.length;n++){let a=e[r][n].staticScore,s=Ofe(r,n,e),c=a+s;(o===-1||c<t)&&(t=c,o=n)}return i[o]}function Ofe(r,e,t){let o=0,i=t[r][e];for(let n=0;n<t.length;n++){if(n===r)continue;let a=0,s=t[n];for(let c=s.length-1;c>=0;c--){let d=s[c],p=Math.max(0,Math.min(i.right,d.right)-Math.max(i.left,d.left)),u=Math.max(0,Math.min(i.bottom,d.bottom)-Math.max(i.top,d.top));a+=p*u}o+=a/s.length}return o}function Rfe(r,e){let t=e.getSum({left:r.left*om,right:r.right*om,top:r.top*om,bottom:r.bottom*om});return t/=200,t/=om*om,t}function Ffe(r,e){let t=Nfe(r,e);return 10*(r.width*r.height-t)}function Nfe(r,e){let t=Math.max(0,Math.min(r.right,e.right)-Math.max(r.left,e.left)),o=Math.max(0,Math.min(r.bottom,e.bottom)-Math.max(r.top,e.top));return t*o}function cJ(r,e){let t;return()=>(t||(t={viewport:{left:0,right:e.width,top:0,bottom:e.height},integralImage:Gfe(r(),e)}),t)}function JD(r,e){if(e.length<=1)return;let t=r();for(let o of e)o.staticScore+=Ffe(o,t.viewport),o.staticScore+=Rfe(o,t.integralImage)}function dJ(r,e){let t=e.nakedLabel?0:e.pt_radius,o=Math.round(t/Math.sqrt(2)),i=[],n=e.pt_x,a=e.pt_y,s=e.width,c=e.height,d=400;i.push({cx_s:0,cy_s:0,cx_a:0,cy_a:0,staticScore:d,orientation:"center",matches:{default:1,center:1,center_auto:1,auto_center:1}}),i.push({cx_s:.5,cx_a:t+3,cy_s:0,cy_a:0,staticScore:d,orientation:"right",matches:{default:1,right:1,center_auto:1,auto_right:1}}),i.push({cx_s:-.5,cx_a:-t-3,cy_s:0,cy_a:0,staticScore:d,orientation:"left",matches:{default:1,left:1,center_auto:1,auto_left:1}}),i.push({cx_s:0,cx_a:0,cy_s:-.5,cy_a:-t,staticScore:d,orientation:"above",matches:{default:1,above:1,auto_center:1,above_auto:1}}),i.push({cx_s:-.5,cx_a:-o,cy_s:-.5,cy_a:-o,staticScore:d,orientation:"tl",matches:{default:1,above_left:1,above_auto:1,auto_left:1}}),i.push({cx_s:.5,cx_a:o,cy_s:-.5,cy_a:-o,staticScore:d,orientation:"tr",matches:{default:1,above_right:1,above_auto:1,auto_right:1}}),i.push({cx_s:0,cx_a:0,cy_s:.5,cy_a:t,staticScore:d,orientation:"below",matches:{default:1,below:1,auto_center:1,below_auto:1}}),i.push({cx_s:-.5,cx_a:-o,cy_s:.5,cy_a:o,staticScore:d,orientation:"bl",matches:{default:1,below_left:1,below_auto:1,auto_left:1}}),i.push({cx_s:.5,cx_a:o,cy_s:.5,cy_a:o,staticScore:d,orientation:"br",matches:{default:1,below_right:1,below_auto:1,auto_right:1}});let p=Math.cos(e.rotation),u=Math.sin(e.rotation),g=i.map(h=>{let b=h.cx_s*s+h.cx_a,v=h.cy_s*c+h.cy_a,T=b*p-v*u,E=v*p+b*u,I={multiplyWidth:h.cx_s-.5,multiplyHeight:h.cy_s-.5,addX:h.cx_a,addY:h.cy_a},_=-s/2,C=s/2,D=-c/2,P=c/2;if(e.rotation){let F=Ufe([{x:_*p-D*u,y:D*p+_*u},{x:_*p-P*u,y:P*p+_*u},{x:C*p-D*u,y:D*p+C*u},{x:C*p-P*u,y:P*p+C*u}]);_=F.left,C=F.right,D=F.top,P=F.bottom}return _=Math.round(n+T+_),C=Math.round(n+T+C),D=Math.round(a+E+D),P=Math.round(a+E+P),{pt_x:Math.round(n),pt_y:Math.round(a),left:_,right:C,top:D,bottom:P,width:C-_,height:P-D,translate:I,staticScore:e.priorOrientation===h.orientation?h.staticScore-20:h.staticScore,orientation:h.orientation,matches:h.matches}});return e.enforceOrientation&&e.enforceOrientation!=="default"?g=__dcg_shared_module_exports__['Ha'](g,h=>!!h.matches[e.enforceOrientation]):e.nakedLabel?g=__dcg_shared_module_exports__['Ha'](g,h=>h.orientation==="center"):e.keepOrientation&&e.priorOrientation?g=__dcg_shared_module_exports__['Ha'](g,h=>h.orientation===e.priorOrientation):g=__dcg_shared_module_exports__['Ha'](g,h=>h.orientation!=="center"),JD(r,g),g}function pJ(r,e){let t=[],o=e.width,i=e.height,n=o/2,a=i/2,s=e.pt_x1,c=e.pt_y1,d=e.pt_x2,p=e.pt_y2,u=5,g=(p-c)/(d-s),h=Math.atan2(p-c,d-s)+Math.PI/2,b=u*Math.cos(h),v=u*Math.sin(h),T=Math.min(c,p)-Math.abs(v)-i,E=Math.max(c,p)+Math.abs(v),I=[.5,.4,.6,.2,.8],_=[0,20,20,40,40],C=[];for(let P of I)C.push({x:s*(1-P)+d*P,y:c*(1-P)+p*P});for(let P=0;P<C.length;P++){let F=C[P],N,Y,z,X;if(g>=2||g<=-2){z=X=F.y-a;let O=Math.abs((d-s)/(p-c)*a)+Math.abs(b);N=F.x+O,Y=F.x-O-o}else if(g<=.05&&g>=-.05){N=Y=F.x-n;let O=Math.abs(g*n)+Math.abs(v);z=F.y-O-i,X=F.y+O}else b>0?(N=F.x+b,Y=F.x-b-o):(N=F.x+b-o,Y=F.x-b),v>0?(z=F.y+v,X=F.y-v-i):(z=F.y+v-i,X=F.y-v);z<T?z=T:z>E&&(z=E),X<T?X=T:X>E&&(X=E);let q=(d-s)*(z-c)-(p-c)*(N-s)>0,S=P.toString()+(q?"-a":"-b");t.push({pt_x:F.x,pt_y:F.y,left:N,top:z,staticScore:_[P],orientation:S,matches:{[S]:1}});let A=P.toString()+(q?"-b":"-a");t.push({pt_x:F.x,pt_y:F.y,left:Y,top:X,staticScore:_[P],orientation:A,matches:{[A]:1}})}let D=t.map(P=>{let F=Math.round(P.left),N=Math.round(P.left+o),Y=Math.round(P.top),z=Math.round(P.top+i);return{pt_x:Math.round(P.pt_x),pt_y:Math.round(P.pt_y),translate:{multiplyWidth:0,multiplyHeight:0,addX:P.left-P.pt_x,addY:P.top-P.pt_y},left:F,right:N,top:Y,bottom:z,width:N-F,height:z-Y,staticScore:e.priorOrientation===P.orientation?P.staticScore-20:P.staticScore,orientation:P.orientation,matches:P.matches}});return e.keepOrientation&&e.priorOrientation&&(D=__dcg_shared_module_exports__['Ha'](D,P=>P.orientation===e.priorOrientation)),JD(r,D),D}function uJ(r,e){let t=[],o=e.pt_x,i=e.pt_y,n=e.width,a=e.height,s=-(e.startAngle+e.deltaAngle/2),c=e.isRightAngle?e.radius*Math.sqrt(2)-1:e.radius+4,d=c+Math.sqrt(e.width*e.width/4+e.height*e.height/4),p=[],u=d*Math.sin(s);u>c+1/2*a&&(u=c+1/2*a),u<-c-1/2*a&&(u=-c-1/2*a),p.push({x:o+d*Math.cos(s)-n/2,y:i+u-a/2});for(let h=0;h<p.length;h++){let b=p[h],v=h.toString()+"-a";t.push({pt_x:b.x,pt_y:b.y,left:b.x,top:b.y,staticScore:0,orientation:v,matches:{[v]:1}})}let g=t.map(h=>{let b=Math.round(h.left),v=Math.round(h.left+n),T=Math.round(h.top),E=Math.round(h.top+a);return{pt_x:Math.round(h.pt_x),pt_y:Math.round(h.pt_y),translate:{multiplyWidth:0,multiplyHeight:0,addX:h.left-h.pt_x,addY:h.top-h.pt_y},left:b,right:v,top:T,bottom:E,width:v-b,height:E-T,staticScore:e.priorOrientation===h.orientation?h.staticScore-20:h.staticScore,orientation:h.orientation,matches:h.matches}});return e.keepOrientation&&e.priorOrientation&&(g=__dcg_shared_module_exports__['Ha'](g,h=>h.orientation===e.priorOrientation)),JD(r,g),g}function hJ(r,e){let t=[],o=e.width,i=e.height,n=10,a=Math.round(n/Math.sqrt(2)),s=0,c=50,d=0,p=0,u=0;for(let v=0;v<e.path.length-2;v+=2)u+=1,d+=e.path[v],p+=e.path[v+1];let g=d/u,h=p/u;t.push({left:g-o/2,top:h-i/2,staticScore:s,orientation:"center",matches:{center:1}}),t.push({left:g+n+3,top:h-i/2,staticScore:c,orientation:"right",matches:{right:1}}),t.push({left:g-(n+o)-3,top:h-i/2,staticScore:c,orientation:"left",matches:{left:1}}),t.push({left:g-o/2,top:h-(i+n),staticScore:c,orientation:"top",matches:{top:1}}),t.push({left:g-(o+a),top:h-(i+a),staticScore:c,orientation:"tl",matches:{tl:1}}),t.push({left:g+a,top:h-(i+a),staticScore:c,orientation:"tr",matches:{tr:1}}),t.push({left:g-o/2,top:h+n,staticScore:c,orientation:"bottom",matches:{bottom:1}}),t.push({left:g-(o+a),top:h+a,staticScore:c,orientation:"bl",matches:{bl:1}}),t.push({left:g+a,top:h+a,staticScore:c,orientation:"br",matches:{br:1}});let b=t.map(v=>{let T=Math.round(v.left),E=Math.round(v.left+o),I=Math.round(v.top),_=Math.round(v.top+i);return{pt_x:Math.round(g),pt_y:Math.round(h),translate:{multiplyWidth:0,multiplyHeight:0,addX:v.left-g,addY:v.top-h},left:T,right:E,top:I,bottom:_,width:E-T,height:_-I,staticScore:e.priorOrientation===v.orientation?v.staticScore-20:v.staticScore,orientation:v.orientation,matches:v.matches}});return e.keepOrientation&&e.priorOrientation&&(b=__dcg_shared_module_exports__['Ha'](b,v=>v.orientation===e.priorOrientation)),JD(r,b),b}function Ufe(r){let e=r[0].x,t=r[0].x,o=r[0].y,i=r[0].y;for(let n=r.length-1;n>=1;n--){let{x:a,y:s}=r[n];a<e&&(e=a),a>t&&(t=a),s<o&&(o=s),s>i&&(i=s)}return{left:e,right:t,top:o,bottom:i}}var Bfe=1,hh=class{constructor(e,t,o,i,n,a,s){this.x=e,this.y=t,this.type=o,this.sketch=i,this.branch=n,this.pointIdxOnBranch=a,this.bareLabel=s===void 0?!1:s,this.id=Bfe++}getLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"labels"in e&&e.labels&&e.labels[this.pointIdxOnBranch]||""}getGraphMode(){return this.sketch.branches[this.branch].graphMode}getCompiledFunction(){let e=this.sketch.branches[this.branch];if(!(!("compiled"in e)||!e.compiled))return e.compiled.fn}isAttachedToPlottedPoint(){return this.type===1006||this.type===1008}isMovable(){return __dcg_shared_module_exports__['ad'](this.getGraphMode())}isPersistent(){return this.type===1008}getLabelSize(){let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"labelSize"in e?e.labelSize===void 0?1:e.labelSize:1}getLabelRotation(){let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"labelAngle"in e?e.labelAngle===void 0?0:e.labelAngle:0}getPointOpacity(){let e=this.sketch&&this.sketch.branches[this.branch];if(e&&"pointOpacity"in e){let t=e.pointOpacity;if(t!==void 0){let o;return Array.isArray(t)?o=t[this.pointIdxOnBranch]:o=t,isFinite(o)?Math.max(0,Math.min(1,o)):1}}return 1}getPointSize(){let e=this.sketch&&this.sketch.branches[this.branch];if(e&&"pointSize"in e){let t=e.pointSize;if(t!==void 0){let o;Array.isArray(t)?o=t[this.pointIdxOnBranch]:o=t;let i=isFinite(o)?Math.max(0,o):8;return this.isMovable()?__dcg_shared_module_exports__['me'](i):i}}return this.isMovable()?__dcg_shared_module_exports__['ne'](8):8}getTextOutline(){if(this.hasEditableLabel())return!1;let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"suppressTextOutline"in e?!e.suppressTextOutline:!0}hasInteractiveLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"interactiveLabel"in e?!!e.interactiveLabel:!1}hasEditableLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"editableLabel"in e?!!e.editableLabel:!1}isBareLabel(){return this.bareLabel}getMovablePoint(){return this.sketch.getMovablePointByIndex(this.pointIdxOnBranch)}isSelected(){return this.sketch.showHighlight}};var{If:gJ,Input:zfe,For:qfe,Switch:Hfe}=il.Components,Wfe=300,mJ={id:!0,sketchId:!0,rotatedWidth:!0,rotatedHeight:!0,alignedWidth:!0,alignedHeight:!0,content:!0,focused:!0,isNakedLabel:!0,isClickable:!0,hasOutline:!0,hasBorder:!0,classes:!0,styles:!0,dotStyles:!0,poi:!1,objectSpec:!1,x:!1,y:!1,screenX:!1,screenY:!1,left:!1,top:!1,rotation:!1,opacity:!1,forcedOrientation:!1,orientation:!1,labelDOM:!1,containerDOM:!1,willCopyToCanvas:!1,layerFilter:!1,cachedDrawingCommands:!1,animation:!1,layerNumber:!1,isComplex:!1};function fJ(r,e){return e?e.getPOIById(r):null}function Db(r,e){return 1e3*(r.pixelsToMath.mapX(r.mathToPixels.mapX(e)+.5)-r.pixelsToMath.mapX(r.mathToPixels.mapX(e)-.5))}function QD(r,e){return 1e3*(r.pixelsToMath.mapY(r.mathToPixels.mapY(e)+.5)-r.pixelsToMath.mapY(r.mathToPixels.mapY(e)-.5))}function jfe(r,{x:e,y:t}){let o=Db(r,e),i=QD(r,t);return{xscale:o,yscale:i}}function bJ(r,e){return e?[r[1],r[0]]:r}function HN(r,e){let t,o=!1,i="",n="",{poi:a}=r,s=a.getGraphMode();if(r.type==="poi"){let{xscale:d,yscale:p}=jfe(e,a);t=a.getLabel();let u,g=a.type===1007&&a.getCompiledFunction();if(g){let h=s===1,b=h?a.y:a.x,[v,T]=bJ([d,p],h);u=__dcg_shared_module_exports__['ob'](b,v,T,g),u=bJ(u,h)}else u=[__dcg_shared_module_exports__['nb'](a.x,d),__dcg_shared_module_exports__['nb'](a.y,p)];o=!isFinite(u[1].value),i=u[0].latex,n=u[1].latex,i==="undefined"&&(i="\\mathrm{undefined}"),n==="undefined"&&(n="\\mathrm{undefined}")}else t=r.text;let c=t&&__dcg_shared_module_exports__['Ke'](t);return t?c==="latex"?{is_hole:o,type:"latex",text:t.substring(1,t.length-1)}:c==="text"?{is_hole:o,type:"text",text:t}:{is_hole:o,type:"mixed",text:t}:r.type==="poi"?r.poi.hasEditableLabel()?{is_hole:o,type:"text",text:""}:s===25||s===26?{is_hole:o,type:"latex",text:__dcg_shared_module_exports__['yb']([a.x,a.y],__dcg_shared_module_exports__['qb'])}:{is_hole:o,type:"latex",text:"\\left("+i+",\\ "+n+"\\right)"}:{is_hole:o,type:"text",text:"?"}}var yJ=4,qN=class extends il.View{getClassName(){var e;return((e=this.props.point())==null?void 0:e.y)!==void 0?"dcg-audio-trace-line dcg-audio-trace-line--horizontal":"dcg-audio-trace-line"}getTraceCoord(){var i,n;let e=(i=this.props.point())==null?void 0:i.x,t=(n=this.props.point())==null?void 0:n.y,o=this.props.projection();if(e!==void 0)return`${Math.round(10*o.mapx(e))/10-yJ/2}px`;if(t!==void 0)return`${Math.round(10*o.mapy(t))/10-yJ/2}px`}getStyle(){var o;let e=this.getTraceCoord(),t=(o=this.props.point())==null?void 0:o.color;return{"--dcg-trace-coord":e,"--dcg-trace-color":t}}template(){return l("div",{class:this.bindFn(this.getClassName),style:this.bindFn(this.getStyle)})}},v1=class extends il.View{constructor(){super(...arguments),this.labelsDirty=!1,this.traceLinePt=void 0}init(){this.grapher=this.props.grapher(),this.controller=this.grapher.controller,this.cachedLabelDict={},this.cachedLabelOrder=[],this.hoveredPOI=void 0,this.openedPOI2Sketch={}}template(){return x("div",{class:il.const("dcg-graph-outer"),style:this.const({"z-index":"0"}),didMount:this.bindFn(this.didMountRoot),children:[l("div",{children:l(qfe,{each:()=>this.cachedLabelOrder,children:e=>x("div",{class:()=>this.getLabelClasses(e),style:()=>this.getLabelStyles(e),didMount:t=>this.linkLabelContainerNode(e,t),children:[l("div",{class:il.const("dcg-pt"),style:()=>this.getDotStyles(e)}),x("div",{class:il.const("dcg-label"),didMount:t=>this.linkLabelDOMNode(e,t),children:[this.renderLabelContent(e),l(gJ,{predicate:()=>this.showPOIbutton(e),children:()=>l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-button-copy-poi-coordinates"),offset:this.const({top:4}),children:l("button",{class:il.const("dcg-unstyled-button dcg-poi-copy-button"),onTap:()=>this.copyPOI(e),"aria-label":()=>this.controller.s("graphing-calculator-button-copy-poi-coordinates"),children:l("i",{class:il.const("dcg-icon-insert")})})})})]})]})})}),l(gJ,{predicate:()=>!0,children:()=>l(qN,{point:()=>this.traceLinePt,projection:()=>this.grapher.getProjection()})})]})}copyPOI(e){delete this.openedPOI2Sketch[e],this.setHoveredPOI(void 0);let t=this.controller.getNextColor();t===ov&&(t=this.controller.getNextColor()),this.controller.dispatch({type:"export-latex-to-explist",latex:this.getLabelContent(e).text,color:t})}showPOIbutton(e){if(!this.controller.isListEnabled()||!this.controller.isListVisible())return!1;let t=this.getHoveredPOI();(t==null?void 0:t.id)!==parseInt(e)&&(t=void 0);let o=fJ(e,this.grapher.graphSketches[this.openedPOI2Sketch[e]])||t;switch(o==null?void 0:o.type){case 1001:case 1002:case 1003:case 1004:return!0;default:return!1}}setTraceLine(e){__dcg_shared_module_exports__['db'](e,this.traceLinePt)||(this.traceLinePt=e,this.update())}getAriaLabelForId(e){let t=this.cachedLabelDict[e],o;t?t.isComplex?o=Mr(__dcg_shared_module_exports__['yb']([t.x,t.y])):o=Gl(this.controller,t.x,t.y):o=this.controller.s("graphing-calculator-label-poi-unknown-coordinates");let i=this.controller.s("graphing-calculator-narration-editable-point-label");return this.controller.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:i,coordinates:o})}renderLabelContent(e){return l(Hfe,{children:t=>t==="text"?l("span",{class:il.const("dcg-label-raw-text"),children:()=>this.getLabelContent(e).text}):t==="latex"?l(dt,{latex:()=>this.getLabelContent(e).text,config:this.bindFn(this.getMQConfig)}):t==="mixed"?l(Xi,{content:()=>this.getLabelContent(e).text,mqConfig:()=>this.controller.getMathquillConfig({})}):t===__dcg_shared_module_exports__['$d'].Math?l("div",{class:()=>({"dcg-editable-label-border":!0,"dcg-do-not-blur":!0,"dcg-focus":this.shouldEditableLabelBeFocused(e),"dcg-empty-label":this.getEditableLabelText(e).trim().length===0}),style:()=>({"border-color":__dcg_shared_module_exports__['sd'](this.getEditableLabelTextColor(e),.3)}),children:l(Qe,{latex:()=>this.getEditableLabelText(e),placeholder:()=>"",isFocused:()=>this.shouldEditableLabelBeFocused(e),capExpressionSize:()=>this.controller.getGraphSettings().config.capExpressionSize,selectOnFocus:il.const(!1),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabelForId(e),getAriaPostLabel:this.const(""),onUserChangedLatex:o=>this.onLabelInput(o,e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:o=>this.onEditableLabelFocusChange(o,e),hasError:this.const(!1),noFadeout:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()})}):x("div",{class:()=>({"dcg-resizing-text-input-container":!0,"dcg-editable-label-border":!0,"dcg-focus":this.shouldEditableLabelBeFocused(e),"dcg-empty-label":this.getEditableLabelText(e).trim().length===0}),style:()=>({"border-color":__dcg_shared_module_exports__['sd'](this.getEditableLabelTextColor(e),.3)}),onScroll:o=>{o.target&&(o.target.scrollLeft=0)},children:[l(zfe,{"aria-label":()=>this.getAriaLabelForId(e),onInput:o=>this.onLabelInput(o,e),value:()=>this.getEditableLabelText(e),onFocus:()=>this.onEditableLabelFocusChange(!0,e),onBlur:()=>this.onEditableLabelFocusChange(!1,e)}),l("span",{class:il.const("dcg-text-input-content"),children:()=>this.getEditableLabelText(e)||" "})]})},()=>this.getLabelContent(e).type)}getSketchIdFromLabelId(e){let t=this.cachedLabelDict[e];if(t)return t.sketchId}getEditableLabelTextColor(e){let t=this.getSketchIdFromLabelId(e);if(!t)return"#000";let o=this.controller.getItemModel(t);return!o||o.type!=="expression"?"#000":Eg(o)}onEditableLabelFocusChange(e,t){let o=this.getSketchIdFromLabelId(t);o&&(e?this.controller.dispatch({type:"set-focus-location",location:{type:"editable-label",id:o}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"editable-label",id:o}}),this.update())}shouldEditableLabelBeFocused(e){let t=this.getSketchIdFromLabelId(e),o=this.controller.getFocusLocation();return!(!o||o.type!=="editable-label"||!t||o.id!==t)}onLabelInput(e,t){let o=this.getSketchIdFromLabelId(t);if(!o)return;let i=this.controller.getItemModel(o);if(!i||i.type!=="expression")return;let n=e;this.controller.getItemEditableLabelMode(o)===__dcg_shared_module_exports__['$d'].Math&&n.length>0&&(n="`"+n+"`"),this.controller.dispatch({type:"set-item-label",id:o,label:n})}getEditableLabelText(e){let t=this.getSketchIdFromLabelId(e);if(!t)return"";let o=this.controller.getItemModel(t);return!o||o.type!=="expression"?"":this.controller.getItemEditableLabelMode(t)===__dcg_shared_module_exports__['$d'].Math?o.label.substring(1,o.label.length-1):o.label}linkLabelDOMNode(e,t){let o=this.cachedLabelDict[e];o&&(o.labelDOM=t)}linkLabelContainerNode(e,t){let o=this.cachedLabelDict[e];o&&(o.containerDOM=t)}getLabelClasses(e){let t=this.cachedLabelDict[e];return t?t.classes:{}}getLabelStyles(e){let t=this.cachedLabelDict[e];return t?t.styles:{}}getDotStyles(e){let t=this.cachedLabelDict[e];return t?t.dotStyles:{}}getLabelContent(e){let t=this.cachedLabelDict[e];if(t){let o=this.getSketchIdFromLabelId(e);if(!o)return{is_hole:!1,type:"text",text:""};let i=this.controller.getItemEditableLabelMode(o);return t.classes["dcg-editable-label"]&&i!==void 0&&i!==__dcg_shared_module_exports__['$d'].None?{is_hole:!1,type:i,text:""}:t.content}return{is_hole:!1,type:"text",text:""}}didMountRoot(e){this.node=e}computeHoveredLabel(e,t){let o;this.hoveredPOI?this.isOpenPOI(this.hoveredPOI)?this.grapher.setLayerClass("hoveredPOI","dcg-mouse-over-opened-poi"):(o=this.computeLabel(e,{poi:this.hoveredPOI,type:"poi"},t,"hovered",1/0),this.grapher.setLayerClass("hoveredPOI","dcg-mouse-over-closed-poi")):this.grapher.setLayerClass("hoveredPOI",void 0);let i=this.getHoveredInteractiveLabel();i&&!i.bareLabel?this.grapher.setLayerClass("interactiveLabel","dcg-mouse-over-opened-poi"):this.grapher.setLayerClass("interactiveLabel",void 0),o&&this.saveLabelToCache(o)}computeTraceLabel(e,t){if(!this.traceInfo)return;let o=this.traceInfo.pt;if(!o)return;let i=new hh(o.x,o.y,1007,this.traceInfo.branchInfo.sketch,this.traceInfo.branchInfo.branch,0),n=this.computeLabel(e,{poi:i,type:"poi"},t,"trace",1/0);n&&this.saveLabelToCache(n)}computeLabel(e,t,o,i,n){var Se,Ce;let{projection:a}=e,s=t.type==="poi"?t.poi.id+"":t.id;i==="trace"&&(s="*trace*");let c=t.poi,d=a.mapx(c.x),p=a.mapy(c.y),u=d,g=p;if(t.type!=="poi"&&(d=0,p=0),!a.coordsAreOnscreen(d,p,20)||this.isHiddenInteractiveLabel(c))return;let h=!1,b,v=c.sketch,T=v&&v.branches[0];T&&(h=!!("nakedLabel"in T&&T.nakedLabel),b="labelOrientation"in T?T.labelOrientation:void 0);let E=v.id,I=this.controller.getItemModel(E);if(c.hasEditableLabel()&&I&&I.type==="expression"&&!Dn(I))return;let _=(I==null?void 0:I.type)==="expression"&&__dcg_shared_module_exports__['wa']((Ce=(Se=I.formula)==null?void 0:Se.typed_constant_value)==null?void 0:Ce.valueType,__dcg_shared_module_exports__['_']),C=HN(t,a),D=c.pointIdxOnBranch,P=c.getLabelSize();this.grapher.settings.config.projectorMode&&(P*=1.2),Array.isArray(P)&&(P=P[D]);let F=c.getLabelRotation();Array.isArray(F)&&(F=F[D]);let N=c.getPointOpacity()*this.controller.getGeoModel().getToolFadeOpacity(E),Y=c.getTextOutline(),z=c.isPersistent(),X=c.isAttachedToPlottedPoint(),q=c.hasInteractiveLabel(),S=c.hasEditableLabel(),A=(I==null?void 0:I.type)==="expression"&&Jn(I),O=this.grapher.clickableObjectsLayer.shouldDrawPressed(E,c.pointIdxOnBranch),B=this.grapher.clickableObjectsLayer.shouldDrawHovered(e,E,c.pointIdxOnBranch),V=this.grapher.clickableObjectsLayer.isKeyboardFocused(E,c.pointIdxOnBranch),K=v.color;if(O){let Te=__dcg_shared_module_exports__['x'](K);Te.l>.2?Te.l-=.2:Te.l+=.1,K=Te.toString()}else if(B){let Te=__dcg_shared_module_exports__['x'](K);Te.l>.2?Te.l-=.1:Te.l+=.2,K=Te.toString()}let oe=!z,Z=X;q&&(Z=!0,oe=!0),i==="trace"&&(Z=!1,oe=!0);let ee=o[s],ue=ee&&ee.orientation,he={"dcg-poi-label":!0,"dcg-tracept":i==="trace","dcg-opened":i==="opened","dcg-hole":C.is_hole,"dcg-show-border":oe,"dcg-hide-dot":Z,"dcg-naked-label":h,"dcg-editable-label":S&&!this.takingScreenshot,"dcg-has-outline":Y&&!oe,"dcg-focus":V};isFinite(P)||(P=1);let $={"font-size":Math.round(P*1100)/10+"%"},se=!he["dcg-editable-label"]&&!he["dcg-tracept"]&&!he["dcg-show-border"]&&!q,J=S?"above-canvas":se?"canvas-labels":"not-drawn";se?$.visibility="hidden":($.left=d+"px",$.top=p+"px",F&&($.transform=`rotate(${F}rad)`),delete $.opacity),z&&K&&($.color=K);let ye={};return i==="trace"&&(ye["background-color"]=K,ye["border-color"]=K),{id:s,sketchId:E,poi:c,x:c.x,y:c.y,screenX:d,screenY:p,top:g,left:u,rotatedWidth:ee==null?void 0:ee.rotatedWidth,rotatedHeight:ee==null?void 0:ee.rotatedHeight,alignedWidth:ee==null?void 0:ee.alignedWidth,alignedHeight:ee==null?void 0:ee.alignedHeight,labelDOM:ee==null?void 0:ee.labelDOM,containerDOM:ee==null?void 0:ee.containerDOM,cachedDrawingCommands:ee==null?void 0:ee.cachedDrawingCommands,animation:ee==null?void 0:ee.animation,forcedOrientation:b,focused:V,isNakedLabel:h,isClickable:A,orientation:ue,rotation:F,classes:he,styles:$,dotStyles:ye,content:C,hasBorder:c.hasEditableLabel(),willCopyToCanvas:se,layerFilter:J,opacity:N,layerNumber:n,isComplex:_,hasOutline:Y||c.hasEditableLabel(),objectSpec:t.type!=="poi"?t.type==="angle"?{type:t.type,segments:[a.mapx(t.segments[0]),a.mapy(t.segments[1]),t.segments[2],t.segments[3]]}:{type:t.type,segments:a.map_xy_pairs(t.segments)}:void 0}}computeAllLabels(e,t){let o={},i,n,a=this.grapher.graphSketches;for(let c of this.grapher.getDrawLayers())for(let d of c.drawOrder){let p=a[d];if(!p)continue;let u=p.labels;if(u.length)for(let g=0;g<u.length;g++){let h=u[g],b=this.computeLabel(e,h,t,"opened",c.layer);b&&(Array.isArray(p.color)&&(b.styles.color=p.color[g]),this.saveLabelToCache(b))}}let s={};for(i in this.openedPOI2Sketch){let c=fJ(i,a[this.openedPOI2Sketch[i]]);c&&(s[i]=c.sketch.id,n=this.computeLabel(e,{poi:c,type:"poi"},t,"opened",1/0),n&&this.saveLabelToCache(n))}return this.openedPOI2Sketch=s,o}saveLabelToCache(e){let t=e.id;this.cachedLabelDict[t]||this.cachedLabelOrder.push(t),this.cachedLabelDict[t]=e}markLabelsDirty(){this.labelsDirty=!0}getInteractiveLabelUnderPoint(e){let t;for(let o=this.cachedLabelOrder.length-1;o>=0;o--){let i=this.cachedLabelOrder[o],n=this.cachedLabelDict[i];if(!n||!n.rotatedWidth||!n.rotatedHeight)continue;let a=n.screenX,s=n.screenY,{left:c,top:d,rotatedWidth:p,rotatedHeight:u}=n;if(p>0&&u>0&&e.x>a+c&&e.x<a+c+p&&e.y>s+d&&e.y<s+d+u){let g=this.getSketchIdFromLabelId(i);if(g===void 0)continue;let h=this.controller.getItemModel(g);if(!h||h.type!=="expression")continue;if(Nv(h))return{type:"editable",model:h,layerNumber:n.layerNumber};!t&&h7(h)?t={type:"draggable",model:h,layerNumber:n.layerNumber,label:{x:n.x,y:n.y}}:!t&&n.isClickable&&(t={type:"clickable",model:h,layerNumber:n.layerNumber,poi:n.poi})}}return t}positionLabels(e,t,o,i){let n=!this.labelsDirty;this.labelsDirty=!1;let a=[];e.forEach(p=>{let u=t[p];if(!u||!u.labelDOM)return;let g,h,b=this.getSketchIdFromLabelId(p);if(b!==void 0){let N=this.grapher.getGraphSketch(b);N&&N.branches&&(g=N.branches[0].pointSize,h=__dcg_shared_module_exports__['ad'](N.branches[0].graphMode))}(g===void 0||typeof g!="number"||g<0)&&(g=8);let v=this.grapher.settings.config.projectorMode?1.3:1;h&&(g=__dcg_shared_module_exports__['me'](g));let T=u.poi.sketch.style;if(h)switch(T){case __dcg_shared_module_exports__['Cd'].TRIANGLE:g*=1.1;break;case __dcg_shared_module_exports__['Cd'].DIAMOND:g*=1.05;break}else switch(T){case __dcg_shared_module_exports__['Cd'].TRIANGLE:g*=1.4;break;case __dcg_shared_module_exports__['Cd'].PLUS:g*=1.35;break;case __dcg_shared_module_exports__['Cd'].STAR:g*=1.3;break;case __dcg_shared_module_exports__['Cd'].DIAMOND:g*=1.2;break}let E=.5*g*v+3,I=u.screenX,_=u.screenY,C=u.classes["dcg-show-border"]?2:0,D=u.labelDOM.clientWidth+C,P=u.labelDOM.clientHeight+C;if(!(D>0&&P>0))return;let F=0;this.takingScreenshot&&u.hasBorder&&(F=5),a.push({renderedLabel:u,pt_x:I,pt_y:_,pt_radius:E+F,rotation:u.rotation,nakedLabel:u.isNakedLabel,width:D,height:P,keepOrientation:n,priorOrientation:u.orientation,enforceOrientation:u.forcedOrientation})});let s=cJ(i,o),c=a.map(p=>{if(p.renderedLabel.objectSpec){if(p.renderedLabel.objectSpec.type==="segment")return pJ(s,{pt_x1:p.renderedLabel.objectSpec.segments[0],pt_y1:p.renderedLabel.objectSpec.segments[1],pt_x2:p.renderedLabel.objectSpec.segments[2],pt_y2:p.renderedLabel.objectSpec.segments[3],pt_radius:10,width:p.width,height:p.height,keepOrientation:p.keepOrientation,priorOrientation:p.priorOrientation||""});if(p.renderedLabel.objectSpec.type==="polygon")return hJ(s,{path:p.renderedLabel.objectSpec.segments,pt_radius:10,width:p.width,height:p.height,keepOrientation:p.keepOrientation,priorOrientation:p.priorOrientation||""});if(p.renderedLabel.objectSpec.type==="angle"){let u=p.renderedLabel.objectSpec.segments,g=this.grapher.settings.config.projectorMode?30:20;return uJ(s,{pt_x:u[0],pt_y:u[1],startAngle:u[2],deltaAngle:u[3],isRightAngle:BD(u[3]),radius:g,pt_radius:10,width:p.width,height:p.height,keepOrientation:p.keepOrientation,priorOrientation:p.priorOrientation||""})}}else return dJ(s,p);return[]});lJ(c).forEach((p,u)=>{let g=a[u].renderedLabel;g.orientation=p.orientation;let h=p.left-p.pt_x,b=p.top-p.pt_y;g.left=h,g.top=b,g.rotatedWidth=p.width,g.rotatedHeight=p.height,g.alignedWidth=a[u].width,g.alignedHeight=a[u].height;let v=p.translate.multiplyWidth*g.alignedWidth+p.translate.addX,T=p.translate.multiplyHeight*g.alignedHeight+p.translate.addY;g.screenX=p.pt_x,g.screenY=p.pt_y;let E=g.animation;E||(E={from_dx:v,from_dy:T,to_dx:v,to_dy:T,now_dx:v,now_dy:T,positionChangeTime:0,orientation:p.orientation},g.animation=E),E.orientation===p.orientation&&(E.to_dx=v,E.to_dy=T);let I,_,C=(Date.now()-E.positionChangeTime)/Wfe;if(C<1){let P=.3*C+2.4*C*C-1.7*C*C*C;I=E.from_dx*(1-P)+E.to_dx*P,_=E.from_dy*(1-P)+E.to_dy*P}else I=E.to_dx,_=E.to_dy;E.now_dx=I,E.now_dy=_,E.to_dx=v,E.to_dy=T,E.orientation!==p.orientation&&(E.positionChangeTime=Date.now(),E.from_dx=I,E.from_dy=_,E.orientation=p.orientation);let D=g.labelDOM;if(D&&!g.willCopyToCanvas){D.style.transform=`translate(${E.now_dx}px,${E.now_dy}px)`;let P=g.containerDOM;P&&(P.style.left=p.pt_x+"px",P.style.top=p.pt_y+"px")}})}copyToCtx(e,t){_s(e,"labels");let o=this.node.getBoundingClientRect();this.cachedLabelOrder.forEach(i=>{var u,g;let n=this.cachedLabelDict[i];if(!n||!n.willCopyToCanvas)return;let a=n.labelDOM;if(!a||t.filter!==n.layerFilter||!t.allowedSketches.has(n.sketchId))return;let s=(u=n.cachedDrawingCommands)==null?void 0:u.commands,c={};for(let h in mJ)if(mJ[h]===!0){let b=n[h],v=(g=n.cachedDrawingCommands)==null?void 0:g.cacheKeys[h];c[h]=b,__dcg_shared_module_exports__['db'](v,b)||(s=void 0)}if(!s){let h={originX:o.x,originY:o.y,hasOutline:!!n.hasOutline,hasBorder:!!n.hasBorder,hasFocus:!!n.focused&&n.isNakedLabel};s=WD(a,h),n.cachedDrawingCommands={cacheKeys:c,commands:s}}let d=this.computeRotatedCenter(n.screenX,n.screenY,n.rotation),p={x:0,y:0};n.animation&&(p.x=n.animation.now_dx,p.y=n.animation.now_dy),e.save(),e.globalAlpha=n.opacity,e.rotate(n.rotation),e.translate(d.x+p.x,d.y+p.y),jD(s,e),e.restore()}),Cs(e)}areAnyLabelsAnimating(){var e;for(let t in this.cachedLabelDict){let o=(e=this.cachedLabelDict[t])==null?void 0:e.animation;if(o&&(o.now_dx!==o.to_dx||o.now_dy!==o.to_dy))return!0}return!1}computeRotatedCenter(e,t,o){let i=Math.cos(-o),n=Math.sin(-o),a=e*i-t*n,s=t*i+e*n;return{x:a,y:s}}recomputeLabels(e,t,o){let i=this.cachedLabelDict;this.cachedLabelDict={},this.cachedLabelOrder=[],this.computeAllLabels(e,i),this.computeHoveredLabel(e,i),this.computeTraceLabel(e,i),this.update(),this.positionLabels(this.cachedLabelOrder,this.cachedLabelDict,t,o)}clearOpenedPOI(){this.openedPOI2Sketch={}}closePOI(e){delete this.openedPOI2Sketch[e.id]}openPOI(e){this.openedPOI2Sketch[e.id]=e.sketch.id}isOpenPOI(e){return this.openedPOI2Sketch.hasOwnProperty(e.id)}isHiddenInteractiveLabel(e){return!e||!e.hasInteractiveLabel()?!1:!this.isOpenPOI(e)&&this.getHoveredPOI()!==e}setHoveredPOI(e){this.hoveredPOI=e}getHoveredPOI(){return this.hoveredPOI}getHoveredInteractiveLabel(){let e=this.getHoveredPOI();if(e&&e.hasInteractiveLabel())return e}setTraceInfo(e){this.traceInfo=e}isTracing(){return!!this.traceInfo}getTraceInfo(){return this.traceInfo}getMQConfig(){return this.controller.getMathquillConfig({})}};function im(r,e){let t=r[e];return Array.isArray(t)&&r.tableInfo?t[r.tableInfo.rowIndex]:t}var kk=class{constructor(e){this.geoHoveredObjects={},this.grapher=e,this.renderedPointsIdOrder=[],this.renderedPoints={},this.speakThrottledAlert=__dcg_shared_module_exports__['Za'](()=>{let t=this.getPOIUnderAttention();if(!t){this.lastAriaAlert=void 0;return}let o=this.getAriaAlert({id:t.id,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!1});o!=null&&o.updated&&(_e(o.completeMessage),this.lastAriaAlert=o)},1e3,{leading:!1,trailing:!0})}recomputeMovablePoints(e){let{projection:t}=e,o=this.grapher.graphSketches,i=this.renderedPoints;this.renderedPoints={},this.renderedPointsIdOrder=[];let n=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention(),a=n==null?void 0:n.calcId,s=(n==null?void 0:n.listIndex)||0,c=E=>{let I=!!n&&a===E.sketch.id&&s===E.listIndex,_=this.processPOI(t,E,i[E.id],I);_&&(this.renderedPoints[E.id]=_,this.renderedPoints[E.id].poi=E,this.renderedPointsIdOrder.push(E.id))};for(let E of this.grapher.generateMergeDrawOrder()){let I=o[E];I&&(I.getMovablePoints().forEach(c),I.getStaticLabeledPoints().forEach(c))}let d=this.renderedPoints[this.hoveredPointId],p=this.renderedPoints[this.pressedPointId],u=d&&d.poi,g=p&&p.poi;u||this.setHoveredPointId(void 0),g||this.setPressedPointId(void 0);let h=g||u,b,v;if(h?(b=h.type==="movable-point"&&h.tableInfo&&h.tableInfo.dragX,v=h.type==="movable-point"&&h.tableInfo&&h.tableInfo.dragY,b&&v||!b&&!v?this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point"):b?this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point-ew"):this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point-ns")):this.grapher.setLayerClass("movablePoints",void 0),!this.getPOIUnderAttention()){this.lastAriaAlert=void 0;return}this.speakThrottledAlert()}_clampedOpacity(e){return e<0?0:e>1?1:__dcg_shared_module_exports__['ib'](e)?e:1}getAllRenderedObjects(e){return this.renderedPointsIdOrder.filter(t=>e?this.renderedPoints[t].type===e:!0).map(t=>this.renderedPoints[t])}getOrderedTabTargets(e){let t=[];return this.renderedPointsIdOrder.forEach(o=>{let i=this.renderedPoints[o];if(e&&i.type!==e||this.getTabIndex(o)===-1)return;let n=i.poi;t.push({calcId:n.sketch.id,listIndex:n.listIndex,polygonEdge:void 0,description:this.getAriaLabel(o)})}),t}redrawToCtx(e,t,o,i){let n=this.grapher.graphSketches;for(let a of o){let s=n[a];if(!s)continue;let c=s.branches[0],d,p,u,g=!1;__dcg_shared_module_exports__['pd'](c)&&(d=c.pointOpacity,p=c.pointSize!==void 0?c.pointSize:8,u=c.style!==void 0?c.style:__dcg_shared_module_exports__['Cd'].POINT,g=!!c.pointOutline),s.getMovablePoints().forEach(h=>{let b;if(i.renderForScreenshot)b={screenX:t.mapx(h.x),screenY:t.mapy(h.y),color:h.color,pointOpacity:d,pointSize:p,pointStyle:u,animationPercent:0};else if(b=this.renderedPoints[h.id],!b||b.type!=="movable")return;let v=g;i.showMovablePoints?this.drawMovablePointOnCtx(e,h.sketch,{...b,enableWhiteOutline:v}):ud.drawPointToCtx({ctx:e,projection:t,x:h.x,y:h.y,alpha:d,sketch:h.sketch,sizeFactor:p/8,style:u,opacityFactor:1,colorOverride:h.color,enableWhiteOutline:v})})}}processPOI(e,t,o,i){let n=t.id,a=t.x,s=t.y,c=e.mapx(a),d=e.mapy(s),p=t.sketch.branches[0],u=this.grapher.settings.config.projectorMode?1.3:1,g=__dcg_shared_module_exports__['pd'](p)&&p.pointSize!==void 0?p.pointSize:8*u,h=e.coordsAreOnscreen(c,d,g);if(!h&&!i)return;let b=t.sketch?this.grapher.controller.getItemModel(t.sketch.id):void 0,v=!!(b&&Mn(b));if(!(b&&this.grapher.controller.shouldIgnoreGraphInteractions(b)))return o||(t.type==="movable-point"?o={type:"movable",id:n,pointOnScreen:h,poi:t,projection:e,screenX,screenY,color:im(t,"color"),pointOpacity:im(t,"pointOpacity"),pointSize:im(t,"pointSize"),pointStyle:im(t,"pointStyle"),pointIsHovered:!1,pointIsPressed:!1,selected:v,lastHoverActionTime:0,animationPercent:0}:b&&b.type==="expression"&&b.label!==void 0&&b.showLabel&&co(b)!==__dcg_shared_module_exports__['Gd'].NONE?o={type:"draggable-label",id:n,pointOnScreen:h,selected:v,poi:t,projection:e,screenX,screenY}:o={type:"static",id:n,pointOnScreen:h,poi:t,projection:e,screenX,screenY,selected:v}),o.pointOnScreen=h,o.poi=t,o.projection=e,o.screenX=c,o.screenY=d,o.type==="movable"&&(o.color=im(o.poi,"color"),o.pointOpacity=im(o.poi,"pointOpacity"),o.pointSize=im(o.poi,"pointSize"),o.pointStyle=im(o.poi,"pointStyle"),o.selected=v,this.updateMovablePointAnimation(o,i)),o}drawMovablePointOnCtx(e,t,o){var v;let i=o.pointSize/2*(this.grapher.settings.config.projectorMode?1.3:1);i<0&&(i=0),t.showHighlight&&(i*=1.15);let n=Array.isArray(o.color)?o.color[0]:o.color,a=o.animationPercent||0,s=this.shouldDrawGhosted(t.id)?MD.IS_GHOSTED:xk,c=this._clampedOpacity(s*o.pointOpacity);c*=(v=this.grapher.controller.getGeoModel().getToolFadeOpacity(t.id))!=null?v:1;let d=t.tokenHovered||!!this.geoHoveredObjects[t.id],p=o.pointStyle,u={x:o.screenX,y:o.screenY},g=o.enableWhiteOutline,h=e.fillStyle,b=e.globalAlpha;e.fillStyle=n,e.globalAlpha=c,ud.drawMoveablePoint(e,p,u,i,g,d,a),e.globalAlpha=b,e.fillStyle=h}updateMovablePointAnimation(e,t){let o=Date.now(),i=e.id,n=this.hoveredPointId===i||t,a=this.pressedPointId===i;e.pointIsPressed=a,n!==e.pointIsHovered&&(e.pointIsHovered=n,e.lastHoverActionTime=o);let s=e.animationPercent||0,d=.004*(o-e.lastHoverActionTime);a?s=1:n?(s+=d,s>=1?s=1:this.requestRedrawNextFrame()):(s-=d,s<=0?s=0:this.requestRedrawNextFrame()),e.animationPercent=s}shouldDrawGhosted(e){if(!e)return!1;let t=this.grapher.controller.getItemModel(e);return!t||t.type!=="expression"?!1:ji(t)}getTabIndex(e){if(this.grapher.controller.getActiveTool()!=="selection")return-1;let t=this.renderedPoints[e];if(!t)return-1;let o=t.poi,i=this.grapher.controller.getItemEditableLabelMode(o.sketch.id),n=this.grapher.controller.getItemModel(o.sketch.id),a=n&&n.type==="expression"&&!Jn(n)&&(t.type==="movable"||i===void 0||i===__dcg_shared_module_exports__['$d'].None),s=this.grapher.settings,c=s.config.graphpaper&&s.config.enableTabindex;return a&&c?0:-1}getAriaHidden(){return!this.grapher.settings.config.graphpaper}getAriaLabel(e){let t=this.getAriaAlert({id:e,includeUsageInstructions:!1});return t&&t.completeMessage}speakAriaAlert(){var i;let e=(i=this.getPOIUnderAttention())==null?void 0:i.id;if(e){let n=this.renderedPoints[e];if(!n||n.type==="static")return this.lastAriaAlert=void 0,!1}let t=this.getAriaAlert({id:e,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!0}),o=!this.lastAriaAlert||this.lastAriaAlert.id!==e||!!(t!=null&&t.updated);return this.lastAriaAlert=t,t!=null&&t.completeMessage?(o&&_e(t.completeMessage),!0):!1}getAriaAlert(e){var z,X;let{id:t,lastAriaAlert:o,includeUsageInstructions:i}=e;if(!t)return;let n=this.renderedPoints[t];if(!n)return;let{controller:a}=this.grapher,s=n.poi.sketch?a.getItemModel(n.poi.sketch.id):void 0;if(!s||s.type!=="expression")return;o&&o.id!==t&&(o=void 0);let c=n.poi,d=n.pointOnScreen,p=n.projection,u=((z=s==null?void 0:s.formula.typed_constant_value)==null?void 0:z.valueType)===__dcg_shared_module_exports__['_']?(X=s==null?void 0:s.formula.typed_constant_value)==null?void 0:X.value:void 0;if(!c||!p||!p.viewport)return;let h=o==null?void 0:o.label,b;a.isGeometry()&&xs(s)?b=AD(s,a,{listIndex:c.listIndex,poi:c,includeDetails:!1}).join(" "):b=s.description?po(tl(s,c.listIndex)):c.ariaLabel;let v=h!==b,T=n.selected,E=!!(o!=null&&o.selected)!==T,I=c.x,_=c.y,C=I!==(o==null?void 0:o.coordX)||_!==(o==null?void 0:o.coordY),D=o&&(v||E||C),P=b||a.s("graphing-calculator-narration-movable-point-prefix"),F=!a.isGeometry()&&(n.type==="movable"||n.type==="draggable-label")&&i?a.s("graphing-calculator-narration-movable-point-suffix-usage-instructions"):"",N=d?"":a.s("graphing-calculator-narration-movable-point-off-screen-prompt"),Y;if(o?v||!C&&E?Y=P+N:C?u?Y=`${Mr(__dcg_shared_module_exports__['yb'](u))}${N}`:Y=`${cd(a,I)} ${dd(a,_)}${N}`:E?Y=P:Y=o.completeMessage:Y=`${a.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:P,coordinates:u?Mr(__dcg_shared_module_exports__['yb'](u)):Gl(a,I,_)})}${F}${N}`,(!o||D)&&a.isGeometry()&&(n.type==="movable"||n.type==="draggable-label")){let q=a.getActiveTool();(q==="selection"||q==="box-selection")&&(Y=WN(Y||b||"",s,a))}return{id:t,coordX:I,coordY:_,label:b,selected:T,completeMessage:Y,updated:D}}setHoveredPointId(e){e!==this.hoveredPointId&&(this.hoveredPointId=e,this.requestRedrawNextFrame())}isMovingPoint(){return!!this.pressedPointId}setPressedPointId(e){e!==this.pressedPointId&&(this.pressedPointId=e,this.requestRedrawNextFrame())}getPOIUnderAttention(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();if(!e)return;let t=e.listIndex||0;for(let o in this.renderedPoints){let n=this.renderedPoints[o].poi;if(n.sketch.id===e.calcId&&n.listIndex===t)return n}}setGeoHoveredObjects(e){__dcg_shared_module_exports__['db'](e,this.geoHoveredObjects)||(this.geoHoveredObjects=e,this.requestRedrawNextFrame())}requestRedrawNextFrame(){this.grapher.controller.requestRedrawGraph()}};function Gl(r,e,t){return cd(r,e)+" "+dd(r,t)}function cd(r,e){let t=r.get2dProjection();if(!t)return"";let{width:o}=t.screen;return r.getReconciledReportPosition()==="coordinates"?r.s("graphing-calculator-narration-audio-trace-property-x",{x:Mr(__dcg_shared_module_exports__['nb'](e,Db(t,e)).latex)}):r.s("graphing-calculator-narration-x-percentage-coordinate",{x:Math.round(t.mathToPixels.mapX(e)/o*1e3)/10})}function dd(r,e){let t=r.get2dProjection();if(!t)return"";let{height:o}=t.screen;return r.getReconciledReportPosition()==="coordinates"?r.s("graphing-calculator-narration-audio-trace-property-y",{y:Mr(__dcg_shared_module_exports__['nb'](e,Db(t,e)).latex)}):r.s("graphing-calculator-narration-y-percentage-coordinate",{y:Math.round(t.mathToPixels.mapY(e)/o*1e3)/10})}function Wr(r,e,t=0){if(!r)return"";let{controller:o}=r;if(r.type==="expression"){let i=o.isItemSecret(r.id);switch(e){case"describe":return i?o.s("graphing-calculator-narration-describe-secret-expression",{index:r.secretIndex}):o.s("graphing-calculator-narration-describe-expression",{index:r.displayIndex});case"delete":return i?o.s("graphing-calculator-narration-delete-secret-expression",{index:r.secretIndex}):o.s("graphing-calculator-narration-delete-expression",{index:r.displayIndex});case"duplicate":return i?o.s("graphing-calculator-narration-duplicate-secret-expression",{index:r.secretIndex}):o.s("graphing-calculator-narration-duplicate-expression",{index:r.displayIndex});case"show":return i?o.s("graphing-calculator-narration-show-secret-expression",{index:r.secretIndex}):o.s("graphing-calculator-narration-show-expression",{index:r.displayIndex});case"hide":return i?o.s("graphing-calculator-narration-hide-secret-expression",{index:r.secretIndex}):o.s("graphing-calculator-narration-hide-expression",{index:r.displayIndex});case"show-options":return i?o.s("graphing-calculator-narration-show-options-secret-expression",{index:r.secretIndex}):o.s("graphing-calculator-narration-show-options-expression",{index:r.displayIndex});case"hide-options":return i?o.s("graphing-calculator-narration-hide-options-secret-expression",{index:r.secretIndex}):o.s("graphing-calculator-narration-hide-options-expression",{index:r.displayIndex});case"create_table":return i?o.s("graphing-calculator-narration-create-table-secret-expression",{index:r.secretIndex}):o.s("graphing-calculator-narration-create-table-expression",{index:r.displayIndex});case"rename":return i?o.s("graphing-calculator-narration-rename-secret-expression",{index:r.secretIndex}):o.s("graphing-calculator-narration-rename-expression",{index:r.displayIndex});case"mute":return i?o.s("graphing-calculator-narration-mute-secret-expression",{index:r.secretIndex}):o.s("graphing-calculator-narration-mute-expression",{index:r.displayIndex});case"unmute":return i?o.s("graphing-calculator-narration-unmute-secret-expression",{index:r.secretIndex}):o.s("graphing-calculator-narration-unmute-expression",{index:r.displayIndex})}}if(r.type==="image")switch(e){case"describe":return tl(r,t)||o.s("graphing-calculator-narration-describe-image",{index:r.displayIndex});case"delete":return o.s("graphing-calculator-narration-delete-image",{index:r.displayIndex});case"duplicate":return o.s("graphing-calculator-narration-duplicate-image",{index:r.displayIndex});case"show":return o.s("graphing-calculator-narration-show-image",{index:r.displayIndex});case"hide":return o.s("graphing-calculator-narration-hide-image",{index:r.displayIndex});case"show-options":return o.s("graphing-calculator-narration-show-options-image",{index:r.displayIndex});case"hide-options":return o.s("graphing-calculator-narration-hide-options-image",{index:r.displayIndex});case"edit_title":return o.s("graphing-calculator-narration-edit-image-title",{index:r.displayIndex})}if(r.type==="text")switch(e){case"describe":return o.s("graphing-calculator-narration-describe-text",{index:r.displayIndex});case"delete":return o.s("graphing-calculator-narration-delete-text",{index:r.displayIndex});case"duplicate":return o.s("graphing-calculator-narration-duplicate-text",{index:r.displayIndex});case"show":return o.s("graphing-calculator-narration-show-text",{index:r.displayIndex});case"hide":return o.s("graphing-calculator-narration-hide-text",{index:r.displayIndex});case"edit_title":return o.s("graphing-calculator-narration-edit-text-title",{index:r.displayIndex})}if(r.type==="table")switch(e){case"describe":return o.s("graphing-calculator-narration-describe-table",{index:r.displayIndex});case"delete":return o.s("graphing-calculator-narration-delete-table",{index:r.displayIndex});case"duplicate":return o.s("graphing-calculator-narration-duplicate-table",{index:r.displayIndex});case"show":return o.s("graphing-calculator-narration-show-table",{index:r.displayIndex});case"hide":return o.s("graphing-calculator-narration-hide-table",{index:r.displayIndex});case"rename":return o.s("graphing-calculator-narration-rename-table",{index:r.displayIndex})}if(r.type==="folder"){let i=!!r.title;switch(e){case"describe":return i?o.s("graphing-calculator-narration-describe-folder-title",{folder:r.title}):o.s("graphing-calculator-narration-describe-folder-index",{index:r.displayIndex});case"collapse":return i?o.s("graphing-calculator-narration-collapse-folder-title",{folder:r.title}):o.s("graphing-calculator-narration-collapse-folder-index",{index:r.displayIndex});case"expand":return i?o.s("graphing-calculator-narration-expand-folder-title",{folder:r.title}):o.s("graphing-calculator-narration-expand-folder-index",{index:r.displayIndex});case"show":return i?o.s("graphing-calculator-narration-show-folder-title",{folder:r.title}):o.s("graphing-calculator-narration-show-folder-index",{index:r.displayIndex});case"hide":return i?o.s("graphing-calculator-narration-hide-folder-title",{folder:r.title}):o.s("graphing-calculator-narration-hide-folder-index",{index:r.displayIndex});case"duplicate":return i?o.s("graphing-calculator-narration-duplicate-folder-title",{folder:r.title}):o.s("graphing-calculator-narration-duplicate-folder-index",{index:r.displayIndex});case"delete":return i?o.s("graphing-calculator-narration-delete-folder-title",{folder:r.title}):o.s("graphing-calculator-narration-delete-folder-index",{index:r.displayIndex});case"edit_title":return o.s("graphing-calculator-narration-edit-folder-title",{index:r.displayIndex})}}switch(e){case"describe":return o.s("graphing-calculator-narration-describe");case"delete":return o.s("graphing-calculator-narration-delete");case"duplicate":return o.s("graphing-calculator-narration-duplicate");case"expand":return o.s("graphing-calculator-narration-expand");case"collapse":return o.s("graphing-calculator-narration-collapse");case"show":return o.s("graphing-calculator-narration-show");case"hide":return o.s("graphing-calculator-narration-hide");case"show-options":return o.s("graphing-calculator-narration-show-options");case"hide-options":return o.s("graphing-calculator-narration-hide-options");case"create_table":return o.s("graphing-calculator-narration-create-table");case"rename":return o.s("graphing-calculator-narration-rename");case"edit_title":return o.s("graphing-calculator-narration-edit-title");case"mute":return o.s("graphing-calculator-narration-mute");case"unmute":return o.s("graphing-calculator-narration-unmute");default:return e}}function Vo(r,e,t={includeDetails:!0}){var c,d,p;if(!r)return e.s("graphing-calculator-narration-geometry-nothing-selected");let o=t.listIndex||0,i=t.description||"";if(r.type!=="expression"){if(r.type==="image"){let u=i!==""?i:Wr(r,"describe",o),{x:g,y:h}=r.formula.dimensions;g&&h&&typeof g[o]=="number"&&typeof h[o]=="number"?i=e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:u,coordinates:Gl(e,g[o],h[o])}):i=u}}else(!r.latex||!((c=r.formula)!=null&&c.typed_constant_value))&&(i=i!==""?i:Wr(r,"describe"));let n=t.poi&&t.poi.sketch.showPOI&&t.poi.type==="static-labeled-point",a=r.type==="expression"&&((d=r.formula.typed_constant_value)==null?void 0:d.valueType)===__dcg_shared_module_exports__['_']?(p=r.formula.typed_constant_value)==null?void 0:p.value:void 0;!i&&xs(r)?(i=Xfe(r,e,t),i=Jfe(i,r,e,t)):t.includeDetails&&t.poi&&!n&&(i=a?i:e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:i,coordinates:Gl(e,t.poi.x,t.poi.y)}));let s=i;return t.includeSelectionState&&!Tv(r)&&!n&&(s=WN(s,r,e)),Tv(r)&&(s=e.s("shared-calculator-narration-item-clickable",{item:s})),s}function Xfe(r,e,t={includeDetails:!0}){var c;let{value:o,valueType:i}=ch(r,t);if(!o)return e.s("shared-calculator-narration-item-unknown");let n=[];if(__dcg_shared_module_exports__['qa'](i))n=S$(r,e,t);else switch(i){case __dcg_shared_module_exports__['C']:n=AD(r,e,t);break;case __dcg_shared_module_exports__['M']:n=b$(r,e,t);break;case __dcg_shared_module_exports__['N']:n=y$(r,e,t);break;case __dcg_shared_module_exports__['J']:n=x$(r,e,t);break;case __dcg_shared_module_exports__['O']:case __dcg_shared_module_exports__['Q']:case __dcg_shared_module_exports__['K']:case __dcg_shared_module_exports__['Y']:n=v$(r,e,t);break;case __dcg_shared_module_exports__['S']:case __dcg_shared_module_exports__['U']:n=w$(r,e,t);break;default:n.push(e.s("shared-calculator-narration-item-unknown"))}let a=n.join(" "),s=(c=r.formula.geometry)==null?void 0:c.call;return s&&(a=$fe(a,s,e)),a}function $fe(r,e,t){let o,i=e.parents;if(e.symbol==="apply"){let n=i[0].type!=="arbitrary-expression"?__dcg_shared_module_exports__['Oc'](i[0]):void 0,a=n?t.getItemsByIdentifier(n):[];if(n&&a.length===0)o=n;else for(let s of a){if(s.type!=="expression")continue;let c=s.formula.geometry;if(!(!c||!c.call)){o=c.call.symbol;break}}}else if(__dcg_shared_module_exports__['Pc'](e.symbol))o=e.symbol;else return r;switch(o){case"coterminal":case"supplement":return r;case"dilate":return t.s("graphing-calculator-narration-geometry-dilated-item",{item:r});case"rotate":return t.s("graphing-calculator-narration-geometry-rotated-item",{item:r});case"translate":return t.s("graphing-calculator-narration-geometry-translated-item",{item:r});case"reflect":return t.s("graphing-calculator-narration-geometry-reflected-item",{item:r});default:return t.s("graphing-calculator-narration-geometry-transformed-item",{item:r})}}function Jfe(r,e,t,o){var i,n;return o.listIndex!==void 0&&((n=(i=e.formula)==null?void 0:i.geometry)!=null&&n.valueType)&&__dcg_shared_module_exports__['qa'](e.formula.geometry.valueType)?t.s("graphing-calculator-narration-item-with-list-index",{listIndex:o.listIndex+1,item:r}):o.polygonEdge!==void 0?t.s("graphing-calculator-narration-geometry-edge-of-polygon",{polygonEdge:o.polygonEdge+1,item:r}):r}function WN(r,e,t){return(e&&Mn(e)?t.s("shared-calculator-narration-item-selected",{item:r}):t.s("shared-calculator-narration-item-unselected",{item:r})).trim()}function ze(r){return{shouldBeFocused:()=>!!_1(r),onFocusedChanged:e=>{_k(r,e)}}}function gh(r){return{isFocused:()=>!!_1(r),onFocusedChanged:e=>{_k(r,e)},handleFocusChanged:e=>{_k(r,e)}}}function _1(r){let e=r.predicate;if(e&&!e())return!1;let t=r.controller.getFocusLocation();return t&&__dcg_shared_module_exports__['db'](t,r.location)}function _k(r,e){let t=r.predicate;t&&!t()||(e?r.controller.dispatch({type:"set-focus-location",location:r.location}):r.controller.dispatch({type:"blur-focus-location",location:r.location}))}var jN=Symbol("HANDLE_EVENT_GLOBAL_NAMESPACE"),Ab=class Ab{constructor(){this.handledBy=new Set}static getOrCreate(e){let t=Ab.metadataMap.get(e);return t||(t=new Ab,Ab.metadataMap.set(e,t)),t}static get(e){return Ab.metadataMap.get(e)}};Ab.metadataMap=new WeakMap;var eA=Ab;function xJ(r){return"originalEvent"in r?r.originalEvent:r instanceof Event?r:void 0}function Xt(r,e=jN){let t=r&&xJ(r);if(!t)return;let o=eA.getOrCreate(t);o==null||o.handledBy.add(e)}function jr(r,e=jN){let t=r&&xJ(r),o=t&&eA.get(t);if(o!=null&&o.handledBy.has(e))return!0;if(e!==jN)return!1;let i=(r==null?void 0:r.target)instanceof Element&&r.target.closest("[handleEvent]");return i&&i!==r.currentTarget?i.getAttribute("handleEvent")!=="false":!1}var{cos:Pn,sin:ta,max:nm,min:C1,abs:kc,sign:vJ,hypot:wJ,PI:va}=Math,Ck=22,$i=Ck/2,Ji=Ck/2,st=r=>r.toFixed(1),$N={type:"arc",center:[0,0],radius:1,startAngle:va/4,endAngle:va/4+va},SJ=[[-1,0],[0,1],[1,-1]],JN={start:0,delta:va/4},XN=va/4,ZN={angle:va/8,side:1},Zfe=["dcg-token-perpendicular","dcg-token-parallel","dcg-token-translate","dcg-token-vector","dcg-token-segment","dcg-token-line","dcg-token-ray","dcg-token-angle","dcg-token-angles","dcg-token-directedangle","dcg-token-directedangles","dcg-token-arc","dcg-token-polygon"];function kJ(r){return Zfe.includes(r)}function _J(r){switch(r.type){case"angle":case"angles":return nbe(r.start,r.delta);case"directedangle":case"directedangles":return abe(r.start,r.delta);case"arc":return sbe(r.arcDetails);case"polygon":return lbe(r.points);case"segment":return cbe(r.angle);case"line":return dbe(r.angle);case"anglebisector":case"ray":return pbe(r.angle);case"vector":case"translate":return ube(r.angle);case"parallel":return hbe(r.angle,r.side);case"perpendicular":return gbe(r.angle)}}function CJ(r,e,t){var o,i,n,a,s,c,d;switch(r){case"angle":case"angles":case"directedangle":case"directedangles":{let p=(o=Qfe(r,e))!=null?o:JN,{start:u,delta:g}=p;return{type:r,start:u,delta:g}}case"arc":{let p=(i=ebe(e))!=null?i:$N;return{type:r,arcDetails:p}}case"polygon":{let p=(n=tbe(e))!=null?n:SJ;return{type:r,points:p}}case"perpendicular":case"anglebisector":case"ray":case"line":case"segment":{let p=(a=TJ(e))!=null?a:XN;return{type:r,angle:p}}case"translate":{let p=(s=obe(e))!=null?s:XN;return{type:r,angle:p}}case"vector":{let p=(c=rbe(e))!=null?c:XN;return{type:r,angle:p}}case"parallel":{let{angle:p,side:u}=(d=ibe(e,t))!=null?d:ZN;return{type:r,angle:p,side:u}}}}function Qfe(r,e){if((e==null?void 0:e.valueType)!==__dcg_shared_module_exports__['S']&&(e==null?void 0:e.valueType)!==__dcg_shared_module_exports__['U'])return;let[t,o,i]=e.value;return{type:r,start:o,delta:i}}function ebe(r){return(r==null?void 0:r.valueType)===__dcg_shared_module_exports__['N']?__dcg_shared_module_exports__['cc'](r.value):void 0}function tbe(r){return(r==null?void 0:r.valueType)===__dcg_shared_module_exports__['J']?r.value:void 0}function TJ(r){let e=r==null?void 0:r.valueType;if(e!==__dcg_shared_module_exports__['K']&&e!==__dcg_shared_module_exports__['O']&&e!==__dcg_shared_module_exports__['Q'])return;let[[t,o],[i,n]]=r.value;return __dcg_shared_module_exports__['j'](i-t,n-o)}function rbe(r){if((r==null?void 0:r.valueType)!==__dcg_shared_module_exports__['Y'])return;let[e,t]=r.value[0];return __dcg_shared_module_exports__['j'](e,t)}function obe(r){if((r==null?void 0:r.valueType)!==__dcg_shared_module_exports__['W'])return;let[e,t]=r.value[1];return __dcg_shared_module_exports__['j'](e,t)}function ibe(r,e){var i;if((r==null?void 0:r.valueType)!==__dcg_shared_module_exports__['O'])return ZN;let t=(i=TJ(r))!=null?i:ZN.angle,o=1;if(e.length===2){let n=e[0],a=e[1],s=n==null?void 0:n.valueType;if((s===__dcg_shared_module_exports__['K']||s===__dcg_shared_module_exports__['O']||s===__dcg_shared_module_exports__['Q'])&&(a==null?void 0:a.valueType)===__dcg_shared_module_exports__['C']){let[c,d]=n.value[0],[p,u]=n.value[1],[g,h]=a.value,b=p-c,T=-(u-d),E=b,I=p-g,_=u-h;o=T*I+E*_>0?1:-1}}return{angle:t,side:o}}function EJ(r,e){(!isFinite(r)||!isFinite(e))&&(r=JN.start,e=JN.delta);let t=Pn(r),o=-ta(r),i=Pn(r+e),n=-ta(r+e),a=nm(0,t,i)-C1(0,t,i),s=nm(0,o,n)-C1(0,o,n),c=kc(e)>va,d=c?2:nm(a,s),p=.73*Ck/d,u=p*t,g=p*o,h=p*i,b=p*n,v=c?0:(C1(0,u,h)+nm(0,u,h))/2,T=c?0:(C1(0,g,b)+nm(0,g,b))/2,E=$i-v,I=Ji-T;return{x1:u,y1:g,x2:h,y2:b,tx:E,ty:I,r:p}}function nbe(r,e){let{x1:t,y1:o,x2:i,y2:n,tx:a,ty:s,r:c}=EJ(r,e),d=.6,p=d*t,u=d*o,g=d*i,h=d*n,b=kc(e)>va?1:0,v=e>0?0:1,T=`M ${st(p)} ${st(u)} A ${st(d*c)} ${st(d*c)} 0 ${b} ${v} ${st(g)} ${st(h)}`;return`<g transform="translate(${a} ${s})"><polyline points="${st(t)},${st(o)},0,0,${st(i)},${st(n)}" /><path d = "${T}" class="dcg-token-angle-arc"/><path d = "${T} L 0 0" class="dcg-token-angle-fill"/></g>`}function abe(r,e){let{x1:t,y1:o,x2:i,y2:n,tx:a,ty:s,r:c}=EJ(r,e),d=.8,p=d*t,u=d*o,g=__dcg_shared_module_exports__['Rb'](1/(d*c),0,2),h=(kc(e)-g)*vJ(e),b=(e+h)/2,v=d*c*Pn(r+h),T=-d*c*ta(r+h),E=vJ(e),I=E*3.5,_=E*(60*va)/180,C=.7,D=r+b,P=v+I*ta(D+_*(1-C)),F=T+I*Pn(D+_*(1-C)),N=v+I*ta(D-_*C),Y=T+I*Pn(D-_*C),z=kc(e)>va?1:0,X=e>0?0:1,q=`M ${st(p)} ${st(u)} A ${st(d*c)} ${st(d*c)} 0 ${z} ${X} ${st(v)} ${st(T)}`,S=`M ${st(P)} ${st(F)} L ${st(v)} ${st(T)} L ${st(N)} ${st(Y)}`;return`<g transform="translate(${a} ${s})"><polyline points="${st(t)},${st(o)},0,0,${st(i)},${st(n)}" />`+(kc(e)<.05?"":`<path d = "${q}" class="dcg-token-directedangle-arc"/>`)+(kc(e)<.29?"":`<path d = "${S}" class="dcg-token-directedangle-arrowhead"/>`)+"</g>"}function sbe(r){if(r===void 0)return"";switch(r.type){case"arc":{let{startAngle:e,endAngle:t}=r;(!isFinite(e)||!isFinite(t))&&(e=$N.startAngle,t=$N.endAngle);let o=t-e,i=.386*Ck;if(kc(o)>6.16)return`<circle cx="${st($i)}" cy="${st(Ji)}" r="${st(i)}">`;if(kc(o)<va/6){let I=(e+t)/2,_=i*ta(I),C=i*Pn(I);return`<path d = "M ${st($i-_)} ${st(Ji-C)} l ${st(2*_)} ${st(2*C)}" />`}let n=.66*va;kc(o)<n&&(i/=kc(o)/2);let a=i*Pn(e),s=-i*ta(e),c=i*Pn(t),d=-i*ta(t),p=i*Pn((e+t)/2),u=-i*ta((e+t)/2),g=__dcg_shared_module_exports__['Rb'](2*(va-kc(o)),0,1),h=g*(C1(a,c,p)+nm(a,c,p))/2,b=g*(C1(s,d,u)+nm(s,d,u))/2,v=$i-h,T=Ji-b;return`<path d = "${`M ${st(a+v)} ${st(s+T)} A ${st(i)} ${st(i)} 0 ${kc(o)>va?1:0} ${o>0?0:1} ${st(c+v)} ${st(d+T)}`}" />`}case"rays":{let{start1:e,end1:t}=r,o=t[0]-e[0],i=t[1]-e[1];(!isFinite(o)||!isFinite(o))&&(o=1,i=1);let n=wJ(o,i),a=3,s=a*o/n,c=-a*i/n;return`<path d = "M ${st($i-s)} ${st(Ji-c)} l ${st(-5*s)} ${st(-5*c)}" /><path d = "M ${st($i+s)} ${st(Ji+c)} l ${st(5*s)} ${st(5*c)}" />`}case"segment":{let{start:e,end:t}=r,o=t[0]-e[0],i=t[1]-e[1];(!isFinite(o)||!isFinite(o))&&(o=1,i=1);let n=wJ(o,i),a=7,s=a*o/n,c=a*i/n;return`<path d = "M ${st($i-s)} ${st(Ji-c)} l ${st(2*s)} ${st(2*c)}" />`}}}function lbe(r){if(r.length<2)return"";r.some(E=>!isFinite(E[0])||!isFinite(E[1]))&&(r=SJ);let e=r[0];r=r.slice(1);let t=e[0],o=t,i=e[1],n=i;for(let E=0;E<r.length;E++){let I=r[E][0],_=r[E][1];I<t&&(t=I),I>o&&(o=I),_<i&&(i=_),_>n&&(n=_)}let a=(t+o)/2,s=(i+n)/2,c=nm(o-t,n-i),d=.8*Ck,p=E=>$i+d*(E-a)/c,u=E=>Ji-d*(E-s)/c,g=E=>`${E[0].toFixed(1)} ${E[1].toFixed(1)}`,h=p(e[0]),b=u(e[1]);if(!isFinite(h)||!isFinite(b))return"";let v=[];for(let E of r){let I=p(E[0]),_=u(E[1]);if(!isFinite(I)||!isFinite(_))return"";v.push(g([I,_]))}return`<path d = ${`"M ${g([h,b])} ${v.map(E=>`L ${E} `).join(" ")} Z"`} />`}function QN(r,e,t){let i=7*Pn(r),n=7*ta(-r);return`<path d = "M ${st($i-e*i)} ${st(Ji-e*n)} L ${st($i+t*i)} ${st(Ji+t*n)}" />`}function cbe(r){return QN(r,1,1)}function dbe(r){return QN(r,2,2)}function pbe(r){return QN(r,1,2)}function ube(r){let o=48*(va/180),i=8.5-1,n=8.5-7*Pn(o),a=$i-i*Pn(r),s=Ji+i*ta(r),c=$i+n*Pn(r),d=Ji-n*ta(r),p=`M ${st(a)} ${st(s)} L ${st(c)} ${st(d)}`,u=$i+8.5*Pn(r),g=Ji+8.5*ta(-r),h=u-7*Pn(r+o/2),b=g+7*ta(r+o/2),v=u-7*Pn(r-o/2),T=g+7*ta(r-o/2),E=`M ${st(h)} ${st(b)} L ${st(u)} ${st(g)} L ${st(v)} ${st(T)}`;return`<path d = "${p}"/><path d = "${E}" class="dcg-token-vector-arrowhead"/>`}function hbe(r,e){let o=14*Pn(r),i=14*-ta(r),n=4*Pn(r+e*va/2),a=4*-ta(r+e*va/2);return`<path d = "M ${st($i-o)} ${st(Ji-i)} L ${st($i+o)} ${st(Ji+i)}" /><path d = "M ${st($i+n-o)} ${st(Ji+a-i)} L ${st($i+n+o)} ${st(Ji+a+i)}" class="dcg-token-parallel-parent"/>`}function gbe(r){let t=14*Pn(r),o=14*-ta(r);return`<path d = "M ${st($i-t)} ${st(Ji-o)} L ${st($i+t)} ${st(Ji+o)}" /><path d = "M ${st($i+o)} ${st(Ji-t)} L ${st($i-o)} ${st(Ji+t)}" class="dcg-token-parallel-parent"/>`}var{If:Tk}=Lb.Components,mbe=.8,Gp=class extends Lb.View{init(){this.controller=this.props.controller()}template(){return x("span",{class:()=>{var t,o;let e=this.parentOrChildHovered();return{"dcg-geo-token-view":!0,"dcg-static-token":(o=(t=this.props).isStatic)==null?void 0:o.call(t),"dcg-selected-token":this.isTokenSelected(),"dcg-hidden-token":this.isHidden(),"dcg-token-has-label":this.showLabel(),"dcg-child-of-hovered-token":e==="child","dcg-parent-of-hovered-token":e==="parent","dcg-assignment-token":!!this.getAssignment(),"dcg-graph-interactions-disabled":this.isGraphInteractionDisabled(),"dcg-light-color":this.isLightColor()}},style:()=>({color:this.getColor()}),role:this.bindFn(this.getAriaRole),"dcg-token-type":()=>this.getTokenInfo().iconType,"aria-roledescription":()=>this.props.insideGroup()?void 0:this.controller.s("graphing-calculator-narration-geometry-construction-role-description"),"aria-label":this.bindFn(this.getAriaLabel),"aria-selected":this.bindFn(this.isTokenSelected),tabIndex:()=>this.props.putInTabOrder()?0:-1,manageFocus:()=>this.props.focusLocation?ze({controller:this.controller,location:this.props.focusLocation()}):void 0,onTapStart:this.bindFn(this.onTapStart),onTap:this.bindFn(this.onTap),onPointerOver:this.bindFn(this.onPointerOver),onPointerOut:this.bindFn(this.onPointerOut),children:[l("span",{class:Lb.const("dcg-token-background")}),x("span",{class:()=>({"dcg-token-icon":!0,[this.getAdditionalTokenClass()]:!!this.getAdditionalTokenClass(),"dcg-token-is-list":this.getIsList()&&!this.getAssignment()}),children:[l(Tk,{predicate:()=>!!this.getIcon(),children:()=>l("i",{class:this.bindFn(this.getIcon)})}),l(Tk,{predicate:()=>kJ(this.getAdditionalTokenClass()),children:()=>l("div",{willUnmount:()=>this.willUnmountSVG(),didMount:e=>this.didMountSVG(e)})})]}),l(Tk,{predicate:()=>!!this.getAssignment(),children:()=>l(dt,{latex:this.bindFn(this.getAssignment),config:this.const({})})}),l(Tk,{predicate:()=>this.showLabel(),children:()=>l("span",{class:()=>({"dcg-token-label":!0}),children:()=>this.getLabel()})}),l(Tk,{predicate:this.bindFn(this.isGraphInteractionDisabled),children:()=>l("i",{class:Lb.const("dcg-icon-lock")})})]})}isLightColor(){let e=this.getColor();return!e||this.isTransformation()||this.isHidden()?!1:iv({type:"single-color",value:e},this.controller.invertSwatches(),mbe)}didMountSVG(e){this.svgElement=e,this.renderSVGElement()}willUnmountSVG(){this.svgElement=void 0,this.lastSVGInputs=void 0}getTypedValue(e){var i;if(e===void 0)return;let t=this.controller.getItemsByIdentifier(e);if(!t||t.length!==1)return;let o=t[0];return(i=o==null?void 0:o.formula)==null?void 0:i.typed_constant_value}getParentValues(e){var n,a,s;let t=this.controller.getItemsByIdentifier(e);if(!t||t.length!==1)return[];let o=t[0],i=(s=(a=(n=o==null?void 0:o.formula)==null?void 0:n.geometry)==null?void 0:a.call)==null?void 0:s.parents;return i===void 0?[]:i.map(c=>{if(c.type==="arbitrary-expression")return;let d=__dcg_shared_module_exports__['Oc'](c);return this.getTypedValue(d)})}renderSVGElement(){if(!this.svgElement)return;let e=this.props.identifier(),t=this.getIconType(),o=this.getTypedValue(e),i=this.getParentValues(e),n=CJ(t,o,i);n!==void 0&&(__dcg_shared_module_exports__['db'](n,this.lastSVGInputs)||(this.lastSVGInputs=n,this.svgElement.innerHTML=`<svg>${_J(n)}</svg>`))}getAdditionalTokenClass(){if(this.getAssignment()||this.hasError())return"";switch(this.getIconType()){case"glider":return"dcg-token-glider";case"line":return"dcg-token-line";case"segment":return"dcg-token-segment";case"ray":return"dcg-token-ray";case"intersection":return"dcg-token-intersection";case"midpoint":return"dcg-token-midpoint";case"parallel":return"dcg-token-parallel";case"perpendicular":return"dcg-token-perpendicular";case"anglebisector":return"dcg-token-ray";case"rotate":return"dcg-token-rotate";case"circle":return"dcg-token-circle";case"arc":return"dcg-token-arc";case"vector":return"dcg-token-vector";case"dilate":return"dcg-token-dilate";case"reflect":return"dcg-token-reflect";case"translate":return"dcg-token-translate";case"transformation":return"dcg-token-transformation";case"point":case"start":case"end":return"dcg-token-point";case"polygon":return"dcg-token-polygon";case"angle":return"dcg-token-angle";case"angles":return"dcg-token-angles";case"directedangle":case"directedangles":return"dcg-token-directedangle"}return""}getIdFromParentRef(e){if(e.type==="arbitrary-expression")return;let t=__dcg_shared_module_exports__['Oc'](e);return this.controller.getExpressionIdForIdentifier(t)}isGraphInteractionDisabled(){let e=this.props.controller().getExpressionIdForIdentifier(this.props.identifier())||"",t=this.controller.getItemModel(e);return!!t&&(t.type==="expression"||t.type==="image")&&!!t.disableGraphInteractions}parentOrChildHovered(){var d,p,u,g,h,b;if(!this.props.showParentChildrenHover||!this.props.showParentChildrenHover())return!1;let e=this.controller.getHoveredOrFocusedTokenIdentifier(),t=this.controller.getExpressionIdForIdentifier(e),o=this.props.identifier(),i=this.props.controller().getExpressionIdForIdentifier(o)||"";if(!t)return!1;let n=this.controller.getItemModel(t),a=this.controller.getItemModel(i);if(!n||n.type!=="expression"||!a||a.type!=="expression")return!1;let s=((u=(p=(d=n.formula)==null?void 0:d.geometry)==null?void 0:p.call)==null?void 0:u.parents)||[],c=((b=(h=(g=a.formula)==null?void 0:g.geometry)==null?void 0:h.call)==null?void 0:b.parents)||[];for(let v=0;v<s.length;v++)if(this.getIdFromParentRef(s[v])===i)return"parent";for(let v=0;v<c.length;v++)if(this.getIdFromParentRef(c[v])===t)return"child";return!1}willUnmount(){this.implicitMouseOut()}didUpdate(){this.renderSVGElement();let e=this.props.identifier();this.currentlyActiveIdentifier&&e!==this.currentlyActiveIdentifier&&this.implicitMouseOut()}implicitMouseOut(){this.currentlyActiveIdentifier&&this.controller.runAfterDispatch(()=>{let e=this.currentlyActiveIdentifier;e&&(this.currentlyActiveIdentifier=void 0,this.controller.dispatch({type:"unset-active-token",identifier:e,style:"hovered"}))})}isHidden(){return this.getTokenInfo().isHidden}hasError(){let e=this.getTokenInfo();return!e||e.hasError}getIcon(){if(this.getAssignment())return;let e=this.getTokenInfo();if(this.hasError())return"dcg-icon-error";switch(e.iconType){case"point":case"glider":case"intersection":case"strictintersection":case"midpoint":case"start":case"end":return"dcg-icon-point";case"dilate":return"dcg-icon-dilation";case"rotate":return"dcg-icon-rotation";case"reflect":return"dcg-icon-reflection";case"transformation":return"dcg-icon-title";case"angle":case"angles":case"directedangle":case"directedangles":case"polygon":case"vector":case"translate":case"apply":case"arc":case"circle":case"clockwise":case"counterclockwise":case"error":case"line":case"parallel":case"perpendicular":case"anglebisector":case"ray":case"reflex":case"segment":case"segments":case"unknown":case"vertices":return;default:return e.iconType}}showLabel(){return!!this.getLabel()}getLabel(){if(this.getAssignment())return"";if(this.getIconType()!=="point"&&this.getIconType()!=="midpoint")return!1;let e=this.getTokenInfo().label.trim();return e.length<=2?e:""}getAssignment(){let e=this.props.identifier();return e[0]!=="$"?__dcg_shared_module_exports__['vb'](e):""}getAriaLabel(){let e=this.getTokenInfo(),t=Vo(this.controller.getItemModel(e==null?void 0:e.calcId),this.controller,{includeDetails:!1,depth:1});return this.isHidden()?this.controller.s("graphing-calculator-narration-geometry-hidden-construction-description",{description:t}):t}isTransformation(){var e;return((e=this.getTokenInfo())==null?void 0:e.groupType)==="transformation"}getColor(){if(this.getAssignment())return;let e=this.getTokenInfo();if(this.hasError())return"#fa824c";if(!(this.getIconType()==="translate"&&!this.isHidden()))return this.isTransformation()||this.isHidden()?"#aaa":e.color}getIconType(){return this.getTokenInfo().iconType}getIsList(){return this.getTokenInfo().isList}getTokenInfo(){let e=this.props.identifier();return this.controller.getTokenRenderInfoByIdentifier(e)}onPointerOver(e){var t,o;(o=(t=this.props).isStatic)!=null&&o.call(t)||e.pointerType==="mouse"&&(this.currentlyActiveIdentifier=this.props.identifier(),this.controller.dispatch({type:"set-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}))}onPointerOut(e){var t,o;(o=(t=this.props).isStatic)!=null&&o.call(t)||e.pointerType==="mouse"&&this.currentlyActiveIdentifier&&(this.controller.dispatch({type:"unset-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}),this.currentlyActiveIdentifier=void 0)}onTapStart(e){var t,o;(o=(t=this.props).isStatic)!=null&&o.call(t)||Xt(e)}onTap(e){var t,o;(o=(t=this.props).isStatic)!=null&&o.call(t)||(Xt(e),this.props.focusLocation&&this.controller.dispatch({type:"set-focus-location",location:this.props.focusLocation()}),this.controller.dispatch({type:"select-expression-that-defines-token",identifier:this.props.identifier(),toggle:this.isTokenSelected(),multiSelectMode:this.controller.isMultiSelectEnabled()&&!!e.shiftKey}))}isTokenSelected(){let e=this.getTokenInfo();return!!(e&&e.isSelected)}getAriaRole(){var e,t;if(!((t=(e=this.props).isStatic)!=null&&t.call(e)))return this.props.insideGroup()?"option":"button"}};var T1=r=>{let e=function(){return r};return e.isDcgViewConst=!0,e},b1=class{constructor(e,t,o){this.tokenController=e,this.mathNode=t,this.isStatic=o}updateTokens(e){if(!this.mathNode)return;if(!this.lastTokenInfo||this.lastTokenInfo.latex!==e)if(!this.tokenController.doesLatexContainToken(e))this.lastTokenInfo={latex:e,tokens:[]};else{let o=[];this.mathNode.querySelectorAll(".dcg-mq-token").forEach(i=>{o.push(i)}),this.lastTokenInfo={latex:e,tokens:o}}let t=this.lastTokenInfo.tokens;for(let o of t){let i=o.dcgTokenView;if(i)i.update();else{let n=o.getAttribute("data-dcg-mq-token")||"",a=IJ.mountToNode(Gp,o,{controller:T1(this.tokenController),identifier:T1("$"+n),insideMQ:T1(!0),insideGroup:T1(!1),putInTabOrder:T1(!1),isStatic:T1(this.isStatic)});o.dcgTokenView=a}}}};var{If:fbe}=Pb.Components,E1=500,bbe=30,ybe=100,Qe=class r extends Pb.View{constructor(){super(...arguments),this.lastLatexProp=""}template(){return x("div",{class:Pb.const("dcg-mq-container"),children:[l(fbe,{predicate:()=>this.getPlaceholder().trim().length>0,children:()=>l("span",{class:Pb.const("dcg-mq-placeholder"),children:l(dt,{config:()=>this.props.config(),latex:()=>this.getPlaceholder()})})}),l("div",{class:()=>({"dcg-math-field":!0,"dcg-no-fadeout":this.props.noFadeout&&this.props.noFadeout(),"dcg-invalid":this.props.hasError(),"dcg-focus":this.props.isFocused()}),didMount:e=>this.didMountMathquill(e),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0})]})}willUnmount(){var e;(e=this.mathquillFocus)==null||e.willUnmount(),this.mathField=void 0}getPlaceholder(){return!this.props.placeholder||this.props.isFocused()||this.props.latex()?"":this.props.placeholder()}didMountMathquill(e){var n,a;this.cachedConfig=this.getCacheableMQConfig();let t={...this.cachedConfig,restrictMismatchedBrackets:"none",handlers:{reflow:s=>{this.props.onReflow&&this.mathField&&this.props.onReflow(s)}},onCut:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},onPaste:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},overrideTypedText:s=>{this.mathField&&this.viewCanAcceptText(s)&&(this.mathField.typedText(s),this.props.onUserChangedLatex(this.mathField.latex()))},overrideKeystroke:(s,c)=>{if(s==="Backspace"&&c.preventDefault(),!this.mathField)return;if(s==="Spacebar"&&this.props.disableSpace&&this.props.disableSpace())return c.preventDefault();let d=Pe(c);if(d==="Up"||d==="Down"||d==="Left"||d==="Right"||d==="Esc"){let p=[];c.ctrlKey&&p.push("Ctrl"),c.metaKey&&p.push("Meta"),c.altKey&&p.push("Alt"),c.shiftKey&&p.push("Shift"),p.length?(p.push(d),s=p.join("-")):s=d}this.props.onUserPressedKey?this.props.onUserPressedKey(s,c):(this.mathField.keystroke(s,c),this.props.onUserChangedLatex(this.mathField.latex())),this.maybeTriggerOnSelectionChange()}};this.props.needsSystemKeypad&&this.props.needsSystemKeypad()&&(t.substituteTextarea=()=>{let s=document.createElement("textarea");return s.setAttribute("autocorrect","off"),s.setAttribute("autocapitalize","none"),s.setAttribute("spellcheck","false"),s.setAttribute("autocomplete","off"),s});let o=(a=(n=this.props).tokenController)==null?void 0:a.call(n);o&&(this.mathquillTokenHelper=new b1(o,e,!1)),this.$mathField=re(e);let i=Pl.MathField(e,t);this.mathField=i,e._mqMathFieldInstance=this.mathField,e._mqViewInstance=this,this.mathquillFocus=new p1(i,this.$mathField,this.props),this.$mathField.on("paste.view",s=>this.onPasteEvent(s)),!YE&&(Ws||Nu)&&this.$mathField.on("keypress.view",s=>this.onKeypressEvent(s)),this.hookupMQTapTouch(i),this.updateMathquill()}getCacheableMQConfig(){let e={...this.props.config()};return e.maxDepth=this.props.capExpressionSize()?bbe:ybe,e}didUpdate(){this.updateMathquill()}updateMathquill(){var e,t;this.updateMathquillConfig(),this.updateMathquillAria(),this.updateMathquillLatex(),(e=this.mathquillFocus)==null||e.updateMathquillFocused(),this.updateMathquillPostLabel(),(t=this.mathquillTokenHelper)==null||t.updateTokens(this.props.latex())}onPasteEvent(e){let t="",o=window.clipboardData,i=e.originalEvent;o&&o.getData?t=o.getData("Text"):i&&i.clipboardData&&i.clipboardData.getData&&(t=i.clipboardData.getData("text/plain"));let n=this.viewCanAcceptText(t);return!n&&this.props.onExpressionSizeExceeded&&this.props.onExpressionSizeExceeded(),n}viewCanAcceptText(e){return r.canAcceptText(this.mathField,this.props.capExpressionSize(),e)}static canAcceptText(e,t,o){if(!e)return!1;if(!t)return!0;let i=e.latex();return d1(i)+d1(o)<=E1}onKeypressEvent(e){if(e.stopPropagation(),e.preventDefault(),!this.mathField)return;let t=e.key&&e.key.length===1?e.key:void 0;t&&this.viewCanAcceptText(t)&&(this.mathField.typedText(t),this.props.onUserChangedLatex(this.mathField.latex()))}hookupMQTapTouch(e){this.$mathField.on("dcg-tapstart.view",()=>{let t="dcg-tapend.mathquill-selection-change";this.maybeTriggerOnSelectionChange(),re(document).on(t,()=>{this.maybeTriggerOnSelectionChange(),re(document).off(t)})}),e.ignoreNextMousedown(()=>Rz.shouldIgnoreMouseDown()),this.$mathField.on("dcg-tap.view",t=>{var n;let o=t;if(o.device!=="touch"||o.target.closest(".dcg-mq-ignore-mousedown"))return;let i=o.changedTouches[0];e.clickAt(i.clientX,i.clientY,i.target),(n=this.mathquillFocus)!=null&&n.isFocused()||e.focus()})}updateMathquillConfig(e={}){if(!this.mathField)return;let t={...this.getCacheableMQConfig(),...e};__dcg_shared_module_exports__['db'](t,this.cachedConfig)||(this.cachedConfig=t,this.mathField.config(t))}updateMathquillAria(){if(!this.mathField)return;let e=this.props.getAriaLabel();e!==this.mathField.getAriaLabel()&&this.mathField.setAriaLabel(e)}updateMathquillPostLabel(){this.mathField&&this.mathField.setAriaPostLabel(this.props.getAriaPostLabel(),this.props.hasError()?5e3:1e3)}updateMathquillLatex(){let e=this.props.latex();this.mathField&&this.lastLatexProp!==e&&(this.props.capExpressionSize()&&d1(e)>E1||(this.lastLatexProp=e,this.mathField.latex()!==e&&this.mathField.latex(e)))}maybeTriggerOnSelectionChange(){let e=this.props.onSelectionChanged;if(!e||!this.mathField)return;let t=this.mathField.selection();__dcg_shared_module_exports__['db'](t,this.lastSelection)||(this.lastSelection=t,e(t))}static getFocusedMathquill(){if(!document.activeElement)return;let e=document.activeElement.closest(".dcg-mq-editable-field");if(e)return e._mqMathFieldInstance}static getMQViewInstance(e){let t=e.el();if(t)return t._mqViewInstance}static applyArrowKeyAndReturnIfWasAtBounds(e,t,o){let i=e.selection(),n=i.startIndex===0&&i.endIndex===i.latex.length;if(/(Up|Down)$/.test(t)&&n)return e.keystroke(t,o),!0;e.keystroke(t,o);let a=e.selection();return!(a.latex!==i.latex||a.startIndex!==i.startIndex||a.endIndex!==i.endIndex)}static temporarilyOverrideLeftRightIntoCommandGoes(e,t){var n;let o=r.getMQViewInstance(e);if(!o)return()=>{};let i=(n=o.getCacheableMQConfig().leftRightIntoCmdGoes)!=null?n:"up";return o.updateMathquillConfig({leftRightIntoCmdGoes:t}),()=>o.updateMathquillConfig({leftRightIntoCmdGoes:i})}static simulateKeypressFromKeypad(e,t){var n;let o=r.getMQViewInstance(e);if(!o)return;let i=(n=o.getCacheableMQConfig().leftRightIntoCmdGoes)!=null?n:"up";if((t==="Left"||t==="Right")&&o.updateMathquillConfig({leftRightIntoCmdGoes:void 0}),o.props.onUserPressedKey)o.props.onUserPressedKey(t);else{e.keystroke(t);let a=e.latex();o.props.onUserChangedLatex(a)}o.maybeTriggerOnSelectionChange(),(t==="Left"||t==="Right")&&o.updateMathquillConfig({leftRightIntoCmdGoes:i})}static simulateUserChangedLatex(e){let t=r.getMQViewInstance(e);if(t&&t.mathField){let o=t.mathField.latex();t.props.onUserChangedLatex(o)}}static handleKeystrokeAndDecideIfSpecialEvent(e,t,o){return t==="Enter"||t==="Delete"&&e.latex()===""||t==="Backspace"&&e.latex()===""?!0:t==="Up"||t==="Down"||t==="Left"||t==="Right"?r.applyArrowKeyAndReturnIfWasAtBounds(e,t,o):(e.keystroke(t,o),!1)}static normalizeLatex(e,t){let o=document.createElement("div"),i=Pl.MathField(o,t);return i.latex(e),i.latex()}};var Gb=__dcg_shared_module_exports__['e'](j());var{For:xbe,If:vbe,IfElse:wbe}=Gb.Components,ar=class extends Gb.View{constructor(){super(...arguments),this.btnViews={}}init(){this.config=this.props.staticConfig()}template(){return l("div",{class:Gb.const("dcg-segmented-control-container"),role:()=>{var e,t;return(t=(e=this.props).treatAsMultiSelect)!=null&&t.call(e)?"listbox":"radiogroup"},"aria-multiselectable":()=>{var e,t;return(t=(e=this.props).treatAsMultiSelect)!=null&&t.call(e)?!0:void 0},onKeyDown:this.bindFn(this.handleRadioKeydown),"aria-label":this.props.ariaGroupLabel,children:l(xbe,{each:()=>this.config,children:(e,t)=>l("div",{class:()=>{var o;return{"dcg-segmented-control-btn":!0,"dcg-selected":e.selected(),"dcg-theme-mini":this.getTheme()==="mini","dcg-theme-full-width-mini":this.getTheme()==="full-width-mini","dcg-theme-default":this.getTheme()==="default","dcg-disabled":this.isDisabled()||((o=e.disabled)==null?void 0:o.call(e)),[e.class?e.class():""]:!!e.class}},role:()=>{var o,i;return(i=(o=this.props).treatAsMultiSelect)!=null&&i.call(o)?"option":"radio"},tabIndex:()=>this.getTabIndexForOption(e),"aria-label":()=>this.getAriaLabel(e),style:()=>({"min-width":this.props.minButtonWidth?this.props.minButtonWidth()+"px":void 0}),"aria-checked":()=>{var o,i;return(i=(o=this.props).treatAsMultiSelect)!=null&&i.call(o)?void 0:e.selected()},"aria-selected":()=>{var o,i;return(i=(o=this.props).treatAsMultiSelect)!=null&&i.call(o)?e.selected():void 0},onTap:o=>{var i,n,a,s;this.isDisabled()||(i=e.disabled)!=null&&i.call(e)||(e.onSelect(o.device),(a=(n=this.props).focusOnTap)!=null&&a.call(n)&&((s=this.btnViews[t])==null||s.focus()))},didMount:o=>this.btnViews[t]=o,manageFocus:()=>{if(e.focusHelperOptions)return ze(e.focusHelperOptions)},children:l(Oe,{tooltip:()=>{var o;return((o=e.tooltip)==null?void 0:o.call(e))||""},gravity:()=>{var o;return((o=e.tooltipGravity)==null?void 0:o.call(e))||"s"},disabled:()=>!(e.tooltip&&e.tooltip()),children:wbe(()=>!!e.template,{false:()=>x("div",{class:Gb.const("dcg-segmented-control-interior"),children:[()=>e.label?e.label():"",l(vbe,{predicate:()=>!!e.icon,children:()=>l("i",{class:()=>e.icon?e.icon():""})})]}),true:e.template})})})},e=>e.key)})}getAriaLabel(e){return e.ariaLabel?e.ariaLabel():e.label?e.label():e.tooltip?e.tooltip():""}isDisabled(){var e,t;return!!((t=(e=this.props).disabled)!=null&&t.call(e))}getTheme(){return this.props.theme?this.props.theme():"default"}handleRadioKeydown(e){var p,u,g;let t=Pe(e);if(t!=="Up"&&t!=="Down"&&t!=="Left"&&t!=="Right"&&t!=="Home"&&t!=="End"||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;e.preventDefault(),e.stopPropagation();let o=__dcg_shared_module_exports__['Wa'](this.config,h=>this.btnViews[h.key]===document.activeElement),i=this.config.length,n=o;t==="Home"&&(n=0),t==="End"&&(n=this.config.length-1),t==="Left"&&(n=(o-1+i)%i),t==="Right"&&(n=(o+1)%i);let a=this.props.numRows?this.props.numRows():1,s=Math.ceil(i/a),c=a===1?1:s;t==="Up"&&(n=(o-c+i)%i),t==="Down"&&(n=(o+c)%i);let d=this.config[n];d&&((p=this.btnViews[d.key])==null||p.focus(),!((g=(u=this.props).treatAsMultiSelect)!=null&&g.call(u))&&d.onSelect("keyboard"))}getTabIndexForOption(e){if(this.isDisabled())return-1;let t=e.key===this.config[0].key,o=this.config.find(i=>i.selected());return e.key===(o==null?void 0:o.key)||t&&!o?0:-1}};var bd=__dcg_shared_module_exports__['e'](j());Ut();function Dr(){document.activeElement&&Hu(document.activeElement)&&re(document.activeElement).trigger("blur")}var Ob=__dcg_shared_module_exports__['e'](j());function MJ(r){if(!r)return;let e=[];for(let t of r.split(" ")){let o=t.indexOf("|"),i=o!==-1?t.slice(0,o):t;e.push(i)}return e}function I1(r,e,t){let o=MJ(t);return e==="nemeth"?nh(r,{operatorNames:o}):e==="ueb"?ah(r,{operatorNames:o}):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}function tA(r,e,t){let o=MJ(t);return e==="nemeth"?K3(r,{operatorNames:o}):e==="ueb"?z3(r,{operatorNames:o}):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}var DJ=__dcg_shared_module_exports__['e'](j());Ut();var M1=class extends DJ.View{template(){return l(dt,{latex:this.props.latex,config:this.props.config,tabbable:()=>this.props.tabbable?this.props.tabbable():!0,getAriaLabel:this.props.getAriaLabel,tokenController:this.props.tokenController,onUserPressedKey:this.props.onUserPressedKey,didMountMathquill:e=>this.didMountMathquill(e)})}didMountMathquill(e){var t,o;this.mathquillFocus=new p1(e,re(e.el()),this.props),this.didUpdate(),(o=(t=this.props).didMountMathquill)==null||o.call(t,e),this.props.isFocused()&&e.select(),re(e.el()).on("dcg-tap",()=>{if(jn)return;let i=e.selection();i.startIndex===i.endIndex&&e.select()})}willUnmount(){var e;(e=this.mathquillFocus)==null||e.willUnmount()}didUpdate(){var e;(e=this.mathquillFocus)==null||e.updateMathquillFocused()}};var rA=__dcg_shared_module_exports__['e'](j());Ut();var{Input:Sbe}=rA.Components,Vb=class extends rA.View{init(){this.ASCIICharacters=` A1B'K2L@CIF/MSP"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=`,this.ASCIITable=[],this.HomeRowCharacters="FDSJKL",this.charCodes=[],this.sixKeyModel={keysDown:0,stickyKeysDown:0};let e;for(e=0;e<this.ASCIICharacters.length;e++)this.ASCIITable.push(this.ASCIICharacters.charCodeAt(e));for(e=0;e<this.HomeRowCharacters.length;e++)this.charCodes.push(this.HomeRowCharacters.charCodeAt(e))}template(){return l(Sbe,{class:this.const("dcg-braille-input dcg-do-blur"),tabIndex:()=>this.props.tabIndex?this.props.tabIndex():0,readOnly:()=>this.props.isStatic()?!0:void 0,autocomplete:this.const("off"),autocorrect:this.const("off"),autocapitalize:this.const("off"),spellcheck:this.const("false"),onKeyDown:this.bindFn(this.onKeydown),onKeyUp:this.bindFn(this.onKeyUp),onInput:this.bindFn(this.props.onInput),value:()=>this.props.value(),"aria-label":()=>this.props.ariaLabel()||$s(""),didMount:this.bindFn(this.didInputMount),didUnmount:this.bindFn(this.props.didUnmount),placeholder:()=>this.props.placeholder?this.props.placeholder():"",size:()=>this.props.size&&this.props.size()})}didInputMount(e){this.rootNode=e,re(this.rootNode).on("focus",t=>{this.props.isFocused()||this.props.onFocusedChanged(!0,t.originalEvent||t)}).on("blur",t=>{this.props.isFocused()&&this.props.onFocusedChanged(!1,t.originalEvent||t)}).on("dcg-tap",()=>{var t,o;zE()&&this.props.isStatic()&&((o=(t=this.props).selectOnFocus)==null?void 0:o.call(t))!==!1&&this.rootNode.select()}),this.props.didMount(e),this.updateFocus()}didUpdate(){this.updateFocus()}updateFocus(){var e,t;this.rootNode&&(this.props.isFocused()&&document.activeElement!==this.rootNode&&(this.rootNode.focus(),((t=(e=this.props).selectOnFocus)!=null&&t.call(e)||this.props.isStatic())&&this.rootNode.select()),!this.props.isFocused()&&document.activeElement===this.rootNode&&this.rootNode.blur())}onKeydown(e){let t=this.charCodes.indexOf(e.which);!this.props.isStatic()&&this.isSixKeyInput()&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&t!==-1?(this.sixKeyModel={...this.sixKeyModel,keysDown:this.addKey(this.sixKeyModel.keysDown,t),stickyKeysDown:this.addKey(this.sixKeyModel.stickyKeysDown,t)},e.preventDefault()):this.props.onKeyDown&&this.props.onKeyDown(e)}onKeyUp(e){let t=this.charCodes.indexOf(e.which),o=!1;return!this.props.isStatic()&&this.isSixKeyInput()&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&t!==-1?(this.sixKeyModel={...this.sixKeyModel,keysDown:this.removeKey(this.sixKeyModel.keysDown,t)},this.sixKeyModel.keysDown===0&&(this.addCharacter(this.bitsToASCII(this.sixKeyModel.stickyKeysDown)),this.sixKeyModel={...this.sixKeyModel,stickyKeysDown:0})):o=!0,o||e.preventDefault(),o}addKey(e,t){return e|1<<t}removeKey(e,t){return e&~(1<<t)}bitsToASCII(e){return String.fromCharCode(this.ASCIITable[e])}addCharacter(e){this.rootNode&&!this.props.isStatic()&&(this.rootNode.setRangeText(e,this.rootNode.selectionStart,this.rootNode.selectionEnd,"end"),this.props.onInput(this.rootNode.value))}isSixKeyInput(){return typeof this.props.sixKeyInput=="function"&&this.props.sixKeyInput()}};var AJ=__dcg_shared_module_exports__['e'](j());var D1=class extends AJ.View{template(){return l(Oe,{...this.props,customTooltipView:()=>l(dt,{latex:this.props.tooltip,config:this.const({})}),theme:this.const("light"),noWrap:this.const(!0),children:this.props.children})}};var{If:LJ,IfElse:kbe}=Ob.Components;function ra(r,e){return{sixKeyInput:()=>r.getSixKeyInput(),mode:()=>r.getBrailleMode(),capExpressionSize:()=>r.getCapExpressionSize()?{exceedsLimit:t=>t.length>E1,onExpressionSizeExceeded:()=>r.dispatchExpressionSizeExceeded()}:void 0,mqConfig:()=>r.getMathquillConfig({additionalOperators:(e==null?void 0:e.additionalOperators)||[]}),tokenController:r.getTokenController.bind(r),needsSystemKeypad:()=>!r.isKeypadEnabled()}}var un=class extends Ob.View{constructor(){super(...arguments),this.currentBrailleValue=this.getBrailleFromLatex(this.props.latex()),this.currentBrailleMode=this.props.mode(),this.hasTranslationError=!1,this.currentLatex=this.props.latex()}brailleInputHasFocus(){return this.brailleInput!==void 0&&document.activeElement==this.brailleInput}isStatic(){var e,t;return!!((t=(e=this.props).isStatic)!=null&&t.call(e))}hasError(){var e,t;return!!((t=(e=this.props).hasError)!=null&&t.call(e))}willUpdate(){let e=this.currentLatex!==this.props.latex(),t=this.props.mode(),o=t!==this.currentBrailleMode&&t!=="none";this.brailleInputHasFocus()&&!e&&!o||(this.currentLatex=this.props.latex(),(o||!this.hasTranslationError||e||this.isStatic())&&(this.currentBrailleValue=this.getBrailleFromLatex(this.props.latex()),this.hasTranslationError=!1),this.currentBrailleMode=t)}onBrailleInput(e){var i,n;if(!this.props.onUserChangedLatex)return;let t=this.getLatexFromBraille(e);this.hasTranslationError=t.isError;let o=(n=(i=this.props).capExpressionSize)==null?void 0:n.call(i);if(!t.isError&&o&&o.exceedsLimit(t.value)){o.onExpressionSizeExceeded();return}this.currentBrailleValue=e,t.isError||(this.currentLatex=t.value,this.props.onUserChangedLatex(t.value))}getBrailleFromLatex(e,t=!1){let o=I1(e,this.props.mode(),this.props.mqConfig().autoOperatorNames);return o.isError?"":t?o.value:ma.toExpandedBrailleAscii(o.value)}getLatexFromBraille(e){return tA(ma.coerceToSixDotCells(e),this.props.mode(),this.props.mqConfig().autoOperatorNames)}getBrailleLabel(e){return this.getBrailleFromLatex(e.replace(/\s/,"\\ "))}shouldShowBraille(){let e=this.props.mode();return e==="nemeth"||e==="ueb"}isOverflowingLeft(){return this.brailleInput?this.brailleInput.scrollLeft>0:!1}isOverflowingRight(){if(!this.brailleInput)return!1;let e=this.brailleInput.getBoundingClientRect().width,t=this.brailleInput.scrollWidth,o=this.brailleInput.scrollLeft;return t>e+o+2}didMountBrailleInput(e){this.brailleInput=e}didUnmountBrailleInput(){this.brailleInput=void 0}handleFocusChange(e,t){var o,i;(i=(o=this.props).onFocusedChanged)==null||i.call(o,e,t),this.brailleInput&&this.isStatic()&&this.props.mode()!=="none"&&this.brailleInput.scrollTo(0,0)}getTooltipText(){let e=this.props.placeholder&&!this.brailleInputHasFocus()?this.props.placeholder():"";return $s(this.props.latex()||e)}template(){return x("div",{class:Ob.const("dcg-mathquill-wrapper"),children:[l(LJ,{predicate:()=>this.shouldShowBraille(),children:()=>l("div",{class:()=>({"dcg-mathquill-braille":!0,"dcg-text-selectable":this.isStatic(),"dcg-focus":this.props.isFocused(),"dcg-invalid":this.hasError(),"dcg-mathquill-static-braille":this.isStatic(),"dcg-mathquill-braille-overflow-left":this.isOverflowingLeft(),"dcg-mathquill-braille-overflow-right":this.isOverflowingRight()}),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0,children:l(D1,{tooltip:()=>this.getTooltipText(),gravity:this.const("s"),delay:this.const(0),showOnTapstart:this.const(!0),children:l(Vb,{ariaLabel:()=>this.getBrailleLabel(this.props.brailleAriaLabel?this.props.brailleAriaLabel():this.props.ariaLabel()),didMount:this.bindFn(this.didMountBrailleInput),didUnmount:this.bindFn(this.didUnmountBrailleInput),onFocusedChanged:(e,t)=>this.shouldShowBraille()&&this.handleFocusChange(e,t),isFocused:this.props.isFocused,onKeyDown:this.props.onKeydown,selectOnFocus:this.props.selectOnFocus,onInput:this.bindFn(this.onBrailleInput),sixKeyInput:this.props.sixKeyInput,value:()=>this.currentBrailleValue,placeholder:()=>$s(this.props.placeholder?this.getBrailleFromLatex(this.props.placeholder()):""),tabIndex:this.bindFn(this.getTabindex),isStatic:this.bindFn(this.isStatic),size:()=>this.currentBrailleValue&&this.currentBrailleValue.length||1})})})}),l(LJ,{predicate:()=>!this.shouldShowBraille(),children:()=>l("div",{class:Ob.const("dcg-typeset-math"),children:kbe(()=>this.isStatic(),{true:()=>l(M1,{latex:this.props.latex,tabbable:()=>this.getTabindex()>=0,config:this.props.mqConfig,isFocused:this.props.isFocused,onFocusedChanged:(e,t)=>!this.shouldShowBraille()&&this.handleFocusChange(e,t),tokenController:this.props.tokenController,getAriaLabel:this.props.ariaLabel,onUserPressedKey:(e,t)=>{var o,i;t&&((i=(o=this.props).onKeydown)==null||i.call(o,t))}}),false:()=>l(Qe,{latex:this.props.latex,isFocused:this.props.isFocused,focusPosition:this.props.focusPosition,capExpressionSize:()=>{var e,t;return!!((t=(e=this.props).capExpressionSize)!=null&&t.call(e))},tokenController:this.props.tokenController,noFadeout:this.props.noFadeout,config:this.props.mqConfig,getAriaLabel:this.props.ariaLabel,getAriaPostLabel:()=>{var e,t;return((t=(e=this.props).getAriaPostLabel)==null?void 0:t.call(e))||""},hasError:()=>{var e,t;return((t=(e=this.props).hasError)==null?void 0:t.call(e))||!1},onUserPressedKey:this.props.onUserPressedKey,onUserChangedLatex:e=>{var t,o;return(o=(t=this.props).onUserChangedLatex)==null?void 0:o.call(t,e)},onExpressionSizeExceeded:()=>{var e,t,o;return(o=(t=(e=this.props).capExpressionSize)==null?void 0:t.call(e))==null?void 0:o.onExpressionSizeExceeded()},onFocusedChanged:(e,t)=>!this.shouldShowBraille()&&this.handleFocusChange(e,t),selectOnFocus:this.props.selectOnFocus,onSelectionChanged:this.props.onSelectionChanged,onReflow:this.props.onReflow,disableSpace:this.props.disableSpace,needsSystemKeypad:this.props.needsSystemKeypad,placeholder:this.props.placeholder,dataLabelAttributeValue:this.props.dataLabelAttributeValue})})})})]})}getTabindex(){return this.props.tabIndex?this.props.tabIndex():0}};function _c(){if(!(!document.activeElement||!document.activeElement.classList.contains("dcg-braille-input")))return document.activeElement}function PJ(r){return!r||r.value===""}var GJ=__dcg_shared_module_exports__['e'](j());function _be(r){let e=r.target;return e.classList.contains("dcg-exp-action-button")||e.classList.contains("dcg-icon-duplicate")||e.classList.contains("dcg-icon-remove")||e.classList.contains("dcg-icon-lock")||e.classList.contains("dcg-icon-pencil")}var Es=class extends GJ.View{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,this._isFirstRender=!0,this._isDragCopy=this.props.isDragCopy()}onItemViewMounted(e){this._isDragCopy||(this.model.rootViewNode=e),this._isFirstRender=!1}onItemViewUnmounted(){this._isDragCopy||(this.model.rootViewNode=void 0)}isFirstRender(){return this._isFirstRender}onMouseSelect(e){if(this.controller.isInEditListMode()&&!_be(e)){this.exitEditListMode();return}this.controller.isItemReadonly(this.id)||e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||jr(e)||(Xt(e),this.controller.dispatch({type:"set-selected-id",id:this.id,state:"selected"}))}onDragPending(e){this.controller.isItemReadonly(this.model.id)||this.props.onDragPending(e)}exitEditListMode(){this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!0})}};var uo=__dcg_shared_module_exports__['e'](j());var{If:eU}=uo.Components,Cc=class extends uo.View{init(){this.controller=this.props.controller()}template(){return l(eU,{predicate:this.bindFn(this.shouldShowOptions),children:()=>x("span",{class:()=>({"dcg-expression-edit-actions":!0,"dcg-limited-height":this.limitedHeight()}),didMount:()=>{this.controller.isInEditListMode()&&_e(this.controller.s("graphing-calculator-narration-edit-list-mode-on"))},didUnmount:()=>{this.controller.isInEditListMode()||_e(this.controller.s("graphing-calculator-narration-edit-list-mode-off"))},children:[l("span",{class:uo.const("dcg-graphic"),handleEvent:uo.const("true")}),l(eU,{predicate:()=>$f(this.model())!==void 0,children:()=>l(Oe,{tooltip:this.bindFn(this.getConvertTooltip),gravity:this.const("s"),children:l("span",{class:uo.const("dcg-action-createtable dcg-exp-action-button"),handleEvent:uo.const("true"),role:uo.const("button"),tabIndex:uo.const("0"),"aria-label":()=>Wr(this.model(),"create_table"),onTap:this.bindFn(this.onCreateTable),children:l("i",{class:uo.const("dcg-icon-table"),"aria-hidden":uo.const("true")})})})}),l(eU,{predicate:()=>this.controller.shouldShowAuthorFeatures(),children:()=>l(Oe,{tooltip:this.bindFn(this.getReadonlyToggleLabel),gravity:this.const("s"),children:l("span",{class:()=>({"dcg-action-lock":!0,"dcg-exp-action-button":!0,"dcg-selected":this.isReadonly()}),handleEvent:uo.const("true"),role:uo.const("button"),tabIndex:uo.const("0"),"aria-label":this.bindFn(this.getReadonlyToggleLabel),onTap:this.bindFn(this.onToggleReadonly),children:l("i",{class:uo.const("dcg-icon-lock"),"aria-hidden":uo.const("true")})})})}),l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-duplicate-expression-tooltip"),gravity:this.const("s"),children:l("span",{class:uo.const("dcg-duplicate-btn dcg-exp-action-button"),handleEvent:uo.const("true"),role:uo.const("button"),tabIndex:uo.const("0"),"aria-label":()=>Wr(this.model(),"duplicate"),onTap:this.bindFn(this.onDuplicateWithoutFocus),children:l("i",{class:uo.const("dcg-icon-duplicate"),"aria-hidden":uo.const("true")})})}),l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-expression-delete-tooltip"),gravity:this.const("s"),children:l("span",{class:uo.const("dcg-delete-btn dcg-exp-action-button"),handleEvent:uo.const("true"),role:uo.const("button"),tabIndex:uo.const("0"),"aria-label":()=>Wr(this.model(),"delete"),onTap:this.bindFn(this.onDelete),children:l("i",{class:uo.const("dcg-icon-remove"),"aria-hidden":uo.const("true")})})})]})})}shouldShowOptions(){return this.controller.isInEditListMode()&&(this.controller.shouldShowAuthorFeatures()||!this.controller.isItemReadonly(this.props.id()))}model(){return this.controller.getItemModel(this.props.id())}getConvertTooltip(){return QE(this.model())?this.controller.s("graphing-calculator-label-create-table"):this.controller.s("graphing-calculator-label-convert-to-table-tooltip")}limitedHeight(){let e=this.model();return e&&(e.type==="image"||this.isSlider())}isSlider(){let e=this.model();return e&&e.type==="expression"&&e.sliderExists}onCreateTable(){let e=this.model();e&&this.controller.dispatch({type:"convert-or-create-table",index:e.index})}onDelete(e){this.controller.dispatch({type:"delete-item-and-animate-out",id:this.props.id(),setFocusAfterDelete:e.device==="keyboard"})}onDuplicateWithoutFocus(){let e=this.model();e&&(e.type==="folder"?this.controller.dispatch({type:"duplicate-folder",id:this.props.id()}):this.controller.dispatch({type:"duplicate-expression",id:this.props.id()}))}isReadonly(){return this.controller.isItemMarkedReadonly(this.props.id())}onToggleReadonly(){let e=this.model();e&&this.controller.dispatch({type:"set-item-readonly",id:this.props.id(),readonly:!e.readonly})}getReadonlyIcon(){return this.isReadonly()?"dcg-icon-lock":"dcg-icon-pencil"}getReadonlyToggleLabel(){return this.isReadonly()?this.controller.s("graphing-calculator-label-unlock-expression-tooltip"):this.controller.s("graphing-calculator-label-lock-expression-tooltip")}};var Tc=__dcg_shared_module_exports__['e'](j());var rU=__dcg_shared_module_exports__['e'](j()),tU=class extends rU.View{template(){return l("div",{children:this.props.children})}shouldUpdate(){return this.props.shouldUpdate()}},oA=class extends rU.View{template(){return l("div",{inert:()=>this.props.suspended()?!0:void 0,"aria-hidden":()=>this.props.suspended()?!0:void 0,class:()=>({"dcg-suspended":this.props.suspended()}),children:l(tU,{shouldUpdate:()=>!this.props.suspended(),children:this.props.children})})}};var nl=__dcg_shared_module_exports__['e'](j());var VJ=__dcg_shared_module_exports__['e'](j());var wa=class extends VJ.View{init(){this.controller=this.props.controller()}template(){var e,t;return l(un,{latex:this.props.latex,isFocused:this.bindFn(this.isFocused),isStatic:this.const(!0),ariaLabel:this.props.brailleAriaLabel||this.props.ariaLabel,...ra(this.controller,{additionalOperators:((t=(e=this.props).additionalOperators)==null?void 0:t.call(e))||[]}),onKeydown:o=>{var i,n;return(n=(i=this.props).onKeypress)==null?void 0:n.call(i,o)},tabIndex:()=>this.props.tabbable()?0:-1,selectOnFocus:()=>!jn,onFocusedChanged:this.bindFn(this.onFocusChange)})}isFocused(){return __dcg_shared_module_exports__['db'](this.props.focusLocation(),this.controller.getFocusLocation())}onFocusChange(e,t){var o,i;e?this.controller.dispatch({type:"set-focus-location",location:this.props.focusLocation()}):(i=(o=this.props).suppressBlurEvent)!=null&&i.call(o,t)||this.controller.dispatch({type:"blur-focus-location",location:this.props.focusLocation()})}};var{If:Cbe}=nl.Components,Rb=class extends nl.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:nl.const("dcg-action-info"),handleEvent:nl.const("true"),children:[l("span",{class:nl.const("dcg-action-label"),children:"Run "}),l(wa,{latex:()=>this.model.clickableInfo.latex,ariaLabel:()=>this.controller.s("graphing-calculator-label-ticker-min-step"),tabbable:this.const(!0),focusLocation:this.const({type:"action-info",id:this.model.id}),controller:this.props.controller,additionalOperators:this.const(["index"])}),l("span",{class:nl.const("dcg-action-label"),children:" on click"}),l(Cbe,{predicate:()=>!this.controller.isItemReadonly(this.model.id),children:()=>l("span",{class:nl.const("dcg-click-edit"),role:nl.const("button"),tabIndex:nl.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-action"),onTap:this.bindFn(this.editAction),children:l("i",{class:nl.const("dcg-icon-pencil"),"aria-hidden":nl.const("true")})})})]})}editAction(){this.model.type==="expression"?this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"expression",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}}):this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"image",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:this.model.id,location:"updaterule"}})}getMenuGUID(){return this.model.guid}};var hd=__dcg_shared_module_exports__['e'](j());var Fb=__dcg_shared_module_exports__['e'](j());var Vp=class extends Fb.View{template(){return l(Oe,{tooltip:()=>this.props.controller().s("shared-calculator-label-toast-learn-more"),children:l("a",{"aria-label":()=>this.props.controller().s("shared-calculator-label-toast-learn-more"),class:Fb.const("dcg-learn-more-link"),href:this.props.href,target:Fb.const("_blank"),children:l("i",{class:Fb.const("dcg-icon-question-sign"),"aria-hidden":Fb.const("true")})})})}};var iA=__dcg_shared_module_exports__['e'](j());var{IfElse:Tbe}=iA.Components,or=class extends iA.View{init(){this.controller=this.props.controller()}template(){return l("div",{class:this.bindFn(this.getContainerClass),children:Tbe(this.props.readonly,{true:()=>l(un,{latex:this.bindFn(this.getStaticLatex),isFocused:this.props.isFocused,isStatic:this.const(!0),onFocusedChanged:this.props.handleFocusChanged,brailleAriaLabel:this.props.brailleLabel,ariaLabel:this.props.ariaLabel,dataLabelAttributeValue:this.props.dataLabelAttributeValue,...ra(this.props.controller())}),false:()=>l(un,{latex:this.props.latex,isFocused:this.props.isFocused,selectOnFocus:this.const(!0),onKeydown:this.bindFn(this.onKeydown),hasError:this.props.hasError,placeholder:this.props.placeholder,brailleAriaLabel:this.props.brailleLabel,ariaLabel:this.props.ariaLabel,dataLabelAttributeValue:this.props.dataLabelAttributeValue,...ra(this.props.controller()),getAriaPostLabel:()=>{var t,o;let e=((o=(t=this.props).ariaPostLabel)==null?void 0:o.call(t))||"";return this.props.hasError()&&e===""&&(e=this.controller.s("shared-calculator-narration-math-input-error-message")),e},onUserPressedKey:this.props.handlePressedKey,onUserChangedLatex:this.props.handleLatexChanged,onSelectionChanged:this.props.handleSelectionChanged,onFocusedChanged:this.props.handleFocusChanged})})})}getStaticLatex(){return this.props.latex()?this.props.latex():this.props.placeholder?this.props.placeholder():""}getContainerClass(){let e=this.props.containerClass?this.props.containerClass():{};return e["dcg-inline-math-input-view"]=!0,this.props.fullWidth&&this.props.fullWidth()&&(e["dcg-full-width-inline-math-input"]=!0),this.props.fontSize&&this.props.fontSize()==="large"&&(e["dcg-large-font-inline-math-input"]=!0),this.props.noBorder&&this.props.noBorder()&&(e["dcg-no-border-inline-math-input"]=!0),e}onKeydown(e){if(!this.props.handlePressedKey)return;let t=Pe(e);t&&this.props.handlePressedKey(t,e)}};var{If:oU}=hd.Components,nA=class extends hd.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}handlePressedKey(e,t,o){if(!this.controller.isInEditListMode()){if(t==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(t==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"})}let i=Qe.getFocusedMathquill(),n=_c();if(t==="Left"||t==="Right"||t==="Down"||t==="Up"){let a;i?a=Qe.applyArrowKeyAndReturnIfWasAtBounds(i,t,o):n&&(n.selectionStart===0&&t==="Left"||n.selectionStart===n.value.length&&t==="Right"||t==="Up"||t==="Down")?a=!0:a=!1,a&&(o&&o.preventDefault(),t==="Left"?e==="max"+this.getDomainVariableString()&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"min"+this.getDomainVariableString()}}):t==="Right"?e==="min"+this.getDomainVariableString()&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"max"+this.getDomainVariableString()}}):t==="Down"?this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}):t==="Up"&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}}));return}i&&(i.keystroke(t,o),e==="min"+this.getDomainVariableString()?this.dispatchMinLatexIfChanged(i.latex()):e==="max"+this.getDomainVariableString()&&this.dispatchMaxLatexIfChanged(i.latex()))}getDomainVariable(){var o,i;let e=this.props.domainIndex(),t=(i=(o=this.model.formula.domains)==null?void 0:o[e])==null?void 0:i.variable;if(!t)throw new Error("Programming Error: could not find domain variable in index "+e);return t}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"domain-limit",id:this.id,location:e}})}dispatchMinLatexIfChanged(e){this.getMinLatex()!==e&&this.controller.dispatch({type:"set-domain-minlatex",variable:this.getDomainVariable(),id:this.id,latex:e})}dispatchMaxLatexIfChanged(e){this.getMaxLatex()!==e&&this.controller.dispatch({type:"set-domain-maxlatex",variable:this.getDomainVariable(),id:this.id,latex:e})}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="domain-limit"||e.id!==this.id))return e.location}getMinLatex(){return m7(this.model,this.getDomainVariable())}getMaxLatex(){return f7(this.model,this.getDomainVariable())}getDomainVariableString(){let e=this.getDomainVariable();return e==="theta"?e="\\theta":e==="phi"&&(e="\\phi"),e}getDomainVariableDisplayLatex(){return"\\le "+this.getDomainVariableString()+" \\le"}getPlaceholder(e){return __dcg_shared_module_exports__['nb'](e).string.replace("\u03C0","\\pi")}template(){return l("div",{class:hd.const("dcg-domain dcg-do-blur"),handleEvent:hd.const("true"),children:x("div",{class:hd.const("dcg-display-domain dcg-do-blur"),handleEvent:hd.const("true"),children:[l(or,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.getMinLatex(),isFocused:()=>this.getFocusedInput()==="min"+this.getDomainVariableString(),placeholder:()=>this.getPlaceholder(W9(this.model,this.getDomainVariable())),ariaLabel:()=>this.controller.s("graphing-calculator-narration-domain3d-minimum",{term:this.getDomainVariableString()}),brailleLabel:()=>this.controller.raw("dmin"),handleFocusChanged:e=>this.handleFocusedChanged("min"+this.getDomainVariableString(),e),hasError:()=>!X9(this.model,this.getDomainVariable()),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("min"+this.getDomainVariableString(),e,t),handleLatexChanged:e=>this.dispatchMinLatexIfChanged(e),dataLabelAttributeValue:this.const("domain-min")}),l("span",{class:hd.const("dcg-interval-interior"),children:l(dt,{latex:()=>this.getDomainVariableDisplayLatex(),config:this.const({})})}),l(or,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.getMaxLatex(),isFocused:()=>this.getFocusedInput()==="max"+this.getDomainVariableString(),placeholder:()=>this.getPlaceholder(j9(this.model,this.getDomainVariable())),ariaLabel:()=>this.controller.s("graphing-calculator-narration-domain3d-maximum",{term:this.getDomainVariableString()}),brailleLabel:()=>this.controller.raw("dmax"),handleFocusChanged:e=>this.handleFocusedChanged("max"+this.getDomainVariableString(),e),hasError:()=>!$9(this.model,this.getDomainVariable()),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("max"+this.getDomainVariableString(),e,t),handleLatexChanged:e=>this.dispatchMaxLatexIfChanged(e),dataLabelAttributeValue:this.const("domain-max")}),l(oU,{predicate:()=>this.getDomainVariableString()==="\\phi",children:()=>l(Vp,{href:this.const("https://help.desmos.com/hc/en-us/articles/15824510769805"),controller:this.props.controller})})]})})}},Ek=class extends hd.View{constructor(){super(...arguments),this.model=this.props.model()}hasFirstDomainIndex(){return Og(this.model)||oh(this.model)&&!y7(this.model)}hasSecondDomainIndex(){return oh(this.model)?!x7(this.model):!1}template(){return x("div",{children:[l(oU,{predicate:this.bindFn(this.hasFirstDomainIndex),children:()=>l(nA,{controller:this.props.controller,model:this.props.model,domainIndex:this.const(0)})}),l(oU,{predicate:this.bindFn(this.hasSecondDomainIndex),children:()=>l(nA,{controller:this.props.controller,model:this.props.model,domainIndex:this.const(1)})})]})}};var Ro=__dcg_shared_module_exports__['e'](j());var OJ=__dcg_shared_module_exports__['e'](j());var Ebe=.9,mh=class extends OJ.View{template(){return l("div",{class:()=>{var e,t;return{"dcg-color-swatch":!0,"dcg-forced-color-none":!0,"dcg-color-evaluation":(t=(e=this.props).isEvaluation)==null?void 0:t.call(e),"dcg-light-color":iv(this.props.color(),this.props.invertSwatches(),Ebe)}},style:()=>({background:nv(this.props.color())})})}};var RJ=15,iU=100,{If:FJ,SwitchUnion:Ibe,For:Mbe,Switch:NJ,IfElse:Dbe}=Ro.Components,aA=class extends Ro.View{template(){return l("div",{class:Ro.const("dcg-evaluation-view__wrapped-value"),children:l(NJ,{children:()=>l(wa,{latex:this.props.latex,controller:this.props.controller,focusLocation:this.bindFn(this.getFocusLocation),tabbable:this.bindFn(this.isTabbable),ariaLabel:this.const("")})},this.bindFn(this.isTabbable))})}isTabbable(){return!this.props.listIndex||this.props.listIndex()===0}getFocusLocation(){return this.props.listIndex?{type:"expression-evaluation",id:this.props.id(),listIndex:this.props.listIndex()}:{type:"expression-evaluation",id:this.props.id()}}},A1=class extends Ro.View{template(){return l("div",{tabIndex:()=>this.props.listIndex&&this.props.listIndex()>0?-1:0,class:Ro.const("dcg-evaluation-view__plaintext"),onTap:e=>e.target.focus(),manageFocus:this.const(ze({controller:this.props.controller(),location:this.getFocusLocation()})),children:this.props.content})}getFocusLocation(){return this.props.listIndex?{type:"expression-evaluation",id:this.props.id(),listIndex:this.props.listIndex()}:{type:"expression-evaluation",id:this.props.id()}}},sA=class extends Ro.View{constructor(){super(...arguments),this.controller=this.props.controller()}template(){return l("div",{class:Ro.const("dcg-equals-or-slow"),children:Dbe(()=>this.displaySlowEvaluation(),{true:()=>l(Oe,{tooltip:()=>this.controller.s("shared-calculator-error-slow-evaluation"),sticky:this.const(!0),gravity:this.const("n"),children:l("span",{class:Ro.const("dcg-spinner"),"aria-hidden":Ro.const("true")})}),false:()=>l("span",{class:Ro.const("dcg-evaluation-view__equals-sign"),onTap:this.bindFn(this.selectEvaluation),children:l(dt,{latex:this.const("="),config:this.const({})})})})})}displaySlowEvaluation(){return this.controller.shouldShowProgressUpdateIcons()&&this.controller.isItemSlowInEvaluator(this.props.id())}selectEvaluation(){let e=this.props.isList()?{type:"expression-evaluation",id:this.props.id(),listIndex:0}:{type:"expression-evaluation",id:this.props.id()};this.controller.dispatch({type:"set-focus-location",location:e})}},Ik=class extends Ro.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.shouldShowShowMoreLink=!1,this.countToShow=iU,this.cachedEvaluationRHS=this.getEvaluationRHS()}template(){return l("div",{class:()=>({"dcg-evaluation-container":!0,"dcg-hidden":this.props.controller().isInEditListMode()}),handleEvent:Ro.const("true"),tabIndex:this.const("-1"),didMount:this.bindFn(this.remeasureDOMAndUpdateCache),onKeyDown:this.bindFn(this.handlePressedKey),children:Ibe(()=>this.cachedEvaluationRHS,"type",{"list-count":e=>l(A1,{...this.props,content:()=>this.controller.s("graphing-calculator-label-evaluation-list",{count:e().count})}),list:e=>x("div",{class:()=>({"dcg-evaluation-list":!0,"dcg-do-not-blur":!0}),handleEvent:Ro.const("true"),children:[x("div",{class:()=>({"dcg-evaluation-view__collapsed-list-values":this.listCollapsed(),"dcg-evaluation-view__list-values":!0,"dcg-evaluation-view__point-values":!!e().isPoint}),onMount:t=>this.listValuesEl=t,children:[l(sA,{...this.props,isList:this.const(!0)}),l(Mbe,{each:()=>e().displayedValues,children:(t,o)=>l(NJ,{children:i=>i?l(A1,{...this.props,content:()=>this.controller.s("shared-calculator-label-undefined"),listIndex:()=>o}):l(aA,{controller:this.props.controller,id:this.props.id,latex:()=>this.getListValue(o),listIndex:()=>o})},()=>this.getListValue(o)==="undefined")},(t,o)=>o),l(FJ,{predicate:()=>e().count>this.countToShow&&!this.listCollapsed(),children:()=>l("div",{class:Ro.const("dcg-blue-link dcg-do-not-blur dcg-show-even-more-link"),role:Ro.const("link"),tabIndex:Ro.const("0"),onTap:t=>this.expandFurther({focus:t.device==="keyboard"}),handleEvent:Ro.const("true"),children:()=>this.controller.s("account-shell-text-mygraphs-count-more",{count:e().count-this.countToShow})})})]}),l(FJ,{predicate:()=>this.shouldShowShowMoreLink,children:()=>l("div",{class:Ro.const("dcg-show-more-link"),children:l("div",{class:Ro.const("dcg-blue-link dcg-do-not-blur"),role:Ro.const("link"),handleEvent:Ro.const("true"),tabIndex:Ro.const("0"),onTap:t=>this.expandList({focus:t.device==="keyboard"}),manageFocus:this.const(ze({controller:this.props.controller(),location:{type:"expression-evaluation",listIndex:"show-more",id:this.props.id()}})),children:()=>this.controller.s("graphing-calculator-label-evaluation-list",{count:e().count})})})})]}),number:e=>x("div",{class:()=>({"dcg-evaluation-number":!0,"dcg-evaluation-view__point-values":!!e().isPoint}),children:[l(sA,{...this.props,isList:this.const(!1)}),l(aA,{controller:this.props.controller,latex:()=>e().valueLatex,id:this.props.id})]}),undefined:()=>l(A1,{...this.props,content:()=>this.controller.s("shared-calculator-label-undefined")}),emptyList:()=>l(A1,{...this.props,content:()=>this.controller.s("shared-calculator-label-empty-list")}),rgbcolor:e=>l("div",{class:Ro.const("dcg-evaluation-view__color-swatch"),"aria-label":()=>e().ariaLabel,tabIndex:Ro.const("0"),children:l(mh,{color:()=>e().colorValue,isEvaluation:this.const(!0),invertSwatches:()=>this.controller.invertSwatches()})})})})}getListValue(e){let t=this.cachedEvaluationRHS;return(t==null?void 0:t.type)!=="list"?"":t.displayedValues[e]}listCollapsed(){return!this.controller.isEvaluationExpanded(this.props.id())}numValuesVisible(){return this.listCollapsed()?RJ:this.countToShow}tryNavigatingUpOrDown(e){var h;let t=this.getCurrentListIndex();if(t===void 0)return!1;let o=t;if(this.cachedEvaluationRHS.type!=="list"||this.listCollapsed()||o===void 0)return!1;let i=(h=document.activeElement)==null?void 0:h.closest(".dcg-evaluation-view__wrapped-value");if(!i)return!1;if(e==="down"&&this.cachedEvaluationRHS.count===o+1||e==="up"&&o===0)return!0;let n=i.getBoundingClientRect(),a=n.top,s=n.left+n.width/2,c,d,p,u=a,g=s;for(;i!=null&&i.getBoundingClientRect;){c=i,d=u,p=g;let b=e==="up"?-1:1;if(i=e==="up"?c.previousElementSibling:c.nextElementSibling,!(i!=null&&i.getBoundingClientRect)||!i.classList.contains("dcg-evaluation-view__wrapped-value")||(n=i.getBoundingClientRect(),o+=b,u=n.top,g=n.left+n.width/2,u===a))continue;if(d!==a&&u!==d)return this.moveFocusToIndex(o-b),!0;if((e==="up"?g<s:g>s)&&u!==a)return d===a?this.moveFocusToIndex(o):Math.abs(g-s)>Math.abs(s-p)?this.moveFocusToIndex(o-b):this.moveFocusToIndex(o),!0}if(e==="up"&&this.moveFocusToIndex(0),e==="down"){if(this.cachedEvaluationRHS.count>this.countToShow)return this.expandFurther({focus:!1}),this.tryNavigateDownThroughList();this.moveFocusToIndex(this.cachedEvaluationRHS.count-1)}return!0}tryNavigateDownThroughList(){if(this.listCollapsed())return this.expandList({focus:"no-change"}),this.tryNavigateDownThroughList();if(this.tryNavigatingUpOrDown("down"))return!0;let e=this.getCurrentListIndex();return e===void 0||this.cachedEvaluationRHS.type!=="list"?!1:e<this.cachedEvaluationRHS.count-1?(this.moveFocusToIndex(this.cachedEvaluationRHS.count-1),!0):!1}handlePressedKey(e){let t=Pe(e),o=!1;switch(t){case"Up":this.tryNavigatingUpOrDown("up")||this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.props.id()}}),o=!0;break;case"Right":this.incrementThroughList(1)&&(o=!0);break;case"Left":this.incrementThroughList(-1)&&(o=!0);break;case"Down":this.tryNavigateDownThroughList()||this.controller.dispatch({type:"on-special-key-pressed",key:t}),o=!0;break;case"PageUp":case"PageDown":this.controller.dispatch({type:"on-special-key-pressed",key:t}),o=!0;break;case"Esc":this.listCollapsed()?Dr():(this.collapseList(),this.controller.dispatch({type:"set-focus-location",location:{type:"expression-evaluation",id:this.props.id(),listIndex:"show-more"}})),o=!0;break}o&&(e.preventDefault(),e.stopPropagation())}getCurrentListIndex(){let e=this.controller.focusLocation;if(!((e==null?void 0:e.type)!=="expression-evaluation"||e.id!==this.props.id()||e.listIndex===void 0||e.listIndex==="show-more"))return e.listIndex}moveFocusToIndex(e){this.controller.dispatch({type:"set-focus-location",location:{type:"expression-evaluation",id:this.props.id(),listIndex:e}})}incrementThroughList(e){if(this.cachedEvaluationRHS.type!=="list")return!1;let t=this.getCurrentListIndex();if(t===void 0)return!1;let o=t+e;return o<0||o>=this.cachedEvaluationRHS.count?!1:(o>this.maxVisibleIdx&&this.listCollapsed()?this.expandList({focus:!0}):o>=this.countToShow?this.expandFurther({focus:!0}):this.moveFocusToIndex(o),!0)}remeasureDOMAndUpdateCache(){var c,d;let e=this.cachedDisplay;if(this.cachedDisplay={expressionListWidth:this.controller.computeMajorLayout().list.width,evaluationRHS:this.cachedEvaluationRHS,listCollapsed:this.listCollapsed(),brailleMode:this.controller.getBrailleMode(),projectorMode:this.controller.getGraphSettings().config.projectorMode},!this.listValuesEl||((c=this.cachedEvaluationRHS)==null?void 0:c.type)!=="list"||!this.listCollapsed()||!this._isMounted||__dcg_shared_module_exports__['db'](e,this.cachedDisplay))return;let t=(d=this.listValuesEl.parentElement)==null?void 0:d.querySelector(".dcg-show-more-link"),o=(t==null?void 0:t.clientWidth)||0,i=this.listValuesEl.scrollWidth>this.listValuesEl.clientWidth+o||this.cachedEvaluationRHS.count>RJ;if(i!==this.shouldShowShowMoreLink&&(this.shouldShowShowMoreLink=i,this.update()),!this.shouldShowShowMoreLink)return;let n=0,a=this.listValuesEl.getBoundingClientRect().right;this.listValuesEl.querySelectorAll(".dcg-evaluation-view__wrapped-value").forEach((p,u)=>{let g=p.getBoundingClientRect();g.left+g.width<=a&&(n=u)}),n!==this.maxVisibleIdx&&(this.maxVisibleIdx=n)}expandFurther(e){this.countToShow+=iU,e.focus?(this.update(),this.controller.dispatch({type:"set-focus-location",location:{type:"expression-evaluation",id:this.props.id(),listIndex:this.countToShow-iU}})):this.controller.dispatch({type:"set-selected-id",id:this.props.id(),state:"selected"})}expandList(e){this.shouldShowShowMoreLink=!1,this.controller.dispatch({type:"expand-evaluation",id:this.props.id()}),e.focus===!0?this.controller.dispatch({type:"set-focus-location",location:{type:"expression-evaluation",id:this.props.id(),listIndex:this.maxVisibleIdx+1}}):e.focus===!1&&Dr()}collapseList(){this.listCollapsed()||this.controller.dispatch({type:"collapse-evaluation",id:this.props.id()})}willUpdate(){this.cachedEvaluationRHS=this.getEvaluationRHS()}didUpdate(){this.remeasureDOMAndUpdateCache()}getColorLabel(){let e=this.controller.getItemModel(this.props.id());if(!(!e||e.type!=="expression"))return DD(e,this.controller)}getEvaluationRHS(){var i,n,a;let e=this.controller.getItemModel(this.props.id());if((e==null?void 0:e.type)!=="expression")return{type:"undefined"};let t=(i=e==null?void 0:e.formula)==null?void 0:i.is_evaluable,o=this.props.numericEvaluation?{valueType:__dcg_shared_module_exports__['B'],value:this.props.numericEvaluation()}:(n=e.formula)==null?void 0:n.typed_constant_value;if(!o||!__dcg_shared_module_exports__['ua'](o==null?void 0:o.valueType,__dcg_shared_module_exports__['Ce']))return{type:"undefined"};switch(o.valueType){case __dcg_shared_module_exports__['B']:return __dcg_shared_module_exports__['sb'](o.value,{...__dcg_shared_module_exports__['pb'],displayAsFraction:this.shouldDisplayAsFraction()}).type==="undefined"?{type:"undefined"}:{type:"number",valueLatex:(a=__dcg_shared_module_exports__['ub'](o.value,{...__dcg_shared_module_exports__['pb'],displayAsFraction:this.shouldDisplayAsFraction()}))!=null?a:""};case __dcg_shared_module_exports__['E']:{if(o.value.length===0)return{type:"emptyList"};if(!t)return{type:"list-count",count:o.value.length};let c=o.value.slice(0,this.numValuesVisible()).map(d=>__dcg_shared_module_exports__['ub'](d,this.getLabelOptions()));return{type:"list",count:o.value.length,displayedValues:c}}case __dcg_shared_module_exports__['_']:let s=__dcg_shared_module_exports__['yb'](o.value,{...__dcg_shared_module_exports__['qb'],displayAsFraction:this.shouldDisplayAsFraction()});return s==="undefined"?{type:"undefined"}:{type:"number",valueLatex:s};case __dcg_shared_module_exports__['$']:{if(o.value.length===0)return{type:"emptyList"};if(!t)return{type:"list-count",count:o.value.length};let c=o.value.slice(0,this.numValuesVisible()).map(d=>__dcg_shared_module_exports__['yb'](d,{...this.getLabelOptions(),digits:4}));return{type:"list",count:o.value.length,displayedValues:c}}case __dcg_shared_module_exports__['C']:{let c=__dcg_shared_module_exports__['Ab'](o.value,{...__dcg_shared_module_exports__['qb'],displayAsFraction:this.shouldDisplayAsFraction()});return c==="undefined"?{type:"undefined"}:{type:"number",isPoint:!0,valueLatex:c}}case __dcg_shared_module_exports__['F']:{if(o.value.length===0)return{type:"emptyList"};let c=o.value.slice(0,this.numValuesVisible()).map(d=>__dcg_shared_module_exports__['Ab'](d,{...this.getLabelOptions(),digits:4}));return{type:"list",isPoint:!0,count:o.value.length,displayedValues:c}}case __dcg_shared_module_exports__['ja']:{let c=__dcg_shared_module_exports__['Bb'](o.value,{...__dcg_shared_module_exports__['qb'],displayAsFraction:this.shouldDisplayAsFraction()});return c==="undefined"?{type:"undefined"}:{type:"number",valueLatex:c,isPoint:!0}}case __dcg_shared_module_exports__['ka']:{if(o.value.length===0)return{type:"emptyList"};let c=o.value.slice(0,this.numValuesVisible()).map(d=>__dcg_shared_module_exports__['Bb'](d,{...this.getLabelOptions(),digits:4}));return{type:"list",count:o.value.length,displayedValues:c,isPoint:!0}}case __dcg_shared_module_exports__['H']:case __dcg_shared_module_exports__['I']:{let c=yb(e);return c?{type:"rgbcolor",colorValue:Array.isArray(c)?{type:"color-array",value:c}:{type:"single-color",value:c},val:c,ariaLabel:this.getColorLabel()}:{type:"undefined"}}case __dcg_shared_module_exports__['G']:return{type:"emptyList"};default:throw new Error(`Unexpected evaluation type ${o}`)}}getLabelOptions(){return this.props.controller().getEvaluationLabelOptionsForItem(this.props.id())}shouldDisplayAsFraction(){return this.props.controller().shouldEvaluationForItemDisplayAsFraction(this.props.id())}};var L1=__dcg_shared_module_exports__['e'](j()),P1=class extends L1.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:L1.const("dcg-expression-footer__alt-text dcg-do-blur"),handleEvent:L1.const("true"),onTap:this.bindFn(this.focusAlt),tapboundary:L1.const("true"),children:[l("b",{children:()=>this.controller.s("graphing-calculator-label-alt-text")}),()=>this.model.description]})}focusAlt(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:this.model.type==="expression"?{type:"expression",model:this.model,guid:this.model.guid}:{type:"image",model:this.model,guid:this.model.guid}}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:this.model.id,location:"alt-text"}})}};var Ka=__dcg_shared_module_exports__['e'](j());var Nl=__dcg_shared_module_exports__['e'](j());Ut();var Abe='a, input, button:not([disabled]), textarea, select [role="textbox"], [tabIndex="0"], [role="option"], [role="button"], [role="link"], summary',am=class{constructor({isOpen:e,closeMenu:t,anchorSelector:o,popoverSelector:i,itemNavigationKey:n}){this.handleKeydown=e=>{switch(this.itemNavigationKey){case"arrow":return this.onKeydownWithArrowTrapping(e);case"tab":return this.onKeydownWithTabTrapping(e)}};this.handleTap=e=>{let t=document.querySelector(this.popoverSelector);if(!t)return;let{target:o}=e,i=this.anchorSelector;i&&o.closest(i)||t.contains(o)||Array.from(document.querySelectorAll(".dcg-keypad,.dcg-show-keypad-container")).some(a=>a.contains(o))||this.closeMenu()};this.isOpen=e,this.closeMenu=t,this.anchorSelector=o,this.popoverSelector=i,this.itemNavigationKey=n}getFocusableItems(){let e=document.querySelector(this.popoverSelector);return e?Array.from(e.querySelectorAll(Abe)).filter(o=>o.getAttribute("tabIndex")!=="-1"&&!o.closest("[inert]")).filter(o=>Ku(o)):[]}focusAnchor(){var e;(e=document.querySelector(this.anchorSelector))==null||e.focus()}focusItemAtIdx(e){let t=this.getFocusableItems();return t.length&&t.length>e?(t[e].focus(),!0):!1}focusFirstItem(){this.focusItemAtIdx(0)}focusLastItem(){this.focusItemAtIdx(this.getFocusableItems().length-1)}getFocusedElement(){return this.getFocusableItems().find(e=>e.matches(":focus"))}moveFocusInDirection(e){let t=this.getFocusableItems(),o=t.findIndex(a=>a.matches(":focus"));if(o===-1)return!1;let i=o+e;if(i==-1||i==t.length)return!0;let n=t[i];return n?(n.focus(),!0):!1}isAnchorFocused(){var e;return(e=document.querySelector(this.anchorSelector))==null?void 0:e.matches(":focus")}isFirstItemFocused(){var t;let e=this.getFocusableItems();return e.length>0&&((t=e[0])==null?void 0:t.matches(":focus"))}isLastItemFocused(){var t;let e=this.getFocusableItems();return e.length>0&&((t=e[e.length-1])==null?void 0:t.matches(":focus"))}onKeydownWithArrowTrapping(e){if(this.isOpen())switch(Pe(e)){case Tn:this.moveFocusInDirection(-1)&&e.preventDefault();break;case Mi:this.moveFocusInDirection(1)&&e.preventDefault();break;case Wc:e.preventDefault(),this.focusLastItem();break;case us:e.preventDefault(),this.closeMenu();break;case Wi:e.preventDefault(),e.stopPropagation(),this.closeMenu(),this.focusAnchor();break}}onKeydownWithTabTrapping(e){if(!this.isOpen())return;let t=Pe(e);if(t===Wi){e.preventDefault(),e.stopPropagation(),this.focusAnchor(),this.closeMenu();return}if(t==="Tab"&&!e.altKey&&!e.ctrlKey&&!e.metaKey){if(this.isAnchorFocused()){e.shiftKey?this.focusLastItem():this.focusFirstItem(),e.preventDefault(),e.stopPropagation();return}if(this.isLastItemFocused()&&!e.shiftKey){this.focusAnchor(),e.preventDefault(),e.stopPropagation();return}if(this.isFirstItemFocused()&&e.shiftKey){this.focusAnchor(),e.preventDefault(),e.stopPropagation();return}}}};var{IfDefined:Lbe,If:UJ}=Nl.Components,Pbe=-7,lA=9,Mk=class extends Nl.View{didMountPopover(e){var o,i,n,a,s,c;(i=(o=this.props).didMount)==null||i.call(o,e);let t=(a=(n=this.props).focusHelper)==null?void 0:a.call(n);t&&(document.addEventListener("keydown",t.handleKeydown),(c=(s=this.props).focusAnchorOnTap)!=null&&c.call(s)||t==null||t.focusFirstItem())}didUnmountPopover(){var t,o;let e=(o=(t=this.props).focusHelper)==null?void 0:o.call(t);e&&document.removeEventListener("keydown",e.handleKeydown)}getPositionClasses(){let e=this.props.position();return{"dcg-left":e==="left","dcg-right":e==="right","dcg-bottom":e==="bottom-left"||e==="bottom-right","dcg-top":e==="top-left"||e==="top-right"}}template(){return x("div",{class:()=>{var e,t,o,i,n,a;return{"dcg-dropdown-popover":!0,"dcg-dropdown-popover--with-arrow":!((t=(e=this.props).hideArrow)!=null&&t.call(e)),"dcg-dropdown-popover--constrain-height":(i=(o=this.props).constrainHeight)==null?void 0:i.call(o),...this.getPositionClasses(),[((a=(n=this.props).className)==null?void 0:a.call(n))||""]:!!this.props.className}},role:Nl.const("region"),style:()=>{var e,t;return{...((t=(e=this.props).style)==null?void 0:t.call(e))||{}}},didMount:this.bindFn(this.didMountPopover),didUnmount:this.bindFn(this.didUnmountPopover),children:[x("div",{class:Nl.const("dcg-dropdown-popover__interior"),children:[Lbe(()=>{var e,t;return(t=(e=this.props).title)==null?void 0:t.call(e)},e=>l("h2",{class:Nl.const("dcg-unstyled-heading dcg-dropdown-popover__title"),children:()=>e()})),this.props.popoverBody()]}),l(UJ,{predicate:()=>{var e,t;return!((t=(e=this.props).hideArrow)!=null&&t.call(e))},children:()=>l("div",{class:Nl.const("dcg-arrow"),style:()=>{var e,t;return((t=(e=this.props).arrowStyle)==null?void 0:t.call(e))||{}}})})]})}},oa=class extends Nl.View{constructor(){super(...arguments),this.showDropdown=!1,this.guid=this.props.guid(),this.dropdownStyle={},this.arrowStyle=void 0,this.debouncedPositionDynamically=__dcg_shared_module_exports__['_a'](this.bindFn(this.positionDynamically),200)}init(){var t,o;let e=(o=(t=this.props).focusTrapping)==null?void 0:o.call(t);e&&(this.focusHelper=new am({anchorSelector:`.dcg-popover-with-anchor__anchor--${this.guid}`,popoverSelector:`.dcg-popover-with-anchor__popover--${this.guid}`,isOpen:()=>this.isDropdownOpen(),closeMenu:()=>this.setDropdownOpen(!1),itemNavigationKey:e.itemNavigationKey}))}isDropdownOpen(){return this.props.controlled?this.props.controlled().isOpen:this.showDropdown}setDropdownOpen(e){var t,o;(o=(t=this.props).disabled)!=null&&o.call(t)||(this.props.controlled?this.props.controlled().setDropdownOpen(e):(this.showDropdown=e,this.update()),e&&(this.resetPosition(),this.positionDynamically()))}didMountWrapper(e){var o,i;this.rootNode=e,window.addEventListener("resize",this.debouncedPositionDynamically);let t=(i=(o=this.props).boundingParentElement)==null?void 0:i.call(o);t&&(this.resizeObserver=new ResizeObserver(this.debouncedPositionDynamically),this.resizeObserver.observe(t)),re(document.body).on(`dcg-tapstart.${this.guid}`,n=>{if(!(n.target===e||re.contains(e,n.target))&&this.isDropdownOpen()){let a=e.querySelector(".dcg-popover-with-anchor__popover");if(re.contains(a,n.target))return;let s=a.getBoundingClientRect();if(n.clientX!==void 0&&n.clientY!==void 0&&n.clientX>s.left&&n.clientX<s.right&&n.clientY>s.top&&n.clientY<s.bottom)return;this.setDropdownOpen(!1);return}})}didUnmountWrapper(){this.showDropdown=!1,re(document.body).off(`.${this.guid}`),re(document).off(`.${this.guid}`),window.removeEventListener("resize",this.debouncedPositionDynamically),this.resizeObserver&&this.resizeObserver.disconnect()}didMountDropdown(e){var o,i,n;this.dropdownNode=e,((o=this.rootNode)==null?void 0:o.querySelector(".dcg-arrow"))&&(this.arrowStyle={}),this.resetPosition(),this.positionDynamically(),(n=(i=this.props.dropdownProps()).didMount)==null||n.call(i,e)}getDropdownOffset(){return this.props.dropdownOffset!==void 0?this.props.dropdownOffset():Pbe}resetPosition(){var i;let e=this.props.dropdownProps().position();this.dropdownStyle={},((i=this.rootNode)==null?void 0:i.querySelector(".dcg-arrow"))?this.arrowStyle={}:this.arrowStyle=void 0;let o=this.getDropdownOffset();switch(e){case"left":case"right":this.dropdownStyle.top=`${o}px`,this.arrowStyle&&(this.arrowStyle.top=`${lA}px`);break;case"top-right":case"bottom-right":this.dropdownStyle.left=`${o}px`,this.arrowStyle&&(this.arrowStyle.left=`${lA}px`);break;case"top-left":case"bottom-left":this.dropdownStyle.right=`${o}px`,this.arrowStyle&&(this.arrowStyle.right=`${lA}px`);break}this.update()}positionDynamically(){var v,T,E,I;let e=this.dropdownNode,t=this.rootNode;if(!t||!e||!this.isDropdownOpen())return;let o=e.getBoundingClientRect(),i=(E=(T=(v=this.props).boundingParentElement)==null?void 0:T.call(v))==null?void 0:E.getBoundingClientRect(),n=i?i.x+i.width:window.innerWidth,a=i?i.y+i.height:window.innerHeight,s=(I=i==null?void 0:i.left)!=null?I:0,c=o.bottom>a,d=o.right>n,p=o.left<s,u=this.props.dropdownProps().position(),g=t.getBoundingClientRect(),h=15,b=lA+this.getDropdownOffset();if((u==="left"||u==="right")&&c){let _=a-g.y-h,C=o.height-_;this.dropdownStyle.top=`${-1*C}px`,this.arrowStyle&&(this.arrowStyle.top=`${C+b}px`)}else if((u==="bottom-right"||u==="top-right")&&d){let _=n-g.x-h,C=o.width-_;this.dropdownStyle.left=`${-1*C}px`,this.arrowStyle&&(this.arrowStyle.left=`${C+b}px`)}else if((u==="bottom-left"||u==="top-left")&&p){let _=g.x+g.width-h-s,C=o.width-_;this.dropdownStyle.right=`${-1*C}px`,this.arrowStyle&&(this.arrowStyle.right=`${C+b}px`)}this.update()}getDropdownClassNames(){var t,o;let e=((o=(t=this.props.dropdownProps()).className)==null?void 0:o.call(t))||"";return`dcg-popover-with-anchor__popover dcg-popover-with-anchor__popover--${this.guid} ${e}`}template(){return x("div",{class:()=>{var e,t;return{"dcg-popover-with-anchor":!0,[((t=(e=this.props).containerClassName)==null?void 0:t.call(e))||""]:!!this.props.containerClassName}},didMount:this.bindFn(this.didMountWrapper),didUnmount:this.bindFn(this.didUnmountWrapper),children:[l("div",{role:Nl.const("link"),tabIndex:Nl.const(0),"aria-label":()=>{var e,t;return(t=(e=this.props).anchorAriaLabel)==null?void 0:t.call(e)},"aria-expanded":this.bindFn(this.isDropdownOpen),"aria-haspopup":Nl.const("true"),class:()=>({"dcg-popover-with-anchor__anchor":!0,[`dcg-popover-with-anchor__anchor--${this.guid}`]:!0,"dcg-popover-with-anchor__open":this.isDropdownOpen()}),onTap:e=>{var t,o,i,n,a;(o=(t=this.props).anchorTapStopPropagation)!=null&&o.call(t)&&e.stopPropagation(),this.setDropdownOpen(!this.isDropdownOpen()),(n=(i=this.props).focusAnchorOnTap)!=null&&n.call(i)&&((a=this.focusHelper)==null||a.focusAnchor())},manageFocus:()=>{var e,t;return(t=(e=this.props).manageFocus)==null?void 0:t.call(e)},children:this.props.anchor()}),l(UJ,{predicate:()=>this.isDropdownOpen(),children:()=>l(Mk,{...this.props.dropdownProps(),className:this.bindFn(this.getDropdownClassNames),focusHelper:()=>this.focusHelper,didMount:e=>this.didMountDropdown(e),arrowStyle:()=>this.arrowStyle,style:()=>this.dropdownStyle,popoverBody:this.props.popoverBody,focusAnchorOnTap:this.props.focusAnchorOnTap})})]})}};var Dk=__dcg_shared_module_exports__['e'](j());var Zo=class extends Dk.View{template(){return l(Oe,{tooltip:this.props.error,sticky:()=>{var e,t,o;return(o=(t=(e=this.props).sticky)==null?void 0:t.call(e))!=null?o:!0},gravity:this.props.gravity,additionalClass:this.const("dcg-tooltipped-error-container"),children:l("div",{class:()=>{var e,t,o,i,n,a;return{"dcg-tooltipped-error":!0,"dcg-small":((t=(e=this.props).size)==null?void 0:t.call(e))==="small","dcg-medium-small":((i=(o=this.props).size)==null?void 0:i.call(o))==="medium-small","dcg-white":this.props.isWhite&&this.props.isWhite(),"dcg-tooltipped-error__instant":(a=(n=this.props).instant)==null?void 0:a.call(n)}},children:l("i",{class:Dk.const("dcg-icon-error"),"aria-hidden":Dk.const("true")})})})}};var{If:nU,IfElse:Gbe}=Ka.Components,ho=(r,e=4)=>r===1/0?"\\infty":r===-1/0?"-\\infty":r!==void 0?__dcg_shared_module_exports__['ub'](r,{...__dcg_shared_module_exports__['qb'],digits:e,displayAsFraction:!1,scientificNotationDigits:1}):"",G1=class extends Ka.View{constructor(){super(...arguments),this.controller=this.props.controller()}getPopoverGuid(){return`exportable-evaluation-${this.props.outputItem()}-${this.props.id()}`}template(){return Gbe(()=>{var e,t;return!!((t=(e=this.props).error)!=null&&t.call(e))||this.getFormattedNumber()==="undefined"},{false:()=>l(oa,{focusAnchorOnTap:this.const(!0),anchor:()=>x("div",{class:Ka.const("dcg-exportable-evaluation--value"),children:[l(dt,{latex:this.bindFn(this.getFormattedNumber),config:this.const({}),...gh({controller:this.controller,location:{type:this.props.type(),id:this.props.id(),subtype:"exportable-evaluation",item:this.props.outputItem()}})}),l("i",{class:Ka.const("dcg-icon-caret-down")})]}),guid:this.bindFn(this.getPopoverGuid),controlled:()=>({isOpen:this.controller.isPopoverOpen(this.getPopoverGuid()),setDropdownOpen:e=>this.controller.dispatch({type:"set-popover-open",guid:this.getPopoverGuid(),open:e})}),dropdownProps:this.const({position:this.const("bottom-left")}),dropdownOffset:()=>-15,manageFocus:this.const(ze({controller:this.controller,location:{type:this.props.type(),id:this.props.id(),subtype:"exportable-evaluation-dot-dot",item:this.props.outputItem()}})),anchorAriaLabel:()=>{var e,t;return this.props.label?`${(t=(e=this.props).label)==null?void 0:t.call(e)} ${Mr(this.getFormattedNumber())}`:Mr(this.getFormattedNumber())},focusTrapping:this.const({itemNavigationKey:"tab"}),popoverBody:()=>x("div",{class:Ka.const("dcg-exportable-evaluation--popover"),children:[l(nU,{predicate:()=>{var e,t;return!!((t=(e=this.props).label)!=null&&t.call(e))},children:()=>l("label",{class:Ka.const("dcg-exportable-evaluation--label"),children:l(Xi,{content:()=>{var e,t;return((t=(e=this.props).label)==null?void 0:t.call(e))||""}})})}),x("div",{class:Ka.const("dcg-exportable-evaluation__copy-wrapper"),children:[l(M1,{latex:this.bindFn(this.getLongerNumber),config:this.const({}),getAriaLabel:this.props.label?()=>this.props.label():void 0,...gh({controller:this.controller,location:{type:this.props.type(),id:this.props.id(),subtype:"exportable-evaluation-expanded",item:this.props.outputItem()}})}),l(nU,{predicate:()=>!this.props.doExport,children:()=>l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-text-export-snapshot"),offset:this.const({top:4}),children:l("button",{class:Ka.const("dcg-unstyled-button dcg-exportable-evaluation__export-btn"),"aria-label":()=>this.controller.s("graphing-calculator-text-export-snapshot"),manageFocus:this.const(ze({controller:this.controller,location:{type:this.props.type(),id:this.props.id(),subtype:"exportable-evaluation-copy-value",item:this.props.outputItem()}})),onTap:this.bindFn(this.copyValueToList),children:l("i",{class:Ka.const("dcg-icon-insert"),"aria-hidden":Ka.const("true")})})})})]}),l(nU,{predicate:()=>!!this.props.doExport,children:()=>l("button",{class:Ka.const("dcg-btn-light-gray"),onTap:()=>{var e,t;return(t=(e=this.props).doExport)==null?void 0:t.call(e)},manageFocus:this.const(ze({controller:this.controller,location:{type:this.props.type(),id:this.props.id(),subtype:"exportable-evaluation-export-button",item:this.props.outputItem()}})),children:"Export to expression list"})})]})}),true:()=>l("div",{class:Ka.const("dcg-exportable-evaluation--wrapper"),children:l("div",{class:Ka.const("dcg-exportable-evaluation--value dcg-exportable-evaluation--errored"),children:l(Zo,{instant:this.const(!0),size:this.const("medium-small"),error:()=>{var e,t,o;return this.controller.unpack((o=(t=(e=this.props).error)==null?void 0:t.call(e))!=null?o:{key:"graphing-calculator-error-invalid-exportable-evaluation"})}})})})})}copyValueToList(){var t;let e=(t=this.controller.getItemModel(this.props.id()))==null?void 0:t.index;e!==void 0&&this.controller.dispatch({type:"export-latex-to-explist",latex:this.getLongerNumber(),indexToInsert:e+1})}getFormattedNumber(){var t;let e=this.props.outputValue();return typeof e=="string"?e:(t=ho(e))!=null?t:""}getLongerNumber(){var o;let e=this.props.outputValue();return typeof e=="string"?e:`${e!==void 0&&(o=__dcg_shared_module_exports__['ub'](e,{...__dcg_shared_module_exports__['pb']}))!=null?o:""}`}};var Ak=__dcg_shared_module_exports__['e'](j());var V1=r=>{switch(r){case"pleft":case"pright":case"p":return"graphing-calculator-label-inference-output-p";case"z":return"graphing-calculator-label-inference-output-z";case"t":return"graphing-calculator-label-inference-output-t";case"dof":return"graphing-calculator-label-inference-output-degrees-of-freedom";case"confidenceUpper":return"graphing-calculator-label-inference-output-confidence-upper";case"confidenceLower":return"graphing-calculator-label-inference-output-confidence-lower";case"significanceDiagram":return"graphing-calculator-label-inference-output-significance-diagram";case"confidenceDiagram":return"graphing-calculator-label-inference-output-confidence-diagram";case"pointEstimate":return"graphing-calculator-label-inference-output-point-estimate";case"standardError":return"graphing-calculator-label-inference-output-standard-error";default:throw new Error(`Unexpected item ${r}`)}},gd=class extends Ak.View{getOutputLabel(){var e,t;return(t=(e=this.props).hideLabel)!=null&&t.call(e)?"":this.props.controller().s(V1(this.props.outputItem()))+": "}template(){return x("div",{class:Ak.const("dcg-exportable-evaluation--wrapper"),"dcg-evaluation-item":this.props.outputItem,children:[l("label",{class:Ak.const("dcg-exportable-evaluation--label"),children:l(Xi,{content:this.bindFn(this.getOutputLabel)})}),l(G1,{controller:this.props.controller,id:this.props.id,type:this.const("inference-footer"),label:this.bindFn(this.getOutputLabel),outputItem:this.props.outputItem,doExport:this.bindFn(this.doExport),outputValue:this.bindFn(this.getOutputValue),error:this.bindFn(this.getOutputError)})]})}getOutputError(){return this.props.controller().getInferenceOutputErrorById(this.props.id(),this.props.outputItem())}doExport(){this.props.controller().dispatch({type:"export-inference-item-to-expression-list",item:this.props.outputItem(),id:this.props.id()})}getOutputValue(){return this.props.controller().getInferenceOutputValueById(this.props.id(),this.props.outputItem())}};var O1=class{constructor(e,t){this.model=t}getSpec(){return wp(this.model)}isMissingDefault(){if(!bb(this.model))return!1;let e=this.getSpec();if(!e)return!1;for(let t=0;t<e.params.length;t++)if(this.shouldShowDefaultValue(e.params[t]))return!0;return!1}getSuggestionType(){return this.getListOfParameters().length>1?this.isMissingDefault()?"listWithDefault":"list":this.missingRequiredParam()?"individual":"none"}missingRequiredParam(){let e=this.getSpec();if(!e||e.params.length!==1)return;let t=e.params[0];if(!this.getDefaultValue(t)&&!this.getParameterExtractedValue(t))return t}getDefaultValue(e){let t=this.getSpec();if(!t||!t.params)return"";for(let o=0;o<t.params.length;o++)if(t.params[o]===e)return t.defaults[o]||"";return""}getListOfParameters(){let e=this.getSpec();return e?e.params:[]}getParameterExtractedValue(e){let t=this.getSpec();return t&&t.values[e]||""}shouldShowDefaultValue(e){return!this.getParameterExtractedValue(e)&&!!this.getDefaultValue(e)}getExtractedAndDefaultArgString(e){let{params:t,values:o,defaults:i}=e;return t.map((a,s)=>{let c=o[a],d=i[s];return c||d||""}).join(",")}};var YJ=1e-6,BJ=1e9;function cA(r,e){let t=Math.max(aU(r.parameters[e]),r.displayPrecision);return __dcg_shared_module_exports__['ub'](r.parameters[e],{digits:t,scientificNotationDigits:t-1,smallCutoff:YJ,bigCutoff:BJ})}function aU(r){let e=Math.abs(r);if(e>=BJ||e<YJ||e<=1)return 6;let t=Math.floor(Math.log10(e))+1;return Math.min(9,t+5)}function Nb(r){return __dcg_shared_module_exports__['ub'](r,{zeroCutoff:1e-15,digits:4,smallCutoff:1e-6,bigCutoff:1e9})}var dA=["parameter-suggestions","warning","regression","slider","domain","ttest","stats","inference","significance","confidence","action-info","label","distribution","visualization","rename-prompt","extend-to-3d","slider-prompt","evaluation","braille-error","alt-text"],KJ={inference:!0,significance:!0,confidence:!0,distribution:!0},sU=(r,e)=>{let{formula:t}=e;if(t.warning!==void 0){let o=t.warning.key==="shared-calculator-error-complex-wirtinger-differs";return{type:"evaluation",message:r.unpack(t.warning),learnMoreWirtinger:o}}if(!r.getIncludeFunctionParametersInRandomSeed()&&t.depends_on_random_seed&&t.function_definition)return{type:"legacy-random-seed-behavior"};if(e.expressionTooComplex)return{type:"expressionTooComplex"};if(e.unresolved)return{type:"unresolved"};if(B9(e))return{type:"tone-out-of-range"};if(e.nanBlame===__dcg_shared_module_exports__['nd'].ComplexCoercion)return{type:"nan-blame-complex-coercion"};if(e.recursiveDepthPlottingError)return{type:"recursive-depth-plotting-error"}},Lk={warning:(r,e)=>!!sU(r,e),"action-info":(r,e)=>r.shouldShowActionInfo(e.id),"braille-error":(r,e)=>r.getBrailleMode()!=="none"&&!!e.error&&!vs(e),distribution:(r,e)=>{let t=wp(e);return(t==null?void 0:t.type)!=="distribution"||ik(e)?!1:bb(e)},domain:(r,e)=>!e.sliderExists&&(Og(e)||oh(e)),evaluation:(r,e)=>r.shouldShowEvaluationForItem(e.id),"extend-to-3d":(r,e)=>r.isThreeDMode()&&!e.expressionTooComplex&&e.shouldGraph&&ok(e),label:(r,e)=>Av(e)&&!r.isThreeDMode(),regression:(r,e)=>!!e.formula.regression,"rename-prompt":(r,e)=>{let t=r.getSuggestedIdentifierRenameInfo(e.id);return!!(t&&t.countOfChanges)},slider:(r,e)=>!!e.sliderExists,"slider-prompt":(r,e)=>r.shouldShowSliderPrompt(e),stats:(r,e)=>VM(e),inference:(r,e)=>{var t;return ea(e)&&r.isInferenceEnabled()&&__dcg_shared_module_exports__['ya']((t=e.formula.typed_constant_value)==null?void 0:t.valueType)},significance:(r,e)=>vp(e)&&r.isInferenceEnabled(),ttest:(r,e)=>GM(e),visualization:(r,e)=>PM(e),"alt-text":(r,e)=>r.shouldShowAltTextInFooter(e),confidence:(r,e)=>fb(e)&&r.isInferenceEnabled(),"parameter-suggestions":(r,e)=>new O1(r,e).getSuggestionType()!=="none"};function lU(r,e,t){var i,n,a,s,c,d,p,u,g;let{formula:o}=t;switch(r){case"evaluation":{let h=(i=o.typed_constant_value)==null?void 0:i.value;return Array.isArray(h)?[`\\ ${h.length}\\ element\\ list`]:[`=${h}`]}case"ttest":{let h=Vv(t);return h?[`<${__dcg_shared_module_exports__['mb'](h.lessThan,5)}`,`>${__dcg_shared_module_exports__['mb'](h.greaterThan,5)}`,`\\ne${__dcg_shared_module_exports__['mb'](h.notEqual,5)}`]:[]}case"regression":{let h=o.regression;if(!h)return[];let b=[],v=h.statistics,T=h.parameters;v.Rsquared!==void 0&&b.push(`R^2=${Nb(v.Rsquared)}`),v.rsquared!==void 0&&b.push(`r^2=${Nb(v.rsquared)}`),v.r!==void 0&&b.push(`r=${Nb(v.r)}`),v.RMSE!==void 0&&b.push(`\\operatorname{RMSE}=${Nb(v.RMSE)}`);for(let E in T)b.push(`${E}=${cA(h,E)}`);return b}case"distribution":{if(!t.cdf.show)return[];let h=nk(t),b=(n=t.formula)==null?void 0:n.cdf_min,v=(a=t.formula)==null?void 0:a.cdf_max,T=(s=t.formula)==null?void 0:s.cdf_p,E=(c=t.formula)==null?void 0:c.cdf_min_valid,I=(d=t.formula)==null?void 0:d.cdf_max_valid;if(!h)return[];if(t.cdf.compute==="p"&&!E||t.cdf.compute==="bounds"&&!((p=t.formula)!=null&&p.cdf_p_valid))return["Invalid inputs``"];if(t.cdf.compute==="p"&&(h==="inner"||h==="outer")&&!I)return["Invalid inputs``"];switch(h){case"inner":{let _=ho(Math.min(b,v)),C=ho(Math.max(b,v));return[`P\\left(${_} \\le x \\le ${C}\\right) = ${ho(T)}`]}case"outer":{let _=ho(Math.min(b,v)),C=ho(Math.max(b,v));return[`P\\left(x \\le ${_} or x \\ge ${C}\\right) = ${ho(T)}`]}case"left":return[`P\\left(x \\le ${ho(b)}\\right) = ${ho(T)}`];case"right":return[`P\\left(${ho(b)} \\le x \\right) = ${ho(T)}`];default:throw new Error(`Unhandled tails ${h}`)}}case"inference":{let h=[];if(t.inference.confidence){let b=e.getInferenceObjectComputedModel(t.id,"confidenceLevel"),v=(u=b==null?void 0:b.formula)==null?void 0:u.typed_constant_value;(v==null?void 0:v.valueType)===__dcg_shared_module_exports__['B']&&h.push(`Confidence level\`=${ho(v.value)}\``),["confidenceLower","confidenceUpper","pointEstimate","standardError"].forEach(E=>{let I=e.getInferenceOutputValueById(t.id,E);h.push(`${e.s(V1(E))}\`=${ho(I)}\``)})}if(t.inference.significance){let b=e.getInferenceObjectComputedModel(t.id,"hypothesis"),v=(g=b==null?void 0:b.formula)==null?void 0:g.typed_constant_value;(v==null?void 0:v.valueType)===__dcg_shared_module_exports__['B']&&h.push(`H_0\\ \\ ${tI(t)}=${ho(v.value)}`);let T=[];Ug(t)==="ttest"?T.push("dof","t"):T.push("z"),T.push("p"),T.forEach(E=>{let I=e.getInferenceOutputValueById(t.id,E);h.push(`${e.s(V1(E))}\`=${ho(I)}\``)})}return h}case"confidence":return["confidenceLower","confidenceUpper"].map(b=>{let v=e.getInferenceOutputValueById(t.id,b);return`${e.s(V1(b))}\`=${ho(v)}\``});case"significance":{let h=[];return qv(t)==="ttest"?h.push("dof","t"):h.push("z"),h.push("p"),h.map(b=>{let v=e.getInferenceOutputValueById(t.id,b);return`${e.s(V1(b))}\`=${ho(v)}\``})}case"warning":case"extend-to-3d":case"action-info":case"braille-error":case"slider":case"slider-prompt":case"stats":case"label":case"domain":case"visualization":case"rename-prompt":case"alt-text":case"parameter-suggestions":return[];default:return[r]}}var hn=__dcg_shared_module_exports__['e'](j());var{If:Vbe,Switch:Obe}=hn.Components,Pk=class extends hn.View{init(){this.controller=this.props.controller()}template(){return x("div",{class:hn.const("dcg-expression-warning dcg-text-selectable"),handleEvent:hn.const("true"),role:hn.const("note"),children:[l("i",{class:hn.const("dcg-icon-error"),"aria-hidden":hn.const("true")}),l(Obe,{children:e=>{switch(e==null?void 0:e.type){case"unresolved":return x("span",{children:[()=>this.controller.s("graphing-calculator-error-equation-contains-unresolved-details"),l("a",{href:hn.const("https://help.desmos.com/hc/en-us/articles/202529079-Unresolved-Detail-In-Plotted-Functions"),target:hn.const("_blank"),children:()=>this.controller.s("graphing-calculator-link-learn-more")})]});case"expressionTooComplex":return x("span",{children:[()=>this.controller.s("shared-calculator-error-gpu-expression-too-complex"),l("a",{href:hn.const("https://help.desmos.com/hc/en-us/articles/26801641850893-GPU-Error-while-Plotting-an-Expression"),target:hn.const("_blank"),children:()=>this.controller.s("graphing-calculator-link-learn-more")})]});case"tone-out-of-range":return l("span",{children:()=>this.controller.s("graphing-calculator-error-tone-frequency-out-of-range",{min:Pv,max:Gv})});case"recursive-depth-plotting-error":return l("span",{children:()=>this.controller.s("graphing-calculator-error-reached-maximum-recursion-depth")});case"nan-blame-complex-coercion":return l("span",{children:()=>this.controller.s("graphing-calculator-error-nan-blame-complex-coercion")});case"legacy-random-seed-behavior":return x("span",{children:[()=>this.controller.s("graphing-calculator-error-legacy-random-seed-behavior"),l("a",{href:hn.const("https://help.desmos.com/hc/en-us/articles/25261997911181-Change-to-Random-Seeds-in-Function-Definitions"),target:hn.const("_blank"),class:hn.const("dcg-warning-footer-learn-more"),children:()=>this.controller.s("graphing-calculator-link-learn-more")}),l("button",{onTap:()=>{this.controller.dispatch({type:"update-legacy-random-seed-behavior"})},class:hn.const("dcg-btn-light-gray dcg-update-behavior-btn dcg-unstyled-button"),children:()=>this.controller.s("graphing-calculator-label-update-to-new-behavior")})]});case"evaluation":return x("span",{children:[()=>e.message,l(Vbe,{predicate:()=>e.learnMoreWirtinger,children:()=>l("a",{href:hn.const("https://en.wikipedia.org/wiki/Wirtinger_derivatives#Formal_definition"),target:hn.const("_blank"),children:()=>this.controller.s("graphing-calculator-link-learn-more")})})]});case void 0:return}}},()=>this.props.warning())]})}};var Sa=__dcg_shared_module_exports__['e'](j());var R1=__dcg_shared_module_exports__['e'](j()),za=class extends R1.View{template(){return l("div",{class:R1.const("dcg-dot-dot-dropdown"),children:l("i",{class:R1.const("dcg-icon-ellipsis-vertical"),"aria-hidden":R1.const("true")})})}};var Ul=__dcg_shared_module_exports__['e'](j());var{For:Rbe,If:Fbe}=Ul.Components,Is=class extends Ul.View{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.promptGroupId=`prompt-slider-${yc()}`}template(){return x("div",{class:Ul.const("dcg-create-sliders"),handleEvent:Ul.const("true"),role:Ul.const("group"),"aria-labelledby":this.const(this.promptGroupId),children:[l("span",{class:Ul.const("dcg-msg"),id:this.const(this.promptGroupId),children:this.bindFn(this.getPromptMsg)}),x("span",{class:Ul.const("btns"),children:[l("span",{children:l(Rbe,{each:this.bindFn(this.getMissingVariables),children:e=>l("div",{class:Ul.const("dcg-slider-btn-container"),children:l("button",{class:()=>({"dcg-btn-slider":!0,"dcg-btn-blue":this.getMissingVariables().length===1,"dcg-base-case-btn":this.getMissingBaseCases().length>0,"dcg-btn-light-gray":this.getMissingVariables().length!==1}),onTap:t=>this.onCreateSlider(t,[e]),children:l(dt,{config:this.const({}),latex:()=>e})})})})}),l(Fbe,{predicate:()=>this.getMissingVariables().length>1,children:()=>l("div",{class:Ul.const("dcg-slider-btn-container dcg-all"),children:l("button",{class:Ul.const("dcg-btn-slider dcg-btn-blue"),onTap:e=>this.onCreateSlider(e,this.getMissingVariables()),children:()=>this.controller.s("graphing-calculator-button-slider-add-all-variables")})})})]})]})}getPromptMsg(){return this.getMissingBaseCases().length>0?this.controller.s("graphing-calculator-label-add-base-case"):this.controller.s("graphing-calculator-label-add-slider")}onCreateSlider(e,t){var o,i,n;this.model.type==="ticker"?this.controller.dispatch({type:"create-sliders-for-ticker",variables:t}):this.controller.dispatch({type:"create-sliders-for-item",id:this.model.id,variables:t}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:(n=(i=(o=this.props).restoreFocusLocation)==null?void 0:i.call(o))!=null?n:{type:"expression",id:this.model.id}})}getMissingBaseCases(){return this.model.type!=="expression"?[]:th(this.model)}getMissingVariables(){if(this.props.missingVariables)return this.props.missingVariables().slice(0,yp);let e=this.getMissingBaseCases();return e.length>0?e:(this.model.type==="ticker"?O0(this.model):K0(this.model)).slice(0,yp)}};function zJ(r){let{scaleFactor:e}=r;return{xmin:-e,xmax:+e,ymin:-.5,ymax:1.5}}function Nbe(r,e){let{width:t,height:o}=e,{xmin:i,xmax:n,ymin:a,ymax:s}=zJ(r),c=t/(n-i),d=-o/(s-a),p=-i*c,u=o-a*d;return{Tx:p,Sx:c,Ty:u,Sy:d}}function qJ(r){let{width:e,height:t}=r,{Tx:o,Sx:i,Ty:n,Sy:a}=Nbe(r,{width:e,height:t}),{xmin:s,xmax:c}=zJ(r),d=Z=>Z*i+o,p=Z=>Z*a+n,u="",g="dcg-confidence-diagram-line",h="dcg-confidence-diagram-minor-tick";function b(Z,ee=g){return`<polyline points="${Z.map(ue=>ue.toFixed(2)).join(",")}" class="${ee}"/>
`}let{min:v,max:T,pointEstimate:E,standardError:I,scaleFactor:_}=r,C=I,D=Math.max((v-E)/C,-2*_),P=Math.min((T-E)/C,2*_),F=D<-_,N=P>_,Y=ho(v),z=ho(T);F&&Y&&(Y=v===-1/0?"\u2190 \u221E":`\u2190 ${Y}`),N&&z&&(z=T===1/0?"\u221E \u2192":`${z} \u2192`),u+=b([d(s),p(0),d(c),p(0)]),u+=b([d(0),p(-.15),d(0),p(.15)]);let X=Math.ceil(_)+1;for(let Z=-X;Z<=X;Z++)u+=b([d(Z),p(-.05),d(Z),p(.05)],h);let q=.5;u+=b([d(D),p(q),d(P),p(q)]),u+=b([d(D),p(q-.04),d(D),p(q+.04)]),u+=b([d(P),p(q-.04),d(P),p(q+.04)]);let S="dcg-anchor-center",A="dcg-anchor-left",O="dcg-anchor-right",B=F?-_*.95:D,V=N?_*.95:P,K=V-B<3,{pointEstimateLabel:oe}=r;if(Y){let Z=D/-_>.68,ee=Z?-_*.95:B,ue=Z?O:K?A:S;v===-1/0&&(ue="dcg-anchor-right dcg-symbol-font"),u+=`<text x="${d(ee)}" y="${p(q+.08)}" class="${ue}">${Y}</text>`}if(z&&v!==T){let Z=P/_>.68,ee=Z?_*.95:V,ue=Z?A:K?O:S;T===1/0&&(ue="dcg-anchor-left dcg-symbol-font"),u+=`<text x="${d(ee)}" y="${p(q+.08)}" class="${ue}">${z}</text>`}return oe&&(u+=`<text x="${d(0)}" y="${p(-.43)}" class="${S}">${oe}</text>`),u}var{If:Gk}=Sa.Components,F1=class extends Sa.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.model=this.props.model()}getConfidenceLevel(){var e,t;return(t=(e=this.model.inference.confidence)==null?void 0:e.confidenceLevel)!=null?t:"0.95"}setConfidenceLevel(e){return this.controller.dispatch({type:"set-inference-object-data",id:this.model.id,update:{confidence:{confidenceLevel:e}}})}confidenceLevelHasError(){return this.controller.inferenceInputValueHasError(this.model.id,"confidenceLevel")}isConfidenceEditable(){return ea(this.model)}missingConfidenceLevelVariables(){var t;let e=this.controller.getInferenceUIConfidenceLevelExpression(this.model.id);return((t=e==null?void 0:e.formula.variables)!=null?t:[]).map(o=>__dcg_shared_module_exports__['vb'](o))}shouldShowSliderPromptForConfidenceLevel(){return this.missingConfidenceLevelVariables().length>0}id(){return this.model.id}template(){return x("div",{class:()=>({"dcg-inference-footer_expanded-section":!0,"dcg-inference-footer__confidence-interval":!0,"dcg-inference-ui-grid":!this.shouldShowSliderPromptForConfidenceLevel()}),children:[x("div",{class:Sa.const("dcg-inference-footer--confidence-values"),children:[l(Gk,{predicate:this.bindFn(this.isConfidenceEditable),children:()=>x("div",{class:Sa.const("dcg-exportable-evaluation--wrapper dcg-inference--confidence-input"),children:[l("label",{class:Sa.const("dcg-exportable-evaluation--label"),children:l(Xi,{content:()=>this.controller.s("graphing-calculator-label-inference-ui-confidence-level")})}),l(or,{latex:this.bindFn(this.getConfidenceLevel),ariaLabel:()=>this.controller.s("graphing-calculator-label-inference-ui-confidence-level"),hasError:this.bindFn(this.confidenceLevelHasError),handleLatexChanged:e=>this.setConfidenceLevel(e),handlePressedKey:(e,t)=>this.handlePressedKey(e,t),controller:this.props.controller,readonly:this.const(!1),...gh({controller:this.props.controller(),location:{type:"inference-footer",id:this.model.id,subtype:"mathquill-input",item:"confidenceLevel"}}),ariaPostLabel:()=>this.shouldShowSliderPromptForConfidenceLevel()?this.controller.s("graphing-calculator-narration-add-slider-prompt",{vars:ol(this.controller.getLanguage(),this.missingConfidenceLevelVariables().map(Mr))}):""})]})}),l(Gk,{predicate:()=>!this.shouldShowSliderPromptForConfidenceLevel(),children:()=>x("ul",{class:Sa.const("dcg-unstyled-list"),children:[l("li",{children:l(gd,{outputItem:this.const("confidenceLower"),id:this.bindFn(this.id),controller:this.props.controller})}),l("li",{children:l(gd,{outputItem:this.const("confidenceUpper"),id:this.bindFn(this.id),controller:this.props.controller})}),l(Gk,{predicate:()=>ea(this.model),children:()=>x("div",{children:[l("li",{children:l(gd,{outputItem:this.const("pointEstimate"),id:this.bindFn(this.id),controller:this.props.controller})}),l("li",{children:l(gd,{outputItem:this.const("standardError"),id:this.bindFn(this.id),controller:this.props.controller})})]})})]})}),l(Gk,{predicate:()=>this.shouldShowSliderPromptForConfidenceLevel(),children:()=>l(Is,{model:()=>this.model,controller:this.props.controller,missingVariables:()=>this.missingConfidenceLevelVariables(),restoreFocusLocation:this.const({type:"inference-footer",id:this.model.id,subtype:"mathquill-input",item:"confidenceLevel"})})})]}),l(Gk,{predicate:()=>ea(this.model)&&!this.shouldShowSliderPromptForConfidenceLevel(),children:()=>x("div",{class:Sa.const(" dcg-inference--confidence--diagram"),children:[l(cU,{controller:this.props.controller,id:()=>this.model.id}),l(oa,{anchor:()=>l(za,{}),anchorAriaLabel:()=>this.controller.s("graphing-calculator-label-inference-ui-export-confidence-diagram"),focusTrapping:this.const({itemNavigationKey:"tab"}),guid:()=>`exportable-confidence-diagram-${this.model.id}`,controlled:()=>({isOpen:this.props.controller().isPopoverOpen(`exportable-confidence-diagram-${this.model.id}`),setDropdownOpen:e=>this.props.controller().dispatch({type:"set-popover-open",guid:`exportable-confidence-diagram-${this.model.id}`,open:e})}),dropdownProps:this.const({position:this.const("bottom-left")}),dropdownOffset:()=>-15,manageFocus:this.const(ze({controller:this.props.controller(),location:{type:"inference-footer",id:this.model.id,subtype:"exportable-evaluation-dot-dot",item:"confidenceDiagram"}})),popoverBody:()=>x("div",{class:Sa.const("dcg-exportable-evaluation--popover"),children:[l("i",{class:Sa.const("dcg-coming-soon"),children:"Description coming soon..."}),l("button",{class:Sa.const("dcg-btn-light-gray"),onTap:()=>this.controller.dispatch({type:"export-inference-item-to-expression-list",item:"confidenceDiagram",id:this.model.id}),manageFocus:this.const(ze({controller:this.props.controller(),location:{type:"inference-footer",id:this.model.id,subtype:"exportable-evaluation-export-button",item:"confidenceDiagram"}})),children:"Export to expression list"})]})})]})})]})}handlePressedKey(e,t){let o=Qe.getFocusedMathquill();if(o){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter"&&this.missingConfidenceLevelVariables().length>0&&this.controller.areSlidersEnabled())return this.controller.dispatch({type:"create-sliders-for-item",id:this.model.id,variables:this.missingConfidenceLevelVariables().slice(0,yp),doNotChangeFocus:!0});o.keystroke(e,t),this.setConfidenceLevel(o.latex())}}},cU=class extends Sa.View{constructor(){super(...arguments),this.controller=this.props.controller()}getScaleFactor(){let e=this.controller.getInferenceOutputValueById(this.props.id(),"dof");if(e!==void 0){if(e<=1)return 63;if(e<=2)return 12;if(e<=3)return 6;if(e>3&&e<13)return 4.5;if(e>=13)return 4}return 3}willUnmountSVG(){this.svgElement=void 0,this.lastSVGInputs=void 0}renderSVGElement(){var h,b,v,T;if(!this.svgElement)return;let e=this.svgElement,t="clientWidth"in e?e.clientWidth:0,o="clientHeight"in e?e.clientHeight:0,i=this.props.id(),n=E=>this.controller.getInferenceOutputValueById(i,E),a=(h=n("confidenceLower"))!=null?h:-1,s=(b=n("confidenceUpper"))!=null?b:1,c=(v=n("pointEstimate"))!=null?v:0,d=(T=n("standardError"))!=null?T:1,p=ho(c),u=this.getScaleFactor(),g=t&&o?{min:a,max:s,pointEstimate:c,standardError:d,pointEstimateLabel:p,scaleFactor:u,width:t,height:o}:void 0;__dcg_shared_module_exports__['db'](g,this.lastSVGInputs)||(this.lastSVGInputs=g,this.svgElement.innerHTML=`<svg>${g?qJ(g):""}</svg>`)}didUpdate(){this.renderSVGElement()}didMountSVG(e){this.svgElement=e,this.renderSVGElement()}template(){return l("div",{class:Sa.const("dcg-inference--confidence--diagram--svg"),inert:Sa.const(!0),willUnmount:()=>this.willUnmountSVG(),didMount:e=>this.didMountSVG(e),"aria-hidden":Sa.const("true")})}};var Br=__dcg_shared_module_exports__['e'](j());var{If:dU,Switch:Ube,IfElse:Ybe}=Br.Components,pU=r=>{var e,t;return(e=r.formula.distribution_spec)!=null&&e.discrete?"p":(t=r.cdf.compute)!=null?t:"p"},fh=class extends Br.View{constructor(){super(...arguments),this.model=this.props.model(),this.controller=this.props.controller()}template(){return l("span",{"dcg-evaluation-item":this.props.item,children:Ybe(()=>this.getType()==="input",{true:()=>l(or,{controller:this.props.controller,ariaLabel:this.bindFn(this.getAriaLabel),handleLatexChanged:this.bindFn(this.handleLatexChanged),handlePressedKey:this.bindFn(this.handlePressedKey),latex:this.bindFn(this.getLatex),hasError:this.bindFn(this.inputHasError),readonly:()=>this.controller.isItemReadonly(this.model.id),placeholder:this.bindFn(this.getPlaceholder),...gh({controller:this.props.controller(),location:{type:"distribution-footer",id:this.model.id,subtype:"mathquill-input",item:this.props.item()}})}),false:()=>l(G1,{outputValue:this.bindFn(this.getProvidedOrComputedValue),controller:this.props.controller,type:this.const("distribution-footer"),label:this.bindFn(this.getAriaLabel),id:()=>this.model.id,outputItem:this.props.item,error:this.bindFn(this.getOutputError)})})})}getType(){let e=pU(this.model);switch(this.props.item()){case"cdfMax":case"cdfMin":return e==="p"?"input":"output";case"pValue":return e==="p"?"output":"input"}}inputHasError(){switch(this.props.item()){case"cdfMin":return this.model.formula.cdf_min_valid===!1;case"cdfMax":return this.model.formula.cdf_max_valid===!1;case"pValue":return this.model.formula.cdf_p_valid===!1}}getOutputError(){return this.model.formula.cdf_error}getProvidedOrComputedValue(){switch(this.props.item()){case"cdfMin":return this.model.formula.cdf_min;case"cdfMax":return this.model.formula.cdf_max;case"pValue":return this.model.formula.cdf_p}}getLatex(){switch(this.props.item()){case"cdfMin":return C7(this.model);case"cdfMax":return T7(this.model);case"pValue":return this.model.cdf.p||""}}getAriaLabel(){switch(this.props.labelKey()){case"lower":return this.controller.s("graphing-calculator-narration-cdf-minimum");case"upper":return this.controller.s("graphing-calculator-narration-cdf-maximum");case"p":return this.controller.s("graphing-calculator-narration-distributions-ui-p-value")}}getPlaceholder(){switch(this.props.item()){case"cdfMin":return ho(this.model.formula.cdf_min_default,3);case"cdfMax":return ho(this.model.formula.cdf_max_default,3);case"pValue":return ho(this.model.formula.cdf_p_default,3)}}handleLatexChanged(e){switch(this.props.item()){case"cdfMin":return this.controller.dispatch({type:"set-cdf-props",id:this.model.id,props:{min:e,p:""}});case"cdfMax":return this.controller.dispatch({type:"set-cdf-props",id:this.model.id,props:{max:e,p:""}});case"pValue":return this.controller.dispatch({type:"set-cdf-props",id:this.model.id,props:{p:e,min:"",max:""}})}}handlePressedKey(e,t){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter"){this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});return}let o=Qe.getFocusedMathquill();if(!o)return;o.keystroke(e,t);let i=o.latex();i!==this.model.latex&&this.handleLatexChanged(i)}},pA=class extends Br.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.props.model().id,this.toggleGuid=__dcg_shared_module_exports__['jb']("dcg-difference--cdf-toggle")}showCDF(){return Hv(this.model)}template(){return x("div",{class:Br.const("dcg-distribution-footer-view"),tapboundary:Br.const("true"),handleEvent:Br.const("true"),children:[l(dU,{predicate:()=>f3(this.model),children:()=>l("div",{class:Br.const("dcg-inference-footer__section-container"),role:Br.const("group"),"aria-labelled-by":this.const(this.toggleGuid),children:x("button",{"aria-expanded":this.bindFn(this.showCDF),class:()=>({"dcg-inference-footer_section-title":!0,"dcg-unstyled-button":!0,"dcg-inference-footer_section-open":this.showCDF()}),onTap:()=>this.controller.dispatch({type:"set-cdf-props",id:this.model.id,props:{show:!this.showCDF()}}),id:this.const(this.toggleGuid),children:[l("i",{class:Br.const("dcg-icon-caret-down"),"aria-hidden":Br.const("true")}),()=>this.controller.s("graphing-calculator-button-cdf-footer-title")]})})}),l(dU,{predicate:this.bindFn(this.showCDF),children:()=>x("div",{class:Br.const("dcg-distribution-footer-view--cdf dcg-smaller-font"),children:[x("div",{class:Br.const("dcg-distribution-footer__toggles"),children:[x("div",{class:Br.const("dcg-distribution-footer__region-toggle"),children:[l("div",{class:Br.const("dcg-expression-footer-title"),children:()=>this.controller.s("graphing-calculator-label-distributions-ui-region")}),l(ar,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-label-distributions-ui-region"),staticConfig:this.bindFn(this.getTailsOptions),theme:this.const("mini"),focusOnTap:this.const(!0)})]}),l(dU,{predicate:this.bindFn(this.isContinuousDistribution),children:()=>x("div",{class:Br.const("dcg-distribution-footer__direction-toggle"),children:[l("div",{class:Br.const("dcg-expression-footer-title"),children:()=>this.controller.s("graphing-calculator-label-distributions-ui-compute")}),l(ar,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-label-distributions-ui-compute"),staticConfig:this.bindFn(this.getDirectionOptions),theme:this.const("mini"),focusOnTap:this.const(!0)})]})})]}),x("div",{class:Br.const("dcg-distribution-footer-view--cdf-params"),children:[l("div",{class:Br.const("dcg-mq-math-mode dcg-distribution-footer__lhs"),children:x("div",{class:Br.const("dcg-mq-root-block"),children:[l("var",{children:"P"}),x("span",{class:Br.const("dcg-mq-non-leaf dcg-mq-bracket-container"),children:[l("span",{class:Br.const("dcg-sr-only"),children:()=>this.controller.s("shared-calculator-narration-keypad-key-left-paren")}),l("span",{class:Br.const("dcg-mq-scaled dcg-mq-bracket-l dcg-mq-paren"),didMount:e=>{e.innerHTML=`<svg preserveAspectRatio="none" viewBox="3 0 106 186" class="">
                          <path d="M85 0 A61 101 0 0 0 85 186 L75 186 A75 101 0 0 1 75 0" class="">
                          </path>
                        </svg>`}}),l("span",{class:Br.const("dcg-mq-bracket-middle dcg-mq-non-leaf"),children:l(Ube,{children:e=>{switch(e){case"inner":return x("div",{class:Br.const("dcg-distribution-view--bounds"),children:[l(fh,{...this.props,item:this.const("cdfMin"),labelKey:()=>this.shouldFlipMinAndMax()?"upper":"lower"}),l(dt,{latex:()=>this.shouldFlipMinAndMax()?"\\ge x\\ge":"\\le x\\le",config:this.const({})}),l(fh,{...this.props,item:this.const("cdfMax"),labelKey:()=>this.shouldFlipMinAndMax()?"lower":"upper"})]});case"outer":return x("div",{class:Br.const("dcg-distribution-view--bounds"),children:[l(dt,{latex:()=>this.shouldFlipMinAndMax()?"x\\ge":"x\\le",config:this.const({})}),l(fh,{...this.props,item:this.const("cdfMin"),labelKey:()=>this.shouldFlipMinAndMax()?"upper":"lower"}),l("span",{class:Br.const("dcg-distribution-view__or"),children:()=>this.controller.raw("or")}),l(dt,{latex:()=>this.shouldFlipMinAndMax()?"x\\le":"x\\ge",config:this.const({})}),l(fh,{...this.props,item:this.const("cdfMax"),labelKey:()=>this.shouldFlipMinAndMax()?"lower":"upper"})]});case"left":return x("div",{class:Br.const("dcg-distribution-view--bounds"),children:[l(dt,{latex:this.const("x\\le"),config:this.const({})}),l(fh,{...this.props,item:this.const("cdfMin"),labelKey:this.const("upper")})]});case"right":return x("div",{class:Br.const("dcg-distribution-view--bounds"),children:[l(dt,{latex:this.const("x \\ge"),config:this.const({})}),l(fh,{...this.props,labelKey:this.const("lower"),item:this.const("cdfMin")})]});default:return l("div",{})}}},()=>nk(this.model))}),l("span",{class:Br.const("dcg-sr-only"),children:()=>this.controller.s("shared-calculator-narration-keypad-key-right-paren")}),l("span",{class:Br.const("dcg-mq-scaled dcg-mq-bracket-r dcg-mq-paren"),didMount:e=>{e.innerHTML=`<svg preserveAspectRatio="none" viewBox="3 0 106 186" class="">
                          <path d="M24 0 A61 101 0 0 1 24 186 L34 186 A75 101 0 0 0 34 0" class=""></path>
                        </svg>`}})]})]})}),x("div",{class:Br.const("dcg-distribution-footer__rhs"),children:[l("span",{class:Br.const("dcg-distribution-footer__equals"),children:l(dt,{latex:this.const("="),config:this.const({})})}),l(fh,{...this.props,item:this.const("pValue"),labelKey:this.const("p")})]})]})]})})]})}shouldFlipMinAndMax(){return this.model.formula.cdf_max!==void 0&&this.model.formula.cdf_min!==void 0&&this.model.formula.cdf_max<this.model.formula.cdf_min}setEditDirection(e){if(e==="p"){let t=!!this.model.cdf.p&&!this.model.cdf.min&&!this.model.cdf.max;this.controller.dispatch({type:"set-cdf-props",id:this.model.id,props:t?{min:ho(this.model.formula.cdf_min,6),max:ho(this.model.formula.cdf_max,6),compute:"p"}:{compute:"p"}})}else{let t=!this.model.cdf.p&&(!!this.model.cdf.min||!!this.model.cdf.max);this.controller.dispatch({type:"set-cdf-props",id:this.model.id,props:t?{p:ho(this.model.formula.cdf_p,6),compute:"bounds"}:{compute:"bounds"}})}}getTailsSelection(){return nk(this.model)}setTails(e){let t=this.model.cdf.min,o=this.model.cdf.max,i=this.model.cdf.p;pU(this.model)==="bounds"?(t="",o=""):i="",this.controller.dispatch({type:"set-cdf-props",id:this.id,props:{tails:e,min:t,max:o,p:i}})}isContinuousDistribution(){var e;return!((e=this.model.formula.distribution_spec)!=null&&e.discrete)}getDirectionOptions(){return[{key:"p",label:()=>this.controller.s("graphing-calculator-label-distributions-ui-area")},{key:"bounds",label:()=>this.controller.s("graphing-calculator-label-distributions-ui-bounds")}].map(e=>({...e,selected:()=>pU(this.model)===e.key,onSelect:()=>this.setEditDirection(e.key)}))}getTailsOptions(){return[{key:"inner",label:()=>"Inner"},{key:"outer",label:()=>"Outer"},{key:"left",label:()=>"Left"},{key:"right",label:()=>"Right"}].map(e=>({...e,selected:()=>this.getTailsSelection()===e.key,onSelect:()=>this.setTails(e.key)}))}};var Ha=__dcg_shared_module_exports__['e'](j());var qa=__dcg_shared_module_exports__['e'](j());var Ub=__dcg_shared_module_exports__['e'](j());var Bbe=r=>r.toFixed(2);function HJ(r,e){let t=e==="button";return{xmin:-6,xmax:6,ymin:t?0:r==="tdist"?-.175:-.15,ymax:r==="normaldist"?.5:t?.4:.45}}function Kbe(r,e,t){let{width:o,height:i}=e,{xmin:n,xmax:a,ymin:s,ymax:c}=HJ(r,t),d=o/(a-n),p=-i/(c-s),u=-n*d,g=i-s*p;return{Tx:u,Sx:d,Ty:g,Sy:p}}function WJ(r){return jJ(r,{width:40,height:18},"button")}function jJ(r,e,t){let{width:o}=e,{min:i,max:n,tails:a,distributionSpec:s}=r;if(s===void 0)return"";let c=s.symbol;if(c!=="normaldist"&&c!=="tdist")return"";let{xmin:d,xmax:p}=HJ(c,t),{Tx:u,Sx:g,Ty:h,Sy:b}=Kbe(c,e,t),v=-u/g,T=(o-u)/g,E=1/g,I=A=>A*g+u,_=A=>A*b+h,C=[],D="",P=s.evaluatedParams;function F(A){switch(c){case"tdist":return __dcg_shared_module_exports__['Tb'](A,P[0]);case"normaldist":return __dcg_shared_module_exports__['Ub'](A,0,1)}}function N(A,O){O===void 0?C.push(I(A),_(0)+.5):C.push(I(A),_(O))}function Y(A){return`<polyline points="${C.map(O=>Bbe(O)).join(",")}" class="${A}"/>
`}if(t==="large"){for(let A=-5;A<=5;A++)C=[I(A),_(-.015),I(A),_(.015)],D+=Y("dcg-significance-diagram-minor-tick");C=[I(0),_(-.03),I(0),_(.03)],D+=Y("dcg-significance-diagram-major-tick"),C=[I(d),_(0),I(p),_(0)],D+=Y("dcg-significance-diagram-x-axis")}let z=t==="button"?"dcg-cdf-diagram-tails":"dcg-significance-diagram-tails";function X(){C=[0,h+1];for(let A=v;A<T;A+=E)A<i&&N(A,F(A));N(i,F(i)),N(i),D+=Y(z)}function q(A){C=[],N(A),N(A,F(A));for(let O=v;O<T;O+=E)O>A&&N(O,F(O));N(T),D+=Y(z)}let S=t==="button"?"dcg-cdf-diagram-curve":"dcg-significance-diagram-curve";C=[];for(let A=v;A<T;A+=E)N(A,F(A));if(D+=Y(S),a==="left"?X():a==="right"?q(i):a==="outer"&&(X(),q(n)),t==="large"){let A=r,{score:O,label:B,labelOrientation:V}=A;if(O){let K=__dcg_shared_module_exports__['Rb'](O,-6,6);D+=`<circle cx="${I(K)}" cy="${_(0)}" r="2.5" class="dcg-significance-diagram-dot" />`;let oe=0,Z=-.085;V==="below"&&(oe=-.3),V==="below_right"&&(oe=0),V==="below_left"&&(oe=-2),D+=`<text x="${I(K+oe)}" y="${_(Z)}" class="dcg-significance-diagram-label">${B}</text>`,a==="outer"&&Math.abs(O!=null?O:0)>.5&&Math.abs(O!=null?O:0)<=6&&(D+=`<circle cx="${I(-O)}" cy="${_(0)}" r="2.5" class="dcg-significance-diagram-outer-dot" />`,D+=`<text x="${I(-O-.5)}" y="${_(Z)}" class="dcg-significance-diagram-outer-label">\u2013 ${B}</text>`)}}return D}function XJ(r){let{width:e,height:t}=r;return jJ(r,{width:e,height:t},"large")}var Vk=__dcg_shared_module_exports__['e'](j());var uA=class extends Vk.View{template(){return l("div",{class:Vk.const("dcg-inference--significance--diagram--button"),willUnmount:()=>this.willUnmountSVG(),didMount:e=>this.didMountSVG(e),"aria-hidden":Vk.const("true")})}didMountSVG(e){this.svgElement=e,this.renderSVGElement()}willUnmountSVG(){this.svgElement=void 0,this.lastSVGInputs=void 0}renderSVGElement(){if(!this.svgElement)return;let e=this.props.min(),t=this.props.max(),o=this.props.tails();e=e===void 0?-1/0:__dcg_shared_module_exports__['Rb'](e,-1,1),t=t===void 0?1/0:__dcg_shared_module_exports__['Rb'](t,-1,1),e===void 0&&t===void 0&&(o=void 0);let i=this.props.distributionSpec(),n=i?{min:e,max:t,tails:o,distributionSpec:i}:void 0;__dcg_shared_module_exports__['db'](n,this.lastSVGInputs)||(this.lastSVGInputs=n,this.svgElement.innerHTML=`<svg>${n?WJ(n):""}</svg>`)}didUpdate(){this.renderSVGElement()}};var N1=class extends Ub.View{constructor(){super(...arguments),this.controller=this.props.controller()}getDistributionSpec(){let e=this.props.id(),t=wg(this.controller.getItemModel(e));switch(t){case"t":let o=this.controller.getInferenceOutputValueById(e,"dof");return{symbol:"tdist",evaluatedParams:[o!=null?o:1,0,1]};case"zprop":case"z":return{symbol:"normaldist",evaluatedParams:[0,1]};case void 0:return;default:throw new Error(`Unexpected inferenceType ${t}`)}}getMin(){let e=wg(this.controller.getItemModel(this.props.id()));if(!e)return;let t=this.controller.getInferenceOutputValueById(this.props.id(),e!=null&&e.startsWith("z")?"z":"t");if(t!==void 0)return this.props.tails()==="outer"?-Math.abs(t):t}getMax(){let e=wg(this.controller.getItemModel(this.props.id()));if(!e)return;let t=this.controller.getInferenceOutputValueById(this.props.id(),e!=null&&e.startsWith("z")?"z":"t");if(t!==void 0)return this.props.tails()==="outer"?Math.abs(t):t}template(){return l(uA,{distributionSpec:this.bindFn(this.getDistributionSpec),min:this.bindFn(this.getMin),max:this.bindFn(this.getMax),tails:this.props.tails})}},hA=class extends Ub.View{init(){this.controller=this.props.controller()}getDistributionSpec(){let e=this.props.id(),t=wg(this.controller.getItemModel(e));switch(t){case"t":let o=this.controller.getInferenceOutputValueById(e,"dof");return{symbol:"tdist",evaluatedParams:[o!=null?o:1,0,1]};case"zprop":case"z":return{symbol:"normaldist",evaluatedParams:[0,1]};case void 0:return;default:throw new Error(`Unexpected inferenceType ${t}`)}}getDistributionData(){var h,b;let e=this.props.id(),t=this.controller.getItemModel(e),i=((h=wg(t))!=null?h:"z").startsWith("z")?"z":"t",n=this.controller.getInferenceObjectData(e),a=this.controller.getInferenceOutputValueById(e,i),s=i==="t"?this.controller.getInferenceOutputValueById(e,"dof"):void 0,c=(b=n==null?void 0:n.significance)==null?void 0:b.tails;(n==null?void 0:n.significance)===void 0&&(t==null?void 0:t.type)==="expression"&&vp(t)&&(c="outer"),(a===void 0||i==="t"&&s===void 0)&&(c=void 0);let d=`${i}*`,p="below";a!==void 0&&a<-6?(d=`\u2190 ${i}*`,p="below_right"):a&&a>6&&(d=`${i}* \u2192`,p="below_left");let u=a,g=a;return a!==void 0&&c==="outer"&&(u=-Math.abs(a),g=Math.abs(a)),u!=null||(u=-1),g!=null||(g=1),{min:u,max:g,tails:c,score:a,label:d,labelOrientation:p}}didMountSVG(e){this.svgElement=e,this.renderSVGElement()}willUnmountSVG(){this.svgElement=void 0,this.lastSVGInputs=void 0}renderSVGElement(){if(!this.svgElement)return;let e=this.getDistributionSpec(),t=this.getDistributionData(),{min:o,max:i,tails:n,score:a,label:s,labelOrientation:c}=t,d="clientWidth"in this.svgElement?this.svgElement.clientWidth:0,p="clientHeight"in this.svgElement?this.svgElement.clientHeight:0,u=e&&d&&p?{min:o,max:i,tails:n,score:a,label:s,labelOrientation:c,distributionSpec:e,width:d,height:p}:void 0;__dcg_shared_module_exports__['db'](u,this.lastSVGInputs)||(this.lastSVGInputs=u,this.svgElement.innerHTML=`<svg>${u?XJ(u):""}</svg>`)}didUpdate(){this.renderSVGElement()}template(){return l("div",{class:Ub.const("dcg-inference--significance--diagram--large"),inert:Ub.const(!0),willUnmount:()=>this.willUnmountSVG(),didMount:e=>this.didMountSVG(e),"aria-hidden":Ub.const("true")})}};var{If:Ok}=qa.Components,U1=class extends qa.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.model=this.props.model()}init(){this.controller=this.props.controller(),this.model=this.props.model()}getInferenceType(){var e;return(e=Ug(this.model))!=null?e:qv(this.model)}getSignificanceTest(){return this.model.inference.significance}setHypothesisLatex(e){this.controller.dispatch({type:"set-inference-object-data",id:this.model.id,update:{significance:{hypothesis:e}}})}hypothesisHasError(){return this.controller.inferenceInputValueHasError(this.model.id,"hypothesis")}getHypothesisLabel(){var e;return"H_0:\\ \\ "+((e=tI(this.model))!=null?e:"")+"="}showHypothesis(){return!vp(this.model)}id(){return this.props.model().id}isTTest(){return this.getInferenceType()==="ttest"}getScoreType(){let e=this.getInferenceType();return e==="zproptest"||e==="ztest"?"z":"t"}missingHypothesisVariables(){var t;let e=this.controller.getInferenceUIHypothesisExpression(this.model.id);return((t=e==null?void 0:e.formula.variables)!=null?t:[]).map(o=>__dcg_shared_module_exports__['vb'](o))}shouldShowSliderPromptForHypothesis(){return this.missingHypothesisVariables().length>0}template(){return x("div",{class:()=>({"dcg-inference-footer__significance-test":!0,"dcg-inference-footer_expanded-section":!0,"dcg-inference-ui-grid":!this.shouldShowSliderPromptForHypothesis()}),children:[x("div",{children:[l(Ok,{predicate:()=>this.showHypothesis(),children:()=>x("div",{class:qa.const("dcg-inference--prop-input dcg-inference--hypothesis-input"),children:[l("label",{children:l(dt,{latex:this.bindFn(this.getHypothesisLabel),config:this.const({})})}),l(or,{latex:()=>{var e,t;return(t=(e=this.getSignificanceTest())==null?void 0:e.hypothesis)!=null?t:""},ariaLabel:()=>this.controller.s("graphing-calculator-label-inference-ui-hypothesis"),hasError:this.bindFn(this.hypothesisHasError),handlePressedKey:(e,t)=>this.handlePressedKey(e,t),handleLatexChanged:e=>this.setHypothesisLatex(e),controller:this.props.controller,readonly:this.const(!1),...gh({controller:this.props.controller(),location:{type:"inference-footer",id:this.model.id,subtype:"mathquill-input",item:"hypothesis"}}),ariaPostLabel:()=>this.shouldShowSliderPromptForHypothesis()?this.controller.s("graphing-calculator-narration-add-slider-prompt",{vars:ol(this.controller.getLanguage(),this.missingHypothesisVariables().map(Mr))}):""})]})}),l(Ok,{predicate:()=>this.shouldShowSliderPromptForHypothesis(),children:()=>l(Is,{model:()=>this.model,controller:this.props.controller,missingVariables:()=>this.missingHypothesisVariables(),restoreFocusLocation:this.const({type:"inference-footer",id:this.model.id,subtype:"mathquill-input",item:"hypothesis"})})}),l(Ok,{predicate:()=>!this.shouldShowSliderPromptForHypothesis(),children:()=>x("div",{children:[l(ar,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-label-inference-ui-tails"),staticConfig:this.bindFn(this.getTailsOptions),theme:this.const("mini")}),l(Ok,{predicate:()=>this.isTTest(),children:()=>l(gd,{controller:this.props.controller,outputItem:this.const("dof"),id:()=>this.model.id})}),l(gd,{controller:this.props.controller,outputItem:this.bindFn(this.getScoreType),id:this.bindFn(this.id)}),l(gd,{controller:this.props.controller,outputItem:this.bindFn(this.getPValueType),id:this.bindFn(this.id)})]})})]}),l(Ok,{predicate:()=>!this.shouldShowSliderPromptForHypothesis(),children:()=>x("div",{class:qa.const("dcg-inference--significance--diagram"),children:[l(hA,{controller:this.props.controller,id:this.bindFn(this.id)}),l(oa,{anchor:()=>l(za,{}),anchorAriaLabel:()=>this.controller.s("graphing-calculator-label-inference-ui-export-significance-diagram"),focusTrapping:this.const({itemNavigationKey:"tab"}),guid:()=>`exportable-significance-diagram-${this.model.id}`,controlled:()=>({isOpen:this.props.controller().isPopoverOpen(`exportable-significance-diagram-${this.model.id}`),setDropdownOpen:e=>this.props.controller().dispatch({type:"set-popover-open",guid:`exportable-significance-diagram-${this.model.id}`,open:e})}),dropdownProps:this.const({position:this.const("bottom-left")}),dropdownOffset:()=>-15,manageFocus:this.const(ze({controller:this.props.controller(),location:{type:"inference-footer",id:this.model.id,subtype:"exportable-evaluation-dot-dot",item:"significanceDiagram"}})),popoverBody:()=>x("div",{class:qa.const("dcg-exportable-evaluation--popover"),children:[l("i",{class:qa.const("dcg-coming-soon"),children:"Description coming soon..."}),l("button",{class:qa.const("dcg-btn-light-gray"),onTap:()=>this.controller.dispatch({type:"export-inference-item-to-expression-list",item:"significanceDiagram",id:this.model.id}),manageFocus:this.const(ze({controller:this.props.controller(),location:{type:"inference-footer",id:this.model.id,subtype:"exportable-evaluation-export-button",item:"significanceDiagram"}})),children:"Export to expression list"})]})})]})})]})}getPValueType(){var e,t;switch((t=(e=this.controller.getInferenceObjectData(this.id()))==null?void 0:e.significance)==null?void 0:t.tails){case"left":return"pleft";case"right":return"pright";case"outer":default:return"p"}}getTailsOptions(){let e=this.props.model().id;return[{key:"left",label:()=>"Left",template:()=>x("div",{class:qa.const("dcg-significance-toggle-option"),children:[l(N1,{controller:this.props.controller,id:this.const(e),tails:this.const("left")}),l("div",{class:qa.const("dcg-significance-toggle-option__title"),children:()=>this.controller.s("graphing-calculator-text-distribution-tails-left")})]})},{key:"outer",label:()=>"Both",template:()=>x("div",{class:qa.const("dcg-significance-toggle-option"),children:[l(N1,{controller:this.props.controller,id:this.const(e),tails:this.const("outer")}),l("div",{class:qa.const("dcg-significance-toggle-option__title"),children:()=>this.controller.s("graphing-calculator-text-distribution-tails-both")})]})},{key:"right",label:()=>"Right",template:()=>x("div",{class:qa.const("dcg-significance-toggle-option"),children:[l(N1,{controller:this.props.controller,id:this.const(e),tails:this.const("right")}),l("div",{class:qa.const("dcg-significance-toggle-option__title"),children:()=>this.controller.s("graphing-calculator-text-distribution-tails-right")})]})}].map(t=>({...t,selected:()=>{var o,i,n;return((n=(i=(o=this.controller.getInferenceObjectData(e))==null?void 0:o.significance)==null?void 0:i.tails)!=null?n:"outer")===t.key},onSelect:()=>{this.controller.dispatch({type:"set-inference-object-data",id:e,update:{significance:{tails:t.key}}})}}))}handlePressedKey(e,t){let o=Qe.getFocusedMathquill();if(o){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter"&&this.missingHypothesisVariables().length>0&&this.controller.areSlidersEnabled())return this.controller.dispatch({type:"create-sliders-for-item",id:this.model.id,variables:this.missingHypothesisVariables().slice(0,yp),doNotChangeFocus:!0});o.keystroke(e,t),this.setHypothesisLatex(o.latex())}}};var{If:$J}=Ha.Components,gA=class extends Ha.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.model=this.props.model(),this.confidenceToggleGuid=__dcg_shared_module_exports__['jb']("dcg-inference--confidence-toggle"),this.significanceToggleGuid=__dcg_shared_module_exports__['jb']("dcg-inference--significance-toggle")}hasConfidenceInterval(){return!!this.model.inference.confidence.show}setHasConfidenceInterval(e){return e?this.controller.dispatch({type:"set-inference-object-data",id:this.model.id,update:{confidence:{show:!0}}}):this.controller.dispatch({type:"set-inference-object-data",id:this.model.id,update:{confidence:{show:!1}}})}setHasSignificanceTest(e){return e?this.controller.dispatch({type:"set-inference-object-data",id:this.model.id,update:{significance:{show:!0}}}):this.controller.dispatch({type:"set-inference-object-data",id:this.model.id,update:{significance:{show:!1}}})}hasSignificanceTest(){var e;return!!((e=this.model.inference.significance)!=null&&e.show)}template(){return x("div",{class:Ha.const("dcg-inference-ui dcg-inference-footer"),tapboundary:Ha.const("true"),handleEvent:Ha.const("true"),children:[x("div",{class:Ha.const("dcg-inference-footer__section-container"),role:Ha.const("group"),"aria-labelled-by":this.const(this.confidenceToggleGuid),children:[x("button",{class:()=>({"dcg-inference-footer_section-title":!0,"dcg-inference-footer_section-open":this.hasConfidenceInterval(),"dcg-unstyled-button":!0}),onTap:()=>this.setHasConfidenceInterval(!this.hasConfidenceInterval()),"aria-expanded":this.bindFn(this.hasConfidenceInterval),id:this.const(this.confidenceToggleGuid),children:[l("i",{class:Ha.const("dcg-icon-caret-down"),"aria-hidden":Ha.const("true")}),()=>this.controller.s("graphing-calculator-label-inference-ui-confidence-interval")]}),l($J,{predicate:this.bindFn(this.hasConfidenceInterval),children:()=>l(F1,{...this.props})})]}),x("div",{class:Ha.const("dcg-inference-footer__section-container"),role:Ha.const("group"),"aria-labelled-by":this.const(this.significanceToggleGuid),children:[x("button",{class:()=>({"dcg-inference-footer_section-title":!0,"dcg-inference-footer_section-open":this.hasSignificanceTest(),"dcg-unstyled-button":!0}),onTap:()=>this.setHasSignificanceTest(!this.hasSignificanceTest()),"aria-expanded":this.bindFn(this.hasSignificanceTest),id:this.const(this.significanceToggleGuid),children:[l("i",{class:Ha.const("dcg-icon-caret-down"),"aria-hidden":Ha.const("true")}),()=>this.controller.s("graphing-calculator-label-inference-ui-significance-test")]}),l($J,{predicate:this.bindFn(this.hasSignificanceTest),children:()=>l(U1,{...this.props})})]})]})}};var bh=__dcg_shared_module_exports__['e'](j());var{Input:zbe,IfElse:uU,IfDefined:qbe,If:JJ}=bh.Components,Yb=class extends bh.View{template(){return this.controller=this.props.controller(),x("div",{class:()=>({"dcg-label-visible":this.getShowLabel(),"dcg-label-input-visible":!this.getIsDisabled(),"dcg-label-container":!0,"dcg-do-blur":!0}),tapboundary:bh.const("true"),handleEvent:bh.const("true"),children:[uU(()=>{var e,t;return!!((t=(e=this.props).forceEnabled)!=null&&t.call(e))},{true:()=>l("span",{children:()=>this.controller.s("graphing-calculator-button-label")+":"}),false:()=>l(ft,{onChange:this.bindFn(this.onCheckboxInput),checked:this.bindFn(this.getShowLabel),children:()=>this.controller.s("graphing-calculator-button-label")+(this.getIsDisabled()?"":":")})}),uU(this.bindFn(this.hasEditableLabel),{true:()=>l("div",{class:bh.const("dcg-editable-mode-toggle"),children:l(ar,{theme:this.const("mini"),staticConfig:this.bindFn(this.getEditableLabelOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-editable-label-mode")})}),false:()=>uU(()=>{var e,t;return!!((t=(e=this.props).displayComputedValue)!=null&&t.call(e))},{false:()=>l(JJ,{predicate:()=>{var e,t;return!((t=(e=this.props).suppressInput)!=null&&t.call(e))},children:()=>l(JJ,{predicate:()=>!this.getIsDisabled(),children:()=>{var e;return l(zbe,{class:()=>({"dcg-label-input":!0,"dcg-readonly":this.getIsReadonly(),"dcg-disabled-editable-input":this.hasEditableLabel()}),disabled:this.bindFn(this.getIsReadonly),"aria-label":()=>this.controller.s("graphing-calculator-narration-label-text"),manageFocus:(e=this.props.manageInputFocus)!=null?e:()=>{},didMount:t=>{var o,i;this.inputNode=t,(i=(o=this.props).selectInputOnMount)!=null&&i.call(o)&&t.select()},"aria-disabled":()=>this.getIsDisabled()||this.hasEditableLabel()||this.getIsReadonly(),value:this.bindFn(this.getLabel),onInput:this.bindFn(this.onLabelInput)})}})}),true:()=>qbe(()=>{var e,t;return(t=(e=this.props).displayComputedValue)==null?void 0:t.call(e)},e=>l("div",{class:bh.const("dcg-computed-label-value"),children:l(dt,{latex:e,config:()=>this.controller.getMathquillConfig({})})}))})})]})}getEditableLabelOptions(){return[{key:"math",label:()=>this.controller.s("graphing-calculator-button-editable-math"),selected:()=>this.model().editableLabelMode===__dcg_shared_module_exports__['$d'].Math,onSelect:()=>this.setEditableLabelMode(__dcg_shared_module_exports__['$d'].Math)},{key:"text",label:()=>this.controller.s("graphing-calculator-button-editable-text"),selected:()=>this.model().editableLabelMode===__dcg_shared_module_exports__['$d'].Text,onSelect:()=>this.setEditableLabelMode(__dcg_shared_module_exports__['$d'].Text)}]}setEditableLabelMode(e){this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id(),editableLabelMode:e})}getIsReadonly(){return this.controller.isItemReadonly(this.model().id)}model(){return this.props.model()}id(){return this.model().id}getLabel(){return this.model().label||""}hasEditableLabel(){return Nv(this.model())}getShowLabel(){var e,t;return ws(this.model())&&!((t=(e=this.props).displayComputedValue)!=null&&t.call(e))}getIsDisabled(){var e,t;return(t=(e=this.props).forceEnabled)!=null&&t.call(e)||document.activeElement===this.inputNode?!1:this.getLabel().length===0&&!this.getShowLabel()}onLabelInput(e){let t=e;this.controller.dispatch({type:"set-item-label",id:this.id(),label:t}),this.controller.dispatch({type:"set-item-showlabel",id:this.id(),showLabel:!!t})}onCheckboxInput(){this.controller.dispatch({type:"set-item-showlabel",id:this.id(),showLabel:!this.getShowLabel()})}};var sm=__dcg_shared_module_exports__['e'](j());var{If:Hbe,For:ZJ,SwitchUnion:Wbe}=sm.Components,mA=class extends sm.View{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.parameterSuggestions=new O1(this.controller,this.model),this.id=this.model.id}template(){return Wbe(()=>this.parameterSuggestions.getSuggestionType(),{list:()=>l("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"}),children:l(ZJ,{each:()=>this.parameterSuggestions.getListOfParameters(),children:e=>l("span",{class:sm.const("dcg-parameter-name"),children:()=>this.getParamName(e)})})}),listWithDefault:()=>l("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"}),onTap:this.bindFn(this.fillInDefaults),children:l(ZJ,{each:()=>this.parameterSuggestions.getListOfParameters(),children:e=>x("span",{class:sm.const("dcg-parameter-name"),children:[()=>this.getParamName(e),l(Hbe,{predicate:()=>this.parameterSuggestions.shouldShowDefaultValue(e),children:()=>x("span",{class:sm.const("dcg-default-marker"),children:["= ",()=>this.parameterSuggestions.getDefaultValue(e)]})})]})})}),individual:()=>l("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"}),children:this.bindFn(this.getMissingRequiredParamText)}),none:()=>{}})}fillInDefaults(){let e=this.parameterSuggestions.getSpec();if(!e)return;let{symbol:t,span:o}=e,{input:i,start:n,end:a}=o,s=this.parameterSuggestions.getExtractedAndDefaultArgString(e),c=`\\operatorname{${t}}\\left(${s}\\right)`,d=`${i.slice(0,n)}${c}${i.slice(a)}`;this.controller.dispatch({type:"set-item-latex",id:this.id,latex:d}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}),this.controller.dispatch({type:"keypad/press-key",key:"Left"})}getMissingRequiredParamText(){let e=this.parameterSuggestions.missingRequiredParam();return e?this.controller.s("graphing-calculator-text-enter-pareneter",{param:this.getParamName(e)}):""}getParamName(e){switch(e){case"mean":return this.controller.s("graphing-calculator-text-parameter-name-mean");case"stdev":return this.controller.s("graphing-calculator-text-parameter-name-stddev");case"dof":return this.controller.s("graphing-calculator-text-parameter-name-dof");case"probsuccess":return this.controller.s("graphing-calculator-text-parameter-name-probsuccess");case"trials":return this.controller.s("graphing-calculator-text-parameter-name-trials");case"data":return this.controller.s("graphing-calculator-text-parameter-name-data");case"binwidth":return this.controller.s("graphing-calculator-text-parameter-name-binwidth");case"min":return this.controller.s("graphing-calculator-text-parameter-name-min");case"max":return this.controller.s("graphing-calculator-text-parameter-name-max");case"height":return this.controller.s("graphing-calculator-text-parameter-name-height");case"offset":return this.controller.s("graphing-calculator-text-parameter-name-offset");case"shift":return this.controller.s("graphing-calculator-text-parameter-name-shift");case"scale":return this.controller.s("graphing-calculator-text-parameter-name-scale");default:return e}}};var Op=__dcg_shared_module_exports__['e'](j());var Rk=class extends Op.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.id=this.props.id()}template(){return x("div",{class:Op.const("dcg-prompt-rename"),handleEvent:Op.const("true"),children:[()=>wt("graphing-calculator-label-rename"),l("span",{class:Op.const("dcg-btn-light-gray"),onTap:this.bindFn(this.handleRename),tabIndex:Op.const(0),role:Op.const("button"),children:l(dt,{latex:()=>`${this.getRenameIdentifierFrom()} \\to ${this.getRenameIdentifierTo()}`,config:this.const({}),children:l("span",{style:Op.const("pointer-events:none")})})}),l("span",{class:Op.const("dcg-reference-count"),children:()=>wt(this.getRenameIdentifierFolderId()!==void 0?"graphing-calculator-label-reference-count-in-folder":"graphing-calculator-label-reference-count",{count:__dcg_shared_module_exports__['Db'](this.getRenameCountOfChanges())})})]})}getRenameIdentifierFrom(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.from||""}getRenameIdentifierTo(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.to||""}getRenameCountOfChanges(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.countOfChanges||0}getRenameIdentifierFolderId(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e==null?void 0:e.folderId}handleRename(){let e={search:this.getRenameIdentifierFrom(),replace:this.getRenameIdentifierTo()},t=this.getRenameIdentifierFolderId();t===void 0?this.controller.dispatch({type:"rename-identifier-global",...e}):this.controller.dispatch({type:"rename-identifier-in-item",id:t,...e})}};var Ar=__dcg_shared_module_exports__['e'](j());var Rp=__dcg_shared_module_exports__['e'](j());var{If:jbe}=Rp.Components,fA=class extends Rp.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return l(jbe,{predicate:()=>this.controller.showResidualsZoomFitButton(this.model),children:()=>l("div",{class:Rp.const("dcg-residuals-zoom-view dcg-do-blur"),handleEvent:Rp.const(!0),children:l(Oe,{tooltip:this.bindFn(this.getZoomText),gravity:()=>"e",children:l("i",{onTap:this.bindFn(this.onZoom),role:Rp.const("button"),tabIndex:Rp.const("0"),"aria-label":this.bindFn(this.getZoomText),class:Rp.const("dcg-icon-zoom-fit"),manageFocus:this.const(ze({controller:this.controller,location:{type:"regression-output",id:this.props.model().id,parameter:"residual-zoom"}}))})})})})}getZoomText(){return this.controller.s("graphing-calculator-text-zoom-fit")}onZoom(e){this.controller.dispatch({type:"expression-zoom-fit-residuals",id:this.model.id,focusAfterTap:e.device==="keyboard"})}};var{If:lm,For:QJ,IfElse:Xbe}=Ar.Components,bA=class extends Ar.View{template(){return x("div",{class:Ar.const("dcg-parameter-warning dcg-text-selectable"),role:Ar.const("note"),children:[l("i",{class:Ar.const("dcg-icon-error"),"aria-hidden":Ar.const("true")}),"\xA0",()=>this.props.controller().s("graphing-calculator-text-regression-potentially-inaccurate-parameters"),"\xA0",l("a",{href:Ar.const("https://help.desmos.com/hc/en-us/articles/360042942771"),target:Ar.const("_blank"),children:()=>this.props.controller().s("graphing-calculator-link-learn-more")})]})}},Y1=class extends Ar.View{template(){return l(Oe,{tooltip:this.props.tooltip,gravity:this.const("s"),children:l("a",{class:Ar.const("dcg-expression-footer-title-help"),target:Ar.const("_blank"),href:this.props.helpURL,"aria-label":this.props.tooltip,children:l("i",{class:Ar.const("dcg-icon-question-sign"),"aria-hidden":Ar.const("true")})})})}},B1=class extends Ar.View{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,l("div",{class:Ar.const("dcg-regression-footer-view"),children:x("div",{class:Ar.const("dcg-handle-event"),handleEvent:Ar.const("true"),children:[l(lm,{predicate:()=>{var e,t;return this.hasParameterWarning()&&!!((t=(e=this.props).hideParameters)!=null&&t.call(e))},children:()=>l(bA,{...this.props})}),l(lm,{predicate:this.bindFn(this.getShouldSuggestLogMode),children:()=>l("div",{class:Ar.const("dcg-log-mode-toggle"),children:Xbe(()=>this.areLogModeRegressionsForced(),{true:()=>l("div",{class:Ar.const("dcg-action-log-mode-toggle dcg-no-hover-styling"),children:()=>this.controller.s("graphing-calculator-button-regression-log-mode")}),false:()=>x("div",{children:[l(ft,{class:this.const("dcg-action-log-mode-toggle dcg-log-mode-checkbox"),onChange:this.bindFn(this.onTapLogMode),checked:()=>this.getIsLogModeRegression(),children:()=>this.controller.s("graphing-calculator-button-regression-log-mode")}),l(Y1,{helpURL:this.const("https://help.desmos.com/hc/en-us/articles/204349605"),tooltip:()=>this.controller.s("graphing-calculator-label-regression-log-mode-help-tooltip")})]})})})}),l(lm,{predicate:()=>this.shouldShowParameters()&&Object.keys(this.getRegression().parameters).length>0,children:()=>l(hU,{controller:this.props.controller,id:this.const(this.id),regression:()=>this.getRegression()})}),x("div",{class:Ar.const("dcg-statistics"),role:Ar.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-statistics"),children:[x("div",{class:Ar.const("dcg-expression-footer-title"),children:[()=>this.controller.s("graphing-calculator-heading-regression-statistics"),l(lm,{predicate:this.bindFn(this.showRMSENotice),children:()=>l(Y1,{helpURL:this.const("https://help.desmos.com/hc/en-us/articles/202529129-What-is-RMSE-"),tooltip:()=>this.controller.s("graphing-calculator-label-regression-what-is-rmse-tooltip")})}),l(lm,{predicate:this.bindFn(this.showNegativeRSquaredWarning),children:()=>l(Y1,{helpURL:this.const("https://help.desmos.com/hc/en-us/articles/202529139-Why-am-I-seeing-a-negative-R-2-value-"),tooltip:()=>this.controller.s("graphing-calculator-label-regression-why-is-negative-tooltip")})})]}),l("div",{class:Ar.const("dcg-statistics-values"),children:l(QJ,{each:this.bindFn(this.getStatisticsSections),children:e=>{let t=e.value;return t===void 0?l("div",{children:l(Xi,{content:()=>this.controller.s("graphing-calculator-text-undefined-parameter",{parameter:"`"+e.type+"`"})})}):l("div",{class:()=>({"dcg-indented-r-value":e.type==="r"}),children:l(wa,{latex:()=>`\\operatorname{${e.type}}=`+Nb(t),ariaLabel:this.const(""),tabbable:this.const(!0),focusLocation:this.const({type:"regression-output",id:this.id,parameter:e.type}),controller:this.props.controller})})}},e=>e.type+":"+e.value)})]}),x("div",{role:Ar.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-residuals"),class:Ar.const("dcg-residuals"),children:[l("div",{class:Ar.const("dcg-expression-footer-title"),children:()=>this.controller.s("graphing-calculator-heading-regression-residuals")}),l(wa,{latex:this.bindFn(this.getResidualVariable),ariaLabel:this.const(""),tabbable:this.const(!0),focusLocation:this.const({type:"regression-output",id:this.id,parameter:this.getResidualVariable()}),controller:this.props.controller}),l(lm,{predicate:this.bindFn(this.getResidualSuggestionVisible),children:()=>l("button",{class:Ar.const("dcg-residual-suggestion dcg-action-plot-residual dcg-btn dcg-btn-light-gray"),role:Ar.const("button"),onTap:this.bindFn(this.onTapResidualsSuggestion),manageFocus:this.const(ze({controller:this.controller,location:{type:"regression-plot-residuals-button",id:this.model.id}})),children:()=>this.controller.s("graphing-calculator-button-regression-plot-residuals")})}),l(fA,{model:this.props.model,controller:this.props.controller})]}),l("div",{class:Ar.const("dcg-clear")}),l(lm,{predicate:()=>{var e,t;return this.hasParameterWarning()&&!((t=(e=this.props).hideParameters)!=null&&t.call(e))},children:()=>l(bA,{...this.props})})]})})}showNegativeRSquaredWarning(){let e=this.getStatisticsSections();return __dcg_shared_module_exports__['Ja'](e,t=>t.type==="R^2"&&t.value!==void 0&&t.value<0)}showRMSENotice(){let e=this.getStatisticsSections();return __dcg_shared_module_exports__['Ja'](e,t=>t.type==="RMSE")}getStatisticsSections(){var o,i,n,a,s,c;let e=[],t=this.getRegression().statistics;return t.RMSE!==void 0&&((i=(o=this.props).suppressRMSE)!=null&&i.call(o)?e.push({type:"R^2",value:void 0}):e.push({type:"RMSE",value:t.RMSE})),t.Rsquared!==void 0&&e.push({type:"R^2",value:t.Rsquared}),t.rsquared!==void 0&&e.push({type:"R^2",value:t.rsquared}),t.r!==void 0&&((a=(n=this.props).showRValue)==null?void 0:a.call(n))!=="never"?e.push({type:"r",value:t.r}):((c=(s=this.props).showRValue)==null?void 0:c.call(s))==="always"&&e.push({type:"r",value:void 0}),e}shouldShowParameters(){return!this.props.hideParameters||!this.props.hideParameters()}onTapResidualsSuggestion(){this.controller.dispatch({type:"plot-residuals",id:this.id})}onTapLogMode(){this.controller.dispatch({type:"toggle-logmode",id:this.id})}getRegression(){return this.props.regression()}getResidualVariable(){return this.getRegression().residualVariable||""}getResidualSuggestionVisible(){return this.getRegression().residualSuggestionId!==void 0}areLogModeRegressionsForced(){return this.controller.areLogModeRegressionsForced()}getShouldSuggestLogMode(){var e,t;return(t=(e=this.props).suppressLogModeCheckbox)!=null&&t.call(e)?!1:!!this.getRegression().shouldSuggestLogMode}hasParameterWarning(){return!!this.getRegression().parameterWarning}getIsLogModeRegression(){var e;return this.model.type==="expression"?!!this.model.isLogModeRegression:!!((e=this.model.regression)!=null&&e.isLogMode)}},hU=class extends Ar.View{init(){this.controller=this.props.controller(),this.id=this.props.id()}template(){return x("div",{class:Ar.const("dcg-parameters-container"),children:[x("div",{class:Ar.const("dcg-expression-footer-title"),children:[()=>this.controller.s("graphing-calculator-heading-regression-parameters"),l(lm,{predicate:()=>!this.props.regression().isLinear,children:()=>l(Y1,{helpURL:this.const("https://help.desmos.com/hc/en-us/articles/360042428612"),tooltip:()=>this.controller.s("graphing-calculator-label-regression-parameters-not-exact")})})]}),l("div",{role:Ar.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-parameters"),class:Ar.const("dcg-parameters"),children:l(QJ,{each:()=>Object.keys(this.props.regression().parameters),children:e=>l(wa,{latex:()=>this.getParameterEquationLatex(e),ariaLabel:this.const(""),tabbable:this.const(!0),focusLocation:this.const({type:"regression-output",id:this.id,parameter:e}),controller:this.props.controller})})})]})}getParameterEquationLatex(e){return e+"="+cA(this.props.regression(),e)}};var sl=__dcg_shared_module_exports__['e'](j());var al=__dcg_shared_module_exports__['e'](j());Ut();Ut();var $be=0,Jbe=`guid_${Math.round(Math.random()*1e6)}_${new Date().getTime()}_`;function gU(r,e,t){var o;(o=r[e])==null||o.forEach(i=>i.callback(e,t))}function mU(r,e){e.split(" ").forEach(t=>{var n,a;let[o,i]=t.split(".");if(o&&i)r[o]=(n=r[o])==null?void 0:n.filter(s=>s.namespace!==i);else if(o)delete r[o];else if(i)for(let s in r)r[s]=(a=r[s])==null?void 0:a.filter(c=>c.namespace!==i)})}function fU(r,e,t){e.split(" ").forEach(o=>{var s;let[i,n]=o.split("."),a={namespace:n,callback:t};r[i]||(r[i]=[]),(s=r[i])==null||s.push(a)})}var Pi=class{constructor(){this.__eventObservers={},this.guid=Jbe+ ++$be}triggerEvent(e,t){gU(this.__eventObservers,e,t)}observeEvent(e,t){fU(this.__eventObservers,e,t)}unobserveEvent(e){mU(this.__eventObservers,e)}};var K1=class{constructor(){this._eventBus=new Pi;this.dragging=!1;this.guid=__dcg_shared_module_exports__['jb']("dragdrop-class")}_evt2pt(e){return{x:e.changedTouches[0].pageX-this._offsetPt.x,y:e.changedTouches[0].pageY-this._offsetPt.y}}_dispatch(e,t){if(this._destroyed)return;let o=this._evt2pt(t);this._eventBus.triggerEvent(e,{x:o.x,y:o.y,dx:o.x-this._startPt.x,dy:o.y-this._startPt.y,evt:t})}destroy(){re(document).off(`.${this.guid}`),this._destroyed=!0}startDrag(e,t={}){if(!this.dragging)return re(document).on(`dcg-tapmove.${this.guid}`,o=>{(o.originalEvent||o).preventDefault(),cancelAnimationFrame(this.frameThrottle),this.frameThrottle=requestAnimationFrame(()=>this.doDrag(o))}),re(document).on(`dcg-tapend.${this.guid} dcg-tapcancel.${this.guid}`,o=>this.endDrag(o)),this._offsetPt={x:0,y:0},t.origin&&(this._offsetPt={x:this._evt2pt(e).x-t.origin.x,y:this._evt2pt(e).y-t.origin.y}),this._startPt=this._evt2pt(e),this.dragging=!0,this._dispatch("onGrab",e)}doDrag(e){this.dragging&&this._dispatch("onDrag",e)}endDrag(e){this.dragging&&(re(document).off(`.${this.guid}`),this.doDrag(e),this.dragging=!1,this._dispatch("onDrop",e))}observeEvent(e,t){return this._eventBus.observeEvent(e,t)}};var{If:Zbe}=al.Components,Bb=class extends al.View{template(){return x("div",{class:()=>({"dcg-slider-interior":!0,"dcg-disable-slider":this.shouldDisableSlider()}),didMount:this.bindFn(this.didMountRoot),onTapStart:this.bindFn(this.onStartDrag),children:[x("div",{class:al.const("dcg-track"),children:[l("div",{class:al.const("dcg-ticks"),onMount:this.bindFn(this.didMountTickMarks)}),l("div",{class:al.const("dcg-graphic")})]}),l(Zbe,{predicate:this.bindFn(this.shouldShowZeroMarker),children:()=>l("div",{class:al.const("dcg-zeroMarker"),style:()=>({left:this.getZeroMarkerPercent()+"%"})})}),x("div",{class:()=>({"dcg-thumb":!0,"dcg-down":this.isDragging}),role:al.const("slider"),tabIndex:al.const("0"),disablescroll:al.const("true"),style:()=>({left:this.getThumbPercent()+"%"}),onKeyDown:this.bindFn(this.onKeyDown),"aria-label":this.props.ariaLabel,"aria-valuemin":()=>{var e,t;return(t=(e=this.props).ariaPercent)!=null&&t.call(e)?0:this.props.min()},"aria-valuemax":()=>{var e,t;return(t=(e=this.props).ariaPercent)!=null&&t.call(e)?100:this.props.max()},"aria-valuenow":()=>{var e,t;return(t=(e=this.props).ariaPercent)!=null&&t.call(e)?void 0:this.props.value()},"aria-valuetext":()=>{var e,t;return(t=(e=this.props).ariaPercent)!=null&&t.call(e)?`${Math.floor(this.getThumbPercent())}%`:void 0},manageFocus:this.buildFocusManager(),children:[l("div",{class:al.const("dcg-graphic")}),l("div",{class:al.const("dcg-center")})]})]})}willUnmount(){this.dragDrop.destroy()}didMountRoot(e){this.rootNode=e,this.dragDrop=new K1,this.isMounted=!0,this.dragDrop.observeEvent("onDrop",()=>{this.isDragging=!1,this.update(),this.props.onDrop&&this.props.onDrop()}),this.dragDrop.observeEvent("onGrab",()=>{this.isDragging=!0,this.update(),this.props.onGrab&&this.props.onGrab()}),this.dragDrop.observeEvent("onDrag",(t,o)=>{this.props.onDragUpdate(this.valueFromPixels(o.x))})}didMountTickMarks(e){this.tickMarksNode=e,this.renderTickMarks()}didUpdate(){this.renderTickMarks()}shouldDisableSlider(){return this.props.min()===this.props.max()}renderTickMarks(){if(!this.tickMarksNode)return;let e=this.props.step(),t=this.props.min(),o=this.props.max(),i;if(e===void 0?i=0:i=100*e/(o-t),i<3&&(i=0),i>100&&(i=0),isNaN(i)&&(i=0),this.lastTickMarksPercent===i)return;this.lastTickMarksPercent=i;let n="";if(i>0&&i<100)for(let a=i;a<100;a+=i)n+='<div class="dcg-tick" style="left:'+a+'%"></div>';this.tickMarksNode.innerHTML=n}shouldShowZeroMarker(){return this.props.min()<=0&&this.props.max()>=0}getZeroMarkerPercent(){let e=this.props.min(),t=this.props.max();return 100*(0-e)/(t-e)}getThumbPercent(){return 100*this.percentFromValue(this.props.value())}valueFromPixels(e){if(!this.isMounted)return 0;let t=this.props.min(),o=this.props.max(),i=this.rootNode.getBoundingClientRect().width,n=__dcg_shared_module_exports__['Rb'](e/i,0,1),a=t+(o-t)*n,s=(o-t)/i;return no(a-s,a+s)}percentFromValue(e){let t=this.props.min(),o=this.props.max();return __dcg_shared_module_exports__['Rb']((e-t)/(o-t),0,1)}pixelsFromValue(e){if(!this.isMounted)return 0;let t=this.percentFromValue(e);return this.rootNode.getBoundingClientRect().width*t}onKeyDown(e){switch(Pe(e)){case Tn:this.props.onUpPress&&(this.props.onUpPress(),e.preventDefault(),e.stopPropagation());break;case Mi:this.props.onDownPress&&(this.props.onDownPress(),e.preventDefault(),e.stopPropagation());break;case Yu:this.props.onEnterPress&&(this.props.onEnterPress(),e.preventDefault(),e.stopPropagation());break;case Wi:document.activeElement&&re(document.activeElement).trigger("blur");break;case np:this.props.onKeyboardUpdate("down"),e.preventDefault(),e.stopPropagation();break;case ap:this.props.onKeyboardUpdate("up"),e.preventDefault(),e.stopPropagation();break;case bg:this.props.onKeyboardUpdate("bigdown"),e.preventDefault(),e.stopPropagation();break;case fg:this.props.onKeyboardUpdate("bigup"),e.preventDefault(),e.stopPropagation();break;case Bu:this.props.onKeyboardUpdate("min"),e.preventDefault(),e.stopPropagation();break;case Wc:this.props.onKeyboardUpdate("max"),e.preventDefault(),e.stopPropagation();break}}onStartDrag(e){if(e.device==="keyboard"||!e.target)return;e.preventDefault(),Dr();let t={x:0,y:0};e.target.closest(".dcg-thumb")?t.x=this.pixelsFromValue(this.props.value()):t.x=e.changedTouches[0].clientX-this.rootNode.getBoundingClientRect().left,this.dragDrop.startDrag(e,{origin:t})}buildFocusManager(){return!this.props.onFocusedChanged||!this.props.isFocused?this.const(void 0):this.const({shouldBeFocused:this.props.isFocused,onFocusedChanged:this.props.onFocusedChanged})}};var md=__dcg_shared_module_exports__['e'](j());var{If:Qbe}=md.Components,Fk=class extends md.View{init(){this.controller=this.props.controller(),this.model=this.controller.getModel()}template(){return l("div",{class:md.const("dcg-slider_menu dcg-do-blur"),handleEvent:md.const("true"),didMount:e=>this.node=e,children:x("div",{class:md.const("dcg-editable-mathquill-container"),children:[l(Qbe,{predicate:()=>!this.shouldOnlyShowStep(),children:()=>x("span",{children:[l(or,{readonly:()=>this.controller.isItemReadonly(),latex:()=>this.model.slider.hardMin?this.model.slider.min:"",isFocused:()=>this.getFocusedInput()==="min",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-minimum"),brailleLabel:()=>this.controller.raw("sldrmin"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("min",e,t),hasError:()=>!XI(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("min",e,t),handleLatexChanged:e=>this.handleLatexChanged("min",e),dataLabelAttributeValue:this.const("slidermin")}),l("span",{class:md.const("dcg-interval-interior"),children:l(dt,{latex:this.bindFn(this.getDependentLatex),config:this.const({}),children:l("span",{})})}),l(or,{readonly:()=>this.controller.isItemReadonly(),latex:()=>this.model.slider.hardMax?this.model.slider.max:"",isFocused:()=>this.getFocusedInput()==="max",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-maximum"),brailleLabel:()=>this.controller.raw("sldrmax"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("max",e,t),hasError:()=>!$I(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("max",e,t),handleLatexChanged:e=>this.handleLatexChanged("max",e),dataLabelAttributeValue:this.const("slidermax")})]})}),x("span",{class:()=>({"dcg-slider-step-container":!this.shouldOnlyShowStep()}),children:[l("span",{class:md.const("dcg-slider-step-label"),"aria-hidden":md.const("true"),children:()=>this.controller.s("graphing-calculator-label-slider-step")}),l(or,{readonly:()=>this.controller.isItemReadonly(),latex:()=>this.model.slider.step,isFocused:()=>this.getFocusedInput()==="step",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-step"),brailleLabel:()=>this.controller.raw("sldrstep"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("step",e,t),hasError:()=>!JI(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("step",e,t),handleLatexChanged:e=>this.handleLatexChanged("step",e),dataLabelAttributeValue:this.const("sliderstep")})]})]})})}handlePressedKey(e,t,o){if(this.controller.canShowSliderThumb()&&!this.shouldOnlyShowStep()&&(t==="Esc"||t==="Enter")){this.controller.dispatchSetFocusLocation({type:"slider-thumb"});return}let i=Qe.getFocusedMathquill(),n=_c();if(t==="Left"||t==="Right"||t==="Down"||t==="Up"){let a;i?a=Qe.applyArrowKeyAndReturnIfWasAtBounds(i,t,o):n&&(n.selectionStart===0&&t==="Left"||n.selectionStart===n.value.length&&t==="Right"||t==="Up"||t==="Down")?a=!0:a=!1,a&&(o&&o.preventDefault(),t==="Left"&&!this.shouldOnlyShowStep()?e==="max"?this.controller.dispatchSetFocusLocation({type:"slider-limit",location:"min"}):e==="step"&&this.controller.dispatchSetFocusLocation({type:"slider-limit",location:"max"}):t==="Right"&&!this.shouldOnlyShowStep()?e==="min"?this.controller.dispatchSetFocusLocation({type:"slider-limit",location:"max"}):e==="max"&&this.controller.dispatchSetFocusLocation({type:"slider-limit",location:"step"}):t==="Down"?this.controller.dispatchSpecialKeyPressed("Down"):t==="Up"&&this.controller.dispatchSpecialKeyPressed("Up"));return}i&&(i.keystroke(t,o),this.handleLatexChanged(e,i.latex()))}shouldOnlyShowStep(){return this.model.slider.loopMode===__dcg_shared_module_exports__['Pd'].PLAY_INDEFINITELY}handleLatexChanged(e,t){e==="min"?this.dispatchMinLatexIfChanged(t):e==="max"?this.dispatchMaxLatexIfChanged(t):e==="step"&&this.dispatchStepLatexIfChanged(t)}handleFocusedChanged(e,t,o){t&&this.getFocusedInput()!==e?this.controller.dispatchSetFocusLocation({type:"slider-limit",location:e}):this.getFocusedInput()===e&&this.controller.getBrailleMode()==="none"&&(!o.relatedTarget||!this.node.contains(o.relatedTarget))&&this.controller.dispatchBlurFocusLocation({type:"slider-limit",location:e})}dispatchMinLatexIfChanged(e){this.controller.dispatchSetMinLatexIfChanged(e)}dispatchMaxLatexIfChanged(e){this.controller.dispatchSetMaxLatexIfChanged(e)}dispatchStepLatexIfChanged(e){this.controller.dispatchSetStepLatexIfChanged(e)}getDependentLatex(){let e=lb(this.model)||"";return" \\le "+__dcg_shared_module_exports__['vb'](e)+" \\le "}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="slider-limit"))return e.location}};function ko(r,e,t){let o=eye(r,e,t);Rr(r,o)}function Rr(r,e){if(r.focusLocation=e,!e||(e.type==="ticker"&&(r.getListModel().ticker.playing=!1,Ir(r.getListModel(),void 0)),e.type==="settings"||e.type==="generic-menu"||e.type==="editable-label"||e.type==="add-item-btn"||e.type==="add-expression-btn"||e.type==="add-note-btn"||e.type==="add-table-btn"||e.type==="add-folder-btn"||e.type==="add-ticker-btn"||e.type==="add-inference-btn"||e.type==="add-inference-wizard"||e.type==="add-image-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn"||e.type==="zoom-in-btn"||e.type==="zoom-restore-btn"||e.type==="search-expressions"||e.type==="replace-expressions"||e.type==="ticker"||e.type==="geo-token"||e.type==="geo-show-constructions-icon"||e.type==="geo-basic-tool"||e.type==="geo-basic-tool-menu-item"||e.type==="geo-construct-menu-existing-transformations"||e.type==="multi-select-more-icon"||e.type==="multi-select-construct-icon"||e.type==="multi-select-style-icon"||e.type==="multi-select-label-icon"||e.type==="geo-header-back-link"||e.type==="multi-select-show-hide-icon"||e.type==="new-transformation-number"||e.type==="label-points-icon"||e.type==="graph-paper"||e.type==="quest"||e.type==="global-mute-button"||e.type==="color-picker-option"||e.type==="multi-select-label-menu-label-input"||e.type==="multi-select-options-menu-item"))return;let t=r.getItemModel(e.id);if(e.type==="expression-menu"){Ir(r.getListModel(),void 0);return}else Ir(r.getListModel(),t);t&&t.type==="expression"&&fs(t,!1)}function eye(r,e,t){let o=r.getItemModel(e);if(!o)return;let i=r.isInEditListMode()||r.isItemReadonly(o.id);switch(o.type){case"expression":return{type:i?"readonly-expression":o.type,id:e};case"folder":case"text":return{type:o.type,id:e};case"table":{let a={row:1,column:0},s=!1;return t&&(typeof t=="object"&&"location"in t&&t.location==="cell"?a={row:t.row,column:t.column}:t==="end"?a={row:Xn(o),column:0}:t==="start"?a={row:0,column:0}:t==="container"&&(s=!0)),s?{type:"table-container",id:e}:{type:o.type,id:e,location:a}}case"image":return{type:o.type,id:e,location:"name"};default:return o}}function eZ(r){let e=r.getSelectedItem();if(e&&e.type==="expression"&&!e.readonly){ko(r,e.id);return}if(e&&e.type==="table"&&r.focusLocation&&!e.readonly)return;let t=r.getFirstFullyVisibleItem(),o=r.getListModel();for(;t&&(t.type!=="expression"||t.readonly);)t=F0(o,t.index);if(t){ko(r,t.id);return}let i=r.createItemModel({type:"expression",id:r.generateId(),color:r.getNextColor()});Dl(r.getListModel(),i),ko(r,i.id)}function Nk(r){let e=r.focusLocation;if(e&&!(e.type==="settings"||e.type==="generic-menu"||e.type==="editable-label"||e.type==="add-item-btn"||e.type==="add-expression-btn"||e.type==="add-note-btn"||e.type==="add-table-btn"||e.type==="add-ticker-btn"||e.type==="add-folder-btn"||e.type==="add-inference-btn"||e.type==="add-inference-wizard"||e.type==="add-image-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn"||e.type==="zoom-in-btn"||e.type==="zoom-restore-btn"||e.type==="search-expressions"||e.type==="replace-expressions"||e.type==="ticker"||e.type==="geo-token"||e.type==="geo-show-constructions-icon"||e.type==="geo-basic-tool"||e.type==="geo-basic-tool-menu-item"||e.type==="geo-construct-menu-existing-transformations"||e.type==="multi-select-more-icon"||e.type==="multi-select-construct-icon"||e.type==="multi-select-style-icon"||e.type==="multi-select-label-icon"||e.type==="geo-header-back-link"||e.type==="multi-select-show-hide-icon"||e.type==="new-transformation-number"||e.type==="label-points-icon"||e.type==="graph-paper"||e.type==="quest"||e.type==="global-mute-button"||e.type==="color-picker-option"||e.type==="multi-select-label-menu-label-input"||e.type==="multi-select-options-menu-item"))return r.getItemModel(e.id)}function z1(r,e,t){Rr(r,{type:"table",id:e,location:t})}var bU=class{canShowSliderThumb(){return this.getViewDeterminedBySliderState()!=="limits"}getViewDeterminedBySliderState(){if(this.isItemReadonly())return"thumb";let e=this.getModel();if(!XI(e)||!$I(e)||!JI(e)||e.slider.loopMode===__dcg_shared_module_exports__['Pd'].PLAY_INDEFINITELY)return"limits"}},yA=class extends bU{constructor(t,o){super();this.model=t;this.controller=o;this.getBrailleMode=this.controller.getBrailleMode.bind(this.controller);this.getSixKeyInput=this.controller.getSixKeyInput.bind(this.controller);this.getCapExpressionSize=this.controller.getCapExpressionSize.bind(this.controller);this.s=this.controller.s.bind(this.controller);this.raw=this.controller.raw.bind(this.controller);this.getTokenController=this.controller.getTokenController.bind(this.controller);this.isKeypadEnabled=this.controller.isKeypadEnabled.bind(this.controller);this.getMathquillConfig=this.controller.getMathquillConfig.bind(this.controller)}getModel(){return this.model}getView(){var i,n;if(this.controller.isInEditListMode())return"limits";let t=this.getViewDeterminedBySliderState();if(t)return t;if(((i=this.getFocusLocation())==null?void 0:i.type)==="slider-limit")return"limits";let o=this.controller.getFocusLocation();return((n=Nk(this.controller))==null?void 0:n.id)===this.model.id&&((o==null?void 0:o.type)==="expression"||(o==null?void 0:o.type)==="top-level-icon"||(o==null?void 0:o.type)==="readonly-expression")?"limits":"thumb"}isItemReadonly(){return this.controller.isItemReadonly(this.model.id)}getFocusLocation(){var o;let t=this.controller.getFocusLocation();if(t&&((o=Nk(this.controller))==null?void 0:o.id)===this.model.id)switch(t.type){case"slider-limit":case"slider-icon":case"slider-thumb":return t;default:t.type;return}}dispatchAdjustSliderByKeyboard(t){this.controller.dispatch({type:"adjust-slider-by-keyboard",id:this.model.id,adjustment:t})}dispatchAdjustSliderByDraggingThumb(t){this.controller.dispatch({type:"adjust-slider-by-dragging-thumb",id:this.model.id,target:t})}dispatchSetIsPlayingIfChanged(t){this.model.slider.isPlaying!==t&&this.controller.dispatch({type:"set-slider-isplaying",id:this.model.id,isPlaying:t})}dispatchSetIsDraggingIfChanged(t){this.model.sliderDragging!==t&&this.controller.dispatch({type:"set-slider-dragging",id:this.model.id,dragging:t})}dispatchSetMinLatexIfChanged(t){this.model.slider.min!==t&&this.controller.dispatch({type:"set-slider-minlatex",id:this.model.id,latex:t})}dispatchSetMaxLatexIfChanged(t){this.model.slider.max!==t&&this.controller.dispatch({type:"set-slider-maxlatex",id:this.model.id,latex:t})}dispatchSetStepLatexIfChanged(t){this.model.slider.step!==t&&this.controller.dispatch({type:"set-slider-steplatex",id:this.model.id,latex:t})}dispatchSetFocusLocation(t){this.controller.dispatch({type:"set-focus-location",location:{...t,id:this.model.id}})}dispatchBlurFocusLocation(t){this.controller.dispatch({type:"blur-focus-location",location:{...t,id:this.model.id}})}dispatchSpecialKeyPressed(t){let o=this.getFocusLocation();t==="Up"&&(o==null?void 0:o.type)==="slider-limit"?this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}}):this.controller.dispatch({type:"on-special-key-pressed",key:t})}dispatchClearSelection(){this.controller.dispatch({type:"set-none-selected"})}dispatchExpressionSizeExceeded(){this.controller.dispatch({type:"expression-size-exceeded"})}};var{If:rZ}=sl.Components,xA=class extends sl.View{init(){this.sliderController=new yA(this.props.model(),this.props.controller())}template(){return l(yU,{sliderController:this.const(this.sliderController)})}},yU=class extends sl.View{init(){this.controller=this.props.sliderController(),this.model=this.controller.getModel();let e=this.controller.getTokenController();e&&(this.tokenControllerGetter=this.const(e))}template(){return x("div",{class:sl.const("dcg-slider-container"),tapboundary:sl.const("true"),onKeyDown:e=>{Pe(e)==="Tab"&&!e.altKey&&!e.metaKey&&!e.ctrlKey&&(e.shiftKey?this.isSliderThumbFocused()&&(this.controller.isItemReadonly()||(this.controller.dispatchSetFocusLocation({type:"slider-limit",location:"step"}),e.preventDefault(),e.stopPropagation())):!e.shiftKey&&this.isSliderStepFocused()&&(this.controller.canShowSliderThumb()?this.controller.dispatchSetFocusLocation({type:"slider-thumb"}):this.controller.dispatchSetFocusLocation({type:"slider-icon"}),e.preventDefault(),e.stopPropagation()))},children:[l(rZ,{predicate:this.bindFn(this.shouldShowSlider),children:()=>x("div",{class:sl.const("dcg-do-blur dcg-slider"),handleEvent:sl.const("true"),children:[l("div",{class:sl.const("dcg-minLabel dcg-template-minlabelhtml"),role:sl.const("button"),"aria-label":this.bindFn(this.getMinAriaLabel),onTap:()=>this.onEditLimit("min"),children:l(dt,{latex:()=>qI(this.model),config:this.const({}),tokenController:this.tokenControllerGetter})}),l(Bb,{min:()=>Zs(this.model),max:()=>bc(this.model),step:()=>od(this.model),value:()=>Qs(this.model),ariaLabel:()=>this.controller.getBrailleMode()==="none"?'"'+lb(this.model)+'"':""+lb(this.model),onGrab:this.bindFn(this.onGrab),onDrop:this.bindFn(this.onDrop),onDragUpdate:this.bindFn(this.onDragUpdate),onKeyboardUpdate:this.bindFn(this.onKeyboardUpdate),onUpPress:()=>this.controller.dispatchSpecialKeyPressed("Up"),onDownPress:()=>this.controller.dispatchSpecialKeyPressed("Down"),onEnterPress:()=>this.controller.dispatchSpecialKeyPressed("Enter"),isFocused:this.bindFn(this.isSliderThumbFocused),onFocusedChanged:e=>{e?this.controller.dispatchSetFocusLocation({type:"slider-thumb"}):this.controller.dispatchBlurFocusLocation({type:"slider-thumb"})}}),l("div",{class:sl.const("dcg-maxLabel dcg-template-maxlabelhtml"),onTap:()=>this.onEditLimit("max"),role:sl.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-narration-slider-maximum")+" "+po(HI(this.model)),children:l(dt,{latex:()=>HI(this.model),config:this.const({}),tokenController:this.tokenControllerGetter})})]})}),l(rZ,{predicate:this.bindFn(this.shouldShowLimitInputs),children:()=>l(Fk,{controller:this.props.sliderController})})]})}getMinAriaLabel(){return this.controller.isItemReadonly()?this.controller.s("graphing-calculator-narration-slider-minimum")+" "+po(qI(this.model)):this.controller.s("graphing-calculator-narration-edit-slider-variable-limits",{variable:this.controller.getBrailleMode()==="none"?'"'+lb(this.model)+'"':""+lb(this.model)})}onGrab(){this.dispatchIsDraggingIfChanged(!0)}onDrop(){this.controller.dispatchClearSelection(),this.dispatchIsPlayingIfChanged(!1),this.dispatchIsDraggingIfChanged(!1)}onKeyboardUpdate(e){this.controller.dispatchAdjustSliderByKeyboard(e)}onDragUpdate(e){this.controller.dispatchAdjustSliderByDraggingThumb(e)}onEditLimit(e){this.controller.dispatchSetFocusLocation({type:"slider-limit",location:e})}dispatchIsPlayingIfChanged(e){this.controller.dispatchSetIsPlayingIfChanged(e)}dispatchIsDraggingIfChanged(e){this.controller.dispatchSetIsDraggingIfChanged(e)}shouldShowLimitInputs(){return this.controller.getView()==="limits"}shouldShowSlider(){return!this.shouldShowLimitInputs()}isSliderThumbFocused(){var e;return((e=this.controller.getFocusLocation())==null?void 0:e.type)==="slider-thumb"}isSliderMinFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-limit"&&e.location==="min")}isSliderStepFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-limit"&&e.location==="step")}};var fd=__dcg_shared_module_exports__['e'](j());var{For:tye}=fd.Components,Uk=class extends fd.View{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return l("div",{class:fd.const("dcg-stats-footer-container dcg-do-blur"),handleEvent:fd.const("true"),children:l("ul",{class:fd.const("dcg-unstyled-list"),children:l(tye,{each:this.bindFn(this.getValues),children:e=>{let t=this.controller.s(e.label);return x("li",{class:fd.const("dcg-value"),children:[l("div",{class:fd.const("dcg-row-header dcg-text-selectable"),children:()=>t}),l("div",{class:fd.const("dcg-evaluation"),children:l(wa,{latex:()=>e.value,ariaLabel:()=>t,tabbable:this.const(!0),focusLocation:this.const({type:"stats-output",id:this.id,parameter:e.parameter}),controller:this.props.controller,onKeypress:this.bindFn(this.handlePressedKey)})})]})}},e=>e.parameter+":"+e.label+":"+e.value)})})}getValues(){let e=Y9(this.model);return e?[{parameter:"min",label:"graphing-calculator-label-stats-minimum",value:this.getStatValue(e.min)},{parameter:"q1",label:"graphing-calculator-label-stats-first-quartile",value:this.getStatValue(e.q1)},{parameter:"median",label:"graphing-calculator-label-stats-median",value:this.getStatValue(e.median)},{parameter:"q3",label:"graphing-calculator-label-stats-third-quartile",value:this.getStatValue(e.q3)},{parameter:"max",label:"graphing-calculator-label-stats-maximum",value:this.getStatValue(e.max)}]:[]}handlePressedKey(e){let t=Pe(e);if(t)switch(t){case"Up":this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}),e.preventDefault();break;case"PageUp":case"PageDown":case"Down":case"Enter":this.controller.dispatch({type:"on-special-key-pressed",key:t}),e.preventDefault();break;case"Esc":Dr(),e.preventDefault();break}}getStatValue(e){var t;return(t=__dcg_shared_module_exports__['ub'](e,{...__dcg_shared_module_exports__['pb']}))!=null?t:""}};var ai=__dcg_shared_module_exports__['e'](j());var Yk=class extends ai.View{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return l("div",{class:ai.const("dcg-ttest-footer-container dcg-do-blur"),handleEvent:ai.const("true"),children:x("ul",{class:ai.const("dcg-unstyled-list"),children:[x("li",{class:ai.const("dcg-value"),role:ai.const("textbox"),"aria-readonly":ai.const("true"),tabIndex:ai.const("0"),"aria-label":()=>"Less than: "+this.getLessThan(),children:[l("div",{class:ai.const("dcg-operator"),children:l(dt,{config:this.const({}),latex:this.const("<")})}),l("div",{class:ai.const("dcg-evaluation"),children:l(dt,{config:this.const({}),latex:()=>this.getLessThan()})})]}),x("li",{class:ai.const("dcg-value"),role:ai.const("textbox"),"aria-readonly":ai.const("true"),tabIndex:ai.const("0"),"aria-label":()=>"Greater than: "+this.getGreaterThan(),children:[l("div",{class:ai.const("dcg-operator"),children:l(dt,{config:this.const({}),latex:this.const(">")})}),l("div",{class:ai.const("dcg-evaluation"),children:l(dt,{config:this.const({}),latex:()=>this.getGreaterThan()})})]}),x("li",{class:ai.const("dcg-value"),role:ai.const("textbox"),"aria-readonly":ai.const("true"),tabIndex:ai.const("0"),"aria-label":()=>"Not equal: "+this.getNotEqual(),children:[l("div",{class:ai.const("dcg-operator"),children:l(dt,{config:this.const({}),latex:this.const("\u2260")})}),l("div",{class:ai.const("dcg-evaluation"),children:l(dt,{config:this.const({}),latex:()=>this.getNotEqual()})})]})]})})}getLessThan(){let e=Vv(this.model);return e?__dcg_shared_module_exports__['mb'](e.lessThan,5):""}getGreaterThan(){let e=Vv(this.model);return e?__dcg_shared_module_exports__['mb'](e.greaterThan,5):""}getNotEqual(){let e=Vv(this.model);return e?__dcg_shared_module_exports__['mb'](e.notEqual,5):""}};var Zi=__dcg_shared_module_exports__['e'](j());var{SwitchUnion:rye,If:oZ}=Zi.Components,q1=class extends Zi.View{template(){return x("div",{class:Zi.const("dcg-toggle-container"),children:[x("div",{class:Zi.const("dcg-expression-footer-title"),children:[this.props.title,l(oZ,{predicate:()=>!!this.props.helpLink,children:()=>l("a",{"aria-label":()=>this.props.controller().s("account-shell-link-help"),class:Zi.const("dcg-expression-footer-title-help"),target:Zi.const("_blank"),href:this.props.helpLink,children:l("i",{class:Zi.const("dcg-icon-question-sign"),"aria-hidden":Zi.const("true")})})})]}),l(ar,{staticConfig:this.bindFn(this.getSegmentedControlOptions),ariaGroupLabel:this.props.title,disabled:this.bindFn(this.isReadonly),theme:this.const("mini"),minButtonWidth:this.const(65)})]})}isReadonly(){return this.props.controller().isItemReadonly(this.props.model().id)}getSegmentedControlOptions(){return this.props.options().map(e=>({key:e.name,label:()=>e.displayName,selected:()=>this.isSelected(e.name),onSelect:()=>{this.props.controller().dispatch({type:"set-visualization-prop",id:this.props.model().id,prop:this.props.vizProp(),value:e.name})}}))}isSelected(e){return rh(this.props.model(),this.props.vizProp())===e}},Bk=class extends Zi.View{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,l("div",{class:Zi.const("dcg-visualization-parameters-container dcg-do-blur"),tapboundary:Zi.const("true"),handleEvent:Zi.const("true"),children:l("div",{class:Zi.const("dcg-smaller-font"),children:rye(()=>this.getVisualizationType(),{boxplot:()=>x("div",{children:[l("div",{class:Zi.const("dcg-expression-footer-title"),children:()=>this.controller.s("graphing-calculator-heading-visual-parameters-display-properties")}),this.makeMQInput({prop:"axisOffset",siblingProps:["breadth"],default:"1",name:()=>this.controller.s("graphing-calculator-narration-visual-parameters-offset")}),this.makeMQInput({prop:"breadth",siblingProps:["axisOffset"],default:"1",name:()=>rh(this.model,"alignedAxis")==="y"?this.controller.s("graphing-calculator-narration-visual-parameters-width"):this.controller.s("graphing-calculator-narration-visual-parameters-height")}),l(ft,{checked:()=>!!rh(this.model,"showBoxplotOutliers"),disabled:()=>this.controller.isItemReadonly(this.model.id),onChange:this.bindFn(this.onToggleOutliers),children:l("span",{class:Zi.const("dcg-parameter-name"),children:()=>this.controller.s("graphing-calculator-button-visual-parameters-exclude-outliers")})})]}),dotplot:()=>l(oZ,{predicate:()=>H9(this.model),children:()=>x("div",{class:Zi.const("dcg-toggles-container"),children:[l(q1,{...this.props,vizProp:()=>"dotplotXMode",options:()=>[{name:"exact",displayName:this.controller.s("graphing-calculator-button-visual-parameters-exact")},{name:"bin",displayName:this.controller.s("graphing-calculator-button-visual-parameters-binned")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-x-values")}),l(q1,{...this.props,vizProp:()=>"binAlignment",options:()=>[{name:"center",displayName:this.controller.s("graphing-calculator-button-visual-parameters-center")},{name:"left",displayName:this.controller.s("graphing-calculator-button-visual-parameters-left")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment")})]})}),histogram:()=>x("div",{class:Zi.const("dcg-toggles-container"),children:[l(q1,{...this.props,vizProp:()=>"histogramMode",options:()=>[{name:"",displayName:this.controller.s("graphing-calculator-button-visual-parameters-count")},{name:"relative",displayName:this.controller.s("graphing-calculator-button-visual-parameters-relative")},{name:"density",displayName:this.controller.s("graphing-calculator-button-visual-parameters-density")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bar-heights"),helpLink:this.const("https://help.desmos.com/hc/en-us/articles/360022405991")}),l(q1,{...this.props,vizProp:()=>"binAlignment",options:()=>[{name:"center",displayName:this.controller.s("graphing-calculator-button-visual-parameters-center")},{name:"left",displayName:this.controller.s("graphing-calculator-button-visual-parameters-left")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment")})]}),none:()=>l("span",{})})})})}makeMQInput(e){return x("span",{children:[x("span",{class:Zi.const("dcg-parameter-name"),children:[e.name,":"]}),l(or,{latex:()=>this.getPropLatex(e),ariaLabel:e.name,placeholder:()=>e.default,isFocused:()=>this.isInputFocused(e.prop),hasError:()=>!K9(this.model,e.prop),handleFocusChanged:t=>this.handleFocusedChanged(e.prop,t),handlePressedKey:(t,o)=>this.handlePressedKey(t,o,e.prop),handleLatexChanged:t=>this.handleLatexChanged(e.prop,t),readonly:()=>this.controller.isItemReadonly(this.model.id),controller:this.props.controller})]})}handlePressedKey(e,t,o){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});let i=Qe.getFocusedMathquill();i&&(i.keystroke(e,t),this.handleLatexChanged(o,i.latex()))}isInputFocused(e){let t=this.controller.getFocusLocation();return!t||t.type!=="visualization-prop"||t.id!==this.id?!1:t.location===e}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"visualization-prop",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"visualization-prop",id:this.id,location:e}})}getPropLatex({prop:e}){let t=rh(this.model,e);return typeof t=="string"?t:""}handleLatexChanged(e,t){rh(this.model,e)!==t&&this.controller.dispatch({type:"set-visualization-prop",id:this.id,prop:e,value:t})}onToggleOutliers(){let e=rh(this.model,"showBoxplotOutliers");this.controller.dispatch({type:"set-visualization-prop",id:this.id,prop:"showBoxplotOutliers",value:!e})}getVisualizationType(){return bb(this.model)?Ng(this.model)?"boxplot":ih(this.model)?"dotplot":gb(this.model)?"histogram":"none":"none"}};var{If:oye,SwitchUnion:iye,For:nye}=Tc.Components,vA=class extends Tc.View{constructor(){super(...arguments),this.model=this.props.model(),this.controller=this.props.controller(),this.footers=[],this.suspendedFooters={}}init(){this.updateFootersCache()}id(){return this.model.id}getFooterComponents(){return this.footers}updateFootersCache(){let e=[];this.suspendedFooters={};for(let t of dA)this.hasFooterComponent(t)?e.push(t):(this.model.error||this.model.latex!==this.model.formula.evaluated_latex)&&!vs(this.model)&&KJ[t]&&this.footers.includes(t)&&(e.push(t),this.suspendedFooters[t]=!0);this.footers=e}isFooterSuspended(e){return!!this.suspendedFooters[e]}hasFooterComponent(e){return Lk[e](this.controller,this.model)}willUpdate(){this.updateFootersCache()}template(){return l(oye,{predicate:()=>this.getFooterComponents().length>0,children:()=>l("div",{class:this.getFooterClass(),children:l(nye,{each:()=>this.getFooterComponents(),children:e=>l(oA,{suspended:()=>this.isFooterSuspended(e),children:iye(()=>e,{regression:()=>l(B1,{model:this.props.model,controller:this.props.controller,regression:()=>this.props.model().formula.regression}),label:()=>l(Yb,{model:this.props.model,controller:this.props.controller}),slider:()=>l(xA,{model:this.props.model,controller:this.props.controller}),"alt-text":()=>l(P1,{model:this.props.model,controller:this.props.controller}),"slider-prompt":()=>l(Is,{model:this.props.model,controller:this.props.controller}),"braille-error":()=>x("div",{tabIndex:Tc.const(0),class:Tc.const("dcg-expression-braille-error"),role:Tc.const("button"),"aria-roledescription":Tc.const("error"),"aria-label":()=>this.controller.unpack(this.model.error),children:[l("i",{class:Tc.const("dcg-icon-error"),"aria-hidden":Tc.const("true")}),()=>this.controller.unpack(this.model.error)]}),domain:()=>l(Ek,{model:this.props.model,controller:this.props.controller}),evaluation:()=>l(Ik,{id:()=>this.props.model().id,controller:this.props.controller}),visualization:()=>l(Bk,{model:this.props.model,controller:this.props.controller}),"rename-prompt":()=>l(Rk,{controller:this.props.controller,id:this.bindFn(this.id)}),ttest:()=>l(Yk,{model:this.props.model,controller:this.props.controller}),stats:()=>l(Uk,{model:this.props.model,controller:this.props.controller}),inference:()=>l(gA,{model:this.props.model,controller:this.props.controller}),significance:()=>l(U1,{model:this.props.model,controller:this.props.controller}),confidence:()=>l(F1,{model:this.props.model,controller:this.props.controller}),distribution:()=>l(pA,{model:this.props.model,controller:this.props.controller}),"action-info":()=>l(Rb,{model:this.props.model,controller:this.props.controller}),"extend-to-3d":()=>l("div",{handleEvent:Tc.const("true"),children:l(ft,{onChange:t=>{this.controller.dispatch({type:"set-item-extend-to-3D",id:this.model.id,extendTo3D:t})},checked:()=>this.model.extendTo3D,class:this.const("dcg-extend-to-3d-checkbox"),children:()=>this.controller.s("graphing-calculator-label-extend-to-3d")})}),warning:()=>l(Pk,{controller:this.props.controller,warning:()=>sU(this.controller,this.model)}),"parameter-suggestions":()=>l(mA,{controller:this.props.controller,model:this.props.model})})})})})})}getFooterClass(){let e=!this.props.isFirstRender()&&!this.model.expressionTooComplex;return this.const({"dcg-expression-bottom":!0,"dcg-indent-in-folder":!0,"dcg-fadein-bottom":e})}};En();var Fp=__dcg_shared_module_exports__['e'](j());var H1=__dcg_shared_module_exports__['e'](j());var Kb=__dcg_shared_module_exports__['e'](j());var Ms=__dcg_shared_module_exports__['e'](j()),wA=class extends Ms.View{template(){return x("div",{class:Ms.const("dcg-slow-plotting-icon"),children:[l("div",{class:Ms.const("dcg-slow-plotting-icon__dot")}),l("div",{class:Ms.const("dcg-slow-plotting-icon__dot")}),l("div",{class:Ms.const("dcg-slow-plotting-icon__dot")}),l("div",{class:Ms.const("dcg-slow-plotting-icon__dot")}),l("div",{class:Ms.const("dcg-slow-plotting-icon__dot")}),l("div",{class:Ms.const("dcg-slow-plotting-icon__dot")}),l("div",{class:Ms.const("dcg-slow-plotting-icon__dot")}),l("div",{class:Ms.const("dcg-slow-plotting-icon__dot")}),l("div",{class:Ms.const("dcg-slow-plotting-icon__dot")}),l("div",{class:Ms.const("dcg-slow-plotting-icon__dot")}),l("div",{class:Ms.const("dcg-slow-plotting-icon__dot")})]})}};var{If:Kk}=Kb.Components,qo=class extends Kb.View{template(){return x("span",{class:()=>({"dcg-do-not-blur":!0,"dcg-forced-color-none":!0,"dcg-circular-icon":!0,"dcg-thick-outline":this.isThickOutline(),"dcg-white-icon":!!this.props.whiteIcon&&this.props.whiteIcon(),"dcg-hidden":this.isHidden(),"dcg-semi-transparent":this.props.semiTransparent&&this.props.semiTransparent(),"dcg-colored-icon":this.isColoredIcon(),"dcg-has-background-image":this.hasBackgroundImage(),[this.iconModifier()]:this.iconModifier().length>0}),style:this.bindFn(this.getIconStyle),children:[l(Kk,{predicate:this.bindFn(this.hasBackgroundImage),children:()=>l("span",{class:Kb.const("dcg-background-image"),style:()=>({"background-image":this.props.backgroundImage&&this.props.backgroundImage(),opacity:this.props.backgroundOpacity&&this.props.backgroundOpacity().toString()})})}),l(Kk,{predicate:()=>!!this.backgroundIcon(),children:()=>l("i",{class:()=>({[this.backgroundIcon()]:!0,"dcg-layered-icon":!0}),style:()=>({opacity:this.backgroundOpacity().toString()})})}),l(Kk,{predicate:()=>!!this.primaryIcon(),children:()=>l("i",{class:()=>({[this.primaryIcon()]:!0,"dcg-layered-icon":!0}),style:()=>({color:this.props.foregroundColor&&this.props.foregroundColor()})})}),l(Kk,{predicate:()=>this.props.iconType()==="loading",children:()=>l("span",{class:Kb.const("dcg-spinner")})}),l(Kk,{predicate:()=>this.props.iconType()==="slow-plotting",children:()=>l(wA,{})})]})}isColoredIcon(){return!this.isThickOutline()&&!this.isHidden()&&!this.hasBackgroundImage()&&this.props.iconType()!=="loading"}iconModifier(){if(!this.props.iconModifier)return"";switch(this.props.iconModifier()){case"medium":return"dcg-modifier-size-medium";case"large":return"dcg-modifier-size-large";case"small":return"dcg-modifier-size-small";case"rotated":return"dcg-modifier-rotated";case"fade-in":return"dcg-modifier-fade-in";case"none":return""}}getIconStyle(){let e=!this.isHidden()&&this.props.backgroundColor?nv(this.props.backgroundColor()):void 0;return e?{background:e}:{}}isHidden(){return this.props.iconType()==="hidden"}isThickOutline(){let e=this.props.iconType();return e==="folder"||e==="pause"||e==="play"||e==="fraction"||e==="action"||e==="metronome"||e==="sound"}hasBackgroundImage(){return!!this.props.backgroundImage&&!this.isHidden()&&!!this.props.backgroundImage()}primaryIcon(){let e=this.props.iconType();switch(e){case"sound":return"dcg-icon-sound-wave";case"folder":return"dcg-icon-folder";case"pause":return"dcg-icon-pause";case"play":return"dcg-icon-play";case"polygon-dashed":case"polygon-dashed-filled":return"dcg-icon-polygon-dashed";case"polygon-dotted":case"polygon-dotted-filled":return"dcg-icon-polygon-dotted";case"polygon-default":case"polygon-default-filled":return"dcg-icon-polygon-solid";case"graph-dashed":case"parametric-dashed-filled":return"dcg-icon-parametric-dashed";case"graph-dotted":case"parametric-dotted-filled":return"dcg-icon-parametric-dotted";case"graph-default":case"parametric-default-filled":return"dcg-icon-parametric-solid";case"movable-vertical":return"dcg-icon-move-vertical";case"movable-both":return"dcg-icon-move";case"movable-horizontal":return"dcg-icon-move-horizontal";case"point-open":return"dcg-icon-point-open";case"point-cross":return"dcg-icon-point-cross";case"point-diamond":return"dcg-icon-point-diamond";case"point-plus":return"dcg-icon-point-plus";case"point-square":return"dcg-icon-point-square";case"point-star":return"dcg-icon-point-star";case"point-triangle":return"dcg-icon-point-triangle";case"point-default":return"dcg-icon-point-closed";case"table-points":case"table-points-and-lines":return"dcg-icon-points";case"table-lines":return"dcg-icon-lines-solid";case"shaded-inequality":case"inequality":return"dcg-icon-shaded-inequality-dash";case"check":return"dcg-icon-check";case"none":case"background":case"hidden":case"polygon-none-filled":case"parametric-none-filled":case"loading":case"slow-plotting":return"";case"fraction":return"dcg-icon-fraction";case"boxplot":return"dcg-icon-boxplot";case"dotplot-cross":return"dcg-icon-dotplot-cross";case"dotplot-default":return"dcg-icon-dotplot-default";case"dotplot-open":return"dcg-icon-dotplot-open";case"histogram":return"dcg-icon-histogram";case"unfilled-distribution":case"filled-distribution":return"dcg-icon-distribution";case"action":return"dcg-icon-chevron-right";case"metronome":return"dcg-icon-metronome-2";case"arrow-right":return"dcg-icon-arrow-right";default:return e}}backgroundOpacity(){let e=this.backgroundIcon();return e==="dcg-icon-polygon-filled"||e==="dcg-icon-parametric-filled"||e==="dcg-icon-shaded-inequality-shade2"||e==="dcg-icon-distribution-fill"||e==="dcg-icon-histogram-fill"?.5:1}backgroundIcon(){let e=this.props.iconType();return e==="filled-distribution"?"dcg-icon-distribution-fill":e==="histogram"?"dcg-icon-histogram-fill":e==="polygon-dashed-filled"||e==="polygon-dotted-filled"||e==="polygon-default-filled"||e==="polygon-none-filled"?"dcg-icon-polygon-filled":e==="parametric-dashed-filled"||e==="parametric-dotted-filled"||e==="parametric-default-filled"||e==="parametric-none-filled"?"dcg-icon-parametric-filled":e==="table-points-and-lines"?"dcg-icon-lines-solid":e==="shaded-inequality"?"dcg-icon-shaded-inequality-shade2":e==="action"?"dcg-icon-minus":""}};var SA=class extends H1.View{constructor(){super(...arguments),this.isAnimating=!1}init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return l("div",{class:()=>({"dcg-action-icon-view":!0,"dcg-action-icon-view-animating":this.isAnimating}),children:l("div",{class:H1.const("dcg-circular-icon-container"),"aria-label":()=>this.controller.s("graphing-calculator-narration-run-action-icon"),role:H1.const("button"),tabIndex:H1.const("0"),onTap:e=>{jr(e,"dragdrop")||this.runActionOnce()},manageFocus:this.const(ze({controller:this.props.controller(),location:{type:"action-icon",id:this.model.id}})),children:l(qo,{iconType:this.const("action"),whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)})})})}runActionOnce(){this.isAnimating=!0,this.controller.dispatch({type:"action-single-step",id:this.model.id}),setTimeout(this.bindIfMounted(()=>{this.isAnimating=!1,this.update()}),150)}};var yh=__dcg_shared_module_exports__['e'](j());var kA=class extends yh.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:yh.const("dcg-play-pause-icon-view"),children:[l(Oe,{gravity:this.const("s"),tooltip:()=>this.controller.s("graphing-calculator-label-slider-disabled-while-ticker-playing"),disabled:()=>!this.controller.getTickerPlaying(),sticky:this.const(!0),children:l("div",{class:()=>({"dcg-circular-icon-container":!0,"dcg-disabled":this.controller.getTickerPlaying()}),"aria-label":this.bindFn(this.getAriaLabel),"aria-disabled":()=>this.controller.getTickerPlaying(),role:yh.const("button"),tabIndex:()=>this.controller.getTickerPlaying()?"-1":"0",onTap:e=>{this.controller.getTickerPlaying()||jr(e,"dragdrop")||this.toggleSliderIsPlaying()},"dcg-open-menu-guid":()=>this.model.guid,manageFocus:this.const(ze({controller:this.controller,location:{type:"slider-icon",id:this.model.id}})),children:l(qo,{iconType:()=>this.getIconType(),whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)})})}),l("div",{class:yh.const("dcg-slider-menu-container"),children:l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-animation-properties-tooltip"),gravity:this.const("e"),children:l("div",{class:()=>({"dcg-slider-menu-opener":!0,"dcg-menu-open":this.myOptionsOpen()}),tabIndex:yh.const(0),"dcg-open-menu-guid":()=>this.getMenuGUID(),role:yh.const("button"),"aria-label":()=>this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-animation-properties"):this.controller.s("graphing-calculator-narration-show-animation-properties"),onTap:e=>{jr(e,"dragdrop")||e.wasLongheld()||this.toggleOptions(e)},manageFocus:this.const(ze({controller:this.controller,location:{type:"slider-animation-properties-icon",id:this.model.id}})),children:l("i",{class:this.bindFn(this.getIcon),"aria-hidden":yh.const("true")})})})})]})}getIcon(){return __dcg_shared_module_exports__['Qd'](this.model.slider.loopMode)}getIconType(){return!this.model.slider.isPlaying||WI(this.model)?"play":"pause"}getMenuGUID(){return"slider-"+this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"slider",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}getAriaLabel(){if(!this.model.sliderExists)return"";let e=Pg(this.model);return e?this.model.slider.isPlaying?this.controller.s("graphing-calculator-narration-pause-variable-animation",{variable:e}):this.controller.s("graphing-calculator-narration-play-variable-animation",{variable:e}):""}toggleSliderIsPlaying(){if(this.model.sliderExists){let e="",t=Pg(this.model);WI(this.model)?(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-restarted",{variable:t})),this.controller.dispatch({type:"play-slider-from-min",id:this.model.id})):this.model.slider.isPlaying?(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-paused",{variable:t})),this.controller.dispatch({type:"set-slider-isplaying",id:this.model.id,isPlaying:!1})):(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-playing",{variable:t})),this.controller.dispatch({type:"set-slider-isplaying",id:this.model.id,isPlaying:!0})),e!==""&&_e(e)}}};var iZ=__dcg_shared_module_exports__['e'](j());var _A=class extends iZ.View{init(){this.model=this.props.model(),this.controller=this.props.controller()}toggleMuted(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id})}showAsTurnedOff(){return ek(this.model)}template(){return l("button",{class:()=>{var e;return{"dcg-unstyled-button":!0,"dcg-circular-icon-container":!0,"dcg-show-globally-muted":((e=this.controller.toneController)==null?void 0:e.isGlobalMuted())&&!this.showAsTurnedOff()}},onTap:e=>{jr(e,"dragdrop")||this.toggleMuted()},"aria-label":this.props.ariaLabel,children:l(qo,{iconType:()=>this.showAsTurnedOff()?"hidden":"sound",whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)})})}};var{SwitchUnion:aye,If:sye}=Fp.Components,lye="#6A93D2",nZ="#000",aZ="#fff",zk=class extends Fp.View{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return l("div",{class:Fp.const("dcg-expression-icon-container"),children:aye(this.bindFn(this.getIconMode),{error:()=>l(Zo,{error:this.bindFn(this.getErrorMsg),isWhite:this.bindFn(this.renderAsSelected)}),none:()=>l("span",{}),slider:()=>l(kA,{controller:this.props.controller,model:this.props.model}),action:()=>l(SA,{controller:this.props.controller,model:this.props.model}),icon:()=>x("div",{class:Fp.const("dcg-circular-icon-container"),role:Fp.const("button"),tabIndex:Fp.const("0"),"dcg-open-menu-guid":()=>this.getMenuGUID(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:e=>{if(!jr(e,"dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions(e);if((this.controller.isInEditListMode()||e.shiftKey)&&!this.isFraction())return this.toggleOptions(e);if(this.isFraction())return this.onToggleFractionDisplay();this.toggleGraphShown()}},onLongHold:e=>{Xt(e,"dcg-longhold"),Xt(e,"dcg-tap"),!(this.isFraction()||this.displaySlowPlotting()&&!eh(this.model))&&this.toggleOptions(e)},manageFocus:this.const(ze({controller:this.controller,location:{type:"expression-icon",id:this.model.id}})),children:[l(qo,{iconType:this.bindFn(this.getIconType),backgroundColor:this.bindFn(this.getBackgroundColor),whiteIcon:this.bindFn(this.renderAsSelected),foregroundColor:this.bindFn(this.getForegroundColor),iconModifier:this.bindFn(this.getIconModifier),backgroundImage:this.bindFn(this.backgroundImage),backgroundOpacity:this.const(1)}),l(sye,{predicate:()=>this.model.disableGraphInteractions,children:()=>l("i",{class:Fp.const("dcg-graph-interaction-disabled dcg-icon-lock")})})]}),tone:()=>l(_A,{controller:this.props.controller,model:this.props.model,ariaLabel:this.bindFn(this.getIconAriaLabel)})})})}backgroundImage(){let e=this.getBackgroundColor();return e.type==="image"?`url("${e.value}")`:""}getErrorMsg(){return this.colorError()?this.controller.s("shared-calculator-error-color-not-assigned"):this.controller.unpack(this.model.error)}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"expression",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}renderAsSelected(){return this.controller.isItemBeingDragged(this.model.id)?!0:this.controller.isItemSelected(this.model.id)&&!this.controller.isInEditListMode()}displaySlowPlotting(){return this.controller.shouldShowProgressUpdateIcons()&&this.controller.isItemGraphing(this.model.id)&&this.controller.isItemSlowInEvaluator(this.model.id)&&!ji(this.model)}isFraction(){return this.controller.canDisplayEvaluationForItemAsFraction(this.model.id)}getIconMode(){return this.displaySlowPlotting()?"icon":this.hasError()?"error":this.controller.getGraphSettings().config.graphpaper?eh(this.model)?"icon":this.hasSlider()?"slider":this.isFraction()?"icon":this.isNonemptyAction()?"action":this.isToneExpression()&&this.controller.toneEnabled()?"tone":"none":"none"}isToneExpression(){return el(this.model)}toggleGraphShown(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id})}colorError(){return!!this.model.formula.rgb_value&&!this.model.formula.assignment}hasError(){return this.colorError()?!0:!!this.model.error&&!vs(this.model)&&this.controller.getBrailleMode()==="none"}hasSlider(){return!!this.model.sliderExists}isNonemptyAction(){return Yv(this.model)}getDisplayProps(){let{points:e,lines:t,fill:o}=this.model;return __dcg_shared_module_exports__['Wc'](this.model.formula.expression_type,{points:e,lines:t,fill:o},i=>{Er("getReconciledExpressionProps [Chrome Switch Bug]",{metaData:{method:"getDisplayProps",type:i}})})}getBackgroundColor(){if(!this.isFraction())return k0(this.model);let e=this.renderAsSelected();return this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id)?{type:"single-color",value:e?aZ:nZ}:{type:"single-color",value:""}}getForegroundColor(){if(!this.isFraction())return"";let e=this.renderAsSelected(),t=this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id);return e!==t?aZ:e?lye:nZ}onToggleFractionDisplay(){this.controller.dispatch({type:"toggle-fraction-evaluation",id:this.model.id})}getIconModifier(){return Ng(this.model)&&rh(this.model,"alignedAxis")==="y"?"rotated":this.displaySlowPlotting()&&this.model.formula.is_graphable===void 0?"fade-in":"none"}getIconType(){var d;if(this.isFraction())return"fraction";if(this.displaySlowPlotting())return"slow-plotting";if(!this.model.shouldGraph)return"hidden";if(this.controller.isInEditListMode())return"none";let e=this.model.pointStyle,t=this.model.lineStyle,o=this.getDisplayProps(),i=this.model.formula;if(Ng(this.model))return"boxplot";if(ih(this.model)){if(this.model.pointStyle==="POINT")return"dotplot-default";if(this.model.pointStyle==="CROSS")return"dotplot-cross";if(this.model.pointStyle==="OPEN")return"dotplot-open"}if(gb(this.model))return"histogram";if(mb(this.model))return Hv(this.model)&&!((d=this.model.formula)!=null&&d.cdf_error)?"filled-distribution":"unfilled-distribution";if(co(this.model)===__dcg_shared_module_exports__['Gd'].X)return"movable-horizontal";if(co(this.model)===__dcg_shared_module_exports__['Gd'].Y)return"movable-vertical";if(co(this.model)===__dcg_shared_module_exports__['Gd'].XY)return"movable-both";if(Dn(this.model))return e===__dcg_shared_module_exports__['Cd'].OPEN?"point-open":e===__dcg_shared_module_exports__['Cd'].CROSS?"point-cross":e===__dcg_shared_module_exports__['Cd'].SQUARE?"point-square":e===__dcg_shared_module_exports__['Cd'].PLUS?"point-plus":e===__dcg_shared_module_exports__['Cd'].TRIANGLE?"point-triangle":e===__dcg_shared_module_exports__['Cd'].DIAMOND?"point-diamond":e===__dcg_shared_module_exports__['Cd'].STAR?"point-star":"point-default";if(hb(this.model))return"point-default";if(Rg(this.model)||Fg(this.model))return o.lines&&o.points?"table-points-and-lines":o.lines?"table-lines":"table-points";if(AM(this.model))return"polygon-default-filled";let n=this.getDisplayProps().fill;if(Dv(this.model))return n?o.lines?t===__dcg_shared_module_exports__['Dd'].DASHED?"polygon-dashed-filled":t===__dcg_shared_module_exports__['Dd'].DOTTED?"polygon-dotted-filled":"polygon-default-filled":"polygon-none-filled":o.lines?t===__dcg_shared_module_exports__['Dd'].DASHED?"polygon-dashed":t===__dcg_shared_module_exports__['Dd'].DOTTED?"polygon-dotted":"polygon-default":"none";if(Kv(this.model))return n?o.lines?t===__dcg_shared_module_exports__['Dd'].DASHED?"parametric-dashed-filled":t===__dcg_shared_module_exports__['Dd'].DOTTED?"parametric-dotted-filled":"parametric-default-filled":"parametric-none-filled":o.lines?t===__dcg_shared_module_exports__['Dd'].DASHED?"graph-dashed":t===__dcg_shared_module_exports__['Dd'].DOTTED?"graph-dotted":"graph-default":"none";let a=i.operator,s=__dcg_shared_module_exports__['yc'][a].direction!==0,c=__dcg_shared_module_exports__['yc'][a].inclusive===!1;return i.is_shade_between||!c&&s?"shaded-inequality":c&&!s?"inequality":c&&s?"shaded-inequality":t===__dcg_shared_module_exports__['Dd'].DASHED?"graph-dashed":t===__dcg_shared_module_exports__['Dd'].DOTTED?"graph-dotted":"graph-default"}getIconAriaLabel(){return this.displaySlowPlotting()?this.controller.s("shared-calculator-label-slow-plotting"):this.isFraction()?Gg(this.model)?this.controller.s("shared-calculator-narration-display-as-decimal"):this.controller.s("shared-calculator-narration-display-as-fraction"):this.myOptionsOpen()?Wr(this.model,"hide-options"):this.controller.isInEditListMode()?Wr(this.model,"show-options"):el(this.model)?this.model.hidden?Wr(this.model,"unmute"):Wr(this.model,"mute"):this.model.hidden?Wr(this.model,"show"):Wr(this.model,"hide")}};var Np=__dcg_shared_module_exports__['e'](j());var{If:cye}=Np.Components,CA=class extends Np.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return l(cye,{predicate:this.bindFn(this.shouldShow),children:()=>l("div",{class:Np.const("dcg-generate-table-view dcg-do-blur"),handleEvent:Np.const(!0),children:l(Oe,{tooltip:this.bindFn(this.getTooltip),gravity:()=>"s",children:l("i",{onTap:()=>this.controller.dispatch({type:"convert-or-create-table",index:this.model.index}),role:Np.const("button"),tabIndex:Np.const("0"),"aria-label":()=>Wr(this.model,"create_table"),class:Np.const("dcg-icon-create-table")})})})})}shouldShow(){return $f(this.model)!=="recursive-function"||!this.model||this.model.type!=="expression"?!1:!this.controller.hasTableHeaderWithIdentifier(this.model.formula.function_definition)}getTooltip(){return this.controller.s("graphing-calculator-label-create-table")}};var xh=__dcg_shared_module_exports__['e'](j());var{If:dye}=xh.Components,W1=class extends xh.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return l(dye,{predicate:()=>this.controller.showExpressionZoomFitButton(this.model),children:()=>l("div",{class:xh.const("dcg-suggested-zoom-view dcg-do-not-blur"),onTapStart:e=>Xt(e,"dcg-expression-drag"),children:l(Oe,{tooltip:this.bindFn(this.getZoomText),gravity:()=>"e",children:l("i",{onTap:this.bindFn(this.onZoom),role:xh.const("button"),tabIndex:xh.const("0"),"aria-label":this.bindFn(this.getZoomText),class:xh.const("dcg-icon-zoom-fit")})})})})}getZoomText(){return this.controller.s("graphing-calculator-text-zoom-fit")}onZoom(e){this.controller.dispatch({type:"expression-zoom-fit",id:this.model.id,focusAfterTap:e.device==="keyboard"})}};var Ec=__dcg_shared_module_exports__['e'](j());var{If:pye,Switch:uye}=Ec.Components,Ic=class extends Ec.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}iconType(){return this.controller.shouldShowReplaceIcon()?"rename":this.controller.isItemMarkedReadonly(this.model.id)?"lock":"delete"}getAriaLabel(){switch(this.iconType()){case"none":case"lock":return;case"rename":return Wr(this.model,"rename");case"delete":return Wr(this.model,"delete")}}onIconTap(){this.iconType()==="delete"?this.controller.dispatch({type:"delete-item-and-animate-out",id:this.model.id,setFocusAfterDelete:!this.controller.isInEditListMode()}):this.iconType()==="rename"&&this.controller.dispatch({type:"rename-identifier-in-item",search:this.controller.getExpressionSearchStr(),replace:this.controller.getExpressionReplaceStr(),id:this.model.id})}isIconTappable(){let e=this.iconType();return e!=="none"&&e!=="lock"}template(){return l(pye,{predicate:()=>!this.controller.isInEditListMode(),children:()=>l("div",{class:()=>({"dcg-top-level-icon":!0,"dcg-tappable":this.isIconTappable()}),tabIndex:()=>this.isIconTappable()?0:-1,"aria-label":this.bindFn(this.getAriaLabel),handleEvent:this.bindFn(this.isIconTappable),onTap:this.bindFn(this.onIconTap),role:Ec.const("button"),manageFocus:this.const({shouldBeFocused:()=>_1({controller:this.controller,location:{type:"top-level-icon",id:this.model.id}}),onFocusedChanged:(e,t)=>{var o;e?this.controller.dispatch({type:"set-focus-location",location:{type:"top-level-icon",id:this.model.id}}):t.relatedTarget&&!((o=t.relatedTarget)!=null&&o.closest("[data-dcg-label]"))&&this.controller.dispatch({type:"blur-focus-location",location:{type:"top-level-icon",id:this.model.id}})}}),children:l(uye,{children:e=>{switch(e){case"delete":return l("i",{class:Ec.const("dcg-icon-remove dcg-top-level-delete"),"aria-hidden":Ec.const("true")});case"lock":return l("i",{class:Ec.const("dcg-icon-lock dcg-lock-indicator"),"aria-hidden":Ec.const("true")});case"rename":return l("i",{class:Ec.const("dcg-icon-replace"),"aria-hidden":Ec.const("true")});case"none":return l("span",{})}}},()=>this.iconType())})})}};var{If:sZ}=bd.Components,zb=class extends Es{didMountRootNode(e){this.rootNode=e,this.onItemViewMounted(e),this.lastBrailleMode=this.controller.getBrailleMode()}willUnmount(){this.onItemViewUnmounted()}template(){return x("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-highlighted-expressionitem":this.controller.isExpressionHighlighted(this.id),"dcg-mathitem":!0,"dcg-inFolder":!!this.model.folderId,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-selected":this.controller.isItemSelected(this.id)&&!this.controller.isInEditListMode(),"dcg-dragging":this.controller.isItemBeingDragged(this.id),"dcg-hasSlider":this.hasSlider(),"dcg-hasEvaluation":!!this.controller.shouldShowEvaluationForItem(this.id),"dcg-hasRegression":this.hasRegression(),"dcg-hasDomain":this.hasDomain()||this.hasDomain3d()}),"expr-id":()=>this.model.id,didMount:this.bindFn(this.didMountRootNode),children:[x("div",{class:bd.const("dcg-fade-container"),onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect),children:[x("div",{class:bd.const("dcg-main"),children:[l(sZ,{predicate:()=>!this.controller.isInEditListMode()&&!this.isReadonly(),children:()=>l(un,{latex:()=>n3(this.model),ariaLabel:()=>this.getAriaLabel("speech"),brailleAriaLabel:()=>this.getAriaLabel("braille"),onKeydown:this.bindFn(this.handlePressedKey),...ra(this.controller),getAriaPostLabel:this.bindFn(this.getFormulaAria),isFocused:()=>this.isFocused(),noFadeout:()=>this.controller.isItemMarkedReadonly(this.model.id),hasError:this.const(!1),onUserPressedKey:this.bindFn(this.handleEditableMathquillPressedKey),onUserChangedLatex:e=>this.handleLatexChanged(e),onFocusedChanged:this.bindFn(this.handleMQFocusedChanged),onSelectionChanged:()=>{this.controller.runAfterDispatch(()=>{this.controller.dispatch({type:"render"})})}})}),l(sZ,{predicate:()=>this.controller.isInEditListMode()||this.isReadonly(),children:()=>l("div",{class:bd.const("dcg-edit-list-mathquill"),onTap:()=>this.controller.isInEditListMode()?this.exitEditListMode():{},children:l(un,{latex:()=>n3(this.model),ariaLabel:()=>this.getAriaLabel("speech"),brailleAriaLabel:()=>this.getAriaLabel("braille"),isStatic:this.const(!0),isFocused:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="readonly-expression"?!1:e.id===this.id},onKeydown:this.bindFn(this.handlePressedKey),onUserPressedKey:(e,t)=>t&&this.handlePressedKey(t),onFocusedChanged:(e,t)=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"readonly-expression",id:this.model.id}}):this.doesNodeBelongToSliderLimit(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"readonly-expression",id:this.model.id}})},...ra(this.controller)})})})]}),l(Ic,{controller:this.props.controller,model:this.props.model}),l(vA,{controller:this.props.controller,model:this.props.model,isFirstRender:this.bindFn(this.isFirstRender)})]}),x("span",{class:()=>({"dcg-tab":!0,"dcg-action-drag":!0,"dcg-action-icon-touch":!0,...this.debugProgressClassMap()}),handleEvent:bd.const("true"),tapboundary:bd.const("true"),disablescroll:bd.const("true"),onTapStart:this.bindFn(this.onDragPending),children:[l("span",{class:bd.const("dcg-num"),children:()=>this.model.displayIndex}),l("div",{class:bd.const("dcg-tab-interior dcg-action-icon-mouse"),children:l(zk,{model:this.props.model,controller:this.props.controller})}),l(W1,{model:this.props.model,controller:this.props.controller}),l(CA,{model:this.props.model,controller:this.props.controller})]}),l(Cc,{controller:this.props.controller,id:()=>this.model.id})]})}debugProgressClassMap(){if(!this.controller.shouldShowProgressUpdateColors())return{};let e=this.controller.getEvaluatorStateForItem(this.model.id);switch(e){case void 0:case"IDLE":case"RESOLVED":return{};case"UNPUBLISHED":return{"dcg-progress-unpublished":!0};case"ANALYZING":return{"dcg-progress-analyzing":!0};case"GRAPHING":return{"dcg-progress-graphing":!0};default:throw new Error(`Unexpected analysis state: ${e}`)}}didUpdate(){this.lastBrailleMode=this.controller.getBrailleMode()}shouldShowLabelView(){return Av(this.model)&&!this.controller.isThreeDMode()}hasRegression(){return!!this.model.formula.is_regression}hasDomain(){return Og(this.model)}hasDomain3d(){return oh(this.model)}isTTest(){return GM(this.model)}hasSlider(){return!!this.model.sliderExists}getLabelOptions(){return this.controller.getEvaluationLabelOptionsForItem(this.model.id)}getAriaLabel(e){if(this.shouldShowLabelView()){let t;this.model.label&&this.model.label!==""?t=this.model.label:e==="speech"?t=this.controller.s("graphing-calculator-narration-expression-label"):t=this.controller.raw("lbl");let o;return ws(this.model)?o=t:e==="speech"?o=this.controller.s("graphing-calculator-narration-expression-hidden-label",{label:t}):o=this.controller.raw("h __label__",{label:t}),o}if(e==="speech"){let t=this.controller.s("shared-calculator-narration-expression-index",{index:this.model.displayIndex});if(this.controller.shouldShowProgressUpdateIcons()){let o=this.controller.getEvaluatorStateForItem(this.model.id);if(o)return`${t} - ${o}`}return t}else return this.controller.raw("eq__index__",{index:this.model.displayIndex})}getFormulaAria(){let e=this.model.formula,t="";if(this.controller.isItemSlowInEvaluator(this.model.id))return this.controller.shouldShowEvaluationForItem(this.id)?this.controller.s("graphing-calculator-narration-slow-evaluation"):this.controller.s("graphing-calculator-narration-slow-compute");if(!e||vs(this.model))return t;if(this.controller.shouldShowEvaluationForItem(this.model.id))t=`equals ${DD(this.model,this.controller,this.getLabelOptions())}`;else if(e.error&&!this.controller.shouldShowSliderPrompt(this.model))t=this.controller.unpack(e.error);else if(this.controller.shouldShowSliderPrompt(this.model)){let o=th(this.model).length;if(o>0)t=this.controller.s("graphing-calculator-narration-add-base-case-prompt",{count:__dcg_shared_module_exports__['Db'](o)});else{let i=[],n=Ev(this.model);for(let a=0;a<n.length;a++)i.push(Mr(n[a]));t=this.controller.s("graphing-calculator-narration-add-slider-prompt",{vars:ol(this.controller.getLanguage(),i)})}}else mb(this.model)?t=this.controller.s("graphing-calculator-narration-expression-evaluation-is-distribution"):this.isTTest()&&(t=this.controller.s("graphing-calculator-narration-expression-evaluation-is-t-test"));if(this.model.shouldGraph&&(e.is_graphable||e.is_regression)){e.is_graphable&&e.is_regression?t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph-and-regression"):e.is_regression?t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-regression"):t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph");let o=this.controller.getAudioGraph();o&&o.agNavigator.canTrace(this.model)&&(qr?t+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-mac"):t+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-windows"))}return this.controller.toneEnabled()&&el(this.model)&&(this.model.hidden?t+=" "+this.controller.s("graphing-calculator-narration-expression-tone-muted"):t+=" "+this.controller.s("graphing-calculator-narration-expression-tone-unmuted")),t}handlePressedKey(e){let t=Pe(e);if(!(!t||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)&&(t==="Esc"?(this.controller.isInEditListMode()?this.exitEditListMode():Dr(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}}),e.preventDefault(),e.stopPropagation()):(t==="Up"||t==="Down"||t==="Enter")&&(this.controller.dispatch({type:"on-special-key-pressed",key:t}),e.preventDefault(),e.stopPropagation()),!this.isReadonly()&&(t==="Del"||t==="Backspace"))){let o=_c();vs(this.model)&&(!o||PJ(o))&&(this.controller.dispatch({type:"on-special-key-pressed",key:t==="Del"?"Delete":t}),e.preventDefault(),e.stopPropagation())}}handleEditableMathquillPressedKey(e,t){var i;let o=Qe.getFocusedMathquill();if(o){if(t&&this.controller.isGraphPaperFocused()){let n=(i=this.controller.getGrapher2d())==null?void 0:i.poiController;if(!n)return;let a=n.keyboardAttentionManager;if(e==="Tab"||e==="Shift-Tab"){t.stopPropagation(),t.preventDefault(),a.focusNextObjFromKeyboard({direction:t.shiftKey?"prev":"next"});return}else if(e==="Left"||e==="Right"||e==="Up"||e==="Down"||e==="Shift-Left"||e==="Shift-Right"||e==="Shift-Up"||e==="Shift-Down"){t.stopPropagation(),t.preventDefault(),t&&n.moveGeoPointFromKeyboard(t);return}else if(e==="Enter"){t.stopPropagation(),t.preventDefault();let s=a.getKeyboardAttention();n.activateGeoObjectFromKeyboard(s,t),this.controller.getEvaluator().notifyWhenSynced(()=>{let c=this.controller.getValidCursorContext(),d=this.model.formula.cursor_context;if(c&&__dcg_shared_module_exports__['db'](c,d)){let p=this.controller.getFocusLocation();if(p&&p.type==="expression"&&p.id===this.model.id&&!p.isFakeGraphFocus&&this.controller.dispatch({type:"set-focus-location",location:{...p,isFakeGraphFocus:!0}}),s){let u=a.findTabbableObjectsForCurrentTool(s);u.currentIsTabbable&&a.updateKeyboardAttention(u.targets[u.currentTabIndex],{describe:!1})}}});return}else if(e==="Esc"){t.stopPropagation(),t.preventDefault(),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}});return}}if(e==="Esc"){Dr(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}});return}else{if(e==="Up"||e==="Down")return Qe.applyArrowKeyAndReturnIfWasAtBounds(o,e,t)?this.controller.dispatch({type:"on-special-key-pressed",key:e}):void 0;if(e==="Delete"||e==="Backspace"){if(vs(this.model))return this.controller.dispatch({type:"on-special-key-pressed",key:e})}else if(e==="Enter")return t&&(t.preventDefault(),t.stopPropagation()),this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"})}o.keystroke(e,t),this.handleLatexChanged(o.latex())}}handleLatexChanged(e){e!==this.model.latex&&this.controller.dispatch({type:"set-item-latex",id:this.id,latex:e,source:"user-edit"})}doesNodeBelongToSliderLimit(e){return!e||!this.rootNode.contains(e)?!1:!!e.closest("[data-dcg-label]")}handleMQFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}):!this.doesNodeBelongToSliderLimit(t.relatedTarget)&&this.lastBrailleMode===this.controller.getBrailleMode()&&this.controller.dispatch({type:"blur-focus-location",location:{type:"expression",id:this.id}})}onMouseSelect(e){this.isReadonly()||e.device!=="keyboard"&&(e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||jr(e)||(Xt(e),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}})))}isReadonly(){return this.controller.isItemReadonly(this.id)}isFocused(){let e=this.controller.getFocusLocation();return!e||e.type!=="expression"?!1:e.id===this.id}};var _t=function(r,e,t){var o=document.createElement("img"),i,n;if(o.onerror=e,o.onload=function(){n&&!(t&&t.noRevoke)&&_t.revokeObjectURL(n),e&&e(_t.scale(o,t))},_t.isInstanceOf("Blob",r)||_t.isInstanceOf("File",r))i=n=_t.createObjectURL(r),o._type=r.type;else if(typeof r=="string")i=r,t&&t.crossOrigin&&(o.crossOrigin=t.crossOrigin);else return!1;return i?(o.src=i,o):_t.readFile(r,function(a){var s=a.target;s&&s.result?o.src=s.result:e&&e(a)})},TA=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;_t.isInstanceOf=function(r,e){return Object.prototype.toString.call(e)==="[object "+r+"]"};_t.transformCoordinates=function(){};_t.getTransformedOptions=function(r){return r};_t.renderImageToCanvas=function(r,e,t,o,i,n,a,s,c,d){return r.getContext("2d").drawImage(e,t,o,i,n,a,s,c,d),r};_t.hasCanvasOption=function(r){return r.canvas||r.crop};_t.scale=function(r,e){e=e||{};var t=document.createElement("canvas"),o=r.getContext||_t.hasCanvasOption(e)&&t.getContext,i=r.naturalWidth||r.width,n=r.naturalHeight||r.height,a=i,s=n,c,d,p,u,g,h,b,v,T,E=function(){var _=Math.max((p||a)/a,(u||s)/s);_>1&&(a=Math.ceil(a*_),s=Math.ceil(s*_))},I=function(){var _=Math.min((c||a)/a,(d||s)/s);_<1&&(a=Math.ceil(a*_),s=Math.ceil(s*_))};return o&&(e=_t.getTransformedOptions(e),b=e.left||0,v=e.top||0,e.sourceWidth?(g=e.sourceWidth,e.right!==void 0&&e.left===void 0&&(b=i-g-e.right)):g=i-b-(e.right||0),e.sourceHeight?(h=e.sourceHeight,e.bottom!==void 0&&e.top===void 0&&(v=n-h-e.bottom)):h=n-v-(e.bottom||0),a=g,s=h),c=e.maxWidth,d=e.maxHeight,p=e.minWidth,u=e.minHeight,o&&c&&d&&e.crop?(a=c,s=d,T=g/h-c/d,T<0?(h=d*g/c,e.top===void 0&&e.bottom===void 0&&(v=(n-h)/2)):T>0&&(g=c*h/d,e.left===void 0&&e.right===void 0&&(b=(i-g)/2))):((e.contain||e.cover)&&(p=c=c||p,u=d=d||u),e.cover?(I(),E()):(E(),I())),o?(t.width=a,t.height=s,_t.transformCoordinates(t,e),_t.renderImageToCanvas(t,r,b,v,g,h,0,0,a,s)):(r.width=a,r.height=s,r)};_t.createObjectURL=function(r){return TA?TA.createObjectURL(r):!1};_t.revokeObjectURL=function(r){return TA?TA.revokeObjectURL(r):!1};_t.readFile=function(r,e,t){if(window.FileReader){var o=new FileReader;if(o.onload=o.onerror=e,t=t||"readAsDataURL",o[t])return o[t](r),o}return!1};(!window.navigator||!window.navigator.platform||!/iP(hone|od|ad)/.test(window.navigator.platform))&&(lZ=_t.renderImageToCanvas,_t.detectSubsampling=function(r){var e,t;return r.width*r.height>1024*1024?(e=document.createElement("canvas"),e.width=e.height=1,t=e.getContext("2d"),t.drawImage(r,-r.width+1,0),t.getImageData(0,0,1,1).data[3]===0):!1},_t.detectVerticalSquash=function(r,e){var t=r.naturalHeight||r.height,o=document.createElement("canvas"),i=o.getContext("2d"),n,a,s,c,d;for(e&&(t/=2),o.width=1,o.height=t,i.drawImage(r,0,0),n=i.getImageData(0,0,1,t).data,a=0,s=t,c=t;c>a;)d=n[(c-1)*4+3],d===0?s=c:a=c,c=s+a>>1;return c/t||1},_t.renderImageToCanvas=function(r,e,t,o,i,n,a,s,c,d){if(e._type==="image/jpeg"){var p=r.getContext("2d"),u=document.createElement("canvas"),g=1024,h=u.getContext("2d"),b,v,T,E;if(u.width=g,u.height=g,p.save(),b=_t.detectSubsampling(e),b&&(t/=2,o/=2,i/=2,n/=2),v=_t.detectVerticalSquash(e,b),b||v!==1){for(o*=v,c=Math.ceil(g*c/i),d=Math.ceil(g*d/n/v),s=0,E=0;E<n;){for(a=0,T=0;T<i;)h.clearRect(0,0,g,g),h.drawImage(e,t,o,i,n,-T,-E,i,n),p.drawImage(u,0,0,g,g,a,s,c,d),T+=g,a+=c;E+=g,s+=d}return p.restore(),r}}return lZ(r,e,t,o,i,n,a,s,c,d)});var lZ,hye=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);_t.blobSlice=hye&&function(){var r=this.slice||this.webkitSlice||this.mozSlice;return r.apply(this,arguments)};_t.metaDataParsers={jpeg:{65505:[]}};_t.parseMetaData=function(r,e,t){t=t||{};var o=this,i=t.maxMetaDataSize||262144,n={},a=!(window.DataView&&r&&r.size>=12&&r.type==="image/jpeg"&&_t.blobSlice);(a||!_t.readFile(_t.blobSlice.call(r,0,i),function(s){var c=s.target.result,d=new DataView(c),p=2,u=d.byteLength-4,g=p,h,b,v,T;if(d.getUint16(0)===65496){for(;p<u&&(h=d.getUint16(p),h>=65504&&h<=65519||h===65534);){if(b=d.getUint16(p+2)+2,p+b>d.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(v=_t.metaDataParsers.jpeg[h],v)for(T=0;T<v.length;T+=1)v[T].call(o,d,p,b,n,t);p+=b,g=p}!t.disableImageHead&&g>6&&(c.slice?n.imageHead=c.slice(0,g):n.imageHead=new Uint8Array(c).subarray(0,g))}else console.log("Invalid JPEG file: Missing JPEG marker.");e(n)},"readAsArrayBuffer"))&&e(n)};var gye=_t.hasCanvasOption;_t.hasCanvasOption=function(r){return gye(r)||r.orientation};_t.transformCoordinates=function(r,e){var t=r.getContext("2d"),o=r.width,i=r.height,n=e.orientation;if(n)switch(n>4&&(r.width=i,r.height=o),n){case 2:t.translate(o,0),t.scale(-1,1);break;case 3:t.translate(o,i),t.rotate(Math.PI);break;case 4:t.translate(0,i),t.scale(1,-1);break;case 5:t.rotate(.5*Math.PI),t.scale(1,-1);break;case 6:t.rotate(.5*Math.PI),t.translate(0,-i);break;case 7:t.rotate(.5*Math.PI),t.translate(o,-i),t.scale(-1,1);break;case 8:t.rotate(-.5*Math.PI),t.translate(-o,0);break}};_t.getTransformedOptions=function(r){if(!r.orientation||r.orientation===1)return r;var e={},t;for(t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);switch(r.orientation){case 2:e.left=r.right,e.right=r.left;break;case 3:e.left=r.right,e.top=r.bottom,e.right=r.left,e.bottom=r.top;break;case 4:e.top=r.bottom,e.bottom=r.top;break;case 5:e.left=r.top,e.top=r.left,e.right=r.bottom,e.bottom=r.right;break;case 6:e.left=r.top,e.top=r.right,e.right=r.bottom,e.bottom=r.left;break;case 7:e.left=r.bottom,e.top=r.right,e.right=r.top,e.bottom=r.left;break;case 8:e.left=r.bottom,e.top=r.left,e.right=r.top,e.bottom=r.right;break}return r.orientation>4&&(e.maxWidth=r.maxHeight,e.maxHeight=r.maxWidth,e.minWidth=r.minHeight,e.minHeight=r.minWidth,e.sourceWidth=r.sourceHeight,e.sourceHeight=r.sourceWidth),e};_t.ExifMap=function(){return this};_t.ExifMap.prototype.map={Orientation:274};_t.ExifMap.prototype.get=function(r){return this[r]||this[this.map[r]]};_t.getExifThumbnail=function(r,e,t){var o,i,n;if(!t||e+t>r.byteLength){console.log("Invalid Exif data: Invalid thumbnail data.");return}for(o=[],i=0;i<t;i+=1)n=r.getUint8(e+i),o.push((n<16?"0":"")+n.toString(16));return"data:image/jpeg,%"+o.join("%")};_t.exifTagTypes={1:{getValue:function(r,e){return r.getUint8(e)},size:1},2:{getValue:function(r,e){return String.fromCharCode(r.getUint8(e))},size:1,ascii:!0},3:{getValue:function(r,e,t){return r.getUint16(e,t)},size:2},4:{getValue:function(r,e,t){return r.getUint32(e,t)},size:4},5:{getValue:function(r,e,t){return r.getUint32(e,t)/r.getUint32(e+4,t)},size:8},9:{getValue:function(r,e,t){return r.getInt32(e,t)},size:4},10:{getValue:function(r,e,t){return r.getInt32(e,t)/r.getInt32(e+4,t)},size:8}};_t.exifTagTypes[7]=_t.exifTagTypes[1];_t.getExifValue=function(r,e,t,o,i,n){var a=_t.exifTagTypes[o],s,c,d,p,u,g;if(!a){console.log("Invalid Exif data: Invalid tag type.");return}if(s=a.size*i,c=s>4?e+r.getUint32(t+8,n):t+8,c+s>r.byteLength){console.log("Invalid Exif data: Invalid data offset.");return}if(i===1)return a.getValue(r,c,n);for(d=[],p=0;p<i;p+=1)d[p]=a.getValue(r,c+p*a.size,n);if(a.ascii){for(u="",p=0;p<d.length&&(g=d[p],g!=="\0");p+=1)u+=g;return u}return d};_t.parseExifTag=function(r,e,t,o,i){var n=r.getUint16(t,o);i.exif[n]=_t.getExifValue(r,e,t,r.getUint16(t+2,o),r.getUint32(t+4,o),o)};_t.parseExifTags=function(r,e,t,o,i){var n,a,s;if(t+6>r.byteLength){console.log("Invalid Exif data: Invalid directory offset.");return}if(n=r.getUint16(t,o),a=t+2+12*n,a+4>r.byteLength){console.log("Invalid Exif data: Invalid directory size.");return}for(s=0;s<n;s+=1)this.parseExifTag(r,e,t+2+12*s,o,i);return r.getUint32(a,o)};_t.parseExifData=function(r,e,t,o,i){if(!i.disableExif){var n=e+10,a,s,c;if(r.getUint32(e+4)===1165519206){if(n+8>r.byteLength){console.log("Invalid Exif data: Invalid segment size.");return}if(r.getUint16(e+8)!==0){console.log("Invalid Exif data: Missing byte alignment offset.");return}switch(r.getUint16(n)){case 18761:a=!0;break;case 19789:a=!1;break;default:console.log("Invalid Exif data: Invalid byte alignment marker.");return}if(r.getUint16(n+2,a)!==42){console.log("Invalid Exif data: Missing TIFF marker.");return}s=r.getUint32(n+4,a),o.exif=new _t.ExifMap,s=_t.parseExifTags(r,n,n+s,a,o),s&&!i.disableExifThumbnail&&(c={exif:{}},s=_t.parseExifTags(r,n,n+s,a,c),c.exif[513]&&(o.exif.Thumbnail=_t.getExifThumbnail(r,n+c.exif[513],c.exif[514]))),o.exif[34665]&&!i.disableExifSub&&_t.parseExifTags(r,n,n+o.exif[34665],a,o),o.exif[34853]&&!i.disableExifGps&&_t.parseExifTags(r,n,n+o.exif[34853],a,o)}}};_t.metaDataParsers.jpeg[65505].push(_t.parseExifData);_t.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"};_t.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}};_t.ExifMap.prototype.getText=function(r){var e=this.get(r);switch(r){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[r][e];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(e[0],e[1],e[2],e[3]);case"ComponentsConfiguration":return this.stringValues[r][e[0]]+this.stringValues[r][e[1]]+this.stringValues[r][e[2]]+this.stringValues[r][e[3]];case"GPSVersionID":return e[0]+"."+e[1]+"."+e[2]+"."+e[3]}return String(e)};(function(r){var e=r.tags,t=r.map,o;for(o in e)e.hasOwnProperty(o)&&(t[e[o]]=o)})(_t.ExifMap.prototype);_t.ExifMap.prototype.getAll=function(){var r={},e,t;for(e in this)this.hasOwnProperty(e)&&(t=this.tags[e],t&&(r[t]=this.getText(t)));return r};function cZ(r,e){let t=[.92,.86,.8,.7,.6,.5,.4,.3,.2,.1],o;for(let i=0;i<t.length;i++)if(o=r.toDataURL("image/jpeg",t[i]),o.length<e)return o;return o}function mye(r,e){let t=r.toDataURL().length,o=r.width,i=r.height,n=document.createElement("canvas"),a;for(let s=0;s<2;s++){let c=Math.sqrt(e/t);if(o=Math.round(c*o),i=Math.round(c*i),n.height=i,n.width=o,n.getContext("2d").drawImage(r,0,0,o,i),a=n.toDataURL(),t=a.length,t<e)return a}return a}function fye(r){let t=r.getContext("2d").getImageData(0,0,r.width,r.height).data;for(let o=3;o<t.length;o+=4)if(t[o]!==255)return!0;return!1}function EA(r,e){_t(r,o=>{if(!o.toDataURL){e(!0);return}let i=2e5,n;r.type==="image/jpeg"?n=cZ(o,i):(n=o.toDataURL(),n.length>i&&(n=n.length>.75*o.width*o.height&&!fye(o)?cZ(o,i):mye(o,i))),e(null,n)},{orientation:!0,canvas:!0,maxWidth:1600,maxHeight:1600})}var Up=__dcg_shared_module_exports__['e'](j());function IA(r){let e=document.createElement("a");return e.href=r,e.href}var{SwitchUnion:bye,If:yye}=Up.Components,qb=class extends Up.View{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return l("div",{class:Up.const("dcg-expression-icon-container dcg-image-icon-container"),children:bye(this.bindFn(this.typeOfIcon),{error:()=>l(Zo,{error:()=>this.controller.unpack(this.model.error),isWhite:this.bindFn(this.isSelected)}),failed:()=>l("span",{}),loading:()=>l(qo,{iconType:this.const("loading")}),hidden:()=>this.buildIconView(),image:()=>this.buildIconView()})})}buildIconView(){return x("div",{class:Up.const("dcg-circular-icon-container"),role:Up.const("button"),tabIndex:Up.const("0"),"dcg-open-menu-guid":()=>this.getMenuGUID(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:e=>{if(!jr(e,"dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions(e);if(this.controller.isInEditListMode()||e.shiftKey)return this.toggleOptions(e);this.toggleImageShown()}},onLongHold:e=>{Xt(e,"dcg-longhold"),Xt(e,"dcg-tap"),this.toggleOptions(e)},manageFocus:this.const(ze({controller:this.controller,location:{type:"image-icon",id:this.model.id}})),children:[l(qo,{iconType:()=>this.typeOfIcon()==="hidden"?"hidden":"background",backgroundImage:this.bindFn(this.getBackgroundImage),backgroundOpacity:this.const(1),whiteIcon:this.bindFn(this.isSelected)}),l(yye,{predicate:()=>this.model.disableGraphInteractions,children:()=>l("i",{class:Up.const("dcg-graph-interaction-disabled dcg-icon-lock")})})]})}isSelected(){return this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}typeOfIcon(){return this.model.loadStatus==="loading"?"loading":this.model.loadStatus==="failed"?"failed":this.hasError()?"error":this.model.shouldGraph?"image":"hidden"}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"image",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}hasError(){return!!this.model.error&&this.controller.getBrailleMode()==="none"}getBackgroundImage(){return this.model.image_url===this.lastURL?this.lastEncodedURL:(this.lastURL=this.model.image_url,this.lastEncodedURL='url("'+IA(this.model.image_url)+'")',this.lastEncodedURL)}toggleImageShown(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id}),this.controller.dispatch({type:"set-focus-location",location:{type:"image-icon",id:this.model.id}})}getIconAriaLabel(){return this.myOptionsOpen()?Wr(this.model,"hide-options"):this.controller.isInEditListMode()?Wr(this.model,"show-options"):this.model.hidden?Wr(this.model,"show"):Wr(this.model,"hide")}};var MA={};__dcg_shared_module_exports__['d'](MA,{LARGE:()=>wye,MEDIUM:()=>xU,SMALL:()=>vye,VERY_LARGE:()=>Sye,VERY_SMALL:()=>xye});var xye=9,vye=12,xU=16,wye=20,Sye=24;En();var jb=__dcg_shared_module_exports__['e'](j());Ut();var Yl=__dcg_shared_module_exports__['e'](j());var Fo=__dcg_shared_module_exports__['e'](j());var vh=__dcg_shared_module_exports__['e'](j());Ut();var wh=class extends vh.View{init(){this.controller=this.props.controller()}template(){return x("div",{class:vh.const("dcg-do-not-blur"),onTap:this.bindFn(this.newImage),handleEvent:vh.const("true"),role:vh.const("button"),tabIndex:()=>this.props.readonly()?-1:0,"aria-label":this.props.ariaLabel,"aria-disabled":()=>this.props.readonly(),manageFocus:this.const(this.props.location?ze({controller:this.controller,location:this.props.location()}):void 0),children:[this.props.children,l("input",{type:vh.const("file"),accept:vh.const("image/*"),style:vh.const("display: none"),didMount:this.bindFn(this.didMountFileInput)})]})}didMountFileInput(e){this.fileInputNode=e,re(e).on("change",()=>{this.props.onFileChange(e.files),e.value=""})}newImage(){this.props.readonly()||this.fileInputNode.click()}};var{If:dZ,Switch:pZ}=Fo.Components,DA=class extends Fo.View{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return x("div",{class:Fo.const("dcg-clickable-image-info-view"),role:Fo.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-clickable-image-options"),children:[x("div",{class:Fo.const("dcg-clickable-image-state-container"),children:[l(Oe,{tooltip:()=>this.tooltip("hovered"),gravity:this.const("s"),children:l(wh,{controller:()=>this.controller,ariaLabel:()=>this.tooltip("hovered"),onFileChange:e=>this.updateImage("hovered",e),readonly:()=>this.controller.isItemReadonly(this.id),children:l(pZ,{children:()=>l("div",{class:Fo.const("dcg-clickable-image-state"),style:()=>this.getStyleForState("hovered")})},this.bindFn(this.hoveredStatus))})}),l(dZ,{predicate:()=>!!this.model.clickableInfo.hoveredImage,children:()=>l("div",{class:Fo.const("dcg-clickable-image-state-close"),onTap:()=>this.removeImageState("hovered"),ariaLabel:()=>this.controller.s("graphing-calculator-label-remove-hovered-image"),role:Fo.const("button"),tabIndex:Fo.const(0),children:l("i",{class:Fo.const("dcg-icon-remove"),"aria-hidden":Fo.const("true")})})}),l("div",{role:Fo.const("heading"),"aria-level":Fo.const("2"),class:Fo.const("dcg-clickable-image-label"),children:()=>this.controller.s("graphing-calculator-label-hovered")})]}),x("div",{class:Fo.const("dcg-clickable-image-state-container"),children:[l(Oe,{tooltip:()=>this.tooltip("depressed"),gravity:this.const("s"),children:l(wh,{controller:()=>this.controller,ariaLabel:()=>this.tooltip("depressed"),onFileChange:e=>this.updateImage("depressed",e),readonly:()=>this.controller.isItemReadonly(this.id),children:l(pZ,{children:()=>l("div",{class:Fo.const("dcg-clickable-image-state"),style:()=>this.getStyleForState("depressed")})},this.bindFn(this.depressedStatus))})}),l(dZ,{predicate:()=>!!this.model.clickableInfo.depressedImage,children:()=>l("div",{class:Fo.const("dcg-clickable-image-state-close"),onTap:()=>this.removeImageState("depressed"),ariaLabel:()=>this.controller.s("graphing-calculator-label-remove-depressed-image"),role:Fo.const("button"),tabIndex:Fo.const(0),children:l("i",{class:Fo.const("dcg-icon-remove"),"aria-hidden":Fo.const("true")})})}),l("div",{role:Fo.const("heading"),"aria-level":Fo.const("2"),class:Fo.const("dcg-clickable-image-label"),children:()=>this.controller.s("graphing-calculator-label-depressed")})]})]})}hoveredStatus(){return this.hoveredUploading?"loading":"background"}depressedStatus(){return this.depressedUploading?"loading":"background"}tooltip(e){return(e==="hovered"?this.model.clickableInfo.hoveredImage:this.model.clickableInfo.depressedImage)?e==="depressed"?this.controller.s("graphing-calculator-label-change-depressed-image-tooltip"):this.controller.s("graphing-calculator-label-change-hovered-image-tooltip"):e==="depressed"?this.controller.s("graphing-calculator-label-add-depressed-image-tooltip"):this.controller.s("graphing-calculator-label-add-hovered-image-tooltip")}getImageURLForState(e){let t;if(e==="hovered"){if(this.hoveredStatus()!=="background")return"";t="hoveredImage"}else{if(this.depressedStatus()!=="background")return"";t="depressedImage"}let o=this.model.clickableInfo[t];return o?`url(${o})`:`url(${this.model.image_url})`}getStyleForState(e){let t={"background-image":this.getImageURLForState(e),opacity:"1"};return e==="hovered"&&!this.model.clickableInfo.hoveredImage&&(t.opacity="0.5"),t}removeImageState(e){e==="hovered"?this.controller.dispatch({type:"set-hovered-image",id:this.model.id,url:""}):this.controller.dispatch({type:"set-depressed-image",id:this.model.id,url:""})}updateImage(e,t){if(!t||!t[0])return;let o=t[0];e==="hovered"&&(this.hoveredUploading=!0),e==="depressed"&&(this.depressedUploading=!0),this.controller.getGraphSettings().config.imageUploadCallback(o,(i,n)=>{e==="hovered"&&(this.hoveredUploading=!1),e==="depressed"&&(this.depressedUploading=!1),!i&&n&&(e==="hovered"?this.controller.dispatch({type:"set-hovered-image",id:this.model.id,url:n}):this.controller.dispatch({type:"set-depressed-image",id:this.model.id,url:n}))})}};var Hb=__dcg_shared_module_exports__['e'](j()),to=class extends Hb.View{template(){return l("div",{class:()=>({"dcg-toggle-view":!0,"dcg-toggled":this.props.toggled()}),"aria-label":()=>this.props.ariaLabel(),role:Hb.const("checkbox"),tabIndex:Hb.const("0"),"aria-checked":()=>this.props.toggled(),toggled:()=>this.props.toggled(),onTap:this.bindFn(this.props.onChange),children:l("div",{class:Hb.const("dcg-toggle-track"),children:l("div",{class:Hb.const("dcg-toggle-switch")})})})}};var vU=/\{\$([a-zA-Z0-9\-]+([a-zA-Z0-9\-]+_)*[a-zA-Z0-9\-]+)\}/;function uZ(r,e){let t=0,o=0,i={},n={},a=s(r);if(!/^<0>/.test(a)||!/<\/0>$/.test(a))throw new Error("Expected template string to start and end with <0> and </0>, but found "+JSON.stringify(a));return a.slice(3,-4).trim();function s(d){if(e.isConst(d))return e.getConstValue(d);if(e.isNamedBinding(d)){let p=c(i,e.getBindingName(d)),u=`{$${p}}`;if(!vU.test(u))throw new Error(`Invalid <Localize> variable: ${u}.`);return e.addBinding&&e.addBinding(p,d),i[p]=!0,u}else if(d!==r&&e.isView(d)){let p=c(n,e.getViewName(d));if(!/[a-zA-Z0-9\-_]/.test(p))throw new Error(`Invalid <Localize> subview identifier: ${p}.`);return e.addView&&e.addView(p,d),n[p]=!0,`<${p}/>`}else if(e.isBinding(d)){let p=c(i,`v${t++}`),u=`{$${p}}`;return e.addBinding&&e.addBinding(p,d),i[p]=!0,u}else{let p=`${o++}`;e.addElement&&e.addElement(p,d);let u=[];return e.forEachChild(d,g=>{u.push(s(g))}),n[p]=!0,u.length>0?`<${p}>${u.join("")}</${p}>`:`<${p}/>`}}function c(d,p){let u=0,g=p;for(;d[g];)g=`${p}-${++u}`;return g}}var ll=__dcg_shared_module_exports__['e'](j()),AA=__dcg_shared_module_exports__['e'](kZ());function Mye(r){return r.__DCGViewLocalizeBindingName}function _Z(r){return ll.isSpec(r)&&"__DCGViewLocalizeViewName"in r}var Ot=class extends ll.View{init(){this.viewMap={},this.elementMap={},this.bindingMap={},this.i18n=this.props.i18n();let e=l("div",{style:ll.const("display: contents;"),children:this.props.children});if(ll.isSpec(e)&&e.type==="element")this.templateString=this.serializeToTemplateString(e);else throw new Error("programming error: expected root localize to be DCGElementSpec")}template(){return l(ll.Components.If,{predicate:()=>this.shouldShow(),children:()=>l(ll.Components.Switch,{children:e=>this.renderDeserializedTemplateNode(this.parseAndValidate(e))},()=>SU(this.translatedString()))})}shouldShow(){let e=this.props.options&&this.props.options();return e&&e.hideUntranslatedView&&this.i18n.hasTranslation?this.i18n.hasTranslation(this.props.key()):!0}translatedString(){let e={};for(let t in this.bindingMap)e[t]=$s(`{$${t}}`);return this.i18n.s(this.props.key(),e)}static variable(e,t){let o=()=>t();return o.__DCGViewLocalizeBindingName=e,o}static subview(e,t){let o=t();if(ll.isSpec(o)||(o=l("span",{})),ll.isSpec(o))return{...o,__DCGViewLocalizeViewName:e};throw new Error("expected a DCGElementSpec")}parseAndValidate(e){let t=(0,AA.parse)(e),o={},i={};n(t);for(let a in this.elementMap)if(!i[a])return(0,AA.parse)(SU(this.templateString));for(let a in this.bindingMap)if(!o[a])return(0,AA.parse)(SU(this.templateString));return t;function n(a){if(Array.isArray(a)){for(let s of a)n(s);return}a.name==="token"?o[a.attrs.id]=!0:a.type!=="text"&&(i[a.name]=!0,n(a.children))}}renderDeserializedTemplateNode(e){if(Array.isArray(e))return e.map(t=>this.renderDeserializedTemplateNode(t));if(e.type==="text")return ll.const(e.content||"");if(e.name==="token"){let t=this.bindingMap[e.attrs.id];return t||(()=>"")}else if(this.elementMap[e.name]){let t=this.elementMap[e.name],o=e.children.map(i=>this.renderDeserializedTemplateNode(i));return{...t,props:{...t.props,children:o}}}else return this.viewMap[e.name]?this.viewMap[e.name]:{isDCGElementSpec:!0,type:"element",tagName:"span",props:{children:[]}}}serializeToTemplateString(e){return uZ(e,{isView:_Z,isConst:Dye,isBinding:t=>typeof t=="function",isNamedBinding:Mye,getConstValue:t=>t(),getBindingName:t=>t.__DCGViewLocalizeBindingName,getViewName:t=>t.__DCGViewLocalizeViewName,addBinding:(t,o)=>{this.bindingMap[t]=o},addElement:(t,o)=>{this.elementMap[t]=o},addView:(t,o)=>{if(this.viewMap[t])throw new Error(`Unexpected duplicate view ${t}.`);this.viewMap[t]=o},forEachChild:(t,o)=>{for(let i of t.props.children){if(typeof i=="string"&&(i=this.const(i)),ll.isSpec(i)){if(i.type==="view"&&!_Z(i))throw new Error("Bare DCGViews are not allowed inside <Localize>. Use Localize.subview().");if(i.type==="fragment")throw new Error("<Localize> does not support fragments yet")}if(typeof i=="boolean")throw new Error("<Localize> does not expect boolean as children. Must be wrapped in getter");if(typeof i=="number")throw new Error("<Localize> does not expect number as children. Must be wrapped in getter");if(i===null)throw new Error("<Localize> does not expect null as children. Must be wrapped in getter");if(i===void 0)throw new Error("<Localize> does not expect undefined as children. Must be wrapped in getter");o(i)}}})}};function Dye(r){return typeof r=="function"&&r.isDCGViewConst}function SU(r){return`<0>${r}</0>`.replace(new RegExp(vU.source,"g"),(t,o)=>`<token id="${o}"/>`)}function Gi(r,e,t){return Aye(r,e)===t}function Aye(r,e){let t=r.getFocusLocation();if(!(!t||t.type!=="expression-menu"||t.id!==e))return t.location}function Vi(r,e,t,o){let i=e;t?r.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:i,location:o}}):r.dispatch({type:"blur-focus-location",location:{type:"expression-menu",id:i,location:o}})}var{If:kU,IfDefined:Lye}=Yl.Components,j1=class extends Yl.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:Yl.const("dcg-options-menu-section dcg-clickable-section"),children:[x("div",{class:Yl.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-heading-clickable"),l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-make-clickable"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleClickable)})]}),l(kU,{predicate:this.props.isOpen,children:()=>x("div",{class:Yl.const("dcg-options-menu-content"),children:[x("div",{class:Yl.const("dcg-clickable-menu-row"),children:[l("span",{class:Yl.const("dcg-input-label"),children:()=>this.controller.s("graphing-calculator-label-update-on-click")}),l(un,{latex:()=>this.model.clickableInfo.latex,ariaLabel:()=>this.controller.s("graphing-calculator-narration-click-action"),...ra(this.controller,{additionalOperators:["index"]}),placeholder:this.const(""),isFocused:()=>Gi(this.controller,this.model.id,"updaterule"),selectOnFocus:this.const(!0),getAriaPostLabel:this.const(""),hasError:()=>this.hasError(),onUserChangedLatex:this.bindFn(this.dispatchUpdateRuleLatexIfChanged),onFocusedChanged:e=>Vi(this.controller,this.model.id,e,"updaterule"),dataLabelAttributeValue:this.const("click-handler")}),Lye(()=>this.packedError(),e=>l("span",{class:Yl.const("dcg-clickable-info-error-container"),children:l(Zo,{error:()=>this.controller.unpack(e()),size:this.const("small")})}))]}),l(kU,{predicate:this.bindFn(this.isList),children:()=>l("div",{class:Yl.const("dcg-clickable-list-index-notice"),children:x(Ot,{i18n:this.const(this.controller),children:["Use"," ",l("span",{class:()=>({"dcg-index-variable-marker":!0,"dcg-btn":!0,"dcg-btn-light-gray":!0,"dcg-mathquill-has-focus":Gi(this.controller,this.model.id,"updaterule"),"dcg-do-not-blur":!0}),onTap:this.bindFn(this.insertIndex),children:"index"})," ","to reference the clicked index in the list."]},this.const("graphing-calculator-label-list-index"))})}),l(kU,{predicate:()=>this.model.type==="image",children:()=>l("div",{class:Yl.const("dcg-clickable-menu-row"),children:l(DA,{controller:()=>this.controller,model:()=>this.model})})})]})})]})}insertIndex(){this.controller.dispatch({type:"keypad/type-text",text:"index"})}isList(){return this.model.formula?!!this.model.formula.is_concrete_list:!1}hasError(){return this.packedError()!==void 0}packedError(){if(this.model.formula.click_handler&&this.model.formula.click_handler.status==="error")return this.model.formula.click_handler.error}toggleClickable(){this.controller.dispatch({type:"set-clickableinfo-prop",id:this.model.id,prop:"enabled",value:!this.model.clickableInfo.enabled}),this.model.clickableInfo.enabled&&Vi(this.controller,this.model.id,!0,"updaterule")}dispatchUpdateRuleLatexIfChanged(e){this.model.clickableInfo.latex!==e&&this.controller.dispatch({type:"set-clickableinfo-rule-latex",id:this.model.id,latex:e})}};var qk=__dcg_shared_module_exports__['e'](j());var Qi=__dcg_shared_module_exports__['e'](j());var{For:CZ,If:LA}=Qi.Components,X1=class extends Qi.View{init(){this.controller=this.props.controller()}template(){return x("div",{class:Qi.const("dcg-color-picker-container"),role:Qi.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-color-picker-label"),onKeyDown:this.bindFn(this.handleKeydown),children:[l("div",{class:Qi.const("dcg-color-picker-menu dcg-do-not-blur"),role:Qi.const("listbox"),"aria-label":()=>this.controller.s("graphing-calculator-narration-color-picker-standard-colors-label"),children:l(CZ,{each:()=>this.getColorValues(),children:e=>x("div",{class:Qi.const("dcg-color-tile"),handleEvent:Qi.const("true"),role:Qi.const("option"),"aria-label":()=>up(this.controller,e),tabIndex:()=>this.isSelected(e)||this.isFirstAndNoneSelected(e)?0:-1,"aria-selected":()=>this.isSelected(e),manageFocus:()=>ze({controller:this.controller,location:{type:"color-picker-option",category:"standard",color:e}}),onTap:()=>this.props.onColorSelected(e),children:[l(mh,{color:()=>({type:"single-color",value:e}),invertSwatches:()=>this.controller.invertSwatches()}),l(LA,{predicate:()=>this.isSelected(e),children:()=>l("i",{class:Qi.const("dcg-icon-check"),"aria-hidden":Qi.const("true")})})]})})}),l(LA,{predicate:()=>this.getUniqueCustomColors().length>0,children:()=>l("div",{class:Qi.const("dcg-color-picker-menu dcg-do-not-blur"),role:Qi.const("listbox"),"aria-label":()=>this.controller.s("graphing-calculator-narration-color-picker-custom-colors-label"),children:l(CZ,{each:this.bindFn(this.getUniqueCustomColors),children:e=>l(D1,{tooltip:()=>e.assignmentLatex,children:x("div",{class:Qi.const("dcg-color-tile"),handleEvent:Qi.const("true"),role:Qi.const("option"),"aria-label":()=>{let t=this.getColorValue(e);return t.type==="single-color"?up(this.controller,t.value):Mr(e.assignmentLatex)},tabIndex:()=>this.props.colorLatex()===e.assignmentLatex?0:-1,"aria-selected":()=>this.props.colorLatex()===e.assignmentLatex,manageFocus:()=>ze({controller:this.controller,location:{type:"color-picker-option",category:"custom",color:e.assignmentLatex}}),onTap:()=>this.props.onCustomColorSelected(e.assignmentLatex),children:[l(mh,{color:()=>this.getColorValue(e),invertSwatches:()=>this.controller.invertSwatches()}),l(LA,{predicate:()=>this.props.colorLatex()===e.assignmentLatex,children:()=>l("i",{class:()=>this.getCheckmarkClass(e),"aria-hidden":Qi.const("true")})}),l(LA,{predicate:()=>{var t,o;return((o=(t=this.props).customColorVisibility)==null?void 0:o.call(t))==="suppressed"},children:()=>l("i",{class:Qi.const("dcg-icon-lock")})})]})})},e=>e.assignmentLatex)})})]})}hideColorFunctions(){var e,t,o;return(o=(t=(e=this.props).hideColorFunctions)==null?void 0:t.call(e))!=null?o:!1}isFirstAndNoneSelected(e){return e===this.getColorValues()[0]&&!this.props.selectedColor()}isSelected(e){let t=this.props.colorLatex();return t&&__dcg_shared_module_exports__['La'](this.getUniqueCustomColors(),"assignmentLatex").indexOf(t)>=0?!1:this.props.selectedColor()===e}getColorValues(){return __dcg_shared_module_exports__['ab'](this.controller.getColors())}getUniqueCustomColors(){if(this.props.customColorVisibility&&this.props.customColorVisibility()==="hidden")return[];let e=[];e.push(...this.controller.getAllColorAssignments()),this.hideColorFunctions()||e.push(...this.controller.getAllColorFunctionAssignments());let t=__dcg_shared_module_exports__['Qa'](e,o=>o.assignmentLatex);return e.filter(o=>t[o.assignmentLatex]===1)}getColorValue(e){switch(e.id){case"shader":return{type:e.id};default:let t=this.controller.getColorById(e.id);return Array.isArray(t)?{type:"color-array",value:t}:/^data:image/.test(t)?{type:"image",value:t}:{type:"single-color",value:t}}}getCheckmarkClass(e){return iv(this.getColorValue(e),!1)?`dcg-icon-check ${lH(this.getColorValue(e),!1)?"dcg-light-color":"dcg-mixed-color"}`:"dcg-icon-check"}handleKeydown(e){let t=this.controller.getFocusLocation();if((t==null?void 0:t.type)!=="color-picker-option"||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;let o=Pe(e);if(o!=="Up"&&o!=="Down"&&o!=="Left"&&o!=="Right"&&o!=="Home"&&o!=="End")return;e.preventDefault(),e.stopPropagation();let i=this.getColorValues(),n=this.getUniqueCustomColors().map(p=>p.assignmentLatex),a=i.length,s=t.category==="standard"?i.indexOf(t.color):a+n.indexOf(t.color),c=s,d=i.length+n.length-1;o==="Left"&&(c=s-1),o==="Right"&&(c=s+1),o==="Home"&&(c=0),o==="End"&&(c=1/0),o==="Up"&&s-a>=0&&(c=s-a),o==="Down"&&s+a<=d&&(c=s+a),c=__dcg_shared_module_exports__['Rb'](c,0,d),c!==s&&(c<a?(this.props.onColorSelected(i[c]),this.controller.dispatch({type:"set-focus-location",location:{type:"color-picker-option",category:"standard",color:i[c]}})):(this.props.onCustomColorSelected(n[c-a]),this.controller.dispatch({type:"set-focus-location",location:{type:"color-picker-option",category:"custom",color:n[c-a]}})))}};var cm=class extends qk.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return l("div",{class:qk.const("dcg-options-menu-section"),children:l("div",{class:qk.const("dcg-options-menu-content"),children:l(X1,{controller:this.props.controller,colorLatex:this.bindFn(this.getColorLatex),selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideColorFunctions:this.bindFn(this.hideColorFunctions),customColorVisibility:this.bindFn(this.customColorVisibility)})})})}hideColorFunctions(){return this.model.type!=="expression"?!1:hb(this.model)||Fg(this.model)}customColorVisibility(){return this.model.type==="expression"&&Bv(this.model)||this.model.type==="table"?"hidden":"visible"}onColorSelected(e){this.model.type!=="image"&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-color",id:this.model.id,color:e}):this.model.type==="table"?this.controller.dispatch({type:"set-tableregression-color",color:e,tableId:this.model.id}):this.controller.dispatch({type:"set-tablecolumn-color",color:e,tableId:this.model.table.id,columnId:this.model.id}))}onCustomColorSelected(e){this.model.type!=="image"&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-colorlatex",id:this.model.id,colorLatex:e}):this.model.type==="table-column"&&this.controller.dispatch({type:"set-tablecolumn-colorlatex",tableId:this.model.table.id,columnId:this.model.id,colorLatex:e}))}getColorLatex(){var e,t;return this.model.type==="image"?"":this.model.type==="table"?(t=(e=this.model.regression)==null?void 0:e.color)!=null?t:"":this.model.colorLatex}getModelColor(){var e,t;return this.model.type==="image"?"":this.model.type==="table"?(t=(e=this.model.regression)==null?void 0:e.color)!=null?t:"":Eg(this.model)}};var yd=__dcg_shared_module_exports__['e'](j());var{If:Pye,For:Gye}=yd.Components,$1=class extends yd.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:yd.const("dcg-options-menu-section"),children:[x("div",{class:yd.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-heading-drag"),l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-menu-drag-enabled"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleDragEnabled)})]}),l(Pye,{predicate:this.props.isOpen,children:()=>l("div",{class:yd.const("dcg-options-menu-content"),children:l("div",{class:yd.const("dcg-style-icons"),role:yd.const("radiogroup"),children:l(Gye,{each:()=>[__dcg_shared_module_exports__['Gd'].X,__dcg_shared_module_exports__['Gd'].Y,__dcg_shared_module_exports__['Gd'].XY],children:e=>l("div",{class:()=>({"dcg-style-icon-container":!0,"dcg-disabled":this.isDisabled(e)}),onTap:()=>this.onDragModeSelected(e),role:yd.const("radio"),tabIndex:()=>this.isDisabled(e)?-1:0,"aria-label":()=>e==="X"?this.controller.s("graphing-calculator-narration-drag-mode-x"):e==="Y"?this.controller.s("graphing-calculator-narration-drag-mode-y"):e==="XY"?this.controller.s("graphing-calculator-narration-drag-mode-xy"):this.controller.raw(""),"aria-checked":()=>this.getDragMode()===e,children:l(qo,{backgroundColor:()=>({type:"single-color",value:"#000"}),semiTransparent:()=>this.getDragMode()!==e,iconType:()=>e==="X"?"movable-horizontal":e==="Y"?"movable-vertical":"movable-both"})})})})})})]})}isDisabled(e){let t=this.controller.getEnabledDragModesForItem(this.model.id);return!__dcg_shared_module_exports__['Ka'](t,e)}onDragModeSelected(e){if(this.model.type==="expression"){if(this.isDisabled(e))return;this.controller.dispatch({type:"set-item-dragmode",id:this.model.id,dragMode:e})}else{let t=this.model.id,o=this.model.table.id;this.controller.dispatch({type:"set-tablecolumn-dragmode",tableId:o,columnId:t,dragMode:e})}}getDragMode(){return this.model.type==="expression"?co(this.model)||this.model.dragMode:this.model.dragMode}toggleDragEnabled(){let e=this.getDragMode()!==__dcg_shared_module_exports__['Gd'].NONE?__dcg_shared_module_exports__['Gd'].NONE:__dcg_shared_module_exports__['Gd'].XY;this.model.type==="expression"?this.controller.dispatch({type:"set-item-dragmode",id:this.model.id,dragMode:e}):this.onDragModeSelected(e)}};var xd=__dcg_shared_module_exports__['e'](j());var{If:TZ}=xd.Components,PA=class extends xd.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:xd.const("dcg-options-menu-section"),children:[x("div",{class:xd.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-heading-fill"),l(TZ,{predicate:()=>!this.isInequality(),children:()=>l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-fill-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleFillVisible)})})]}),l(TZ,{predicate:this.props.isOpen,children:()=>l("div",{class:xd.const("dcg-options-menu-content"),children:x("div",{class:xd.const("dcg-iconed-mathquill-row dcg-fill-opacity-row"),children:[l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),children:l("i",{class:xd.const("dcg-icon-opacity"),"aria-hidden":xd.const("true")})}),l(or,{latex:()=>this.model.fillOpacity,placeholder:this.bindFn(this.getFillOpacity),isFocused:()=>Gi(this.controller,this.model.id,"opacity"),ariaPostLabel:()=>b3(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-fill-opacity"),hasError:()=>!b3(this.model),handleLatexChanged:this.bindFn(this.dispatchOpacityLatexIfChanged),dataLabelAttributeValue:this.const("fill-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>Vi(this.controller,this.model.id,e,"opacity")})]})})})]})}getFillOpacity(){return""+.4}isInequality(){return xp(this.model)}toggleFillVisible(){this.controller.dispatch({type:"set-item-fill",id:this.model.id,fill:!this.props.isOpen()})}dispatchOpacityLatexIfChanged(e){this.model.fillOpacity!==e&&this.controller.dispatch({type:"set-item-fillopacity",id:this.model.id,fillOpacity:e})}};var Wb=__dcg_shared_module_exports__['e'](j());var{If:Oye}=Wb.Components,dm=class extends Wb.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return l(Oye,{predicate:()=>this.isVisible(),children:()=>l("div",{class:Wb.const("dcg-options-menu-section dcg-interactivity-section dcg-section-without-title"),children:l("div",{class:Wb.const("dcg-options-menu-content"),children:l(ft,{checked:()=>$n(this.model),onChange:()=>this.toggleGraphInteractionsDisabled(),ariaLabel:()=>this.controller.s("graphing-calculator-label-disable-graph-interactions"),children:()=>this.controller.s("graphing-calculator-label-disable-graph-interactions")})})})})}isVisible(){return this.controller.shouldShowAuthorFeatures()}toggleGraphInteractionsDisabled(){this.model.type==="table-column"?this.controller.dispatch({type:"set-tablecolumn-disable-graph-interactions",tableId:this.model.table.id,columnId:this.model.id,disableGraphInteractions:!$n(this.model)}):this.controller.dispatch({type:"set-item-disable-graph-interactions",id:this.model.id,disableGraphInteractions:!$n(this.model)})}};var ka=__dcg_shared_module_exports__['e'](j());var vd=__dcg_shared_module_exports__['e'](j());var{For:Rye}=vd.Components,Fye=[{orientation:__dcg_shared_module_exports__['Od'].DEFAULT,cssClass:"dcg-label-orientation-center",description:"graphing-calculator-text-label-orientation-default"},{orientation:__dcg_shared_module_exports__['Od'].ABOVE,cssClass:"dcg-label-orientation-above",description:"graphing-calculator-text-label-orientation-above"},{orientation:__dcg_shared_module_exports__['Od'].ABOVE_RIGHT,cssClass:"dcg-label-orientation-above-right",description:"graphing-calculator-text-label-orientation-above-right"},{orientation:__dcg_shared_module_exports__['Od'].RIGHT,cssClass:"dcg-label-orientation-right",description:"graphing-calculator-text-label-orientation-right"},{orientation:__dcg_shared_module_exports__['Od'].BELOW_RIGHT,cssClass:"dcg-label-orientation-below-right",description:"graphing-calculator-text-label-orientation-below-right"},{orientation:__dcg_shared_module_exports__['Od'].BELOW,cssClass:"dcg-label-orientation-below",description:"graphing-calculator-text-label-orientation-below"},{orientation:__dcg_shared_module_exports__['Od'].BELOW_LEFT,cssClass:"dcg-label-orientation-below-left",description:"graphing-calculator-text-label-orientation-below-left"},{orientation:__dcg_shared_module_exports__['Od'].LEFT,cssClass:"dcg-label-orientation-left",description:"graphing-calculator-text-label-orientation-left"},{orientation:__dcg_shared_module_exports__['Od'].ABOVE_LEFT,cssClass:"dcg-label-orientation-above-left",description:"graphing-calculator-text-label-orientation-above-left"}],GA=class extends vd.View{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return x("div",{class:vd.const("dcg-label-orientation-view"),style:()=>`transform: rotate(${this.getCSSRotationValue()});`,children:[l("span",{class:vd.const("dcg-vertical-orientation-indicator")}),l("div",{class:vd.const("dcg-label-orientations"),role:vd.const("radiogroup"),"aria-label":()=>this.controller.s("graphing-calculator-heading-label-orientation"),children:l(Rye,{each:()=>Fye,children:e=>l("div",{class:()=>({[e.cssClass]:!0,"dcg-orientation-option":!0,"dcg-selected":this.isSelected(e.orientation),"dcg-orientation-disabled":this.isDisabled(e.orientation)}),role:vd.const("radio"),tabIndex:vd.const("0"),"aria-label":()=>this.controller.s(e.description),"aria-checked":()=>this.getOrientation()===e.orientation,onTap:()=>this.onTapOrientation(e.orientation),children:l("i",{class:()=>({"dcg-icon-chevron-left":e.orientation!==__dcg_shared_module_exports__['Od'].DEFAULT})})})},e=>e.orientation)})]})}isDisabled(e){return e!==__dcg_shared_module_exports__['Od'].DEFAULT?!1:this.isPointVisible()?!0:this.model.labelOrientation===__dcg_shared_module_exports__['Od'].DEFAULT}isSelected(e){return e===__dcg_shared_module_exports__['Od'].DEFAULT&&e===this.model.labelOrientation?!this.isPointVisible():e===this.model.labelOrientation}isPointVisible(){return this.model.hidden?!1:Dn(this.model)?!this.model.hidden:this.model.points}getCSSRotationValue(){let e=L7(this.model);return`${Array.isArray(e)?0:e}rad`}getOrientation(){return this.props.model().labelOrientation}onTapOrientation(e){e===this.getOrientation()&&(e=__dcg_shared_module_exports__['Od'].DEFAULT),this.controller.dispatch({type:"set-item-label-orientation",id:this.id,labelOrientation:e})}};var J1=__dcg_shared_module_exports__['e'](j());var Z1=class extends J1.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:J1.const("dcg-iconed-mathquill-row dcg-point-opacity-row"),children:[l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),children:l("i",{class:J1.const("dcg-icon-opacity"),"aria-hidden":J1.const("true")})}),l(or,{latex:()=>this.model.pointOpacity,placeholder:this.bindFn(this.getPointOpacityPlaceholder),isFocused:()=>Gi(this.controller,this.model.id,"pointopacity"),ariaPostLabel:()=>this.isPointOpacityValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-line-opacity"),hasError:()=>!this.isPointOpacityValid(),handleLatexChanged:this.bindFn(this.dispatchPointOpacityLatexIfChanged),dataLabelAttributeValue:this.const("point-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>Vi(this.controller,this.model.id,e,"pointopacity")})]})}isPointOpacityValid(){return this.model.type==="expression"?M7(this.model):this.model.type==="table-column"?Aq(this.model):!1}dispatchPointOpacityLatexIfChanged(e){this.model.pointOpacity!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointopacity",id:this.model.id,pointOpacity:e}):this.controller.dispatch({type:"set-tablecolumn-pointopacity",columnId:this.model.id,tableId:this.model.table.id,pointOpacity:e}))}getPointOpacityPlaceholder(){return`${1}`}};var{If:Hk}=ka.Components,VA=class extends ka.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:ka.const("dcg-options-menu-section"),children:[x("div",{class:ka.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-heading-label"),l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLabelVisible)})]}),l(Hk,{predicate:this.props.isOpen,children:()=>x("div",{class:ka.const("dcg-options-menu-content"),children:[x("div",{class:ka.const("dcg-options-flex-container"),children:[x("div",{class:ka.const("dcg-options-left-side"),children:[l(Hk,{predicate:this.props.showPointOpacity,children:()=>l(Z1,{...this.props})}),x("div",{class:ka.const("dcg-iconed-mathquill-row dcg-label-size-row"),children:[l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-label-size-tooltip"),children:l("span",{class:ka.const("dcg-font-size"),children:"A"})}),l(or,{latex:()=>this.model.labelSize,placeholder:()=>"1",isFocused:()=>Gi(this.controller,this.model.id,"labelsize"),ariaPostLabel:()=>x3(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-size"),hasError:()=>!x3(this.model),handleLatexChanged:this.bindFn(this.dispatchLabelSizeIfChanged),dataLabelAttributeValue:this.const("label-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>Vi(this.controller,this.model.id,e,"labelsize")})]}),x("div",{class:()=>({"dcg-iconed-mathquill-row":!0,"dcg-label-angle-row":!0,"dcg-suffix-degree":this.props.controller().getGraphSettings().degreeMode,"dcg-suffix-radian":!this.props.controller().getGraphSettings().degreeMode}),children:[l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-angle-tooltip"),children:l("i",{class:ka.const("dcg-icon-angle"),"aria-hidden":ka.const("true")})}),l(or,{latex:()=>this.model.labelAngle,placeholder:()=>"0",isFocused:()=>Gi(this.controller,this.model.id,"labelangle"),ariaPostLabel:()=>v3(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-angle"),hasError:()=>!v3(this.model),handleLatexChanged:this.bindFn(this.dispatchLabelAngleIfChanged),dataLabelAttributeValue:this.const("label-angle"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>Vi(this.controller,this.model.id,e,"labelangle")})]})]}),l("div",{class:ka.const("dcg-options-right-side"),children:l(GA,{controller:()=>this.controller,model:()=>this.model})})]}),x("div",{class:ka.const("dcg-label-advanced"),children:[l(ft,{checked:this.bindFn(this.getWhiteTextOutline),onChange:this.bindFn(this.setWhiteTextOutline),disabled:()=>this.getEditable(),children:()=>this.controller.s("graphing-calculator-button-label-text-outline")}),l(Hk,{predicate:()=>this.controller.canUseAdvancedStyling(),children:()=>x("div",{role:ka.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-advanced"),children:[l(Hk,{predicate:()=>this.shouldShowHoverLabelCheckbox(),children:()=>l(ft,{checked:this.bindFn(this.getInteractiveLabel),onChange:this.bindFn(this.setInteractiveLabel),children:()=>this.controller.s("graphing-calculator-button-label-show-on-hover")})}),l(Hk,{predicate:this.bindFn(this.shouldShowEditableLabelToggle),children:()=>l(ft,{checked:this.bindFn(this.getEditable),onChange:this.bindFn(this.setEditable),children:()=>this.controller.s("graphing-calculator-button-label-editable")})})]})})]})]})})]})}getWhiteTextOutline(){return this.getEditable()?!1:!this.model.suppressTextOutline}setWhiteTextOutline(e){this.controller.dispatch({type:"set-suppress-text-outline",id:this.model.id,suppressTextOutline:!e})}setInteractiveLabel(e){this.controller.dispatch({type:"set-item-interactive-label",id:this.model.id,interactiveLabel:e})}getInteractiveLabel(){return!!this.model.interactiveLabel}setEditable(e){if(e){let t=__dcg_shared_module_exports__['Ke'](this.model.label)==="latex"?__dcg_shared_module_exports__['$d'].Math:__dcg_shared_module_exports__['$d'].Text;this.controller.dispatch({type:"set-item-editable-label-mode",id:this.model.id,editableLabelMode:t})}else this.controller.dispatch({type:"set-item-editable-label-mode",id:this.model.id,editableLabelMode:__dcg_shared_module_exports__['$d'].None})}getEditable(){return this.model.editableLabelMode!==__dcg_shared_module_exports__['$d'].None}shouldShowEditableLabelToggle(){return Dn(this.model)}shouldShowHoverLabelCheckbox(){return co(this.model)===__dcg_shared_module_exports__['Gd'].NONE}dispatchLabelAngleIfChanged(e){this.model.labelAngle!==e&&this.controller.dispatch({type:"set-item-labelangle",id:this.model.id,labelAngle:e})}dispatchLabelSizeIfChanged(e){this.model.labelSize!==e&&this.controller.dispatch({type:"set-item-labelSize",id:this.model.id,labelSize:e})}toggleLabelVisible(){this.controller.dispatch({type:"set-item-showlabel",id:this.model.id,showLabel:!this.props.isOpen()})}};var _a=__dcg_shared_module_exports__['e'](j());var{If:EZ}=_a.Components,Q1=class extends _a.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:_a.const("dcg-options-menu-section"),children:[x("div",{class:_a.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-heading-lines"),l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-lines-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLinesVisible)})]}),l(EZ,{predicate:()=>this.props.isOpen(),children:()=>l("div",{class:_a.const("dcg-options-menu-content"),children:x("div",{class:_a.const("dcg-options-flex-container"),children:[x("div",{class:_a.const("dcg-options-left-side"),children:[x("div",{class:_a.const("dcg-iconed-mathquill-row dcg-line-opacity-row"),children:[l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),children:l("i",{class:_a.const("dcg-icon-opacity"),"aria-hidden":_a.const("true")})}),l(or,{latex:()=>this.model.lineOpacity,placeholder:this.bindFn(this.getLineOpacity),isFocused:()=>Gi(this.controller,this.model.id,"lineopacity"),ariaPostLabel:()=>this.isLineOpacityValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-line-opacity"),hasError:()=>!this.isLineOpacityValid(),handleLatexChanged:this.bindFn(this.dispatchLineOpacityLatexIfChanged),dataLabelAttributeValue:this.const("line-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>Vi(this.controller,this.model.id,e,"lineopacity")})]}),x("div",{class:_a.const("dcg-iconed-mathquill-row dcg-line-thickness-row"),children:[l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-line-thickness-tooltip"),children:l("i",{class:_a.const("dcg-icon-line-thickness"),"aria-hidden":_a.const("true")})}),l(or,{latex:()=>this.model.lineWidth,placeholder:this.bindFn(this.getLineWidth),isFocused:()=>Gi(this.controller,this.model.id,"linewidth"),ariaPostLabel:()=>this.isLineWidthValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-line-thickness-tooltip"),hasError:()=>!this.isLineWidthValid(),handleLatexChanged:this.bindFn(this.dispatchLineWidthLatexIfChanged),dataLabelAttributeValue:this.const("line-width"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>Vi(this.controller,this.model.id,e,"linewidth")})]})]}),l("div",{class:_a.const("dcg-options-right-side"),children:l(EZ,{predicate:this.bindFn(this.shouldShowLineStyles),children:()=>l(ar,{staticConfig:this.bindFn(this.getPointStyleOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-style"),theme:this.const("mini")})})})]})})})]})}getLineWidth(){return""+2.5}getLineOpacity(){return""+1}getPointStyleOptions(){return[__dcg_shared_module_exports__['Dd'].SOLID,__dcg_shared_module_exports__['Dd'].DASHED,__dcg_shared_module_exports__['Dd'].DOTTED].map(t=>({key:t,icon:()=>this.getStyleIcon(t),ariaLabel:()=>this.getStyleAria(t),selected:()=>this.model.lineStyle===t,class:()=>"dcg-line-segmented-option",onSelect:()=>{this.onLineStyleSelected(t)}}))}getStyleIcon(e){switch(e){case __dcg_shared_module_exports__['Dd'].SOLID:return"dcg-icon-line-solid";case __dcg_shared_module_exports__['Dd'].DASHED:return"dcg-icon-line-dashed";case __dcg_shared_module_exports__['Dd'].DOTTED:return"dcg-icon-line-dotted"}}getStyleAria(e){let t=this.controller.s;switch(e){case __dcg_shared_module_exports__['Dd'].SOLID:return t("graphing-calculator-narration-line-style-solid");case __dcg_shared_module_exports__['Dd'].DASHED:return t("graphing-calculator-narration-line-style-dashed");case __dcg_shared_module_exports__['Dd'].DOTTED:return t("graphing-calculator-narration-line-style-dotted")}}isLineOpacityValid(){return this.model.type==="expression"?I7(this.model):this.model.type==="table-column"?Iq(this.model):!1}isLineWidthValid(){return this.model.type==="expression"?RM(this.model):this.model.type==="table-column"?Mq(this.model):!1}dispatchLineOpacityLatexIfChanged(e){this.model.lineOpacity!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-lineopacity",id:this.model.id,lineOpacity:e}):this.controller.dispatch({type:"set-tablecolumn-lineopacity",tableId:this.model.table.id,columnId:this.model.id,lineOpacity:e}))}shouldShowLineStyles(){return!(this.model.type==="expression"&&xp(this.model))}onLineStyleSelected(e){this.model.lineStyle!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-linestyle",id:this.model.id,lineStyle:e}):this.controller.dispatch({type:"set-tablecolumn-linestyle",tableId:this.model.table.id,columnId:this.model.id,lineStyle:e}))}dispatchLineWidthLatexIfChanged(e){this.model.lineWidth!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-linewidth",id:this.model.id,lineWidth:e}):this.controller.dispatch({type:"set-tablecolumn-linewidth",tableId:this.model.table.id,columnId:this.model.id,lineWidth:e}))}toggleLinesVisible(){this.model.type==="expression"?this.controller.dispatch({type:"set-item-lines",id:this.model.id,lines:!this.props.isOpen()}):this.controller.dispatch({type:"set-tablecolumn-lines",tableId:this.model.table.id,columnId:this.model.id,bool:!this.props.isOpen()})}};var wd=__dcg_shared_module_exports__['e'](j());var{If:Uye}=wd.Components,RA=class extends wd.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:wd.const("dcg-options-menu-section"),children:[x("div",{class:wd.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-heading-lines"),l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-lines-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLinesVisible)})]}),l(Uye,{predicate:()=>this.props.isOpen(),children:()=>l("div",{class:wd.const("dcg-options-menu-content"),children:x("div",{class:wd.const("dcg-iconed-mathquill-row dcg-line-thickness-row-3d"),children:[l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-line-thickness-3d-tooltip"),children:l("i",{class:wd.const("dcg-icon-line-thickness"),"aria-hidden":wd.const("true")})}),l(or,{latex:()=>this.model.lineWidth,placeholder:()=>`${1}`,isFocused:()=>Gi(this.controller,this.model.id,"linewidth"),ariaPostLabel:()=>this.isLineWidthValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-line-thickness-3d-tooltip"),hasError:()=>!this.isLineWidthValid(),handleLatexChanged:this.bindFn(this.dispatchLineWidthLatexIfChanged),dataLabelAttributeValue:this.const("line-width"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>Vi(this.controller,this.model.id,e,"linewidth")})]})})})]})}toggleLinesVisible(){this.controller.dispatch({type:"set-item-lines",id:this.model.id,lines:!this.props.isOpen()})}isLineWidthValid(){return this.model.type==="expression"?RM(this.model):!1}dispatchLineWidthLatexIfChanged(e){this.model.lineWidth!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-linewidth",id:this.model.id,lineWidth:e})}};var cl=__dcg_shared_module_exports__['e'](j());var{If:MZ}=cl.Components,ew=class extends cl.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:cl.const("dcg-options-menu-section"),children:[x("div",{class:cl.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-heading-points"),l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-points-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.togglePointsVisible)})]}),l(MZ,{predicate:this.props.isOpen,children:()=>x("div",{class:cl.const("dcg-options-menu-content"),children:[x("div",{class:cl.const("dcg-options-flex-container dcg-options--point-styles"),children:[x("div",{class:cl.const("dcg-options-left-side"),children:[l(Z1,{...this.props}),l(MZ,{predicate:()=>this.model.type==="expression"||!this.isDraggable(),children:()=>x("div",{class:cl.const("dcg-iconed-mathquill-row dcg-point-size-row"),children:[l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-point-size-tooltip"),children:l("i",{class:cl.const("dcg-icon-line-thickness"),"aria-hidden":cl.const("true")})}),l(or,{latex:this.bindFn(this.getPointSize),placeholder:this.bindFn(this.getDefaultPointSize),isFocused:()=>Gi(this.controller,this.model.id,"pointsize"),ariaPostLabel:()=>this.isPointSizeValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-point-size"),hasError:()=>!this.isPointSizeValid(),handleLatexChanged:e=>this.dispatchPointSizeLatexIfChanged(e),dataLabelAttributeValue:this.const("point-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>Vi(this.controller,this.model.id,e,"pointsize")})]})})]}),l("div",{class:cl.const("dcg-options-right-side"),children:l(ar,{staticConfig:this.bindFn(this.getPointStyleOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-style"),theme:this.const("mini"),numRows:this.const(2)})})]}),l(ft,{checked:this.bindFn(this.getWhiteOutline),onChange:this.bindFn(this.setWhiteOutline),children:()=>this.controller.s("graphing-calculator-button-label-point-outline")})]})})]})}getPointSize(){return this.isDraggable()&&this.model.type==="expression"?this.model.movablePointSize:this.model.pointSize}getPointStyleOptions(){return[__dcg_shared_module_exports__['Cd'].POINT,__dcg_shared_module_exports__['Cd'].OPEN,__dcg_shared_module_exports__['Cd'].CROSS,__dcg_shared_module_exports__['Cd'].SQUARE,__dcg_shared_module_exports__['Cd'].PLUS,__dcg_shared_module_exports__['Cd'].TRIANGLE,__dcg_shared_module_exports__['Cd'].DIAMOND,__dcg_shared_module_exports__['Cd'].STAR].map(t=>({key:t,icon:()=>this.getStyleIcon(t),ariaLabel:()=>this.getStyleAria(t),selected:()=>this.model.pointStyle===t,class:()=>"dcg-point-segmented-option",onSelect:()=>{this.onPointStyleSelected(t)}}))}getStyleIcon(e){switch(e){case __dcg_shared_module_exports__['Cd'].POINT:return"dcg-icon-point-closed";case __dcg_shared_module_exports__['Cd'].OPEN:return"dcg-icon-point-open";case __dcg_shared_module_exports__['Cd'].CROSS:return"dcg-icon-point-cross";case __dcg_shared_module_exports__['Cd'].SQUARE:return"dcg-icon-point-square";case __dcg_shared_module_exports__['Cd'].PLUS:return"dcg-icon-point-plus";case __dcg_shared_module_exports__['Cd'].TRIANGLE:return"dcg-icon-point-triangle";case __dcg_shared_module_exports__['Cd'].DIAMOND:return"dcg-icon-point-diamond";case __dcg_shared_module_exports__['Cd'].STAR:return"dcg-icon-point-star"}}getStyleAria(e){let t=this.controller.s;switch(e){case __dcg_shared_module_exports__['Cd'].POINT:return t("graphing-calculator-narration-point-style-point");case __dcg_shared_module_exports__['Cd'].OPEN:return t("graphing-calculator-narration-point-style-open");case __dcg_shared_module_exports__['Cd'].CROSS:return t("graphing-calculator-narration-point-style-cross");case __dcg_shared_module_exports__['Cd'].SQUARE:return t("graphing-calculator-narration-point-style-square");case __dcg_shared_module_exports__['Cd'].PLUS:return t("graphing-calculator-narration-point-style-plus");case __dcg_shared_module_exports__['Cd'].TRIANGLE:return t("graphing-calculator-narration-point-style-triangle");case __dcg_shared_module_exports__['Cd'].DIAMOND:return t("graphing-calculator-narration-point-style-diamond");case __dcg_shared_module_exports__['Cd'].STAR:return t("graphing-calculator-narration-point-style-star")}}isPointSizeValid(){return this.model.type==="expression"?this.isDraggable()?D7(this.model):OM(this.model):this.model.type==="table-column"?Dq(this.model):!1}onPointStyleSelected(e){this.model.pointStyle!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointstyle",id:this.model.id,pointStyle:e}):this.controller.dispatch({type:"set-tablecolumn-pointstyle",columnId:this.model.id,tableId:this.model.table.id,pointStyle:e}))}dispatchPointSizeLatexIfChanged(e){this.getPointSize()!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointsize",id:this.model.id,pointSize:e}):this.controller.dispatch({type:"set-tablecolumn-pointsize",columnId:this.model.id,tableId:this.model.table.id,pointSize:e}))}getWhiteOutline(){return this.model.pointOutline}setWhiteOutline(e){this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointoutline",id:this.model.id,pointOutline:e}):this.controller.dispatch({type:"set-tablecolumn-pointoutline",columnId:this.model.id,tableId:this.model.table.id,pointOutline:e})}isDraggable(){return this.getDragMode()!==__dcg_shared_module_exports__['Gd'].NONE}togglePointsVisible(){this.model.type==="expression"&&Dn(this.model)?this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id}):this.model.type==="expression"?this.controller.dispatch({type:"set-item-points",id:this.model.id,points:!this.props.isOpen()}):this.controller.dispatch({type:"set-tablecolumn-points",columnId:this.model.id,tableId:this.model.table.id,bool:!this.props.isOpen()})}getDragMode(){return this.model.type==="expression"?co(this.model)||this.model.dragMode:this.model.dragMode}getDefaultPointSize(){return this.model.type==="expression"&&ih(this.model)?`${14}`:`${8}`}};var Sd=__dcg_shared_module_exports__['e'](j());var{If:Kye}=Sd.Components,FA=class extends Sd.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:Sd.const("dcg-options-menu-section"),children:[x("div",{class:Sd.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-heading-points"),l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-points-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.togglePointsVisible)})]}),l(Kye,{predicate:()=>this.props.isOpen(),children:()=>l("div",{class:Sd.const("dcg-options-menu-content"),children:x("div",{class:Sd.const("dcg-iconed-mathquill-row dcg-line-thickness-row-3d"),children:[l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-point-size-3d-tooltip"),children:l("i",{class:Sd.const("dcg-icon-line-thickness"),"aria-hidden":Sd.const("true")})}),l(or,{latex:()=>this.model.pointSize,placeholder:this.bindFn(this.getDefaultPointSize),isFocused:()=>Gi(this.controller,this.model.id,"pointsize"),ariaPostLabel:()=>this.isPointSizeValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-point-size"),hasError:()=>!this.isPointSizeValid(),handleLatexChanged:e=>this.dispatchPointSizeLatexIfChanged(e),dataLabelAttributeValue:this.const("point-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>Vi(this.controller,this.model.id,e,"pointsize")})]})})})]})}togglePointsVisible(){this.controller.dispatch({type:"set-item-points",id:this.model.id,points:!this.props.isOpen()})}isPointSizeValid(){return this.model.type==="expression"?OM(this.model):!1}dispatchPointSizeLatexIfChanged(e){this.model.pointSize!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-pointsize",id:this.model.id,pointSize:e})}getDefaultPointSize(){return`${3}`}};var NA=__dcg_shared_module_exports__['e'](j());var{Textarea:zye}=NA.Components,pm=class extends NA.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){var e,t,o;return l("div",{class:()=>{var i,n,a;return{"dcg-screen-reader-description--wrapper":!0,[(a=(n=(i=this.props).class)==null?void 0:n.call(i))!=null?a:""]:!!this.props.class}},children:l(zye,{placeholder:()=>this.controller.s("graphing-calculator-text-add-screen-reader-label-placeholder"),class:this.const("dcg-screen-reader-description--input dcg-shared-input-blue-outline"),manageFocus:this.const(ze({controller:this.controller,location:(o=(t=(e=this.props).focusLocation)==null?void 0:t.call(e))!=null?o:{type:"expression-menu",id:this.model.id,location:"alt-text"}})),value:()=>this.model.description,onInput:i=>this.controller.dispatch({type:"set-item-description",id:this.model.id,description:i})})})}};var kd=__dcg_shared_module_exports__['e'](j());var{If:CU}=kd.Components,UA=class extends kd.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:kd.const("dcg-options-menu-section"),children:[x("div",{class:kd.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-heading-surfaces"),l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-surfaces-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleSurfacesVisible)})]}),l(CU,{predicate:()=>this.props.isOpen(),children:()=>x("div",{style:kd.const("font-size:85%; margin-top:8px"),children:[l(CU,{predicate:()=>this.usesResolution()&&this.controller.getGraphSettings().config.beta3d,children:()=>x("div",{children:["Resolution:",l(or,{latex:()=>this.model.resolution,placeholder:()=>this.getDefaultResolution(),isFocused:()=>Gi(this.controller,this.model.id,"resolution"),ariaPostLabel:()=>this.isResolutionValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-resolution-tooltip"),hasError:()=>!this.isResolutionValid(),handleLatexChanged:this.bindFn(this.dispatchResolutionLatexIfChanged),dataLabelAttributeValue:this.const("resolution"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>Vi(this.controller,this.model.id,e,"resolution")})]})}),l(CU,{predicate:this.bindFn(this.shouldShowOpacity),children:()=>x("div",{class:kd.const("dcg-iconed-mathquill-row dcg-surface-opacity-row"),children:[l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("s"),children:l("i",{class:kd.const("dcg-icon-opacity"),"aria-hidden":kd.const("true")})}),l(or,{latex:()=>this.model.surfaceOpacity,isFocused:()=>Gi(this.controller,this.model.id,"opacity"),placeholder:this.const("1"),ariaPostLabel:()=>y3(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-surface-opacity"),hasError:()=>!y3(this.model),handleLatexChanged:this.bindFn(this.dispatchOpacityLatexIfChanged),dataLabelAttributeValue:this.const("surface-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>Vi(this.controller,this.model.id,e,"opacity")})]})})]})})]})}shouldShowOpacity(){return this.controller.getGraphSettings().config.beta3d?this.model.formula.is_inequality!==!0:!1}toggleSurfacesVisible(){this.controller.dispatch({type:"set-item-lines",id:this.model.id,lines:!this.props.isOpen()})}usesResolution(){return!AM(this.model)&&!v7(this.model)}dispatchResolutionLatexIfChanged(e){this.model.resolution!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-resolution",id:this.model.id,resolution:e})}isResolutionValid(){return this.model.type==="expression"?A7(this.model):!1}getDefaultResolution(){return this.model.type==="expression"&&w7(this.model)?`${__dcg_shared_module_exports__['kd']}`:`${__dcg_shared_module_exports__['ld']}`}dispatchOpacityLatexIfChanged(e){this.model.surfaceOpacity!==e&&this.controller.dispatch({type:"set-item-surfaceopacity",id:this.model.id,surfaceOpacity:e})}};var{For:qye}=jb.Components,Hye=["surfaces","points3d","lines3d","colors","clickable","description","disableGraphInteractions"],Wye=["points","label","drag","lines","colors","fill","clickable","description","disableGraphInteractions"],DZ=["fill","label","lines","lines3d","points","points3d","surfaces"];function dl(r,e){e.runAfterDispatch(()=>{if(!r)return;let t=r.closest(".dcg-options-menu-container"),o=e.findEl(".dcg-container"),i=e.getOpenMenuIcon(),n=!!r.closest(".dcg-table-column-menu");if(!t||!o||!i)return;let a=e.computeMajorLayout(),s=a.list.top+a.list.height,c=a.keypad.top,d=Math.min(s,c),p=o.getBoundingClientRect(),u=i.getBoundingClientRect(),g=d+p.top-u.top,h=t.offsetHeight,b=0;h>g&&(b=+g-h);let v=n?!b:-b<h-38;t.style.marginTop=`${n&&b<0?b-34:b}px`,r.style.marginTop=`${-b}px`,r.style.display=v?"":"none"})}function Sh(r,e){requestAnimationFrame(()=>{let t=e.getExppanelElt(),o=e.getOpenMenuIcon();r&&t&&o&&t.contains(o)&&re(t).on(`scroll.${r}`,()=>{re(t).off(`scroll.${r}`);let i=e.getFocusLocation(),n=e.getOpenItemMenu();i&&n&&i.type==="expression-menu"&&"model"in n&&i.id===n.model.id&&e.dispatch({type:"blur-focus-location",location:i}),e.dispatch({type:"close-item-settings-menu"})})})}function kh(r,e){let t=e.getExppanelElt();t&&r&&re(t).off(`scroll.${r}`)}var tw=class extends jb.View{init(){var e;this.controller=this.props.controller(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){Sh(this.guid,this.controller)}willUnmount(){kh(this.guid,this.controller)}didUpdate(){dl(this.arrowElt,this.controller)}getSections(){let e=(this.controller.isThreeDMode()?Hye:Wye).filter(i=>this.shouldShowSection(i)),t=e.find(i=>DZ.includes(i)&&this.isSectionOpen(i));if(!t)return e;e=e.filter(i=>i!=="colors");let o=e.findIndex(i=>i===t);return e.splice(o+1,0,"colors"),e}template(){let e=this.props.model();return x("div",{class:()=>({"dcg-expressions-options-menu":!0,"dcg-options-menu":!0}),role:jb.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu"),children:[l("div",{children:l(qye,{each:this.bindFn(this.getSections),children:t=>{switch(t){case"points":return l(ew,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("points")});case"label":return l(VA,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("label"),showPointOpacity:()=>this.isFirstOpenSection("label")});case"drag":return l($1,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("drag")});case"lines":return l(Q1,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("lines")});case"fill":return l(PA,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("fill")});case"colors":return l(cm,{model:()=>e,controller:this.bindFn(this.props.controller)});case"description":return l(pm,{class:this.const("dcg-options-menu-section"),model:()=>e,controller:this.bindFn(this.props.controller)});case"points3d":return l(FA,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("points3d")});case"lines3d":return l(RA,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("lines3d")});case"surfaces":return l(UA,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("surfaces")});case"clickable":return l(j1,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>!!e.clickableInfo.enabled});case"disableGraphInteractions":return l(dm,{model:()=>e,controller:()=>this.props.controller()})}}})}),l("div",{class:jb.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0})]})}didMountArrow(e){this.arrowElt=e,dl(this.arrowElt,this.controller)}shouldShowClickableSection(){let e=this.props.model();return this.controller.areActionsEnabled()&&Z0(e)&&!this.controller.isItemReadonly(e.id)&&(this.controller.shouldShowAuthorFeatures()||!$n(e))}shouldShowDragSection(){let e=this.props.model();return this.controller.shouldShowAuthorFeatures()||!$n(e)}shouldShowSection(e){let t=this.props.model(),o=Dn(t)||ih(t),i=ok(t)&&(t.extendTo3D||t.formula.expression_type===__dcg_shared_module_exports__['Vc'].IMPLICIT_SURFACE_AMBIGUOUS)||!ok(t)&&g3(t),n=gb(t)||Ng(t)||Bv(t)||_7(t)||Lg(t);switch(e){case"points":return!n&&(o||Rg(t));case"lines":return!o&&!n;case"colors":return n||DZ.some(a=>this.isSectionOpen(a));case"fill":return Dv(t)||Kv(t)||xp(t)&&!(zv(t)||LM(t)||m3(t));case"label":return Rg(t)||Dn(t);case"drag":return Dn(t)&&!!t.formula.move_strategy&&this.shouldShowDragSection();case"clickable":return this.shouldShowClickableSection();case"description":return cM(t);case"disableGraphInteractions":return this.controller.shouldShowAuthorFeatures();case"surfaces":return i;case"lines3d":return!i&&!(Dn(t)||hb(t));case"points3d":return Rg(t)||Fg(t)||Dn(t)||hb(t);default:return e}}isFirstOpenSection(e){return this.getSections().find(t=>this.isSectionOpen(t))===e}isSectionOpen(e){let t=this.props.model(),{points:o,lines:i,fill:n}=t,a=__dcg_shared_module_exports__['Wc'](t.formula.expression_type,{points:o,lines:i,fill:n},s=>{Er("getReconciledExpressionProps [Chrome Switch Bug]",{metaData:{method:"isSectionOpen",type:s}})});switch(e){case"lines":return t.hidden?!1:a.lines;case"label":return ws(t);case"fill":return t.hidden?!1:xp(t)?!0:a.fill;case"points":return t.hidden?!1:Dn(t)?!t.hidden:a.points;case"drag":return co(t)!==__dcg_shared_module_exports__['Gd'].NONE;case"colors":case"disableGraphInteractions":case"clickable":case"description":return!0;case"points3d":return t.hidden?!1:a.points;case"lines3d":case"surfaces":return t.hidden?!1:a.lines}}};var YA=class{constructor(e){this.mq=e,this.id=e.id,this.data=e.data}simulateUserChangedLatex(){Qe.simulateUserChangedLatex(this.mq)}simulateKeypress(e){Qe.simulateKeypressFromKeypad(this.mq,e)}config(e){return this.mq.config(e),this}latex(e){return e===void 0?this.mq.latex():(this.mq.latex(e),this.simulateUserChangedLatex(),this)}reflow(){this.mq.reflow()}el(){return this.mq.el()}getAriaLabel(){return this.mq.getAriaLabel()}setAriaLabel(e){return this.mq.setAriaLabel(e)}html(){return this.mq.html()}mathspeak(){return this.mq.mathspeak()}text(){return this.mq.text()}selection(){return this.mq.selection()}select(){return this.mq.select(),this}moveToRightEnd(){return this.mq.moveToRightEnd(),this}moveToLeftEnd(){return this.mq.moveToLeftEnd(),this}cmd(e){return this.mq.cmd(e),this.simulateUserChangedLatex(),this}write(e){return this.mq.write(e),this.simulateUserChangedLatex(),this}keystroke(e){return this.simulateKeypress(e),this}typedText(e){return this.mq.typedText(e),this.simulateUserChangedLatex(),this}clearSelection(){return this.mq.clearSelection(),this}getAriaPostLabel(){return this.mq.getAriaPostLabel()}setAriaPostLabel(e,t){return this.mq.setAriaPostLabel(e,t),this}blur(){return this.mq.blur(),this}focus(){return this.mq.focus(),this}revert(){return this.mq.revert()}ignoreNextMousedown(e){return this.mq.ignoreNextMousedown(e),this}clickAt(e,t,o){return this.mq.clickAt(e,t,o),this}};function AZ(r){let e=r.mode,t=r.width,o=r.height,i=r.currentBounds,n=r.graphpaperAspectRatio,a=r.mathAspectRatio,s=r.mathBounds,c=t/o,d={x:i.left+i.width/2,y:i.bottom+i.height/2};if(s.left===void 0!=(s.right===void 0)||s.bottom===void 0!=(s.top===void 0))return __dcg_shared_module_exports__['Be'].warn('asyncScreenshot: cannot specify "left" bound without "right" or "bottom" bound without "top". Got: '+s),i;let p=s.left!==void 0&&s.right!==void 0,u=s.bottom!==void 0&&s.top!==void 0,g=p&&u,h,b,v,T,E,I,_,C,D,P;switch(e){case"stretch":return g?s:p?{left:s.left,right:s.right,bottom:i.bottom,top:i.top}:u?{left:i.left,right:i.right,bottom:s.bottom,top:s.top}:i;case"contain":return g?(T=s.right-s.left,E=s.top-s.bottom,I={x:s.left+T/2,y:s.bottom+E/2},v=T/E,c>v?(b=E/o,h=b*a,{left:I.x-h*t/2,right:I.x+h*t/2,bottom:s.bottom,top:s.top}):(h=T/t,b=h/a,{left:s.left,right:s.right,bottom:I.y-b*o/2,top:I.y+b*o/2})):p?(_=s.right-s.left,C=s.left+_/2,v=_/i.height,c>v?(b=i.height/o,h=b*a,{left:C-h*t/2,right:C+h*t/2,bottom:i.bottom,top:i.top}):(h=_/t,b=h/a,{left:s.left,right:s.right,bottom:d.y-b*o/2,top:d.y+b*o/2})):u?(D=s.top-s.bottom,P=s.bottom+D/2,v=i.width/D,c>v?(b=D/o,h=b*a,{left:d.x-h*t/2,right:d.x+h*t/2,bottom:s.bottom,top:s.top}):(h=i.width/t,b=h/a,{left:i.left,right:i.right,bottom:P-b*o/2,top:P+b*o/2})):c>n?(b=i.height/o,h=b*a,{left:d.x-h*t/2,right:d.x+h*t/2,bottom:i.bottom,top:i.top}):(h=i.width/t,b=h/a,{left:i.left,right:i.right,bottom:d.y-b*o/2,top:d.y+b*o/2});case"preserveX":return g?(T=s.right-s.left,E=s.top-s.bottom,I={x:s.left+T/2,y:s.bottom+E/2},v=T/E,h=T/t,b=h/a,{left:s.left,right:s.right,bottom:I.y-b*o/2,top:I.y+b*o/2}):u?(D=s.top-s.bottom,P=s.bottom+D/2,v=i.width/D,h=i.width/t,b=h/a,{left:i.left,right:i.right,bottom:P-b*o/2,top:P+b*o/2}):p?(_=s.right-s.left,h=_/t,b=h/a,{left:s.left,right:s.right,bottom:d.y-b*o/2,top:d.y+b*o/2}):(_=i.right-i.left,h=_/t,b=h/a,{left:i.left,right:i.right,bottom:d.y-b*o/2,top:d.y+b*o/2});case"preserveY":return g?(T=s.right-s.left,E=s.top-s.bottom,I={x:s.left+T/2,y:s.bottom+E/2},v=T/E,b=E/o,h=b*a,{left:I.x-h*t/2,right:I.x+h*t/2,bottom:s.bottom,top:s.top}):p?(_=s.right-s.left,C=s.left+_/2,v=_/i.height,b=i.height/o,h=b*a,{left:C-h*t/2,right:C+h*t/2,bottom:i.bottom,top:i.top}):u?(D=s.top-s.bottom,b=D/o,h=b*a,{left:d.x-h*t/2,right:d.x+h*t/2,bottom:s.bottom,top:s.top}):(D=i.top-i.bottom,b=D/o,h=b*a,{left:d.x-h*t/2,right:d.x+h*t/2,bottom:i.bottom,top:i.top});default:return i}}jo();function Yp(r){return r==="es-ES"?(__dcg_shared_module_exports__['Be'].warn("{language: 'es-ES'} has been deprecated. Proceeding with {language: 'es'}"),"es"):r}Cx();var TU={keypad:!0,graphpaper:!0,expressions:!0,settingsMenu:!0,zoomButtons:!0,showResetButtonOnGraphpaper:!1,expressionsTopbar:!0,capExpressionSize:!1,pointsOfInterest:!0,trace:!0,border:!0,lockViewport:!1,expressionsCollapsed:!1,authorFeatures:!1,authorMode:!0,advancedStyling:!1,images:!0,imageUploadCallback:EA,folders:!0,notes:!0,sliders:!0,links:!0,qwertyKeyboard:!0,restrictedFunctions:!1,forceEnableGeometryFunctions:!1,pasteGraphLink:!1,pasteTableData:!0,degreeMode:!1,clearIntoDegreeMode:!1,autosize:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,colors:{RED:hI,BLUE:gI,GREEN:mI,ORANGE:bI,PURPLE:fI,BLACK:ov},invertedColors:!1,functionDefinition:!0,projectorMode:!1,decimalToFraction:!0,fontSize:16,language:"en",backgroundColor:"#fff",textColor:"#000",distributions:!0,brailleMode:"none",sixKeyInput:!1,brailleControls:!0,graphDescription:void 0,reportPosition:"default",zoomFit:!0,forceLogModeRegressions:!1,defaultLogModeRegressions:!1,actions:"auto",audio:!0,logScales:!0,translucentSurfaces:!1,perspectiveDistortion:1,showKeyboardShortcutsInTooltips:!1,tone:!0,muted:!0,showPerformanceMeter:!1,allowComplex:!0,customRegressions:!0},LZ=Object.keys(TU),jye={orientationButtons:!0,debug3dRender:void 0,debugPeelLayers:void 0,adaptivePeeling:!0,debugPixelRatio:void 0,translucentOpacity:"0.8",peelFloatTexture:!1,debugScale:1/10,peelUpsample:void 0},PZ={product:"graphing",showHamburger:!1,disableScrollFix:!1,branding:!0,onlyTraceSelected:!1,disableMouseInteractions:!1,nativeOnscreenKeypad:!1,plaidMode:!1,wireframe:!1,pasteGraphLinkCallback:void 0,editOnWeb:!1,crossOriginSaveTest:!1,enableTabindex:!0,audioTraceReverseExpressions:!1,audioTraceSimult:!1,transparentBackground:!1,pauseWhenOffscreen:!1,hideGeoUI:!1,substitutions:!0,intervalComprehensions:!0,recursion:!0,beta3d:!1,folderModules:!1,disableLighting:!1,disableWorkerOnZoom:!1,cacheRenderedSvgs:!1,ghostMode:!1,tableRegressions:!0,reflectionArc:!1,logInternalErrors:!1,debugProgressUpdates:!1,recursionDepthLimit:void 0,newStats:!1,...jye},Xye={solutions:!0,menus:!0,singleVariableSolutions:!0,clickableObjects:!1,administerSecretFolders:!1};Cx();var _h={...TU,...PZ};function EU(r){return!!(TU.hasOwnProperty(r)||PZ.hasOwnProperty(r)||Xye.hasOwnProperty(r))}function BA(r){let e=__dcg_shared_module_exports__['f'](_h);for(let t in r)e.hasOwnProperty(t)&&(e[t]=r[t]);return __dcg_shared_module_exports__['rd'](e.backgroundColor)||(e.backgroundColor=_h.backgroundColor,__dcg_shared_module_exports__['Be'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)")),__dcg_shared_module_exports__['rd'](e.textColor)||(e.textColor=_h.textColor,__dcg_shared_module_exports__['Be'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)")),e.actions!==!0&&e.actions!==!1&&e.actions!=="auto"&&(e.actions=_h.actions,__dcg_shared_module_exports__['Be'].warn("Invalid actions setting. Must be true, false, or 'auto'.")),r.zoomButtons===void 0&&(!e.graphpaper||e.lockViewport)&&(e.zoomButtons=!1),r.images===void 0&&(e.graphpaper||(e.images=!1)),r.hasOwnProperty("menus")&&(__dcg_shared_module_exports__['Be'].warn("As of API version 0.4, the 'menus' option is deprecated and has been split into 'settingsMenu' (boolean) and 'expressionsTopbar' (boolean)."),r.hasOwnProperty("settingsMenu")||(e.settingsMenu=!!r.menus),r.hasOwnProperty("expressionsTopbar")||(e.expressionsTopbar=!!r.menus)),r.hasOwnProperty("solutions")&&(__dcg_shared_module_exports__['Be'].warn("As of API v1.0, the 'solutions' option is deprecated and has been replaced with 'pointsOfInterest' (boolean)."),r.hasOwnProperty("pointsOfInterest")||(e.pointsOfInterest=!!r.solutions)),r.hasOwnProperty("singleVariableSolutions")&&__dcg_shared_module_exports__['Be'].warn("As of API v1.0, the 'singleVariableSolutions' has been removed. The calculator no longer displays solutions to single variable equations."),r.hasOwnProperty("clickableObjects")&&(__dcg_shared_module_exports__['Be'].warn("As of API v1.7, the 'clickableObjects' option is deprecated and has been replaced with 'actions'."),r.clickableObjects===!0&&!r.hasOwnProperty("actions")&&(e.actions=!0)),r.hasOwnProperty("administerSecretFolders")&&(__dcg_shared_module_exports__['Be'].warn("As of API v1.8, the 'administerSecretFolders' option is deprecated and has been subsumed under 'authorFeatures'."),r.administerSecretFolders===!0&&!r.hasOwnProperty("authorFeatures")&&(e.authorFeatures=!0)),e.graphpaper||(e.expressionsCollapsed&&(e.expressionsCollapsed=!1,__dcg_shared_module_exports__['Be'].warn("Desmos API initialized with bad options. graphpaper: false and expressionsCollapsed: true are incompatible. Proceeding with expressionsCollapsed: false.")),e.zoomButtons&&(e.zoomButtons=!1,__dcg_shared_module_exports__['Be'].warn("Desmos API initialized with bad options. graphpaper: false and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")),e.showResetButtonOnGraphpaper&&(e.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['Be'].warn("Desmos API initialized with bad options. graphpaper: false and showResetButtonOnGraphpaper: true are incompatible. Proceeding with showResetButtonOnGraphpaper: false."))),e.lockViewport&&e.zoomButtons&&(e.zoomButtons=!1,__dcg_shared_module_exports__['Be'].warn("Desmos API initialized with bad options. lockViewport: true and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")),(e.notes===!1||e.folders===!1||e.images===!1)&&e.pasteGraphLink===!0&&(e.pasteGraphLink=!1,__dcg_shared_module_exports__['Be'].warn("Desmos API initialized with bad options. pasteGraphLink: true is incompatible with disabling the creation of note, folder, or image expressions. Proceeding with pasteGraphLink: false.")),e.language&&(e.language=Yp(e.language)),e}function $ye(r){Gx?setTimeout(r,25):requestAnimationFrame(r)}var GZ=1,rw={},Wk=!1;function OZ(){Wk=!0,$ye(Jye)}var VZ={};function Jye(){VZ.rafSPY&&VZ.rafSPY(),Wk=!1;for(let r in rw)rw[r].detectAndEnqueueEvent(),Wk=!0;if(Wk){OZ();for(let r in rw)rw[r].dispatchQueuedEvent()}}var Xb=class{constructor(e,t){this.elt=e;this.cb=t;this.destroyed=!1;this.lastZoom=1;this.lastOffscreen=!1;this.id=GZ.toString(),this.appliedScale={x:1,y:1},GZ++}stopWatching(){delete rw[this.id]}startWatching(){this.checkForChanges(),rw[this.id]=this,Wk||OZ()}resetAppliedScalingAndGetBoundingClientRect(){let e=this.elt.getBoundingClientRect(),t={x:e.width/this.elt.offsetWidth,y:e.height/this.elt.offsetHeight};if(t.x===this.appliedScale.x&&t.y===this.appliedScale.y)return e;let o=this.elt.querySelector(".dcg-dom-change-wrapper");return o&&(this.appliedScale=t,Yo(o,{transform:"scale("+1/this.appliedScale.x+","+1/this.appliedScale.y+")",width:100*this.appliedScale.x+"%",height:100*this.appliedScale.y+"%",transformOrigin:"0 0"})),e}detectAndEnqueueEvent(){var i;if(this.destroyed)return;let e=!0;if(!(document.body&&document.body.contains(this.elt)))this.lastSize&&(this.lastSize=void 0,this.queuedEvent={type:"removed",target:this.elt,isOffscreen:!0});else{let n=this.resetAppliedScalingAndGetBoundingClientRect();e=n.top>window.innerHeight||n.bottom<0||n.left>window.innerWidth||n.right<0,this.lastSize?(n.width!==this.lastSize.width||n.height!==this.lastSize.height||window.devicePixelRatio!==this.lastSize.pixelRatio)&&(this.lastSize.width=n.width,this.lastSize.height=n.height,this.lastSize.pixelRatio=window.devicePixelRatio,this.queuedEvent={type:"resized",target:this.elt,size:{...this.lastSize},isOffscreen:e}):(this.lastSize={width:n.width,height:n.height,pixelRatio:window.devicePixelRatio},this.queuedEvent={type:"added",target:this.elt,size:{...this.lastSize},isOffscreen:e})}let o=((i=window.visualViewport)==null?void 0:i.scale)||1;o!==this.lastZoom&&(this.lastZoom=o,this.queuedEvent={type:"visual-viewport-zoom",zoom:o,isOffscreen:e}),e!==this.lastOffscreen&&(this.lastOffscreen=e,this.queuedEvent||(this.queuedEvent={type:"offscreen-noop",target:this.elt,isOffscreen:e}))}dispatchQueuedEvent(){let e=this.queuedEvent;e&&(this.queuedEvent=void 0,this.cb(e))}checkForChanges(){this.detectAndEnqueueEvent(),this.dispatchQueuedEvent()}destroy(){this.stopWatching();for(let e in this)this.hasOwnProperty(e)&&delete this[e];this.destroyed=!0}};var Zye=0,Qye="guid_"+Math.round(Math.random()*1e6)+"_"+new Date().getTime()+"_",IU=class{constructor(e){this.__observers={},this.guid=Qye+ ++Zye,e&&this.setProperties(e)}unobserveAll(){this.__observers={}}getProperty(e){return this[e]}setProperty(e,t){let o=this[e];this.setPropertyWithoutNotifying(e,t),!__dcg_shared_module_exports__['db'](o,t)&&this.notifyPropertyChange(e)}setPropertyWithoutNotifying(e,t){this[e]=t}setProperties(e){let t=[];for(let o of Object.keys(e)){let i=this[o];this.setPropertyWithoutNotifying(o,e[o]),__dcg_shared_module_exports__['db'](i,e[o])||t.push(o)}t.forEach(o=>this.notifyPropertyChange(o))}notifyPropertyChange(e){gU(this.__observers,e,this)}observe(e,t){fU(this.__observers,e,t)}unobserve(e){mU(this.__observers,e)}observeAndSync(e,t){this.observe(e,t);let o=e.split(" ");for(let i=0;i<o.length;i++){let a=o[i].split(".")[0];this.hasOwnProperty(a)&&t(a,this)}}},Ds=IU;var rS=__dcg_shared_module_exports__['e'](j());var h_=__dcg_shared_module_exports__['e'](j());Ut();var ow,Mt,jk,AU,DU;function Wa(r,e){var t=Object.keys(e),o;for(o=0;o<t.length;o++)r=r.replace(new RegExp("\\{"+t[o]+"\\}","gi"),e[t[o]]);return r}function KA(r){var e,t,o;if(!r)throw new Error("cannot create a random attribute name for an undefined object");e="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",t="";do for(t="",o=0;o<12;o++)t+=e[Math.floor(Math.random()*e.length)];while(r[t]);return t}function exe(r,e){var t,o,i={},n,a;for(r=r.split(","),e=e||10,t=0;t<r.length;t+=2)o="&"+r[t+1]+";",n=parseInt(r[t],e),i[o]="&#"+n+";";return i["\\xa0"]="&#160;",i}function txe(r){var e={left:"start",right:"end",center:"middle",start:"start",end:"end"};return e[r]||e.start}DU=exe("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);ow={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}};jk=function(r,e){this.__root=r,this.__ctx=e};jk.prototype.addColorStop=function(r,e){var t=this.__ctx.__createElement("stop"),o,i;t.setAttribute("offset",r),e.indexOf("rgba")!==-1?(o=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,i=o.exec(e),t.setAttribute("stop-color",Wa("rgb({r},{g},{b})",{r:i[1],g:i[2],b:i[3]})),t.setAttribute("stop-opacity",i[4])):t.setAttribute("stop-color",e),this.__root.appendChild(t)};AU=function(r,e){this.__root=r,this.__ctx=e};Mt=function(r){var e={width:500,height:500,enableMirroring:!1},t;if(arguments.length>1?(t=e,t.width=arguments[0],t.height=arguments[1]):r?t=r:t=e,!(this instanceof Mt))return new Mt(t);this._randomPostfix="-"+function(){return"xxxxxxxx".replace(/x/g,function(i){return(Math.random()*16|0).toString(16)})}(),this._svgClassNames=[],this.width=t.width||e.width,this.height=t.height||e.height,this.enableMirroring=t.enableMirroring!==void 0?t.enableMirroring:e.enableMirroring,this.canvas=this,this.__document=t.document||document,t.ctx?this.__ctx=t.ctx:(this.__canvas=this.__document.createElement("canvas"),this.__ctx=this.__canvas.getContext("2d")),this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__document.createElementNS("http://www.w3.org/2000/svg","svg"),this.__root.setAttribute("version",1.1),this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.__root.setAttribute("width",this.width),this.__root.setAttribute("height",this.height),this.__ids={},this.__defs=this.__document.createElementNS("http://www.w3.org/2000/svg","defs"),this.__root.appendChild(this.__defs),this.__currentElement=this.__document.createElementNS("http://www.w3.org/2000/svg","g"),this.__root.appendChild(this.__currentElement)};Mt.prototype.__createElement=function(r,e,t){typeof e=="undefined"&&(e={});var o=this.__document.createElementNS("http://www.w3.org/2000/svg",r),i=Object.keys(e),n,a;for(t&&(o.setAttribute("fill","none"),o.setAttribute("stroke","none")),n=0;n<i.length;n++)a=i[n],o.setAttribute(a,e[a]);var s=this._svgClassNames&&this._svgClassNames[this._svgClassNames.length-1];return s&&o.setAttribute("class",s),o};Mt.prototype.__setDefaultStyles=function(){var r=Object.keys(ow),e,t;for(e=0;e<r.length;e++)t=r[e],this[t]=ow[t].canvas};Mt.prototype.__applyStyleState=function(r){var e=Object.keys(r),t,o;for(t=0;t<e.length;t++)o=e[t],this[o]=r[o]};Mt.prototype.__getStyleState=function(){var r,e={},t=Object.keys(ow),o;for(r=0;r<t.length;r++)o=t[r],e[o]=this[o];return e};Mt.prototype.__applyStyleToCurrentElement=function(r){var e=this.__currentElement,t=this.__currentElementsToStyle;t&&(e.setAttribute(r,""),e=t.element,t.children.forEach(function(h){h.setAttribute(r,"")}));var o=Object.keys(ow),i,n,a,s,c,d;for(i=0;i<o.length;i++)if(n=ow[o[i]],a=this[o[i]],n.apply){if(a instanceof AU){if(a.__ctx)for(;a.__ctx.__defs.childNodes.length;)s=a.__ctx.__defs.childNodes[0].getAttribute("id"),this.__ids[s]=s,this.__defs.appendChild(a.__ctx.__defs.childNodes[0]);e.setAttribute(n.apply,Wa("url(#{id})",{id:a.__root.getAttribute("id")}))}else if(a instanceof jk)e.setAttribute(n.apply,Wa("url(#{id})",{id:a.__root.getAttribute("id")}));else if(n.apply.indexOf(r)!==-1&&n.svg!==a)if((n.svgAttr==="stroke"||n.svgAttr==="fill")&&a.indexOf("rgba")!==-1){c=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,d=c.exec(a),e.setAttribute(n.svgAttr,Wa("rgb({r},{g},{b})",{r:d[1],g:d[2],b:d[3]}));var p=d[4],u=this.globalAlpha;u!=null&&(p*=u),e.setAttribute(n.svgAttr+"-opacity",p)}else{var g=n.svgAttr;if(o[i]==="globalAlpha"&&(g=r+"-"+n.svgAttr,e.getAttribute(g)))continue;e.setAttribute(g,a)}}};Mt.prototype.__closestGroupOrSvg=function(r){return r=r||this.__currentElement,r.nodeName==="g"||r.nodeName==="svg"?r:this.__closestGroupOrSvg(r.parentNode)};Mt.prototype.getSerializedSvg=function(r){var e=new XMLSerializer().serializeToString(this.__root),t,o,i,n,a,s;if(s=/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi,s.test(e)&&(e=e.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),r)for(t=Object.keys(DU),o=0;o<t.length;o++)i=t[o],n=DU[i],a=new RegExp(i,"gi"),a.test(e)&&(e=e.replace(a,n));return e};Mt.prototype.getSvg=function(){return this.__root};Mt.prototype._dcgStartNamedGroup=function(r){var e=this.__createElement("g");e.setAttribute("id",r+this._randomPostfix);var t=this.__closestGroupOrSvg();this.__groupStack.push(t),t.appendChild(e),this.__currentElement=e};Mt.prototype._dcgEndNamedGroup=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElement||(this.__currentElement=this.__root.childNodes[1])};Mt.prototype._dcgSaveClassName=function(r){this._svgClassNames.push(r),this.__currentElement&&this.__currentElement.tagName==="path"&&!this.__currentDefaultPath&&(this.__currentElement.getAttribute("class")||this.__currentElement.setAttribute("class",r))};Mt.prototype._dcgRestoreClassName=function(){this._svgClassNames.pop()};Mt.prototype.save=function(){var r=this.__createElement("g"),e=this.__closestGroupOrSvg();this.__groupStack.push(e),e.appendChild(r),this.__currentElement=r,this.__stack.push(this.__getStyleState())};Mt.prototype.restore=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]);var r=this.__stack.pop();this.__applyStyleState(r)};Mt.prototype.__addTransform=function(r){var e=this.__closestGroupOrSvg();if(e.childNodes.length>0){this.__currentElement.nodeName==="path"&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:e,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var t=this.__createElement("g");e.appendChild(t),this.__currentElement=t}var o=this.__currentElement.getAttribute("transform");o?o+=" ":o="",o+=r,this.__currentElement.setAttribute("transform",o)};Mt.prototype.scale=function(r,e){e===void 0&&(e=r),this.__addTransform(Wa("scale({x},{y})",{x:r,y:e}))};Mt.prototype.rotate=function(r){var e=r*180/Math.PI;this.__addTransform(Wa("rotate({angle},{cx},{cy})",{angle:e,cx:0,cy:0}))};Mt.prototype.translate=function(r,e){this.__addTransform(Wa("translate({x},{y})",{x:r,y:e}))};Mt.prototype.transform=function(r,e,t,o,i,n){this.__addTransform(Wa("matrix({a},{b},{c},{d},{e},{f})",{a:r,b:e,c:t,d:o,e:i,f:n}))};Mt.prototype.beginPath=function(){var r,e;this.__currentDefaultPath="",this.__currentPosition={},r=this.__createElement("path",{},!0),e=this.__closestGroupOrSvg(),e.appendChild(r),this.__currentElement=r};Mt.prototype.__applyCurrentDefaultPath=function(){var r=this.__currentElement;r.nodeName==="path"?r.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",r.nodeName)};Mt.prototype.__addPathCommand=function(r){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=r};Mt.prototype.moveTo=function(r,e){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.__currentPosition={x:r,y:e},this.__addPathCommand(Wa("M {x} {y}",{x:r,y:e}))};Mt.prototype.closePath=function(){this.__currentDefaultPath&&this.__addPathCommand("Z")};Mt.prototype.lineTo=function(r,e){this.__currentPosition={x:r,y:e},this.__currentDefaultPath.indexOf("M")>-1?this.__addPathCommand(Wa("L {x} {y}",{x:r,y:e})):this.__addPathCommand(Wa("M {x} {y}",{x:r,y:e}))};Mt.prototype.bezierCurveTo=function(r,e,t,o,i,n){this.__currentPosition={x:i,y:n},this.__addPathCommand(Wa("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:r,cp1y:e,cp2x:t,cp2y:o,x:i,y:n}))};Mt.prototype.quadraticCurveTo=function(r,e,t,o){this.__currentPosition={x:t,y:o},this.__addPathCommand(Wa("Q {cpx} {cpy} {x} {y}",{cpx:r,cpy:e,x:t,y:o}))};var MU=function(r){var e=Math.sqrt(r[0]*r[0]+r[1]*r[1]);return[r[0]/e,r[1]/e]};Mt.prototype.arcTo=function(r,e,t,o,i){var n=this.__currentPosition&&this.__currentPosition.x,a=this.__currentPosition&&this.__currentPosition.y;if(!(typeof n=="undefined"||typeof a=="undefined")){if(i<0)throw new Error("IndexSizeError: The radius provided ("+i+") is negative.");if(n===r&&a===e||r===t&&e===o||i===0){this.lineTo(r,e);return}var s=MU([n-r,a-e]),c=MU([t-r,o-e]);if(s[0]*c[1]===s[1]*c[0]){this.lineTo(r,e);return}var d=s[0]*c[0]+s[1]*c[1],p=Math.acos(Math.abs(d)),u=MU([s[0]+c[0],s[1]+c[1]]),g=i/Math.sin(p/2),h=r+g*u[0],b=e+g*u[1],v=[-s[1],s[0]],T=[c[1],-c[0]],E=function(C){var D=C[0],P=C[1];return P>=0?Math.acos(D):-Math.acos(D)},I=E(v),_=E(T);this.lineTo(h+v[0]*i,b+v[1]*i),this.arc(h,b,i,I,_)}};Mt.prototype.stroke=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke")};Mt.prototype.fill=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","stroke fill markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")};Mt.prototype.rect=function(r,e,t,o){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.moveTo(r,e),this.lineTo(r+t,e),this.lineTo(r+t,e+o),this.lineTo(r,e+o),this.lineTo(r,e),this.closePath()};Mt.prototype.fillRect=function(r,e,t,o){var i,n;i=this.__createElement("rect",{x:r,y:e,width:t,height:o},!0),n=this.__closestGroupOrSvg(),n.appendChild(i),this.__currentElement=i,this.__applyStyleToCurrentElement("fill")};Mt.prototype.strokeRect=function(r,e,t,o){var i,n;i=this.__createElement("rect",{x:r,y:e,width:t,height:o},!0),n=this.__closestGroupOrSvg(),n.appendChild(i),this.__currentElement=i,this.__applyStyleToCurrentElement("stroke")};Mt.prototype.__clearCanvas=function(){for(var r=this.__closestGroupOrSvg(),e=r.getAttribute("transform"),t=this.__root.childNodes[1],o=t.childNodes,i=o.length-1;i>=0;i--)o[i]&&t.removeChild(o[i]);this.__currentElement=t,this.__groupStack=[],e&&this.__addTransform(e)};Mt.prototype.clearRect=function(r,e,t,o){if(r===0&&e===0&&t===this.width&&o===this.height){this.__clearCanvas();return}var i,n=this.__closestGroupOrSvg();i=this.__createElement("rect",{x:r,y:e,width:t,height:o,fill:"#FFFFFF"},!0),n.appendChild(i)};Mt.prototype.createLinearGradient=function(r,e,t,o){var i=this.__createElement("linearGradient",{id:KA(this.__ids),x1:r+"px",x2:t+"px",y1:e+"px",y2:o+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(i),new jk(i,this)};Mt.prototype.createRadialGradient=function(r,e,t,o,i,n){var a=this.__createElement("radialGradient",{id:KA(this.__ids),cx:o+"px",cy:i+"px",r:n+"px",fx:r+"px",fy:e+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(a),new jk(a,this)};Mt.prototype.__parseFont=function(){var r=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i,e=r.exec(this.font),t={style:e[1]||"normal",size:e[4]||"10px",family:e[6]||"sans-serif",weight:e[3]||"normal",decoration:e[2]||"normal",href:null};return this.__fontUnderline==="underline"&&(t.decoration="underline"),this.__fontHref&&(t.href=this.__fontHref),t};Mt.prototype.__wrapTextLink=function(r,e){if(r.href){var t=this.__createElement("a");return t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r.href),t.appendChild(e),t}return e};Mt.prototype.__applyText=function(r,e,t,o){var i=this.__parseFont(),n=this.__closestGroupOrSvg(),a=this.__createElement("text",{"font-family":i.family,"font-size":i.size,"font-style":i.style,"font-weight":i.weight,"text-decoration":i.decoration,x:e,y:t,"text-anchor":txe(this.textAlign)},!0);a.appendChild(this.__document.createTextNode(r)),this.__currentElement=a,this.__applyStyleToCurrentElement(o),n.appendChild(this.__wrapTextLink(i,a))};Mt.prototype.fillText=function(r,e,t){this.__applyText(r,e,t,"fill")};Mt.prototype.strokeText=function(r,e,t){this.__applyText(r,e,t,"stroke")};Mt.prototype.measureText=function(r){return this.__ctx.font=this.font,this.__ctx.measureText(r)};Mt.prototype.arc=function(r,e,t,o,i,n){if(o!==i){o=o%(2*Math.PI),i=i%(2*Math.PI),o===i&&(i=(i+2*Math.PI-.001*(n?-1:1))%(2*Math.PI));var a=r+t*Math.cos(i),s=e+t*Math.sin(i),c=r+t*Math.cos(o),d=e+t*Math.sin(o),p=n?0:1,u=0,g=i-o;g<0&&(g+=2*Math.PI),n?u=g>Math.PI?0:1:u=g>Math.PI?1:0,this.lineTo(c,d),this.__addPathCommand(Wa("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:t,ry:t,xAxisRotation:0,largeArcFlag:u,sweepFlag:p,endX:a,endY:s})),this.__currentPosition={x:a,y:s}}};Mt.prototype.clip=function(){var r=this.__closestGroupOrSvg(),e=this.__createElement("clipPath"),t=KA(this.__ids),o=this.__createElement("g");this.__applyCurrentDefaultPath(),r.removeChild(this.__currentElement),e.setAttribute("id",t),e.appendChild(this.__currentElement),this.__defs.appendChild(e),r.setAttribute("clip-path",Wa("url(#{id})",{id:t})),r.appendChild(o),this.__currentElement=o};Mt.prototype.drawImage=function(){var r=Array.prototype.slice.call(arguments),e=r[0],t,o,i,n,a=0,s=0,c,d,p,u,g,h,b,v,T,E,I;if(r.length===3)t=r[1],o=r[2],c=e.width,d=e.height,i=c,n=d;else if(r.length===5)t=r[1],o=r[2],i=r[3],n=r[4],c=e.width,d=e.height;else if(r.length===9)a=r[1],s=r[2],c=r[3],d=r[4],t=r[5],o=r[6],i=r[7],n=r[8];else throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);p=this.__closestGroupOrSvg(),b=this.__currentElement;var _="translate("+t+", "+o+")";if(e instanceof Mt){if(u=e.getSvg().cloneNode(!0),u.childNodes&&u.childNodes.length>1){for(g=u.childNodes[0];g.childNodes.length;)I=g.childNodes[0].getAttribute("id"),this.__ids[I]=I,this.__defs.appendChild(g.childNodes[0]);if(h=u.childNodes[1],h){var C=h.getAttribute("transform"),D;C?D=C+" "+_:D=_,h.setAttribute("transform",D),p.appendChild(h)}}}else(e.nodeName==="CANVAS"||e.nodeName==="IMG")&&(v=this.__createElement("image"),v.setAttribute("width",i),v.setAttribute("height",n),v.setAttribute("opacity",this.globalAlpha),v.setAttribute("preserveAspectRatio","none"),(a||s||c!==e.width||d!==e.height)&&(T=this.__document.createElement("canvas"),T.width=i,T.height=n,E=T.getContext("2d"),E.drawImage(e,a,s,c,d,0,0,i,n),e=T),v.setAttribute("transform",_),v.setAttribute("xlink:href",e.nodeName==="CANVAS"?e.toDataURL():e.getAttribute("src")),p.appendChild(v))};Mt.prototype.createPattern=function(r,e){var t=this.__document.createElementNS("http://www.w3.org/2000/svg","pattern"),o=KA(this.__ids),i;return t.setAttribute("id",o),t.setAttribute("width",r.width),t.setAttribute("height",r.height),r.nodeName==="CANVAS"||r.nodeName==="IMG"?(i=this.__document.createElementNS("http://www.w3.org/2000/svg","image"),i.setAttribute("width",r.width),i.setAttribute("height",r.height),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r.nodeName==="CANVAS"?r.toDataURL():r.getAttribute("src")),t.appendChild(i),this.__defs.appendChild(t)):r instanceof Mt&&(t.appendChild(r.__root.childNodes[1]),this.__defs.appendChild(t)),new AU(t,this)};Mt.prototype.setLineDash=function(r){r&&r.length>0?this.lineDash=r.join(","):this.lineDash=null};Mt.prototype.ellipse=function(r,e,t,o,i,n,a,s){if(n!==a){n=n%(2*Math.PI),a=a%(2*Math.PI),n===a&&(a=(a+2*Math.PI-.001*(s?-1:1))%(2*Math.PI));var c=r+Math.cos(-i)*t*Math.cos(a)+Math.sin(-i)*o*Math.sin(a),d=e-Math.sin(-i)*t*Math.cos(a)+Math.cos(-i)*o*Math.sin(a),p=r+Math.cos(-i)*t*Math.cos(n)+Math.sin(-i)*o*Math.sin(n),u=e-Math.sin(-i)*t*Math.cos(n)+Math.cos(-i)*o*Math.sin(n),g=s?0:1,h=0,b=a-n;b<0&&(b+=2*Math.PI),s?h=b>Math.PI?0:1:h=b>Math.PI?1:0,this.lineTo(p,u),this.__addPathCommand(Wa("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:t,ry:o,xAxisRotation:i*(180/Math.PI),largeArcFlag:h,sweepFlag:g,endX:c,endY:d})),this.__currentPosition={x:c,y:d}}};Mt.prototype._dcgSetTitle=function(r){var e=this.__currentElement,t=!1,o,i=e.getElementsByTagName("title");i.length>0?o=i[0]:(o=this.__document.createElementNS("http://www.w3.org/2000/svg","title"),t=!0),o.textContent=r,t&&e.appendChild(o)};Mt.prototype.drawFocusRing=function(){};Mt.prototype.createImageData=function(){};Mt.prototype.getImageData=function(){};Mt.prototype.putImageData=function(){};Mt.prototype.globalCompositeOperation=function(){};Mt.prototype.setTransform=function(){};var RZ=Mt;var Ch=class r extends Ds{constructor(){super();this.highlightPropertyMultipliers={};this.stateProperties=[],this.cloneProperties=[],this.highlightPropertyMultipliers={},this.config=new Ds;for(let t in Li)Li.hasOwnProperty(t)&&this.addStateProperty(t,Li[t]);this.setProperty("labelHangingColor","rgba(150,150,150,1)"),this.setProperty("lastChangedAxis","x"),this.addDynamicProperties()}addDynamicProperties(){let t=this;function o(n,a,s){t.cloneProperties.push(n);function c(){t.setProperty(n,t.config.projectorMode?s:a)}t.config.observe("projectorMode",c),c()}function i(n,a,s,c,d){t.cloneProperties.push(n);function p(){let g;t.config.projectorMode?g=t.highlight?d:c:g=t.highlight?s:a,t.setProperty(n,g)}let u=[a,s,c,d];t.highlightPropertyMultipliers[n]=u.map(g=>g/u[0]),t.observe("highlight",p),t.config.observe("projectorMode",p),p()}o("labelSize",14,19),o("majorAxisOpacity",.4,1),o("minorAxisOpacity",.12,.25),o("axisOpacity",.9,.9),o("axisLineWidth",1.5,2),o("axisLineOffset",.25,0),o("pixelsPerLabel",80,120),i("curveOpacity",.7,1,.7,1),o("globalCurveColor",void 0,void 0),o("disableFill",!1,!1),i("graphLineWidth",2.5,3.5,5,7),i("pointLineWidth",8,8*1.2,8*1.3,8*1.2*1.3)}setController(t){this.controller=t,this.registerCallbacks()}getHighlightPropertyMultiplier(t,o){let i=o?1:0;return this.config.projectorMode?this.highlightPropertyMultipliers[t][2+i]:this.highlightPropertyMultipliers[t][i]}getFillOpacityMultiplier(){return this.highlight&&this.controller&&this.controller.isGeometry()?1.3:1}addStateProperty(t,o){this[t]=o,this.stateProperties.push(t),this.cloneProperties.push(t)}static fromObject(t){let o=new r;return o.cloneProperties.forEach(i=>{t.hasOwnProperty(i)&&o.setProperty(i,t[i])}),o}registerCallbacks(){let t=()=>{var o;(o=this.controller)==null||o.requestRedrawGraph()};this.stateProperties.forEach(o=>{this.observe(o,t)}),this.config.observe("backgroundColor",t),this.config.observe("textColor",t),this.config.observe("invertedColors",t),this.observe("backgroundColor",t),this.observe("textColor",t),this.config.observe("enableTabindex",t),this.config.observeAndSync("projectorMode",t)}_validateSetting(t,o){let i;switch(t){case"xAxisMinorSubdivisions":case"yAxisMinorSubdivisions":i=Math.round(Math.min(Math.max(0,o),5)),o!==i&&__dcg_shared_module_exports__['Be'].warn("minorSubdivisions must be an integer between 0 and 5. You provided "+o+", which we changed to "+i+".");break;case"degreeMode":case"projectorMode":case"showGrid":case"showXAxis":case"showYAxis":case"xAxisNumbers":case"yAxisNumbers":case"polarNumbers":case"enableTabindex":case"invertedColors":case"complex":i=o==="false"?!1:!!o,o!==i&&__dcg_shared_module_exports__['Be'].warn(t+" must be a Boolean. You provided "+o+" ("+typeof o+"), which we changed to "+i+" ("+typeof i+").");break;case"xAxisStep":case"yAxisStep":i=parseFloat(o),isFinite(o)||(i=0,__dcg_shared_module_exports__['Be'].warn(t+" must be a number. You provided "+o+", which we changed to "+i+"."));break;case"xAxisScale":case"yAxisScale":i=o,!this.config.logScales&&o==="logarithmic"?(i="linear",__dcg_shared_module_exports__['Be'].warn("Must set logScales: true to set "+t+" to 'logarithmic'.")):o!=="linear"&&o!=="logarithmic"&&(i="linear",__dcg_shared_module_exports__['Be'].warn(t+' must be "linear" or "logarithmic". You provided '+o+", which we changed to "+i+"."));break;case"xAxisArrowMode":case"yAxisArrowMode":i=__dcg_shared_module_exports__['Nd'][o],i!==o&&(i=__dcg_shared_module_exports__['Nd'].NONE,__dcg_shared_module_exports__['Be'].warn(`unknown AxisArrowMode. Allowed values are: 
`+__dcg_shared_module_exports__['$a'](__dcg_shared_module_exports__['Nd']).join(`
`)));break;case"xAxisLabel":case"yAxisLabel":i=o,typeof o!="string"&&(i="",__dcg_shared_module_exports__['Be'].warn(t+" must be a string. you provided a "+typeof o+"."));break;case"randomSeed":i=o,typeof o!="string"&&(i=""+o,__dcg_shared_module_exports__['Be'].warn("randomSeed must be a string. you provided a "+typeof o+"."));break;case"backgroundColor":i=o,typeof o!="string"&&(i="",__dcg_shared_module_exports__['Be'].warn(t+" must be a string. you provided a "+typeof o+".")),i||(i="#fff"),i[0]!=="#"&&(i="#"+i);break;case"textColor":i=o,typeof o!="string"&&(i="",__dcg_shared_module_exports__['Be'].warn(t+" must be a string. you provided a "+typeof o+".")),i||(i="#000"),i[0]!=="#"&&(i="#"+i);break;case"fontSize":i=o,typeof o!="number"&&(i=parseInt(i,10),__dcg_shared_module_exports__['Be'].warn("fontSize must be a number. Attempted to convert "+o+" to "+i+"."));break;case"language":i=o,typeof o!="string"&&(i="",__dcg_shared_module_exports__['Be'].warn(t+" must be a string. you provided a "+typeof o+".")),o!=="en"&&!LI(o)&&(i="en",__dcg_shared_module_exports__['Be'].warn(o+" is not currently an available language."));break;default:i=o;break}return i}validateSettings(t){let o={},i=!1;for(let n in t)this.stateProperties.indexOf(n)>=0?o[n]=this._validateSetting(n,t[n]):(__dcg_shared_module_exports__['Be'].warn('Invalid graph setting "'+n+'".'),i=!0);return i&&__dcg_shared_module_exports__['Be'].warn(`Available graph settings are: 
`+this.stateProperties.join(`
`)),this.config.allowComplex||o.complex&&(__dcg_shared_module_exports__['Be'].warn("complex: true is not compatible with allowComplex: false. Forcing complex: false"),o.complex=!1),o.complex&&(o.degreeMode&&__dcg_shared_module_exports__['Be'].warn("degreeMode: true is not compatible with complex: true. Forcing degreeMode: false"),o.degreeMode=!1),o}getConfiguredBackgroundColor(){return __dcg_shared_module_exports__['qd'](this.config.backgroundColor||"#fff")}getBackgroundColor({invertWhite:t}={invertWhite:!1}){let o=this.getConfiguredBackgroundColor();return this.config.invertedColors&&t?__dcg_shared_module_exports__['ud'](o):o}getConfiguredTextColor(){return __dcg_shared_module_exports__['qd'](this.config.textColor||"#000")}getTextColor({invertBlack:t}={invertBlack:!1}){let o=this.getConfiguredTextColor();return this.config.invertedColors&&t?__dcg_shared_module_exports__['ud'](o):o}cloneConfig(){let t={};for(let o of Object.keys(_h))t[o]=__dcg_shared_module_exports__['f'](this.config[o]);return t}};Ut();var iw=class{constructor(e,t){this.is3d=!0;this.color="#000000",this.showHighlight=!1,this.selected=!1,this.hoistToTop=!1,this.id=e,this.branches=t!==void 0?t:[]}updateFrom(e){e&&(this.showHighlight=e.showHighlight,this.hoistToTop=e.hoistToTop,this.selected=e.selected)}};function NZ(r){return r.is3d}function Bl(r,e){if(NZ(e)||r.isGeoUIActive()&&r.getAllToolPreviewItems().filter(o=>o.id===e.id).length>0)return!1;for(let t of e.branches)if(_d(t,r.getGraphSettings().config.audioTraceSimult))return!0;return!1}function _d(r,e){if(r)switch(r.graphMode){case 8:case 5:case 6:return e&&r.segments.length>0;case 1:case 2:case 3:case 4:case 25:case 26:return r.segments.length>0;default:return!1}}function UZ(r,e){for(let t=0;t<r.branches.length;t++)if(_d(r.branches[t],e))return t;return 0}function Xk(r,e,t){let o=0;for(let i=0;i<=e;i++)_d(r.branches[i],t)&&(o+=1);return o}function YZ(r){switch(r.graphMode){case 1:case 2:case 3:case 4:case 25:case 26:return!0;default:return!1}}function BZ(r,e){switch(e){case 2:case 8:case 5:case 6:case 3:case 4:case 25:case 26:return{independentMin:r.xmin,independentMax:r.xmax,dependentMin:r.ymin,dependentMax:r.ymax};case 1:return{independentMin:r.ymin,independentMax:r.ymax,dependentMin:r.xmin,dependentMax:r.xmax};default:throw LU(e)}}function LU(r){return`Unexpected graph mode. Received ${r}`}function PU(r){let e=Math.random()*2-1;return(r+.2*e)/1.02}function KZ(r,e){if(r===1)return e.y;if(r===2||r===8||r===5||r===6)return e.x;throw LU(r)}function zZ(r,e){let t=([o,i])=>{let n=e!=null&&e.degreeMode?o*Math.PI/180:o;return[i*Math.cos(n),i*Math.sin(n)]};return __dcg_shared_module_exports__['Sa'](__dcg_shared_module_exports__['Ya'](r,2).map(o=>t(o)),!0)}function GU(r,e,t){let o=qg(r,e.mathToPixels,t),i=Tj(o,{xmin:0,xmax:e.screen.width,ymin:0,ymax:e.screen.height}),n=e.pixelsToMath;return t===$v&&(n=new __dcg_shared_module_exports__['jd'](n.yScale,n.xScale)),i.map(s=>qg(s,n,t))}function qZ(r,e){return r[0]-e[0]}function HZ(r){switch(r.graphMode){case 2:case 3:case 4:case 25:case 26:return{independent:r.x,dependent:r.y};case 1:return{independent:r.y,dependent:r.x};default:throw LU(r.graphMode)}}var rxe=.1;function VU(r){return r<0?rxe:0}function $k(r){var D;let e=r.getGrapher();if(!e)return"";let t=e.viewportController.getViewport(),o=e.getProjection(),{showGrid:i,showXAxis:n,xAxisNumbers:a,showYAxis:s,yAxisNumbers:c,xAxisLabel:d,yAxisLabel:p}=e.settings,u=!1,g="",h=!1,b=[],v=Mr(__dcg_shared_module_exports__['nb'](t.xmin,Db(o,t.xmin)).latex),T=Mr(__dcg_shared_module_exports__['nb'](t.xmax,Db(o,t.xmax)).latex),E=Mr(__dcg_shared_module_exports__['nb'](t.ymin,QD(o,t.ymin)).latex),I=Mr(__dcg_shared_module_exports__['nb'](t.ymax,QD(o,t.ymax)).latex),_=t.zmin?Mr(__dcg_shared_module_exports__['nb'](t.zmin).latex):"",C=t.zmax?Mr(__dcg_shared_module_exports__['nb'](t.zmax).latex):"";if(r.is3dProduct()){let{xmin:P,xmax:F,ymin:N,ymax:Y,zmin:z,zmax:X}=t,{showAxis3D:q,showNumbers3D:S,showPlane3D:A}=e.settings;P===N&&P===z&&F===Y&&F===X&&q?(n=s=u=!1,b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-xyz-axis-range",{xmin:v,xmax:T}))):(n=s=u=q,d=p=g="",a=c=h=S,i=n&&A)}if(n&&(a&&d!==""?b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-range-and-label",{xmin:v,xmax:T,label:d})):a&&d===""?b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-range",{xmin:v,xmax:T})):!a&&d!==""?b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-and-label",{label:d})):!a&&d===""&&b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-x-axis"))),s&&(c&&p!==""?b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-range-and-label",{ymin:E,ymax:I,label:p})):c&&p===""?b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-range",{ymin:E,ymax:I})):!c&&p!==""?b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-and-label",{label:p})):!c&&p===""&&b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-y-axis"))),u&&(h&&g!==""?b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-z-axis-range-and-label",{zmin:_,zmax:C,label:g})):h&&g===""?b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-z-axis-range",{zmin:_,zmax:C})):!h&&g!==""?b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-z-axis-and-label",{label:g})):!h&&g===""&&b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-z-axis"))),i&&b.push(r.s("graphing-calculator-narration-audio-trace-description-visible-grid")),r.is3dProduct()&&b.push(oxe(r)),!r.isGeometry()&&!r.is3dProduct()){let P=(D=r.getGrapher())==null?void 0:D.graphSketches,F=0;for(let N in P)Bl(r,P[N])&&(F+=1);b.push(r.s("graphing-calculator-narration-audio-trace-traceable-curves",{sketchCount:__dcg_shared_module_exports__['Db'](F)}))}return b.join(" ").trim()}function oxe(r){return""}function ixe(r,e,t){return{x:r.x,y:r.y,branch:r.branch,reportedBranch:t,type:r.type,graphMode:e,intersects:r.intersects}}var nw=101,zA=class{constructor(e,t,o){this.grapher=o,this.controller=e,this.audiograph=t,this.reset()}reset(){this.currentPoint=void 0,this.resetToFirstBranch(),this.sampledPoints=[],this.pois=[],this.independent=0}resetToFirstBranch(){let e=this.getCurrentSketch();this.branch=e?UZ(e,this.grapher.settings.config.audioTraceSimult):0}resetTracePoint(){this.grapher.traceLayer.setTraceInfo(void 0),this.grapher.traceLayer.setTraceLine(void 0),this.drawTracePoint(this.getCurrentPoint())}drawTracePoint(e){let t=this.getCurrentSketch();if(!e||!t)return;let o=t.branches[this.branch];if(!o)return;let i=o.graphMode;if(__dcg_shared_module_exports__['bd'](i))return;let n={x:e.x,y:e.y},a={branchInfo:{branch:e.branch,id:t.id,sketch:t},pt:n};__dcg_shared_module_exports__['db'](a,this.grapher.traceLayer.getTraceInfo())||(this.grapher.traceLayer.setTraceInfo(a),this.controller.requestRedrawGraph())}drawTraceLine(e,t){if(e===void 0||!t)return;let o=this.getCurrentSketch();t===1?this.grapher.traceLayer.setTraceLine({x:void 0,y:e,color:o==null?void 0:o.color}):this.grapher.traceLayer.setTraceLine({x:e,y:void 0,color:o==null?void 0:o.color})}moveToOrigin(){let e=this.getCurrentSketch();if(!e||!Bl(this.controller,e))return;let t=e.branches[this.branch];if(!_d(t,this.grapher.settings.config.audioTraceSimult))return;let o=t.graphMode;if(o===2)this.setIndependent("x",0);else if(o===1)this.setIndependent("y",0);else if(__dcg_shared_module_exports__['bd'](o)){let i=this.getSortedPOI()[0];this.setIndependent("x",i?i.x:0)}}getCurrentSketch(){let e,t=this.controller.getSelectedItem();if(t)if(t.type==="table"){let o=this.audiograph.getFocusedTableLocation();if(o&&(e=this.getGraphSketchForTableLocation(t,o)),!e){for(let i of t.columnModels)if(e=this.grapher.getGraphSketch(i.id),e!==void 0)break}}else e=this.grapher.getGraphSketch(t.id);return e}getFirstTraceableSketch(e){let[t]=this.getTraceableCurves(void 0,this.controller.shouldAudioTraceReverseExpressions()?"up":"down");if(t){let o=this.controller.getItemModelByIndex(t.expressionIndex);if(!o)return;let i;switch(t.type){case"expression":i=this.grapher.getGraphSketch(o.id);break;case"table":e!=null&&e.selectAssociatedExpression&&this.audiograph.setFocusedTableLocation(t.location),i=this.getGraphSketchForTableLocation(o,t.location);break;default:let n=t;throw new Error(`Unexpected curve type ${n}`)}if(i)return e!=null&&e.selectAssociatedExpression&&this.controller.dispatch({type:"set-selected-index",index:t.expressionIndex}),i}}canTrace(e){if(!e||e.type==="image"||e.type==="text")return!1;let t;if(e.type==="expression"&&e.shouldGraph)t=this.grapher.getGraphSketch(e.id);else if(e.type==="table"){for(let o of e.columnModels)if(o.shouldGraph){t=this.grapher.getGraphSketch(o.id);break}}return t?Bl(this.controller,t):!1}getTraceableExpressionCount(){let e=0,t=this.controller.getItemCount();for(let o=0;o<t;o++){let i=this.controller.getItemModelByIndex(o);i&&this.canTrace(i)&&e++}return e}computeStepSizes(){let e=this.grapher.getProjection().viewport;if(!e)return;let t=e.xmin,o=e.xmax,i=e.ymin,n=e.ymax,a=this.getCurrentSketch();if(!a||!Bl(this.controller,a))return;let s=a.branches[this.branch];if(!_d(s,this.grapher.settings.config.audioTraceSimult))return;let c=s.graphMode;if(c===2)this.independent<t?this.independent=t:this.independent>o&&(this.independent=o);else if(c===1)this.independent<i?this.independent=i:this.independent>n&&(this.independent=n);else if(__dcg_shared_module_exports__['bd'](c)){let d,p;this.independent<t?(p=this.getSortedPOI()[0],this.independent=p&&p.x!==void 0?p.x:0):this.independent>o&&(d=this.getSortedPOI(),p=d[d.length-1],this.independent=p&&p.x!==void 0?p.x:0)}}getPoint(e,t){let o,i=this.getCurrentSketch();if(!i||!Bl(this.controller,i))return o;let n,a,s=0,c=i.branches[e];if(!c)return;let d=Xk(i,e,this.grapher.settings.config.audioTraceSimult);"compiled"in c&&c.compiled&&(a=c.compiled.fn);let p=c.graphMode,u=this.grapher.getProjection(),{mathToPixels:g,pixelsToMath:h,screen:b}=u;if(p===2||p===8){let v=h.mapX(g.mapX(t)+b.width/(nw-1));n=this.getInterveningPOIs(t,v,e,p)[0],(!n||n.x!==t||n.branch!==e)&&(n=void 0,s=a?a(t):0),n?o={x:n.x,y:n.y,type:n.type,typeChain:n.typeChain,branch:n.branch,reportedBranch:d,graphMode:p,intersects:n.intersects}:a&&(o={x:t,y:s,branch:e,reportedBranch:d,graphMode:p})}else if(p===1){let v=h.mapY(g.mapY(t)-b.height/(nw-1));n=this.getInterveningPOIs(t,v,e,p)[0],(!n||n.y!==t||n.branch!==e)&&(n=void 0,s=a?a(t):0),n?o={x:n.x,y:n.y,type:n.type,typeChain:n.typeChain,branch:n.branch,reportedBranch:d,graphMode:p,intersects:n.intersects}:a&&(o={y:t,x:s,branch:e,reportedBranch:d,graphMode:p})}else if(__dcg_shared_module_exports__['bd'](p)){let v=h.mapX(g.mapX(t)+b.width/(nw-1));n=this.getInterveningPOIs(t,v,e,p)[0],n&&n.x===t&&n.branch===e?o={x:n.x,y:n.y,type:n.type,typeChain:n.typeChain,branch:n.branch,reportedBranch:d,graphMode:p,intersects:n.intersects}:o={x:t,y:NaN,branch:e,reportedBranch:d,graphMode:p}}return o}getSampledPoints(){return this.sampledPoints.length===0&&this.updateSampledPoints(),this.sampledPoints}updateSampledPoints(){let e=this.getCurrentSketch();if(!e||!Bl(this.controller,e))return;let t=[],o=this.grapher.getProjection(),i=o.viewport;for(let n=0;n<e.branches.length;n++){let a=e.branches[n];if(!_d(a,this.grapher.settings.config.audioTraceSimult))continue;let s=a.graphMode,c=0,d=0,p=[],u;if(s===2||__dcg_shared_module_exports__['bd'](s))c=i.xmin,d=i.xmax,u=(g,h,b)=>o.mathToPixels.interpolateX(g,h,b);else if(s===1)c=i.ymin,d=i.ymax,u=(g,h,b)=>o.mathToPixels.interpolateY(g,h,b);else continue;for(let g=0;g<nw;g++){let h=u(c,d,g/(nw-1)),b=__dcg_shared_module_exports__['nb'](h).value,v=u(c,d,(g+1)/(nw-1)),T=__dcg_shared_module_exports__['nb'](v).value,E=this.getInterveningPOIs(b,T,n,s);if(E.length>0)p.push.apply(p,E);else{let I=this.getPoint(n,b);I&&p.push(I)}}t.push.apply(t,this.removeDuplicates(p,s))}this.sampledPoints=t}getCurrentPoint(){return this.currentPoint||this.updateCurrentPoint(),this.currentPoint}updateCurrentPoint(e){if(e){this.currentPoint=e;let t=e.graphMode;t===2||__dcg_shared_module_exports__['bd'](t)?this.independent=e.x!==void 0?e.x:0:t===1&&(this.independent=e.y!==void 0?e.y:0),this.branch=e.branch}else this.currentPoint=this.getPoint(this.branch,this.independent)}prevPoint(){this.moveToPoint(-1)}nextPoint(){this.moveToPoint(1)}firstPoint(){let e=this.getSampledPoints();e.length>0&&this.updateCurrentPoint(e[0])}lastPoint(){let e=this.getSampledPoints();e.length>0&&this.updateCurrentPoint(e[e.length-1])}moveToPoint(e){let t=this.getCurrentPoint();if(!t)return;if(__dcg_shared_module_exports__['bd'](t.graphMode)){this.moveToPOI(e);return}let o=this.getSampledPoints(),i=this.getClosestPointIndexOnSameBranch(o,t);if(i!==-1){let n=i+e;n<=0?(n=0,It(this.controller.s("graphing-calculator-narration-audio-trace-first-point"))):n>=o.length-1&&(n=o.length-1,It(this.controller.s("graphing-calculator-narration-audio-trace-last-point")));let a=o[n];this.updateCurrentPoint(a)}}canMoveToPrevPoint(){let e=this.getCurrentPoint();if(!e)return!1;if(__dcg_shared_module_exports__['bd'](e.graphMode))return this.canMoveToPrevPOI();let t=this.getSampledPoints(),o=this.getClosestPointIndexOnSameBranch(t,e);return o!==-1&&o>0}canMoveToNextPoint(){let e=this.getCurrentPoint();if(!e)return!1;if(__dcg_shared_module_exports__['bd'](e.graphMode))return this.canMoveToNextPOI();let t=this.getSampledPoints(),o=this.getClosestPointIndexOnSameBranch(t,e);return o!==-1&&o<t.length-1}prevPOI(){this.moveToPOI(-1)}nextPOI(){this.moveToPOI(1)}getSortedPOI(){return(!this.pois||this.pois.length===0)&&this.updatePOI(),this.pois}updatePOI(){let e=[],t,o=[],i=this.getCurrentSketch();if(!(!i||!Bl(this.controller,i))){for(let n=0;n<i.branches.length;n++){let a=i.branches[n];if(!a)continue;let s=Xk(i,n,this.grapher.settings.config.audioTraceSimult),c=a.graphMode;if(o=[],t=i.getBranchPOI(n),t.length>0){c===2||__dcg_shared_module_exports__['bd'](c)?o=__dcg_shared_module_exports__['Pa'](t,"x"):c===1&&(o=__dcg_shared_module_exports__['Pa'](t,"y"));let d=[];for(let p of o)d.push(ixe(p,c,s));e.push.apply(e,this.removeDuplicates(d,c))}}this.pois=e}}removeDuplicates(e,t){let o=[];for(let i of e){if(i={...i},i.graphMode=t,o.length===0){o.push(i);continue}let n=o[o.length-1];__dcg_shared_module_exports__['nb'](n.x).value===__dcg_shared_module_exports__['nb'](i.x).value&&__dcg_shared_module_exports__['nb'](n.y).value===__dcg_shared_module_exports__['nb'](i.y).value&&n.branch===i.branch?(n.typeChain||(n.typeChain=n.type!==void 0?[n.type]:[]),i.type!==void 0&&n.typeChain.indexOf(i.type)===-1&&n.typeChain.push(i.type),i.type===1001&&i.intersects&&n.intersects===void 0&&(n.intersects=i.intersects)):o.push(i)}return o}getInterveningPOIs(e,t,o,i){let n=[],a=this.getSortedPOI(),s=NaN;for(let c of a)c&&((i===2||__dcg_shared_module_exports__['bd'](i))&&!isNaN(c.x)?s=c.x:i===1&&!isNaN(c.y)&&(s=c.y),c.branch===o&&!isNaN(s)&&(e<=s&&s<t||t<=s&&s<e)&&n.push(c));return e>t?n.reverse():n}setIndependent(e,t){let o=this.getSampledPoints();for(let n of o)if(n&&n.hasOwnProperty(e)&&n[e]===t){if(e==="x"){this.independent=n.x!==void 0?n.x:0,this.updateCurrentPoint();return}else if(e==="y"){this.independent=n.y!==void 0?n.y:0,this.updateCurrentPoint();return}}let i=!0;if(o.length>0){let n=Math.floor((o.length-1)/2),a=o[n];a&&(e==="x"?(this.independent=a.x!==void 0?a.x:0,i=!1):e==="y"&&(this.independent=a.y!==void 0?a.y:0,i=!1))}i&&(this.independent=0),this.resetToFirstBranch(),this.updateCurrentPoint()}moveToPOI(e){if(!this.getCurrentPoint())return;let o=this.getSampledPoints(),i=this.getPOIIndexByDirection(e);i===-1?It(this.controller.s("graphing-calculator-narration-audio-trace-no-more-pois")):this.updateCurrentPoint(o[i])}getPOIIndexByDirection(e){let t=this.getCurrentPoint();if(!t)return-1;let o=this.getSampledPoints(),i=this.getClosestPointIndexOnSameBranch(o,t),n=-1;if(i!==-1){let a=t.graphMode,s=e===1?o.length-1:0;for(let c=i;c!==s+e;c+=e){let d=o[c];if(((a===2||__dcg_shared_module_exports__['bd'](a))&&t.x!==d.x||a===1&&t.y!==d.y)&&d.type!==void 0){n=c;break}}}return n}canMoveToPrevPOI(){return this.getPOIIndexByDirection(-1)!==-1}canMoveToNextPOI(){return this.getPOIIndexByDirection(1)!==-1}getClosestPointIndexOnSameBranch(e,t){let o=-1,i=1/0;if(e.length>0&&t){let n=t.graphMode;for(let a=0;a<e.length;a++){let s=e[a];if(t.branch!==s.branch)continue;let c;n===2||__dcg_shared_module_exports__['bd'](n)?c=Math.abs(s.x-t.x):c=Math.abs(s.y-t.y),c<i&&(o=a,i=c)}}return o}prevCurve(){this.controller.shouldAudioTraceReverseExpressions()?this.switchCurves("down"):this.switchCurves("up")}nextCurve(){this.controller.shouldAudioTraceReverseExpressions()?this.switchCurves("up"):this.switchCurves("down")}switchCurves(e){let t=this.controller.getSelectedItem();if(!t)return;let o=e==="down"?this.findNextTraceableIndex(t.index):this.findPrevTraceableIndex(t.index);if(o){let i=this.controller.getItemModelByIndex(o.expressionIndex);if(!i)return;o.type==="table"&&this.audiograph.setFocusedTableLocation(o.location),this.controller.dispatch({type:"set-selected-id",id:i.id,state:"selected"}),this.controller.runAfterDispatch(()=>this.audiograph.enterAudioTrace())}}canMoveToPrevCurve(){let e=this.controller.getSelectedItem();return e?this.controller.shouldAudioTraceReverseExpressions()?!!this.findNextTraceableIndex(e.index):!!this.findPrevTraceableIndex(e.index):!1}canMoveToNextCurve(){let e=this.controller.getSelectedItem();return e?this.controller.shouldAudioTraceReverseExpressions()?!!this.findPrevTraceableIndex(e.index):!!this.findNextTraceableIndex(e.index):!1}*getTraceableCurves(e,t="down"){let o=t==="down"?1:-1;for(let i=e!=null?e:t==="down"?0:this.controller.getItemCount()-1;t==="down"?i<=this.controller.getItemCount()-1:i>=0;i+=o){let n=this.controller.getItemModelByIndex(i);if(this.canTrace(n))if((n==null?void 0:n.type)==="table"){let a=[];for(let c=1;c<n.columnModels.length;c+=1){let d=n.columnModels[c];d!=null&&d.shouldGraph&&this.grapher.getGraphSketch(d.id)&&a.push({type:"table",expressionIndex:i,location:{tableId:n.id,type:"cell",location:{column:c,row:0}}})}this.controller.areTableRegressionsEnabled()&&n.regression&&!n.regression.hidden&&a.push({type:"table",expressionIndex:i,location:{type:"table-regression",location:void 0,tableId:n.id}}),t==="up"&&a.reverse();let s=this.audiograph.getFocusedTableLocation();if(s){let c=a.findIndex(({location:d})=>__dcg_shared_module_exports__['db'](d,s));yield*a.slice(c!==-1?c:0)}else yield*a}else yield{type:"expression",expressionIndex:i}}}findNextTraceableIndex(e){let[t,o]=this.getTraceableCurves(e,"down");return o}findPrevTraceableIndex(e){let[t,o]=this.getTraceableCurves(e,"up");return o}getGraphSketchForTableLocation(e,t){if(!(!e||e.type!=="table")){if(t.type==="cell"){let o=e.columnModels[t.location.column];if(o)return this.grapher.getGraphSketch(o.id)}else if(t.type==="table-regression"){let o=e.regression;if(o)return this.grapher.getGraphSketch(o.id)}}}};En();var WZ="/assets/build/poi-AGMVXCPR.mp3";var um=.075,ao=.0015,jZ=.02,XZ=125,$Z=330,JZ=2e3,axe=27.5,sxe=4186,OU=.04,RU=.2,ZZ=25;function QZ(r){return r<2e3?.002:.005}function lxe(r){return{segments:r.clippedSegments.length,totalPoints:r.clippedSegments.map(e=>e.length).reduce((e,t)=>e+t,0),graphMode:r.graphMode,duration:r.duration,discrete:r.discrete}}var Jk=class{constructor(e,t){this.audioContext=e.audioContext,this.audioContext&&(this.oscillator=this.audioContext.createOscillator(),this.oscillator.setPeriodicWave(e.getBaseWaveform()),this.firstHarmonic=this.audioContext.createOscillator(),this.firstHarmonic.setPeriodicWave(e.getFirstHarmonicWaveform()),this.firstHarmonicGain=this.audioContext.createGain(),this.firstHarmonicGain.gain.value=0,this.pan=this.audioContext.createStereoPanner(),this.pan.pan.value=0,this.gain=this.audioContext.createGain(),this.gain.gain.value=0,this.oscillatorGain=this.audioContext.createGain(),this.oscillatorGain.gain.value=.5,this.oscillatorGain.connect(this.gain),this.oscillator.connect(this.oscillatorGain),this.firstHarmonic.connect(this.firstHarmonicGain),this.firstHarmonicGain.connect(this.gain),this.gain.connect(this.pan),this.pan.connect(t),this.oscillator.start(),this.firstHarmonic.start(),this.brownNoiseGain=this.audioContext.createGain(),this.brownNoiseGain.gain.value=0,this.brownNoiseSource=this.audioContext.createBufferSource(),this.brownNoiseSource.buffer=e.brownNoiseSample,this.brownNoiseSource.loop=!0,this.brownNoiseSource.start(),this.brownNoiseSource.connect(this.brownNoiseGain),this.brownNoiseGain.connect(this.pan))}stop(e){let t=Math.max(this.audioContext.currentTime,e);this.gain.gain.setTargetAtTime(0,t,ao),this.brownNoiseGain.gain.setTargetAtTime(0,t,ao),setTimeout(()=>{this.oscillator.stop(),this.firstHarmonic.stop(),this.brownNoiseSource.stop(),this.pan.disconnect()},1e3*(2*ao+Math.max(0,e-this.audioContext.currentTime))+1)}};function cxe(r){if(r.length<=2)return[r];let e=__dcg_shared_module_exports__['Ya'](r,2),t=0,o=[[e[0]]],i=e[0][0]<e[1][0];for(let n=1;n<e.length;n++)o[t].push(e[n]),n<e.length-1&&i!==e[n][0]<e[n+1][0]&&(i=!i,t++,o[t]=[e[n]]);return o.map(n=>__dcg_shared_module_exports__['Sa'](n))}function dxe(r){let e=__dcg_shared_module_exports__['Ya'](r,2);return e.sort((t,o)=>t[0]-o[0]),__dcg_shared_module_exports__['Sa'](e)}var qA=class{constructor({controller:e,agNavigator:t,audioEnabled:o}){this.isPlayingOneBranch=!1;this.FREQ_MIN=XZ;this.FREQ_MAX=JZ;this.FREQ_BASE=$Z;e&&(this.controller=e),this.audioContextManager=new Lv,this.audioGraphNavigator=t,this.audioEnabled=o,this.screenDuration=5,this.audioVolume=.5}getBaseWaveform(){var o;let e=new Float32Array([0,1,0,.25]),t=new Float32Array([1,0,.25,0]);return(o=this.audioContext)==null?void 0:o.createPeriodicWave(e,t)}getFirstHarmonicWaveform(){var o;let e=new Float32Array([0,0,0,.25,0,0,0,0]),t=new Float32Array([1,0,1,0,.25,0,.3,0]);return(o=this.audioContext)==null?void 0:o.createPeriodicWave(e,t)}async prepareSynthesizer(){if(!this.audioEnabled()||!this.audioContextManager||!this.audioGraphNavigator)return;try{this.audioContext=(await this.audioContextManager.getResumedAudioContext()).audioContext,this.playbackSupported=!0}catch(o){this.playbackSupported=!1;return}this.audioContext.destination.disconnect(),this.mainGainNode=this.audioContext.createGain(),this.mainGainNode.gain.value=this.audioVolume,this.mainGainNode.connect(this.audioContext.destination);let e=this.audioContext.sampleRate*this.screenDuration;this.brownNoiseSample=this.audioContext.createBuffer(1,e,this.audioContext.sampleRate);let t=PU(0);for(let o=0;o<e;o++)t=PU(t),this.brownNoiseSample.getChannelData(0)[o]=t;if(!this.poiBufferSample)try{let o=await fetch(WZ);this.poiBufferSample=await this.audioContext.decodeAudioData(await o.arrayBuffer())}catch(o){Er(o)}SM()}releaseAudio(){var e;this.stop(),(e=this.audioContextManager)==null||e.suspend()}synthesizePoint(e,t,o,i){let{gain:n,brownNoiseGain:a,oscillator:s,firstHarmonic:c,firstHarmonicGain:d,pan:p}=i;o=Math.max(o,this.audioContext.currentTime);let u=this.mapDependentToFrequency(t);if(!(!this.viewportBounds||!u)){if(t<this.viewportBounds.dependentMin||t>this.viewportBounds.dependentMax){a.gain.setTargetAtTime(OU,o,ao),a.gain.setTargetAtTime(0,o+um,ao);return}s.frequency.setValueAtTime(u,o),c.frequency.setValueAtTime(u,o),n.gain.setTargetAtTime(1,o,ao),e>0&&d.gain.setTargetAtTime(.15,o,ao),a.gain.setTargetAtTime(VU(t),o,ao),p.pan.setTargetAtTime(this.getPanValueFromIndependent(e),o,ao),n.gain.setTargetAtTime(0,o+um,ao),d.gain.setTargetAtTime(0,o+um,ao),a.gain.setTargetAtTime(0,o+um,ao)}}playPoint(e){!YZ(e)||!this.audioContextManager||(this.setupScales(e.graphMode),this.prepareSynthesizer().then(()=>{let t=new Jk(this,this.mainGainNode);this.turnMainGainOn();let o=this.audioContext.currentTime,{independent:i,dependent:n}=HZ(e);if(!this.mapDependentToFrequency(n)||!this.viewportBounds){t.stop(o);return}if(this.synthesizePoint(i,n,o,t),e.intersects){let a=this.audioContext.createBufferSource();a.connect(t.gain),a.buffer=this.poiBufferSample;try{a==null||a.start(this.audioContext.currentTime)}catch(s){}}t.stop(o+um+ao)}))}playCurrentSketch(e="sequential"){this.audioContextManager&&this.prepareSynthesizer().then(()=>{this.isPlaying=!0,this.isPlayingOneBranch=!1,this.controller.runAfterDispatch(()=>this.controller.dispatch({type:"render"})),this.prepareToPlay(e),this.startPlayingTime=this.audioContext.currentTime+ao,this.currentPlayLoopStartTime=this.startPlayingTime,this.lagLoggingData||(this.lagLoggingData={startPlayingTime:this.startPlayingTime,branchCount:this.branches.length,branchInfo:this.branches.map(t=>lxe(t)),branchIteratorStartTimes:[],branchIteratorRunTimes:[],branchIteratorCallCount:0,branchLags:[],screenDuration:this.screenDuration}),e==="sequential"?(this.currentPlayLoopBranchIndex=0,this.playBranchIterators=[this.playBranch(this.currentPlayLoopBranchIndex,this.currentPlayLoopStartTime)],this.lagLoggingData&&(this.lagLoggingData.proposedDuration=this.branches.reduce((t,o)=>{var i;return t+((i=o.duration)!=null?i:0)},0)),this.sequentialPlayLoop()):e==="simultaneous"&&(this.playBranchIterators=this.branches.map((t,o)=>this.playBranch(o,this.currentPlayLoopStartTime)),this.playBranchIterators.push(this.playBlankSpace(this.currentPlayLoopStartTime)),this.simultaneousPlayLoop())})}stop(){var i,n,a,s,c,d;kM(),clearTimeout(this.timeoutId),this.isPlaying=!1,this.startPlayingTime=void 0;let e=(i=this.audioContext)==null?void 0:i.currentTime;if(!e)return;this.lagLoggingData&&(this.lagLoggingData.actualDuration=e-this.lagLoggingData.startPlayingTime,this.lagLoggingData.stopPlayingTime=e,(a=(n=this.controller).logEvent)==null||a.call(n,{category:"audio-trace",action:"stop-graph"}),this.lagLoggingData=void 0);let t=(s=this.playBranchIterators)==null?void 0:s.map(p=>p.next()).filter(p=>!p.done);t==null||t.forEach(p=>{var u,g;return(g=(u=p.value).synthStopCallback)==null?void 0:g.call(u,e)}),this.playBranchIterators=[],(c=this.mainGainNode)==null||c.gain.cancelScheduledValues(e),(d=this.mainGainNode)==null||d.gain.setTargetAtTime(0,e,ao);let o=this.mainGainNode;setTimeout(()=>o.disconnect(),1e3*2*ao+1),this.controller.runAfterDispatch(()=>this.controller.dispatch({type:"render"}))}getGraphMode(){if(this.branches)return this.currentPlayLoopBranchIndex!==void 0?this.branches[this.currentPlayLoopBranchIndex].graphMode:this.branches[0].graphMode}playBranchByIndex(e){this.audioContext&&this.prepareSynthesizer().then(()=>{this.prepareToPlay("simultaneous"),this.isPlayingOneBranch=!0,this.isPlaying=!0,this.startPlayingTime=this.audioContext.currentTime+ao,this.currentPlayLoopStartTime=this.startPlayingTime,this.currentPlayLoopBranchIndex=e,this.branches[0].graphMode===8||this.branches[0].graphMode==5||this.branches[0].graphMode==6?(this.playBranchIterators=this.branches.map((t,o)=>this.playBranch(o,this.currentPlayLoopStartTime)),this.playBranchIterators.push(this.playBlankSpace(this.currentPlayLoopStartTime))):this.playBranchIterators=[this.playBranch(e,this.startPlayingTime)],this.simultaneousPlayLoop()})}getPlaybackSupported(){return this.playbackSupported}getIsPlaying(){return this.isPlaying}getAudioSpeed(){return this.screenDuration*10}setAudioSpeed(e){this.screenDuration=e/10}getAudioVolume(){return this.audioVolume}setAudioVolume(e){var t;this.audioVolume=e,(t=this.mainGainNode)==null||t.gain.setTargetAtTime(this.audioVolume,0,ao)}getCurrentIndependentValue(){var o,i;if(!this.getIsPlaying()||this.startPlayingTime===void 0)return;if(this.isPlayingOneBranch)return(i=(o=this.branches[this.currentPlayLoopBranchIndex]).mapTimeToIndependent)==null?void 0:i.call(o,this.audioContext.currentTime-this.startPlayingTime);let e=this.audioContext.currentTime-this.startPlayingTime,t=0;for(let n of this.branches)if(!(!n.duration||!n.mapIndependentToTime||!n.mapTimeToIndependent)){if(e-t>=n.duration){t+=n.duration;continue}return n.mapTimeToIndependent(e-t)}}getCurrentBranchIndex(){if(!this.getIsPlaying()||this.startPlayingTime===void 0)return;if(this.isPlayingOneBranch)return this.currentPlayLoopBranchIndex;let e=this.audioContext.currentTime-this.startPlayingTime,t=0;for(let o=0;o<this.branches.length;o++){let i=this.branches[o];if(i.duration){if(e-t>=i.duration){t+=i.duration;continue}return o}}}preprocessBranch(e,t){switch(e.graphMode){case 8:case 5:case 6:let o=[],i=e.segments;if(e.graphMode===6){let n=this.controller.getViewState();i=i.map(a=>zZ(a,n))}for(let n of i){let s=GU(n,t,Sb);o.push(...s.filter(c=>c.length>2))}return o=__dcg_shared_module_exports__['Sa'](o.map(n=>cxe(n).map(a=>dxe(a))),!0),o.sort((n,a)=>n[0]-a[0]),o.map(n=>({graphMode:e.graphMode,discrete:!1,poi:e.poi,clippedSegments:[n]})).filter(n=>n.clippedSegments.length>0);case 2:case 1:{let n=[];for(let a of e.segments){let s=e.graphMode===2?Sb:$v,c=GU(a,t,s);n.push(...c.filter(d=>d.length>2))}return n.sort((a,s)=>a[0]-s[0]),{graphMode:e.graphMode,discrete:!1,clippedSegments:n,poi:e.poi}}case 3:case 25:case 26:case 4:{let{viewport:n}=t,a=e.segments[0].slice();a.sort(qZ);let s=[],c=[];for(let d of a)s.push(d[0],d[1]),d[0]>=n.xmin&&d[0]<=n.xmax&&d[1]>=n.ymin&&d[1]<=n.ymax&&c.push(d[0],d[1]);return{graphMode:2,discrete:!0,clippedSegments:[c],poi:void 0}}default:throw new Error(`Unimplemented graph mode: ${e.graphMode}`)}}turnMainGainOn(){var e,t;(e=this.mainGainNode)==null||e.gain.cancelScheduledValues(0),(t=this.mainGainNode)==null||t.gain.setTargetAtTime(this.audioVolume,0,ao)}getPanValueFromIndependent(e){if(!this.independentScale)return 0;let t=__dcg_shared_module_exports__['fd'](this.independentScale,e)/this.screenDuration;return __dcg_shared_module_exports__['Rb'](2*t-1,-1,1)}setupScales(e){this.projection=this.controller.get2dProjection(),this.viewportBounds=BZ(this.projection.viewport,e);let t=e===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,o=e===1?this.projection.settings.xAxisScale:this.projection.settings.yAxisScale;this.independentScale=__dcg_shared_module_exports__['ed'](t,[this.viewportBounds.independentMin,this.viewportBounds.independentMax],[0,this.screenDuration]),this.dependentScale=__dcg_shared_module_exports__['ed'](o,[this.viewportBounds.dependentMin,this.viewportBounds.dependentMax],[0,1]),this.viewportBounds.dependentMax<=sxe&&this.viewportBounds.dependentMin>=axe&&this.viewportBounds.dependentMax-this.viewportBounds.dependentMin>=1e3?(this.FREQ_MIN=this.viewportBounds.dependentMin,this.FREQ_MAX=this.viewportBounds.dependentMax,this.FREQ_BASE=void 0):(this.FREQ_MIN=XZ,this.FREQ_MAX=JZ,this.FREQ_BASE=$Z)}densifyBranches(){this.branches.map(e=>{if(e.discrete)return e;let t=this.independentScale,o=this.dependentScale;return!t||!o||!e.clippedSegments||(e.clippedSegments=e.clippedSegments.map(i=>{let n=[];for(let a=0;a<i.length;a+=2){let s=this.mapDependentToFrequency(i[a+1]),c=this.mapDependentToFrequency(i[a+3]);if(n.push(i[a]),n.push(i[a+1]),s&&c&&isFinite(s)&&isFinite(c)&&Math.abs((c-s)/s)>=QZ(Math.min(c,s))){let d=Math.ceil(Math.abs((c-s)/s)/QZ(Math.min(c,s)));for(let p=1;p<d;p++)n.push(__dcg_shared_module_exports__['gd'](t.type,i[a],i[a+2],p*1/d)),n.push(__dcg_shared_module_exports__['gd'](o.type,i[a+1],i[a+3],p*1/d))}}return n})),e})}setupToPlayBranches(e){if(!this.audioGraphNavigator||!this.audioContext||!this.mainGainNode)return;let t=this.audioGraphNavigator.getCurrentSketch();if(!t)return;let o=this.controller.get2dProjection();if(this.branches=__dcg_shared_module_exports__['Sa'](t.branches.filter(i=>_d(i,this.controller.getGraphSettings().config.audioTraceSimult)).map(i=>this.preprocessBranch(i,o))).filter(i=>i.clippedSegments.length>0),!!this.branches.length)if(this.setupScales(this.branches[0].graphMode),this.densifyBranches(),e==="simultaneous"){let i=Math.min(...this.branches.map(d=>d.clippedSegments[0][0])),n=Math.max(...this.branches.map(d=>d.clippedSegments.slice(-1)[0].slice(-2)[0])),a=this.mapIndependentToTime(n)-this.mapIndependentToTime(i),s=__dcg_shared_module_exports__['ed'](this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[i,n],[0,a]),c=__dcg_shared_module_exports__['ed'](this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[0,a],[i,n]);this.branches.forEach(d=>{d.duration=d.discrete?a+um:a,d.mapIndependentToTime=p=>__dcg_shared_module_exports__['fd'](s,p),d.mapTimeToIndependent=p=>__dcg_shared_module_exports__['fd'](c,p)})}else this.branches.forEach(i=>{let n=i.clippedSegments[0][0],a=i.clippedSegments.slice(-1)[0].slice(-2)[0];i.discrete?i.duration=i.clippedSegments.reduce((d,p)=>d+p.length/2,0)*(um+jZ):i.duration=this.mapIndependentToTime(a)-this.mapIndependentToTime(n);let s=__dcg_shared_module_exports__['ed'](this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[n,a],[0,i.duration]),c=__dcg_shared_module_exports__['ed'](this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[0,i.duration],[n,a]);i.mapIndependentToTime=d=>__dcg_shared_module_exports__['fd'](s,d),i.mapTimeToIndependent=d=>__dcg_shared_module_exports__['fd'](c,d)})}prepareToPlay(e){this.setupToPlayBranches(e),this.turnMainGainOn(),clearInterval(this.timeoutId)}sequentialPlayLoop(){var o,i,n,a,s;let e=this.audioContext.currentTime,t=(o=this.playBranchIterators[0])==null?void 0:o.next();if(this.lagLoggingData&&(this.lagLoggingData.branchIteratorCallCount++,this.audioContext.currentTime-e>0&&(this.lagLoggingData.branchIteratorStartTimes.push(e),this.lagLoggingData.branchIteratorRunTimes.push(this.audioContext.currentTime-e))),!!t){if(t.done)if(((i=t.value)==null?void 0:i.duration)!==void 0&&(this.currentPlayLoopStartTime=((n=t.value.startTime)!=null?n:this.currentPlayLoopStartTime)+t.value.duration),this.currentPlayLoopBranchIndex<this.branches.length-1)this.currentPlayLoopBranchIndex++,this.playBranchIterators[0]=this.playBranch(this.currentPlayLoopBranchIndex,this.currentPlayLoopStartTime),this.sequentialPlayLoop();else{(a=this.mainGainNode)==null||a.gain.cancelScheduledValues(this.currentPlayLoopStartTime),(s=this.mainGainNode)==null||s.gain.setTargetAtTime(0,this.currentPlayLoopStartTime,ao),clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>this.stop(),1e3*(Math.max(this.currentPlayLoopStartTime-this.audioContext.currentTime,0)+ao));return}this.timeoutId=setTimeout(()=>this.sequentialPlayLoop(),ZZ)}}simultaneousPlayLoop(){var t,o;let e=this.playBranchIterators.map(i=>i.next());if(e.every(i=>i.done)){let i=this.currentPlayLoopStartTime+Math.max(...e.map(n=>{var a;return(a=n.value)!=null&&a.duration&&isFinite(n.value.duration)?n.value.duration:0}));(t=this.mainGainNode)==null||t.gain.cancelScheduledValues(i),(o=this.mainGainNode)==null||o.gain.setTargetAtTime(0,i,ao),this.timeoutId=setTimeout(()=>this.stop(),1e3*(Math.max(i-this.audioContext.currentTime,0)+ao))}else this.timeoutId=setTimeout(()=>this.simultaneousPlayLoop(),ZZ)}*playBlankSpace(e){let t=Math.max(this.audioContext.currentTime,e),o=new Jk(this,this.mainGainNode),{oscillator:i,pan:n,brownNoiseGain:a,gain:s}=o;i.stop(),s.gain.setTargetAtTime(1,t,ao);let c=this.branches.map(u=>{if(u.mapIndependentToTime)return[u.clippedSegments[0][0],u.clippedSegments.slice(-1)[0].slice(-2)[0]]}).filter(u=>!!u),d=[];for(c.sort((u,g)=>u[0]-g[0]);c.length>0;){let u=c[0];c=c.filter(g=>g[1]>u[1]),c.filter(g=>g[0]<=u[1]).length===0&&d.push([u[1],Math.min(...c.map(g=>g[0]))])}d=d.filter(u=>isFinite(u[0])&&isFinite(u[1]));let p=u=>{o.stop(u)};for(let u of d){let g=t+this.mapIndependentToTime(u[0]),h=t+this.mapIndependentToTime(u[1]);for(;g>this.audioContext.currentTime+RU;)yield{synthStopCallback:p};a.gain.setTargetAtTime(OU,g,ao),a.gain.setTargetAtTime(0,h,ao),n.pan.setValueAtTime(this.getPanValueFromIndependent(u[0]),g),n.pan.linearRampToValueAtTime(this.getPanValueFromIndependent(u[1]),h)}return{duration:0}}mapDiscreteSegmentIndexToTime(e){return e/2*(um+jZ)}*playBranch(e,t){var v,T,E,I;let o=this.branches[e];if(!(o!=null&&o.duration)||!(o!=null&&o.mapIndependentToTime))return{duration:0};let i=new Jk(this,this.mainGainNode),n=o.clippedSegments,a=_=>{i.stop(_)},{oscillator:s,gain:c,firstHarmonic:d,firstHarmonicGain:p,pan:u,brownNoiseGain:g}=i,h=Math.max(this.audioContext.currentTime,t);if(o.poi&&o.poi.intersections&&this.poiBufferSample){let _=KZ(o.graphMode,o.poi.intersections);for(let C of _){let D=this.audioContext.createBufferSource();D.connect(c),D.buffer=this.poiBufferSample;try{D==null||D.start(h+o.mapIndependentToTime(C))}catch(P){}}}let b=h;for(let _=0;_<n.length;_++){let C=n[_];for(let D=0;D<C.length;D+=2){let P=D===0,F=D+2>=C.length,N=o.discrete?b+this.mapDiscreteSegmentIndexToTime(D):h+o.mapIndependentToTime(C[D]),Y=this.mapDependentToFrequency(C[D+1]);for(;N>this.audioContext.currentTime+RU;)yield{synthStopCallback:a,duration:void 0};if(o.discrete){this.synthesizePoint(C[D],C[D+1],b+this.mapDiscreteSegmentIndexToTime(D),i);continue}if(N<this.audioContext.currentTime-RU&&this.lagLoggingData&&this.lagLoggingData.branchLags.push({branchIndex:e,segmentIndex:_,pos:D,nextTime:N,proposedStartTime:t,lagAmount:this.audioContext.currentTime-N,currentTime:this.audioContext.currentTime}),P&&(p.gain.cancelScheduledValues(N),g.gain.cancelScheduledValues(N),c.gain.setTargetAtTime(1,N,ao)),Y!==void 0&&isFinite(Y)){s.frequency.linearRampToValueAtTime(Y,N),d.frequency.linearRampToValueAtTime(Y,N);let z=N;if(D>=2&&C[D-2]<=0!=C[D]<=0){let A=C[D-2],O=C[D];z=h+o.mapIndependentToTime(__dcg_shared_module_exports__['gd']((T=(v=this.independentScale)==null?void 0:v.type)!=null?T:"linear",A,O,Math.abs(O)/(Math.abs(O)+Math.abs(A))))}p.gain.setTargetAtTime(C[D]>0?.15:0,z,ao);let q=N;if(D>=2&&C[D+1]<=0!=C[D-1]<=0){let A=C[D-2],O=C[D],B=C[D-1],V=C[D+1];q=h+o.mapIndependentToTime(__dcg_shared_module_exports__['gd']((I=(E=this.independentScale)==null?void 0:E.type)!=null?I:"linear",A,O,Math.abs(B)/(Math.abs(B)+Math.abs(V))))}g.gain.setTargetAtTime(VU(C[D+1]),q,ao)}F&&(c.gain.setTargetAtTime(0,N,ao),_<o.clippedSegments.length-1&&g.gain.setTargetAtTime(OU,N,ao)),D===0?u.pan.setValueAtTime(this.getPanValueFromIndependent(C[D]),N):u.pan.linearRampToValueAtTime(this.getPanValueFromIndependent(C[D]),N)}b+=this.mapDiscreteSegmentIndexToTime(C.length)}return o.duration=Math.max(0,o.duration,this.audioContext.currentTime-t),i.stop(h+o.duration),{duration:o.duration,startTime:h}}mapIndependentToTime(e){return this.independentScale?__dcg_shared_module_exports__['fd'](this.independentScale,e):0}mapDependentToFrequency(e){if(!this.dependentScale)return;let t=__dcg_shared_module_exports__['fd'](this.dependentScale,e);if(this.FREQ_BASE)return Math.min(Math.max(this.FREQ_BASE*Math.pow(2,t),this.FREQ_MIN),this.FREQ_MAX);{let o=this.FREQ_MAX-this.FREQ_MIN;return Math.min(Math.max(this.FREQ_MIN+o*t,this.FREQ_MIN),this.FREQ_MAX)}}};var Zk=[{speed:1600,displayedSpeed:"1/32 x"},{speed:1200,displayedSpeed:"1/24 x"},{speed:800,displayedSpeed:"1/16 x"},{speed:400,displayedSpeed:"1/8 x"},{speed:200,displayedSpeed:"1/4 x"},{speed:100,displayedSpeed:"1/2 x"},{speed:50,displayedSpeed:"1 x"},{speed:25,displayedSpeed:"2 x"},{speed:12.5,displayedSpeed:"4 x"},{speed:6.25,displayedSpeed:"8 x"}],HA=class{constructor(e,t){this.focusedTableLocation=void 0;this.grapher=t,this.controller=e,this.audioTraceActive=!1,this.wasFocusInExpressionsView=!1,this.sliderTraceActive=!1,this.sliderIndex=0,this.sliderArray=[],this.lastSpokenBranch=1,this.agNavigator=new zA(e,this,this.grapher),this.agSynthesizer=new qA({controller:e,agNavigator:this.agNavigator,audioEnabled:()=>this.controller.getAudio()}),this.audioSpeedIndex=6,this.agSynthesizer.releaseAudio()}remove(){}handleKeydown(e){let t=e.altKey&&!e.metaKey&&!e.ctrlKey&&!e.shiftKey;t&&Jr(e)==="S"?this.controller.getSelectedItem()&&(this.audioTraceActive||this.isFocusInExpressionsView())&&(e.preventDefault(),e.stopPropagation(),this.describeCurve()):t&&Jr(e)==="G"?(this.audioTraceActive||this.isFocusInExpressionsView())&&(e.preventDefault(),e.stopPropagation(),this.describeAxes()):t&&Jr(e)==="T"?(e.preventDefault(),e.stopPropagation(),this.toggleAudioTrace()):this.audioTraceActive&&(this.sliderTraceActive?this.sliderTraceKeydown(e):(this.stopAnimations(),this.audioTraceKeydown(e)))}sliderTraceKeydown(e){let t=e.altKey||e.metaKey,o=!t&&!e.ctrlKey&&!e.shiftKey;o&&Pe(e)===np||Jr(e)==="J"?(e.preventDefault(),e.stopPropagation(),this.decrementSliderValue()):o&&Pe(e)===ap||Jr(e)==="L"?(e.preventDefault(),e.stopPropagation(),this.incrementSliderValue()):o&&Pe(e)===bg?(e.preventDefault(),e.stopPropagation(),this.decrementBigSliderValue()):o&&Pe(e)===fg?(e.preventDefault(),e.stopPropagation(),this.incrementBigSliderValue()):!t&&(Pe(e)===Mi||!e.shiftKey&&Pe(e)===us||Jr(e)==="K")?(e.preventDefault(),e.stopPropagation(),this.nextSlider()):!t&&(Pe(e)===Tn||e.shiftKey&&Pe(e)===us||Jr(e)==="I")?(e.preventDefault(),e.stopPropagation(),this.prevSlider()):o&&Pe(e)===Bu||Jr(e)==="U"?(e.preventDefault(),e.stopPropagation(),this.sliderMin()):o&&Pe(e)===Wc||Jr(e)==="N"?(e.preventDefault(),e.stopPropagation(),this.sliderMax()):this.audioTraceKeydown(e)}audioTraceKeydown(e){let t=e.altKey||e.metaKey,o=t&&!e.ctrlKey&&!e.shiftKey,i=!t&&!e.ctrlKey&&!e.shiftKey,n=Jr(e);if(Pe(e)===Tn&&o)e.preventDefault(),e.stopPropagation(),bi(),this.agNavigator.prevCurve();else if(Pe(e)===Mi&&o)e.preventDefault(),e.stopPropagation(),bi(),this.agNavigator.nextCurve();else if(i&&Pe(e)===np||Pe(e)===Tn||n==="J")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/audio-trace",command:"previous-point"});else if(i&&Pe(e)===ap||Pe(e)===Mi||n==="L")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/audio-trace",command:"next-point"});else if(!t&&(Pe(e)===bg||!e.shiftKey&&Pe(e)===us||n==="I"))e.preventDefault(),e.stopPropagation(),this.reportAndMoveToNextPOI();else if(!t&&(Pe(e)===fg||e.shiftKey&&Pe(e)===us||n==="K"))e.preventDefault(),e.stopPropagation(),this.reportAndMoveToPrevPOI();else if(i&&Pe(e)===Bu||n==="U")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToFirstPoint();else if(i&&Pe(e)===Wc||n==="N")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToLastPoint();else if(i&&n==="X")e.preventDefault(),e.stopPropagation(),this.reportX();else if(i&&n==="P")e.preventDefault(),e.stopPropagation(),this.reportPOICount();else if(i&&n==="Y")e.preventDefault(),e.stopPropagation(),this.reportY();else if(i&&n==="T")e.preventDefault(),e.stopPropagation(),this.reportType();else if(i&&n==="B")e.preventDefault(),e.stopPropagation(),this.reportBranch();else if(i&&n==="O")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToOrigin();else if(i&&n==="H")e.preventDefault(),e.stopPropagation(),this.hearGraph();else if(i&&typeof n=="string"&&n>="0"&&n<="9"){if(e.preventDefault(),e.stopPropagation(),bi(),!this.controller.getAudio()){_e(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}this.agSynthesizer.stop();let a=this.agNavigator.getCurrentSketch();if(a){let s;e.which===48?s=9:s=e.which-49;let c=s,d=-1;for(let p=0;p<a.branches.length;p++)if(_d(a.branches[p],this.grapher.settings.config.audioTraceSimult)&&(c-=1),c<0){d=p;break}d>=0?this.agSynthesizer.getPlaybackSupported()?(this.agSynthesizer.playBranchByIndex(d),this.grapher.traceLayer.setTraceInfo(void 0),this.graphAnimationTimeoutId=requestAnimationFrame(()=>this.animateCurrentSketchLine())):_e(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play")):_e(this.controller.s("graphing-calculator-narration-audio-trace-branch-not-found",{branch:s+1}))}else _e(this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected"))}else t&&typeof n=="string"&&n>="1"&&n<="5"?(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-audio-trace-speed",speed:parseInt(n,10)+3})):!e.altKey&&!e.ctrlKey&&!e.metaKey&&n==="V"?(e.preventDefault(),e.stopPropagation(),this.controller.getAudio()?e.shiftKey?this.controller.dispatch({type:"keypad/audio-trace",command:"volume-down"}):this.controller.dispatch({type:"keypad/audio-trace",command:"volume-up"}):_e(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play"))):i&&n==="A"?(e.preventDefault(),e.stopPropagation(),bi(),this.queueAnimatingPoints(!0),_e()):i&&n==="S"&&this.controller.isListEnabled()?(e.preventDefault(),e.stopPropagation(),this.toggleSliderTrace()):i&&n==="C"?(e.preventDefault(),e.stopPropagation(),this.reportColor()):i&&this.exitAudioTrace();this.controller.dispatch({type:"render"})}describeCurve(){bi();let e=this.agNavigator.getCurrentSketch();if(!e){_e(this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected"));return}It(this.controller.s("graphing-calculator-narration-audio-trace-description-color",{color:up(this.controller,e.color)}));let t=Xk(e,e.branches.length-1,this.grapher.settings.config.audioTraceSimult);t>1&&It(this.controller.s("graphing-calculator-narration-audio-trace-description-branch-count",{branches:t}));let o=!1,i=!1;for(let a of e.branches)if(t===1&&a.segments.length>0&&a.hasOwnProperty("operator")){if(a.graphMode===2){if(a.operator===">"||a.operator===">="){It(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-above"));break}else if(a.operator==="<"||a.operator==="<="){It(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-below"));break}}else if(a.graphMode===1){if(a.operator===">"||a.operator===">="){It(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-right"));break}else if(a.operator==="<"||a.operator==="<="){It(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-left"));break}}}else t>1&&(a.graphMode===2||a.graphMode===1?(a.operator==="<"||a.operator==="<="||a.operator===">"||a.operator===">=")&&(o=!0):a.graphMode===7&&(i=!0));o&&i&&It(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-in-regions"));let n=e.getPOI();if(n.length>0){let a=[];for(let s of n)a[s.type]===void 0?a[s.type]=1:a[s.type]+=1;a.forEach((s,c)=>{c===1001?It(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-intersection"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intersections",{count:s})):c===1002?It(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-root"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-roots",{count:s})):c===1003?It(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-intercept"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intercepts",{count:s})):c===1004?It(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-extremum"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-extrema",{count:s})):c===1008&&It(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-label"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-labels",{count:s}))})}_e()}describeAxes(){bi(),_e($k(this.controller))}queueCoordinates(e){if(!this.grapher.getProjection().viewport||!e)return;let o=this.agNavigator.getCurrentSketch();e.hasOwnProperty("branch")&&o&&o.branches.length>1&&this.lastSpokenBranch!==e.reportedBranch&&this.queueCoordinateProp(e,"branch"),e.hasOwnProperty("type")&&It(this.controller.s("graphing-calculator-narration-audio-trace-property-type-before-coordinates",{type:this.describePOI(e)})),e.graphMode===25||e.graphMode===26?It(Mr(__dcg_shared_module_exports__['yb']([e.x,e.y]))):(this.queueCoordinateProp(e,"x"),this.queueCoordinateProp(e,"y"))}queueCoordinateProp(e,t){if(this.grapher.getProjection().viewport&&e)switch(t){case"branch":typeof e.reportedBranch=="number"&&It(this.controller.s("graphing-calculator-narration-audio-trace-property-branch-number",{branch:e.reportedBranch}));break;case"type":It(this.describePOI(e));break;case"x":It(cd(this.controller,e.x));break;case"y":It(dd(this.controller,e.y));break;default:let i=t;throw new Error(`Unexpected prop ${i}`)}}describePOI(e){if(e!=null&&e.typeChain){let t=[];for(let o=0;o<e.typeChain.length;o++)t.push(this.poiTypeToText(e,o));return ol(this.controller.getLanguage(),t)}else return this.poiTypeToText(e)}poiTypeToText(e,t){switch(t&&e.typeChain?e.typeChain[t]:e.type){case 1001:let i=this.getIntersectingCurves(e);return i!==""?this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection-with-curves",{curves:i}):this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection");case 1002:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-root");case 1003:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-intercept");case 1004:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-extremum");case 1006:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-definition");case 1007:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-trace");case 1008:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-label");default:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-not-a-poi")}}getIntersectingCurves(e){return!e||!e.intersects?"":this.getExpressionAriaLabel(e.intersects)}getExpressionAriaLabel(e){var o;let t=this.controller.getItemModel(e);return t?t.type==="expression"&&t.label?po(t.label):t.type==="table"&&((o=this.focusedTableLocation)==null?void 0:o.type)==="cell"?this.controller.s("graphing-calculator-narration-audio-trace-expression-with-column",{index:t.displayIndex,column:this.focusedTableLocation.location.column+1}):Wr(t,"describe"):""}exitAudioTrace(e){var t;if(this.audioTraceActive){if(this.audioTraceActive=!1,this.controller.isKeypadEnabled()&&this.controller.dispatch({type:"keypad/123"}),e||(e=this.controller.s("graphing-calculator-text-audio-trace-off")),this.controller.dispatch({type:"toast/close"}),this.wasFocusInExpressionsView){let o=this.controller.getSelectedItem();if((!o||!this.controller.isItemSelectable(o.id))&&(o=this.controller.getFirstFullyVisibleItem()),o&&this.controller.isItemSelectable(o.id)){let i={type:"move-focus-to-item",id:o.id,where:"end"};if(o.type==="table")switch((t=this.focusedTableLocation)==null?void 0:t.type){case"cell":i.where={location:"cell",...this.focusedTableLocation.location},this.focusedTableLocation.location.column===1&&this.enteredAudioTraceWithFirstTableColumnFocused&&(i.where.column=0);break;case"table-regression":i={type:"set-focus-location",location:{type:"table-regression-type-dropdown",id:o.id}}}this.controller.dispatch(i)}}this.wasFocusInExpressionsView=!1,this.focusedTableLocation=void 0,this.stopAnimations(),this.sliderTraceActive=!1,this.sliderIndex=0,this.agSynthesizer.stop(),this.agSynthesizer.releaseAudio(),this.agNavigator.reset(),this.lastSpokenBranch=1,this.grapher.traceLayer.setTraceInfo(void 0),this.grapher.traceLayer.setTraceLine(void 0),this.controller.requestRedrawGraph(),this.enteredAudioTraceWithFirstTableColumnFocused=!1,_e(e),this.resumeAnimations()}}isFocusInExpressionsView(){return!!this.controller.getFocusedItem()}canAudioTraceCurrentExp(){let e=this.controller.getSelectedItem();return e?e.type==="table"?!!this.agNavigator.getCurrentSketch():this.agNavigator.canTrace(e):!1}enterAudioTrace(e){var a,s;let t=this.controller.getSelectedItem(),o=t&&t.type!=="table"&&!this.agNavigator.canTrace(t)?this.getExpressionAriaLabel(t.id):void 0,i=!1;this.audioTraceActive||(this.wasFocusInExpressionsView=this.isFocusInExpressionsView(),t&&o&&It(this.controller.s("graphing-calculator-narration-audio-trace-unsupported-expression",{expression:o})),i=!!o||!this.wasFocusInExpressionsView);let n;if(i)n=this.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!0});else if(!o){if(t&&t.type==="expression"&&t.formula&&t.formula.error)return this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected")}});if(t&&t.type==="table"){if(!this.focusedTableLocation){let c=gs(t),d=this.controller.getFocusLocation();d!=null&&d.type.startsWith("table-regression")||(a=document.activeElement)!=null&&a.closest(".dcg-table-regression")?this.setFocusedTableLocation({tableId:t.id,type:"table-regression",location:void 0}):(this.enteredAudioTraceWithFirstTableColumnFocused=(c==null?void 0:c.column)===0,this.setFocusedTableLocation(c?{tableId:t.id,type:"cell",location:{column:c.column||1,row:c.row}}:void 0))}}else this.enteredAudioTraceWithFirstTableColumnFocused=!1,this.setFocusedTableLocation(void 0);n=this.agNavigator.getCurrentSketch()}if(!n){this.agNavigator.reset(),this.lastSpokenBranch=1,this.exitAudioTrace(),n=this.agNavigator.getCurrentSketch();let c=n==null?void 0:n.branches[0].graphMode;return c===8&&!this.grapher.settings.config.audioTraceSimult?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-implicit-support")}})):c===5&&!this.grapher.settings.config.audioTraceSimult?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-parametric-support")}})):c===6&&!this.grapher.settings.config.audioTraceSimult?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-polar-support")}})):this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected")}})}if((s=this.controller.toneController)==null||s.handleAction({type:"mute-global"}),this.agNavigator.reset(),this.agNavigator.computeStepSizes(),this.lastSpokenBranch=1,this.grapher.traceLayer.clearOpenedPOI(),this.controller.requestRedrawGraph(),!this.audioTraceActive&&(this.controller.isKeypadEnabled()||this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-on"),noAria:!0,onHide:()=>this.exitAudioTrace(),hideAfter:0}}),o&&n&&It(this.controller.s("graphing-calculator-narration-audio-trace-tracing-different-expression",{expression:this.getExpressionAriaLabel(this.focusedTableLocation?this.focusedTableLocation.tableId:n.id)})),It(this.controller.s("graphing-calculator-text-audio-trace-on")),this.controller.getAudio()||It(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled")),this.pauseAnimations(),this.queueAnimatingPoints(!1),this.agSynthesizer.prepareSynthesizer(),(!e||!e.fromKeypad)&&(It(this.controller.s("graphing-calculator-narration-audio-trace-instructions-use-arrow-keys")),this.controller.getAudio()&&It(this.controller.s("graphing-calculator-narration-audio-trace-instructions-hear-graph")),this.agNavigator.getTraceableExpressionCount()>1&&(qr?It(this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-mac")):It(this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-windows"))),qr?It(this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-mac")):It(this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-windows"))),this.wasFocusInExpressionsView)){let c=this.controller.findEl(".dcg-graph-outer");c&&(re(c).one("focusin",()=>{setTimeout(()=>{_e()},0)}),this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}))}this.agNavigator.moveToOrigin(),It(this.getExpressionAriaLabel(n.id)),this.reportAudioTrace({playSound:!1}),this.wasFocusInExpressionsView||_e(),this.audioTraceActive=!0,this.controller.isKeypadEnabled()&&this.controller.dispatch({type:"keypad/audio"})}checkIfSelectedItemChanged(e){this.lastSelectedId!==e&&(this.lastSelectedId=e,this.audioTraceActive&&(e?(It(this.getExpressionAriaLabel(e)),this.exitSliderTrace(),this.agNavigator.updatePOI(),this.agNavigator.moveToOrigin(),this.reportAudioTrace(),_e()):this.exitAudioTrace()))}pauseAnimations(){this.sliderArray.length=0,this.controller.getAllModelsWithSliders().forEach(t=>{t.slider.isPlaying&&(this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!1}),this.sliderArray.push(t))})}resumeAnimations(){if(this.sliderArray.length!==0){for(let e=0;e<this.sliderArray.length;e++){let t=this.sliderArray[e];t.slider.isPlaying!==!0&&this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!0})}this.sliderArray.length=0}}stopAnimations(){this.controller.getAllModelsWithSliders().forEach(t=>{t.slider.isPlaying&&this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!1})})}hasActiveSliders(){let e=this.controller.getAllModelsWithSliders();for(let t=0;t<e.length;t++)if(e[t].slider.isPlaying)return!0;return!1}queueAnimatingPoints(e){this.sliderArray.length===1?It(this.controller.s("graphing-calculator-narration-audio-trace-one-slider-paused")):this.sliderArray.length>1?It(this.controller.s("graphing-calculator-narration-audio-trace-multiple-sliders-paused",{sliders:this.sliderArray.length})):e&&It(this.controller.s("graphing-calculator-narration-audio-trace-no-sliders-paused"))}queueSliderLatex(){this.hasActiveSliders()||this.agSynthesizer.stop();let e=this.getSelectedSlider();e?It(e.latex):It(this.controller.s("graphing-calculator-narration-audio-trace-slider-value-unknown"))}getSelectedSlider(){let e=this.controller.getAllModelsWithSliders();return this.sliderIndex<=e.length-1?e[this.sliderIndex]:null}incrementSliderValue(){this.adjustSlider("up")}decrementSliderValue(){this.adjustSlider("down")}incrementBigSliderValue(){this.adjustSlider("bigup")}decrementBigSliderValue(){this.adjustSlider("bigdown")}nextSlider(){this.adjustSlider("next")}prevSlider(){this.adjustSlider("prev")}sliderMin(){this.adjustSlider("min")}sliderMax(){this.adjustSlider("max")}adjustSlider(e){let t=this.getSelectedSlider();if(!t){It(this.controller.s("graphing-calculator-narration-audio-trace-cannot-change-slider-value"));return}let o=t.latex,i=this.controller.getAllModelsWithSliders().length;switch(e){case"up":case"down":case"bigup":case"bigdown":case"min":case"max":this.controller.dispatch({type:"adjust-slider-by-keyboard",id:t.id,adjustment:e}),this.queueSliderLatex(),_e();break;case"next":this.sliderIndex++,this.sliderIndex>=i&&(It(this.controller.s("graphing-calculator-narration-audio-trace-last-slider")),this.sliderIndex=i-1),this.queueSliderLatex(),_e();return;case"prev":this.sliderIndex--,this.sliderIndex<0&&(It(this.controller.s("graphing-calculator-narration-audio-trace-first-slider")),this.sliderIndex=0),this.queueSliderLatex(),_e();return}!t.slider.isPlaying&&o!==t.latex&&(this.queueSliderLatex(),_e())}toggleAudioTrace(){this.audioTraceActive?this.exitAudioTrace():this.enterAudioTrace()}toggleSliderTrace(){this.sliderTraceActive?this.exitSliderTrace():this.enterSliderTrace()}enterSliderTrace(){if(this.sliderTraceActive)return;this.sliderIndex=0,this.controller.getAllModelsWithSliders().length!==0?(It(this.controller.s("graphing-calculator-narration-slider-trace-on")),this.queueSliderLatex(),this.sliderTraceActive=!0):(It(this.controller.s("graphing-calculator-narration-slider-trace-no-sliders")),this.sliderTraceActive=!1),_e()}exitSliderTrace(){this.sliderTraceActive&&(It(this.controller.s("graphing-calculator-narration-slider-trace-off")),this.sliderTraceActive=!1,this.sliderIndex=0,_e())}recomputePoints(){!this.audioTraceActive||this.agSynthesizer.getIsPlaying()||(this.agNavigator.updatePOI(),this.agNavigator.updateSampledPoints(),this.agNavigator.updateCurrentPoint(),this.agNavigator.resetTracePoint(),this.agNavigator.computeStepSizes())}reportAndMoveToPrevPoint(){bi(),this.agNavigator.prevPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToNextPoint(){bi(),this.agNavigator.nextPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToOrigin(){bi(),this.agNavigator.moveToOrigin(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToPrevPOI(){bi(),this.agNavigator.prevPOI(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToNextPOI(){bi(),this.agNavigator.nextPOI(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToFirstPoint(){bi(),this.agNavigator.firstPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToLastPoint(){bi(),this.agNavigator.lastPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportX(){bi(),this.reportAudioTrace({propToSpeak:"x",playSound:!1})}reportY(){bi(),this.reportAudioTrace({propToSpeak:"y",playSound:!1})}reportColor(){bi();let e=this.agNavigator.getCurrentSketch();e?It(up(this.controller,e.color)):It(this.controller.s("graphing-calculator-narration-color-unknown")),_e()}reportPOICount(){bi();let e=this.agNavigator.getCurrentSketch(),t=e?e.getPOI().length:0;_e(this.controller.s("graphing-calculator-narration-audio-trace-poi-count",{x:t}))}reportType(){bi(),this.reportAudioTrace({propToSpeak:"type",playSound:!1})}reportBranch(){bi(),this.reportAudioTrace({propToSpeak:"branch",playSound:!1})}describePoint(){bi(),this.reportAudioTrace({playSound:!1}),_e()}playCurrentPoint(){let e=this.agNavigator.getCurrentPoint();e&&this.agSynthesizer.playPoint(e)}reportAudioTrace(e){var a,s;let t=this.agNavigator.getCurrentPoint();if(!t)return;let o=e==null?void 0:e.propToSpeak,i=this.controller.getAudio()&&this.agSynthesizer.getPlaybackSupported()&&((a=e==null?void 0:e.playSound)!=null?a:!0),n=(s=e==null?void 0:e.speakCoordinates)!=null?s:!0;this.agSynthesizer.stop(),i&&this.playCurrentPoint(),n&&(o?this.queueCoordinateProp(t,o):this.queueCoordinates(t),this.lastSpokenBranch=t.reportedBranch?t.reportedBranch:t.branch+1,setTimeout(()=>{_e()},o?0:100))}adjustPlaybackSpeed(e){if(!this.controller.getAudio()){_e(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}if(e<0||e>=Zk.length)return;this.audioSpeedIndex=e;let t=Zk[e];return this.agSynthesizer.setAudioSpeed(t.speed),_e(this.controller.s("graphing-calculator-narration-audio-trace-playback-speed",{speed:t.displayedSpeed}))}speedUp(){this.adjustPlaybackSpeed(this.audioSpeedIndex+1)}speedDown(){this.adjustPlaybackSpeed(this.audioSpeedIndex-1)}adjustVolume(e){if(bi(),!this.controller.getAudio()){_e(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}let t=this.agSynthesizer.getAudioVolume(),o=e==="up"?Math.min(100,Math.round((t+.1)*100)):Math.max(0,Math.round((t-.1)*100));this.agSynthesizer.setAudioVolume(o/100),this.playCurrentPoint(),_e(this.controller.s("graphing-calculator-narration-audio-trace-volume",{volume:o}))}getFocusedTableLocation(){return this.focusedTableLocation}setFocusedTableLocation(e){this.focusedTableLocation=e}getAudioTraceActive(){return this.audioTraceActive}isAudioTracing(){return!!this.agSynthesizer&&this.agSynthesizer.getIsPlaying()}handleEvaluatorChange(e){}hearGraph(){var e,t;if(bi(),!this.controller.getAudio()){_e(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}if(this.agSynthesizer.getPlaybackSupported()){this.agSynthesizer.stop();let o=this.agNavigator.getCurrentSketch();if((t=(e=this.controller).logEvent)==null||t.call(e,{category:"audio-trace",action:"hear-graph"}),o&&Bl(this.controller,o)){let i=this.grapher.settings.config.audioTraceSimult?"simultaneous":"sequential";this.agSynthesizer.playCurrentSketch(i),i==="simultaneous"?(this.grapher.traceLayer.setTraceInfo(void 0),requestAnimationFrame(()=>this.animateCurrentSketchLine())):(this.grapher.traceLayer.setTraceLine(void 0),requestAnimationFrame(()=>this.animateCurrentSketchPoint()))}else _e(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-trace-this-expression"))}else _e(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play"))}animateCurrentSketchPoint(){if(this.graphAnimationTimeoutId&&cancelAnimationFrame(this.graphAnimationTimeoutId),this.graphAnimationTimeoutId=requestAnimationFrame(()=>this.animateCurrentSketchPoint()),!this.agSynthesizer.getIsPlaying())return;let e=this.agSynthesizer.getCurrentIndependentValue(),t=this.agSynthesizer.getCurrentBranchIndex();e!==void 0&&t!==void 0&&this.agNavigator.drawTracePoint(this.agNavigator.getPoint(t,e))}animateCurrentSketchLine(){if(this.graphAnimationTimeoutId&&cancelAnimationFrame(this.graphAnimationTimeoutId),this.graphAnimationTimeoutId=requestAnimationFrame(()=>this.animateCurrentSketchLine()),!this.agSynthesizer.getIsPlaying())return;let e=this.agSynthesizer.getCurrentIndependentValue();e!==void 0&&this.agNavigator.drawTraceLine(e,this.agSynthesizer.getGraphMode())}stopGraph(){this.agSynthesizer.stop(),this.graphAnimationTimeoutId&&cancelAnimationFrame(this.graphAnimationTimeoutId)}getAudioSpeedIndex(){return this.audioSpeedIndex}getAudioVolume(){var e;return(e=this.agSynthesizer.getAudioVolume())!=null?e:.5}};var WA=class{redrawToCtx(e,t){let{ctx:o,projection:i}=e;if(!t)return;o.save(),o.lineWidth=2,o.fillStyle="rgba(0,0,0,.15)",o.strokeStyle="rgba(0,0,0,.4)";let n=i.mapx(t.left),a=i.mapy(t.top),s=i.mapx(t.right),c=i.mapy(t.bottom),d=s-n,p=c-a;o.fillRect(n,a,d,p),o.strokeRect(n,a,d,p),o.restore()}};var hm={};hm.vpmax8={width:170,height:220,margins:{left:5,top:15,right:5,bottom:50}};hm.vpmax11={width:230,height:220,margins:{left:15,top:15,right:5,bottom:5}};hm.etc8={width:96,height:96,margins:{left:5,top:15,right:0,bottom:0}};hm.etc11={width:132,height:134,margins:{left:10,top:15,right:5,bottom:5}};var pl=class{constructor(e,t,o){this.screen=e,this.viewport=t,this.settings=o,this.mathCoordinates=__dcg_shared_module_exports__['id'](t),this.pixelCoordinates=__dcg_shared_module_exports__['hd'](e),this.updateScalePairs()}updateScalePairs(){let{xAxisScale:e,yAxisScale:t}=this.settings;this.mathToPixels=__dcg_shared_module_exports__['jd'].fromRects(this.mathCoordinates,this.pixelCoordinates,{xAxisScale:e,yAxisScale:t}),this.pixelsToMath=this.mathToPixels.inverse()}mapx(e){return this.mathToPixels.mapX(e)}mapy(e){return this.mathToPixels.mapY(e)}reverse_mapx(e){return this.pixelsToMath.mapX(e)}reverse_mapy(e){return this.pixelsToMath.mapY(e)}mapAlongAxis(e,t){switch(t){case"x":return this.mapx(e);case"y":return this.mapy(e);default:{let o=t;throw new Error(`Unknown axis: ${o}`)}}}reverseMapAlongAxis(e,t){switch(t){case"x":return this.reverse_mapx(e);case"y":return this.reverse_mapy(e);default:{let o=t;throw new Error(`Unknown axis: ${o}`)}}}map_pt(e){return this.mathToPixels.mapPoint(e)}map_xy_pairs(e){let t=[];for(let o=0;o<e.length;o+=2)t.push(this.mapx(e[o])),t.push(this.mapy(e[o+1]));return t}reverse_map_pt(e){return this.pixelsToMath.mapPoint(e)}coordsAreOnscreen(e,t,o=0){return e>-o&&t>-o&&e<this.screen.width+o&&t<this.screen.height+o}closestPointOnScreen(e){let t=this.pixelCoordinates;return{x:Math.min(Math.max(e.x,t.left),t.right),y:Math.min(Math.max(e.y,t.top),t.bottom)}}};var Kl=class{constructor(e,t){this.width=e,this.height=t}};var pxe=10240;function uxe(r,e,t,o,i){let{dotSpacing:n}=r,a=1+n,s=i.charCodeAt(0)-pxe;s&1&&e.fillRect(t,o,1,1),s&2&&e.fillRect(t,o+a,1,1),s&4&&e.fillRect(t,o+2*a,1,1),s&8&&e.fillRect(t+a,o,1,1),s&16&&e.fillRect(t+a,o+a,1,1),s&32&&e.fillRect(t+a,o+2*a,1,1)}function $A(r,e){let{x:t,y:o,width:i,height:n}=e,a=r.getImageData(t,o,i,n).data;for(let s=3;s<a.length;s+=4)if(a[s]!==0)return!1;return!0}function hxe(r,e){let{x:t,y:o,width:i,height:n}=e,a=r.getImageData(t,o,i,n).data;for(let s=3;s<a.length;s+=4)if(a[s]===0)return!1;return!0}function FU(r,e,t,o,i){return $A(e,ZA(r,t,o,i))}function gxe(r,e,t,o,i){let{dotSpacing:n}=r,a=3+2*n;for(let s=0;s<i.length;s++)uxe(r,e,t+a*s,o,i[s])}function Eh(r,e){let{dotSpacing:t}=r;return(2+t)*e.length+(1+t)*(e.length-1)}function JA(r,e){let{dotSpacing:t}=r;return 3+2*t}function ZA(r,e,t,o){let{cellPadding:i}=r;return{x:e-i,y:t-i,width:Eh(r,o)+2*i,height:JA(r,o)+2*i}}function jA(r,e){if(!r)return e;let t=Math.min(r.x,e.x),o=Math.min(r.y,e.y),i=Math.max(r.x+r.width,e.x+e.width)-t,n=Math.max(r.y+r.height,e.y+e.height)-o;return{x:t,y:o,width:i,height:n}}function eQ(r,e,t){return Math.min(Math.max(r,e),t)}function Qk(r,e,t,o,i){return{x:eQ(t,0,e.canvas.width-Eh(r,i)),y:eQ(o,0,e.canvas.height-JA(r,i))}}function e_(r,e,t,o,i){let n=e.fillStyle;e.fillStyle="white";let a=ZA(r,t,o,i);e.fillRect(a.x,a.y,a.width,a.height),e.fillStyle="black",gxe(r,e,t,o,i),e.fillStyle=n}function NU(r,e,t,o){let{cellPadding:i}=r;return{x:Math.round(e-(Eh(r,o)+i)),y:t}}function mxe(r){return r.replace(/\u283C(?!$)/g,"")}function Th(r,e){let t=e==="nemeth"?nh(r):ah(r);return t.isError?"":mxe(t.value)}function sw(r,e){return e>=0?r*Math.pow(10,e):r/Math.pow(10,-e)}function rQ(r,e,t,o){let[i,n]=t,a=Math.ceil(Math.log(n-i)/Math.LN10)-1,s=a,c=5,d=15;e:for(let p=a;a-p<4;p--)for(let u of[5,2,1]){let g=sw(u,p),h=Math.floor(i/g)+1,b=Math.ceil(n/g)-1,v=Math.abs(o(g)-o(0)),T=Th(String(sw(h*u,p)),e),E=Th(String(sw(b*u,p)),e);if(v<Eh(r,T)+Eh(r," ")||v<Eh(r,E)+Eh(r," ")||b-h>=d)break e;s=p,c=u}return{int:c,exp:s}}function oQ(r,e,t){return rQ(r,e,[t.viewport.xmin,t.viewport.xmax],o=>t.mapx(o))}function fxe(r,e,t){return t.viewport.isSquare(t.screen,{xAxisScale:t.settings.xAxisScale,yAxisScale:t.settings.yAxisScale})?oQ(r,e,t):rQ(r,e,[t.viewport.ymin,t.viewport.ymax],o=>t.mapy(o))}function tQ(r,e){let{int:t,exp:o}=r,[i,n]=e,a=Math.ceil(i/sw(t,o)),s=Math.floor(n/sw(t,o)),c=[];for(let d=a;d<=s;d++)c.push(sw(d*t,o));return c}function bxe(r,e,t){return{x:tQ(oQ(r,e,t),[t.viewport.xmin,t.viewport.xmax]),y:tQ(fxe(r,e,t),[t.viewport.ymin,t.viewport.ymax])}}function iQ(r,e,t,o,i,n){if(t.margins===void 0||e===void 0)return;let a=yxe(o),s=t.margins,c={...e.settings},d=c.showGrid&&xxe(o),p=!!c.showXAxis,u=!!c.showYAxis,g=!!c.xAxisNumbers,h=c.xAxisArrowMode,b=!!c.yAxisNumbers,v=c.yAxisArrowMode,T=a.graphLineWidth,E={showGrid:!1,xAxisNumbers:!1,xAxisArrowMode:__dcg_shared_module_exports__['Nd'].NONE,yAxisNumbers:!1,yAxisArrowMode:__dcg_shared_module_exports__['Nd'].NONE,showXAxis:!1,showYAxis:!1,graphLineWidth:T,pointLineWidth:2.5,curveOpacity:1,globalCurveColor:"#000",disableFill:!0};for(let K in E)e.settings[K]=E[K];let I=r.width-s.right-s.left,_=r.height-s.top-s.bottom,C=new Kl(I,_),D=e.getProjection().viewport;e.settings.squareAxes&&(D=D.squareCrop(C,e.settings));let P=new pl(C,D,e.settings),F=r.getContext("2d"),N=document.createElement("canvas");N.width=I,N.height=_;let Y=N.getContext("2d"),z=document.createElement("canvas");z.width=I,z.height=_;let X=z.getContext("2d"),q=document.createElement("canvas");q.width=I,q.height=_;let S=q.getContext("2d"),A=document.createElement("canvas");A.width=I,A.height=_;let O=A.getContext("2d"),B=document.createElement("canvas");B.width=I,B.height=_;let V=B.getContext("2d");if(F!==null&&O!==null&&Y!==null&&S!==null&&V!==null&&X!==null){e.settings.disableFill=!0,e.screenshotToCanvas(A,{width:I,height:_,targetPixelRatio:1,transparentBackground:!0,showMovablePoints:n}),e.settings.disableFill=!1,e.screenshotToCanvas(N,{width:I,height:_,targetPixelRatio:1,transparentBackground:!0,showMovablePoints:n}),F.fillStyle="white",F.fillRect(0,0,r.width,r.height);let K=Math.round(P.mapx(0)),oe=Math.round(P.mapy(0)),Z=c.xAxisLabel!==""?c.xAxisLabel.replace(/ /g,"\\ "):"x",ee=c.yAxisLabel!==""?c.yAxisLabel.replace(/ /g,"\\ "):"y",ue=1;if(p&&P.coordsAreOnscreen(I-6,oe-8,0)){let $={...a,cellPadding:a.cellPadding+ue},se=2+2*JA($,Z),J=I-2,ye=oe-se,Se=Th(Z,i);({x:J,y:ye}=NU($,J,ye,Se)),{x:J,y:ye}=Qk($,Y,J,ye,Se),e_($,V,J,ye,Se)}if(u&&P.coordsAreOnscreen(K+4,1,0)){let $={...a,cellPadding:a.cellPadding+ue},se=K+4,J=1,ye=Th(ee,i);({x:se,y:J}=Qk($,Y,se,J,ye)),e_($,V,se,J,ye)}let{x:he,y:ae}=bxe(a,i,P);if(p){let $;for(let se of he){if(se===0&&u)continue;let J=Math.round(P.mapx(se));if(!(J<2||J>P.screen.width-2)&&g){let ye=Eh(a,Th("-1",i))-Eh(a,Th("1",i)),Se=se<0?ye+1:1,Ce=J-Se,Te=oe+4,Ae=Th(""+se,i);({x:Ce,y:Te}=Qk(a,V,Ce,Te,Ae)),FU(a,O,Ce,Te,Ae)&&(e_(a,V,Ce,Te,Ae),$=jA($,ZA(a,Ce,Te,Ae)))}}a.embossPatternInequalities&&$&&($=jA($,{x:0,y:oe,width:I,height:0}),S.fillStyle="white",S.fillRect($.x,$.y,$.width,$.height))}if(u){let $;for(let se of ae){if(se===0&&p)continue;let J=Math.round(P.mapy(se));if(J<2||J>P.screen.height-2)continue;let ye=-Math.ceil(JA(a," ")/2);if(b){let Se=K-4,Ce=J+ye,Te=Th(""+se,i);({x:Se,y:Ce}=NU(a,Se,Ce,Te)),{x:Se,y:Ce}=Qk(a,V,Se,Ce,Te),FU(a,O,Se,Ce,Te)&&(e_(a,V,Se,Ce,Te),$=jA($,ZA(a,Se,Ce,Te)))}}a.embossPatternInequalities&&$&&($=jA($,{x:K,y:0,width:0,height:_}),S.fillStyle="white",S.fillRect($.x,$.y,$.width,$.height))}if(p&&u){let $=K-2,se=oe+2,J=Th(g||b?"0":"o",i);({x:$,y:se}=NU(a,$,se,J)),P.coordsAreOnscreen($,se,0)&&({x:$,y:se}=Qk(a,V,$,se,J),FU(a,O,$,se,J)&&e_(a,V,$,se,J))}for(let $ of he){let se=Math.round(P.mapx($));se<2||se>P.screen.width-2||u&&$===0||d&&t_(S,"white",se-1,0,_,3)}for(let $ of ae){let se=Math.round(P.mapy($));se<2||se>P.screen.height-2||p&&$===0||d&&r_(S,"white",se-1,0,I,3)}p&&r_(S,"white",oe-3,0,I,7),u&&t_(S,"white",K-3,0,_,7);for(let $ of he){let se=Math.round(P.mapx($));se<2||se>P.screen.width-2||u&&$===0||(d?t_(S,XA(o),se,0,_):p&&t_(S,XA(o),se,oe-3,oe+2))}for(let $ of ae){let se=Math.round(P.mapy($));se<2||se>P.screen.height-2||p&&$===0||(d?r_(S,XA(o),se,0,I):u&&r_(S,XA(o),se,K-3,K+2))}if(p&&r_(S,aw(o),oe,0,I),u&&t_(S,aw(o),K,0,_),v!==__dcg_shared_module_exports__['Nd'].NONE&&(kxe(S,aw(o),K,0),v===__dcg_shared_module_exports__['Nd'].BOTH&&Sxe(S,aw(o),K,_-1)),h!==__dcg_shared_module_exports__['Nd'].NONE&&(vxe(S,aw(o),I-1,oe),h===__dcg_shared_module_exports__['Nd'].BOTH&&wxe(S,aw(o),0,oe)),a.embossPatternInequalities)for(let $=0;$<I;$+=6)for(let se=0;se<_;se+=6){let J={x:$,y:se,width:3,height:3};hxe(Y,J)&&$A(S,J)&&$A(O,J)&&$A(V,J)&&_xe(X,"black",$,se)}a.embossPatternInequalities||F.drawImage(N,s.left,s.top),F.drawImage(q,s.left,s.top),F.drawImage(A,s.left,s.top),F.drawImage(B,s.left,s.top),a.embossPatternInequalities&&F.drawImage(z,s.left,s.top)}for(let K in E)e.settings[K]=c[K]}function yxe(r){if(r==="etc8"||r==="etc11")return{dotSpacing:0,cellPadding:1,graphLineWidth:1.75,embossPatternInequalities:!0};if(r==="vpmax8"||r==="vpmax11")return{dotSpacing:1,cellPadding:2,graphLineWidth:1,embossPatternInequalities:!1};{let e=r;throw new Error(`Unexpected embosser model ${e}`)}}function xxe(r){if(r==="etc8"||r==="etc11")return!1;if(r==="vpmax8"||r==="vpmax11")return!0;{let e=r;throw new Error(`Unexpected embosser model ${e}`)}}function aw(r){switch(r){case"vpmax8":case"vpmax11":return"rgb(145, 145, 145)";case"etc8":case"etc11":return"rgb(0, 0, 0)";default:let e=r;throw new Error("Unexpected embosser model: "+e)}}function XA(r){switch(r){case"vpmax8":case"vpmax11":return"rgb(219, 219, 219)";case"etc8":case"etc11":return"rgb(0, 0, 0)";default:let e=r;throw new Error("Unexpected embosser model: "+e)}}function t_(r,e,t,o,i,n=1){let a=r.fillStyle;r.fillStyle=e,r.fillRect(t-1,o,n,i-o),r.fillStyle=a}function r_(r,e,t,o,i,n=1){let a=r.fillStyle;r.fillStyle=e,r.fillRect(o,t-1,i-o,n),r.fillStyle=a}function vxe(r,e,t,o){let i=r.fillStyle;r.fillStyle=e;for(let n=-2;n<=2;n++)r.fillRect(t-Math.abs(n),o-1+n,1,1);r.fillStyle=i}function wxe(r,e,t,o){let i=r.fillStyle;r.fillStyle=e;for(let n=-2;n<=2;n++)r.fillRect(t+Math.abs(n),o-1+n,1,1);r.fillStyle=i}function Sxe(r,e,t,o){let i=r.fillStyle;r.fillStyle=e;for(let n=-2;n<=2;n++)r.fillRect(t-1+n,o-Math.abs(n),1,1);r.fillStyle=i}function kxe(r,e,t,o){let i=r.fillStyle;r.fillStyle=e;for(let n=-2;n<=2;n++)r.fillRect(t-1+n,o+Math.abs(n),1,1);r.fillStyle=i}function _xe(r,e,t,o){let i=r.fillStyle;r.fillStyle=e,r.fillRect(t+1,o,1,1),r.fillRect(t,o+1,1,1),r.fillRect(t+1,o+1,1,1),r.fillRect(t+2,o+1,1,1),r.fillRect(t+1,o+2,1,1),r.fillStyle=i}var nQ={translate:!0,reflect:!0,dilate:!0,rotate:!0},aWe={selection:!0,point:!0,line:!0,segment:!0,ray:!0,vector:!0,circle:!0,arc:!0,parallel:!0,perpendicular:!0,midpoint:!0,polygon:!0,compass:!0,angle:!0,directedangle:!0,anglebisector:!0,"box-selection":!0,"expression-edit":!0,...nQ},lw=Object.keys(nQ);var yi=__dcg_shared_module_exports__['e'](j());function UU(r,e){if(r.indexOf("\\idref_{")===0){let t=r.indexOf("}"),o=r.slice(8,t);return e(o)+r.slice(t+1)}else return r}function YU(r,e){var i;let t={};for(let n in r){let a=r[n];if(a.type==="polygon-segment"&&!a.showAsSepratePreviewObject){let s=aQ(a,e,{});if(!s)throw new Error("Expected polygon-segment object to be converted");t[n]={type:"inline",rhs:s.rhs}}}let o={...t};for(let n in r){if(t[n])continue;let a=r[n],s=aQ(a,e,t);s&&(o[n]={type:"assignment",latex:`${(i=s.lhs)!=null?i:a.id}=${s.rhs}`,color:a.color,showAngleLabel:s.showAngleLabel,sliderInfo:s.sliderInfo})}return o}function aQ(r,e,t){var n;let o=a=>{let s=a;return t[a]?s=t[a].rhs:e.isBeingCommitted&&(s=UU(a,e.getVariableNameForId)),s},i=a=>a.map(o);switch(r.type){case"point-reference":return{rhs:r.parents[0]};case"point":let{x:a,y:s}=r;return{rhs:"\\left("+__dcg_shared_module_exports__['kb'](a)+","+__dcg_shared_module_exports__['kb'](s)+"\\right)"};case"glider":return{rhs:"\\operatorname{glider}\\left("+i(r.parents)[0]+","+__dcg_shared_module_exports__['kb'](r.t)+"\\right)"};case"polygon":return{rhs:"\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)"};case"circle":case"arc":case"compass":case"segment":case"line":case"ray":case"parallel":case"perpendicular":case"anglebisector":case"intersection":case"midpoint":return{rhs:"\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)"};case"vector-copy":{let[b,v]=i(r.parents);return{rhs:`\\operatorname{translate}\\left(${b},${b}.\\operatorname{start},${v}\\right)`}}case"vector":return{rhs:"\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)"};case"vector-endpoint":return{rhs:`${i(r.parents)[0]}.\\operatorname{${r.location}}`};case"translate":case"reflect":case"dilate":case"rotate":{let b=r.type==="dilate"||r.type==="rotate"?[...i([r.parents[0]]),r.parents[1]]:i(r.parents);return{rhs:`\\operatorname{${r.type}}\\left(x,${b.join(",")}\\right)`,lhs:`${r.id}\\left(x\\right)`}}case"angle":case"directedangle":return{showAngleLabel:(n=r.showAngleLabel)!=null?n:!0,rhs:"\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)"};case"polygon-angle":case"polygon-directedangle":let c=r.type==="polygon-angle"?"angles":"directedangles",d=i(r.parents)[0],p=r.angleIndex;return{showAngleLabel:e.isBeingCommitted,rhs:`\\operatorname{${c}}\\left(${d}\\right)\\left[${p}\\right]`};case"polygon-segment":return{rhs:i(r.parents)[0]+(r.listAccess!==void 0?"\\left["+r.listAccess+"\\right]":"")+".\\operatorname{segments}\\left["+(r.edgeNumber+1)+"\\right]"};case"slider":return{lhs:r.lhsLatex,rhs:r.rhsLatex,sliderInfo:r.sliderInfo};case"expression-edit-preview-latex":return r.rhsLatex===""?void 0:{showAngleLabel:r.rhsLatex.trim().startsWith("\\operatorname{angle}\\left("),rhs:r.rhsLatex};default:return r}}function BU(r,e){__dcg_shared_module_exports__['Mb'](r)?r.value.forEach((t,o)=>{let i=__dcg_shared_module_exports__['ra'](r.valueType);if(__dcg_shared_module_exports__['xa'](i))throw new Error("Programming error: unexpected lambda type");e({valueType:i,value:t},o+1)}):e(r,void 0)}function o_(r){let e=r.formula.geometry,t=e==null?void 0:e.identifier;return t?__dcg_shared_module_exports__['vb'](t):"\\idref_{"+r.id+"}"}function $b(r,e){let{controller:t,expandLists:o=!0}=r;t.getAllItemModels().concat(t.getAllToolPreviewItems()).forEach(n=>{var p;if(!xs(n))return;let a=n.formula.typed_constant_value,s=n.formula.geometry,c=o_(n),d=!t.getItemModel(n.id);o&&t.canExpandListForItem(n.id)?BU(a,(u,g)=>{var v;let h=c+(g===void 0?"":"\\left["+g+"\\right]"),b={calcId:n.id,data:s,hidden:!n.shouldGraph,isGraphableAndInteractive:!!((v=n.formula)!=null&&v.is_graphable)&&!r.controller.shouldIgnoreGraphInteractions(n),assignment:c,listIndex:g!==void 0?g-1:void 0,typedRuntimeValue:u,referenceLatex:h};e(b,d)}):e({calcId:n.id,data:s,hidden:!n.shouldGraph,isGraphableAndInteractive:!!((p=n.formula)!=null&&p.is_graphable)&&!r.controller.shouldIgnoreGraphInteractions(n),assignment:c,listIndex:void 0,typedRuntimeValue:a,referenceLatex:c},d)})}function KU(r,e){return{...r,referenceLatex:r.assignment+"\\left["+e+"\\right]",typedRuntimeValue:__dcg_shared_module_exports__['Nb'](r.typedRuntimeValue,e),listIndex:e}}var Cd=class{constructor(e){this.model=e;this.s=e.s}createOutput(){return this.model.createCustomToolOutput(this.getSpec())}clearTentativeOutputs(){let e=this.getSpec(),t={},o=this.model.getNonObjectsState().ui.currentTool.idMap;for(let i in o){let n=o[i];!this.model.isObjectALockedToolInput(n)&&this.model.isObjectUncommitted(n)&&(t[i]=n)}this.model.deleteObjectsAndRememberReusableId(t),this.model.tentativelyMatchToolInput(e,""),this.createOutput()}didLockInput(e){var n;let{currentTool:t}=this.model.getNonObjectsState().ui,o=t.inputIndex,i=e.inputs[o];i&&(n=i.numberInputInfo)!=null&&n.defaultLatex&&!t.idMap[i.id]&&this.onNumberInput(i.numberInputInfo.defaultLatex)}shouldReferenceSpecificItemInList(e,t){return!t}getExpandedReferenceForDef(e,t){return this.shouldReferenceSpecificItemInList(e,t)?e.referenceLatex:e.assignment}getListIndexForHover(e,t){if(this.shouldReferenceSpecificItemInList(e,t))return e.listIndex}_getOrCreatePoint(e,t,o){let i=this.model.getOrCreatePointNearMouse(e,o);if(i.type==="def")return{createdNew:!1,def:i.def,reference:this.getExpandedReferenceForDef(i.def,t),previewOnly:!1};let n=this.createPointDefinition(i.spec,t),a=i.spec.type==="point-reference"?i.spec.targetSpec.parentDefs:i.spec.parentDefs,s=0;for(let d=0;d<a.length;d++){let p=a[d];if(p.polygonEdgeInfo){let u=this.model.createToolInputDependency({type:"polygon-segment",parents:[p.polygonEdgeInfo.polygonDef.referenceLatex],edgeNumber:p.polygonEdgeInfo.edgeNumber||0,polygonColor:this.getPolygonEdgeColor(p)},this.getSpec(),s);n.parents[d]=u,s+=1,this.model.setObjectHovered({tokenId:u,listIndex:void 0})}else this.model.setObjectHovered({calcId:p.calcId,listIndex:this.getListIndexForHover(p,t)})}return{createdNew:!0,def:void 0,reference:this.model._createInputObject(n),previewOnly:n.type==="point"&&n.previewOnly}}_isReadyToCommit(){return this.model.getNonObjectsState().ui.currentTool.inputIndex>=this.getSpec().inputs.length}_getFirstMissingInput(){let{inputIndex:e}=this.model.getNonObjectsState().ui.currentTool;return this.getSpec().inputs[e]}canNextInputBePoint(){let e=this._getFirstMissingInput();return e&&e.type==="point"?!0:!!(e&&e.type==="union"&&e.valueTypes.indexOf(__dcg_shared_module_exports__['C'])!==-1)}getNonPointInputType(){let e=this._getFirstMissingInput();if(!(!e||e.type==="point"))return e.type==="union"?e:e.type}isValidNextInputType(e){if(this.canNextInputBePoint()&&__dcg_shared_module_exports__['y'](e,__dcg_shared_module_exports__['C']))return!0;let t=this._getFirstMissingInput();if(!t)return!1;let o=[];if(t.type==="union")o=t.valueTypes;else{let i=t.type;switch(i){case"point":o=[__dcg_shared_module_exports__['C']];break;case"straight":o=[...__dcg_shared_module_exports__['va'].types];break;case"angle":o=[__dcg_shared_module_exports__['S'],__dcg_shared_module_exports__['U']];break;case"arc":o=[__dcg_shared_module_exports__['N']];break;case"circle":o=[__dcg_shared_module_exports__['M']];break;case"polygon":o=[__dcg_shared_module_exports__['J']];break;case"segment":o=[__dcg_shared_module_exports__['K']];break;case"vector":o=[__dcg_shared_module_exports__['Y']];break;default:return i}}return t.numberInputInfo&&o.push(__dcg_shared_module_exports__['B']),o.some(i=>__dcg_shared_module_exports__['y'](e,i))}getAllValidNextInputTypes(){return __dcg_shared_module_exports__['na'].filter(e=>this.isValidNextInputType(e))}getHint(){let e=this._getFirstMissingInput();return e?e.hint!==void 0?this.s(e.hint):this.s("graphing-calculator-text-geometry-select-hint",{type:e.type}):""}getSpecIdToLockIn(e,t){let o=e.inputs[t];if(o)return o.id}tryCommitResults(){if(this.model.attemptLockToolInputIn(this.getSpec()),this._isReadyToCommit()){let e=this.model.getUncommittedObjects();for(let o in e)e[o].type==="expression-edit-preview-latex"&&delete e[o];let t={...this.model.getNonObjectsState().ui.currentTool.idMap};return this.model.commitObjects(),this.model.deselectAllObjects(),this.model.cancelToolplay(),{committed:e,toolIdToLatex:t}}return{committed:void 0}}tentativelyAddInput({target:e,pointInfo:t},o){var n,a;let i;if(e)if(e.polygonEdgeInfo){let s=this.model.createToolInputDependency({type:"polygon-segment",parents:[(n=e.polygonEdgeInfo)==null?void 0:n.polygonDef.referenceLatex],edgeNumber:((a=e.polygonEdgeInfo)==null?void 0:a.edgeNumber)||0,polygonColor:this.getPolygonEdgeColor(e)},this.getSpec(),0);this.model.setObjectHovered({tokenId:s,listIndex:void 0}),i=s}else i=this.getExpandedReferenceForDef(e,o),this.model.setObjectHovered({calcId:e.calcId,listIndex:this.getListIndexForHover(e,o)});else t&&(i=t.reference,t!=null&&t.def&&!t.createdNew&&!t.previewOnly&&this.model.setObjectHovered({calcId:t.def.calcId,listIndex:this.getListIndexForHover(t.def,o)}));i&&this.model.tentativelyMatchToolInput(this.getSpec(),i)}onFocus(e){this.clearTentativeOutputs(),e&&this.tentativelyAddInput({target:e},!1),this.createOutput()}onMove(e){this.clearTentativeOutputs();let t=this.canNextInputBePoint(),o=this.getNonPointInputType(),i=!1;if(o){let n=this.model.getObjectDefUnderMouse(e.pt,e.tolerance,this.model.getCurrentTool());n&&this.model.objectIsInstanceOf(n,o)&&(this.tentativelyAddInput({target:n},e.shift),i=!0)}if(!i&&t){let n=this._getOrCreatePoint(e.pt,e.shift,e.tolerance);i=!n.previewOnly,this.isDegenerateInput(n.reference)?n.def&&this.model.setObjectHovered({calcId:n.def.calcId,listIndex:this.getListIndexForHover(n.def,e.shift)}):this.tentativelyAddInput({pointInfo:n},e.shift)}return this.createOutput(),i}isDegenerateInput(e){return!!this.model.getNonObjectsState().ui.currentTool.lockedIds[e]}getNumberInputLatex(){let e=this.getSpec(),{inputIndex:t,idMap:o}=this.model.getNonObjectsState().ui.currentTool,i=e.inputs[t];return i!=null&&i.numberInputInfo&&o[`${i.id}-number`]||""}onNumberInput(e){this.clearTentativeOutputs();let t=this.getSpec();this.model.storeNumberInputLatex(t,e),this.createOutput()}createPointDefinition(e,t){let o=e.parentDefs,i;switch(e.type){case"point-reference":{i={type:"point-reference",parents:[this.getExpandedReferenceForDef(o[0],t)]};break}default:{let n=o.map(a=>this.getExpandedReferenceForDef(a,t));i={...e,parents:n}}}return i}shouldUseJitEdges(){return!0}shouldHighlightRelevantObjects(){return!0}getPolygonEdgeColor(e){var n;let{ui:t}=this.model.getNonObjectsState(),o=e.polygonEdgeInfo?this.model.controller.getItemModel(e.polygonEdgeInfo.polygonDef.calcId):void 0;if((o==null?void 0:o.type)!=="expression")return t.colors.line;let i=vI(o)&&wI(o);return e.listIndex!==void 0&&Array.isArray(i)?(n=i[e.listIndex])!=null?n:t.colors.line:typeof i=="string"?i:o.color}};function QA(r,e){if(typeof e=="object")return e.valueTypes.some(t=>__dcg_shared_module_exports__['y'](r,t));switch(e){case"point":return r===__dcg_shared_module_exports__['C'];case"straight":return r===__dcg_shared_module_exports__['O']||r===__dcg_shared_module_exports__['Q']||r===__dcg_shared_module_exports__['K']||r===__dcg_shared_module_exports__['Y'];case"angle":return r===__dcg_shared_module_exports__['S']||r===__dcg_shared_module_exports__['U'];case"arc":return r===__dcg_shared_module_exports__['N'];case"circle":return r===__dcg_shared_module_exports__['M'];case"polygon":return r===__dcg_shared_module_exports__['J'];case"segment":return r===__dcg_shared_module_exports__['K'];case"vector":return r===__dcg_shared_module_exports__['Y'];default:return e}}var tL=class r{constructor(e,t){this.value=e;this.valueType=t}static point(e){return new r(e,__dcg_shared_module_exports__['C'])}static polygonSegment(e){return new r(e,__dcg_shared_module_exports__['K'])}},Lr=class extends Cd{constructor(t,o){super(t);this.definition=o;this.s=t.s,this.displayNameKey=o.displayNameKey,this.toolType=o.toolType,this.toolName=o.name,this.icon=o.icon,this.workflows=o.workflows.map(i=>{let n=i.input.broadcast?__dcg_shared_module_exports__['Ca'](i.input.types,{geometry:!0}):__dcg_shared_module_exports__['Ba'](i.input.types,{geometry:!0});return{...i,signature:n}})}getWorkflows(){return this.workflows}getMatchingWorkflow(t){let o=t.map(s=>s.valueType),i=this.workflows.filter(s=>s.signature.matches(o));if(i.length===0)return;let n=i.find(s=>o.length>=s.signature.minArity),a=n!=null&&n.canCommit?n.canCommit(t):!!n;return{firstMatch:n!=null?n:i[0],canCommit:a,allMatches:i,inputs:t,argTypes:o}}getInputAtIndex(t){let{idMap:o}=this.model.getNonObjectsState().ui.currentTool,i=o[`${t}`];if(i)return this.getInputById(i)}getInputById(t){let i=this.model.getUncommittedObjects()[t];if(i&&Txe(i))return tL.point(i);if(i&&i.type==="polygon-segment")return tL.polygonSegment(i);let n=this.model.findDefsForInputId(t)[0];return n==null?void 0:n.typedRuntimeValue}getMatchingWorkflowForCurrentInputs(t=1/0){let{inputIndex:o}=this.model.getNonObjectsState().ui.currentTool,i=[];for(let n=0;n<=Math.min(o,t);n++){let a=this.getInputAtIndex(n);if(a===void 0)break;i.push(a)}return this.getMatchingWorkflow(i)}canNextInputBePoint(){let{inputIndex:t}=this.model.getNonObjectsState().ui.currentTool,o=this.getMatchingWorkflowForCurrentInputs(t-1);return!!(o!=null&&o.allMatches.some(i=>{let n=i.signature.argTypeAtIndex(t);return n===void 0?!1:__dcg_shared_module_exports__['Da'](__dcg_shared_module_exports__['C'],n)}))}isDegenerateInput(t){if(this.definition.isDegenerateInput){let o=this.getMatchingWorkflowForCurrentInputs(),i=this.getInputById(t);return i?this.definition.isDegenerateInput({previousInputs:(o==null?void 0:o.inputs)||[],proposedInput:i}):!1}return super.isDegenerateInput(t)}getSpec({isCommitting:t}={isCommitting:!1}){var c,d;let o=this.getMatchingWorkflowForCurrentInputs();if(!o)return{inputs:[],outputs:[]};let{inputIndex:i}=this.model.getNonObjectsState().ui.currentTool,n=o.firstMatch,a=[],s=(c=n.signature.maxArity)!=null?c:i+1;for(let p=0;p<s;p++){let u=n.signature.argTypeAtIndex(p);if(!u)throw new Error(`Expected arg type for arg ${p}`);if(sQ(u)){let g=[];if(p===i){let h=this.getMatchingWorkflowForCurrentInputs(p-1);for(let b of(d=h==null?void 0:h.allMatches)!=null?d:[]){let v=b.signature.argTypeAtIndex(p);v&&!sQ(v)&&g.push(...typeof v=="number"?[v]:v.getTypes())}}g.length>0?a.push({id:`${p}`,type:"union",hint:eL(n,p),valueTypes:[...g,__dcg_shared_module_exports__['C']]}):a.push({id:`${p}`,type:"point",hint:eL(n,p)})}else a.push({id:`${p}`,type:"union",hint:eL(n,p),valueTypes:typeof u=="number"?[u]:u.getTypes().slice()})}return{inputs:a,outputs:zU(n,o.inputs,t)}}tryCommitResults(){var t;if(this.model.attemptLockToolInputIn(this.getSpec()),(t=this.getMatchingWorkflowForCurrentInputs())!=null&&t.canCommit){this.clearTentativeOutputs(),this.model.createCustomToolOutput(this.getSpec({isCommitting:!0}));let o=this.model.getUncommittedObjects();for(let n in o)o[n].type==="expression-edit-preview-latex"&&delete o[n];let i={...this.model.getNonObjectsState().ui.currentTool.idMap};return this.model.commitObjects(),this.model.deselectAllObjects(),this.model.cancelToolplay(),{committed:o,toolIdToLatex:i}}return{committed:void 0}}getExpressionEditHint(t){var i;let o=(i=this.getMatchingWorkflowForCurrentInputs())==null?void 0:i.firstMatch;return o?this.s(eL(o,t)):""}shouldReferenceSpecificItemInList(t,o){var i,n;if(o){let{inputIndex:a}=this.model.getNonObjectsState().ui.currentTool;return!((n=(i=this.getMatchingWorkflowForCurrentInputs())==null?void 0:i.allMatches)!=null?n:[]).some(d=>{let p=d.signature.argTypeAtIndex(a);return p===void 0?!1:typeof p=="number"?__dcg_shared_module_exports__['qa'](p):p.getTypes().some(__dcg_shared_module_exports__['qa'])})}else return!0}};function zU(r,e,t){let o;return Array.isArray(r.output)?o=r.output:o=r.output({inputs:e,isCommitting:t}),o.map((i,n)=>({...i,id:`result-${n}`,hidden:!1,parents:i.parents.map(a=>({type:"reference-input",id:`${a}`}))}))}function sQ(r){return typeof r=="number"?r===__dcg_shared_module_exports__['C']:r.getTypes().every(e=>__dcg_shared_module_exports__['wa'](e,__dcg_shared_module_exports__['C']))}function eL(r,e){return Array.isArray(r.input.hints)?r.input.hints[e]:r.input.hints(e)}function Txe(r){switch(r.type){case"point":case"intersection":case"glider":case"point-reference":case"midpoint":case"vector-endpoint":return!0;default:return r.type,!1}}var oL=__dcg_shared_module_exports__['e'](j());Ut();var Exe='a, input, button:not([disabled]), textarea, select [role="textbox"], [tabIndex="0"], [role="option"], [role="button"], [role="link"], summary',rL=class{constructor({closeMenu:e,focusIcon:t,getIconSelector:o,getContainerEl:i,isIconFocused:n}){this.globalKeyDownListener=e=>{let t=Pe(e);if(t===Wi){e.preventDefault(),e.stopPropagation(),this.focusIcon(),this.closeMenu();return}if(t==="Tab"&&!e.altKey&&!e.ctrlKey&&!e.metaKey){if(this.isIconFocused()){e.shiftKey?this.focusLastOption():this.focusFirstOption(),e.preventDefault(),e.stopPropagation();return}if(this.isLastOptionViewFocused()&&!e.shiftKey){this.focusIcon(),e.preventDefault(),e.stopPropagation();return}if(this.isFirstOptionViewFocused()&&e.shiftKey){this.focusIcon(),e.preventDefault(),e.stopPropagation();return}}};this.tapListener=e=>{let t=this.getContainerEl();if(!t)return;let{target:o}=e,i=this.getIconSelector();i&&o.closest(i)||t.contains(o)||Array.from(document.querySelectorAll(".dcg-keypad,.dcg-show-keypad-container")).some(a=>a.contains(o))||this.closeMenu()};this.closeMenu=e,this.getContainerEl=i,this.getIconSelector=o,this.isIconFocused=n,this.focusIcon=t}isFirstOptionViewFocused(){let{first:e}=this.getDOMTabStops();return e!==void 0&&e.matches(":focus")}focusFirstOption(){let{first:e}=this.getDOMTabStops();e!==void 0&&e.focus()}focusLastOption(){let{last:e}=this.getDOMTabStops();e!==void 0&&e.focus()}isLastOptionViewFocused(){let{last:e}=this.getDOMTabStops();return e!==void 0&&e.matches(":focus")}getDOMTabStops(){let e=this.getContainerEl();if(e===void 0)return{};let t=Array.from(e.querySelectorAll(Exe)).filter(o=>o.getAttribute("tabIndex")!=="-1");return{first:t.find(o=>Ku(o)),last:[...t.reverse()].find(o=>Ku(o))}}};var As=class extends oL.View{init(){this.controller=this.props.controller()}template(){return l("div",{class:oL.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView),children:this.props.children})}didMount(){this.props.openAriaAlert&&_e(this.props.openAriaAlert())}willUnmount(){this.props.closeAriaAlert&&_e(this.props.closeAriaAlert())}didMountView(e){this.focusHelper=new rL({isIconFocused:()=>this.isIconModelFocused(),focusIcon:()=>this.focusIcon(),getContainerEl:()=>this.openView,closeMenu:()=>this.hideOptions(),getIconSelector:()=>{var t;return`[dcg-open-menu-guid="${(t=this.controller.getOpenItemMenu())==null?void 0:t.guid}"]`}}),this.guid=__dcg_shared_module_exports__['jb']("dcg-dropdown-menu"),this.openView=e,this.positionMenu(),this.moveFocusIfAppropriate(),this.attachKeyDownListeners(),this.attachTapListener()}isIconModelFocused(){let e=this.controller.getFocusLocation();return __dcg_shared_module_exports__['db'](e,this.props.menuButtonFocusLocation())}attachKeyDownListeners(){this.props.shouldHandleTabAndEscape()&&document.addEventListener("keydown",this.focusHelper.globalKeyDownListener)}attachTapListener(){re(document.body).on(`dcg-tapstart.${this.guid}`,this.focusHelper.tapListener)}didUnmountView(){document.removeEventListener("keydown",this.focusHelper.globalKeyDownListener),re(document.body).off(`.${this.guid}`),this.openView=void 0}moveFocusIfAppropriate(){this.shouldMoveFocusToFirstOption()?this.focusHelper.focusFirstOption():this.shouldMoveFocusToLastOption()&&this.focusHelper.focusLastOption()}hideOptions(){this.controller.dispatch({type:"close-item-settings-menu"})}getRootEl(){return this.controller.findEl(this.props.rootElSelector())}positionMenu(){var a;let e=this.controller.getOpenMenuIcon();if(!e||!this.openView)return;let t=this.getRootEl();if(!t)return;let o=t.getBoundingClientRect(),i=e.getBoundingClientRect(),n=i.width;if(this.props.menuType()==="geo-tool-dropdown"||this.props.menuType()==="multi-select-construct"||this.props.menuType()==="multi-select-style"||this.props.menuType()==="multi-select-label"||this.props.menuType()==="multi-select-more"){Yo(this.openView,{display:"block"});let s=(a=this.openView.querySelector(".dcg-options-menu"))==null?void 0:a.getBoundingClientRect();if(!s)return;let c=i.left-o.left,d=o.right-(i.left+n);c+n/2>=s.width/2&&d+n/2>=s.width/2?Yo(this.openView,{top:`${i.top-o.top}px`,left:`${c+n/2-s.width/2}px`}):c<d?Yo(this.openView,{top:`${i.top-o.top}px`,left:"0px"}):Yo(this.openView,{top:`${i.top-o.top}px`,right:`${s.width}px`})}else Yo(this.openView,{top:`${i.top-o.top}px`,left:`${i.left-o.left}px`,display:"block"})}focusIcon(){this.controller.focusOpenMenuIcon()}shouldMoveFocusToFirstOption(){if(this.props.focusOnOpen)return this.props.focusOnOpen()==="first";if(this.openView&&this.openView.matches(":focus-within"))return!1;let e=this.controller.getOpenItemMenu();return(e==null?void 0:e.type)===this.props.menuType()&&!!(e!=null&&e.focusFirstOption)}shouldMoveFocusToLastOption(){return this.props.focusOnOpen?this.props.focusOnOpen()==="last":!1}};var i_=__dcg_shared_module_exports__['e'](j()),iL=class extends i_.View{onSpanMount(e){e.insertAdjacentHTML("beforeend",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><style>.cls-1{fill:#7c69b3}.cls-3{fill:#719972}</style></defs><g id="Layer_1"><path d="M35.3 45.6ZM7.2 97.3z" class="cls-3"/><path fill="#fff" d="M7.2 97.3"/><path d="M47.7 39.8c2.5-2.9 3.7-6.3 3.7-10.3s-1-6.6-3-9.3c-2-2.7-4.6-4.6-7.7-5.7V2.7H30v11.8c-3.1 1.1-5.7 3-7.7 5.7s-3 5.8-3 9.3 1.3 7.6 3.9 10.5L4.7 89.4l2.5 7.9 8.2-5.1 17.1-46.9c.9.2 1.9.2 2.8.2 1.1 0 2.1 0 3.1-.3l16.8 47.1 8.2 4.3 1.7-8.2-17.5-48.7Zm-16.2-6.5c-1-1-1.5-2.3-1.5-3.8s.5-2.8 1.5-3.8 2.3-1.5 3.8-1.5 2.8.5 3.8 1.5 1.5 2.3 1.5 3.8-.5 2.8-1.5 3.8-2.3 1.5-3.8 1.5-2.8-.5-3.8-1.5Z" class="cls-3"/><path d="m49.8 94.3-9.9-27.8-8.7 15.6c-.6 1.1-.2 2.5.8 3.2l17.6 10.5c.4.2.8.3 1.2.3-.4-.5-.8-1.1-1-1.8ZM94.1 16 76.5 5.5c-1.1-.6-2.5-.3-3.1.8L54.2 40.8l11.3 31.3 29.5-53c.6-1.1.2-2.5-.8-3.2Z" class="cls-1"/></g></svg>')}template(){return l("span",{"aria-hidden":i_.const("true"),class:i_.const("dcg-construct-button-icon"),onMount:this.bindFn(this.onSpanMount)})}};var ia=__dcg_shared_module_exports__['e'](j());var dQ=__dcg_shared_module_exports__['e'](j());function cQ(r,e,t){r.save();for(let o of t)switch(o.type){case"point":{let i;!o.color||o.color==="dark"?i=YD({isPoint:!0,color:e.point,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):o.color==="light"?i=__dcg_shared_module_exports__['sd'](e.point,.7):i=o.color;let n;switch(o.size){case"small":n=5;break;case"large":n=10;break;case"medium":default:n=5;break}o.hollow?(r.lineWidth=2,r.strokeStyle=i,r.beginPath(),r.arc(o.x,o.y,n-1,0,2*Math.PI),r.stroke()):(r.fillStyle=i,r.beginPath(),r.arc(o.x,o.y,n,0,2*Math.PI),r.fill())}break;case"circle":{let i;!o.color||o.color==="dark"?i=vk({isPoint:!1,color:e.circle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):o.color==="light"?i=__dcg_shared_module_exports__['sd'](e.circle,.7):typeof o.color=="function"?i=o.color(e):i=o.color;let n;switch(o.lineWidth){case"small":n=2;break;case"large":n=7;break;case"medium":case void 0:n=4;break;default:n=o.lineWidth;break}r.lineWidth=n,r.strokeStyle=i,r.beginPath(),r.arc(o.x,o.y,o.radius,0,2*Math.PI),r.stroke()}break;case"arc":{let i;!o.color||o.color==="dark"?i=vk({isPoint:!1,color:e.circle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):o.color==="light"?i=__dcg_shared_module_exports__['sd'](e.circle,.7):i=o.color;let n;switch(o.lineWidth){case"small":n=2;break;case"large":n=7;break;case"medium":default:n=4;break}r.lineWidth=n,r.strokeStyle=i,r.beginPath(),r.arc(o.x,o.y,o.radius,o.startAngle,o.endAngle),r.stroke()}break;case"stroked-path":{let i;!o.color||o.color==="dark"?i=vk({isPoint:!1,color:e.line,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):o.color==="light"?i=__dcg_shared_module_exports__['sd'](e.line,.7):typeof o.color=="function"?i=o.color(e):i=o.color;let n=o.path,a;switch(o.lineWidth){case"small":a=1;break;case"large":a=5;break;case"medium":default:a=3;break}r.lineCap="round",r.lineJoin="round",r.strokeStyle=i,r.lineWidth=a,r.beginPath(),r.moveTo(n[0],n[1]);for(let s=2;s<n.length;s+=2)r.lineTo(n[s],n[s+1]);if(o.arrow){let s=[],c=n.length-1;Mxe(s,n[c-3],n[c-2],n[c-1],n[c],a/2+9.5);for(let d=0;d<s.length;d+=2)r.lineTo(s[d],s[d+1])}r.stroke()}break;case"filled-polygon":{let i;o.color?i=o.color:i=YD({isPoint:!1,color:e.polygon,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0});let n=o.path;r.fillStyle=i,r.beginPath(),r.moveTo(n[0],n[1]);for(let a=2;a<n.length;a+=2)r.lineTo(n[a],n[a+1]);r.fill()}break;case"angle":{let i=vk({isPoint:!1,color:e.angle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0}),n=YD({isPoint:!1,color:e.angle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0});Ixe(r,{type:"angle-indicator",lineWidth:4,strokeStyle:i,fillStyle:n,isRightAngle:!1,x:o.x,y:o.y,isDirected:o.isDirected,radius:o.radius,startAngle:o.startAngle,deltaAngle:o.deltaAngle})}break;case"ellipse":r.lineWidth=o.lineWidth,r.strokeStyle=o.color,r.beginPath(),r.ellipse(o.x,o.y,o.rx,o.ry,0,0,2*Math.PI),r.stroke();break;default:return o}r.restore()}function Ixe(r,e){r.beginPath(),lQ(r,e),r.lineTo(e.x,e.y),r.lineTo(e.x+e.radius*Math.cos(e.startAngle),e.y+e.radius*Math.sin(e.startAngle)),e.isDirected||(r.fillStyle=e.fillStyle,r.fill()),r.strokeStyle=e.strokeStyle,r.lineWidth=e.lineWidth,r.beginPath(),lQ(r,e),r.stroke()}function lQ(r,e){let t=e.startAngle+e.deltaAngle;if(e.isRightAngle){let o=e.radius*Math.cos(e.startAngle),i=e.radius*Math.cos(t),n=e.radius*Math.sin(e.startAngle),a=e.radius*Math.sin(t);r.moveTo(e.x+o,e.y+n),r.lineTo(e.x+o+i,e.y+n+a),r.lineTo(e.x+i,e.y+a)}else r.arc(e.x,e.y,e.radius,e.startAngle,t)}function Mxe(r,e,t,o,i,n=12){let a=Math.atan2(i-t,o-e),s=o-n*Math.cos(a-Math.PI/9),c=i-n*Math.sin(a-Math.PI/9),d=o-n*Math.cos(a+Math.PI/9),p=i-n*Math.sin(a+Math.PI/9),u=o-(n-2)*Math.cos(a-Math.PI/18),g=i-(n-2)*Math.sin(a-Math.PI/18),h=o-(n-2)*Math.cos(a+Math.PI/18),b=i-(n-2)*Math.sin(a+Math.PI/18);r.push(s,c,d,p,o,i,u,g,h,b,o,i)}var Jb=class extends dQ.View{template(){return l("canvas",{didMount:this.bindFn(this.didMountCanvas),width:()=>this.props.width(),height:()=>this.props.height(),style:()=>({width:this.props.width()/2+"px",height:this.props.height()/2+"px"})})}didMountCanvas(e){this.canvas=e,this.redraw()}didUpdate(){this.redraw()}redraw(){let e=this.props.instructions()||[],t=this.props.model().getNonObjectsState().ui.colors;if(__dcg_shared_module_exports__['db'](e,this.lastInstructions)&&__dcg_shared_module_exports__['db'](t,this.lastColors))return;this.lastInstructions=e,this.lastColors=t;let o=this.canvas.getContext("2d");o.clearRect(0,0,o.canvas.width,o.canvas.height),cQ(o,t,e)}};var gm=__dcg_shared_module_exports__['e'](j());var{For:pQ,SwitchUnion:Dxe}=gm.Components,cw=class extends gm.View{init(){this.controller=this.props.controller(),this.geoModel=this.controller.getGeoModel()}template(){return x("div",{class:()=>({"dcg-options-menu":!0,"dcg-select-tools-dropdown":!0,"dcg-shift-menu-left":this.props.items()[0][0]==="angle"||this.props.items()[0][0]==="segment"}),"aria-label":this.props.ariaLabel,onKeyDown:this.bindFn(this.handleKeyPress),"dcg-geo-tool-group":this.bindFn(this.props.group),children:[l("div",{class:gm.const("dcg-options-menu-section-container"),role:gm.const("menu"),children:l(pQ,{each:()=>this.props.items(),children:e=>l("div",{class:()=>({"dcg-options-menu-section":!0}),children:l(pQ,{each:()=>e,children:t=>x("button",{role:gm.const("menuitemradio"),tabIndex:()=>t===e[0]&&this.sectionKey(e)===this.sectionKey(this.props.items()[0])?0:-1,"aria-disabled":()=>!this.isToolEnabled(t),"aria-description":()=>this.isToolEnabled(t)?void 0:this.controller.s("graphing-calculator-narration-geometry-tool-disabled",{tool:this.geoModel.getDisplayNameForTool(t)}),"aria-checked":()=>this.controller.getActiveTool()===t,onTap:o=>{this.isToolEnabled(t)&&this.props.onChooseTool({tool:t,fromKeyboard:o.device==="keyboard"})},"dcg-geo-tool":this.const(t),class:()=>({"dcg-dropdown-tool":!0,"dcg-unstyled-button":!0,"dcg-transformation-tool":__dcg_shared_module_exports__['Pc'](t),"dcg-selected-tool":this.controller.getActiveTool()===t,"dcg-disabled":!this.isToolEnabled(t),"dcg-will-be-hidden-or-disabled":this.controller.toolWillBeHiddenOrDisabled(t)}),manageFocus:this.const(ze({controller:this.controller,location:{type:"geo-basic-tool-menu-item",tool:t}})),children:[Dxe(()=>this.getIconInfo(t),"type",{css:o=>l("i",{class:()=>o().className}),canvas:o=>l(Jb,{model:()=>this.geoModel,width:this.const(100),height:this.const(100),instructions:()=>o().instructions})}),l("span",{children:()=>this.geoModel.getDisplayNameForTool(t)})]})})})},this.sectionKey)}),this.props.children]})}sectionKey(e){return e.join("-")}getIconInfo(e){switch(e){case"dilate":return{type:"css",className:"dcg-icon-dilation"};case"reflect":return{type:"css",className:"dcg-icon-reflection"};case"rotate":return{type:"css",className:"dcg-icon-rotation"};case"translate":return{type:"css",className:"dcg-icon-vector"};default:return{type:"canvas",instructions:this.geoModel.getIconInstructionsForTool(e)}}}isToolEnabled(e){return this.controller.isGeoToolEnabled(e)&&this.geoModel.isToolActuallyUsable(e)}handleKeyPress(e){let t=Pe(e);if(t!=="Up"&&t!=="Down"&&t!=="Esc")return;let o=__dcg_shared_module_exports__['Sa'](this.props.items()),i=this.controller.getFocusLocation();if(t==="Esc"){(i==null?void 0:i.type)==="geo-basic-tool-menu-item"&&this.focusMenuIcon(),this.controller.dispatch({type:"close-item-settings-menu"}),e.stopPropagation(),e.preventDefault();return}if((i==null?void 0:i.type)!=="geo-basic-tool-menu-item")return;let n=t==="Down"?1:-1,s=(o.indexOf(i.tool)+n)%o.length;s<0&&(s=o.length+s),s>=0&&(this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-menu-item",tool:o[s]}}),e.preventDefault(),e.stopPropagation())}focusMenuIcon(){let e=this.props.group();if(!e)return;if(e==="construct-from-selection")return this.controller.dispatch({type:"set-focus-location",location:{type:"multi-select-construct-icon"}});let t=this.controller.getGeoToolbarItemsForGroup(e),o=t==null?void 0:t.current;if(o)return this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:o}})}};var{If:uQ,For:Axe,Switch:Lxe}=ia.Components,Zb=class extends ia.View{template(){return l("span",{class:ia.const("dcg-tool-dropdown"),role:ia.const("button"),tabIndex:ia.const("-1"),"aria-label":this.props.menuName,"aria-expanded":this.props.ariaExpanded,onTap:this.bindFn(this.handleOnTap),children:l("span",{class:ia.const("dcg-dropdown-icon"),children:l("i",{class:ia.const("dcg-icon-caret-down"),"aria-hidden":ia.const("true")})})})}handleOnTap(e){Xt(e),this.props.openDropDown()}},nL=class extends ia.View{init(){this.controller=this.props.controller(),this.geoModel=this.controller.getGeoModel()}getGroups(){return this.controller.getGeoToolbarGroupKeys()}hasDropdown(e){return!!this.getGroup(e).dropdown}template(){return x("div",{role:ia.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tools"),class:ia.const("dcg-geo-basic-tools dcg-animate-in-after-initial-load"),onKeyDown:e=>this.handleToolbarKeydown(e),children:[l("div",{class:ia.const("dcg-geo-basic-tools-row"),children:l(Axe,{each:()=>this.getGroups(),children:e=>x("div",{class:ia.const("dcg-tool-button-container"),children:[x("button",{class:()=>({"dcg-split-btn":this.hasDropdown(e),"dcg-selected":this.isGroupSelected(this.getGroup(e)),"dcg-disabled":!this.isGroupEnabled(this.getGroup(e)),"dcg-menu-open":this.isGroupDropdownOpen(this.getGroup(e)),"dcg-will-be-hidden-or-disabled":this.controller.toolWillBeHiddenOrDisabled(this.getGroup(e).current)}),"dcg-geo-tool":()=>this.getGroup(e).current,"dcg-geo-tool-group":()=>e,tabIndex:()=>this.isGroupSelected(this.getGroup(e))?0:-1,"aria-label":()=>this.geoModel.getDisplayNameForTool(this.getGroup(e).current),"aria-disabled":()=>!this.isGroupEnabled(this.getGroup(e)),"aria-haspopup":()=>this.hasDropdown(e),"aria-pressed":()=>this.isGroupSelected(this.getGroup(e)),onTap:t=>this.handleTap(t,this.getGroup(e)),onLongHold:()=>this.openMenuFromLongHold(this.getGroup(e)),"dcg-open-menu-guid":()=>this.getGuid(this.getGroup(e)),manageFocus:()=>ze({controller:this.controller,location:{type:"geo-basic-tool",tool:this.getGroup(e).current}}),"aria-controls":()=>this.getGuid(this.getGroup(e)),"aria-expanded":()=>this.isGroupDropdownOpen(this.getGroup(e)),children:[l("span",{class:()=>({"dcg-basic-tool-btn":!0,"dcg-icon":!0}),children:l(Jb,{model:()=>this.geoModel,width:this.const(96),height:this.const(96),instructions:()=>this.geoModel.getIconInstructionsForTool(this.getGroup(e).current)})}),l(uQ,{predicate:()=>this.hasDropdown(e),children:()=>l(Zb,{menuName:()=>L0(e),controller:this.props.controller,ariaExpanded:()=>this.isGroupDropdownOpen(this.getGroup(e)),openDropDown:()=>this.openDropdownMenu(this.getGroup(e))})})]}),l(uQ,{predicate:()=>this.isGroupDropdownOpen(this.getGroup(e)),children:()=>l(As,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!1),menuType:this.const("geo-tool-dropdown"),menuButtonFocusLocation:this.const({type:"geo-basic-tool",tool:this.getGroup(e).current}),rootElSelector:this.const(".dcg-geo-basic-tools-row"),children:l(cw,{controller:this.props.controller,group:()=>e,ariaLabel:()=>L0(e),items:()=>this.getDropdownTools(e),onChooseTool:t=>{this.controller.dispatch({type:"select-geo-tool",tool:t.tool,focusGraphPaper:!!t.fromKeyboard})}})})})]})})}),l(Lxe,{children:e=>{switch(e){case"hidden":return l("span",{});case"construct":case"pick-a-tool":return x("div",{class:()=>({"dcg-geo-getting-started-pointer":!0,"dcg-geo-getting-started-has-tool":this.controller.getGeometryGettingStartedMessageState()!=="pick-a-tool"}),children:[this.bindFn(this.getPointerMessage),l("span",{class:ia.const("dcg-curved-icon-container"),children:l("i",{class:ia.const("dcg-icon-curved-arrow")})})]})}}},()=>this.controller.getGeometryGettingStartedMessageState())]})}getDropdownTools(e){let t=this.controller.getOpenItemMenu();if(!t||t.type!=="geo-tool-dropdown"||t.group!==e)return[];if(t.group==="line"){let o=[],i=[];for(let n of t.tools)n==="segment"||n==="line"||n==="ray"||n==="vector"?o.push(n):i.push(n);return[o,i]}return[t.tools]}isGroupSelected(e){return this.selectedTool()===e.current}isGroupEnabled(e){return this.controller.isGeoToolEnabled(e.current)}getGroup(e){let t=this.controller.getGeoToolbarItemsForGroup(e);if(!t)throw new Error("Programing error: "+e+" not found");return t}getPointerMessage(){return this.controller.getGeometryGettingStartedMessageState()==="pick-a-tool"?this.controller.s("geometry-label-pick-tool-instruction"):this.controller.s("geometry-label-construct-instruction")}getFocusedOrActiveTool(){let e=this.controller.getAllVisibleGeoToolbarItems(),t=this.controller.getFocusLocation();if(!t)return;let o;return t.type==="geo-basic-tool"||t.type==="geo-basic-tool-menu-item"?o=t.tool:o=this.controller.getActiveTool(),e.find(i=>{var n,a;return i.current===o||i.dropdown&&((a=(n=i.dropdown)==null?void 0:n.indexOf)==null?void 0:a.call(n,o))>-1})}handleToolbarKeydown(e){var c,d,p,u;let t=Pe(e);if(t!=="Up"&&t!=="Down"&&t!=="Left"&&t!=="Right"&&t!=="Home"&&t!=="End"||(e.preventDefault(),e.stopPropagation(),!this.controller.getFocusLocation()))return;let i=this.controller.getAllVisibleGeoToolbarItems(),n=this.getFocusedOrActiveTool();if(!n)return;let a=i.findIndex(g=>g.group===n.group),s;if(t==="Home")s=(c=i[0])==null?void 0:c.current;else if(t==="End")s=(d=i[i.length-1])==null?void 0:d.current;else if(t==="Left"||t==="Right"){let g=t==="Left"?-1:1,h=Math.max(0,Math.min(i.length-1,a+g));s=(p=i[h])==null?void 0:p.current,((u=this.controller.getOpenItemMenu())==null?void 0:u.type)==="geo-tool-dropdown"&&this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:this.getGuid(n),tools:[],group:n.group}})}else(t==="Up"||t==="Down")&&this.openDropdownMenu(n);s&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:s}})}selectedTool(){let e=this.controller.getActiveTool();return e==="expression-edit"?"selection":e}openDropdownMenu(e){e.dropdown&&(this.isGroupSelected(e)||this.controller.dispatch({type:"select-geo-tool",tool:e.current}),this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:this.getGuid(e),tools:e.dropdown,group:e.group,focusFirstOption:!1}}),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-menu-item",tool:e.current}}))}getGuid(e){return e.dropdown?"geo-dropdown-"+e.dropdown[0]:""}openMenuFromLongHold(e){this.controller.dispatch({type:"select-geo-tool",tool:e.current}),this.openDropdownMenu(e)}handleTap(e,t){e.wasLongheld()||jr(e)||(e.shiftKey||this.isGroupSelected(this.getGroup(t.group))?this.openDropdownMenu(t):(this.controller.dispatch({type:"select-geo-tool",tool:t.current,focusGraphPaper:e.device==="keyboard"}),e.device!=="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:t.current}})))}isGroupDropdownOpen(e){let t=this.controller.getOpenItemMenu();return(t==null?void 0:t.type)==="geo-tool-dropdown"&&t.group===e.group}};var Kp=__dcg_shared_module_exports__['e'](j());var n_=__dcg_shared_module_exports__['e'](j());var{Switch:Pxe,SwitchUnion:Gxe}=n_.Components,Bp=class extends n_.View{template(){return Gxe(()=>this.getLatexOrToken(),"type",{identifier:e=>l(Gp,{identifier:()=>e().identifier,insideMQ:()=>!1,controller:()=>this.props.controller(),insideGroup:()=>!1,putInTabOrder:()=>!1}),latex:e=>l(dt,{config:()=>this.props.controller().getMathquillConfig({}),latex:()=>e().latex,tokenController:this.props.controller})})}getLatexOrToken(){let e=this.props.parent();switch(e.type){case"arbitrary-expression":return{type:"latex",latex:e.latex};case"list-access":case"polygon-edge":case"simple":return{type:"identifier",identifier:__dcg_shared_module_exports__['Oc'](e)};default:return{type:"latex",latex:"unknown"}}}},aL=class extends n_.View{init(){this.controller=this.props.controller()}template(){return l(Pxe,{children:e=>{switch(e){case"translate":return this.getParents().length===1?l("div",{children:x(Ot,{i18n:this.const(this.controller),children:["Translate by"," ",Ot.subview("parent1",()=>l(Bp,{controller:this.props.controller,parent:()=>this.getParents()[0]}))]},this.const("graphing-calculator-label-geometry-translation-by-vector"))}):l("div",{children:x(Ot,{i18n:this.const(this.controller),children:["Translate from"," ",Ot.subview("parent1",()=>l(Bp,{controller:this.props.controller,parent:()=>this.getParents()[0]}))," ","to"," ",Ot.subview("parent2",()=>l(Bp,{controller:this.props.controller,parent:()=>this.getParents()[1]}))]},this.const("graphing-calculator-label-geometry-translation-by-two-points"))});case"reflect":return l("div",{children:x(Ot,{i18n:this.const(this.controller),children:["Reflect over"," ",Ot.subview("parent1",()=>l(Bp,{controller:this.props.controller,parent:()=>this.getParents()[0]}))]},this.const("graphing-calculator-label-geometry-reflection-over-point"))});case"dilate":return l("div",{children:x(Ot,{i18n:this.const(this.controller),children:["Dilate at"," ",Ot.subview("parent1",()=>l(Bp,{controller:this.props.controller,parent:()=>this.getParents()[0]}))," by ",Ot.subview("parent2",()=>l(Bp,{controller:this.props.controller,parent:()=>this.getParents()[1]}))]},this.const("graphing-calculator-label-geometry-dilation-by-point"))});case"rotate":return l("div",{children:x(Ot,{i18n:this.const(this.controller),children:["Rotate around"," ",Ot.subview("parent1",()=>l(Bp,{controller:this.props.controller,parent:()=>this.getParents()[0]}))," by ",Ot.subview("parent2",()=>l(Bp,{controller:this.props.controller,parent:()=>Vxe(this.getParents()[1],this.controller.getGraphSettings().degreeMode)}))]},this.const("graphing-calculator-label-geometry-rotation-around-point-by-angle"))});case void 0:return l("span",{})}}},this.bindFn(this.getTransformationType))}getParents(){let e=this.getGeometry();return!e||!e.call?[]:e&&e.call?e.call.parents:[]}getGeometry(){var e;return(e=this.props.model())==null?void 0:e.formula.geometry}getTransformationType(){var o;let e=this.getGeometry(),t=(o=e==null?void 0:e.call)==null?void 0:o.symbol;switch(t){case"translate":case"dilate":case"reflect":case"rotate":return t}}};function Vxe(r,e){let t=e?"\xB0":"";if(r.type==="arbitrary-expression")return{...r,latex:r.latex+t};if(r.type==="simple"){let o=__dcg_shared_module_exports__['vb'](r.identifier);if(!/^\\token\{(\d+)\}$/.test(o))return{type:"arbitrary-expression",latex:o+t}}return r}var{For:Oxe,If:Rxe}=Kp.Components,sL=class extends Kp.View{init(){this.controller=this.props.controller()}template(){return l(cw,{controller:this.props.controller,ariaLabel:()=>this.controller.s("graphing-calculator-narration-geometry-construct-menu"),group:()=>"construct-from-selection",items:()=>{var o,i;let e=[this.getTransformations()],t=(i=(o=this.props.constructFromSelectionInfo())==null?void 0:o.relevantTools)!=null?i:[];return t.length>0&&e.push(t),e},onChooseTool:e=>this.chooseTool(e),children:l(Rxe,{predicate:()=>this.props.existingTransformations().length>0,children:()=>x("div",{class:Kp.const("dcg-options-menu-section dcg-existing-transformations-container"),children:[l("div",{class:Kp.const("dcg-transformation-header"),children:()=>this.controller.s("graphing-calculator-label-recent-transformations")}),l("div",{role:Kp.const("menu"),"aria-label":()=>this.controller.s("graphing-calculator-label-recent-transformations"),onKeyDown:this.bindFn(this.handleKeyPress),children:l(Oxe,{each:()=>this.props.existingTransformations(),children:(e,t)=>l("div",{class:Kp.const("dcg-existing-transformation"),role:Kp.const("menuitemradio"),tabIndex:()=>t===this.props.existingTransformations()[0].id?0:-1,onTap:()=>this.applyTransformation(e),onPointerOut:o=>this.onPointerOut(o,e),onPointerOver:o=>this.onPointerOver(o,e),willUnmount:()=>this.onImplicitMouseOut(e),manageFocus:()=>ze({controller:this.controller,location:{type:"geo-construct-menu-existing-transformations",transformationId:e.id}}),children:l(aL,{controller:this.props.controller,model:()=>e})})},e=>e.id)})]})})})}generateToolOutput(e){let t=this.props.constructFromSelectionInfo();if(!t)return;let{selected:o}=t;return this.controller.getGeoModel().generatePureToolOutput(e,o)}chooseTool(e){var o,i;let t=e.tool;if(!__dcg_shared_module_exports__['Pc'](t)){let n=this.generateToolOutput(t);if(n!=null&&n.canCommit)this.controller.dispatch({type:"close-item-settings-menu"}),this.controller.getGeoModel().resetToolMode(),this.controller.dispatch({type:"commit-geo-objects",shiftKey:!1,committed:n.outputs,clearToolAndSelection:!0,toolIdToLatex:{}});else{let a=this.controller.getSelectedItem();this.controller.dispatch({type:"select-geo-tool",tool:t,forceSingleUse:!0,focusGraphPaper:!!e.fromKeyboard});let s=this.controller.getGeoModel(),c=(i=(o=s.getTool(t)).getSpec)==null?void 0:i.call(o);if(!c||(a==null?void 0:a.type)!=="expression")return;s.tentativelyMatchToolInput(c,o_(a)),s.attemptLockToolInputIn(c)}return}this.controller.dispatch({type:"select-geo-tool",tool:t,focusGraphPaper:!!e.fromKeyboard})}getTransformations(){return lw.filter(e=>this.controller.isGeoToolVisible(e))}handleKeyPress(e){let t=Pe(e);if(t!=="Up"&&t!=="Down"&&t!=="Esc")return;let o=this.props.existingTransformations(),i=this.controller.getFocusLocation();if(t==="Esc"){if((i==null?void 0:i.type)==="geo-construct-menu-existing-transformations")return this.controller.dispatch({type:"set-focus-location",location:{type:"multi-select-construct-icon"}});this.controller.dispatch({type:"close-item-settings-menu"}),e.stopPropagation(),e.preventDefault();return}if((i==null?void 0:i.type)!=="geo-construct-menu-existing-transformations")return;let n=t==="Down"?1:-1,s=(o.findIndex(c=>c.id===i.transformationId)+n)%o.length;s<0&&(s=o.length+s),s>=0&&(this.controller.dispatch({type:"set-focus-location",location:{type:"geo-construct-menu-existing-transformations",transformationId:o[s].id}}),e.preventDefault(),e.stopPropagation())}onPointerOver(e,t){var i;if(e.pointerType!=="mouse")return;let o=(i=Go(t))==null?void 0:i.identifier;o&&(this.currentlyActiveTokenIdentifier=o,this.controller.dispatch({type:"set-active-token",identifier:this.currentlyActiveTokenIdentifier,style:"hovered"}))}onPointerOut(e,t){var i;if(e.pointerType!=="mouse")return;let o=(i=Go(t))==null?void 0:i.identifier;o&&this.currentlyActiveTokenIdentifier&&this.currentlyActiveTokenIdentifier===o&&(this.controller.dispatch({type:"unset-active-token",identifier:this.currentlyActiveTokenIdentifier,style:"hovered"}),this.currentlyActiveTokenIdentifier=void 0)}onImplicitMouseOut(e){var o;let t=(o=Go(e))==null?void 0:o.identifier;t&&this.currentlyActiveTokenIdentifier&&this.currentlyActiveTokenIdentifier===t&&this.controller.runAfterDispatch(()=>{let i=this.currentlyActiveTokenIdentifier;i&&(this.currentlyActiveTokenIdentifier=void 0,this.controller.dispatch({type:"unset-active-token",identifier:i,style:"hovered"}))})}applyTransformation(e){var o;if(!((o=e.formula.geometry)!=null&&o.identifier))return;let t=__dcg_shared_module_exports__['vb'](e.formula.geometry.identifier);this.controller.dispatch({type:"apply-transformation-to-selected",assignmentLatex:t})}};var Ih=__dcg_shared_module_exports__['e'](j());var{If:Fxe,IfElse:Nxe,SwitchUnion:Uxe}=Ih.Components,lL=class extends Ih.View{init(){this.controller=this.props.controller(),this.updateSingleItemState()}willUpdate(){this.updateSingleItemState()}updateSingleItemState(){var o;let e=this.getSelectionLabelInfo();if(e.type==="multiple"){this.singleItemState=void 0;return}if(((o=this.singleItemState)==null?void 0:o.itemId)===e.model.id)return;let t;ws(e.model)?t=e.model.label===""?"measurement":"text":t="text",this.singleItemState={itemId:e.model.id,mode:t}}sectionValues(){return this.props.sectionValues()}getSelectionLabelInfo(){var o,i;let t=this.sectionValues().singleLabelableExpressionModel;switch((i=(o=t==null?void 0:t.formula)==null?void 0:o.geometry)==null?void 0:i.valueType){case __dcg_shared_module_exports__['C']:return{type:"single",objectType:"point",model:t};case __dcg_shared_module_exports__['S']:case __dcg_shared_module_exports__['U']:return{type:"single",objectType:"angle",model:t};case __dcg_shared_module_exports__['K']:return{type:"single",objectType:"segment",model:t};default:return{type:"multiple",objectType:"point"}}}allowPointCoordinates(){return!!this.controller.getGraphSettings().showXAxis}getLabelMode(){var t;return this.getSelectionLabelInfo().type==="multiple"?this.sectionValues().pointLabels:(t=this.singleItemState)==null?void 0:t.mode}getSegmentedLabels(){switch(this.getSelectionLabelInfo().objectType){case"point":return{text:"A,B,C",measurement:"(x,y)"};case"angle":return{text:"Text",measurement:"Measure"};case"segment":return{text:"Text",measurement:"Length"}}}getSegmentedControlConfig(){let e=()=>this.getSelectionLabelInfo().objectType==="point"&&this.allowPointCoordinates()?"dcg-segmented-control-btn--point":"";return[{key:"text",label:()=>this.getSegmentedLabels().text,selected:()=>this.getLabelMode()==="text",onSelect:t=>{this.lastSelectionDevice=t,this.onSelectTextLabel()},class:e},{key:"measurements",label:()=>this.getSegmentedLabels().measurement,selected:()=>this.getLabelMode()==="measurement",onSelect:t=>{this.lastSelectionDevice=t,this.onSelectMeasurementLabel()},class:e}]}onSelectTextLabel(){var t;let e=this.getSelectionLabelInfo();if(e.type==="multiple"){this.controller.dispatch({type:"set-label-state-for-selected-points",state:this.getLabelMode()==="text"?"none":"auto"});return}if(!this.singleItemState)throw new Error("Expected singleItemState to be defined");this.getLabelMode()==="text"?(this.singleItemState.mode="none",this.controller.dispatch({type:"set-item-showlabel",id:e.model.id,showLabel:!1})):(this.singleItemState.mode="text",((t=e.model.formula.geometry)==null?void 0:t.valueType)===__dcg_shared_module_exports__['C']?this.controller.dispatch({type:"set-label-state-for-selected-points",state:"auto"}):this.controller.dispatch({type:"set-item-showlabel",id:e.model.id,showLabel:!1}))}onSelectMeasurementLabel(){let e=this.getSelectionLabelInfo();if(e.type==="multiple"){this.controller.dispatch({type:"set-label-state-for-selected-points",state:this.getLabelMode()==="measurement"?"none":"measurement"});return}if(!this.singleItemState)throw new Error("Expected singleItemState to be defined");this.getLabelMode()==="measurement"?(this.singleItemState.mode="none",this.controller.dispatch({type:"set-item-showlabel",id:e.model.id,showLabel:!1})):(this.singleItemState.mode="measurement",this.controller.dispatch({type:"set-item-showlabel",id:e.model.id,showLabel:!0}),this.controller.dispatch({type:"set-item-label",id:e.model.id,label:""}))}template(){return l("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-label-menu":!0}),role:Ih.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-label-menu"),children:x("div",{class:Ih.const("dcg-options-menu-section"),children:[Uxe(()=>this.getSelectionLabelInfo(),"type",{multiple:()=>l("div",{children:Nxe(this.bindFn(this.allowPointCoordinates),{true:()=>x("div",{class:Ih.const("dcg-multi-select-menu_margin-top-section"),children:[()=>this.controller.s("graphing-calculator-button-geometry-label-points"),":"]}),false:()=>l(ft,{checked:()=>this.getLabelMode()==="text",onChange:()=>this.onSelectTextLabel(),children:()=>this.controller.s("graphing-calculator-button-geometry-label-points")})})}),single:e=>l("div",{class:Ih.const("dcg-multi-select-menu_margin-top-section"),children:l(Yb,{controller:this.props.controller,model:()=>e().model,forceEnabled:this.const(!0),displayComputedValue:()=>{if(this.getLabelMode()!=="measurement")return;let t=this.controller.getGrapher2d(),o=t.getGraphSketch(e().model.id);return o&&o.labels.length===1?HN(o.labels[0],t.getProjection()).text:""},selectInputOnMount:()=>this.lastSelectionDevice!=="keyboard",suppressInput:()=>this.getLabelMode()==="none",manageInputFocus:this.const(ze({controller:this.controller,location:{type:"multi-select-label-menu-label-input"}}))})})}),l(Fxe,{predicate:()=>this.getSelectionLabelInfo().objectType!=="point"||this.allowPointCoordinates(),children:()=>l(ar,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-geometry-label-options"),staticConfig:this.bindFn(this.getSegmentedControlConfig)})})]})})}};var ja=__dcg_shared_module_exports__['e'](j());var Td=__dcg_shared_module_exports__['e'](j());var{Input:Yxe,If:qU}=Td.Components,cL=class extends Td.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.newFolderTitle=""}init(){this.cacheFolderList()}willUpdate(){this.cacheFolderList()}template(){return l(qU,{predicate:()=>this.getMovableItems().length>0,children:()=>x("div",{class:Td.const("dcg-move-to-expression-list"),children:[x("div",{class:Td.const("dcg-move-to-expression-list-title"),role:()=>this.canMoveToExpressionList()?"button":void 0,tabIndex:()=>this.canMoveToExpressionList()?0:void 0,onTap:this.bindFn(this.moveToExpressionList),children:[l(qU,{predicate:()=>this.canMoveToExpressionList(),children:()=>l("i",{class:Td.const("dcg-icon-insert"),"aria-hidden":Td.const("true")})}),l("span",{children:this.bindFn(this.getMoveMessage)})]}),l(qU,{predicate:()=>!this.canMoveToExpressionList(),children:()=>x("div",{class:Td.const("dcg-move-to-expression-list-flex"),children:[l(Yxe,{"aria-label":this.bindFn(this.getMoveMessage),value:()=>this.newFolderTitle,onInput:e=>{this.newFolderTitle=e,this.update()},placeholder:()=>this.controller.s("graphing-calculator-label-geometry-move-to-folder-placeholder"),didMount:e=>{e.onkeydown=function(t){let o=Pe(t);(o==="Backspace"||o==="Del")&&t.stopPropagation()}},onEnterPressed:this.bindFn(this.onEnterPressed)}),l("div",{class:()=>({"dcg-btn-purple":!0,"dcg-disabled":!this.newFolderTitle}),role:Td.const("button"),tabIndex:()=>this.newFolderTitle?0:-1,onTap:this.bindFn(this.createNewFolder),children:()=>this.controller.s("graphing-calculator-button-move-to-expression-list-action")})]})})]})})}getMovableItems(){return this.controller.getAllSelectedItems().filter(t=>!this.controller.isItemReadonly(t.id))}canMoveToExpressionList(){var n,a;let e=this.getMovableItems(),[t]=e;if(!(e.length===1&&t.type!=="folder"&&t.folderId===__dcg_shared_module_exports__['Zd']))return!1;if(t.type!=="expression"||((a=(n=t.formula.geometry)==null?void 0:n.call)==null?void 0:a.symbol)!=="apply")return!0;let i=t.formula.geometry.call.parents[0];return i.type==="arbitrary-expression"?!0:this.controller.getItemsByIdentifier(__dcg_shared_module_exports__['Oc'](i)).every(s=>s.folderId!==__dcg_shared_module_exports__['Zd'])}getMoveMessage(){return`${this.controller.s("graphing-calculator-text-geometry-move-to-expression-list-message")}${this.canMoveToExpressionList()?"":":"}`}onEnterPressed(){let e=this.folderList.find(t=>t.title===this.newFolderTitle);e?this.chooseFolder(e.id):this.createNewFolder()}chooseFolder(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"folderId",value:e}})}createNewFolder(){this.newFolderTitle&&this.controller.dispatch({type:"update-all-selected-items",update:{prop:"folderId",value:this.newFolderTitle,createFolder:!0}})}cacheFolderList(){this.folderList=this.controller.getAllItemModels().filter(e=>e.type==="folder"&&!this.controller.isGeoFolder(e))}moveToExpressionList(){this.canMoveToExpressionList()&&this.controller.dispatch({type:"move-selected-item-to-expression-list"})}};var{If:Qb}=ja.Components,dL=class extends ja.View{constructor(){super(...arguments),this.controller=this.props.controller()}sectionValues(){return this.props.sectionValues()}template(){return l("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-options-menu":!0}),role:ja.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu"),children:x("div",{class:ja.const("dcg-options-menu-section"),children:[l(Qb,{predicate:()=>this.hasSelectedAndEditableItems(),children:()=>x("button",{handleEvent:ja.const("true"),class:ja.const("dcg-unstyled-button dcg-delete-btn dcg-btn-purple"),onTap:this.bindFn(this.deleteSelected),children:[l("i",{class:ja.const("dcg-icon-trashcan"),"aria-hidden":ja.const("true")}),l("span",{children:()=>this.getDeleteItemString()})]})}),l(Qb,{predicate:()=>this.sectionValues().draggableFreePoint!==void 0,children:()=>x(Dp,{children:[l("div",{class:ja.const("dcg-divider-line")}),l("div",{class:ja.const("dcg-checkbox-section"),children:l(ft,{checked:()=>!!this.sectionValues().draggableFreePoint,onChange:this.bindFn(this.onDraggableFreePointChanged),children:()=>this.controller.s("graphing-calculator-button-draggable-points")})})]})}),l(Qb,{predicate:()=>this.sectionValues().graphInteractionDisabled!==void 0&&this.props.controller().shouldShowAuthorFeatures(),children:()=>l("div",{class:ja.const("dcg-checkbox-section dcg-disable-graph-interactions"),children:l(ft,{checked:()=>!!this.sectionValues().graphInteractionDisabled,onChange:()=>this.toggleGraphInteractionsDisabled(),children:()=>this.controller.s("graphing-calculator-label-disable-graph-interactions")})})}),l(Qb,{predicate:()=>this.sectionValues().arrowMode!==void 0,children:()=>l("div",{children:()=>this.controller.s("graphing-calculator-text-geometry-arrow-mode",{mode:this.getArrowModeDisplayName()})})}),l(Qb,{predicate:()=>this.controller.getGraphSettings().config.expressions,children:()=>x(Dp,{children:[l("div",{class:ja.const("dcg-divider-line")}),l(cL,{controller:this.props.controller})]})}),l(Qb,{predicate:()=>this.getSelectedAndEditableItems().length===1,children:()=>{let e=this.getSelectedAndEditableItems()[0];return(e==null?void 0:e.type)!=="expression"?l("span",{}):l(Qb,{predicate:()=>!$n(e),children:()=>x(Dp,{children:[l("div",{class:ja.const("dcg-divider-line")}),l(pm,{controller:this.props.controller,model:this.const(e),focusLocation:this.const({type:"multi-select-options-menu-item",subtype:"screenreader-description"})})]})})}})]})})}getSelectedAndEditableItems(){return this.controller.getAllSelectedItems().filter(t=>!this.controller.isItemReadonly(t.id))}hasSelectedAndEditableItems(){return this.getSelectedAndEditableItems().length>0}toggleGraphInteractionsDisabled(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"disableGraphInteractions",value:!this.sectionValues().graphInteractionDisabled}})}onDraggableFreePointChanged(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"dragMode",value:e?__dcg_shared_module_exports__['Gd'].XY:__dcg_shared_module_exports__['Gd'].NONE}})}getArrowModeDisplayName(){let e=this.sectionValues().arrowMode;if(!e)return"";switch(e){case __dcg_shared_module_exports__['Md'].NONE:return this.controller.s("graphing-calculator-text-arrow-mode-none");case __dcg_shared_module_exports__['Md'].DEFAULT:return this.controller.s("graphing-calculator-text-arrow-mode-default");case __dcg_shared_module_exports__['Md'].POSITIVE:return this.controller.s("graphing-calculator-text-arrow-mode-positive");case __dcg_shared_module_exports__['Md'].BOTH:return this.controller.s("graphing-calculator-text-arrow-mode-both")}}getSelectedCount(){return this.controller.getAllSelectedItems().length}getDeleteItemString(){let e=this.getSelectedCount(),t=this.getSelectedAndEditableItems().length;return e-t>0?this.controller.s("graphing-calculator-text-geometry-delete-selected-unlocked-objects",{count:__dcg_shared_module_exports__['Db'](t)}):this.controller.s("graphing-calculator-text-geometry-delete-selected-objects",{count:__dcg_shared_module_exports__['Db'](t)})}deleteSelected(){this.controller.dispatch({type:"delete-all-selected-items"})}};var mm=__dcg_shared_module_exports__['e'](j());var{If:Bxe}=mm.Components,pL=class extends mm.View{init(){this.controller=this.props.controller()}sectionValues(){return this.props.sectionValues()}getSelectedColor(){let e=this.sectionValues().color;return!(e!=null&&e.isUnique)||!(e!=null&&e.selectedColor)?"":e.selectedColor}template(){return l("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-style-menu":!0}),role:mm.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-style-menu"),children:x("div",{class:mm.const("dcg-options-menu-section"),children:[l("div",{class:mm.const("dcg-multi-select-color-picker"),children:l(X1,{controller:this.props.controller,colorLatex:()=>{var e,t;return(t=(e=this.sectionValues().color)==null?void 0:e.colorLatex)!=null?t:""},selectedColor:this.bindFn(this.getSelectedColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),customColorVisibility:this.bindFn(this.getCustomColorVisibility)})}),l(Bxe,{predicate:()=>this.sectionValues().arrowMode!==void 0,children:()=>l("div",{children:()=>this.controller.s("graphing-calculator-text-geometry-arrow-mode",{mode:this.getArrowModeDisplayName()})})})]})})}getArrowModeDisplayName(){let e=this.sectionValues().arrowMode;if(!e)return"";switch(e){case __dcg_shared_module_exports__['Md'].NONE:return this.controller.s("graphing-calculator-text-arrow-mode-none");case __dcg_shared_module_exports__['Md'].DEFAULT:return this.controller.s("graphing-calculator-text-arrow-mode-default");case __dcg_shared_module_exports__['Md'].POSITIVE:return this.controller.s("graphing-calculator-text-arrow-mode-positive");case __dcg_shared_module_exports__['Md'].BOTH:return this.controller.s("graphing-calculator-text-arrow-mode-both")}}onColorSelected(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"color",value:e}})}getCustomColorVisibility(){return this.controller.getGraphSettings().hideCustomColors?this.controller.shouldShowAuthorFeatures()?"suppressed":"hidden":"visible"}onCustomColorSelected(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"colorLatex",value:e}})}};var fm=__dcg_shared_module_exports__['e'](j());var dw=class extends fm.View{template(){return l("button",{class:()=>{var e,t;return{"dcg-unstyled-button":!0,"dcg-navigate-back":!0,"dcg-navigate-back__no-right-border":(t=(e=this.props).noRightBorder)==null?void 0:t.call(e)}},onTap:this.props.onBack,"aria-label":this.props.ariaLabel,role:fm.const("button"),tabIndex:fm.const("0"),handleEvent:fm.const("true"),manageFocus:this.const(ze({controller:this.props.controller(),location:{type:"geo-header-back-link"}})),children:l("i",{class:fm.const("dcg-icon-chevron-left"),"aria-hidden":fm.const("true")})})}};var{If:zp,Switch:hQ}=yi.Components,uL=class extends yi.View{init(){this.controller=this.props.controller(),this.cacheSectionValues(),this.cacheExistingTransformations()}willUpdate(){this.cacheSectionValues(),this.cacheExistingTransformations(),this.cachedConstructFromSelectionInfo=this.computeConstructFromSelectionInfo()}template(){return x("div",{class:yi.const("dcg-multi-select-header dcg-animate-in-after-initial-load"),onKeyDown:this.bindFn(this.handleKeydown),role:yi.const("toolbar"),"aria-label":this.bindFn(this.getSelectedCountString),children:[l(dw,{onBack:this.bindFn(this.deselectAll),controller:this.props.controller,noRightBorder:this.const(!0),ariaLabel:()=>this.controller.s("shared-calculator-text-keyboard-shortcut-geometry-deselect-all-objects")}),l(hQ,{children:()=>l(zp,{predicate:()=>this.isButtonVisible("multi-select-show-hide-icon"),children:()=>x("div",{class:()=>({"dcg-btn-outline":!0,"dcg-show-hide-btn":!0,"dcg-any-visible-objects":this.anyVisible()}),handleEvent:yi.const("true"),tabIndex:yi.const("0"),role:yi.const("button"),onTap:this.bindFn(this.toggleItemsVisible),manageFocus:this.const(ze({controller:this.controller,location:{type:"multi-select-show-hide-icon"}})),children:[x("div",{"aria-hidden":()=>!this.anyVisible(),children:[()=>this.controller.s("graphing-calculator-text-geometry-hide-objects"),l(zp,{predicate:()=>this.getSelectedCount()>1,children:()=>l("span",{children:()=>` (${this.getSelectedCount()})`})})]}),x("div",{"aria-hidden":this.bindFn(this.anyVisible),children:[()=>this.controller.s("graphing-calculator-text-geometry-show-objects"),l(zp,{predicate:()=>this.getSelectedCount()>1,children:()=>l("span",{children:()=>` (${this.getSelectedCount()})`})})]})]})})},this.bindFn(this.getSelectedItemsKey)),x("div",{class:()=>({"dcg-style-button":!0,"dcg-toolbar-dropdown-button":!0,"dcg-menu-open":this.isStyleMenuOpen()}),handleEvent:yi.const("true"),tabIndex:yi.const("-1"),role:yi.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-style-menu"),"aria-expanded":this.bindFn(this.isStyleMenuOpen),"dcg-open-menu-guid":()=>HU(),onTap:this.bindFn(this.toggleStyleMenu),manageFocus:this.const(ze({controller:this.controller,location:{type:"multi-select-style-icon"}})),children:[l(mh,{color:()=>this.getSelectedColor(),invertSwatches:()=>this.controller.invertSwatches()}),l(Zb,{menuName:()=>this.controller.s("graphing-calculator-narration-geometry-style-menu"),ariaExpanded:this.bindFn(this.isStyleMenuOpen),controller:this.const(this.controller),openDropDown:()=>{}})]}),l(zp,{predicate:()=>this.isButtonVisible("multi-select-label-icon"),children:()=>x("div",{class:()=>({"dcg-label-button":!0,"dcg-toolbar-dropdown-button":!0,"dcg-menu-open":this.isLabelMenuOpen()}),handleEvent:yi.const("true"),tabIndex:yi.const("-1"),role:yi.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-narration-label-menu"),"aria-expanded":this.bindFn(this.isLabelMenuOpen),"dcg-open-menu-guid":()=>WU(),onTap:this.bindFn(this.toggleLabelMenu),manageFocus:this.const(ze({controller:this.controller,location:{type:"multi-select-label-icon"}})),children:[l("div",{class:yi.const("dcg-label-button-icon"),children:"A"}),l(Zb,{menuName:()=>this.controller.s("graphing-calculator-narration-label-menu"),ariaExpanded:this.bindFn(this.isLabelMenuOpen),controller:this.const(this.controller),openDropDown:()=>{}})]})}),l(zp,{predicate:()=>this.isButtonVisible("multi-select-construct-icon"),children:()=>x("div",{class:()=>({"dcg-construct-button":!0,"dcg-toolbar-dropdown-button":!0,"dcg-menu-open":this.isConstructMenuOpen()}),handleEvent:yi.const("true"),tabIndex:yi.const("-1"),role:yi.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-construct-menu"),"aria-expanded":this.bindFn(this.isConstructMenuOpen),"dcg-open-menu-guid":()=>a_(),onTap:this.bindFn(this.toggleConstructMenu),manageFocus:this.const(ze({controller:this.controller,location:{type:"multi-select-construct-icon"}})),children:[l(iL,{}),l(Zb,{menuName:()=>this.controller.s("graphing-calculator-narration-geometry-construct-menu"),ariaExpanded:this.bindFn(this.isConstructMenuOpen),controller:this.const(this.controller),openDropDown:()=>{}})]})}),l(zp,{predicate:()=>this.isButtonVisible("multi-select-more-icon"),children:()=>l(Oe,{tooltip:this.bindFn(this.getMoreString),children:l("div",{"aria-label":this.bindFn(this.getMoreString),role:yi.const("button"),tabIndex:yi.const("-1"),handleEvent:yi.const("true"),"aria-expanded":this.bindFn(this.isMoreMenuOpen),class:()=>({"dcg-multi-select-icon-button dcg-more-options dcg-toolbar-dropdown-button":!0,"dcg-menu-open":this.isMoreMenuOpen()}),"dcg-open-menu-guid":()=>ey(),manageFocus:this.const(ze({controller:this.controller,location:{type:"multi-select-more-icon"}})),onTap:this.bindFn(this.toggleMoreMenu),children:l(za,{})})})}),l(zp,{predicate:this.bindFn(this.isLabelMenuOpen),children:()=>l(hQ,{children:()=>l(As,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!0),menuType:this.const("multi-select-label"),menuButtonFocusLocation:this.const({type:"multi-select-label-icon"}),rootElSelector:this.const(".dcg-multi-select-header"),children:l(lL,{controller:this.props.controller,sectionValues:()=>this.sectionValues})})},()=>Object.keys(this.controller.getSelectedExpressionIds()).join(":"))}),l(zp,{predicate:this.bindFn(this.isStyleMenuOpen),children:()=>l(As,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!0),menuType:this.const("multi-select-style"),menuButtonFocusLocation:this.const({type:"multi-select-style-icon"}),rootElSelector:this.const(".dcg-multi-select-header"),children:l(pL,{controller:this.props.controller,sectionValues:()=>this.sectionValues})})}),l(zp,{predicate:this.bindFn(this.isConstructMenuOpen),children:()=>l(As,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!0),menuType:this.const("multi-select-construct"),menuButtonFocusLocation:this.const({type:"multi-select-construct-icon"}),rootElSelector:this.const(".dcg-multi-select-header"),children:l(sL,{controller:this.props.controller,constructFromSelectionInfo:()=>this.cachedConstructFromSelectionInfo,existingTransformations:()=>this.cachedExistingTransformations})})}),l(zp,{predicate:this.bindFn(this.isMoreMenuOpen),children:()=>l(As,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!0),menuType:this.const("multi-select-more"),menuButtonFocusLocation:this.const({type:"multi-select-more-icon"}),rootElSelector:this.const(".dcg-multi-select-header"),children:l(dL,{controller:this.props.controller,sectionValues:()=>this.sectionValues})})})]})}getFocusOrder(){return["geo-header-back-link","multi-select-show-hide-icon","multi-select-style-icon","multi-select-label-icon","multi-select-construct-icon","multi-select-more-icon"].filter(t=>this.isButtonVisible(t)).map(t=>({type:t}))}isButtonVisible(e){switch(e){case"geo-header-back-link":return!0;case"multi-select-show-hide-icon":return this.hasSelectedAndEditableItems();case"multi-select-style-icon":return!0;case"multi-select-label-icon":return this.sectionValues.pointLabels!==void 0||this.sectionValues.singleLabelableExpressionModel!==void 0;case"multi-select-construct-icon":return this.isSomeRelevantToolEnabled();case"multi-select-more-icon":return this.controller.shouldShowAuthorFeatures()||this.hasSelectedAndEditableItems()||this.sectionValues.draggableFreePoint!==void 0;default:return!1}}cacheSectionValues(){this.sectionValues=this.computeSectionValues()}computeSectionValues(){var n;let e={pointLabels:[],singleLabelableExpressionModel:[],draggableFreePoint:[],arrowMode:[],graphInteractionDisabled:[],color:[]},t=this.controller.getAllSelectedItems();for(let a of t){if(e.graphInteractionDisabled.push($n(a)),a.type!=="expression")continue;e.color.push({selectedColor:Eg(a),colorLatex:a.colorLatex});let s=(n=a.formula.geometry)==null?void 0:n.valueType;switch(__dcg_shared_module_exports__['qa'](s)&&(s=__dcg_shared_module_exports__['ra'](s)),s){case __dcg_shared_module_exports__['C']:a.showLabel?e.pointLabels.push(a.label?"text":"measurement"):e.pointLabels.push("none"),e.singleLabelableExpressionModel.push(a),a.formula.move_strategy&&e.draggableFreePoint.push(a.dragMode!==__dcg_shared_module_exports__['Gd'].NONE);break;case __dcg_shared_module_exports__['J']:break;case __dcg_shared_module_exports__['N']:e.arrowMode.push(a.arrowMode);break;case __dcg_shared_module_exports__['M']:break;case __dcg_shared_module_exports__['O']:break;case __dcg_shared_module_exports__['Q']:break;case __dcg_shared_module_exports__['Y']:break;case __dcg_shared_module_exports__['K']:e.singleLabelableExpressionModel.push(a),e.arrowMode.push(a.arrowMode);break;case __dcg_shared_module_exports__['S']:case __dcg_shared_module_exports__['U']:e.singleLabelableExpressionModel.push(a);break;case __dcg_shared_module_exports__['W']:break;default:}}let o={},i=t.length;for(let a in e){let s=a;switch(s){case"singleLabelableExpressionModel":{let d=e[s];i===1&&d.length===1&&(o[s]=d[0])}break;case"pointLabels":{let d=e[s];if(d.length>0&&i>1){let p=__dcg_shared_module_exports__['Ua'](d);p.length===1?o[s]=p[0]:o[s]="none"}}break;case"draggableFreePoint":{let d=e[s];d.length>0&&(o[s]=__dcg_shared_module_exports__['Ja'](d))}break;case"arrowMode":break;case"graphInteractionDisabled":{o[s]=e[s].every(d=>d);break}case"color":{let d=e[s].map(u=>JSON.stringify(u)),p=new Set(d).size===1;o[s]={...e[s][0],isUnique:p};break}default:return s}}return o}cacheExistingTransformations(){this.cachedExistingTransformations=this.computeExistingTransformations()}computeConstructFromSelectionInfo(){let e=this.controller.getSelectedItem();if((e==null?void 0:e.type)==="expression"){let t=e.formula.typed_constant_value;if(!t||__dcg_shared_module_exports__['wa'](t.valueType,__dcg_shared_module_exports__['C']))return;let o=this.controller.getAllAvailableGeoTools(),i=[];for(let n of o){let a=this.controller.getGeoModel().getTool(n);a instanceof Lr&&a.getMatchingWorkflow([t])&&i.push(n)}return{type:"single-selection",selected:[{referenceLatex:o_(e),typedValue:t}],relevantTools:i}}}computeExistingTransformations(){var t,o;let e=[];for(let i of this.controller.getAllItemModels()){if(i.type!=="expression"||!this.controller.isItemInGeoFolder(i.id))continue;let n=(t=i.formula.geometry)==null?void 0:t.call;if(!n||!__dcg_shared_module_exports__['Pc'](n.symbol)||!n.parents.every((s,c)=>s.type!=="arbitrary-expression"||(n.symbol==="rotate"||n.symbol==="dilate")&&c===1))continue;let a=(o=i.formula.typed_constant_value)==null?void 0:o.valueType;a!==void 0&&__dcg_shared_module_exports__['wa'](a,__dcg_shared_module_exports__['W'])&&e.push(i)}return e.reverse()}handleKeydown(e){let t=Pe(e);if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||t!=="Left"&&t!=="Right"&&t!=="Home"&&t!=="End")return;let o=this.controller.getFocusLocation();if(!o)return;let i=__dcg_shared_module_exports__['Wa'](this.getFocusOrder(),o);if(i===-1)return;e.preventDefault(),e.stopPropagation();let n=i;t==="Left"?n=Math.max(0,i-1):t==="Right"?n=Math.min(this.getFocusOrder().length-1,i+1):t==="Home"?n=0:t==="End"&&(n=this.getFocusOrder().length-1),n!==i&&(this.controller.dispatch({type:"close-item-settings-menu"}),this.controller.dispatch({type:"set-focus-location",location:this.getFocusOrder()[n]}))}getSelectedCountString(){return this.controller.getGrapherDimensions().width<450?"":this.controller.s("graphing-calculator-text-geometry-selected-objects",{count:__dcg_shared_module_exports__['Db'](this.getSelectedCount())})}getSelectedAndEditableItems(){return this.controller.getAllSelectedItems().filter(t=>!this.controller.isItemReadonly(t.id))}hasSelectedAndEditableItems(){return this.getSelectedAndEditableItems().length>0}isSomeRelevantToolEnabled(){var t,o;return[...(o=(t=this.cachedConstructFromSelectionInfo)==null?void 0:t.relevantTools)!=null?o:[],...lw].some(i=>this.controller.isGeoToolVisible(i))}deselectAll(){this.controller.dispatch({type:"set-none-selected"})}getMoreString(){return this.controller.s("graphing-calculator-text-geometry-multi-select-more-dropdown")}getSelectedItemsKey(){let e=this.controller.getAllSelectedItems();return __dcg_shared_module_exports__['La'](e,"id").join("-")}toggleItemsVisible(){this.anyVisible()?this.hideSelected():this.showSelected()}anyVisible(){let e=this.controller.getAllSelectedItems();return __dcg_shared_module_exports__['Ja'](e,t=>!ji(t))}isFolderMenuOpen(){return this.controller.isItemSettingsMenuOpen(Kxe())}isMoreMenuOpen(){return this.controller.isItemSettingsMenuOpen(ey())}isConstructMenuOpen(){return this.controller.isItemSettingsMenuOpen(a_())}isStyleMenuOpen(){return this.controller.isItemSettingsMenuOpen(HU())}isLabelMenuOpen(){return this.controller.isItemSettingsMenuOpen(WU())}toggleMoreMenu(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-more",guid:ey(),focusFirstOption:!0}})}toggleConstructMenu(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-construct",guid:a_(),focusFirstOption:!0}})}toggleStyleMenu(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-style",guid:HU(),focusFirstOption:!0}})}toggleLabelMenu(){var t;let e=this.sectionValues.singleLabelableExpressionModel;!this.isLabelMenuOpen()&&e&&!ws(e)&&((t=e.formula.geometry)==null?void 0:t.valueType)===__dcg_shared_module_exports__['C']&&this.controller.dispatch({type:"set-label-state-for-selected-points",state:"auto"}),this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-label",guid:WU(),focusFirstOption:!0}}),this.isLabelMenuOpen()&&e&&e.label!==""&&this.controller.dispatch({type:"set-focus-location",location:{type:"multi-select-label-menu-label-input"}})}getSelectedCount(){return this.controller.getAllSelectedItems().length}hideSelected(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"visible",value:!1}})}showSelected(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"visible",value:!0}})}getSelectedColor(){var o;let e=this.sectionValues.color,t=e&&((o=this.controller.getAllColorAssignments().find(i=>i.assignmentLatex===e.colorLatex))==null?void 0:o.id);if(t){let i=this.controller.getColorById(t);return Array.isArray(i)?{type:"color-array",value:i}:{type:"single-color",value:i}}else if(e!=null&&e.selectedColor)return{type:"single-color",value:e.selectedColor};return{type:"single-color",value:this.controller.getColors().GRAY}}};function Kxe(){return"**multi-select-folder**"}function ey(){return"**multi-select-more**"}function a_(){return"**multi-select-construct**"}function HU(){return"**multi-select-style**"}function WU(){return"**multi-select-label**"}Ut();var Mh=document.createElement("canvas").getContext("2d"),Xa=class r{constructor(e,t){this._label=e,this._fontSize=t,this._layout=zxe(e,t)}getRect(){return this.getRectWhenCenteredAt({x:0,y:0})}getRectWhenCenteredAt(e){return{left:this._layout.left+e.x,right:this._layout.right+e.x,top:this._layout.top+e.y,bottom:this._layout.bottom+e.y}}getBoundsWhenCenteredAt(e,t){switch(t){case"x":return{lower:this._layout.left+e,upper:this._layout.right+e};case"y":return{lower:this._layout.top+e,upper:this._layout.bottom+e};default:let o=t;throw new Error(`Unknown axis: ${o}`)}}getWidth(){return this._layout.right-this._layout.left}getHeight(){return this._layout.bottom-this._layout.top}getDimensionAlongAxis(e){switch(e){case"x":return this.getWidth();case"y":return this.getHeight();default:let t=e;throw new Error(`Unknown axis: ${t}`)}}clampBoundsWithinRect(e,t){let o,i;return e.x+this._layout.left<t.left?o=t.left-this._layout.left:e.x+this._layout.right>t.right?o=t.right-this._layout.right:o=e.x,e.y+this._layout.top<t.top?i=t.top-this._layout.top:e.y+this._layout.bottom>t.bottom?i=t.bottom-this._layout.bottom:i=e.y,{x:o,y:i}}getValue(){return this._label.value}getMinusWidth(){return this.getValue()<0?(r.setCtxFontSize(Mh,this._fontSize),Mh.measureText("-1").width-Mh.measureText("1").width):0}getString(){return this._label.superscript?this._label.mantissa+"^"+this._label.superscript:this._label.string}drawCenteredAt(e,t,o){let i=t.x,n=r.computeBaselineFromCenter(t.y,this._fontSize);o&&Oo(e,o),e.save(),o&&xo(e),r.setCtxFontSize(e,this._fontSize),this._label.superscript?(e.strokeText(this._label.mantissa,this._layout.mantissa_x+i,this._layout.mantissa_y+n),e.strokeText(this._label.superscript,this._layout.superscript_x+i,this._layout.superscript_y+n),e.fillText(this._label.mantissa,this._layout.mantissa_x+i,this._layout.mantissa_y+n),e.fillText(this._label.superscript,this._layout.superscript_x+i,this._layout.superscript_y+n)):(e.strokeText(this._label.string,this._layout.mantissa_x+i,this._layout.mantissa_y+n),e.fillText(this._label.string,this._layout.mantissa_x+i,this._layout.mantissa_y+n)),e.restore()}static computeBaselineFromCenter(e,t){return e+.272*t}static setCtxFontSize(e,t){e.font=t+"px Arial",e.textAlign="center"}};function zxe(r,e){if(r.superscript){let t=e;Xa.setCtxFontSize(Mh,t);let o=Mh.measureText(r.mantissa).width,i=Math.round(.8*e);Xa.setCtxFontSize(Mh,i);let n=Mh.measureText(r.superscript).width,a=0,s=e/5,c=o/2+n/2,d=-e/4,p=d-i/2,u=s+t/2,g=a-o/2,h=c+n/2;return{top:p,bottom:u,left:g,right:h,mantissa_height:t,mantissa_width:o,mantissa_x:a,mantissa_y:s,superscript_height:i,superscript_width:n,superscript_x:c,superscript_y:d}}else{let t=e;Xa.setCtxFontSize(Mh,e);let o=Mh.measureText(r.string).width,i=0,n=0,a=n-t/2,s=n+t/2,c=i-o/2,d=i+o/2;return{top:a,bottom:s,left:c,right:d,mantissa_height:t,mantissa_width:o,mantissa_x:i,mantissa_y:n}}}function qxe(r,e,t,o){let i=Math.ceil(r/t),n=Math.floor(e/t),a=1/t;if(!(i>n)&&!(n-i>1e4))for(let s=i;s<=n;s++)o(s/a)}var jU={base:10,major:[1,2,5],minor:[5,4,5]},Hxe={base:10,major:[Math.PI,2*Math.PI,5*Math.PI],minor:[4,4,5]},Wxe={base:2,major:[Math.PI/3],minor:[3]};function jxe(r){return r?{base:10,major:[r,2*r,5*r],minor:[4,4,5]}:jU}function XU(r,e){let{major:t,minor:o,base:i}=e,n=1/0,a=1/0;for(let s=0;s<t.length;s++){let c=t[s],d=Math.ceil(Math.log(r/c)/Math.log(i)),p=c*Math.pow(i,d);if(p<n){n=p;let u=o[s];a=n/u}}return{major:n,minor:a}}function Xxe(r,e,t){return 1+(e-r)/t}function gQ(r){let e=r.screen.width,t=r.screen.height,o=r.viewport.xmax-r.viewport.xmin,i=r.viewport.ymax-r.viewport.ymin,n=r.settings.pixelsPerLabel;return{majorStepX:n/e*o,majorStepY:n/t*i}}function zl(r){let e=c=>{let[d,p,u,g,h]=c==="x"?[r.viewport.xmin,r.viewport.xmax,r.settings.xAxisStep,r.settings.xAxisNumbers,r.settings.xAxisMinorSubdivisions]:[r.viewport.ymin,r.viewport.ymax,r.settings.yAxisStep,r.settings.yAxisNumbers,r.settings.yAxisMinorSubdivisions],b=p-d,v=Math.abs(u!=null?u:NaN),T=0,E=0;if(v&&v!==Math.PI){let I=Xxe(d,p,v);if(I>=3&&I<100){let _=0;if(g){let D=0;qxe(d,p,v,P=>{let F=new Xa(__dcg_shared_module_exports__['nb'](P,b),r.settings.labelSize);D=Math.max(F.getDimensionAlongAxis(c),D)}),_=D+10}else _=h===1?8:20;let C=c==="x"?"width":"height";I*_<=r.screen[C]&&(T=v,v===3||v===5?E=1:E=v/4)}}if(!T){let I=gQ(r)[c==="x"?"majorStepX":"majorStepY"],_=XU(I,__dcg_shared_module_exports__['nb'](v,b).string.indexOf("\u03C0")>=0?I>=1?Hxe:Wxe:jxe(v));T=_.major,E=_.minor}return{majorStep:T,minorStep:E}},t=()=>{var c,d;if(Math.abs((c=r.settings.xAxisStep)!=null?c:NaN)===Math.abs((d=r.settings.yAxisStep)!=null?d:NaN)){let{xmin:g,xmax:h,ymin:b,ymax:v}=r.viewport,T=r.screen.width/(h-g),E=r.screen.height/(v-b),I=T/E,_=.01;if(I>=1-_&&I<=2){let{majorStep:C,minorStep:D}=e("y");return{x:{majorStep:C,minorStep:D},y:{majorStep:C,minorStep:D}}}if(I<=1-_&&I>=.5){let{majorStep:C,minorStep:D}=e("x");return{x:{majorStep:C,minorStep:D},y:{majorStep:C,minorStep:D}}}}return{x:e("x"),y:e("y")}},o=()=>{let{xAxisScale:c,yAxisScale:d}=r.settings,p=c==="logarithmic",u=d==="logarithmic";return!p&&!u?t():{x:p?{majorStep:NaN,minorStep:NaN}:e("x"),y:u?{majorStep:NaN,minorStep:NaN}:e("y")}},{x:i,y:n}=o(),{xAxisMinorSubdivisions:a=0,yAxisMinorSubdivisions:s=0}=r.settings;return{majorStepX:i.majorStep,minorStepX:a>0?i.majorStep/a:i.minorStep,majorStepY:n.majorStep,minorStepY:s>0?n.majorStep/s:n.minorStep}}function mQ(r){let e=gQ(r),t=XU(e.majorStepX,jU),o=XU(e.majorStepY,jU),i=t.major>o.major?t:o;return{majorStepR:i.major,minorStepR:i.minor}}var ty=class{constructor(){this.displayNameKey="graphing-calculator-text-geometry-tool-box-selection-display-name";this.toolType="selection";this.icon=[{type:"stroked-path",color:"#aaa",path:[35,35,51,35,51,51,35,51,35,35]},{type:"filled-polygon",color:"#000",path:[50,50,63.5,62,58.25,62.75,62,72.5,59.75,74,55.25,64.25,50.75,68,50,50]}]}getNumberInputLatex(){return""}clearTentativeOutputs(){}canNextInputBePoint(){return!1}getAllValidNextInputTypes(){return __dcg_shared_module_exports__['na'].filter(e=>this.isValidNextInputType(e))}isValidNextInputType(e){return e!==__dcg_shared_module_exports__['W']}getNonPointInputType(){}getHint(){return""}getExpressionEditHint(e){return this.getHint()}onNumberInput(e){}onMove(e){return!0}onFocus(e){}tryCommitResults(){return{committed:void 0}}shouldUseJitEdges(){return!1}shouldHighlightRelevantObjects(){return!1}};function fQ(r,e){return r===void 0?e===void 0:!(e===void 0||r.calcId!==e.calcId||r.listIndex!==e.listIndex||r.polygonEdge!==e.polygonEdge)}var hL=class{constructor(e){this.poiController=e,this.controller=e.controller,this.grapher=e.manager}getKeyboardAttention(){return this.objectUnderAttention}setKeyboardAttention(e){this.objectUnderAttention=e}findNonGeometryTabTargetsInGraph(){let e=this.controller.getGrapher3d();if(e)return e.getOrderedTabTargets();let t=this.grapher.imageLayer.getOrderedTabTargets(),o=this.grapher.clickableObjectsLayer.getOrderedTabTargets(),i=this.grapher.movablePointsLayer.getOrderedTabTargets();return t.concat(o).concat(i)}findTabbableObjectsForCurrentTool(e){let t=e==null?void 0:e.calcId,o={},i=this.controller.getGeoModel().getCurrentTool();if((!this.controller.isGeometry()||i.isValidNextInputType(__dcg_shared_module_exports__['A']))&&this.findNonGeometryTabTargetsInGraph().filter(u=>!(i instanceof ty&&this.controller.isClickableId(u.calcId))).forEach(u=>{var h;let g=(h=u.listIndex)!=null?h:0;if(!o[u.calcId])o[u.calcId]=[];else if(g&&!(!this.controller.isGeometry()||this.controller.canExpandListForItem(u.calcId)))return;o[u.calcId][g]?o[u.calcId][g].description=u.description:o[u.calcId].push(u)}),this.controller.isGeometry()){let p=this.controller.getGeoModel();p.getAllChoosableDefsUnordered({mode:"tab"},p.getCurrentTool()).filter(g=>!o[g.calcId]).forEach(g=>{var b;o[g.calcId]||(o[g.calcId]=[]);let h={calcId:g.calcId,listIndex:g.listIndex,polygonEdge:(b=g.polygonEdgeInfo)==null?void 0:b.edgeNumber,geoDef:{...g}};o[g.calcId].push(h)})}let n=[],a=-1,s=!1,c=this.controller.getGrapher3d(),d=c?c.getTabOrder():this.grapher.getTabOrder();for(let p of d){p===t&&(a=n.length);let u=o[p];if(u){u.sort((g,h)=>g.listIndex!==h.listIndex?g.listIndex===void 0?-1:h.listIndex===void 0?1:g.listIndex-h.listIndex:g.polygonEdge!==h.polygonEdge?g.polygonEdge===void 0?-1:h.polygonEdge===void 0?1:g.polygonEdge-h.polygonEdge:0);for(let g of u)p===t&&(s||(a=n.length),fQ(g,e)&&(s=!0)),n.push(g)}}return{targets:n,currentTabIndex:a,currentIsTabbable:s}}findNextObjFromKeyboard(e,t){let{targets:o,currentIsTabbable:i,currentTabIndex:n}=this.findTabbableObjectsForCurrentTool(t);if(!o.length)return;if(n===-1)return e==="next"?{wrapped:!1,target:o[0]}:{wrapped:!1,target:o[o.length-1]};let a=!1,s=n;return e==="prev"?s-=1:i&&(s+=1),s===-1?(a=!0,s=o.length-1):s>=o.length&&(a=!0,s=0),{wrapped:a,target:o[s]}}focusNextObjFromKeyboard(e={}){let t={allowWrapping:!0,selectNonClickables:!1,direction:"next"},{direction:o,allowWrapping:i,selectNonClickables:n}={...t,...e},a=this.findNextObjFromKeyboard(o,this.getKeyboardAttention());return!a||!i&&a.wrapped?(n&&this.controller.dispatch({type:"set-none-selected"}),!1):(a.wrapped&&this.controller.isVirtualMouseAllowed()?this.resetBackToGeoKeyboardPt():(n&&(this.controller.isClickableId(a.target.calcId)||!this.controller.isGeoItem(a.target.calcId)?this.controller.dispatch({type:"set-none-selected"}):this.controller.dispatch({type:"set-selected-id",id:a.target.calcId,state:"selected"})),this.updateKeyboardAttention(a.target,{describe:!0})),!0)}updateKeyboardAttention(e,t){let o=this.getKeyboardAttention();fQ(e,o)||(this.setKeyboardAttention(e),this.controller.isGeometry()&&this.controller.getGeoModel().onFocus(e==null?void 0:e.geoDef),this.poiController.moveGeoKeyboardPtToFocusedItem(t),t.describe&&this.poiController.describeFocusedItem({includeDetails:!0}))}clearAttentionIfNotTabbable(){let{currentIsTabbable:e}=this.findTabbableObjectsForCurrentTool(this.getKeyboardAttention());e||this.updateKeyboardAttention(void 0,{describe:!1})}handleGrapherGainedFocus(){if(this.controller.getGeoModel().speakCurrentGeoToolHint(),this.controller.isVirtualMouseAllowed())this.resetBackToGeoKeyboardPt();else{let t=this.findTabbableObjectsForCurrentTool(void 0).targets;t.length?(this.setKeyboardAttention(void 0),this.updateKeyboardAttention(t[0],{describe:!0})):_e(this.controller.s("graphing-calculator-narration-geometry-no-tool-inputs"))}}resetBackToGeoKeyboardPt(){this.updateKeyboardAttention(void 0,{describe:!0}),this.poiController.geoKeyboardPt.x=this.poiController.geoKeyboardPt.lastArrowedX,this.poiController.geoKeyboardPt.y=this.poiController.geoKeyboardPt.lastArrowedY,this.poiController.handleGeoKeyboardPtMove()}};function gL(r){if(!r)return 0;if(r.type==="image"&&r.listIndex)return r.listIndex;if("poi"in r)return r.poi.pointIdxOnBranch;if("branchInfo"in r&&r.branchInfo.sketch){let e=r.branchInfo.branch,t=r.branchInfo.sketch.branches[e];return"listIndex"in t&&t.listIndex||0}return 0}var Jxe=0,pw=class r{constructor(e,t){this.geoKeyboardPt={x:NaN,y:NaN,lastArrowedX:NaN,lastArrowedY:NaN};this.canceledGeoToolplayWhilePressed=!1;this.manager=e,this.controller=e.controller,this.keyboardAttentionManager=new hL(this),this.graphSettings=t,this.elt=this.manager.elt,this.id=Jxe++,this.graphSettings.config.observe("disableMouseInteractions",()=>{this.graphSettings.config.disableMouseInteractions?this.removeHandlers():this.graphSettings.config.graphpaper&&this.addHandlers()}),this.speakThrottledDescription=__dcg_shared_module_exports__['Za'](o=>{_e(po(o))},100,{leading:!1,trailing:!0}),!(!this.graphSettings.config.graphpaper||this.graphSettings.config.disableMouseInteractions)&&this.addHandlers()}remove(){this.removeHandlers()}addHandlers(){this.addTouchEventHandlers(),this.addHoverEventHandler(),this.addKeyboardEventHandlers(),this.addManualUnhoverListener(),this.addGeoEventHandlers()}removeHandlers(){this.removeAllGlobalMouseListeners(),this.removeManualUnhoverListener(),this.removeAllGeoListeners(),this.removeHoverEventHandler(),this.removeElementListeners()}removeElementListeners(){re(this.elt).off("touchstart"),re(this.elt).off("dcg-tapstart"),re(this.elt).off("mouseleave"),re(this.elt).off("keydown")}addGlobalMouseListener(e,t){let o=e.split(" ");for(let i of o){let n=i+".dcg-poiController-"+this.id;re(document).on(n,t)}}removeAllGeoListeners(){re(document).off(".dcg-poiController-geo-"+this.id)}removeAllGlobalMouseListeners(){re(document).off(".dcg-poiController-"+this.id)}getToleranceByDevice(e){return e==="touch"?20:10}addGeoEventHandlers(){re(document).on("mouseleave.dcg-poiController-geo-"+this.id,()=>{var e;if(this.controller.isGeoToolActive()&&!((e=this.pointerState)!=null&&e.isPressed)){let t=this.controller.getGeoModel();t.onMouseAction("move",{pt:{x:NaN,y:NaN},shift:!1,tolerance:0}),t.onPreviewChange()}}),re(document).on("dcg-tapend.dcg-poiController-geo-"+this.id,e=>{var i;let t=!!((i=this.pointerState)!=null&&i.isPressed),o=this.updatePointerState(e);this.controller.isGeoToolActive()&&t&&this.handleGeoTapEnd(o,e)})}removeHoverEventHandler(){re(document).off(".dcg-poiController-global-hover-"+this.id)}addHoverEventHandler(){let e="dcg-tapmove.dcg-poiController-global-hover-"+this.id;re(document).on(e,t=>this.handleTapmove(t))}handleTapmove(e){var P;let t=this.updatePointerState(e);if(this.controller.isGeoToolActive()&&this.handleGeoTapMove(t)||e.device==="touch")return;let o=document.elementFromPoint(e.clientX,e.clientY),i=!!o&&!!o.closest(".dcg-grapher"),n=!!o&&!!o.closest(".dcg-label"),a=!!o&&!!o.closest(".dcg-opened"),s=n&&!a,c=(P=this.controller.getGrapher3d())==null?void 0:P.webglLayer,d=this.manager.poiLabelsLayer,p=this.getMouseRelativeToGrapher(e),u=this.getToleranceByDevice(e.device);c&&(c==null||c.setMouse(i?p:void 0));let g;i&&!n&&(g=this.getFeatureUnderPoint(p,u)),!!((e==null?void 0:e.originalEvent)||e).buttons&&(g=void 0);let h;if(g&&g.type==="movable-point"){let F=g.poi,N=F&&F.getMovablePoint();h=N&&N.id}let b,v=0;g&&g.isClickable&&!this.isBoxSelectActive(e)&&!this.manager.movablePointsLayer.isMovingPoint()&&!this.manager.traceLayer.isTracing()&&(b=g.model,v=gL(g));let T=this.manager.clickableObjectsLayer,E={};b&&(E[b.id]={listIndexes:v===void 0?void 0:{[v]:!0}}),T.setHoveredObjects(E);let I;g&&"poi"in g&&g.poi&&(!g.poi.isAttachedToPlottedPoint()||g.poi.hasInteractiveLabel())&&(I=g.poi);let _=!I&&s;I!==d.getHoveredPOI()&&!_&&(this.controller.isTraceEnabled()?d.setHoveredPOI(I):d.setHoveredPOI(void 0),this.controller.requestRedrawGraph());let C=!1;if(g&&g.type==="image"){let F=td(g.model),N=g.isClickable;C=F&&!N}let D=!1;g&&g.type==="draggable-label"&&(D=!0),C||D?this.manager.setLayerClass("extraMoveCursor","dcg-mouse-over-movable-point"):this.manager.setLayerClass("extraMoveCursor",""),this.manager.movablePointsLayer.setHoveredPointId(h)}addManualUnhoverListener(){let e=()=>{let t=this.manager;t.poiLabelsLayer.setHoveredPOI(void 0),t.clickableObjectsLayer.setHoveredObjects({}),this.controller.requestRedrawGraph()};re(window).on("blur.dcg-poiController-"+this.id,e),re(this.elt).on("mouseleave",e)}removeManualUnhoverListener(){re(window).off(".dcg-poiController-"+this.id)}getPickResults(e,t){let o=t.webglLayer,{x:i,y:n}=this.getMouseRelativeToGrapher(e);return o.setMouse({x:i,y:n}),o.pickAtMouseAndReadResults(),o.getPickResult()}isClickable(e){let t=this.controller.getItemModel(e);return Rv(t)}add3DTouchEventHandlers(e){let t=e.elt;if(!t)return;let o=e.webglLayer;re(t).on("dcg-tapstart",i=>{if(i.touches.length>1)return;let n=this.getPickResults(i,e);if(n!=null&&n.id){let{id:a,index:s}=n;this.isClickable(a)?(o.setPressedAction({id:a,index:s}),i.stopPropagation(),i.preventDefault()):this.controller.dispatch({type:"set-selected-id",id:a,state:"selected"})}}),re(t).on("dcg-tapend dcg-tapcancel",()=>{let i=o.getPressedAction();i&&(o.setPressedAction(void 0),this.controller.dispatch({type:"clickable-item-clicked",id:i.id,listIndex:i.index})),o.isTrackingPressedAction=!1}),re(t).on("dcg-tapmove",i=>{if(o.isTrackingPressedAction){let n=this.getPickResults(i,e);if(n!=null&&n.id){let{id:a,index:s}=n;this.isClickable(a)?o.setPressedAction({id:a,index:s}):o.setPressedAction(void 0)}else o.setPressedAction(void 0)}})}addTouchEventHandlers(){re(this.elt).on("touchstart",e=>this.handleTouchstart(e)),re(this.elt).on("dcg-tapstart",e=>this.handleTapstart(e))}handleTouchstart(e){if(!this.isViewportLocked()){e.target.matches("input, textarea")||e.preventDefault();return}let t=this.getMouseRelativeToGrapher(e),o=this.getToleranceByDevice(e.device),i=this.getFeatureUnderPoint(t,o);i&&(i.type==="image"&&!Mn(i.model)&&!td(i.model)||i.type==="sketch-branch"&&this.graphSettings.config.onlyTraceSelected&&!i.sketch.selected||e.target.matches("input, textarea")||e.preventDefault())}handleTapstart(e){let t=this.updatePointerState(e);if(this.controller.isGeoToolActive()&&this.handleGeoTapStart(t,e)){Xt(e);return}if(e.target.closest(".dcg-label")){Xt(e,"do-not-clear-poi-labels");return}let o=this.getMouseRelativeToGrapher(e),i=this.getToleranceByDevice(e.device),n=this.getFeatureUnderPoint(o,i);if(!n){this.isBoxSelectActive(e)||this.controller.dispatch({type:"set-none-selected"}),this.isBoxSelectActive(e)?this.startBoxSelect(e):this.manager.viewportController.beginPanning(e);return}if(n.isClickable&&!this.isBoxSelectActive(e)){let p="model"in n&&n.model;p?this.manager.clickableObjectsLayer.setPressedObject({id:p.id,listIndex:gL(n)}):this.manager.clickableObjectsLayer.setPressedObject(void 0)}else this.manager.clickableObjectsLayer.setPressedObject(void 0);if(n.type==="editable-label"){Xt(e);return}else Dr();if(n.type==="draggable-label"){this.startMovingPoints({poiUnderMouse:void 0,evt:e,points:[{type:"draggable-label",label:n.label,model:n.model,startScreenPt:o}],originalTargetObjectId:n.model.id}),Xt(e);return}if(n.type==="clickable-label"&&Xt(e),n.type==="image"&&td(n.model)&&!this.isBoxSelectActive(e)){let p=!!n.isClickable;if(this.startMovingPoints({poiUnderMouse:void 0,evt:e,points:[{type:"image",image:n.model,startScreenPt:o,shouldDelayUntilRealMove:p}],originalTargetObjectId:n.model.id}),!p){Xt(e);return}}let a=!1,s=n.model;if(this.controller.isGeometry()&&s&&s.type==="expression"&&s.formula.geometry){let p;"poi"in n&&(p=n.poi),a=this.startReverseDrag(s.id,e,p),a&&n.type!=="static-point"&&this.manager.clickableObjectsLayer.setPressedObject({id:s.id,listIndex:gL(n)}),!a&&n.isClickable&&this.controller.dispatch({type:"set-none-selected"})}if(n.type==="movable-point"&&(Xt(e),Xt(e,"do-not-clear-poi-labels"),!a)){this.startMovingPoints({poiUnderMouse:n.poi,evt:e,points:[{type:"poi",poi:n.poi,startScreenPt:o}],originalTargetObjectId:n.sketch.id});return}if(!a&&this._togglePOIUnderPoint(n)){Xt(e),Xt(e,"do-not-clear-poi-labels");return}if(!a&&n.type==="sketch-branch"&&!n.isClickable){let p=!this.controller.isTraceEnabled();if(this.graphSettings.config.onlyTraceSelected){if(Xt(e,"do-not-clear-poi-labels"),!p&&this.controller.getItemSelectedState(n.model.id)==="selected"&&!this.isBoxSelectActive(e)){this.startTracingBranch(n,o),Xt(e);return}}else{let u=!this.controller.isListEnabled();if(p&&u||(this.selectItemIfNotSecret(n.model.id,{multiSelect:this.isBoxSelectActive(e),tentative:!1}),p))return;this.startTracingBranch(n,o),Xt(e),Xt(e,"do-not-clear-poi-labels");return}}(this.controller.shouldShowMultiSelectHeader()?"multi-select":"default")==="default"&&a||this.selectFeatureUnderMouse(n,{multiSelect:this.isBoxSelectActive(e),tentative:!0});let d=!1;this.addGlobalMouseListener("dcg-tapmove",p=>{d=!0,this.manager.clickableObjectsLayer.isAnObjectPressed()?o=this.getMouseRelativeToGrapher(p):a||(this.removeAllGlobalMouseListeners(),this.controller.isGeometry()&&(this.controller.dispatch({type:"clear-tentative-selection"}),this.addGlobalMouseListener("dcg-tapend",u=>{this.removeAllGlobalMouseListeners(),this.shouldTreatSmallDragAsClick(e,u)&&this.selectFeatureUnderMouse(n,{multiSelect:this.isBoxSelectActive(u),tentative:!1})})),this.manager.viewportController.beginPanning(p))}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",p=>{this.removeAllGlobalMouseListeners();let u=this.manager.clickableObjectsLayer.getPressedObject(),g=u&&u.id;this.manager.clickableObjectsLayer.setPressedObject(void 0);let h=this.getFeatureUnderPoint(o,i);if(h&&h.isClickable){let b="model"in h&&h.model;b&&b.id===g&&!jr(p,"dragged-clickable-object")&&!this.isBoxSelectActive(p)&&this.controller.dispatch({type:"clickable-item-clicked",id:b.id,listIndex:gL(h)});return}(!d||this.shouldTreatSmallDragAsClick(e,p))&&(this.controller.hasTentativeSelection()?this.controller.dispatch({type:"commit-tentative-selection"}):this.selectFeatureUnderMouse(h,{multiSelect:this.isBoxSelectActive(p),tentative:!1}))})}shouldTreatSmallDragAsClick(e,t){var a,s,c,d;let o=((a=t.clientX)!=null?a:NaN)-((s=e.clientX)!=null?s:NaN),i=((c=t.clientY)!=null?c:NaN)-((d=e.clientY)!=null?d:NaN),n=this.getToleranceByDevice(t.device);return Math.abs(o)<n&&Math.abs(i)<n}selectFeatureUnderMouse(e,t){var i;if(!e)return;let o=(i=e.model)==null?void 0:i.id;o&&(this.controller.isItemSelected(o)&&!t.multiSelect||this.controller.isItemSelected(o)&&t.tentative||e.type==="movable-point"&&!this.controller.isGeometry()||e.isClickable||this.selectItemIfNotSecret(o,t))}isBoxSelectActive(e){if(!this.controller.isMultiSelectEnabled())return!1;let t=this.controller.getActiveTool();return t==="selection"&&e.shiftKey||t==="box-selection"}isViewportLocked(){return this.controller.zoomAndPanDisabled()}addKeyboardEventHandlers(){let e=`dcg-poiController-${this.id}`;re(document).on(`keyup.${e} keydown.${e}`,t=>{this.handleShiftKeyChange(t.shiftKey)}),re(this.elt).on("keydown",t=>{var c,d,p;let o=t;if(this.manager.getAudioTrace().getAudioTraceActive())return;let i=this.manager.movablePointsLayer.getPOIUnderAttention(),n=this.manager.imageLayer.getFocusedImage(),a=Pe(o),s=Jr(o);if((a==="Up"||a==="Down"||a==="Left"||a==="Right")&&this.controller.isGraphPaperFocused()){o.stopPropagation(),o.preventDefault();let u=this.keyboardAttentionManager.getKeyboardAttention(),g=this.controller.getActiveTool();if(!u&&(g==="selection"||g==="box-selection")&&!o.altKey&&!o.ctrlKey&&!o.metaKey&&!o.shiftKey){this.manager.viewportController.panFromKeyboard(a);return}else if(u&&this.controller.shouldAllowMovingPointsWithKeyboard()){let h=n?n.centerId:u.calcId;if(!h)return;let b=this.getDraggablePointOrAncestors(h,o);this.movePointsFromKeyboard(b,o),this.controller.getEvaluator().notifyWhenSynced(()=>{this.describeFocusedItem({includeDetails:!0})})}else this.controller.isVirtualMouseAllowed()&&(this.keyboardAttentionManager.updateKeyboardAttention(void 0,{describe:!1}),this.moveGeoPointFromKeyboard(o))}else if(a==="Tab"&&this.controller.isGraphPaperFocused()){let u=o.shiftKey?"prev":"next",g=this.keyboardAttentionManager.getKeyboardAttention();if(!(this.controller.getActiveTool()!=="selection")&&!g&&u==="prev")return;this.handleTabEvent(u,o)}else if((a==="Enter"||a==="Space")&&this.controller.isGraphPaperFocused()&&this.controller.getActiveTool()==="selection"){let u=this.keyboardAttentionManager.getKeyboardAttention();if(u){let g=this.controller.getItemModel(u.calcId);if(g&&!this.isBoxSelectActive(o)){let h=g.type==="expression"&&Jn(g),b=g.type==="image"&&ob(g);h||b?(this.lastClickedKeyboardAttention=u,this.lastClickedDescription=tl(g,u.listIndex),this.controller.dispatch({type:"clickable-item-clicked",id:u.calcId,listIndex:u.listIndex})):(this.lastClickedKeyboardAttention=void 0,this.lastClickedDescription=void 0)}}o.preventDefault(),o.stopPropagation();return}else if(this.controller.isGeometry()&&this.controller.isGraphPaperFocused()){let u=!1;if(o.ctrlKey&&o.shiftKey&&!o.altKey&&!o.metaKey){let g;if(s==="O"?g={type:"multi-select-more",guid:ey(),focusFirstOption:!0,previousFocusLocation:{type:"graph-paper"}}:s==="A"&&(g={type:"multi-select-construct",guid:a_(),focusFirstOption:!0,previousFocusLocation:{type:"graph-paper"}}),g){o.preventDefault(),o.stopPropagation();let h=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getActiveTool()!=="box-selection"&&h&&this.controller.getItemModel(h.calcId)&&this.controller.dispatch({type:"set-selected-id",id:h.calcId,state:"selected"}),this.controller.dispatch({type:"toggle-item-settings-menu",menu:g})}}else if(!o.altKey&&!o.ctrlKey&&!o.metaKey){if(a==="Enter"||a==="Space")if(o.preventDefault(),this.controller.getActiveTool()!=="selection"&&o.stopPropagation(),this.controller.getActiveTool()==="box-selection"){let g=((c=this.keyboardAttentionManager.getKeyboardAttention())==null?void 0:c.calcId)||"";this.controller.isClickableId(g)&&(g=""),this.selectItemIfNotSecret(g,{multiSelect:!0,tentative:!1}),this.describeFocusedItem({includeDetails:!1})}else{let g=this.keyboardAttentionManager.getKeyboardAttention();this.activateGeoObjectFromKeyboard(g,o)}else if(s==="?")o.preventDefault(),o.stopPropagation(),this.controller.getGeoModel().speakCurrentGeoToolHint();else if(s==="D")o.preventDefault(),o.stopPropagation(),this.describeFocusedItem({includeDetails:!0});else if(a==="Backspace"||a==="Del"){o.preventDefault(),o.stopPropagation();let g=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getActiveTool()!=="box-selection"&&g&&this.controller.getItemModel(g.calcId)&&this.controller.dispatch({type:"set-selected-id",id:g.calcId,state:"selected"}),this.controller.dispatch({type:"delete-all-selected-items"}),u=!0}else if(s==="-"||s==="="){o.preventDefault(),o.stopPropagation();let g=this.controller.getAllVisibleGeoToolbarItems(),h=g.findIndex(b=>(b==null?void 0:b.current)===this.controller.getActiveTool());for(let b=1;b<g.length;b++){let v=h+(s==="-"?-b:b);v<0&&(v=g.length+v),v>g.length-1&&(v=v-g.length);let T=(d=g[v])==null?void 0:d.current;if(this.selectGeoTool(T)){u=!0;break}}}else if(s==="["||s==="]"){o.preventDefault(),o.stopPropagation();let h=this.controller.getAllVisibleGeoToolbarItems().find(T=>(T==null?void 0:T.current)===this.controller.getActiveTool());if(!h)return;let b=h.dropdown||[h.current];if(b.length===0)return;let v=b.indexOf(h.current);for(let T=1;T<b.length;T++){let E=v+(s==="["?-T:T);E<0&&(E=b.length+E),E>b.length-1&&(E=E-b.length);let I=b[E];if(this.selectGeoTool(I)){u=!0;break}}}else if(!o.shiftKey&&s!==void 0&&s>="0"&&s<="9"){let g=(p=this.controller.getAllVisibleGeoToolbarItems()[o.which-49])==null?void 0:p.current;u=this.selectGeoTool(g)}}u&&this.handleGeoKeyboardPtMove()}else i&&(s==="X"||s==="Y"||s==="L"||s==="C")?this.speakPoint(i,s):n&&(s==="X"||s==="Y"||s==="L")&&this.manager.imageLayer.speakImageAttribute(n,s)})}selectGeoTool(e){return e?this.controller.isGeoToolEnabled(e)?(this.controller.dispatch({type:"select-geo-tool",tool:e}),!0):(_e(this.controller.s("graphing-calculator-narration-geometry-tool-disabled",{tool:this.controller.getGeoModel().getDisplayNameForTool(e)})),!1):!1}getMouseRelativeToGrapher(e){let t=this.elt.getBoundingClientRect(),o=e.touches?e.touches[0]:e,i=o.clientX-t.left,n=o.clientY-t.top;return{x:i,y:n}}_getStyledPointRadiusAdjustments(){return{radiusMultiplier:this.graphSettings.getHighlightPropertyMultiplier("pointLineWidth",!1),selectedRadiusMultiplier:this.graphSettings.getHighlightPropertyMultiplier("pointLineWidth",!0)}}_getStyledPointRadiusForPOI(e,t){let o=e.getPointSize()/2,i=e.isSelected()?t.selectedRadiusMultiplier:t.radiusMultiplier;return o*i}handleTabEvent(e,t){let o=this.controller.getActiveTool()!=="selection";if(this.keyboardAttentionManager.focusNextObjFromKeyboard({direction:e,allowWrapping:o,selectNonClickables:this.controller.getActiveTool()==="selection"})){t==null||t.preventDefault(),t==null||t.stopPropagation();return}else if(!o){this.keyboardAttentionManager.updateKeyboardAttention(void 0,{describe:!1}),e==="prev"&&(t==null||t.preventDefault(),t==null||t.stopPropagation(),this.manager.speakGrapherFocusAriaLabel());return}}_getDistanceFromStyledPOI(e,t){let o=this._getStyledPointRadiusForPOI(e,t.adjustments),i=Math.max(0,t.tolerance-o),n=t.projection.map_pt(e),a=__dcg_shared_module_exports__['k'](n.x-t.screenPt.x,n.y-t.screenPt.y),s=Math.max(0,a-o);if(s<=i)return s}_getClosestPoint(e,t,o){let i=1/0,n,a={projection:this.manager.getProjection(),adjustments:this._getStyledPointRadiusAdjustments(),screenPt:t,tolerance:o};for(let s of e){let c=this._getDistanceFromStyledPOI(s,a);c!==void 0&&c<=i&&(i=c,n=s)}return n}getViewportAsRect(){let e=this.controller.getGrapher2d().viewportController.getViewport();return{left:e.xmin,right:e.xmax,bottom:e.ymax,top:e.ymin}}findIdsThatAreOnscreen(){return this.findIdsThatIntersectBox(this.getViewportAsRect(),{ignoreClickables:!1})}findIdsThatIntersectBox(e,t){let o={};for(let i of this.manager.generateMergeDrawOrder()){let n=this.controller.getItemModel(i);if(n&&!this.controller.shouldIgnoreGraphInteractions(n)){if(n.type==="expression"){let a=this.manager.getGraphSketch(i);if(!a||Jn(n)&&t.ignoreClickables||this.controller.isItemNotSelectableBecauseItsSecret(i))continue;let s=a.branches;if(!s||!s.length)continue;for(let c=0;c<s.length;c++)if(this.doesBoxIntersectBranch(s[c],e)){o[n.id]=!0;break}}else if(n.type==="image"){let a=this.manager.getGraphImage(i);if(!a)continue;r.doesBoxIntersectAnyImage(a,e)&&(o[n.id]=!0)}}}return this.manager.poiDotsLayer.getDrawnPOI().forEach(i=>{let n=i.sketch.id,a=this.controller.getItemModel(n);a&&this.controller.shouldIgnoreGraphInteractions(a)||(a==null?void 0:a.type)==="expression"&&Jn(a)&&t.ignoreClickables||this.controller.isItemNotSelectableBecauseItsSecret(n)||i.isBareLabel()||(i.isMovable()||i.isAttachedToPlottedPoint())&&r.doesBoxContainPoint(i,e)&&(o[n]=!0)}),o}_getStyledLineAdjustments(){return{thicknessMultiplier:this.graphSettings.getHighlightPropertyMultiplier("graphLineWidth",!1),selectedThicknessMultiplier:this.graphSettings.getHighlightPropertyMultiplier("graphLineWidth",!0)}}_getStyledLineThicknessForBranch(e,t,o){let i=Math.max(0,"lineWidth"in e&&e.lineWidth||0)/2;return t?i*o.selectedThicknessMultiplier:i*o.thicknessMultiplier}_getDistanceFromStyledBranch(e,t,o,i){let n=this._getStyledLineThicknessForBranch(e,t,i.adjustments),a=this.calculateDistanceFromBranch(e,i.screenPt,i.projection,o),s=Math.max(0,a-n),c=Math.max(0,i.tolerance-n);if(s<=c)return s}getLabelUnderPoint(e){let t=this.manager.poiLabelsLayer.getInteractiveLabelUnderPoint(e);if(t&&!this.controller.shouldIgnoreGraphInteractions(t.model))switch(t.type){case"editable":return{type:"label",stackingContext:-1/0,stackingLayer:t.layerNumber,distance:0,label:{type:"editable-label",model:t.model,isClickable:void 0}};case"draggable":return{type:"label",stackingContext:-1/0,stackingLayer:t.layerNumber,distance:0,label:{type:"draggable-label",label:t.label,model:t.model,isClickable:void 0}};case"clickable":return{type:"label",stackingContext:-1/0,stackingLayer:t.layerNumber,distance:0,label:{type:"clickable-label",model:t.model,poi:t.poi,isClickable:!0}}}}getFeatureUnderPointInLayer(e,t,o,i){var u,g,h,b;let n,a=e.layer,s=e.drawOrder,c=this.manager.getProjection(),d={adjustments:this._getStyledLineAdjustments(),projection:c,screenPt:t,tolerance:o},p=1;for(let v=s.length-1;v>=0;v--){let T=s[v],E=this.controller.getItemModel(T),I=p;if(i[T]={layerNumber:a,stackingContext:I},!E){let _=this.manager.getGraphSketch(T),C=(g=(u=_==null?void 0:_.branches)==null?void 0:u[0])==null?void 0:g.tableId;if(C){let D=this.controller.getItemModel(C);(D==null?void 0:D.type)==="table"&&((h=D.regression)==null?void 0:h.id)===T&&(E=D)}}if(E&&!this.controller.shouldIgnoreGraphInteractions(E)){if(E.type==="expression"||E.type==="table"&&((b=E.regression)==null?void 0:b.id)===T){let _=this.manager.getGraphSketch(T);if(!_)continue;let C=_.branches;if(!C||!C.length)continue;if(_.hoistToTop&&!this.controller.isGeometry()&&(I=-1/0,i[T]={layerNumber:1/0,stackingContext:I}),!n||n.stackingContext>=I){let D=E.type==="table"?!1:Jn(E);for(let P=0;P<C.length;P++){let F=C[P],N=this._getDistanceFromStyledBranch(F,_.showHighlight,D,d);if(N!==void 0){let Y=!1;n?(I<n.stackingContext||I===n.stackingContext&&N<n.distance-3.5)&&(Y=!0):Y=!0,Y&&(n={type:"sketch-branch",model:E,sketch:_,distance:N,stackingContext:I,stackingLayer:a,branchInfo:{id:_.id,branch:P,sketch:_}})}}}}else if(E.type==="image"){let _=this.manager.getGraphImage(T);if(!_)continue;let C=this.getImageInfoUnderMouse(_,c.pixelsToMath.mapPoint(t),o);if(!C)continue;p+=1,I=p,i[T]={layerNumber:a,stackingContext:I},p+=1,(!n||n.stackingContext>I)&&(n={type:"image",model:_,distance:0,stackingContext:I,stackingLayer:a,listIndex:C.listIndex})}}}return n}getFeatureUnderPoint(e,t){var b;if(this.manager.scaleAxis)return;let o,i=this.getLabelUnderPoint(e);if(i){if(i.label.type==="editable-label")return i.label;o=i}let n={},a=this.manager.getDrawLayers();for(let v=a.length-1;v>=0;v--){let T=a[v],E=this.getFeatureUnderPointInLayer(T,e,t,n);E&&(o?E.stackingLayer>o.stackingLayer&&(o=E):o=E)}let s=[],c=[],d=[],p=[];this.manager.poiDotsLayer.getDrawnPOI().forEach(v=>{var I;if(v.isBareLabel())return;let T=v.sketch.id,E=this.controller.getItemModel(T);if(!(E&&this.controller.shouldIgnoreGraphInteractions(E))){if(!E&&v.sketch.branches.length>0){let _=v.sketch.branches[0].tableId,C=_!==void 0?this.controller.getItemModel(_):void 0,D=(C==null?void 0:C.type)==="table"&&lo(C,T);if(D&&this.controller.shouldIgnoreGraphInteractions(D))return}if(v.isMovable()){let _=E&&E.type==="expression"&&((I=E.formula.geometry)==null?void 0:I.call);(!o||o.stackingLayer<=n[v.sketch.id].layerNumber)&&(_&&_.symbol==="glider"?s.push(v):c.push(v))}else v.isAttachedToPlottedPoint()?(!o||o.stackingLayer<n[v.sketch.id].layerNumber||o.stackingLayer===n[v.sketch.id].layerNumber&&o.stackingContext>=n[v.sketch.id].stackingContext)&&d.push(v):p.push(v)}});let u=this._getClosestPoint(s,e,t);if(u||(u=this._getClosestPoint(c,e,t)),u)return{type:"movable-point",poi:u,isClickable:void 0,sketch:u.sketch,model:this.controller.getItemModel(u.sketch.id)};let g=this._getClosestPoint(p,e,t+2);if(g)return{type:"poi",poi:g,isClickable:!1,model:void 0};let h=this._getClosestPoint(d,e,t);if(h){let v=this.controller.getItemModel(h.sketch.id);return v&&v.type==="expression"&&Jn(v)?{type:"static-point",poi:h,sketch:h.sketch,isClickable:!0,model:v}:{type:"static-point",poi:h,isClickable:!1,sketch:h.sketch,model:v}}if(o){if(o.type==="label")return o.label;if(o.type==="sketch-branch"){let v,T;if(o.model.type==="table")T=!0,v=!1;else{v=Jn(o.model);let E=(b=o.model.formula.typed_constant_value)==null?void 0:b.valueType;T=!(this.controller.isGeometry()&&E&&__dcg_shared_module_exports__['ta'](E))}return{type:"sketch-branch",branchInfo:o.branchInfo,sketch:o.sketch,model:o.model,isClickable:v,isTraceable:T,isSelected:this.controller.isItemSelected(o.model.id),selectionId:this.controller.isItemSelectable(o.model.id)?o.model.id:void 0}}else if(o.type==="image")return{type:"image",model:o.model,isClickable:ob(o.model),listIndex:o.listIndex,isSelected:this.controller.isItemSelected(o.model.id),selectionId:this.controller.isItemSelectable(o.model.id)?o.model.id:void 0}}}_togglePOIUnderPoint(e){if(!this.controller.isTraceEnabled())return;if(e.isClickable)return!1;let t="poi"in e&&e.poi;return!t||t.isBareLabel()||this.controller.isGeometry()&&e.type==="static-point"&&!t.hasInteractiveLabel()?!1:(this.manager.poiLabelsLayer.isOpenPOI(t)?(this.manager.poiLabelsLayer.closePOI(t),this.manager.poiLabelsLayer.setHoveredPOI(void 0)):(this.manager.poiLabelsLayer.openPOI(t),this.speakPoint(t)),this.controller.requestRedrawGraph(),!0)}getImageInfoUnderMouse(e,t,o){if(!e)return;let i=e.formula;if(!i)return;let n=i.dimensions;if(!(!n.x||!n.y||!n.width||!n.height||!n.radianAngle||!e.shouldGraph))for(let a=n.x.length-1;a>=0;a--){let s=n.x[a],c=n.y[a],d=n.radianAngle[a],p=s+Math.cos(d)*(t.x-s)-Math.sin(d)*(t.y-c),u=c+Math.sin(d)*(t.x-s)+Math.cos(d)*(t.y-c),g=.5*Math.abs(n.width[a]),h=.5*Math.abs(n.height[a]);if(p>s-g&&p<s+g&&u>c-h&&u<c+h)return{listIndex:a}}}doesBoxIntersectBranch(e,t){let o=!1,i=!1;switch(e.graphMode){case 5:case 8:case 2:break;case 6:o=!0;break;case 1:i=!0;break;case 18:case 17:case 19:case 24:return RD(t,{x1:e.segments[0][0],y1:e.segments[0][1],x2:e.segments[0][2],y2:e.segments[0][3],extendStart:e.graphMode===18,extendEnd:e.graphMode!==17});case 20:return F$(t,{x:e.segments[0][0],y:e.segments[0][1],radius:e.segments[0][2]});case 21:case 23:{let[a,s]=e.segments[0],[c,d,p]=e.graphMode===21?this.getBoxIntersectArgsForArc(e):this.getBoxIntersectArgsForAngleMarker(e),u=(p-d)/2+d;return R$(t,{x0:a+c*Math.cos(d),y0:s+c*Math.sin(d),x1:a+c*Math.cos(u),y1:s+c*Math.sin(u),x2:a+c*Math.cos(p),y2:s+c*Math.sin(p)})}default:return!1}let n=e.segments;for(let a=0;a<n.length;a++){let s=n[a];if(o){let c=s;s=[];for(let d=0;d<c.length;d+=2){let p=c[d],u=c[d+1];s.push(u*Math.cos(p),u*Math.sin(p))}}else if(i){let c=s;s=[];for(let d=0;d<c.length;d+=2)s.push(c[d+1],c[d])}if(N$(t,s))return!0}return!1}getBoxIntersectArgsForArc(e){return[e.segments[0][2],e.segments[0][3],e.segments[0][4]]}getBoxIntersectArgsForAngleMarker(e){let t=e.segments[0][3],o=this.manager.getProjection(),i=tm(t,o),n=o.pixelsToMath.dangerouslyGetXScaleFactor(),a=o.pixelsToMath.dangerouslyGetYScaleFactor();return[Math.abs(Math.min(n,a))*i,e.segments[0][2],e.segments[0][2]+t]}static doesBoxIntersectAnyImage(e,t){let o=e.formula;if(!o)return;let i=o.dimensions;if(!(!i.x||!i.y||!i.width||!i.height||!i.radianAngle||!e.shouldGraph)){for(let n=i.x.length-1;n>=0;n--)if(FD(t,{width:i.width[n],height:i.height[n],angle:i.radianAngle[n],center:{x:i.x[n],y:i.y[n]}}))return!0;return!1}}static doesBoxContainPoint(e,t){return t.left<=e.x&&e.x<=t.right&&t.top<=e.y&&e.y<=t.bottom}calculateDistanceFromBranch(e,t,o,i){let n=this.controller.isGeometry()&&e.graphMode===7;if(i||n){let c=[t.x,t.y],d=UN(o,e);for(let p of d)if(__dcg_shared_module_exports__['v'](p,c))return 0}if(e.graphMode===7)return 1/0;let s=r.getBranchesDistanceInfo(e,t,o,i,this.controller.isGeometry());return s?s.minDistance:1/0}static getBranchesDistanceInfo(e,t,o,i,n){let a=t.x,s=t.y,{mathToPixels:c,pixelsToMath:d}=o;switch(e.graphMode){case 5:if(!n&&!i)return;break;case 8:if(!i)return;break;case 6:if(!i)return;break;case 2:case 1:break;case 23:{let[E,I,_,C]=e.segments[0],D=c.dangerouslyGetXScaleFactor(),P=c.dangerouslyGetYScaleFactor(),[F,N]=d.mapCoordinatePair([a,s]),Y=tm(C,o),z=Y/D,X=1/0,q=N-I,S=F-E,A=Math.atan2(q,S);if(__dcg_shared_module_exports__['i'](A,_,C))__dcg_shared_module_exports__['k'](q*P,S*D)<=Y+7&&(X=0);else{let O=__dcg_shared_module_exports__['n'](F,N,E+z*Math.cos(_),I+z*Math.sin(_),E,I),B=__dcg_shared_module_exports__['n'](F,N,E+z*Math.cos(_+C),I+z*Math.sin(_+C),E,I),V=__dcg_shared_module_exports__['k'](D*(O[0]-F),P*(O[1]-N)),K=__dcg_shared_module_exports__['k'](D*(B[0]-F),P*(B[1]-N));X=Math.min(V,K)}return{closestPoint:{x:a,y:s},minDistance:X,secondDistance:X}}break;case 18:case 17:case 19:case 24:{if(!e.segments.length)return null;let E=c.mapX(e.segments[0][0]),I=c.mapY(e.segments[0][1]),_=c.mapX(e.segments[0][2]),C=c.mapY(e.segments[0][3]),D=e.graphMode===18,P=e.graphMode===18||e.graphMode===19,F=__dcg_shared_module_exports__['o'](a,s,E,I,_,C,D,P);if(!F)return null;let N=__dcg_shared_module_exports__['k'](F[0]-a,F[1]-s);return{closestPoint:{x:F[0],y:F[1]},minDistance:N,secondDistance:N}}case 21:case 20:{let E=e.segments[0][0],I=e.segments[0][1],_=e.segments[0][2],C=e.graphMode===21?e.segments[0][3]:0,D=e.graphMode===21?e.segments[0][4]:Math.PI*2,P=__dcg_shared_module_exports__['p'](d.mapX(a),d.mapY(s),E,I,_,C,D);if(!P)return null;let F=c.mapCoordinatePair(P),N=__dcg_shared_module_exports__['k'](F[0]-a,F[1]-s);return{closestPoint:{x:F[0],y:F[1]},minDistance:N,secondDistance:N}}default:return}let p=1/0,u=1/0,g,h;for(let E=0;E<e.segments.length;E++){let I=e.segments[E];for(let _=0;_<I.length-3;_+=2){let C=I[_],D=I[_+1],P=I[_+2],F=I[_+3];if(e.graphMode===6){let O=D,B=C;C=O*Math.cos(B),D=O*Math.sin(B);let V=F,K=P;P=V*Math.cos(K),F=V*Math.sin(K)}e.graphMode===1&&([C,D]=[D,C],[P,F]=[F,P]);let[N,Y]=c.mapCoordinatePair([C,D]),[z,X]=c.mapCoordinatePair([P,F]),q=__dcg_shared_module_exports__['n'](0,0,N-a,Y-s,z-a,X-s),S=__dcg_shared_module_exports__['k'](q[0],q[1]);q[e.graphMode===1?1:0]<0?S<p&&(p=S,g=q):S<u&&(u=S,h=q)}}let b=p<u?g:h;if(!b)return;let v=b[0]+a,T=b[1]+s;return{closestPoint:{x:v,y:T},minDistance:Math.min(p,u),secondDistance:Math.max(p,u)}}static getBranchesTracePoint(e,t,o,i){let n,a=o.pixelsToMath.mapPoint(t);switch(e.graphMode){case 20:case 21:{let Y=e.graphMode===21?e.segments[0][3]:0,z=e.graphMode===21?e.segments[0][4]:Math.PI*2;n=__dcg_shared_module_exports__['p'](a.x,a.y,e.segments[0][0],e.segments[0][1],e.segments[0][2],Y,z);break}case 18:case 19:case 17:n=__dcg_shared_module_exports__['o'](a.x,a.y,e.segments[0][0],e.segments[0][1],e.segments[0][2],e.segments[0][3],e.graphMode===18,e.graphMode!==17);break}if(n)return{x:n[0],y:n[1]};if(!e)return;let s="compiled"in e&&e.compiled,c=s&&s.fn;if(!c)return;let d=this.getBranchesDistanceInfo(e,t,o,!1,i);if(!d)return;let{mathToPixels:p,pixelsToMath:u}=o,g,h;e.graphMode===2?(h="x",g="y"):(h="y",g="x",p=new __dcg_shared_module_exports__['jd'](p.yScale,p.xScale),u=p.inverse());let b=Math.pow(d.minDistance/d.secondDistance,2),v=d.closestPoint[h]*(1-b)+t[h]*b,T=.5,E=.5,I=p.mapY(c(u.mapX(v-T))),_=p.mapY(c(u.mapX(v))),C=p.mapY(c(u.mapX(v+T))),D=T*Math.min(1,E/Math.abs(I-_)),P=T*Math.min(1,E/Math.abs(C-_));isFinite(D)||(D=T),isFinite(P)||(P=T);let F=no(u.mapX(v-D),u.mapX(v+P)),N=c(F);if(!isFinite(p.mapY(N))){let Y=p.mapX(F)-T,z=p.mapX(F)+T,X=u.mapX(Y),q=u.mapX(z),S=c(X),A=c(q),O=p.mapY(S),B=p.mapY(A);Math.abs(O-t[g])<Math.abs(B-t[g])?N=S:N=A}return{x:e.graphMode===2?F:N,y:e.graphMode===2?N:F}}getPointInfo(e){switch(e.type){case"movable-point":case"static-labeled-point":return bQ(e);case"poi":return bQ(e.poi.getMovablePoint());case"movable-point-parent":return{calcId:e.id,isReverseDrag:!0};case"image":return{calcId:e.image.formula.center_reference_id,isReverseDrag:!1};case"draggable-label":return{calcId:e.model.id,isReverseDrag:!1};default:return e}}getDraggablePointOrAncestors(e,t){if(!this.controller.isGeometry()){let c=this.controller.getItemModel(e);if(c&&c.type==="expression"&&FM(c)){let d=G7(c);return d?co(c)===__dcg_shared_module_exports__['Gd'].NONE?[]:[{type:"movable-point-parent",id:e,shouldDelayUntilRealMove:!0,...d}]:[]}}let o=[e];(this.isBoxSelectActive(t)||this.controller.isItemSelected(e))&&o.push(...this.controller.getAllSelectedItems().map(c=>c.id).filter(c=>c!==e));let i=!1,n={},a=[];$b({controller:this.controller},(c,d)=>{if(!d&&c.typedRuntimeValue.valueType===__dcg_shared_module_exports__['C']&&c.data.isMovablePoint){let[p,u]=c.typedRuntimeValue.value;n[c.calcId]={id:c.calcId,value:{x:p,y:u}}}});let s=this.controller.getGeoModel().getComputedBoard().computeReversibilityLineages(o);for(let c in s){let d=n[c];if(!d){i=!0;break}a.push({type:"movable-point-parent",id:c,x:d.value.x,y:d.value.y,shouldDelayUntilRealMove:!0,transformations:s[c]})}return i?[]:a}getFeatureCenterMathPoint(e){switch(e.type){case"poi":return e.poi;case"movable-point-parent":let t={x:e.x,y:e.y};if(e.transformations){let o=__dcg_shared_module_exports__['pc'](e.transformations.forward,[t.x,t.y]);t={x:o[0],y:o[1]}}return t;case"image":return{x:e.image.formula.dimensions.x[0],y:e.image.formula.dimensions.y[0]};case"draggable-label":return{x:e.label.x,y:e.label.y}}}startReverseDrag(e,t,o){let i=this.getMouseRelativeToGrapher(t),n=this.getDraggablePointOrAncestors(e,t).map(a=>({...a,startScreenPt:i}));return n.length>0?(this.startMovingPoints({poiUnderMouse:o,evt:t,points:n,originalTargetObjectId:e}),!0):!1}startMovingPoints(e){let t=e.points,o=!1,i=t.map(this.getPointInfo),n=this.controller;function a(){o=!0,n.dispatch({type:"start-moving-points",points:i})}let s=!1;for(let g of t)if(g.shouldDelayUntilRealMove){s=!0;break}s||a();let c;e.poiUnderMouse&&e.poiUnderMouse.isMovable()&&(c=e.poiUnderMouse.getMovablePoint().id),this.manager.movablePointsLayer.setPressedPointId(c);let d=t.map(g=>{let h=this.manager.getProjection().map_pt(this.getFeatureCenterMathPoint(g));return{x:g.startScreenPt.x-h.x,y:g.startScreenPt.y-h.y}}),p,u=()=>{if(!p)return;this.shouldTreatSmallDragAsClick(e.evt,p)||this.controller.dispatch({type:"clear-tentative-selection"}),o||a();let g=this.manager.getProjection(),h=this.getMouseRelativeToGrapher(p);p=void 0,this.controller.dispatch({type:"on-move-points",points:t.map(this.getPointInfo),screenPts:d.map(b=>({x:h.x-b.x,y:h.y-b.y})),transform:t.map(b=>b.type==="movable-point-parent"?b.transformations:void 0),previousScreenPts:t.map(b=>b.startScreenPt),projection:g})};this.manager.registerMovablePointListener(u),this.addGlobalMouseListener("dcg-tapmove",g=>{p=g}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",g=>{u(),this.manager.deregisterMovablePointListener(),this.removeAllGlobalMouseListeners(),this.manager.movablePointsLayer.setPressedPointId(void 0),o&&(Xt(g,"dragged-clickable-object"),this.controller.dispatch({type:"stop-moving-points",points:t.map(this.getPointInfo)}))})}startTracingBranch(e,t){if(!e.isTraceable)return;let o=e.branchInfo;this.manager.markLabelsDirty(),this.lastScreenPt=t;let i=this.manager.getProjection(),a=o.sketch.branches[o.branch],s=r.getBranchesTracePoint(a,t,i,this.controller.isGeometry());s&&this.speakPoint(s),this.manager.traceLayer.setTraceInfo({pt:s,branchInfo:o}),this.controller.requestRedrawGraph(),this.addGlobalMouseListener("dcg-tapmove",this.handleTraceUpdate.bind(this)),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",this.stopTracingBranch.bind(this))}stopTracingBranch(e){this.manager.markLabelsDirty();let t=this.manager.poiLabelsLayer.getHoveredPOI();t&&!this.manager.poiLabelsLayer.isOpenPOI(t)&&(this.manager.poiLabelsLayer.openPOI(t),this.speakPoint(t),this.controller.requestRedrawGraph()),this.lastScreenPt=void 0,this.manager.traceLayer.setTraceInfo(void 0),this.controller.requestRedrawGraph(),this.removeAllGlobalMouseListeners()}handleTraceUpdate(e){if(!this.manager.traceLayer.traceInfo)return;let t=this.manager.getProjection(),o;if(e)o=this.getMouseRelativeToGrapher(e),this.lastScreenPt=o,this.manager.markLabelsDirty();else if(this.lastScreenPt)o=this.lastScreenPt;else return;let i=1/0,n=-1,a=this.manager.traceLayer.traceInfo,s=this.manager.graphSketches[a.branchInfo.sketch.id];if(!s)return;a.branchInfo.sketch=s;let c=a.branchInfo.sketch.branches;for(let u=0;u<c.length;u++){let g=this.calculateDistanceFromBranch(c[u],o,t,!1);g<i&&(n=u,i=g)}let d=c[n],p=d?r.getBranchesTracePoint(d,o,t,this.controller.isGeometry()):void 0;p&&this.speakPoint(p),this.manager.traceLayer.traceInfo.branchInfo.branch=n,this.manager.traceLayer.traceInfo.pt=p,this.controller.requestRedrawGraph()}hasNonlinearMoveStrategy(e){if(!e||e.type!=="movable-point-parent")return!1;let t=this.controller.getItemModel(e.id);if(!t||t.type!=="expression"||!t.formula)return!1;let o=t.formula.move_strategy;return!o||!o[0]?!1:o[0].type==="updateSliderNonlinear"}movePointsFromKeyboard(e,t){if(!t)return;let o=this.manager.getProjection(),i=e.map(h=>{let{x:b,y:v}=o.map_pt(this.getFeatureCenterMathPoint(h));return{x:b,y:v}}),n=0,a=0,s=Pe(t),c=(o.pixelCoordinates.right-o.pixelCoordinates.left)/40,d=(o.pixelCoordinates.bottom-o.pixelCoordinates.top)/40,p=s==="Up"||s==="Down"?d:c;p=t.shiftKey?p*5:p;let u,g;if(s==="Up"?(g="y",a-=p,u=t.shiftKey?"bigup":"up"):s==="Down"?(g="y",a+=p,u=t.shiftKey?"bigdown":"down"):s==="Left"?(g="x",n-=p,u=t.shiftKey?"bigdown":"down"):s==="Right"&&(g="x",n+=p,u=t.shiftKey?"bigup":"up"),u){let h=i.map(({x:v,y:T})=>({x:v+n,y:T+a})),b;g==="x"||e.some(v=>this.hasNonlinearMoveStrategy(v))?b={x:u}:g==="y"&&(b={y:u}),this.controller.dispatch({type:"on-move-points",points:e.map(v=>this.getPointInfo(v)),screenPts:h,previousScreenPts:i,transform:e.map(v=>v.type==="movable-point-parent"?v.transformations:void 0),projection:o,keyboardDirection:b})}}getGeoKeyboardPt(){return this.initGeoKeyboardPt(),this.geoKeyboardPt}setGeoKeyboardPt(e){this.geoKeyboardPt={...this.geoKeyboardPt,x:e.x,y:e.y},e.fromArrowKeys&&(this.geoKeyboardPt.lastArrowedX=e.x,this.geoKeyboardPt.lastArrowedY=e.y),this.controller.requestRedrawGraph()}initGeoKeyboardPt(){if(!isNaN(this.geoKeyboardPt.x)&&!isNaN(this.geoKeyboardPt.y))return;let e=this.manager.getProjection();if(!e)return;let t=e.viewport,o=zl(e),i=o.minorStepX,n=o.minorStepY,a=Math.round((t.xmin+t.xmax)/2/i)*i,s=Math.round((t.ymin+t.ymax)/2/n)*n;this.setGeoKeyboardPt({x:a,y:s})}moveGeoPointFromKeyboard(e){if(!e)return;this.initGeoKeyboardPt();let t=this.manager.getProjection();if(!t)return;let o=t.viewport,i=zl(t),n=i.minorStepX/4,a=i.minorStepY/4,s=this.geoKeyboardPt.x,c=this.geoKeyboardPt.y,d=Pe(e);d==="Down"?e.ctrlKey?c=o.ymin:c=Math.max(Math.round((c-a)/a)*a,o.ymin):d==="Up"?e.ctrlKey?c=o.ymax:c=Math.min(Math.round((c+a)/a)*a,o.ymax):d==="Left"?e.ctrlKey?s=o.xmin:s=Math.max(Math.round((s-n)/n)*n,o.xmin):d==="Right"&&(e.ctrlKey?s=o.xmax:s=Math.min(Math.round((s+n)/n)*n,o.xmax)),!(s===this.geoKeyboardPt.x&&c===this.geoKeyboardPt.y)&&(this.setGeoKeyboardPt({x:s,y:c,fromArrowKeys:!0}),this.handleGeoKeyboardPtMove(e),this.controller.getEvaluator().notifyWhenSynced(()=>{It(Gl(this.controller,this.geoKeyboardPt.x,this.geoKeyboardPt.y));let p=this.manager.clickableObjectsLayer.getHoveredObjects(),u=[];for(let g in p){let h=this.controller.getItemModel(g,{includePreviewItems:!0});h!==void 0&&u.push(Vo(h,this.controller,{includeDetails:!1,depth:this.controller.isToolPreviewItem(g)?0:1}))}u.length&&It(this.controller.s("graphing-calculator-narration-geometry-near-item",{item:ol(this.controller.getLanguage(),u)})),_e()}))}handleGeoKeyboardPtMove(e){this.initGeoKeyboardPt();let t=this.controller.getGeoModel(),o=!!(e&&e.shiftKey);t.onMouseAction("move",{pt:this.geoKeyboardPt,shift:o,tolerance:this.getToleranceByDevice("keyboard")}),t.onPreviewChange()}activateGeoObjectFromKeyboard(e,t){e!=null&&e.geoDef?this.tapGeoObjectFromKeyboard(e.geoDef,t):this.tapGeoPointFromKeyboard(t)}tapGeoObjectFromKeyboard(e,t){var a;let o=this.controller.getGeoModel(),i=o.getCurrentTool();if(!i)return;i.onFocus(e);let n=i.tryCommitResults();n.committed&&this.controller.dispatch({type:"commit-geo-objects",shiftKey:t.shiftKey,...n}),o.updateNextObjectId(o.controller.findLastTokenNumber()+1),o.clearHoveredObjects(),o.onPreviewChange(),this.speakGeoReleaseAction(this.controller.getActiveTool(),(a=i.getSpec)==null?void 0:a.call(i),n.committed),this.keyboardAttentionManager.clearAttentionIfNotTabbable()}tapGeoPointFromKeyboard(e){var c;this.initGeoKeyboardPt();let t=this.controller.getGeoModel(),o=this.controller.getActiveTool(),i=t.getCurrentTool(),n=(c=i.getSpec)==null?void 0:c.call(i),a=!!e.shiftKey,s=t.onMouseAction("release",{pt:this.geoKeyboardPt,shift:a,tolerance:this.getToleranceByDevice("keyboard")});s.committed&&this.controller.dispatch({type:"commit-geo-objects",shiftKey:e.shiftKey,...s}),t.onMouseAction("move",{pt:this.geoKeyboardPt,shift:a,tolerance:this.getToleranceByDevice("keyboard")}),t.onPreviewChange(),this.speakGeoReleaseAction(o,n,s.committed),this.keyboardAttentionManager.clearAttentionIfNotTabbable()}speakGeoReleaseAction(e,t,o){var i;if(o!==void 0){let n=Object.keys(o);if(!n.length||!t)return;let a="";if(e==="point"||e==="expression-edit"){for(let s in o){let c=o[s];if(c){if(c.type==="point-reference"){a=this.controller.s("graphing-calculator-text-geometry-tool-point-display-name");break}else if(c.type==="intersection"){a=this.controller.s("graphing-calculator-text-geometry-intersection");break}else if(c.type==="glider"){a=this.controller.s("graphing-calculator-text-geometry-glider");break}else if(c.type==="vector-endpoint"){c.location==="start"?a=this.controller.s("graphing-calculator-text-geometry-tool-vector-start-point-display-name"):a=this.controller.s("graphing-calculator-text-geometry-tool-vector-end-point-display-name");break}}}a===""&&(a=this.controller.s("graphing-calculator-text-geometry-tool-point-display-name"))}else{let s=(i=t.outputs[0])==null?void 0:i.type;switch(s){case"arc":a=this.controller.s("graphing-calculator-text-geometry-tool-arc-display-name");break;case"circle":a=this.controller.s("graphing-calculator-text-geometry-tool-circle-display-name");break;case"line":a=this.controller.s("graphing-calculator-text-geometry-tool-line-display-name");break;case"segment":a=this.controller.s("graphing-calculator-text-geometry-tool-segment-display-name");break;case"ray":a=this.controller.s("graphing-calculator-text-geometry-tool-ray-display-name");break;case"vector-copy":a=this.controller.s("graphing-calculator-text-geometry-tool-vector-copy-display-name");break;case"vector":a=this.controller.s("graphing-calculator-text-geometry-tool-vector-display-name");break;case"parallel":a=this.controller.s("graphing-calculator-text-geometry-tool-parallel-display-name");break;case"perpendicular":a=this.controller.s("graphing-calculator-text-geometry-tool-perpendicular-display-name");break;case"anglebisector":a=this.controller.s("graphing-calculator-text-geometry-tool-angle-bisector-display-name");break;case"midpoint":a=this.controller.s("graphing-calculator-text-geometry-tool-midpoint-display-name");break;case"polygon":a=this.controller.s("graphing-calculator-text-geometry-tool-polygon-display-name");break;case"angle":a=this.controller.s("graphing-calculator-text-geometry-tool-angle-display-name");break;case"directedangle":a=this.controller.s("graphing-calculator-text-geometry-tool-directed-angle-display-name");break;case"reflect":a=this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");break;case"translate":a=this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name");break;case"dilate":a=this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");break;case"rotate":a=this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");break;case"vector-endpoint":case"expression-edit-preview-latex":case"point":case"intersection":case"glider":case"slider":case"polygon-angle":case"polygon-directedangle":case"compass":case"polygon-segment":case"point-reference":case void 0:a=this.controller.s("shared-calculator-narration-item-unknown");break;default:let c=s;throw new Error("Exhaustive Check failed"+c)}}n.length===1?_e(this.controller.s("graphing-calculator-narration-geometry-added-object-type",{type:a})):a!=="graphing-calculator-text-geometry-point"?n.length===2?_e(this.controller.s("graphing-calculator-narration-geometry-added-object-type-and-point",{type:a})):_e(this.controller.s("graphing-calculator-narration-geometry-added-object-type-and-points",{type:a,points:n.length-1})):_e(this.controller.s("graphing-calculator-narration-geometry-added-points",{points:n.length}))}else this.controller.getGeoModel().speakCurrentGeoToolHint()}describeFocusedItem(e){let t=this.keyboardAttentionManager.getKeyboardAttention(),o=this.controller.getItemModel((t==null?void 0:t.calcId)||"");this.controller.getEvaluator().notifyWhenSynced(()=>{var i,n;if(!this.controller.isGeometry()&&o&&o.type==="image"&&((i=this.manager.imageLayer.getFocusedImage())==null?void 0:i.id)===o.id){this.manager.imageLayer.speakAriaAlert();return}o&&((n=this.manager.movablePointsLayer.getPOIUnderAttention())==null?void 0:n.sketch.id)===o.id&&this.manager.movablePointsLayer.speakAriaAlert()||_e(Vo(o,this.controller,{includeDetails:e.includeDetails,description:t==null?void 0:t.description,poi:this.manager.movablePointsLayer.getPOIUnderAttention(),listIndex:t==null?void 0:t.listIndex,polygonEdge:t==null?void 0:t.polygonEdge,includeSelectionState:this.controller.isGeometry()&&(this.controller.getActiveTool()==="box-selection"||this.controller.getActiveTool()==="selection")}))})}getPointFromFocusedItem(){var p;let e=this.keyboardAttentionManager.getKeyboardAttention(),t=this.controller.getItemModel((e==null?void 0:e.calcId)||"");if(!t||t.type!=="expression"||!t.latex)return;let o=t.formula.typed_constant_value;if(!o||!this.manager.getProjection())return;let n=o.valueType,a=o.value;if(__dcg_shared_module_exports__['qa'](o.valueType)){let u=e==null?void 0:e.listIndex;u&&(n=__dcg_shared_module_exports__['ra'](n),a=a[u])}let s=e==null?void 0:e.polygonEdge;if(n===__dcg_shared_module_exports__['J']&&s!==void 0&&s>=0&&a.length>s){let u=a[s],g=a[(s+1)%a.length];n=__dcg_shared_module_exports__['K'],a=[u,g]}let c=NaN,d=NaN;return n===__dcg_shared_module_exports__['C']?(c=a[0],d=a[1]):n===__dcg_shared_module_exports__['O']||n===__dcg_shared_module_exports__['Q']||n===__dcg_shared_module_exports__['K']?(c=(a[0][0]+a[1][0])/2,d=(a[0][1]+a[1][1])/2):n===__dcg_shared_module_exports__['Y']?(c=a[1][0]+a[0][0]/2,d=a[1][1]+a[0][1]/2):(p=a[0])!=null&&p.length&&(c=a[0][0],d=a[0][1]),{x:c,y:d}}moveGeoKeyboardPtToFocusedItem(e){let t=this.getPointFromFocusedItem();if(!t)return;let{x:o,y:i}=t,n=this.keyboardAttentionManager.getKeyboardAttention(),a=this.controller.getFocusLocation(),s=a&&a.type==="expression"&&a.isFakeGraphFocus;this.controller.getGeoModel().setObjectHovered({calcId:(n==null?void 0:n.calcId)||"",listIndex:void 0}),!isNaN(o)&&!isNaN(i)?this.setGeoKeyboardPt({x:o,y:i}):!s&&this.controller.isVirtualMouseAllowed()&&e.describe&&_e(this.controller.s("graphing-calculator-narration-geometry-unable-to-move"))}speakPoint(e,t){if(!(!e||!this.manager.getAudioTrace()||!this.manager.getProjection()))switch(t){case"X":_e(cd(this.controller,e.x));break;case"Y":_e(dd(this.controller,e.y));break;case"L":"ariaLabel"in e&&e.ariaLabel?_e(e.ariaLabel):_e(this.controller.s("graphing-calculator-narration-poi-graph-point"));break;case"C":"sketch"in e&&_e(up(this.controller,e.sketch.color))}}selectItemIfNotSecret(e,t){this.controller.isItemNotSelectableBecauseItsSecret(e)||(!this.controller.isMultiSelectEnabled()||!t.multiSelect?this.controller.dispatch({type:"set-selected-id",id:e,state:t.tentative?"tentatively-selected":"selected"}):this.controller.dispatch({type:"toggle-selected-with-multi-select",id:e,state:t.tentative?"tentatively-selected":"selected"}))}convertTouchEventToMathPoint(e){let{clientX:t,clientY:o}=e.changedTouches[0],i=this.manager.elt.getBoundingClientRect();return this.controller.getGeoModel().convertCanvasPixelsToPoint({x:t-i.left,y:o-i.top})}handleGeoTapStart(e,t){let o=this.controller.getGeoModel();this.canceledGeoToolplayWhilePressed=!1;let i=e.shift;return o.onMouseAction("move",{pt:e.mathPoint,shift:i,tolerance:this.getToleranceByDevice(e.device)}).handled?(e.device==="mouse"?this.handleGeoTapMove(e):(o.onPreviewChange(),this.updateGeoHoveredObjects()),o.getToolMode()==="expression-edit"&&t.preventDefault(),!0):!1}updatePointerState(e){var n;let t=e.target&&e.target instanceof HTMLElement&&e.target.closest(".dcg-geometry-toolbar-view"),o=this.isEventWithinInstance(e),i;return e.type==="dcg-tapstart"?i=!0:e.type==="dcg-tapend"?i=!1:i=!!((n=this.pointerState)!=null&&n.isPressed),this.pointerState={mathPoint:this.convertTouchEventToMathPoint(e),device:e.device,shift:!!e.shiftKey,isPressed:i,isOnToolbar:t,isWithinInstance:o},(e.type==="dcg-tapmove"||e.type==="dcg-tapstart")&&this.updateClickToInsertMode(),this.pointerState}updateClickToInsertMode(){var o;let e=this.pointerState;if(!e||!this.controller.isGeometry()||((o=this.controller.getFocusLocation())==null?void 0:o.type)!=="expression")return;let t=this.controller.getGeoModel();t.getClickToInsertMode()!=="permissive"&&e.shift?t.getObjectDefUnderMouse(e.mathPoint,this.getToleranceByDevice(e.device),{shouldUseJitEdges:()=>!0,isValidNextInputType:()=>!0})&&this.controller.dispatch({type:"update-click-to-insert-mode",clickToInsertMode:"permissive"}):t.getClickToInsertMode()==="permissive"&&!e.shift&&this.controller.dispatch({type:"update-click-to-insert-mode",clickToInsertMode:"valid-type"})}handleShiftKeyChange(e){let t=this.pointerState;if(!(!t||t.shift===e)&&(t.shift=e,this.updateClickToInsertMode(),this.controller.isGeoToolActive())){let o=this.controller.getGeoModel();o.onMouseAction("move",{pt:t.mathPoint,shift:t.shift,tolerance:this.getToleranceByDevice("mouse")}),o.onPreviewChange()}}handleGeoTapMove(e){let t=this.controller.getGeoModel(),o;return!e.isOnToolbar&&(e.isWithinInstance||e.isPressed)?o=t.onMouseAction("move",{pt:e.mathPoint,shift:e.shift,tolerance:this.getToleranceByDevice(e.device)}).handled:(t.onMouseAction("move",{pt:{x:NaN,y:NaN},shift:!1,tolerance:0}),o=!0),t.onPreviewChange(),o}replayGeoTapMove(){let e=this.controller.getGeoModel(),t=this.pointerState;t&&(e.onMouseAction("move",{pt:{...t.mathPoint},shift:t.shift,tolerance:this.getToleranceByDevice("mouse")}),e.onPreviewChange())}handleGeoTapEnd(e,t){var c;let o=this.controller.getGeoModel(),i=this.canceledGeoToolplayWhilePressed?{committed:void 0}:o.onMouseAction("release",{pt:e.mathPoint,shift:e.shift,tolerance:this.getToleranceByDevice(e.device)});this.canceledGeoToolplayWhilePressed=!1,i.committed&&this.controller.dispatch({type:"commit-geo-objects",shiftKey:e.shift,...i}),e.isWithinInstance&&e.device==="mouse"?this.handleGeoTapMove(e):o.onPreviewChange();let n=this.controller.getActiveTool(),a=o.getCurrentTool(),s=(c=a.getSpec)==null?void 0:c.call(a);this.speakGeoReleaseAction(n,s,i.committed),o.getToolMode()==="expression-edit"&&t.preventDefault()}isEventWithinInstance(e){return e.target?this.manager.elt.contains(e.target):!1}updateGeoHoveredObjects(){let e=this.controller.getGeoModel(),t={};e.getHoveredItems().forEach(o=>{let i;if("tokenId"in o){let n=this.controller.getGeoTokenInfoFromIdentifier(__dcg_shared_module_exports__['wb'](o.tokenId));i=n&&n.calcId}else i=o.calcId;if(i!==void 0){let n=t[i];n?o.listIndex===void 0?n.listIndexes=void 0:n.listIndexes!==void 0&&(n.listIndexes[o.listIndex]=!0):t[i]={listIndexes:o.listIndex===void 0?void 0:{[o.listIndex]:!0}}}}),this.manager.clickableObjectsLayer.setHoveredObjects(t),this.manager.movablePointsLayer.setGeoHoveredObjects(this.controller.getActiveTool()==="point"?{}:t)}cancelGeoToolplay(){var e;this.canceledGeoToolplayWhilePressed=!!((e=this.pointerState)!=null&&e.isPressed),this.updateGeoHoveredObjects()}startBoxSelect(e){let t={};this.controller.getAllSelectedItems().forEach(n=>t[n.id]=!0);let o=this.manager.getProjection().reverse_map_pt(this.getMouseRelativeToGrapher(e)),i;this.addGlobalMouseListener("dcg-tapmove",n=>{i=this.manager.getProjection().reverse_map_pt(this.getMouseRelativeToGrapher(n));let a={left:Math.min(o.x,i.x),top:Math.min(o.y,i.y),right:Math.max(o.x,i.x),bottom:Math.max(o.y,i.y)};this.manager.setBoxSelectRectangle(a);let s=this.findIdsThatIntersectBox(a,{ignoreClickables:!0});this.controller.dispatch({type:"set-all-selected-ids",ids:{...t,...s}})}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",n=>{this.removeAllGlobalMouseListeners(),this.manager.setBoxSelectRectangle(void 0),i||this.controller.dispatch({type:"set-none-selected"})})}updateAria(){let e=this.keyboardAttentionManager.getKeyboardAttention();if(!e||!this.lastClickedKeyboardAttention||e.calcId!==this.lastClickedKeyboardAttention.calcId||e.listIndex!==this.lastClickedKeyboardAttention.listIndex){this.lastClickedKeyboardAttention=void 0,this.lastClickedDescription=void 0;return}let t=this.controller.getItemModel(e.calcId);if(!t)return;let o=tl(t,e.listIndex);o&&o!==this.lastClickedDescription&&(this.lastClickedDescription=o,this.speakThrottledDescription(o))}};function bQ(r){return{calcId:r.sketch.id,isReverseDrag:!1,scaleFactor:r.type==="movable-point"?r.scaleFactor:void 0,tableInfo:r.type==="movable-point"?r.tableInfo:void 0}}function $U(r,e){return`${r}_dcg_delim_${e}`}var l_=class{constructor(e){this.hoveredObjects={},this.grapher=e,this.controller=this.grapher.controller,this.renderedTabTargetOrder=[],this.renderedTabTargets={}}getOrderedTabTargets(){return this.renderedTabTargetOrder.map(e=>{let t=this.renderedTabTargets[e];return{calcId:t.id,listIndex:t.listIndex,polygonEdge:void 0,description:t.description}})}recomputeClickableObjects(){var o;this.renderedTabTargets={},this.renderedTabTargetOrder=[];let e=this.controller.get2dPOIController(),t=e.getViewportAsRect();for(let i of this.grapher.getTabOrder()){let n=this.controller.getItemModel(i);if(!n)continue;let a=this.grapher.getGraphSketch(i),s=this.grapher.getGraphImage(i),c=this.grapher.getProjection(),d;if(a&&n.type==="expression"&&Jn(n))for(let p=0;p<a.branches.length;p++){let u=a.branches[p];__dcg_shared_module_exports__['od'](u)?a.getBranchPOI(p).forEach(g=>{d=g.pointIdxOnBranch||0,pw.doesBoxContainPoint(g,t)&&this.addTabTarget(n,d)}):(d=(u==null?void 0:u.listIndex)||0,e.doesBoxIntersectBranch(u,t)&&this.addTabTarget(n,d))}else if(s&&s.shouldGraph&&n.type==="image"&&ob(n)){let p=n.formula&&n.formula.dimensions;if(!((o=p.x)!=null&&o.length))continue;for(let u=0;u<p.x.length;u++)UD(c,n,u)&&this.addTabTarget(n,u)}}Object.keys(this.hoveredObjects).length||this.pressedObject?this.grapher.setLayerClass("clickableObjects","dcg-mouse-over-clickable-object"):this.grapher.setLayerClass("clickableObjects",void 0),this.grapher.poiController.updateAria()}addTabTarget(e,t){let o=$U(e.id,t);this.renderedTabTargetOrder.indexOf(o)!==-1||this.renderedTabTargets[o]!==void 0||(this.renderedTabTargetOrder.push(o),this.renderedTabTargets[o]={type:e.type,id:e.id,listIndex:t,description:this.getComputedDescription(e,t)})}getTabIndex(e){if(this.controller.getActiveTool()!=="selection"||!this.renderedTabTargets[e])return-1;let o=this.grapher.settings;return!o.config.graphpaper||!o.config.enableTabindex?-1:0}getAriaHidden(){return!this.grapher.settings.config.graphpaper}getCachedDescription(e){return this.renderedTabTargets[e].description}getComputedDescription(e,t){let o=e.formula&&e.formula.computed_description&&e.formula.computed_description[t];return o&&o!==""?po(o):this.grapher.getAudioTrace().getExpressionAriaLabel(e.id)}getModelId(e){let t=this.renderedTabTargets[e];return t?t.id:""}getListIndex(e){let t=this.renderedTabTargets[e];if(t)return t.listIndex}isKeyboardFocused(e,t){if(!e)return!1;let o=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention(),i=o==null?void 0:o.calcId;return e===i&&(t===void 0||t===(o==null?void 0:o.listIndex))}shouldDrawHovered(e,t,o){if(!t)return!1;if(this.isKeyboardFocused(t,o))return!0;let{translationPreviewVectorParents:i,rotationPreviewAngleMarkerParents:n}=e.transformationPreviewParentData;if(i.has(t)||n.has(t)&&!this.controller.isToolPreviewItem(t))return!0;if(this.isAnObjectPressed()&&!this.isObjectPressed(t))return!1;let a=this.getHoveredObjectById(t);return a?a.listIndexes===void 0||o===void 0?!0:!!a.listIndexes[o]:!1}setHoveredObjects(e){__dcg_shared_module_exports__['db'](e,this.hoveredObjects)||(this.hoveredObjects=e,this.requestRedrawNextFrame())}getHoveredObjects(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();if(e){let t=__dcg_shared_module_exports__['f'](this.hoveredObjects),o=t[e.calcId],i=e.listIndex||0;return o?o.listIndexes?o.listIndexes[i]=!0:o.listIndexes={[i]:!0}:(o={listIndexes:{[i]:!0}},t[e.calcId]=o),t}else return this.hoveredObjects}getHoveredObjectById(e){return this.getHoveredObjects()[e]}shouldDrawPressed(e,t){if(!e)return!1;let o=this.pressedObject;return!o||o.id!==e?!1:t===void 0?!0:o.listIndex===t}isObjectPressed(e){return e===void 0?!1:!!(this.pressedObject&&this.pressedObject.id===e)}setPressedObject(e){!e&&!this.pressedObject||e&&this.pressedObject&&e.id===this.pressedObject.id&&e.listIndex===this.pressedObject.listIndex||(this.pressedObject=e,this.requestRedrawNextFrame())}getPressedObject(){return this.pressedObject}isAnObjectPressed(){return!!this.pressedObject}requestRedrawNextFrame(){this.controller.requestRedrawGraph()}shouldDrawGhosted(e){if(!e)return!1;let t=this.controller.getItemModel(e);return!t||t.type!=="expression"?!1:ji(t)}};var uw=__dcg_shared_module_exports__['e'](j()),{If:Zxe}=uw.Components,mL=class extends uw.View{init(){this.controller=this.props.grapher().controller,this.poiController=this.props.grapher().poiController}template(){return l(Zxe,{predicate:this.bindFn(this.showCursor),children:()=>l("div",{class:uw.const("dcg-geo-keyboard-cursor"),style:()=>({top:`${this.getPosition().y}px`,left:`${this.getPosition().x}px`})})})}getPosition(){let e=this.poiController.getGeoKeyboardPt(),t=this.props.grapher().getProjection();return{x:t.mapx(e.x),y:t.mapy(e.y)}}showCursor(){return this.controller.isVirtualMouseAllowed()}};var yQ=__dcg_shared_module_exports__['e'](j());var Dh=__dcg_shared_module_exports__['e'](j());var{If:Qxe}=Dh.Components,fL=class extends Dh.View{init(){this.grapher=this.props.grapher(),this.controller=this.grapher.controller,this.width=0,this.height=0,this.pixelRatio=0}getDevicePixelRatio(){return window.devicePixelRatio||1}template(){return x("div",{class:Dh.const("dcg-graph-outer"),didMount:e=>this.rootNode=e,manageFocus:this.const(ze({controller:this.controller,location:{type:"graph-paper"}})),children:[l("div",{tabIndex:()=>this.getShiftTabElementTabIndex(),onFocus:()=>{let e=this.rootNode.getAttribute("aria-label")||"";this.rootNode.setAttribute("aria-label",""),this.rootNode.focus(),this.rootNode.setAttribute("aria-label",e),this.controller.get2dPOIController().handleTabEvent("prev")}}),l(Qxe,{predicate:()=>this.isIOSAndIframe(),children:()=>l("div",{style:Dh.const("width:1px; height:.5px; pointer-events:none; opacity: 0;"),"aria-hidden":Dh.const("true"),children:"text"})}),l("canvas",{class:Dh.const("dcg-graph-inner"),didMount:e=>{this.canvasNode=e,this.ctx=this.canvasNode.getContext("2d"),this.resize(0,0)},style:()=>({position:"relative",display:"block",outline:"none","-webkit-transform":this.isIOSAndIframe()?"translate3d(0,-.25px,0)":void 0})})]})}getShiftTabElementTabIndex(){var t;return((t=this.rootNode)==null?void 0:t.getAttribute("tabindex"))!=="0"||this.controller.getActiveTool()!=="selection"||this.rootNode===document.activeElement?"-1":"0"}isIOSAndIframe(){return Ws&&Uu}resize(e,t,o){var i;o=o||this.getDevicePixelRatio(),!(e===this.width&&t===this.height&&o===this.pixelRatio)&&(this.width=e,this.height=t,this.canvasNode.style.width=e+"px",this.canvasNode.style.height=t+"px",this.canvasNode.setAttribute("width",""+e*o),this.canvasNode.setAttribute("height",""+t*o),this.pixelRatio=o,this.ctx=this.canvasNode.getContext("2d"),(i=this.ctx)==null||i.scale(o,o),this.update())}getAriaLabel(e){let t=[],{graphDescription:o}=this.grapher.settings.config;if(this.grapher.type==="3d"&&this.controller.is3dProduct())o!==void 0?t.push(o):(t.push(`${this.controller.s("graphing-calculator-narration-3d-graphpaper-label")}.`),t.push($k(this.controller)));else if(this.grapher.type==="2d"&&!this.controller.is3dProduct()){let i=this.grapher.getAudioTrace();if(!i)return"";o!==void 0?t.push(o):(t.push(`${this.controller.s("graphing-calculator-narration-graphpaper-label")}.`),t.push($k(this.controller)),!this.controller.isGeometry()&&e>0&&(i.getAudioTraceActive()||i.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!1})!==void 0&&(qr?t.push(this.controller.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-mac")):t.push(this.controller.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-windows")))))}if(t.length)return t.join(" ").trim()}updateAria(e,t){let o=this.getAriaLabel(t);o!==void 0?(this.rootNode.setAttribute("role","img"),this.rootNode.setAttribute("aria-label",o),this.rootNode.setAttribute("aria-hidden",!e||!this.grapher.settings.config.graphpaper?"true":"false"),this.rootNode.setAttribute("tabindex",e&&this.grapher.settings.config.graphpaper&&this.grapher.settings.config.enableTabindex?"0":"-1")):["role","aria-roledescription","aria-label","aria-hidden","tabindex"].forEach(n=>this.rootNode.removeAttribute(n)),this.update()}speakAriaLabelAgain(){let e=this.rootNode.getAttribute("aria-label");e&&_e(e)}};var JU=class{constructor(e){this._layerClasses={};this._classLayers={};this.elt=e.elt,this.settings=e.settings,this.controller=e.controller,this.evaluator=e.evaluator,this.elt.style.overflow="hidden"}classLayers(e){var t,o;return(o=(t=this._classLayers)[e])!=null?o:t[e]=new Set}setLayerClass(e,t){let o=this._layerClasses[e];if(this._layerClasses[e]=t,o!==t){if(o){let i=this.classLayers(o);i.delete(e),i.size===0&&this.elt.classList.remove(o)}t&&(this.classLayers(t).add(e),this.elt.classList.add(t))}}},ZU=class extends JU{constructor(e){super(e),this.canvasLayer=yQ.mountToNode(fL,this.elt,{grapher:()=>this}),this.elt.appendChild(this.canvasLayer.rootNode)}getImageData(e,t,o,i){var n;return(n=this.canvasLayer.ctx)==null?void 0:n.getImageData(e,t,o,i)}_setIsVisible(e){e!==this.isVisible&&(this.isVisible=e,e?this.controller.requestRedrawGraph():this.canvasLayer.resize(0,0))}getIsVisible(){return this.isVisible}};function*c_(r){for(let e=0;e<r.length;e++)yield*r[e].drawOrder}var QU=class extends ZU{setDrawLayers(e){__dcg_shared_module_exports__['db'](this.__drawLayers,e)||(this.__drawLayers=e,this.controller.requestRedrawGraph())}setTabOrder(e){this.__tabOrder=e}getDrawLayers(){return this.__drawLayers}getTabOrder(){return this.__tabOrder}generateMergeDrawOrder(){return c_(this.__drawLayers)}},e5=class extends QU{constructor(){super(...arguments);this.__redrawRequested=!1;this.events=new Pi}redrawAllLayers(){this.__redrawRequested=!0}redrawAllLayersSynchronously(){return this._redrawAllLayers()}notifyAfterRedraw(t){if(!this.__redrawRequested)t();else{this.notifyAfterRedraw_i?this.notifyAfterRedraw_i++:this.notifyAfterRedraw_i=1;let o="redraw.notifyAfterRedraw"+this.notifyAfterRedraw_i;this.events.observeEvent(o,()=>{this.events.unobserveEvent(o),t()})}}},t5=class extends e5{getUserRequestedViewport(){return this._lastUserRequestedViewport}setUserRequestedViewport(e){this._lastUserRequestedViewportUpdateToken||(this._lastUserRequestedViewportUpdateToken=0),this._lastUserRequestedViewportUpdateToken+=1,this._lastUserRequestedViewport=__dcg_shared_module_exports__['f'](e),this._afterViewportChange()}getCurrentViewport(){return this.viewportController.getViewport().toObject()}debounceUserRequestedViewportChange(){this.__debouncedViewportCommit||(this.__debouncedViewportCommit=__dcg_shared_module_exports__['_a']((o,i)=>{if(!this.isDragging&&this._lastUserRequestedViewportUpdateToken===i){if(this._lastUserRequestedViewport){let n=Or.fromObject(this._lastUserRequestedViewport);if(this.computeConcreteViewport(n).equals(o))return}this.controller.dispatch({type:"commit-user-requested-viewport",viewport:o})}},1e3));let e=this.getCurrentViewport();this.__debouncedViewportCommit(e,this._lastUserRequestedViewportUpdateToken)}},r5=class extends t5{getState(e){let t={...this.getCurrentViewport()};this.controller.is3dProduct()||(delete t.zmin,delete t.zmax);let o={viewport:t};return this.settings.stateProperties.forEach(i=>{i!=="randomSeed"&&i!=="includeFunctionParametersInRandomSeed"&&(!this.controller.is3dProduct()&&bX(i)||(o[i]=this.settings[i]))}),e.stripDefaults&&(o=__dcg_shared_module_exports__['Jd'](Li,o)),o}getUndoRedoDiffState(){let e=this.getUndoRedoFullState();return e.speed3D!==0&&delete e.worldRotation3D,e}getUndoRedoFullState(){let e={};return this.settings.stateProperties.forEach(t=>{e[t]=this.settings[t]}),e.viewport=this.getUserRequestedViewport(),e}},hw=class extends r5{};var gw=class{constructor(e,t){this.is3d=!1;this.color="#000000",this.style="normal",this.showPOI=!1,this.showHighlight=!1,this.hoistToTop=!1,this.selected=!1,this.tokenHovered=!1,this.tokenSelected=!1,this.labels=[],this.id=e,this.branches=t!==void 0?t:[],this.getPOI().forEach(o=>{o.type===1008&&this.labels.push({type:"poi",poi:o})}),t.forEach((o,i)=>{if(o.graphMode===22){if(o.objectType===17){let n=new hh(0,0,1008,this,i,0,!1);this.labels.push({id:"label-"+e+"-"+(o.listIndex||0),type:"segment",poi:n,segments:o.segments[0],text:o.labels&&o.labels[0]||""})}else if(o.objectType===16){let n=new hh(0,0,1008,this,i,0,!1);this.labels.push({id:"label-"+e+"-"+(o.listIndex||0),type:"polygon",poi:n,segments:o.segments[0],text:o.labels&&o.labels[0]||""})}else if(o.objectType===23){let n=new hh(0,0,1008,this,i,0,!1);this.labels.push({id:"label-"+e+"-"+(o.listIndex||0),type:"angle",poi:n,segments:o.segments[0],text:o.labels&&o.labels[0]||""})}}})}getPOI(){if(this.__cachedPOI)return this.__cachedPOI;this.__cachedPOI=[],this.__cachedPOIIds={};for(let e=0;e<this.branches.length;e++){let t=this.branches[e];if(t.graphMode===1||t.graphMode===2){let o=t.poi;o.zeros&&this._pushPOI(o.zeros,e,1002),o.intercept&&this._pushPOI(o.intercept,e,1003),o.extrema&&this._pushPOI(o.extrema,e,1004),o.intersections&&this._pushPOI(o.intersections,e,1001)}else if(__dcg_shared_module_exports__['od'](t)){let o=t.poi,i=(t.graphMode===3||t.graphMode===25)&&t.interactiveLabel===!0;if(t.showLabel===!0||i){let n=t.nakedLabel;o.defined&&this._pushPOI(o.defined,e,1008,n)}else o.defined&&this._pushPOI(o.defined,e,1006)}}return this.__cachedPOI}getBranchPOI(e){return this.getPOI().filter(t=>t.branch===e)}getMovablePoints(){if(this.__cachedMovablePoints)return this.__cachedMovablePoints;this.__cachedMovablePoints=[];let e=this.branches[0];if(e&&e.segments.length===1&&__dcg_shared_module_exports__['pd'](e)){let t=e.segments[0];for(let o=0;o<t.length;o++){let i;e.tableId&&(i={tableId:e.tableId,columnId:this.id,rowIndex:e.movablePointInfo[o].index,dragX:e.movablePointInfo[o].dragX,dragY:e.movablePointInfo[o].dragY});let n=e.scaleFactors?e.scaleFactors[0][o]:void 0,a=i?i.rowIndex:o,s=e.segments.length===1&&e.labels&&e.labels[o]?e.labels[o]:void 0,c=e.hasOwnProperty("pointOpacity")?e.pointOpacity:1,d=e.pointSize!==void 0?e.pointSize:8,p=e.style!==void 0?e.style:__dcg_shared_module_exports__['Cd'].POINT;this.__cachedMovablePoints.push({type:"movable-point",id:"movable:["+this.id+","+a+"]",listIndex:a,sketch:this,color:Array.isArray(this.color)?this.color[o]:this.color,pointOpacity:c,pointSize:d,pointStyle:p,tableInfo:i,scaleFactor:n,x:t[o][0],y:t[o][1],label:s,ariaLabel:s&&po(s)})}}return this.__cachedMovablePoints}getMovablePointByIndex(e){return this.getMovablePoints()[e]}getStaticLabeledPoints(){if(this.__cachedStaticLabeledPoints)return this.__cachedStaticLabeledPoints;let e=this.branches[0];return this.__cachedStaticLabeledPoints=[],this.getPOI().forEach(t=>{if(t.type!==1006&&t.type!==1008||e.graphMode!==3&&e.graphMode!==25)return;let o=e.showLabel,i=t.getLabel();!o&&i===""||this.__cachedStaticLabeledPoints.push({type:"static-labeled-point",id:"static["+this.id+","+t.id+"]",listIndex:t.pointIdxOnBranch,x:t.x,y:t.y,sketch:t.sketch,label:i,ariaLabel:i!==""?po(i):void 0})}),this.__cachedStaticLabeledPoints}_pushPOI(e,t,o,i=!1){for(let n=0,a=e.x.length;n<a;n++){let s=new hh(e.x[n],e.y[n],o,this,t,n,i);e.intersects&&(s.intersects=e.intersects[n]),this.__cachedPOI.push(s),this.__cachedPOIIds[s.id]=s}}updateIntersections(e){for(let o=0,i=this.branches.length;o<i;o++){let n=this.branches[o];n.graphMode!==15&&n.graphMode!==22&&(n.poi.intersections=e[o])}let t=this.__cachedPOI;this.__cachedPOI=[],t.forEach(o=>{o.type!==1001?this.__cachedPOI.push(o):delete this.__cachedPOIIds[o.id]});for(let o=0;o<this.branches.length;o++){let i=this.branches[o];if(i.graphMode===1||i.graphMode===2){let n=i.poi;n.intersections&&this._pushPOI(n.intersections,o,1001)}}}getPOIById(e){return this.__cachedPOIIds[e]}updateFrom(e){if(e&&(this.showPOI=e.showPOI,this.showHighlight=e.showHighlight,this.hoistToTop=e.hoistToTop,this.selected=e.selected,this.tokenSelected=e.tokenSelected,this.tokenHovered=e.tokenHovered,__dcg_shared_module_exports__['od'](this.branches[0]))){let t=!0;for(let o=0;o<this.__cachedPOI.length;o++){let i=e.__cachedPOI[o],n=this.__cachedPOI[o];if(!i||i.type!==n.type){t=!1;break}}if(t)for(let o=0;o<this.__cachedPOI.length;o++){let i=e.__cachedPOI[o],n=this.__cachedPOI[o];delete this.__cachedPOIIds[n.id],this.__cachedPOIIds[i.id]=n,n.id=i.id}}}};var{floor:ry,ceil:oy,round:tve,log10:bL,log2:xQ,abs:ym}=Math,bm=r=>BE?`rgba(255,255,255,${r})`:`rgba(0,0,0,${r})`,vL=class{redrawToCtx(e,t){let{ctx:o,projection:i}=e;_s(o,"graphpaper");let n=i.settings.showGrid&&!i.settings.threeDMode;if(i.settings.polarMode&&n){let a=mQ(i);_s(o,"grid"),this.drawPolarGrid(o,i,a),Cs(o),_s(o,"axis"),this.drawAxes(o,i,t);let s=this.drawPolarStepNumbers(o,i,a);this.drawLabels(o,i,s),Cs(o)}else{let a=zl(i),s=o5(i);n&&(_s(o,"grid"),this.drawCartesianGrid(o,i,a,s),Cs(o));let c=!n&&!i.settings.threeDMode;_s(o,"axis"),i.settings.threeDMode||this.drawAxes(o,i,t);let d=this.drawCartesianStepNumbers(o,i,a,c,s);this.drawLabels(o,i,d),Cs(o)}Cs(o)}addTextShadow(e,t){let{threeDMode:o,showPlane3D:i}=t.settings;e.strokeStyle=t.settings.getBackgroundColor({invertWhite:o}),e.lineWidth=3,o&&(!i||t.settings.invertedColors)&&(e.lineWidth=1.5),e.miterLimit=2}drawPolarGrid(e,t,o){e.save();let i=t.settings.minorAxisOpacity,a=1-(1-t.settings.majorAxisOpacity)/(1-i),s=__dcg_shared_module_exports__['r'](t.mapx(0)),c=__dcg_shared_module_exports__['r'](t.mapy(0)),d=t.screen.height/(t.viewport.ymax-t.viewport.ymin),p=t.screen.width/(t.viewport.xmax-t.viewport.xmin),u=d/p,g=p/d,h=c/u,b=t.viewport.smallestR(),v=t.viewport.largestR(),T=o.minorStepR*Math.max(1,Math.floor(b/o.minorStepR)),E=o.majorStepR*Math.max(1,Math.floor(b/o.majorStepR));e.lineWidth=1,e.strokeStyle=bm(i);for(let _ of Ls(T,v,o.minorStepR)){Oo(e,"dcg-svg-minor-gridline"),e.beginPath(),xo(e),e.scale(1,u);let C=t.mapx(_)-s;e.moveTo(s+C,h),e.arc(s,h,C,0,2*Math.PI),e.scale(1,g),e.stroke()}let I=b>0?5:15;for(let _ of Ls(0,359,I)){if((_===0||_===180)&&t.settings.showXAxis||(_===90||_===270)&&t.settings.showYAxis)continue;Oo(e,"dcg-svg-minor-gridline"),e.beginPath(),xo(e),e.moveTo(s,c);let C=t.mapx(v*Math.cos(_*Math.PI/180)),D=t.mapy(v*Math.sin(_*Math.PI/180));e.lineTo(__dcg_shared_module_exports__['r'](C),__dcg_shared_module_exports__['r'](D)),e.stroke()}e.lineWidth=1,e.strokeStyle=bm(a);for(let _ of Ls(E,v,o.majorStepR)){Oo(e,"dcg-svg-major-gridline"),e.beginPath(),xo(e),e.scale(1,u);let C=t.mapx(_)-s;e.moveTo(s+C,h),e.arc(s,h,C,0,2*Math.PI),e.scale(1,g),e.stroke()}e.restore()}drawCartesianGrid(e,t,o,i=o5(t)){e.save();let{xmin:n,xmax:a,ymin:s,ymax:c}=t.viewport,d=t.screen.width,p=t.screen.height,u=p,g=0;t.settings.restrictGridToFirstQuadrant&&(n=0,s=0,u=t.mapy(0),g=t.mapx(0));let h=t.settings.minorAxisOpacity*i.x.unitOpacity,b=t.settings.minorAxisOpacity*i.y.unitOpacity,v=t.settings.majorAxisOpacity;e.lineWidth=1;let T=A=>{if(A===0&&t.settings.showYAxis)return;let O=__dcg_shared_module_exports__['r'](t.mapx(A));O===__dcg_shared_module_exports__['r'](0)||O===__dcg_shared_module_exports__['r'](d)||(e.beginPath(),e.moveTo(O,0),e.lineTo(O,u),e.stroke())},E=A=>{if(A===0&&t.settings.showXAxis)return;let O=__dcg_shared_module_exports__['r'](t.mapy(A));O===__dcg_shared_module_exports__['r'](0)||O===__dcg_shared_module_exports__['r'](p)||(e.beginPath(),e.moveTo(g,O),e.lineTo(d,O),e.stroke())};Oo(e,"dcg-svg-minor-gridline");let{majorStepX:I,majorStepY:_,minorStepX:C,minorStepY:D}=o,P=t.settings.xAxisScale==="logarithmic",F=t.settings.yAxisScale==="logarithmic",N=P?i.x.minor:Ls(n,a,C),Y=F?i.y.minor:Ls(s,c,D);e.strokeStyle=bm(h);for(let A of N)T(A);e.strokeStyle=bm(b);for(let A of Y)E(A);xo(e);let z=1-(1-v)/(1-h),X=1-(1-v)/(1-b);Oo(e,"dcg-svg-major-gridline");let q=P?i.x.major:Ls(n,a,I),S=F?i.y.major:Ls(s,c,_);e.strokeStyle=bm(z);for(let A of q)T(A);e.strokeStyle=bm(X);for(let A of S)E(A);xo(e),e.restore()}drawAxes(e,t,o){let i=t.settings.axisLineOffset,n=t.settings.axisOpacity,a=`rgba(127,205,230,${n.toString()})`,s=bm(n),c=t.settings.xAxisArrowMode,d=t.settings.yAxisArrowMode,p=t.settings.showXAxis,u=t.settings.showYAxis,g=1,h=Math.round(t.mapx(0))-i,b=Math.round(t.mapy(0))-i,v=t.screen.height,T=t.screen.width;function E(C,D,P){e.save();let F=Math.PI/12,N=8*Math.max(e.lineWidth,1.5);e.lineJoin="round",e.fillStyle=s,e.strokeStyle=s,e.beginPath(),e.moveTo(C,D),e.lineTo(C+Math.cos(P-F)*N,D+Math.sin(P-F)*N),e.lineTo(C+Math.cos(P+F)*N,D+Math.sin(P+F)*N),e.lineTo(C,D),e.lineTo(C+Math.cos(P-F)*N,D+Math.sin(P-F)*N),e.stroke(),e.fill(),e.restore()}let I=v,_=0;t.settings.restrictGridToFirstQuadrant&&(I=b,_=h,c===__dcg_shared_module_exports__['Nd'].BOTH&&(c=__dcg_shared_module_exports__['Nd'].POSITIVE),d===__dcg_shared_module_exports__['Nd'].BOTH&&(d=__dcg_shared_module_exports__['Nd'].POSITIVE)),u&&(_s(e,"yaxis"),t.settings.takingScreenshot&&wk(e,t.settings.yAxisLabel||"Y axis"),e.save(),Oo(e,"dcg-svg-axis-line"),e.lineWidth=t.settings.axisLineWidth*(o==="y"?g:1),e.strokeStyle=o==="y"?a:s,d===__dcg_shared_module_exports__['Nd'].BOTH?(e.beginPath(),e.moveTo(h,2*t.settings.axisLineWidth),e.lineTo(h,v-2*t.settings.axisLineWidth),e.stroke(),E(h,v-t.settings.axisLineWidth,3*Math.PI/2),E(h,t.settings.axisLineWidth,Math.PI/2)):d===__dcg_shared_module_exports__['Nd'].POSITIVE?(e.beginPath(),e.moveTo(h,2*t.settings.axisLineWidth),e.lineTo(h,I),e.stroke(),E(h,t.settings.axisLineWidth,Math.PI/2)):(e.beginPath(),e.moveTo(h,0),e.lineTo(h,I),e.stroke()),xo(e),e.restore(),Cs(e)),p&&(_s(e,"xaxis"),t.settings.takingScreenshot&&wk(e,t.settings.xAxisLabel||"X axis"),e.save(),Oo(e,"dcg-svg-axis-line"),e.lineWidth=t.settings.axisLineWidth*(o==="x"?g:1),e.strokeStyle=o==="x"?a:s,c===__dcg_shared_module_exports__['Nd'].BOTH?(e.beginPath(),e.moveTo(2*t.settings.axisLineWidth,b),e.lineTo(T-2*t.settings.axisLineWidth,b),e.stroke(),E(t.settings.axisLineWidth,b,0),E(T-t.settings.axisLineWidth,b,Math.PI)):c===__dcg_shared_module_exports__['Nd'].POSITIVE?(e.beginPath(),e.lineTo(_,b),e.lineTo(T-2*t.settings.axisLineWidth,b),e.stroke(),E(T-t.settings.axisLineWidth,b,Math.PI)):(e.beginPath(),e.lineTo(_,b),e.lineTo(T,b),e.stroke()),xo(e),e.restore(),Cs(e))}drawPolarStepNumbers(e,t,o){e.save();let i=t.settings.showGrid,n=t.settings.xAxisNumbers&&t.settings.showXAxis,a=t.settings.yAxisNumbers&&t.settings.showYAxis,s=i&&t.settings.polarNumbers,c=t.viewport.largestR(),d=t.viewport.smallestR(),p=t.viewport.xmin,u=t.viewport.xmax,g=t.viewport.ymin,h=t.viewport.ymax,b=t.screen.width,v=t.screen.height,T={left:3,right:b-3,top:3,bottom:v-3},E=t.settings.labelHangingColor,I=t.settings.getTextColor(),_=t.settings.labelSize,C=_;this.addTextShadow(e,t),e.fillStyle=I;function D(B,V,K){let oe=Math.sqrt(B*B-V*V);g<=oe&&oe<=h&&K.push({x:t.mapx(V),y:t.mapy(oe)}),g<=-oe&&-oe<=h&&K.push({x:t.mapx(V),y:t.mapy(-oe)})}function P(B,V,K){let oe=Math.sqrt(B*B-V*V);p<=oe&&oe<=u&&K.push({x:t.mapx(oe),y:t.mapy(V)}),p<=-oe&&-oe<=u&&K.push({x:t.mapx(-oe),y:t.mapy(V)})}let F=t.mapx(0),N=t.mapy(0),Y=g<=0&&0<=h,z=p<=0&&0<=u,X=Y&&n,q=z&&a,S="";if(!X&&!q&&i){let B=ym(F),V=ym(F-b),K=ym(N),oe=ym(N-v),Z,ee,ue,he;B<=V?(Z="left",ue=B):(Z="right",ue=V),K<=oe?(ee="top",he=K):(ee="bottom",he=oe),n&&a?S=ue<=he?Z:ee:a?S=Z:n&&(S=ee)}let A={left:0,right:b,top:N-1,bottom:N+1},O={left:F-1,right:F+1,top:0,bottom:v};for(let B of Ls(0,c,o.majorStepR)){let V=[],K=[],oe=[],Z=new Xa(__dcg_shared_module_exports__['nb'](B,c),_),ee=Z.getRect();switch(B>0?(q&&g<=B&&B<=h&&K.push({x:F-ee.right-5,y:t.mapy(B)}),q&&g<=-B&&-B<=h&&K.push({x:F-ee.right-5,y:t.mapy(-B)}),X&&p<=B&&B<=u&&V.push({x:t.mapx(B),y:N-ee.top+3}),X&&p<=-B&&-B<=u&&V.push({x:t.mapx(-B),y:N-ee.top+3})):q&&!n&&g<=B&&B<=h?K.push({x:F-ee.right-5,y:t.mapy(B)}):X&&!a&&p<=B&&B<=u&&V.push({x:t.mapx(B),y:N-ee.top+3}),S){case"top":P(B,h,oe);break;case"bottom":P(B,g,oe);break;case"left":D(B,p,oe);break;case"right":D(B,u,oe);break}V.forEach(ue=>{ue=Z.clampBoundsWithinRect(ue,T),Z.drawCenteredAt(e,ue,"dcg-svg-axis-value"),yL(A,Z.getRectWhenCenteredAt(ue))}),K.forEach(ue=>{ue=Z.clampBoundsWithinRect(ue,T),Z.drawCenteredAt(e,ue,"dcg-svg-axis-value"),yL(O,Z.getRectWhenCenteredAt(ue))}),oe.forEach(ue=>{ue=Z.clampBoundsWithinRect(ue,T),Z.drawCenteredAt(e,ue,"dcg-svg-axis-value")})}if(s){let B=Math.ceil(d/o.majorStepR),V=Math.floor(c/o.majorStepR),oe=Math.ceil((B+V)/2)*o.majorStepR,Z=d>0?15:30;for(let ee of Ls(0,359,Z)){let ue;t.settings.degreeMode?ue=ee.toString()+"\xB0":ue=__dcg_shared_module_exports__['nb'](ee*Math.PI/180,2*Math.PI).string;let he=e.measureText(ue).width/2,ae=oe/1.05,$=ae*Math.cos(ee*Math.PI/180),se=ae*Math.sin(ee*Math.PI/180);if($<p||$>u||se<g||se>h)continue;let J=t.mapx($),ye=t.mapy(se);ee===0||ee===180?ye-=C:(ee===90||ee===270)&&(J+=he+3);let Se=__dcg_shared_module_exports__['Rb'](J,3+he,b-3-he),Ce=__dcg_shared_module_exports__['Rb'](ye,3+C,v-3-C);Ce=Xa.computeBaselineFromCenter(Ce,_),Oo(e,"dcg-svg-polar-axis-value"),e.save(),xo(e),e.fillStyle=E,Xa.setCtxFontSize(e,_),e.strokeText(ue,Se,Ce),e.fillText(ue,Se,Ce),e.restore()}}return e.restore(),{x:A,y:O}}drawLabels(e,t,o){let i=t.viewport.xmin,n=t.viewport.xmax,a=t.viewport.ymin,s=t.viewport.ymax,c=t.screen.width,d=t.screen.height,p=(n-i)/c,u=(s-a)/d,g=t.settings.getTextColor(),h=t.mapx(0),b=t.mapy(0),v=t.settings.labelSize,T=15,E=t.settings.showXAxis&&t.settings.xAxisLabel,I=t.settings.showYAxis&&t.settings.yAxisLabel,_=o.x,C=o.y;if(E&&_){Oo(e,"dcg-svg-axis-label"),e.save(),xo(e),e.fillStyle=g;let D;if(e.__xLabelOffset&&t.settings.isViewportTransient&&xL(e.__xLabelOffset.xscale,p)&&xL(e.__xLabelOffset.yscale,u)&&(D={x:e.__xLabelOffset.x+h,y:e.__xLabelOffset.y+b}),this._setAxisLabelFont(e,E,v,t),!D){let P=e.measureText(E).width,F=c-P-T,N=v;_.bottom+N<d?D={x:F,y:_.bottom+N}:D={x:F,y:_.top-N/2},e.__xLabelOffset={x:D.x-h,y:D.y-b,xscale:p,yscale:u}}e.strokeText(E,D.x,D.y),e.fillText(E,D.x,D.y),e.restore()}else e.__xLabelPosition=null;if(I&&C){Oo(e,"dcg-svg-axis-label"),e.save(),xo(e),e.fillStyle=g;let D;if(e.__yLabelOffset&&t.settings.isViewportTransient&&xL(e.__yLabelOffset.xscale,p)&&xL(e.__yLabelOffset.yscale,u)&&(D={x:e.__yLabelOffset.x+h,y:e.__yLabelOffset.y+b}),this._setAxisLabelFont(e,I,v,t),!D){let P=e.measureText(I).width,F=v,N=P+5;if(!this._isShortMathyLabel(I)){let z=P;P=F,F=z,N=P*.5}let Y=0+T+F;C.left-P>0?D={x:C.left-N,y:Y}:D={x:C.right+P,y:Y},e.__yLabelOffset={x:D.x-h,y:D.y-b,xscale:p,yscale:u}}e.translate(D.x,D.y),this._isShortMathyLabel(I)||e.rotate(-Math.PI/2),e.strokeText(I,0,0),e.fillText(I,0,0),e.restore()}else e.__yLabelPosition=null}_isShortMathyLabel(e){return e.trim().match(/^([a-zA-Z]?)\(?([a-zA-Z]?)\)?$/)}_setAxisLabelFont(e,t,o,i){this.addTextShadow(e,i),this._isShortMathyLabel(t)?e.font="italic "+Math.round(o*1.4)+"px Times":e.font=Math.round(o*1.2)+"px Arial"}drawCartesianStepNumbers(e,t,o,i,n=o5(t)){e.save();let{showXAxis:a,showYAxis:s}=t.settings,c=a&&t.settings.xAxisNumbers,d=s&&t.settings.yAxisNumbers,{xmin:p,xmax:u,ymin:g,ymax:h}=t.viewport,b=t.screen.width,v=t.screen.height,T={left:3,top:3,right:b-3,bottom:v-3};t.settings.restrictGridToFirstQuadrant&&(p=0,g=0);let E=t.settings.getTextColor({invertBlack:t.settings.threeDMode}),I=t.settings.threeDMode?E:t.settings.labelHangingColor,_=t.mapx(0),C=t.mapy(0),D=t.settings.labelSize;this.addTextShadow(e,t);let P={left:0,right:b,top:C-1,bottom:C+1},F={left:_-1,right:_+1,top:0,bottom:v};if(t.settings.threeDMode&&!t.settings.showNumbers3D)return{x:P,y:F};let N=5,Y=!1;if(a&&s&&(c||d)){Y=!0,e.fillStyle=E;let A=new Xa(__dcg_shared_module_exports__['nb'](0,1),D);A.drawCenteredAt(e,{x:_-A.getRect().right-N,y:C-A.getRect().top+N},"dcg-svg-axis-value")}let{majorStepX:z,majorStepY:X}=o,q=[],S=[];if(c){let A=t.settings.xAxisScale==="logarithmic",O=A?n.x.label:Ls(p,u,z);for(let B of O){let V=A?void 0:u-p,K=__dcg_shared_module_exports__['nb'](B,V,A),oe=new Xa(K,D);oe.getString()==="0"&&Y||q.push(oe)}}if(d){let A=t.settings.yAxisScale==="logarithmic",O=A?n.y.label:Ls(g,h,X);for(let B of O){let V=A?void 0:h-g,K=__dcg_shared_module_exports__['nb'](B,V,A),oe=new Xa(K,D);oe.getString()==="0"&&Y||S.push(oe)}}if(i){e.save(),Oo(e,"dcg-svg-tickmark");let A=t.settings.axisLineOffset,O=t.settings.axisOpacity,B=bm(O);e.lineWidth=t.settings.axisLineWidth,e.strokeStyle=B;let V=Math.round(t.mapy(0))-A,K=Math.round(t.mapx(0))-A,oe=Math.round(2*e.lineWidth)-A;e.beginPath(),q.forEach(Z=>{let ee=Math.round(t.mapx(Z.getValue()))-A;e.moveTo(ee,V-oe),e.lineTo(ee,V+oe)}),S.forEach(Z=>{let ee=Math.round(t.mapy(Z.getValue()))-A;e.moveTo(K-oe,ee),e.lineTo(K+oe,ee)}),e.stroke(),xo(e),e.restore()}return q.forEach(A=>{let O={x:t.mapx(A.getValue())-.5*A.getMinusWidth(),y:C-A.getRect().top+N},B=A.clampBoundsWithinRect(O,T);e.fillStyle=O.y===B.y||t.settings.yAxisScale==="logarithmic"?E:I;let V="dcg-svg-axis-value";O.x!==B.x&&(V+=" dcg-svg-offcenter-axis-value"),A.drawCenteredAt(e,B,V),yL(P,A.getRectWhenCenteredAt(B)),xo(e)}),S.forEach(A=>{let O={x:_-N-A.getRect().right,y:t.mapy(A.getValue())},B=A.clampBoundsWithinRect(O,T);e.fillStyle=O.x===B.x||t.settings.xAxisScale==="logarithmic"?E:I;let V="dcg-svg-axis-value";O.y!==B.y&&(V+=" dcg-svg-offcenter-axis-value"),A.drawCenteredAt(e,B,V),yL(F,A.getRectWhenCenteredAt(B)),xo(e)}),e.restore(),{x:P,y:F}}};function Ls(r,e,t){let o=Math.ceil(r/t),i=Math.floor(e/t);if(!rve({nmin:o,nmax:i}))return[];let n=[];for(let a=o;a<=i;a++)n.push(a*t);return n}var rve=({nmin:r,nmax:e})=>isFinite(e-r)&&e-r<=1e4;function o5(r){return{x:vQ("x",r),y:vQ("y",r)}}function vQ(r,e){let t=new Set,o=new Set,i=new Set,n=1;function a(he){return _?e.mapx(he):e.mapy(he)}function s(he,ae){return ym(a(ae)-a(he))}let c=(he,ae)=>{let $=he*ae,se=(he+1)*ae;if($<C&&se<C||$>D&&se>D)return;let J=he>=5?s(7*ae,8*ae):he>=2?s(3*ae,4*ae):s(ae,2*ae),ye=J/s($,se);if(J<40)return;let Se={settings:{pixelsPerLabel:e.settings.pixelsPerLabel*ye,labelSize:e.settings.labelSize,xAxisNumber:e.settings.xAxisNumbers,yAxisNumber:e.settings.yAxisNumbers},screen:{width:J,height:J},viewport:{xmin:$,ymin:$,xmax:se,ymax:se}},{minorStepX:Ce,majorStepX:Te}=zl(Se),Ae=Math.max($,C),je=Math.min(se,D);for(let ie=ry(Ae/Ce);ie<oy(je/Ce);ie++)i.add(ie*Ce);for(let ie=ry(Ae/Te);ie<oy(je/Te);ie++){let te=ie*Te;te<=$||te>=se||(o.add(te),t.add(te))}},d={label:[],major:[],minor:[],unitOpacity:1},{xAxisScale:p,yAxisScale:u,pixelsPerLabel:g}=e.settings,{xmin:h,xmax:b,ymin:v,ymax:T}=e.viewport,{width:E,height:I}=e.screen,_=r==="x",[C,D]=_?[h,b]:[v,T],P=_?E:I,F=_?p:u,N=e.settings.xAxisMinorSubdivisions!==0;if(F!=="logarithmic")return d;let Y=ry(bL(C)),z=oy(bL(D)),X=oy(bL(D)-bL(C)),q=s(10**Y,10**(Y+1)),S=15,A=100,O=q>S,B=[];q>6.25*g&&(B=[2,3,4,6,8]),q>12*g&&(B=[2,3,4,5,6,7,8]),q>14*g&&(B=[2,3,4,5,6,7,8,9]);let V=B.length!=0;if(S<=q&&q<=A&&(n=Math.sqrt((q-S)/(A-S))),!isFinite(X))return d;let K=ry(P/g),oe=Math.max(1,2**tve(xQ(X/K)));for(let he=oy(Y/oe);he<=ry(z/oe);he++)t.add(10**(he*oe));o=new Set([...t]);let Z=ry(P/S),ee=Math.max(1,2**oy(xQ(X/Z)));for(let he=oy(Y/ee);he<=ry(z/ee);he++)(O?o:i).add(10**(he*ee));if(O)for(let he=Y;he<z;he++){let ae=10**he;for(let $ of B)t.add($*ae);if(V){for(let $=2;$<=9;$++)o.add($*ae);for(let $=1;$<=9;$++)c($,ae)}else for(let $=2;$<=9;$++)i.add($*ae)}N&&(i=new Set);let ue=_?e.reverse_mapx(a(C)+g/4):e.reverse_mapy(a(C)-2*e.settings.labelSize);return{label:[...t].filter(he=>ue<=he&&he<=D),major:[...o].filter(he=>C<=he&&he<=D),minor:[...i].filter(he=>C<=he&&he<=D),unitOpacity:n}}function yL(r,e){e.left<r.left&&(r.left=e.left),e.right>r.right&&(r.right=e.right),e.top<r.top&&(r.top=e.top),e.bottom>r.bottom&&(r.bottom=e.bottom)}function xL(r,e){let t=ym(r),o=ym(e);return ym(t-o)<=(t<o?o:t)*1e-4}var d_=class{constructor(e){this.grapher=e,this.controller=this.grapher.controller,this.renderedTabTargetOrder=[],this.renderedTabTargets={}}recomputeImages(e){let{projection:t}=e;this.renderedTabTargets={},this.renderedTabTargetOrder=[];for(let o of this.grapher.generateMergeDrawOrder()){let i=this.controller.getItemModel(o);if(i&&i.type==="image"&&i.shouldGraph&&td(i)){let n=i.formula.dimensions;if(!n||!n.x||!n.y||!n.width||!n.height||!n.radianAngle)continue;for(let a=0;a<n.x.length;a++)if(UD(t,i,a)){this.renderedTabTargetOrder.push(o),this.renderedTabTargets[o]={id:o,description:this.getComputedDescription(i,a),x:n.x[a],y:n.y[a],radianAngle:n.radianAngle[a],width:n.width[a],height:n.height[a],widthScale:Math.abs(t.mapx(1)-t.mapx(0)),heightScale:Math.abs(t.mapy(1)-t.mapy(0)),screenX:t.mapx(n.x[a]),screenY:t.mapy(n.y[a]),centerId:i.formula.center_reference_id,selected:Mn(i)};break}}}this.speakAriaAlert()}getOrderedTabTargets(){return this.getTabIndex()===-1?[]:this.renderedTabTargetOrder.map(e=>{var o;let t=this.renderedTabTargets[e];return{calcId:t.id,listIndex:void 0,polygonEdge:void 0,description:this.controller.isGeometry()||(o=this.getAriaAlert({id:t.id,includeUsageInstructions:!0}))==null?void 0:o.completeMessage}})}getTabIndex(){if(this.controller.getActiveTool()!=="selection")return-1;let e=this.grapher.settings;return e.config.graphpaper&&e.config.enableTabindex?0:-1}getComputedDescription(e,t){let o=e.formula&&e.formula.computed_description&&e.formula.computed_description[t];return o&&o!==""?po(o):this.grapher.getAudioTrace().getExpressionAriaLabel(e.id)}speakAriaAlert(){if(this.controller.isGeometry())return;let e=this.getFocusedImage();if(!e){this.lastAriaAlert=void 0;return}let t=e.id,o=this.getAriaAlert({id:t,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!0});this.lastAriaAlert=o,o&&o.completeMessage&&_e(o.completeMessage)}getAriaAlert(e){let{id:t,lastAriaAlert:o,includeUsageInstructions:i}=e;if(!t)return;let n=this.controller.getItemModel(t);if(!n||n.type!=="image")return;let a=this.renderedTabTargets[t];if(!a)return;o&&o.id!==t&&(o=void 0);let s=o==null?void 0:o.label,c=a.description,d=s!==c,p=!!(o!=null&&o.selected),u=a.selected,g=p!==u,h=o&&o.coordX,b=o&&o.coordY,v=a.x,T=a.y,E=v!==h||T!==b,I=this.grapher.getProjection(),_=Gl(this.controller,v,T),C=c,D=i?this.controller.s("graphing-calculator-narration-movable-point-suffix-usage-instructions"):"",P=this.isImageFullyVisible(n,I)?"":this.controller.s("graphing-calculator-narration-draggable-image-off-screen-prompt"),F;return o?d||!E&&g?F=C+P:E?F=_+P:F="":F=this.controller.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:C,coordinates:_})+D+P,{id:t,coordX:v,coordY:T,label:c,completeMessage:F}}getFocusedImage(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();return e?this.renderedTabTargets[e.calcId]:void 0}speakImageAttribute(e,t){if(!(!e||!this.grapher.getAudioTrace()||!this.grapher.getProjection()))switch(t){case"X":_e(cd(this.controller,e.x));break;case"Y":_e(dd(this.controller,e.y));break;case"L":_e(e.description);break}}isImageFullyVisible(e,t){let o=e.formula.dimensions;if(!o||!o.x||!o.y)return!1;for(let i=0;i<o.x.length;i++)if(!t.coordsAreOnscreen(t.mapx(o.x[i]),t.mapy(o.y[i])))return!1;return!0}};var wL=class{constructor(e){this.savedPOI=[],this.controller=e}redrawToCtx(e,t,o,i,n){let{ctx:a,projection:s}=e,c=[];for(let d of c_(n)){let p=t[d];if(!p)continue;if(p.hoistToTop&&!this.controller.isGeometry()){let g=p.showHighlight;g&&e.projection.settings.setProperty("highlight",!0),ud.drawSketchToCtx({sketch:p,drawContext:e,poiLabelsLayer:o,clickableObjectsLayer:i,geometryContext:this.controller.getGeoModel()}),g&&e.projection.settings.setProperty("highlight",!1)}let u=p.getPOI();(p.showPOI||u.length&&u[0].isAttachedToPlottedPoint())&&c.push.apply(c,this.drawPOIs(u,a,s))}this.savedPOI=c}getDrawnPOI(){return this.savedPOI}drawPOIs(e,t,o){t.lineWidth=o.settings.pointLineWidth,t.strokeStyle="#AAAAAA",t.fillStyle="#AAAAAA",t.lineJoin="round",t.lineCap="round";let i=[];if(e.length&&e[0].isAttachedToPlottedPoint())for(let n of e)ud.mapPointToScreen(o,n.x,n.y)&&i.push(n);else for(let n of e)ud.drawPointToCtx({ctx:t,projection:o,enableWhiteOutline:!1,style:__dcg_shared_module_exports__['Cd'].POINT,...n})&&i.push(n);return i}};jo();var p_=__dcg_shared_module_exports__['e'](j()),SL=class extends p_.View{template(){return l("div",{class:this.const(Tx),style:()=>({width:this.props.width(),height:this.props.height(),position:"fixed",left:"0px",top:"0px"}),children:l("div",{class:p_.const("dcg-container"),children:l("div",{class:p_.const("dcg-grapher"),style:()=>({"font-size":this.props.concreteFontSize()})})})})}};var Ed=class extends Cd{generateDefaultName(){return"does not matter"}};var wQ="graphing-calculator-text-geometry-tool-rotation-hint-center",ove="graphing-calculator-text-geometry-tool-rotation-hint-angle",ive="graphing-calculator-text-geometry-tool-rotation-hint-angle-start",nve="graphing-calculator-text-geometry-tool-rotation-hint-angle-end",iy=class extends Ed{constructor(t){super(t);this.model=t;this.displayNameKey="graphing-calculator-text-geometry-tool-rotate-display-name",this.toolName="rotation",this.toolType="transformation"}getMode(){let{idMap:t}=this.model.getNonObjectsState().ui.currentTool;return t["2-number"]?"number":"directed-angle"}getExpressionEditHint(t){return t===0?this.s(wQ):this.s(ove)}onNumberInput(t){super.onNumberInput(t),this.clearTentativeOutputs()}onMove(t){return this.getMode()==="number"&&this.model.getNonObjectsState().ui.currentTool.inputIndex===1?!1:super.onMove(t)}getSpecIdToLockIn(t,o){if(o===1){let i=t.inputs[o];return this.getMode()==="number"?`${i.id}-number`:i.id}return super.getSpecIdToLockIn(t,o)}getPartialAnglePreviewInfo(){let{inputIndex:t,idMap:o}=this.model.getNonObjectsState().ui.currentTool;if(t>0){let i=this.model.findDefsForInputId(o[1])[0];if(!i)return;let n=[i.typedRuntimeValue],a=this.model.findDefsForInputId(o[2])[0],s=this.model.findDefsForInputId(o[3])[0];if(a&&s&&n.push(a.typedRuntimeValue,s.typedRuntimeValue),i)return{id:o["angle-output"],type:"rotation-with-incomplete-angle",args:n}}}getSpec(){let t={inputs:[{type:"point",id:"1",hint:wQ},{type:"union",valueTypes:[__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['U']],id:"2",hint:ive,numberInputInfo:{defaultLatex:"",sliderInfo:{value:this.model.controller.getDegreeMode()?"90":"1.57079632679",min:"0",max:this.model.controller.getDegreeMode()?"360":"2\\pi"}}}],outputs:[]},o={id:"number-output",type:"rotate",hidden:this.getMode()!=="number",name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2-number"}]};if(this.getMode()==="directed-angle"){let{idMap:i,inputIndex:n}=this.model.getNonObjectsState().ui.currentTool;n>1&&delete t.inputs[1].numberInputInfo;let a=i[2],s=!1,c=a&&this.model.findDefsForInputId(a)[0];s=!!(c&&c.typedRuntimeValue.valueType==__dcg_shared_module_exports__['C']),s?(t.inputs.push({type:"point",id:"3",hint:nve}),t.outputs.push({id:"directed-angle",type:"directedangle",hidden:!1,showAngleLabel:!1,parents:[{type:"reference-input",id:"2"},{type:"reference-input",id:"1"},{type:"reference-input",id:"3"}]},{id:"angle-output",type:"rotate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"directed-angle"}]})):t.outputs.push({id:"angle-output",type:"rotate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]})}else t.outputs.push(o);return t}};var SQ="graphing-calculator-text-geometry-tool-vector-hint-start",ave="graphing-calculator-text-geometry-tool-vector-hint-end",sve="graphing-calculator-text-geometry-tool-vector-copy-hint-end",lve={name:"vector",displayNameKey:"graphing-calculator-text-geometry-tool-vector-display-name",toolType:"simple",icon:[{type:"stroked-path",path:[32,68,65,35],lineWidth:"large",arrow:!0},{type:"point",x:32,y:68},{type:"point",x:68,y:32}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['C']],hints:[SQ,ave]},output:[{type:"vector",parents:[0,1]}]},{input:{broadcast:!1,types:[__dcg_shared_module_exports__['Y'],__dcg_shared_module_exports__['C']],hints:[SQ,sve]},output:[{type:"vector-copy",parents:[0,1]}]}]},u_=class extends Lr{constructor(t){super(t,lve);this.model=t}};function cve(r){return Array.isArray(r)&&r.length===2&&r.every(e=>Array.isArray(e)&&e.length===2&&e.every(t=>!Array.isArray(t)&&!isNaN(t)))}function ny(r){if(!cve(r))return __dcg_shared_module_exports__['Ob'](__dcg_shared_module_exports__['Y']);let e=r[1][0],t=r[1][1],o=r[1][0]+r[0][0],i=r[1][1]+r[0][1];return[[e,t],[o,i]]}var dve=14,kQ=2.5,pve=40,uve=15,hve=.75,gve=1;function xm(r){return r.valueType===__dcg_shared_module_exports__['C']?r.value:r.valueType===__dcg_shared_module_exports__['F']?r.value[0]:void 0}function mve(r){return r.valueType===__dcg_shared_module_exports__['Y']?r.value:r.valueType===__dcg_shared_module_exports__['Z']?r.value[0]:void 0}function fve(r){return r.valueType===__dcg_shared_module_exports__['O']||r.valueType===__dcg_shared_module_exports__['Q']||r.valueType===__dcg_shared_module_exports__['K']||r.valueType===__dcg_shared_module_exports__['Y']?{segment:r.valueType===__dcg_shared_module_exports__['K'],value:r.value}:r.valueType===__dcg_shared_module_exports__['P']||r.valueType===__dcg_shared_module_exports__['R']||r.valueType===__dcg_shared_module_exports__['L']||r.valueType===__dcg_shared_module_exports__['Z']?{segment:r.valueType===__dcg_shared_module_exports__['L'],value:r.value[0]}:void 0}function _Q(r){return r.valueType===__dcg_shared_module_exports__['B']?r.value:r.valueType===__dcg_shared_module_exports__['E']?r.value[0]:void 0}function CQ(r){return r.valueType===__dcg_shared_module_exports__['U']?r.value:r.valueType===__dcg_shared_module_exports__['V']?r.value[0]:void 0}var kL=class{constructor(e){this.controller=e.controller}getTransformationPreviewInfoFromItem(e,t){var n;if(e.type!=="expression"||e.hidden)return;let{translationsWithVisibleVectorParent:o}=t.transformationPreviewParentData;if(o.has(e.id))return;let i=(n=e.formula.geometry)==null?void 0:n.transformation_preview_info;if(i)return{...i,id:e.id}}getInprogressTransformation(e){let t=this.controller.getAllToolPreviewItems();for(let i of t){let n=this.getTransformationPreviewInfoFromItem(i,e);if(n)return n}let o=this.controller.getGeoModel().getCurrentTool();if(o instanceof iy)return o.getPartialAnglePreviewInfo()}getHoveredOrSelectedTransformations(e){let t=this.controller.getAllSelectedItems(),o=this.controller.getHoveredOrFocusedTokenIdentifier(),i=o?this.controller.getItemsByIdentifier(o)[0]:void 0;i&&!t.some(a=>a.id===i.id)&&t.push(i);let n=[];return t.forEach(a=>{if(a.type!=="expression")return;let s=this.getTransformationPreviewInfoFromItem(a,e);s&&n.push(s)}),n}drawTranslationPreview(e,t,o,i){let n=t.mapx(o[0]),a=t.mapy(o[1]),s=t.mapx(i[0]),c=t.mapy(i[1]);e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=5,e.moveTo(n,a),e.lineTo(s,c),pd(e,n,a,s,c,20),e.stroke(),e.restore()}drawReflectionPreview(e,t,o){let i=o.value,n=o.segment,[a,s,c,d]=Cb([i[0][0],i[0][1],i[1][0],i[1][1]],t,18).clipped,p=(a+c)/2,u=(s+d)/2;if(n){let[I,_,C,D]=Cb([i[0][0],i[0][1],i[1][0],i[1][1]],t,17).clipped;p=(I+C)/2,u=(_+D)/2}if(isNaN(p)&&isNaN(u))return;let g=40,h=g/__dcg_shared_module_exports__['k'](a-c,s-d),b=p+(d-s)*h,v=u-(c-a)*h,T=p-(d-s)*h,E=u+(c-a)*h;if(e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=4,e.moveTo(a,s),e.lineTo(c,d),this.controller.getGraphSettings().config.reflectionArc){let I=Math.atan2(v-u,b-p),_=g,C=g*.7;e.moveTo(b,v),e.ellipse(p,u,_,C,I,0,Math.PI,!1);let D=.35,P=I+Math.PI/2+D,F=I+Math.PI/2-D;pd(e,b+Math.cos(P),v+Math.sin(P),b,v,10),pd(e,T+Math.cos(F),E+Math.sin(F),T,E,10)}else e.moveTo(b,v),e.lineTo(T,E),pd(e,p,u,b,v,10),pd(e,p,u,T,E,10);e.stroke(),e.restore()}drawDilationPreview(e,t,o,i){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=3;let n=i<.6||i>1.4&&i<2?6:10,a=t.pixelsToMath.mapX(25)-t.pixelsToMath.mapX(0);[[a,0],[0,a],[-a,0],[0,-a]].forEach(s=>{let c=[o[0]+s[0],o[1]+s[1]],d=__dcg_shared_module_exports__['pc'](__dcg_shared_module_exports__['mc'](o,i),c),[p,u]=t.map_xy_pairs(c),[g,h]=t.map_xy_pairs(d);e.moveTo(p,u),e.lineTo(g,h),pd(e,p,u,g,h,n)}),e.stroke(),e.restore()}drawRotationPreview(e,t,o,i,n,a){if(this.drawRotationCenterPreview(e,t,o),!(n===void 0||!isFinite(n))){if(a!==void 0&&a!==0&&isFinite(a)){if(i&&i[0]===o[0]&&i[1]===o[1])return;this.drawFullRotationAngle(e,t,o,n,a,!1)}else if(i){this.drawPlaceholderRotationAngle(e,t,i,n);return}}}drawFullRotationAngle(e,t,o,i,n,a){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=kQ;let s=pve,c=-i,d=-n,p,u;if(a){let E=Cb([o[0],o[1],o[0]+Math.cos(i),o[1]+Math.sin(i)],t,19).clipped;p=E[0],u=E[1];let I=Cb([o[0],o[1],o[0]+Math.cos(i+n),o[1]+Math.sin(i+n)],t,19).clipped;e.moveTo(p,u),e.lineTo(E[2],E[3]),e.moveTo(p,u),e.lineTo(I[2],I[3]);let _=s*Math.abs(d),C=.5*(1-hve)*_,D=Math.min(C,uve),P=(d>0?1:-1)*D/s;c+=P,d-=2*P}else[p,u]=t.map_xy_pairs(o);let g=d<=0,h=p+s*Math.cos(c),b=u+s*Math.sin(c),v=p+s*Math.cos(c+d),T=u+s*Math.sin(c+d);e.moveTo(h,b),e.arc(p,u,s,c,c+d,g),YN(e,v,T,c,d,10,s),e.stroke(),e.restore()}drawPlaceholderRotationAngle(e,t,o,i){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=gve;let n=-i,[a,s]=t.map_xy_pairs(o);e.moveTo(a,s);let c=1.5*tm(0,t);e.lineTo(a+c*Math.cos(n),s+c*Math.sin(n)),e.stroke(),e.restore()}drawRotationCenterPreview(e,t,o){let[i,n]=t.map_xy_pairs(o);e.save(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=kQ,e.beginPath(),e.arc(i,n,dve,0,2*Math.PI),e.stroke(),e.restore()}redrawToCtx(e){let{ctx:t,projection:o}=e,i=this.getInprogressTransformation(e),n=this.getHoveredOrSelectedTransformations(e);i&&n.push(i);for(let a=0;a<n.length;a++){let s=n[a],c=s.args;switch(s.type){case"translate":if(c.length===2){let d=xm(c[0]),p=xm(c[1]);d&&p&&this.drawTranslationPreview(t,o,d,p)}else if(c.length===1){let d=mve(c[0]);if(d){let[p,u]=ny(d);this.drawTranslationPreview(t,o,p,u)}}break;case"reflect":{let d=fve(c[0]);d&&this.drawReflectionPreview(t,o,d)}break;case"dilate":{let d=xm(c[0]),p=_Q(c[1]);d&&p!==void 0&&isFinite(p)&&p!==1&&this.drawDilationPreview(t,o,d,p)}break;case"rotate":{let d=xm(c[0]);if(!d)return;let p=_Q(c[1]),u=CQ(c[1]),g,h;if(p!==void 0)h=this.controller.getDegreeMode()?p*Math.PI/180:p,g=0;else if(u)g=u[1],h=u[2],e.transformationPreviewParentData.rotationsWithVisibleAndCenteredAngle.has(s.id)&&(h=void 0);else return;this.drawRotationPreview(t,o,d,u?u[0]:void 0,g,h)}break;case"rotation-with-incomplete-angle":{let d=xm(c[0]);if(!d)return;let p,u;if(c.length>=3){let g=xm(c[1]);if(p=xm(c[2]),!d||!g||!p)return;let h=g[0]-p[0],b=g[1]-p[1];u=Math.atan2(b,h)}this.drawRotationPreview(t,o,d,p,u,void 0)}}}}};function TQ(r){var d,p,u,g,h,b,v,T,E,I;let e=new Set,t=new Set,o=new Set,i=new Set,n={},a={};for(let _ of[...r.getAllItemModels(),...r.getAllToolPreviewItems()]){if(_.type!=="expression"||ji(_))continue;let C=_.formula.typed_constant_value;if(!C)continue;if(__dcg_shared_module_exports__['wa'](C.valueType,__dcg_shared_module_exports__['Y'])){let P=(d=Go(_))==null?void 0:d.identifier;P&&(n[P]=_.id)}let D=CQ(C);if(D){let P=(p=Go(_))==null?void 0:p.identifier;P&&(a[P]={id:_.id,value:D})}}let s=r.getHoveredOrFocusedTokenIdentifier(),c=[...r.getAllItemModels().filter(_=>{var C;if(r.isItemSelected(_.id))return!0;if(_.type==="expression"&&s){let D=(C=Go(_))==null?void 0:C.identifier;return s===D}return!1}),...r.getAllToolPreviewItems()];for(let _ of c){if(_.type!=="expression")continue;let C=_.formula.geometry,D=C==null?void 0:C.transformation_preview_info;if(((u=C==null?void 0:C.call)==null?void 0:u.symbol)==="translate"&&(D==null?void 0:D.args.length)===1&&__dcg_shared_module_exports__['wa'](D.args[0].valueType,__dcg_shared_module_exports__['Y'])){let P=(b=(h=(g=_.formula.geometry)==null?void 0:g.call)==null?void 0:h.parents)==null?void 0:b[0];if(!P||P.type==="arbitrary-expression")continue;let F=n[__dcg_shared_module_exports__['Oc'](P)];F&&(e.add(_.id),t.add(F))}if(((v=C==null?void 0:C.call)==null?void 0:v.symbol)==="rotate"&&(D!=null&&D.args)&&(D==null?void 0:D.args.length)>1&&__dcg_shared_module_exports__['wa'](D.args[1].valueType,__dcg_shared_module_exports__['U'])){let P=(I=(E=(T=_.formula.geometry)==null?void 0:T.call)==null?void 0:E.parents)==null?void 0:I[1];if(!P||P.type==="arbitrary-expression")continue;let F=a[__dcg_shared_module_exports__['Oc'](P)];if(!F)continue;i.add(F.id);let N=xm(D.args[0]);if(!N)continue;F.value[0][0]===N[0]&&F.value[0][1]===N[1]&&o.add(_.id)}}return{translationsWithVisibleVectorParent:e,translationPreviewVectorParents:t,rotationsWithVisibleAndCenteredAngle:o,rotationPreviewAngleMarkerParents:i}}var $a=class $a{constructor(e=0,t=0,o=1,i=o){this.tx=e,this.ty=t,this.sx=o,this.sy=i}toJSON(){return{tx:this.tx,ty:this.ty,sx:this.sx,sy:this.sy}}compose(e){return new $a(this.sx*e.tx+this.tx,this.sy*e.ty+this.ty,this.sx*e.sx,this.sy*e.sy)}translate(e,t){let o=t===void 0?e.x:t.x-e.x,i=t===void 0?e.y:t.y-e.y;return new $a(this.tx+o,this.ty+i,this.sx,this.sy)}scale(e,t){return $a.scale(e,t).compose(this)}scaleAtPoint(e,t,o=t){return $a.scaleAtPoint(e,t,o).compose(this)}mapX(e){return this.sx*e+this.tx}mapY(e){return this.sy*e+this.ty}mapPoint(e){return{x:this.mapX(e.x),y:this.mapY(e.y)}}mapRect(e){return{left:this.mapX(e.left),right:this.mapX(e.right),bottom:this.mapY(e.bottom),top:this.mapY(e.top)}}};$a.scale=function(e,t=e){return new $a(0,0,e,t)},$a.translate=function(e,t){return new $a().translate(e,t)},$a.scaleAtPoint=function(e,t,o=t){return o===void 0&&(o=t),new $a(e.x*(1-t),e.y*(1-o),t,o)},$a.fromRects=function(e,t){let o=(t.right-t.left)/(e.right-e.left),i=(t.top-t.bottom)/(e.top-e.bottom);return new $a(t.left-o*e.left,t.bottom-i*e.bottom,o,i)},$a.fromJSON=function(e){return new $a(e.tx,e.ty,e.sx,e.sy)};var Ah=$a;Ut();var{log10:_L}=Math;function i5(r,e){let t=e.x-r.x,o=e.y-r.y,i=.5*(r.x+e.x),n=.5*(r.y+e.y),a=.5*__dcg_shared_module_exports__['k'](t,o);return{center:Ja(i,n),radius:a}}function EQ(r,e){let t={x:2*r.x-e.x,y:2*r.y-e.y};return i5(e,t)}function IQ(r,e){let t=[];for(let o=0;o<r.length;o++)t.push(Ja(r[o].pageX-e.left,r[o].pageY-e.top));return t}function Ja(r,e){return{x:r,y:e}}function MQ(r){return Ja(.5*(r.left+r.right),.5*(r.bottom+r.top))}var xve=0,CL=class{constructor(e,t){this.s=Qc(()=>this.grapher.settings.config.language);this.grapher=e,this.elt=e.elt,this.id=xve++,this.controller=t,this.isScalingEnabled=!1,this.mousePt=Ja(0,0),this.lastScrollZoom=Date.now(),this.preventScrollZoom=!1,this.addMouseWheelEventHandler(),this.addTouchEventHandler()}remove(){re(window).off(".viewportcontroller-"+this.id)}getViewport(){return this.grapher.getProjection().viewport}getProjection(){return this.grapher.getProjection()}isViewportLocked(){return this.grapher.controller.zoomAndPanDisabled()}updateMouse(e){let t=this.elt.getBoundingClientRect();this.mousePt=Ja(e.clientX-t.left,e.clientY-t.top)}updateScaleAxis(){this.isMouseInViewport()&&(this.isMouseNearYAxis()?this.grapher.scaleAxis="y":this.isMouseNearXAxis()?this.grapher.scaleAxis="x":this.grapher.scaleAxis="both"),this.updateCursor(),this.controller.requestRedrawGraph()}updateCursor(){this.elt.classList.toggle("dcg-scale-horizontal",this.grapher.scaleAxis==="x"),this.elt.classList.toggle("dcg-scale-vertical",this.grapher.scaleAxis==="y"),this.elt.classList.toggle("dcg-scale-both",this.grapher.scaleAxis==="both")}isMouseNearOrigin(){let t=this.getProjection().mathToPixels.mapPoint(Ja(0,0));return Math.abs(this.mousePt.x-t.x)<50&&Math.abs(this.mousePt.y-t.y)<50}isMouseNearXAxis(){let e=this.getProjection(),t=e.pixelCoordinates,o=e.mathToPixels.mapY(0);return o=Math.min(Math.max(t.top,o),t.bottom),Math.abs(this.mousePt.y-o)<40&&e.settings.showXAxis}isMouseNearYAxis(){let e=this.getProjection(),t=e.pixelCoordinates,o=e.mathToPixels.mapX(0);return o=Math.min(Math.max(t.left,o),t.right),Math.abs(this.mousePt.x-o)<40&&e.settings.showYAxis}isMouseInViewport(){let e=this.getProjection(),t=e.mathCoordinates,o=e.pixelsToMath.mapPoint(this.mousePt);return o.x>=t.left&&o.x<=t.right&&o.y>=t.bottom&&o.y<=t.top}_setViewportWithoutCancellingAnimation(e){if(!e.isValid(this.controller.getAxisScaleSettings())||e.equals(this.getViewport()))return;let o=this.getProjection();this.grapher._setProjection(new pl(o.screen,e,o.settings))}setViewport(e){this.cancelAnimation(),this._setViewportWithoutCancellingAnimation(e)}setScreen(e){let t=this.getProjection(),o=t.settings.squareAxes?t.viewport.squareYAxis(e,t.settings):t.viewport,i=new pl(e,o,t.settings);this.grapher._setProjection(i)}getTransformedViewport(e){let{pixelCoordinates:t,mathCoordinates:o,settings:i}=this.getProjection(),{xAxisScale:n,yAxisScale:a}=i,s=e.mapRect(t),c=__dcg_shared_module_exports__['jd'].fromRectsInverse(o,s,{xAxisScale:n,yAxisScale:a}).mapRect(t);return new Or(c.left,c.right,c.bottom,c.top)}transformViewport(e){this.setViewport(this.getTransformedViewport(e)),(this.grapher.scaleAxis==="x"||this.grapher.scaleAxis==="y")&&this.controller.markSquareAxesAfterUserEditedViewport()}animateToViewport(e){this.cancelAnimation();let t=this.getProjection(),o=t.viewport,i=t.mathToPixels,n=0,a,s=c=>{a||(a=c);let d=(c-a)/500;if(n+=d,n<1){this.__animationTimeout=requestAnimationFrame(s);let p=i.interpolateX(o.xmin,e.xmin,n),u=i.interpolateX(o.xmax,e.xmax,n),g=i.interpolateY(o.ymin,e.ymin,n),h=i.interpolateY(o.ymax,e.ymax,n);this._setViewportWithoutCancellingAnimation(new Or(p,u,g,h)),this.grapher.debounceUserRequestedViewportChange()}else this.setViewport(Or.fromObject(e)),this.grapher.debounceUserRequestedViewportChange(),this.controller.markSquareAxesAfterUserEditedViewport()};this.__animationTimeout=requestAnimationFrame(s)}cancelAnimation(){cancelAnimationFrame(this.__animationTimeout)}addMouseWheelEventHandler(){let e=!1,t,o;re(window).on("scroll.viewportcontroller-"+this.id,a=>{e=!0}),re(window).on("wheel.viewportcontroller-"+this.id,a=>{t=a.clientX,o=a.clientY}),re(window).on("mousemove.viewportcontroller-"+this.id,a=>{if(!e)return;let s=a.clientX-t,c=a.clientY-o;s*s+c*c<100||(e=!1)});let i=0,n=a=>{let s=a.originalEvent;if(s.deltaX===0&&s.deltaY===0)return;let c=Date.now(),d=c-this.lastScrollZoom;if(this.preventScrollZoom&&d>50&&(this.preventScrollZoom=!1),this.lastScrollZoom=c,this.preventScrollZoom)return;let p=this.getProjection();if(this.isViewportLocked())return;let u=p.mathToPixels;if(e)return;s.preventDefault(),this.updateMouse(s);let g=u.mapPoint(Ja(0,0)),b=(s.deltaY===0?-s.deltaX:-s.deltaY)>0?1:-1,v=this.isMouseNearOrigin()&&b>0?g:this.mousePt;if(i>0)return;i+=1,requestAnimationFrame(()=>{i--});let{xAxisScale:T,yAxisScale:E}=p.settings,I=.0625;(T==="logarithmic"||E==="logarithmic")&&d<25&&(I*=Math.max(10,d)/25);let _=b>0?1+I:1/(1+I),C=this.grapher.scaleAxis,D=C==="x"||C==="both"||!C?_:1,P=C==="y"||C==="both"||!C?_:1,F=Ah.scaleAtPoint(v,D,P),N=this.getTransformedViewport(F);b==-1&&this.tooBig(N)||b==1&&this.tooSmall(N)||(this.transformViewport(F),this.grapher.debounceUserRequestedViewportChange())};re(this.elt).on("wheel",n)}applyPanTouchChanges(e,t){if(this.isViewportLocked()||this.isScalingEnabled)return;let o=Ja(t[0].x-e[0].x,t[0].y-e[0].y);this.transformViewport(Ah.translate(o)),this.grapher.debounceUserRequestedViewportChange()}chooseDragScaleCenter(){let e=this.getProjection(),t=e.pixelCoordinates,o=e.mathToPixels.mapX(0),i=e.mathToPixels.mapY(0);return o=Math.min(Math.max(t.left,o),t.right),i=Math.min(Math.max(t.top,i),t.bottom),Ja(o,i)}applyScaleTouchChanges(e,t){if(this.isViewportLocked())return;let o=this.grapher.scaleAxis,i,n;if(e.length===2&&t.length===2)i=i5(e[0],e[1]),n=i5(t[0],t[1]);else if(t.length===1){let u=this.chooseDragScaleCenter();i=EQ(u,e[0]),n=EQ(u,t[0])}else return;let a=n.radius/i.radius,s=o==="y"?1:a,c=o==="x"?1:a,d=Ah.scaleAtPoint(i.center,s,c).translate(i.center,n.center),p=this.getTransformedViewport(d);a<1&&this.tooBig(p)||a>1&&this.tooSmall(p)||(this.transformViewport(d),this.grapher.debounceUserRequestedViewportChange())}panFromKeyboard(e){if(this.isViewportLocked()||this.isScalingEnabled)return;let t=Ja(0,0);e==="Up"?(_e(this.s("graphing-calculator-narration-viewport-pan-up")),t=Ja(0,-5)):e==="Down"?(_e(this.s("graphing-calculator-narration-viewport-pan-down")),t=Ja(0,5)):e==="Left"?(_e(this.s("graphing-calculator-narration-viewport-pan-left")),t=Ja(-5,0)):e==="Right"&&(_e(this.s("graphing-calculator-narration-viewport-pan-right")),t=Ja(5,0)),this.transformViewport(Ah.translate(t)),this.grapher.debounceUserRequestedViewportChange()}addTouchEventHandler(){let e=[],t=!1,o=!0,i=!0,n=h=>{t||this.isViewportLocked()||(this.updateMouse(h.originalEvent),this.isScalingEnabled&&this.updateScaleAxis())};re(window).on("mousemove.viewportcontroller-"+this.id,n),this.beginPanning=h=>{let b=this.getProjection();if(this.isViewportLocked()||t||h.touches.length!==h.changedTouches.length)return;t=!0,this.grapher.isDragging=!0,this.updateMouse(h);let v=b.mathToPixels.mapPoint(Ja(0,0)),T=this.grapher.scaleAxis;(T==="x"||T==="both")&&(o=this.mousePt.x>v.x),(T==="y"||T==="both")&&(i=this.mousePt.y>v.y),this.controller.dispatch({type:"grapher/drag-start"}),re(document).on("dcg-tapmove.graphdrag",u),re(document).on("dcg-tapstart.graphdrag dcg-tapend.graphdrag dcg-tapcancel.graphdrag",g)};let a=h=>{if(h.length<2)return;let b=this.grapher.getProjection(),v=b.pixelCoordinates,T=b.mathToPixels.mapX(0),E=b.mathToPixels.mapY(0),I=40;T=Math.min(Math.max(v.left,T),v.right),E=Math.min(Math.max(v.top,E),v.bottom);let _=h[1].x-h[0].x,C=h[1].y-h[0].y;return Math.abs(h[0].x-T)<I&&Math.abs(h[1].x-T)<I&&Math.abs(C)>3*Math.abs(_)&&b.settings.showYAxis?"y":Math.abs(h[0].y-E)<I&&Math.abs(h[1].y-E)<I&&Math.abs(_)>3*Math.abs(C)&&b.settings.showXAxis?"x":"both"},s=h=>(this.grapher.scaleAxis||(this.grapher.scaleAxis=a(h)),this.grapher.scaleAxis),c=()=>{this.grapher.scaleAxis&&(this.grapher.scaleAxis=void 0,this.controller.requestRedrawGraph(),this.updateCursor())},d=()=>{this.isScalingEnabled=!1,this.preventScrollZoom=!0,c()},p=h=>h.altKey||h.ctrlKey||h.metaKey,u=h=>{let b=h;if(!t||this.isViewportLocked())return;let v=IQ(b.touches,yo(this.elt));if(e.length===2&&v.length===2)s(v),this.applyScaleTouchChanges(e,v);else if(e.length===1&&this.isScalingEnabled){this.updateMouse(b);let T=this.grapher.scaleAxis,I=this.getProjection().mathToPixels.mapPoint(Ja(0,0)),_,C,D=5,P=o?1:-1,F=i?1:-1;if((T==="x"||T==="both")&&(_=this.mousePt.x>I.x+D*P),(T==="y"||T==="both")&&(C=this.mousePt.y>I.y+D*F),T==="x"&&o!==_||T==="y"&&i!==C||T==="both"&&o!==_&&i!==C)return;this.applyScaleTouchChanges(e,v)}else c();e.length===1&&this.applyPanTouchChanges(e,v),this.controller.dispatch({type:"grapher/drag-move"}),e=v},g=h=>{let b=h;t&&(this.cancelAnimation(),e=IQ(b.touches,yo(this.elt)),b.touches.length===0&&(t=!1,this.grapher.isDragging=!1,re(document).off(".graphdrag"),this.grapher.debounceUserRequestedViewportChange(),this.controller.dispatch({type:"grapher/drag-end"})),(b.touches.length===0||b.touches.length===1&&!this.isScalingEnabled)&&c())};re(window).on("keydown.viewportcontroller-"+this.id,h=>{this.controller.isGeoToolActive()||this.isViewportLocked()||(Pe(h)===l0&&!p(h)&&this.shouldAllowShiftScaling()?(this.isScalingEnabled=!0,this.grapher.scaleAxis||this.updateScaleAxis()):d())}),re(window).on("keyup.viewportcontroller-"+this.id+" blur.viewportcontroller-"+this.id,d)}shouldAllowShiftScaling(){return!this.controller.isGeometry()}zoom(e){let t=this.getProjection().pixelCoordinates;if(e==="in"){let o=this.getTransformedViewport(Ah.scaleAtPoint(MQ(t),2));this.tooSmall(o)||this.animateToViewport(o),_e(this.s("graphing-calculator-narration-viewport-zoom-in"))}else if(e==="out"){let o=this.getTransformedViewport(Ah.scaleAtPoint(MQ(t),.5));this.tooBig(o)||this.animateToViewport(o),_e(this.s("graphing-calculator-narration-viewport-zoom-out"))}else if(e==="square"){let o=this.getSquareViewport();this.getProjection().settings.setProperty("squareAxes",!0),this.animateToViewport(o),_e(this.s("graphing-calculator-narration-viewport-zoom-square"))}else e==="default"&&this.setDefaultViewport()}tooBig(e){let t=this.getProjection(),{xAxisScale:o,yAxisScale:i}=t.settings,{xmin:n,xmax:a,ymin:s,ymax:c}=e;return o==="logarithmic"&&_L(a)-_L(n)>60||i==="logarithmic"&&_L(c)-_L(s)>60||this.controller.isGeometry()&&a-n>1e5}tooSmall(e){let{xmin:t,xmax:o}=e;return this.controller.isGeometry()&&o-t<1e-4}zoomSquareImmediately(){this.setViewport(this.getSquareViewport())}zoomCustom(e){this.animateToViewport(e),_e(this.s("graphing-calculator-narration-viewport-updated"))}setDefaultViewport(){let e=this.controller.getDefaultViewport();this.animateToViewport(e),_e(this.s("graphing-calculator-narration-viewport-default"))}isDefaultViewportRestored(){let e=this.getProjection(),{xAxisScale:t,yAxisScale:o}=e.settings,i=t==="linear",n=o==="linear",a=e.viewport,s=this.controller.getDefaultViewport(),c=i?a.xmax-a.xmin:Math.log(a.xmax/a.xmin),d=n?a.ymax-a.ymin:Math.log(a.ymax/a.ymin),p=i?a.xmin-s.xmin:Math.log(a.xmin/s.xmin),u=i?a.xmax-s.xmax:Math.log(a.xmax/s.xmax),g=n?a.ymin-s.ymin:Math.log(a.ymin/s.ymin),h=n?a.ymax-s.ymax:Math.log(a.ymax/s.ymax),b=.025;return Math.abs(p/c)<b&&Math.abs(u/c)<b&&Math.abs(g/d)<b&&Math.abs(h/d)<b}getSquareViewport(){let e=this.getProjection();return e.settings.lastChangedAxis==="y"?e.viewport.squareXAxis(e.screen,e.settings):e.viewport.squareYAxis(e.screen,e.settings)}};function vve(){return new Kl(1024,768)}function DQ(r){let{xAxisScale:e,yAxisScale:t}=r;return new Or(...e==="linear"?[-Jg,Jg]:[10**-Zg,10**Zg],...t==="linear"?[-Jg,Jg]:[10**-Zg,10**Zg])}var wve=document.createElement("canvas"),ay=class r extends hw{constructor(t,o,i,n){super({elt:t,settings:o,controller:i,evaluator:n});this.type="2d";this.__screenRequested3D=new Kl(768,768);this.lastActiveToken={selected:void 0,hovered:void 0};let a=vve(),s=DQ(o).squareYAxis(a,o);this.setUserRequestedViewport(s),this.__projection=new pl(a,s,o),this.markLabelsDirty=__dcg_shared_module_exports__['_a'](()=>{this.evaluator.notifyWhenSynced(()=>{this.poiLabelsLayer.markLabelsDirty(),this.controller.requestRedrawGraph()})},300),this.poiController=new pw(this,o),this.viewportController=new CL(this,this.controller),this.showPOIDots=!0,this.graphSketches={},this.graphImages={},this.audioGraph=new HA(i,this),this.boxSelectLayer=new WA;let c=document.createElement("div");this.elt.appendChild(c),this.imageLayer=new d_(this),this.gridLayer=new vL,this.poiDotsLayer=new wL(this.controller),this.graphsLayer=new ud(this.controller,this.settings,u=>this.audioGraph.getExpressionAriaLabel(u)),this.transformationPreviewLayer=new kL(this),this.clickableObjectsLayer=new l_(this),this.movablePointsLayer=new kk(this);let d=document.createElement("div");this.elt.appendChild(d),this.poiLabelsLayer=h_.mountToNode(v1,d,{grapher:()=>this});let p=document.createElement("div");this.elt.appendChild(p),this.geoKeyboardCursorLayer=h_.mountToNode(mL,p,{grapher:()=>this}),this.traceLayer=this.poiLabelsLayer,this.scaleAxis=void 0}privateGetGridLayer(){return this.gridLayer}static copyGraphProperties(t,o){t=__dcg_shared_module_exports__['Ld'](Li,t);let i={...t};delete i.viewport;let n=o.validateSettings(i);for(let a in n)o.setProperty(a,n[a]);return t}remove(){this.elt.remove(),this.poiController.remove(),this.viewportController.remove(),this.audioGraph.remove()}tick(t){(this.__redrawRequested||this.poiLabelsLayer.areAnyLabelsAnimating())&&this._redrawAllLayers(),this.__movablePointListener&&this.__movablePointListener()}registerMovablePointListener(t){this.__movablePointListener=t}deregisterMovablePointListener(){this.__movablePointListener=void 0}clear(){this.graphSketches={},this.graphImages={}}getGraphSketch(t){return this.graphSketches[t]}getGraphImage(t){return this.graphImages[t]}addGraphSketch(t){this.graphSketches[t.id]=t}removeGraphSketch(t){delete this.graphSketches[t]}addGraphImage(t){t.imageObj.width&&t.imageObj.height?(this.graphImages[t.id]=t,this.controller.requestRedrawGraph()):re(t.imageObj).on("load.calc_load",()=>this.addGraphImage(t))}removeGraphImage(t){let o=this.graphImages[t];o&&re(o.imageObj).off("load.calc_load"),delete this.graphImages[t],this.controller.requestRedrawGraph()}setBoxSelectRectangle(t){this.boxSelectRectangle=t,this.controller.requestRedrawGraph()}getProjection(){return this.__projection}_setProjection(t){this.__projection=t,this.controller.requestRedrawGraph()}getAudioTrace(){return this.audioGraph}getDefaultViewport(){let t=this.getProjection();return DQ(this.settings).squareYAxis(t.screen,this.settings)}_updateScreenSize(t,o){if(t<=0||o<=0)return;let n=this.getProjection().screen;if(n.width===t&&n.height===o)return;let a=new Kl(t,o);this.viewportController.setScreen(a)}update(){let{top:t,left:o,width:i,height:n}=this.controller.computeMajorLayout().grapher,a=this.controller.isGraphPaperFocused()&&!this.poiController.keyboardAttentionManager.getKeyboardAttention()&&!this.controller.getSelectedGeoExpression()&&!this.geoKeyboardCursorLayer.showCursor()&&!this.controller.inAudioTraceMode()&&Oz();this.elt.classList.toggle("dcg-grapher-focused",a),this.controller.isThreeDMode()&&({width:i,height:n}=this.__screenRequested3D),i>0&&n>0?(this._setIsVisible(!0),this._updateScreenSize(i,n),Yo(this.elt,{position:"absolute",left:o+"px",top:t+"px",width:i+"px",height:n+"px"})):this._setIsVisible(!1)}setActiveToken(t,o){let i=this.lastActiveToken[o];this.lastActiveToken[o]=t;let n=t&&this.getGraphSketch(t),a=i&&this.getGraphSketch(i);a!==n&&(a&&(o==="selected"?a.tokenSelected=!1:o==="hovered"&&(a.tokenHovered=!1)),n&&(o==="selected"?n.tokenSelected=!0:o==="hovered"&&(n.tokenHovered=!0))),this.controller.requestRedrawGraph()}deselectSketch(t){let o=this.getGraphSketch(t);o&&(o.selected=!1,o.showPOI=!1,o.showHighlight=!1)}selectSketch(t){let o=this.getGraphSketch(t);o&&(o.selected=!0,o.showPOI=this.controller.isTraceEnabled(),o.showHighlight=!0)}setSketchHoistedToTop(t,o){let i=this.getGraphSketch(t);i&&(i.hoistToTop=o)}updateSketch(t,o){let i=this.getGraphSketch(t);if(!o.length){this.removeGraphSketch(t);return}let n=new gw(t,o);o[0].graphMode!==15&&(n.color=o[0].color,o[0].style&&(n.style=o[0].style)),i&&n.updateFrom(i);let a=this.controller.getPropagatedSelectedIds(),s=!!a.selected[t],c=!!a.hoistedToTop[t];n.selected=s,n.tokenHovered=t===String(this.lastActiveToken.hovered),n.tokenSelected=t===String(this.lastActiveToken.selected),n.showPOI=s&&this.controller.isTraceEnabled(),n.showHighlight=s,n.hoistToTop=c,this.addGraphSketch(n)}updateIntersections(t,o){let i=this.getGraphSketch(t);i&&i.updateIntersections(o)}_clear(){let o=this.getProjection().screen;this.canvasLayer.resize(o.width,o.height),this.canvasLayer.ctx&&(this.canvasLayer.ctx.clearRect(0,0,o.width,o.height),this.controller.isThreeDMode()?this.controller.getInvertedColors()||(this.canvasLayer.ctx.fillStyle="rgba(255,255,255,0.001961)",this.canvasLayer.ctx.fillRect(0,0,o.width,o.height)):BE&&(this.controller.getInvertedColors()||(this.canvasLayer.ctx.fillStyle="rgb(0,0,0)",this.canvasLayer.ctx.fillRect(0,0,o.width,o.height))))}isDrawingPlaneFor3dMode(){return this.controller.showPlane3D()||this.controller.showNumbers3D()}createDrawContext(){if(this.canvasLayer.ctx)return{ctx:this.canvasLayer.ctx,projection:this.getProjection(),transformationPreviewParentData:TQ(this.controller)}}_redrawAllLayers(){if(this.update(),!this.isVisible&&!this.isDrawingPlaneFor3dMode())return;this.__redrawRequested=!1;let t=Date.now();this._clear();let o=this.createDrawContext();this.audioGraph.recomputePoints(),this._redrawGrapher(o),this._redrawTransformationPreviewLayer(o),this._redrawBoxSelectLayer(o),this._redrawGeoKeyboardCursorLayer(),this._updateCanvasLayerAria(),this.events.triggerEvent("redraw",Date.now()-t);let i=this.controller.getGrapher3d();this.isDrawingPlaneFor3dMode()&&i&&i.webglLayer.updatePlaneMap()}_redrawTransformationPreviewLayer(t){t&&this.transformationPreviewLayer.redrawToCtx(t)}_redrawBoxSelectLayer(t){t&&this.boxSelectLayer.redrawToCtx(t,this.boxSelectRectangle)}_redrawGeoKeyboardCursorLayer(){this.geoKeyboardCursorLayer.update()}_updateCanvasLayerAria(){let t=0;for(let o in this.graphSketches)Bl(this.controller,this.graphSketches[o])&&(t+=1);this.canvasLayer.updateAria(this.isVisible,t)}_redrawGrapher(t){if(!t)return;let o=this.controller.isThreeDMode();this.clickableObjectsLayer.recomputeClickableObjects(),o||(this.imageLayer.recomputeImages(t),this.movablePointsLayer.recomputeMovablePoints(t),this.poiLabelsLayer.recomputeLabels(t,this.size(),()=>this.drawLabelHitMask({projection:this.getProjection(),showMovablePoints:!0,includePillboxes:!0})));let i=n=>{this.graphsLayer.redrawToCtx(t,this.graphSketches,this.graphImages,n.drawOrder,this.poiLabelsLayer,this.clickableObjectsLayer),o||(this.poiLabelsLayer.copyToCtx(t.ctx,{filter:"canvas-labels",allowedSketches:n.drawSet}),this.movablePointsLayer.redrawToCtx(t.ctx,t.projection,n.drawOrder,{showMovablePoints:!0,renderForScreenshot:!1}))};for(let n of this.__drawLayers)n.layer<0&&i(n);this.gridLayer.redrawToCtx(t,this.scaleAxis);for(let n of this.__drawLayers)n.layer>=0&&i(n);!o&&this.showPOIDots&&this.poiDotsLayer.redrawToCtx(t,this.graphSketches,this.poiLabelsLayer,this.clickableObjectsLayer,this.__drawLayers)}size(){let t=this.canvasLayer.ctx;if(!t)return{width:0,height:0};let o=t.canvas.getBoundingClientRect();return{width:o.width,height:o.height}}_parseScreenshotOpts(t){return n5(t,this.settings,this.getProjection().screen)}_syncScreenshotReturnCanvas(t){let o=document.createElement("canvas");if(t&&t.braille){let{embosserModel:i,brailleMode:n}=t.braille,a=hm[i];o.width=a.width,o.height=a.height,iQ(o,this,a,i,n,!!t.showMovablePoints)}else{let i=this._parseScreenshotOpts(t);o.width=i.width*i.targetPixelRatio,o.height=i.height*i.targetPixelRatio,this.screenshotToCanvas(o,t)}return o}screenshot(t){return t&&t.showLabels&&(t={...t,showLabels:!1}),this._syncScreenshotReturnCanvas(t).toDataURL("image/png")}asyncScreenshot(t,o){if(t&&t.format==="svg"){t.transparentBackground&&(t=__dcg_shared_module_exports__['f'](t),t.transparentBackground=!1);let{width:i,height:n,targetPixelRatio:a}=this._parseScreenshotOpts(t);i*=a,n*=a;let s=new RZ(i,n),c={getContext:()=>s,width:i,height:n};this.screenshotToCanvas(c,t),o(s.getSerializedSvg())}else{let i=this._syncScreenshotReturnCanvas(t);o(i.toDataURL("image/png"))}}makeScreenshotProjection(t){let{width:o,height:i,settings:n}=this._parseScreenshotOpts(t),a=new Kl(o,i),s=this.getProjection().viewport;return this.settings.squareAxes&&(s=s.squareCrop(a,this.settings)),new pl(a,s,n)}drawLabelHitMask(t){let o=t.projection,i=wve;i.width=o.screen.width,i.height=o.screen.height;let n=i.getContext("2d");n.clearRect(0,0,o.screen.width,o.screen.height);let a={ctx:n,projection:o,transformationPreviewParentData:{translationPreviewVectorParents:new Set,translationsWithVisibleVectorParent:new Set,rotationPreviewAngleMarkerParents:new Set,rotationsWithVisibleAndCenteredAngle:new Set}},s=[...this.generateMergeDrawOrder()];if(this.gridLayer.redrawToCtx(a),this.graphsLayer.redrawToCtx(a,this.graphSketches,this.graphImages,s,this.poiLabelsLayer,this.clickableObjectsLayer),this.movablePointsLayer.redrawToCtx(a.ctx,a.projection,s,{showMovablePoints:t.showMovablePoints,renderForScreenshot:!0}),t.includePillboxes){let c=this.elt.getBoundingClientRect(),d=this.controller.findEl(".dcg-overgraph-pillbox-elements"),p=this.controller.findEl(".dcg-graphpaper-branding");__dcg_shared_module_exports__['Fa']([d,p],u=>{if(!u)return;let g=u.getBoundingClientRect();n.globalAlpha=1,n.fillStyle="black",n.fillRect(g.left-c.left,g.top-c.top,g.width,g.height)})}return n}screenshotToCanvas(t,o){let i=this._parseScreenshotOpts(o),{targetPixelRatio:n,transparentBackground:a}=i,s=t.getContext("2d");s.scale(n,n);let c=this.makeScreenshotProjection(o);c.settings.takingScreenshot=!0,_s(s,"background"),Oo(s,"dcg-svg-background"),a?s.clearRect(0,0,c.screen.width,c.screen.height):(s.fillStyle="white",s.fillRect(0,0,c.screen.width,c.screen.height)),xo(s),Cs(s);let d={ctx:s,projection:c,transformationPreviewParentData:{translationPreviewVectorParents:new Set,translationsWithVisibleVectorParent:new Set,rotationPreviewAngleMarkerParents:new Set,rotationsWithVisibleAndCenteredAngle:new Set}};this.imageLayer.recomputeImages(d);let p;if(o&&"showLabels"in o&&o.showLabels){let g=c.screen.width,h=c.screen.height,b=c.settings.labelSize||15,v=1;(g<200||h<200)&&(v=.9);let T=b*v+"px",E=document.createElement("div");E.classList.add("dcg-calculator-screenshot-labels-container"),h_.mountToNode(SL,E,{concreteFontSize:()=>T,width:()=>`${c.screen.width}px`,height:()=>`${c.screen.height}px`}),document.body.append(E);let I=h_.mountToNode(v1,E.querySelector(".dcg-grapher"),{grapher:()=>this});I.takingScreenshot=!0;let _={width:c.screen.width,height:c.screen.height};I.recomputeLabels({projection:c,ctx:s,transformationPreviewParentData:{translationPreviewVectorParents:new Set,translationsWithVisibleVectorParent:new Set,rotationPreviewAngleMarkerParents:new Set,rotationsWithVisibleAndCenteredAngle:new Set}},_,()=>this.drawLabelHitMask({projection:c,showMovablePoints:!!o.showMovablePoints,includePillboxes:!1})),p={labelsLayer:I,layersWrapper:E}}let u=g=>{this.graphsLayer.redrawToCtx(d,this.graphSketches,this.graphImages,g.drawOrder,this.poiLabelsLayer,this.clickableObjectsLayer),p&&p.labelsLayer.copyToCtx(s,{filter:"canvas-labels",allowedSketches:g.drawSet}),this.movablePointsLayer.redrawToCtx(d.ctx,d.projection,g.drawOrder,{showMovablePoints:!!(o!=null&&o.showMovablePoints),renderForScreenshot:!0})};for(let g of this.__drawLayers)g.layer<0&&u(g);this.gridLayer.redrawToCtx(d);for(let g of this.__drawLayers)g.layer>=0&&u(g);p&&(p.labelsLayer.copyToCtx(s,{filter:"above-canvas",allowedSketches:new Set([...this.generateMergeDrawOrder()])}),p.layersWrapper.remove())}speakGrapherFocusAriaLabel(){this.canvasLayer.speakAriaLabelAgain()}_afterViewportChange(){}setGrapherState(t,o){if((!o||!o.doNotClear)&&this.clear(),"complex"in t&&!this.controller.canEnableComplexMode()&&(t={...t,complex:!1}),t=r.copyGraphProperties(t,this.settings),"viewport"in t){let i=Or.fromObject(t.viewport);this.setUserRequestedViewport(i);let n=this.computeConcreteViewport(i);this.viewportController.setViewport(n)}this.controller.requestRedrawGraph()}computeConcreteViewport(t){let o=this.getProjection().screen;return this.settings.squareAxes&&!t.isSquare(o,this.controller.getAxisScaleSettings())?t.squareYAxis(o,this.settings):t}setCanvasSizeFor3D(t,o){this.__screenRequested3D=new Kl(t,o)}getCanvasNode(){return this.canvasLayer.canvasNode}};function n5(r,e,t){let o,i,n,a,s,c;return r?(o=r.width||r.height||t.width,i=r.height||r.width||t.height,n=r.targetPixelRatio||1,n<1&&(n=1),a=(o<256||i<256)&&!r.preserveAxisNumbers,s=Ch.fromObject({...e,...r.settings}),c=!!r.transparentBackground):(o=t.width,i=t.height,n=1,a=!1,s=Ch.fromObject(e),c=!1),a&&(s.setProperty("xAxisNumbers",!1),s.setProperty("yAxisNumbers",!1),s.setProperty("polarNumbers",!1)),{width:o,height:i,targetPixelRatio:n,settings:s,transparentBackground:c}}var Za=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];var TL=Math.PI/180,a5=180/Math.PI;function Mc(){let r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return(Za[r&255]+Za[r>>8&255]+Za[r>>16&255]+Za[r>>24&255]+"-"+Za[e&255]+Za[e>>8&255]+"-"+Za[e>>16&15|64]+Za[e>>24&255]+"-"+Za[t&63|128]+Za[t>>8&255]+"-"+Za[t>>16&255]+Za[t>>24&255]+Za[o&255]+Za[o>>8&255]+Za[o>>16&255]+Za[o>>24&255]).toLowerCase()}function sy(r,e,t){return Math.max(e,Math.min(t,r))}function s5(r){return(r&r-1)===0&&r!==0}function g_(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return r/4294967295;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int32Array:return Math.max(r/2147483647,-1);case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function mw(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return Math.round(r*4294967295);case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int32Array:return Math.round(r*2147483647);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}var AQ="155";var LQ=0,l5=1,PQ=2;var m_=0,ly=1,Ca=2;var EL=0,vm=1,c5=2,d5=3,p5=4,IL=5,Hp=100,GQ=101,VQ=102,OQ=103,RQ=104,ML=200,DL=201,FQ=202,NQ=203,AL=204,LL=205,UQ=206,YQ=207,BQ=208,KQ=209,zQ=210,qQ=0,HQ=1,WQ=2,f_=3,jQ=4,XQ=5,$Q=6,JQ=7;var u5=300;var b_=1e3,cy=1001,y_=1002,Wp=1003,ZQ=1004;var h5=1005;var ql=1006,QQ=1007;var x_=1008;var Gn=1009,eee=1010,tee=1011,fw=1012,PL=1013,Id=1014,Dc=1015,bw=1016,GL=1017,VL=1018,jp=1020,ree=1021,Xp=1023,oee=1024,iee=1025,Lh=1026,wm=1027,nee=1028,OL=1029,aee=1030,RL=1031,FL=1033,NL=33776,UL=33777,YL=33778,BL=33779,g5=35840,m5=35841,f5=35842,b5=35843,see=36196,y5=37492,x5=37496,v5=37808,w5=37809,S5=37810,k5=37811,_5=37812,C5=37813,T5=37814,E5=37815,I5=37816,M5=37817,D5=37818,A5=37819,L5=37820,P5=37821,G5=36492,V5=36283,O5=36284,R5=36285,F5=36286;var yw="",_o="srgb",Qa="srgb-linear";var KL=7680;var lee=519,cee=512,dee=513,pee=514,uee=515,hee=516,gee=517,mee=518,fee=519,bee=35044;var N5="300 es",zL=1035,Ac=2e3,v_=2001;var Ee=class r{constructor(e=0,t=0,o=0){this.x=e,this.y=t,this.z=o}set(e,t,o){return o===void 0&&(o=this.z),this.x=e,this.y=t,this.z=o,this}clone(){return new r(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}applyMatrix3(e){let t=this.x,o=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[3]*o+n[6]*i,this.y=n[1]*t+n[4]*o+n[7]*i,this.z=n[2]*t+n[5]*o+n[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,o=this.y,i=this.z,n=e.elements,a=1/(n[3]*t+n[7]*o+n[11]*i+n[15]);return this.x=(n[0]*t+n[4]*o+n[8]*i+n[12])*a,this.y=(n[1]*t+n[5]*o+n[9]*i+n[13])*a,this.z=(n[2]*t+n[6]*o+n[10]*i+n[14])*a,this}applyQuaternion(e){let t=this.x,o=this.y,i=this.z,n=e.x,a=e.y,s=e.z,c=e.w,d=c*t+a*i-s*o,p=c*o+s*t-n*i,u=c*i+n*o-a*t,g=-n*t-a*o-s*i;return this.x=d*c+g*-n+p*-s-u*-a,this.y=p*c+g*-a+u*-n-d*-s,this.z=u*c+g*-s+d*-a-p*-n,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}transformDirection(e){let t=this.x,o=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[4]*o+n[8]*i,this.y=n[1]*t+n[5]*o+n[9]*i,this.z=n[2]*t+n[6]*o+n[10]*i,this.normalize()}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){return this.multiplyScalar(1/(this.length()||1))}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let o=e.x,i=e.y,n=e.z,a=t.x,s=t.y,c=t.z;return this.x=i*c-n*s,this.y=n*a-o*c,this.z=o*s-i*a,this}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,o=this.y-e.y,i=this.z-e.z;return t*t+o*o+i*i}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixColumn(e,t){let o=t*4,i=e.elements;return this.x=i[o],this.y=i[o+1],this.z=i[o+2],this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}};var $t=class r{constructor(e,t,o,i,n,a,s,c,d,p,u,g,h,b,v,T){this.isMatrix4=!0;this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,o,i,n,a,s,c,d,p,u,g,h,b,v,T)}set(e,t,o,i,n,a,s,c,d,p,u,g,h,b,v,T){let E=this.elements;return E[0]=e,E[4]=t,E[8]=o,E[12]=i,E[1]=n,E[5]=a,E[9]=s,E[13]=c,E[2]=d,E[6]=p,E[10]=u,E[14]=g,E[3]=h,E[7]=b,E[11]=v,E[15]=T,this}clone(){let e=new r,t=this.elements;for(let o=0;o<16;o++)e.elements[o]=t[o];return e}copy(e){let t=this.elements,o=e.elements;return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],t[9]=o[9],t[10]=o[10],t[11]=o[11],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractRotation(e){let t=this.elements,o=e.elements,i=1/U5.setFromMatrixColumn(e,0).length(),n=1/U5.setFromMatrixColumn(e,1).length(),a=1/U5.setFromMatrixColumn(e,2).length();return t[0]=o[0]*i,t[1]=o[1]*i,t[2]=o[2]*i,t[3]=0,t[4]=o[4]*n,t[5]=o[5]*n,t[6]=o[6]*n,t[7]=0,t[8]=o[8]*a,t[9]=o[9]*a,t[10]=o[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,o=e.x,i=e.y,n=e.z,a=Math.cos(o),s=Math.sin(o),c=Math.cos(i),d=Math.sin(i),p=Math.cos(n),u=Math.sin(n);if(e.order==="XYZ"){let g=a*p,h=a*u,b=s*p,v=s*u;t[0]=c*p,t[4]=-c*u,t[8]=d,t[1]=h+b*d,t[5]=g-v*d,t[9]=-s*c,t[2]=v-g*d,t[6]=b+h*d,t[10]=a*c}else if(e.order==="YXZ"){let g=c*p,h=c*u,b=d*p,v=d*u;t[0]=g+v*s,t[4]=b*s-h,t[8]=a*d,t[1]=a*u,t[5]=a*p,t[9]=-s,t[2]=h*s-b,t[6]=v+g*s,t[10]=a*c}else if(e.order==="ZYX"){let g=a*p,h=a*u,b=s*p,v=s*u;t[0]=c*p,t[4]=b*d-h,t[8]=g*d+v,t[1]=c*u,t[5]=v*d+g,t[9]=h*d-b,t[2]=-d,t[6]=s*c,t[10]=a*c}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Sve,e,kve)}lookAt(e,t,o){let i=this.elements;return Hl.subVectors(e,t),Hl.lengthSq()===0&&(Hl.z=1),Hl.normalize(),Sm.crossVectors(o,Hl),Sm.lengthSq()===0&&(Math.abs(o.z)===1?Hl.x+=1e-4:Hl.z+=1e-4,Hl.normalize(),Sm.crossVectors(o,Hl)),Sm.normalize(),qL.crossVectors(Hl,Sm),i[0]=Sm.x,i[4]=qL.x,i[8]=Hl.x,i[1]=Sm.y,i[5]=qL.y,i[9]=Hl.y,i[2]=Sm.z,i[6]=qL.z,i[10]=Hl.z,this}multiply(e){return this.multiplyMatrices(this,e)}multiplyMatrices(e,t){let o=e.elements,i=t.elements,n=this.elements,a=o[0],s=o[4],c=o[8],d=o[12],p=o[1],u=o[5],g=o[9],h=o[13],b=o[2],v=o[6],T=o[10],E=o[14],I=o[3],_=o[7],C=o[11],D=o[15],P=i[0],F=i[4],N=i[8],Y=i[12],z=i[1],X=i[5],q=i[9],S=i[13],A=i[2],O=i[6],B=i[10],V=i[14],K=i[3],oe=i[7],Z=i[11],ee=i[15];return n[0]=a*P+s*z+c*A+d*K,n[4]=a*F+s*X+c*O+d*oe,n[8]=a*N+s*q+c*B+d*Z,n[12]=a*Y+s*S+c*V+d*ee,n[1]=p*P+u*z+g*A+h*K,n[5]=p*F+u*X+g*O+h*oe,n[9]=p*N+u*q+g*B+h*Z,n[13]=p*Y+u*S+g*V+h*ee,n[2]=b*P+v*z+T*A+E*K,n[6]=b*F+v*X+T*O+E*oe,n[10]=b*N+v*q+T*B+E*Z,n[14]=b*Y+v*S+T*V+E*ee,n[3]=I*P+_*z+C*A+D*K,n[7]=I*F+_*X+C*O+D*oe,n[11]=I*N+_*q+C*B+D*Z,n[15]=I*Y+_*S+C*V+D*ee,this}determinant(){let e=this.elements,t=e[0],o=e[4],i=e[8],n=e[12],a=e[1],s=e[5],c=e[9],d=e[13],p=e[2],u=e[6],g=e[10],h=e[14],b=e[3],v=e[7],T=e[11],E=e[15];return b*(+n*c*u-i*d*u-n*s*g+o*d*g+i*s*h-o*c*h)+v*(+t*c*h-t*d*g+n*a*g-i*a*h+i*d*p-n*c*p)+T*(+t*d*u-t*s*h-n*a*u+o*a*h+n*s*p-o*d*p)+E*(-i*s*p-t*c*u+t*s*g+i*a*u-o*a*g+o*c*p)}invert(){let e=this.elements,t=e[0],o=e[1],i=e[2],n=e[3],a=e[4],s=e[5],c=e[6],d=e[7],p=e[8],u=e[9],g=e[10],h=e[11],b=e[12],v=e[13],T=e[14],E=e[15],I=u*T*d-v*g*d+v*c*h-s*T*h-u*c*E+s*g*E,_=b*g*d-p*T*d-b*c*h+a*T*h+p*c*E-a*g*E,C=p*v*d-b*u*d+b*s*h-a*v*h-p*s*E+a*u*E,D=b*u*c-p*v*c-b*s*g+a*v*g+p*s*T-a*u*T,P=t*I+o*_+i*C+n*D;if(P===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let F=1/P;return e[0]=I*F,e[1]=(v*g*n-u*T*n-v*i*h+o*T*h+u*i*E-o*g*E)*F,e[2]=(s*T*n-v*c*n+v*i*d-o*T*d-s*i*E+o*c*E)*F,e[3]=(u*c*n-s*g*n-u*i*d+o*g*d+s*i*h-o*c*h)*F,e[4]=_*F,e[5]=(p*T*n-b*g*n+b*i*h-t*T*h-p*i*E+t*g*E)*F,e[6]=(b*c*n-a*T*n-b*i*d+t*T*d+a*i*E-t*c*E)*F,e[7]=(a*g*n-p*c*n+p*i*d-t*g*d-a*i*h+t*c*h)*F,e[8]=C*F,e[9]=(b*u*n-p*v*n-b*o*h+t*v*h+p*o*E-t*u*E)*F,e[10]=(a*v*n-b*s*n+b*o*d-t*v*d-a*o*E+t*s*E)*F,e[11]=(p*s*n-a*u*n-p*o*d+t*u*d+a*o*h-t*s*h)*F,e[12]=D*F,e[13]=(p*v*i-b*u*i+b*o*g-t*v*g-p*o*T+t*u*T)*F,e[14]=(b*s*i-a*v*i-b*o*c+t*v*c+a*o*T-t*s*T)*F,e[15]=(a*u*i-p*s*i+p*o*c-t*u*c-a*o*g+t*s*g)*F,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],o=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,o,i))}makeTranslation(e,t,o){return this.set(1,0,0,e,0,1,0,t,0,0,1,o,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),o=Math.sin(e);return this.set(1,0,0,0,0,t,-o,0,0,o,t,0,0,0,0,1),this}makeRotationAxis(e,t){let o=Math.cos(t),i=Math.sin(t),n=1-o,a=e.x,s=e.y,c=e.z,d=n*a,p=n*s;return this.set(d*a+o,d*s-i*c,d*c+i*s,0,d*s+i*c,p*s+o,p*c-i*a,0,d*c-i*s,p*c+i*a,n*c*c+o,0,0,0,0,1),this}makeScale(e,t,o){return this.set(e,0,0,0,0,t,0,0,0,0,o,0,0,0,0,1),this}compose(e,t,o){let i=this.elements,n=t._x,a=t._y,s=t._z,c=t._w,d=n+n,p=a+a,u=s+s,g=n*d,h=n*p,b=n*u,v=a*p,T=a*u,E=s*u,I=c*d,_=c*p,C=c*u,D=o.x,P=o.y,F=o.z;return i[0]=(1-(v+E))*D,i[1]=(h+C)*D,i[2]=(b-_)*D,i[3]=0,i[4]=(h-C)*P,i[5]=(1-(g+E))*P,i[6]=(T+I)*P,i[7]=0,i[8]=(b+_)*F,i[9]=(T-I)*F,i[10]=(1-(g+v))*F,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}makePerspective(e,t,o,i,n,a,s=Ac){let c=this.elements,d=2*n/(t-e),p=2*n/(o-i),u=(t+e)/(t-e),g=(o+i)/(o-i),h,b;if(s===Ac)h=-(a+n)/(a-n),b=-2*a*n/(a-n);else if(s===v_)h=-a/(a-n),b=-a*n/(a-n);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return c[0]=d,c[4]=0,c[8]=u,c[12]=0,c[1]=0,c[5]=p,c[9]=g,c[13]=0,c[2]=0,c[6]=0,c[10]=h,c[14]=b,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,o,i,n,a,s=Ac){let c=this.elements,d=1/(t-e),p=1/(o-i),u=1/(a-n),g=(t+e)*d,h=(o+i)*p,b,v;if(s===Ac)b=(a+n)*u,v=-2*u;else if(s===v_)b=n*u,v=-1*u;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return c[0]=2*d,c[4]=0,c[8]=0,c[12]=-g,c[1]=0,c[5]=2*p,c[9]=0,c[13]=-h,c[2]=0,c[6]=0,c[10]=v,c[14]=-b,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){let t=this.elements,o=e.elements;for(let i=0;i<16;i++)if(t[i]!==o[i])return!1;return!0}fromArray(e,t=0){for(let o=0;o<16;o++)this.elements[o]=e[o+t];return this}toArray(e,t=0){let o=this.elements;return e[t]=o[0],e[t+1]=o[1],e[t+2]=o[2],e[t+3]=o[3],e[t+4]=o[4],e[t+5]=o[5],e[t+6]=o[6],e[t+7]=o[7],e[t+8]=o[8],e[t+9]=o[9],e[t+10]=o[10],e[t+11]=o[11],e[t+12]=o[12],e[t+13]=o[13],e[t+14]=o[14],e[t+15]=o[15],e}},U5=new Ee,Sve=new Ee(0,0,0),kve=new Ee(1,1,1),Sm=new Ee,qL=new Ee,Hl=new Ee;var yee=new $t,ul=class{constructor(e=0,t=0,o=0,i="XYZ"){this._x=e,this._y=t,this._z=o,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,o,i=this._order){return this._x=e,this._y=t,this._z=o,this._order=i,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,o=!0){let i=e.elements,n=i[0],a=i[4],s=i[8],c=i[1],d=i[5],p=i[9],u=i[2],g=i[6],h=i[10];switch(t){case"XYZ":this._y=Math.asin(sy(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-p,h),this._z=Math.atan2(-a,n)):(this._x=Math.atan2(g,d),this._z=0);break;case"YXZ":this._x=Math.asin(-sy(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(s,h),this._z=Math.atan2(c,d)):(this._y=Math.atan2(-u,n),this._z=0);break;case"ZYX":this._y=Math.asin(-sy(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(g,h),this._z=Math.atan2(c,n)):(this._x=0,this._z=Math.atan2(-a,d));break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,o===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,o){return yee.makeRotationFromQuaternion(e),this.setFromRotationMatrix(yee,t,o)}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}};var Co=class r{constructor(e,t,o,i,n,a,s,c,d){this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,o,i,n,a,s,c,d)}set(e,t,o,i,n,a,s,c,d){let p=this.elements;return p[0]=e,p[1]=i,p[2]=s,p[3]=t,p[4]=n,p[5]=c,p[6]=o,p[7]=a,p[8]=d,this}copy(e){let t=this.elements,o=e.elements;return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}multiplyMatrices(e,t){let o=e.elements,i=t.elements,n=this.elements,a=o[0],s=o[3],c=o[6],d=o[1],p=o[4],u=o[7],g=o[2],h=o[5],b=o[8],v=i[0],T=i[3],E=i[6],I=i[1],_=i[4],C=i[7],D=i[2],P=i[5],F=i[8];return n[0]=a*v+s*I+c*D,n[3]=a*T+s*_+c*P,n[6]=a*E+s*C+c*F,n[1]=d*v+p*I+u*D,n[4]=d*T+p*_+u*P,n[7]=d*E+p*C+u*F,n[2]=g*v+h*I+b*D,n[5]=g*T+h*_+b*P,n[8]=g*E+h*C+b*F,this}invert(){let e=this.elements,t=e[0],o=e[1],i=e[2],n=e[3],a=e[4],s=e[5],c=e[6],d=e[7],p=e[8],u=p*a-s*d,g=s*c-p*n,h=d*n-a*c,b=t*u+o*g+i*h;if(b===0)return this.set(0,0,0,0,0,0,0,0,0);let v=1/b;return e[0]=u*v,e[1]=(i*d-p*o)*v,e[2]=(s*o-i*a)*v,e[3]=g*v,e[4]=(p*t-i*c)*v,e[5]=(i*n-s*t)*v,e[6]=h*v,e[7]=(o*c-d*t)*v,e[8]=(a*t-o*n)*v,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}equals(e){let t=this.elements,o=e.elements;for(let i=0;i<9;i++)if(t[i]!==o[i])return!1;return!0}toArray(e,t=0){let o=this.elements;return e[t]=o[0],e[t+1]=o[1],e[t+2]=o[2],e[t+3]=o[3],e[t+4]=o[4],e[t+5]=o[5],e[t+6]=o[6],e[t+7]=o[7],e[t+8]=o[8],e}clone(){let e=new r,t=this.elements;for(let o=0;o<9;o++)e.elements[o]=t[o];return e}};var Lc=class r{constructor(e=0,t=0,o=0,i=1){this.isQuaternion=!0;this._x=e,this._y=t,this._z=o,this._w=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,o,i){return this._x=e,this._y=t,this._z=o,this._w=i,this._onChangeCallback(),this}clone(){return new r(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let o=e._x,i=e._y,n=e._z,a=e._order,s=Math.cos,c=Math.sin,d=s(o/2),p=s(i/2),u=s(n/2),g=c(o/2),h=c(i/2),b=c(n/2);switch(a){case"XYZ":this._x=g*p*u+d*h*b,this._y=d*h*u-g*p*b,this._z=d*p*b+g*h*u,this._w=d*p*u-g*h*b;break;case"YXZ":this._x=g*p*u+d*h*b,this._y=d*h*u-g*p*b,this._z=d*p*b-g*h*u,this._w=d*p*u+g*h*b;break;case"ZYX":this._x=g*p*u-d*h*b,this._y=d*h*u+g*p*b,this._z=d*p*b-g*h*u,this._w=d*p*u+g*h*b;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t!==!1&&this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,o=t[0],i=t[4],n=t[8],a=t[1],s=t[5],c=t[9],d=t[2],p=t[6],u=t[10],g=o+s+u;if(g>0){let h=.5/Math.sqrt(g+1);this._w=.25/h,this._x=(p-c)*h,this._y=(n-d)*h,this._z=(a-i)*h}else if(o>s&&o>u){let h=2*Math.sqrt(1+o-s-u);this._w=(p-c)/h,this._x=.25*h,this._y=(i+a)/h,this._z=(n+d)/h}else if(s>u){let h=2*Math.sqrt(1+s-o-u);this._w=(n-d)/h,this._x=(i+a)/h,this._y=.25*h,this._z=(c+p)/h}else{let h=2*Math.sqrt(1+u-o-s);this._w=(a-i)/h,this._x=(n+d)/h,this._y=(c+p)/h,this._z=.25*h}return this._onChangeCallback(),this}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let o=e._x,i=e._y,n=e._z,a=e._w,s=t._x,c=t._y,d=t._z,p=t._w;return this._x=o*p+a*s+i*d-n*c,this._y=i*p+a*c+n*s-o*d,this._z=n*p+a*d+o*c-i*s,this._w=a*p-o*s-i*c-n*d,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let o=this._x,i=this._y,n=this._z,a=this._w,s=a*e._w+o*e._x+i*e._y+n*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=a,this._x=o,this._y=i,this._z=n,this;let c=1-s*s;if(c<=Number.EPSILON){let h=1-t;return this._w=h*a+t*this._w,this._x=h*o+t*this._x,this._y=h*i+t*this._y,this._z=h*n+t*this._z,this.normalize(),this._onChangeCallback(),this}let d=Math.sqrt(c),p=Math.atan2(d,s),u=Math.sin((1-t)*p)/d,g=Math.sin(t*p)/d;return this._w=a*u+this._w*g,this._x=o*u+this._x*g,this._y=i*u+this._y*g,this._z=n*u+this._z*g,this._onChangeCallback(),this}toArray(e,t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}};var Ps=new Ee,Ta=class{constructor(e,t,o=!1){this.isBufferAttribute=!0;if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=o,this.usage=bee,this.updateRange={offset:0,count:-1},this.gpuType=Dc,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}applyMatrix4(e){for(let t=0,o=this.count;t<o;t++)Ps.fromBufferAttribute(this,t),Ps.applyMatrix4(e),this.setXYZ(t,Ps.x,Ps.y,Ps.z);return this}applyNormalMatrix(e){for(let t=0,o=this.count;t<o;t++)Ps.fromBufferAttribute(this,t),Ps.applyNormalMatrix(e),this.setXYZ(t,Ps.x,Ps.y,Ps.z);return this}transformDirection(e){for(let t=0,o=this.count;t<o;t++)Ps.fromBufferAttribute(this,t),Ps.transformDirection(e),this.setXYZ(t,Ps.x,Ps.y,Ps.z);return this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=g_(t,this.array)),t}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=g_(t,this.array)),t}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=g_(t,this.array)),t}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=g_(t,this.array)),t}setXY(e,t,o){return e*=this.itemSize,this.normalized&&(t=mw(t,this.array),o=mw(o,this.array)),this.array[e+0]=t,this.array[e+1]=o,this}setXYZ(e,t,o,i){return e*=this.itemSize,this.normalized&&(t=mw(t,this.array),o=mw(o,this.array),i=mw(i,this.array)),this.array[e+0]=t,this.array[e+1]=o,this.array[e+2]=i,this}};var km=class extends Ta{constructor(e,t,o){super(new Uint16Array(e),t,o)}};var _m=class extends Ta{constructor(e,t,o){super(new Uint32Array(e),t,o)}},No=class extends Ta{constructor(e,t,o){super(new Float32Array(e),t,o)}};var hl=class{hasEventListener(e,t){if(this._listeners===void 0)return!1;let o=this._listeners;return o[e]!==void 0&&o[e].indexOf(t)!==-1}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let o=this._listeners;o[e]===void 0&&(o[e]=[]),o[e].indexOf(t)===-1&&o[e].push(t)}removeEventListener(e,t){if(this._listeners===void 0)return;let i=this._listeners[e];if(i!==void 0){let n=i.indexOf(t);n!==-1&&i.splice(n,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let o=this._listeners[e.type];if(o!==void 0){e.target=this;let i=o.slice(0);for(let n=0,a=i.length;n<a;n++)i[n].call(this,e);e.target=null}}};var xw=class{constructor(){this.mask=1}enable(e){this.mask|=1<<e|0}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}};var _ve=0,xee=new Ee,vee=new Lc,w_=new $t,Y5=new Ee,B5=new Ee,Cve=new Ee(1,0,0),Tve=new Ee(0,1,0),Eve=new Ee(0,0,1),Ive={type:"added"},Mve={type:"removed"},Cm=class Cm extends hl{constructor(){super();this.isObject3D=!0;Object.defineProperty(this,"id",{value:_ve++}),this.uuid=Mc(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Cm.DEFAULT_UP.clone();let t=new Ee,o=new ul,i=new Lc,n=new Ee(1,1,1);function a(){i.setFromEuler(o,!1)}function s(){o.setFromQuaternion(i,void 0,!1)}o._onChange(a),i._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:o},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new $t},normalMatrix:{value:new Co}}),this.matrix=new $t,this.matrixWorld=new $t,this.dcgModelMatrix=new $t,this.matrixAutoUpdate=Cm.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Cm.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new xw,this.visible=!0,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}setPickingColorArray(t){this.pickingColorArray=t;let{repeatColorCounts:o,colors:i}=t,n=[];for(let a=0;a<o.length;a++){let s=i[a],c=o[a];for(let d=0;d<c;d++)n.push(...s)}this.geometry&&this.geometry.setAttribute("vertexPickingColor",new Ta(new Float32Array(n),4))}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}translateOnAxis(t,o){return xee.copy(t).applyQuaternion(this.quaternion),this.position.add(xee.multiplyScalar(o)),this}translateX(t){return this.translateOnAxis(Cve,t)}translateY(t){return this.translateOnAxis(Tve,t)}translateZ(t){return this.translateOnAxis(Eve,t)}lookAt(t){Y5.copy(t);let o=this.parent;this.updateWorldMatrix(!0,!1),B5.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?w_.lookAt(B5,Y5,this.up):w_.lookAt(Y5,B5,this.up),this.quaternion.setFromRotationMatrix(w_),o&&(w_.extractRotation(o.matrixWorld),vee.setFromRotationMatrix(w_),this.quaternion.premultiply(vee.invert()))}add(t){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.add(arguments[o]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Ive)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}let o=this.children.indexOf(t);return o!==-1&&(t.parent=null,this.children.splice(o,1),t.dispatchEvent(Mve)),this}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,o){if(this[t]===o)return this;for(let i=0,n=this.children.length;i<n;i++){let s=this.children[i].getObjectByProperty(t,o);if(s!==void 0)return s}}getObjectsByProperty(t,o){let i=[];this[t]===o&&i.push(this);for(let n=0,a=this.children.length;n<a;n++){let s=this.children[n].getObjectsByProperty(t,o);s.length>0&&(i=i.concat(s))}return i}traverse(t){t(this);let o=this.children;for(let i=0,n=o.length;i<n;i++)o[i].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let o=this.children;for(let i=0,n=o.length;i<n;i++)o[i].traverseVisible(t)}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);let o=this.children;for(let i=0,n=o.length;i<n;i++){let a=o[i];(a.matrixWorldAutoUpdate===!0||t===!0)&&a.updateMatrixWorld(t)}}updateWorldMatrix(t,o){let i=this.parent;if(t===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),o===!0){let n=this.children;for(let a=0,s=n.length;a<s;a++){let c=n[a];c.matrixWorldAutoUpdate===!0&&c.updateWorldMatrix(!1,!0)}}}};Cm.DEFAULT_UP=new Ee(0,1,0),Cm.DEFAULT_MATRIX_AUTO_UPDATE=!0,Cm.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var si=Cm;var vw=class extends si{constructor(){super();this.isCamera=!0;this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new $t,this.projectionMatrix=new $t,this.projectionMatrixInverse=new $t,this.coordinateSystem=Ac}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,o){super.updateWorldMatrix(t,o),this.matrixWorldInverse.copy(this.matrixWorld).invert()}};var Ph=class extends vw{constructor(e=-1,t=1,o=1,i=-1,n=.1,a=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=o,this.bottom=i,this.near=n,this.far=a,this.updateProjectionMatrix()}setViewOffset(e,t,o,i,n,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=o,this.view.offsetY=i,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,i=(this.top+this.bottom)/2,n=o-e,a=o+e,s=i+t,c=i-t;if(this.view!==null&&this.view.enabled){let d=(this.right-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=d*this.view.offsetX,a=n+d*this.view.width,s-=p*this.view.offsetY,c=s-p*this.view.height}this.projectionMatrix.makeOrthographic(n,a,s,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}};var Tm=class extends vw{constructor(e=50,t=1,o=.1,i=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=o,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=a5*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(TL*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return a5*2*Math.atan(Math.tan(TL*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,o,i,n,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=o,this.view.offsetY=i,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(TL*.5*this.fov)/this.zoom,o=2*t,i=this.aspect*o,n=-.5*i,a=this.view;if(a!==null&&a.enabled){let c=a.fullWidth,d=a.fullHeight;n+=a.offsetX*i/c,t-=a.offsetY*o/d,i*=a.width/c,o*=a.height/d}let s=this.filmOffset;s!==0&&(n+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+i,t,t-o,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}};var dy=class{constructor(e=new Ee(1/0,1/0,1/0),t=new Ee(-1/0,-1/0,-1/0)){this.min=e,this.max=t}setFromBufferAttribute(e){this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0;for(let t=0,o=e.count;t<o;t++)K5.fromBufferAttribute(e,t),this.min.min(K5),this.max.max(K5);return this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},K5=new Ee;var ww=new Ee,z5=new Ee,Gh=class{constructor(e=new Ee,t=-1){this.center=e,this.radius=t}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(z5.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ww.copy(e.center).add(z5)),this.expandByPoint(ww.copy(e.center).sub(z5))),this)}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ww.subVectors(e,this.center);let t=ww.lengthSq();if(t>this.radius*this.radius){let o=Math.sqrt(t),i=(o-this.radius)*.5;ww.multiplyScalar(i/o),this.center.add(ww),this.radius+=i}return this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}};function HL(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}function S_(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function Dve(r){let e=r.getError();switch(e){case r.NO_ERROR:return"NO_ERROR";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";default:return typeof e=="number"?e.toString(16):e}}function Dt(r,e,t){if(r==null){let o=`Expected ${e} to be defined and not null.`;throw t&&(o+=` GL Error: ${Dve(t)}.`),new Error(o)}}var Ave=0,Sw=new $t,wee=new dy,py=new Ee,es=class extends hl{constructor(){super();this.isBufferGeometry=!0;Object.defineProperty(this,"id",{value:Ave++}),this.uuid=Mc(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.groups=[],this.boundingSphere=null,this.userData={}}setIndex(t){return Array.isArray(t)?this.index=new(HL(t)?_m:km)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,o){return this.attributes[t]=o,this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,o,i=0){this.groups.push({start:t,count:o,materialIndex:i})}applyMatrix4(t){let o=this.attributes.position;o!==void 0&&(o.applyMatrix4(t),o.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let a=new Co().getNormalMatrix(t);i.applyNormalMatrix(a),i.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(t),n.needsUpdate=!0),this.boundingSphere!==null&&this.computeBoundingSphere(),this}rotateX(t){return Sw.makeRotationX(t),this.applyMatrix4(Sw),this}translate(t,o,i){return Sw.makeTranslation(t,o,i),this.applyMatrix4(Sw),this}scale(t,o,i){return Sw.makeScale(t,o,i),this.applyMatrix4(Sw),this}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Gh);let t=this.attributes.position;if(t){let o=this.boundingSphere.center;wee.setFromBufferAttribute(t),wee.getCenter(o);let i=0;for(let n=0,a=t.count;n<a;n++)py.fromBufferAttribute(t,n),i=Math.max(i,o.distanceToSquared(py));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeVertexNormals(){let t=this.index,o=this.getAttribute("position");if(o!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Ta(new Float32Array(o.count*3),3),this.setAttribute("normal",i);else for(let h=0,b=i.count;h<b;h++)i.setXYZ(h,0,0,0);let n=new Ee,a=new Ee,s=new Ee,c=new Ee,d=new Ee,p=new Ee,u=new Ee,g=new Ee;if(t)for(let h=0,b=t.count;h<b;h+=3){let v=t.getX(h+0),T=t.getX(h+1),E=t.getX(h+2);n.fromBufferAttribute(o,v),a.fromBufferAttribute(o,T),s.fromBufferAttribute(o,E),u.subVectors(s,a),g.subVectors(n,a),u.cross(g),c.fromBufferAttribute(i,v),d.fromBufferAttribute(i,T),p.fromBufferAttribute(i,E),c.add(u),d.add(u),p.add(u),i.setXYZ(v,c.x,c.y,c.z),i.setXYZ(T,d.x,d.y,d.z),i.setXYZ(E,p.x,p.y,p.z)}else for(let h=0,b=o.count;h<b;h+=3)n.fromBufferAttribute(o,h+0),a.fromBufferAttribute(o,h+1),s.fromBufferAttribute(o,h+2),u.subVectors(s,a),g.subVectors(n,a),u.cross(g),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){let t=this.attributes.normal;for(let o=0,i=t.count;o<i;o++)py.fromBufferAttribute(t,o),py.normalize(),t.setXYZ(o,py.x,py.y,py.z)}dispose(){this.dispatchEvent({type:"dispose"})}};var gn=class r{constructor(e=0,t=0,o=0,i=1){this.x=e,this.y=t,this.z=o,this.w=i}set(e,t,o,i){return this.x=e,this.y=t,this.z=o,this.w=i,this}clone(){return new r(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}};var Ft=class r{constructor(e=0,t=0){this.x=e,this.y=t}set(e,t){return this.x=e,this.y=t,this}clone(){return new r(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}applyMatrix3(e){let t=this.x,o=this.y,i=e.elements;return this.x=i[0]*t+i[3]*o+i[6],this.y=i[1]*t+i[4]*o+i[7],this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){return this.multiplyScalar(1/(this.length()||1))}distanceTo(e){let t=this.x-e.x,o=this.y-e.y,i=t*t+o*o;return Math.sqrt(i)}equals(e){return e.x===this.x&&e.y===this.y}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}};var Lve=0,WL=class{constructor(e){this.data=e;this.isSource=!0;this.uuid=Mc();this.version=0;Object.defineProperty(this,"id",{value:Lve++})}set needsUpdate(e){e===!0&&this.version++}};var $p=class{constructor(e,t,o){this.width=e;this.height=t;this.depth=o}},Pve=0,kw=class kw extends hl{constructor(e,t=kw.DEFAULT_MAPPING,o=cy,i=cy,n=ql,a=x_,s=Xp,c=Gn,d=kw.DEFAULT_ANISOTROPY,p=yw){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Pve++}),this.uuid=Mc(),this.name="",this.source=new WL(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=o,this.wrapT=i,this.magFilter=n,this.minFilter=a,this.anisotropy=d,this.format=s,this.internalFormat=null,this.type=c,this.offset=new Ft(0,0),this.repeat=new Ft(1,1),this.center=new Ft(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Co,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=p,this.userData={},this.version=0,this.onUpdate=void 0,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==u5)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case b_:e.x=e.x-Math.floor(e.x);break;case cy:e.x=e.x<0?0:1;break;case y_:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case b_:e.y=e.y-Math.floor(e.y);break;case cy:e.y=e.y<0?0:1;break;case y_:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};kw.DEFAULT_ANISOTROPY=1,kw.DEFAULT_MAPPING=u5;var gl=kw;var jL=class extends hl{constructor(t=1,o=1,i={}){super();this.isRenderTarget=!0;this.width=t,this.height=o,this.depth=1,this.scissor=new gn(0,0,t,o),this.scissorTest=!1,this.viewport=new gn(0,0,t,o);let n=new $p(t,o,1);this.texture=new gl(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:ql,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(t,o,i=1){if(this.width!==t||this.height!==o||this.depth!==i){this.width=t,this.height=o,this.depth=i;let n=this.texture.image;n.width=t,n.height=o,n.depth=i,this.dispose()}this.viewport.set(0,0,t,o),this.scissor.set(0,0,t,o)}dispose(){this.dispatchEvent({type:"dispose"})}};var Em=class{constructor(){this.arcLengthDivisions=200;this.needsUpdate=!1}getPointAt(e,t){let o=this.getUtoTmapping(e);return this.getPoint(o,t)}getPoints(e=5){let t=[];for(let o=0;o<=e;o++)t.push(this.getPoint(o/e));return t}getSpacedPoints(e=5){let t=[];for(let o=0;o<=e;o++)t.push(this.getPointAt(o/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],o,i=this.getPoint(0),n=0;t.push(0);for(let a=1;a<=e;a++)o=this.getPoint(a/e),n+=o.distanceTo(i),t.push(n),i=o;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let o=this.getLengths(),i=0,n=o.length,a;t?a=t:a=e*o[n-1];let s=0,c=n-1,d;for(;s<=c;)if(i=Math.floor(s+(c-s)/2),d=o[i]-a,d<0)s=i+1;else if(d>0)c=i-1;else{c=i;break}if(i=c,o[i]===a)return i/(n-1);let p=o[i],g=o[i+1]-p,h=(a-p)/g;return(i+h)/(n-1)}getTangent(e,t){let i=e-1e-4,n=e+1e-4;i<0&&(i=0),n>1&&(n=1);let a=this.getPoint(i),s=this.getPoint(n),c=t||new Ft;return c.copy(s).sub(a).normalize(),c}getTangentAt(e,t){let o=this.getUtoTmapping(e);return this.getTangent(o,t)}computeFrenetFrames(e,t){let o=new Ee,i=[],n=[],a=[],s=new Ee,c=new $t;for(let g=0;g<=e;g++){let h=g/e,b=this.getTangentAt(h,new Ft);i[g]=new Ee(b.x,b.y,0)}n[0]=new Ee,a[0]=new Ee;let d=Number.MAX_VALUE,p=Math.abs(i[0].x),u=Math.abs(i[0].y);p<=d&&(d=p,o.set(1,0,0)),u<=d&&(d=u,o.set(0,1,0)),s.crossVectors(i[0],o).normalize(),n[0].crossVectors(i[0],s),a[0].crossVectors(i[0],n[0]);for(let g=1;g<=e;g++){if(n[g]=n[g-1].clone(),a[g]=a[g-1].clone(),s.crossVectors(i[g-1],i[g]),s.length()>Number.EPSILON){s.normalize();let h=Math.acos(sy(i[g-1].dot(i[g]),-1,1));n[g].applyMatrix4(c.makeRotationAxis(s,h))}a[g].crossVectors(i[g],n[g])}if(t===!0){let g=Math.acos(sy(n[0].dot(n[e]),-1,1));g/=e,i[0].dot(s.crossVectors(n[0],n[e]))>0&&(g=-g);for(let h=1;h<=e;h++)n[h].applyMatrix4(c.makeRotationAxis(i[h],g*h)),a[h].crossVectors(i[h],n[h])}return{tangents:i,normals:n,binormals:a}}};var uy=class extends Em{constructor(e=new Ft,t=new Ft){super(),this.v1=e,this.v2=t}getPoint(e,t=new Ft){let o=t;return e===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(e).add(this.v1)),o}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ft){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}};var XL=class extends Em{constructor(){super(...arguments);this.curves=[];this.autoClose=!1}add(t){this.curves.push(t)}closePath(){let t=this.curves[0].getPoint(0),o=this.curves[this.curves.length-1].getPoint(1);t.equals(o)||this.curves.push(new uy(o,t))}getPoint(t,o){let i=t*this.getLength(),n=this.getCurveLengths(),a=0;for(;a<n.length;){if(n[a]>=i){let s=n[a]-i,c=this.curves[a],d=c.getLength(),p=d===0?0:1-s/d;return c.getPointAt(p,o)}a++}}getLength(){let t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=void 0,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let t=[],o=0;for(let i=0,n=this.curves.length;i<n;i++)o+=this.curves[i].getLength(),t.push(o);return this.cacheLengths=t,t}getSpacedPoints(t=40){let o=[];for(let i=0;i<=t;i++)o.push(this.getPoint(i/t));return this.autoClose&&o.push(o[0]),o}getPoints(t=12){let o=[],i;for(let n=0,a=this.curves;n<a.length;n++){let s=a[n],c=s instanceof uy?1:t,d=s.getPoints(c);for(let p=0;p<d.length;p++){let u=d[p];i&&i.equals(u)||(o.push(u),i=u)}}return this.autoClose&&o.length>1&&!o[o.length-1].equals(o[0])&&o.push(o[0]),o}};function Gve(r,e){let t=1-r;return t*t*e}function Vve(r,e){return 2*(1-r)*r*e}function Ove(r,e){return r*r*e}function q5(r,e,t,o){return Gve(r,e)+Vve(r,t)+Ove(r,o)}var $L=class extends Em{constructor(e=new Ft,t=new Ft,o=new Ft){super(),this.v0=e,this.v1=t,this.v2=o}getPoint(e,t=new Ft){let o=t,i=this.v0,n=this.v1,a=this.v2;return o.set(q5(e,i.x,n.x,a.x),q5(e,i.y,n.y,a.y)),o}};var hy=class extends XL{constructor(t){super();this.currentPoint=new Ft;t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let o=1,i=t.length;o<i;o++)this.lineTo(t[o].x,t[o].y);return this}moveTo(t,o){return this.currentPoint.set(t,o),this}lineTo(t,o){let i=new uy(this.currentPoint.clone(),new Ft(t,o));return this.curves.push(i),this.currentPoint.set(t,o),this}quadraticCurveTo(t,o,i,n){let a=new $L(this.currentPoint.clone(),new Ft(t,o),new Ft(i,n));return this.curves.push(a),this.currentPoint.set(i,n),this}};var _w=class extends hy{constructor(){super(...arguments);this.uuid=Mc();this.holes=[]}getPointsHoles(t){let o=[];for(let i=0,n=this.holes.length;i<n;i++)o[i]=this.holes[i].getPoints(t);return o}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}};var At=class r{constructor(e){this.isColor=!0;if(e instanceof r)this.copy(e);else if(typeof e=="number")this.setHex(e);else if(typeof e=="string"){let{r:t,g:o,b:i}=__dcg_shared_module_exports__['vd'](e);this.setRGB(t/255,o/255,i/255)}else this.r=1,this.g=1,this.b=1}setHex(e){return e=Math.floor(e),this.setRGB((e>>16&255)/255,(e>>8&255)/255,(e&255)/255),this}setRGB(e,t,o){return this.r=__dcg_shared_module_exports__['wd'](e),this.g=__dcg_shared_module_exports__['wd'](t),this.b=__dcg_shared_module_exports__['wd'](o),this}clone(){let e=new r;return e.r=this.r,e.g=this.g,e.b=this.b,e}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}getRGB(e,t){t===_o?(e.r=__dcg_shared_module_exports__['xd'](this.r),e.g=__dcg_shared_module_exports__['xd'](this.g),e.b=__dcg_shared_module_exports__['xd'](this.b)):(e.r=this.r,e.g=this.g,e.b=this.b)}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}};var kee={triangulate:function(r,e,t=2){let o=e&&e.length,i=o?e[0]*t:r.length,n=Rve(r,0,i,t,!0),a=[];if(!n||n.next===n.prev)return a;let s,c,d,p,u,g,h;if(o)throw new Error("EarCut does not support holes");if(r.length>80*t){s=d=r[0],c=p=r[1];for(let b=t;b<i;b+=t)u=r[b],g=r[b+1],u<s&&(s=u),g<c&&(c=g),u>d&&(d=u),g>p&&(p=g);h=Math.max(d-s,p-c),h=h!==0?32767/h:0}return Fve(n,a,t,s,c,h,0),a}};function Rve(r,e,t,o,i){let n,a;if(i===zve(r,e,t,o)>0)for(n=e;n<t;n+=o)a=See(n,r[n],r[n+1],a);else for(n=t-o;n>=e;n-=o)a=See(n,r[n],r[n+1],a);return a&&Kve(a,a.next)&&(_ee(a),a=a.next),a}function Fve(r,e,t,o,i,n,a){if(!r)return;!a&&n&&Yve(r,o,i,n);let s=r,c,d;for(;r.prev!==r.next;){if(c=r.prev,d=r.next,n?Uve(r,o,i,n):Nve(r)){e.push(c.i/t|0),e.push(r.i/t|0),e.push(d.i/t|0),_ee(r),r=d.next,s=d.next;continue}if(r=d,r===s)throw new Error("EarCut does not expect ear === stop")}}function Nve(r){let e=r.prev,t=r,o=r.next;if(gy(e,t,o)>=0)return!1;let i=e.x,n=t.x,a=o.x,s=e.y,c=t.y,d=o.y,p=i<n?i<a?i:a:n<a?n:a,u=s<c?s<d?s:d:c<d?c:d,g=i>n?i>a?i:a:n>a?n:a,h=s>c?s>d?s:d:c>d?c:d,b=o.next;for(;b!==e;){if(b.x>=p&&b.x<=g&&b.y>=u&&b.y<=h&&k_(i,s,n,c,a,d,b.x,b.y)&&gy(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function Uve(r,e,t,o){let i=r.prev,n=r,a=r.next;if(gy(i,n,a)>=0)return!1;let s=i.x,c=n.x,d=a.x,p=i.y,u=n.y,g=a.y,h=s<c?s<d?s:d:c<d?c:d,b=p<u?p<g?p:g:u<g?u:g,v=s>c?s>d?s:d:c>d?c:d,T=p>u?p>g?p:g:u>g?u:g,E=H5(h,b,e,t,o),I=H5(v,T,e,t,o),_=r.prevZ,C=r.nextZ;for(;_&&_.z>=E&&C&&C.z<=I;){if(_.x>=h&&_.x<=v&&_.y>=b&&_.y<=T&&_!==i&&_!==a&&k_(s,p,c,u,d,g,_.x,_.y)&&gy(_.prev,_,_.next)>=0||(_=_.prevZ,C.x>=h&&C.x<=v&&C.y>=b&&C.y<=T&&C!==i&&C!==a&&k_(s,p,c,u,d,g,C.x,C.y)&&gy(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;_&&_.z>=E;){if(_.x>=h&&_.x<=v&&_.y>=b&&_.y<=T&&_!==i&&_!==a&&k_(s,p,c,u,d,g,_.x,_.y)&&gy(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;C&&C.z<=I;){if(C.x>=h&&C.x<=v&&C.y>=b&&C.y<=T&&C!==i&&C!==a&&k_(s,p,c,u,d,g,C.x,C.y)&&gy(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function Yve(r,e,t,o){let i=r;do i.z===0&&(i.z=H5(i.x,i.y,e,t,o)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==r);i.prevZ.nextZ=void 0,i.prevZ=void 0,Bve(i)}function Bve(r){let e,t,o,i,n,a,s,c,d=1;do{for(t=r,r=void 0,n=void 0,a=0;t;){for(a++,o=t,s=0,e=0;e<d&&(s++,o=o.nextZ,!!o);e++);for(c=d;s>0||c>0&&o;)s!==0&&(c===0||!o||t.z<=o.z)?(i=t,t=t.nextZ,s--):(i=o,o=o.nextZ,c--),n?n.nextZ=i:r=i,i.prevZ=n,n=i;t=o}n.nextZ=void 0,d*=2}while(a>1);return r}function H5(r,e,t,o,i){return r=(r-t)*i|0,e=(e-o)*i|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function k_(r,e,t,o,i,n,a,s){return(i-a)*(e-s)>=(r-a)*(n-s)&&(r-a)*(o-s)>=(t-a)*(e-s)&&(t-a)*(n-s)>=(i-a)*(o-s)}function gy(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function Kve(r,e){return r.x===e.x&&r.y===e.y}function See(r,e,t,o){let i=new W5(r,e,t);return o?(i.next=o.next,i.prev=o,o.next.prev=i,o.next=i):(i.prev=i,i.next=i),i}function _ee(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}var W5=class{constructor(e,t,o){this.i=e,this.x=t,this.y=o,this.z=0,this.prevZ=void 0,this.nextZ=void 0,this.steiner=!1}};function zve(r,e,t,o){let i=0;for(let n=e,a=t-o;n<t;n+=o)i+=(r[a]-r[n])*(r[n+1]+r[a+1]),a=n;return i}var Im=class r{static area(e){let t=e.length,o=0;for(let i=t-1,n=0;n<t;i=n++)o+=e[i].x*e[n].y-e[n].x*e[i].y;return o*.5}static isClockWise(e){return r.area(e)<0}static triangulateShape(e,t){let o=[],i=[],n=[];Cee(e),Tee(o,e);let a=e.length;t.forEach(Cee);for(let c=0;c<t.length;c++)i.push(a),a+=t[c].length,Tee(o,t[c]);let s=kee.triangulate(o,i);for(let c=0;c<s.length;c+=3)n.push(s.slice(c,c+3));return n}};function Cee(r){let e=r.length;e>2&&r[e-1].equals(r[0])&&r.pop()}function Tee(r,e){for(let t=0;t<e.length;t++)r.push(e[t].x),r.push(e[t].y)}var JL=class{constructor(){this.color=new At;this.subPaths=[];this.currentPath=new hy}moveTo(e,t){return this.currentPath=new hy,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,o,i){return this.currentPath.quadraticCurveTo(e,t,o,i),this}toShapes(e=!1){function t(E){let I=[];for(let _=0,C=E.length;_<C;_++){let D=E[_],P=new _w;P.curves=D.curves,I.push(P)}return I}function o(E,I){let _=I.length,C=!1;for(let D=_-1,P=0;P<_;D=P++){let F=I[D],N=I[P],Y=N.x-F.x,z=N.y-F.y;if(Math.abs(z)>Number.EPSILON){if(z<0&&(F=I[P],Y=-Y,N=I[D],z=-z),E.y<F.y||E.y>N.y)continue;if(E.y===F.y){if(E.x===F.x)return!0}else{let X=z*(E.x-F.x)-Y*(E.y-F.y);if(X===0)return!0;if(X<0)continue;C=!C}}else{if(E.y!==F.y)continue;if(N.x<=E.x&&E.x<=F.x||F.x<=E.x&&E.x<=N.x)return!0}}return C}let i=Im.isClockWise,n=this.subPaths;if(n.length===0)return[];let a,s,c,d=[];if(n.length===1)return s=n[0],c=new _w,c.curves=s.curves,d.push(c),d;let p=!i(n[0].getPoints());p=e?!p:p;let u=[],g=[],h=[],b=0,v;h[b]=[];for(let E=0,I=n.length;E<I;E++)if(s=n[E],v=s.getPoints(),a=i(v),a=e?!a:a,a){!p&&g[b]&&b++;let _={s:new _w,p:v};_.s.curves=s.curves,g[b]=_,p&&b++,h[b]=[]}else h[b].push({h:s,p:v[0]});if(!g[0])return t(n);if(g.length>1){let E=!1,I=0;for(let _=0,C=g.length;_<C;_++)u[_]=[];for(let _=0,C=g.length;_<C;_++){let D=h[_];for(let P=0;P<D.length;P++){let F=D[P],N=!0;for(let Y=0;Y<g.length;Y++)o(F.p,g[Y].p)&&(_!==Y&&I++,N?(N=!1,u[Y].push(F)):E=!0);N&&u[_].push(F)}}I>0&&E===!1&&(h=u)}let T;for(let E=0,I=g.length;E<I;E++){c=g[E].s,d.push(c),T=h[E];for(let _=0,C=T.length;_<C;_++)c.holes.push(T[_].h)}return d}};var Jp=class extends es{constructor(e=1,t=1,o=1,i=32,n=1,a=!1,s=0,c=Math.PI*2){super(),this.type="CylinderGeometry";let d=this;i=Math.floor(i),n=Math.floor(n);let p=[],u=[],g=[],h=[],b=0,v=[],T=o/2,E=0;I(),a===!1&&(e>0&&_(!0),t>0&&_(!1)),this.setIndex(p),this.setAttribute("position",new No(u,3)),this.setAttribute("normal",new No(g,3)),this.setAttribute("uv",new No(h,2));function I(){let C=new Ee,D=new Ee,P=0,F=(t-e)/o;for(let N=0;N<=n;N++){let Y=[],z=N/n,X=z*(t-e)+e;for(let q=0;q<=i;q++){let S=q/i,A=S*c+s,O=Math.sin(A),B=Math.cos(A);D.x=X*O,D.y=-z*o+T,D.z=X*B,u.push(D.x,D.y,D.z),C.set(O,F,B).normalize(),g.push(C.x,C.y,C.z),h.push(S,1-z),Y.push(b++)}v.push(Y)}for(let N=0;N<i;N++)for(let Y=0;Y<n;Y++){let z=v[Y][N],X=v[Y+1][N],q=v[Y+1][N+1],S=v[Y][N+1];p.push(z,X,S),p.push(X,q,S),P+=6}d.addGroup(E,P,0),E+=P}function _(C){let D=b,P=new Ft,F=new Ee,N=0,Y=C===!0?e:t,z=C===!0?1:-1;for(let q=1;q<=i;q++)u.push(0,T*z,0),g.push(0,z,0),h.push(.5,.5),b++;let X=b;for(let q=0;q<=i;q++){let A=q/i*c+s,O=Math.cos(A),B=Math.sin(A);F.x=Y*B,F.y=T*z,F.z=Y*O,u.push(F.x,F.y,F.z),g.push(0,z,0),P.x=O*.5+.5,P.y=B*.5*z+.5,h.push(P.x,P.y),b++}for(let q=0;q<i;q++){let S=D+q,A=X+q;C===!0?p.push(A,A+1,S):p.push(A+1,A,S),N+=3}d.addGroup(E,N,C===!0?1:2),E+=N}}};var ZL=class extends Jp{constructor(e=1,t=1,o=32,i=1,n=!1,a=0,s=Math.PI*2){super(0,e,t,o,i,n,a,s),this.type="ConeGeometry"}};var QL=class extends es{constructor(e,t={}){super(),this.type="ExtrudeGeometry";let o=this,i=[],n=[];for(let s=0,c=e.length;s<c;s++){let d=e[s];a(d)}this.setAttribute("position",new No(i,3)),this.setAttribute("uv",new No(n,2)),this.computeVertexNormals();function a(s){let c=[],d=t.curveSegments!==void 0?t.curveSegments:12,p=t.steps!==void 0?t.steps:1,u=t.depth!==void 0?t.depth:1,g=t.bevelEnabled!==void 0?t.bevelEnabled:!0,h=t.bevelThickness!==void 0?t.bevelThickness:.2,b=t.bevelSize!==void 0?t.bevelSize:h-.1,v=t.bevelOffset!==void 0?t.bevelOffset:0,T=t.bevelSegments!==void 0?t.bevelSegments:3,E=t.UVGenerator!==void 0?t.UVGenerator:qve;g||(T=0,h=0,b=0,v=0);let I=s.extractPoints(d),_=I.shape,C=I.holes;if(!Im.isClockWise(_)){_=_.reverse();for(let $=0,se=C.length;$<se;$++){let J=C[$];Im.isClockWise(J)&&(C[$]=J.reverse())}}let P=Im.triangulateShape(_,C),F=_;for(let $=0,se=C.length;$<se;$++){let J=C[$];_=_.concat(J)}function N($,se,J){return se||console.error("THREE.ExtrudeGeometry: vec does not exist"),$.clone().addScaledVector(se,J)}let Y=_.length,z=P.length;function X($,se,J){let ye,Se,Ce,Te=$.x-se.x,Ae=$.y-se.y,je=J.x-$.x,ie=J.y-$.y,te=Te*Te+Ae*Ae,we=Te*ie-Ae*je;if(Math.abs(we)>Number.EPSILON){let Ie=Math.sqrt(te),He=Math.sqrt(je*je+ie*ie),ge=se.x-Ae/Ie,nt=se.y+Te/Ie,lt=J.x-ie/He,Me=J.y+je/He,Nt=((lt-ge)*ie-(Me-nt)*je)/(Te*ie-Ae*je);ye=ge+Te*Nt-$.x,Se=nt+Ae*Nt-$.y;let Tt=ye*ye+Se*Se;if(Tt<=2)return new Ft(ye,Se);Ce=Math.sqrt(Tt/2)}else{let Ie=!1;Te>Number.EPSILON?je>Number.EPSILON&&(Ie=!0):Te<-Number.EPSILON?je<-Number.EPSILON&&(Ie=!0):Math.sign(Ae)===Math.sign(ie)&&(Ie=!0),Ie?(ye=-Ae,Se=Te,Ce=Math.sqrt(te)):(ye=Te,Se=Ae,Ce=Math.sqrt(te/2))}return new Ft(ye/Ce,Se/Ce)}let q=[];for(let $=0,se=F.length,J=se-1,ye=$+1;$<se;$++,J++,ye++)J===se&&(J=0),ye===se&&(ye=0),q[$]=X(F[$],F[J],F[ye]);let S=[],A,O=q.concat();for(let $=0,se=C.length;$<se;$++){let J=C[$];A=[];for(let ye=0,Se=J.length,Ce=Se-1,Te=ye+1;ye<Se;ye++,Ce++,Te++)Ce===Se&&(Ce=0),Te===Se&&(Te=0),A[ye]=X(J[ye],J[Ce],J[Te]);S.push(A),O=O.concat(A)}for(let $=0;$<T;$++){let se=$/T,J=h*Math.cos(se*Math.PI/2),ye=b*Math.sin(se*Math.PI/2)+v;for(let Se=0,Ce=F.length;Se<Ce;Se++){let Te=N(F[Se],q[Se],ye);Z(Te.x,Te.y,-J)}for(let Se=0,Ce=C.length;Se<Ce;Se++){let Te=C[Se];A=S[Se];for(let Ae=0,je=Te.length;Ae<je;Ae++){let ie=N(Te[Ae],A[Ae],ye);Z(ie.x,ie.y,-J)}}}let B=b+v;for(let $=0;$<Y;$++){let se=g?N(_[$],O[$],B):_[$];Z(se.x,se.y,0)}for(let $=1;$<=p;$++)for(let se=0;se<Y;se++){let J=g?N(_[se],O[se],B):_[se];Z(J.x,J.y,u/p*$)}for(let $=T-1;$>=0;$--){let se=$/T,J=h*Math.cos(se*Math.PI/2),ye=b*Math.sin(se*Math.PI/2)+v;for(let Se=0,Ce=F.length;Se<Ce;Se++){let Te=N(F[Se],q[Se],ye);Z(Te.x,Te.y,u+J)}for(let Se=0,Ce=C.length;Se<Ce;Se++){let Te=C[Se];A=S[Se];for(let Ae=0,je=Te.length;Ae<je;Ae++){let ie=N(Te[Ae],A[Ae],ye);Z(ie.x,ie.y,u+J)}}}V(),K();function V(){let $=i.length/3;if(g){let se=0,J=Y*se;for(let ye=0;ye<z;ye++){let Se=P[ye];ee(Se[2]+J,Se[1]+J,Se[0]+J)}se=p+T*2,J=Y*se;for(let ye=0;ye<z;ye++){let Se=P[ye];ee(Se[0]+J,Se[1]+J,Se[2]+J)}}else{for(let se=0;se<z;se++){let J=P[se];ee(J[2],J[1],J[0])}for(let se=0;se<z;se++){let J=P[se];ee(J[0]+Y*p,J[1]+Y*p,J[2]+Y*p)}}o.addGroup($,i.length/3-$,0)}function K(){let $=i.length/3,se=0;oe(F,se),se+=F.length;for(let J=0,ye=C.length;J<ye;J++){let Se=C[J];oe(Se,se),se+=Se.length}o.addGroup($,i.length/3-$,1)}function oe($,se){let J=$.length;for(;--J>=0;){let ye=J,Se=J-1;Se<0&&(Se=$.length-1);for(let Ce=0,Te=p+T*2;Ce<Te;Ce++){let Ae=Y*Ce,je=Y*(Ce+1),ie=se+ye+Ae,te=se+Se+Ae,we=se+Se+je,Ie=se+ye+je;ue(ie,te,we,Ie)}}}function Z($,se,J){c.push($),c.push(se),c.push(J)}function ee($,se,J){he($),he(se),he(J);let ye=i.length/3,Se=E.generateTopUV(o,i,ye-3,ye-2,ye-1);ae(Se[0]),ae(Se[1]),ae(Se[2])}function ue($,se,J,ye){he($),he(se),he(ye),he(se),he(J),he(ye);let Se=i.length/3,Ce=E.generateSideWallUV(o,i,Se-6,Se-3,Se-2,Se-1);ae(Ce[0]),ae(Ce[1]),ae(Ce[3]),ae(Ce[1]),ae(Ce[2]),ae(Ce[3])}function he($){i.push(c[$*3+0]),i.push(c[$*3+1]),i.push(c[$*3+2])}function ae($){n.push($.x),n.push($.y)}}}},qve={generateTopUV:function(r,e,t,o,i){let n=e[t*3],a=e[t*3+1],s=e[o*3],c=e[o*3+1],d=e[i*3],p=e[i*3+1];return[new Ft(n,a),new Ft(s,c),new Ft(d,p)]},generateSideWallUV:function(r,e,t,o,i,n){let a=e[t*3],s=e[t*3+1],c=e[t*3+2],d=e[o*3],p=e[o*3+1],u=e[o*3+2],g=e[i*3],h=e[i*3+1],b=e[i*3+2],v=e[n*3],T=e[n*3+1],E=e[n*3+2];return Math.abs(s-p)<Math.abs(a-d)?[new Ft(a,1-c),new Ft(d,1-u),new Ft(g,1-b),new Ft(v,1-E)]:[new Ft(s,1-c),new Ft(p,1-u),new Ft(h,1-b),new Ft(T,1-E)]}};var __=class extends es{constructor(e=1,t=1,o=1,i=1){super(),this.type="PlaneGeometry";let n=e/2,a=t/2,s=Math.floor(o),c=Math.floor(i),d=s+1,p=c+1,u=e/s,g=t/c,h=[],b=[],v=[],T=[];for(let E=0;E<p;E++){let I=E*g-a;for(let _=0;_<d;_++){let C=_*u-n;b.push(C,-I,0),v.push(0,0,1),T.push(_/s),T.push(1-E/c)}}for(let E=0;E<c;E++)for(let I=0;I<s;I++){let _=I+d*E,C=I+d*(E+1),D=I+1+d*(E+1),P=I+1+d*E;h.push(_,C,P),h.push(C,D,P)}this.setIndex(h),this.setAttribute("position",new No(b,3)),this.setAttribute("normal",new No(v,3)),this.setAttribute("uv",new No(T,2))}};var Cw=class extends si{constructor(t,o=1){super();this.isLight=!0;this.type="Light",this.color=new At(t),this.intensity=o}dispose(){}};var Tw=class extends Cw{constructor(t,o){super(t,o);this.isAmbientLight=!0;this.type="AmbientLight"}};var Mm=class extends Cw{constructor(t,o){super(t,o);this.isDirectionalLight=!0;this.type="DirectionalLight",this.position.copy(si.DEFAULT_UP),this.updateMatrix(),this.target=new si}dispose(){}};function Dm(r){let e={};for(let t in r){e[t]={};for(let o in r[t]){let i=r[t][o];i&&(i instanceof At||i instanceof Co||i instanceof $t||i instanceof Ft||i instanceof Ee||i instanceof gn||i instanceof gl||i instanceof Lc)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][o]=null):e[t][o]=i.clone():Array.isArray(i)?e[t][o]=i.slice():e[t][o]=i}}return e}function Eee(r){let e=[];for(let t=0;t<r.length;t++)e.push(r[t].clone());return e}function Iee(r){return r.getRenderTarget()===null?r.outputColorSpace:Qa}var Hve=0,Pc=class extends hl{constructor(e){super(),Object.defineProperty(this,"id",{value:Hve++}),this.uuid=Mc(),this.name="",this.type="Material",this.blending=vm,this.side=m_,this.vertexColors=!1,this.useVertexPickingColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=AL,this.blendDst=LL,this.blendEquation=Hp,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=f_,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=lee,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KL,this.stencilZFail=KL,this.stencilZPass=KL,this.stencilWrite=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.userData={},this.version=0,this._alphaTest=0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="",this.fragmentShader="",this.wireframe=!1,this.lights=!1,this.forceSinglePass=!0,this.exprTooComplex=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}customProgramCacheKey(){return"no-custom-cache-key"}setValues(e){if(e!==void 0)for(let t in e){let o=t,i=e[o];if(i===void 0){console.warn(`THREE.Material: parameter '${o}' has value of undefined.`);continue}let n=this[o];if(n===void 0){console.warn(`THREE.Material: '${o}' is not a property of THREE.${this.type}.`);continue}n&&n.isColor?n.set(i):n&&n instanceof Ee&&i&&i instanceof Ee?n.copy(i):this[o]=i}}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.useVertexPickingColors=e.useVertexPickingColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Dm(e.uniforms),this.uniformsGroups=Eee(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.lights=e.lights,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}};var Am=class extends Ta{constructor(e,t,o=!1,i=1){super(e,t,o),this.meshPerAttribute=i}};var xi=class extends si{constructor(e,t){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t}};var Mee=new $t,Dee=new Gh,vi=class extends xi{constructor(e,t,o){super(e,t),this.instanceMatrix=new Am(new Float32Array(o*16),16),this.instanceColor=new Am(new Float32Array(o*3),3),this.instancePickingColor=new Am(new Float32Array(o*4),4),this.count=o}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getPickingColorAt(e,t){let o=this.instancePickingColor.array;e=e*4,t[0]=o[e+0],t[1]=o[e+1],t[2]=o[e+2],t[3]=o[e+3]}setColorAt(e,t){t.toArray(this.instanceColor.array,e*3)}setPickingColorAt(e,t){let o=this.instancePickingColor.array,i=e*4;o[i+0]=t[0],o[i+1]=t[1],o[i+2]=t[2],o[i+3]=t[3]}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}computeBoundingSphere(){var o,i;let e=this.geometry,t=this.count;this.boundingSphere||(this.boundingSphere=new Gh),e.boundingSphere||e.computeBoundingSphere(),(o=this.boundingSphere)==null||o.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Mee),Dee.copy(e.boundingSphere).applyMatrix4(Mee),(i=this.boundingSphere)==null||i.union(Dee)}dispose(){this.dispatchEvent({type:"dispose"})}};var Vh=class{constructor(e=new Ee(1,0,0),t=0){this.isPlane=!0;this.normal=e,this.constant=t}setComponents(e,t,o,i){return this.normal.set(e,t,o),this.constant=i,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}distanceToPoint(e){return this.normal.dot(e)+this.constant}};var C_=new Gh,eP=class{constructor(e=new Vh,t=new Vh,o=new Vh,i=new Vh,n=new Vh,a=new Vh){this.planes=[e,t,o,i,n,a]}setFromProjectionMatrix(e,t=Ac){let o=this.planes,i=e.elements,n=i[0],a=i[1],s=i[2],c=i[3],d=i[4],p=i[5],u=i[6],g=i[7],h=i[8],b=i[9],v=i[10],T=i[11],E=i[12],I=i[13],_=i[14],C=i[15];if(o[0].setComponents(c-n,g-d,T-h,C-E).normalize(),o[1].setComponents(c+n,g+d,T+h,C+E).normalize(),o[2].setComponents(c+a,g+p,T+b,C+I).normalize(),o[3].setComponents(c-a,g-p,T-b,C-I).normalize(),o[4].setComponents(c-s,g-u,T-v,C-_).normalize(),t===Ac)o[5].setComponents(c+s,g+u,T+v,C+_).normalize();else if(t===v_)o[5].setComponents(s,u,v,_).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){let t=e.geometry;return t?(e instanceof vi?(e.computeBoundingSphere(),C_.copy(e.boundingSphere).applyMatrix4(e.matrixWorld)):(t.boundingSphere||t.computeBoundingSphere(),C_.copy(t.boundingSphere),C_.applyMatrix4(e.dcgModelMatrix),C_.applyMatrix4(e.matrixWorld)),this.intersectsSphere(C_)):!1}intersectsSphere(e){let t=this.planes,o=e.center,i=-e.radius;for(let n=0;n<6;n++)if(t[n].distanceToPoint(o)<i)return!1;return!0}};var T_=class extends si{constructor(){super(),this.isGroup=!0,this.type="Group"}};var Aee=new Ee,Lee=new Ee,tP=class extends si{constructor(e,t){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,o=[0];for(let i=1,n=t.count;i<n;i++)Aee.fromBufferAttribute(t,i-1),Lee.fromBufferAttribute(t,i),o[i]=o[i-1],o[i]+=Aee.distanceTo(Lee);e.setAttribute("lineDistance",new No(o,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}};var Pee=new Ee,Gee=new Ee,rP=class extends tP{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,o=[];for(let i=0,n=t.count;i<n;i+=2)Pee.fromBufferAttribute(t,i),Gee.fromBufferAttribute(t,i+1),o[i]=i===0?0:o[i-1],o[i+1]=o[i]+Pee.distanceTo(Gee);e.setAttribute("lineDistance",new No(o,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}};var Vee=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}

vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
`;var Oee=`
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6

#define saturate( a ) clamp( a, 0.0, 1.0 )

float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }

#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif

struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};

struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};

struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
};

vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}

vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}

vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
`;var Ree=`
#ifdef USE_MAP
	diffuseColor *= texture2D( map, vMapUv );
#endif

#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif
`;var Fee=`
#ifdef OPAQUE
  diffuseColor.a = 1.0;
#endif

gl_FragColor = vec4( outgoingLight, diffuseColor.a );
gl_FragColor = linearToOutputTexel( gl_FragColor );

#ifdef PREMULTIPLIED_ALPHA
	// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.
	gl_FragColor.rgb *= gl_FragColor.a;
#endif
`;var Nee=`
#ifdef USE_MAP
	varying vec2 vMapUv;
	uniform sampler2D map;
#endif

#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif

#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif

#if defined(USE_INSTANCING_PICKINGCOLOR) || defined(USE_VERTEX_PICKING_COLOR)
	varying vec4 vPickingColor;
#endif
`;var Uee=`
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif

#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif

#if defined(USE_INSTANCING_PICKINGCOLOR) || defined (USE_VERTEX_PICKING_COLOR)
	varying vec4 vPickingColor;
#endif
`;var Yee=`
#ifdef USE_MAP
	vMapUv = ( vec3( MAP_UV, 1 ) ).xy;
#endif

vec3 transformed = vec3( position );
vec4 mvPosition = vec4( transformed, 1.0 );

#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#else
	mvPosition = dcgModelMatrix * mvPosition;
#endif

mvPosition = modelViewMatrix * mvPosition;

gl_Position = projectionMatrix * mvPosition;

#ifdef USE_COLOR
	vColor = color;
#endif

#ifdef USE_INSTANCING_COLOR
  vColor = instanceColor;
#endif

#ifdef USE_INSTANCING_PICKINGCOLOR
	vPickingColor = instancePickingColor;
#endif

#ifdef USE_VERTEX_PICKING_COLOR
	vPickingColor = vertexPickingColor;
#endif

`;var Bee=`
PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );

vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );

material.roughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );

#ifdef IOR
	material.ior = ior;
	float specularIntensityFactor = 1.0;
	vec3 specularColorFactor = vec3( 1.0 );
	material.specularF90 = 1.0;
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif

GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );

IncidentLight directLight;

#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif

#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
#endif

#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif

#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif

#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif
`;var Kee=`
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];

vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}

vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}

vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}

#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif

struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;

	#ifdef IOR
		float ior;
	#endif
};

vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );

float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}

float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1
	return RECIPROCAL_PI * a2 / pow2( denom );
}

vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness ); // UE4's roughness
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}

vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}

void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 Fr = specularColor;
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619; // 1/21
	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}

void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}

#define RE_Direct RE_Direct_Physical
#define RE_IndirectDiffuse RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular	RE_IndirectSpecular_Physical
`;var mn={common:Oee,colorspace_pars_fragment:Vee,common_fragment_begin:Ree,common_fragment_end:Fee,common_pars_fragment:Nee,common_pars_vertex:Uee,common_vertex:Yee,lights_fragment:Bee,lights_pars_fragment:Kee};var j5={common:{diffuse:{value:new At(16777215)},opacity:{value:1},map:{value:null},alphaTest:{value:0}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}}}};var oP=class{constructor(e,t){this.gl=e;this.info=t}setMode(e){this.mode=e}render(e,t){this.gl.drawArrays(this.mode,e,t),this.info.update(t,this.mode,1)}renderInstances(e,t,o){o!==0&&(this.gl.drawArraysInstanced(this.mode,e,t,o),this.info.update(t,this.mode,o))}};var iP=class{constructor(e,t,o){let i;function n(){if(i!==void 0)return i;if(t.has("EXT_texture_filter_anisotropic")===!0){let F=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(F.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i||0}function a(F){if(F==="highp"){let N=e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT),Y=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);if(N!==null&&N.precision>0&&Y!==null&&Y.precision>0)return"highp";F="mediump"}if(F==="mediump"){let N=e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT),Y=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT);if(N!==null&&N.precision>0&&Y!==null&&Y.precision>0)return"mediump"}return"lowp"}let s=typeof WebGL2RenderingContext!="undefined"&&e.constructor.name==="WebGL2RenderingContext",c=o.precision!==void 0?o.precision:"highp",d=a(c);d!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",d,"instead."),c=d);let p=s||t.has("WEBGL_draw_buffers"),u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),g=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_TEXTURE_SIZE),b=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),v=e.getParameter(e.MAX_VERTEX_ATTRIBS),T=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),E=e.getParameter(e.MAX_VARYING_VECTORS),I=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),_=g>0,C=s||t.has("OES_texture_float"),D=_&&C,P=s?e.getParameter(e.MAX_SAMPLES):0;this.isWebGL2=s,this.drawBuffers=p,this.getMaxAnisotropy=n,this.getMaxPrecision=a,this.precision=c,this.maxTextures=u,this.maxVertexTextures=g,this.maxTextureSize=h,this.maxCubemapSize=b,this.maxAttributes=v,this.maxVertexUniforms=T,this.maxVaryings=E,this.maxFragmentUniforms=I,this.vertexTextures=_,this.floatFragmentTextures=C,this.floatVertexTextures=D,this.maxSamples=P}};var nP=class{constructor(e){let t={};function o(i){if(t[i]!==void 0)return t[i];let n;switch(i){case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return t[i]=n,n}this.has=function(i){return o(i)!==null},this.init=function(){o("EXT_color_buffer_float"),o("OES_texture_float_linear"),o("EXT_color_buffer_half_float"),o("WEBGL_multisampled_render_to_texture")},this.get=function(i){let n=o(i);return n===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),n}}};var Ew=class extends es{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}};var aP=class{constructor(e,t,o,i){let n={},a=new WeakMap;function s(g){let h=g.target;h.index!==null&&t.remove(h.index);for(let v in h.attributes)t.remove(h.attributes[v]);h.removeEventListener("dispose",s),delete n[h.id];let b=a.get(h);b&&(t.remove(b),a.delete(h)),i.releaseStatesOfGeometry(h),h instanceof Ew&&delete h._maxInstanceCount,o.memory.geometries--}function c(g,h){return n[h.id]===!0||(h.addEventListener("dispose",s),n[h.id]=!0,o.memory.geometries++),h}function d(g){let h=g.attributes;for(let b in h)t.update(h[b],e.ARRAY_BUFFER)}function p(g){let h=[],b=g.index,v=g.attributes.position,T=0;if(b!==null){let _=b.array;T=b.version;for(let C=0,D=_.length;C<D;C+=3){let P=_[C+0],F=_[C+1],N=_[C+2];h.push(P,F,F,N,N,P)}}else if(v!==void 0){let _=v.array;T=v.version;for(let C=0,D=_.length/3-1;C<D;C+=3){let P=C+0,F=C+1,N=C+2;h.push(P,F,F,N,N,P)}}else return;let E=new(HL(h)?_m:km)(h,1);E.version=T;let I=a.get(g);I&&t.remove(I),a.set(g,E)}function u(g){let h=a.get(g);if(h){let v=g.index;v!==null&&h.version<v.version&&p(g)}else p(g);let b=a.get(g);return Dt(b,"attribute"),b}this.get=c,this.update=d,this.getWireframeAttribute=u}};var sP=class{constructor(e,t){this.gl=e;this.info=t}setMode(e){this.mode=e}setIndex(e){this.type=e.type,this.bytesPerElement=e.bytesPerElement}render(e,t){this.gl.drawElements(this.mode,t,this.type,e*this.bytesPerElement),this.info.update(t,this.mode,1)}renderInstances(e,t,o){o!==0&&(this.gl.drawElementsInstanced(this.mode,t,this.type,e*this.bytesPerElement,o),this.info.update(t,this.mode,o))}};var lP=class{constructor(e){this.gl=e;this.autoReset=!0;this.programs=null;this.memory={geometries:0,textures:0},this.render={frame:0,calls:0,triangles:0,points:0,lines:0}}update(e,t,o){let i=this.gl,n=this.render;switch(n.calls++,t){case i.TRIANGLES:n.triangles+=o*(e/3);break;case i.LINES:n.lines+=o*(e/2);break;case i.LINE_STRIP:n.lines+=o*(e-1);break;case i.LINE_LOOP:n.lines+=o*e;break;case i.POINTS:n.points+=o*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",t);break}}reset(){this.render.calls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}};var X5=class{constructor(){this.lights={}}get(e){let t=this.lights,o=t[e.id];if(o!==void 0)return o;let i={direction:new Ee,color:new At};return t[e.id]=i,i}},Wve=0,cP=class{constructor(){let e=new X5;this.state={version:0,hash:{directionalLength:-1},ambient:[0,0,0],directional:[]};let t=this.state,o=new Ee;function i(a){let s=0,c=0,d=0,p=0;for(let g=0,h=a.length;g<h;g++){let b=a[g],v=b.color,T=b.intensity;if(b instanceof Tw)s+=v.r*T,c+=v.g*T,d+=v.b*T;else if(b instanceof Mm){let E=e.get(b);E.color.copy(b.color).multiplyScalar(b.intensity),t.directional[p]=E,p++}}t.ambient[0]=s,t.ambient[1]=c,t.ambient[2]=d;let u=t.hash;u.directionalLength!==p&&(t.directional.length=p,u.directionalLength=p,t.version=Wve++)}function n(a,s){let c=0,d=s.matrixWorldInverse;for(let p=0,u=a.length;p<u;p++){let g=a[p];if(g instanceof Mm){let h=t.directional[c];h.direction.setFromMatrixPosition(g.matrixWorld),o.setFromMatrixPosition(g.target.matrixWorld),h.direction.sub(o),h.direction.transformDirection(d),c++}}}this.setup=i,this.setupView=n}};var dP=class{constructor(e,t,o,i){let n=new WeakMap;function a(d){let p=i.render.frame,u=d.geometry,g=t.get(d,u);return n.get(g)!==p&&(t.update(g),n.set(g,p)),d instanceof vi&&(d.hasEventListener("dispose",c)===!1&&d.addEventListener("dispose",c),n.get(d)!==p&&(o.update(d.instanceMatrix,e.ARRAY_BUFFER),d.instanceColor&&o.update(d.instanceColor,e.ARRAY_BUFFER),d.instancePickingColor&&o.update(d.instancePickingColor,e.ARRAY_BUFFER),n.set(d,p))),g}function s(){n=new WeakMap}function c(d){let p=d.target;p.removeEventListener("dispose",c),o.remove(p.instanceMatrix),p.instanceColor&&o.remove(p.instanceColor),p.instancePickingColor&&o.remove(p.instancePickingColor)}this.update=a,this.dispose=s}};En();function $5(r,e,t){let o=r.createShader(e);if(!o)throw new Error(`Error creating shader (type ${e}): ${t}`);return r.shaderSource(o,t),r.compileShader(o),o}var $ee=new gl(new $p(0,0));function jve(r){return typeof r[0]=="number"}function Oh(r){return!Array.isArray(r)&&"x"in r}var zee=[],qee=[],Hee=new Float32Array(16),Wee=new Float32Array(9),jee=new Float32Array(4);function Iw(r,e,t){if(jve(r))return r;let o=e*t,i=zee[o];if(i===void 0&&(i=new Float32Array(o),zee[o]=i),e!==0){r[0].toArray(i,0);for(let n=1,a=0;n!==e;++n)a+=t,r[n].toArray(i,a)}return i}function ts(r,e){if(r.length!==e.length)return!1;for(let t=0,o=r.length;t<o;t++)if(r[t]!==e[t])return!1;return!0}function rs(r,e){for(let t=0,o=e.length;t<o;t++)r[t]=e[t]}function Xve(r,e){let t=qee[e];t===void 0&&(t=new Int32Array(e),qee[e]=t);for(let o=0;o!==e;++o)t[o]=r.allocateTextureUnit();return t}function $ve(r,e){let t=this.cache;t[0]!==e&&(r.uniform1f(this.addr,e),t[0]=e)}function Jve(r,e){let t=this.cache;if(Oh(e))(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ts(t,e))return;r.uniform2fv(this.addr,e),rs(t,e)}}function Zve(r,e){let t=this.cache;if(Oh(e))(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e instanceof At)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(r.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ts(t,e))return;r.uniform3fv(this.addr,e),rs(t,e)}}function Qve(r,e){let t=this.cache;if(Oh(e))(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ts(t,e))return;r.uniform4fv(this.addr,e),rs(t,e)}}function e1e(r,e){let t=this.cache;if(Array.isArray(e)){if(ts(t,e))return;r.uniformMatrix2fv(this.addr,!1,e),rs(t,e)}else{let o=e.elements;if(ts(t,o))return;jee.set(o),r.uniformMatrix2fv(this.addr,!1,jee),rs(t,o)}}function t1e(r,e){let t=this.cache;if(Array.isArray(e)){if(ts(t,e))return;r.uniformMatrix3fv(this.addr,!1,e),rs(t,e)}else{let o=e.elements;if(ts(t,o))return;Wee.set(o),r.uniformMatrix3fv(this.addr,!1,Wee),rs(t,o)}}function r1e(r,e){let t=this.cache;if(Array.isArray(e)){if(ts(t,e))return;r.uniformMatrix4fv(this.addr,!1,e),rs(t,e)}else{let o=e.elements;if(ts(t,o))return;Hee.set(o),r.uniformMatrix4fv(this.addr,!1,Hee),rs(t,o)}}function o1e(r,e){let t=this.cache;t[0]!==e&&(r.uniform1i(this.addr,e),t[0]=e)}function i1e(r,e){let t=this.cache;if(Oh(e))(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ts(t,e))return;r.uniform2iv(this.addr,e),rs(t,e)}}function n1e(r,e){let t=this.cache;if(Oh(e))(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ts(t,e))return;r.uniform3iv(this.addr,e),rs(t,e)}}function a1e(r,e){let t=this.cache;if(Oh(e))(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ts(t,e))return;r.uniform4iv(this.addr,e),rs(t,e)}}function s1e(r,e){let t=this.cache;t[0]!==e&&(r.uniform1ui(this.addr,e),t[0]=e)}function l1e(r,e){let t=this.cache;if(Oh(e))(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ts(t,e))return;r.uniform2uiv(this.addr,e),rs(t,e)}}function c1e(r,e){let t=this.cache;if(Oh(e))(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ts(t,e))return;r.uniform3uiv(this.addr,e),rs(t,e)}}function d1e(r,e){let t=this.cache;if(Oh(e))(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ts(t,e))return;r.uniform4uiv(this.addr,e),rs(t,e)}}function p1e(r,e,t){let o=this.cache,i=t.allocateTextureUnit();o[0]!==i&&(r.uniform1i(this.addr,i),o[0]=i),t.setTexture2D(e||$ee,i)}function u1e(r){switch(r){case 5126:return $ve;case 35664:return Jve;case 35665:return Zve;case 35666:return Qve;case 35674:return e1e;case 35675:return t1e;case 35676:return r1e;case 5124:case 35670:return o1e;case 35667:case 35671:return i1e;case 35668:case 35672:return n1e;case 35669:case 35673:return a1e;case 5125:return s1e;case 36294:return l1e;case 36295:return c1e;case 36296:return d1e;case 35678:case 36198:case 36298:case 36306:return p1e;case 35679:case 36299:case 36307:throw new Error("THREE.WebGLUniforms: sampler3D support is not implemented.");case 35680:case 36300:case 36308:throw new Error("THREE.WebGLUniforms: samplerCube support is not implemented.");case 36289:case 36303:case 36311:throw new Error("THREE.WebGLUniforms: sampler2DArray support is not implemented.")}throw new Error(`Unknown uniform type: ${r}`)}function h1e(r,e){r.uniform1fv(this.addr,e)}function g1e(r,e){let t=Iw(e,this.size,2);r.uniform2fv(this.addr,t)}function m1e(r,e){let t=Iw(e,this.size,3);r.uniform3fv(this.addr,t)}function f1e(r,e){let t=Iw(e,this.size,4);r.uniform4fv(this.addr,t)}function b1e(r,e){let t=Iw(e,this.size,4);r.uniformMatrix2fv(this.addr,!1,t)}function y1e(r,e){let t=Iw(e,this.size,9);r.uniformMatrix3fv(this.addr,!1,t)}function x1e(r,e){let t=Iw(e,this.size,16);r.uniformMatrix4fv(this.addr,!1,t)}function v1e(r,e){r.uniform1iv(this.addr,e)}function w1e(r,e){r.uniform2iv(this.addr,e)}function S1e(r,e){r.uniform3iv(this.addr,e)}function k1e(r,e){r.uniform4iv(this.addr,e)}function _1e(r,e){r.uniform1uiv(this.addr,e)}function C1e(r,e){r.uniform2uiv(this.addr,e)}function T1e(r,e){r.uniform3uiv(this.addr,e)}function E1e(r,e){r.uniform4uiv(this.addr,e)}function I1e(r,e,t){let o=this.cache,i=e.length,n=Xve(t,i);ts(o,n)||(r.uniform1iv(this.addr,n),rs(o,n));for(let a=0;a!==i;++a)t.setTexture2D(e[a]||$ee,n[a])}function M1e(r){switch(r){case 5126:return h1e;case 35664:return g1e;case 35665:return m1e;case 35666:return f1e;case 35674:return b1e;case 35675:return y1e;case 35676:return x1e;case 5124:case 35670:return v1e;case 35667:case 35671:return w1e;case 35668:case 35672:return S1e;case 35669:case 35673:return k1e;case 5125:return _1e;case 36294:return C1e;case 36295:return T1e;case 36296:return E1e;case 35678:case 36198:case 36298:case 36306:return I1e;case 35679:case 36299:case 36307:throw new Error("THREE.WebGLUniforms: sampler3DArray support is not implemented.");case 35680:case 36300:case 36308:throw new Error("THREE.WebGLUniforms: samplerCube support is not implemented.");case 36289:case 36303:case 36311:throw new Error("THREE.WebGLUniforms: sampler2DArray support is not implemented.")}throw new Error(`Unrecognized uniform type: ${r}`)}var Z5=class{constructor(e,t,o){this.id=e,this.addr=o,this.cache=[],this.setValue=u1e(t.type)}},Q5=class{constructor(e,t,o){this.id=e,this.addr=o,this.cache=[],this.size=t.size,this.setValue=M1e(t.type)}},pP=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,o){let i=this.seq;for(let n=0,a=i.length;n!==a;++n){let s=i[n];s.setValue(e,t[s.id],o)}}},J5=/(\w+)(\])?(\[|\.)?/g;function Xee(r,e){r.seq.push(e),r.map[e.id]=e}function D1e(r,e,t){let o=r.name,i=o.length;for(J5.lastIndex=0;;){let n=J5.exec(o),a=J5.lastIndex;Dt(n,"parseUniform match");let s=n[1],c=n[2]==="]",d=n[3];if(c&&(s=s|0),d===void 0||d==="["&&a+2===i){Xee(t,d===void 0?new Z5(s,r,e):new Q5(s,r,e));break}else{let u=t.map[s];if(u===void 0&&(u=new pP(s),Xee(t,u)),!(u instanceof pP))throw new Error(`THREE.WebGLUniforms: Programming error: expected ${s} to be a StructuredUniform`);t=u}}}var Lm=class{constructor(e,t){this.seq=[],this.map={};let o=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<o;++i){let n=e.getActiveUniform(t,i);Dt(n,"active info",e);let a=e.getUniformLocation(t,n.name);D1e(n,a,this)}}setValue(e,t,o,i){let n=this.map[t];n!==void 0&&n.setValue(e,o,i)}setOptional(e,t,o,i){let n=t[o];n!==void 0&&this.setValue(e,o,n,i)}static upload(e,t,o,i){for(let n=0,a=t.length;n!==a;++n){let s=t[n],c=o[s.id];c.needsUpdate!==!1&&s.setValue(e,c.value,i)}}static seqWithValue(e,t){let o=[];for(let i=0,n=e.length;i!==n;++i){let a=e[i];a.id in t&&o.push(a)}return o}};var A1e=0;function L1e(r,e){if(r===null)throw new Error("Shader source is undefined.");let t=r.split(`
`),o=[],i=Math.max(e-6,0),n=Math.min(e+6,t.length);for(let a=i;a<n;a++){let s=a+1;o.push(`${s===e?">":" "} ${s}: ${t[a]}`)}return o.join(`
`)}function P1e(r){switch(r){case Qa:return["Linear","( value )"];case _o:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",r),["Linear","( value )"]}}function Jee(r,e,t){let o=r.getShaderParameter(e,r.COMPILE_STATUS),i=r.getShaderInfoLog(e);Dt(i,"shader info",r);let n=i.trim()||"";if(o&&n==="")return"";let a=/ERROR: 0:(\d+)/.exec(n);if(a){let s=parseInt(a[1]);return t.toUpperCase()+`

`+n+`

`+L1e(r.getShaderSource(e),s)}else return n}function G1e(r,e){let t=P1e(e);return"vec4 "+r+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function V1e(r){let e=[];for(let t in r){let o=r[t];o!==!1&&e.push("#define "+t+" "+o)}return e.join(`
`)}function O1e(r,e){let t={},o=r.getProgramParameter(e,r.ACTIVE_ATTRIBUTES);for(let i=0;i<o;i++){let n=r.getActiveAttrib(e,i);if(!n)throw new Error("THREE.WebGLProgram: Error fetching attribute info.");let a=n.name,s=1;n.type===r.FLOAT_MAT2&&(s=2),n.type===r.FLOAT_MAT3&&(s=3),n.type===r.FLOAT_MAT4&&(s=4),t[a]={type:n.type,location:r.getAttribLocation(e,a),locationSize:s}}return t}function Zee(r){return r!==""}function Qee(r,e){return r.replace(/NUM_DIR_LIGHTS/g,""+e.numDirLights)}var R1e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ete(r){return r.replace(R1e,F1e)}function F1e(r,e,t,o){let i="";for(let n=parseInt(e);n<parseInt(t);n++)i+=o.replace(/\[\s*i\s*\]/g,"[ "+n+" ]").replace(/UNROLLED_LOOP_INDEX/g,""+n);return i}function tte(r){let e="precision "+r.precision+` float;
precision `+r.precision+" int;";return r.precision==="highp"?e+=`
#define HIGH_PRECISION`:r.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}var uP=class{constructor(e,t,o,i){var C,D,P;let n=e.getContext(),a=o.defines,s=o.vertexShader,c=o.fragmentShader,d=V1e(a),p=n.createProgram();if(!p)throw new Error("THREE.WebGLProgram: Unable to create program.");let u,g,h=o.glslVersion?"#version "+o.glslVersion+`
`:"";u=[tte(o),"#define SHADER_TYPE "+o.shaderType,"#define SHADER_NAME "+o.shaderName,d,o.instancing?"#define USE_INSTANCING":"",o.instancingColor?"#define USE_INSTANCING_COLOR":"",o.instancingPickingColor?"#define USE_INSTANCING_PICKINGCOLOR":"",o.vertexPickingColor?"#define USE_VERTEX_PICKING_COLOR":"",o.map?"#define USE_MAP":"",o.mapUv?"#define MAP_UV "+o.mapUv:"",o.vertexColors?"#define USE_COLOR":"",o.vertexUv1s?"#define USE_UV1":"",o.vertexUv2s?"#define USE_UV2":"",o.vertexUv3s?"#define USE_UV3":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_PICKINGCOLOR","	attribute vec4 instancePickingColor;","#endif","#ifdef USE_VERTEX_PICKING_COLOR"," attribute vec4 vertexPickingColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif",`
`].filter(Zee).join(`
`),g=[tte(o),"#define SHADER_TYPE "+o.shaderType,"#define SHADER_NAME "+o.shaderName,d,o.map?"#define USE_MAP":"",o.alphaTest?"#define USE_ALPHATEST":"",o.vertexColors?"#define USE_COLOR":"",o.instancingColor?"#define USE_INSTANCING_COLOR":"",o.instancingPickingColor?"#define USE_INSTANCING_PICKINGCOLOR":"",o.vertexPickingColor?"#define USE_VERTEX_PICKING_COLOR":"",o.vertexUv1s?"#define USE_UV1":"",o.vertexUv2s?"#define USE_UV2":"",o.vertexUv3s?"#define USE_UV3":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",o.opaque?"#define OPAQUE":"",mn.colorspace_pars_fragment,G1e("linearToOutputTexel",o.outputColorSpace),`
`].filter(Zee).join(`
`),s=Qee(s,o),c=Qee(c,o),s=ete(s),c=ete(c),h=`#version 300 es
`,u=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+u,g=["#define varying in",o.glslVersion===N5?"":"layout(location = 0) out highp vec4 pc_fragColor;",o.glslVersion===N5?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g;let b=h+u+s,v=h+g+c,T=$5(n,n.VERTEX_SHADER,b),E=$5(n,n.FRAGMENT_SHADER,v);if(n.attachShader(p,T),n.attachShader(p,E),o.index0AttributeName!==void 0&&n.bindAttribLocation(p,0,o.index0AttributeName),n.linkProgram(p),e.debug.checkShaderErrors){let F=(C=n.getProgramInfoLog(p))==null?void 0:C.trim(),N=(D=n.getShaderInfoLog(T))==null?void 0:D.trim(),Y=(P=n.getShaderInfoLog(E))==null?void 0:P.trim();Dt(F,"program lob",n),Dt(N,"vertex log",n),Dt(Y,"fragment log",n);let z=!0,X=!0,q=!1;if(n.getProgramParameter(p,n.LINK_STATUS)===!1)if(z=!1,typeof e.debug.onShaderError=="function")e.debug.onShaderError(n,p,T,E);else{let S=Jee(n,T,"vertex"),A=Jee(n,E,"fragment"),O=n.getError();q=A.includes("Expression too complex"),q||(console.error("THREE.WebGLProgram: Shader Error "+O+" - VALIDATE_STATUS "+n.getProgramParameter(p,n.VALIDATE_STATUS)+`

Program Info Log: `+F+`
`+S+`
`+A),O&&O!=1282||S||A||F&&O!=1282?Er("Shader error",{metaData:{glError:O,glProgramParameter:n.getProgramParameter(p,n.VALIDATE_STATUS),glProgramLog:F,glVertexErrors:S,glFragmentError:A,vertexShader:b,fragmentShader:v}}):Er("WebGL program link failure with no error reported",{metaData:{vertexShader:b,fragmentShader:v}}))}else F!==""?console.warn("THREE.WebGLProgram: Program Info Log:",F):(N===""||Y==="")&&(X=!1);X&&(this.diagnostics={runnable:z,exprTooComplex:q,programLog:F,vertexShader:{log:N,prefix:u},fragmentShader:{log:Y,prefix:g}})}n.deleteShader(T),n.deleteShader(E);let I;this.getUniforms=function(){return I===void 0&&(I=new Lm(n,p)),I};let _;this.getAttributes=function(){return _===void 0&&(_=O1e(n,p)),_},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(p),this.program=void 0},this.type=o.shaderType,this.name=o.shaderName,this.id=A1e++,this.cacheKey=t,this.usedTimes=1,this.program=p,this.vertexShader=T,this.fragmentShader=E}};var N1e=0,hP=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,o=e.fragmentShader,i=this._getShaderStage(t),n=this._getShaderStage(o),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(n)===!1&&(a.add(n),n.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let o of t||[])o.usedTimes--,o.usedTimes===0&&this.shaderCache.delete(o.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,o=t.get(e);return o===void 0&&(o=new Set,t.set(e,o)),o}_getShaderStage(e){let t=this.shaderCache,o=t.get(e);return o===void 0&&(o=new eY(e),t.set(e,o)),o}},eY=class{constructor(e){this.id=N1e++,this.code=e,this.usedTimes=0}};var gP=class{constructor(e,t,o){let i=new xw,n=new hP,a=[],s=t.vertexTextures,c=t.precision;function d(I){return I===0?"uv":`uv${I}`}function p(I,_,C,D){var V,K,oe,Z;let P=D.geometry;I.precision!==null&&(c=t.getMaxPrecision(I.precision),c!==I.precision&&console.warn("THREE.WebGLProgram.getParameters:",I.precision,"not supported, using",c,"instead."));let F=I.vertexShader,N=I.fragmentShader;n.update(I);let Y=n.getVertexShaderID(I),z=n.getFragmentShaderID(I),X=e.getRenderTarget(),q=D instanceof vi,S=!!P.attributes.uv1,A=!!P.attributes.uv2,O=!!P.attributes.uv3;return{shaderType:I.type,shaderName:I.name,vertexShader:F,fragmentShader:N,defines:I.defines,customVertexShaderID:Y,customFragmentShaderID:z,glslVersion:I.glslVersion,precision:c,instancing:q,instancingColor:q&&!!D.instanceColor,instancingPickingColor:q&&!!D.instancePickingColor,vertexPickingColor:!!D.pickingColorArray,supportsVertexTextures:s,outputColorSpace:X===null?e.outputColorSpace:Qa,map:!!I.map,opaque:I.transparent===!1&&I.blending===vm,alphaTest:I.alphaTest>0,mapUv:!!I.map&&d(I.map.channel),vertexColors:I.vertexColors,vertexUv1s:S,vertexUv2s:A,vertexUv3s:O,numDirLights:_.directional.length,premultipliedAlpha:I.premultipliedAlpha,doubleSided:I.side===Ca,flipSided:I.side===ly,index0AttributeName:I.index0AttributeName,extensionDerivatives:((V=I.extensions)==null?void 0:V.derivatives)===!0,extensionFragDepth:((K=I.extensions)==null?void 0:K.fragDepth)===!0,extensionDrawBuffers:((oe=I.extensions)==null?void 0:oe.drawBuffers)===!0,extensionShaderTextureLOD:((Z=I.extensions)==null?void 0:Z.shaderTextureLOD)===!0,rendererExtensionFragDepth:!0,rendererExtensionDrawBuffers:!0,rendererExtensionShaderTextureLod:!0,customProgramCacheKey:I.customProgramCacheKey()}}function u(I){let _=[];if(_.push(I.customVertexShaderID),_.push(I.customFragmentShaderID),I.defines!==void 0)for(let C in I.defines)_.push(C),_.push(I.defines[C]);return g(_,I),h(_,I),_.push(e.outputColorSpace),_.push(I.customProgramCacheKey),_.join()}function g(I,_){I.push(_.precision),I.push(_.outputColorSpace),I.push(_.mapUv),I.push(_.numDirLights)}function h(I,_){i.disableAll(),i.enable(0),_.instancing&&i.enable(2),_.instancingColor&&i.enable(3),_.instancingPickingColor&&i.enable(4),_.vertexPickingColor&&i.enable(5),_.supportsVertexTextures&&i.enable(1),_.alphaTest&&i.enable(10),_.vertexColors&&i.enable(11),_.vertexUv1s&&i.enable(13),_.vertexUv2s&&i.enable(14),_.vertexUv3s&&i.enable(15),I.push(i.mask),i.disableAll(),_.premultipliedAlpha&&i.enable(8),_.doubleSided&&i.enable(11),_.flipSided&&i.enable(12),_.opaque&&i.enable(17),I.push(i.mask)}function b(I,_){let C;for(let D=0,P=a.length;D<P;D++){let F=a[D];if(F.cacheKey===_){C=F,++C.usedTimes;break}}return C===void 0&&(C=new uP(e,_,I,o),a.push(C)),C}function v(I){if(--I.usedTimes===0){let _=a.indexOf(I);a[_]=a[a.length-1],a.pop(),I.destroy()}}function T(I){n.remove(I)}function E(){n.dispose()}this.getParameters=p,this.getProgramCacheKey=u,this.getUniforms=I=>I.uniforms,this.acquireProgram=b,this.releaseProgram=v,this.releaseShaderCache=T,this.programs=a,this.dispose=E}};var mP=class{constructor(){let e=new WeakMap;function t(a){let s=e.get(a);return s===void 0&&(s={},e.set(a,s)),s}function o(a){e.delete(a)}function i(a,s,c){e.get(a)[s]=c}function n(){e=new WeakMap}this.get=t,this.remove=o,this.update=i,this.dispose=n}};var fP=class{constructor(){let e=[],t=0,o=[],i=[];function n(){t=0,o.length=0,i.length=0}function a(u,g,h,b,v,T){let E=e[t];return E===void 0?(E={id:u.id,object:u,geometry:g,material:h,groupOrder:b,renderOrder:u.renderOrder,z:v,group:T},e[t]=E):(E.id=u.id,E.object=u,E.geometry=g,E.material=h,E.groupOrder=b,E.renderOrder=u.renderOrder,E.z=v,E.group=T),t++,E}function s(u,g,h,b,v,T){let E=a(u,g,h,b,v,T);h.transparent===!0?i.push(E):o.push(E)}function c(u,g,h,b,v,T){let E=a(u,g,h,b,v,T);h.transparent===!0?i.unshift(E):o.unshift(E)}function d(u,g){o.length>1&&o.sort(u||U1e),i.length>1&&i.sort(g||Y1e)}function p(){for(let u=t,g=e.length;u<g;u++){let h=e[u];if(h.id===null)break;h.id=null,h.object=null,h.geometry=null,h.material=null,h.group=null}}this.opaque=o,this.transparent=i,this.init=n,this.push=s,this.unshift=c,this.finish=p,this.sort=d}},bP=class{constructor(){let e=new WeakMap;function t(i,n){let a=e.get(i),s;return a===void 0?(s=new fP,e.set(i,[s])):n>=a.length?(s=new fP,a.push(s)):s=a[n],s}function o(){e=new WeakMap}this.get=t,this.dispose=o}};function U1e(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function Y1e(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}var yP=class{constructor(e){function t(){let de=!1,le=new gn,Fe=null,be=new gn(0,0,0,0);return{setMask:function(it){Fe!==it&&!de&&(e.colorMask(it,it,it,it),Fe=it)},setLocked:function(it){de=it},setClear:function(it,Ye,_r,ht,Ni){Ni===!0&&(it*=ht,Ye*=ht,_r*=ht),le.set(it,Ye,_r,ht),be.equals(le)===!1&&(e.clearColor(it,Ye,_r,ht),be.copy(le))},reset:function(){de=!1,Fe=null,be.set(-1,0,0,0)}}}function o(){let de=!1,le=null,Fe=null,be=null;return{setTest:function(it){it?$(e.DEPTH_TEST):se(e.DEPTH_TEST)},setMask:function(it){le!==it&&!de&&(e.depthMask(it),le=it)},setFunc:function(it){if(Fe!==it){switch(it){case qQ:e.depthFunc(e.NEVER);break;case HQ:e.depthFunc(e.ALWAYS);break;case WQ:e.depthFunc(e.LESS);break;case f_:e.depthFunc(e.LEQUAL);break;case jQ:e.depthFunc(e.EQUAL);break;case XQ:e.depthFunc(e.GEQUAL);break;case $Q:e.depthFunc(e.GREATER);break;case JQ:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}Fe=it}},setLocked:function(it){de=it},setClear:function(it){be!==it&&(e.clearDepth(it),be=it)},reset:function(){de=!1,le=null,Fe=null,be=null}}}function i(){let de=!1,le=null,Fe=null,be=null,it=null,Ye=null,_r=null,ht=null,Ni=null;return{setTest:function(Xr){de||(Xr?$(e.STENCIL_TEST):se(e.STENCIL_TEST))},setMask:function(Xr){le!==Xr&&!de&&(e.stencilMask(Xr),le=Xr)},setFunc:function(Xr,mo,Ze){(Fe!==Xr||be!==mo||it!==Ze)&&(e.stencilFunc(Xr,mo,Ze),Fe=Xr,be=mo,it=Ze)},setOp:function(Xr,mo,Ze){(Ye!==Xr||_r!==mo||ht!==Ze)&&(e.stencilOp(Xr,mo,Ze),Ye=Xr,_r=mo,ht=Ze)},setLocked:function(Xr){de=Xr},setClear:function(Xr){Ni!==Xr&&(e.clearStencil(Xr),Ni=Xr)},reset:function(){de=!1,le=null,Fe=null,be=null,it=null,Ye=null,_r=null,ht=null,Ni=null}}}let n=t(),a=o(),s=i(),c=new WeakMap,d=new WeakMap,p={},u={},g=new WeakMap,h=[],b=null,v=!1,T=null,E=null,I=null,_=null,C=null,D=null,P=null,F=!1,N=null,Y=null,z=null,X=null,q=null,S=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),A=!1,O=0,B=e.getParameter(e.VERSION);if(B.indexOf("WebGL")!==-1){let de=/^WebGL (\d)/.exec(B);Dt(de,"webgl version match",e),O=parseFloat(de[1]),A=O>=1}else if(B.indexOf("OpenGL ES")!==-1){let de=/^OpenGL ES (\d)/.exec(B);Dt(de,"opengl es version match",e),O=parseFloat(de[1]),A=O>=2}let V=null,K={},oe=e.getParameter(e.SCISSOR_BOX),Z=e.getParameter(e.VIEWPORT),ee=new gn().fromArray(oe),ue=new gn().fromArray(Z);function he(de,le,Fe,be){let it=new Uint8Array(4),Ye=e.createTexture();e.bindTexture(de,Ye),e.texParameteri(de,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(de,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let _r=0;_r<Fe;_r++)de===e.TEXTURE_3D||de===e.TEXTURE_2D_ARRAY?(Dt(be,"dimensions"),e.texImage3D(le,0,e.RGBA,1,1,be,0,e.RGBA,e.UNSIGNED_BYTE,it)):e.texImage2D(le+_r,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,it);return Ye}let ae={[e.TEXTURE_2D]:he(e.TEXTURE_2D,e.TEXTURE_2D,1),[e.TEXTURE_CUBE_MAP]:he(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),[e.TEXTURE_2D_ARRAY]:he(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),[e.TEXTURE_3D]:he(e.TEXTURE_3D,e.TEXTURE_3D,1,1)};n.setClear(0,0,0,1),a.setClear(1),s.setClear(0),$(e.DEPTH_TEST),a.setFunc(f_),ie(!1),te(l5),$(e.CULL_FACE),Ae(EL);function $(de){p[de]!==!0&&(e.enable(de),p[de]=!0)}function se(de){p[de]!==!1&&(e.disable(de),p[de]=!1)}function J(de,le){return u[de]!==le?(e.bindFramebuffer(de,le),u[de]=le,de===e.DRAW_FRAMEBUFFER&&(u[e.FRAMEBUFFER]=le),de===e.FRAMEBUFFER&&(u[e.DRAW_FRAMEBUFFER]=le),!0):!1}function ye(de,le){let Fe=h,be=!1;de?(Dt(le,"framebuffer",e),Fe=g.get(le),Fe===void 0&&(Fe=[],g.set(le,Fe)),Fe[0]!==e.COLOR_ATTACHMENT0&&(Fe[0]=e.COLOR_ATTACHMENT0,be=!0)):Fe[0]!==e.BACK&&(Fe[0]=e.BACK,be=!0),be&&e.drawBuffers(Fe)}function Se(de){return b!==de?(Dt(de,"program",e),e.useProgram(de),b=de,!0):!1}let Ce={[Hp]:e.FUNC_ADD,[GQ]:e.FUNC_SUBTRACT,[VQ]:e.FUNC_REVERSE_SUBTRACT,[OQ]:e.MIN,[RQ]:e.MAX},Te={[ML]:e.ZERO,[DL]:e.ONE,[FQ]:e.SRC_COLOR,[AL]:e.SRC_ALPHA,[zQ]:e.SRC_ALPHA_SATURATE,[BQ]:e.DST_COLOR,[UQ]:e.DST_ALPHA,[NQ]:e.ONE_MINUS_SRC_COLOR,[LL]:e.ONE_MINUS_SRC_ALPHA,[KQ]:e.ONE_MINUS_DST_COLOR,[YQ]:e.ONE_MINUS_DST_ALPHA};function Ae(de,le,Fe,be,it,Ye,_r,ht){if(de===EL){v===!0&&(se(e.BLEND),v=!1);return}if(v===!1&&($(e.BLEND),v=!0),de!==IL){if(de!==T||ht!==F){if((E!==Hp||C!==Hp)&&(e.blendEquation(e.FUNC_ADD),E=Hp,C=Hp),ht)switch(de){case vm:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case c5:e.blendFunc(e.ONE,e.ONE);break;case d5:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case p5:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",de);break}else switch(de){case vm:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case c5:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case d5:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case p5:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",de);break}I=null,_=null,D=null,P=null,T=de,F=ht}return}it=it||le,Ye=Ye||Fe,_r=_r||be,(le!==E||it!==C)&&(Dt(le,"blendEquation"),Dt(it,"blendEquationAlpha"),e.blendEquationSeparate(Ce[le],Ce[it]),E=le,C=it),(Fe!==I||be!==_||Ye!==D||_r!==P)&&(Dt(Fe,"blendSrc"),Dt(be,"blendDst"),Dt(Ye,"blendSrcAlpha"),Dt(_r,"blendDstAlpha"),e.blendFuncSeparate(Te[Fe],Te[be],Te[Ye],Te[_r]),I=Fe,_=be,D=Ye,P=_r),T=de,F=!1}function je(de,le){de.side===Ca?se(e.CULL_FACE):$(e.CULL_FACE);let Fe=de.side===ly;le&&(Fe=!Fe),ie(Fe),de.blending===vm&&de.transparent===!1?Ae(EL):Ae(de.blending,de.blendEquation,de.blendSrc,de.blendDst,de.blendEquationAlpha,de.blendSrcAlpha,de.blendDstAlpha,de.premultipliedAlpha),a.setFunc(de.depthFunc),a.setTest(de.depthTest),a.setMask(de.depthWrite),n.setMask(de.colorWrite);let be=de.stencilWrite;s.setTest(be),be&&(s.setMask(de.stencilWriteMask),s.setFunc(de.stencilFunc,de.stencilRef,de.stencilFuncMask),s.setOp(de.stencilFail,de.stencilZFail,de.stencilZPass)),Ie(de.polygonOffset,de.polygonOffsetFactor,de.polygonOffsetUnits),de.alphaToCoverage===!0?$(e.SAMPLE_ALPHA_TO_COVERAGE):se(e.SAMPLE_ALPHA_TO_COVERAGE)}function ie(de){N!==de&&(de?e.frontFace(e.CW):e.frontFace(e.CCW),N=de)}function te(de){de!==LQ?($(e.CULL_FACE),de!==Y&&(de===l5?e.cullFace(e.BACK):de===PQ?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):se(e.CULL_FACE),Y=de}function we(de){de!==z&&(A&&e.lineWidth(de),z=de)}function Ie(de,le,Fe){de?($(e.POLYGON_OFFSET_FILL),(X!==le||q!==Fe)&&(Dt(le,"factor"),Dt(Fe,"units"),e.polygonOffset(le,Fe),X=le,q=Fe)):se(e.POLYGON_OFFSET_FILL)}function He(de){de?$(e.SCISSOR_TEST):se(e.SCISSOR_TEST)}function ge(de){de===void 0&&(de=e.TEXTURE0+S-1),V!==de&&(e.activeTexture(de),V=de)}function nt(de,le,Fe){Fe===void 0&&(V===null?Fe=e.TEXTURE0+S-1:Fe=V);let be=K[Fe];be===void 0&&(be={type:void 0,texture:void 0},K[Fe]=be),(be.type!==de||be.texture!==le)&&(V!==Fe&&(e.activeTexture(Fe),V=Fe),e.bindTexture(de,le||ae[de]),be.type=de,be.texture=le)}function lt(){if(V===null)throw new Error("THREE.WebGLState: Trying to unbind a texture that was never bound");let de=K[V];de!==void 0&&de.type!==void 0&&(e.bindTexture(de.type,null),de.type=void 0,de.texture=void 0)}this.compressedTexImage2D=function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(le){console.error("THREE.WebGLState:",le)}},this.compressedTexImage3D=function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(le){console.error("THREE.WebGLState:",le)}},this.texSubImage2D=function(){try{e.texSubImage2D.apply(e,arguments)}catch(le){console.error("THREE.WebGLState:",le)}},this.texSubImage3D=function(){try{e.texSubImage3D.apply(e,arguments)}catch(le){console.error("THREE.WebGLState:",le)}},this.compressedTexSubImage2D=function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(le){console.error("THREE.WebGLState:",le)}},this.compressedTexSubImage3D=function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(le){console.error("THREE.WebGLState:",le)}},this.texStorage2D=function(){try{e.texStorage2D.apply(e,arguments)}catch(le){console.error("THREE.WebGLState:",le)}},this.texStorage3D=function(){try{e.texStorage3D.apply(e,arguments)}catch(le){console.error("THREE.WebGLState:",le)}},this.texImage2D=function(){try{e.texImage2D.apply(e,arguments)}catch(le){console.error("THREE.WebGLState:",le)}},this.texImage3D=function(){try{e.texImage3D.apply(e,arguments)}catch(le){console.error("THREE.WebGLState:",le)}};function Me(de){ee.equals(de)===!1&&(e.scissor(de.x,de.y,de.z,de.w),ee.copy(de))}function Nt(de){ue.equals(de)===!1&&(e.viewport(de.x,de.y,de.z,de.w),ue.copy(de))}function Tt(de,le){let Fe=d.get(le);Fe===void 0&&(Fe=new WeakMap,d.set(le,Fe));let be=Fe.get(de);be===void 0&&(be=e.getUniformBlockIndex(le,de.name),Fe.set(de,be))}function Et(de,le){let be=d.get(le).get(de);c.get(le)!==be&&(e.uniformBlockBinding(le,be,de.__bindingPointIndex),c.set(le,be))}function gr(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),p={},V=null,K={},u={},g=new WeakMap,h=[],b=null,v=!1,T=null,E=null,I=null,_=null,C=null,D=null,P=null,F=!1,N=null,Y=null,z=null,X=null,q=null,ee.set(0,0,e.canvas.width,e.canvas.height),ue.set(0,0,e.canvas.width,e.canvas.height),n.reset(),a.reset(),s.reset()}this.buffers={color:n,depth:a,stencil:s},this.enable=$,this.disable=se,this.bindFramebuffer=J,this.drawBuffers=ye,this.useProgram=Se,this.setBlending=Ae,this.setMaterial=je,this.setFlipSided=ie,this.setCullFace=te,this.setLineWidth=we,this.setPolygonOffset=Ie,this.setScissorTest=He,this.activeTexture=ge,this.bindTexture=nt,this.unbindTexture=lt,this.updateUBOMapping=Tt,this.uniformBlockBinding=Et,this.scissor=Me,this.viewport=Nt,this.reset=gr}};var my=class extends gl{constructor(t,o,i,n,a,s,c,d,p,u){if(u=u!==void 0?u:Lh,u!==Lh&&u!==wm)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&u===Lh&&(i=Id),i===void 0&&u===wm&&(i=jp);let g=new $p(t,o);super(g,n,a,s,c,d,u,i,p);this.isDepthTexture=!0;this.isDepthTexture=!0,this.image=g,this.magFilter=c!==void 0?c:Wp,this.minFilter=d!==void 0?d:Wp,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.compareFunction=t.compareFunction,this}};var xP=class{constructor(e,t,o,i,n,a,s){let c=n.maxTextures,d=n.maxTextureSize,p=n.maxSamples,u=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,g=typeof navigator=="undefined"?!1:/OculusBrowser/g.test(navigator.userAgent),h,b=new WeakMap,v=!1;try{v=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(ie){}function T(ie,te){return v?new OffscreenCanvas(ie,te):S_("canvas")}function E(ie,te){let we=1;if((ie.width>te||ie.height>te)&&(we=te/Math.max(ie.width,ie.height)),we<1)if(typeof HTMLImageElement!="undefined"&&ie instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&ie instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&ie instanceof ImageBitmap){let Ie=Math.floor(we*ie.width),He=Math.floor(we*ie.height);h===void 0&&(h=T(Ie,He)),h.width=Ie,h.height=He;let ge=h.getContext("2d");if(Dt(ge,"2d context"),!(ge instanceof OffscreenCanvasRenderingContext2D||ge instanceof CanvasRenderingContext2D))throw new Error("Expected a 2d rendering context");return ge.drawImage(ie,0,0,Ie,He),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ie.width+"x"+ie.height+") to ("+Ie+"x"+He+")."),h}else return"data"in ie&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ie.width+"x"+ie.height+")."),ie;return ie}function I(ie){return s5(ie.width)&&s5(ie.height)}function _(ie){return ie.generateMipmaps&&ie.minFilter!==Wp&&ie.minFilter!==ql}function C(ie){e.generateMipmap(ie)}function D(ie,te,we,Ie,He=!1){if(ie!==null){if(e[ie]!==void 0)return e[ie];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ie+"'")}let ge=te;return te===e.RED&&(we===e.FLOAT&&(ge=e.R32F),we===e.HALF_FLOAT&&(ge=e.R16F),we===e.UNSIGNED_BYTE&&(ge=e.R8)),te===e.RED_INTEGER&&(we===e.UNSIGNED_BYTE&&(ge=e.R8UI),we===e.UNSIGNED_SHORT&&(ge=e.R16UI),we===e.UNSIGNED_INT&&(ge=e.R32UI),we===e.BYTE&&(ge=e.R8I),we===e.SHORT&&(ge=e.R16I),we===e.INT&&(ge=e.R32I)),te===e.RG&&(we===e.FLOAT&&(ge=e.RG32F),we===e.HALF_FLOAT&&(ge=e.RG16F),we===e.UNSIGNED_BYTE&&(ge=e.RG8)),te===e.RGBA&&(we===e.FLOAT&&(ge=e.RGBA32F),we===e.HALF_FLOAT&&(ge=e.RGBA16F),we===e.UNSIGNED_BYTE&&(ge=Ie===_o&&He===!1?e.SRGB8_ALPHA8:e.RGBA8),we===e.UNSIGNED_SHORT_4_4_4_4&&(ge=e.RGBA4),we===e.UNSIGNED_SHORT_5_5_5_1&&(ge=e.RGB5_A1)),(ge===e.R16F||ge===e.R32F||ge===e.RG16F||ge===e.RG32F||ge===e.RGBA16F||ge===e.RGBA32F)&&t.get("EXT_color_buffer_float"),ge}function P(ie,te){return _(ie)===!0?Math.log2(Math.max(te.width,te.height))+1:ie.mipmaps!==void 0&&ie.mipmaps.length>0?ie.mipmaps.length:1}function F(ie){let te=ie.target;te.removeEventListener("dispose",F),Y(te)}function N(ie){let te=ie.target;te.removeEventListener("dispose",N),X(te)}function Y(ie){let te=i.get(ie);if(te.__webglInit===void 0)return;let we=ie.source,Ie=b.get(we);if(Ie){let He=Ie[te.__cacheKey];He.usedTimes--,He.usedTimes===0&&z(ie),Object.keys(Ie).length===0&&b.delete(we)}i.remove(ie)}function z(ie){let te=i.get(ie);e.deleteTexture(te.__webglTexture);let we=ie.source,Ie=b.get(we);Dt(Ie,"webglTextures"),delete Ie[te.__cacheKey],s.memory.textures--}function X(ie){let te=ie.texture,we=i.get(ie),Ie=i.get(te);Ie.__webglTexture!==void 0&&(e.deleteTexture(Ie.__webglTexture),s.memory.textures--),ie.depthTexture&&ie.depthTexture.dispose();let He=we.__webglFramebuffer;if(Array.isArray(He))for(let ge=0;ge<He.length;ge++)e.deleteFramebuffer(He[ge]);else He&&e.deleteFramebuffer(He);if(we.__webglDepthbuffer&&e.deleteRenderbuffer(we.__webglDepthbuffer),we.__webglMultisampledFramebuffer&&e.deleteFramebuffer(we.__webglMultisampledFramebuffer),we.__webglColorRenderbuffer)for(let ge=0;ge<we.__webglColorRenderbuffer.length;ge++)we.__webglColorRenderbuffer[ge]&&e.deleteRenderbuffer(we.__webglColorRenderbuffer[ge]);we.__webglDepthRenderbuffer&&e.deleteRenderbuffer(we.__webglDepthRenderbuffer),i.remove(te),i.remove(ie)}let q=0;function S(){q=0}function A(){let ie=q;return ie>=c&&console.warn("THREE.WebGLTextures: Trying to use "+ie+" texture units while this GPU supports only "+c),q+=1,ie}function O(ie){let te=[];return te.push(ie.wrapS),te.push(ie.wrapT),te.push(ie.magFilter),te.push(ie.minFilter),te.push(ie.anisotropy),te.push(ie.internalFormat),te.push(ie.format),te.push(ie.type),te.push(ie.generateMipmaps),te.push(ie.premultiplyAlpha),te.push(ie.flipY),te.push(ie.unpackAlignment),te.push(ie.colorSpace),te.join()}function B(ie,te){let we=i.get(ie);if(ie.isRenderTargetTexture===!1&&ie.version>0&&we.__version!==ie.version)if(ie.image.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ue(we,ie,te);return}o.bindTexture(e.TEXTURE_2D,we.__webglTexture,e.TEXTURE0+te)}let V={[b_]:e.REPEAT,[cy]:e.CLAMP_TO_EDGE,[y_]:e.MIRRORED_REPEAT},K={[Wp]:e.NEAREST,[ZQ]:e.NEAREST_MIPMAP_NEAREST,[h5]:e.NEAREST_MIPMAP_LINEAR,[ql]:e.LINEAR,[QQ]:e.LINEAR_MIPMAP_NEAREST,[x_]:e.LINEAR_MIPMAP_LINEAR},oe={[cee]:e.NEVER,[fee]:e.ALWAYS,[dee]:e.LESS,[uee]:e.LEQUAL,[pee]:e.EQUAL,[mee]:e.GEQUAL,[hee]:e.GREATER,[gee]:e.NOTEQUAL};function Z(ie,te){if(e.texParameteri(ie,e.TEXTURE_WRAP_S,V[te.wrapS]),e.texParameteri(ie,e.TEXTURE_WRAP_T,V[te.wrapT]),e.texParameteri(ie,e.TEXTURE_MAG_FILTER,K[te.magFilter]),e.texParameteri(ie,e.TEXTURE_MIN_FILTER,K[te.minFilter]),te.compareFunction&&(e.texParameteri(ie,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(ie,e.TEXTURE_COMPARE_FUNC,oe[te.compareFunction])),t.has("EXT_texture_filter_anisotropic")===!0){let we=t.get("EXT_texture_filter_anisotropic");if(te.magFilter===Wp||te.minFilter!==h5&&te.minFilter!==x_||te.type===Dc&&t.has("OES_texture_float_linear")===!1)return;(te.anisotropy>1||i.get(te).__currentAnisotropy)&&(e.texParameterf(ie,we.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(te.anisotropy,n.getMaxAnisotropy())),i.get(te).__currentAnisotropy=te.anisotropy)}}function ee(ie,te){let we=!1;ie.__webglInit===void 0&&(ie.__webglInit=!0,te.addEventListener("dispose",F));let Ie=te.source,He=b.get(Ie);He===void 0&&(He={},b.set(Ie,He));let ge=O(te);if(ge!==ie.__cacheKey){He[ge]===void 0&&(He[ge]={texture:e.createTexture()||void 0,usedTimes:0},s.memory.textures++,we=!0),He[ge].usedTimes++;let nt=ie.__cacheKey?He[ie.__cacheKey]:void 0;nt!==void 0&&(He[ie.__cacheKey].usedTimes--,nt.usedTimes===0&&z(te)),ie.__cacheKey=ge,ie.__webglTexture=He[ge].texture}return we}function ue(ie,te,we){let Ie=e.TEXTURE_2D,He=ee(ie,te),ge=te.source;o.bindTexture(Ie,ie.__webglTexture,e.TEXTURE0+we);let nt=i.get(ge);if(ge.version!==nt.__version||He===!0){o.activeTexture(e.TEXTURE0+we),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,te.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,te.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);let lt=E(te.image,d);lt=je(te,lt);let Me=I(lt),Nt=a.convert(te.format,te.colorSpace),Tt=a.convert(te.type),Et=D(te.internalFormat,Nt,Tt,te.colorSpace);Z(Ie,te);let gr,de=te.mipmaps,le=nt.__version===void 0||He===!0,Fe=P(te,lt);if(te instanceof my)Et=e.DEPTH_COMPONENT,te.type===Dc?Et=e.DEPTH_COMPONENT32F:te.type===Id?Et=e.DEPTH_COMPONENT24:te.type===jp?Et=e.DEPTH24_STENCIL8:Et=e.DEPTH_COMPONENT16,te.format===Lh&&Et===e.DEPTH_COMPONENT&&te.type!==fw&&te.type!==Id&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),te.type=Id,Tt=a.convert(te.type)),te.format===wm&&Et===e.DEPTH_COMPONENT&&(Et=e.DEPTH_STENCIL,te.type!==jp&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),te.type=jp,Tt=a.convert(te.type))),le&&o.texStorage2D(e.TEXTURE_2D,1,Et,lt.width,lt.height);else if(de.length>0&&Me){le&&o.texStorage2D(e.TEXTURE_2D,Fe,Et,de[0].width,de[0].height);for(let be=0,it=de.length;be<it;be++)gr=de[be],o.texSubImage2D(e.TEXTURE_2D,be,0,0,Nt,Tt,gr);te.generateMipmaps=!1}else{if(le&&o.texStorage2D(e.TEXTURE_2D,Fe,Et,lt.width,lt.height),lt instanceof $p)throw new Error("Texture does not have any image data to upload.");o.texSubImage2D(e.TEXTURE_2D,0,0,0,Nt,Tt,lt)}_(te)&&C(Ie),nt.__version=ge.version,te.onUpdate&&te.onUpdate(te)}ie.__version=te.version}function he(ie,te,we,Ie,He,ge){if(!ie||Array.isArray(ie))throw new Error("THREE.WebGLTextures: expected non-array framebuffer");let nt=a.convert(we.format,we.colorSpace),lt=a.convert(we.type),Me=D(we.internalFormat,nt,lt,we.colorSpace);if(!i.get(te).__hasExternalTextures){let Tt=Math.max(1,te.width>>ge),Et=Math.max(1,te.height>>ge);o.texImage2D(He,ge,Me,Tt,Et,0,nt,lt,null)}if(o.bindFramebuffer(e.FRAMEBUFFER,ie),Ae(te))u.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,Ie,He,i.get(we).__webglTexture,0,Te(te));else if(He===e.TEXTURE_2D||He>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&He<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z){let Tt=i.get(we).__webglTexture;Dt(Tt,"webglTexture"),e.framebufferTexture2D(e.FRAMEBUFFER,Ie,He,Tt,ge)}o.bindFramebuffer(e.FRAMEBUFFER,null)}function ae(ie,te,we){if(e.bindRenderbuffer(e.RENDERBUFFER,ie||null),te.depthBuffer&&!te.stencilBuffer){let Ie=e.DEPTH_COMPONENT16;if(we||Ae(te)){let He=te.depthTexture;He&&He.isDepthTexture&&(He.type===Dc?Ie=e.DEPTH_COMPONENT32F:He.type===Id&&(Ie=e.DEPTH_COMPONENT24));let ge=Te(te);Ae(te)?u.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,ge,Ie,te.width,te.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,ge,Ie,te.width,te.height)}else e.renderbufferStorage(e.RENDERBUFFER,Ie,te.width,te.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,ie||null)}else if(te.depthBuffer&&te.stencilBuffer){let Ie=Te(te);we&&Ae(te)===!1?e.renderbufferStorageMultisample(e.RENDERBUFFER,Ie,e.DEPTH24_STENCIL8,te.width,te.height):Ae(te)?u.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,Ie,e.DEPTH24_STENCIL8,te.width,te.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,te.width,te.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,ie||null)}else{let Ie=[te.texture];for(let He=0;He<Ie.length;He++){let ge=Ie[He],nt=a.convert(ge.format,ge.colorSpace),lt=a.convert(ge.type),Me=D(ge.internalFormat,nt,lt,ge.colorSpace),Nt=Te(te);we&&Ae(te)===!1?e.renderbufferStorageMultisample(e.RENDERBUFFER,Nt,Me,te.width,te.height):Ae(te)?u.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,Nt,Me,te.width,te.height):e.renderbufferStorage(e.RENDERBUFFER,Me,te.width,te.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function $(ie,te){if(o.bindFramebuffer(e.FRAMEBUFFER,ie),!(te.depthTexture&&te.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(te.depthTexture).__webglTexture||te.depthTexture.image.width!==te.width||te.depthTexture.image.height!==te.height)&&(te.depthTexture.image.width=te.width,te.depthTexture.image.height=te.height,te.depthTexture.needsUpdate=!0),B(te.depthTexture,0);let we=i.get(te.depthTexture).__webglTexture;Dt(we,"webglDepthTexture");let Ie=Te(te);if(te.depthTexture.format===Lh)Ae(te)?u.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,we,0,Ie):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,we,0);else if(te.depthTexture.format===wm)Ae(te)?u.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,we,0,Ie):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,we,0);else throw new Error("Unknown depthTexture format")}function se(ie){let te=i.get(ie),we=tY(te);ie.depthTexture&&!te.__autoAllocateDepthBuffer?$(we,ie):(o.bindFramebuffer(e.FRAMEBUFFER,we),te.__webglDepthbuffer=e.createRenderbuffer()||void 0,ae(te.__webglDepthbuffer,ie,!1)),o.bindFramebuffer(e.FRAMEBUFFER,null)}function J(ie,te,we){let Ie=i.get(ie),He=tY(Ie);te!==void 0&&he(He,ie,ie.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),we!==void 0&&se(ie)}function ye(ie){let te=ie.texture,we=i.get(ie),Ie=i.get(te);if(ie.addEventListener("dispose",N),Ie.__webglTexture===void 0&&(Ie.__webglTexture=e.createTexture()||void 0),Ie.__version=te.version,s.memory.textures++,te.mipmaps&&te.mipmaps.length>0){let ge=[];we.__webglFramebuffer=ge;for(let nt=0;nt<te.mipmaps.length;nt++){let lt=e.createFramebuffer();Dt(lt,"framebuffer",e),ge[nt]=lt}}else{let ge=e.createFramebuffer();we.__webglFramebuffer=ge||void 0}if(ie.samples>0&&Ae(ie)===!1){let ge=[te],nt=e.createFramebuffer();Dt(nt,"framebuffer",e),we.__webglMultisampledFramebuffer=nt,we.__webglColorRenderbuffer=[],o.bindFramebuffer(e.FRAMEBUFFER,we.__webglMultisampledFramebuffer);for(let lt=0;lt<ge.length;lt++){let Me=ge[lt],Nt=e.createRenderbuffer();Dt(Nt,"renderbuffer",e),we.__webglColorRenderbuffer[lt]=Nt,e.bindRenderbuffer(e.RENDERBUFFER,we.__webglColorRenderbuffer[lt]);let Tt=a.convert(Me.format,Me.colorSpace),Et=a.convert(Me.type),gr=D(Me.internalFormat,Tt,Et,Me.colorSpace,!1),de=Te(ie);e.renderbufferStorageMultisample(e.RENDERBUFFER,de,gr,ie.width,ie.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+lt,e.RENDERBUFFER,we.__webglColorRenderbuffer[lt])}if(e.bindRenderbuffer(e.RENDERBUFFER,null),ie.depthBuffer){let lt=e.createRenderbuffer();Dt(lt,"renderbuffer",e),we.__webglDepthRenderbuffer=lt,ae(we.__webglDepthRenderbuffer,ie,!0)}o.bindFramebuffer(e.FRAMEBUFFER,null)}let He=e.TEXTURE_2D;if(o.bindTexture(He,Ie.__webglTexture),Z(He,te),te.mipmaps&&te.mipmaps.length>0){let ge=B1e(we);for(let nt=0;nt<te.mipmaps.length;nt++)he(ge[nt],ie,te,e.COLOR_ATTACHMENT0,He,nt)}else he(we.__webglFramebuffer,ie,te,e.COLOR_ATTACHMENT0,He,0);_(te)&&C(He),o.unbindTexture(),ie.depthBuffer&&se(ie)}function Se(ie){let te=[ie.texture];for(let we=0,Ie=te.length;we<Ie;we++){let He=te[we];if(_(He)){let ge=e.TEXTURE_2D,nt=i.get(He).__webglTexture;o.bindTexture(ge,nt),C(ge),o.unbindTexture()}}}function Ce(ie){if(ie.samples>0&&Ae(ie)===!1){let te=[ie.texture],we=ie.width,Ie=ie.height,He=e.COLOR_BUFFER_BIT,ge=[],nt=ie.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,lt=i.get(ie);Dt(lt.__webglMultisampledFramebuffer,"__webglMultisampledFramebuffer"),o.bindFramebuffer(e.READ_FRAMEBUFFER,lt.__webglMultisampledFramebuffer),o.bindFramebuffer(e.DRAW_FRAMEBUFFER,tY(lt));for(let Me=0;Me<te.length;Me++){ge.push(e.COLOR_ATTACHMENT0+Me),ie.depthBuffer&&ge.push(nt);let Nt=lt.__ignoreDepthValues!==void 0?lt.__ignoreDepthValues:!1;Nt===!1&&(ie.depthBuffer&&(He|=e.DEPTH_BUFFER_BIT),ie.stencilBuffer&&(He|=e.STENCIL_BUFFER_BIT)),Nt===!0&&(e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[nt]),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[nt])),e.blitFramebuffer(0,0,we,Ie,0,0,we,Ie,He,e.NEAREST),g&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,ge)}o.bindFramebuffer(e.READ_FRAMEBUFFER,null),o.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),o.bindFramebuffer(e.DRAW_FRAMEBUFFER,lt.__webglMultisampledFramebuffer)}}function Te(ie){return Math.min(p,ie.samples)}function Ae(ie){let te=i.get(ie);return ie.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&te.__useRenderToTexture!==!1}function je(ie,te){let we=ie.colorSpace,Ie=ie.format,He=ie.type;return ie.format===zL||we!==Qa&&we!==yw&&(we===_o?(Ie!==Xp||He!==Gn)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",we)),te}this.allocateTextureUnit=A,this.resetTextureUnits=S,this.setTexture2D=B,this.rebindTextures=J,this.setupRenderTarget=ye,this.updateRenderTargetMipmap=Se,this.updateMultisampleRenderTarget=Ce,this.useMultisampledRTT=Ae}};function tY(r){let e=r.__webglFramebuffer;if(!e||Array.isArray(e))throw new Error("THREE.WebGLTextures: expected non-array framebuffer");return e}function B1e(r){let e=r.__webglFramebuffer;if(!e||!Array.isArray(e))throw new Error("THREE.WebGLTextures: expected array framebuffer");return e}var vP=class{constructor(e,t,o){let i={},n={},a=[],s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function c(I,_){let C=_.program;Dt(C,"webglProgram"),o.uniformBlockBinding(I,C)}function d(I,_){let C=i[I.id];C===void 0&&(b(I),C=p(I),i[I.id]=C,I.addEventListener("dispose",T));let D=_.program;Dt(D,"webglProgram"),o.updateUBOMapping(I,D);let P=t.render.frame;n[I.id]!==P&&(g(I),n[I.id]=P)}function p(I){let _=u();I.__bindingPointIndex=_;let C=e.createBuffer(),D=I.__size,P=I.usage;return e.bindBuffer(e.UNIFORM_BUFFER,C),e.bufferData(e.UNIFORM_BUFFER,D,P),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,_,C),C}function u(){for(let I=0;I<s;I++)if(a.indexOf(I)===-1)return a.push(I),I;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function g(I){let _=i[I.id],C=I.uniforms,D=I.__cache;if(_===void 0)throw new Error("THREE.WebGLUniformsGroups: buffer is undefined");e.bindBuffer(e.UNIFORM_BUFFER,_);for(let P=0,F=C.length;P<F;P++){let N=C[P];if(h(N,P,D)===!0){let Y=N.__offset,z=Array.isArray(N.value)?N.value:[N.value],X=0;for(let q=0;q<z.length;q++){let S=z[q],A=v(S);typeof S=="number"?(N.__data[0]=S,e.bufferSubData(e.UNIFORM_BUFFER,Y+X,N.__data)):S instanceof Co?(N.__data[0]=S.elements[0],N.__data[1]=S.elements[1],N.__data[2]=S.elements[2],N.__data[3]=S.elements[0],N.__data[4]=S.elements[3],N.__data[5]=S.elements[4],N.__data[6]=S.elements[5],N.__data[7]=S.elements[0],N.__data[8]=S.elements[6],N.__data[9]=S.elements[7],N.__data[10]=S.elements[8],N.__data[11]=S.elements[0]):(S.toArray(N.__data,X),X+=A.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,Y,N.__data)}}e.bindBuffer(e.UNIFORM_BUFFER,null)}function h(I,_,C){let D=I.value;if(C[_]===void 0){if(typeof D=="number")C[_]=D;else{let P=Array.isArray(D)?D:[D],F=[];for(let N=0;N<P.length;N++){let Y=P[N];F.push(typeof Y=="number"?Y:Y.clone())}C[_]=F}return!0}else if(typeof D=="number"){if(C[_]!==D)return C[_]=D,!0}else{let P=C[_],F=Array.isArray(P)?P:[P],N=Array.isArray(D)?D:[D];for(let Y=0;Y<F.length;Y++){let z=F[Y];if(z.equals(N[Y])===!1)return z.copy(N[Y]),!0}}return!1}function b(I){let _=I.uniforms,C=0,D=16,P=0;for(let F=0,N=_.length;F<N;F++){let Y=_[F],z={boundary:0,storage:0},X=Array.isArray(Y.value)?Y.value:[Y.value];for(let q=0,S=X.length;q<S;q++){let A=X[q],O=v(A);z.boundary+=O.boundary,z.storage+=O.storage}if(Y.__data=new Float32Array(z.storage/Float32Array.BYTES_PER_ELEMENT),Y.__offset=C,F>0){P=C%D;let q=D-P;P!==0&&q-z.boundary<0&&(C+=D-P,Y.__offset=C)}C+=z.storage}P=C%D,P>0&&(C+=D-P),I.__size=C,I.__cache={}}function v(I){let _={boundary:0,storage:0};return typeof I=="number"?(_.boundary=4,_.storage=4):I instanceof Ft?(_.boundary=8,_.storage=8):I instanceof Ee||I instanceof At?(_.boundary=16,_.storage=12):I instanceof gn?(_.boundary=16,_.storage=16):I instanceof Co?(_.boundary=48,_.storage=48):I instanceof $t?(_.boundary=64,_.storage=64):I instanceof gl?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",I),_}function T(I){let _=I.target;_.removeEventListener("dispose",T);let C=a.indexOf(_.__bindingPointIndex);a.splice(C,1);let D=i[_.id];D!==void 0&&e.deleteBuffer(D),delete i[_.id],delete n[_.id]}function E(){for(let I in i){let _=i[I];_!==void 0&&e.deleteBuffer(_)}a=[],i={},n={}}this.bind=c,this.update=d,this.dispose=E}};var E_=class{constructor(e,t){function o(i,n=yw){let a;if(i===Gn)return e.UNSIGNED_BYTE;if(i===GL)return e.UNSIGNED_SHORT_4_4_4_4;if(i===VL)return e.UNSIGNED_SHORT_5_5_5_1;if(i===eee)return e.BYTE;if(i===tee)return e.SHORT;if(i===fw)return e.UNSIGNED_SHORT;if(i===PL)return e.INT;if(i===Id)return e.UNSIGNED_INT;if(i===Dc)return e.FLOAT;if(i===bw)return e.HALF_FLOAT;if(i===ree)return e.ALPHA;if(i===Xp)return e.RGBA;if(i===oee)return e.LUMINANCE;if(i===iee)return e.LUMINANCE_ALPHA;if(i===Lh)return e.DEPTH_COMPONENT;if(i===wm)return e.DEPTH_STENCIL;if(i===zL)return a=t.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(i===nee)return e.RED;if(i===OL)return e.RED_INTEGER;if(i===aee)return e.RG;if(i===RL)return e.RG_INTEGER;if(i===FL)return e.RGBA_INTEGER;if(i===NL||i===UL||i===YL||i===BL)if(n===_o)if(a=t.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(i===NL)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===UL)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===YL)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===BL)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=t.get("WEBGL_compressed_texture_s3tc"),a!==null){if(i===NL)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===UL)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===YL)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===BL)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===g5||i===m5||i===f5||i===b5)if(a=t.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(i===g5)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===m5)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===f5)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===b5)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===see)return a=t.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(i===y5||i===x5)if(a=t.get("WEBGL_compressed_texture_etc"),a!==null){if(i===y5)return n===_o?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(i===x5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===v5||i===w5||i===S5||i===k5||i===_5||i===C5||i===T5||i===E5||i===I5||i===M5||i===D5||i===A5||i===L5||i===P5)if(a=t.get("WEBGL_compressed_texture_astc"),a!==null){if(i===v5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===w5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===S5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===k5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===_5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===C5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===T5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===E5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===I5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===M5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===D5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===A5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===L5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===P5)return n===_o?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===G5)if(a=t.get("EXT_texture_compression_bptc"),a!==null){if(i===G5)return n===_o?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(i===V5||i===O5||i===R5||i===F5)if(a=t.get("EXT_texture_compression_rgtc"),a!==null){if(i===V5)return a.COMPRESSED_RED_RGTC1_EXT;if(i===O5)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===R5)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===F5)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===jp?e.UNSIGNED_INT_24_8:e[i]!==void 0?e[i]:null}this.convert=o}};var Rh=class extends si{constructor(){super();this.isScene=!0;this.isScene=!0,this.type="Scene",this.background=null,this.overrideMaterial=null}};var wP=class{constructor(e){let t=new WeakMap;function o(c,d){let p=c.array,u=c.usage,g=e.createBuffer();e.bindBuffer(d,g),e.bufferData(d,p,u),c.onUploadCallback();let h;if(p instanceof Float32Array)h=e.FLOAT;else if(p instanceof Uint16Array)h=e.UNSIGNED_SHORT;else if(p instanceof Int16Array)h=e.SHORT;else if(p instanceof Uint32Array)h=e.UNSIGNED_INT;else if(p instanceof Int32Array)h=e.INT;else if(p instanceof Int8Array)h=e.BYTE;else if(p instanceof Uint8Array)h=e.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:g,type:h,bytesPerElement:p.BYTES_PER_ELEMENT,version:c.version}}function i(c,d,p){let u=d.array,g=d.updateRange;e.bindBuffer(p,c),g.count===-1?e.bufferSubData(p,0,u):(e.bufferSubData(p,g.offset*u.BYTES_PER_ELEMENT,u,g.offset,g.count),g.count=-1),d.onUploadCallback()}function n(c){return t.get(c)}function a(c){let d=t.get(c);d&&(e.deleteBuffer(d.buffer),t.delete(c))}function s(c,d){let p=t.get(c);p===void 0?t.set(c,o(c,d)):p.version<c.version&&(i(p.buffer,c,d),p.version=c.version)}this.get=n,this.remove=a,this.update=s}};var SP=new At(0),kP=class{constructor(e,t,o,i,n){let a=new At(0),s=i===!0?0:1;function c(p,u){let g=!1,h=u.isScene===!0?u.background:null;h===null?d(a,s):h&&h.isColor&&(d(h,1),g=!0),(e.autoClear||g)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)}function d(p,u){p.getRGB(SP,Iee(e)),t.buffers.color.setClear(SP.r,SP.g,SP.b,u,n)}this.getClearColor=function(){return a},this.setClearColor=function(p,u=1){a.copy(p),s=u,d(a,s)},this.getClearAlpha=function(){return s},this.setClearAlpha=function(p){s=p,d(a,s)},this.render=c}};var _P=class{constructor(e,t){let o=e.getParameter(e.MAX_VERTEX_ATTRIBS),i=!0,n={},a=b(null),s=a,c=!1;function d(q,S,A,O,B){let V=!1;if(i){let K=h(O,A,S);s!==K&&(s=K,u(s.object)),V=v(q,O,A,B),V&&T(q,O,A,B)}else{let K=S.wireframe===!0;(s.geometry!==O.id||s.program!==A.id||s.wireframe!==K)&&(s.geometry=O.id,s.program=A.id,s.wireframe=K,V=!0)}if(B!==null&&t.update(B,e.ELEMENT_ARRAY_BUFFER),(V||c)&&(c=!1,P(q,S,A,O),B!==null)){let K=t.get(B);Dt(K,"indexAttributes"),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,K.buffer)}}function p(){return e.createVertexArray()}function u(q){e.bindVertexArray(q)}function g(q){return e.deleteVertexArray(q)}function h(q,S,A){let O=A.wireframe===!0?"true":"false",B=n[q.id];B===void 0&&(B={},n[q.id]=B);let V=B[S.id];V===void 0&&(V={},B[S.id]=V);let K=V[O];return K===void 0&&(K=b(p()),V[O]=K),K}function b(q){let S=[],A=[],O=[];for(let B=0;B<o;B++)S[B]=0,A[B]=0,O[B]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:S,enabledAttributes:A,attributeDivisors:O,object:q,attributes:{},index:null}}function v(q,S,A,O){let B=s.attributes,V=S.attributes,K=0,oe=A.getAttributes();for(let Z in oe)if(oe[Z].location>=0){let ue=B[Z],he=V[Z];if(he===void 0&&q instanceof vi&&(Z==="instanceMatrix"&&q.instanceMatrix&&(he=q.instanceMatrix),Z==="instanceColor"&&q.instanceColor&&(he=q.instanceColor),Z==="instancePickingColor"&&q.instancePickingColor&&(he=q.instancePickingColor)),ue===void 0||ue.attribute!==he||he&&ue.data!==he.data)return!0;K++}return s.attributesNum!==K||s.index!==O}function T(q,S,A,O){let B={},V=S.attributes,K=0,oe=A.getAttributes();for(let Z in oe)if(oe[Z].location>=0){let ue=V[Z];ue===void 0&&q instanceof vi&&(Z==="instanceMatrix"&&q.instanceMatrix&&(ue=q.instanceMatrix),Z==="instanceColor"&&q.instanceColor&&(ue=q.instanceColor),Z==="instancePickingColor"&&q.instancePickingColor&&(ue=q.instancePickingColor));let he={attribute:ue};ue&&"data"in ue&&ue.data&&(he.data=ue.data),B[Z]=he,K++}s.attributes=B,s.attributesNum=K,s.index=O}function E(){let q=s.newAttributes;for(let S=0,A=q.length;S<A;S++)q[S]=0}function I(q){_(q,0)}function _(q,S){let A=s.newAttributes,O=s.enabledAttributes,B=s.attributeDivisors;A[q]=1,O[q]===0&&(e.enableVertexAttribArray(q),O[q]=1),B[q]!==S&&(e.vertexAttribDivisor(q,S),B[q]=S)}function C(){let q=s.newAttributes,S=s.enabledAttributes;for(let A=0,O=S.length;A<O;A++)S[A]!==q[A]&&(e.disableVertexAttribArray(A),S[A]=0)}function D(q,S,A,O,B,V,K){K===!0?e.vertexAttribIPointer(q,S,A,B,V):e.vertexAttribPointer(q,S,A,O,B,V)}function P(q,S,A,O){E();let B=O.attributes,V=A.getAttributes(),K=S.defaultAttributeValues;for(let oe in V){let Z=V[oe];if(Z.location>=0){let ee=B[oe];if(ee===void 0&&q instanceof vi&&(oe==="instanceMatrix"&&q.instanceMatrix&&(ee=q.instanceMatrix),oe==="instanceColor"&&q.instanceColor&&(ee=q.instanceColor),oe==="instancePickingColor"&&q.instancePickingColor&&(ee=q.instancePickingColor)),ee!==void 0){let ue=ee.normalized,he=ee.itemSize,ae=t.get(ee);if(ae===void 0)continue;let $=ae.buffer,se=ae.type,J=ae.bytesPerElement,ye=se===e.INT||se===e.UNSIGNED_INT||ee.gpuType===PL;if(ee instanceof Am){for(let Se=0;Se<Z.locationSize;Se++)_(Z.location+Se,ee.meshPerAttribute);!(q instanceof vi)&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=ee.meshPerAttribute*ee.count)}else for(let Se=0;Se<Z.locationSize;Se++)I(Z.location+Se);e.bindBuffer(e.ARRAY_BUFFER,$);for(let Se=0;Se<Z.locationSize;Se++)D(Z.location+Se,he/Z.locationSize,se,ue,he*J,he/Z.locationSize*Se*J,ye)}else if(K!==void 0){let ue=K[oe];if(ue!==void 0)switch(ue.length){case 2:e.vertexAttrib2fv(Z.location,ue);break;case 3:e.vertexAttrib3fv(Z.location,ue);break;case 4:e.vertexAttrib4fv(Z.location,ue);break;default:e.vertexAttrib1fv(Z.location,ue)}}}}C()}function F(){z();for(let q in n){let S=n[q];for(let A in S){let O=S[A];for(let B in O){let V=O[B];Dt(V,"state"),g(V.object),delete O[B]}delete S[A]}delete n[q]}}function N(q){if(n[q.id]===void 0)return;let S=n[q.id];for(let A in S){let O=S[A];for(let B in O){let V=O[B];Dt(V,"state"),g(V.object),delete O[B]}delete S[A]}delete n[q.id]}function Y(q){for(let S in n){let A=n[S];if(Dt(A,"programMap"),A[q.id]===void 0)continue;let O=A[q.id];for(let B in O){let V=O[B];Dt(V,"state"),g(V.object),delete O[B]}delete A[q.id]}}function z(){X(),c=!0,s!==a&&(s=a,u(s.object))}function X(){a.geometry=null,a.program=null,a.wireframe=!1}this.setup=d,this.reset=z,this.resetDefaultState=X,this.dispose=F,this.releaseStatesOfGeometry=N,this.releaseStatesOfProgram=Y,this.initAttributes=E,this.enableAttribute=I,this.disableUnusedAttributes=C}};var CP=class{constructor(){let e=new cP,t=[];function o(){t.length=0}function i(s){t.push(s)}function n(){e.setup(t)}function a(s){e.setupView(t,s)}this.state={lightsArray:t,lights:e},this.init=o,this.pushLight=i,this.setupLights=n,this.setupLightsView=a}},TP=class{constructor(){let e=new WeakMap;this.get=function(o,i=0){let n=e.get(o),a;return n===void 0?(a=new CP,e.set(o,[a])):i>=n.length?(a=new CP,n.push(a)):a=n[i],a},this.dispose=function(){e=new WeakMap}}};function rte(r){return r instanceof gn}function ote(r){return r.isLight}function K1e(r){return r.isScene}function EP(r){return r.isMesh}function rY(r){return r.isLine}function z1e(r){return r.isLineSegments}function q1e(){let r=S_("canvas");return r.style.display="block",r}var Mw=class{constructor(e={}){let{canvas:t=q1e(),context:o=null,depth:i=!0,stencil:n=!0,alpha:a=!1,antialias:s=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:d=!1,powerPreference:p="default",failIfMajorPerformanceCaveat:u=!1}=e;this.isWebGLRenderer=!0;let g;o!==null?g=o.getContextAttributes().alpha:g=a;let h=new Uint32Array(4),b=new Int32Array(4),v=null,T=null,E=[],I=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.outputColorSpace=_o;let _=this,C=!1,D=0,P=0,F=null,N=-1,Y=null,z=new gn,X=new gn,q=null,S=t.width,A=t.height,O=1,B=null,V=null,K=new gn(0,0,S,A),oe=new gn(0,0,S,A),Z=!1,ee=new eP,ue=new $t,he=new Ee,ae=new Rh;function $(){return F===null?O:1}let se={alpha:!0,depth:i,stencil:n,antialias:s,premultipliedAlpha:c,preserveDrawingBuffer:d,powerPreference:p,failIfMajorPerformanceCaveat:u};"setAttribute"in t&&t.setAttribute("data-engine",`three.js r${AQ}`),t.addEventListener("webglcontextlost",de,!1),t.addEventListener("webglcontextrestored",le,!1),t.addEventListener("webglcontextcreationerror",Fe,!1);let J=(()=>{let ce=o||t.getContext("webgl2",se);if(ce===null)throw new Error("THREE.WebGLRenderer: Error creating WebGL context with your selected attributes.");return ce})(),ye,Se,Ce,Te,Ae,je,ie,te,we,Ie,He,ge,nt,lt,Me,Nt,Tt,Et;function gr(){Dt(J,"gl context"),ye=new nP(J),Se=new iP(J,ye,e),ye.init(),Nt=new E_(J,ye),Ce=new yP(J),Te=new lP(J),Ae=new mP,je=new xP(J,ye,Ce,Ae,Se,Nt,Te),ie=new wP(J),Tt=new _P(J,ie),te=new aP(J,ie,Te,Tt),we=new dP(J,te,ie,Te),Ie=new gP(_,Se,Tt),He=new bP,ge=new TP,nt=new kP(_,Ce,we,g,c),Et=new vP(J,Te,Ce),lt=new oP(J,Te),Me=new sP(J,Te),Te.programs=Ie.programs,_.capabilities=Se,_.extensions=ye,_.properties=Ae,_.renderLists=He,_.state=Ce,_.info=Te}gr(),this.getContext=function(){return J},this.getContextAttributes=function(){return J.getContextAttributes()},this.forceContextLoss=function(){let ce=ye.get("WEBGL_lose_context");ce&&ce.loseContext()},this.forceContextRestore=function(){let ce=ye.get("WEBGL_lose_context");ce&&ce.restoreContext()},this.getPixelRatio=function(){return O},this.setPixelRatio=function(ce){ce!==void 0&&(O=ce,this.setSize(S,A,!1))},this.getSize=function(ce){return ce.set(S,A)},this.setSize=function(ce,ve,We=!0){S=ce,A=ve,t.width=Math.floor(ce*O),t.height=Math.floor(ve*O),We===!0&&(t.style.width=ce+"px",t.style.height=ve+"px"),this.setViewport(0,0,ce,ve)},this.getDrawingBufferSize=function(ce){return ce.set(S*O,A*O).floor()},this.setDrawingBufferSize=function(ce,ve,We){S=ce,A=ve,O=We,t.width=Math.floor(ce*We),t.height=Math.floor(ve*We),this.setViewport(0,0,ce,ve)},this.getCurrentViewport=function(ce){return ce.copy(z)},this.getViewport=function(ce){return ce.copy(K)},this.setViewport=function(ce,ve,We,De){rte(ce)?K.set(ce.x,ce.y,ce.z,ce.w):K.set(ce,ve,We,De),Ce.viewport(z.copy(K).multiplyScalar(O).floor())},this.getScissor=function(ce){return ce.copy(oe)},this.setScissor=function(ce,ve,We,De){rte(ce)?oe.set(ce.x,ce.y,ce.z,ce.w):oe.set(ce,ve,We,De),Ce.scissor(X.copy(oe).multiplyScalar(O).floor())},this.getScissorTest=function(){return Z},this.setScissorTest=function(ce){Ce.setScissorTest(Z=ce)},this.setOpaqueSort=function(ce){B=ce},this.setTransparentSort=function(ce){V=ce},this.getClearColor=function(ce){return ce.copy(nt.getClearColor())},this.setClearColor=function(...ce){nt.setClearColor.apply(nt,ce)},this.getClearAlpha=function(){return nt.getClearAlpha()},this.setClearAlpha=function(...ce){nt.setClearAlpha.apply(nt,ce)},this.clear=function(ce=!0,ve=!0,We=!0){let De=0;if(ce){let mt=!1;if(F!==null){let gt=F.texture.format;mt=gt===FL||gt===RL||gt===OL}if(mt){Dt(F,"render target");let gt=F.texture.type,Vt=gt===Gn||gt===Id||gt===fw||gt===jp||gt===GL||gt===VL,ir=nt.getClearColor(),Yt=nt.getClearAlpha(),Ht=ir.r,Lt=ir.g,ur=ir.b;Vt?(h[0]=Ht,h[1]=Lt,h[2]=ur,h[3]=Yt,J.clearBufferuiv(J.COLOR,0,h)):(b[0]=Ht,b[1]=Lt,b[2]=ur,b[3]=Yt,J.clearBufferiv(J.COLOR,0,b))}else De|=J.COLOR_BUFFER_BIT}ve&&(De|=J.DEPTH_BUFFER_BIT),We&&(De|=J.STENCIL_BUFFER_BIT),J.clear(De)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",de,!1),t.removeEventListener("webglcontextrestored",le,!1),t.removeEventListener("webglcontextcreationerror",Fe,!1),He.dispose(),ge.dispose(),Ae.dispose(),we.dispose(),Tt.dispose(),Et.dispose(),Ie.dispose()};function de(ce){ce.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),C=!0}function le(){console.log("THREE.WebGLRenderer: Context Restored."),C=!1;let ce=Te.autoReset;gr(),Te.autoReset=ce}function Fe(ce){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ce.statusMessage)}function be(ce){let ve=ce.target;ve.removeEventListener("dispose",be),it(ve)}function it(ce){Ye(ce),Ae.remove(ce)}function Ye(ce){let ve=Ae.get(ce).programs;ve!==void 0&&(ve.forEach(We=>{Ie.releaseProgram(We)}),Ie.releaseShaderCache(ce))}this.renderBufferDirect=function(ce,ve,We,De,mt,gt){ve===null&&(ve=ae);let Vt=!!EP(mt)&&mt.matrixWorld.determinant()<0,ir=pt(ce,ve,De,mt);Ce.setMaterial(De,Vt);let Yt=We.index,Ht=1;if(De.wireframe===!0){if(Yt=te.getWireframeAttribute(We),Yt===void 0)return;Ht=2}let Lt=We.attributes.position,ur=0,qt=1/0*Ht;gt!==null&&(ur=Math.max(ur,gt.start*Ht),qt=Math.min(qt,(gt.start+gt.count)*Ht)),Yt!==null?(ur=Math.max(ur,0),qt=Math.min(qt,Yt.count)):Lt!=null&&(ur=Math.max(ur,0),qt=Math.min(qt,Lt.count));let Mo=qt-ur;if(Mo<0||Mo===1/0)return;Dt(ir,"program"),Tt.setup(mt,De,ir,We,Yt);let Ci,wn=lt;if(Yt!==null&&(Ci=ie.get(Yt),wn=Me,Dt(Ci,"attribute"),Me.setIndex(Ci)),EP(mt)?De.wireframe===!0?(Ce.setLineWidth($()),wn.setMode(J.LINES)):wn.setMode(J.TRIANGLES):rY(mt)&&(Ce.setLineWidth($()),z1e(mt)?wn.setMode(J.LINES):wn.setMode(J.LINE_STRIP)),mt instanceof vi)wn.renderInstances(ur,Mo,mt.count);else if(We instanceof Ew){let di=We._maxInstanceCount!==void 0?We._maxInstanceCount:1/0,$r=Math.min(We.instanceCount,di);wn.renderInstances(ur,Mo,$r)}else wn.render(ur,Mo)},this.compile=function(ce,ve){function We(De,mt,gt){De.transparent===!0&&De.side===Ca&&De.forceSinglePass===!1?(De.side=ly,De.needsUpdate=!0,mo(De,mt,gt),De.side=m_,De.needsUpdate=!0,mo(De,mt,gt),De.side=Ca):mo(De,mt,gt)}T=ge.get(ce),T.init(),I.push(T),ce.traverseVisible(De=>{Dt(T,"render state"),ote(De)&&De.layers.test(ve.layers)&&T.pushLight(De)}),T.setupLights(),ce.traverse(De=>{let mt=De.material;if(mt){if(!EP(De)&&!rY(De))throw new Error(`THREE.WebGLRenderer: Object of type ${De.type} has material but no geometry.`);if(Array.isArray(mt))for(let gt=0;gt<mt.length;gt++){let Vt=mt[gt];We(Vt,ce,De)}else We(mt,ce,De)}}),I.pop(),T=null},this.render=function(ce,ve){if(ve!==void 0&&ve.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}C!==!0&&(ce.matrixWorldAutoUpdate===!0&&ce.updateMatrixWorld(),ve.parent===null&&ve.matrixWorldAutoUpdate===!0&&ve.updateMatrixWorld(),T=ge.get(ce,I.length),T.init(),I.push(T),ue.multiplyMatrices(ve.projectionMatrix,ve.matrixWorldInverse),ee.setFromProjectionMatrix(ue),v=He.get(ce,E.length),v.init(),E.push(v),_r(ce,ve,0,_.sortObjects),v.finish(),_.sortObjects===!0&&v.sort(B,V),this.info.render.frame++,this.info.autoReset===!0&&this.info.reset(),nt.render(v,ce),T.setupLights(),ht(v,ce,ve),F!==null&&(je.updateMultisampleRenderTarget(F),je.updateRenderTargetMipmap(F)),Tt.resetDefaultState(),N=-1,Y=null,I.pop(),I.length>0?T=I[I.length-1]:T=null,E.pop(),E.length>0?v=E[E.length-1]:v=null)};function _r(ce,ve,We,De){if(ce.visible===!1)return;if(ce.layers.test(ve.layers)){if(Dt(T,"render state"),ce.isGroup)We=ce.renderOrder;else if(ote(ce))T.pushLight(ce);else if((EP(ce)||rY(ce))&&(Dt(v,"render list"),!ce.frustumCulled||ee.intersectsObject(ce))){let Vt=we.update(ce),ir=ce.material;if(Dt(ir,"material"),De&&(Vt.boundingSphere===null&&Vt.computeBoundingSphere(),he.copy(Vt.boundingSphere.center),he.applyMatrix4(ce.matrixWorld).applyMatrix4(ue)),Array.isArray(ir)){let Yt=Vt.groups;for(let Ht=0,Lt=Yt.length;Ht<Lt;Ht++){let ur=Yt[Ht],qt=ur.materialIndex&&ir[ur.materialIndex];qt&&qt.visible&&v.push(ce,Vt,qt,We,he.z,ur)}}else ir.visible&&v.push(ce,Vt,ir,We,he.z,null)}}let gt=ce.children;for(let Vt=0,ir=gt.length;Vt<ir;Vt++)_r(gt[Vt],ve,We,De)}function ht(ce,ve,We,De){let mt=ce.opaque,gt=ce.transparent;Dt(T,"render state"),T.setupLightsView(We),De&&Ce.viewport(z.copy(De)),mt.length>0&&Ni(mt,ve,We),gt.length>0&&Ni(gt,ve,We),Ce.buffers.depth.setTest(!0),Ce.buffers.depth.setMask(!0),Ce.buffers.color.setMask(!0),Ce.setPolygonOffset(!1)}function Ni(ce,ve,We){let De=K1e(ve)?ve.overrideMaterial:null;for(let mt=0,gt=ce.length;mt<gt;mt++){let Vt=ce[mt],ir=Vt.object,Yt=Vt.geometry,Ht=De===null?Vt.material:De,Lt=Vt.group;ir.layers.test(We.layers)&&Xr(ir,ve,We,Yt,Ht,Lt)}}function Xr(ce,ve,We,De,mt,gt){ce.modelViewMatrix.multiplyMatrices(We.matrixWorldInverse,ce.matrixWorld),ce.normalMatrix.getNormalMatrix(ce.modelViewMatrix),mt.transparent===!0&&mt.side===Ca&&mt.forceSinglePass===!1?(mt.side=ly,mt.needsUpdate=!0,_.renderBufferDirect(We,ve,De,mt,ce,gt),mt.side=m_,mt.needsUpdate=!0,_.renderBufferDirect(We,ve,De,mt,ce,gt),mt.side=Ca):_.renderBufferDirect(We,ve,De,mt,ce,gt)}function mo(ce,ve,We){ve.isScene!==!0&&(ve=ae);let De=Ae.get(ce);Dt(T,"render state");let mt=T.state.lights,gt=mt.state.version,Vt=Ie.getParameters(ce,mt.state,ve,We),ir=Ie.getProgramCacheKey(Vt),Yt=De.programs;Yt===void 0&&(ce.addEventListener("dispose",be),Yt=new Map,De.programs=Yt);let Ht=Yt.get(ir);if(Ht!==void 0){if(De.currentProgram===Ht&&De.lightsStateVersion===gt)return Ze(ce,Vt),Ht}else Vt.uniforms=Ie.getUniforms(ce),Ht=Ie.acquireProgram(Vt,ir),Yt.set(ir,Ht),De.uniforms=Vt.uniforms;let Lt=De.uniforms;Dt(Lt,"uniforms"),Ze(ce,Vt),De.needsLights=ke(ce),De.lightsStateVersion=gt,De.needsLights&&(Lt.ambientLightColor.value=mt.state.ambient,Lt.directionalLights.value=mt.state.directional);let ur=Ht.getUniforms(),qt=Lm.seqWithValue(ur.seq,Lt);return De.currentProgram=Ht,De.uniformsList=qt,Ht}function Ze(ce,ve){let We=Ae.get(ce);We.outputColorSpace=ve.outputColorSpace,We.instancing=ve.instancing,We.instancingColor=ve.instancingColor,We.instancingPickingColor=ve.instancingPickingColor}function pt(ce,ve,We,De){var wn;ve.isScene!==!0&&(ve=ae),je.resetTextureUnits();let mt=F===null?_.outputColorSpace:Qa,gt=Ae.get(We);Dt(T,"render state");let Vt=T.state.lights,ir=!1;We.version===gt.__version?(gt.needsLights&&gt.lightsStateVersion!==Vt.state.version||gt.outputColorSpace!==mt||De instanceof vi!=!!gt.instancing)&&(ir=!0):(ir=!0,gt.__version=We.version);let Yt=gt.currentProgram;ir===!0&&(Yt=mo(We,ve,De)),We.exprTooComplex=((wn=Yt==null?void 0:Yt.diagnostics)==null?void 0:wn.exprTooComplex)===!0;let Ht=!1,Lt=!1,ur=!1;Dt(Yt,"program");let qt=Yt.getUniforms(),Mo=gt.uniforms;if(Ce.useProgram(Yt.program)&&(Ht=!0,Lt=!0,ur=!0),We.id!==N&&(N=We.id,Lt=!0),Ht||Y!==ce){qt.setValue(J,"projectionMatrix",ce.projectionMatrix,je),Y!==ce&&(Y=ce,Lt=!0,ur=!0);let di=qt.map.cameraPosition;di!==void 0&&di.setValue(J,he.setFromMatrixPosition(ce.matrixWorld),je),qt.setValue(J,"isOrthographic",ce instanceof Ph,je),qt.setValue(J,"viewMatrix",ce.matrixWorldInverse,je)}Lt&&(gt.needsLights&&(Dt(Mo,"m_uniforms"),xt(Mo,ur)),We.uniformsNeedUpdate=!1,Dt(gt.uniformsList,"uniformsList"),Dt(Mo,"m_uniforms"),Lm.upload(J,gt.uniformsList,Mo,je)),We.uniformsNeedUpdate===!0&&(Dt(gt.uniformsList,"uniformsList"),Dt(Mo,"m_uniforms"),Lm.upload(J,gt.uniformsList,Mo,je),We.uniformsNeedUpdate=!1),qt.setValue(J,"dcgModelMatrix",De.dcgModelMatrix,je),qt.setValue(J,"modelViewMatrix",De.modelViewMatrix,je),qt.setValue(J,"pickingColor",De.pickingColor||[0,0,0,0],je),qt.setValue(J,"normalMatrix",De.normalMatrix,je);let Ci=We.uniformsGroups;for(let di=0,$r=Ci.length;di<$r;di++){let pi=Ci[di];Et.update(pi,Yt),Et.bind(pi,Yt)}return Yt}function xt(ce,ve){ce.ambientLightColor.needsUpdate=ve,ce.directionalLights.needsUpdate=ve}function ke(ce){return ce.lights===!0}this.getActiveCubeFace=function(){return D},this.getActiveMipmapLevel=function(){return P},this.getRenderTarget=function(){return F},this.setRenderTarget=function(ce,ve=0,We=0){F=ce,D=ve,P=We;let De=!0,mt=null;if(ce){let Vt=Ae.get(ce);Vt.__useDefaultFramebuffer!==void 0?(Ce.bindFramebuffer(J.FRAMEBUFFER,null),De=!1):Vt.__webglFramebuffer===void 0?je.setupRenderTarget(ce):Vt.__hasExternalTextures&&ce.depthTexture&&je.rebindTextures(ce,Ae.get(ce.texture).__webglTexture,Ae.get(ce.depthTexture).__webglTexture);let ir=Ae.get(ce).__webglFramebuffer;ce.samples>0&&je.useMultisampledRTT(ce)===!1?mt=Ae.get(ce).__webglMultisampledFramebuffer:Array.isArray(ir)?mt=ir[We]:mt=ir,z.copy(ce.viewport),X.copy(ce.scissor),q=ce.scissorTest}else z.copy(K).multiplyScalar(O).floor(),X.copy(oe).multiplyScalar(O).floor(),q=Z;Ce.bindFramebuffer(J.FRAMEBUFFER,mt)&&Se.drawBuffers&&De&&Ce.drawBuffers(ce,mt),Ce.viewport(z),Ce.scissor(X),Ce.setScissorTest(q),N=-1},this.readRenderTargetPixels=function(ce,ve,We,De,mt,gt,Vt){if(!(ce&&ce.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ir=Ae.get(ce).__webglFramebuffer;if(ir){Ce.bindFramebuffer(J.FRAMEBUFFER,ir);try{let Yt=ce.texture,Ht=Yt.format,Lt=Yt.type;if(Ht!==Xp&&Nt.convert(Ht)!==J.getParameter(J.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let ur=Lt===bw&&(ye.has("EXT_color_buffer_half_float")||ye.has("EXT_color_buffer_float"));if(Lt!==Gn&&Nt.convert(Lt)!==J.getParameter(J.IMPLEMENTATION_COLOR_READ_TYPE)&&Lt!==Dc&&!ur){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ve>=0&&ve<=ce.width-De&&We>=0&&We<=ce.height-mt&&J.readPixels(ve,We,De,mt,Nt.convert(Ht),Nt.convert(Lt),gt)}finally{let Yt=F!==null?Ae.get(F).__webglFramebuffer:null;Ce.bindFramebuffer(J.FRAMEBUFFER,Yt||null)}}},this.copyFramebufferToTexture=function(ce,ve,We=0){let De=Math.pow(2,-We),mt=Math.floor(ve.image.width*De),gt=Math.floor(ve.image.height*De);je.setTexture2D(ve,0),J.copyTexSubImage2D(J.TEXTURE_2D,We,0,0,ce.x,ce.y,mt,gt),Ce.unbindTexture()},this.copyTextureToTexture=function(ce,ve,We,De=0){let mt=Nt.convert(We.format),gt=Nt.convert(We.type);je.setTexture2D(We,0),J.pixelStorei(J.UNPACK_FLIP_Y_WEBGL,We.flipY),J.pixelStorei(J.UNPACK_PREMULTIPLY_ALPHA_WEBGL,We.premultiplyAlpha),J.pixelStorei(J.UNPACK_ALIGNMENT,We.unpackAlignment),J.texSubImage2D(J.TEXTURE_2D,De,ce.x,ce.y,mt,gt,ve.image),De===0&&We.generateMipmaps&&J.generateMipmap(J.TEXTURE_2D),Ce.unbindTexture()},this.initTexture=function(ce){je.setTexture2D(ce,0),Ce.unbindTexture()},this.resetState=function(){D=0,P=0,F=null,Ce.reset(),Tt.reset()}}get coordinateSystem(){return Ac}};var os=class extends jL{constructor(t=1,o=1,i={}){super(t,o,i);this.isWebGLRenderTarget=!0}};var IP=class extends gl{constructor(t,o,i,n,a,s,c,d,p){super(t,o,i,n,a,s,c,d,p);this.isCanvasTexture=!0;this.needsUpdate=!0}};var I_=class extends QL{constructor(e,t){let i=t.font.generateShapes(e,t.size),n={...t,depth:t.height!==void 0?t.height:50};n.bevelThickness===void 0&&(n.bevelThickness=10),n.bevelSize===void 0&&(n.bevelSize=8),n.bevelEnabled===void 0&&(n.bevelEnabled=!1),super(i,n)}};var M_=class{constructor(e){this.data=e}generateShapes(e,t=100){let o=[],i=H1e(e,t,this.data);for(let n=0,a=i.length;n<a;n++)o.push(...i[n].toShapes());return o}};function H1e(r,e,t){let o=Array.from(r),i=e/t.resolution,n=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*i,a=[],s=0,c=0;for(let d=0;d<o.length;d++){let p=o[d];if(p===`
`)s=0,c-=n;else{let u=W1e(p,i,s,c,t);s+=u.offsetX,a.push(u.path)}}return a}function W1e(r,e,t,o,i){let n=i.glyphs[r]||i.glyphs["?"];if(!n)throw new Error('THREE.Font: character "'+r+'" does not exists in font family '+i.familyName+".");let a=new JL,s,c,d,p,u,g;if(n.o){let h=n._cachedOutline||(n._cachedOutline=n.o.split(" "));for(let b=0,v=h.length;b<v;){let T=h[b++];switch(T){case"m":s=h[b++]*e+t,c=h[b++]*e+o,a.moveTo(s,c);break;case"l":s=h[b++]*e+t,c=h[b++]*e+o,a.lineTo(s,c);break;case"q":d=h[b++]*e+t,p=h[b++]*e+o,u=h[b++]*e+t,g=h[b++]*e+o,a.quadraticCurveTo(u,g,d,p);break;default:if(T)throw new Error("unrecognized action: "+T)}}}return{offsetX:n.ha*e,path:a}}Ut();var{abs:ite,PI:nte}=Math;function cte(r,e,t,o){let i=ate(r,t,o),n=ate(e,t,o);return pte(i,n)}function ate(r,e,t){let o={x:(r.x-e.x)/t,y:-(r.y-e.y)/t},i=o.x*o.x+o.y*o.y,n=Math.sqrt(i);return i<1?new Ee(o.x,-o.y,Math.sqrt(1-i)):new Ee(o.x/n,-o.y/n,0)}function dte(r,e,t){let o=ste(r,t),i=ste(e,t);return pte(o,i)}function ste(r,e){let t={x:r.x-e.x,y:r.y-e.y},o=Math.hypot(t.x,t.y);return o===0?new Ee(1,0,0):new Ee(t.x/o,t.y/o,0)}function j1e(r){let e=r.elements,t=new Ee(e[3],e[4],e[5]).normalize(),o=new Ee(e[6],e[7],e[8]),i=new Ee().crossVectors(t,o).normalize();o.crossVectors(i,t).normalize();let n=new Co;return n.set(i.x,t.x,o.x,i.y,t.y,o.y,i.z,t.z,o.z),n}function Dw(r,e){let t=r.clone().transpose(),o=new Co().multiplyMatrices(t,e),i=new Co().multiplyMatrices(o,r);return j1e(i)}function pte(r,e){let t=e.clone();t.cross(r);let o=t.length(),i=e.dot(r),n=1-i;o>0&&(t.x=t.x/o,t.y=t.y/o,t.z=t.z/o);let a=new Co;return a.set(n*t.z*t.z+i,n*t.z*t.x-o*t.y,n*t.y*t.z+o*t.x,n*t.z*t.x+o*t.y,n*t.x*t.x+i,n*t.y*t.x-o*t.z,n*t.y*t.z-o*t.x,n*t.y*t.x+o*t.z,n*t.y*t.y+i),a}var{sin:D_,cos:MP}=Math;function Zp(){let r=Aw(-(11*Math.PI)/16);return fy(Math.PI/8).multiply(r)}function DP(){let r=Aw(-Math.PI/2);return fy(Math.PI/2).multiply(r)}function Aw(r){let e=new Co;return e.set(MP(r),-D_(r),0,D_(r),MP(r),0,0,0,1),e}function fy(r){let e=new Co;return e.set(MP(r),0,-D_(r),0,1,0,D_(r),0,MP(r)),e}function oY(r){let e=r.elements,t=e[0]+e[4]+e[8];if(t<3){let o=Math.acos(.5*(t-1)),i=2*D_(o),n=(e[5]-e[7])/i,a=(e[6]-e[2])/i,s=(e[1]-e[3])/i;return{axis:new Ee(n,a,s),angle:o}}return{axis:new Ee(0,0,-1),angle:0}}function ute(r,e){let t=__dcg_shared_module_exports__['dd'](r,e),o=new Co;return o.elements=t,o}function lte(r,e){return e*Math.floor(r/e+.5)}function AP(r){let e=jn?.06:.03,t=new $t().setFromMatrix3(r),{y:o,z:i}=new ul(0,0,0,"YXZ").setFromRotationMatrix(t),n=lte(o,nte/2),a=lte(i,nte/2),s=ite(o-n)<e,c=ite(i-a)<e,d;if(s||c){let p=s?n:o,u=c?a:i,g=new ul(0,p,u,"YXZ"),h=new $t().makeRotationFromEuler(g);d=new Co().setFromMatrix4(h)}else d=r;return{matrix:d,isXYsnapped:c,isZsnapped:s}}Ut();var X1e=.1,PP=class{constructor(e,t){this.viewport=e;this.grapher3d=t;this.s=Qc(()=>this.grapher3d.settings.config.language)}isDefaultViewportRestored(){return this.grapher3d.isDefaultDomain()}getCurrentDomain(){var e,t;return{xmin:this.viewport.xmin,xmax:this.viewport.xmax,ymin:this.viewport.ymin,ymax:this.viewport.ymax,zmin:(e=this.viewport.zmin)!=null?e:__dcg_shared_module_exports__['Gc'].zmin,zmax:(t=this.viewport.zmax)!=null?t:__dcg_shared_module_exports__['Gc'].zmax}}animateToDomain(e){let t=this.getCurrentDomain(),o=this.grapher3d.transition;o.isZooming||(o.isZooming=!0,o.startTime=window.performance.now(),o.duration=150,o.zoom0=t,o.zoom1=e,this.grapher3d.startZoom())}setDefaultViewport(){this.animateToDomain(new __dcg_shared_module_exports__['md']),_e(this.s("graphing-calculator-narration-viewport-default"))}setViewport(e){var n,a;if(!e.isValid({xAxisScale:"linear",yAxisScale:"linear"})||!e.isZValid())return;let o=e.toObject();e=Or.fromObject(Z1e({...o,zmin:(n=o.zmin)!=null?n:__dcg_shared_module_exports__['Gc'].zmin,zmax:(a=o.zmax)!=null?a:__dcg_shared_module_exports__['Gc'].zmax})),this.grapher3d.controller.getGrapher2d().viewportController.setViewport(e),this.viewport=e,this.grapher3d.controller.requestRedrawGraph()}getViewport(){return this.viewport}setScreen(){}zoom(e){let t=this.getCurrentDomain(),o=this.grapher3d.transition;switch(e){case"in":{if(o.isZooming)return;o.isZooming=!0,o.startTime=window.performance.now(),o.duration=150,o.zoom0=t,o.zoom1=A_(t,1/2),this.grapher3d.startZoom(),_e(this.s("graphing-calculator-narration-viewport-zoom-in"))}break;case"out":{if(o.isZooming)return;o.isZooming=!0,o.startTime=window.performance.now(),o.duration=150,o.zoom0=t,o.zoom1=nY(t,2,X1e),this.grapher3d.startZoom(),_e(this.s("graphing-calculator-narration-viewport-zoom-out"))}break;case"square":this.grapher3d.settings.setProperty("squareAxes",!0),this.animateToDomain($1e(this.getCurrentDomain())),_e(this.s("graphing-calculator-narration-viewport-zoom-square"));break;case"default":this.setDefaultViewport();break;case"default3dOrientation":this.animateToOrientation(Zp()),_e(this.s("graphing-calculator-narration-viewport-zoom-3d-default"));break;case"xy3dOrientation":this.animateToOrientation(DP()),_e(this.s("graphing-calculator-narration-viewport-zoom-3d-xy"));break;case"recenter":this.animateToDomain(J1e(this.getCurrentDomain())),_e(this.s("graphing-calculator-narration-viewport-zoom-recenter"));break;default:}}animateToOrientation(e){this.grapher3d.settings.setProperty("speed3D",0),this.grapher3d.settings.setProperty("worldRotation3D",[...e.elements]),this.grapher3d.controls.animateToOrientation(e)}zoomSquareImmediately(){}remove(){}beginPanning(){}zoomCustom(e){}getProjection(){return this.grapher3d.getProjection()}panFromKeyboard(e){}};function A_(r,e,t){let{xwidth:o,ywidth:i,zwidth:n}=Q1e(r);return hte(r,{xwidth:o*e,ywidth:i*e,zwidth:n*e},t)}function nY(r,e,t,o=new Ee(0,0,0)){let i=new Ee((r.xmax+r.xmin)/2,(r.ymax+r.ymin)/2,(r.zmax+r.zmin)/2),n=new Ee(o.x<i.x?r.xmax:r.xmin,o.y<i.y?r.ymax:r.ymin,o.z<i.z?r.zmax:r.zmin),a=0;for(let p of["x","y","z"])Math.abs(n[p]-o[p])>Math.abs(a)&&i[p]!==o[p]&&(a=(n[p]-o[p])/(i[p]-o[p]));let s=i.clone().sub(o).multiplyScalar(a).add(o);s.lerp(i,1-t);for(let p of["x","y","z"]){let u=r[`${p}min`],g=r[`${p}max`];u===0||g===0?s[p]=0:u===-g&&(s[p]=i[p])}let c=A_(r,e,s),d=new Ee((c.xmax+c.xmin)/2,(c.ymax+c.ymin)/2,(c.zmax+c.zmin)/2);return d.x<o.x!=i.x<o.x&&(c.xmax=.5*(c.xmax-c.xmin),c.xmin=-c.xmax),d.y<o.y!=i.y<o.y&&(c.ymax=.5*(c.ymax-c.ymin),c.ymin=-c.ymax),d.z<o.z!=i.z<o.z&&(c.zmax=.5*(c.zmax-c.zmin),c.zmin=-c.zmax),c}function $1e(r){let e=r.xmax-r.xmin;return hte(r,{xwidth:e,ywidth:e,zwidth:e})}function hte(r,{xwidth:e,ywidth:t,zwidth:o},i){let n=new __dcg_shared_module_exports__['md'];return[n.xmin,n.xmax]=iY(r.xmin,r.xmax,e,i==null?void 0:i.x),[n.ymin,n.ymax]=iY(r.ymin,r.ymax,t,i==null?void 0:i.y),[n.zmin,n.zmax]=iY(r.zmin,r.zmax,o,i==null?void 0:i.z),n}function J1e(r){let e=new __dcg_shared_module_exports__['md'];return e.xmax=.5*(r.xmax-r.xmin),e.xmin=-e.xmax,e.ymax=.5*(r.ymax-r.ymin),e.ymin=-e.ymax,e.zmax=.5*(r.zmax-r.zmin),e.zmin=-e.zmax,e}function Z1e(r){let e=new __dcg_shared_module_exports__['md'];return[e.xmin,e.xmax]=LP(r.xmin,r.xmax),[e.ymin,e.ymax]=LP(r.ymin,r.ymax),[e.zmin,e.zmax]=LP(r.zmin,r.zmax),e}var Md=134e3,gte=134e-6;function mte(r,e,t,o){return t=__dcg_shared_module_exports__['Rb'](t,gte,Md),o=o!=null?o:r===0||e===0?0:(r+e)/2,r=o+(r-o)/(e-r)*t,e=r+t,[r,e]}function iY(r,e,t,o){return[r,e]=mte(r,e,t,o),LP(r,e)}function LP(r,e){r<-Md/2&&(e<-Md/4&&(e+=-Md/2-r,e=Math.min(Md/2,e)),r=-Md/2),e>Md/2&&(r>Md/4&&(r+=Md/2-e,r=Math.max(-Md/2,r)),e=Md/2);let t=gte*Math.max(1,Math.abs(r),Math.abs(e));return e-r<t?mte(r,e,t):[r,e]}function Q1e(r){let{xmin:e,xmax:t,ymin:o,ymax:i,zmin:n,zmax:a}=r;return{xwidth:t-e,ywidth:i-o,zwidth:a-n}}var{abs:Dd,min:xte,acos:fte,hypot:vte,PI:Ad}=Math,ewe=1e3,twe=.2,Fh={NONE:-1,ROTATE:0},rwe={type:"start"},owe={type:"end"},bte=50,iwe=5*Math.PI/180,GP=class extends hl{constructor(t,o,i){super();this.worldRotation3D=Zp();this.unsnappedRotation=new Co;this.axis3D=[0,0,1];this.speed3D=0;this.touches=[];this.spinningWorld=t,this.copyWorldRotationToWorld(),this.domElement=i!==void 0?i:document,this.grapher3d=o,this.state=Fh.NONE,this.lastMovedTime=0,this.lastRotateTime=0,this.lastWheelEventTime=0,this.keyStillDown=!1,this.lastAngle=0,this.useVirtualSphere=!1,this.startedOutsideVirtualSphere=!1,this.isXYsnapped=!1,this.isZsnapped=!1,this.dimensions=()=>{let n=this.domElement===document?this.domElement.body:this.domElement,a=n.clientWidth,s=n.clientHeight,c=new Ft(a/2,s/2),d=Math.min(a,s)/2;return{center:c,radius:d,height:s,width:a}},this.onContextMenu=n=>{this.grapher3d.controller.dispatch({type:"blur-focus-location",location:this.grapher3d.controller.getFocusLocation()})},this.onTapStart=n=>{var E,I;let a=n,s=Object.keys(this.touches).length;this.touches=aY(a.touches);let c=Object.keys(this.touches).length,d=o.webglLayer.getPressedAction()!==void 0;if(s<2&&c===2&&!d){this.startPinchZoom();return}if(c>1)return;let{top:p,left:u}=yo(this.grapher3d.elt),g=this.touches[0].pageX-u,h=this.touches[0].pageY-p;if(this.isPinchZooming()||(E=this.grapher3d)!=null&&E.transition.isOrienting)return;this.grapher3d.controller.dispatch({type:"set-none-selected"}),o.webglLayer.setMouse({x:g,y:h}),o.webglLayer.pickAtMouseAndReadResults();let b=(I=o.webglLayer.getPickResult())==null?void 0:I.id;if(b){let _=o.controller.getItemModel(b);if(_&&_.type==="expression"&&Jn(_))return}this.state=Fh.ROTATE,this.speed3D=0,this.invert=void 0;let{center:v,radius:T}=this.dimensions();this.startedOutsideVirtualSphere=vte(g-v.x,h-v.y)>=T,this.unsnappedRotation.copy(this.worldRotation3D),this.useVirtualSphere=a.shiftKey&&this.grapher3d.settings.config.beta3d||!this.isHorizonLevel(),this.state!==Fh.NONE&&(this.grapher3d.isDragging=!0,re(document).on("dcg-tapmove",this.onTapMove),re(document).on("dcg-tapend",this.onTapUp),re(document).on("dcg-tapcancel",this.onTapUp),this.dispatchEvent(rwe))},this.onTapMove=n=>{var T;let a=n,s=a.changedTouches[0].identifier,c=a.changedTouches[0],d=this.touches.find(E=>E.identifier===s)||c;this.touches=aY(a.touches);let{top:p,left:u}=yo(this.grapher3d.elt),g=new Ft(d.pageX-u,d.pageY-p),h=new Ft(c.pageX-u,c.pageY-p);if(this.isPinchZooming()){this.updatePinchZoom();return}if((T=this.grapher3d)!=null&&T.transition.isOrienting||this.state!=Fh.ROTATE||this.isRotationLocked())return;let b=h.x-g.x,v=h.y-g.y;if(b!==0||v!==0){let E,{center:I,radius:_,height:C,width:D}=this.dimensions();if(this.useVirtualSphere)E=this.startedOutsideVirtualSphere?dte(h,g,I):cte(h,g,I,_),E=Dw(this.worldRotation3D,E),this.setWorldRotation(this.worldRotation3D.multiply(E));else{if(this.invert===void 0){this.invert=h.y>I.y?1:-1;let K=new Ee(0,0,1).applyMatrix3(this.worldRotation3D);K.x>.7&&(this.invert*=-1),Dd(K.x)<.7&&(this.invert=K.z<-.7?-1:1)}let X=b/D*Ad*this.invert,q=v/C*Ad,S=Aw(X),A=fy(q);A=Dw(this.unsnappedRotation,A),Dd(v)>2*Dd(b)?this.unsnappedRotation.multiply(A):Dd(b)>2*Dd(v)?this.unsnappedRotation.multiply(S):this.unsnappedRotation.multiply(A).multiply(S);let{matrix:O,isXYsnapped:B,isZsnapped:V}=AP(this.unsnappedRotation);this.setWorldRotation(O),this.isXYsnapped=B,this.isZsnapped=V,A=fy(q),A=Dw(this.worldRotation3D,A),E=Dd(v)>Dd(b)?A:S}let{axis:P,angle:F}=oY(E),N=a.timeStamp,Y=(N-this.lastMovedTime)*.001;this.axis3D=[P.x,P.y,P.z],this.useVirtualSphere&&this.snapSpinAxisIfClose();let z=240*(Ad/180);this.speed3D=__dcg_shared_module_exports__['Rb'](F/Y,-z,z),this.lastAngle=0,this.lastMovedTime=N,Dd(this.speed3D)<iwe&&(this.speed3D=0)}else this.lastMovedTime+bte<a.timeStamp&&(this.speed3D=0)},this.onTapUp=n=>{var d;let a=n,s=Object.keys(this.touches).length;this.touches=aY(a.touches);let c=Object.keys(this.touches).length;s===2&&c<2&&this.isPinchZooming()&&this.stopPinchZoom(),!((d=this.grapher3d)!=null&&d.transition.isOrienting)&&(c>0||(this.lastMovedTime+bte<a.timeStamp&&!this.isPinchZooming()&&(this.speed3D=0),this.grapher3d.isDragging=!1,re(document).off("dcg-tapmove",this.onTapMove),re(document).off("dcg-tapend",this.onTapUp),re(document).off("dcg-tapcancel",this.onTapUp),this.dispatchEvent(owe),this.grapher3d.debounceUserRequestedRotationChange(),this.state=Fh.NONE,this.grapher3d.controller.dispatch({type:"render"})))},this.onMouseWheel=n=>{var _,C;let a=n;if(this.state!==Fh.NONE||this.isLocked()||a.deltaY===0)return;a.preventDefault(),this.lastWheelEventTime===0&&this.grapher3d.startZoom(),this.lastWheelEventTime=window.performance.now();let s=this.grapher3d.webglLayer.domain(),c=this.grapher3d.webglLayer.getMouse(),d=Date.now(),p=this.speed3D!==0,u=a.deltaY<0?"in":"out",g=this.currentZoomAction&&d-this.currentZoomAction.lastChangeTime>ewe;if(!this.currentZoomAction||this.currentZoomAction.input.type!=="pointer"||this.currentZoomAction.input.x!==(c==null?void 0:c.x)||this.currentZoomAction.input.y!==(c==null?void 0:c.y)||this.currentZoomAction.isSpinning!==p||u==="in"&&this.currentZoomAction.initialDirection==="out"||g){let D=u==="in"?(_=this.grapher3d.webglLayer.getZoomScrollWheelPickResult())==null?void 0:_.point:void 0;this.currentZoomAction={lastChangeTime:d,start:s,input:{type:"pointer",...c},isSpinning:p,center:D==null?void 0:D.clone(),initialDirection:u}}else this.currentZoomAction&&(this.currentZoomAction.lastChangeTime=d);let h=(C=this.currentZoomAction)==null?void 0:C.center,b=this.currentZoomAction.start.xmax-this.currentZoomAction.start.xmin,v=s.xmax-s.xmin;if(this.currentZoomAction.initialDirection==="in"&&u==="out"&&v>=b){let D=this.currentZoomAction.start;delete this.currentZoomAction,s=D,h=void 0}if(!h){let D=s.xmin<=0&&s.xmax>=0,P=s.ymin<=0&&s.ymax>=0,F=s.zmin<=0&&s.zmax>=0;D&&P&&F&&(h=new Ee(0,0,0))}let T=1.05,E;u==="out"&&(!h||h.lengthSq()===0)?E=nY(s,T,twe):E=A_(s,a.deltaY<0?1/T:T,h);let I=new Or(E.xmin,E.xmax,E.ymin,E.ymax,E.zmin,E.zmax);this.updateViewport(I),this.copyWorldRotationToWorld(),this.grapher3d.webglLayer.updateAxes(),this.grapher3d.controller.dispatch({type:"render"})},this.domElement.addEventListener("touchstart",n=>{(!this.isLocked()||!this.isRotationLocked())&&n.preventDefault()},{passive:!1}),re(this.domElement).on("dcg-tapstart",this.onTapStart),re(this.domElement).on("contextmenu",this.onContextMenu),this.domElement.addEventListener("wheel",this.onMouseWheel)}keyUp(){this.keyStillDown=!1,this.speed3D&&_e(this.grapher3d.controller.s("graphing-calculator-narration-3d-rotation-speed",{speed:Math.ceil(this.speed3D*180/Ad)}))}applyTiltFromKeyboard(t,o){var p;if(this.isRotationLocked()||this.isPinchZooming()||(p=this.grapher3d)!=null&&p.transition.isOrienting)return;this.grapher3d.controller.dispatch({type:"set-none-selected"});let i={Up:this.grapher3d.controller.s("graphing-calculator-narration-3d-rotate-up"),Down:this.grapher3d.controller.s("graphing-calculator-narration-3d-rotate-down"),Left:this.grapher3d.controller.s("graphing-calculator-narration-3d-rotate-left"),Right:this.grapher3d.controller.s("graphing-calculator-narration-3d-rotate-right")},n=u=>{let g=fy(u);g=Dw(this.unsnappedRotation,g),this.unsnappedRotation.multiply(g)},a=u=>{this.unsnappedRotation.multiply(Aw(u))},s=u=>{let g=fy(u);return Dw(this.worldRotation3D,g)},c=u=>Aw(u);if(t===this.lastKeyboardDirection&&this.keyStillDown)if(this.speed3D===0){let u,g=2*Ad/180;switch(t){case"Up":u=s(-g);break;case"Down":u=s(+g);break;case"Left":u=c(-g);break;case"Right":u=c(+g);break}let{axis:h,angle:b}=oY(u);this.axis3D=[h.x,h.y,h.z],this.speed3D=b}else{let u=240*(Ad/180);this.speed3D=__dcg_shared_module_exports__['Rb'](this.speed3D*1.1,-u,u)}else if(this.speed3D)this.lastKeyboardDirection=void 0,this.keyStillDown=!0,this.speed3D=0,_e(this.grapher3d.controller.s("graphing-calculator-narration-3d-rotation-stopped"));else{this.lastKeyboardDirection=t,this.keyStillDown=!0,_e(i[t]);let u=Ad/180;switch(t){case"Up":n(-u);break;case"Down":n(+u);break;case"Left":a(-u);break;case"Right":a(+u);break}let{matrix:g,isXYsnapped:h,isZsnapped:b}=AP(this.unsnappedRotation);this.setWorldRotation(g),this.isXYsnapped=h,this.isZsnapped=b,this.lastAngle=0}}isPinchZooming(){var t;return((t=this.currentZoomAction)==null?void 0:t.input.type)==="pinch"}startPinchZoom(){if(this.isLocked()||this.isPinchZooming())return;let t=__dcg_shared_module_exports__['f'](this.touches);this.grapher3d.controller.dispatch({type:"set-none-selected"}),this.grapher3d.startZoom(),this.currentZoomAction={lastChangeTime:Date.now(),start:this.grapher3d.webglLayer.domain(),center:void 0,input:{type:"pinch",pinchZoomStartPositions:t},isSpinning:this.speed3D!==0,initialDirection:void 0}}stopPinchZoom(){this.isPinchZooming()&&(this.currentZoomAction=void 0,this.grapher3d.endZoom(),this.grapher3d.controller.dispatch({type:"render"}))}updatePinchZoom(){var s;if(((s=this.currentZoomAction)==null?void 0:s.input.type)!=="pinch")return;let t=yte(this.currentZoomAction.input.pinchZoomStartPositions),i=yte(this.touches)/t;if(!isFinite(i))return;let n=A_(this.currentZoomAction.start,1/i),a=new Or(n.xmin,n.xmax,n.ymin,n.ymax,n.zmin,n.zmax);this.updateViewport(a),this.copyWorldRotationToWorld()}snapSpinAxisIfClose(){if(!this.grapher3d.settings.showAxis3D)return;let[t,o,i]=this.axis3D,n=.97;t>n&&(this.axis3D=[1,0,0]),o>n&&(this.axis3D=[0,1,0]),i>n&&(this.axis3D=[0,0,1]),t<-n&&(this.axis3D=[-1,0,0]),o<-n&&(this.axis3D=[0,-1,0]),i<-n&&(this.axis3D=[0,0,-1])}copyWorldRotationToWorld(){this.spinningWorld.setRotationFromMatrix(new $t().setFromMatrix3(this.worldRotation3D))}update(){return!0}dispose(){re(this.domElement).off("dcg-tapstart",this.onTapStart),re(document).off("dcg-tapmove",this.onTapMove),re(document).off("dcg-tapend",this.onTapUp),re(document).off("dcg-tapcancel",this.onTapUp),this.domElement.removeEventListener("wheel",this.onMouseWheel)}setWorldRotation(t){this.worldRotation3D=t,this.copyWorldRotationToWorld();let{isXYsnapped:o,isZsnapped:i}=AP(t);this.isXYsnapped=o,this.isZsnapped=i}isHorizonLevel(){let t=new Ee(0,0,1).applyMatrix3(this.worldRotation3D);return Dd(t.y)<1e-4}compareWorldRotationTo(t){let o=new $t().setFromMatrix3(this.worldRotation3D),i=new $t().setFromMatrix3(t),n=new ul(0,0,0,"YXZ").setFromRotationMatrix(o),a=new ul().setFromRotationMatrix(i),s=new Lc().setFromEuler(n).normalize(),c=new Lc().setFromEuler(a).normalize(),d=xte(Dd(s.dot(c)),1);return 2*fte(d)*(180/Ad)}isDefaultOrientation(){let t=this.compareWorldRotationTo(Zp());return this.speed3D===0&&t<1}isXYPlaneOrientation(){let t=this.compareWorldRotationTo(DP());return this.speed3D===0&&t<.001}animateToOrientation(t){let o=this.grapher3d;this.speed3D=0;let i=o.transition,n=new $t().setFromMatrix3(this.worldRotation3D),a=new $t().setFromMatrix3(t),s=new ul().setFromRotationMatrix(a),c=new ul(0,0,0,"YXZ").setFromRotationMatrix(n);i.q0.setFromEuler(c),i.q1.setFromEuler(s);let d=i.q0.clone().normalize(),p=i.q1.clone().normalize(),u=2*fte(Dd(d.dot(p)))*(180/Ad);i.isOrienting=!0,i.startTime=window.performance.now(),i.duration=150*__dcg_shared_module_exports__['Rb'](u/30,1,3)}updateViewport(t){let o=this.grapher3d,i=o.controller.getGrapher2d();o.viewportController.setViewport(t),o.debounceUserRequestedViewportChange(),i.viewportController.setViewport(t),i.redrawAllLayersSynchronously(),o.webglLayer.updatePlaneMap(),o.webglLayer.updateDomainObjects()}isLocked(){return this.grapher3d.controller.zoomAndPanDisabled()}isRotationLocked(){return this.grapher3d.controller.getGraphSettings().userLockedRotation||this.grapher3d.controller.getVisualViewportIsZoomed()}},VP=class{constructor(){this.isZooming=!1;this.zoom0=new __dcg_shared_module_exports__['md'];this.zoom1=new __dcg_shared_module_exports__['md'];this.isOrienting=!1;this.q0=new Lc;this.q1=new Lc;this.objectIdExtendingTo3D=void 0;this.startTime=0;this.duration=0}};function wte(r){let e=r.grapher3d,t=e.transition;if(e.settings.threeDMode){if(r.lastWheelEventTime!=0&&(window.performance.now()-r.lastWheelEventTime)*.001>.1&&(r.lastWheelEventTime=0,e.endZoom()),t.isZooming){let{zoom0:o,zoom1:i}=t,n=window.performance.now(),a=xte(1,(n-t.startTime)/t.duration),s=new Or(a*i.xmin+(1-a)*o.xmin,a*i.xmax+(1-a)*o.xmax,a*i.ymin+(1-a)*o.ymin,a*i.ymax+(1-a)*o.ymax,a*i.zmin+(1-a)*o.zmin,a*i.zmax+(1-a)*o.zmax);a>=1&&(e.endZoom(),t.isZooming=!1),r.updateViewport(s)}if(t.isOrienting){let i=(window.performance.now()-t.startTime)/t.duration;if(i>=1){let n=new $t().makeRotationFromQuaternion(t.q1);r.setWorldRotation(new Co().setFromMatrix4(n)),t.isOrienting=!1,e.controller.dispatch({type:"render"})}else{let n=t.q0.clone().slerp(t.q1,i),a=new $t().makeRotationFromQuaternion(n);r.setWorldRotation(new Co().setFromMatrix4(a)),r.unsnappedRotation.copy(r.worldRotation3D)}}if(t.objectIdExtendingTo3D&&t.startTime>0){let o=r.grapher3d.webglLayer,i=t.objectIdExtendingTo3D,n=o.domain(),{zmin:a,zmax:s}=n,d=(window.performance.now()-t.startTime)/t.duration;d>=1?(o.setZboundsOnSurfaces(i,-1/0,1/0),t.objectIdExtendingTo3D=void 0):o.setZboundsOnSurfaces(i,d*a,d*s),e.controller.requestRedrawGraph()}if(e.settings.userLockedRotation&&(r.speed3D=0),r.speed3D===0)r.lastRotateTime=window.performance.now();else{let o=window.performance.now(),i=(o-r.lastRotateTime)*.001,n=r.lastRotateTime!=0&&i<2?i*r.speed3D:0;if(n>20*Ad/180&&(n=20*Ad/180),r.state===Fh.NONE){let a=r.axis3D,s=new Ee(a[0],a[1],a[2]),c=ute(s,n);r.setWorldRotation(r.worldRotation3D.multiply(c)),r.unsnappedRotation.copy(r.worldRotation3D)}r.lastRotateTime=o,r.lastAngle=n}}}function yte(r){return r.length!==2?NaN:vte(r[0].pageX-r[1].pageX,r[0].pageY-r[1].pageY)}function aY(r){return __dcg_shared_module_exports__['f'](r)}function Ste(r,e=.01*(r.xmax-r.xmin)){return e*=2,Math.abs(r.xmin+r.xmax)<=e&&Math.abs(r.ymin+r.ymax)<=e&&Math.abs(r.zmin+r.zmax)<=e}En();var sY=[];function kte(r){return sY[r]===void 0&&(sY[r]=nwe(r)),sY[r]}function nwe(r){let e=Math.SQRT1_2,t=[0,0,1,0,0,-1,-e,-e,0,e,-e,0,e,e,0,-e,e,0],o=[0,3,4,0,4,5,0,5,2,0,2,3,1,4,3,1,5,4,1,2,5,1,3,2];function i(n){let a=t.length/3;for(let s=0;s<a;s++)if(n.x===t[3*s+0]&&n.y===t[3*s+1]&&n.z===t[3*s+2])return s;return t.push(n.x,n.y,n.z),a}for(let n=0;n<r;n++){let a=o.length/3;for(let s=0;s<a;s++){let c=o[3*s+0],d=o[3*s+1],p=o[3*s+2],u=new __dcg_shared_module_exports__['cd'](t[3*c+0],t[3*c+1],t[3*c+2]),g=new __dcg_shared_module_exports__['cd'](t[3*d+0],t[3*d+1],t[3*d+2]),h=new __dcg_shared_module_exports__['cd'](t[3*p+0],t[3*p+1],t[3*p+2]),b=new __dcg_shared_module_exports__['cd']().addVectors(u,g).multiply(.5).normalize(),v=new __dcg_shared_module_exports__['cd']().addVectors(g,h).multiply(.5).normalize(),T=new __dcg_shared_module_exports__['cd']().addVectors(h,u).multiply(.5).normalize(),E=i(b),I=i(v),_=i(T);o.push(c,E,_,E,d,I,I,p,_),o[3*s+0]=E,o[3*s+1]=I,o[3*s+2]=_}}return{vertices:new Float32Array(t),indices:new Uint16Array(o)}}var _te={name:"FillShader",defines:{},uniforms:{color:{value:new At(16777215)},opacity:{value:1}},vertexShader:`
		void main() {
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`
		uniform vec3 color;
		uniform float opacity;
		void main() {
			gl_FragColor = vec4( color, opacity );
		}`};var OP=class{constructor(){}setSize(e,t){}dispose(){}},awe=new Ph(-1,1,1,-1,0,1),RP=class{constructor(e){let t=new es;t.setAttribute("position",new No([-1,3,0,-1,-1,0,3,-1,0],3)),t.setAttribute("uv",new No([0,2,0,0,2,0],2)),this._mesh=new xi(t,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,awe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}};var Wl=class extends OP{constructor(t,o={},i="tDiffuse"){super();this.inputTextureName=i;this.uniforms=Dm(t.uniforms),this.defines=t.defines?{...t.defines}:{},this.material=new Pc({...o,name:t.name!==void 0?t.name:"unspecified",defines:this.defines,uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.fsTriangle=new RP(this.material)}render(t,o,i){this.renderFromTexture(t,o,i.texture)}renderFromTexture(t,o,i){this.uniforms[this.inputTextureName]&&(this.uniforms[this.inputTextureName].value=i),this.fsTriangle.material=this.material,t.setRenderTarget(o),this.fsTriangle.render(t)}dispose(){this.material.dispose(),this.fsTriangle.dispose()}};function FP(r,e,t=0,o=0,i=e.width,n=e.height,a=new Uint8ClampedArray(4*i*n)){return r.readRenderTargetPixels(e,t,o,i,n,a),a}function P_(r,e,t,o){let i=4*(o*e+t);return[r[i],r[i+1],r[i+2],r[i+3]]}var L_=new Uint8Array(4),swe=new Float32Array(L_.buffer);function NP([r,e,t,o]){return L_[0]=o,L_[1]=t,L_[2]=e,L_[3]=r,swe[0]}function lwe(r){let e=r.getContext();if(!(e instanceof WebGL2RenderingContext))throw new Error("WebGL2 is required for waitForFullFlush");return e}async function Cte(r){let e=lwe(r),t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);if(!t)throw new Error("Failed to create sync object");e.flush();let o=await Tte(e,t,0,0);return e.deleteSync(t),o}function Tte(r,e,t,o){let i=performance.now();return new Promise((n,a)=>{function s(){let c=r.clientWaitSync(e,t,0);if(c===r.WAIT_FAILED){a();return}if(c===r.TIMEOUT_EXPIRED){i=performance.now(),setTimeout(s,o);return}n([i,performance.now()])}s()})}async function cwe(r,e,t,o,i,n,a){let s=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);if(!s)throw new Error("Failed to create sync object");r.flush(),await Tte(r,s,0,10),r.deleteSync(s),r.bindBuffer(e,t),r.getBufferSubData(e,o,i,n,a),r.bindBuffer(e,null)}async function Ete(r,e,t,o,i,n,a,s){let c=r.createBuffer();if(!c)throw new Error("Failed to create buffer");return r.bindBuffer(r.PIXEL_PACK_BUFFER,c),r.bufferData(r.PIXEL_PACK_BUFFER,s.byteLength,r.STREAM_READ),r.readPixels(e,t,o,i,n,a,0),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),await cwe(r,r.PIXEL_PACK_BUFFER,c,0,s),r.deleteBuffer(c),s}var lY;function Ite(){if(lY)return lY;let r=new Wl(_te),e=1,t=1,o=1,i=0,n=r.material;n.uniforms.color.value=new At().setRGB(e,t,o),n.uniforms.opacity.value=i,n.blending=IL,n.blendEquation=Hp,n.blendSrc=DL,n.blendDst=ML;let a=new Mw,s=a.getContext(),c=[Dc,bw,Gn],d=[s.FLOAT,s.HALF_FLOAT,s.UNSIGNED_BYTE],p=[new Float32Array(4),new Uint16Array(4),new Uint8Array(4)],u=[1,15360,255],g=[];for(let h=0;h<c.length;h++){let b=new os(1,1,{minFilter:Wp,magFilter:Wp,type:c[h],format:Xp,stencilBuffer:!1,depthBuffer:!0});r.render(a,b,new os),s.readPixels(0,0,1,1,s.RGBA,d[h],p[h]);let v=[...p[h]];v[0]/=u[h],v[1]/=u[h],v[2]/=u[h],v[3]/=u[h];let T=(I,_,C=.01)=>I<_+C&&I>_-C,E=s.checkFramebufferStatus(s.FRAMEBUFFER)===s.FRAMEBUFFER_COMPLETE;E=E&&T(v[0],e),E=E&&T(v[1],t),E=E&&T(v[2],o),E=E&&T(v[3],i),E=E||h===c.length-1,b.dispose(),E&&g.push(c[h])}return r.dispose&&r.dispose(),lY=g,g}var cY;function dwe(){if(!cY){let r=document.createElement("div");r.className="dcg-3d-debug-root",document.body.appendChild(r),cY=r}return cY}var UP=class{constructor({filter:e}){this.canvases={};e?(this.enabled=!0,this.filter=new RegExp(e)):this.enabled=!1}removeUnused(){for(let e in this.canvases)this.canvases[e].used?this.canvases[e].used=!1:(this.canvases[e].container.remove(),delete this.canvases[e])}get(e,t){let o=t?`${e} ${t}`:e;if(!(!this.enabled||!this.filter.test(o)))return this.canvases[e]||(this.canvases[e]=new dY),this.canvases[e].setLabel(o),this.canvases[e].used=!0,this.canvases[e]}},dY=class{constructor(){this.container=document.createElement("div"),this.container.className="dcg-3d-debug-container",this.canvas=document.createElement("canvas"),this.container.appendChild(this.canvas),dwe().appendChild(this.container)}setLabel(e){this.container.setAttribute("dcg-label",e)}renderRawData(e,t,o,i){var a;let n=new ImageData(e,t,o);this.canvas.width=t,this.canvas.height=o,this.container.style.width=t*i+"px",this.container.style.height=o*i+"px",(a=this.canvas.getContext("2d"))==null||a.putImageData(n,0,0)}renderFromTarget(e,t,o){this.renderRawData(FP(e,t),t.width,t.height,o)}};var Mte=`{
  "glyphs": {
    "x": {
      "x_min": 0,
      "x_max": 675,
      "ha": 764,
      "o": "m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "
    },
    "y": {
      "x_min": 0,
      "x_max": 684.78125,
      "ha": 771,
      "o": "m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "
    },
    "z": {
      "x_min": -0.015625,
      "x_max": 613.890625,
      "ha": 697,
      "o": "m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "
    }
  },
  "cssFontWeight": "normal",
  "ascender": 1189,
  "underlinePosition": -100,
  "cssFontStyle": "normal",
  "boundingBox": { "yMin": -334, "xMin": -111, "yMax": 1189, "xMax": 1672 },
  "resolution": 1000,
  "original_font_information": {
    "postscript_name": "Helvetiker-Regular",
    "version_string": "Version 1.00 2004 initial release",
    "vendor_url": "http://www.magenta.gr/",
    "full_font_name": "Helvetiker",
    "font_family_name": "Helvetiker",
    "copyright": "Copyright (c) \u039Cagenta ltd, 2004",
    "description": "",
    "trademark": "",
    "designer": "",
    "designer_url": "",
    "unique_font_identifier": "\u039Cagenta ltd:Helvetiker:22-10-104",
    "license_url": "http://www.ellak.gr/fonts/MgOpen/license.html",
    "license_description": "Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\\r\\n\\r\\nPermission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license (\\"Fonts\\") and associated documentation files (the \\"Font Software\\"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \\r\\n\\r\\nThe above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\\r\\n\\r\\nThe Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word \\"MgOpen\\", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\\r\\n\\r\\nThis License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the \\"MgOpen\\" name.\\r\\n\\r\\nThe Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \\r\\n\\r\\nTHE FONT SOFTWARE IS PROVIDED \\"AS IS\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.",
    "manufacturer_name": "\u039Cagenta ltd",
    "font_sub_family_name": "Regular"
  },
  "descender": -334,
  "familyName": "Helvetiker",
  "lineHeight": 1522,
  "underlineThickness": 50
}
`;var Dte=`// License: MIT License (c) 2014 Mikola Lysenko
// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

lowp vec4 encode_float(highp float v) {
  highp float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  highp vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  highp float e = floor(log2(av));
  highp float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  highp float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}
`;var Lw=`
uniform int uDepthPeel; // 1 or 0
uniform vec2 uInverseScreenSize;
uniform highp sampler2D uOpaqueDepthTexture;
uniform highp sampler2D uPrevDepthTexture;
uniform int uDepthPeelLayer;
uniform float uDepthOffset;
`,Pw=`
  if (uDepthPeel != 0) {
    vec2 screenPos = gl_FragCoord.xy * uInverseScreenSize;
    float opaqueDepth = texture2D(uOpaqueDepthTexture, screenPos).x;
    if (opaqueDepth + uDepthOffset - gl_FragCoord.z < 0.0) {
      discard;
    }

    if(uDepthPeelLayer != 0){
      vec4 texel = texture2D(uPrevDepthTexture,screenPos);
      float prevDepth = texel.x;
      if(prevDepth + uDepthOffset - gl_FragCoord.z >= 0. ){
        discard;
      }
    }
  }
`;var Gs={Default:0,PickingObjectId:1,PickingX:2,PickingY:3,PickingZ:4,Depth:5};function YP(){return{zMinForAnimation:{value:-1/0},zMaxForAnimation:{value:1/0},clip_x:{value:!0},clip_y:{value:!0},clip_z:{value:!0},NaN:{value:NaN},Infinity:{value:1/0}}}var pY=`
#ifdef DCG_SUPPORTS_PICKING
  uniform vec4 pickingColor;
  ${Dte}
#endif
`,BP=`#ifdef DCG_SUPPORTS_PICKING
if (dcgRenderMode == ${Gs.PickingObjectId}) {
  #if defined(USE_INSTANCING_PICKINGCOLOR) || defined(USE_VERTEX_PICKING_COLOR)
  gl_FragColor = vPickingColor;
  #else
  gl_FragColor = pickingColor;
  #endif
  return;
} else if (dcgRenderMode == ${Gs.PickingX}) {
  gl_FragColor = encode_float(vPosition.x);
  return;
} else if (dcgRenderMode == ${Gs.PickingY}) {
  gl_FragColor = encode_float(vPosition.y);
  return;
} else if (dcgRenderMode == ${Gs.PickingZ}) {
  gl_FragColor = encode_float(vPosition.z);
  return;
}
#endif
`,hwe=`  varying vec3 vPosition;
  uniform bool clip_x;
  uniform bool clip_y;
  uniform bool clip_z;
  uniform float xMin;
  uniform float xMax;
  uniform float yMin;
  uniform float yMax;
  uniform float zMin;
  uniform float zMax;
  uniform float zMinForAnimation;
  uniform float zMaxForAnimation;
  uniform int dcgRenderMode;

  ${pY}
`,gwe=`  if (clip_x && (vPosition.x < xMin || vPosition.x > xMax)) {discard;}
  if (clip_y && (vPosition.y < yMin || vPosition.y > yMax)) {discard;}
  if (clip_z && (vPosition.z < zMin || vPosition.z > zMax)) {discard;}
  if ((vPosition.z < zMinForAnimation) || (vPosition.z > zMaxForAnimation)) {discard;}
`,Pm=`  gl_FragColor = LinearTosRGB( gl_FragColor );
`;function KP({variant:r,uvArgs:e,extraMeshArgs:t,restrictionShader:o}){let i;r.type==="colorFunc"?i=`      vec3 color = getColor();
      if (isnan(color.x) || isnan(color.y) || isnan(color.z)) {discard;}
      vec4 diffuseColor = vec4(color.x, color.y, color.z, opacity );`:i="vec4 diffuseColor = vec4( diffuse, opacity );";let n=r.type==="colorFunc"?__dcg_shared_module_exports__['Sc']`vec3 getColor() {
            ${Ate(e,r.colorShader.source)}
            ${Lte(t,r.colorShader.source)}
            ${r.colorShader.source}
            }\n`:"",a=[o].concat(r.type==="colorFunc"?[r.colorShader]:[]),s=__dcg_shared_module_exports__['Tc'](...a.map(D=>D==null?void 0:D.shaderFunctions))+`
`+n+mwe(o,Ate(e,o==null?void 0:o.source),t),c=fwe(o)+Pw+i,d=/\bvUV\b/.test(s)||/\bvUV\b/.test(c),p=[void 0,"float","vec2","vec3"][t.length],u=p&&(/\bvExtras\b/.test(s)||/\bvExtras\b/.test(c)),g=__dcg_shared_module_exports__['Uc'](o==null?void 0:o.shaderUniforms),h=g.uniforms,b=g.declarations,v=`    ${__dcg_shared_module_exports__['Rc']}
    ${b}
    ${d?`varying vec2 vUV;
`:""}
    ${u?`varying ${p} vExtras;
`:""}
    ${Lw}
    ${s}
`,T=(d?`varying vec2 vUV;
`:"")+(u?`attribute ${p} extras;
`:"")+(u?`varying ${p} vExtras;
`:"")+`varying vec3 vPosition;
uniform mat4 dcgModelMatrix;
`,E=`    ${u?"  vExtras = extras; ":""}
    ${d?"  vUV = uv; ":""}
    #ifdef USE_INSTANCING
      vPosition = (instanceMatrix * vec4( position, 1.0 )).xyz;
    #else
      vPosition = (dcgModelMatrix * vec4( position, 1.0 )).xyz;
    #endif
  `,I=r.type==="colorFunc"?"color::"+r.colorCacheKey+"::"+e.join(","):r.type,_=o?"::"+o.source:"",C=I+_;return{fragmentDeclarations:hwe+v,fragmentColorChunk:gwe+c,vertexDeclarations:T,vertexPositionChunk:E,cacheKey:C,glslUniforms:h}}function Ate(r,e){let t=d=>d==="x"||d==="y"||d==="z",o=r[0],i=r[1],n=new RegExp(`\\b${o}\\b`),a=new RegExp(`\\b${i}\\b`),s=o!==void 0&&!t(o)&&e&&n.test(e),c=i!==void 0&&!t(i)&&e&&a.test(e);return(s?[`float ${o} = vUV.x;`]:[]).concat(c?[`float ${i} = vUV.y;`]:[]).join(`
`)}function Lte(r,e){let t=o=>new RegExp(`\\b${o}\\b`).test(e);return["float x = vPosition.x;","float y = vPosition.y;","float z = vPosition.z;"].concat(r.length===1?t(r[0])?`float ${r[0]} = vExtras;`:"":r.map((o,i)=>t(o)?`float ${o} = vExtras.${"xyz"[i]};`:"")).join(`
`)}function mwe(r,e,t){return r?__dcg_shared_module_exports__['Sc']`bool restriction() {
      ${e}
      ${Lte(t,r.source)}
      ${r.source}
      }\n`:""}function fwe(r){return r?"if (!restriction()) {discard;}":""}function Pte(r){let{cacheKey:e,vertexPositionChunk:t,vertexDeclarations:o,fragmentColorChunk:i,fragmentDeclarations:n,glslUniforms:a}=KP(r),s=`
varying vec3 vViewPosition;
varying vec3 vNormal;

${mn.common}
${mn.common_pars_vertex}

${o}

void main() {

	${mn.common_vertex}

	vViewPosition = - mvPosition.xyz;
	vec3 transformedNormal = vec3( normal );

	#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	#else
	mat3 m = mat3( dcgModelMatrix );
	#endif
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;

	transformedNormal = normalMatrix * transformedNormal;

	#ifdef FLIP_SIDED
		transformedNormal = - transformedNormal;
	#endif
	vNormal = normalize( transformedNormal );

  ${t}
}
`,c=`
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
varying vec3 vNormal;

#ifdef IOR
	uniform float ior;
#endif

varying vec3 vViewPosition;

${mn.common}
${mn.common_pars_fragment}
${mn.lights_pars_fragment}

${n}

void main() {

  ${i}

	#if defined( USE_COLOR  ) || defined( USE_INSTANCING_COLOR  )
		diffuseColor.rgb = vColor;
	#endif

	${r.disableLighting.value?"vec4 dcgRawColor = diffuseColor;":""}

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	${mn.common_fragment_begin}
	float roughnessFactor = roughness;
	float metalnessFactor = metalness;
	float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif

	// non perturbed normal for clearcoat among others
	vec3 geometryNormal = normal;

	// accumulation
	${mn.lights_fragment}

	// modulation

	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;

	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;

	${BP}

	${mn.common_fragment_end}

	${r.disableLighting.value?"gl_FragColor.rgb = dcgRawColor.rgb;":""}

	${Pm}

	if (uDepthPeel == 1) {
		// When depth peeling, we render with transparent: false, which causes <opaque_fragment> to set gl_FragColor.a = 1.
		// We need to set it back to the correct value so that it can be respsected in compositing.
		gl_FragColor.a = opacity;
	}
}
`;return{vertex:s,fragment:c,cacheKey:e,glslUniforms:a}}var bwe={...Dm(j5.common),...Dm(j5.lights),roughness:{value:.4},metalness:{value:0},emissive:{value:new At(0)}},Gm=class extends Pc{constructor(t){let{vertex:o,fragment:i,cacheKey:n,glslUniforms:a}=Pte({...t,disableLighting:t.globalUniforms.disableLighting}),s=typeof t.color=="string"&&__dcg_shared_module_exports__['Ed'](t.color)?"#808080":t.color,c={...Dm(bwe),...YP(),...t.graphUniforms,...t.globalUniforms,opacity:{value:t.opacity},diffuse:{value:new At(s)},map:{value:t.map},...a};super({name:"GraphSurfaceMaterial",wireframe:t.wireframe,vertexShader:o,fragmentShader:i,opacity:t.opacity,side:Ca,lights:!0,uniforms:c});this.defines={DCG_SUPPORTS_PICKING:!1};this.vertexColors=t.vertexColors,this.useVertexPickingColors=t.useVertexPickingColors,this.map=t.map,this.defines.DCG_SUPPORTS_PICKING=!0,this.cacheKey=n}setEmissiveIntensity(t){let o=new At(16777215);o.multiplyScalar(t),this.uniforms.emissive.value.copy(o)}customProgramCacheKey(){return this.cacheKey}};function Gte(r){let{cacheKey:e,vertexPositionChunk:t,vertexDeclarations:o,fragmentColorChunk:i,fragmentDeclarations:n,glslUniforms:a}=KP(r),s=`
  ${mn.common}
  ${mn.common_pars_vertex}

  ${o}

void main() {
  ${mn.common_vertex}

  ${t}
}
`,c=`
uniform vec3 diffuse;
uniform float opacity;
varying vec3 vNormal;

${mn.common}
${mn.common_pars_fragment}

${n}

void main() {

  ${i}

  ${mn.common_fragment_begin}
  float specularStrength = 1.0;

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );

	// accumulation (baked indirect lighting only)
	reflectedLight.indirectDiffuse += vec3( 1.0 );

	// modulation

	reflectedLight.indirectDiffuse *= diffuseColor.rgb;

	vec3 outgoingLight = reflectedLight.indirectDiffuse;

  ${mn.common_fragment_end}

	${Pm}
}
`;return{vertex:s,fragment:c,cacheKey:e,glslUniforms:a}}var zP=class extends Pc{constructor(e){let{vertex:t,fragment:o,cacheKey:i,glslUniforms:n}=Gte({extraMeshArgs:[],restrictionShader:void 0,uvArgs:[],variant:{type:"zClip"},disableLighting:e.globalUniforms.disableLighting}),a=typeof e.color=="string"&&__dcg_shared_module_exports__['Ed'](e.color)?"#808080":e.color,s={...YP(),...e.graphUniforms,...e.globalUniforms,roughness:{value:.4},metalness:{value:0},opacity:{value:e.opacity},diffuse:{value:new At(a)},...n};super({name:"LineMaterial",vertexShader:t,fragmentShader:o,opacity:e.opacity,side:Ca,uniforms:s}),this.cacheKey=i}setColor(e){this.uniforms.diffuse.value.copy(e)}setOpacity(e){this.opacity=this.uniforms.opacity.value=e}customProgramCacheKey(){return this.cacheKey}};var{abs:Gw,min:Vte,max:Rte}=Math,Fte=11184810,ywe=3355443,qP="#444444",HP="#bbbbbb",xwe=1e-4;function Nte(r){let e=new At(Fte),t=new At(ywe);return{axisMaterial:Ote(e,r),tickMaterial:Ote(t,r)}}function uY(r,e,t){return new jP(new dy(new Ee(r.xmin,r.ymin,r.zmin),new Ee(r.xmax,r.ymax,r.zmax)),new At(e),t)}function Ute(r,e){let t=r.box;t.min.x=e.xmin,t.max.x=e.xmax,t.min.y=e.ymin,t.max.y=e.ymax,t.min.z=e.zmin,t.max.z=e.zmax,r.updateMatrixWorld()}function hY(r){r.dispose()}var vwe=new M_(JSON.parse(Mte));function Ote(r,e){let t=new Gm({color:r,extraMeshArgs:[],map:void 0,opacity:1,restrictionShader:void 0,uvArgs:[],variant:{type:"zClip"},wireframe:!1,vertexColors:!1,useVertexPickingColors:!1,globalUniforms:e,graphUniforms:{clip_x:{value:!1},clip_y:{value:!1},clip_z:{value:!1}}});return t.customProgramCacheKey=()=>"axis-material",t}function Yte(r,e){let{xmin:t,xmax:o,ymin:i,ymax:n,zmin:a,zmax:s}=r,c=Vte(e.width,e.height),d=.05*(c>360?1:c>120?360/c:4-c/120),p=4,u=p*d/.08,g=__dcg_shared_module_exports__['Rb'](0,t,o),h=__dcg_shared_module_exports__['Rb'](0,i,n),b=__dcg_shared_module_exports__['Rb'](0,a,s),v=o-t,T=n-i,E=s-a,I=4*((g-t)/v-.5),_=4*((h-i)/T-.5),C=4*((b-a)/E-.5),D=s<=0?-4:Vte(4*s/E,4);return{textSize:d,scale:p,delta:u,zLen:D,x:I,y:_,z:C}}var Bte=.02,Qp=7*Bte;function Kte(r,e,t,{axisMaterial:o}){let{xmin:i,xmax:n,ymin:a,ymax:s,zmin:c,zmax:d}=r,p=n-i,u=s-a,g=d-c,h=(n+i)/2,b=(s+a)/2,v=(d+c)/2,T=new si,E=Math.PI,I=Bte,{textSize:_,scale:C,delta:D,zLen:P,x:F,y:N,z:Y}=Yte(r,e);function z(A){return new xi(new Jp(.8*I,.8*I,A,10),o)}function X(){return new xi(new ZL(2*I,Qp,16),o)}function q(A,O,B,V=1){return A.position.set(B[0],B[1],B[2]),A.setRotationFromEuler(yy(O[0],O[1],O[2])),A.scale.set(V,V,V),A.name="axes",T.add(A),A}function S(A,O,B=1){let V=Cwe(A,o);V.translateX(-O[0]*D),V.translateY(-O[1]*D),V.scale.set(B,B,B),V.name="axes";let K=jte(V);K.name=A,T.add(K)}return q(z(4-6*I),[0,0,E/2],[-Qp/2,N,Y]),q(z(4-6*I),[0,0,0],[F,-Qp/2,Y]),q(z(4-6*I),[-E/2,0,0],[F,N,-Qp/2]),q(X(),[0,0,-E/2],[2-Qp/2,N,Y]),q(X(),[0,0,0],[F,2-Qp/2,Y]),q(X(),[E/2,0,0],[F,N,Y+Rte(P,0)-Qp/2]),t&&(S("x",[.027,.03],_*C),S("y",[.025,.02],_*C),S("z",[.025,.03],_*C)),T.scale.set(p/4,u/4,g/4),T.position.set(h,b,v),T}function gY(r){for(let e of r.getObjectsByProperty("name","axes"))e.geometry.dispose()}function zte(r){r.axisMaterial.dispose(),r.tickMaterial.dispose()}function qte({axes:r,plane:e,domain:t,screen:o,controls:i,invertedColors:n,isDepthPeelingActive:a}){let s=i.worldRotation3D,{xmax:c,ymax:d,zmax:p}=t,{scale:u,delta:g,zLen:h,x:b,y:v,z:T}=Yte(t,o);if(r===void 0)return;let E=Math.PI,I=r.getObjectByName("x"),_=r.getObjectByName("y"),C=r.getObjectByName("z"),D=new Ee(1,0,0).applyMatrix3(s),P=new Ee(0,1,0).applyMatrix3(s),F=new Ee(0,0,1).applyMatrix3(s);function N(Te,Ae,je){Te==null||Te.setRotationFromEuler(yy(Ae[0],Ae[1],Ae[2])),Te==null||Te.position.set(je[0],je[1],je[2])}function Y(Te){return Math.acos(__dcg_shared_module_exports__['Rb'](Te,-1,1))}let z=c<=0?-1:1,X=d<=0?-1:1,q=p<=0?-1:1,S=[z*(.5*u+.05*g),v,T],A=[b,X*(.5*u+.05*g),T],O=[b,v,q*(T+Rte(h,0)+.04*g)],B=i.speed3D===0||i.grapher3d.isDragging,V=Gw(i.axis3D[0])>.99,K=Gw(i.axis3D[1])>.99,oe=Gw(i.axis3D[2])>.99,Z=B||V,ee=B||K,ue=B||oe,{isXYsnapped:he,isZsnapped:ae}=i,$=Gw(D.y)>.99&&he&&Z,se=Gw(P.y)>.99&&he&&ee;if(Gw(F.z)<.001&&ae&&ue)N(I,[E,0,E],S),N(_,[E,E,E],A),N(C,[E/2,0,0],O);else{let Te=F.z<0?1:-1,Ae=P.y<0?1:-1,je=-Te*(E/2),te=(P.x*D.y<0?1:-1)*Y(P.z),we=-Te*Y(-Ae*D.z),Ie=$?te:E/2,He=se?we:je,ge=(P.y<0?-1:1)*Y(D.y)+E,nt=Ae*E/2;N(I,[Ie,0,0],S),N(_,[He,0,nt],A),N(C,[je,0,ge],O);let lt=e==null?void 0:e.getObjectByName("z plane");lt==null||lt.setRotationFromEuler(yy(E/2,0,ge))}let Se=new Ee(0,0,1).applyMatrix3(i.worldRotation3D).x;e==null||e.updateZOffsets(Se<0);let Ce;e!=null&&e.xyPlane&&(Ce=e.xyPlane.material,Ce.uniforms.diffuse.value=new At(n?0:16777215)),_we({invertedColors:n,obliqueness:Se,domainPlaneMaterial:Ce,isDepthPeelingActive:a})}var WP=class extends T_{constructor(e,t,o,i,n){super();let{showNumbers3D:a,showPlane3D:s}=o.settings,{xmin:c,xmax:d,ymin:p,ymax:u,zmin:g,zmax:h}=e,[b,v,T]=[d-c,u-p,h-g],E=__dcg_shared_module_exports__['Rb'](0,g,h);this.basePosition=new Ee((d+c)/2,(u+p)/2,E),this.zOffset=xwe*(h-g);let I=new __(b,v);if(this.xyNumbersPlane=new xi(I,t.xyNumbersMaterial),this.xyNumbersPlane.name="xy numbers plane",this.xyPlane=new xi(I,t.xyPlaneMaterial),this.xyPlane.name="xy plane",s){this.add(this.xyPlane);let _=new jP(new dy(new Ee(c,p,E),new Ee(d,u,E)),new At(Fte),n);_.name="xy border",this.add(_)}if(a){this.add(this.xyNumbersPlane),this.add(kwe(o,e,i));let _=new __(4,4),C=new xi(_,t.zMaterial),D=jte(C),[P,F]=[__dcg_shared_module_exports__['Rb'](0,c,d),__dcg_shared_module_exports__['Rb'](0,p,u)];C.setRotationFromEuler(yy(Math.PI/2,0,0)),C.name="z plane",D.scale.set(b/4,v/4,T/4),D.position.set(P,F,(h+g)/2),wwe(t.zCanvas,o,e),t.zMaterial.uniforms.map.value.needsUpdate=!0,this.add(D)}}updateZOffsets(e){var a,s;let{x:t,y:o,z:i}=this.basePosition,n=e?this.zOffset:-this.zOffset;this.xyPlane&&((a=this.xyPlane)==null||a.position.set(t,o,i-n),this.xyPlane.renderOrder=0),this.xyNumbersPlane&&((s=this.xyNumbersPlane)==null||s.position.set(t,o,i+2*n),this.xyNumbersPlane.renderOrder=2)}};function wwe(r,e,t){let o=r.getContext("2d");if(o===null)return;let i=Hte(e,t),n=e.settings.labelSize,{xmin:a,xmax:s,zmin:c,zmax:d}=t,p=[];for(let _ of i){let C=__dcg_shared_module_exports__['nb'](_,d-c);p.push(new Xa(C,n))}o.save(),o.scale(window.devicePixelRatio,window.devicePixelRatio),o.clearRect(0,0,e.screen.width,e.screen.height),o.fillStyle=`rgba(${e.settings.config.invertedColors?"0,0,0":"255,255,255"},0.001961)`,o.fillRect(0,0,e.screen.width,e.screen.height),o.lineWidth=1.5,o.miterLimit=2,o.strokeStyle=e.settings.getBackgroundColor({invertWhite:!0});let u=5,g=e.settings.getTextColor({invertBlack:!0}),h=e.screen.width,b=e.screen.height,v={left:3,top:3,right:h-3,bottom:b-3},T=new Or(a,s,c,d,c,d),E=new pl(e.screen,T,e.settings),I=r.width/window.devicePixelRatio/2;for(let _ of p){let C={x:I-u-_.getRect().right,y:E.mapy(_.getValue())},D=_.clampBoundsWithinRect(C,v);o.fillStyle=g,_.drawCenteredAt(o,D,"")}o.restore()}function Hte(r,e){let{zmin:t,zmax:o}=e,i={...r.viewport,ymin:t,ymax:o},n={...r,viewport:i},{majorStepY:a}=zl(n),s=Ls(t,o,a);return o>0&&(s=s.filter(c=>c!=0)),s}function Swe(r,e){let{zmin:t,zmax:o}=e;return Hte(r,e).filter(n=>n<=o-Qp/4*(o-t))}function kwe(r,e,{tickMaterial:t}){let{xmin:o,xmax:i,ymin:n,ymax:a,zmin:s,zmax:c}=e,d=__dcg_shared_module_exports__['Rb'](0,o,i),p=__dcg_shared_module_exports__['Rb'](0,n,a),u=__dcg_shared_module_exports__['Rb'](0,s,c),g=Math.PI,h=.004,b=h*(i-o),v=h*(a-n),T=h*(c-s),E=new T_,I=.4;for(let D of Swe(r,e)){let P=new Jp,F=new xi(P,t);F.position.set(d,p,D),F.scale.set(b,I*T,v),F.setRotationFromEuler(yy(g/2,0,0)),F.name="ticks",E.add(F)}let{majorStepX:_,majorStepY:C}=zl(r);for(let D of Ls(o,i,_)){if(D>i-Qp/4*(i-o))continue;let P=new Jp,F=new xi(P,t);F.position.set(D,p,u),F.scale.set(v,I*b,T),F.setRotationFromEuler(yy(0,0,g/2)),F.name="ticks",E.add(F)}for(let D of Ls(n,a,C)){if(D>a-Qp/4*(a-n))continue;let P=new Jp,F=new xi(P,t);F.position.set(d,D,u),F.scale.set(T,I*v,b),F.setRotationFromEuler(yy(0,g/2,0)),F.name="ticks",E.add(F)}return E}function _we({obliqueness:r,domainPlaneMaterial:e,invertedColors:t}){if(!e)return;e.uniforms.obliqueness.value=Math.abs(r);let o=t?__dcg_shared_module_exports__['ud'](qP):qP,i=t?__dcg_shared_module_exports__['ud'](HP):HP;e.setGridColors({major:o,minor:i})}function Wte(r){var o,i,n,a;let e=s=>r.getObjectByName(s);(o=e("xy numbers plane"))==null||o.geometry.dispose(),(i=e("xy plane"))==null||i.geometry.dispose(),(n=e("z plane"))==null||n.geometry.dispose(),(a=e("xy border"))==null||a.dispose();let t=r.getObjectsByProperty("name","ticks");for(let s of t)s.geometry.dispose()}function mY(r){r.uniforms.map.value.dispose(),r.dispose()}function jte(r){let e=new si;return e.add(r),e}function Cwe(r,e){let t=new I_(r,{font:vwe,size:1,height:.02,curveSegments:12,bevelEnabled:!0,bevelThickness:.04,bevelSize:.04,bevelOffset:0,bevelSegments:5});return new xi(t,e)}var yy=(r,e,t)=>new ul(r,e,t,"ZYX"),jP=class extends rP{constructor(t,o,i){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new es;s.setIndex(new Ta(n,1)),s.setAttribute("position",new No(a,3));super(s,new zP({color:o,opacity:1,graphUniforms:{clip_x:{value:!1},clip_y:{value:!1},clip_z:{value:!1}},globalUniforms:i}));this.type="Box3Helper";this.box=t,this.geometry.computeBoundingSphere()}updateMatrixWorld(t){let o=this.box;o.isEmpty()||(o.getCenter(this.position),o.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}};var xy=class extends Pc{constructor(e,t){super({name:"DomainPlaneMaterial",side:Ca,transparent:e.transparent,vertexShader:`
        varying vec3 vPosition;
        void main() {
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
          vPosition = position;
        }
      `,fragmentShader:`
        uniform mat4 projectionMatrix;
        uniform mat4 modelViewMatrix;

        varying vec3 vPosition;
        uniform int dcgRenderMode;
        uniform vec2 uScreenSize;
        uniform float xMin;
        uniform float xMax;
        uniform float yMin;
        uniform float yMax;

        uniform vec3 diffuse;
        uniform float opacity;

        uniform float xMinorStep;
        uniform float yMinorStep;
        uniform float xMajorStep;
        uniform float yMajorStep;
        uniform vec3 majorGridColor;
        uniform vec3 minorGridColor;
        uniform float obliqueness;

        ${Lw}
        ${pY}

        float getNearestStep(float t, float step) {
          float prev = step * floor(t / step);
          float next = prev + step;
          return abs(t - prev) < abs(t - next) ? prev : next;
        }

        vec2 projectToScreen(vec3 p) {
          vec4 pNDC = projectionMatrix * modelViewMatrix * vec4(p, 1.0);
          pNDC /= pNDC.w;
          return 0.5 * (pNDC.xy + 1.0) * uScreenSize;
        }

        bool isMajorStep(float s, float minorStep, float majorStep) {
          return mod(s, majorStep) < minorStep * 0.125;
        }

        void main() {
          ${Pw}
          ${BP}
          // the xyPlane geometry is shifted in domain3d-objects to reduce cancellation error
          float x0 = (xMin + xMax) / 2.;
          float y0 = (yMin + yMax) / 2.;
          float xNearest = getNearestStep(vPosition.x + x0, xMinorStep);
          float yNearest = getNearestStep(vPosition.y + y0, yMinorStep);
          bool xIsMajor = isMajorStep(xNearest, xMinorStep, xMajorStep);
          bool yIsMajor = isMajorStep(yNearest, yMinorStep, yMajorStep);
          vec2 xNearestScreen = projectToScreen(vec3(xNearest - x0, vPosition.y, vPosition.z));
          vec2 yNearestScreen = projectToScreen(vec3(vPosition.x, yNearest - y0, vPosition.z));
          float xDist = distance(gl_FragCoord.xy, xNearestScreen);
          float yDist = distance(gl_FragCoord.xy, yNearestScreen);
          float minDist = xDist < yDist ? xDist : yDist;
          bool isMajor = xDist < yDist ? xIsMajor : yIsMajor;

          vec4 grid = vec4(0.0);
          float baseWidth = 0.0;
          float feather = 2.0;
          if (obliqueness < FADE_THRESHOLD) {
            baseWidth = 3.0 * (1.0 - obliqueness / FADE_THRESHOLD);
            feather = 2.0 * obliqueness / FADE_THRESHOLD;
          }
          if (minDist <= baseWidth + feather) {
            vec3 gridColor = isMajor ? majorGridColor : minorGridColor;
            // We want integral of blurFactor to be 1.0 over the whole region
            //
            //   baseWidth
            //   --------------
            //   |            |            //   |            |             // h |            |              //   |            |               //   |            |                //   -------------|-----
            //               feather (2.0)
            // h * baseWidth + h * feather / 2 = 1
            // h = 1 / (baseWidth + feather / 2)
            float h = 1.0 / (baseWidth + feather / 2.0);
            float blurFactor = h - max(0.0, (minDist - baseWidth)) / feather;
            grid = vec4(gridColor, blurFactor);
          }

          // Composite the grid color ("grid") onto the domain plane color (diffuse, opacity)
          float composedAlpha = mix(opacity, grid.a, grid.a);
          vec3 composedColor = mix(diffuse*opacity, grid.rgb*grid.a, grid.a) / composedAlpha;
          gl_FragColor = vec4(composedColor, composedAlpha);

          ${Pm}
        }
      `,defines:{DCG_SUPPORTS_PICKING:!0,FADE_THRESHOLD:.4},uniforms:{opacity:{value:e.opacity},diffuse:{value:e.color},majorGridColor:{value:new At(qP)},minorGridColor:{value:new At(HP)},obliqueness:{value:1},...t}})}setGridColors({major:e,minor:t}){this.uniforms.majorGridColor.value=new At(e),this.uniforms.minorGridColor.value=new At(t)}};var vy=class extends Pc{constructor(e,t){let o=new IP(e.canvas);super({name:"DomainPlaneNumbersMaterial",side:Ca,transparent:e.transparent,vertexShader:`
        varying vec2 vUv;

        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
      `,fragmentShader:`

        uniform sampler2D map;
        uniform float opacity;
        varying vec2 vUv;
        uniform int dcgRenderMode;

        ${Lw}

        uniform float alphaTest;

        void main() {
          ${Pw}

          vec4 sampleColor = texture2D( map, vUv );

          // When we're only showing numbers, we clear the canvas with a low alpha and discard it here.
          if ( sampleColor.a < alphaTest ) {
            discard;
          }

          #ifdef OPAQUE
          if (uDepthPeel == 0) {
            sampleColor.a = 1.0;
          }
          #endif

          gl_FragColor = sampleColor;

          ${Pm}
        }
      `,uniforms:{map:{value:o},alphaTest:{value:.1},...t}}),this.canvas=e.canvas,this.texture=o}dispose(){super.dispose(),this.texture.dispose()}};var Twe={name:"DepthPeelLayerAddJittersShader",uniforms:{uCompositeType:{value:0},uTextureA:{value:null},uTextureB:{value:null},weight:{value:1}},defines:{},vertexShader:`
    varying vec2 vUv;
    void main(){
      vUv = uv;
      gl_Position = vec4(position.xy,0.,1.);
    }
  `,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D uTextureA;
    uniform sampler2D uTextureB;
    uniform int uCompositeType;
    uniform float weight;
    void main() {
      vec4 src = texture2D(uTextureA,vUv);
      src.a *= weight;
      vec4 dst = uCompositeType == 1 ? texture2D(uTextureB,vUv) : vec4(0.0);
      // Convert src, dst to premultiplied, and do the addition in premultiplied space.
      // We don't want to store the buffers premultiplied since that loses dynamic range.
      src.rgb *= src.a;
      dst.rgb *= dst.a;
      gl_FragColor = src + dst;
      // Convert output back to non-premultiplied
      // Don't need to check for division by zero, since it gets converted to a buffer 0-255 (an integer, not NaN),
      // which we will then multiply by 0 (the alpha).
      gl_FragColor.rgb /= gl_FragColor.a;
    }
  `},XP=class{constructor(){this.shaderPass=new Wl(Twe,{depthTest:!1,depthWrite:!1,transparent:!1},"uTextureA")}dispose(){this.shaderPass.dispose()}addInPremultiplied(e,t,o,i,n){this.shaderPass.uniforms.weight.value=i,n instanceof At?(this.shaderPass.uniforms.uCompositeType.value=0,this.shaderPass.uniforms.uTextureB.value=null):(this.shaderPass.uniforms.uTextureB.value=n.texture,this.shaderPass.uniforms.uCompositeType.value=1),this.shaderPass.renderFromTexture(e,t,o.texture)}};var Ewe={name:"DepthPeelLayerCompositeShader",uniforms:{uTopTexture:{value:null},uBottomTexture:{value:null},uBackgroundColor:{value:new At(0)},uCompositeType:{value:0}},defines:{},vertexShader:`
    varying vec2 vUv;
    void main(){
      vUv = uv;
      gl_Position = vec4(position.xy,0.,1.);
    }
  `,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D uTopTexture;
    uniform sampler2D uBottomTexture;
    uniform vec3 uBackgroundColor;
    uniform int uCompositeType;
    void main() {
      vec4 top = texture2D(uTopTexture,vUv);
      vec4 bot = uCompositeType == 1 ? texture2D(uBottomTexture,vUv) : vec4(uBackgroundColor, 1.0);
      // Convert top, bot to premultiplied, and do the addition in premultiplied space.
      // We don't want to store the buffers premultiplied since that loses dynamic range.
      top.rgb *= top.a;
      bot.rgb *= bot.a;
      gl_FragColor = top + bot * (1. - top.a);
      // Convert output back to non-premultiplied
      gl_FragColor.rgb /= gl_FragColor.a;
    }
  `},$P=class{constructor(){this.shaderPass=new Wl(Ewe,{depthTest:!1,depthWrite:!1,transparent:!1},"uTopTexture")}dispose(){this.shaderPass.dispose()}composite(e,t,o,i){i instanceof At?(this.shaderPass.uniforms.uCompositeType.value=0,this.shaderPass.uniforms.uBackgroundColor.value=i,this.shaderPass.uniforms.uBottomTexture.value=null):(this.shaderPass.uniforms.uCompositeType.value=1,this.shaderPass.uniforms.uBackgroundColor.value=new At(0),this.shaderPass.uniforms.uBottomTexture.value=i.texture),this.shaderPass.renderFromTexture(e,t,o.texture)}};var G_=4,Iwe={name:"MaxWindow",uniforms:{tDiffuse:{value:null},sourcePixelSize:{value:new Ft(1,1)},destPixelSize:{value:new Ft(1,1)}},defines:{},vertexShader:`
  varying vec2 vUv;

  void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
  }`,fragmentShader:`
  uniform float weight;
  uniform sampler2D tDiffuse;
  uniform vec2 sourcePixelSize;
  uniform vec2 destPixelSize;
  varying vec2 vUv;

  void main() {
    vec2 demi = vec2(0.5,0.5);
    vec2 xy = destPixelSize * vUv - demi;
    vec4 maxAccum = vec4(0.);
    for (float i=0.; i < ${G_}.0; i+=1.) {
      for (float j=0.; j < ${G_}.0; j+=1.) {
        vec2 xySample = min(
          xy * ${G_}.0 + vec2(i,j) + demi,
          sourcePixelSize
        );
        vec2 uvSample = xySample / sourcePixelSize;
        vec4 val = texture2D(tDiffuse, uvSample);
        maxAccum = max(maxAccum, val);
      }
    }
    gl_FragColor = maxAccum;
  }`},fY=class{constructor(){this.shaderPass=new Wl(Iwe,{depthTest:!1,depthWrite:!1,transparent:!0})}dispose(){this.shaderPass.dispose()}render(e,t,o){this.shaderPass.uniforms.sourcePixelSize={value:new Ft(o.width,o.height)},this.shaderPass.uniforms.destPixelSize={value:new Ft(t.width,t.height)},e.setRenderTarget(t),e.setClearColor(new At(0),0),e.clear(),this.shaderPass.render(e,t,o)}},JP=class{constructor(e,t){this.targetType=t;this.maxPass=new fY;this.maxMipmapTargets=[];let o=e.x,i=e.y;for(let n=0;o=Math.ceil(o/G_),i=Math.ceil(i/G_),o>1||i>1;n++)this.maxMipmapTargets[n]=this.createTarget(o,i)}dispose(){for(let e of this.maxMipmapTargets)e.dispose();this.maxPass.dispose()}createTarget(e,t){return new os(e,t,{minFilter:ql,magFilter:ql,type:this.targetType,colorSpace:Qa})}renderMax(e,t,o,i,n,a){var s;for(let c=0;c<=this.maxMipmapTargets.length;c++){let d=c===0?o:this.maxMipmapTargets[c-1],p=c<this.maxMipmapTargets.length?this.maxMipmapTargets[c]:t;this.maxPass.render(e,p,d)}for(let c=0;c<this.maxMipmapTargets.length;c++){let d=this.maxMipmapTargets[c];(s=i.get(`max-mm-p${n}-${c}`,`${d.width}x${d.height}`))==null||s.renderFromTarget(e,d,a*Math.min(o.width/d.width,o.height/d.height))}}};var ZP=class{constructor(e,t,o,i,n,a){this.controller=e;this.renderer=t;this.materialManager=o;this.scene=i;this.camera=n;this.debug=a;this.triangles=0;this.pixelRatio=t.getPixelRatio();let s=t.getSize(new Ft).multiplyScalar(this.pixelRatio);this.size=s,this.init()}init(){this.samples=1;let e=this.controller.getGraphSettings().config.peelUpsample;e?this.samples=e:this.pixelRatio<1.5?this.samples=3:this.pixelRatio<2.5?this.samples=2:this.samples=1;let t=this.controller.getGraphSettings().config.peelFloatTexture?Ite()[0]:Gn,o=()=>new os(this.size.x,this.size.y,{minFilter:ql,magFilter:ql,type:t,colorSpace:Qa});this.peelSampleTargets=[],this.peelResultTarget=o(),this.secondPeelResultTarget=o(),this.compositingTargets=[o(),o()],this.maxPass=new JP(this.size,t),this.finalMipmapTargets=[this.maxPass.createTarget(1,1),this.maxPass.createTarget(1,1)],this.opaqueBackgroundTargets=[];for(let n=0;n<this.samples;n++){let a=o();a.depthTexture=new my(this.size.x,this.size.y),this.opaqueBackgroundTargets.push(a)}this.combinedOpaqueBackgroundTarget=o();let i=2*this.samples;for(let n=0;n<i;n++){let a=o();a.depthTexture=new my(this.size.x,this.size.y),this.peelSampleTargets.push(a)}this.compositePass=new $P,this.addPremultipliedPass=new XP,this.materialManager.setScreenSize(this.size.x,this.size.y)}dispose(){this.peelSampleTargets.forEach(e=>e.dispose()),this.compositingTargets.forEach(e=>e.dispose()),this.peelResultTarget.dispose(),this.compositePass.dispose(),this.addPremultipliedPass.dispose(),this.maxPass.dispose()}getDebugScale(){return this.controller.getGraphSettings().config.debugScale}render(e){var v;let t=this.renderer,o=t.getPixelRatio(),i=t.getSize(new Ft).multiplyScalar(o);(o!==this.pixelRatio||this.size.x!==i.x||this.size.y!==i.y)&&(this.size.copy(i),this.dispose(),this.init());let n=t.getClearColor(new At),a=t.autoClear;t.autoClear=!1,t.setClearColor(new At(0),1),t.clear(),this.materialManager.setGlobalUniform("dcgRenderMode",Gs.Default);let s=Mwe(this.scene);Awe(this.scene),this.renderOpaqueBackground(),Jte(this.scene,s),this.materialManager.setGlobalUniform("uDepthPeel",1),this.materialManager.setGlobalUniform("uDepthPeelLayer",0),this.materialManager.setGlobalUniform("uPrevDepthTexture",null);let c,d=this.peelSampleTargets.slice(0,this.samples),p=this.peelSampleTargets.slice(this.samples,2*this.samples),u=this.compositingTargets[0],g=this.compositingTargets[1];Lwe(this.scene);let h=[];this.renderTransparentLayer(d,void 0,0,u),e===1&&h.push(this.queryNonemptyPixels(0,u,this.finalMipmapTargets[0])),c=u;for(let T=0;T<e;T++){let E=T+1;this.renderTransparentLayer(p,d,E,this.peelResultTarget),this.compositePass.composite(this.renderer,g,u,this.peelResultTarget),(v=this.debug.get(`peel-c${E}`))==null||v.renderFromTarget(this.renderer,g,this.getDebugScale()),T>=e-2&&h.push(this.queryNonemptyPixels(E,this.peelResultTarget,this.finalMipmapTargets[T===e-2?0:1])),c=g,[p,d]=[d,p],[g,u]=[u,g]}let b=this.renderer.info.render.frame;Promise.all(h).then(T=>{if(T.length!==2)throw new Error(`Programming error: expected 2 nonempty pixel query results, got ${T.length}`);let E=T[0][3]>0,_=T[1][3]>0?1:E?2:0;this.controller.setAdaptiveDepthPeelingInfo({frame:b,peelLayers:e,status:_})}),Jte(this.scene,s),this.compositePass.composite(this.renderer,null,c,this.combinedOpaqueBackgroundTarget),t.setClearColor(n),t.autoClear=a,this.materialManager.setGlobalUniform("uPrevDepthTexture",null),this.materialManager.setGlobalUniform("uDepthPeel",0)}renderOpaqueBackground(){this.materialManager.setGlobalUniform("uDepthPeel",0),this.materialManager.setGlobalUniform("uOpaqueDepthTexture",null);let e=this.combinedOpaqueBackgroundTarget,t=this.secondPeelResultTarget;this.samples%2===0&&([t,e]=[e,t]);for(let o=0;o<this.samples;o++){let i=this.opaqueBackgroundTargets[o];this.renderer.setRenderTarget(i),this.setJitterOffset(o),this.renderer.setClearColor(new At(0),0),this.renderer.clear(),this.renderer.render(this.scene,this.camera),this.addPremultipliedPass.addInPremultiplied(this.renderer,e,i,Xte(this.samples,o),o===0?new At(0):t),[e,t]=[t,e]}this.camera.clearViewOffset()}renderTransparentLayer(e,t,o,i){var a,s;let n=this.secondPeelResultTarget;e.length%2===0&&([n,i]=[i,n]);for(let c=0;c<e.length;c++){let d=e[c];this.materialManager.setGlobalUniform("uOpaqueDepthTexture",this.opaqueBackgroundTargets[c].depthTexture),t&&this.materialManager.setGlobalUniform("uPrevDepthTexture",t[c].depthTexture),this.setJitterOffset(c),this.materialManager.setGlobalUniform("uDepthPeelLayer",o),this.materialManager.setGlobalUniform("dcgRenderMode",Gs.Default),this.renderer.setClearColor(new At(0),0),this.renderer.setRenderTarget(d),this.renderer.clear(!0,!0);let p=this.scene.background;this.scene.background=null,this.renderer.render(this.scene,this.camera),this.scene.background=p,this.triangles=this.renderer.info.render.triangles,(a=this.debug.get(`peel-p${o}-s${c}`))==null||a.renderFromTarget(this.renderer,d,this.getDebugScale()),this.addPremultipliedPass.addInPremultiplied(this.renderer,i,d,Xte(this.samples,c),c===0?new At(0):n),(s=this.debug.get(`peel-p${o}-s${c}-combined`))==null||s.renderFromTarget(this.renderer,i,this.getDebugScale()),[i,n]=[n,i]}this.camera.clearViewOffset()}setJitterOffset(e){if(!$te[this.samples])throw new Error(`Unsupported sample count: ${this.samples}`);let t=$te[this.samples];this.camera.setViewOffset(this.size.x,this.size.y,t[e][0]*.0625,t[e][1]*.0625,this.size.x,this.size.y)}queryNonemptyPixels(e,t,o){var s,c;(s=this.debug.get(`max-mm-p${e}-start`))==null||s.renderFromTarget(this.renderer,t,this.getDebugScale()),this.maxPass.renderMax(this.renderer,o,t,this.debug,e,this.getDebugScale());let i=this.renderer.getContext(),n=new Uint8Array(4*o.width*o.height),a=Ete(i,0,0,o.width,o.height,i.RGBA,i.UNSIGNED_BYTE,n).then(()=>[...n]);return(c=this.debug.get(`max-mm-p${e}-end`,`${o.width}x${o.height}`))==null||c.renderFromTarget(this.renderer,o,this.getDebugScale()*Math.min(t.width/o.width,t.height/o.height)),a}};function Xte(r,e){let t=1/r,o=1/32,i=-.5+(e+.5)/r;return t+o*i}var $te={1:[[0,0]],2:[[4,4],[-4,-4]],3:[[3.323,3.323],[-4.54,1.216],[1.216,-4.54]],4:[[-2,-6],[6,-2],[-6,2],[2,6]]};function Mwe(r){let e=new Map;return r.traverse(t=>{e.set(t,t.visible)}),e}function Jte(r,e){r.traverse(t=>{t.visible=e.get(t)})}var Dwe=.999;function Awe(r){r.traverse(e=>{Zte(e)==="transparent"&&(e.visible=!1)})}function Lwe(r){r.traverse(e=>{Zte(e)==="opaque"&&(e.visible=!1)})}function Zte(r){let e=r.material;if(e)return e instanceof xy||e instanceof vy||e.opacity<Dwe?"transparent":"opaque"}var QP=class{constructor(){this.materialCache={};this.globalUniforms={dcgRenderMode:Gs.Default,xMin:0,xMax:0,yMin:0,yMax:0,zMin:0,zMax:0,xMajorStep:0,xMinorStep:0,yMajorStep:0,yMinorStep:0,uDepthPeel:0,uDepthPeelLayer:0,uOpaqueDepthTexture:null,uPrevDepthTexture:null,uScreenSize:new Ft(1,1),uInverseScreenSize:new Ft(1,1),uDepthOffset:1e-6,disableLighting:!0}}setGlobalUniform(e,t){this.globalUniforms[e]=t}disposeAllMaterials(){this.disposeMaterialsNotInScene(new Rh)}disposeMaterialsNotInScene(e){var o;let t={};e.traverse(i=>{if("material"in i){let n=i.material,a;Array.isArray(i.material)?a=n:a=[n],a.forEach(s=>{ere(s)&&(t[s.dcgMaterialCacheKey]=!0)})}});for(let i in this.materialCache)if(!t[i]){let n=this.materialCache[i];n.dispose(),(o=n.map)==null||o.dispose(),delete this.materialCache[i]}}getOrMakeMaterial(e){let t=Pwe(e.spec),o=this.materialCache[t];if(o)switch(e.type){case"surface-graph":Qte(o.uniforms,e.uniforms);break;case"domain-plane":break;default:throw new Error(`Unexpected type ${e.type}`)}else{switch(e.type){case"surface-graph":o=this._buildSurfaceMaterial(e.spec,e.uniforms);break;case"domain-plane":o=this.buildDomainPlaneMaterial(e.spec);break;default:throw new Error(`Unexpected type ${e.type}`)}this.materialCache[t]=o,o.dcgMaterialCacheKey=t}return o}setScreenSize(e,t){this.globalUniforms.uScreenSize.set(e,t),this.globalUniforms.uInverseScreenSize.set(1/e,1/t)}setDomain(e,t){let{xmin:o,xmax:i,ymin:n,ymax:a,zmin:s,zmax:c}=e,d=1e-5,p=(i-o)*d,u=(a-n)*d,g=(c-s)*d;this.globalUniforms.xMin=o-p,this.globalUniforms.xMax=i+p,this.globalUniforms.yMin=n-u,this.globalUniforms.yMax=a+u,this.globalUniforms.zMin=s-g,this.globalUniforms.zMax=c+g;let h=zl(t);this.globalUniforms.xMinorStep=h.minorStepX,this.globalUniforms.xMajorStep=h.majorStepX,this.globalUniforms.yMinorStep=h.minorStepY,this.globalUniforms.yMajorStep=h.majorStepY}setDisableLighting(e){this.globalUniforms.disableLighting=e}setZBoundsUniform(e,t){if(!ere(e))throw new Error("Cannot update zBoundsForAnimation on a material that is not managed by MaterialManager");e instanceof xy||e instanceof vy||tre(e.uniforms,t)}_buildSurfaceMaterial(e,t){var p,u;let o=e.color,i=(p=e.uvArgs)!=null?p:[],n=(u=e.extraMeshArgs)!=null?u:[],a=e.restrictionShader,s=o.startsWith("wireframe:");s&&(o=o.slice(10));let c=this.getVariant(o,e.colorShader),d=new Gm({color:__dcg_shared_module_exports__['Ed'](o)?"#808080":o,wireframe:s,opacity:e.opacity,extraMeshArgs:n,map:void 0,variant:c,vertexColors:e.vertexColors||!1,useVertexPickingColors:e.useVertexPickingColors||!1,restrictionShader:a,uvArgs:i,globalUniforms:this.getGlobalUniforms()});return Qte(d.uniforms,t),d}buildDomainPlaneMaterial(e){let t;return e.type==="domain-plane-numbers-material"?t=new vy(e,this.getGlobalUniforms()):t=new xy(e,this.getGlobalUniforms()),this.setupGlobalUniforms(t.uniforms),t}getVariant(e,t){return e.startsWith("shader:")?!t||!t.source?{type:"zClip"}:{type:"colorFunc",colorShader:t,colorCacheKey:JSON.stringify(t)}:{type:"zClip"}}getGlobalUniforms(){let e={};return this.setupGlobalUniforms(e),e}setupGlobalUniforms(e){let t=this;for(let o in this.globalUniforms){let i=o;e[i]={get value(){return t.globalUniforms[i]}}}}};function Qte(r,e){let{clip:t,zBoundsForAnimation:o}=e;tre(r,o),r.clip_x={value:t.x},r.clip_y={value:t.y},r.clip_z={value:t.z},r.NaN={value:NaN},r.Infinity={value:1/0}}function tre(r,e){r.zMinForAnimation={value:e.zMinForAnimation},r.zMaxForAnimation={value:e.zMaxForAnimation}}function Pwe(r){return r.type==="domain-plane-numbers-material"?(r.canvas.hasAttribute("dcg-material-manager-id")||r.canvas.setAttribute("dcg-material-manager-id",Math.random()+""),JSON.stringify({...r,canvas:r.canvas.getAttribute("dcg-material-manager-id")})):JSON.stringify(r)}function ere(r){return"dcgMaterialCacheKey"in r}function rre(r,e,t){var O,B,V;let o=__dcg_shared_module_exports__['Rb'](Math.floor(8+30*e),8,20),{xmin:i,xmax:n,ymin:a,ymax:s,zmin:c,zmax:d}=t,p=(n-i)/2,u=(s-a)/2,g=(d-c)/2,h=30,b={xmin:i-h*p,xmax:n+h*p,ymin:a-h*u,ymax:s+h*u,zmin:c-h*g,zmax:d+h*g};function v(K,oe,Z){return b.xmin<=K&&K<=b.xmax&&b.ymin<=oe&&oe<=b.ymax&&b.zmin<=Z&&Z<=b.zmax}for(let K=0;K<r.length/3;K++){let oe=r[3*K+0],Z=r[3*K+1],ee=r[3*K+2];if(v(oe,Z,ee)||!X(K))continue;let he=K===r.length/3-1||!X(K+1)?K-1:K+1;if(!X(he))continue;let ae=r[3*he+0]-oe,$=r[3*he+1]-Z,se=r[3*he+2]-ee,J=Gwe(b,oe,Z,ee,ae,$,se);r[3*K+0]=(O=J==null?void 0:J.x)!=null?O:NaN,r[3*K+1]=(B=J==null?void 0:J.y)!=null?B:NaN,r[3*K+2]=(V=J==null?void 0:J.z)!=null?V:NaN}for(let K=0;K<r.length/3-1;K++)if(X(K)&&X(K+1)){r=r.slice(3*K);break}if(!(X(0)&&X(1)))return[[],[],[]];let E=r.length/3-1,I=new Ee,_=new Ee,C=[],D=[],P=[],F=A();for(let K=0;K<=E;K++)N(K);return Y(),[C,D,P];function N(K){_.x=r[3*K+0],_.y=r[3*K+1],_.z=r[3*K+2];let oe=F.normals[K],Z=F.binormals[K];if(S(K))for(let ee=0;ee<=o;ee++){let ue=ee/o*Math.PI*2,he=Math.sin(ue),ae=-Math.cos(ue);I.x=p*e*(ae*oe.x+he*Z.x),I.y=u*e*(ae*oe.y+he*Z.y),I.z=g*e*(ae*oe.z+he*Z.z),C.push(_.x+I.x,_.y+I.y,_.z+I.z),I.normalize(),D.push(I.x,I.y,I.z)}else for(let ee=0;ee<=o;ee++)C.push(0,0,0),D.push(0,0,0)}function Y(){for(let K=1;K<=E;K++)if(S(K-1)&&S(K))for(let oe=1;oe<=o;oe++){let Z=(o+1)*(K-1)+(oe-1),ee=(o+1)*K+(oe-1),ue=(o+1)*K+oe,he=(o+1)*(K-1)+oe;P.push(Z,ee,he,ee,ue,he)}}function z(K){return new Ee(r[3*K+0],r[3*K+1],r[3*K+2])}function X(K){return isFinite(Math.fround(r[3*K+0]))&&isFinite(Math.fround(r[3*K+1]))&&isFinite(Math.fround(r[3*K+2]))}function q(K){return isFinite(K.x)&&isFinite(K.y)&&isFinite(K.z)}function S(K){return X(K)&&q(F.normals[K])&&q(F.binormals[K])}function A(){let K=new Ee,oe=[],Z=[],ee=[],ue=new Ee,he=new $t;for(let ae=0;ae<=E;ae++){let[$,se]=ae<E?[ae+1,ae]:[ae,ae-1],J=z($).sub(z(se)).normalize();q(J)?oe[ae]=J:ae>0&&(oe[ae]=oe[ae-1])}for(let ae=0;ae<=E;ae++)if(ae===0||!X(ae-1)){Z[ae]=new Ee,ee[ae]=new Ee;let $=Number.MAX_VALUE,se=Math.abs(oe[ae].x),J=Math.abs(oe[ae].y),ye=Math.abs(oe[ae].z);se<=$&&($=se,K.set(1,0,0)),J<=$&&($=J,K.set(0,1,0)),ye<=$&&K.set(0,0,1),ue.crossVectors(oe[ae],K).normalize(),Z[ae].crossVectors(oe[ae],ue),ee[ae].crossVectors(oe[ae],Z[ae])}else{if(Z[ae]=Z[ae-1].clone(),ee[ae]=ee[ae-1].clone(),ue.crossVectors(oe[ae-1],oe[ae]),ue.length()>Number.EPSILON){ue.normalize();let se=Math.acos(__dcg_shared_module_exports__['Rb'](oe[ae-1].dot(oe[ae]),-1,1));Z[ae].applyMatrix4(he.makeRotationAxis(ue,se))}let $=ae>0&&oe[ae-1].dot(oe[ae])>-.999999*oe[ae-1].length()*oe[ae].length()?oe[ae].clone().add(oe[ae-1]).normalize():oe[ae];ee[ae].crossVectors($,Z[ae]).normalize()}return{normals:Z,binormals:ee}}}function Gwe(r,e,t,o,i,n,a){let s,c,d,p,u,g,h=1/i,b=1/n,v=1/a;if(h>=0?(s=(r.xmin-e)*h,c=(r.xmax-e)*h):(s=(r.xmax-e)*h,c=(r.xmin-e)*h),b>=0?(d=(r.ymin-t)*b,p=(r.ymax-t)*b):(d=(r.ymax-t)*b,p=(r.ymin-t)*b),s===c||d===p||s>p||d>c||((d>s||isNaN(s))&&(s=d),(p<c||isNaN(c))&&(c=p),v>=0?(u=(r.zmin-o)*v,g=(r.zmax-o)*v):(u=(r.zmax-o)*v,g=(r.zmin-o)*v),u===g)||s>g||u>c||((u>s||s!==s)&&(s=u),(g<c||c!==c)&&(c=g),c<0))return;let T=s>=0?s:c;return{x:e+T*i,y:t+T*n,z:o+T*a}}En();var ore=new Set;ore.add("(0,0,0,0)");var eG=class{constructor(){this.pickingColorToData=new Map;this.idToPickingColor=new Map;this.testingLastHashCollisionCount=0}setPickingColorForMesh(e){let{mesh:t,branchId:o}=e;if(t instanceof vi)for(let i=0;i<t.count;i++){let n=o+":"+i,a=this._getOrCreatePickingColor({mesh:t,index:i,isPoint:e.isPoint,blocksPicking:e.blocksPicking,forceOpaque:!1,pickingId:n});t.setPickingColorAt(i,a)}else if(e.pickingColorVertexCounts){let i=[],{pickingColorVertexCounts:n}=e;for(let a=0;a<n.length;a++){let c=yY(o)+":"+a,d=this._getOrCreatePickingColor({mesh:t,index:a,isPoint:e.isPoint,blocksPicking:e.blocksPicking,forceOpaque:!1,pickingId:c});i.push(d)}t.setPickingColorArray({colors:i,repeatColorCounts:n})}else{let i=o;t.pickingColor=this._getOrCreatePickingColor({mesh:t,index:0,isPoint:e.isPoint,blocksPicking:e.blocksPicking,forceOpaque:e.forceOpaque,pickingId:i})}}_getOrCreatePickingColor(e){let t=e.pickingId,o=this.idToPickingColor.get(t);if(o){let c=o.key;return this.pickingColorToData.set(c,e),o.color}let i=Rwe(e.pickingId),n,a,s=0;for(;;){let c=i+s**2,d=c>>24&255,p=c>>16&255,u=c>>8&255,g=e.forceOpaque?255:c&255;if(n=`(${d},${p},${u},${g})`,a=[d/255,p/255,u/255,g/255],!ore.has(n)&&!this.pickingColorToData.has(n))break;if(s++,s>100){Er(new Error(`PickingColorManager.getOrCreatePickingColor: too many collisions for id ${t}`)),n="(0,0,0,0)",a=[0,0,0,0];break}}return this.testingLastHashCollisionCount=s,this.pickingColorToData.set(n,e),this.idToPickingColor.set(t,{key:n,color:a}),a}getDataForPickingColor(e){let t=`(${e.join(",")})`;return this.pickingColorToData.get(t)}disposeColorsNotInScene(e){let t=new Set;e.traverse(o=>{if(o instanceof vi){let i=[0,0,0,0];for(let n=0;n<o.count;n++)o.getPickingColorAt(n,i),t.add(bY(i))}else if(o.pickingColorArray){let i=o.pickingColorArray.colors;if(i)for(let n of i)t.add(bY(n))}else{let i=o.pickingColor;i&&t.add(bY(i))}});for(let o of this.pickingColorToData.keys())if(!t.has(o)){let i=this.pickingColorToData.get(o);this.idToPickingColor.delete(i.pickingId),this.pickingColorToData.delete(o)}}};function bY(r){return"("+Math.round(r[0]*255)+","+Math.round(r[1]*255)+","+Math.round(r[2]*255)+","+Math.round(r[3]*255)+")"}var Vwe=2166136261,Owe=16777619;function Rwe(r){let e=Vwe;for(let t=0;t<r.length;t++)e^=r.charCodeAt(t),e*=Owe;return e>>>0}var ire={name:"ConcatShader",uniforms:{t0:{value:null},t1:{value:null},t2:{value:null},t3:{value:null}},defines:{},vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`
		uniform sampler2D t0;
		uniform sampler2D t1;
		uniform sampler2D t2;
		uniform sampler2D t3;

		uniform float opacity;
		uniform sampler2D tDiffuse;
		varying vec2 vUv;

		void main() {
      int index = int(vUv.x * 4.0);
      float x = vUv.x * 4.0 - float(index);
      vec2 uv = vec2(x, vUv.y);
      if (index == 0) {
        gl_FragColor = texture2D( t0, uv );
      } else if (index == 1) {
        gl_FragColor = texture2D( t1, uv );
      } else if (index == 2) {
        gl_FragColor = texture2D( t2, uv );
      } else if (index == 3) {
        gl_FragColor = texture2D( t3, uv );
      }
		}`};var nre={name:"CopyShader",uniforms:{tDiffuse:{value:null},weight:{value:1}},defines:{SRGB_COLOR_SPACE:!0},vertexShader:`
		varying vec2 vUv;

		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`
		uniform float weight;
		uniform sampler2D tDiffuse;
		varying vec2 vUv;

		void main() {
			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = weight * texel;
      #ifdef SRGB_COLOR_SPACE
      gl_FragColor = LinearTosRGB( gl_FragColor );
      #endif
		}`};var{abs:xY,floor:Fwe,sin:are,cos:sre}=Math;function lre(r,e,t,o){if(!A(r)||!A(e)||!isFinite(t)||r.equals(e)||t===0)return[[],[],[]];let i=e.clone().sub(r).normalize(),n=i.clone().negate(),a=new Ee,s=new Ee,c=new Ee,d=Number.MAX_VALUE,p=xY(i.x),u=xY(i.y),g=xY(i.z);p<=d&&(d=p,a.set(1,0,0)),u<=d&&(d=u,a.set(0,1,0)),g<=d&&a.set(0,0,1),c.crossVectors(i,a).normalize(),a.crossVectors(i,c),s.crossVectors(i,a);let h=new Ee,b=(o.xmax-o.xmin)/2,v=(o.ymax-o.ymin)/2,T=(o.zmax-o.zmin)/2,E=[],I=[],_=[],C=e.clone().sub(r),P=new Ee(C.x/b,C.y/v,C.z/T).length();t>P/6&&(t=P/6);let F=6*t,N=1-Math.min(1,F/P),Y=r.clone().add(C.clone().multiplyScalar(N)),z=__dcg_shared_module_exports__['Rb'](Fwe(8+80*t),8,30);q(r,t),q(Y,t),S();let X=E.length/3;E.push(r.x,r.y,r.z),I.push(n.x,n.y,n.z),q(r,t,n);for(let O=1;O<=z;O++)_.push(X,X+O,X+O+1);X=E.length/3,E.push(Y.x,Y.y,Y.z),I.push(n.x,n.y,n.z),q(Y,2*t,n);for(let O=1;O<=z;O++)_.push(X,X+O,X+O+1);X=E.length/3;for(let O=0;O<=z;O++){let B=O/z*Math.PI*2,V=are(B),K=-sre(B);h.x=b*2*t*(K*a.x+V*s.x),h.y=v*2*t*(K*a.y+V*s.y),h.z=T*2*t*(K*a.z+V*s.z),E.push(Y.x+h.x,Y.y+h.y,Y.z+h.z),E.push(e.x,e.y,e.z);let oe=1/3,Z=new Ee(K*a.x+V*s.x+oe*i.x,K*a.y+V*s.y+oe*i.y,K*a.z+V*s.z+oe*i.z).normalize();I.push(Z.x,Z.y,Z.z,Z.x,Z.y,Z.z)}for(let O=0;O<z;O++)_.push(X+2*O,X+2*O+1,X+2*O+2);return[E,I,_];function q(O,B,V){for(let K=0;K<=z;K++){let oe=K/z*Math.PI*2,Z=are(oe),ee=-sre(oe);h.x=b*B*(ee*a.x+Z*s.x),h.y=v*B*(ee*a.y+Z*s.y),h.z=T*B*(ee*a.z+Z*s.z),E.push(O.x+h.x,O.y+h.y,O.z+h.z),h.normalize(),V===void 0?I.push(h.x,h.y,h.z):I.push(V.x,V.y,V.z)}}function S(){for(let O=1;O<=z;O++){let B=O-1,V=z+O,K=z+O+1,oe=O;_.push(B,V,oe,V,K,oe)}}function A(O){return isFinite(O.x)&&isFinite(O.y)&&isFinite(O.z)}}var{abs:oG,min:tG,max:V_,sqrt:zwe,round:pre,log10:ure,tan:wY,atan:hre,PI:qwe}=Math,aG=50,gre=6.75,jl=1,Vw=1,O_=.002,Ow=30,R_=class{constructor(e,t){this.pickingColorManager=new eG;this.perspective=1;this.lastFrameExpressionTooComplexIDs=new Set;this.debugOnlyMeasureGPUTiming=!1;this.lastRenderInfo={peelLayers:0,triangles:0,bufferUploads:0,bufferUploadItems:0,startTimeCPU:0,durationCPU:0};this.mainCopyOutputPass=new Wl(nre);this.concatPass=new Wl(ire);this.pickingPassCacheKey="";this.pickResult={pickingReadCacheKey:""};this.worldViewCacheKeyInfo={math:[new Ee(0,0,0),new Ee(1,0,0),new Ee(0,1,0),new Ee(0,0,1)],clip:[new Ee(0,0,0),new Ee(1,0,0),new Ee(0,1,0),new Ee(0,0,1)]};this.domainObjectUpdates=0;var c,d;let{config:o}=t.getGraphSettings();this.debug=new UP({filter:(c=o.debug3dRender)!=null?c:null}),(d=o.debug3dRender)!=null&&d.includes("pick")&&(Vw=5,jl=5),this.surfaces={},this.renderedTabTargets={},this.renderedTabTargetOrder=[],this.isTrackingPressedAction=!1,this.scene=new Rh,this.spinningWorld=new si,this.world=new si,this.spinningWorld.add(this.world),this.scene.add(this.spinningWorld),this.controller=t,this.materialManager=new QP,this.cameraDistance=aG,this.camera=new Tm,this.axesMaterials=Nte(this.materialManager.getGlobalUniforms()),this.setBackgroundColor(t.getGraphSettings().backgroundColor3d),this.canvas=e,this.renderer=Hwe(this.canvas),this.mainRenderTarget=new os(this.canvas.width,this.canvas.height,{colorSpace:Qa,samples:4}),this.mainCopyOutputPass.defines.SRGB_COLOR_SPACE=!1;let i=new Tw(4210752,Math.PI);this.scene.add(i);let n=2.8,a=new Mm(16777215,n);a.position.set(-1,1,1),this.scene.add(a);let s=new Mm(16777215,n);s.position.set(-1,-1,0),this.scene.add(s),this.controller.getGraphSettings().config.observeAndSync("disableLighting",()=>{this.materialManager.setDisableLighting(this.controller.getGraphSettings().config.disableLighting)}),this.initDepthPeel(),this.updateDomainObjects(),this.initPickingTargets()}getNumberOfSurfaces(){return Object.keys(this.surfaces).length}showPlane(e){this.domainPlane!==void 0&&(e?this.world.add(this.domainPlane):this.world.remove(this.domainPlane))}showBox(e){e?this.world.add(this.domainBox):this.world.remove(this.domainBox);for(let t in this.surfaces)this.deleteSurface(t)}showAxes(e){e?this.world.add(this.domainAxes):this.world.remove(this.domainAxes)}updateCamera(){let e=this.canvas.width/this.canvas.height,t=this.controller.getPerspectiveDistortion();if(t===0&&!(this.camera instanceof Ph)?this.depthPeel.camera=this.camera=new Ph:t!==0&&!(this.camera instanceof Tm)&&(this.depthPeel.camera=this.camera=new Tm),this.camera instanceof Tm){let o=qwe/360,i=gre/tG(e,1);this.cameraDistance=aG/t,this.camera.position.set(-this.cameraDistance,0,0),this.camera.fov=hre(t*wY(o*i))/o}else this.cameraDistance=50,this.camera.position.set(-this.cameraDistance,0,0),e>1?(this.camera.left=-2.95*e,this.camera.right=2.95*e,this.camera.bottom=-2.95,this.camera.top=2.95):(this.camera.left=-2.95,this.camera.right=2.95,this.camera.bottom=-2.95/e,this.camera.top=2.95/e);this.camera.up.set(0,0,1),this.camera.lookAt(new Ee(0,0,0)),this.camera.updateProjectionMatrix(),this.perspective=t}initDepthPeel(){this.depthPeel=new ZP(this.controller,this.renderer,this.materialManager,this.scene,this.camera,this.debug)}initPickingTargets(){let e=jl,t=Vw;this.pickingTargets={id:new os(e,t,{type:Gn}),x:new os(e,t,{type:Gn}),y:new os(e,t,{type:Gn}),z:new os(e,t,{type:Gn}),combined:new os(e*4,t,{type:Gn})}}debugOnlyTrackBufferUploads(){let e=this;Ta.prototype.onUploadCallback=function(){e.lastRenderInfo.bufferUploads++,e.lastRenderInfo.bufferUploadItems+=this.array.length}}debugGetPrograms(){return this.renderer.info.programs||[]}getClipAxes(e){return this.controller.getGraphSettings().showBox3D?{x:!0,y:!0,z:!0}:e!=null?e:{x:!1,y:!1,z:!1}}setBackgroundColor(e){this.backgroundColor=new At(e!=null?e:dD.backgroundColor3d),this.updateBackgroundColor()}updateBackgroundColor(){if(this.controller.invertSwatches()){let{r:e,g:t,b:o}=this.backgroundColor;this.scene.background=new At,this.scene.background.setRGB(1-e,1-t,1-o)}else this.scene.background=this.backgroundColor}domain(){var o,i;let e=this.controller.getGrapher3d(),t=new __dcg_shared_module_exports__['md'];if(e){let n=e.viewportController.getViewport();t.xmin=n.xmin,t.xmax=n.xmax,t.ymin=n.ymin,t.ymax=n.ymax,t.zmin=(o=n.zmin)!=null?o:-2,t.zmax=(i=n.zmax)!=null?i:2}return t}updateAxes(){let e=this.domain(),{screen:t}=this.controller.get2dProjection(),{width:o,height:i}=t,{showAxis3D:n,showAxisLabels3D:a}=this.controller.getGraphSettings(),s={domain:e,showAxis3D:n,showAxisLabels3D:a,width:o,height:i};__dcg_shared_module_exports__['db'](this.domainAxesData,s)||(this.domainAxesData=s,this.domainAxes!==void 0&&(this.world.remove(this.domainAxes),gY(this.domainAxes),this.domainAxes=new si),n&&(this.domainAxes=Kte(e,t,a,this.axesMaterials),this.world.add(this.domainAxes)))}updateBox(){let e=this.domain();this.domainBox?(this.updateDomainBoxColor(),Ute(this.domainBox,e)):this.domainBox=uY(e,this.getDomainBoxColor(),this.materialManager.getGlobalUniforms());let t=this.controller.getGraphSettings().showBox3D,o=this.domainBox.parent===this.world;t!==o&&(t?this.world.add(this.domainBox):this.world.remove(this.domainBox))}getDomainBoxColor(){var t;return this.controller.isGraphPaperFocused()&&!((t=this.controller.getGrapher3d())!=null&&t.isDragging)&&this.controller.getGrapher2d().poiController.keyboardAttentionManager.getKeyboardAttention()===void 0?this.controller.getInvertedColors()?16777215:0:11184810}updateDomainBoxColor(){let{showBox3D:e}=this.controller.getGraphSettings();if(!e||!this.domainBox)return;let t=this.getDomainBoxColor();t!==this.domainBoxColor&&(this.domainBoxColor=t,this.world.remove(this.domainBox),hY(this.domainBox),this.domainBox=uY(this.domain(),t,this.materialManager.getGlobalUniforms()),this.world.add(this.domainBox))}updatePlaneMap(){this.disposePlaneTextureIfResized(),this.domainPlaneMaterials!==void 0&&(this.domainPlaneMaterials.xyNumbersMaterial.uniforms.map.value.needsUpdate=!0,this.domainPlaneMaterials.zMaterial.uniforms.map.value.needsUpdate=!0)}disposePlaneTextureIfResized(){let e=this.controller.getGrapher2d().getCanvasNode();this.domainPlaneMaterials&&(e.width!==this.domainPlaneMaterials.width||e.height!==this.domainPlaneMaterials.height)&&(mY(this.domainPlaneMaterials.xyNumbersMaterial),mY(this.domainPlaneMaterials.zMaterial),this.domainPlaneMaterials=void 0)}disposePlane(){this.domainPlane!==void 0&&(this.world.remove(this.domainPlane),Wte(this.domainPlane),this.domainPlane=void 0)}updatePlane(){let e=this.domain(),t=this.controller.showPlane3D(),o=this.controller.showNumbers3D(),i=this.computeDepthPeelLayers()>0,n=this.controller.getGrapher2d().getCanvasNode(),a=this.controller.getInvertedColors(),{width:s,height:c}=n,d={domain:e,showPlane3D:t,showNumbers3D:o,depthPeelingActive:i,invertedColors:a,width:s,height:c};if(!__dcg_shared_module_exports__['db'](this.domainPlaneData,d)&&(this.domainPlaneData=d,this.disposePlaneTextureIfResized(),this.disposePlane(),t||o)){if(this.domainPlaneMaterials=this.constructDomainMaterials(),!this.domainPlaneMaterials)return;this.domainPlane=new WP(this.domain(),this.domainPlaneMaterials,this.controller.getGrapher2d().getProjection(),this.axesMaterials,this.materialManager.getGlobalUniforms()),this.domainPlane.xyPlane&&this.pickingColorManager.setPickingColorForMesh({mesh:this.domainPlane.xyPlane,isPoint:!1,blocksPicking:!0,forceOpaque:!0,branchId:"**dcg_domain_plane_picking_id**"}),this.world.add(this.domainPlane)}}constructDomainMaterials(){var u,g,h,b,v;let{showNumbers3D:e,showPlane3D:t}=this.controller.getGraphSettings(),o=this.computeDepthPeelLayers()>0;if(this.domainPlaneMaterials!==void 0&&this.domainPlaneMaterials.showPlane3D===t&&this.domainPlaneMaterials.showNumbers3D===e&&this.domainPlaneMaterials.depthPeelingActive===o)return this.domainPlaneMaterials;(g=(u=this.domainPlaneMaterials)==null?void 0:u.xyNumbersMaterial)==null||g.dispose(),(h=this.domainPlaneMaterials)==null||h.xyPlaneMaterial.dispose(),(v=(b=this.domainPlaneMaterials)==null?void 0:b.zMaterial)==null||v.dispose();let i=this.controller.getGrapher2d().getCanvasNode();if(i.width===0||i.height===0)return;let n=this.materialManager.getOrMakeMaterial({type:"domain-plane",spec:{type:"domain-plane-numbers-material",canvas:i,showNumbers:e,transparent:t&&!o}}),a=document.createElement("canvas");a.width=i.width,a.height=i.height;let s=this.materialManager.getOrMakeMaterial({type:"domain-plane",spec:{type:"domain-plane-numbers-material",canvas:a,showNumbers:e,transparent:!1}}),c=this.controller.getGraphSettings().plane3dOpacity,d=Number(c);if((c===""||isNaN(d))&&(d=.5),d=__dcg_shared_module_exports__['Rb'](d,0,1),d<O_)return;let p=this.materialManager.getOrMakeMaterial({type:"domain-plane",spec:{type:"domain-plane-material",opacity:d,transparent:!o,color:new At(16777215)}});return{zCanvas:a,zMaterial:s,xyNumbersMaterial:n,xyPlaneMaterial:p,width:i.width,height:i.height,showNumbers3D:e,showPlane3D:t,depthPeelingActive:o}}computeDepthPeelLayers(){let e=this.computeDesiredDepthPeelLayersFromGeometry(),t=tG(e,Ow);if(e===0)return 0;if(!this.getConfig().adaptivePeeling)return t;let o=this.controller.getAdaptiveDepthPeelingInfo(),i=e;if(o){let{peelLayers:n,status:a}=o;if(a===1){let s=Math.ceil(Ow/3);i=(Math.floor(n/s)+1)*s}else a===0?i=n-1:i=n}return __dcg_shared_module_exports__['Rb'](i,1,t)}getConfig(){return this.controller.getGraphSettings().config}computeDesiredDepthPeelLayersFromGeometry(){let{debugPeelLayers:e}=this.getConfig();if(e!==void 0)return e;let t=1,o=0;for(let n in this.surfaces){let a=this.surfaces[n];if(a.isTransparent){let s=__dcg_shared_module_exports__['Rb'](a.mesh.material.opacity,0,1);if(s<O_)continue;s<t&&(t=s),a.shape==="plane"?o+=1:a.shape==="sphere"?o+=2:o+=pre(-2/ure(1-s))}}if(t===1)return 0;let i=tG(o,pre(-2/ure(1-t)));return this.controller.showPlane3D()&&(i+=1),V_(1,i)}updateDomainObjects(){this.domainObjectUpdates++,this.updateAxes(),this.updateBox(),this.updatePlane();let e=this.domain(),{xmin:t,xmax:o,ymin:i,ymax:n,zmin:a,zmax:s}=e;this.spinningWorld.scale.set(4/(o-t),4/(n-i),4/(s-a)),this.world.position.set(-(o+t)/2,-(n+i)/2,-(s+a)/2),this.materialManager.setDomain(e,this.controller.getGrapher2d().getProjection()),this.updateDomainObjectsFromCamera()}getZBoundsForAnimationForNewSurface(e){var s;let t=(s=this.controller.getGrapher3d())==null?void 0:s.transition,o=t==null?void 0:t.objectIdExtendingTo3D,{zmin:i,zmax:n}=this.domain(),a=window.performance.now();if(o&&e.startsWith(o+":")){t.startTime<0&&(t.startTime=a);let c=(a-t.startTime)/t.duration;return c>=1?Vm:{zMinForAnimation:c*i,zMaxForAnimation:c*n}}return Vm}setZboundsOnSurfaces(e,t,o){for(let i in this.surfaces)if(i.startsWith(e+":")){let a=this.surfaces[i].mesh.material;this.materialManager.setZBoundsUniform(a,{zMinForAnimation:t,zMaxForAnimation:o})}}deleteSurface(e){let t=this.surfaces[e];if(!t)return;this.world.remove(t.mesh);let o=t.mesh.geometry;Wwe(o)||o.dispose(),delete this.surfaces[e]}getColorShader(e){if(e.startsWith("shader:"))return this.controller.getShader(e.slice(7))}renderPoint3D(e,t,o){let{position:i,radius:n,guid:a}=e;if(n<=0||!isFinite(n))return;let s=this.domain(),{xmin:c,xmax:d,ymin:p,ymax:u,zmin:g,zmax:h}=s,b=this.makeCacheKey(a,s);this.surfaces[t]&&(this.surfaces[t].cacheKey!==b||this.surfaces[t].materialColor!=o)&&this.deleteSurface(t);let[v,T,E]=i,I=n*(d-c)/4,_=n*(u-p)/4,C=n*(h-g)/4;if(!this.surfaces[t]){let D=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:t,color:o,opacity:1,colorShader:this.getColorShader(o)},uniforms:{domain:s,clip:this.getClipAxes(),zBoundsForAnimation:Vm}}),P=rG(n),F=new xi(P,D);F.dcgModelMatrix=new $t().makeTranslation(v,T,E).multiply(new $t().makeScale(I,_,C)),this.surfaces[t]={mesh:F,cacheKey:b,isNotInSketchOrder:!1,materialColor:o,isTransparent:!1,isPoint:!0},this.world.add(F)}this.surfaces[t].isNotInSketchOrder=!1}makeCacheKey(e,t){return e+":"+JSON.stringify(t)}renderPointList3D(e,t){let o=this.domain(),{xmin:i,xmax:n,ymin:a,ymax:s,zmin:c,zmax:d}=o,{pressedId:p}=this.pressedActionData(),u=this.highlightedIndex(e),g=t.map(b=>b.color+"_"+b.guid).join(":")+`:${u}:${e===p}`,h=this.makeCacheKey(g,o);if(this.surfaces[e]&&this.surfaces[e].cacheKey!==h&&this.deleteSurface(e),!this.surfaces[e]){let b="",v=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:e,color:b,opacity:1,colorShader:this.getColorShader(b)},uniforms:{domain:o,clip:this.getClipAxes(),zBoundsForAnimation:Vm}}),T=t[0];if(T.graphMode!==114)return;let E=rG(T.radius),I=new vi(E,v,t.length);for(let _=0;_<t.length;_++){let C=t[_];if(C.graphMode!==114)return;let[D,P,F]=C.position,N=C.radius,Y=this.needsHighlighting(e,_)?wy(C.color,this.highlightAmount(e,_)):C.color,z=N*(n-i)/4,X=N*(s-a)/4,q=N*(d-c)/4;if(N<=0||!isFinite(N)||rG(N)!==E)return;let A=new $t().makeTranslation(D,P,F).multiply(new $t().makeScale(z,X,q));I.setMatrixAt(_,A),I.setColorAt(_,new At(Y))}this.surfaces[e]={mesh:I,cacheKey:h,isNotInSketchOrder:!1,materialColor:b,isTransparent:!1,isPoint:!0},this.world.add(I)}return this.surfaces[e].isNotInSketchOrder=!1,this.surfaces[e]}renderSphere3D(e,t,o){var z,X;let{position:i,radius:n,restrictionShader:a,guid:s}=e,c=e.surfaceOpacity;if(!this.getConfig().beta3d&&!this.controller.getTranslucentSurfaces()&&(c=1),c<O_)return;let d=((z=this.getColorShader(o))==null?void 0:z.source)||"";this.surfaces[t]&&(this.surfaces[t].cacheKey!==s||this.surfaces[t].materialColor!=o||d!=((X=this.surfaces[t].shader)!=null?X:""))&&this.deleteSurface(t);let[p,u,g]=i,[h,b,v]=[oG(n[0]),oG(n[1]),oG(n[2])],{xmin:T,xmax:E,ymin:I,ymax:_,zmin:C,zmax:D}=this.domain(),[P,F,N]=[E-T,_-I,D-C],Y=2*V_(h/P,b/F,v/N);if(!this.surfaces[t]){let q=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:t,color:o,opacity:c,colorShader:this.getColorShader(o),restrictionShader:a},uniforms:{domain:this.domain(),clip:this.getClipAxes(),zBoundsForAnimation:Vm}}),S=rG(Y),A=new xi(S,q);A.dcgModelMatrix=new $t().makeTranslation(p,u,g).multiply(new $t().makeScale(h,b,v)),this.surfaces[t]={mesh:A,material:q,cacheKey:s,isNotInSketchOrder:!1,materialColor:o,isTransparent:c<1,shape:"sphere",shader:d},this.world.add(A)}this.surfaces[t].isNotInSketchOrder=!1}renderCurve3D(e,t,o){var g,h;let{points:i,thickness:n,guid:a}=e,s=SY(e.graphMode);if(n<0||!isFinite(n))return;let c=this.domain(),d=a+":"+JSON.stringify(n)+":"+JSON.stringify(c),p=this.surfaces[t],u=((g=this.getColorShader(o))==null?void 0:g.source)||"";if(p&&(p.cacheKey!==d||p.materialColor!=o||u!=((h=p.shader)!=null?h:""))&&this.deleteSurface(t),!(i===void 0||i.length===0||n===0)){if(!this.surfaces[t]){let b=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:t,color:o,opacity:1,colorShader:this.getColorShader(o)},uniforms:{domain:c,clip:this.getClipAxes(s),zBoundsForAnimation:Vm}}),v=.01*n,[T,E,I]=rre(i,v,c),_=iG(new Float32Array(T),new Float32Array(E),new Uint32Array(I)),C=new xi(_,b);this.surfaces[t]={mesh:C,cacheKey:d,isNotInSketchOrder:!1,isTransparent:!1,materialColor:o},this.world.add(C)}this.surfaces[t].isNotInSketchOrder=!1}}renderVector3D(e,t,o,i){var P,F;let n=this.isClickable(t),a=t===this.pressedActionData().pressedId,s=this.highlightedIndex(t),c=t+`:${o}`,{points:d,thickness:p,guid:u}=e,g=SY(e.graphMode),h=this.domain(),b=JSON.stringify(h),v=`${u}:${b}:${p}:${s}:${a}`,T=this.surfaces[c],E=((P=this.getColorShader(i))==null?void 0:P.source)||"";if(T&&(T.cacheKey!==v||T.materialColor!=i||E!=((F=T.shader)!=null?F:""))&&this.deleteSurface(c),d===void 0||d.length<6||d.length%6!=0)return;this.needsHighlighting(t,o)&&d.length===6&&(i=wy(i,this.highlightAmount(t,o)));let I=s!==void 0&&d.length>6,_=wy(i,this.highlightAmount(t,s)),C=__dcg_shared_module_exports__['yd'](i),D=__dcg_shared_module_exports__['yd'](_);if(!this.surfaces[c]){let N=d.length>6&&n,Y=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:c,color:i,opacity:1,colorShader:this.getColorShader(i),vertexColors:I,useVertexPickingColors:N},uniforms:{domain:h,clip:this.getClipAxes(g),zBoundsForAnimation:Vm}}),z=N?[]:void 0,X=.01*p,q=[],S=[],A=[],O=[];for(let K=0;K<d.length;K+=6){let oe=new Ee(d[K],d[K+1],d[K+2]),Z=new Ee(d[K+3],d[K+4],d[K+5]),[ee,ue,he]=lre(oe,Z,X,h),ae=q.length/3;if(q.push(...ee),S.push(...ue),A.push(...he.map($=>$+ae)),z==null||z.push(ee.length/3),I){let $=K/6===s?D:C;for(let se=0;se<ee.length/3;se++)O.push($[0],$[1],$[2])}}let B=iG(new Float32Array(q),new Float32Array(S),new Uint32Array(A));I&&B.setAttribute("color",new Ta(new Float32Array(O),3));let V=new xi(B,Y);this.surfaces[c]={mesh:V,cacheKey:v,isNotInSketchOrder:!1,isTransparent:!1,materialColor:i,pickingColorVertexCounts:z},this.world.add(V)}this.surfaces[c].isNotInSketchOrder=!1}renderTriangle3D(e,t,o,i){if(e.surfaceOpacity<O_)return;let n=this.isClickable(t),a=t+`:${o}`,s=t===this.pressedActionData().pressedId,c=this.highlightedIndex(t),d=`:${c}:${s}`,p=e.meshData.faces.length/3,{meshData:u}=e,g=wy(i,this.highlightAmount(t,c)),h=__dcg_shared_module_exports__['yd'](i),b=__dcg_shared_module_exports__['yd'](g),v=[],T=p>1&&n;if(this.needsHighlighting(t,o)&&p===1&&(i=wy(i,this.highlightAmount(t,o))),c!==void 0&&p>1)if(u.colors&&c!=null){let _=u.colors,C=new Float32Array(_),D=9*c,P=255*__dcg_shared_module_exports__['xd'](_[D]),F=255*__dcg_shared_module_exports__['xd'](_[D+1]),N=255*__dcg_shared_module_exports__['xd'](_[D+2]),Y=__dcg_shared_module_exports__['td'](P,F,N),z=wy(Y,this.highlightAmount(t,o)),X=__dcg_shared_module_exports__['yd'](z);C.set([...X,...X,...X],D),e={...e,meshData:{...e.meshData,colors:C}}}else{for(let C=0;C<u.faces.length;C+=3){let D=C/3===c?b:h;v.push(D[0],D[1],D[2],D[0],D[1],D[2],D[0],D[1],D[2])}let _=new Float32Array(v);e={...e,meshData:{...e.meshData,colors:_}}}let I=this.renderSurface(e,a,i,T,d);if(T){let _=[];for(let C=0;C<p;C++)_.push(3);I&&(I.pickingColorVertexCounts=_)}}renderSurface(e,t,o,i=!1,n=""){var v,T,E;this.getConfig().wireframe&&(o="wireframe:"+o);let{meshData:a,surfaceOpacity:s}=e;if(!this.getConfig().beta3d&&!this.controller.getTranslucentSurfaces()&&(s=1),s<O_)return;let{uvArgs:c,restrictionShader:d}=e,p=(v=e.extraMeshArgs)!=null?v:[],u=SY(e.graphMode),g=((T=this.getColorShader(o))==null?void 0:T.source)||"",h=this.domain(),b=a.guid+n;if(this.surfaces[t]&&(this.surfaces[t].cacheKey!==b||this.surfaces[t].materialColor!=o||g!=((E=this.surfaces[t].shader)!=null?E:"")||a.isDomainCube&&!jwe(h,this.surfaces[t].domain))&&this.deleteSurface(t),!this.surfaces[t]){let I=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:t,color:o,opacity:s,colorShader:this.getColorShader(o),vertexColors:!!a.colors,useVertexPickingColors:i,restrictionShader:d,uvArgs:c,extraMeshArgs:p},uniforms:{domain:h,clip:this.getClipAxes(u),zBoundsForAnimation:a.isDomainCube?Vm:this.getZBoundsForAnimationForNewSurface(t)}});if(a.isDomainCube){let D=h,F=this.controller.getGrapher3d().transition;if(F.objectIdExtendingTo3D&&F.startTime>0){let N=F.objectIdExtendingTo3D;if(N&&t.startsWith(N+":")){let Y=this.domain(),{zmin:z,zmax:X}=Y,S=(window.performance.now()-F.startTime)/F.duration;S<1&&(D.zmin=S*z,D.zmax=S*X)}}a.positions=__dcg_shared_module_exports__['Fd'](D).positions}let _=iG(a.positions,a.normals,a.faces);_.setAttribute("uv",new No(a.uvs,2)),p.length>0&&_.setAttribute("extras",new No(a.extraAttrs,p.length)),a.colors&&_.setAttribute("color",new Ta(a.colors,3));let C=new xi(_,I);this.surfaces[t]={mesh:C,material:I,cacheKey:b,isNotInSketchOrder:!1,materialColor:o,shader:g,isTransparent:s<1,shape:Xwe(a,h)?"plane":void 0,domain:h},this.world.add(C)}return this.surfaces[t].isNotInSketchOrder=!1,this.surfaces[t]}projectMathCoordinates(e,t=new Ee){return t.copy(e).applyMatrix4(this.world.matrixWorld).project(this.camera)}finalizeSurface(e){let{branchId:t,surface:o,renderOrder:i,isSurfaceSelected:n}=e;this.pickingColorManager.setPickingColorForMesh({branchId:t,mesh:o.mesh,isPoint:!!o.isPoint,blocksPicking:!1,forceOpaque:!1,pickingColorVertexCounts:o.pickingColorVertexCounts});let a=o==null?void 0:o.mesh.material;o&&a instanceof Gm&&(o.mesh.renderOrder=i,a.setEmissiveIntensity(n?.015:0))}needsHighlighting(e,t){if(!this.isClickable(e))return!1;let{keyboardFocusId:o,keyboardFocusIndex:i}=this.getKeyboardFocus(),{pressedId:n,pressedIndex:a}=this.pressedActionData(),s=this.getPickResult(),c=s==null?void 0:s.id,d=s==null?void 0:s.index;return e===c&&t===d||e===o&&t===i||e===n&&t===a}highlightedIndex(e){if(!this.isClickable(e))return;let{keyboardFocusId:t,keyboardFocusIndex:o}=this.getKeyboardFocus(),{pressedId:i,pressedIndex:n}=this.pressedActionData(),a=this.getPickResult(),s=a==null?void 0:a.id,c=a==null?void 0:a.index;if(e===s)return c;if(e===t)return o;if(e===i)return n}highlightAmount(e,t){let{pressedId:o,pressedIndex:i}=this.pressedActionData();return e===o&&t===i?.16:.24}redraw(e,t){var q,S,A;(q=this.debug)==null||q.removeUnused();let o=this.controller.getGrapher3d();if(o===void 0)return;this.renderedTabTargets={},this.renderedTabTargetOrder=[];let i=this.canvas,n=performance.now(),a=this.lastRenderInfo={peelLayers:0,bufferUploadItems:0,bufferUploads:0,triangles:0,startTimeCPU:n,durationCPU:0},s=this.renderer;s.setRenderTarget(this.mainRenderTarget),this.updateBackgroundColor(),this.updateDomainObjectsFromCamera(),this.updateCamera();let c=window.devicePixelRatio||1;c!==s.getPixelRatio()&&(s.setPixelRatio(c),o.controls.updateViewport(o.viewportController.getViewport())),this.camera.setViewOffset(i.width/c,i.height/c,0,0,i.width/c,i.height/c),s.setSize(i.width/c,i.height/c);for(let O in this.surfaces)this.surfaces[O].isNotInSketchOrder=!0;let d=this.getPickResult();this.isClickable(d==null?void 0:d.id)?o.setLayerClass("clickableObjects","dcg-mouse-over-clickable-object"):o.setLayerClass("clickableObjects",void 0);let p=0;for(let O of c_(t)){let B=e[O];if(!B||!B.branches)continue;let V=this.controller.isItemSelected(O),K=this.controller.getItemModel(O),oe=this.isClickable(O);if((K==null?void 0:K.type)==="expression"&&(Rg(K)||Fg(K))){let Z=this.renderPointList3D(O,B.branches);if(Z){if(p+=1,this.finalizeSurface({branchId:O,surface:Z,renderOrder:p,isSurfaceSelected:V}),oe)for(let ee=0;ee<B.branches.length;ee++)this.addTabTarget(K,ee);continue}}for(let Z in B.branches){p+=1;let ee=B.branches[Z],ue=O+":"+Z,he=ee.color,ae=parseInt(Z);this.needsHighlighting(O,ae)&&(he=wy(he,this.highlightAmount(O,ae))),ee.graphMode===130||ee.graphMode===103||ee.graphMode===106||ee.graphMode===107||ee.graphMode===108||ee.graphMode===109||ee.graphMode===110||ee.graphMode===111||ee.graphMode===112||ee.graphMode===113||ee.graphMode===210?this.renderSurface(ee,ue,he):ee.graphMode===100||ee.graphMode===119||ee.graphMode===128?this.renderCurve3D(ee,ue,he):ee.graphMode===114?this.renderPoint3D(ee,ue,he):ee.graphMode===118?this.renderSphere3D(ee,ue,he):ee.graphMode===117?this.renderTriangle3D(ee,O,ae,ee.color):ee.graphMode===129&&this.renderVector3D(ee,O,ae,ee.color);let $=this.surfaces[ue];if($&&(this.finalizeSurface({branchId:ue,surface:$,renderOrder:p,isSurfaceSelected:V}),oe))if(ee.graphMode===117){let se=ee.meshData.faces.length/3;for(let J=0;J<se;J++)this.addTabTarget(K,J)}else if(ee.graphMode===129&&ae===0){let se=ee.points.length/6;for(let J=0;J<se;J++)this.addTabTarget(K,J)}else this.addTabTarget(K,ae)}}let u=2.0001*zwe(3),{xmin:g,xmax:h,ymin:b,ymax:v,zmin:T,zmax:E}=this.domain(),I=new Ee((h+g)/2,(v+b)/2,(E+T)/2),_=4/V_(h-g,v-b,E-T);for(let O in this.surfaces)if(this.surfaces[O].isNotInSketchOrder)this.deleteSurface(O);else if(!this.controller.getGraphSettings().showBox3D){let B=this.surfaces[O].mesh.geometry;B.boundingSphere===null&&B.computeBoundingSphere();let V=B.boundingSphere;if(V===null)continue;let oe=(new Ee().subVectors(I,V.center).length()+V.radius)*_;u=V_(u,oe)}let C=this.computeDepthPeelLayers();C>0!==((S=this.domainPlaneMaterials)==null?void 0:S.depthPeelingActive)&&this.updateDomainObjects();let P=this.controller.getPerspectiveDistortion(),F=1e3/(0<P&&P<1?P:1),N=V_(.001,this.cameraDistance-u),Y=tG(F,this.cameraDistance+u);this.camera.near=N,this.camera.far=Y,this.camera.updateProjectionMatrix(),this.materialManager.setGlobalUniform("dcgRenderMode",Gs.Default),this.mainRenderTarget.setSize(i.width,i.height),this.renderer.setRenderTarget(this.mainRenderTarget),this.materialManager.setScreenSize(i.width,i.height),a.peelLayers=C,C>0?(this.depthPeel.render(C),a.triangles=this.depthPeel.triangles):(s.render(this.scene,this.camera),a.triangles=this.renderer.info.render.triangles),C==0&&this.mainCopyOutputPass.render(s,null,this.mainRenderTarget),this.debugOnlyMeasureGPUTiming&&Cte(this.renderer).then(O=>{a.endTimeGPU=O}),a.durationCPU=performance.now()-n,this.materialManager.disposeMaterialsNotInScene(this.scene),this.pickingColorManager.disposeColorsNotInScene(this.scene);let z=new Set;for(let O in this.surfaces)(A=this.surfaces[O].material)!=null&&A.exprTooComplex&&z.add(yY(O));let X=[];for(let O of this.lastFrameExpressionTooComplexIDs)z.has(O)||X.push(O);(z.size>0||X.length>0)&&this.controller.dispatch({type:"mark-too-complex-for-gl",errors:z,fixed:X}),this.lastFrameExpressionTooComplexIDs=z,this.onRenderSpy&&this.onRenderSpy()}updateDomainObjectsFromCamera(){let e=this.controller.getGrapher3d();e&&qte({axes:this.domainAxes,plane:this.domainPlane,domain:this.domain(),screen:this.controller.get2dProjection().screen,controls:e.controls,invertedColors:this.controller.getInvertedColors(),isDepthPeelingActive:this.computeDepthPeelLayers()>0})}pickAtMouseAndReadResults(){this.pickingPass(),this.readPickingOutputFromGPU()}getAllSurfaceGeoemtriesCacheKey(){let e="";for(let t in this.surfaces){let o=this.surfaces[t];e+=o.cacheKey}return e+="|domainUpdates:"+this.domainObjectUpdates,e}getPickingCacheKey(){var e,t;return`world:${this.getWorldViewCacheKey()}:mouse:${(e=this.mouse)==null?void 0:e.x},${(t=this.mouse)==null?void 0:t.y}:surfaces:${this.getAllSurfaceGeoemtriesCacheKey()}`}pickingPass(){if(this.controller.getGrapher3d()===void 0)return;let t=this.mouse;if(!t)return;let o=this.pickingPassCacheKey,i=this.getPickingCacheKey();if(o===i)return;this.pickingPassCacheKey=i;let n=this.scene.background,a=this.renderer.getClearColor(new At),s=new Map;this.world.children.forEach(h=>{var b;if(s.set(h,h.visible),h instanceof xi){let v=h.material;h.visible=!!((b=v.defines)!=null&&b.DCG_SUPPORTS_PICKING)}else h.visible=!1}),this.domainPlane&&s.get(this.domainPlane)&&(this.domainPlane.visible=!0,this.domainPlane.children.forEach(h=>{s.set(h,h.visible),h.visible=h.name==="xy plane"}));let c=window.devicePixelRatio,d=Math.floor(jl/2),p=Math.floor(Vw/2),[u,g]=[Math.floor(t.x*c)-d,Math.floor(t.y*c)-p];this.camera.setViewOffset(this.renderer.domElement.width,this.renderer.domElement.height,u,g,jl,Vw),this.renderer.setClearColor(new At(0),0),this.scene.background=null,this.materialManager.setGlobalUniform("dcgRenderMode",Gs.PickingObjectId),this.renderer.setRenderTarget(this.pickingTargets.id),this.renderer.clearColor(),this.renderer.render(this.scene,this.camera),this.materialManager.setGlobalUniform("dcgRenderMode",Gs.PickingX),this.renderer.setRenderTarget(this.pickingTargets.x),this.renderer.clearColor(),this.renderer.render(this.scene,this.camera),this.materialManager.setGlobalUniform("dcgRenderMode",Gs.PickingY),this.renderer.setRenderTarget(this.pickingTargets.y),this.renderer.clearColor(),this.renderer.render(this.scene,this.camera),this.materialManager.setGlobalUniform("dcgRenderMode",Gs.PickingZ),this.renderer.setRenderTarget(this.pickingTargets.z),this.renderer.clearColor(),this.renderer.render(this.scene,this.camera),this.concatPass.uniforms.t0={value:this.pickingTargets.id.texture},this.concatPass.uniforms.t1={value:this.pickingTargets.x.texture},this.concatPass.uniforms.t2={value:this.pickingTargets.y.texture},this.concatPass.uniforms.t3={value:this.pickingTargets.z.texture},this.camera.clearViewOffset(),this.renderer.setClearColor(a),this.scene.background=n,s.forEach((h,b)=>{b.visible=h}),this.concatPass.render(this.renderer,this.pickingTargets.combined,this.pickingTargets.combined)}readPickingOutputFromGPU(){var I,_,C;let e=this.getPickingCacheKey();if(this.pickResult.pickingReadCacheKey===e)return;let t=Math.floor(jl/2),o=Math.floor(Vw/2),i=FP(this.renderer,this.pickingTargets.combined,0,0,jl*4,Vw),n=P_(i,jl*4,t,o),a=P_(i,jl*4,jl+t,o),s=P_(i,jl*4,2*jl+t,o),c=P_(i,jl*4,3*jl+t,o),d=NP(a),p=NP(s),u=NP(c);if((I=this.debug.get("pick-combined"))==null||I.renderFromTarget(this.renderer,this.pickingTargets.combined,10),n.every(D=>D===0)){this.pickResult={pickingReadCacheKey:e};return}let g=this.pickingColorManager.getDataForPickingColor(n);if(!g){Er(`Failed to find id for picking color ${n}`),this.pickResult={pickingReadCacheKey:e};return}if(g.blocksPicking){this.pickResult={pickingReadCacheKey:e};return}let h=(C=(_=this.pickResult.result)==null?void 0:_.point)!=null?C:new Ee;if(h.set(d,p,u),g.isPoint){let D=g.mesh,P;D instanceof vi?(P=new $t,D.getMatrixAt(g.index,P)):P=g.mesh.dcgModelMatrix,h=new Ee(0,0,0).applyMatrix4(P)}let b=g.pickingId.split(":"),v=b.length,T=b[0],E=v>1?parseInt(b[v-1]):-1;this.pickResult={pickingReadCacheKey:e,result:{point:h,id:T,index:E}}}isClickable(e){if(e===void 0)return!1;let t=this.controller.getItemModel(e);return!!Rv(t)}getPickResult(){return this.pickResult.result}getKeyboardFocus(){let e=this.controller.getGrapher2d().poiController.keyboardAttentionManager.getKeyboardAttention(),t=e==null?void 0:e.calcId,o=e==null?void 0:e.listIndex;return{keyboardFocusId:t,keyboardFocusIndex:o}}pressedActionData(){var o,i;let e=(o=this.pressedAction)==null?void 0:o.id,t=(i=this.pressedAction)==null?void 0:i.index;return{pressedId:e,pressedIndex:t}}getZoomScrollWheelPickResult(){if(this.controller.getGrapher3d().controls.speed3D===0)return this.getPickResult()}getMouse(){return this.mouse}setMouse(e){this.mouse=e}getWorldViewCacheKey(){let{math:e,clip:t}=this.worldViewCacheKeyInfo,o="";for(let i=0;i<e.length;i++)this.projectMathCoordinates(e[i],t[i]),o+=`:${t[i].x},${t[i].y}`;return o}baseplaneMultiplier(){let e=gre*(Math.PI/360),t=this.camera instanceof Tm?hre(this.perspective*wY(e)):e;return 2/(wY(t)*-this.camera.position.x)}mathCoordinatesToBufferCoordinates(e){let t=new Ee(e.x,e.y,e.z).applyMatrix4(this.world.matrixWorld).project(this.camera),o=this.canvas,i=o.width/2,n=o.height/2,a=Math.round(t.x*i+i),s=Math.round(t.y*n+n);return{x:a,y:s}}mathCoordinatesToScreenCoordinates(e,t){let o=new Ee(e.x,e.y,e.z).applyMatrix4(this.world.matrixWorld).project(this.camera),i=this.canvas,n=window.devicePixelRatio,a=i.width/n/2,s=i.height/n/2,c=o.x*a+a,d=-o.y*s+s;return(!t||!t.skipRounding)&&(c=Math.round(c),d=Math.round(d)),{x:c,y:d}}_testingGetMeshById(e){let t=this.surfaces[e];return t?t.mesh:void 0}remove(){this.materialManager.disposeAllMaterials(),this.pickingColorManager.disposeColorsNotInScene(new Rh),this.domainBox&&hY(this.domainBox),this.domainAxes&&(gY(this.domainAxes),zte(this.axesMaterials)),this.renderer.dispose(),this.renderer.forceContextLoss()}addTabTarget(e,t){let o=$U(e.id,t);this.renderedTabTargetOrder.indexOf(o)!==-1||this.renderedTabTargets[o]!==void 0||(this.renderedTabTargetOrder.push(o),this.renderedTabTargets[o]={type:e.type,id:e.id,listIndex:t,description:this.getComputedDescription(e,t)})}getOrderedTabTargets(){return this.renderedTabTargetOrder.map(e=>{let t=this.renderedTabTargets[e];return{calcId:t.id,listIndex:t.listIndex,polygonEdge:void 0,description:t.description}})}setPressedAction(e){this.pressedAction=e,e!==void 0&&(this.isTrackingPressedAction=!0);let t=this.controller.getGrapher3d();t&&(t.controls.state=Fh.NONE,t.redrawAllLayers())}getPressedAction(){return this.pressedAction}getComputedDescription(e,t){let o=e.formula&&e.formula.computed_description&&e.formula.computed_description[t];return o&&o!==""?po(o):this.getDescription(e)}getDescription(e){switch(e.formula.expression_type){case __dcg_shared_module_exports__['Vc'].SURFACE:case __dcg_shared_module_exports__['Vc'].SURFACE_AMBIGUOUS:case __dcg_shared_module_exports__['Vc'].SURFACE_CONSTANT_AMBIGUOUS:case __dcg_shared_module_exports__['Vc'].SURFACE_r_\u03B8z:case __dcg_shared_module_exports__['Vc'].SURFACE_r_\u03B8z_AMBIGUOUS:case __dcg_shared_module_exports__['Vc'].SURFACE_z_r\u03B8:case __dcg_shared_module_exports__['Vc'].SURFACE_r_\u03B8\u03C6:case __dcg_shared_module_exports__['Vc'].SURFACE_xyz_uv:case __dcg_shared_module_exports__['Vc'].IMPLICIT_SURFACE:case __dcg_shared_module_exports__['Vc'].IMPLICIT_SURFACE_AMBIGUOUS:return this.controller.raw("surface");case __dcg_shared_module_exports__['Vc'].CURVE3D_xyz_t:case __dcg_shared_module_exports__['Vc'].SLICE:case __dcg_shared_module_exports__['Vc'].SLICE_r\u03B8z_at_z:case __dcg_shared_module_exports__['Vc'].SLICE_zr\u03B8_at_r:case __dcg_shared_module_exports__['Vc'].SLICE_zr\u03B8_at_\u03B8:case __dcg_shared_module_exports__['Vc'].SLICE_zr\u03B8_at_xyz:case __dcg_shared_module_exports__['Vc'].SLICE_r\u03B8\u03C6_at_\u03B8:case __dcg_shared_module_exports__['Vc'].SLICE_r\u03B8\u03C6_at_\u03C6:case __dcg_shared_module_exports__['Vc'].SLICE_r\u03B8\u03C6_at_xyz:case __dcg_shared_module_exports__['Vc'].SLICE_xyz_uv:return this.controller.raw("curve");case __dcg_shared_module_exports__['Vc'].SEGMENT3D:return this.controller.raw("segment");case __dcg_shared_module_exports__['Vc'].VECTOR3D:return this.controller.raw("vector");case __dcg_shared_module_exports__['Vc'].SPHERE3D:return this.controller.raw("sphere");case __dcg_shared_module_exports__['Vc'].POINT3D:case __dcg_shared_module_exports__['Vc'].POINT3D_LIST:return this.controller.raw("point");case __dcg_shared_module_exports__['Vc'].TRIANGLE3D:return this.controller.raw("triangle")}return this.controller.raw("3d object")}};function Hwe(r){let e=new Mw({antialias:!0,alpha:!0,preserveDrawingBuffer:!0,canvas:r});return e.setPixelRatio(window.devicePixelRatio||1),e}function SY(r){switch(r){case 106:return{x:!0,y:!0,z:!1};case 107:return{x:!1,y:!0,z:!0};case 108:return{x:!0,y:!1,z:!0};case 110:return{x:!1,y:!1,z:!0};case 112:case 113:case 210:case 128:return{x:!0,y:!0,z:!0};default:return{x:!1,y:!1,z:!1}}}var Vm={zMinForAnimation:-1/0,zMaxForAnimation:1/0};function iG(r,e,t){let o=new es;return o.setIndex(r.length<65536?new km(t,1):new _m(t,1)),o.setAttribute("position",new No(r,3)),o.setAttribute("normal",new No(e,3)),o}var nG=[];function rG(r){let e=r<.02?1:r<.05?2:r<.2?3:r<.8?4:5;if(nG[e]===void 0){let t=kte(e);nG[e]=iG(t.vertices,t.vertices,t.indices)}return nG[e]}function Wwe(r){return nG.includes(r)}function jwe(r,e){return e!==void 0&&r.xmin===e.xmin&&r.xmax===e.xmax&&r.ymin===e.ymin&&r.ymax===e.ymax&&r.zmin===e.zmin&&r.zmax===e.zmax}function wy(r,e){return __dcg_shared_module_exports__['Ed'](r)?r:__dcg_shared_module_exports__['sd'](r,e)}function Xwe(r,e){let t=r.faces.length/3,o=r.positions.length/3,{xmin:i,xmax:n,ymin:a,ymax:s,zmin:c,zmax:d}=e,p=h=>(h-i)/(n-i),u=h=>(h-a)/(s-a),g=h=>(h-c)/(d-c);if(t===1)return!0;if(t===2&&o===4){let h=r.positions,b=new Ee(p(h[0]),u(h[1]),g(h[2])),v=new Ee(p(h[3]),u(h[4]),g(h[5])),T=new Ee(p(h[6]),u(h[7]),g(h[8])),E=new Ee(p(h[9]),u(h[10]),g(h[11])),I=new Ee().subVectors(v,b),_=new Ee().subVectors(T,b),C=new Ee().subVectors(E,b),D=I.cross(_);return oG(D.dot(C)/(D.length()*C.length()))<.01}return!1}function yY(r){return r.split(":")[0]}var $we=1e3;function Jwe(){return new Kl(1024,768)}function kre(){return new Or(__dcg_shared_module_exports__['Gc'].xmin,__dcg_shared_module_exports__['Gc'].xmax,__dcg_shared_module_exports__['Gc'].ymin,__dcg_shared_module_exports__['Gc'].ymax,__dcg_shared_module_exports__['Gc'].zmin,__dcg_shared_module_exports__['Gc'].zmax)}var sG=class extends hw{constructor(t,o,i,n){super({elt:t,settings:o,controller:i,evaluator:n});this.type="3d";this.screen=Jwe();this.redrawTickCount=0;let a=kre();this.setUserRequestedViewport(a),this.viewportController=new PP(a,this),this.graphSketches={};let s=document.createElement("canvas");s.className="dcg-webgl-canvas",this.getDebugPixelRatio()!==1&&(s.style.imageRendering="pixelated"),this.webglLayer=new R_(s,i),this.elt.appendChild(s),this.transition=new VP,this.controls=new GP(this.webglLayer.spinningWorld,this,this.canvasLayer.canvasNode),this.controls.setWorldRotation(Zp()),this.controls.unsnappedRotation.copy(this.controls.worldRotation3D),this.addKeydownEventHandler()}isDefaultDomain(){let t=this.viewportController.getViewport(),o=this.getDefaultViewport();return t.xmin===o.xmin&&t.xmax===o.xmax&&t.ymin===o.ymin&&t.ymax===o.ymax&&t.zmin===o.zmin&&t.zmax===o.zmax}getDebugPixelRatio(){var t;return(t=this.settings.config.debugPixelRatio)!=null?t:1}startZoom(){this.settings.config.disableWorkerOnZoom&&this.evaluator.setTicksEnabled(!1)}endZoom(){this.settings.config.disableWorkerOnZoom&&this.evaluator.setTicksEnabled(!0)}remove(){this.controls.dispose(),this.elt.remove(),this.viewportController.remove(),this.webglLayer.remove()}tick(t){this.redrawTickCount+=1,this.controller.getGrapher2d().tick(t),wte(this.controls);let o=this.webglLayer.getPickResult();this.webglLayer.pickAtMouseAndReadResults();let i=this.webglLayer.getPickResult();__dcg_shared_module_exports__['db'](o,i)||(this.__redrawRequested=!0),(!this.lastRenderedWorldRotation||!this.lastRenderedWorldRotation.equals(this.controls.worldRotation3D))&&(this.__redrawRequested=!0,this.lastRenderedWorldRotation=this.controls.worldRotation3D.clone()),this.__redrawRequested&&this._redrawAllLayers()}clear(){this.graphSketches={},this.controller.getGrapher2d().clear()}getGraphSketch(t){return this.graphSketches[t]}addGraphSketch(t){this.graphSketches[t.id]=t}removeGraphSketch(t){t in this.graphSketches&&delete this.graphSketches[t]}flatWorldRotation3D(){return[...this.controls.worldRotation3D.elements]}debounceUserRequestedRotationChange(){this.__debouncedRotationCommit||(this.__debouncedRotationCommit=__dcg_shared_module_exports__['_a'](()=>{if(this.isDragging||this.settings.userLockedRotation)return;let t=this.flatWorldRotation3D();(this.settings.worldRotation3D.length===0&&this.controls.worldRotation3D.equals(Zp())||__dcg_shared_module_exports__['db'](this.settings.worldRotation3D,t))&&this.settings.axis3D===this.controls.axis3D&&this.settings.speed3D===this.controls.speed3D||this.controller.dispatch({type:"commit-user-requested-rotation",worldRotation3D:t,axis3D:this.controls.axis3D,speed3D:this.controls.speed3D})},$we)),this.__debouncedRotationCommit()}getDefaultViewport(){return kre()}_updateScreenSize(t,o){if(t<=0||o<=0)return;let i=this.screen;i.width===t&&i.height===o||(this.screen=new Kl(t,o),this.viewportController.setScreen(this.screen))}getProjection(){return new pl(this.screen,this.viewportController.getViewport(),this.settings)}size(){let t=this.canvasLayer.ctx;if(!t)return this.controller.getGrapher2d().size();let{width:o,height:i}=t.canvas.getBoundingClientRect();return o===0||i===0?this.controller.getGrapher2d().size():{width:o,height:i}}update(){let{top:t,left:o,width:i,height:n}=this.controller.computeMajorLayout().grapher,a=this.baseplaneWidth(),s=this.controller.getGrapher2d();s.setCanvasSizeFor3D(a,a),s.update(),this.webglLayer.updateDomainObjects(),i>0&&n>0?(this._setIsVisible(!0),this._updateScreenSize(i,n),Yo(this.elt,{position:"absolute",left:o+"px",top:t+"px",width:i+"px",height:n+"px"})):this._setIsVisible(!1)}deselectSketch(t){let o=this.getGraphSketch(t);o&&(o.selected=!1,o.showHighlight=!1)}selectSketch(t){let o=this.getGraphSketch(t);o&&(o.selected=!0,o.showHighlight=!0)}setSketchHoistedToTop(t,o){let i=this.getGraphSketch(t);i&&(i.hoistToTop=o)}updateSketch(t,o){if(!o.length){this.removeGraphSketch(t);return}let i=new iw(t,o);i.color=o[0].color;let n=this.getGraphSketch(t);n&&i.updateFrom(n);let a=this.controller.getPropagatedSelectedIds(),s=!!a.selected[t],c=!!a.hoistedToTop[t];i.selected=s,i.showHighlight=s,i.hoistToTop=c,this.addGraphSketch(i)}_redrawAllLayers(){if(!this.isVisible)return;let t=Date.now();this.__redrawRequested=!1,this.canvasLayer.resize(this.screen.width,this.screen.height),this.controls.update(),this._redrawWebglLayer(),this.events.triggerEvent("redraw",Date.now()-t),this.canvasLayer.updateAria(this.isVisible,0)}_redrawWebglLayer(){let t=this.getDebugPixelRatio();this.webglLayer.canvas.width=this.canvasLayer.canvasNode.width/t,this.webglLayer.canvas.height=this.canvasLayer.canvasNode.height/t,t!==1&&(this.webglLayer.canvas.style.transform=`scale(${t})`,this.webglLayer.canvas.style.transformOrigin="0 0"),this.webglLayer.redraw(this.graphSketches,this.__drawLayers)}_parseScreenshotOpts(t){return n5(t,this.settings,this.screen)}screenshot(t){let o=document.createElement("canvas"),i=this._parseScreenshotOpts(t);o.width=i.width*i.targetPixelRatio,o.height=i.height*i.targetPixelRatio;let n=this.screenshotToCanvas(o),a=o.toDataURL("image/png");return n&&n(),a}asyncScreenshot(t,o){t.format==="svg"&&__dcg_shared_module_exports__['Be'].warn("Unsupported format 'svg' for 3d screenshot. Assuming 'png' format instead.");for(let i of["showLabels","showMovablePoints","mathBounds","mode"])t.hasOwnProperty(i)&&__dcg_shared_module_exports__['Be'].warn(`Property ${i} is ignored for 3d screenshot.`);o(this.screenshot(t))}screenshotToCanvas(t){let o=new R_(t,this.controller);return o.spinningWorld.setRotationFromMatrix(new $t().setFromMatrix3(this.controls.worldRotation3D)),o.redraw(this.graphSketches,this.__drawLayers),()=>o.remove()}_afterViewportChange(){this.webglLayer!==void 0&&this.webglLayer.updateDomainObjects()}computeConcreteViewport(t){return t}setGrapherState(t,o){t=__dcg_shared_module_exports__['Ld'](Li,t),"complex"in t&&!this.controller.canEnableComplexMode()&&(t={...t,complex:!1}),(!o||!o.doNotClear)&&this.clear();for(let i in Li)Li.hasOwnProperty(i)&&this.settings.setProperty(i,t[i]);if("viewport"in t){let i=Or.fromObject(t.viewport);this.setUserRequestedViewport(i),this.viewportController.setViewport(i),this.webglLayer!==void 0&&this.webglLayer.updateDomainObjects()}if("speed3D"in t&&(this.controls.speed3D=t.speed3D),"worldRotation3D"in t){let i=t.worldRotation3D;if(i.length===9){let n=new Co;n.set(i[0],i[3],i[6],i[1],i[4],i[7],i[2],i[5],i[8]),this.controls.setWorldRotation(n),this.controls.unsnappedRotation.copy(this.controls.worldRotation3D),!this.controls.isHorizonLevel()&&!this.controller.getGraphSettings().config.beta3d&&(this.controls.setWorldRotation(Zp()),this.controls.unsnappedRotation.copy(this.controls.worldRotation3D),this.controls.speed3D=0)}else this.controls.setWorldRotation(Zp()),this.controls.unsnappedRotation.copy(this.controls.worldRotation3D)}"axis3D"in t&&(this.controls.axis3D=t.axis3D),this.controller.requestRedrawGraph()}baseplaneWidth(){let t=this.controller.computeMajorLayout().grapher,{width:o,height:i}=t;return o<360&&(i=360*(i/o),o=360),i<360&&(o=360*(o/i),i=360),Math.ceil(Math.min(o,i)*this.webglLayer.baseplaneMultiplier())}mathCoordinatesToScreenCoordinates(t){return this.webglLayer.mathCoordinatesToScreenCoordinates(t)}addKeydownEventHandler(){re(this.elt).on("keydown",t=>{if(!this.controller.isGraphPaperFocused())return;let o=t;if(o.altKey||o.ctrlKey||o.metaKey)return;let i=Pe(o);if(i==="Tab"){let a=o.shiftKey?"prev":"next";this.handleTabEvent(a,o),this.redrawAllLayers();return}let n=this.controller.getGrapher2d().poiController.keyboardAttentionManager.getKeyboardAttention();if(n){if(i==="Enter"||i==="Space"){let a=this.controller.getItemModel(n.calcId);Rv(a)&&this.controller.dispatch({type:"clickable-item-clicked",id:n.calcId,listIndex:n.listIndex})}return}i!=="Up"&&i!=="Down"&&i!=="Left"&&i!=="Right"||(o.stopPropagation(),o.preventDefault(),this.controls.applyTiltFromKeyboard(i,o.shiftKey),this.debounceUserRequestedRotationChange())}),re(this.elt).on("keyup",()=>{this.controller.isGraphPaperFocused()&&this.controls.keyUp()})}getCanvasNode(){return this.webglLayer.canvas}getOrderedTabTargets(){return this.webglLayer.getOrderedTabTargets()}handleTabEvent(t,o){let n=this.controller.getGrapher2d().poiController.keyboardAttentionManager,s=n.getKeyboardAttention()!==void 0;if(t==="prev"&&!s){n.updateKeyboardAttention(void 0,{describe:!1}),this.webglLayer.updateDomainObjects();return}if(n.focusNextObjFromKeyboard({direction:t,allowWrapping:!1,selectNonClickables:!1})){o==null||o.preventDefault(),o==null||o.stopPropagation(),this.webglLayer.updateDomainObjects();return}else{n.updateKeyboardAttention(void 0,{describe:!1}),t==="prev"&&s&&(this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}),this.speakGrapherFocusAriaLabel(),o==null||o.preventDefault(),o==null||o.stopPropagation()),this.webglLayer.updateDomainObjects();return}}speakGrapherFocusAriaLabel(){let o=this.elt.getElementsByClassName("dcg-graph-outer")[0].getAttribute("aria-label");o&&_e(o)}};jo();var Un=__dcg_shared_module_exports__['e'](j());var wi=__dcg_shared_module_exports__['e'](j());var nr=__dcg_shared_module_exports__['e'](j());var F_=__dcg_shared_module_exports__['e'](j()),cr=class extends F_.View{template(){return l("div",{class:()=>{var e,t,o,i,n;return{"dcg-keypad-btn-container":!0,"dcg-disabled":this.isDisabled(),[(o=(t=(e=this.props).additionalClass)==null?void 0:t.call(e))!=null?o:""]:!!((n=(i=this.props).additionalClass)!=null&&n.call(i))}},style:()=>{var e;return{"flex-grow":(e=this.getColSpan())==null?void 0:e.toString()}},children:l("span",{role:F_.const("button"),class:this.bindFn(this.getClasses),"dcg-command":this.props.command,"aria-label":this.bindFn(this.getAriaLabel),"aria-disabled":this.bindFn(this.isDisabled),"aria-controls":this.props.ariaControls?this.props.ariaControls:this.const(void 0),"aria-expanded":this.props.ariaExpanded?this.bindFn(this.getAriaExpanded):this.const(void 0),onTap:()=>{this.isDisabled()||this.props.onTap()},children:l("span",{class:F_.const("dcg-keypad-btn-content"),children:this.props.children})})})}getClasses(){let e={"dcg-keypad-btn":!0,"dcg-keypad-btn-active":this.isActive()},t=this.props.style();switch(t){case"default":e["dcg-btn-light-on-gray"]=!0;break;case"highlight":e["dcg-btn-dark-on-gray"]=!0;break;case"popover":e["dcg-btn-light-gray"]=!0;break;case"blue":e["dcg-btn-short-blue"]=!0;break;case"tall-blue":e["dcg-btn-tall-blue"]=!0;break;default:return t}return e}isActive(){return this.props.active?this.props.active():!1}getAriaLabel(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()}getColSpan(){if(this.props.colspan)return this.props.colspan()}isDisabled(){return this.props.disabled&&this.props.disabled()}getAriaExpanded(){return this.props.ariaExpanded?this.props.ariaExpanded():void 0}};var Cre=__dcg_shared_module_exports__['e'](j());var _re=__dcg_shared_module_exports__['e'](j()),ky=class extends _re.View{init(){this.controller=this.props.controller()}};var Pr=class extends ky{template(){return l("div",{class:Cre.const("dcg-basic-keypad dcg-do-not-blur"),children:this.props.children})}};var Ge=__dcg_shared_module_exports__['e'](j());var{IfElse:Ire,If:Tre,Switch:Zwe}=Ge.Components;function hr(r,e){return r===void 0?Ge.const(e):typeof r=="function"?r:Ge.const(r)}function Fw(r){return(e,t,o={},i)=>l(cr,{command:Ge.const(r.command||r.typedText||r.keys[0]),ariaLabel:()=>r.ariaLabelKey?i(r.ariaLabelKey):r.typedText||r.keys[0],colspan:hr(o.colspan,1),style:()=>o.style||"default",onTap:()=>t({type:"keypad/type-text",text:r.typedText||r.keys[0]}),children:Ire(()=>r.keys[0]==="{"||r.keys[0]==="[",{true:()=>x("span",{class:Ge.const("dcg-mq-math-mode"),style:Ge.const("font-size: 120%"),children:[Ge.const(r.keys[0]),"\xA0",l("span",{style:Ge.const("color: #999"),children:Ge.const(r.keys[1])})]}),false:()=>x("span",{class:Ge.const("dcg-either-or-btn"),children:[l(dt,{config:Ge.const({}),latex:Ge.const(r.keys[0])}),l("span",{style:Ge.const("color: #999"),children:l(dt,{config:Ge.const({}),latex:Ge.const(r.keys[1])})})]})})})}function Nw(r){return(e,t,o={},i)=>l(cr,{command:Ge.const(r.command||r.typedText||r.keys[1]),ariaLabel:()=>r.ariaLabelKey?i(r.ariaLabelKey):r.typedText||r.keys[0],colspan:hr(o.colspan,1),style:hr(o.style,"default"),onTap:()=>t({type:"keypad/type-text",text:r.typedText||r.keys[1]}),children:Ire(()=>r.keys[1]==="}"||r.keys[1]==="]",{true:()=>x("span",{class:Ge.const("dcg-mq-math-mode"),style:Ge.const("font-size: 120%"),children:[l("span",{style:Ge.const("color: #999"),children:Ge.const(r.keys[0])}),"\xA0",Ge.const(r.keys[1])]}),false:()=>x("span",{children:[l("span",{style:Ge.const("color: #999"),children:l(dt,{config:Ge.const({}),latex:Ge.const(r.keys[0])})}),l(dt,{config:Ge.const({}),latex:Ge.const(r.keys[1])})]})})})}function Qwe(r){return(e,t,o={},i)=>x(cr,{command:Ge.const(r.command),ariaLabel:()=>r.ariaLabelKey?i(r.ariaLabelKey):e,colspan:hr(o.colspan,1),style:()=>o.style||"default",onTap:()=>{t({type:"keypad/audio-trace",command:r.command})},children:[l(Tre,{predicate:Ge.const(r.iconClass!==void 0),children:()=>l("span",{class:()=>({"dcg-button-icon":!0,"dcg-icon-only":r.contentKey===void 0}),children:l("i",{class:Ge.const(r.iconClass),"aria-hidden":Ge.const("true")})})}),l(Tre,{predicate:Ge.const(r.contentKey!==void 0),children:()=>l("span",{children:()=>i(r.contentKey)||e})})]})}function Ne(r){return(e,t,o={},i)=>l(cr,{command:Ge.const(r.command||e),ariaLabel:()=>r.ariaLabelKey?i(r.ariaLabelKey):e,colspan:hr(o.colspan,1),style:()=>o.style||"default",onTap:()=>t({type:"keypad/type-text",text:r.typedText||e}),children:l(dt,{config:Ge.const({}),latex:Ge.const(r.content||e)})})}function Ere(r){return(e,t,o={},i)=>l(cr,{command:Ge.const(r.command||e),ariaLabel:()=>r.ariaLabelKey?i(r.ariaLabelKey):e,colspan:hr(o.colspan,1),style:()=>o.style||"default",onTap:()=>t({type:"keypad/type-text",text:r.typedText||e}),children:l("span",{class:Ge.const("dcg-mq-math-mode"),children:Ge.const(r.content||e)})})}function Ke(r){return(e,t,o={},i)=>l(cr,{command:Ge.const(e),ariaLabel:()=>r.ariaLabelKey?i(r.ariaLabelKey):e,colspan:hr(o.colspan,1),style:()=>o.style||"default",onTap:()=>t({type:"keypad/type-text",text:e+"("}),children:l(Zwe,{children:n=>n?l("span",{class:Ge.const("dcg-mq-math-mode dcg-static-mathquill-view"),children:l("span",{class:Ge.const("dcg-mq-root-block"),children:l("span",{class:Ge.const("dcg-mq-operator-name"),children:()=>e})})}):l(dt,{config:Ge.const({}),latex:Ge.const(e)})},()=>!!e.match(/^[a-z]{2,}$/))})}function Vn(r){return(e,t,o={},i)=>l(cr,{command:Ge.const(r.command),ariaLabel:()=>r.ariaLabelKey?i(r.ariaLabelKey):r.command,colspan:hr(o.colspan,1),style:()=>o.style||"default",onTap:()=>{t({type:"keypad/custom-command",command:r.command})},children:l(dt,{config:Ge.const({}),latex:Ge.const(r.content)})})}var eSe={"{":Ere({ariaLabelKey:"shared-calculator-narration-keypad-key-left-bracket"}),"}":Ere({ariaLabelKey:"shared-calculator-narration-keypad-key-right-bracket"}),"(":Ne({ariaLabelKey:"shared-calculator-narration-keypad-key-left-paren"}),")":Ne({ariaLabelKey:"shared-calculator-narration-keypad-key-right-paren"}),sqrt:Ne({content:"\\sqrt{}",ariaLabelKey:"shared-calculator-narration-keypad-key-sqrt"}),"/":Ne({ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),division:Ne({content:"\xF7",typedText:"/",command:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),obelus:Ne({content:"\xF7",typedText:"\xF7",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),"*":Ne({ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),multiplication:Ne({content:"\xD7",typedText:"*",command:"*",ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),"\xB1":Ne({ariaLabelKey:"shared-calculator-narration-keypad-plus-minus"}),"-":Ne({ariaLabelKey:"shared-calculator-narration-keypad-key-minus"}),"+":Ne({ariaLabelKey:"shared-calculator-narration-keypad-key-plus"}),".":Ne({ariaLabelKey:"shared-calculator-narration-keypad-key-decimal"}),ans:(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("shared-calculator-narration-keypad-key-ans"),colspan:hr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/type-text",text:r}),children:"ans"}),enter:(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("shared-calculator-narration-keypad-key-enter"),colspan:hr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Enter",source:"keypad"}),children:l("i",{class:Ge.const("dcg-icon-arrow-enter"),"aria-hidden":Ge.const("true")})}),undo:(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("shared-calculator-narration-keypad-key-enter"),colspan:hr(t.colspan,1),disabled:hr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"undo",source:"button-tap"}),children:l("i",{class:Ge.const("dcg-icon-undo"),"aria-hidden":Ge.const("true")})}),redo:(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("shared-calculator-narration-keypad-key-enter"),colspan:hr(t.colspan,1),disabled:hr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"redo",source:"button-tap"}),children:l("i",{class:Ge.const("dcg-icon-redo"),"aria-hidden":Ge.const("true")})}),shift:(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("shared-calculator-narration-keypad-key-shift"),colspan:hr(t.colspan,1),style:()=>t.style||"default",active:hr(t.active,!1),onTap:()=>e({type:"keypad/shift"}),children:l("i",{class:Ge.const("dcg-icon-shift"),"aria-hidden":Ge.const("true")})}),left:(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("shared-calculator-narration-keypad-key-left-arrow"),colspan:hr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Left",source:"keypad"}),children:l("i",{class:Ge.const("dcg-icon-arrow-left"),"aria-hidden":Ge.const("true")})}),right:(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("shared-calculator-narration-keypad-key-right-arrow"),colspan:hr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Right",source:"keypad"}),children:l("i",{class:Ge.const("dcg-icon-arrow-right"),"aria-hidden":Ge.const("true")})}),123:(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("shared-calculator-narration-keypad-key-toggle-numbers"),colspan:hr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/123"}),children:"1 2 3"}),ABC:(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("shared-calculator-narration-keypad-key-toggle-letters"),colspan:hr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/abc"}),children:"A B C"}),Audio:(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("shared-calculator-narration-keypad-key-toggle-audio-trace"),colspan:hr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"on"}),children:l("i",{class:Ge.const("dcg-icon-volume"),"aria-hidden":Ge.const("true")})}),backspace:(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("shared-calculator-narration-keypad-key-backspace"),colspan:hr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Backspace",source:"keypad"}),children:l("i",{class:Ge.const("dcg-icon-delete"),"aria-hidden":Ge.const("true")})}),pi:Ne({content:"\\pi",ariaLabelKey:"shared-calculator-narration-keypad-key-pi"}),alpha:Ne({content:"\\alpha",ariaLabelKey:"shared-calculator-narration-keypad-key-alpha"}),beta:Ne({content:"\\beta",ariaLabelKey:"shared-calculator-narration-keypad-key-beta"}),theta:Ne({content:"\\theta",ariaLabelKey:"shared-calculator-narration-keypad-key-theta"}),tau:Ne({content:"\\tau",ariaLabelKey:"shared-calculator-narration-keypad-key-tau"}),phi:Ne({content:"\\phi",ariaLabelKey:"shared-calculator-narration-keypad-key-phi"}),rho:Ne({content:"\\rho",ariaLabelKey:"shared-calculator-narration-keypad-key-rho"}),"a^2":Vn({command:"a^2",content:"a^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"a^3":Vn({command:"a^3",content:"a^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"x^3":Vn({command:"a^3",content:"x^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"a^b":Ne({content:"a^b",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),a_b:Ne({content:"a_b",typedText:"_",ariaLabelKey:"shared-calculator-narration-keypad-key-subscript"}),"a/b":Vn({content:"\\frac{a}{b}",command:"a/b",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),"x^2":Vn({command:"a^2",content:"x^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"x^y":Ne({content:"x^y",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),"x/y":Ne({content:"\\frac{x}{y}",typedText:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),nthroot:Vn({command:"nthroot",content:"\\sqrt[n]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-nthroot"}),ythroot:Vn({command:"nthroot",content:"\\sqrt[y]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-ythroot"}),sin:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-sin"}),cos:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-cos"}),tan:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-tan"}),tone:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-tone"}),sec:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-sec"}),csc:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-csc"}),cot:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-cot"}),sinh:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-sinh"}),cosh:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-cosh"}),tanh:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-tanh"}),sech:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),csch:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),coth:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-coth"}),arcsin:Vn({command:"arcsin",content:"sin^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsin"}),arccos:Vn({command:"arccos",content:"cos^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccos"}),arctan:Vn({command:"arctan",content:"tan^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arctan"}),arccsc:Vn({command:"arccsc",content:"csc^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccsc"}),arcsec:Vn({command:"arcsec",content:"sec^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsec"}),arccot:Vn({command:"arccot",content:"cot^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccot"}),"|a|":Ne({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"|x|":Ne({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),ln:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-ln"}),midpoint:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-midpoint"}),segment:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-segment"}),line:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-line"}),ray:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-ray"}),parallel:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-parallel"}),perpendicular:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-perpendicular"}),circle:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-circle"}),arc:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-arc"}),angle:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-angle"}),directedangle:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angle"}),glider:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-glider"}),coterminal:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-coterminal"}),supplement:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-supplement"}),dilate:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-dilate"}),rotate:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-rotate"}),translate:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-translate"}),reflect:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-reflect"}),vertices:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-vertices"}),angles:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-angles"}),directedangles:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angles"}),segments:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-segments"}),radius:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-radius"}),center:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-center"}),intersection:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-intersection"}),area:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-area"}),perimeter:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-perimeter"}),log:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-log"}),quantile:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-quantile"}),quartile:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-quartile"}),var:Ke({}),varp:Ke({}),nCr:Ke({}),loga:Vn({command:"loga",content:"log_a",ariaLabelKey:"shared-calculator-narration-keypad-key-loga"}),stdev:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-stdev"}),mad:Ke({}),nPr:Ke({}),total:Ke({}),count:Ke({}),length:Ke({}),for:Ke({}),min:Ke({}),max:Ke({}),cov:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-cov"}),covp:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-covp"}),corr:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-corr"}),spearman:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-spearman"}),stats:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-stats"}),polygon:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-polygon"}),distance:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-distance"}),triangle:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-triangle"}),sphere:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-sphere"}),vector:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-vector"}),mean:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-mean"}),stdevp:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-stdevp"}),mod:Ke({}),"e^x":Ne({typedText:"e^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),"10^n":Ne({content:"\\times10^{n}",typedText:"*10^",ariaLabelKey:"shared-calculator-narration-keypad-key-10-n"}),"a^{-1}":Ne({typedText:"^-1",ariaLabelKey:"shared-calculator-narration-keypad-key-reciprocal"}),sum:Ne({content:"\\sum",ariaLabelKey:"shared-calculator-narration-keypad-key-sum"}),prod:Ne({content:"\\prod",ariaLabelKey:"shared-calculator-narration-keypad-key-product"}),floor:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-floor"}),ceil:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-ceil"}),round:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-round"}),abs:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"!":Ne({ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),"n!":Ne({typedText:"!",ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),median:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-median"}),lcm:Ke({}),gcd:Ke({}),gcf:Ke({}),ddx:Vn({command:"ddx",content:"\\frac{d}{dx}"}),integral:Vn({command:"integral",content:"\\int",ariaLabelKey:"shared-calculator-narration-keypad-key-int"}),"%":Ne({content:"\\%",ariaLabelKey:"shared-calculator-narration-keypad-key-percent-of"}),"->":Ne({content:"\\to",ariaLabelKey:"shared-calculator-narration-keypad-key-action-to"}),with:Ne({typedText:"with",content:"with",ariaLabelKey:"shared-calculator-narration-keypad-key-action-with"}),prime:Ne({typedText:"'",content:"f'",ariaLabelKey:"shared-calculator-narration-keypad-key-prime"}),exp:Ke({}),sign:Ke({}),normaldist:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-normaldist"}),poissondist:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-poissondist"}),binomialdist:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-binomialdist"}),uniformdist:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-uniformdist"}),erf:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-erf"}),histogram:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-histogram"}),boxplot:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-boxplot"}),dotplot:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-dotplot"}),tscore:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-tscore"}),ittest:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-ittest"}),ttest:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-ttest"}),tdist:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-tdist"}),chisqdist:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-chisqdist"}),pdf:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),cdf:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),random:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-random"}),inversecdf:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-inversecdf"}),hsv:Ke({}),rgb:Ke({}),sort:Ke({}),shuffle:Ke({}),unique:Ke({}),join:Ke({}),"A^-1":Vn({command:"A^-1",content:"A^{-1}",ariaLabelKey:"matrix-calculator-narration-keypad-key-inverse"}),"A^T":Vn({command:"A^T",content:"A^T",ariaLabelKey:"matrix-calculator-narration-keypad-key-transpose"}),"A^2":Vn({command:"A^2",content:"A^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"A^n":Ne({content:"A^n",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),det:Ke({ariaLabelKey:"matrix-calculator-narration-keypad-key-det"}),trace:Ke({ariaLabelKey:"matrix-calculator-narration-keypad-key-trace"}),rref:Ke({ariaLabelKey:"matrix-calculator-narration-keypad-key-rref"}),a:Ne({}),b:Ne({}),c:Ne({}),d:Ne({}),e:Ne({}),f:Ne({}),g:Ne({}),h:Ne({}),i:Ne({}),j:Ne({}),k:Ne({}),l:Ne({}),m:Ne({}),n:Ne({}),o:Ne({}),p:Ne({}),q:Ne({}),r:Ne({}),s:Ne({}),t:Ne({}),u:Ne({}),v:Ne({}),w:Ne({}),x:Ne({}),boldX:Ne({content:"x",typedText:"x"}),y:Ne({}),boldY:Ne({content:"y",typedText:"y"}),z:Ne({}),boldZ:Ne({content:"z",typedText:"z"}),A:Ne({}),B:Ne({}),C:Ne({}),D:Ne({}),E:Ne({}),F:Ne({}),G:Ne({}),H:Ne({}),I:Ne({}),J:Ne({}),K:Ne({}),L:Ne({}),M:Ne({}),N:Ne({}),O:Ne({}),P:Ne({}),Q:Ne({}),R:Ne({}),S:Ne({}),T:Ne({}),U:Ne({}),V:Ne({}),W:Ne({}),X:Ne({}),Y:Ne({}),Z:Ne({}),0:Ne({}),1:Ne({}),2:Ne({}),3:Ne({}),4:Ne({}),5:Ne({}),6:Ne({}),7:Ne({}),8:Ne({}),9:Ne({}),",":Ne({}),"=":Ne({}),"[":Ne({}),"]":Ne({}),"{}_left":Fw({keys:["{","}"]}),"{}_right":Nw({keys:["{","}"]}),"()_left":Fw({keys:["(",")"]}),"()_right":Nw({keys:["(",")"]}),"[]_left":Fw({keys:["[","]"]}),"[]_right":Nw({keys:["[","]"]}),",'_left":Fw({keys:[",","\u2032"]}),",'_right":Nw({keys:[",","\u2032"],typedText:"'"}),'"':Ne({}),"'":Ne({}),"~":Ne({}),":":Ne({}),">":Ne({}),"<":Ne({}),">=":Ne({content:"\\ge"}),"<=":Ne({content:"\\le"}),"!%_left":Fw({keys:["!","{}^{%}"]}),"!%_right":Nw({keys:["!","{}^{%}"],typedText:"%"}),"~:_left":Fw({keys:["~","{}^{:}"]}),"~:_right":Nw({keys:["~","{}^{:}"],typedText:":"}),real:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-real"}),imag:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-imag"}),conj:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-conj"}),arg:Ke({ariaLabelKey:"shared-calculator-narration-keypad-key-arg"}),"audio-trace-off":Qwe({contentKey:"graphing-calculator-button-keypad-audio-trace-off",command:"off"}),"hear-graph":(r,e,t={},o)=>x(cr,{command:Ge.const(r),disabled:hr(t.disabled,!1),colspan:hr(t.colspan,1),style:hr(t.style,"blue"),ariaLabel:Ge.const(void 0),onTap:()=>{e({type:"keypad/audio-trace",command:"hear-graph"})},children:[l("span",{class:Ge.const("dcg-play-icon-container"),children:l("i",{class:Ge.const("dcg-icon-play"),"aria-hidden":Ge.const("true")})}),l("span",{children:()=>o("graphing-calculator-button-audio-trace-hear-graph")})]}),"stop-graph":(r,e,t={},o)=>x(cr,{command:Ge.const(r),disabled:hr(t.disabled,!1),colspan:hr(t.colspan,1),style:hr(t.style,"blue"),onTap:()=>{e({type:"keypad/audio-trace",command:"stop-graph"})},children:[l("span",{class:Ge.const("dcg-stop-icon-container"),children:l("span",{class:Ge.const("dcg-stop-icon")})}),l("span",{children:()=>o("graphing-calculator-button-audio-trace-stop-graph")})]}),"volume-down":(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("graphing-calculator-narration-keypad-key-volume-down"),disabled:hr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"volume-down"}),children:l("span",{class:Ge.const("dcg-button-icon dcg-icon-only"),children:l("i",{class:Ge.const("dcg-icon-volume-down"),"aria-hidden":Ge.const("true")})})}),"volume-up":(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("graphing-calculator-narration-keypad-key-volume-up"),disabled:hr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"volume-up"}),children:l("span",{class:Ge.const("dcg-button-icon dcg-icon-only"),children:l("i",{class:Ge.const("dcg-icon-volume-up"),"aria-hidden":Ge.const("true")})})}),"speed-down":(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("graphing-calculator-narration-keypad-key-speed-down"),disabled:hr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"speed-down"}),children:l("span",{class:Ge.const("dcg-button-icon dcg-icon-only"),children:l("i",{class:Ge.const("dcg-icon-hide"),"aria-hidden":Ge.const("true")})})}),"speed-up":(r,e,t={},o)=>l(cr,{command:Ge.const(r),ariaLabel:()=>o("graphing-calculator-narration-keypad-key-speed-up"),disabled:hr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"speed-up"}),children:l("span",{class:Ge.const("dcg-button-icon dcg-icon-only"),children:l("i",{class:Ge.const("dcg-icon-show"),"aria-hidden":Ge.const("true")})})}),"previous-point":(r,e,t={},o)=>l(cr,{ariaLabel:()=>o("graphing-calculator-narration-keypad-key-previous-point"),command:Ge.const(r),disabled:hr(t.disabled,!1),colspan:hr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-point"}),children:l("span",{class:Ge.const("dcg-button-icon dcg-icon-only"),children:l("i",{class:Ge.const("dcg-icon-thin-arrow-left"),"aria-hidden":Ge.const("true")})})}),"next-point":(r,e,t={},o)=>l(cr,{ariaLabel:()=>o("graphing-calculator-narration-keypad-key-next-point"),command:Ge.const(r),disabled:hr(t.disabled,!1),colspan:hr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-point"}),children:l("span",{class:Ge.const("dcg-button-icon dcg-icon-only"),children:l("i",{class:Ge.const("dcg-icon-thin-arrow-right"),"aria-hidden":Ge.const("true")})})}),"previous-poi":(r,e,t={},o)=>l(cr,{ariaLabel:()=>o("graphing-calculator-narration-keypad-key-previous-poi"),command:Ge.const(r),disabled:hr(t.disabled,!1),colspan:hr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-poi"}),children:l("span",{class:Ge.const("dcg-button-icon dcg-icon-only"),children:l("i",{class:Ge.const("dcg-icon-hide"),"aria-hidden":Ge.const("true")})})}),"next-poi":(r,e,t={},o)=>l(cr,{ariaLabel:()=>o("graphing-calculator-narration-keypad-key-next-poi"),command:Ge.const(r),disabled:hr(t.disabled,!1),colspan:hr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-poi"}),children:l("span",{class:Ge.const("dcg-button-icon dcg-icon-only"),children:l("i",{class:Ge.const("dcg-icon-show"),"aria-hidden":Ge.const("true")})})}),"previous-curve":(r,e,t={},o)=>l(cr,{ariaLabel:()=>o("graphing-calculator-narration-keypad-key-previous-curve"),command:Ge.const(r),disabled:hr(t.disabled,!1),colspan:hr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-curve"}),children:l("span",{class:Ge.const("dcg-button-icon dcg-icon-only"),children:l("i",{class:Ge.const("dcg-icon-caret-up"),"aria-hidden":Ge.const("true")})})}),"next-curve":(r,e,t={},o)=>l(cr,{ariaLabel:()=>o("graphing-calculator-narration-keypad-key-next-curve"),command:Ge.const(r),disabled:hr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-curve"}),children:l("span",{class:Ge.const("dcg-button-icon dcg-icon-only"),children:l("i",{class:Ge.const("dcg-icon-caret-down"),"aria-hidden":Ge.const("true")})})})};function R(r,e,t={}){let o=r.dispatch;return eSe[e](e,o,t,r.s)}function Zr(r=1){return l("div",{style:Ge.const(`flex-grow:${r}`)})}var Mre=__dcg_shared_module_exports__['e'](j());var kY=class kY extends Mre.View{init(){this.controller=this.props.controller(),this.dispatch=this.controller.dispatch,this.s=this.controller.s}};kY.uuid=yc();var Qo=kY;var{IfElse:tSe}=nr.Components,lG=460,cG=class extends Qo{template(){return l(Pr,{controller:this.props.controller,children:x("div",{class:nr.const("dcg-audio-keypad-container"),children:[x("div",{class:nr.const("dcg-audio-keypad-column dcg-playback-column"),children:[l(Oe,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s"),children:l("div",{class:nr.const("dcg-btn-playback"),children:tSe(()=>this.controller.isAudioTracing(),{true:()=>R(this,"stop-graph",{disabled:this.bindFn(this.isAudioDisabled)}),false:()=>R(this,"hear-graph",{disabled:this.bindFn(this.isAudioDisabled)})})})}),l("div",{class:nr.const("dcg-key-nav-section-container"),children:l(Oe,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s"),children:x("div",{class:nr.const("dcg-key-nav-section"),children:[R(this,"volume-down",{disabled:this.bindFn(this.isVolumeDownDisabled)}),x("div",{role:nr.const("heading"),"aria-level":nr.const("2"),class:()=>({"dcg-key-nav-section-title-container":!0,"dcg-disabled":this.isAudioDisabled()}),children:[l("span",{class:nr.const("dcg-key-nav-section-title"),children:()=>this.controller.s("graphing-calculator-label-audio-trace-volume")}),l("span",{class:nr.const("dcg-keypad-volume-value dcg-key-nav-section-value"),children:()=>this.getAudioTraceVolume()})]}),R(this,"volume-up",{disabled:this.bindFn(this.isVolumeUpDisabled)})]})})}),l("div",{class:nr.const("dcg-key-nav-section-container"),children:l(Oe,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s"),children:x("div",{class:nr.const("dcg-key-nav-section"),children:[R(this,"speed-down",{disabled:this.bindFn(this.isSpeedDownDisabled)}),x("div",{class:()=>({"dcg-key-nav-section-title-container":!0,"dcg-disabled":this.isAudioDisabled()}),role:nr.const("heading"),"aria-level":nr.const("2"),children:[l("span",{class:nr.const("dcg-key-nav-section-title"),children:()=>this.controller.s("graphing-calculator-label-audio-trace-speed")}),l("span",{class:nr.const("dcg-keypad-speed-value dcg-key-nav-section-value"),children:()=>this.getAudioTraceSpeed()})]}),R(this,"speed-up",{disabled:this.bindFn(this.isSpeedUpDisabled)})]})})}),R(this,"audio-trace-off",{style:"highlight"})]}),l("div",{class:nr.const("dcg-audio-keypad-spacer")}),x("div",{class:nr.const("dcg-audio-keypad-column dcg-navigation-column"),children:[l("span",{class:nr.const("dcg-key-section-title dcg-center-col"),role:nr.const("heading"),"aria-level":nr.const("2"),children:()=>this.controller.s("graphing-calculator-heading-audio-trace-navigation")}),x("div",{class:nr.const("dcg-key-nav-section dcg-center-col"),children:[R(this,"previous-point",{disabled:this.bindFn(this.isPrevPointDisabled)}),l("div",{class:nr.const("dcg-key-nav-section-title-container"),role:nr.const("heading"),"aria-level":nr.const("2"),children:()=>this.controller.s("graphing-calculator-label-audio-trace-point")}),R(this,"next-point",{disabled:this.bindFn(this.isNextPointDisabled)})]}),x("div",{class:nr.const("dcg-key-nav-section"),children:[R(this,"previous-poi",{disabled:this.bindFn(this.isPrevPOIDisabled)}),l("div",{class:nr.const("dcg-key-nav-section-title-container dcg-poi-section-container"),role:nr.const("heading"),"aria-level":nr.const("2"),children:x(Ot,{i18n:this.const(this.controller),children:[l("span",{class:nr.const("dcg-key-nav-section-value"),children:"Point"}),l("span",{class:nr.const("dcg-key-nav-section-title"),children:"of Interest"})]},this.const("graphing-calculator-heading-keypad-audio-trace-point-of-interest"))}),R(this,"next-poi",{disabled:this.bindFn(this.isNextPOIDisabled)})]}),x("div",{class:nr.const("dcg-key-nav-section dcg-center-col"),children:[R(this,"previous-curve",{disabled:this.bindFn(this.isPrevCurveDisabled)}),l("div",{class:nr.const("dcg-key-nav-section-title-container"),role:nr.const("heading"),"aria-level":nr.const("2"),children:()=>this.controller.s("graphing-calculator-label-audio-trace-curve")}),R(this,"next-curve",{disabled:this.bindFn(this.isNextCurveDisabled)})]})]}),l("div",{class:nr.const("dcg-audio-keypad-spacer")}),x("div",{class:nr.const("dcg-audio-keypad-column dcg-screenreader-options"),children:[x("span",{class:nr.const("dcg-key-section-title"),role:nr.const("heading"),"aria-level":nr.const("2"),children:[()=>this.layoutWidth()<=lG?this.controller.s("graphing-calculator-heading-audio-trace-describe"):this.controller.s("graphing-calculator-heading-audio-trace-screen-reader"),l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-audio-trace-need-screen-reader"),gravity:this.const("s"),sticky:this.const(!0),children:l("i",{class:nr.const("dcg-icon-question-sign"),"aria-hidden":nr.const("true")})})]}),l(cr,{command:nr.const("describe-point"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-point"})},children:l("span",{children:()=>this.layoutWidth()<=lG?this.controller.s("graphing-calculator-button-keypad-describe-point-short"):this.controller.s("graphing-calculator-button-keypad-describe-point")})}),l(cr,{command:nr.const("describe-curve"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-curve"})},children:l("span",{children:()=>this.layoutWidth()<=lG?this.controller.s("graphing-calculator-button-keypad-describe-curve-short"):this.controller.s("graphing-calculator-button-keypad-describe-curve")})}),l(cr,{command:nr.const("describe-axes"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-axes"})},children:l("span",{children:()=>this.layoutWidth()<=lG?this.controller.s("graphing-calculator-label-axes"):this.controller.s("graphing-calculator-button-keypad-describe-axes")})})]})]})})}layoutWidth(){return this.controller.getLayoutMeasurements().width}isPrevPointDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToPrevPoint():!0}isNextPointDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToNextPoint():!0}isPrevPOIDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToPrevPOI():!0}isNextPOIDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToNextPOI():!0}isPrevCurveDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToPrevCurve():!0}isNextCurveDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToNextCurve():!0}isAudioDisabled(){return!this.controller.getAudio()}getAudioTraceVolume(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?"0%":`${r.getAudioVolume()*100}%`}isVolumeDownDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioVolume()<=0}isVolumeUpDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioVolume()>=1}getAudioTraceSpeed(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?"0":Zk[r.getAudioSpeedIndex()].displayedSpeed}isSpeedDownDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioSpeedIndex()<=0}isSpeedUpDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioSpeedIndex()===Zk.length-1}getDisabledTooltipText(){return this.isAudioDisabled()?this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"):""}};var On=__dcg_shared_module_exports__['e'](j());var{If:dG,For:Dre}=On.Components,pG=class extends Qo{template(){return x("div",{class:()=>({"dcg-functions-popover":!0,"dcg-popover":!0,"dcg-top":!0,"dcg-two-column":this.shouldRenderWithTwoColumns()}),id:this.const(`dcg-functions-popover-${Qo.uuid}`),role:On.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-button-functions"),children:[l("div",{class:On.const("dcg-popover-interior"),children:l("div",{class:On.const("dcg-interior-buttons"),children:l("div",{class:On.const("dcg-basic-keypad dcg-do-not-blur"),children:l(Dre,{each:this.bindFn(this.getKeypadKeys),children:r=>x("div",{class:On.const("dcg-keypad-keys-section"),children:[l(dG,{predicate:()=>r.title!==void 0,children:()=>x("div",{class:On.const("dcg-section-heading"),role:On.const("heading"),"aria-level":On.const("2"),children:[()=>r.title,l(dG,{predicate:()=>!!r.beta,children:()=>l("span",{class:On.const("dcg-beta-tag"),children:()=>this.controller.s("shared-calculator-narration-keypad-key-beta")})}),l(dG,{predicate:()=>!!r.helpLink,children:()=>l("a",{href:()=>r.helpLink.url,target:On.const("_blank"),"aria-label":()=>r.helpLink.tooltip,children:l("i",{class:On.const("dcg-icon-question-sign"),"aria-hidden":On.const("true")})})})]})}),l(dG,{predicate:()=>r.title===void 0,children:()=>l("div",{class:On.const("dcg-popover-section-separator"),role:On.const("separator")})}),l("div",{class:On.const("dcg-keypad-keys-buttons"),children:l(Dre,{each:()=>r.keys,children:e=>this.b(e)})})]})},r=>r.id)})})}),l("div",{class:On.const("dcg-arrow")})]})}shouldRenderWithTwoColumns(){let r=this.controller.getGraphSettings().config.projectorMode?410:375;return this.controller.getLayoutMeasurements().width<r}getInverseTrigSection(){let r=this.controller.areFunctionsRestricted()?["arcsin","arccos","arctan"]:["arcsin","arccos","arctan","arccsc","arcsec","arccot"];return{id:"inversetrig",title:this.controller.s("graphing-calculator-heading-inverse-trig"),keys:r}}getGeometryTools(){let r=["midpoint","intersection","segment","line","ray","vector","parallel","perpendicular","circle","arc","angle","directedangle","polygon","glider"];return{id:"geometry-tools",title:this.controller.s("graphing-calculator-heading-geometry-tools"),keys:r}}getGeometryTransformations(){let r=["dilate","rotate","reflect","translate"];return{id:"geometry-transformations",title:this.controller.s("graphing-calculator-heading-geometry-transformations"),keys:r}}getGeometryMeasurements(){let r=["distance","length","area","perimeter","vertices","angles","directedangles","segments","radius","center","coterminal","supplement"];return{id:"geometry-measurements",title:this.controller.s("graphing-calculator-heading-geometry-measurements"),keys:r}}getCalculatorGeometryMethods(){let r=!this.controller.areFunctionsRestricted()||this.controller.areGeometryFunctionsForceEnabled(),e=this.controller.isThreeDMode()?["segment","triangle","sphere","vector"]:["polygon"],t=this.controller.isThreeDMode()?["length","distance","midpoint"]:["distance","midpoint"],o=r?t:[];return{id:"geometry",title:this.controller.s("graphing-calculator-heading-geometry"),keys:[...e,...o]}}getTrigSection(){let r=this.controller.areFunctionsRestricted()?["sin","cos","tan"]:["sin","cos","tan","csc","sec","cot"];return{id:"trig",title:this.controller.s("graphing-calculator-heading-trig"),keys:r}}getHyperbolicTrigSection(){let r=this.controller.areFunctionsRestricted()?["sinh","cosh","tanh"]:["sinh","cosh","tanh","csch","sech","coth"];return{id:"hyperbtrig",title:this.controller.s("graphing-calculator-heading-hyperbolic-trig"),keys:r}}getListFunctions(){return{id:"lists",title:this.controller.s("graphing-calculator-heading-lists"),keys:["join","sort","shuffle","unique","for"]}}getStatTests(){return{id:"stat-tests",title:this.controller.s("graphing-calculator-heading-stat-tests"),keys:["ttest","tscore","ittest"]}}getStatsSection(){let r=["mean","median","min","max","quartile","quantile","stdev","stdevp","var"];return this.controller.areFunctionsRestricted()||(r=r.concat(["mad","cov","covp"])),r=r.concat(["corr","spearman","stats","count","total"]),{id:"stats",title:this.controller.s("graphing-calculator-heading-stats"),keys:r}}getMiscSection(){return{title:this.controller.s("graphing-calculator-button-functions-menu-number-theory"),id:"misc",keys:["lcm","gcd","mod","ceil","floor","round","sign","nthroot","nPr","nCr"]}}getVisualizationsSection(){return{title:this.controller.s("graphing-calculator-heading-dist-tab-visualizations"),id:"visualizations",keys:["histogram","dotplot","boxplot"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/360022405991-Data-Visualizations",tooltip:this.controller.s("graphing-calculator-narration-dist-tab-visualizations")}}}getCalculusSection(){return{title:this.controller.s("graphing-calculator-heading-calculus"),id:"calculus",keys:["exp","ln","log","loga","ddx","prime","integral","sum","prod"]}}getDistributionsSection(){return{title:this.controller.s("graphing-calculator-heading-dist-tab-distributions"),id:"distributions",keys:["normaldist","tdist","chisqdist","poissondist","binomialdist","uniformdist","pdf","cdf","inversecdf","random"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/360022401451-Distributions",tooltip:this.controller.s("graphing-calculator-narration-dist-tab-distributions")}}}getColorsSection(){return{title:this.controller.s("graphing-calculator-button-functions-menu-custom-colors"),id:"colors",keys:["rgb","hsv"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/4406795899533-Custom-Colors",tooltip:this.controller.s("graphing-calculator-button-functions-menu-custom-colors")}}}getAdvancedSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-advanced"),id:"advanced",keys:["->","with"],helpLink:{url:"https://help.desmos.com/hc/en-us/sections/4406370087053-Advanced-Features",tooltip:this.controller.s("graphing-calculator-heading-functions-menu-advanced")}}}getPolarSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-polar"),id:"polar",keys:["rho","theta","phi"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/15824510769805",tooltip:this.controller.s("graphing-calculator-heading-functions-menu-polar")}}}getSoundSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-sound"),id:"sound",keys:["tone"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/21373904717197-Tone",tooltip:this.controller.s("graphing-calculator-heading-functions-menu-sound")}}}getComplexSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-complex"),id:"complex",keys:["real","imag","conj","arg"]}}getKeypadKeys(){let r=[this.getTrigSection(),this.getInverseTrigSection(),this.getStatsSection(),this.getListFunctions()];return this.controller.areDistributionsEnabled()&&(this.controller.isThreeDMode()||r.push(this.getVisualizationsSection()),r.push(this.getDistributionsSection()),r.push(this.getStatTests())),r.push(this.getCalculusSection()),r.push(this.getHyperbolicTrigSection()),this.controller.is3dProduct()&&r.push(this.getPolarSection()),this.controller.isGeometry()?(r.push(this.getGeometryTools()),r.push(this.getGeometryMeasurements()),r.push(this.getGeometryTransformations())):r.push(this.getCalculatorGeometryMethods()),r.push(this.getColorsSection()),this.controller.toneAllowed()&&r.push(this.getSoundSection()),r.push(this.getMiscSection()),this.controller.isComplexModeEnabled()&&r.push(this.getComplexSection()),this.controller.areActionsEnabled()&&r.push(this.getAdvancedSection()),r}b(r){return R(this,r,{style:"popover"})}};var uG=__dcg_shared_module_exports__['e'](j()),ot=class extends uG.View{template(){return l("div",{class:uG.const("dcg-keypad-row"),children:this.props.children})}};var hG=class extends Qo{template(){return x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"a"),R(this,"b"),R(this,"c"),R(this,"d"),R(this,"e"),R(this,"f"),R(this,"g"),R(this,"h"),R(this,"i"),R(this,"j")]}),x(ot,{children:[R(this,"k"),R(this,"l"),R(this,"m"),R(this,"n"),R(this,"o"),R(this,"p"),R(this,"q"),R(this,"r"),R(this,"s"),R(this,"t")]}),x(ot,{children:[R(this,"shift",{style:"highlight"}),R(this,"u"),R(this,"v"),R(this,"w"),R(this,"x"),R(this,"y"),R(this,"z"),R(this,"theta"),R(this,"backspace",{colspan:2,style:"highlight"})]}),x(ot,{children:[R(this,"123",{colspan:2,style:"highlight"}),R(this,"a_b"),R(this,"!%_left"),R(this,"[]_left"),R(this,"{}_left"),R(this,this.controller.getGraphSettings().config.customRegressions?"~:_left":":")," ",R(this,",'_left"),R(this,"enter",{colspan:2,style:"blue"})]})]})}};var gG=class extends Qo{template(){return x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"A"),R(this,"B"),R(this,"C"),R(this,"D"),R(this,"E"),R(this,"F"),R(this,"G"),R(this,"H"),R(this,"I"),R(this,"J")]}),x(ot,{children:[R(this,"K"),R(this,"L"),R(this,"M"),R(this,"N"),R(this,"O"),R(this,"P"),R(this,"Q"),R(this,"R"),R(this,"S"),R(this,"T")]}),x(ot,{children:[R(this,"shift",{style:"highlight"}),R(this,"U"),R(this,"V"),R(this,"W"),R(this,"X"),R(this,"Y"),R(this,"Z"),R(this,"tau"),R(this,"backspace",{colspan:2,style:"highlight"})]}),x(ot,{children:[R(this,"123",{colspan:2,style:"highlight"}),R(this,"a^b"),R(this,"!%_right"),R(this,"[]_right"),R(this,"{}_right"),R(this,this.controller.getGraphSettings().config.customRegressions?"~:_right":":"),R(this,",'_right"),R(this,"enter",{colspan:2,style:"blue"})]})]})}};var _y=__dcg_shared_module_exports__['e'](j());var{IfElse:rSe}=_y.Components,mG=class extends Qo{template(){return x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"boldX"),R(this,"boldY"),rSe(()=>this.props.controller().isComplexModeEnabled(),{false:()=>R(this,"a^2"),true:()=>R(this,"i")}),R(this,"a^b"),Zr(.5),R(this,"7",{style:"highlight"}),R(this,"8",{style:"highlight"}),R(this,"9",{style:"highlight"}),R(this,"division"),Zr(.5),l(cr,{command:this.const("functions"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-functions"),colspan:this.const(2),style:this.const("highlight"),active:()=>this.controller.isKeypadFunctionsPopoverOpen(),onTap:()=>this.dispatch({type:"keypad/functions"}),ariaControls:this.const(`dcg-functions-popover-${Qo.uuid}`),ariaExpanded:()=>this.controller.isKeypadFunctionsPopoverOpen(),children:this.bindFn(this.getFuncsBtnText)})]}),x(ot,{children:[R(this,"("),R(this,")"),R(this,"<"),R(this,">"),Zr(.5),R(this,"4",{style:"highlight"}),R(this,"5",{style:"highlight"}),R(this,"6",{style:"highlight"}),R(this,"multiplication"),Zr(.5),R(this,"left",{style:"highlight"}),R(this,"right",{style:"highlight"})]}),x(ot,{children:[R(this,"|a|"),R(this,","),R(this,"<="),R(this,">="),Zr(.5),R(this,"1",{style:"highlight"}),R(this,"2",{style:"highlight"}),R(this,"3",{style:"highlight"}),R(this,"-"),Zr(1),R(this,"backspace",{colspan:1.5,style:"highlight"})]}),x(ot,{children:[l(cr,{command:_y.const("ABC"),colspan:this.const(1),additionalClass:this.const("dcg-abc-button--one-column"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-letters"),style:this.const("highlight"),onTap:()=>{this.dispatch({type:"keypad/abc"})},children:()=>this.controller.getLayoutMeasurements().width<=600?this.controller.raw("ABC"):this.controller.raw("A B C")}),l(cr,{command:_y.const("Audio"),disabled:()=>!this.controller.canAudioTrace(),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-audio-trace"),colspan:this.const(1),style:()=>"highlight",onTap:()=>this.dispatch({type:"keypad/audio-trace",command:"on"}),children:l("i",{class:_y.const("dcg-icon-volume"),"aria-hidden":_y.const("true")})}),R(this,"sqrt"),R(this,"pi"),Zr(.5),R(this,"0",{style:"highlight"}),R(this,".",{style:"highlight"}),R(this,"="),R(this,"+"),Zr(.5),R(this,"enter",{colspan:2,style:"blue"})]})]})}getFuncsBtnText(){return this.controller.isNarrow()?this.controller.s("graphing-calculator-button-funcs"):this.controller.s("graphing-calculator-button-functions")}};var bG=__dcg_shared_module_exports__['e'](j());var{If:oSe}=bG.Components,fG=class extends Qo{template(){return x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"boldX"),R(this,"boldY"),R(this,"boldZ"),R(this,"a^b"),Zr(.5),R(this,"7",{style:"highlight"}),R(this,"8",{style:"highlight"}),R(this,"9",{style:"highlight"}),R(this,"division"),Zr(.5),l(cr,{command:this.const("functions"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-functions"),colspan:this.const(2),style:this.const("highlight"),active:()=>this.controller.isKeypadFunctionsPopoverOpen(),onTap:()=>this.dispatch({type:"keypad/functions"}),ariaControls:this.const(`dcg-functions-popover-${Qo.uuid}`),ariaExpanded:()=>this.controller.isKeypadFunctionsPopoverOpen(),children:this.bindFn(this.getFuncsBtnText)})]}),x(ot,{children:[R(this,"("),R(this,")"),R(this,"<"),R(this,">"),Zr(.5),R(this,"4",{style:"highlight"}),R(this,"5",{style:"highlight"}),R(this,"6",{style:"highlight"}),R(this,"multiplication"),Zr(.5),R(this,"left",{style:"highlight"}),R(this,"right",{style:"highlight"})]}),x(ot,{children:[R(this,"|a|"),R(this,","),R(this,"<="),R(this,">="),Zr(.5),R(this,"1",{style:"highlight"}),R(this,"2",{style:"highlight"}),R(this,"3",{style:"highlight"}),R(this,"-"),Zr(1),R(this,"backspace",{colspan:1.5,style:"highlight"})]}),x(ot,{children:[l(cr,{command:bG.const("ABC"),colspan:()=>this.controller.isComplexModeEnabled()?1:2,additionalClass:()=>this.controller.isComplexModeEnabled()?"dcg-abc-button--one-column":void 0,ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-letters"),style:this.const("highlight"),onTap:()=>{this.dispatch({type:"keypad/abc"})},children:()=>this.controller.isComplexModeEnabled()&&this.controller.getLayoutMeasurements().width<=600?this.controller.raw("ABC"):this.controller.raw("A B C")}),l(oSe,{predicate:()=>this.controller.isComplexModeEnabled(),children:()=>R(this,"i")}),R(this,"sqrt"),R(this,"pi"),Zr(.5),R(this,"0",{style:"highlight"}),R(this,".",{style:"highlight"}),R(this,"="),R(this,"+"),Zr(.5),R(this,"enter",{colspan:2,style:"blue"})]})]})}getFuncsBtnText(){return this.controller.isNarrow()?this.controller.s("graphing-calculator-button-funcs"):this.controller.s("graphing-calculator-button-functions")}};var yG=class extends Qo{template(){return x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"q"),R(this,"w"),R(this,"e"),R(this,"r"),R(this,"t"),R(this,"y"),R(this,"u"),R(this,"i"),R(this,"o"),R(this,"p")]}),x(ot,{children:[R(this,"a"),R(this,"s"),R(this,"d"),R(this,"f"),R(this,"g"),R(this,"h"),R(this,"j"),R(this,"k"),R(this,"l"),R(this,"theta")]}),x(ot,{children:[R(this,"shift",{colspan:1.364,style:"highlight"}),Zr(.136),R(this,"z"),R(this,"x"),R(this,"c"),R(this,"v"),R(this,"b"),R(this,"n"),R(this,"m"),Zr(.136),R(this,"backspace",{colspan:1.364,style:"highlight"})]}),x(ot,{children:[R(this,"123",{colspan:1.818,style:"highlight"}),Zr(.182),R(this,"a_b"),R(this,"!%_left"),R(this,"[]_left"),R(this,"{}_left"),R(this,this.controller.getGraphSettings().config.customRegressions?"~:_left":":"),R(this,",'_left"),Zr(.182),R(this,"enter",{colspan:1.818,style:"blue"})]})]})}};var xG=class extends Qo{template(){return x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"Q"),R(this,"W"),R(this,"E"),R(this,"R"),R(this,"T"),R(this,"Y"),R(this,"U"),R(this,"I"),R(this,"O"),R(this,"P")]}),x(ot,{children:[R(this,"A"),R(this,"S"),R(this,"D"),R(this,"F"),R(this,"G"),R(this,"H"),R(this,"J"),R(this,"K"),R(this,"L"),R(this,"tau")]}),x(ot,{children:[R(this,"shift",{colspan:1.364,active:!0,style:"highlight"}),Zr(.136),R(this,"Z"),R(this,"X"),R(this,"C"),R(this,"V"),R(this,"B"),R(this,"N"),R(this,"M"),Zr(.136),R(this,"backspace",{colspan:1.364,style:"highlight"})]}),x(ot,{children:[R(this,"123",{colspan:1.818,style:"highlight"}),Zr(.182),R(this,"a^b"),R(this,"!%_right"),R(this,"[]_right"),R(this,"{}_right"),R(this,this.controller.getGraphSettings().config.customRegressions?"~:_right":":"),R(this,",'_right"),Zr(.182),R(this,"enter",{colspan:1.818,style:"blue"})]})]})}};var{SwitchUnion:iSe,If:_Y}=wi.Components,vG=class extends Qo{template(){return x("div",{class:wi.const("dcg-keypad"),role:wi.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-keypad"),children:[l("div",{class:()=>({"dcg-keys-container":!0,"dcg-smaller-functions-text":this.controller.getLayoutMeasurements().width<650,"dcg-small-ABC":this.controller.getLayoutMeasurements().width<490,"dcg-smaller-ABC":this.controller.getLayoutMeasurements().width<420,"dcg-smallest-ABC":this.controller.getLayoutMeasurements().width<380}),style:this.bindFn(this.computeStyles),didMount:this.bindFn(this.didMountContainer),"aria-hidden":()=>!this.controller.isKeypadOpen(),children:x("div",{class:wi.const("dcg-keys-background dcg-do-not-blur"),children:[x("div",{class:wi.const("dcg-keys"),children:[iSe(()=>this.controller.getKeypadLayout(),{letters:()=>l(yG,{controller:this.props.controller}),capitalLetters:()=>l(xG,{controller:this.props.controller}),mainNumbers:()=>l(mG,{controller:this.props.controller}),mainNumbers3D:()=>l(fG,{controller:this.props.controller}),noQwertyLetters:()=>l(hG,{controller:this.props.controller}),noQwertyCapitalLetters:()=>l(gG,{controller:this.props.controller}),audio:()=>l(cG,{controller:this.props.controller})}),l(_Y,{predicate:()=>this.controller.isKeypadFunctionsPopoverOpen(),children:()=>l(pG,{controller:this.props.controller})})]}),l(_Y,{predicate:()=>this.controller.isHideKeypadButtonVisible(),children:()=>l("div",{class:wi.const("dcg-minimize-keypad-container"),children:l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-hide-keypad"),gravity:this.const("n"),offset:this.const({left:6}),children:x("div",{role:wi.const("button"),"aria-expanded":wi.const("true"),"aria-controls":this.const(Qo.uuid),"aria-label":()=>this.controller.s("graphing-calculator-label-hide-keypad"),class:wi.const("dcg-minimize-keypad"),onTap:()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!0})},children:[l("i",{class:wi.const("dcg-icon-keyboard"),"aria-hidden":wi.const("true")}),l("i",{class:wi.const("dcg-icon-caret-down"),"aria-hidden":wi.const("true")})]})})})})]})}),l(_Y,{predicate:this.bindFn(this.isShowKeypadButtonVisible),children:()=>l("div",{class:wi.const("dcg-show-keypad-container"),children:l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-show-keypad"),gravity:this.const("n"),children:x("div",{role:wi.const("button"),"aria-expanded":wi.const("false"),"aria-controls":this.const(Qo.uuid),"aria-label":()=>this.controller.s("graphing-calculator-label-show-keypad"),class:wi.const("dcg-btn-flat-gray dcg-show-keypad dcg-do-not-blur"),onTap:()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!1})},children:[l("i",{class:wi.const("dcg-icon-keyboard"),"aria-hidden":wi.const("true")}),l("i",{class:wi.const("dcg-icon-caret-up dcg-do-not-blur"),"aria-hidden":wi.const("true")})]})})})})]})}didMountContainer(r){this.containerElt=r}isShowKeypadButtonVisible(){return this.controller.getBrailleMode()!=="none"?!1:!this.controller.isKeypadOpen()&&!this.controller.isNarrow()&&!this.controller.isInEditListMode()&&(this.controller.isListVisible()||this.controller.inAudioTraceMode())}didMount(){this.updatePopoverPosition()}didUpdate(){this.updatePopoverPosition()}computeStyles(){let r={};return this.controller.isNarrow()||(r.transition="transform .3s, opacity .3s"),this.controller.isKeypadOpen()||(r.opacity="0",r.transform="translate3d(0, 255px, 0)"),r}updatePopoverPosition(){if(!this.controller.isKeypadFunctionsPopoverOpen()){this.__popoverCache=void 0;return}let r=this.controller.computeMajorLayout(),e={keypadTop:r.keypad.top,keypadWidth:r.keypad.width,keypadHeight:r.keypad.height,showToLeft:r.grapher.height<525};if(__dcg_shared_module_exports__['db'](e,this.__popoverCache))return;this.__popoverCache=e;let t=this.containerElt,o=t.querySelector("[dcg-command=functions]"),i=t.querySelector(".dcg-functions-popover"),n=t.querySelector(".dcg-arrow");if(e.showToLeft){i.classList.remove("dcg-top"),i.classList.add("dcg-left");let s=e.keypadHeight-(yo(o).top-yo(t).top)-o.offsetHeight/2-2-10;n.style.left="auto",n.style.bottom=`${s}px`}else i.classList.remove("dcg-left"),i.classList.add("dcg-top"),n.style.left=`${i.offsetWidth-o.offsetWidth/2}px`,n.style.bottom="auto"}};Ut();Ut();var nSe=function(){{let o=!1,i=function(){n(document),o=!0},n=function(a){o||re(a).bind("touchstart",s=>{let c=re(s.target),d=0,p=null;if(!c[0].closest("[disablescroll]"))for(;d===0&&c.length&&c[0].tagName!==void 0;){let u=getComputedStyle(c[0]).overflow,g=getComputedStyle(c[0]).overflowY;if(u!=="hidden"&&u!=="visible"&&g!=="hidden"&&g!=="hidden"){let h=c.scrollTop();h!==0&&(d=2),c.scrollTop(h+1),c.scrollTop()!==h&&(d=1|d,c.scrollTop(h))}c=re(c[0].parentElement)}if(d!==0){p=[];let u=s.originalEvent.touches;for(let g=0;g<u.length;g++){let h={};for(let b in u[g])u[g].hasOwnProperty(b)&&(h[b]=u[g][b]);p.push(h)}}re(document).on("touchmove.scrollfix",u=>{if(p){let g=p[0],b=u.originalEvent.touches[0].screenY-g.screenY;(b>0&&!(d&2)||b<0&&!(d&1))&&(d=0),b&&(p=null)}d===0&&u.preventDefault()}),re(document).on("touchend.scrollfix",()=>{re(document).off(".scrollfix")})})};return{limitScrollOnElement:n,limitScrollOnDocument:i}}}();var{limitScrollOnElement:wG,limitScrollOnDocument:Are}=nSe;Ut();function N_(r){re(r).on("drag dragend dragenter dragover dragleave drop",t=>{t.preventDefault(),t.stopPropagation()})}var aa=__dcg_shared_module_exports__['e'](j());var fl=__dcg_shared_module_exports__['e'](j());var{For:aSe,SwitchUnion:sSe,If:lSe}=fl.Components,SG=class extends fl.View{init(){this.controller=this.props.controller()}template(){return x("div",{role:fl.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tools"),class:fl.const("dcg-geo-basic-tools dcg-animate-in-after-initial-load dcg-complex-tool-instruction-view"),children:[l(dw,{ariaLabel:()=>this.controller.s("account-shell-button-mygraphs-cancel"),controller:this.props.controller,onBack:this.bindFn(this.onCancel)}),l(aSe,{each:()=>this.getInputIndexes(),children:e=>l(TY,{activeStep:this.bindFn(this.getInputIndex),controller:this.props.controller,toolSpec:()=>this.getToolSpec(),stepIdx:()=>e})})]})}onCancel(){this.controller.dispatch({type:"select-geo-tool",tool:"selection"}),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:"selection"}})}getInputIndex(){return this.controller.getGeoModel().getNonObjectsState().ui.currentTool.inputIndex}getInputIndexes(){return this.getToolSpec().inputs.map((e,t)=>t)}getToolSpec(){return this.controller.getGeoModel().getCurrentTool().getSpec()}},TY=class extends fl.View{init(){this.controller=this.props.controller()}template(){return sSe(()=>this.getInputType(),{completed:()=>l("span",{}),upcoming:()=>l("span",{class:fl.const("dcg-step-upcoming"),children:l("span",{})}),active:()=>x("span",{class:fl.const("dcg-active-step"),children:[l("span",{class:fl.const("dcg-step-active-icon"),children:l("span",{children:()=>this.props.stepIdx()+1})}),l("span",{class:fl.const("dcg-active-step-text"),children:this.bindFn(this.getActiveString)}),l(lSe,{predicate:this.bindFn(this.isNumberInputStep),children:()=>x("span",{class:fl.const("dcg-input-flex-container"),didMount:this.bindFn(this.didMountNumberInput),children:[l(or,{containerClass:()=>({"dcg-suffix-degree":this.getNumberUnits()==="\xB0","dcg-suffix-radian":this.getNumberUnits()==="rad"}),readonly:()=>!1,latex:()=>this.getNumberInputLatex(),ariaLabel:this.bindFn(this.getActiveString),isFocused:()=>this.isNumberInputFocused(),handleFocusChanged:(e,t)=>this.handleFocusedChanged(e,t),hasError:this.bindFn(this.doesNumberInputHaveError),controller:this.props.controller,handlePressedKey:(e,t)=>{this.handlePressedKey(e,t)},handleLatexChanged:e=>{this.handleLatexChanged(e)},handleSelectionChanged:e=>{this.handleLatexChanged(e.latex,!0)},dataLabelAttributeValue:this.const("transformation-number")}),l("span",{class:()=>({"dcg-action-submit":!0,"dcg-disabled":this.isSubmitNumberDisabled(),"dcg-btn-purple":!0}),role:fl.const("button"),tabIndex:()=>this.isSubmitNumberDisabled()?-1:0,"aria-disabled":this.bindFn(this.isSubmitNumberDisabled),onTap:e=>this.submitNumberInput({device:e.device}),children:()=>this.controller.s("shared-calculator-button-go")})]})})]})})}getNumberUnits(){return this.controller.getActiveTool()==="rotate"?this.controller.getDegreeMode()?"\xB0":"rad":""}didMountNumberInput(){this.controller.dispatch({type:"set-focus-location",location:{type:"new-transformation-number"}})}isNumberInputFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="new-transformation-number")}doesNumberInputHaveError(){var c;if(!this.getNumberInputLatex()||this.getNumberInputLatex()===((c=this.getStep().numberInputInfo)==null?void 0:c.defaultLatex))return!1;let t=this.props.toolSpec().outputs[0].id,{idMap:o}=this.controller.getGeoModel().getNonObjectsState().ui.currentTool,i=o[t];if(!i)return!0;let n=N0(this.controller.getListModel()).filter(d=>{var p;if(d.type==="expression")return i===((p=Go(d))==null?void 0:p.latex)}),a=n[0];if(!a||n.length===0||n.length>1||a.error)return!0;let s=a.formula.typed_constant_value;if(!s)return!0;if(__dcg_shared_module_exports__['wa'](s.valueType,__dcg_shared_module_exports__['W'])){let d=__dcg_shared_module_exports__['qa'](s.valueType)?s.value:[s.value];for(let p of d){let[[u,g],[h,b]]=p;if(isNaN(u)||isNaN(g)||isNaN(h)||isNaN(b))return!0}return!1}return!0}handlePressedKey(e,t){let o=Qe.getFocusedMathquill();if(e==="Enter"){this.submitNumberInput({device:"keyboard"});return}o&&(o.keystroke(e,t),this.handleLatexChanged(o.latex()))}getNumberInputLatex(){return this.controller.getGeoModel().getCurrentTool().getNumberInputLatex()}isSubmitNumberDisabled(){return!!(this.doesNumberInputHaveError()||!this.getNumberInputLatex())}submitNumberInput(e){var s,c;if(this.isSubmitNumberDisabled())return;let t=this.controller.getGeoModel(),o=this.controller.getActiveTool(),i=t.getCurrentTool(),n=(s=i.getSpec)==null?void 0:s.call(i),a=i.tryCommitResults();a.committed&&(this.controller.dispatch({type:"commit-geo-objects",...a}),(c=this.controller.get2dPOIController())==null||c.speakGeoReleaseAction(o,n,a.committed),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}))}handleLatexChanged(e,t){(this.getNumberInputLatex()!==e||t)&&(this.controller.getGeoModel().getCurrentTool().onNumberInput(e),this.controller.getGeoModel().onPreviewChange())}handleFocusedChanged(e,t){e&&!this.isNumberInputFocused()?this.controller.dispatch({type:"set-focus-location",location:{type:"new-transformation-number"}}):this.isNumberInputFocused()&&this.controller.dispatch({type:"blur-focus-location",location:{type:"new-transformation-number"}})}getActiveString(){let e=this.props.controller(),t=this.getStep().hint;return t?e.s(t):e.s("shared-calculator-narration-item-unknown")}isNumberInputStep(){return!!this.getStep().numberInputInfo}getStep(){return this.props.toolSpec().inputs[this.props.stepIdx()]}getInputType(){let e=this.props.activeStep(),t=this.props.stepIdx();return t<e?"completed":t>e?"upcoming":"active"}};var{SwitchUnion:cSe,If:Lre}=aa.Components,kG=class extends aa.View{constructor(){super(...arguments),this.afterInitialLoad=!1}init(){this.controller=this.props.controller()}template(){return x("div",{class:()=>({"dcg-geometry-toolbar-view":!0,"dcg-after-initial-load":this.afterInitialLoad}),style:()=>({left:`${this.controller.computeMajorLayout().grapher.left}px`}),onTapStart:this.bindFn(this.onTapStart),children:[x("div",{class:aa.const("dcg-header-left dcg-do-blur"),children:[l(Lre,{predicate:this.bindFn(this.showHamburger),children:()=>l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),gravity:this.const("s"),children:l("div",{role:aa.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),tabIndex:aa.const("0"),class:aa.const("dcg-action-opendrawer dcg-icon-btn dcg-in-api-action-opendrawer"),onTap:()=>this.controller.dispatch({type:"open-drawer"}),children:l("i",{class:aa.const("dcg-icon-hamburger"),"aria-hidden":aa.const("true")})})})}),l(Lre,{predicate:this.bindFn(this.showOpenExpressionsButton),children:()=>l("div",{class:aa.const("dcg-show-expressions-tab dcg-icon-btn"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),role:aa.const("button"),tabIndex:aa.const("0"),onTap:e=>{this.controller.dispatch({type:"show-expressions-list",focusHideIcon:e.device==="keyboard"})},manageFocus:this.const(ze({controller:this.controller,location:{type:"show-expression-list-btn"}})),children:l("i",{class:aa.const("dcg-icon-show"),"aria-hidden":aa.const("true")})})})]}),l("div",{class:aa.const("dcg-flex-spacer dcg-do-blur")}),cSe(this.bindFn(this.getViewToShow),{tools:()=>l(nL,{controller:this.props.controller}),selectedItems:()=>l(uL,{controller:this.props.controller}),complexToolInstructions:()=>l(SG,{controller:this.props.controller})}),l("div",{class:aa.const("dcg-flex-spacer dcg-do-blur")})]})}showHamburger(){return this.controller.getGraphSettings().config.showHamburger?!this.controller.isListEnabled()||!this.controller.isListVisible()||this.controller.isNarrow():!1}showOpenExpressionsButton(){return this.controller.isListEnabled()&&!this.controller.isListVisible()&&!this.controller.isNarrow()}willUpdate(){this.afterInitialLoad||this.getViewToShow()==="selectedItems"&&(this.afterInitialLoad=!0)}onTapStart(e){e.target.classList.contains("dcg-do-blur")&&(this.controller.dispatch({type:"set-none-selected"}),this.controller.dispatch({type:"select-geo-tool",tool:"selection"}))}getViewToShow(){let e=this.controller.getActiveTool();return __dcg_shared_module_exports__['Pc'](e)?"complexToolInstructions":this.controller.shouldShowMultiSelectHeader()?"selectedItems":"tools"}};var Km=__dcg_shared_module_exports__['e'](j());var Cy=__dcg_shared_module_exports__['e'](j());var Uw=class extends Cy.View{init(){this.controller=this.props.controller()}template(){return x("div",{class:()=>({"dcg-btn-flat-gray":this.props.isPillbox(),"dcg-btn-flat-gray-group":this.props.isPillbox(),"dcg-group-horizontal":this.props.isPillbox()}),children:[l(Oe,{tooltip:()=>this.controller.getshowKeyboardShortcutsInTooltips()?this.controller.s("graphing-calculator-label-undo-with-shortcut-tooltip"):this.controller.s("graphing-calculator-label-undo-tooltip"),gravity:this.const("s"),disabled:()=>!this.controller.canUndo(),displayBlock:this.props.isPillbox,children:l("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-action-undo":!0,"dcg-icon-btn":!0,"dcg-pillbox-btn-interior":this.props.isPillbox(),"dcg-disabled":!this.controller.canUndo()}),tabIndex:()=>this.controller.canUndo()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-narration-undo"),onTap:this.bindFn(this.undo),"aria-disabled":()=>!this.controller.canUndo(),children:l("i",{class:Cy.const("dcg-icon-undo"),"aria-hidden":Cy.const("true")})})}),l(Oe,{tooltip:()=>this.controller.getshowKeyboardShortcutsInTooltips()?this.controller.s("graphing-calculator-label-redo-with-shortcut-tooltip"):this.controller.s("graphing-calculator-label-redo-tooltip"),gravity:this.const("s"),disabled:()=>!this.controller.canRedo(),displayBlock:this.props.isPillbox,children:l("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-action-redo":!0,"dcg-icon-btn":!0,"dcg-pillbox-btn-interior":this.props.isPillbox(),"dcg-disabled":!this.controller.canRedo()}),tabIndex:()=>this.controller.canRedo()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-narration-redo"),onTap:()=>this.controller.dispatch({type:"redo"}),"aria-disabled":()=>!this.controller.canRedo(),children:l("i",{class:Cy.const("dcg-icon-redo"),"aria-hidden":Cy.const("true")})})})]})}undo(){this.controller.hasVisibleAndUndoableToast()?this.controller.dispatch({type:"toast/undo"}):this.controller.dispatch({type:"undo"})}};var Gc=__dcg_shared_module_exports__['e'](j());var{If:dSe}=Gc.Components,Rm=class extends Gc.View{init(){this.controller=this.props.controller()}template(){return l(Oe,{tooltip:this.bindFn(this.getTooltip),gravity:this.const("w"),children:x("div",{class:()=>({"dcg-action-settings":!0,"dcg-pillbox-btn-interior":!0,"dcg-icon-btn":!0,"dcg-btn-flat-gray":this.isPillbox(),"dcg-settings-pillbox":this.isPillbox()}),role:Gc.const("button"),tabIndex:Gc.const("0"),"aria-haspopup":Gc.const("true"),"aria-expanded":()=>this.controller.isGraphSettingsOpen(),"aria-label":this.bindFn(this.getTooltip),onTap:this.bindFn(this.onTapSettingsButton),manageFocus:this.const(ze({controller:this.controller,location:{type:"settings",location:"icon"}})),children:[l("i",{class:Gc.const("dcg-icon-wrench"),"aria-hidden":Gc.const("true")}),l(dSe,{predicate:()=>this.controller.getLockViewportUserSetting()||this.controller.getLockRotationUserSetting(),children:()=>l("i",{class:Gc.const("dcg-icon-lock"),"aria-hidden":Gc.const("true")})})]})})}getTooltip(){return this.controller.isGeometry()?this.controller.s("graphing-calculator-label-tooltip-geometry-settings"):this.controller.s("graphing-calculator-label-tooltip-graph-settings")}isPillbox(){return this.props.isPillbox&&this.props.isPillbox()}onTapSettingsButton(e){this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:e.device==="keyboard"})}};var Rn=__dcg_shared_module_exports__['e'](j()),{SwitchUnion:pSe}=Rn.Components,U_=class extends Rn.View{template(){return this.controller=this.props.controller(),pSe(()=>this.controller.getBrandingMode(),{"static-edit-link":()=>l("div",{class:Rn.const("dcg-graphpaper-branding"),children:x("a",{href:()=>this.controller.getEditLink(),target:Rn.const("_blank"),children:[l("span",{class:Rn.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-on-desmos"),children:()=>this.controller.s("graphing-calculator-link-edit-on-desmos")}),l("i",{class:Rn.const("dcg-icon-desmos"),"aria-hidden":Rn.const("true")})]})}),"edit-link":()=>l("div",{class:Rn.const("dcg-graphpaper-branding"),children:x("span",{class:Rn.const("dcg-edit-branding"),onTap:()=>this.controller.dispatch({type:"open-on-web"}),children:[l("span",{class:Rn.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-on-desmos"),children:()=>this.controller.s("graphing-calculator-link-edit-on-desmos")}),l("i",{class:Rn.const("dcg-icon-desmos"),"aria-hidden":Rn.const("true")})]})}),"powered-by":()=>x("div",{class:Rn.const("dcg-graphpaper-branding dcg-unclickable"),children:[l("span",{class:Rn.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-powered-by-desmos"),children:()=>this.controller.s("graphing-calculator-label-powered-by")}),l("i",{class:Rn.const("dcg-icon-desmos"),"aria-hidden":Rn.const("true")})]})})}};var Nh=__dcg_shared_module_exports__['e'](j());var Y_=class extends Nh.View{init(){this.controller=this.props.controller()}template(){return l("div",{class:Nh.const("dcg-reset-container"),children:l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-reset"),gravity:this.props.tooltipGravity,children:l("div",{class:Nh.const("dcg-reset-pillbox dcg-action-reset dcg-btn-flat-gray dcg-pillbox-btn-interior"),role:Nh.const("button"),tabIndex:Nh.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-reset"),onTap:this.bindFn(this.reset),children:l("i",{class:Nh.const("dcg-icon-reset"),"aria-hidden":Nh.const("true")})})})})}reset(){this.controller.dispatch({type:"reset-graph"})}};var eu=__dcg_shared_module_exports__['e'](j());var B_=class extends eu.View{init(){this.controller=this.props.controller()}template(){return x("div",{class:()=>({"dcg-3d-orientation-pillbox":!0,"dcg-btn-flat-gray":!0,"dcg-btn-flat-gray-group":!0,"dcg-group-horizontal":this.props.layout()==="horizontal","dcg-group-vertical":this.props.layout()==="vertical"}),role:eu.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-3d-orientation-options-label"),children:[l(Oe,{disabled:this.bindFn(this.isDefaultOrientation),tooltip:this.bindFn(this.getDefaultOrientationLabel),gravity:this.bindFn(this.getTooltipGravity),displayBlock:this.const(!0),children:l("div",{class:()=>({"dcg-action-defaultorientation":!0,"dcg-pillbox-btn-interior":!0,"dcg-disabled":this.isDefaultOrientation()}),role:eu.const("button"),"aria-disabled":this.bindFn(this.isDefaultOrientation),tabIndex:()=>this.isDefaultOrientation()?-1:0,"aria-label":this.bindFn(this.getDefaultOrientationLabel),onTap:this.bindFn(this.rotateToDefaultOrientation),children:l("i",{class:eu.const("dcg-icon-3d-cube"),"aria-hidden":eu.const("true")})})}),l(Oe,{tooltip:this.bindFn(this.getXYOrientationLabel),gravity:this.bindFn(this.getTooltipGravity),disabled:this.bindFn(this.isXYPlaneOrientation),displayBlock:this.const(!0),children:l("div",{class:()=>({"dcg-action-xyorientation":!0,"dcg-pillbox-btn-interior":!0,"dcg-disabled":this.isXYPlaneOrientation()}),role:eu.const("button"),"aria-disabled":this.bindFn(this.isXYPlaneOrientation),tabIndex:()=>this.isXYPlaneOrientation()?-1:0,"aria-label":this.bindFn(this.getXYOrientationLabel),onTap:this.bindFn(this.rotateToXyOrientation),children:l("i",{class:eu.const("dcg-icon-xy-plane"),"aria-hidden":eu.const("true")})})})]})}getTooltipGravity(){return this.props.layout()==="horizontal"?"s":"w"}rotateToDefaultOrientation(){this.controller.dispatch({type:"zoom",direction:"default3dOrientation"})}rotateToXyOrientation(){this.controller.dispatch({type:"zoom",direction:"xy3dOrientation"})}isDefaultOrientation(){var t;let e=(t=this.controller.getGrapher3d())==null?void 0:t.controls;return!!(e!=null&&e.isDefaultOrientation())}isXYPlaneOrientation(){var t;let e=(t=this.controller.getGrapher3d())==null?void 0:t.controls;return!!(e!=null&&e.isXYPlaneOrientation())}getDefaultOrientationLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-default-orientation")}getXYOrientationLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-xy-orientation")}};var zt=__dcg_shared_module_exports__['e'](j());Ut();var bl=function(r,e,t){if(r===void 0||e===void 0)return!1;let o,i=e.getBoundingClientRect().height,n=r.getBoundingClientRect().height,a=yo(r),s=yo(e);if(!a||!s)return!1;let c=e.scrollTop,d=a.top+c-s.top,p=d-t,u=n+d+t-i;if(p>=u)o=Math.min(Math.max(c,u),p);else{let g=.5*(p+u),h=p+t;o=Math.min(g,h)}return o!==c?(e.scrollTop=o,e.scrollTop!=c):!1};var Xl=__dcg_shared_module_exports__['e'](j());var _G=__dcg_shared_module_exports__['e'](j());var Ty=class extends _G.View{template(){return x("div",{class:_G.const("dcg-checkbox-title dcg-lock-viewport-option"),children:[l(ft,{ariaLabel:()=>this.props.controller().s("graphing-calculator-label-settings-lock-viewport"),onChange:()=>{this.props.controller().dispatch({type:"toggle-lock-viewport"})},checked:()=>this.props.controller().getLockViewportUserSetting(),children:()=>this.props.controller().s("graphing-calculator-label-settings-lock-viewport")}),l(Vp,{href:this.const("https://help.desmos.com/hc/en-us/articles/4405296853517#h_01FZX4DBWKD83TZVMH615XF3QA"),controller:this.props.controller})]})}};var{If:CG}=Xl.Components,TG=class extends Xl.View{init(){this.controller=this.props.controller(),this.isOpen=this.getAxisScale("x")==="logarithmic"||this.getAxisScale("y")==="logarithmic"||this.controller.getLockViewportUserSetting()}template(){return x("div",{class:Xl.const("dcg-advanced-graph-settings-view"),children:[l(CG,{predicate:()=>this.shouldShowLogScalesOption(),children:()=>x("div",{children:[x("div",{class:()=>({"dcg-advanced-toggle":!0,"dcg-margin-top":!0,"dcg-opened":this.isOpen}),onTap:this.bindFn(this.toggleOpen),tabIndex:Xl.const(0),role:Xl.const("button"),"aria-pressed":()=>this.isOpen,children:[l("div",{class:Xl.const("dcg-caret-container"),children:l("i",{class:Xl.const("dcg-icon-caret-down"),"aria-hidden":Xl.const("true")})}),()=>this.controller.s("graphing-calculator-label-more-viewport-options")]}),l(CG,{predicate:()=>this.isOpen,children:()=>x("div",{class:Xl.const("dcg-advanced-contents"),children:[x("div",{class:Xl.const("dcg-log-axes-container"),children:[l("div",{children:()=>this.getAxisScaleLabel("x")}),l(ar,{ariaGroupLabel:()=>this.getAxisScaleLabel("x"),theme:this.const("mini"),staticConfig:this.const(this.getStaticConfigForAxis("x"))}),l("div",{children:()=>this.getAxisScaleLabel("y")}),l(ar,{ariaGroupLabel:()=>this.getAxisScaleLabel("y"),theme:this.const("mini"),staticConfig:this.const(this.getStaticConfigForAxis("y"))})]}),l(CG,{predicate:()=>!this.controller.getLockViewportConfigSetting(),children:()=>l(Ty,{...this.props})})]})})]})}),l(CG,{predicate:()=>!this.controller.getLockViewportConfigSetting()&&!this.shouldShowLogScalesOption(),children:()=>l(Ty,{...this.props})})]})}toggleOpen(){this.isOpen=!this.isOpen,this.update()}getAxisScaleLabel(e){return e==="x"?this.controller.s("graphing-calculator-label-settings-x-axis")+":":this.controller.s("graphing-calculator-label-settings-y-axis")+":"}getStaticConfigForAxis(e){return[{key:"linear",label:()=>"Linear",selected:()=>this.getAxisScale(e)==="linear",onSelect:()=>this.setAxisScale({axis:e,scale:"linear"})},{key:"logarithmic",label:()=>"Logarithmic",selected:()=>this.getAxisScale(e)==="logarithmic",onSelect:()=>this.setAxisScale({axis:e,scale:"logarithmic"})}]}shouldShowLogScalesOption(){return this.controller.getGraphSettings().config.logScales&&!this.controller.isThreeDMode()}getAxisScale(e){return this.controller.getGraphSettings()[e==="x"?"xAxisScale":"yAxisScale"]}setAxisScale({axis:e,scale:t}){return this.controller.dispatch({type:"set-graph-settings",[e==="x"?"xAxisScale":"yAxisScale"]:t})}};var tu=__dcg_shared_module_exports__['e'](j());var{If:uSe}=tu.Components,Fm=class extends tu.View{init(){this.controller=this.props.controller()}template(){return x("div",{children:[l("div",{class:tu.const("dcg-braille-options-buttons"),children:l(ar,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),theme:this.const("full-width-mini"),staticConfig:this.bindFn(this.getBrailleOptions)})}),x("div",{class:tu.const("dcg-six-key-checkbox"),children:[l(ft,{onChange:e=>this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:e}),checked:()=>this.controller.getSixKeyInput(),children:()=>this.controller.s("graphing-calculator-label-settings-six-key-braille")}),l(Vp,{href:this.const("https://www.desmos.com/accessibility#braille"),controller:this.props.controller})]}),l(uSe,{predicate:this.props.showBrailleNote,children:()=>x("div",{class:tu.const("dcg-refreshable-braille-note"),children:[()=>this.controller.s("graphing-calculator-text-refreshable-braille-display-note")+" ",l("a",{href:()=>"https://www.desmos.com/braille-examples?"+this.controller.getBrailleMode(),class:tu.const("dcg-blue-link"),target:tu.const("_blank"),children:()=>this.controller.s("graphing-calculator-link-view-braille-examples")})]})})]})}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.controller.getBrailleMode()==="nemeth",onSelect:()=>this.setBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>this.controller.getBrailleMode()==="ueb",onSelect:()=>this.setBrailleMode("ueb")}]}setBrailleMode(e){this.controller.dispatch({type:"set-braille-mode",mode:e})}};var ru=__dcg_shared_module_exports__['e'](j());var{If:Pre}=ru.Components,Nm=class extends ru.View{init(){this.controller=this.props.controller()}toggleComplexMode(){this.controller.logEvent({category:"settings",action:this.props.isComplexModeEnabled()?"disable-complex":"enable-complex"}),this.props.toggleComplexMode()}template(){return x("div",{class:ru.const("dcg-options-menu-section dcg-complex-container"),children:[x("div",{class:ru.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-label-settings-complex-mode"),l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-complex-mode"),onChange:this.bindFn(this.toggleComplexMode),toggled:this.props.isComplexModeEnabled})]}),l(Pre,{predicate:this.props.isComplexModeEnabled,children:()=>l("div",{class:ru.const("dcg-complex-options-section"),children:x("div",{class:ru.const("dcg-complex-enabled-note"),children:[l(Xi,{content:()=>this.controller.s("shared-calculator-text-complex-enabled-note",{eq1:"`i^2`",eq2:"`\\sqrt{-4}`"})}),l(Pre,{predicate:()=>this.props.product()==="graphing"||this.props.product()==="graphing-3d",children:()=>l("div",{class:ru.const("dcg-complex-plotting-note"),children:()=>this.controller.s("graphing-calculator-text-complex-plotting-note")})})]})})})]})}};var Yw=__dcg_shared_module_exports__['e'](j());var{IfElse:hSe}=Yw.Components,Vc=class extends Yw.View{init(){this.controller=this.props.setup().controller}getGravity(){return this.props.setup().type==="basic"?"s":this.controller.isNarrow()?"n":"w"}template(){return l("div",{class:Yw.const("dcg-options-menu-section dcg-radiangroup"),children:hSe(()=>this.controller.isComplexModeEnabled(),{true:()=>l(Oe,{tooltip:()=>this.controller.s("shared-calculator-text-complex-radian-mode"),gravity:this.bindFn(this.getGravity),sticky:this.const(!0),displayBlock:this.const(!0),additionalClass:this.const("dcg-cursor-default"),children:l(ar,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-angle"),theme:()=>this.props.setup().type==="basic"?"mini":"default",staticConfig:this.bindFn(this.getAngleModeOptions),disabled:()=>this.controller.isComplexModeEnabled()})}),false:()=>this.renderControl()})})}renderControl(){return l(ar,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-angle"),theme:()=>this.props.setup().type==="basic"?"mini":"default",staticConfig:this.bindFn(this.getAngleModeOptions),disabled:()=>this.controller.isComplexModeEnabled()})}getAngleModeOptions(){let e=this.props.setup();return[{key:"radians",label:()=>e.type==="basic"?this.controller.s("basic-calculator-label-controlbar-rad"):this.controller.s("graphing-calculator-button-settings-radians"),selected:()=>!this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!1),focusHelperOptions:e.type==="advanced"?{controller:e.controller,location:{type:"settings",location:"radian-mode"}}:void 0},{key:"degrees",label:()=>e.type==="basic"?this.controller.s("basic-calculator-label-controlbar-deg"):this.controller.s("graphing-calculator-button-settings-degrees"),selected:()=>this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!0),focusHelperOptions:e.type==="advanced"?{controller:e.controller,location:{type:"settings",location:"degree-mode"}}:void 0}]}getDegreeMode(){return this.controller.getDegreeMode()}setDegreeMode(e){this.controller.dispatch({type:"update-degree-mode",mode:e})}};var EG=__dcg_shared_module_exports__['e'](j());var Bw=class extends EG.View{init(){this.controller=this.props.controller()}template(){return x("div",{children:[l("div",{class:EG.const("dcg-displaysizegroup"),children:l(ar,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size"),staticConfig:this.bindFn(this.getProjectorModeOptions)})}),l(ft,{onChange:this.bindFn(this.toggleInvertedColors),checked:()=>this.controller.getInvertedColors(),manageFocus:this.const(ze({controller:this.controller,location:{type:"settings",location:"reverse-contrast"}})),children:()=>this.controller.s("graphing-calculator-label-settings-reverse-contrast")})]})}getProjectorModeOptions(){return[{key:"default",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-default"),class:()=>"dcg-displaysize-default",selected:()=>!this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!1),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"default-size"}}},{key:"large",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-large"),class:()=>"dcg-displaysize-large",selected:()=>this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!0),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"large-size"}}}]}onSelectProjectorModeOption(e){this.controller.dispatch({type:"set-projector-mode",value:e})}getProjectorMode(){return!!this.controller.getGraphSettings().config.projectorMode}toggleInvertedColors(){this.controller.dispatch({type:"set-inverted-colors",value:!this.controller.getInvertedColors()})}};var{Input:Gre,If:$l,IfElse:Vre}=zt.Components,Um=class extends zt.View{template(){return l(or,{isFocused:()=>this.props.parent().getFocusedLimit()===this.props.limit(),latex:()=>this.props.parent().getLimitLatex(this.props.limit()),ariaLabel:this.props.ariaLabel,handleLatexChanged:e=>this.props.parent().setLimitLatex(this.props.limit(),e),handleFocusChanged:e=>this.props.parent().onFocusedChanged(this.props.limit(),e),hasError:()=>this.props.parent().isLimitInvalid(this.props.limit()),dataLabelAttributeValue:this.props.limit,controller:this.props.controller,readonly:this.const(!1),containerClass:()=>({"dcg-log-scale":this.props.axisScale()==="logarithmic"})})}},IG=class extends zt.View{init(){this.controller=this.props.controller(),this.uuid=yc()}template(){return x("div",{class:zt.const("dcg-settings-view-container"),children:[l(Rm,{...this.props,isPillbox:this.const(!0)}),l($l,{predicate:()=>this.controller.isGraphSettingsOpen(),children:()=>l("div",{class:zt.const("dcg-settings-container dcg-left dcg-popover dcg-constrained-height-popover"),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer),children:x("div",{class:zt.const("dcg-popover-interior"),role:zt.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-graph-settings"),children:[x("div",{class:zt.const("dcg-visual-settings"),children:[l(Bw,{controller:this.props.controller}),l($l,{predicate:()=>this.controller.getBrailleControls(),children:()=>x("div",{class:zt.const("dcg-braille-container dcg-braille-mode"),children:[l(ft,{onChange:this.bindFn(this.toggleBrailleMode),checked:()=>this.controller.getBrailleMode()!=="none",children:()=>this.controller.s("shared-calculator-narration-braille-mode")}),l($l,{predicate:()=>this.controller.getBrailleMode()!=="none",children:()=>l("div",{class:zt.const("dcg-braille-options-container"),children:l(Fm,{controller:this.props.controller,showBrailleNote:this.const(!0)})})})]})})]}),x("div",{class:zt.const("dcg-top-section-flex dcg-grid-settings-container"),children:[x("div",{class:zt.const("dcg-grid-settings"),children:[l(ft,{class:this.const("dcg-settings-grid-toggle"),onChange:this.bindFn(this.toggleGrid),checked:this.bindFn(this.getShowGrid),children:()=>this.controller.s("graphing-calculator-label-settings-grid")}),l($l,{predicate:this.bindFn(this.getShowGrid),children:()=>x("div",{class:zt.const("dcg-circle-icon-group dcg-grid-group"),children:[l("div",{class:()=>({"dcg-circle-icon":!0,"dcg-action-cartesian":!0,"dcg-selected":!this.getPolarMode()}),role:zt.const("button"),tabIndex:zt.const("0"),"aria-pressed":()=>!this.getPolarMode(),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-cartesian-grid"),onTap:this.bindFn(this.setCartesianMode),children:l("i",{class:zt.const("dcg-icon-cartesian")})}),"\xA0",l("div",{class:()=>({"dcg-circle-icon":!0,"dcg-action-polar":!0,"dcg-selected":this.getPolarMode()}),role:zt.const("button"),tabIndex:zt.const("0"),"aria-pressed":()=>this.getPolarMode(),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-polar-grid"),onTap:this.bindFn(this.setPolarMode),children:l("i",{class:zt.const("dcg-icon-polar")})})]})}),l(ft,{onChange:this.bindFn(this.toggleArrows),checked:()=>this.getAxisArrowMode()!==__dcg_shared_module_exports__['Nd'].NONE,children:()=>this.controller.s("graphing-calculator-label-settings-arrows")}),l($l,{predicate:()=>this.getAxisArrowMode()!==__dcg_shared_module_exports__['Nd'].NONE,children:()=>x("div",{class:zt.const("dcg-circle-icon-group dcg-arrow-group"),children:[l("div",{role:zt.const("button"),tabIndex:zt.const("0"),class:()=>({"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-selected":this.getAxisArrowMode()===__dcg_shared_module_exports__['Nd'].BOTH}),"dcg-arrows":zt.const("BOTH"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-show-both"),"aria-pressed":()=>this.getAxisArrowMode()===__dcg_shared_module_exports__['Nd'].BOTH,onTap:()=>this.setAxisArrowMode(__dcg_shared_module_exports__['Nd'].BOTH),children:l("i",{class:zt.const("dcg-icon-arrows-two"),"aria-hidden":zt.const("true")})}),"\xA0",l("div",{role:zt.const("button"),tabIndex:zt.const("0"),class:()=>({"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-selected":this.getAxisArrowMode()===__dcg_shared_module_exports__['Nd'].POSITIVE}),"dcg-arrows":zt.const("POSITIVE"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-show-positive"),"aria-pressed":()=>this.getAxisArrowMode()===__dcg_shared_module_exports__['Nd'].POSITIVE,onTap:()=>this.setAxisArrowMode(__dcg_shared_module_exports__['Nd'].POSITIVE),children:l("i",{class:zt.const("dcg-icon-arrows-one"),"aria-hidden":zt.const("true")})})]})})]}),x("div",{class:zt.const("dcg-top-checkboxes-container"),children:[l(ft,{onChange:this.bindFn(this.toggleAxisNumbers),checked:this.bindFn(this.getAxisNumbers),small:this.const(!0),children:()=>this.controller.s("graphing-calculator-label-settings-axis-numbers")}),l($l,{predicate:()=>this.getShowGrid()&&!this.getPolarMode(),children:()=>l(ft,{onChange:this.bindFn(this.toggleMinorGridlines),checked:this.bindFn(this.getMinorGridlines),small:this.const(!0),children:()=>this.controller.s("graphing-calculator-label-settings-minor-gridlines")})}),l($l,{predicate:()=>this.controller.canUseAdvancedStyling()&&!this.getPolarMode(),children:()=>l(ft,{checked:()=>this.controller.getGraphSettings().restrictGridToFirstQuadrant,onChange:e=>this.controller.dispatch({type:"set-graph-settings",restrictGridToFirstQuadrant:e}),small:this.const(!0),children:()=>this.controller.s("graphing-calculator-label-settings-one-quadrant")})}),l($l,{predicate:this.bindFn(this.showZoomSquareButton),children:()=>l("div",{role:zt.const("button"),tabIndex:zt.const("0"),class:zt.const("dcg-action-zoom-square dcg-btn-light-gray"),onTap:this.bindFn(this.zoomSquare),children:()=>this.controller.s("graphing-calculator-button-settings-zoom-square")})})]})]}),x("div",{class:zt.const("dcg-axes-settings-container"),children:[x("div",{class:zt.const("dcg-checkbox-title dcg-x-axis-title"),children:[l(ft,{onChange:this.bindFn(this.toggleXAxis),checked:this.bindFn(this.getShowXAxis),children:l("span",{id:this.const(`x-axis-description-${this.uuid}`),children:()=>this.controller.s("graphing-calculator-label-settings-x-axis")})}),l($l,{predicate:this.bindFn(this.getShowXAxis),children:()=>x("div",{class:zt.const("dcg-axis-label"),children:[l("label",{for:this.const(`x-axis-label-${this.uuid}`),children:()=>this.controller.s("graphing-calculator-button-label")}),l(Gre,{class:this.const("dcg-x-axis-label"),disabled:()=>this.getShowXAxis()?void 0:!0,onInput:this.bindFn(this.onXAxisLabelInput),value:this.bindFn(this.getXAxisLabel),"aria-describedby":this.const(`x-axis-description-${this.uuid}`),id:this.const(`x-axis-label-${this.uuid}`),placeholder:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-label-placeholder")})]})})]}),x("div",{class:zt.const("dcg-editable-mathquill-container dcg-x-axis-options"),children:[l(Um,{limit:this.const("xmin"),axisScale:()=>this.getAxisScale("x"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-min"),parent:this.const(this),controller:this.props.controller}),l(dt,{config:this.const({}),latex:this.const("\\le x\\le"),children:l("span",{class:zt.const("dcg-interval-interior")})}),l(Um,{limit:this.const("xmax"),axisScale:()=>this.getAxisScale("x"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-max"),parent:this.const(this),controller:this.props.controller}),l($l,{predicate:()=>!this.getPolarMode(),children:()=>Vre(()=>this.getAxisScale("x")==="linear",{true:()=>x("span",{class:zt.const("dcg-step-container"),children:[l("span",{class:zt.const("dcg-step-label"),"aria-hidden":zt.const("true"),children:()=>this.controller.s("graphing-calculator-label-settings-step")}),l(Um,{limit:this.const("xstep"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-step"),parent:this.const(this),controller:this.props.controller})]}),false:()=>l("span",{style:zt.const("display: none")})})})]}),x("div",{class:zt.const("dcg-checkbox-title dcg-y-axis-title"),children:[l(ft,{onChange:this.bindFn(this.toggleYAxis),checked:this.bindFn(this.getShowYAxis),children:l("span",{id:this.const(`y-axis-description-${this.uuid}`),children:()=>this.controller.s("graphing-calculator-label-settings-y-axis")})}),l($l,{predicate:this.bindFn(this.getShowYAxis),children:()=>x("div",{class:zt.const("dcg-axis-label"),children:[l("label",{for:this.const(`y-axis-label-${this.uuid}`),children:()=>this.controller.s("graphing-calculator-button-label")}),l(Gre,{class:this.const("dcg-y-axis-label"),onInput:this.bindFn(this.onYAxisLabelInput),value:this.bindFn(this.getYAxisLabel),"aria-describedby":this.const(`y-axis-description-${this.uuid}`),id:this.const(`y-axis-label-${this.uuid}`),placeholder:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-label-placeholder")})]})})]}),x("div",{class:zt.const("dcg-editable-mathquill-container dcg-y-axis-options"),children:[l(Um,{limit:this.const("ymin"),axisScale:()=>this.getAxisScale("y"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-min"),parent:this.const(this),controller:this.props.controller}),l(dt,{config:this.const({}),latex:this.const("\\le y\\le"),children:l("span",{class:zt.const("dcg-interval-interior")})}),l(Um,{limit:this.const("ymax"),axisScale:()=>this.getAxisScale("y"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-max"),parent:this.const(this),controller:this.props.controller}),l($l,{predicate:()=>!this.getPolarMode(),children:()=>Vre(()=>this.getAxisScale("y")==="linear",{true:()=>x("span",{class:zt.const("dcg-step-container"),children:[l("span",{class:zt.const("dcg-step-label"),"aria-hidden":zt.const("true"),children:()=>this.controller.s("graphing-calculator-label-settings-step")}),l(Um,{limit:this.const("ystep"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-step"),parent:this.const(this),controller:this.props.controller})]}),false:()=>l("span",{style:zt.const("display: none")})})})]})]}),l(TG,{controller:this.props.controller}),l($l,{predicate:()=>this.controller.canEnableComplexMode(),children:()=>l(Nm,{...this.props,isComplexModeEnabled:()=>this.controller.isComplexModeEnabled(),toggleComplexMode:()=>this.controller.dispatch({type:"toggle-complex-mode"}),product:()=>this.controller.getProduct()})}),l(Vc,{setup:this.const({controller:this.controller,type:"advanced"})}),l("div",{class:zt.const("dcg-arrow")})]})})})]})}toggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.getBrailleMode()==="none"?"nemeth":"none"})}didMountContainer(e){this.node=e,re(document.documentElement).on("dcg-tapstart.settings-view wheel.settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),re(document.documentElement).on("keydown.settings-view",t=>{let o=Pe(t);if(o==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&o==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let i=this.controller.getFocusLocation();if(!i||i.type!=="settings")return;let n=!!this.controller.getGraphSettings().config.projectorMode,a=!!this.controller.getGraphSettings().degreeMode;t.shiftKey?t.shiftKey&&(n&&i.location==="large-size"||!n&&i.location==="default-size"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):i.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:a?"degree-mode":"radian-mode"}}),t.preventDefault(),t.stopPropagation())):i.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:n?"large-size":"default-size"}}),t.preventDefault(),t.stopPropagation()):(!a&&i.location==="radian-mode"||a&&i.location==="degree-mode")&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){re(document.documentElement).off(".settings-view")}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&this.node.contains(document.activeElement)&&bl(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=e.target,o=this.node.contains(t),i=!!t.closest(".dcg-action-settings"),n=this.isMathquillFocused()&&!!t.closest(".dcg-keypad"),a=!!t.closest(".dcg-action-undo")||!!t.closest(".dcg-action-redo");return!(o||i||n||a)}isMathquillFocused(){return this.getFocusedLimit()!==void 0}getLimitLatex(e){return this.controller.getSettingsViewModel().limitLatex[e]||""}setLimitLatex(e,t){t!==this.controller.getSettingsViewModel().limitLatex[e]&&this.controller.dispatch({type:"set-axis-limit-latex",limit:e,latex:t})}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getInvalidLimits(){let e=!!this.controller.getGraphSettings().degreeMode,t=eo(this.getLimitLatex("xmin"),e),o=eo(this.getLimitLatex("xmax"),e),i=eo(this.getLimitLatex("ymin"),e),n=eo(this.getLimitLatex("ymax"),e),a=this.getLimitLatex("xstep")===""?0:eo(this.getLimitLatex("xstep"),e),s=this.getLimitLatex("ystep")===""?0:eo(this.getLimitLatex("ystep"),e),c={},d=new Or(t,o,i,n);return isFinite(t)&&isFinite(o)?(c.xmin=!d.isXValid(this.controller.getGraphSettings().xAxisScale),c.xmax=c.xmin):(c.xmin=!isFinite(t),c.xmax=!isFinite(o)),isFinite(i)&&isFinite(n)?(c.ymin=!d.isYValid(this.controller.getGraphSettings().yAxisScale),c.ymax=c.ymin):(c.ymin=!isFinite(i),c.ymax=!isFinite(n)),c.xstep=!e1(a),c.ystep=!e1(s),c}isLimitInvalid(e){return this.getInvalidLimits()[e]}onFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"settings",location:e}})}onXAxisLabelInput(e){this.controller.dispatch({type:"set-graph-settings",xAxisLabel:e})}onYAxisLabelInput(e){this.controller.dispatch({type:"set-graph-settings",yAxisLabel:e})}getXAxisLabel(){return this.controller.getGraphSettings().xAxisLabel}getYAxisLabel(){return this.controller.getGraphSettings().yAxisLabel}getShowXAxis(){return!!this.controller.getGraphSettings().showXAxis}toggleXAxis(){this.controller.dispatch({type:"set-graph-settings",showXAxis:!this.getShowXAxis()})}getShowYAxis(){return!!this.controller.getGraphSettings().showYAxis}toggleYAxis(){this.controller.dispatch({type:"set-graph-settings",showYAxis:!this.getShowYAxis()})}getAxisNumbers(){return!!this.controller.getGraphSettings().xAxisNumbers}toggleAxisNumbers(){let e=this.getAxisNumbers();this.controller.dispatch({type:"set-graph-settings",xAxisNumbers:!e,yAxisNumbers:!e,polarNumbers:!e})}getMinorGridlines(){return this.controller.getGraphSettings().xAxisMinorSubdivisions===0}toggleMinorGridlines(){let e=this.getMinorGridlines()?1:0;this.controller.dispatch({type:"set-graph-settings",yAxisMinorSubdivisions:e,xAxisMinorSubdivisions:e})}getPolarMode(){return!!this.controller.getGraphSettings().polarMode}setPolarMode(){this.controller.dispatch({type:"set-polar-mode",polarMode:!0})}setCartesianMode(){this.controller.dispatch({type:"set-polar-mode",polarMode:!1})}getAxisScale(e){return this.controller.getGraphSettings()[e==="x"?"xAxisScale":"yAxisScale"]}getAxisArrowMode(){return this.controller.getGraphSettings().xAxisArrowMode}setAxisArrowMode(e){this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}getShowGrid(){return this.controller.getGraphSettings().showGrid}toggleGrid(){this.controller.dispatch({type:"set-graph-settings",showGrid:!this.getShowGrid()})}toggleArrows(){let e=this.getAxisArrowMode()===__dcg_shared_module_exports__['Nd'].NONE?__dcg_shared_module_exports__['Nd'].BOTH:__dcg_shared_module_exports__['Nd'].NONE;this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}showZoomSquareButton(){let e=this.controller.getAxisScaleSettings();return e.xAxisScale===e.yAxisScale&&!this.controller.getGraphSettings().squareAxes}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}zoomSquare(){this.controller.dispatch({type:"zoom",direction:"square"})}};var Ea=__dcg_shared_module_exports__['e'](j());Ut();var Ym=__dcg_shared_module_exports__['e'](j());var{If:Ore}=Ym.Components,Kw=class extends Ym.View{init(){this.controller=this.props.controller()}template(){return l(Ore,{predicate:this.bindFn(this.shouldShowBrailleSection),children:()=>x("div",{class:Ym.const("dcg-options-menu-section"),children:[x("div",{class:Ym.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("shared-calculator-narration-braille-mode"),l(to,{ariaLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),onChange:this.bindFn(this.toggleBrailleMode),toggled:()=>this.controller.getBrailleMode()!=="none"})]}),l(Ore,{predicate:()=>this.controller.getBrailleMode()!=="none",children:()=>l("div",{class:Ym.const("dcg-braille-options-container"),children:l(Fm,{controller:this.props.controller,showBrailleNote:this.const(!0)})})})]})})}shouldShowBrailleSection(){return this.controller.getBrailleControls()&&this.controller.getGraphSettings().config.expressions}toggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.getBrailleMode()==="none"?"nemeth":"none"})}};var Oc=__dcg_shared_module_exports__['e'](j());var{If:Rre}=Oc.Components,EY=0,K_=aG/8,MG=class extends Oc.View{init(){this.controller=this.props.controller()}template(){return x("div",{class:Oc.const("dcg-options-menu-section"),children:[x("div",{class:Oc.const("dcg-options-menu-section-title dcg-local-display-preferences-title"),children:[()=>this.controller.s("graphing-calculator-label-display-properties"),l(Vp,{href:this.const("https://help.desmos.com/hc/en-us/articles/20301369699981-3D-Graph-Settings#h_01HCFSXHM8S59ETFXB55Y8CZQ5\u2019"),controller:this.props.controller})]}),l(ft,{onChange:this.bindFn(this.toggleInvertedColors),checked:()=>this.controller.getInvertedColors(),manageFocus:this.const(ze({controller:this.controller,location:{type:"settings",location:"reverse-contrast"}})),children:()=>this.controller.s("graphing-calculator-label-settings-reverse-contrast")}),l(Rre,{predicate:()=>this.controller.getGraphSettings().config.beta3d,children:()=>l(ft,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showBox3D:!this.controller.getGraphSettings().showBox3D})},checked:()=>this.controller.getGraphSettings().showBox3D,children:()=>this.controller.raw("Clip to box")})}),l(Rre,{predicate:()=>!this.controller.getGraphSettings().config.beta3d,children:()=>l(ft,{class:()=>"dcg-translucent-surfaces-checkbox",onChange:this.bindFn(this.toggleTranslucentSurfaces),checked:()=>this.controller.getTranslucentSurfaces(),ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-translucent-surfaces"),manageFocus:this.const(ze({controller:this.controller,location:{type:"settings",location:"translucent-surfaces"}})),children:()=>this.controller.s("graphing-calculator-label-settings-translucent-surfaces")})}),x("div",{class:Oc.const("dcg-perspective-slider"),children:[l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-settings-3d-perspective-min"),children:l("i",{class:Oc.const("dcg-icon-3d-cube"),"aria-hidden":Oc.const("true")})}),l(Bb,{min:()=>EY-1,max:()=>K_-1,step:()=>{},value:()=>this.getPerspectiveValue(),ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-3d-perspective-distortion-ratio"),ariaPercent:this.const(!0),onDragUpdate:this.bindFn(this.onDragUpdate),onKeyboardUpdate:this.bindFn(this.onKeyboardUpdate)}),l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-settings-3d-perspective-max"),children:l("i",{class:Oc.const("dcg-icon-3d-perspective"),"aria-hidden":Oc.const("true")})})]})]})}toggleTranslucentSurfaces(){this.controller.dispatch({type:"set-translucent-surfaces",value:!this.controller.getTranslucentSurfaces()})}toggleInvertedColors(){this.controller.dispatch({type:"set-inverted-colors",value:!this.controller.getInvertedColors()})}getPerspectiveValue(){return this.controller.getPerspectiveDistortion()-1}onKeyboardUpdate(e){let o=this.getPerspectiveValue();switch(e){case"up":o+=.1;break;case"down":o-=.1;break;case"bigup":o+=.3;break;case"bigdown":o-=.3;break;case"min":o=EY-1;break;case"max":o=K_-1;break}o=__dcg_shared_module_exports__['Rb'](o+1,EY,K_),this.controller.dispatch({type:"set-perspective-distortion",value:o})}onDragUpdate(e){this.controller.dispatch({type:"set-perspective-distortion",value:e+1})}};var so=__dcg_shared_module_exports__['e'](j());var{If:Ey}=so.Components,Bm=class extends so.View{template(){return l(or,{isFocused:()=>this.props.parent().getFocusedLimit()===this.props.limit(),latex:()=>this.props.parent().getLimitLatex(this.props.limit()),ariaLabel:this.props.ariaLabel,handleLatexChanged:e=>this.props.parent().setLimitLatex(this.props.limit(),e),handleFocusChanged:e=>this.props.parent().onFocusedChanged(this.props.limit(),e),hasError:()=>this.props.parent().isLimitInvalid(this.props.limit()),dataLabelAttributeValue:this.props.limit,controller:this.props.controller,readonly:this.const(!1)})}},DG=class extends so.View{init(){this.controller=this.props.controller(),this.isOpen=this.mustBeOpen()}willUpdate(){this.mustBeOpen()&&(this.isOpen=!0)}mustBeOpen(){var t;let e=(t=this.controller.getGrapher3d())==null?void 0:t.viewportController.getViewport();return e?e.xmin!==e.ymin||e.xmin!==e.zmin||e.xmax!==e.ymax||e.xmax!==e.zmax:!1}template(){return x("div",{class:so.const("dcg-three-d-domain dcg-advanced-graph-settings-view dcg-options-menu-section"),children:[x("div",{class:so.const("dcg-options-menu-section-title dcg-flex-container"),children:[l("div",{children:()=>this.controller.s("graphing-calculator-label-edit-graph-bounds")}),l("div",{children:l(Ey,{predicate:this.bindFn(this.showRecenterButton),children:()=>l("div",{role:so.const("button"),tabIndex:so.const("0"),class:so.const("dcg-action-zoom-recenter dcg-btn-light-gray"),onTap:this.bindFn(this.zoomRecenter),children:()=>this.controller.s("graphing-calculator-label-recenter")})})})]}),x("div",{class:so.const("dcg-three-d-domain-toggle-container"),children:[x("div",{class:()=>({"dcg-advanced-toggle":!0,"dcg-opened":this.isOpen,"dcg-disabled":this.mustBeOpen()}),onTap:this.bindFn(this.toggleOpen),tabIndex:()=>this.mustBeOpen()?-1:0,"aria-disabled":()=>this.mustBeOpen(),role:so.const("button"),"aria-expanded":()=>this.isOpen,"aria-label":()=>this.controller.s("graphing-calculator-label-edit-graph-bounds"),children:[l("div",{class:so.const("dcg-caret-container"),children:l("i",{class:so.const("dcg-icon-caret-down"),"aria-hidden":so.const("true")})}),l(Ey,{predicate:()=>this.isOpen,children:()=>x("span",{class:so.const("dcg-axis-label"),children:[l(dt,{config:this.const({}),latex:this.const("x")}),"-axis:"]})}),l(Ey,{predicate:()=>!this.isOpen,children:()=>l("span",{class:so.const("dcg-axis-label"),children:()=>this.controller.s("graphing-calculator-label-settings-all-axes")})})]}),x("div",{class:so.const("dcg-editable-mathquill-container dcg-x-axis-options"),children:[l(Bm,{limit:this.const("xmin"),ariaLabel:()=>this.isOpen?this.controller.s("graphing-calculator-narration-settings-x-axis-min"):this.controller.s("graphing-calculator-narration-settings-all-axes-min"),parent:this.const(this),controller:this.props.controller}),l(Ey,{predicate:()=>this.isOpen,children:()=>l(dt,{config:this.const({}),latex:this.const("\\le x\\le"),children:l("span",{class:so.const("dcg-interval-interior")})})}),l(Ey,{predicate:()=>!this.isOpen,children:()=>l("span",{class:so.const("dcg-axis-label-to"),children:()=>this.controller.s("shared-label-to")})}),l(Bm,{limit:this.const("xmax"),ariaLabel:()=>this.isOpen?this.controller.s("graphing-calculator-narration-settings-x-axis-max"):this.controller.s("graphing-calculator-narration-settings-all-axes-max"),parent:this.const(this),controller:this.props.controller})]})]}),l(Ey,{predicate:()=>this.isOpen,children:()=>x("div",{class:so.const("dcg-advanced-contents"),children:[x("div",{class:so.const("dcg-editable-mathquill-container dcg-y-axis-options"),children:[x("span",{class:so.const("dcg-axis-label"),children:[l(dt,{config:this.const({}),latex:this.const("y")}),"-axis:"]}),l(Bm,{limit:this.const("ymin"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-min"),parent:this.const(this),controller:this.props.controller}),l(dt,{config:this.const({}),latex:this.const("\\le y\\le"),children:l("span",{class:so.const("dcg-interval-interior")})}),l(Bm,{limit:this.const("ymax"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-max"),parent:this.const(this),controller:this.props.controller})]}),l("div",{children:x("div",{class:so.const("dcg-editable-mathquill-container dcg-z-axis-options"),children:[x("span",{class:so.const("dcg-axis-label"),children:[l(dt,{config:this.const({}),latex:this.const("z")}),"-axis:"]}),l(Bm,{limit:this.const("zmin"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-min"),parent:this.const(this),controller:this.props.controller}),l(dt,{config:this.const({}),latex:this.const("\\le z\\le"),children:l("span",{class:so.const("dcg-interval-interior")})}),l(Bm,{limit:this.const("zmax"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-max"),parent:this.const(this),controller:this.props.controller})]})}),l(Ey,{predicate:this.bindFn(this.showZoomSquareButton),children:()=>l("div",{children:l("div",{role:so.const("button"),tabIndex:so.const("0"),class:so.const("dcg-action-zoom-square-3d dcg-btn-blue"),onTap:this.bindFn(this.zoomSquare),children:()=>this.controller.s("graphing-calculator-button-settings-zoom-square")})})})]})})]})}showRecenterButton(){var t;let e=(t=this.controller.getGrapher3d())==null?void 0:t.webglLayer.domain();return!!e&&!Ste(e,0)}zoomRecenter(e){this.controller.dispatch({type:"zoom",direction:"recenter"}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"xmin"}})}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getLimitLatex(e){return this.controller.getSettingsViewModel().limitLatex[e]||""}setLimitLatex(e,t){t!==this.controller.getSettingsViewModel().limitLatex[e]&&this.controller.dispatch({type:"set-axis-limit-latex",limit:e,latex:t,updateYZAlso:!this.isOpen&&(e==="xmin"||e==="xmax")})}getInvalidLimits(){let e=!!this.controller.getGraphSettings().degreeMode,t=eo(this.getLimitLatex("xmin"),e),o=eo(this.getLimitLatex("xmax"),e),i=eo(this.getLimitLatex("ymin"),e),n=eo(this.getLimitLatex("ymax"),e),a=eo(this.getLimitLatex("zmin"),e),s=eo(this.getLimitLatex("zmax"),e),c={},d=new Or(t,o,i,n,a,s);return isFinite(t)&&isFinite(o)?(c.xmin=!d.isXValid(this.controller.getGraphSettings().xAxisScale),c.xmax=c.xmin):(c.xmin=!isFinite(t),c.xmax=!isFinite(o)),isFinite(i)&&isFinite(n)?(c.ymin=!d.isYValid(this.controller.getGraphSettings().yAxisScale),c.ymax=c.ymin):(c.ymin=!isFinite(i),c.ymax=!isFinite(n)),isFinite(a)&&isFinite(s)?(c.zmin=!d.isZValid(),c.zmax=c.zmin):(c.zmin=!isFinite(a),c.zmax=!isFinite(s)),c}isLimitInvalid(e){return this.getInvalidLimits()[e]}onFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"settings",location:e}})}toggleOpen(){this.mustBeOpen()||(this.isOpen=!this.isOpen,this.update())}showZoomSquareButton(){return!this.controller.getGraphSettings().squareAxes}zoomSquare(e){this.controller.dispatch({type:"zoom",direction:"square"}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"zmax"}})}};var{If:z_}=Ea.Components,AG=class extends Ea.View{init(){this.controller=this.props.controller()}template(){return x("div",{class:Ea.const("dcg-settings-view-container dcg-settings-view-3d-container"),children:[l("div",{class:Ea.const("dcg-3d-settings-flex-container"),children:l(Rm,{...this.props,isPillbox:this.const(!0)})}),l(z_,{predicate:()=>this.controller.isGraphSettingsOpen(),children:()=>l("div",{class:Ea.const("dcg-settings-container dcg-left dcg-popover dcg-constrained-height-popover"),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer),children:x("div",{class:Ea.const("dcg-popover-interior dcg-generic-options-menu"),role:Ea.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-graph-settings"),children:[l(MG,{controller:this.props.controller}),l(DG,{controller:this.props.controller}),x("div",{class:Ea.const("dcg-options-menu-section"),children:[x("div",{class:Ea.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-label-axes"),l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-label-axes"),onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showAxis3D:!this.controller.getGraphSettings().showAxis3D})},toggled:()=>!!this.controller.getGraphSettings().showAxis3D})]}),l(z_,{predicate:()=>this.controller.getGraphSettings().showAxis3D,children:()=>x("div",{class:Ea.const("dcg-show-axis-labels-section"),children:[l("div",{children:l(ft,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showPlane3D:!this.controller.getGraphSettings().showPlane3D})},checked:()=>!!this.controller.getGraphSettings().showPlane3D,children:()=>this.controller.s("graphing-calculator-label-settings-domain-plane")})}),l("div",{children:l(ft,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showNumbers3D:!this.controller.getGraphSettings().showNumbers3D})},checked:()=>!!this.controller.getGraphSettings().showNumbers3D,children:()=>this.controller.s("graphing-calculator-label-settings-numbers-3d")})}),l("div",{children:l(ft,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showAxisLabels3D:!this.controller.getGraphSettings().showAxisLabels3D})},checked:()=>!!this.controller.getGraphSettings().showAxisLabels3D,children:()=>this.controller.s("graphing-calculator-label-settings-axis-labels-3d")})})]})})]}),x("div",{class:Ea.const("dcg-options-menu-section"),children:[l(z_,{predicate:()=>!this.controller.getLockViewportConfigSetting(),children:()=>x("div",{class:Ea.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-label-settings-lock-viewport"),l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-lock-viewport"),onChange:()=>{this.props.controller().dispatch({type:"toggle-lock-viewport"})},toggled:()=>this.props.controller().getLockViewportUserSetting()})]})}),l(z_,{predicate:()=>this.controller.getLockViewportConfigSetting()||this.props.controller().getLockViewportUserSetting(),children:()=>l("div",{class:Ea.const("dcg-three-d-disable-rotation-container"),children:l(ar,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-label-disable-rotation"),theme:this.const("full-width-mini"),staticConfig:this.bindFn(this.getRotationModeOptions)})})})]}),l(z_,{predicate:()=>this.controller.canEnableComplexMode(),children:()=>l(Nm,{...this.props,isComplexModeEnabled:()=>this.controller.isComplexModeEnabled(),toggleComplexMode:()=>this.controller.dispatch({type:"toggle-complex-mode"}),product:this.const("graphing-3d")})}),l(Kw,{controller:this.props.controller}),l(Vc,{setup:this.const({controller:this.controller,type:"advanced"})}),l("div",{class:Ea.const("dcg-arrow")})]})})})]})}getRotationModeOptions(){return[{key:"allow",label:()=>this.controller.s("graphing-calculator-label-allow-rotation"),ariaLabel:()=>this.controller.s("graphing-calculator-label-allow-rotation"),selected:()=>!this.props.controller().getLockRotationUserSetting(),onSelect:()=>{this.props.controller().dispatch({type:"set-lock-rotation",lockRotation:!1})}},{key:"disable",label:()=>this.controller.s("graphing-calculator-label-disable-rotation"),ariaLabel:()=>this.controller.s("graphing-calculator-label-disable-rotation"),selected:()=>this.props.controller().getLockRotationUserSetting(),onSelect:()=>{this.props.controller().dispatch({type:"set-lock-rotation",lockRotation:!0})}}]}didMountContainer(e){this.node=e,re(document.documentElement).on("dcg-tapstart.settings-view wheel.settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),re(document.documentElement).on("keydown.settings-view",t=>{let o=Pe(t);if(o==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&o==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let i=this.controller.getFocusLocation();if(!i||i.type!=="settings")return;let n=!!this.controller.getGraphSettings().degreeMode;t.shiftKey?t.shiftKey&&(i.location==="reverse-contrast"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):i.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:n?"degree-mode":"radian-mode"}}),t.preventDefault(),t.stopPropagation())):i.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"reverse-contrast"}}),t.preventDefault(),t.stopPropagation()):(!n&&i.location==="radian-mode"||n&&i.location==="degree-mode")&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){re(document.documentElement).off(".settings-view")}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&this.node.contains(document.activeElement)&&bl(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=e.target,o=this.node.contains(t),i=!!t.closest(".dcg-action-settings"),n=this.isMathquillFocused()&&t.closest(".dcg-keypad"),a=!!t.closest(".dcg-action-undo")||!!t.closest(".dcg-action-redo");return!(o||i||n||a)}isMathquillFocused(){let e=this.controller.getFocusLocation();return(e==null?void 0:e.type)==="settings"}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}};var q_=__dcg_shared_module_exports__['e'](j());var LG=class extends q_.View{init(){this.controller=this.props.controller()}template(){return l(Oe,{tooltip:this.bindFn(this.getZoomRestoreLabel),gravity:this.const("w"),children:l("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-btn-flat-gray":!0,"dcg-pillbox-btn-interior":!0,"dcg-action-zoomrestore":!0}),"aria-label":this.bindFn(this.getZoomRestoreLabel),onTap:this.bindFn(this.setDefaultViewport),manageFocus:this.const(ze({controller:this.controller,location:{type:"zoom-restore-btn"}})),children:l("i",{class:q_.const("dcg-icon-home"),"aria-hidden":q_.const("true")})})})}setDefaultViewport(){this.controller.dispatch({type:"zoom",direction:"default"}),this.controller.dispatch({type:"set-focus-location",location:{type:"zoom-in-btn"}})}getZoomRestoreLabel(){return this.controller.s("graphing-calculator-label-tooltip-viewport-default")}};var Rc=__dcg_shared_module_exports__['e'](j());var PG=class extends Rc.View{init(){this.controller=this.props.controller()}template(){return l("div",{class:Rc.const("dcg-zoom-container"),children:x("div",{class:Rc.const("dcg-zoominout-pillbox dcg-btn-flat-gray dcg-btn-flat-gray-group dcg-group-vertical"),role:Rc.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-zoom-options-label"),children:[l(Oe,{tooltip:this.bindFn(this.getZoomInLabel),displayBlock:this.const(!0),gravity:this.const("w"),children:l("button",{class:Rc.const("dcg-unstyled-button dcg-action-zoomin dcg-pillbox-btn-interior"),"aria-label":this.bindFn(this.getZoomInLabel),onTap:this.bindFn(this.zoomIn),manageFocus:this.const(ze({controller:this.controller,location:{type:"zoom-in-btn"}})),children:l("i",{class:Rc.const("dcg-icon-plus"),"aria-hidden":Rc.const("true")})})}),l(Oe,{tooltip:this.bindFn(this.getZoomOutLabel),displayBlock:this.const(!0),gravity:this.const("w"),children:l("button",{class:Rc.const("dcg-unstyled-button dcg-action-zoomout dcg-pillbox-btn-interior"),"aria-label":this.bindFn(this.getZoomOutLabel),onTap:this.bindFn(this.zoomOut),children:l("i",{class:Rc.const("dcg-icon-minus"),"aria-hidden":Rc.const("true")})})})]})})}zoomIn(){this.controller.dispatch({type:"zoom",direction:"in"})}zoomOut(){this.controller.dispatch({type:"zoom",direction:"out"})}getZoomInLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-in")}getZoomOutLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-out")}};var{For:gSe,If:H_}=Km.Components,GG=class extends Km.View{init(){this.controller=this.props.controller()}template(){return x("div",{children:[l(H_,{predicate:this.bindFn(this.shouldShowLeftPillboxes),children:()=>x("div",{class:()=>({"dcg-left-pillboxes":!0,"dcg-geometry-toolbar-present":this.controller.shouldShowGeoToolbar()}),children:[l(H_,{predicate:this.bindFn(this.shouldShowUndoRedo),children:()=>l(Uw,{controller:this.props.controller,isPillbox:this.const(!0)})}),l(H_,{predicate:this.bindFn(this.shouldShowGeoReset),children:()=>l(Y_,{controller:this.props.controller,tooltipGravity:this.const("s")})})]})}),l("div",{class:()=>({"dcg-pillbox-container":!0,"dcg-geometry-toolbar-present":this.controller.shouldShowGeoToolbar()}),role:()=>this.controller.isGeoUIActive()?void 0:"region","aria-label":()=>this.controller.isGeoUIActive()?void 0:this.controller.s("graphing-calculator-narration-graph-settings-controls"),children:x("div",{class:Km.const("dcg-overgraph-pillbox-elements"),style:this.bindFn(this.getContainerStyle),children:[l(H_,{predicate:()=>this.shouldShowOrientationPillbox()&&!this.controller.onSmallScreen(),children:()=>l("div",{class:Km.const("dcg-left-pillbox-elements"),children:l(B_,{controller:this.props.controller,layout:this.const("horizontal")})})}),l(H_,{predicate:()=>this.getRightPillboxElements().length>0,children:()=>l("div",{class:Km.const("dcg-right-pillbox-elements"),children:l(gSe,{each:()=>this.getRightPillboxElements(),children:e=>{switch(e){case"settings2d":return l(IG,{controller:this.props.controller});case"settings3d":return l(AG,{controller:this.props.controller});case"settings-geo":return l(Rm,{...this.props,isPillbox:this.const(!0)});case"reset":return l(Y_,{controller:this.props.controller,tooltipGravity:this.const("w")});case"zoom-in-out":return l(PG,{controller:this.props.controller});case"orientation":return l(B_,{layout:this.const("vertical"),controller:this.props.controller});case"zoom-home":return l(LG,{controller:this.props.controller})}}})})})]})}),l(U_,{controller:()=>this.props.controller()})]})}shouldShowLeftPillboxes(){return this.shouldShowGeoReset()||this.shouldShowUndoRedo()}shouldShowGeoReset(){return this.controller.isGeometry()&&this.shouldShowResetButton()&&!this.controller.isListEnabled()}shouldShowUndoRedo(){return this.controller.isGeometry()&&!this.controller.isListEnabled()&&!(this.controller.getGeoToolbarSuppressedByAuthor()||this.controller.getGraphSettings().config.hideGeoUI)}getRightPillboxElements(){let e=[];return this.shouldShowGraphSettings()&&e.push("settings2d"),this.shouldShow3DGraphSettings()&&e.push("settings3d"),this.shouldShowGeometrySettings()&&e.push("settings-geo"),this.shouldShowResetButton()&&!this.shouldShowGeoReset()&&e.push("reset"),this.controller.shouldShowZoomInOutButtons()&&e.push("zoom-in-out"),this.shouldShowOrientationPillbox()&&this.controller.onSmallScreen()&&e.push("orientation"),this.controller.shouldShowZoomHomeButton()&&e.push("zoom-home"),e}shouldShowOrientationPillbox(){return this.controller.is3dProduct()&&this.controller.getGraphSettings().config.orientationButtons&&!this.controller.getGraphSettings().userLockedRotation}getContainerStyle(){let e=this.controller.isKeypadOpen()?this.controller.getKeypadHeight():0;return this.controller.isGraphSettingsOpen()?`bottom: ${e}px;`:"bottom: auto"}shouldShow3DGraphSettings(){return this.controller.getGraphSettings().config.settingsMenu&&this.controller.is3dProduct()}shouldShowGraphSettings(){return this.controller.getGraphSettings().config.settingsMenu&&!this.controller.isGeometry()&&!this.controller.is3dProduct()}shouldShowGeometrySettings(){return this.controller.getGraphSettings().config.settingsMenu?this.controller.isGeometry():!1}shouldShowResetButton(){return this.controller.getGraphSettings().config.showResetButtonOnGraphpaper&&this.controller.hasDefaultState()}};var ei=__dcg_shared_module_exports__['e'](j()),{If:W_}=ei.Components,IY=class extends ei.View{init(){this.controller=this.props.controller()}template(){return x("span",{class:ei.const("dcg-toast"),children:[l("i",{class:ei.const("dcg-icon-error"),"aria-hidden":ei.const("true")}),l(W_,{predicate:()=>!this.showUndo(),children:()=>l("i",{class:ei.const("dcg-icon-remove"),onTap:()=>this.props.onClose(),role:ei.const("link"),tabIndex:ei.const(0),"aria-label":ei.const("Dismiss Notice")})}),l("span",{class:ei.const("dcg-msg"),"aria-atomic":()=>this.shouldLiveUpdateAria(),"aria-live":()=>this.shouldLiveUpdateAria()?"assertive":"",children:()=>this.props.toastData().message}),l(W_,{predicate:this.bindFn(this.showUndo),children:()=>l("a",{role:ei.const("link"),tabIndex:ei.const(0),class:ei.const("dcg-undo"),onTap:()=>this.props.onUndo(),children:()=>this.controller.s("shared-calculator-label-toast-undo")})}),l(W_,{predicate:this.bindFn(this.showLearnMore),children:()=>l("a",{role:ei.const("link"),tabIndex:ei.const(0),target:ei.const("_blank"),onTap:()=>this.props.onLearnMore(),children:()=>this.controller.s("shared-calculator-label-toast-learn-more")})}),l(W_,{predicate:()=>!!this.props.toastData().link,children:()=>l("a",{role:ei.const("link"),tabIndex:ei.const(0),target:ei.const("_blank"),href:()=>{var e;return((e=this.props.toastData().link)==null?void 0:e.url)||""},children:()=>{var e;return((e=this.props.toastData().link)==null?void 0:e.text)||""}})})]})}showUndo(){return!!this.props.toastData().undoCallback}showLearnMore(){return!!this.props.toastData().learnMoreCallback}shouldUpdate(){return!!this.props.toastData().message}shouldLiveUpdateAria(){return!this.props.toastData().noAria}},zw=class extends ei.View{template(){return l("div",{class:()=>({"dcg-toast-view":!0,"dcg-visible":!!this.props.toastData().message,"dcg-below-geo-toolbar":this.isGeometryInCalculator()}),"toast-style":()=>this.props.toastData().toastStyle,children:l(W_,{predicate:()=>!!this.props.toastData().message,children:()=>x("div",{class:ei.const("dcg-toast-wrapper"),children:[l("div",{class:ei.const("dcg-toast-cover")}),l(IY,{...this.props})]})})})}isGeometryInCalculator(){var t;let e=this.props.controller();return(t=e.isGeometry)==null?void 0:t.call(e)}};var nn=__dcg_shared_module_exports__['e'](j());Ut();function VG(r){if(window.clipboardData&&window.clipboardData.getData)return window.clipboardData.getData("Text");if(r&&r.clipboardData&&r.clipboardData.getData)return r.clipboardData.getData("text/plain")}En();function MY(r){let e;if(typeof r=="number")e=r+"";else if(typeof r=="string")e=r;else return!1;return e.trim().match(/^-?[0-9]*\.?[0-9]*$/)}var ou={delimiter:"",header:!1,dynamicTyping:!1,preview:0,step:void 0,encoding:"",comments:!1,complete:void 0,error:void 0,download:!1,chunk:void 0,keepEmptyRows:!1},Fn={};Fn.parse=mSe;Fn.RECORD_SEP="";Fn.UNIT_SEP="";Fn.BYTE_ORDER_MARK="\uFEFF";Fn.BAD_DELIMITERS=["\r",`
`,'"',Fn.BYTE_ORDER_MARK];Fn.LocalChunkSize=1024*1024*10;Fn.RemoteChunkSize=1024*1024*5;Fn.DefaultDelimiter=",";Fn.Parser=OG;Fn.ParserHandle=Fre;function mSe(r,e){var t=fSe(e),o=new Fre(t),i=o.parse(r);return i}function Fre(r){var e=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,t=this,o,i,n=!1,a,s=[],c={data:[],errors:[],meta:{}};r=DY(r),this.parse=function(T){if(a=!1,!r.delimiter){var E=h(T);E.successful?r.delimiter=E.bestDelimiter:(a=!0,r.delimiter=Fn.DefaultDelimiter),c.meta.delimiter=r.delimiter}if(qw(r.step)){var I=r.step;r.step=function(_){c=_,p()?d():I(d(),t)}}return r.preview&&r.header&&r.preview++,o=T,i=new OG(r),c=i.parse(o),d(),qw(r.complete)&&!n&&r.complete(c),n?{meta:{paused:!0}}:c},this.pause=function(){n=!0,i.abort(),o=o.substr(i.getCharIndex())},this.resume=function(){n=!1,i=new OG(r),i.parse(o),qw(r.complete)&&!n&&r.complete(c)},this.abort=function(){i.abort(),qw(r.complete)&&r.complete(c),o=""};function d(){return c&&a&&(v("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+Fn.DefaultDelimiter+"'"),a=!1),p()&&u(),g()}function p(){return r.header&&s.length==0}function u(){if(c){for(var T=0;p()&&T<c.data.length;T++)for(var E=0;E<c.data[T].length;E++)s.push(c.data[T][E]);c.data.splice(0,1)}}function g(){if(!c||!r.header&&!r.dynamicTyping)return c;for(var T=0;T<c.data.length;T++){for(var E={},I=0;I<c.data[T].length;I++){if(r.dynamicTyping){var _=c.data[T][I];_=="true"?c.data[T][I]=!0:_=="false"?c.data[T][I]=!1:c.data[T][I]=b(_)}r.header&&(I>=s.length?(E.__parsed_extra||(E.__parsed_extra=[]),E.__parsed_extra.push(c.data[T][I])):E[s[I]]=c.data[T][I])}r.header&&(c.data[T]=E,I>s.length?v("FieldMismatch","TooManyFields","Too many fields: expected "+s.length+" fields but parsed "+I,T):I<s.length&&v("FieldMismatch","TooFewFields","Too few fields: expected "+s.length+" fields but parsed "+I,T))}return r.header&&c.meta&&(c.meta.fields=s),c}function h(T){for(var E=[",","	","|",";",Fn.RECORD_SEP,Fn.UNIT_SEP],I,_,C,D=0;D<E.length;D++){var P=E[D],F=0,N=0;C=void 0;for(var Y=new OG({delimiter:P,preview:10}).parse(T),z=0;z<Y.data.length;z++){var X=Y.data[z].length;if(N+=X,typeof C=="undefined"){C=X;continue}else X>1&&(F+=Math.abs(X-C),C=X)}N/=Y.data.length,(typeof _=="undefined"||F<_)&&N>1.99&&(_=F,I=P)}return r.delimiter=I,{successful:!!I,bestDelimiter:I}}function b(T){var E=e.test(T);return E?parseFloat(T):T}function v(T,E,I,_){c.errors.push({type:T,code:E,message:I,row:_})}}function OG(r){var e=/^\s*$/,t,o,i,n,a,s,c,d,p,u,g,h,b,v,T,E=!1;r=r||{},o=r.delimiter,i=r.comments,n=r.step,s=r.preview,(typeof o!="string"||o.length!=1||Fn.BAD_DELIMITERS.indexOf(o)>-1)&&(o=","),i===!0?i="#":(typeof i!="string"||i.length!=1||Fn.BAD_DELIMITERS.indexOf(i)>-1||i==o)&&(i=!1),this.parse=function(ae){if(typeof ae!="string")throw"Input must be a string";return ee(ae),I()},this.abort=function(){E=!0},this.getCharIndex=function(){return d};function I(){for(;d<t.length&&!(E||s>0&&T>=s);)c=='"'?D():p?P():F(),_();return C()}function _(){d++,c=t[d]}function C(){if(E&&Z("Abort","ParseAbort","Parsing was aborted by the user's step function"),p&&Z("Quotes","MissingQuotes","Unescaped or mismatched quotes"),S(),!qw(n))return he()}function D(){K()&&!V()?p=!p:(z(),p&&V()?d++:Z("Quotes","UnexpectedQuotes","Unexpected quotes"))}function P(){(O(d)||B(d))&&u++,z()}function F(){c==o?X():O(d)?(q(),_()):B(d)?q():N()?Y():z()}function N(){if(!i)return!1;var ae=d==0||B(d-1)||O(d-2);return ae&&t[d]===i}function Y(){for(;!O(d)&&!B(d)&&d<t.length;)_()}function z(){g[b][v]+=c}function X(){g[b].push(""),v=g[b].length-1}function q(){S(),u++,T++,g.push([]),b=g.length-1,X()}function S(){A(),qw(n)&&(g[b]&&n(he()),ue())}function A(){g[b].length==1&&e.test(g[b][0])&&(r.keepEmptyRows?g[b].splice(0,1):g.splice(b,1),b=g.length-1)}function O(ae){return ae<t.length-1&&(t[ae]=="\r"&&t[ae+1]==`
`||t[ae]==`
`&&t[ae+1]=="\r")}function B(ae){return t[ae]=="\r"||t[ae]==`
`}function V(){return!K()&&d<t.length-1&&t[d+1]=='"'}function K(){return!p&&oe(d-1)||oe(d+1)}function oe(ae){typeof ae!="number"&&(ae=d);var $=t[ae];return ae<=-1||ae>=t.length||$==o||$=="\r"||$==`
`}function Z(ae,$,se){h.push({type:ae,code:$,message:se,line:u,row:b,index:d})}function ee(ae){t=ae,p=!1,d=0,T=0,u=1,ue(),g=[[""]],c=t[d]}function ue(){g=[],h=[],b=0,v=0}function he(){return{data:g,errors:h,meta:{lines:u,delimiter:o,aborted:E,truncated:s>0&&d<t.length}}}}function fSe(r){typeof r!="object"&&(r={});var e=DY(r);return(typeof e.delimiter!="string"||e.delimiter.length!=1||Fn.BAD_DELIMITERS.indexOf(e.delimiter)>-1)&&(e.delimiter=ou.delimiter),typeof e.header!="boolean"&&(e.header=ou.header),typeof e.dynamicTyping!="boolean"&&(e.dynamicTyping=ou.dynamicTyping),typeof e.preview!="number"&&(e.preview=ou.preview),typeof e.step!="function"&&(e.step=ou.step),typeof e.complete!="function"&&(e.complete=ou.complete),typeof e.error!="function"&&(e.error=ou.error),typeof e.encoding!="string"&&(e.encoding=ou.encoding),typeof e.download!="boolean"&&(e.download=ou.download),typeof e.keepEmptyRows!="boolean"&&(e.keepEmptyRows=ou.keepEmptyRows),e}function DY(r){if(typeof r!="object")return r;var e=r instanceof Array?[]:{};for(var t in r)e[t]=DY(r[t]);return e}function qw(r){return typeof r=="function"}var{parse:Nre}=Fn;function Ure(r){let e=r.split(/\r?\n/),t=[],o=!1;if(!(e.length<2)){for(let i=0;i<e.length;i++){let n=e[i];if(!n.trim())continue;i>0&&!MY(n.replace(/,(\d{3})/g,"$1"))&&(o=!0);let a={content:n};t.push(a)}if(!o){let i=__dcg_shared_module_exports__['La'](t,"content").map(n=>n.replace(/,(\d{3})/g,"$1"));return MY(i[0])||(i=i.slice(1)),[{content:"\\left["+i.join(",")+"\\right]",numberList:!0}]}return t}}function Yre(r){if(/^\s*$/.test(r))return;let e=Nre(r,{preview:1e4}),t=e.data,o=[];if(e.errors.length&&!e.data.length){Er("PapaParse.parse returned errors.",{metaData:{input:r,output:e.errors}});return}if(!e.data.length||e.data.length<2)return;let i=t[0].length;for(let n=0;n<i;n++)o.push([]);for(let n=0;n<e.data.length;n++)if(!(n===0&&isNaN(parseFloat(t[n][0])))){if(t[n].length<2)return;if(!(!t[n][0]&&!t[n][1]))for(let a=0;a<i;a++){let s=(t[n][a]||"").replace(/,(\d{3})/g,"$1");if(s&&isNaN(parseFloat(s)))return;o[a].push(s)}}if(!(o[0].length<2))return o}function Bre(r){let e=__dcg_shared_module_exports__['f'](zo(r));return e.graph.product="geometry-calculator",e}function RG(r){return/^\s*(https?:\/\/)?([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/calculator\/./.test(r)}function AY(r){return/^\s*(https?:\/\/)?([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/(geometry|geometry-beta)\/./.test(r)}function LY(r){return/^\s*(https?:\/\/)?([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/3d\/./.test(r)}function PY(r){return/^\s*(https?:\/\/)?([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/geometry-legacy\/./.test(r)}function Hw(r){return RG(r)?"graphing":AY(r)?"geometry-calculator":PY(r)?"geometry":LY(r)?"graphing-3d":void 0}function Kre(r,e){if(!r||!e)return"";switch(e){case"graphing":return`https://www.desmos.com/calculator/${r}`;case"geometry-calculator":return`https://www.desmos.com/geometry/${r}`;case"graphing-3d":return`https://www.desmos.com/3d/${r}`}}async function FG(r,e,t){let o=!1;r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-importing-graph"),hideAfter:0,toastStyle:"cover",onHide:()=>{o=!0}}});let i=()=>{o||r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-error-importing-graph"),toastStyle:"error",hideAfter:12e3}})},n=()=>{r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-error-no-folders"),toastStyle:"error",hideAfter:12e3}})},a=(c,d)=>{r.dispatch({type:"set-state",state:c,opts:{forceUnsavedChanges:!0}}),r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-imported-graph"),undoCallback:()=>{r.dispatch({type:"set-state",state:d,opts:{forceUnsavedChanges:!0}})}}})},s=(c,d,p)=>{if(o)return;let u=r.getSelectedItem();if(!u)return;let g=u.type==="folder",h=u.type!=="folder"&&!!u.folderId,b=g||h,v={},T=r.getState(),E=T.expressions.list;if(E.length===1&&!g&&!r.isGeometry()){a(c,T);return}if(r.isGeometry()&&p!=="graphing"){a(c,T);return}let I=c.expressions.list;p==="graphing"&&Array.isArray(I)&&(I=I.filter(F=>F.id!==__dcg_shared_module_exports__['Zd']));for(let F=0;F<I.length;F++){let N=r.generateId(),Y=I[F];if(Y.type==="folder")if(b){n();return}else{v[Y.id]=N,Y.id=N;continue}Y.folderId?Y.folderId=v[Y.folderId]:g?Y.folderId=u.id:h&&(Y.folderId=u.folderId),Y.id=N}let _=__dcg_shared_module_exports__['f'](T),C=0;for(;C<E.length;){if(E[C].id===u.id){g&&(E[C].title=d);break}C+=1}let D=g?C+1:C,P=g?0:1;E.splice(D,P,...I),a(T,_)};try{let{migratedState:c,title:d,sourceProduct:p}=await ySe({url:e,targetProduct:r.getProduct()});t(c,(u,g)=>{u||!g||!p?i():s(g,d,p)})}catch(c){i()}}async function ySe(r){let e=await fetch(`${r.url}?${new URLSearchParams(Ig)}`,{headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Failed to fetch state from ${r.url} (status ${e.status})`);let t=await e.json(),o=t.state,i=Hw(r.url);return r.targetProduct==="geometry-calculator"&&(i==="geometry"?o=sh(o):i==="graphing"&&(o=Bre(o))),{migratedState:zo(o),title:t.title||"",sourceProduct:i}}En();var zre,qre="dcg-copy-expression";function GY(r,e,t){var a;if(!window.getSelection)return!1;let o=e.getSelectedItem();if(!zE()||!r.clipboardData||!o||e.isItemReadonly(o.id))return!1;let i=[gM(o,{stripDefaults:!0})];i[0].type!=="folder"&&delete i[0].folderId;let n="";switch(o.type){case"expression":if(!o.latex)return!1;n=o.latex;break;case"text":if(!o.text)return!1;n=o.text;break;case"image":n=o.name;break;case"folder":n=o.title;let s=sM(e.getListModel(),o.id);if(!o.title&&s.length===0)return!1;for(let u of s)i.push(gM(u,{stripDefaults:!0}));break;case"table":let c=[],d=Xn(o),p=(a=o.formula)==null?void 0:a.column_data.slice(0,o.columnModels.length-1);if(!p)return!1;for(let u=0;u<d;u++)__dcg_shared_module_exports__['Ia'](p,g=>!g.values[u])||c.push(p.map(g=>g.values[u]||"").join("	"));if(c.length===0)return!1;n=c.join(`
`);break}return r.clipboardData.setData("text/plain",n),r.clipboardData.setData(qre,JSON.stringify(i)),r.preventDefault(),t==="cut"?(e.dispatch({type:"delete-item-and-animate-out",id:o.id,setFocusAfterDelete:!e.isInEditListMode()}),!0):(e.dispatch({type:"set-highlighted-expressions",ids:i.map(s=>s.id)}),clearTimeout(zre),zre=setTimeout(()=>{e.dispatch({type:"set-highlighted-expressions",ids:[]})},400),!0)}function Hre(r,e){var o;let t=(o=r.clipboardData)==null?void 0:o.getData(qre);if(!t)return!1;r.preventDefault();try{let i=JSON.parse(t);return e.dispatch({type:"paste-expression",data:i}),!0}catch(i){return Er("pasteExpression error",{metaData:{content:t}}),!0}}function Wre(r,e){try{let t=VG(r);if(!t)return!1;let o=JSON.parse(t);return o.graph?(e.getProduct()===(o.graph.product||"graphing")?e.dispatch({type:"set-state",state:o}):e.dispatch({type:"paste-expression",data:[{type:"text",id:"doesnotmatter",text:t}]}),r.preventDefault(),r.stopPropagation(),!0):!1}catch(t){return!1}}var NG=__dcg_shared_module_exports__['e'](j()),j_=class extends NG.View{init(){this.controller=this.props.controller()}template(){return l("div",{class:NG.const("dcg-drag-container"),style:()=>({top:this.getTopPx(),left:this.getLeftPx()}),children:this.props.children})}getTopPx(){let e=this.controller.getRawDragState();if(e)return e.itemTop+"px"}getLeftPx(){let e=this.controller.getRawDragState();if(e)return e.itemLeft+"px"}};var Ww=__dcg_shared_module_exports__['e'](j());Ut();var{If:xSe}=Ww.Components,UG=class extends Ww.View{init(){this.guid=__dcg_shared_module_exports__['jb']("dcg-exp-list-resize")}template(){return l(xSe,{predicate:this.bindFn(this.isVisible),children:()=>l("div",{class:Ww.const("dcg-exp-list-resizer"),onTapStart:this.bindFn(this.onTapStart)})})}isVisible(){return this.props.controller().expressionsAreFullWidth()?!1:this.props.controller().isListVisible()}onTapStart(e){this.initialWidth=this.props.controller().getExpListWidth(),this.initialLeft=e.changedTouches[0].clientX,re(document).on(`dcg-tapmove.${this.guid}`,t=>{if(this.initialLeft===void 0||this.initialWidth===void 0)return;let o=t.changedTouches[0].clientX-this.initialLeft+this.initialWidth;this.props.controller().dispatch({type:"resize-exp-list",expListWidth:o})}),re(document).on(`dcg-tapend.${this.guid}`,this.bindFn(this.onTapEnd)),re(document).on(`dcg-tapcancel.${this.guid}`,this.bindFn(this.onTapEnd))}onTapEnd(){re(document).off(`.${this.guid}`),this.initialLeft=void 0,this.initialWidth=void 0}};var zm=__dcg_shared_module_exports__['e'](j());var{For:vSe,If:wSe}=zm.Components,YG=class extends zm.View{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){Sh(this.guid,this.controller)}willUnmount(){kh(this.guid,this.controller)}didMountArrow(e){this.arrowElt=e,dl(this.arrowElt,this.controller)}didUpdate(){dl(this.arrowElt,this.controller)}template(){let e=this.model;return x("div",{class:()=>({"dcg-table-column-menu":!0,"dcg-options-menu":!0}),role:zm.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu"),children:[l("div",{children:l(vSe,{each:this.bindFn(this.getSectionsWithColorAfterFirstOpen),children:t=>{switch(t){case"points":return l(ew,{model:()=>e,controller:this.props.controller,isOpen:()=>this.isSectionOpen("points")});case"drag":return l($1,{model:()=>e,controller:this.props.controller,isOpen:()=>this.isSectionOpen("drag")});case"lines":return l(Q1,{model:()=>e,controller:this.props.controller,isOpen:()=>this.isSectionOpen("lines")});case"colors":return l(cm,{model:()=>e,controller:this.props.controller})}}})}),l(dm,{model:()=>e,controller:()=>this.props.controller()}),l(wSe,{predicate:this.bindFn(this.shouldShowRegressionButton),children:()=>l("div",{class:zm.const("dcg-options-menu-section dcg-options-menu__regression-btn-container"),children:l("button",{class:()=>({"dcg-btn-light-gray":!0,"dcg-disabled":this.isRegressionButtonDisabled()}),onTap:this.bindFn(this.addRegression),children:()=>this.controller.s("graphing-calculator-button-add-table-regression")})})}),l("div",{class:zm.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0})]})}shouldShowRegressionButton(){return this.controller.shouldShowRegressionButton(this.model.table)?ju(this.model):!1}getSectionsWithColorAfterFirstOpen(){let e=this.getSections(),t=[],o=!1;for(let i of e)t.push(i),i==="colors"&&(o=!0),!o&&this.canColorComeAfterSection(i)&&this.isSectionOpen(i)&&(t.push("colors"),o=!0);return t}canColorComeAfterSection(e){switch(e){case"colors":case"drag":return!1;case"lines":case"points":return!0;default:return e}}getSections(){return this.model.draggable&&!this.controller.isThreeDMode()&&!this.controller.shouldIgnoreGraphInteractions(this.model)?["points","lines","drag"]:["points","lines"]}isSectionOpen(e){switch(e){case"drag":return this.model.dragMode!==__dcg_shared_module_exports__['Gd'].NONE;case"lines":return!!this.model.lines;case"points":return!!this.model.points;case"colors":return!0}}addRegression(){this.isRegressionButtonDisabled()||(this.controller.dispatch({type:"close-item-settings-menu"}),this.controller.dispatch({type:"create-table-regression",tableId:this.model.table.id,regressionType:"linear",columnIds:{y:this.model.id,x:this.model.table.columnModels[0].id}}))}isRegressionButtonDisabled(){return!Tg(this.model)}};var X_=__dcg_shared_module_exports__['e'](j());var BG=class extends X_.View{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){Sh(this.guid,this.controller)}willUnmount(){kh(this.guid,this.controller)}didMountArrow(e){this.arrowElt=e,dl(this.arrowElt,this.controller)}didUpdate(){dl(this.arrowElt,this.controller)}template(){let e=this.model;return x("div",{class:()=>({"dcg-table-column-menu":!0,"dcg-options-menu":!0}),role:X_.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu"),children:[l(cm,{model:()=>e,controller:this.props.controller}),l("div",{class:X_.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0})]})}};var Si=__dcg_shared_module_exports__['e'](j());var{If:$_}=Si.Components,KG=class extends Si.View{constructor(){super(...arguments),this.justGlobalReplaced=!1}init(){this.controller=this.props.controller()}template(){return l("div",{class:()=>({"dcg-expression-search-bar":!0,"dcg-expressions-scrolled":this.props.expsScrolled()&&!this.controller.getTickerOpen()}),role:Si.const("search"),children:x("div",{class:Si.const("dcg-search-row"),children:[x("div",{class:Si.const("dcg-search-mathquill-container"),children:[l(Qe,{hasError:this.const(!1),getAriaLabel:()=>this.controller.s("graphing-calculator-label-search-expressions"),getAriaPostLabel:()=>this.controller.getExpressionSearchStr().length===0?this.controller.raw(""):this.shouldShowReplaceError()?this.controller.s("graphing-calculator-error-expression-replacement"):this.shouldShowSearchError()?this.controller.s("graphing-calculator-error-expression-search"):this.controller.s("shared-calculator-text-search-results",{count:__dcg_shared_module_exports__['Db'](this.controller.getExpressionSearchCount())}),capExpressionSize:this.const(!1),onUserChangedLatex:this.bindFn(this.onSearchChange),latex:()=>this.controller.getRawExpressionSearchStr(),isFocused:this.bindFn(this.isSearchFocused),config:this.bindFn(this.getMQConfig),onFocusedChanged:this.bindFn(this.onSearchFocusChanged),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{if(e==="Esc")t&&t.preventDefault(),this.closeSearch();else if(e==="Enter")t&&t.preventDefault(),this.onEnter();else if(e==="Down"){let o=Qe.getFocusedMathquill();return!o||!Qe.applyArrowKeyAndReturnIfWasAtBounds(o,e,t)?void 0:this.controller.dispatch({type:"on-special-key-pressed",key:e})}else{let o=Qe.getFocusedMathquill();if(!o)return;o.keystroke(e,t),this.controller.getRawExpressionSearchStr()!==o.latex()&&(this.justGlobalReplaced=!1,this.onSearchChange(o.latex()))}}}),l("i",{class:Si.const("dcg-icon-search"),"aria-hidden":Si.const("true")}),l($_,{predicate:()=>this.controller.getRawExpressionSearchStr().length===0,children:()=>l("span",{class:Si.const("dcg-search-placeholder"),children:()=>this.controller.s("graphing-calculator-label-search-expressions")})}),l($_,{predicate:()=>this.shouldShowSearchError(),children:()=>l("span",{class:Si.const("dcg-search-replace-icon-container"),children:l(Zo,{error:()=>this.controller.s("graphing-calculator-error-expression-search"),size:this.const("small")})})}),l($_,{predicate:()=>this.controller.isSearchReplaceValid()&&!this.justGlobalReplaced,children:()=>l("span",{class:Si.const("dcg-search-replace-icon-container"),children:l("i",{class:Si.const("dcg-icon-replace"),role:Si.const("button"),tabIndex:Si.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-button-replace"),onTap:this.bindFn(this.onGlobalReplace)})})}),l($_,{predicate:()=>this.justGlobalReplaced,children:()=>l("span",{class:Si.const("dcg-search-replace-icon-container"),children:l("i",{class:Si.const("dcg-icon-check"),"aria-hidden":Si.const("true")})})}),l($_,{predicate:()=>this.shouldShowReplaceError(),children:()=>l("span",{class:Si.const("dcg-search-replace-icon-container"),children:l(Zo,{error:()=>this.controller.s("graphing-calculator-error-expression-replacement"),size:this.const("small")})})})]}),l("i",{onTap:()=>this.closeSearch(),tabIndex:Si.const("0"),"aria-label":()=>this.controller.s("account-shell-button-cancel"),role:Si.const("button"),class:Si.const("dcg-icon-remove dcg-do-not-blur")})]})})}onGlobalReplace(){this.justGlobalReplaced=!0,setTimeout(this.bindIfMounted(()=>{this.justGlobalReplaced=!1,this.update()}),1500),this.controller.dispatch({type:"rename-identifier-global",search:this.controller.getExpressionSearchStr(),replace:this.controller.getExpressionReplaceStr()})}onEnter(){this.controller.isSearchReplaceValid()?this.onGlobalReplace():this.controller.dispatch({type:"update-expression-search-str",str:this.controller.getRawExpressionSearchStr()})}shouldShowSearchError(){return!this.controller.getIsExpressionSearchStrValidForReplace()&&this.controller.getExpressionReplaceStr().length>0}shouldShowReplaceError(){return!this.shouldShowSearchError()&&!this.controller.getIsExpressionReplaceStrValidForReplace()&&this.controller.getExpressionReplaceStr().length>0}closeSearch(){this.controller.dispatch({type:"close-expression-search"})}onSearchChange(e){this.controller.dispatch({type:"update-expression-search-str",str:e})}onSearchFocusChanged(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"search-expressions"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"search-expressions"}})}isSearchFocused(){let e=this.controller.getFocusLocation();return!!e&&e.type==="search-expressions"}onReplaceChange(e){this.controller.dispatch({type:"update-expression-replace-str",str:e})}onReplaceFocusChanged(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"replace-expressions"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"replace-expressions"}})}isReplaceFocused(){let e=this.controller.getFocusLocation();return!!e&&e.type==="replace-expressions"}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["label","rename","image","alt"]})}};var ti=__dcg_shared_module_exports__['e'](j());var en=__dcg_shared_module_exports__['e'](j());Ut();var is=__dcg_shared_module_exports__['e'](j());var Hm=__dcg_shared_module_exports__['e'](j());Ut();var fn=__dcg_shared_module_exports__['e'](j());var{For:jre,If:zG,IfDefined:SSe,Switch:kSe}=fn.Components,Jl=class extends fn.View{template(){var e,t;return x("div",{role:fn.const("list"),class:()=>{var o,i;return{"dcg-shared-options-dropdown":!0,[((i=(o=this.props).class)==null?void 0:i.call(o))||""]:!!this.props.class}},children:[l(jre,{each:this.props.options,children:o=>x("div",{role:fn.const("listitem"),class:fn.const("dropdown-option-container"),children:[l(kSe,{children:i=>"href"in i?x("a",{"aria-disabled":()=>i.disabled,"aria-selected":()=>{var n;return(n=i.selected)==null?void 0:n.call(i)},id:this.const(i.key),tabIndex:()=>this.getTabIndex(i),class:()=>{var n;return{[i.class||""]:!!i.class,"dcg-standard-link-styling":!i.class,"dcg-dropdown-choice":!0,"dcg-disabled":i.disabled,"dcg-selected":(n=i.selected)==null?void 0:n.call(i)}},onTap:()=>!i.disabled&&this.props.onTap(i),href:()=>i.href,target:()=>i.target!==void 0?i.target:"",rel:()=>i.noreferrer?"noreferrer noopener":"",children:[l(zG,{predicate:()=>i.icon!=null,children:()=>l("div",{class:fn.const("dcg-option-icon-container"),children:l("i",{"aria-hidden":fn.const("true"),class:()=>`${i.icon} dcg-option-icon`})})}),l(Xi,{content:i.title})]}):x("div",{role:fn.const("link"),tabIndex:()=>this.getTabIndex(i),"aria-disabled":()=>i.disabled,"aria-selected":()=>{var n;return(n=i.selected)==null?void 0:n.call(i)},id:this.const(i.key),class:()=>{var n;return{[i.class||""]:!!i.class,"dcg-standard-link-styling":!i.class,"dcg-dropdown-choice":!0,"dcg-disabled":i.disabled,"dcg-selected":(n=i.selected)==null?void 0:n.call(i)}},onTap:()=>!i.disabled&&this.props.onTap(i),children:[l(zG,{predicate:()=>i.icon!=null,children:()=>l("div",{class:fn.const("dcg-option-icon-container"),children:l("i",{"aria-hidden":fn.const("true"),class:()=>`${i.icon} dcg-option-icon`})})}),l("span",{class:fn.const("option-title"),children:l(Xi,{content:i.title})}),SSe(()=>i.subtitle&&i.subtitle(),n=>l("span",{class:fn.const("dcg-option-subtitle"),children:n}))]})},()=>o),l(zG,{predicate:()=>!!o.explanations,children:()=>l("div",{class:fn.const("dcg-dropdown-explanations"),children:l(jre,{each:()=>o.explanations||[],children:i=>x("div",{class:fn.const("dcg-explanation"),children:[()=>i.explanation," ",l(zG,{predicate:()=>!!i.link,children:()=>l("a",{class:fn.const("learn-more"),href:()=>i.link!==void 0?i.link:"",target:fn.const("_blank"),children:()=>i.linkText?i.linkText:wt("shared-button-learn-more-capitalized")})})]})},i=>i.flag)})})]})},o=>`${o.key?o.key:o.title()}${o.disabled?"-disabled":""}`),(t=(e=this.props).buildFooter)==null?void 0:t.call(e)]})}getTabIndex(e){var t;return e.disabled&&!((t=e.selected)!=null&&t.call(e))?-1:0}},qm=class extends fn.View{init(){this.showDropdown=!1}template(){var e;return l(oa,{anchor:this.props.anchor,containerClassName:this.props.containerClassName,controlled:()=>({isOpen:this.showDropdown,setDropdownOpen:this.bindFn(this.setDropdownOpen)}),anchorAriaLabel:this.props.anchorAriaLabel,disabled:this.props.disabled,guid:this.props.guid,dropdownProps:()=>({position:this.const("bottom-left"),hideArrow:this.props.hideArrow}),dropdownOffset:this.props.dropdownOffset,focusTrapping:(e=this.props.focusTrapping)!=null?e:this.const({itemNavigationKey:"arrow"}),popoverBody:()=>l(Jl,{...this.props,onTap:this.bindFn(this.tapOption)})})}tapOption(e){e.action!==void 0&&e.action(),!e.preventClose&&("href"in e?e.isDeepLink&&setTimeout(()=>this.setDropdownOpen(!1),0):this.setDropdownOpen(!1))}setDropdownOpen(e){this.showDropdown=e,this.update()}};var{If:_Se,IfElse:CSe}=Hm.Components,Ld=class extends Hm.View{init(){var e,t;this.i18n=this.props.controller(),this.filter=(t=(e=this.props).defaultValue)==null?void 0:t.call(e),this.shouldShowResults=!1,this.uuid=yc(),this.focusHelper=new am({anchorSelector:`#dcg-select-dropdown-container-${this.props.id()} .dcg-dropdown-input`,popoverSelector:`#dcg-select-dropdown-container-${this.props.id()} .dcg-select-dropdown-list`,isOpen:()=>this.isOpen(),closeMenu:()=>this.setResultsOpen(!1),itemNavigationKey:"arrow"})}handleKeyDown(e){var t;switch(Pe(e)){case Mi:if(!this.isOpen()){this.setResultsOpen(!0),e.preventDefault();return}break;case us:if(this.isOpen()){let o=this.focusHelper.getFocusedElement();o&&(this.selectOptionById((t=o.getAttribute("id"))!=null?t:void 0),e.preventDefault());return}break}this.focusHelper.handleKeydown(e)}template(){return x("div",{class:Hm.const("dcg-select-dropdown-container"),onKeyDown:this.bindFn(this.handleKeyDown),didMount:this.bindFn(this.attachTapListener),didUnmount:this.bindFn(this.unmountTapListener),id:()=>`dcg-select-dropdown-container-${this.props.id()}`,children:[x("button",{class:()=>({"dcg-dropdown-input":!0,"dcg-results-hidden":!this.isOpen()}),"aria-haspopup":this.const("listbox"),"aria-expanded":()=>this.isOpen(),onTap:this.bindFn(this.toggleResultsOpen),didMount:e=>{var t,o;(o=(t=this.props).focusOnMount)!=null&&o.call(t)&&e.focus()},id:this.props.id,manageFocus:()=>{var e,t;return(t=(e=this.props).manageFocus)==null?void 0:t.call(e)},children:[l(Xi,{content:this.bindFn(this.getFilterString)}),CSe(()=>this.isOpen(),{true:()=>l("i",{class:Hm.const("dcg-icon-caret-up dcg-open-options"),"aria-label":()=>this.i18n.s("shared-calculator-button-hide-options")}),false:()=>l("i",{class:Hm.const("dcg-icon-caret-down dcg-open-options"),"aria-label":()=>this.i18n.s("shared-calculator-button-show-options")})})]}),l(_Se,{predicate:()=>this.isOpen(),children:()=>l("div",{class:()=>{var e,t;return{"dcg-options-dropdown__container":!0,"dcg-options-dropdown__padded-bottom-container":(t=(e=this.props).addBottomPaddingToDropdown)==null?void 0:t.call(e)}},children:l(Jl,{options:()=>this.getOptions(),onTap:e=>this.selectOptionById(e.key),class:this.const("dcg-select-dropdown-list"),buildFooter:this.props.buildFooter})})})]})}getOptions(){return this.props.options().map(e=>({key:e.id,title:()=>e.label,selected:()=>e.label===this.getFilterString(),disabled:e.disabled,class:"dcg-select-dropdown-option"}))}isOpen(){return!!this.shouldShowResults}setResultsOpen(e){var t,o;if(this.shouldShowResults=e,this.update(),(o=(t=this.props).onOpenChange)==null||o.call(t,e),e)if(this.filter){let i=this.props.options().find(n=>n.id===this.filter);this.focusOption(i)}else if(this.props.externalControl){let i=this.props.externalControl().getValue(),n=this.props.options().find(a=>a.id===i);this.focusOption(n)}else this.focusHelper.focusFirstItem()}toggleResultsOpen(){this.setResultsOpen(!this.shouldShowResults)}focusOption(e){if(!e)return;let t=document.querySelector(`#dcg-select-dropdown-container-${this.props.id()} .dcg-select-dropdown-list #${e.id}`);t==null||t.focus()}onInputChange(e){this.props.externalControl?this.props.externalControl().onValueChange(e):this.filter=e,this.update()}getFilterString(){let t=this.props.options().find(o=>o.id===(this.props.externalControl?this.props.externalControl().getValue():this.filter));return(t==null?void 0:t.label)||""}selectOptionById(e){var i,n;let o=this.props.options().find(a=>a.id===e);o&&(this.onInputChange(o.id),this.setResultsOpen(!1),this.focusHelper.focusAnchor(),(n=(i=this.props).onChange)==null||n.call(i,o.id))}unmountTapListener(){re(document.body).off(`dcg-tapstart.dcg-select-dropdown-container-${this.uuid}`)}attachTapListener(){re(document.body).on(`dcg-tapstart.dcg-select-dropdown-container-${this.uuid}`,this.bindFn(this.tapListener))}tapListener(e){e.target.closest(`#dcg-select-dropdown-container-${this.props.id()}`)||this.setResultsOpen(!1)}};var{If:VY,For:TSe}=is.Components,RY={inferenceWizardData:{sampleType:"data",inferenceType:"t",statisticType:"mean-1",samples:[],samplePropModels:[]},inferenceObjectModels:{},exportedConfidenceIntervalCount:0},WG={t:{data:["list"],stats:["mean","stdev","count"]},z:{data:["list","stdevp"],stats:["mean","count","stdevp"]},zprop:{stats:["successes","count"],data:[]}},Xre={list:"graphing-calculator-label-inference-list",count:"graphing-calculator-label-inference-count",mean:"graphing-calculator-label-inference-mean",stdev:"graphing-calculator-label-inference-stdev",successes:"graphing-calculator-label-inference-successes",stdevp:"graphing-calculator-label-inference-pop-stdev",estimate:"graphing-calculator-label-inference-estimate"},J_=r=>{var i,n,a,s;let{formula:e,sampleProp:t,inferenceType:o}=r;if(!e)return!1;switch(t){case"list":return((i=e.typed_constant_value)==null?void 0:i.valueType)===__dcg_shared_module_exports__['E'];case"count":case"successes":return!(((n=e.typed_constant_value)==null?void 0:n.valueType)!==__dcg_shared_module_exports__['B']||e.typed_constant_value.value<0||Math.floor(e.typed_constant_value.value)!==e.typed_constant_value.value||t==="count"&&o==="t"&&e.typed_constant_value.value<2);case"mean":return((a=e.typed_constant_value)==null?void 0:a.valueType)===__dcg_shared_module_exports__['B'];case"stdev":case"stdevp":return((s=e.typed_constant_value)==null?void 0:s.valueType)===__dcg_shared_module_exports__['B']&&e.typed_constant_value.value>=0;case"estimate":return!0;default:throw new Error(`Unexpected prop ${t}`)}},OY=class extends is.View{init(){this.controller=this.props.controller()}getLatex(){var e,t;return(t=(e=this.controller.getInferenceWizardData().samples[this.props.sampleIndex()])==null?void 0:e[this.props.sampleProp()])!=null?t:""}setLatex(e){let t=this.props.sampleIndex();return this.controller.dispatch({type:"set-inference-wizard-sample-data",sampleIndex:t,update:{[this.props.sampleProp()]:e}})}isFocused(){let e=this.controller.getFocusLocation();return(e==null?void 0:e.type)==="add-inference-wizard"&&e.subtype==="sample-prop-input"&&e.sampleIndex===this.props.sampleIndex()&&e.sampleProp===this.props.sampleProp()}handleFocusChanged(e){return this.controller.dispatch({type:e?"set-focus-location":"blur-focus-location",location:{type:"add-inference-wizard",subtype:"sample-prop-input",sampleIndex:this.props.sampleIndex(),sampleProp:this.props.sampleProp()}})}showError(){return this.props.hasError()&&!!this.getLatex()}template(){return x("li",{class:is.const("dcg-inference--sample-property"),children:[x("label",{children:[()=>this.controller.s(Xre[this.props.sampleProp()]),":"]}),l("div",{class:is.const("dcg-add-inference-wizard--prop-input-wrapper"),children:l(or,{latex:this.bindFn(this.getLatex),isFocused:this.bindFn(this.isFocused),ariaLabel:()=>this.controller.s(Xre[this.props.sampleProp()]),hasError:this.bindFn(this.showError),handleLatexChanged:e=>this.setLatex(e),controller:this.props.controller,readonly:this.const(!1),handlePressedKey:(e,t)=>{if(e==="Enter")this.props.onEnter();else{let o=Qe.getFocusedMathquill();if(!o)return;o.keystroke(e,t),this.setLatex(o.latex())}},handleFocusChanged:e=>this.handleFocusChanged(e)})})]})}},qG=class extends is.View{getRequiredProps(){return WG[this.props.inferenceType()][this.props.sampleType()]}init(){this.controller=this.props.controller()}template(){return x("div",{class:is.const("dcg-add-inference-wizard--sample-description"),children:[l("h3",{children:()=>this.controller.s("graphing-calculator-label-inference-wizard-sample-label",{index:this.props.sampleIndex()+1})}),l("ul",{class:is.const("dcg-unstyled-list"),children:l(TSe,{each:()=>this.getRequiredProps(),children:e=>l(OY,{controller:this.props.controller,sampleProp:this.const(e),sampleIndex:this.props.sampleIndex,onEnter:this.props.onEnter,hasError:()=>this.props.hasError(e,this.props.sampleIndex())})})})]})}},HG=class extends is.View{init(){this.controller=this.props.controller()}getStatisticType(){return this.controller.getInferenceWizardData().statisticType}setStatisticType(e){let t=this.getInferenceType(),o=this.getSampleType();return e.startsWith("proportion")?(t="zprop",o="stats"):t==="zprop"&&(t="t"),this.controller.dispatch({type:"set-inference-wizard-data",update:{statisticType:e,inferenceType:t,sampleType:o}})}getStatisticTypeOptions(){return[{id:"mean-1",label:this.controller.s("graphing-calculator-label-inference-wizard-1-mean")},{id:"mean-2",label:this.controller.s("graphing-calculator-label-inference-wizard-2-means")},{id:"proportion-1",label:this.controller.s("graphing-calculator-label-inference-wizard-1-proportion")},{id:"proportion-2",label:this.controller.s("graphing-calculator-label-inference-wizard-2-proportions")}]}getInferenceType(){return this.controller.getInferenceWizardData().inferenceType}setInferenceType(e){return this.controller.dispatch({type:"set-inference-wizard-data",update:{inferenceType:e}})}getInferenceTypeOptions(){return this.getStatisticType().startsWith("proportion")?[{id:"zprop",label:"zprop"}]:[{id:"t",label:"t"},{id:"z",label:"z"}]}getSampleType(){return this.controller.getInferenceWizardData().sampleType}setSampleType(e){return this.controller.dispatch({type:"set-inference-wizard-data",update:{sampleType:e}})}getSampleTypeOptions(){return[{key:"data",label:()=>this.controller.s("graphing-calculator-label-inference-wizard-data"),onSelect:()=>this.setSampleType("data"),selected:()=>this.getSampleType()==="data"},{key:"stats",label:()=>this.controller.s("graphing-calculator-label-inference-wizard-stats"),onSelect:()=>this.setSampleType("stats"),selected:()=>this.getSampleType()==="stats"}]}getSampleCount(){return this.getStatisticType().endsWith("1")?1:2}hasInvalidProp(){let e=this.getInferenceType(),t=WG[e][this.getSampleType()];for(let o=0;o<this.getSampleCount();o++)if(t.find(i=>this.hasError(i,o)))return!0;return!1}hasError(e,t){var i,n,a,s;let o=this.getInferenceType();if(e==="count"){let c=(n=(i=this.controller.getFormulaForInferenceSampleProp(t,"successes"))==null?void 0:i.typed_constant_value)==null?void 0:n.value,d=(s=(a=this.controller.getFormulaForInferenceSampleProp(t,"count"))==null?void 0:a.typed_constant_value)==null?void 0:s.value;if(d!==void 0&&c!==void 0&&d<c)return!0}return e==="list"?!J_({sampleProp:e,formula:this.controller.getFormulaForInferenceSampleProp(t,e),inferenceType:o})&&!J_({sampleProp:e,formula:this.controller.getFormulaForInferenceSampleProp(t,"listWrapped"),inferenceType:o}):!J_({sampleProp:e,formula:this.controller.getFormulaForInferenceSampleProp(t,e),inferenceType:o})}doAddInference(){if(!this.hasInvalidProp())return this.controller.dispatch({type:"new-inference"})}template(){return x("div",{class:is.const("dcg-popover-interior dcg-add-inference-wizard dcg-inference-ui"),children:[x("header",{children:[l("button",{onTap:e=>this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:e.device==="keyboard"}),manageFocus:this.const(ze({controller:this.controller,location:{type:"add-inference-wizard",subtype:"back-button"}})),class:is.const("dcg-unstyled-button dcg-gray-link"),children:l("i",{class:is.const("dcg-icon dcg-icon-chevron-left")})}),l("h2",{children:()=>this.controller.s("graphing-calculator-narration-inference-wizard-title")})]}),x("div",{class:is.const("dcg-add-inference-wizard--select-type"),children:[l(Ld,{id:()=>"add-inference--data-type",controller:this.props.controller,options:this.bindFn(this.getStatisticTypeOptions),externalControl:this.const({getValue:this.bindFn(this.getStatisticType),onValueChange:e=>this.setStatisticType(e)})}),l(VY,{predicate:()=>!this.getStatisticType().startsWith("proportion"),children:()=>l(Ld,{id:()=>"add-inference--inference-type",controller:this.props.controller,options:this.bindFn(this.getInferenceTypeOptions),externalControl:this.const({getValue:this.bindFn(this.getInferenceType),onValueChange:e=>this.setInferenceType(e)})})})]}),l(VY,{predicate:()=>!this.getStatisticType().startsWith("proportion"),children:()=>l(ar,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-label-inference-wizard-sample-type"),theme:this.const("default"),staticConfig:this.bindFn(this.getSampleTypeOptions)})}),x("div",{class:()=>({"dcg-inference-ui--samples":!0,[`dcg-inference-ui--${this.getSampleCount()}-sample`]:!0}),children:[l(qG,{sampleType:this.bindFn(this.getSampleType),controller:this.props.controller,inferenceType:this.bindFn(this.getInferenceType),sampleIndex:this.const(0),onEnter:this.bindFn(this.doAddInference),hasError:this.bindFn(this.hasError)}),l(VY,{predicate:()=>this.getSampleCount()===2,children:()=>l(qG,{sampleType:this.bindFn(this.getSampleType),controller:this.props.controller,inferenceType:this.bindFn(this.getInferenceType),sampleIndex:this.const(1),onEnter:this.bindFn(this.doAddInference),hasError:this.bindFn(this.hasError)})})]}),l("div",{class:is.const("dcg-add-inference-wizard--create-button-wrapper"),children:l("button",{onTap:this.bindFn(this.doAddInference),class:()=>({"dcg-disabled":this.hasInvalidProp(),"dcg-btn-blue":!0}),disabled:()=>this.hasInvalidProp()?!0:void 0,manageFocus:this.const(ze({controller:this.controller,location:{type:"add-inference-wizard",subtype:"create-button"}})),children:()=>this.controller.s("graphing-calculator-narration-inference-wizard-create-inference")})})]})}};var{If:Wm}=en.Components,jm=class extends en.View{init(){this.controller=this.props.controller()}getAriaLabel(){let e=this.props.itemType();switch(e){case"expression":return this.controller.s("graphing-calculator-narration-add-expression");case"note":return this.controller.s("graphing-calculator-narration-add-note");case"folder":return this.controller.s("graphing-calculator-narration-add-folder");case"table":return this.controller.s("graphing-calculator-narration-add-table");case"ticker":return this.controller.s("graphing-calculator-narration-add-ticker");case"inference":return this.controller.s("graphing-calculator-narration-add-inference");default:throw new Error(`Unexpected ${e}`)}}getIconText(){let e=this.props.itemType();switch(e){case"expression":return this.controller.s("graphing-calculator-label-expression-lowercase");case"note":return this.controller.s("graphing-calculator-label-note-lowercase");case"folder":return this.controller.s("graphing-calculator-label-folder-lowercase");case"table":return this.controller.s("graphing-calculator-label-table-lowercase");case"ticker":return this.controller.s("graphing-calculator-label-ticker-lowercase");case"inference":return this.controller.s("graphing-calculator-label-inference-lowercase");default:throw new Error(`Unexpected ${e}`)}}onTap(){let e=this.props.itemType();switch(e){case"ticker":this.controller.dispatch({type:"open-ticker"});break;case"inference":this.controller.dispatch({type:"open-inference-wizard"});break;default:this.controller.dispatch({type:`new-${e}`})}}getFocusHelper(){return ze({controller:this.controller,location:{type:`add-${this.props.itemType()}-btn`}})}template(){return x("div",{class:()=>({"dcg-new-item":!0,"dcg-do-not-blur":!0,[`dcg-action-new${this.props.itemType()}`]:!0}),role:en.const("button"),tabIndex:en.const(0),"aria-label":this.bindFn(this.getAriaLabel),onTap:this.bindFn(this.onTap),handleEvent:en.const("true"),manageFocus:this.bindFn(this.getFocusHelper),children:[l("i",{class:()=>({[`dcg-icon-new-${this.props.itemType()}`]:!0,"dcg-expression-icon":!0}),"aria-hidden":en.const("true")}),()=>this.getIconText()]})}},Z_=class extends en.View{init(){this.controller=this.props.controller()}template(){return x("div",{class:en.const("dcg-add-expression-container"),children:[l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-add-item-tooltip"),gravity:this.const("s"),children:l("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-icon-btn":!0,"dcg-add-expression-btn":!0,"dcg-action-add-expression":!0,"dcg-do-blur":!0,"dcg-active":this.controller.isAddExpressionOpen()}),handleEvent:en.const("true"),"aria-haspopup":en.const("true"),"aria-expanded":()=>this.controller.isAddExpressionOpen(),"aria-label":()=>this.controller.s("graphing-calculator-label-add-item-tooltip"),didMount:e=>{this.toggleButtonNode=e},onTap:this.bindFn(this.toggleAddExpression),manageFocus:this.const(ze({controller:this.controller,location:{type:"add-item-btn"}})),children:l("i",{class:en.const("dcg-icon-plus"),"aria-hidden":en.const("true")})})}),l(Wm,{predicate:()=>this.controller.isAddExpressionOpen()||this.controller.isAddInferenceOpen(),children:()=>x("div",{class:()=>({"dcg-popover":!0,"dcg-bottom":!this.controller.isNarrow(),"dcg-right":this.controller.isNarrow()}),role:en.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-item-menu"),didMount:this.bindFn(this.didMountPopover),didUnmount:this.bindFn(this.didUnmountPopover),children:[l(Wm,{predicate:()=>this.controller.isAddExpressionOpen()&&!this.controller.isAddInferenceOpen(),children:()=>x("div",{class:en.const("dcg-popover-interior dcg-add-expression-dropdown"),children:[l(jm,{controller:this.props.controller,itemType:this.const("expression")}),l(Wm,{predicate:()=>this.controller.areNotesEnabled(),children:()=>l(jm,{controller:this.props.controller,itemType:this.const("note")})}),l(jm,{controller:this.props.controller,itemType:this.const("table")}),l(Wm,{predicate:()=>this.controller.isInferenceEnabled(),children:()=>l(jm,{controller:this.props.controller,itemType:this.const("inference")})}),l(Wm,{predicate:()=>this.controller.areFoldersEnabled(),children:()=>l(jm,{controller:this.props.controller,itemType:this.const("folder")})}),l(Wm,{predicate:()=>this.controller.areImagesEnabled(),children:()=>l(wh,{controller:()=>this.controller,ariaLabel:()=>this.controller.s("graphing-calculator-narration-add-image"),onFileChange:e=>this.insertFiles(e),location:this.const({type:"add-image-btn"}),readonly:this.const(!1),children:x("div",{class:en.const("dcg-new-item dcg-action-newimage"),children:[l("i",{class:en.const("dcg-icon-new-image dcg-expression-icon"),"aria-hidden":en.const("true")}),()=>this.controller.s("graphing-calculator-label-image-lowercase")]})})}),l(Wm,{predicate:this.bindFn(this.showAddTicker),children:()=>l(jm,{controller:this.props.controller,itemType:this.const("ticker")})})]})}),l(Wm,{predicate:()=>this.controller.isAddInferenceOpen(),children:()=>l(HG,{controller:this.props.controller})}),l("span",{class:en.const("dcg-arrow")})]})})]})}showAddTicker(){return this.controller.areActionsEnabled()&&!this.controller.getTickerOpen()}didMountPopover(e){this.popoverNode=e,re(document).on("dcg-tapstart.add-expression-view wheel.add-expression-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-add-expression",focusIconAfterClose:t.device==="keyboard"})}),re(document).on("keydown.add-expression-view",t=>{if(Pe(t)==="Esc"&&this.controller.dispatch({type:"close-add-expression",focusIconAfterClose:!0}),Pe(t)==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let o=this.controller.getFocusLocation();if(!o)return;let i;this.showAddTicker()?i={type:"add-ticker-btn"}:this.controller.areImagesEnabled()?i={type:"add-image-btn"}:this.controller.areFoldersEnabled()?i={type:"add-folder-btn"}:i={type:"add-table-btn"},!t.shiftKey&&o.type===i.type?(this.controller.dispatch({type:"set-focus-location",location:{type:"add-item-btn"}}),t.preventDefault(),t.stopPropagation()):t.shiftKey&&o.type==="add-item-btn"&&(this.controller.dispatch({type:"set-focus-location",location:i}),t.preventDefault(),t.stopPropagation())}}),ha&&Uu&&re(e).on("dcg-tapstart",t=>t.preventDefault()),re(e.querySelector(".dcg-new-item")).on("touchstart",t=>t.preventDefault())}didUnmountPopover(){re(document).off(".add-expression-view")}toggleAddExpression(e){this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:e.device==="keyboard"})}insertFiles(e){this.controller.dispatch({type:"new-images",files:e})}eventShouldClosePopover(e){let t=!!this.popoverNode.contains(e.target),o=!!this.toggleButtonNode.contains(e.target),i=!!e.target.closest(".dcg-keypad");return!(t||o||i)}};var jw=__dcg_shared_module_exports__['e'](j());var jG=class extends jw.View{init(){this.controller=this.props.controller()}template(){return x("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-constructions-count-link":!0,"dcg-icon-btn":!0,"dcg-active":this.controller.getShowConstructionsOpen(),"dcg-do-not-blur":!0}),handleEvent:jw.const("true"),"aria-expanded":()=>this.controller.getShowConstructionsOpen(),manageFocus:this.const(ze({controller:this.controller,location:{type:"geo-show-constructions-icon"}})),onTap:this.bindFn(this.showAllConstructions),children:[l("i",{class:jw.const("dcg-icon-geometry"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-construction-icon-label")}),l("span",{class:jw.const("dcg-construction-count"),children:()=>this.controller.getGeometryTokenCount()})]})}showAllConstructions(){this.controller.dispatch({type:"set-show-constructions-open",open:!this.controller.getShowConstructionsOpen(),setFocus:!1})}};var Q_=__dcg_shared_module_exports__['e'](j());Ut();var XG=class extends Q_.View{init(){this.controller=this.props.controller()}toggleMuted(){var e;(e=this.controller.toneController)!=null&&e.isGlobalMuted()?this.controller.dispatch({type:"unmute-global"}):this.controller.dispatch({type:"mute-global"})}getMutedState(){return!this.controller.toneController||this.controller.toneController.isGlobalMuted()?"muted":"playing"}getAriaLabel(){switch(this.getMutedState()){case"playing":return this.controller.s("graphing-calculator-narration-mute-all");case"muted":return this.controller.s("graphing-calculator-narration-unmute-all")}}template(){return l(Oe,{gravity:this.const("s"),tooltip:this.bindFn(this.getAriaLabel),children:x("button",{class:()=>{var e;return{"dcg-global-mute-button":!0,"dcg-unstyled-button":!0,"dcg-icon-btn":!0,"dcg-is-muted":this.getMutedState()==="muted","dcg-has-never-interacted":!((e=this.controller.toneController)!=null&&e.getHasEverInteractedWithMute())}},didMount:e=>re(e).on("tipsyshow",()=>{var t;(t=this.controller.toneController)==null||t.registerMuteInteraction(),this.update()}),onTap:()=>this.toggleMuted(),manageFocus:this.const(ze({controller:this.controller,location:{type:"global-mute-button"}})),"aria-label":this.bindFn(this.getAriaLabel),children:[l("span",{class:Q_.const("dcg-first-time-animation")}),l("i",{class:Q_.const("dcg-icon-volume")})]})})}};var{If:iu}=ti.Components,eC=class extends ti.View{init(){this.controller=this.props.controller()}template(){return x("div",{class:()=>({"dcg-expression-top-bar":!0,"dcg-expressions-scrolled":this.showShadow()}),role:ti.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-narration-expression-bar"),didMount:e=>{this.node=e},onTapStart:this.bindFn(this.clearSelectionOnMobile),children:[l(iu,{predicate:this.bindFn(this.showHamburger),children:()=>l("button",{class:ti.const("dcg-unstyled-button dcg-action-opendrawer dcg-tooltip dcg-icon-btn dcg-in-api-action-opendrawer"),handleEvent:ti.const("true"),tooltip:this.bindFn(this.getHamburgerLabel),"aria-label":this.bindFn(this.getHamburgerLabel),onTap:()=>this.controller.dispatch({type:"open-drawer"}),children:l("i",{class:ti.const("dcg-icon-hamburger"),"aria-hidden":ti.const("true")})})}),l(iu,{predicate:()=>!this.controller.isInEditListMode(),children:()=>l(Z_,{controller:()=>this.props.controller()})}),l(iu,{predicate:()=>this.controller.isGeoUIActive()&&!this.controller.isInEditListMode(),children:()=>l(jG,{controller:this.props.controller})}),l(iu,{predicate:this.bindFn(this.showMuteButton),children:()=>l(XG,{controller:this.props.controller})}),l(iu,{predicate:this.bindFn(this.showRerandomize),children:()=>l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-randomize-tooltip"),gravity:this.const("s"),children:l("button",{class:ti.const("dcg-unstyled-button dcg-icon-btn"),handleEvent:ti.const("true"),"aria-label":()=>this.controller.s("graphing-calculator-label-randomize-tooltip"),onTap:()=>this.controller.dispatch({type:"re-randomize"}),children:l("i",{class:ti.const("dcg-icon-randomize"),"aria-hidden":ti.const("true")})})})}),l(iu,{predicate:()=>this.controller.isInEditListMode()&&!this.controller.hasDefaultState(),children:()=>l("button",{class:ti.const("dcg-btn-red dcg-action-clearall"),onTap:()=>this.controller.dispatch({type:"clear-graph"}),children:()=>this.controller.s("graphing-calculator-button-clear-graph")})}),l(iu,{predicate:()=>this.controller.isInEditListMode()&&this.controller.hasDefaultState(),children:()=>l("button",{class:ti.const("dcg-btn-red dcg-action-reset"),onTap:()=>this.controller.dispatch({type:"reset-graph"}),children:()=>this.controller.s("graphing-calculator-button-reset-graph")})}),l("div",{class:ti.const("dcg-center-buttons"),children:l(Uw,{...this.props,isPillbox:this.const(!1)})}),l(iu,{predicate:()=>!this.controller.isInEditListMode(),children:()=>l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-edit-list-tooltip"),gravity:this.const("s"),children:l("button",{class:ti.const("dcg-unstyled-button dcg-icon-btn dcg-action-toggle-edit"),handleEvent:ti.const("true"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-expression-list"),onTap:this.bindFn(this.toggleEditListMode),manageFocus:this.const(ze({controller:this.controller,location:{type:"edit-list-toggle"}})),children:l("i",{class:ti.const("dcg-icon-settings"),"aria-hidden":ti.const("true")})})})}),l(iu,{predicate:()=>this.controller.isInEditListMode(),children:()=>l("button",{class:ti.const("dcg-btn-blue dcg-action-toggle-edit dcg-do-not-blur"),handleEvent:ti.const("true"),onTap:this.bindFn(this.toggleEditListMode),manageFocus:this.const(ze({controller:this.controller,location:{type:"edit-list-toggle"}})),children:()=>this.controller.s("graphing-calculator-button-done")})}),l(iu,{predicate:()=>!this.controller.isInEditListMode()&&this.controller.getGraphSettings().config.graphpaper,children:()=>x(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-hide-expression-list-tooltip"),gravity:this.const("s"),children:[" ",l("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-resize-list-btn":!0,"dcg-action-hideexpressions":!0,"dcg-icon-btn":!0,"dcg-rotated":this.controller.isNarrow()}),"aria-label":()=>this.controller.s("graphing-calculator-label-hide-expression-list-tooltip"),onTap:e=>{this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:e.device==="keyboard"})},manageFocus:this.const(ze({controller:this.controller,location:{type:"hide-expression-list-btn"}})),children:l("i",{class:ti.const("dcg-icon-hide"),"aria-hidden":ti.const("true")})})]})})]})}showShadow(){return this.controller.getTickerOpen()||this.controller.getExpressionSearchOpen()?!1:this.props.expsScrolled()}showRerandomize(){return this.controller.isInEditListMode()?!1:this.controller.anyItemDependsOnRandomSeed()}showHamburger(){return!this.controller.getGraphSettings().config.showHamburger||this.controller.isInEditListMode()?!1:!this.controller.isNarrow()}getHamburgerLabel(){return this.controller.getshowKeyboardShortcutsInTooltips()?this.controller.s("graphing-calculator-label-open-graph-with-shortcut-tooltip"):this.controller.s("graphing-calculator-label-open-graph-tooltip")}clearSelectionOnMobile(e){jr(e)||this.controller.dispatch({type:"set-none-selected"})}toggleEditListMode(e){this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!this.controller.isInEditListMode(),focusExpressionList:!1}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"edit-list-toggle"}})}showMuteButton(){return this.controller.isInEditListMode()?!1:this.controller.toneItemsExist()}};var bn=__dcg_shared_module_exports__['e'](j());var Iy=__dcg_shared_module_exports__['e'](j());Ut();var{Textarea:ESe}=Iy.Components,Uh=class extends Iy.View{template(){return x("div",{class:Iy.const("dcg-smart-textarea-container dcg-text-selectable"),children:[l("div",{class:Iy.const("dcg-displayTextarea dcg-fixed-width-element"),didMount:this.bindFn(this.didMountDisplay)}),l(ESe,{class:()=>({"dcg-fixed-width-element":!0,"dcg-smart-textarea":!0,"dcg-empty":!this.props.text()}),"aria-label":()=>{var e,t;return(t=(e=this.props).ariaLabel)==null?void 0:t.call(e)},placeholder:this.bindFn(this.getPlaceholder),readOnly:()=>this.props.readonly()?!0:void 0,value:this.props.text,onInput:this.props.onInput,didMount:this.bindFn(this.didMountTextarea),onKeyDown:this.bindFn(this.onKeydownEvent)})]})}getDisplayTextHTML(){let e=this.props.text()||"",t=(n,a)=>e.slice(n,a).replace(/</g,"&lt;").replace(/>/g,"&gt;"),o=0,i="";if(this.props.showLinks()){let n=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,a=null;for(;(a=n.exec(e))!==null;){let[s]=a;i+=t(o,a.index),i+=`<a rel='nofollow ugc' href='${s}' target ='_blank'>${s}</a>`,o=n.lastIndex}}return i+=t(o),i}willUnmount(){this.textareaNode=void 0}didMountDisplay(e){this.displayNode=e,re(e).on("touchend",t=>{t.preventDefault()}),re(e).on("dcg-tap dcg-tapstart",t=>{t.target.closest("a")&&Xt(t)}),this.renderDisplayText()}didMountTextarea(e){this.textareaNode=e,re(e).on("dcg-tapstart",t=>{Xt(t)}),re(e).on("focusin focusout",()=>this.onFocusEvent()),this.updateFocused()}didUpdate(){this.updateFocused(),this.renderDisplayText()}onFocusEvent(){if(!this.textareaNode)return;let e=document.activeElement===this.textareaNode;this.props.isFocused()!==e&&this.props.onFocusChange(e)}renderDisplayText(){if(!this.displayNode)return;let e=this.getDisplayTextHTML();this.lastDisplayTextHTML!==e&&(this.lastDisplayTextHTML=e,this.displayNode.innerHTML=e)}isFocused(){return document.activeElement===this.textareaNode}updateFocused(){if(!this.textareaNode)return;let e=this.isFocused(),t=this.props.isFocused();if(e!==t)if(!t)this.textareaNode.blur();else{if(ha&&Uu)return;this.textareaNode.focus(),this.textareaNode.selectionStart=this.textareaNode.selectionEnd=this.textareaNode.value.length}}onKeydownEvent(e){let t=this.textareaNode;if(!t)return;let o=Pe(e),i=this.props.readonly(),n=this.props.readonlyAction&&this.props.readonlyAction();if(i&&n!==void 0&&n.predicate()){!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(o==="Enter"||o==="Space")&&(e.preventDefault(),n.action());return}o==="Enter"&&!e.shiftKey?(e.preventDefault(),this.props.onSpecialKey("Enter")):o==="Esc"?Dr():o==="Up"?(i||t.selectionStart===0&&t.selectionEnd===0)&&!(e.altKey||e.metaKey)&&(e.preventDefault(),this.props.onSpecialKey("Up")):o==="Down"?(i||t.selectionStart===t.value.length&&t.selectionEnd===t.value.length)&&!(e.altKey||e.metaKey)&&(e.preventDefault(),this.props.onSpecialKey("Down")):o==="Backspace"&&!(i&&n!==void 0&&n.predicate())?t.value.length===0&&(e.preventDefault(),this.props.onSpecialKey("Backspace")):o==="Del"&&!(i&&n!==void 0&&n.predicate())&&t.value.length===0&&(e.preventDefault(),this.props.onSpecialKey("Delete")),this.props.onKeydown&&this.props.onKeydown(e)}getPlaceholder(){var e,t;if(!this.props.text())return(t=(e=this.props).placeholder)==null?void 0:t.call(e)}};var{If:ISe}=bn.Components,tC=class extends Es{didMountRoot(e){this.onItemViewMounted(e)}willUnmount(){this.onItemViewUnmounted()}template(){return x("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-highlighted-expressionitem":this.controller.isExpressionHighlighted(this.id),"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressionfolder":!0,"dcg-inFolder":!1,"dcg-selected":this.renderAsSelected(),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-collapsed":!!this.model.collapsed,"dcg-hidden":!!this.model.hidden,"dcg-has-items":this.controller.getNumberOfItemsInFolder(this.id)>0,"dcg-secretFolder":this.model.secret&&!this.controller.shouldShowAuthorFeatures()}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect),didMount:this.bindFn(this.didMountRoot),children:[x("div",{class:bn.const("dcg-fade-container"),children:[x("div",{class:bn.const("dcg-main"),children:[l("button",{"aria-label":()=>this.model.collapsed?Wr(this.model,"expand"):Wr(this.model,"collapse"),class:bn.const("dcg-unstyled-button dcg-caret-container dcg-action-toggle-folder-collapsed dcg-do-not-blur"),handleEvent:bn.const("true"),onTap:this.bindFn(this.toggleCollapsed),children:l("i",{class:bn.const("dcg-icon-caret-down"),"aria-hidden":bn.const("true")})}),l(Uh,{isFocused:this.bindFn(this.isFocused),text:()=>this.model.title,showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey),ariaLabel:this.bindFn(this.getAriaLabel),readonly:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.id),readonlyAction:this.const({predicate:()=>this.controller.isInEditListMode(),action:()=>this.exitEditListMode()}),placeholder:()=>this.controller.s("graphing-calculator-text-folder-placeholder")}),l(ft,{checked:()=>this.model.secret,class:()=>{let e="dcg-action-toggle-secret-folder dcg-do-not-blur";return this.controller.canUseAdvancedStyling()?e:e+" dcg-last-folder-checkbox"},style:()=>({display:this.controller.shouldShowAuthorFeatures()?void 0:"none"}),onChange:this.bindFn(this.toggleSecret),children:l("span",{class:bn.const("dcg-checkbox-label"),children:()=>this.controller.s("graphing-calculator-button-hide-folder-from-students-2")})}),l(ISe,{predicate:()=>this.controller.canUseAdvancedStyling(),children:()=>l(ft,{checked:()=>this.model.inFrontOfEverything,class:this.const("dcg-action-toggle-in-front-of-everything dcg-do-not-blur dcg-last-folder-checkbox"),onChange:this.bindFn(this.toggleinFrontOfEverything),children:l("span",{class:bn.const("dcg-checkbox-label"),children:()=>this.controller.s("graphing-calculator-button-in-front-of-everything")})})})]}),l(Ic,{controller:this.props.controller,model:this.props.model})]}),x("span",{class:bn.const("dcg-tab dcg-action-drag"),handleEvent:bn.const("true"),tapboundary:bn.const("true"),disablescroll:bn.const("true"),onTapStart:this.bindFn(this.onDragPending),children:[l("span",{class:bn.const("dcg-num"),children:()=>this.model.displayIndex}),l("div",{class:bn.const("dcg-tab-interior"),children:l("span",{role:bn.const("button"),tabIndex:bn.const("0"),"aria-pressed":()=>!!this.model.hidden,"aria-label":()=>this.model.hidden?Wr(this.model,"show"):Wr(this.model,"hide"),class:bn.const("dcg-circular-icon-container dcg-expression-icon-container"),onTap:this.bindFn(this.toggleHidden),children:l(qo,{iconType:()=>this.model.hidden?"hidden":"folder",whiteIcon:()=>this.renderAsSelected()||this.controller.isItemBeingDragged(this.model.id)})})})]}),l(Cc,{controller:this.props.controller,id:()=>this.model.id})]})}renderAsSelected(){return this.controller.isItemSelected(this.model.id)||this.model.collapsedChildIsSelected}toggleHidden(){this.controller.dispatch({type:"toggle-item-hidden",id:this.id})}toggleSecret(){this.controller.dispatch({type:"set-item-secret",id:this.id,isSecret:!this.model.secret})}toggleinFrontOfEverything(){this.controller.dispatch({type:"set-item-in-front-of-everything",id:this.id,inFrontOfEverything:!this.model.inFrontOfEverything})}toggleCollapsed(){this.controller.dispatch({type:"set-folder-collapsed",id:this.id,isCollapsed:!this.model.collapsed})}onInput(e){this.controller.dispatch({type:"set-folder-title",id:this.id,title:e})}onFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"folder",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"folder",id:this.id}})}onSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}isFocused(){let e=this.controller.getFocusLocation();return!(!e||e.type!=="folder"||e.id!==this.id)}getAriaLabel(){let e="",t="";switch((this.model.hidden?1:0)+(this.model.collapsed?16:0)+(this.model.secret?256:0)+(this.model.readonly?4096:0)){case 0:t=this.controller.s("graphing-calculator-narration-description-folder");break;case 1:t=this.controller.s("graphing-calculator-narration-description-hidden-folder");break;case 16:t=this.controller.s("graphing-calculator-narration-description-collapsed-folder");break;case 256:t=this.controller.s("graphing-calculator-narration-description-secret-folder");break;case 4096:t=this.controller.s("graphing-calculator-narration-description-readonly-folder");break;case 17:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-folder");break;case 257:t=this.controller.s("graphing-calculator-narration-description-hidden-secret-folder");break;case 4097:t=this.controller.s("graphing-calculator-narration-description-hidden-readonly-folder");break;case 272:t=this.controller.s("graphing-calculator-narration-description-collapsed-secret-folder");break;case 4352:t=this.controller.s("graphing-calculator-narration-description-secret-readonly-folder");break;case 4112:t=this.controller.s("graphing-calculator-narration-description-collapsed-readonly-folder");break;case 273:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-secret-folder");break;case 4113:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-readonly-folder");break;case 4353:t=this.controller.s("graphing-calculator-narration-description-hidden-secret-readonly-folder");break;case 4368:t=this.controller.s("graphing-calculator-narration-description-collapsed-secret-readonly-folder");break;case 4369:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-secret-readonly-folder");break}let d=this.controller.getNumberOfItemsInFolder(this.id);return d>0?e=this.controller.s("graphing-calculator-narration-folder-has-items",{folder:t,count:d}):e=t,e}};var Yh=__dcg_shared_module_exports__['e'](j());var{For:$re,If:MSe}=Yh.Components,$G=class extends Yh.View{init(){this.controller=this.props.controller(),this.currentlyInspectedDepth=1/0,this.cachedTokenDepths={depths:{},isInvalid:!1},this.updateCachedTokenDepthInfo()}willUpdate(){this.updateCachedTokenDepthInfo()}updateCachedTokenDepthInfo(){let e="",t=!1,o=this.controller.getFocusLocation();if(o&&o.type==="expression"){let n=this.controller.getFocusedItem();(n==null?void 0:n.type)==="expression"&&(e=n.id,t=!!n.error&&n.latex!==""||!!n.formula.variables.length)}if(this.cachedTokenDepths.focusedExpressionBeforeError==e&&t){this.cachedTokenDepths.isInvalid=!0;return}this.cachedTokenDepths={depths:this.controller.cachedGeoTokenDepths,isInvalid:!1,focusedExpressionBeforeError:t?void 0:e}}template(){return x("div",{class:()=>({"dcg-geo-show-constructions-pane":!0,"dcg-transient-error":this.cachedTokenDepths.isInvalid,"dcg-cant-drag-item":!!this.controller.getDraggedItemId()&&!this.controller.canDraggedItemBeMovedIntoTokenPane()}),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-token-navigator-label"),role:Yh.const("region"),didUnmount:()=>this.lastFocusedIdentifier=void 0,onKeyDown:this.bindFn(this.handleKeydown),children:[l(MSe,{predicate:()=>this.controller.getGeometryTokenCount()===0,children:()=>l("div",{class:Yh.const("dcg-empty-constructions"),children:()=>this.controller.s("graphing-calculator-text-geometry-no-constructed-objects")})}),l("div",{class:Yh.const("dcg-displayed-sections-container"),children:l($re,{each:this.bindFn(this.getObjectDepths),children:e=>l("div",{class:()=>({"dcg-displayed-section-level":!0,"dcg-selected-level":parseInt(e)===this.getCurrentlyInspectedDepth(),"dcg-below-the-line":parseInt(e)>this.getCurrentlyInspectedDepth()}),children:l("span",{role:Yh.const("listbox"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-token-navigator-depth",{depth:e}),children:l($re,{each:()=>this.getTokensForDepth(e),children:(t,o)=>l("span",{class:()=>({"dcg-token-being-dragged-container":this.isTokenBeingDragged(e,o)}),onTapStart:i=>{let n=this.getCalcIdForDepth(e,o),a=this.controller.getItemModel(n);!a||a.type!=="expression"||this.controller.isItemInGeoFolder(a.id)&&this.props.onDragPending(i,{type:"token",calcId:n,originalIndex:a.index})},children:l(Gp,{showParentChildrenHover:this.const(!0),controller:this.props.controller,identifier:()=>this.getIdentifierForDepth(e,o),insideMQ:this.const(!1),insideGroup:this.const(!0),focusLocation:()=>({type:"geo-token",identifier:this.getIdentifierForDepth(e,o)}),putInTabOrder:()=>{if(this.lastFocusedIdentifier===void 0){let i=this.getObjectDepths();this.lastFocusedIdentifier=this.getIdentifierForDepth(i[0],0)}return this.lastFocusedIdentifier===this.getIdentifierForDepth(e,o)}})})},(t,o)=>o)})})})})]})}isTokenBeingDragged(e,t){let o=this.controller.getDraggedItemId();if(!o)return!1;if(this.controller.isItemInGeoFolder(o))return o==this.getCalcIdForDepth(e,t)}getCurrentlyInspectedDepth(){return Math.min(this.currentlyInspectedDepth,this.getObjectDepths().length-1)}getIdentifierForDepth(e,t){let o=this.getTokensForDepth(e)[t];return o?o.identifier:""}getCalcIdForDepth(e,t){let o=this.getTokensForDepth(e)[t];return o?o.calcId:""}getTokensForDepth(e){let{depths:t}=this.cachedTokenDepths,o=t[e];return o||[]}getObjectDepths(){let e=Object.keys(this.cachedTokenDepths.depths);return e.sort((t,o)=>{let i=parseInt(t),n=parseInt(o);return isFinite(i)?isFinite(n)?i-n:1:-1}),e}selectItemIfNecessary(){if(this.controller.hasAnyItemsSelected())return;let e=this.controller.getFocusLocation();if((e==null?void 0:e.type)!=="geo-token")return;let{calcId:t}=this.controller.cachedGeoTokenInfo[e.identifier];!t||!this.controller.getItemModel(t)||this.controller.dispatch({type:"set-selected-id",id:t,state:"selected"})}handleKeydown(e){let t=this.controller.getFocusLocation(),o=Pe(e),i=Jr(e);if(e.ctrlKey&&e.shiftKey&&!e.altKey&&!e.metaKey&&i==="O"){e.preventDefault(),e.stopPropagation(),this.selectItemIfNecessary(),this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-more",guid:ey(),focusFirstOption:!0,previousFocusLocation:t}});return}if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&i==="T"){if(e.preventDefault(),e.stopPropagation(),(t==null?void 0:t.type)!=="geo-token")return;let{calcId:g}=this.controller.cachedGeoTokenInfo[t.identifier];if(!g)return;let h=this.controller.getItemModel(g);if(!xs(h))return;this.controller.convertToNamedAssignment(h),In(h,""),this.controller.dispatch({type:"set-none-selected"}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:h.id}});return}if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;if(o==="Esc"){e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-show-constructions-open",open:!1,setFocus:!0});return}if(o!=="Up"&&o!=="Down"&&o!=="Left"&&o!=="Right")return;e.preventDefault(),e.stopPropagation();let n=this.getObjectDepths();if(n.length===0)return;let a="";if(t&&t.type==="geo-token")a=t.identifier;else{let g=this.getTokensForDepth(n[0])[0];if(!g)return;a=g.identifier}if(a==="")return;let s,c=-1,d=[];for(s=0;s<n.length;s++){let g=n[s];if(d=this.getTokensForDepth(g),!!d&&(c=__dcg_shared_module_exports__['Wa'](d,{identifier:a}),c!==-1))break}if(s===-1||c===-1)return;o==="Up"?s=Math.max(s-1,0):o==="Down"?s=Math.min(s+1,n.length-1):o==="Left"?c=Math.max(c-1,0):o==="Right"&&(c=Math.min(c+1,d.length-1));let p=this.getTokensForDepth(n[s]);if(!p)return;c=Math.min(c,p.length-1);let u=p[c].identifier;this.controller.dispatch({type:"set-focus-location",location:{type:"geo-token",identifier:u}}),this.lastFocusedIdentifier=u}};var tn=__dcg_shared_module_exports__['e'](j());var{For:DSe,If:JG}=tn.Components,ZG=class extends tn.View{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMountArrow(e){this.arrowElt=e,dl(this.arrowElt,this.controller)}didMount(){Sh(this.guid,this.controller)}willUnmount(){kh(this.guid,this.controller)}didUpdate(){dl(this.arrowElt,this.controller)}template(){let e=this.model;return x("div",{class:tn.const("dcg-image-options-menu dcg-options-menu"),children:[x("div",{class:tn.const("dcg-opacities-menu dcg-options-menu-section"),children:[l("div",{role:tn.const("heading"),"aria-level":tn.const("2"),class:tn.const("dcg-options-menu-section-title"),children:()=>this.controller.s("graphing-calculator-heading-image-opacity")}),l("div",{class:tn.const("dcg-opacities-menu-flex"),role:tn.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-image-opacity"),children:l(DSe,{each:()=>this.controller.getImageOpacities(),children:t=>l("span",{class:tn.const("dcg-opacity-option"),role:tn.const("button"),tabIndex:tn.const(0),"aria-label":()=>`opacity: ${t}`,"aria-pressed":()=>this.isOpacitySelected(t),handleEvent:tn.const("true"),onTap:()=>this.onSelectOpacity(t),children:l(qo,{backgroundImage:this.bindFn(this.getBackgroundImage),iconType:()=>this.isOpacitySelected(t)?"check":"none",backgroundOpacity:()=>parseFloat(t)})})})})]}),x("div",{class:tn.const("dcg-styles-div dcg-options-menu-section dcg-section-without-title"),children:[l(JG,{predicate:()=>this.shouldShowBackgroundCheckbox(),children:()=>l("div",{class:tn.const("dcg-styles-menu"),role:tn.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-image-styles"),children:l(ft,{checked:()=>!e.foreground,onChange:this.bindFn(this.onToggleForeground),children:()=>this.controller.s("graphing-calculator-button-place-image-behind-graphs")})})}),l(JG,{predicate:()=>this.shouldShowDraggableCheckbox(),children:()=>l("div",{class:tn.const("dcg-draggable-checkbox-container"),children:l(ft,{checked:()=>td(e),onChange:this.bindFn(this.onToggleDraggable),children:()=>this.controller.s("graphing-calculator-button-draggable")})})})]}),l(JG,{predicate:this.bindFn(this.shouldShowClickable),children:()=>l(j1,{controller:this.props.controller,model:()=>e,isOpen:()=>!!e.clickableInfo.enabled})}),l(JG,{predicate:()=>cM(this.props.model()),children:()=>l(pm,{class:this.const("dcg-options-menu-section"),controller:this.props.controller,model:this.props.model})}),l(dm,{model:()=>e,controller:()=>this.props.controller()}),l("div",{class:tn.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0})]})}onToggleDraggable(){mv(this.model)?this.controller.dispatch({type:"set-image-draggable",id:this.model.id,draggable:!this.model.draggable}):this.makeDraggable()}onToggleForeground(e){this.controller.dispatch({type:"set-image-in-foreground",id:this.model.id,foreground:!e})}onSelectOpacity(e){this.controller.dispatch({type:"set-image-opacity",id:this.model.id,opacity:e})}isOpacitySelected(e){return this.model.opacity===e}getBackgroundImage(){return this.model.image_url===this.lastURL?this.lastEncodedURL:(this.lastURL=this.model.image_url,this.lastEncodedURL='url("'+IA(this.model.image_url)+'")',this.lastEncodedURL)}shouldShowClickable(){return this.controller.shouldIgnoreGraphInteractions(this.model)?!1:this.controller.areActionsEnabled()}makeDraggable(){this.controller.dispatch({type:"convert-image-to-draggable",id:this.model.id})}shouldShowDraggableCheckbox(){if(this.controller.isThreeDMode()||this.controller.shouldIgnoreGraphInteractions(this.model))return!1;let e=mv(this.model);return e?FM(e):lW(this.model)}shouldShowBackgroundCheckbox(){let e=this.controller.getItemModel(this.model.folderId);return!(e&&e.type==="folder"&&e.inFrontOfEverything)}};var Fr=__dcg_shared_module_exports__['e'](j());var{If:FY,SwitchUnion:Jre,For:ASe}=Fr.Components,LSe=["action-info","slider-prompt","braille-error","alt-text"],My=class extends Fr.View{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return l(or,{containerClass:()=>({"dcg-image-input-mathquill":!0,"dcg-suffix-degree":this.props.name()==="angle"&&this.props.controller().getGraphSettings().degreeMode,"dcg-suffix-radian":this.props.name()==="angle"&&!this.props.controller().getGraphSettings().degreeMode}),fontSize:this.const("large"),fullWidth:this.const(!0),readonly:this.props.readonly,latex:()=>this.model[this.props.name()],isFocused:()=>this.props.focusedInput()===this.props.name(),ariaLabel:()=>this.controller.raw(this.props.name()),handleFocusChanged:this.bindFn(this.handleMQFocusedChanged),hasError:()=>hW(this.model,this.props.name()),controller:this.props.controller,handlePressedKey:this.bindFn(this.handlePressedKey),handleLatexChanged:this.bindFn(this.handleLatexChanged),noBorder:()=>!this.props.focusedInput()})}getInputs(){return["center","width","angle","height","opacity"]}handlePressedKey(e,t){let o=this.props.name(),i=Qe.getFocusedMathquill(),n=this.getInputs(),a=n.indexOf(o);if(!this.controller.isInEditListMode()){if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});if(e==="Esc"){Dr();return}}let s=-1;e==="Up"&&(s=a===1?4:a-2),e==="Down"&&(s=a===4?1:a+2),e==="Left"&&(s=a-1),e==="Right"&&(s=a+1);let c=e;if(s>=0&&s<n.length){let d=!1;if(i)d=Qe.applyArrowKeyAndReturnIfWasAtBounds(i,c,t);else if(e==="Up"||e==="Down")d=!0;else{let p=_c();d=p&&(e==="Left"&&p.selectionStart===0||e==="Right"&&p.selectionStart===p.value.length)}d&&(this.focusInput(n[s]),t&&t.preventDefault());return}i&&(i.keystroke(e,t),this.handleLatexChanged(i.latex()))}focusInput(e){this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.model.id,location:e}})}handleLatexChanged(e){let t=this.props.name();this.model.draggingOnGraphpaper||P0(this.model,t)!==e&&this.controller.dispatch({type:"set-image-mq-attribute",id:this.model.id,attribute:t,latex:e})}handleMQFocusedChanged(e){let t=this.props.name();e?this.props.focusedInput()!==t&&this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.model.id,location:t}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"image",id:this.model.id,location:t}})}},rC=class extends Es{didMountRoot(e){this.onItemViewMounted(e)}willUnmount(){this.onItemViewUnmounted()}template(){return x("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-highlighted-expressionitem":this.controller.isExpressionHighlighted(this.id),"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressionimage":!0,"dcg-inFolder":!!this.model.folderId,"dcg-selected":this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-input-focused":this.getFocusedInput()&&this.getFocusedInput()!=="name"}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect),didMount:this.bindFn(this.didMountRoot),children:[x("div",{class:Fr.const("dcg-fade-container"),children:[l("div",{class:Fr.const("dcg-main"),children:Jre(()=>this.model.loadStatus,{failed:()=>x("div",{children:[l("div",{class:Fr.const("dcg-image-failed"),children:()=>this.controller.s("graphing-calculator-error-failed-to-load-image")}),l("div",{role:Fr.const("button"),tabIndex:Fr.const(0),class:Fr.const("dcg-retry-loading-image"),onTap:this.bindFn(this.onRetryLoad),children:()=>this.controller.s("graphing-calculator-button-load-image-retry")})]}),loading:()=>x("div",{children:[l("div",{class:Fr.const("dcg-image-loading"),children:()=>this.controller.s("graphing-calculator-text-loading-image")}),l("div",{role:Fr.const("button"),tabIndex:Fr.const(0),class:Fr.const("dcg-retry-loading-image"),onTap:this.bindFn(this.onRetryLoad),children:()=>this.controller.s("graphing-calculator-button-load-image-retry")})]}),loaded:()=>x("div",{class:Fr.const("dcg-image-loaded"),children:[x("div",{class:Fr.const("dcg-image-title-row"),children:[l(Uh,{isFocused:()=>this.getFocusedInput()==="name",text:()=>this.model.name,ariaLabel:()=>Wr(this.model,"edit_title"),placeholder:()=>this.controller.s("graphing-calculator-text-image-placeholder"),showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onNameInput),onFocusChange:this.bindFn(this.onNameFocusChange),onSpecialKey:this.bindFn(this.onNameSpecialKey),readonly:()=>this.controller.isInEditListMode()||this.isReadonly()}),l(FY,{predicate:()=>this.controller.areImagesEnabled(),children:()=>l(wh,{controller:()=>this.controller,ariaLabel:()=>this.controller.s("graphing-calculator-button-change-image"),onFileChange:e=>this.insertFiles(e),location:this.const({type:"change-image-btn",id:this.id}),readonly:this.bindFn(this.isReadonly),children:l(FY,{predicate:()=>!this.isReadonly(),children:()=>l("div",{class:Fr.const("dcg-action-changeimage"),children:()=>this.controller.s("graphing-calculator-button-change-image")})})})})]}),x("div",{class:()=>({"dcg-do-blur":!0,"dcg-image-input-grid":!0}),handleEvent:Fr.const("true"),children:[l("div",{class:Fr.const("dcg-image-input-name"),children:()=>this.controller.s("graphing-calculator-label-image-center")}),l(My,{name:this.const("center"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),l("div",{class:Fr.const("dcg-image-input-name"),children:()=>this.controller.s("graphing-calculator-label-image-width")}),l(My,{name:this.const("width"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),l("div",{class:Fr.const("dcg-image-input-name"),children:()=>this.controller.s("graphing-calculator-label-image-angle")}),l(My,{name:this.const("angle"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),l("div",{class:Fr.const("dcg-image-input-name"),children:()=>this.controller.s("graphing-calculator-label-image-height")}),l(My,{name:this.const("height"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),l("div",{class:Fr.const("dcg-image-input-name"),children:()=>this.controller.s("graphing-calculator-label-image-opacity")}),l(My,{name:this.const("opacity"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)})]})]})})}),l("span",{class:Fr.const("dcg-fadeout")}),l(Ic,{controller:this.props.controller,model:this.props.model}),l(FY,{predicate:()=>this.getFooterComponents().length>0,children:()=>l("div",{class:this.getFooterClass(),children:l(ASe,{each:()=>this.getFooterComponents(),children:e=>Jre(()=>e,{"action-info":()=>l(Rb,{model:this.props.model,controller:this.props.controller}),"alt-text":()=>l(P1,{model:this.props.model,controller:this.props.controller}),"braille-error":()=>x("div",{tabIndex:Fr.const(0),class:Fr.const("dcg-expression-braille-error"),"aria-roledescription":Fr.const("error"),"aria-label":()=>this.controller.unpack(this.model.error),children:[l("i",{class:Fr.const("dcg-icon-error"),"aria-hidden":Fr.const("true")}),()=>this.controller.unpack(this.model.error)]}),"slider-prompt":()=>l(Is,{model:this.props.model,controller:this.props.controller})})})})})]}),x("span",{class:Fr.const("dcg-tab dcg-action-drag dcg-action-icon-touch"),handleEvent:Fr.const("true"),tapboundary:Fr.const("true"),disablescroll:Fr.const("true"),onTapStart:this.bindFn(this.onDragPending),children:[l("span",{class:Fr.const("dcg-num"),children:()=>this.model.displayIndex}),l("div",{class:Fr.const("dcg-tab-interior dcg-action-icon-mouse"),children:l(qb,{model:this.props.model,controller:this.props.controller})})]}),l(Cc,{controller:this.props.controller,id:()=>this.model.id})]})}getFooterComponents(){return LSe.filter(e=>this.hasFooterComponent(e))}hasFooterComponent(e){switch(e){case"action-info":return this.controller.shouldShowActionInfo(this.model.id);case"alt-text":return this.controller.shouldShowAltTextInFooter(this.model);case"braille-error":return this.shouldShowBrailleError();case"slider-prompt":return UI(this.model).length>0&&this.controller.areSlidersEnabled();default:let t=e;throw new Error(`Unexpected footer type ${t}`)}}isReadonly(){return this.controller.isItemReadonly(this.id)}getFooterClass(){return this.isFirstRender()?this.const("dcg-expression-bottom dcg-indent-in-folder"):this.const("dcg-expression-bottom dcg-fadein-bottom dcg-indent-in-folder")}onNameInput(e){this.controller.dispatch({type:"set-image-name",id:this.id,name:e})}onNameFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.id,location:"name"}}):this.getFocusedInput()==="name"&&this.controller.dispatch({type:"blur-focus-location",location:{type:"image",id:this.id,location:"name"}})}onNameSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}getFocusedInput(){let e=this.controller.getFocusLocation();if(e&&e.type==="image"&&e.id===this.model.id)return e.location}onRetryLoad(){this.controller.dispatch({type:"image-retry-loading",id:this.id})}shouldShowBrailleError(){return this.controller.getBrailleMode()!=="none"&&!!this.model.error}insertFiles(e){this.controller.dispatch({type:"change-image",files:e,id:this.id})}onMouseSelect(e){e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||jr(e)||(Xt(e),this.controller.dispatch({type:"set-selected-id",id:this.id,state:"selected"}))}};var Bh=__dcg_shared_module_exports__['e'](j()),oC=class extends Bh.View{template(){return this.controller=this.props.controller(),x("div",{class:Bh.const("dcg-expressionitem dcg-new-expression dcg-opened"),children:[l("div",{class:Bh.const("dcg-new-math-div dcg-do-not-blur dcg-action-newmath"),onTap:this.bindFn(this.newMath)}),x("span",{class:Bh.const("dcg-tab"),children:[l("span",{class:Bh.const("dcg-num dcg-variable-index"),children:this.bindFn(this.getIndex)}),l("div",{class:Bh.const("dcg-tab-interior")})]}),l("div",{class:Bh.const("dcg-new-expression-fade")})]})}getIndex(){return this.controller.getNextDisplayIndex()}newMath(){this.controller.dispatch({type:"new-expression-at-end"})}};var Nn=__dcg_shared_module_exports__['e'](j()),iC=class extends Nn.View{init(){this.controller=this.props.controller()}template(){return x("section",{class:Nn.const("dcg-progress-update-legend"),children:[l("h2",{class:Nn.const("dcg-sr-only"),children:"Progress Update Legend"}),l("button",{onTap:()=>this.hideLegend(),class:Nn.const("dcg-hide-progress"),children:"Hide Legend"}),x("ul",{class:Nn.const("dcg-unstyled-list"),children:[x("li",{class:Nn.const("dcg-legend-section"),children:[l("span",{class:Nn.const("dcg-progress-unpublished dcg-progress-swatch"),"aria-label":Nn.const("light yellow swatch"),role:Nn.const("img")}),l("span",{children:"unpublished"})]}),x("li",{class:Nn.const("dcg-legend-section"),children:[l("span",{class:Nn.const("dcg-progress-analyzing dcg-progress-swatch"),"aria-label":Nn.const("light blue swatch"),role:Nn.const("img")}),l("span",{children:"analyzing"})]}),x("li",{class:Nn.const("dcg-legend-section"),children:[l("span",{class:Nn.const("dcg-progress-graphing dcg-progress-swatch"),"aria-label":Nn.const("light red swatch"),role:Nn.const("img")}),l("span",{children:"computing plot"})]})]})]})}hideLegend(){this.controller.dispatch({type:"hide-progress-update-legend"})}};var NY=__dcg_shared_module_exports__['e'](j());var nC=class extends Es{didMountRoot(e){this.onItemViewMounted(e)}willUnmount(){this.onItemViewUnmounted()}template(){let e="";return this.model.cachedRenderHeight&&(e="height:"+this.model.cachedRenderHeight+"px"),l("div",{class:NY.const("dcg-do-not-blur dcg-expressionitem dcg-shell"),"expr-id":this.const(this.model.id),onTap:this.bindFn(this.onMouseSelect),style:NY.const(e),didMount:this.bindFn(this.didMountRoot)})}};var ns=__dcg_shared_module_exports__['e'](j());var Fc=__dcg_shared_module_exports__['e'](j());var QG=[.05,.1,.15,.2,.35,.5,.75,1,1.5,2,3.5,5,7.5,10,15,20],PSe=__dcg_shared_module_exports__['Na'](QG),GSe=__dcg_shared_module_exports__['Ma'](QG),aC=class extends Fc.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return x("div",{class:Fc.const("dcg-slider-speed-container dcg-do-not-blur"),handleEvent:Fc.const("true"),children:[l("span",{class:()=>({"dcg-action-slower":!0,"dcg-disabled":this.isSlowerDisabled()}),onTap:()=>this.animateSlower(),role:Fc.const("button"),"aria-label":()=>this.getSlowerAriaLabel(),tabIndex:()=>this.isSlowerDisabled()?-1:0,"aria-disabled":()=>this.isSlowerDisabled(),children:l("i",{class:Fc.const("dcg-icon-show"),"aria-hidden":Fc.const("true")})}),x("span",{class:Fc.const("dcg-variable-speed"),children:[this.bindFn(this.computeSpeed),"x"]}),l("span",{class:()=>({"dcg-action-faster":!0,"dcg-disabled":this.isFasterDisabled()}),onTap:()=>this.animateFaster(),role:Fc.const("button"),"aria-label":()=>this.getFasterAriaLabel(),tabIndex:()=>this.isFasterDisabled()?-1:0,"aria-disabled":()=>this.isFasterDisabled(),children:l("i",{class:Fc.const("dcg-icon-show"),"aria-hidden":Fc.const("true")})})]})}computeSpeed(){let e=__dcg_shared_module_exports__['ce']/this.model.slider.animationPeriod;return e=Number(e.toFixed(3)),e}isSlowerDisabled(){return PSe>=this.computeSpeed()}isFasterDisabled(){return GSe<=this.computeSpeed()}animateSlower(){let e=this.computeSpeed(),t=__dcg_shared_module_exports__['Ha'](QG,o=>o<e);t.length!==0&&this.setPeriodFromSpeed(__dcg_shared_module_exports__['Ma'](t))}animateFaster(){let e=this.computeSpeed(),t=__dcg_shared_module_exports__['Ha'](QG,o=>o>e);t.length!==0&&this.setPeriodFromSpeed(__dcg_shared_module_exports__['Na'](t))}setPeriodFromSpeed(e){let t=__dcg_shared_module_exports__['ce']/e;this.controller.dispatch({type:"set-slider-animationperiod",id:this.model.id,animationPeriod:t}),_e(this.controller.s("graphing-calculator-narration-slider-animating-at-speed",{speed:e+""}))}getSlowerAriaLabel(){return this.controller.s("graphing-calculator-narration-slider-animate-slower")}getFasterAriaLabel(){return this.controller.s("graphing-calculator-narration-slider-animate-faster")}};var eV=class extends ns.View{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){Sh(this.guid,this.controller)}willUnmount(){kh(this.guid,this.controller)}didMountArrow(e){this.arrowElt=e,dl(this.arrowElt,this.controller)}didUpdate(){dl(this.arrowElt,this.controller)}template(){let e=this.model;return x("div",{class:ns.const("dcg-slider-options-view dcg-options-menu"),children:[l("div",{class:ns.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}),l("div",{class:ns.const("dcg-slider-menu"),children:x("div",{role:ns.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-slider-animation-mode"),children:[l("div",{role:ns.const("heading"),"aria-level":ns.const("2"),class:ns.const("dcg-title"),children:()=>this.controller.s("graphing-calculator-heading-slider-animation-mode")}),l(ar,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-slider-animation-mode"),staticConfig:this.bindFn(this.getAnimationOptions),theme:this.const("mini")})]})}),x("div",{class:ns.const("dcg-slider-menu dcg-slider-speed-menu"),role:ns.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-slider-speed"),children:[l("div",{role:ns.const("heading"),"aria-level":ns.const("2"),class:ns.const("dcg-title"),children:()=>this.controller.s("graphing-calculator-heading-slider-speed")}),l("div",{class:ns.const("dcg-slider-speed-container"),children:l(aC,{model:()=>e,controller:this.props.controller})})]})]})}getAnimationOptions(){let e=this.model;return[__dcg_shared_module_exports__['Pd'].LOOP_FORWARD_REVERSE,__dcg_shared_module_exports__['Pd'].LOOP_FORWARD,__dcg_shared_module_exports__['Pd'].PLAY_ONCE,__dcg_shared_module_exports__['Pd'].PLAY_INDEFINITELY].map(o=>({key:o,icon:()=>__dcg_shared_module_exports__['Qd'](o),tooltip:()=>this.getTooltip(o),tooltipGravity:this.const("s"),selected:()=>this.isSelected(o),onSelect:()=>{this.controller.dispatch({type:"set-slider-loopmode",id:e.id,loopMode:o})}}))}getTooltip(e){let t=this.controller.s;switch(e){case __dcg_shared_module_exports__['Pd'].LOOP_FORWARD_REVERSE:return t("graphing-calculator-narration-slider-loop-forwards-and-backwards");case __dcg_shared_module_exports__['Pd'].LOOP_FORWARD:return t("graphing-calculator-narration-slider-repeat-one-direction");case __dcg_shared_module_exports__['Pd'].PLAY_ONCE:return t("graphing-calculator-narration-slider-play-once");case __dcg_shared_module_exports__['Pd'].PLAY_INDEFINITELY:return t("graphing-calculator-narration-slider-play-indefinitely")}}isSelected(e){return this.model.slider.loopMode===e}};var rn=__dcg_shared_module_exports__['e'](j());function Zre(r){let e=[],t=r.getAllItemModels();for(let o of t){let i=r.getItemRootNodeById(o.id);i&&e.push(i)}return e}function VSe(r){let e=r.getAllItemModels();for(let t=e.length-1;t>=0;t--){let o=e[t];if(o.rootViewNode)return o.id}}function Qre(r,e){let t=Zre(r),o=0,i=t.length-1;for(;o<=i;){let n=o+Math.floor((i-o)/2),a=t[n],s=a.getBoundingClientRect();if(s.top>e)i=n-1;else if(s.bottom<e)o=n+1;else return a}}function OSe(r,e){let t=Zre(r),o=0,i=t.length-1,n;for(;o<=i;){let a=o+Math.floor((i-o)/2),s=t[a];s.getBoundingClientRect().top>e?(i=a-1,n=s):o=a+1}return n}function eoe(r,e){let t=Dy(r);if(!t)return;if(e){let i=r.getItemRootNodeById(e);if(i){let n=i.getBoundingClientRect();if(n.height>0&&n.top<=t.top&&n.bottom>=t.top)return e}}let o=Qre(r,t.top);return o?o.getAttribute("expr-id"):UY(r)}function toe(r,e){let t=Dy(r);if(!t)return;let o=VSe(r);if(!o)return;if(e){let n=r.getItemRootNodeById(e);if(n){let a=n.getBoundingClientRect();if(a.height>0&&a.top<=t.bottom&&a.bottom>=t.bottom||e===o&&a.bottom<=t.bottom)return e}}let i=Qre(r,t.bottom);return i&&i.getAttribute("expr-id")||o}function UY(r){let e=Dy(r);if(!e)return;let t=OSe(r,e.top-2);if(t)return t.getAttribute("expr-id")}function sC(r){return r.findEl(".dcg-exppanel")}function Dy(r){let e=sC(r);if(e)return e.getBoundingClientRect()}function roe(r){let e=r.findEl(".dcg-exppanel-container");if(!e)return;let t=e.getBoundingClientRect(),o=e.scrollTop;return t.top-o}function ooe(r){let e=r.findEl(".dcg-expressionlist");if(!e)return;let t=e.getBoundingClientRect();return{width:t.width,height:t.height}}function ioe(r){let e=sC(r);if(!e)return;let t=e.querySelector(".dcg-drag-container > *");if(!t)return;let o=t.getBoundingClientRect();return{width:o.width,height:o.height}}Ut();var Kh=__dcg_shared_module_exports__['e'](j());var{If:RSe}=Kh.Components,tV=class extends Kh.View{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return l(RSe,{predicate:()=>this.controller.shouldShowRegressionButton(this.model),children:()=>l("div",{class:Kh.const("dcg-add-regression-view dcg-do-not-blur"),onTapStart:e=>Xt(e,"dcg-expression-drag"),children:l(Oe,{tooltip:this.bindFn(this.getTooltipText),gravity:()=>"e",children:l("i",{onTap:()=>{this.controller.dispatch({type:"create-table-regression",tableId:this.model.id,regressionType:"linear"})},role:Kh.const("button"),tabIndex:Kh.const("0"),"aria-label":this.bindFn(this.getTooltipText),class:Kh.const("dcg-icon-points"),manageFocus:this.const(ze({controller:this.controller,location:{type:"add-table-regression-btn",id:this.model.id}}))})})})})}getTooltipText(){return this.controller.s("graphing-calculator-button-add-table-regression")}};var Kr=__dcg_shared_module_exports__['e'](j());En();var FSe={version:xc,randomSeed:"",graph:{viewport:{xmin:-10,ymin:-13.25,xmax:10,ymax:13.25}},expressions:{list:[{id:"1",type:"expression"}]}},lC=FSe;var Joe=__dcg_shared_module_exports__['e'](j());Ut();var cC=class{constructor(e){this.active=!1,this.controller=e;let t=this.controller.getExppanelElt();t&&(this.exppanel=t)}startDragging(e){this.active=!0,this.mousePt=e,this.setupEventListeners()}applyDrag(){var _;let t=this.controller.getListModel().dragState;if(!t)return;this.scheduleUpdateScroll();let o=this.measureDOM(t);if(!o)return;let{floatingPreviewRect:i,dragState:n,visibleRects:a}=o,s=this.controller.getItemModel(n.firstItemId);if(!s)return;let c=s.index,d=a[0];if(d&&d.id!==s.id){let C=this.controller.getItemModel(d.id);C&&C.index>c&&(c=C.index-1)}let{cachedNamedAssignmentLatex:p,cachedTokenAssignmentLatex:u}=n;for(let{id:C,rect:D}of a){if(C===s.id)continue;let P=this.controller.getItemModel(C);if(!P)return;if(P.index<s.index){if(i.top<D.top+D.height/2){c=P.index;break}}else i.bottom>D.top+D.height/2&&(c=P.index,P.type==="folder"&&P.collapsed&&(c+=this.controller.getNumberOfItemsInFolder(P.id)))}let g,h;c>s.index?(g=c,h=c+1):c<s.index?(g=c-1,h=c):(g=c-1,h=c+1);let b=this.controller.getItemModelByIndex(g),v=this.controller.getItemModelByIndex(h),T="",E="";b&&(b.type==="folder"?T=b.id:T=b.folderId),v&&(v.type==="folder"?E=v.id:E=v.folderId);let I="";if(T&&(E===T?s.type==="folder"?c=s.index:I=T:s.type!=="folder"&&this.isPreviewTopContainedInFolder(o,T)&&(I=T)),s.type==="expression")if(n.renderType==="token"){if(t.renderType==="expression"&&(p=s.latex,this.controller.convertToTokenAssignment(s,u)),n.dragTarget.type==="token")c=n.dragTarget.originalIndex,I=((_=this.controller.getGeometryFolder())==null?void 0:_.id)||"";else if(n.dragTarget.type==="expression"){let C=this.controller.getGeometryFolder();if(C){let D=this.controller.getNumberOfItemsInFolder(C.id);s.type==="expression"&&s.folderId===C.id&&(D-=1),c=C.index+D+1,I=C.id}}}else n.renderType==="expression"&&t.renderType==="token"&&(u=s.latex,this.controller.convertToNamedAssignment(s,p));return{dragState:{...n,cachedNamedAssignmentLatex:p,cachedTokenAssignmentLatex:u},newIndex:c,folderId:I}}measureDOM(e){var F;let t={x:((F=Dy(this.controller))==null?void 0:F.left)||0,y:roe(this.controller)},o=ooe(this.controller),i=ioe(this.controller);if(t.y===void 0||!o||!i)return;let n=o.height,a=i.height,s=!1,c=this.controller.getExppanelElt(),d=c==null?void 0:c.querySelector(".dcg-template-expressioneach"),p=d==null?void 0:d.getBoundingClientRect();p&&p.top<=e.mousePt.y&&(s=!0);let u=!1,g=c==null?void 0:c.querySelector(".dcg-geo-show-constructions-pane"),h=g==null?void 0:g.getBoundingClientRect();h&&h.bottom>e.mousePt.y&&(u=!0);let b=!1;(e.dragTarget.type==="token"&&!s||e.dragTarget.type==="expression"&&u&&!s&&this.controller.canDraggedItemBeMovedIntoTokenPane())&&(b=!0);let v=e.grabOffset;b?v={x:i.width/2+2.5,y:i.height/2}:e.dragTarget.type==="token"&&(v={x:0,y:i.height/2});let T=e.mousePt.y-v.y,E=__dcg_shared_module_exports__['Rb'](T-t.y,-a/2,n-a),I=0;b&&(I=__dcg_shared_module_exports__['Rb'](e.mousePt.x-v.x-t.x,0,o.width-i.width-4),E=Math.max(E,2));let _={left:I,top:T,bottom:T+a,height:a},C=this.controller.findFirstVisibleItem(),D=this.controller.findLastVisibleItem(),P=[];if(C&&D)for(let N=C.index;N<=D.index;N++){let Y=this.controller.getItemModelByIndex(N);if(!Y)continue;let z=this.controller.getItemRootNodeById(Y.id);if(z&&Y.id!==e.firstItemId){let X=z.getBoundingClientRect();P.push({id:Y.id,rect:X})}}return{dragState:{...e,itemTop:E,itemLeft:I,renderType:b?"token":"expression"},floatingPreviewRect:_,visibleRects:P}}isPreviewTopContainedInFolder(e,t){let{visibleRects:o,floatingPreviewRect:i}=e;for(let{id:n,rect:a}of o)if(a.top<=i.top&&a.bottom>=i.top){let s=this.controller.getItemModel(n);if(!s)return!1;if(s.type==="folder"&&s.id===t||s.type!=="folder"&&s.folderId===t)return!0}return!1}scheduleUpdateScroll(){this.updateScrollScheduled||(this.updateScrollScheduled=!0,requestAnimationFrame(()=>{this.updateScroll(),this.updateScrollScheduled=!1}))}stop(){this.active=!1,this.tearDownEventListeners(),this.controller.dispatch({type:"stop-dragdrop"})}setupEventListeners(){re(document).on("dcg-tapmove.dragdrop",e=>{this.mousePt.x=e.changedTouches[0].clientX,this.mousePt.y=e.changedTouches[0].clientY,this.controller.dispatch({type:"update-dragdrop",mousePt:this.mousePt})}),re(document).on("dcg-tapend.dragdrop",e=>{this.stop(),Xt(e,"dragdrop")})}tearDownEventListeners(){re(document).off(".dragdrop")}updateScroll(){if(!this.active)return;let e=this.exppanel.getBoundingClientRect(),t=0;t=Math.min(t,this.mousePt.y-e.top),t=Math.max(t,this.mousePt.y-e.bottom+30),t=t*e.height/900,t&&(this.exppanel.scrollTop=this.exppanel.scrollTop+t)}};function noe(r,e,t){let i=.5/(2*t*e);return no(r-i,r+i)}function dC(r,e,t,o,i=0){let n=__dcg_shared_module_exports__['m'](r.x,r.y,0,t[0],t[1],0,o[0],o[1],0);i&&(n+=i);let s=.5/(__dcg_shared_module_exports__['Vb'](t,o)*e);return no(n-s,n+s)}function Pd(r,e){for(let t of e)t&&(t.min!==void 0&&r<t.min?r=t.min:t.max!==void 0&&r>t.max&&(r=t.max));return r}function rV(r,e,t,o){if(!t)return 0;let i=r.mapx(1)-r.mapx(0);switch(t.valueType){case __dcg_shared_module_exports__['M']:{let a=e.x-t.value[0][0],s=e.y-t.value[0][1],c=Math.atan2(s,a)/(2*Math.PI);c<0&&(c+=1),c=noe(c,i,t.value[1]);let d=Pd(0,[o]),p=Pd(1,[o]);if(c>=d&&c<=p)return c;{let u=__dcg_shared_module_exports__['$b'](t.value,d),g=__dcg_shared_module_exports__['$b'](t.value,p),h=__dcg_shared_module_exports__['Vb'](u,[e.x,e.y]),b=__dcg_shared_module_exports__['Vb'](g,[e.x,e.y]);return h<=b?d:p}}case __dcg_shared_module_exports__['N']:{let a=__dcg_shared_module_exports__['cc'](t.value);if(!a)return 0;if(a.type==="segment"){let s=dC(e,i,a.start,a.end);return Pd(s,[{min:0,max:1},o])}else if(a.type==="rays"){let s=__dcg_shared_module_exports__['Vb'](a.start1,[e.x,e.y]),c=__dcg_shared_module_exports__['Vb'](a.start2,[e.x,e.y]),d=!o||o.min===void 0?-1/0:o.min,p=!o||o.max===void 0?1/0:o.max;return s<c?d>0?p>=1?1:d:Pd(-dC(e,i,a.start1,a.end1),[{min:void 0,max:0},o]):p<1?d<=0?0:p:Pd(dC(e,i,a.start2,a.end2,1),[{min:1,max:void 0},o])}else if(a.type=="arc"){let[s,c]=a.center,{radius:d,startAngle:p}=a,u=__dcg_shared_module_exports__['Xb'](t.value),g=e.x-s,h=e.y-c,b=__dcg_shared_module_exports__['h'](Math.atan2(h,g),p,u);if(b>=0&&b<=1)b=noe(b,i,d);else{let E=VD(e,{x:s+d*Math.cos(p),y:c+d*Math.sin(p)}),I=VD(e,{x:s+d*Math.cos(p+u),y:c+d*Math.sin(p+u)});E<=I?b=0:b=1}let v=Pd(0,[o]),T=Pd(1,[o]);if(b>=v&&b<=T)return b;{let E=__dcg_shared_module_exports__['ac'](t.value,v),I=__dcg_shared_module_exports__['ac'](t.value,T),_=__dcg_shared_module_exports__['Vb'](E,[e.x,e.y]),C=__dcg_shared_module_exports__['Vb'](I,[e.x,e.y]);return _<=C?v:T}}return Pd(0,[o])}case __dcg_shared_module_exports__['Q']:case __dcg_shared_module_exports__['K']:case __dcg_shared_module_exports__['O']:{let a=dC(e,i,t.value[0],t.value[1]);return Pd(a,[{min:t.valueType===__dcg_shared_module_exports__['O']?void 0:0,max:t.valueType!==__dcg_shared_module_exports__['K']?void 0:1},o])}case __dcg_shared_module_exports__['J']:{let a=t.value,s=1/0,c=Pd(0,[o]),d=o&&o.min!==void 0?o.min:-1/0,p=o&&o.max!==void 0?o.max:1/0,u=Math.floor(Math.max(d,0)),g=Math.ceil(Math.min(p,a.length));for(let h=u;h<g;h++){let b=a[h],v=a[(h+1)%a.length],T=Pd(dC(e,i,b,v,h),[{min:h,max:h+1},o]),E=__dcg_shared_module_exports__['bc'](t.value,T),I=__dcg_shared_module_exports__['Vb'](E,[e.x,e.y]);I<s&&(s=I,c=T)}return c}case __dcg_shared_module_exports__['C']:case __dcg_shared_module_exports__['S']:case __dcg_shared_module_exports__['U']:case __dcg_shared_module_exports__['W']:case __dcg_shared_module_exports__['Y']:return 0;default:return t}}function aoe(r,e){switch(r.valueType){case __dcg_shared_module_exports__['M']:return __dcg_shared_module_exports__['$b'](r.value,e);case __dcg_shared_module_exports__['N']:return __dcg_shared_module_exports__['ac'](r.value,e);case __dcg_shared_module_exports__['Q']:return __dcg_shared_module_exports__['_b'](r.value,e);case __dcg_shared_module_exports__['K']:return __dcg_shared_module_exports__['Zb'](r.value,e);case __dcg_shared_module_exports__['O']:return __dcg_shared_module_exports__['Yb'](r.value,e);case __dcg_shared_module_exports__['J']:return __dcg_shared_module_exports__['bc'](r.value,e);case __dcg_shared_module_exports__['C']:case __dcg_shared_module_exports__['S']:case __dcg_shared_module_exports__['U']:case __dcg_shared_module_exports__['W']:case __dcg_shared_module_exports__['Y']:return[NaN,NaN];default:return r}}function NSe(r,e){if(!e)return!1;let{left:t,right:o,top:i,bottom:n}=r.pixelCoordinates,{x:a,y:s}=e.mathPoint;if(e.transform){let c=e.model.getTypedConstantValue();if((c==null?void 0:c.valueType)!==__dcg_shared_module_exports__['C'])throw new Error(`Expected movable point to be a Point but found ${c?__dcg_shared_module_exports__['oa'](c.valueType):void 0} instead`);a=a!=null?a:__dcg_shared_module_exports__['Aa'](c,"x"),s=s!=null?s:__dcg_shared_module_exports__['Aa'](c,"y"),[a,s]=__dcg_shared_module_exports__['pc'](e.transform.forward,[a,s])}if(a!==void 0){let c=r.mathToPixels.mapX(a);if(c<t-.5||c>o+.5)return!1}if(s!==void 0){let c=r.mathToPixels.mapY(s);if(c<i-.5||c>n+.5)return!1}return!0}function soe(r,e){if(e.length===1&&!NSe(r,e[0]))return!1;let t=!1;for(let o of e){o.newPointLatex&&o.model.setLatex(o.newPointLatex).didMovePoint&&(t=!0);for(let i in o.sliderUpdates){let{value:n,model:a}=o.sliderUpdates[i];o.commitSliderSoftLimits&&a.commitSliderSoftLimits(),a.adjustSliderByMovablePoint(n).didMovePoint&&(t=!0)}}return t}function loe({projection:r,transform:e,context:t,strategy:o,mode:i,clampToViewport:n}){let a=t.getItemModel(o.id);if(!a||a.type!=="expression")throw new Error(`Programming error: updateSliderNonlinear move strategy should point to an expression item, but found ${a==null?void 0:a.type}`);let s=i==="up"||i==="bigup",c=a.shouldIgnoreSoftLimits(s);o.compiled.fn||__dcg_shared_module_exports__['Cc'](o.compiled);let d=o.compiled.fn;e&&(d=C=>__dcg_shared_module_exports__['pc'](e.forward,o.compiled.fn(C)));let p=C=>{let[D,P]=d(C);return{x:D,y:P}=r.mathToPixels.mapPoint({x:D,y:P}),[D,P]},u=a.getSliderValue(),[g,h]=p(u),b=a.computeSliderKeyboardAdjustment(i,{ignoreSoftLimits:c}),v=b,[T,E]=p(v),I=__dcg_shared_module_exports__['k'](T-g,E-h);if(I<1){let C=__dcg_shared_module_exports__['u'](p,[g+(T-g)/I,h+(E-h)/I],v,v>u?v:o.min,v<u?v:o.max,1);if(C){let D=no(C[0],C[1]);(i==="bigup"||i==="bigdown")&&(D=u+(D-u)*5);let P=a.computeSliderSnappedValue(__dcg_shared_module_exports__['t'](D,o.min,o.max),{ignoreSoftLimits:c}),[F,N]=p(P);__dcg_shared_module_exports__['k'](F-g,N-h)>I&&(b=P)}}n&&(b=doe(r,a.getSliderValue(),b,d));let _=d(b);return{mathPoint:{x:_[0],y:_[1]},sliderUpdates:{[o.id]:{model:a,value:b}}}}function coe({context:r,projection:e,transform:t,strategy:o,targetScreenPoint:i,clampToViewport:n}){let a={mathPoint:{},sliderUpdates:{}},s=r.getItemModel(o.id);if(!s||s.type!=="expression")throw new Error(`Programming error: updateSliderNonlinear move strategy should point to an expression item, but found ${s==null?void 0:s.type}`);o.compiled.fn||__dcg_shared_module_exports__['Cc'](o.compiled);let c=o.compiled.fn;t&&(c=_=>__dcg_shared_module_exports__['pc'](t.forward,o.compiled.fn(_)));let d=_=>{let[C,D]=c(_);return{x:C,y:D}=e.mathToPixels.mapPoint({x:C,y:D}),[C,D]},p=o.initialValue,u=o.min,g=o.max,h=[i.x,i.y],b=__dcg_shared_module_exports__['u'](d,h,p,u,g,1);if(!b)return a;let v=no(b[0],b[1]);u!==void 0&&v<u&&(v=u),g!==void 0&&v>g&&(v=g);let T=s.computeSliderSnappedValue(v,{ignoreSoftLimits:!0});n&&(T=doe(e,s.getSliderValue(),T,c));let[E,I]=c(T);return a.mathPoint.x=E,a.mathPoint.y=I,a.sliderUpdates[s.id]={value:T,model:s},a}function BY({context:r,projection:e,transform:t,strategy:o,targetScreenPoint:i}){let n=e.reverse_map_pt(i);if(t){let p=__dcg_shared_module_exports__['pc'](t.inverse,[n.x,n.y]);n={x:p[0],y:p[1]}}let a=o.type==="updateSliderForGlider"?{min:o.min,max:o.max}:void 0,s=rV(e,n,o.movesOn,a);if(!isFinite(s))return;let c=aoe(o.movesOn,s),d={mathPoint:{x:c[0],y:c[1]},newPointLatex:void 0,sliderUpdates:{}};if(o.type==="updateGliderParameter"){let p=o.span;d.newPointLatex=p.input.slice(0,p.start)+__dcg_shared_module_exports__['lb'](s)+p.input.slice(p.end)}else if(o.type==="updateSliderForGlider"){let p=r.getItemModel(o.id);p&&p.type==="expression"&&(d.sliderUpdates[p.id]={value:s,model:p})}return d}function doe(r,e,t,o){let i=p=>{let[u,g]=o(p);return r.mathToPixels.mapPoint({x:u,y:g})},n=({x:p,y:u})=>{let{left:g,right:h,top:b,bottom:v}=r.pixelCoordinates;return p>=g&&p<=h&&u>=b&&u<=v},a=e,s=i(e),c=t,d=i(t);if(n(d)||!n(s))return t;for(;;){let p=s.x-d.x,u=s.y-d.y;if(p*p+u*u<.5)break;let g=__dcg_shared_module_exports__['s'](a,c);if(g===a||g===c){[a,c]=n(s)?[a,a]:[c,c];break}let h=i(g);n(h)!==n(s)?[c,d]=[g,h]:[a,s]=[g,h]}return no(a,c)}function KY({context:r,projection:e,transform:t,typedConstantValue:o,moveStrategy:i,dragMode:n,targetScreenPoint:a,clampToViewport:s}){if(t){let{x:h,y:b}=e.pixelsToMath.mapPoint(a),[v,T]=__dcg_shared_module_exports__['pc'](t.inverse,[h,b]);a=e.mathToPixels.mapPoint({x:v,y:T})}let c=e.pixelsToMath.mapRect({left:a.x-.5,right:a.x+.5,top:a.y+.5,bottom:a.y-.5}),d=[{min:c.left,max:c.right},{min:c.top,max:c.bottom}],p={mathPoint:{},sliderUpdates:{}},[u,g]=i;if(u.type==="updateCoordinate"||g.type==="updateCoordinate"){let h=USe(o,i,d,n);if(h){let{latex:b,x:v,y:T}=h;(v!==void 0||T!==void 0)&&(p.newPointLatex=b,p.mathPoint.x=v!=null?v:p.mathPoint.x,p.mathPoint.y=T!=null?T:p.mathPoint.y)}}for(let h of[0,1]){let b=i[h];if(pC(h,n)&&b.type==="updateSlider"){let v=r.getItemModel(b.id);if(!v||v.type!=="expression")continue;let[T,E]=b.coefficients,I=no(E*d[h].min+T,E*d[h].max+T),_=v.computeSliderSnappedValue(I,{ignoreSoftLimits:!0}),C=(_-T)/E;if(!s||t){p.mathPoint[h===0?"x":"y"]=C,p.sliderUpdates[v.id]={value:_,model:v};continue}let[D,P]=h===0?[e.mathCoordinates.left,e.mathCoordinates.right]:[e.mathCoordinates.bottom,e.mathCoordinates.top],F=C<D?D:C>P?P:void 0;F!==void 0&&v.getSliderStep()===void 0?(p.mathPoint[h===0?"x":"y"]=F,p.sliderUpdates[v.id]={value:E*F+T,model:v}):(p.mathPoint[h===0?"x":"y"]=C,p.sliderUpdates[v.id]={value:_,model:v})}}return p}function USe(r,e,t,o){if(!e)throw new Error("Programming error: expected move_strategy to be defined.");let i=no(t[0].min,t[0].max),n=no(t[1].min,t[1].max),[a,s]=e;if((r==null?void 0:r.valueType)===__dcg_shared_module_exports__['_']&&a.type==="updateCoordinate"&&s.type==="updateCoordinate"){let[h,b]=[__dcg_shared_module_exports__['Aa'](r,"real"),__dcg_shared_module_exports__['Aa'](r,"imag")],v=pC(0,o),T=pC(1,o),E=v?i:h,I=T?n:b,_=a.inputSpan;return{latex:_.input.slice(0,_.start)+__dcg_shared_module_exports__['yb']([E,I],{alwaysEmitImaginary:!0},"decimalString")+_.input.slice(_.end),x:v?i:void 0,y:T?n:void 0}}let c=!1,d=!1,p,u="",g=0;if(a.type==="updateCoordinate"&&pC(0,o)&&(p=a.inputSpan.input,c=!0,u+=p.slice(g,a.inputSpan.start),u+=__dcg_shared_module_exports__['lb'](i),g=a.inputSpan.end),s.type==="updateCoordinate"&&pC(1,o)&&(p=s.inputSpan.input,d=!0,u+=p.slice(g,s.inputSpan.start),u+=__dcg_shared_module_exports__['lb'](n),g=s.inputSpan.end),p!==void 0)return u+=p.slice(g),{latex:u,x:c?i:void 0,y:d?n:void 0}}function pC(r,e){switch(e){case __dcg_shared_module_exports__['Gd'].X:return r===0;case __dcg_shared_module_exports__['Gd'].Y:return r===1;case __dcg_shared_module_exports__['Gd'].XY:return!0;default:return!1}}function poe(r,e){e.forEach(t=>{YSe(r,t)})}function uoe(r,e){var u;let t=!1,{points:o,previous_screen_pts:i,screen_pts:n,projection:a,transform:s,keyboardDirection:c}=e,d=o.length===1,p=[];for(let g=0;g<o.length;g++){let h=o[g];if(h.tableInfo){KSe(r,h,n[g],a),t=!0;continue}let b=r.getItemModel(h.calcId);if(b){if(b.type==="image")t=t||HSe(r,b,h,n[g],a);else if(b.type==="expression"){let v=WSe({context:r,movedExpr:b,dragMode:(u=b.getReconciledDragMode({isReverseDrag:h.isReverseDrag}))!=null?u:__dcg_shared_module_exports__['Gd'].NONE,currentScreenPoint:i[g],targetScreenPoint:n[g],projection:a,transform:s&&s[g],isOnlyPoint:d,keyboardDirection:c});v&&p.push(v)}}}return t=t||soe(a,p),t}function hoe(r,e){e.forEach(t=>{BSe(r,t)})}function YSe(r,e){if(e.tableInfo){let t=r.getItemModel(e.tableInfo.tableId);if(!t||t.type!=="table")return;t.setIsDraggingOnGrapher(!0)}else{let t=r.getItemModel(e.calcId);if(!t||!(t.type==="expression"||t.type==="image"))return;let o=t.getMoveStrategy();if(!o)return;for(let i=0;i<o.length;i++){let n=o[i];if(o[i].type==="updateCoordinate"||o[i].type==="updateGliderParameter")(t.type==="image"||t.type==="expression")&&t.setIsDraggingOnGrapher(!0);else if(n.type==="updateSlider"||n.type==="updateSliderNonlinear"||n.type==="updateSliderForGlider"){let a=r.getItemModel(n.id);if(!a||a.type!=="expression")continue;let s;if(t.type==="expression"?s=t.getReconciledDragMode({isReverseDrag:e.isReverseDrag}):s=void 0,s===__dcg_shared_module_exports__['Gd'].NONE||i===0&&s===__dcg_shared_module_exports__['Gd'].Y||i===1&&s===__dcg_shared_module_exports__['Gd'].X)continue;a.setIsDraggingSlider(!0)}}}}function BSe(r,e){for(let t of r.getAllItemModels())t.type==="expression"&&t.isSliderDragging()&&t.setIsDraggingSlider(!1),t.isDraggingOnGrapher()&&t.setIsDraggingOnGrapher(!1)}function KSe(r,e,t,o){let i=e.tableInfo.tableId,n=e.tableInfo.rowIndex,a=e.tableInfo.columnId,s=e.tableInfo.dragX,c=e.tableInfo.dragY,d=r.getItemModel(i);if(!d||d.type!=="table")return;let p=d.getColumnIndex(a);if(p===void 0)return;let u=o.closestPointOnScreen(t),g=o.pixelsToMath.mapRect(goe(u,.5)),h={x:__dcg_shared_module_exports__['kb'](no(g.left,g.right)),y:__dcg_shared_module_exports__['kb'](no(g.top,g.bottom))};s&&d.setCellLatex({row:n+1,column:0},h.x),c&&d.setCellLatex({row:n+1,column:p},h.y)}function goe(r,e){return{left:r.x-e,right:r.x+e,top:r.y+e,bottom:r.y-e}}function zSe(r,e,t){if(t[0]===0&&t[1]===0)return{x:e.x,y:e.y,width:r.width,height:r.height};let o=Math.cos(r.radianAngle),i=Math.sin(r.radianAngle),n=e.x-r.x,a=e.y-r.y;if(t[0]===0)return{x:r.x,y:r.y,width:r.width,height:2*t[1]*(o*a+i*n)};if(t[1]===0)return{x:r.x,y:r.y,width:2*t[0]*(o*n-i*a),height:r.height};let s=2*(r.width*t[0]*(o*n-i*a)+r.height*t[1]*(i*n+o*a))/(r.width*r.width+r.height*r.height);return{x:r.x,y:r.y,width:s*r.width,height:s*r.height}}function qSe(r,e,t){let o=[{x:e.left,y:e.bottom},{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.right,y:e.bottom}],i=["x","y","width","height"],n={x:1/0,y:1/0,width:1/0,height:1/0},a={x:-1/0,y:-1/0,width:-1/0,height:-1/0};for(let s of o){let c=zSe(r,s,t);for(let d of i)n[d]=Math.min(n[d],c[d]),a[d]=Math.max(a[d],c[d])}return{min:n,max:a}}function uC(r){return r===void 0?NaN:r[0]}function HSe(r,e,t,o,i){let n=e.getMoveStrategy();if((n==null?void 0:n.length)!==4)return!1;let a=e.getDimensions();if(!a)return!1;let s={x:uC(a.x),y:uC(a.y),width:uC(a.width),height:uC(a.height),radianAngle:uC(a.radianAngle)},c=t.scaleFactor||[0,0],d=c[0]!==0&&c[1]!==0,p=i.closestPointOnScreen(o),u=i.pixelsToMath.mapRect(goe(p,d?.05:.5)),g=qSe(s,u,c),h=i.mathToPixels.mapRect({left:s.x-.5*s.width,right:s.x+.5*s.width,top:s.y-.5*s.height,bottom:s.y+.5*s.height}),b=Math.abs(h.right-h.left),v=Math.abs(h.bottom-h.top),T=i.mathToPixels.mapRect({left:g.min.x-.5*g.min.width,right:g.min.x+.5*g.min.width,top:g.min.y-.5*g.min.height,bottom:g.min.y+.5*g.min.height}),E=Math.abs(T.right-T.left),I=Math.abs(T.bottom-T.top);if(E<b&&E<1||I<v&&I<1)return!1;let _=["width","height","x","y"],C=!1;for(let D=0;D<_.length;D++){let P=_[D],F=n[D];switch(F.type){case"updateCoordinate":let N=no(g.min[P],g.max[P]),Y=F.inputSpan.input,z=__dcg_shared_module_exports__['kb'](N);switch(P){case"width":case"height":e.setImageMQAttribute(P,z);break;case"x":if(n[3].type==="updateCoordinate"){let q=n[3],S=no(g.min.y,g.max.y),A=__dcg_shared_module_exports__['kb'](S),O=Y.slice(0,F.inputSpan.start)+z+Y.slice(F.inputSpan.end,q.inputSpan.start)+A+Y.slice(q.inputSpan.end);e.setImageMQAttribute("center",O)}else{let q=Y.slice(0,F.inputSpan.start)+z+Y.slice(F.inputSpan.end);e.setImageMQAttribute("center",q)}break;case"y":if(n[2].type!=="updateCoordinate"){let q=Y.slice(0,F.inputSpan.start)+z+Y.slice(F.inputSpan.end);e.setImageMQAttribute("center",q)}break;default:return P}C=!0;break;case"updateSlider":{let X=r.getItemModel(F.id);if(!X||X.type!=="expression")continue;let q=F.coefficients[0],S=F.coefficients[1],A=S*g.min[P]+q,O=S*g.max[P]+q,B=no(A,O);X.adjustSliderByMovablePoint(B).didMovePoint&&(C=!0)}break}}return C}function WSe({context:r,movedExpr:e,dragMode:t,currentScreenPoint:o,targetScreenPoint:i,projection:n,transform:a,isOnlyPoint:s,keyboardDirection:c}){var b;let d=e.getMoveStrategy();if((d==null?void 0:d.length)!==2)return;let[p,u]=d;if(s&&p.type==="updateCoordinate"&&u.type==="updateCoordinate"){let v=n.reverse_map_pt(i),T=zY(n,v);T&&(i=n.map_pt(T))}let g=s?n.closestPointOnScreen(i):i;if(!c){let v;switch(p.type){case"updateSliderNonlinear":v=coe({context:r,projection:n,transform:a,strategy:p,targetScreenPoint:g,clampToViewport:s});break;case"updateGliderParameter":case"updateSliderForGlider":v=BY({context:r,projection:n,transform:a,strategy:p,targetScreenPoint:g});break;default:v=KY({context:r,projection:n,transform:a,typedConstantValue:e.getTypedConstantValue(),moveStrategy:d,dragMode:t,targetScreenPoint:g,clampToViewport:s})}return v&&{...v,commitSliderSoftLimits:!1,transform:a,model:e}}let h;if(p.type==="updateSliderNonlinear"){if(!(c!=null&&c.x))return;h=loe({projection:n,transform:a,context:r,strategy:p,mode:c.x,clampToViewport:s})}else if(p.type==="updateGliderParameter"||p.type==="updateSliderForGlider")h=BY({context:r,projection:n,transform:a,strategy:p,targetScreenPoint:g});else{let v=c.x?0:1,T=c.x?g.x-o.x:g.y-o.y,E=d[v];if(E.type==="updateSlider"){let I=r.getItemModel(E.id);if((I==null?void 0:I.type)!=="expression")throw new Error(`Programming error: updateSlider move strategy should point to an expression item, but found ${I==null?void 0:I.type}`);let _=I.getSliderStep();if(_){let C=n.mathToPixels.mapPoint({x:0,y:0}),D=E.coefficients[1],P=Math.abs(v===0?n.mathToPixels.mapX(_/D)-C.x:n.mathToPixels.mapY(_/D)-C.y),F=Math.ceil(1/P);T=P*F*(T>0?1:-1);let N=(b=c.x)!=null?b:c.y;(N==="bigup"||N==="bigdown")&&(T*=5)}}h=KY({context:r,projection:n,transform:a,typedConstantValue:e.getTypedConstantValue(),moveStrategy:d,dragMode:t,targetScreenPoint:{x:o.x+(v===0?T:0),y:o.y+(v===1?T:0)},clampToViewport:s})}return h&&{...h,commitSliderSoftLimits:!0,transform:a,model:e}}function zY(r,e){if(!r.settings.showGrid)return;let t=zl(r),o=t.minorStepX,i=t.minorStepY,n=r.map_pt(e),a=Math.round(e.x/o)*o,s=Math.round(e.y/i)*i,c=5,d={x:a,y:s},p=r.map_pt(d);if(__dcg_shared_module_exports__['k'](p.x-n.x,p.y-n.y)<=c)return d}var oV=class{constructor(e){this.calcController=e}destroy(){}getItemModel(e){let t=this.calcController.getItemModel(e);if(t)switch(t.type){case"expression":return new qY(t);case"image":return new WY(t);case"table":return new HY(t)}}getAllItemModels(){let e=[];return this.calcController.getAllItemModels().forEach(t=>{let o=this.getItemModel(t.id);o&&e.push(o)}),e}startMovingPoints(e){poe(this,e)}stopMovingPoints(e){hoe(this,e)}movePoints(e){return{didMovePoint:uoe(this,e)}}},qY=class{constructor(e){this.model=e;this.type="expression";this.id=e.id}getMoveStrategy(){return this.model.formula.move_strategy}getTypedConstantValue(){return this.model.formula.typed_constant_value}getReconciledDragMode(e){return co(this.model,e)}isDraggingOnGrapher(){return this.model.draggingOnGraphpaper}isSliderDragging(){return this.model.sliderDragging}getSliderValue(){return Qs(this.model)}getSliderStep(){return od(this.model)}computeSliderSnappedValue(e,t){return rd(this.model,e,t)}computeSliderKeyboardAdjustment(e,t){return jI(this.model,e,t)}shouldIgnoreSoftLimits(e){var t;return((t=this.model.slider)==null?void 0:t.step)!==""&&(e&&!this.model.slider.hardMax||!e&&!this.model.slider.hardMin)}setIsDraggingOnGrapher(e){J9(this.model,e)}setIsDraggingSlider(e){ZI(this.model,e)}adjustSliderByMovablePoint(e){let t=this.model.latex;return zF(this.model,e),{didMovePoint:t!==this.model.latex}}setLatex(e){let t=this.model.latex;return Zn(this.model,e),{didMovePoint:t!==this.model.latex}}commitSliderSoftLimits(){sb(this.model)}},HY=class{constructor(e){this.model=e;this.type="table";this.id=e.id}isDraggingOnGrapher(){return this.model.draggingOnGraphpaper}getColumnIndex(e){var t;return(t=lo(this.model,e))==null?void 0:t.index}setIsDraggingOnGrapher(e){e===!0&&Ir(this.model.controller.getListModel(),void 0),Fq(this.model,e)}setCellLatex(e,t){return Cg(this.model,e,t),{didMovePoint:!0}}},WY=class{constructor(e){this.model=e;this.type="image";this.id=e.id}getMoveStrategy(){return this.model.formula.move_strategy}getDimensions(){return this.model.formula.dimensions}isDraggingOnGrapher(){return this.model.draggingOnGraphpaper}setIsDraggingOnGrapher(e){gW(this.model,e)}setImageMQAttribute(e,t){let o=P0(this.model,e);ed(this.model,e,t);let i=P0(this.model,e);return{didMovePoint:o!==i}}};function jSe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var XSe="ID_",Ay=function(){function r(){jSe(this,r),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return r.prototype.register=function(t){var o=XSe+this._lastID++;return this._callbacks[o]=t,o},r.prototype.unregister=function(t){this._callbacks[t]||hC(!1,"Dispatcher.unregister(...): `%s` does not map to a registered callback.",t),delete this._callbacks[t]},r.prototype.waitFor=function(t){this._isDispatching||hC(!1,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var o=0;o<t.length;o++){var i=t[o];if(this._isPending[i]){this._isHandled[i]||hC(!1,"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",i);continue}this._callbacks[i]||hC(!1,"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",i),this._invokeCallback(i)}},r.prototype.dispatch=function(t){this._isDispatching&&hC(!1,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this._startDispatching(t);try{for(var o in this._callbacks)this._isPending[o]||this._invokeCallback(o)}finally{this._stopDispatching()}},r.prototype.isDispatching=function(){return this._isDispatching},r.prototype._invokeCallback=function(t){this._isPending[t]=!0,this._callbacks[t](this._pendingPayload),this._isHandled[t]=!0},r.prototype._startDispatching=function(t){for(var o in this._callbacks)this._isPending[o]=!1,this._isHandled[o]=!1;this._pendingPayload=t,this._isDispatching=!0},r.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},r}();function hC(r,e,t,o,i,n,a,s){if(e===void 0)throw new Error("invariant requires an error message argument");if(!r){var c;if(e===void 0)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[t,o,i,n,a,s],p=0;c=new Error(e.replace(/%s/g,function(){return d[p++]})),c.name="Invariant Violation"}throw c.framesToPop=1,c}}En();function Gd(r){return __dcg_shared_module_exports__['cb'](r)}function Vd(r){this.setState(r)}Vd.prototype.setState=function(r){this.state=r};Vd.prototype.getState=function(){return this.state};Vd.prototype.set=function(r,e){if(arguments.length===1){this.state=r;return}else if(typeof r=="string"){this.state=Gd(this.state),this.state[r]=e;return}let t=r.length-2,o=r[t+1],i;this.state=i=Gd(this.state);for(let n=0;n<=t;n++){let a=r[n];i=i[a]=Gd(i[a])}i[o]=e};Vd.prototype.deepMutate=function(r,e){if(arguments.length===1){e=r,this.state=__dcg_shared_module_exports__['f'](this.state),e(this.state);return}else if(typeof r=="string"){this.state=Gd(this.state),this.state[r]=__dcg_shared_module_exports__['f'](this.state[r]),e(this.state[r]);return}let t=r.length-2,o=r[t+1],i=this.state=Gd(this.state);for(let n=0;n<=t;n++){let a=r[n];i=i[a]=Gd(i[a])}i=i[o]=__dcg_shared_module_exports__['f'](i[o]),e(i)};Vd.prototype.shallowMutate=function(r,e){if(arguments.length===1){e=r,this.state=Gd(this.state),e(this.state);return}else if(typeof r=="string"){this.state=Gd(this.state),this.state[r]=Gd(this.state[r]),e(this.state[r]);return}let t=r.length-1,o=this.state=Gd(this.state);for(let i=0;i<=t;i++){let n=r[i];o=o[n]=Gd(o[n])}e(o)};Vd.areShallowEqual=function(r,e){};Vd.areDeepEqual=function(r,e){};var moe=[{key:"compass",objects:"Segment + Point"},{key:"midpoint",objects:"Segment"},{key:"parallel",objects:"Line + Point"},{key:"perpendicular",objects:"Line + Point"},{key:"image",objects:"2 Points"}];function $Se(r,e){var a;if(e.typedRuntimeValue.valueType===__dcg_shared_module_exports__['W']||e.typedRuntimeValue.valueType===__dcg_shared_module_exports__['X'])return[];let t=e.data.call;if(!t||!t.parents)return[];let o=t.symbol,i=t.parents.map(Xw),n;switch(o){case"circle":{let[s,c]=i,d=c&&((a=r[c])==null?void 0:a.typedRuntimeValue.valueType);d&&__dcg_shared_module_exports__['wa'](d,__dcg_shared_module_exports__['K'])?n=[s]:n=[s,c];break}case"apply":{n=[i[1]];break}case"parallel":case"perpendicular":{n=[i[1]];break}case"polygon":{n=i.every(s=>s!==void 0)?i:[];break}default:n=i}return n.filter(boe)}var JSe=[[1,0],[0,0],!1],gC=class gC{constructor(e,t){let o=(e==null?void 0:e.list)||[];t&&(o=o.concat(t)),this.list=o;let i=(e==null?void 0:e.forward)||JSe;t&&(i=__dcg_shared_module_exports__['nc'](i,t.value)),this.forward=i,this.inverse=__dcg_shared_module_exports__['oc'](i)}add(e){return new gC(this,e)}equals(e){if(this.list.length!==e.list.length)return!1;for(let t=this.list.length-1;t>=0;t--){let o=this.list[t],i=e.list[t];if(!__dcg_shared_module_exports__['db'](o,i))return!1}return!0}isCompletelyRigid(){return this.list.length===0}};gC.COMPLETELY_RIGID=new gC(void 0);var iV=gC;function ZSe(r){var o,i;let e={},t={};for(let n in r){let a=r[n];if(!a)continue;for(let c of((o=a.data.call)==null?void 0:o.parents)||[]){let d=Xw(c);d&&(e[d]||(e[d]=[]),(i=e[d])==null||i.push(a.assignment))}let s=$Se(r,a);t[a.assignment]=s}return{parentToChildren:e,childToReversibilityParents:t}}function foe(r){let e=[],t={};function a(s){var c;t[s]!==2&&(t[s]=1,(c=r[s])==null||c.forEach(a),t[s]=2,e.unshift(s))}for(let s in r)t[s]===void 0&&a(s);return e}function jY(r,e){var u,g,h,b,v,T,E,I,_,C;let t={},o={},i={},n={},a={};for(let D of e)a[D]=!0,i[D]=iV.COMPLETELY_RIGID;let{parentToChildren:s,childToReversibilityParents:c}=ZSe(r);for(let D of foe(c)){let P=r[D];if(!P)continue;let F=(u=P.data.call)==null?void 0:u.symbol,N=(((g=P.data.call)==null?void 0:g.parents)||[]).map(Xw).filter(boe);if(i[P.assignment])if(P.typedRuntimeValue.valueType===__dcg_shared_module_exports__['C']&&!F)t[P.assignment]=i[P.assignment];else if(F==="glider"&&N.length&&!a[N[0]])o[P.assignment]=i[P.assignment];else{let Y=i[P.assignment];if(F==="apply"){let X=(h=r[N[0]])==null?void 0:h.typedRuntimeValue;if((X==null?void 0:X.valueType)===__dcg_shared_module_exports__['X'])return{};if((X==null?void 0:X.valueType)!==__dcg_shared_module_exports__['W'])continue;Y=Y.add(X)}let z=(b=c[P.assignment])!=null?b:[];for(let X of z)i[X]?Y.equals(i[X])||(i[X]=iV.COMPLETELY_RIGID,n[X]=!0):i[X]=Y}}let d={};for(let D in i)d[D]=!0;for(let D of foe(s))if(d[D]){for(let P of s[D]||[])d[P]=!0;if(i[D]){let P=c[D]||[];for(let F of P)n[F]&&(n[D]=!0)}}for(let D in o){let F=(((T=(v=r[D])==null?void 0:v.data.call)==null?void 0:T.parents)||[]).map(Xw)[0];F&&d[F]&&(n[F]=!0)}for(let D in r){if(!d[D])continue;let P=r[D],F=(E=P==null?void 0:P.data.call)==null?void 0:E.symbol,N=(((I=P==null?void 0:P.data.call)==null?void 0:I.parents)||[]).map(Xw);if(F==="apply"&&i[D]){let Y=N[1],z=N[0];if(!Y||!z)continue;let X=(((C=(_=r[z])==null?void 0:_.data.call)==null?void 0:C.parents)||[]).map(Xw),q=X.some(A=>A&&d[A]);if(i[D].isCompletelyRigid()&&(!(Y in i)||i[Y].isCompletelyRigid())||q){n[Y]=!0;for(let A of X)A&&(n[A]=!0)}}}let p=[];for(let D in n)a[D]||p.push(D);return p.length?jY(r,e.concat(p)):{...t,...o}}function Xw(r){if(r.type==="arbitrary-expression")return;let e=__dcg_shared_module_exports__['Oc'](r);return e?__dcg_shared_module_exports__['vb'](e):void 0}function boe(r){return r!==void 0}var mC=class{constructor(){this._nextId=0;this._defs={}}clear(){this._nextId=0,this._defs={}}add(e,t){let o;t?(o=e.assignment,e.listIndex!==void 0&&(o+="\\left["+e.listIndex+"\\right]")):o="**geo-internal-id-"+this._nextId++,this._defs[o]=e}computeReversibilityLineages(e){var s;let t=this.buildAssignmentMap(),o={};for(let c in t){let d=t[c];d&&(o[d.calcId]=d)}let i=[];for(let c of e){let d=o[c];if(!d)return{};i.push(d.assignment)}let n=jY(this.buildAssignmentMap(),i),a={};for(let c in n){let d=(s=t[c])==null?void 0:s.calcId;d&&(a[d]=n[c])}return a}buildAssignmentMap(){let e={};for(let t in this._defs){let o=this._defs[t];o&&(e[o.assignment]=o)}return e}getDepthValues(){let e={},t={},o=this.buildAssignmentMap();for(let c in o){let d=o[c];if(!d)continue;let p=__dcg_shared_module_exports__['wb'](d.assignment),u=[];for(let g of d.data.parentDependencies)u.push(g),t[g]||(t[g]=[]),t[g].push(p);e[p]=u}let i={},n=c=>{if(i[c]!==void 0)return i[c];if(i[c]===-1)return i[c]=0,0;i[c]=-1;let d=-1,p=e[c]||[];for(let g=0;g<p.length;g++){let h=n(p[g]);h>d&&(d=h)}let u=d+1;return i[c]=u,u};for(let c in e)i[c]===void 0&&n(c);let a={},s={};for(let c in t){let d=i[c],p=1/0;t[c].forEach(u=>{let g=i[u];g>d&&(d=g),g<p&&(p=g)}),a[c]=d,s[c]=p}return{createdDepth:i,lastReferencedDepth:a,firstReferencedDepth:s}}};function Ly(r){return r?!!(QSe(r)&&r!==__dcg_shared_module_exports__['Y']||r===__dcg_shared_module_exports__['M']||r===__dcg_shared_module_exports__['N']||r===__dcg_shared_module_exports__['J']):!1}function QSe(r){if(!r)return!1;switch(r){case __dcg_shared_module_exports__['O']:case __dcg_shared_module_exports__['Q']:case __dcg_shared_module_exports__['Y']:case __dcg_shared_module_exports__['K']:return!0}return!1}function voe(r,e){let t={i:0,x:NaN,y:NaN},o={i:1,x:NaN,y:NaN};if(!r||!e)return[t,o];let i=yoe(r.typedRuntimeValue),n=yoe(e.typedRuntimeValue);if(!i||!n)return[t,o];let a=xoe(i,n);return t.x=a[0],t.y=a[1],a=xoe(n,i),o.x=a[0],o.y=a[1],[t,o]}function yoe(r){switch(r.valueType){case __dcg_shared_module_exports__['K']:case __dcg_shared_module_exports__['O']:case __dcg_shared_module_exports__['Q']:return{type:"straight",def:r.value};case __dcg_shared_module_exports__['Y']:return{type:"straight",def:ny(r.value)};case __dcg_shared_module_exports__['M']:return{type:"circle",def:r.value};case __dcg_shared_module_exports__['N']:return{type:"arc",def:r.value}}}function xoe(r,e){switch(r.type){case"straight":switch(e.type){case"straight":return __dcg_shared_module_exports__['gc'](r.def,e.def);case"circle":return __dcg_shared_module_exports__['ec'](r.def,e.def);case"arc":return __dcg_shared_module_exports__['ic'](r.def,e.def)}case"circle":switch(e.type){case"straight":return __dcg_shared_module_exports__['fc'](r.def,e.def);case"circle":return __dcg_shared_module_exports__['dc'](r.def,e.def);case"arc":return __dcg_shared_module_exports__['hc'](r.def,e.def)}case"arc":switch(e.type){case"straight":return __dcg_shared_module_exports__['kc'](r.def,e.def);case"circle":return __dcg_shared_module_exports__['jc'](r.def,e.def);case"arc":return __dcg_shared_module_exports__['lc'](r.def,e.def)}}return[NaN,NaN]}var Xm=class extends Cd{constructor(t){super(t);this.model=t;this.displayNameKey="graphing-calculator-text-geometry-tool-expression-edit-display-name",this.toolType="custom",this.toolName="expression-edit"}getHint(){let t=this.model.controller.getValidCursorContext();if((t==null?void 0:t.type)!=="expression-arguments"||!t.functionSymbol)return this.getGenericHint();let o=this.model.getTool(t.functionSymbol);if(!o)return this.getGenericHint();let i=t.argIndex;if(t.positionWithinArg==="end"&&(i+=1),o.toolType==="transformation"){if(t.argCount===0)return wt("graphing-calculator-text-geometry-tool-expression-edit-starting-transformation-hint");i>0&&(i-=1)}return o.getExpressionEditHint(i)}getGenericHint(){let t=this.getAllValidNextInputTypes();if(t.some(i=>i===__dcg_shared_module_exports__['A']||i===__dcg_shared_module_exports__['D']))return wt("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-any-object");let o=t.filter(i=>!(__dcg_shared_module_exports__['qa'](i)&&t.find(n=>__dcg_shared_module_exports__['ra'](i)===n))).map(i=>fc(__dcg_shared_module_exports__['pa'](i),D0()));return o.length===0?wt("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-0"):o.length===1?wt("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-1",{type:o[0]}):o.length===2?wt("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-2",{type1:o[0],type2:o[1]}):wt("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-many",{types:ol(tb(),o)})}getExpressionEditHint(t){return this.getHint()}getSpec(){let t=this.model.controller.getSelectedItem(),o=XY(this.model.controller.getValidCursorContext());return!o||!t||t.type!=="expression"?{inputs:[],outputs:[]}:{inputs:[{type:"union",valueTypes:o,id:"1"}],outputs:[{type:"expression-edit-preview-latex",rhsLatex:this.buildPreviewLatex(),hidden:!1,color:t.color,id:"2",parents:[]}]}}onMove(t){super.onMove(t);let{idMap:o,inputIndex:i}=this.model.getNonObjectsState().ui.currentTool,n=this.getSpec().inputs[i];return!!(n&&o[n.id])}buildPreviewLatex(){let t="",o="",i=this.model.controller.getValidCursorContext(),n=(i==null?void 0:i.type)==="permissive"?i.cursorContext:i;if((n==null?void 0:n.type)==="empty")return"";(n==null?void 0:n.type)==="expression-arguments"&&((n==null?void 0:n.positionWithinArg)==="end"?t=",":(n==null?void 0:n.positionWithinArg)==="start"&&(o=","));let s=this.model.getNonObjectsState().ui.currentTool.idMap[1];if(!s)return"";let c=this.model.controller.getSelectedItem();if((c==null?void 0:c.type)!=="expression")return"";let d=Qe.getFocusedMathquill(),p=d==null?void 0:d.selection();if((p==null?void 0:p.latex)!==c.latex)return"";let u=c.latex.slice(0,p.startIndex)+t+s+o+c.latex.slice(p.endIndex);return Go(c)?u.slice(c.latex.indexOf("=")+1):u}canNextInputBePoint(){let t=this.model.controller.getValidCursorContext();if((t==null?void 0:t.type)!=="expression-arguments"||t.expressionType!=="FunctionCall"&&t.expressionType!=="List")return!1;let o=XY(t);if(!o)return!1;let i=!1;for(let n of o){if(__dcg_shared_module_exports__['wa'](n,__dcg_shared_module_exports__['A']))return!1;__dcg_shared_module_exports__['wa'](n,__dcg_shared_module_exports__['C'])&&(i=!0)}return i}shouldHighlightRelevantObjects(){let t=this.model.controller.getValidCursorContext();if((t==null?void 0:t.type)==="empty"||(t==null?void 0:t.type)==="permissive")return!1;let o=XY(t);return!(!o||o.some(i=>__dcg_shared_module_exports__['wa'](i,__dcg_shared_module_exports__['A']))||o.every(i=>__dcg_shared_module_exports__['wa'](i,__dcg_shared_module_exports__['B'])||__dcg_shared_module_exports__['wa'](i,__dcg_shared_module_exports__['S'])||__dcg_shared_module_exports__['wa'](i,__dcg_shared_module_exports__['U'])))}};function XY(r){if((r==null?void 0:r.type)==="permissive")return[__dcg_shared_module_exports__['A']];if((r==null?void 0:r.type)==="empty")return[__dcg_shared_module_exports__['S'],__dcg_shared_module_exports__['U'],__dcg_shared_module_exports__['T'],__dcg_shared_module_exports__['V'],__dcg_shared_module_exports__['Y']];if((r==null?void 0:r.type)==="expression-arguments"&&r.expressionType==="FunctionCall"&&r.functionSymbol&&!__dcg_shared_module_exports__['xc'][r.functionSymbol])return;let e=(r==null?void 0:r.type)==="expression-arguments"?r.allowedTypesForInsertedArg:r==null?void 0:r.allowedTypes;return e==null?void 0:e.filter(t=>!__dcg_shared_module_exports__['wa'](t,__dcg_shared_module_exports__['ja']))}var $Y="graphing-calculator-text-geometry-tool-angle-hint-1",JY="graphing-calculator-text-geometry-tool-angle-hint-2",ZY="graphing-calculator-text-geometry-tool-angle-hint-3",QY="graphing-calculator-text-geometry-tool-angles-hint-1",e0e={name:"angle",displayNameKey:"graphing-calculator-text-geometry-tool-angle-display-name",toolType:"complex",icon:[{type:"stroked-path",path:[40,30,30,70,70,70],color:"#bbb"},{type:"angle",x:30,y:70,radius:20,startAngle:-1.325817,deltaAngle:1.325817,isDirected:!1},{type:"point",x:30,y:70},{type:"point",x:40,y:30},{type:"point",x:70,y:70}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['C']],hints:[$Y,JY,ZY]},output:[{type:"angle",parents:[0,1,2]}]},{input:{broadcast:!1,types:[__dcg_shared_module_exports__['J']],hints:[QY]},output:({inputs:r})=>{if(r.length!==1||r[0].valueType!==__dcg_shared_module_exports__['J'])throw new Error(`Programming error: expected a single polygon input, got ${JSON.stringify(r)}`);return r[0].value.map((t,o)=>({type:"polygon-angle",angleIndex:o+1,parents:[0]}))}}]},fC=class extends Lr{constructor(t){super(t,e0e);this.model=t}};var t0e="graphing-calculator-text-geometry-tool-angle-bisector-hint-angle",r0e={name:"anglebisector",displayNameKey:"graphing-calculator-text-geometry-tool-angle-bisector-display-name",toolType:"complex",icon:[{type:"stroked-path",color:"#ccc",path:[40,30,30,70,70,70]},{type:"angle",x:30,y:70,radius:20,startAngle:-1.325817,deltaAngle:1.325817,isDirected:!1},{type:"stroked-path",lineWidth:"large",path:[31,69,70,38.8]}],workflows:[{input:{broadcast:!1,types:[__dcg_shared_module_exports__['ma'].of([__dcg_shared_module_exports__['S'],__dcg_shared_module_exports__['U']])],hints:[t0e]},output:[{type:"anglebisector",parents:[0]}]}]},bC=class extends Lr{constructor(t){super(t,r0e);this.model=t}};var o0e="graphing-calculator-text-geometry-tool-arc-hint-1",i0e="graphing-calculator-text-geometry-tool-arc-hint-2",n0e="graphing-calculator-text-geometry-tool-arc-hint-3",Py=50,nV=80,aV=80,eB=-3,woe=-2.6,tB=-1.7,a0e=[{type:"arc",x:nV,y:aV,radius:Py,startAngle:eB,endAngle:tB},{type:"point",x:nV+Py*Math.cos(eB),y:aV+Py*Math.sin(eB)},{type:"point",x:nV+Py*Math.cos(woe),y:aV+Py*Math.sin(woe)},{type:"point",x:nV+Py*Math.cos(tB),y:aV+Py*Math.sin(tB)}],s0e={name:"arc",displayNameKey:"graphing-calculator-text-geometry-tool-arc-display-name",toolType:"complex",icon:a0e,workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['C']],hints:[o0e,i0e,n0e]},output:[{type:"arc",parents:[0,1,2]}]}]},yC=class extends Lr{constructor(t){super(t,s0e);this.model=t}};var l0e="graphing-calculator-text-geometry-tool-circle-hint-center",c0e="graphing-calculator-text-geometry-tool-circle-hint-radius",d0e={name:"circle",displayNameKey:"graphing-calculator-text-geometry-tool-circle-display-name",toolType:"simple",icon:[{type:"circle",x:50,y:50,radius:26},{type:"point",x:50,y:50},{type:"point",x:68,y:32}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['C']],hints:[l0e,c0e]},output:[{type:"circle",parents:[0,1]}]}]},xC=class extends Lr{constructor(t){super(t,d0e);this.model=t}};var p0e="graphing-calculator-text-geometry-tool-compass-hint-segment",u0e="graphing-calculator-text-geometry-tool-compass-hint-center",h0e={name:"compass",displayNameKey:"graphing-calculator-text-geometry-tool-circle-by-length-display-name",toolType:"complex",icon:[{type:"ellipse",x:50,y:65,rx:26,ry:11,color:__dcg_shared_module_exports__['zd'].GRAY,lineWidth:2},{type:"stroked-path",path:[50,65,78,65]},{type:"stroked-path",path:[50,65,62,36],lineWidth:"large",color:r=>__dcg_shared_module_exports__['sd'](r.circle,.3)},{type:"stroked-path",path:[78,65,66,36],lineWidth:"large",color:r=>__dcg_shared_module_exports__['sd'](r.circle,.3)},{type:"circle",radius:6,x:64,y:31,lineWidth:5,color:r=>__dcg_shared_module_exports__['sd'](r.circle,.3)},{type:"stroked-path",path:[64,24,64,18],lineWidth:"large",color:r=>__dcg_shared_module_exports__['sd'](r.circle,.3)},{type:"point",x:50,y:65},{type:"point",x:78,y:65}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__['K'],__dcg_shared_module_exports__['C']],hints:[p0e,u0e]},output:[{type:"circle",parents:[1,0]}]}]},vC=class extends Lr{constructor(t){super(t,h0e);this.model=t}};var Soe="graphing-calculator-text-geometry-tool-dilation-hint-center",koe="graphing-calculator-text-geometry-tool-dilation-hint-scale-factor",wC=class extends Ed{constructor(t){super(t);this.model=t;this.displayNameKey="graphing-calculator-text-geometry-tool-dilate-display-name",this.toolName="dilation",this.toolType="transformation"}getExpressionEditHint(t){return t===0?this.s(Soe):this.s(koe)}getSpecIdToLockIn(t,o){return o===1?"2-number":super.getSpecIdToLockIn(t,o)}getSpec(){return{inputs:[{type:"point",id:"1",hint:Soe},{type:"union",valueTypes:[],id:"2",hint:koe,numberInputInfo:{defaultLatex:"2",sliderInfo:{value:"2",min:"0",max:"5"}}}],outputs:[{id:"3",type:"dilate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2-number"}]}]}}};var g0e={name:"directedangle",displayNameKey:"graphing-calculator-text-geometry-tool-directedangle-display-name",toolType:"complex",icon:[{type:"stroked-path",path:[40,30,30,70,70,70],color:"#bbb"},{type:"angle",x:30,y:70,radius:20,isDirected:!0,startAngle:-1.325817,deltaAngle:1.325817},{type:"stroked-path",path:[35,50,41,50,37,55,35,50],color:"#000",lineWidth:"medium"},{type:"point",x:30,y:70},{type:"point",x:40,y:30},{type:"point",x:70,y:70}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['C']],hints:[$Y,JY,ZY]},output:[{type:"directedangle",parents:[0,1,2]}]},{input:{broadcast:!1,types:[__dcg_shared_module_exports__['J']],hints:[QY]},output:({inputs:r})=>{if(r.length!==1||typeof r[0]!="object"||r[0].valueType!==__dcg_shared_module_exports__['J'])throw new Error(`Programming error: expected a single polygon input, got ${JSON.stringify(r)}`);return r[0].value.map((t,o)=>({type:"polygon-directedangle",angleIndex:o+1,parents:[0]}))}}]},SC=class extends Lr{constructor(t){super(t,g0e);this.model=t}};var m0e="graphing-calculator-text-geometry-tool-line-hint-start",f0e="graphing-calculator-text-geometry-tool-line-hint-end",b0e={name:"line",displayNameKey:"graphing-calculator-text-geometry-tool-line-display-name",toolType:"simple",icon:[{type:"stroked-path",path:[78,22,22,78],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['C']],hints:[m0e,f0e]},output:[{type:"line",parents:[0,1]}]}]},kC=class extends Lr{constructor(t){super(t,b0e);this.model=t}};var _oe="graphing-calculator-text-geometry-tool-midpoint-hint",y0e={name:"midpoint",displayNameKey:"graphing-calculator-text-geometry-tool-midpoint-display-name",toolType:"simple",icon:[{type:"stroked-path",path:[32,32,68,68]},{type:"point",x:50,y:50,size:"large"},{type:"point",x:32,y:32,size:"medium"},{type:"point",x:68,y:68,size:"medium"}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['C']],hints:[_oe]},output:[{type:"midpoint",parents:[0,1]}]},{input:{broadcast:!0,types:[__dcg_shared_module_exports__['K']],hints:[_oe]},output:[{type:"midpoint",parents:[0]}]}]},_C=class extends Lr{constructor(t){super(t,y0e);this.model=t}};var x0e="graphing-calculator-text-geometry-tool-parallel-hint-straight-line",v0e="graphing-calculator-text-geometry-tool-parallel-hint-point",w0e={name:"parallel",displayNameKey:"graphing-calculator-text-geometry-tool-parallel-display-name",toolType:"complex",icon:[{type:"stroked-path",color:"light",path:[25,50,75,30],lineWidth:"large"},{type:"stroked-path",path:[25,70,75,50],lineWidth:"large"},{type:"point",x:50,y:60,size:"medium"}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__['va'],__dcg_shared_module_exports__['C']],hints:[x0e,v0e]},output:[{type:"parallel",parents:[0,1]}]}]},CC=class extends Lr{constructor(t){super(t,w0e);this.model=t}};var S0e="graphing-calculator-text-geometry-tool-perpendicular-hint-straight-line",k0e="graphing-calculator-text-geometry-tool-perpendicular-hint-point",_0e={name:"perpendicular",displayNameKey:"graphing-calculator-text-geometry-tool-perpendicular-display-name",toolType:"complex",icon:[{type:"stroked-path",color:"light",path:[40,25,60,75],lineWidth:"large"},{type:"stroked-path",path:[25,60,75,40],lineWidth:"large"},{type:"point",x:50,y:50,size:"medium"}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__['va'],__dcg_shared_module_exports__['C']],hints:[S0e,k0e]},output:[{type:"perpendicular",parents:[0,1]}]}]},TC=class extends Lr{constructor(t){super(t,_0e);this.model=t}};var C0e="graphing-calculator-text-geometry-tool-point-hint",T0e={name:"point",displayNameKey:"graphing-calculator-text-geometry-tool-point-display-name",toolType:"simple",icon:[{type:"point",x:50,y:50,size:"large"}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__['C']],hints:[C0e]},output:[]}]},EC=class extends Lr{constructor(t){super(t,T0e);this.model=t}};var E0e="graphing-calculator-text-geometry-tool-polygon-hint-first-point",I0e="graphing-calculator-text-geometry-tool-polygon-hint-next-point",M0e="graphing-calculator-text-geometry-tool-polygon-hint-finish-point",D0e={name:"polygon",displayNameKey:"graphing-calculator-text-geometry-tool-polygon-display-name",toolType:"complex",icon:[{type:"filled-polygon",path:[55,30,30,30,35,70,70,60,55,30]},{type:"stroked-path",path:[55,30,30,30,35,70,70,60,55,30]},{type:"point",x:55,y:30},{type:"point",x:30,y:30},{type:"point",x:35,y:70},{type:"point",x:70,y:60}],isDegenerateInput:({previousInputs:r,proposedInput:e})=>!!(r.length===1&&__dcg_shared_module_exports__['db'](r[0],e)),workflows:[{input:{broadcast:!0,types:{type:"variadic",initial:[__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['C']],rest:__dcg_shared_module_exports__['C']},hints:r=>r===0?E0e:r<3?I0e:M0e},output:({inputs:r,isCommitting:e})=>((e||__dcg_shared_module_exports__['db'](r[r.length-1],r[r.length-2]))&&(r=r.slice(0,-1)),[{type:"polygon",hidden:!1,parents:r.map((t,o)=>o)}]),canCommit:r=>{if(r.length<2)return!1;let e=r[r.length-1],t=r[r.length-2],o=r[0];return __dcg_shared_module_exports__['db'](e,o)||__dcg_shared_module_exports__['db'](e,t)}}]},IC=class extends Lr{constructor(t){super(t,D0e);this.model=t}};var A0e="graphing-calculator-text-geometry-tool-ray-hint-start",L0e="graphing-calculator-text-geometry-tool-ray-hint-end",P0e={name:"ray",displayNameKey:"graphing-calculator-text-geometry-tool-ray-display-name",toolType:"simple",icon:[{type:"stroked-path",path:[78,22,32,68],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['C']],hints:[A0e,L0e]},output:[{type:"ray",parents:[0,1]}]}]},MC=class extends Lr{constructor(t){super(t,P0e);this.model=t}};var Coe="graphing-calculator-text-geometry-tool-reflection-hint-choose-line",DC=class extends Ed{constructor(t){super(t);this.model=t;this.displayNameKey="graphing-calculator-text-geometry-tool-reflect-display-name",this.toolName="reflection",this.toolType="transformation"}getExpressionEditHint(t){return this.s(Coe)}getSpec(){return{inputs:[{type:"straight",id:"1",hint:Coe}],outputs:[{id:"2",type:"reflect",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"}]}]}}};var G0e="graphing-calculator-text-geometry-tool-segment-hint-start",V0e="graphing-calculator-text-geometry-tool-segment-hint-end",O0e={name:"segment",displayNameKey:"graphing-calculator-text-geometry-tool-segment-display-name",toolType:"simple",icon:[{type:"stroked-path",path:[68,32,32,68],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}],workflows:[{input:{broadcast:!0,types:[__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['C']],hints:[G0e,V0e]},output:[{type:"segment",parents:[0,1]}]}]},AC=class extends Lr{constructor(t){super(t,O0e);this.model=t}};var LC=class{constructor(){this.displayNameKey="graphing-calculator-text-geometry-tool-selection-display-name";this.toolType="selection";this.icon=[{type:"filled-polygon",color:"#000",path:[40,30,58,46,51,47,56,60,53,62,47,49,41,54,40,30]}]}getNumberInputLatex(){return""}clearTentativeOutputs(){}canNextInputBePoint(){return!1}getAllValidNextInputTypes(){return __dcg_shared_module_exports__['na'].filter(e=>this.isValidNextInputType(e))}isValidNextInputType(e){return e!==__dcg_shared_module_exports__['W']}getNonPointInputType(){}getHint(){return""}getExpressionEditHint(e){return this.getHint()}onNumberInput(e){}onMove(e){return!0}onFocus(e){}tryCommitResults(){return{committed:void 0}}shouldUseJitEdges(){return!1}shouldHighlightRelevantObjects(){return!1}};var rB="graphing-calculator-text-geometry-tool-translation-hint-from-with-vector",Toe="graphing-calculator-text-geometry-tool-translation-hint-to",PC=class extends Ed{constructor(t){super(t);this.model=t;this.displayNameKey="graphing-calculator-text-geometry-tool-translate-display-name",this.toolName="translation",this.toolType="transformation"}getExpressionEditHint(t){return t===0?this.s(rB):this.s(Toe)}firstInputIsVector(){let{idMap:t}=this.model.getNonObjectsState().ui.currentTool,o=t[1],i=o&&this.model.findDefsForInputId(o)[0];return i&&i.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Y']}getSpec(){return this.firstInputIsVector()?{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['Y']],id:"1",hint:rB}],outputs:[{id:"3",type:"translate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"}]}]}:{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['C'],__dcg_shared_module_exports__['Y']],id:"1",hint:rB},{type:"point",id:"2",hint:Toe}],outputs:[{id:"3",type:"translate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var R0e={selection:LC,point:EC,line:kC,segment:AC,ray:MC,vector:u_,circle:xC,arc:yC,parallel:CC,perpendicular:TC,midpoint:_C,polygon:IC,compass:vC,angle:fC,directedangle:SC,reflect:DC,translate:PC,rotate:iy,dilate:wC,anglebisector:bC,"box-selection":ty,"expression-edit":Xm},oB=R0e;var F0e=!0,N0e=!1,Ioe="**dcg_geo_tool_output_slider**";function U0e(){return{point:__dcg_shared_module_exports__['zd'].PURPLE,line:__dcg_shared_module_exports__['zd'].BLUE,circle:__dcg_shared_module_exports__['zd'].GREEN,polygon:__dcg_shared_module_exports__['zd'].BLUE,angle:__dcg_shared_module_exports__['zd'].BLACK}}function Y0e(r,e){let t=[],o=r.parents;for(let i=0;i<o.length;i++){let n=o[i];n.type==="hardcoded"?t[i]=n.id:t[i]=e[n.id]}return t}var GC=class{constructor(e){this.availableInputTypes=new Set;this._nextObjectId=0;this.clear(),this.controller=e,this.s=this.controller.s,this._tools={};for(let t in oB)this._tools[t]=new oB[t](this)}onPreviewChange(){var n;let e=this.controller.getToolPreviewJSONState(),t=this.getUncommittedObjects();if(this.getCurrentTool()instanceof Xm&&!this.controller.getValidCursorContext()){t={...t};for(let a in e){let s=e[a];s.type==="expression-edit-preview-latex"&&(t[a]=s)}}let i=this.getNonObjectsState().ui.currentTool.lockedIds;for(let a in t){let s=t[a];s.type==="polygon-segment"&&(!i[a]||Object.keys(t).some(c=>!i[c]&&t[c].parents.includes(a)))&&(t[a]={...s,showAsSepratePreviewObject:!0})}__dcg_shared_module_exports__['db'](e,t)?this.controller.dispatch({type:"render"}):this.controller.dispatch({type:"set-tool-preview-state",state:t}),(n=this.controller.get2dPOIController())==null||n.updateGeoHoveredObjects()}peekNextObjectId(){return"\\token{"+this._nextObjectId.toString()+"}"}generateObjectId(){let e=this.peekNextObjectId();return this._nextObjectId+=1,e}updateNextObjectId(e){e>this._nextObjectId&&(this._nextObjectId=e)}clear(){let e={objects:{},ui:{currentTool:{name:"selection",idMap:{},reusableInputIdMap:{},lockedIds:{},inputIndex:0,outputHistory:{},forceSingleUse:!1},colors:U0e(),clickToInsertMode:"valid-type"},hoveredObjects:[],uncommittedIds:{},selectedIds:{},nextSelectionNumber:1,fadeAnimations:{},maxAnimationEndTime:0};this.store?this.store.set(e):this.store=new Vd(e)}onFocus(e){this.clearHoveredObjects(),this.getCurrentTool().onFocus(e),this.onPreviewChange()}onMouseAction(e,t){let o=this.getCurrentTool();if(o instanceof Xm&&!this.controller.getValidCursorContext())return{committed:void 0,handled:!1};switch(this.updateNextObjectId(this.controller.findLastTokenNumber()+1),this.clearHoveredObjects(),e){case"move":return{committed:void 0,handled:o.onMove(t)};case"release":o.onMove(t);let i=o.tryCommitResults();return i.committed?{...i,handled:!0}:{committed:void 0,handled:!1}}}generatePureToolOutput(e,t){let o=this.getTool(e);if(!(o instanceof Lr))return;let i=t.map(p=>p.typedValue),n=o.getMatchingWorkflow(i);if(!n)return;let a=zU(n.firstMatch,i,!1),s={},c={};for(let p=0;p<t.length;p++)c[p]=t[p].referenceLatex;this.updateNextObjectId(this.controller.findLastTokenNumber()+1),this.generateIdsForNewToolOutputs(a);let{ui:d}=this.getNonObjectsState();for(let p of a){let u=d.currentTool.idMap[p.id];s[u]={...p,color:this.defaultColorForObject(d,p),id:u,parents:p.parents.map((g,h)=>{var b;return(b=c[h])!=null?b:""})}}return{canCommit:n.canCommit,outputs:s}}getNonObjectsState(){return{...this.store.getState(),objects:void 0}}getCurrentTool(){return this.getTool(this.getToolMode())}getTool(e){return this._tools[e]}getClickToInsertMode(){return this.store.getState().ui.clickToInsertMode}setClickToInsertMode(e){this.store.set(["ui","clickToInsertMode"],e)}defaultColorForObject(e,t){switch(t.type){case"point":case"point-reference":case"midpoint":case"glider":case"intersection":case"vector-endpoint":return e.colors.point;case"polygon-segment":return t.polygonColor||e.colors.line;case"line":case"segment":case"ray":case"vector":case"vector-copy":case"perpendicular":case"parallel":case"anglebisector":return e.colors.line;case"circle":case"compass":case"arc":return e.colors.circle;case"polygon":return e.colors.polygon;case"angle":case"polygon-angle":case"directedangle":case"polygon-directedangle":return e.colors.angle;case"dilate":case"reflect":case"rotate":case"translate":return __dcg_shared_module_exports__['zd'].GRAY;case"slider":return __dcg_shared_module_exports__['zd'].BLACK;case"expression-edit-preview-latex":return t.color||__dcg_shared_module_exports__['zd'].BLACK;default:return t}}_deselectAll(){this.store.shallowMutate(e=>{e.nextSelectionNumber=1,e.selectedIds={}})}_modifySelection(e){let t=this.getNonObjectsState().nextSelectionNumber;this.store.shallowMutate("selectedIds",o=>{for(let i in e)e[i]?o[i]||(o[i]=t,t+=1):delete o[i]}),this.store.set("nextSelectionNumber",t)}_addObjects(e){this.store.shallowMutate("objects",t=>{for(let o of e)t[o.id]=o})}_deleteObjects(e){if(!e.length)return;let t={};this.store.shallowMutate("objects",o=>{for(let i of e)t[i]=N0e,delete o[i]}),this._modifySelection(t),this.store.shallowMutate("uncommittedIds",o=>{for(let i of e)delete o[i]})}createCustomToolOutput(e){var n;this.generateIdsForNewToolOutputs(e.outputs);let{idMap:t}=this.getNonObjectsState().ui.currentTool,o=[],i=this.getNonObjectsState().ui;for(let a of e.outputs){let s;a.type==="polygon-segment"?s=a.polygonColor:s=this.defaultColorForObject(i,a);let c={...a,id:t[a.id],color:s,parents:Y0e(a,t)};o.push(c)}for(let a of e.inputs)if((n=a.numberInputInfo)!=null&&n.sliderInfo){let s=a.numberInputInfo.sliderInfo,c=t[`${a.id}-number`];if(Fa(c)){let d=Zz(c);if(d&&d in __dcg_shared_module_exports__['xc'])continue;this.controller.getItemsByIdentifier(__dcg_shared_module_exports__['wb'](c)).length||o.push({type:"slider",lhsLatex:c,rhsLatex:s.value,sliderInfo:s,id:Ioe,parents:[],hidden:!1,color:"#000"})}}this._shouldNewObjectsBeMarkedUncommitted()&&this.store.shallowMutate("uncommittedIds",a=>{for(let s of o)a[s.id]=!0}),this._addObjects(o)}_getReusableIdForCurrentInput(e){let t=this.getCurrentTool();if(!t.getSpec)return;let{inputIndex:o,reusableInputIdMap:i}=this.getNonObjectsState().ui.currentTool,a=t.getSpec().inputs[o];if(!a)return;let s=a.id;return e!==void 0&&(s+="-"+e),i[s]}_createInputObject(e,t){let o,i=this._shouldNewObjectsBeMarkedUncommitted();i?o=this._getReusableIdForCurrentInput(t)||this.generateObjectId():o=this.generateObjectId(),i&&this.store.set(["uncommittedIds",o],!0);let n=this.defaultColorForObject(this.getNonObjectsState().ui,e),a={hidden:e.type==="point"&&!!e.previewOnly,...e,id:o,color:n};return this._addObjects([a]),o}attemptLockToolInputIn(e){let{inputIndex:t,idMap:o}=this.getNonObjectsState().ui.currentTool,i=this.getCurrentTool();if(!(i instanceof Cd))return;let n=i.getSpecIdToLockIn(e,t);if(!n)return;let a=o[n];if(!a){this.getCurrentTool().canNextInputBePoint()||this.controller.dispatch({type:"select-geo-tool",tool:"selection"});return}let s=a&&this.store.getState().objects[a];if(s&&s.type==="point"&&s.previewOnly){this.controller.dispatch({type:"select-geo-tool",tool:"selection"});return}this.store.set(["ui","currentTool","inputIndex"],t+1),this.store.set(["ui","currentTool","lockedIds",a],!0);for(let c=0;c<2;c++){let d=n+"-"+c,p=o[d];p&&this.store.set(["ui","currentTool","lockedIds",p],!0)}i.didLockInput(e),this.updateFadeAnimations()}generateIdsForNewToolOutputs(e){let{idMap:t}=this.getNonObjectsState().ui.currentTool,o=!1,i={};for(let n of e)t[n.id]||(o=!0,i[n.id]=this.generateObjectId());o&&this.store.set(["ui","currentTool","idMap"],{...t,...i})}tentativelyMatchToolInput(e,t){let{currentTool:o}=this.getNonObjectsState().ui,i=o.inputIndex,n=e.inputs[i];if(!n)return;let a=n.id;this.store.set(["ui","currentTool","idMap",a],t)}storeNumberInputLatex(e,t){let{currentTool:o}=this.getNonObjectsState().ui,i=o.inputIndex,n=e.inputs[i];if(!(n!=null&&n.numberInputInfo))return;let a=n.id;this.store.set(["ui","currentTool","idMap",`${a}-number`],t)}createToolInputDependency(e,t,o){let i=this._createInputObject(e,o),{currentTool:n}=this.getNonObjectsState().ui,a=n.inputIndex,s=t.inputs[a];if(!s)throw Er("geo tool could not find input in spec",{metaData:{fnArgs:{objectDef:e,toolSpec:t,depIndex:o},localVars:{newObjectId:i,currentTool:n,inputIndex:a,input:s},toolState:this.store.getState()}}),new Error("programming error: could not find input "+a+" in spec");let c=s.id;return this.store.set(["ui","currentTool","idMap",c+"-"+o],i),i}isObjectALockedToolInput(e){return!!this.getNonObjectsState().ui.currentTool.lockedIds[e]}isDegenerateInput(e){let t=this.getCurrentTool();return t instanceof Cd?t.isDegenerateInput(e):!1}getEnabledAdditionalTools(){return moe.filter(e=>!0)}getAdditionalTools(){return this.getEnabledAdditionalTools()}isAnyAdditionalToolEnabled(){return this.getAdditionalTools().length>0}setObjectSelected(e){let t={};t[e]=F0e,this._modifySelection(t)}setObjectsSelected(e){__dcg_shared_module_exports__['Fa'](e,t=>{this.setObjectSelected(t)})}deleteSelectedObjects(){let e=this.getSelectedObjectIdsUnsorted();this._deleteObjects(e)}isObjectUncommitted(e){return!!this.getNonObjectsState().uncommittedIds[e]}getUncommittedObjectIds(){return Object.keys(this.getNonObjectsState().uncommittedIds)}getUncommittedObjects(){let e={},t=this.store.getState().objects,o=this.getUncommittedObjectIds();for(let i of o)e[i]=t[i];return e}isValidNextInputType(e){let t=this.getCurrentTool(),o=t.getNonPointInputType();return e&&__dcg_shared_module_exports__['qa'](e)&&(e=__dcg_shared_module_exports__['ra'](e)),!!(o&&e&&QA(e,o)||t.canNextInputBePoint()&&e&&QA(e,"point"))}recordCommittedOutput(e){this.store.shallowMutate(["ui","currentTool","outputHistory"],t=>{t[e]=!0})}updateFadeAnimations(){let e=this.controller.getAllItemModels(),t=Date.now(),o=-1/0;this.store.shallowMutate(["fadeAnimations"],i=>{var s,c;if(this.getCurrentTool().shouldHighlightRelevantObjects())for(let d of e){if(d.type!=="expression"||!d.latex)continue;let p=d.id,u=(s=d.formula)==null?void 0:s.geometry,g,h=u==null?void 0:u.valueType;u!=null&&u.unconstructable||this.controller.shouldIgnoreGraphInteractions(d)?g="fade-out":this.isValidNextInputType(__dcg_shared_module_exports__['C'])&&(Ly(h)||__dcg_shared_module_exports__['qa'](h)&&Ly(__dcg_shared_module_exports__['ra'](h)))||h&&__dcg_shared_module_exports__['wa'](h,__dcg_shared_module_exports__['J'])&&this.isValidNextInputType(__dcg_shared_module_exports__['K'])||this.isValidNextInputType(h)||this.store.getState().ui.currentTool.outputHistory[p]?g="fade-in":g="fade-out";let b=this.store.getState().fadeAnimations[p];if(b&&b.type!==g){let v=__dcg_shared_module_exports__['Rb'](t-b.start,0,150),T=t+v-150;i[p]={type:g,start:T},o=Math.max(o,T)}else if(g==="fade-out"){let v=(c=b==null?void 0:b.start)!=null?c:t;i[p]={type:"fade-out",start:v},o=Math.max(o,v)}}else{for(let d in i)i[d]={type:"fade-in",start:t-150};o=t-150}}),isFinite(o)&&this.store.set("maxAnimationEndTime",o+150)}getToolFadeOpacity(e){let t=this.controller.getItemModel(e);if((t==null?void 0:t.type)!=="expression")return 1;let o=this.store.getState().fadeAnimations[t.id];if(!o)return 1;let i=Date.now(),n=__dcg_shared_module_exports__['Rb']((i-o.start)/150,0,1),a=o.type==="fade-in"?.2:1,s=o.type==="fade-in"?1:.2;return a*(1-n)+s*n}updateAvailableInputTypes(){let e=this.controller.getAllItemModels();this.availableInputTypes=z0e(e)}isToolActuallyUsable(e){let t=this.getTool(e);if(t instanceof Lr){let o=t.getWorkflows();for(let i of this.availableInputTypes)if(o.some(n=>n.signature.matches([i])))return!0;return!1}return!0}isFading(){return Date.now()<=this.store.getState().maxAnimationEndTime}isObjectSelected(e){return!!this.getNonObjectsState().selectedIds[e]}getSelectedObjectIdsUnsorted(){return Object.keys(this.getNonObjectsState().selectedIds)}getSelectedObjectIdsSorted(){let e=this.getNonObjectsState().selectedIds,t=this.getSelectedObjectIdsUnsorted();return __dcg_shared_module_exports__['Pa'](t,i=>e[i])}deselectAllObjects(){this._deselectAll()}getToolMode(){return this.getNonObjectsState().ui.currentTool.name}setToolMode(e){let t=this.getToolMode(),o=this.getNonObjectsState().ui.currentTool;this.store.set(["ui","currentTool"],{name:e,idMap:{},reusableInputIdMap:{},lockedIds:{},inputIndex:0,outputHistory:e!==t?{}:o.outputHistory,forceSingleUse:e!==t?!1:o.forceSingleUse}),this.updateFadeAnimations(),e!==t&&this.controller.isGraphPaperFocused()&&(e!=="expression-edit"&&It(this.getCurrentToolDisplayName()+"."),this.speakCurrentGeoToolHint())}resetToolMode(){this.setToolMode(this.getToolMode())}markCurrentToolSingleUse(){this.store.set(["ui","currentTool","forceSingleUse"],!0)}areAnyObjectsHovered(){return!!this.getNonObjectsState().hoveredObjects.length}setObjectHovered(e){this.store.deepMutate(t=>{t.hoveredObjects.push(e)})}objectIsInstanceOf(e,t){let o=e==null?void 0:e.typedRuntimeValue.valueType;if(o)return QA(o,t)}getSelectionBox(){return this.getTool("selection").getSelectionBox()}commitObjects(){this.store.set("uncommittedIds",{}),this.store.set("objects",{})}applyTransformation(e){}getProjection(){return this.controller.get2dProjection()}_getPixelsAwayFromDef(e,t,o){let i=o.typedRuntimeValue;switch(i.valueType){case __dcg_shared_module_exports__['C']:{let a=t.mapx(i.value[0]),s=t.mapy(i.value[1]);return __dcg_shared_module_exports__['k'](e.x-a,e.y-s)-6}case __dcg_shared_module_exports__['O']:case __dcg_shared_module_exports__['K']:case __dcg_shared_module_exports__['Q']:case __dcg_shared_module_exports__['Y']:{let n,a,s,c;if(i.valueType===__dcg_shared_module_exports__['Y']){let[[g,h],[b,v]]=ny(i.value);n=t.mapx(g),s=t.mapy(h),a=t.mapx(b),c=t.mapy(v)}else n=t.mapx(i.value[0][0]),s=t.mapy(i.value[0][1]),a=t.mapx(i.value[1][0]),c=t.mapy(i.value[1][1]);let d=i.valueType===__dcg_shared_module_exports__['O'],p=i.valueType===__dcg_shared_module_exports__['O']||i.valueType===__dcg_shared_module_exports__['Q'],u=__dcg_shared_module_exports__['o'](e.x,e.y,n,s,a,c,d,p);return u?__dcg_shared_module_exports__['k'](u[0]-e.x,u[1]-e.y):1/0}case __dcg_shared_module_exports__['M']:{let n=i.value[0][0],a=i.value[0][1],s=i.value[1],c=0,d=Math.PI*2,p=t.reverse_mapx(e.x),u=t.reverse_mapy(e.y),g=__dcg_shared_module_exports__['p'](p,u,n,a,s,c,d);return g?t.screen.width/(t.viewport.xmax-t.viewport.xmin)*__dcg_shared_module_exports__['k'](g[0]-p,g[1]-u):1/0}case __dcg_shared_module_exports__['N']:{let n=__dcg_shared_module_exports__['cc'](i.value);if(!n)return 1/0;let a=(s,c,d,p)=>{let u=t.mapx(s[0]),g=t.mapy(s[1]),h=t.mapx(c[0]),b=t.mapy(c[1]),v=__dcg_shared_module_exports__['o'](e.x,e.y,u,g,h,b,d,p);return v?__dcg_shared_module_exports__['k'](v[0]-e.x,v[1]-e.y):1/0};if(n.type==="arc"){let s=t.reverse_mapx(e.x),c=t.reverse_mapy(e.y),d=__dcg_shared_module_exports__['p'](s,c,n.center[0],n.center[1],n.radius,n.startAngle,n.endAngle);return d?t.screen.width/(t.viewport.xmax-t.viewport.xmin)*__dcg_shared_module_exports__['k'](d[0]-s,d[1]-c):1/0}else return n.type==="segment"?a(n.start,n.end,!1,!1):Math.min(a(n.start1,n.end1,!1,!0),a(n.start2,n.end2,!1,!0))}case __dcg_shared_module_exports__['J']:{let n=[];return i.value.forEach(a=>{n.push(t.mapx(a[0]),t.mapy(a[1]))}),__dcg_shared_module_exports__['v'](n,[e.x,e.y])?0:1/0}case __dcg_shared_module_exports__['S']:case __dcg_shared_module_exports__['U']:{let n=t.screen.width/(t.viewport.xmax-t.viewport.xmin),a=t.screen.height/(t.viewport.ymax-t.viewport.ymin),[[s,c],d,p]=i.value,u=tm(p,t),g=u/n,h=t.reverse_mapx(e.x),b=t.reverse_mapy(e.y),v=1/0,T=b-c,E=h-s,I=Math.atan2(T,E);if(__dcg_shared_module_exports__['i'](I,d,p))__dcg_shared_module_exports__['k'](T*a,E*n)<=u+7&&(v=0);else{let _=__dcg_shared_module_exports__['n'](h,b,s+g*Math.cos(d),c+g*Math.sin(d),s,c),C=__dcg_shared_module_exports__['n'](h,b,s+g*Math.cos(d+p),c+g*Math.sin(d+p),s,c),D=__dcg_shared_module_exports__['k'](n*(_[0]-h),a*(_[1]-b)),P=__dcg_shared_module_exports__['k'](n*(C[0]-h),a*(C[1]-b));v=Math.min(D,P)}return v}case __dcg_shared_module_exports__['W']:return 1/0;default:return 1/0}}getAllChoosableDefsUnordered(e,t){var h;if(!this.controller.isGeometry())return[];let o=[],i=e.mode==="tab",n=e.mode==="mouse",a=this.controller.get2dPOIController().findIdsThatAreOnscreen(),s=i&&this.controller.getActiveTool()==="box-selection",c=!1,d=!1;(h=t.isValidNextInputType)!=null&&h.call(t,__dcg_shared_module_exports__['C'])&&(c=!0),t.shouldUseJitEdges()&&(t.isValidNextInputType(__dcg_shared_module_exports__['K'])||t.isValidNextInputType(__dcg_shared_module_exports__['O'])||t.isValidNextInputType(__dcg_shared_module_exports__['Q']))&&(d=!0);let p=n&&c;p&&(d=!0);let{lockedIds:u,reusableInputIdMap:g}=this.store.getState().ui.currentTool;return $b({controller:this.controller},(b,v)=>{var E,I;if(!b.isGraphableAndInteractive)return;let T=b.assignment;for(let _ in g)if(g[_]===T&&!u[T])return;if(!b.hidden&&!b.data.unconstructable&&!(this.getToolMode()==="expression-edit"&&((E=b.data)!=null&&E.depends_on_selected))&&!(s&&this.controller.isClickableId(b.calcId))&&!(i&&this.isDegenerateInput(b==null?void 0:b.assignment))&&!(i&&v)&&!(i&&!a[b.calcId])){if(b.typedRuntimeValue.valueType===__dcg_shared_module_exports__['J'])if(b.typedRuntimeValue.value.length){if(d){let _=b;if(_.typedRuntimeValue.valueType===__dcg_shared_module_exports__['J']){let C=_.typedRuntimeValue.value;for(let D=0;D<C.length;D++){let P=C[D],F=C[(D+1)%C.length],N=_.referenceLatex+".\\operatorname{segments}\\left["+(D+1)+"\\right]",Y={calcId:_.calcId,listIndex:_.listIndex,hidden:_.hidden,isGraphableAndInteractive:!1,assignment:N,referenceLatex:N,data:_.data,typedRuntimeValue:{valueType:__dcg_shared_module_exports__['K'],value:[P,F]},polygonEdgeInfo:{edgeNumber:D,polygonDef:_}};o.push(Y)}}}}else return;if(p&&!__dcg_shared_module_exports__['wa'](b.typedRuntimeValue.valueType,__dcg_shared_module_exports__['J'])){o.push(b);return}if((I=t.isValidNextInputType)!=null&&I.call(t,b.typedRuntimeValue.valueType)){o.push(b);return}}}),o}_getObjectsUnderMouse(e,t,o){let i=this.getAllChoosableDefsUnordered({mode:"mouse"},o),n=this.getProjection(),a=[];i.forEach(d=>{let p=this._getPixelsAwayFromDef(e,n,d),u=d.polygonEdgeInfo?-1:0;if(p<=t){let g={def:d,layerNumber:u,pixelsAway:p};a.push(g)}});let s=this.controller.get2dSketchOrder(),c={};for(let d=0;d<s.length;d++)c[s[d]]=d;return a.sort((d,p)=>{let u=p.layerNumber-d.layerNumber;if(u!==0)return u;let g=d.pixelsAway-p.pixelsAway;if(g!==0)return g;let h=c[d.def.calcId];return c[p.def.calcId]-h}),a}convertCanvasPixelsToPoint(e){return this.getProjection().reverse_map_pt(e)}convertPointToCanvasPixels(e){return this.getProjection().map_pt(e)}deleteObjectsAndRememberReusableId(e){for(let t in e)this._deleteObjects([e[t]]);this._deleteObjects([Ioe]),this.store.shallowMutate(["ui","currentTool"],t=>t.reusableInputIdMap=e)}getObjectDefUnderMouse(e,t,o){let i=this.convertPointToCanvasPixels(e),n=this._getObjectsUnderMouse(i,t,o);return n.length>0?n[0].def:void 0}getOrCreatePointNearMouse(e,t){let o=this.convertPointToCanvasPixels(e),i=this._getObjectsUnderMouse(o,t,this.getCurrentTool()),n=[];for(let g of i){let h=g.def,{valueType:b}=h.typedRuntimeValue;b===__dcg_shared_module_exports__['C']?n.push({def:h,type:b}):(Ly(b)||b===__dcg_shared_module_exports__['Y'])&&n.push({def:h,type:b})}let{def:a,type:s}=n[0]||{},{def:c,type:d}=n[1]||{},p=this.controller.isGeoToolEnabled("point");if(s===__dcg_shared_module_exports__['C'])return{type:"def",def:a};if(Ly(s)&&Ly(d)){let g=voe(a,c).map(h=>({x:h.x,y:h.y,i:h.i,pixelsFromPoint:Moe(this.getProjection(),Xg(h.x-e.x,h.y-e.y))}));if(g.sort((h,b)=>h.pixelsFromPoint-b.pixelsFromPoint),g=g.filter(h=>h.pixelsFromPoint<5),g[0]){let h=g[0].i===0?[a,c]:[c,a],b=this.findIncidentPointDef(a,c);if(b!=null&&b.hidden){let v=!1,T;if(BU(b.typedRuntimeValue,(E,I)=>{let[_,C]=E.value,D=this.getProjection().mathToPixels.mapPoint({x:_,y:C});Xg(D.x-o.x,D.y-o.y)<t&&(v=!0,T=I)}),v)return T!==void 0&&(b=KU(b,T)),{type:"spec",spec:{type:"point-reference",targetSpec:{type:"intersection",parentDefs:h},parentDefs:[b]}}}return{type:"spec",spec:{type:"intersection",parentDefs:h}}}else if(p)return Doe(this.getProjection(),e,a)}else{if(p&&Ly(s))return Doe(this.getProjection(),e,a);if(s===__dcg_shared_module_exports__['Y']){let h=ny(a.typedRuntimeValue.value).map((b,v)=>({index:v,point:{x:b[0],y:b[1]},pixelsFromPoint:Moe(this.getProjection(),Xg(b[0]-e.x,b[1]-e.y))})).sort((b,v)=>b.pixelsFromPoint-v.pixelsFromPoint).filter(b=>b.pixelsFromPoint<5);if(h.length>0)return K0e(a,h[0].index===1?1:0)}}let u=B0e(this.getProjection(),e);return{type:"spec",spec:{type:"point",x:u.x,y:u.y,parentDefs:[],previewOnly:!p}}}findIncidentPointDef(e,t){let o=e.typedRuntimeValue.valueType,i=t.typedRuntimeValue.valueType,n={};$b({controller:this.controller,expandLists:!1},c=>{if(c.data.identifier&&__dcg_shared_module_exports__['wa'](c.typedRuntimeValue.valueType,__dcg_shared_module_exports__['C'])){let d=c.data.identifier;n[d]=c}});let a=__dcg_shared_module_exports__['Qc']({getGeometryTree:c=>c.data.call,isPointOrListOfPoints:c=>__dcg_shared_module_exports__['wa'](c.typedRuntimeValue.valueType,__dcg_shared_module_exports__['C']),lookup:c=>n[c],resolvesTo:(c,d)=>c===d.data.identifier},e,o,t,i),s=a&&__dcg_shared_module_exports__['Oc'](a);if(s){let c=n[s],d=a&&__dcg_shared_module_exports__['Nc'](a);return d===void 0?c:KU(c,d)}}_shouldNewObjectsBeMarkedUncommitted(){return this.getToolMode()!=="selection"}clearHoveredObjects(){this.store.set("hoveredObjects",[])}getHoveredItems(){return this.store.getState().hoveredObjects}cancelToolplay(){this._deleteObjects(this.getUncommittedObjectIds()),this.clearHoveredObjects(),this.resetToolMode()}isToolplayActive(){return this.getNonObjectsState().ui.currentTool.inputIndex>0}getComputedBoard(){let e=new mC;return $b({controller:this.controller},(t,o)=>{e.add(t,o)}),e}findDefsForInputId(e){let t=[];return $b({controller:this.controller},o=>{(o.assignment===e||o.referenceLatex===e)&&t.push(o)}),t}isCreatingNewTransform(){return this.getCurrentTool().toolType==="transformation"}getCurrentToolDisplayName(){return this.controller.s(this.getCurrentTool().displayNameKey)}isCurrentToolComplex(){return this.getCurrentTool().toolType==="complex"}isCurrentToolSingleUse(){return this.getCurrentTool().toolType==="transformation"||this.getNonObjectsState().ui.currentTool.forceSingleUse}getIconInstructionsForTool(e){let t=this.getTool(e);return t?t.icon:[]}getDisplayNameForTool(e){var t;return this.controller.s((t=this.getTool(e))==null?void 0:t.displayNameKey)||""}speakCurrentGeoToolHint(){_e(this.getCurrentTool().getHint())}};function B0e(r,e){let t=zY(r,e);t&&(e=t);let o=.5/Aoe(r);return{x:no(e.x-o,e.x+o),y:no(e.y-o,e.y+o)}}function Aoe(r){return r.mapx(1)-r.mapx(0)}function Moe(r,e){return Aoe(r)*e-6}function Doe(r,e,t){return{type:"spec",spec:{type:"glider",t:rV(r,e,t.typedRuntimeValue),parentDefs:[t]}}}function K0e(r,e){return{type:"spec",spec:{type:"vector-endpoint",location:e?"end":"start",parentDefs:[r]}}}function z0e(r){let e=new Set;e.add(__dcg_shared_module_exports__['C']);for(let t of r){if(t.type!=="expression"||!t.formula.typed_constant_value||t.hidden)continue;let o=t.formula.typed_constant_value.valueType,i=__dcg_shared_module_exports__['qa'](o)?__dcg_shared_module_exports__['ra'](o):o;__dcg_shared_module_exports__['ta'](i)&&e.add(i),i===__dcg_shared_module_exports__['J']&&e.add(__dcg_shared_module_exports__['K'])}return e}function Loe(r,e,t){let o=r.getItemModel(e);if(!o||o.type!=="table")return;let i=o,n=gs(i),a=n?n.row:-1,s=n?n.column:-1,c=i.columnModels,d=Xn(i),p=c.length,u=(v,T)=>{v===-1?sV(r):v>d?lV(r):(T===-1?(T=p-1,v--):T===p&&(v++,T=0),z1(r,e,{row:v,column:T}))},g=v=>{d>2&&Vq(i,a-1),z1(r,e,{row:v,column:s})},h=v=>{s===0||p<=2||(y0(i,s),z1(r,e,{row:a,column:v}))},b=!!tv(i.columnModels[0]);switch(t){case"Left":u(a,s-1);break;case"Right":u(a,s+1);break;case"Up":u(a-1,s);break;case"Down":u(a+1,s);break;case"PageUp":return sV(r);case"PageDown":return lV(r);case"Enter":if(a>=d)return aB(r);if(s>0||b)return u(a+1,s);if(a===d-1){let v=Oq(i,a);fF(i,a);for(let T=0;T<v.length;T++)Cg(i,{row:a+1,column:T},v[T]);z1(r,e,{row:a+1,column:s});return}fF(i,a),z1(r,e,{row:a+1,column:s});break;case"Backspace":a===0?s===0?iB(r):s===p-1||s===1&&p===3?u(0,s-1):h(s-1):s!==0?u(a,s-1):a===d||b?u(a-1,s):g(a-1);break;case"Delete":a===0?s===0?nB(r):s<p-1&&h(s):a>=d||b||g(a);break}}function sV(r){if(r.inAudioTraceMode())return;let e=r.getFocusLocation(),t=r.getListModel();if((e==null?void 0:e.type)==="ticker"&&r.getExpressionSearchOpen())return Rr(r,{type:"search-expressions"});let o=r.getSelectedItem();if(!o)return;if(mM(t)){if(o=r.getSelectedItem(),!o)return;ko(r,o.id,r.isInEditListMode()&&o.type==="table"?"container":"end")}else r.getTickerVisible()?Rr(r,{type:"ticker",location:"handler"}):r.getExpressionSearchOpen()&&Rr(r,{type:"search-expressions"})}function lV(r){if(r.inAudioTraceMode())return;let e=r.getFocusLocation(),t=r.getListModel();if((e==null?void 0:e.type)==="search-expressions"&&r.getTickerVisible())return Rr(r,{type:"ticker",location:"handler"});if((e==null?void 0:e.type)==="ticker"||(e==null?void 0:e.type)==="search-expressions"){let i=Sv(t);if(i)return ko(r,i.id,r.isInEditListMode()&&i.type==="table"?"container":"start")}if(!fM(t)&&!r.isInEditListMode()){let i=r.createItemModel({type:"expression",id:r.generateId(),color:r.getNextColor()});Dl(t,i),Ir(t,i)}let o=r.getSelectedItem();if(o)return ko(r,o.id,r.isInEditListMode()&&o.type==="table"?"container":"start")}function iB(r){if(r.isInEditListMode())return;let e=r.getSelectedItem();if(!e||r.getItemCount()===1&&e.type==="expression")return;let t=e.type==="text",o=Ua(e);if(o){let i=r.getNumberOfItemsInFolder(o.id);if(e.index===o.index+i){In(e,"");return}}if(sB(r,{moveSelection:!0}),t&&ha&&Uu){Ir(r.getListModel(),void 0);return}e=r.getSelectedItem(),e&&ko(r,e.id,"end")}function nB(r){if(r.isInEditListMode())return;let e=r.getSelectedItem();e&&(r.getItemCount()===1&&e.type==="expression"||(lB(r,{moveSelection:!0}),e=r.getSelectedItem(),e&&ko(r,e.id,"start")))}function aB(r){if(r.isInEditListMode())return;let e=r.getSelectedItem();if(!e)return;if(e.type==="text"&&ha&&Uu){Dr(),Ir(r.getListModel(),void 0);return}if(e.type==="expression"&&th(e).length>0)return r.createSlidersForItem(e.id,th(e).concat(""));let t=K0(e);if(t.length>0&&t.length<=yp&&r.areSlidersEnabled())return r.createSlidersForItem(e.id,K0(e).concat(""));let o=r.createItemModel({type:"expression",id:r.generateId(),color:r.getNextColor()}),i=e.index+1;e.type==="folder"&&e.collapsed&&(i+=r.getNumberOfItemsInFolder(e.id)),cn(r.getListModel(),o,i),Ir(r.getListModel(),o),e.type==="folder"&&!e.collapsed?In(o,e.id):e.type!=="folder"&&e.folderId&&In(o,e.folderId),e=r.getSelectedItem(),e&&ko(r,e.id)}function sB(r,{moveSelection:e}){let t=r.getSelectedItem(),o=r.getListModel();if(!t||r.isItemReadonly(t.id))return;let i=R0(o,t.index);if(r._removeExpressionSynchronously(t),e){if(!i){let n=Sv(o);n&&(i=n)}Ir(o,i)}else Ir(o,void 0)}function lB(r,{moveSelection:e}){let t=r.getSelectedItem(),o=r.getListModel();if(!t||r.isItemReadonly(t.id))return;let i=F0(o,t.index);if(r._removeExpressionSynchronously(t),e){if(!i){let n=aM(o);n&&(i=n)}Ir(o,i)}else Ir(o,void 0)}Ut();var H0e={loga:(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"\\log_{}\\left(\\right)")&&(r.write("\\log_{}"),r.typedText("("),r.keystroke("Left"),r.keystroke("Down"))},nthroot:(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"\\sqrt[]{}")&&(r.write("\\sqrt[]{}"),r.keystroke("Left"),r.keystroke("Left"))},ddx:(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"\\frac{d}{dx}")&&r.write("\\frac{d}{dx}")},arcsin:(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"\\sin^{-1}\\left(\\right)")&&(r.write("sin^{-1}"),r.typedText("("))},arccos:(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"\\cos^{-1}\\left(\\right)")&&(r.write("cos^{-1}"),r.typedText("("))},arctan:(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"\\tan^{-1}\\left(\\right)")&&(r.write("tan^{-1}"),r.typedText("("))},arcsec:(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"\\sec^{-1}\\left(\\right)")&&(r.write("sec^{-1}"),r.typedText("("))},arccsc:(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"\\csc^{-1}\\left(\\right)")&&(r.write("csc^{-1}"),r.typedText("("))},arccot:(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"\\cot^{-1}\\left(\\right)")&&(r.write("cot^{-1}"),r.typedText("("))},"A^T":(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"^{T}")&&(r.typedText("^T"),r.keystroke("Right"))},"A^-1":(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"^{-1}")&&(r.typedText("^-1"),r.keystroke("Right"))},"A^2":(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"^{2}")&&(r.typedText("^2"),r.keystroke("Right"))},"a^2":(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"^{2}")&&(r.typedText("^2"),r.keystroke("Right"))},"a^3":(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"^{3}")&&(r.typedText("^3"),r.keystroke("Right"))},"a/b":(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"\\frac{}{}")&&(r.write("\\frac{}{}"),r.keystroke("Left"))},integral:(r,e)=>{Qe.canAcceptText(r,e.capExpressionSize,"\\int_{}^{}")&&r.cmd("integral")}};function cV(r,e,t){H0e[e](r,t)}var cB=r=>({value:r.degreeMode?"30":"0.5",min:"0",max:r.degreeMode?"360":"2\\pi"}),Goe={min:"0",max:"5",value:"1"},Jw=r=>({min:"0",max:"1",value:`${r}`}),W0e={latex:void 0,polarDomainMin:void 0,polarDomainMax:void 0,parametricDomainMin:void 0,parametricDomainMax:void 0,parametricDomain3DuMin:void 0,parametricDomain3DuMax:void 0,parametricDomain3DvMin:void 0,parametricDomain3DvMax:void 0,parametricDomain3DrMin:void 0,parametricDomain3DrMax:void 0,parametricDomain3DphiMin:void 0,parametricDomain3DphiMax:void 0,clickableInfoLatex:void 0,colorLatex:void 0,tableColumnColorLatex:void 0,cdfMin:()=>({value:"0",min:"-10",max:"10"}),cdfMax:()=>({value:"0",min:"-10",max:"10"}),cdfP:()=>({value:"0.5",min:"0",max:"1"}),pointSize:()=>({value:8+"",min:"0",max:"20"}),movablePointSize:()=>({value:8+"",min:"0",max:"20"}),tableColumnPointSize:()=>({value:8+"",min:"0",max:"20"}),labelAngle:cB,labelSize:()=>({value:"1",min:"0",max:"5"}),lineWidth:()=>({value:2.5+"",min:"0",max:"10"}),resolution:()=>({value:"50",min:"2",max:"100",step:"1"}),tableColumnLineWidth:()=>({value:2.5+"",min:"0",max:"10"}),fillOpacity:()=>({value:.4+"",min:"0",max:"1"}),surfaceOpacity:()=>({value:"0.9",min:"0",max:"1"}),lineOpacity:()=>({value:1+"",min:"0",max:"1"}),tableColumnLineOpacity:()=>Jw(1),pointOpacity:()=>Jw(1),tableColumnPointOpacity:()=>Jw(1),sliderMin:void 0,sliderMax:void 0,sliderStep:void 0,residualVariable:void 0,tableHeader:void 0,tableCellValue:void 0,imageOpacity:()=>({value:"1",min:"0",max:"1"}),imageCenter:void 0,imageHeight:()=>({value:"10",min:"-10",max:"10"}),imageWidth:()=>({value:"10",min:"-10",max:"10"}),imageAngle:cB,tickerMinStep:()=>({value:"0",min:"0"}),tickerHandler:void 0,inferenceHypothesis:()=>({value:"0.5",min:"0",max:"1"}),inferenceConfidenceLevel:()=>({value:"0.95",min:"0",max:"1",step:"0.01"})},Voe={tone:{paramBounds:r=>r===0?{value:"440",min:"110",max:"880"}:Jw(.5)},glider:{paramBounds:r=>{if(r!==0)return Jw(.5)}},dilate:{paramBounds:r=>{if(!(r<2))return{value:"2",min:"0",max:"5"}}},rotate:{paramBounds:(r,e)=>{if(!(r<2))return cB(e)}},circle:{paramBounds:r=>{if(r===1)return Goe}},normaldist:{paramBounds:r=>{if(r===0)return{min:"-5",max:"5",value:"0"};if(r===1)return Goe}},binomialdist:{paramBounds:r=>{if(r===0)return{min:"0",max:"10",step:"1",value:"5"};if(r===1)return{min:"0",max:"1",value:"0.5"}}},quantile:{paramBounds:()=>({min:"0",max:"1",value:"0.5"})},rgb:{paramBounds:r=>({value:"0",min:"0",max:"255",step:"1"})},hsv:{paramBounds:r=>r===0?{value:"0",min:"0",max:"360",step:"1"}:Jw(.5)}};function Ooe(r,e,t){let o=r.map(n=>({location:n.location,parsed:__dcg_shared_module_exports__['xe'](n.latex,{isNewStatsEnabled:t.isNewStatsEnabled})})),i={};for(let n of e)for(let a of o){let s;if(a.location==="inferenceHypothesis"){let c;for(let d of o)if(d.location==="latex"){c=d.parsed;break}c!==void 0&&(s=j0e(n,a.parsed,c))}else s=X0e(n,a,t);s&&s.length&&(i[n]=s[0])}return i}function j0e(r,e,t){let o;if(t.type==="Assignment"&&(t=t._expression),t.type==="FunctionCall")switch(t._symbol){case"ttest":case"ztest":o={value:"0",min:"-10",max:"10"};break;case"zproptest":t.args.length===2&&(o={value:"0.5",min:"0",max:"1"}),t.args.length===4&&(o={value:"0",min:"-1",max:"1"});break}if(o===void 0)return;let i=__dcg_shared_module_exports__['wb'](r);if(e.type==="Identifier"&&e._symbol===i)return[o]}function X0e(r,{parsed:e,location:t},o){let i=__dcg_shared_module_exports__['wb'](r);if(e.type==="Identifier"&&e._symbol===i){let a=W0e[t];return a?[a(o)]:void 0}e.type==="Assignment"&&(e=e._expression);let n=[];switch(e.type==="DotAccess"&&(e=e.args[1]),e.type){case"FunctionCall":{let a=e._symbol;if(Voe.hasOwnProperty(a)){let s=Voe[a];e.args.forEach((c,d)=>{if(c.type==="Identifier"&&c._symbol===i){let p=s.paramBounds(d,o);p&&n.push(p)}})}break}default:return}return n}var zh=class r{constructor(e=100){this.clear(),this._sizeLimit=e}clone(){let e=new r(this._sizeLimit);return e._stack=this._stack.slice(),e._stackPointer=this._stackPointer,e}clear(){this._stack=[],this._stackPointer=-1}getState(){return this._stack[this._stackPointer]}serializeForBugsnag(){function e(t){try{return JSON.stringify(t,null,2)}catch(o){return"[[could not jsonify]]"}}return{currentState:e(this._stack[this._stackPointer]),undoState:e(this._stack[this._stackPointer-1]),redoState:e(this._stack[this._stackPointer+1])}}addState(e){this.canRedo()&&this._stack.splice(this._stackPointer+1),this._stack.push(e),this._stack.length>this._sizeLimit&&this._stack.shift(),this._stackPointer=this._stack.length-1}replaceState(e){this.canRedo()&&this._stack.splice(this._stackPointer+1),this.replaceInteriorState(e)}replaceInteriorState(e){this._stack.length===0?(this._stack.push(e),this._stackPointer=0):this._stack[this._stackPointer]=e}canUndo(){return this._stackPointer>0}canRedo(){return this._stackPointer<this._stack.length-1}undo(){this.canUndo()&&(this._stackPointer-=1)}redo(){this.canRedo()&&(this._stackPointer+=1)}};function J0e(r){switch(r){case"histogram":case"dotplot":return 12;case"boxplot":return 40}return 1/0}function Z0e(r){return r==="boxplot"||r==="dotplot"||r=="histogram"}function Q0e(r){return r==="boxplot"?3:.5}function eke(r,e){if(r.type==="dotplot"||r.type==="histogram"){let i=Math.max(1,r.xmax-r.xmin)*80/(r.binWidth?r.binWidth:1),n=.5*(e.screen.width-i)/i;return Math.max(.2,n)}return .5}function tke(r,e,t){r=__dcg_shared_module_exports__['f'](r);let o=1.2;return e&&r.xmax<0&&r.xmin<0&&r.xmax/(r.xmin-r.xmax)<o&&(r.xmax=0),e&&r.xmax>0&&r.xmin>0&&r.xmin/(r.xmax-r.xmin)<o&&(r.xmin=0),t&&r.ymax<0&&r.ymin<0&&r.ymax/(r.ymin-r.ymax)<o&&(r.ymax=0),t&&r.ymax>0&&r.ymin>0&&r.ymin/(r.ymax-r.ymin)<o&&(r.ymin=0),r}function rke(r,e,t,o){let i=r.type,n=eke(r,e),a=Q0e(i),s,c,d,p;if(r.xmin===r.xmax&&(t?(r.xmin-=.5,r.xmax+=.5):(r.xmin*=.5,r.xmax/=.5)),r.ymin===r.ymax&&(o?(r.ymin-=.5,r.ymax+=.5):(r.ymin*=.5,r.ymax/=.5)),t){let u=(r.xmax-r.xmin)*n;s=r.xmin-u,c=r.xmax+u}else{let u=(r.xmax/r.xmin)**n;s=r.xmin/u,c=r.xmax*u}if(o){let u=(r.ymax-r.ymin)*a;d=r.ymin-u,p=r.ymax+u}else{let u=(r.ymax/r.ymin)**a;d=r.ymin/u,p=r.ymax*u}if(Z0e(i)){let u=e.screen.height/e.screen.width,g=(c-s)*u;if(g>r.ymax-r.ymin&&g<J0e(i)*(r.ymax-r.ymin)){let h=.5*(r.ymax+r.ymin);p=h+.5*g,d=h-.5*g}}return{xmin:s,xmax:c,ymin:d,ymax:p}}function dV(r,e){let t=VC(r,e);if(!t)return!1;let{xAxisScale:o,yAxisScale:i}=e.settings;if(!Or.fromObject(t).isValid({xAxisScale:o,yAxisScale:i}))return!1;let a=e.mapx(t.xmin),s=e.mapx(t.xmax),c=e.mapy(t.ymin),d=e.mapy(t.ymax),p=10;return!(Math.abs(a)<=p&&Math.abs(d)<=p&&Math.abs(s-e.screen.width)<=p&&Math.abs(c-e.screen.height)<=p)}function VC(r,e){let t=1/0,o=-1/0,i=1/0,n=-1/0,a=0,s=r.length,c=e.settings.xAxisScale==="linear",d=e.settings.yAxisScale==="linear";for(let p=0;p<s;p++){let u=tke(r[p],c,d);if(!isFinite(u.xmax-u.xmin)||!isFinite(u.ymax-u.ymin)){a+=1;continue}if(!c&&!(u.xmax>0&&u.xmin>0)||!d&&!(u.ymax>0&&u.ymin>0)){a+=1;continue}let g=rke(u,e,c,d);g.xmin<t&&(t=g.xmin),g.xmax>o&&(o=g.xmax),g.ymin<i&&(i=g.ymin),g.ymax>n&&(n=g.ymax)}if(a!==s)return{xmin:t,xmax:o,ymin:i,ymax:n}}function oke(r){var o,i;let e=r&&r.id,t=[];if(r&&r.type==="table"){r.columnModels.forEach(a=>{t.push(a.id)}),(o=r.regression)!=null&&o.id&&t.push(r.regression.id);let n=gs(r);if(!n){let a=r.controller.getFocusLocation();if((a==null?void 0:a.type)==="table-icon"){let s=r.columnModels.findIndex(c=>c.id===a.columnId);s>=0&&(n={row:0,column:s})}}if(n){let a=r.columnModels[n.column];e=a?a.id:void 0}else e=(i=r.regression)==null?void 0:i.id;return{selected:e?[e]:[],hoistedToTop:t}}return e?{selected:[e],hoistedToTop:[e]}:{selected:[],hoistedToTop:[]}}function Roe(r,e,t){let o={},i={},n=r.getAllSelectedItems();for(let a of n){let s=oke(a);for(let c of s.selected)o[c]=!0,t.selected[c]||e.selectSketch(c);for(let c of s.hoistedToTop)i[c]=!0,t.hoistedToTop[c]||e.setSketchHoistedToTop(c,!0)}for(let a in t.selected)o[a]||e.deselectSketch(a);for(let a in t.hoistedToTop)i[a]||e.setSketchHoistedToTop(a,!1);return{selected:o,hoistedToTop:i}}function ike(r){for(let e in r)return!1;return!0}function nke(r){var o;if(r.type!=="expression")return;let e=r.formula.assignment;return e||((o=r.formula.geometry)==null?void 0:o.identifier)}function ake(r){var t,o,i;let e={lookupIdentifier:{},lookupCalcId:{}};for(let n of r){let a={calcId:n.id,identifier:nke(n),referencesTheseIdentifiers:{},referencedByTheseCalcIds:{}};e.lookupCalcId[a.calcId]=a,a.identifier&&(e.lookupIdentifier[a.identifier]=a)}for(let n of r){let a=e.lookupCalcId[n.id];if(a){if(n.type==="expression"){n.folderId===__dcg_shared_module_exports__['Zd']&&(a.isGarbageCollectable=!n.readonly,(((o=(t=n.formula.geometry)==null?void 0:t.call)==null?void 0:o.symbol)==="segments"||$c(n))&&(a.deleteIfNotReferenced=!0));for(let s of((i=n.formula.geometry)==null?void 0:i.parentDependencies)||[])Foe(e,a,s)}cb(n,s=>{let c=s.match(/(\\token{[0-9]+})/g);if(c)for(let d of c){let p=__dcg_shared_module_exports__['wb'](d);p!==a.identifier&&Foe(e,a,p)}})}}return e}function Foe(r,e,t){e.referencesTheseIdentifiers[t]=!0;let o=r.lookupIdentifier[t];o&&(o.referencedByTheseCalcIds[e.calcId]=!0)}function ske(r,e,t){var a;let o=[];for(let s of e){let c=r.lookupCalcId[s];if(!c)continue;o.push(c);let d=c.referencesTheseIdentifiers;for(let p in d){let u=r.lookupIdentifier[p];u&&delete u.referencedByTheseCalcIds[c.calcId]}}let i={};for(let s in t)for(let c of t[s]){let d=r.lookupIdentifier[c];d&&delete d.referencedByTheseCalcIds[s],i[c]=!0}let n={};for(let s of o){let c=s.referencesTheseIdentifiers;for(let p in c)i[p]=!0;let d=s.identifier;if(d){let p=(a=r.lookupIdentifier[d])==null?void 0:a.referencedByTheseCalcIds;if(p)for(let u in p){let g=r.lookupCalcId[u];g&&g.isGarbageCollectable&&(n[u]=!0)}}}for(let s in i){let c=r.lookupIdentifier[s];if(c&&c.deleteIfNotReferenced){let d=c.referencedByTheseCalcIds;c.calcId&&c.isGarbageCollectable&&ike(d)&&(n[c.calcId]=!0)}}for(let s of o)delete r.lookupCalcId[s.calcId],s.identifier&&delete r.lookupIdentifier[s.identifier];return Object.keys(n)}function Noe(r,e,t){var d;let o=r.getAllItemModels(),i=e.map(p=>p.id),n=ake(o.concat(e)),a={},s={};for(let p in t){let{nextLatex:u}=t[p],g=r.getItemModel(p);if((g==null?void 0:g.type)!=="expression")continue;let h={};for(let v of((d=g.formula.geometry)==null?void 0:d.parentDependencies)||[])h[v]=!0;for(let v in h)mc(u,__dcg_shared_module_exports__['vb'](v))&&delete h[v];let b=Object.keys(h);b.length&&(s[p]=b)}let c=Object.keys(s).length>0;for(;i.length||c;){c=!1,i=ske(n,i,s);for(let p of i)a[p]=!0}return Object.keys(a)}var Uoe=Symbol("privateHistoryProperty"),pV=class{constructor(e,t){this.currentState=e;this.__historyThatShouldNotBeSerialized=Symbol("__historyThatShouldNotBeSerialized");Object.defineProperty(this,Uoe,{value:t.clone(),enumerable:!1,configurable:!1,writable:!1})}toJSON(){throw new Error("Operation unsupported: history should not be serialized.")}};function Yoe(r){let e=r;return{currentState:e.currentState,history:e[Uoe]}}var Boe={version:xc,randomSeed:"",graph:{product:"graphing-3d",threeDMode:!0,viewport:{...__dcg_shared_module_exports__['Gc']}},expressions:{list:[{id:"1",type:"expression"}]}};function Koe(r){switch(r){case"letters":return"capitalLetters";case"noQwertyLetters":return"noQwertyCapitalLetters";case"noQwertyCapitalLetters":return"noQwertyLetters";default:return"letters"}}function zoe(r){switch(r){case"mainNumbers":return"mainNumbers3D";default:return r}}function dB(r){return{keypadMinimized:!qR,keypadLayout:"mainNumbers",keypadFunctionsOpen:!1,graphSettingsOpen:!1,addExpressionOpen:!1,addInferenceOpen:!1,expressionsVisible:!!r.expressions,inEditListMode:!1,isFileDraggedOver:!1,expressionsHiddenTime:void 0,tableRegressionsDropdownOpenForTableId:void 0,openPopoverGuid:void 0}}var yn=__dcg_shared_module_exports__['e'](j()),uV=class extends yn.View{template(){return x("form",{name:yn.const("open_graph_on_web"),target:()=>this.props.openInNewWindow()?"_blank":"",method:yn.const("POST"),action:()=>this.props.saveURL(),style:()=>({display:"none"}),children:[l("input",{type:yn.const("text"),name:yn.const("is_open_on_web"),value:yn.const("true")}),l("input",{type:yn.const("text"),name:yn.const("my_graphs"),value:yn.const("false")}),l("input",{type:yn.const("text"),name:yn.const("is_update"),value:yn.const("false")}),l("input",{type:yn.const("text"),name:yn.const("product"),value:()=>this.props.product()}),l("input",{type:yn.const("text"),name:yn.const("calc_state"),value:()=>this.props.stateData()}),l("input",{type:yn.const("text"),name:yn.const("thumb_data"),value:()=>this.props.thumbData()})]})}};var Hoe={xmin:"",xmax:"",xstep:"",ymin:"",ymax:"",ystep:"",zmin:"",zmax:""};function Woe(r){return r in Hoe}function lke(r){let e=r.split("\xD7");return(e.length>1&&e[0]==="1"?e.slice(1):e).join("\\cdot")}function Gy(r,e){let t=__dcg_shared_module_exports__['nb'](r,e),o="";if(t.mantissa)o=lke(t.mantissa)+"^{"+t.superscript+"}";else{let i=t.string.split("/");i.length===2?i[0][0]==="-"?o="-\\frac{"+i[0].slice(1)+"}{"+i[1]+"}":o="\\frac{"+i[0]+"}{"+i[1]+"}":o=t.string}return o=o.replace(//,"\\pi"),o}function cke(r,e){let t=e.xAxisScale==="linear"?r.xmax-r.xmin:void 0,o=e.yAxisScale==="linear"?r.ymax-r.ymin:void 0,i={xmin:Gy(r.xmin,t),xmax:Gy(r.xmax,t),ymin:Gy(r.ymin,o),ymax:Gy(r.ymax,o)};return r.zmin!==void 0&&r.zmax!==void 0&&(i.zmin=Gy(r.zmin,r.zmax-r.zmin),i.zmax=Gy(r.zmax,r.zmax-r.zmin)),i}function qoe(r,e){return r===0?"":Gy(r,e)}function joe(r,e){return{...cke(r,e.scales),xstep:qoe(e.steps.xAxisStep,r.xmax-r.xmin),ystep:qoe(e.steps.yAxisStep,r.ymax-r.ymin)}}function pB(){return{limitLatex:{...Hoe}}}function Xoe(r){var e;switch(r.type){case"tick":case"tick-ticker":case"evaluator-progress-update":return!1;case"on-evaluator-changes":return!!((e=r.eventUpdates)!=null&&e.userAction);default:return!0}}var Vy=class{constructor(e){this.__nextItemId=0;this.__pendingImageUploads={};this.__lastSelectedIdsForPropagation={selected:{},hoistedToTop:{}};this.nextSubscription=0;this.subscriptions={};this._queuedCallbacks=[];this._hasUnsavedChanges=!1;this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;this.lastParsableObjects={};this.isExpressionSearchStrValidForReplace=!1;this.isExpressionReplaceStrValidForReplace=!1;this.expressionSearchCount=0;this.expressionSearchOpen=!1;this.geoUIActive=!1;this.showConstructionsOpen=!1;this.activeTool="selection";this.visualViewportZoom=1;this.geometryGettingStartedMessageState="pick-a-tool";this.activeTokens={selected:void 0,hovered:void 0};this.apiMethodCallStackInfo={apiMethodCallDepth:0,withHistoryReplacementDepth:0};this.canShowKeyboardShortcuts=!1;this.progressUpdateLegendHidden=!1;this.inferenceUIData=__dcg_shared_module_exports__['f'](RY);this.highlightedExpressions=[];this.shellViews={};this.toastData={};this.s=Qc(()=>this.graphSettings.config.language);this.raw=(e,t)=>$s(e,t);this.hasTranslation=e=>{let t=this.graphSettings.config.language;return LF(e,t)};this.unpack=e=>{let t=this.graphSettings.config.language;return fc(e,t)};this.dispatch=e=>{if(e.type==="blur-focus-location"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}if(e.type==="set-focus-location"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}if(e.type==="tick"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}e.type==="tick"||Xf("dispatch::"+this.bugsnagContext,{type:e.type}),this.dispatcher.isDispatching()&&Xf("dispatch-in-dispatch::"+this.bugsnagContext,{type:e.type}),this.dispatcher.dispatch(e),this.onEventsEmitted&&this.onEventsEmitted(this.enqueuedEvents),this.logEventsFromDispatch(e);let t;for(;t=this._queuedCallbacks.shift();)t()};this._requiresTickNextFrame=!1;this.cachedGeoTokenDepths={};this.cachedGeoTokenInfo={};this.toolPreviewJSONState={};this.updateViews=()=>{for(let e in this.subscriptions)this.subscriptions[e]()};this.bugsnagContext="";this.inPrintMode=!1;this.lastInfiniteScrollFirstDOM=void 0;this.lastInfiniteScrollLastDOM=void 0;this.hasDispatchSinceLastInfiniteScrollUpdate=!1;this.stateStack=new zh;this.isCurrentlyDoingSetState=!1;this.isCurrentlyDoingRestoreState=!1;this.expressionActionsToRestartIfSlow=new Array;this.getQuestIsActive=()=>!1;this.logEvent=e=>{};this.logEventsFromDispatch=e=>{};var t,o;this.graphSettings=e.graphSettings,(o=(t=this.graphSettings).setController)==null||o.call(t,this),this.listModel=YW(this),this.movablePointsController=e.movablePointControllerBuilder?e.movablePointControllerBuilder(this):new oV(this),this.layoutModel=dB(this.graphSettings.config),this.layoutMeasurements={width:0,height:0},this.settingsViewModel=pB(),this.geometryToolbarModel=JH(),this.imageRetryState={lastAttemptTime:0,attempts:0},this.makeGeoAPI(),this.setupDispatcher(),this.toneAllowed()&&(this.toneController=new Q0(this)),this.graphSettings.config.observe("tone",()=>this._updateToneAvailability()),this.graphSettings.config.observe("audio",()=>this._updateToneAvailability())}isEvaluationExpanded(e){return this.expandedEvaluationId===e}destroy(){var e;(e=this.toneController)==null||e.destroy(),this.clearAllTimeouts(),this.evaluator.destroy(),this.movablePointsController.destroy()}setShellView(e,t){if(this.shellViews[e])throw new Error(`Shell view is already set: '${e}'.`);this.shellViews[e]=t}getShellView(e){var t;return(t=this.shellViews)==null?void 0:t[e]}hasUnsavedChanges(){return this._hasUnsavedChanges}getExpressionSearchOpen(){return this.expressionSearchOpen}getShowConstructionsOpen(){return this.showConstructionsOpen}getGeoToolbarSuppressedByAuthor(){return this.geometryToolbarModel.toolbar==="none"&&!this.shouldShowAuthorFeatures()}shouldShowGeoToolbar(){return this.isGeoUIActive()&&!this.getGeoToolbarSuppressedByAuthor()}isGeoUIActive(){return this.geoUIActive}isGeoToolActive(){return this.activeTool!=="selection"&&this.activeTool!=="box-selection"}getActiveTool(){return this.activeTool}canExpandListForItem(e){let t=this.getItemModel(e);return t?!this.isGeometry()||this.activeTool!=="selection"&&this.activeTool!=="box-selection"||this.isClickableId(e)||"label"in t&&t.label!=="":!1}getGeoModel(){return this.geoModel}getGeoToolbarGroupKeys(){return A0(this.geometryToolbarModel,this.shouldShowAuthorFeatures()).groups}getGeoToolbarItemsForGroup(e){let{items:t}=A0(this.geometryToolbarModel,this.shouldShowAuthorFeatures());return t[e]}getAllAvailableGeoTools(){let e=A0(this.geometryToolbarModel,this.shouldShowAuthorFeatures()),t=[];for(let o of e.groups){let i=e.items[o];i&&(i.dropdown?t.push(...i.dropdown):t.push(i.current))}return t}getAllVisibleGeoToolbarItems(){let e=this.getGeoToolbarGroupKeys(),t=[];for(let o of e){let i=this.getGeoToolbarItemsForGroup(o);i&&t.push(i)}return t}getTickerOpen(){return this.areActionsEnabled()?this.listModel.ticker.open:!1}getTickerVisible(){return this.getTickerOpen()&&!this.getTicker().filteredBySearch}getTickerPlaying(){return this.areActionsEnabled()?this.listModel.ticker.playing:!1}hasVisibleToast(){return!__dcg_shared_module_exports__['eb'](this.toastData)}hasVisibleAndUndoableToast(){return typeof this.toastData.undoCallback=="function"}runAfterDispatch(e){this.dispatcher.isDispatching()?this._queuedCallbacks.push(e):e()}runWithinDispatch(e){this.isDispatching()?e():this.dispatch({type:"run-within-dispatch",cb:e})}enqueueEvent(e,t){var n;let o=this.apiMethodCallStackInfo.apiMethodCallDepth>0,i=t&&!o&&Xoe(t)||!!((n=this.enqueuedEvents[e])!=null&&n.isUserInitiated)||e==="userMovedPoint";this.enqueuedEvents[e]={isUserInitiated:i}}getLanguage(){return this.graphSettings.config.language}isExpressionHighlighted(e){return this.highlightedExpressions.indexOf(e)>=0}pushWithHistoryReplacement(){this.apiMethodCallStackInfo.withHistoryReplacementDepth++}popWithHistoryReplacement(){if(this.apiMethodCallStackInfo.withHistoryReplacementDepth--,this.apiMethodCallStackInfo.withHistoryReplacementDepth<0)throw new Error("Programming Error: withHistoryReplacementDepth < 0")}pushAPIMethodCall(){this.apiMethodCallStackInfo.apiMethodCallDepth++}popAPIMethodCall(){this.apiMethodCallStackInfo.apiMethodCallDepth--}getGrapherDimensions(){let e=this.getGrapher();if(!e)return{width:0,height:0};let{width:t,height:o}=e.getProjection().screen;return{width:t,height:o}}setRandomSeed(e){this.graphSettings.setProperty("randomSeed",e)}getRandomSeed(){return this.graphSettings.randomSeed}setIncludeFunctionParametersInRandomSeed(e){this.graphSettings.setProperty("includeFunctionParametersInRandomSeed",e)}getIncludeFunctionParametersInRandomSeed(){return this.graphSettings.includeFunctionParametersInRandomSeed}shouldDispatchTickNextFrame(){return!!this._requiresTickNextFrame}markTickRequiredNextFrame(){this._requiresTickNextFrame=!0}handleTick(e){let t=this.handlePossiblySlowEvaluator();this.areActionsEnabled()&&RW(this.listModel.ticker,{currentFrameTime:e,previousFrameTime:this.lastFrameTime})?this.dispatch({type:"tick-ticker",time:e}):this.shouldDispatchTickNextFrame()?this.dispatch({type:"tick",time:e}):t&&this.dispatch({type:"render"}),this.getGeoModel().isFading()&&this.requestRedrawGraph(),this.lastFrameTime=e}setupDispatcher(){this.dispatcher=new Ay,this.dispatcher.register(e=>{var c;let t=this.getFirstSelectedItem(),o=this.getFocusLocation();this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;let i;this.enqueuedEvents={change:void 0,graphReset:void 0,clearUnsavedChanges:void 0,openDrawer:void 0,showHotkeysModal:void 0,userMovedPoint:void 0,userClickedObject:void 0,userEditedLabel:void 0},e.type==="tick"&&(this._requiresTickNextFrame=!1),this.isCurrentlyDoingSetState=!1,this.isCurrentlyDoingRestoreState=!1,this.handleDispatchedAction(e),this.constrainMultiSelect(),this.updateTheComputedWorld();let n=this.getImageToRetry();(this.getPlayingSliders().length>0||this.isDragDropActive()||n)&&this.markTickRequiredNextFrame(),n&&this.retryLoadingFailedImage(n),this.updateGeometryGettingStartedMessageState(),e.type!=="undo"&&e.type!=="redo"&&e.type!=="restore-history"&&!this.isDragDropActive()&&this.commitUndoRedoSynchronously(e),this.requestParseForAllItems(),this.isCurrentlyDoingSetState=!1,this.isCurrentlyDoingRestoreState=!1,this.enqueuedEvents.change&&((c=this.getGrapher2d())==null||c.markLabelsDirty()),this.enqueuedEvents.clearUnsavedChanges?this._hasUnsavedChanges=!1:this.enqueuedEvents.change&&(this._hasUnsavedChanges=!0);let a=this.getFirstSelectedItem();a?(!t||t.guid!==a.guid)&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0):this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;let s=this.getFocusLocation();s&&!__dcg_shared_module_exports__['db'](s,o)&&this.getFocusedItem()==a&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0),o&&t&&t.type==="table"&&o.type==="table"&&(!s||s.type!=="table"||o.id!==s.id)&&t.isExpanded&&(Qx(t,!1),s||(i=t)),s&&a&&a.type==="table"&&_q(a),(e.type==="adjust-slider-by-dragging-thumb"||e.type==="adjust-slider-by-keyboard")&&(i=this.getItemModel(e.id)),this.updateRenderShellsBeforePaint(),this.updateViews(),i?this.scrollItemIntoView(i):this.shouldScrollSelectedItemIntoViewAfterDispatch&&this.scrollSelectedItemIntoView(),this.updateDragDrop(),this.updateRenderShellsAfterDispatch()})}updateGeometryGettingStartedMessageState(){if(!this.isGeometry())return;let e=this.geometryGettingStartedMessageState,t=this.getActiveTool(),o=t==="selection"||t==="box-selection"||t==="expression-edit";if(e==="hidden")return;if(this.isGraphSettingsOpen()||this.getGraphSettings().showGrid||this.getGraphSettings().showYAxis){this.geometryGettingStartedMessageState="hidden";return}let i=this.getItemModelByIndex(1);if(this.getItemCount()>2||!i||i.type!=="expression"||i.latex!==""||this.geoModel.getNonObjectsState().ui.currentTool.inputIndex>0){this.geometryGettingStartedMessageState="hidden";return}o||(this.geometryGettingStartedMessageState="construct")}getGeometryGettingStartedMessageState(){return this.geometryGettingStartedMessageState}handleDispatchedAction(e){var t,o,i,n,a,s,c,d,p,u,g,h,b,v,T,E,I,_,C,D;switch(e.type){case"render":break;case"undo":this.geoModel.isToolplayActive()?this.cancelGeoToolplay():__dcg_shared_module_exports__['Pc'](this.getActiveTool())?this.setGeoTool("selection"):this.undo();break;case"redo":this.geoModel.isToolplayActive()&&this.cancelGeoToolplay(),this.redo();break;case"clear-undoredo-history":this.clearUndoRedoHistory();break;case"on-special-key-pressed":e.key==="Enter"?aB(this):e.key==="Up"||e.key==="PageUp"?sV(this):e.key==="Down"||e.key==="PageDown"?lV(this):e.key==="Backspace"?iB(this):e.key==="Delete"&&nB(this);break;case"select-previous-expression":mM(this.listModel);break;case"select-next-expression":fM(this.listModel);break;case"toggle-label-for-all-selected-points":this.toggleLabelForAllSelectedObjects();break;case"set-label-state-for-selected-points":{let S=[];for(let A of this.getAllSelectedItems())A.type==="expression"&&$c(A)&&S.push(A);this.setLabelStateForObjects(S,e.state);break}case"move-selected-item-to-expression-list":{let S=this.getSelectedItem();if(!S||S.type==="folder"||this.isItemReadonly(S.id))return;if(S.type==="expression"){let B=TM(S);B&&mp(this.listModel,B,this.getAutonameLatexForExpression(S,this.findLastSubscriptForLetters()))}ub(this.listModel,S.id),"folderId"in S&&S.folderId===__dcg_shared_module_exports__['Zd']&&(S.folderId="");let A=this.getItemCount()-1,O=Ju(this.listModel,A);if(O&&O.type==="expression"&&O.latex===""){this._toplevelReplaceItemAt(A,S,!1);return}Dl(this.listModel,S)}break;case"update-all-selected-items":{let S=e.update;if(e.update.prop==="folderId"){let A;if(e.update.createFolder){A=this.generateId();let ue=this.createItemModel({type:"folder",id:A,title:e.update.value}),he=this.getItemCount()-1,ae=Ju(this.listModel,he);ae&&ae.type==="expression"&&ae.latex===""?this._toplevelReplaceItemAt(this.getItemCount()-1,ue,!1):Dl(this.listModel,ue)}else A=e.update.value;let O=this.getItemModel(A);if(!O||O.type!=="folder")return;let B={},V={};this.getAllSelectedItems().forEach(ue=>{var he;if(!(ue.type==="folder"||ue.folderId===A)&&!this.isItemReadonly(ue.id)&&(B[ue.id]=ue,ue.type==="expression")){let ae=(he=ue.formula.geometry)==null?void 0:he.call;if(ae&&ae.symbol==="apply"){let $=ae.parents[0],se=$.type!=="arbitrary-expression"?__dcg_shared_module_exports__['Oc']($):void 0;se&&(V[se]=!0)}}});for(let ue in V){let he=Dg(this.listModel,ue);he.length===1&&he[0].folderId!==A&&(B[he[0].id]=he[0])}let K={},oe=[];for(let ue in B){let he=B[ue];oe.push(he)}oe.forEach(ue=>{if(ue.type==="expression"){let he=TM(ue);he&&(K[ue.id]=he)}}),oe.sort((ue,he)=>ue.index-he.index);let Z=this.findLastSubscriptForLetters();oe.forEach(ue=>{if(ue.type==="expression"){let he=K[ue.id];if(he){let ae=this.getAutonameLatexForExpression(ue,Z);mp(this.listModel,he,ae)}}}),oe.forEach(ue=>{ub(this.listModel,ue.id)});let ee=O.index+this.getNumberOfItemsInFolder(A)+1;oe.forEach(ue=>{cn(this.listModel,ue,ee),ee+=1}),oe.forEach(ue=>{In(ue,A)})}else if(S.prop==="visible")this.getAllSelectedItems().forEach(A=>{this.isItemReadonly(A.id)||(this._setItemHidden(A.id,!S.value),S.value===!1&&A.type==="expression"&&Vg(A,!1))});else if(e.update.prop==="color"){let A=e.update.value;this.getAllSelectedItems().forEach(O=>{O.type==="expression"&&IM(O,A)})}else if(e.update.prop==="colorLatex"){let A=e.update.value;this.getAllSelectedItems().forEach(O=>{O.type==="expression"&&$0(O,A)})}else if(e.update.prop==="showLabel"){let A=e.update.value;this.getAllSelectedItems().forEach(O=>{O.type==="expression"&&Vg(O,A)})}else if(e.update.prop==="label"){let A=e.update.value;this.getAllSelectedItems().forEach(O=>{O.type==="expression"&&fp(O,A)})}else if(e.update.prop==="dragMode"){let A=e.update.value;this.getAllSelectedItems().forEach(O=>{O.type==="expression"&&Fv(O,A)})}else if(e.update.prop==="lineWidth"){let A=e.update.value;this.getAllSelectedItems().forEach(O=>{O.type==="expression"&&Mv(O,A)})}else if(e.update.prop==="lineOpacity"){let A=e.update.value;this.getAllSelectedItems().forEach(O=>{O.type==="expression"&&Iv(O,A)})}else if(e.update.prop==="lineStyle"){let A=e.update.value;this.getAllSelectedItems().forEach(O=>{O.type==="expression"&&MM(O,A)})}else if(e.update.prop==="strictIntersection"){let A=e.update.value;this.getAllSelectedItems().forEach(O=>{O.type==="expression"&&u7(O,A)})}else if(e.update.prop==="disableGraphInteractions"){let A=e.update.value;this.getAllSelectedItems().forEach(O=>{O.type==="expression"?w3(O,A):O.type==="image"&&BF(O,A)})}}break;case"delete-all-selected-items":{let{deletedItems:S,readonlyItemsNotDeleted:A}=this.removeListOfItems(this.getSelectedExpressionIds());this.garbageCollectGeo(S,{}),this.ensureAtLeastOneVisibleItem(),S.length>0&&It(this.s("graphing-calculator-narration-items-deleted",{count:__dcg_shared_module_exports__['Db'](S.length)})),A>0&&It(this.s("graphing-calculator-narration-locked-items-not-deleted",{count:__dcg_shared_module_exports__['Db'](A)})),_e();break}case"upward-delete-selected-expression":sB(this,{moveSelection:!1});break;case"downward-delete-selected-expression":lB(this,{moveSelection:!1});break;case"table-show-more-rows":{let S=this.getItemModel(e.id);if(!S||S.type!=="table")return;let A=Zf(S);if(!A)return;Ir(this.listModel,S),Qx(S,!0),Rr(this,{type:"table",id:S.id,location:{row:A.min,column:0}})}break;case"navigate-table-by-key":Loe(this,e.id,e.key);break;case"delete-item-and-animate-out":this._deleteItemAndAnimateOut(e.id,e.setFocusAfterDelete);break;case"finish-deleting-item-after-animation":this._finishDeletingItemAfterAnimation(e.id,e.setFocusAfterDelete);break;case"expression-zoom-fit":this._expressionZoomFit(e.id,{focusAfterTap:e.focusAfterTap,synchronous:!1,justResiduals:!1});break;case"expression-zoom-fit-residuals":this._expressionZoomFit(e.id,{focusAfterTap:e.focusAfterTap,synchronous:!1,justResiduals:!0});break;case"set-expression-properties-from-api":this._setExpressionPropertiesFromAPI(e.id,e.properties);break;case"add-item-to-end-from-api":this._addItemToEndFromAPI(this.createItemModel(e.state));break;case"duplicate-expression":{let S=this.getItemModel(e.id);if(!S||S.type==="folder")return;this.copyExpressionToIndex(S,S.index+1)}break;case"set-highlighted-expressions":this.highlightedExpressions=e.ids;break;case"paste-expression":{let S=this.getFocusedItem(),A=e.data;if(!S||A.length===0||A[0].type==="folder"&&!this.areFoldersEnabled()||(A=A.filter(ue=>{switch(ue.type){case"expression":case"table":case"folder":return!0;case"text":return this.areNotesEnabled();case"image":return this.areImagesEnabled()}}),A.length===0))break;let O=A[0],B=S.type==="folder"?S.id:S.folderId,V=this.getItemModel(B),K,oe,Z;if(O.type==="folder"&&V){K=!1,Z=void 0;let ue=this.getNumberOfItemsInFolder(V.id);oe=V.index+ue}else Z=V==null?void 0:V.id,K=S.type==="expression"&&S.latex==="",oe=S.index;O.type==="table"&&(O=this.copyTableStateWithNewColumnIds(O));let ee=this.createItemModel({...O,id:this.generateId()});if(K?this._toplevelReplaceItemAt(S.index,ee,!0):(this._toplevelInsertItemAt(oe+1,ee,!0,Z),oe=oe+1),O.type==="folder")for(let ue=1;ue<A.length;ue++){let he=A[ue];he.type==="table"&&(he=this.copyTableStateWithNewColumnIds(he));let ae=this.createItemModel({...he,id:this.generateId()});this._toplevelInsertItemAt(oe+ue,ae,!1,ee.id)}}break;case"duplicate-folder":{let{id:S}=e,A=this.getItemModel(S);if(!A||A.type!=="folder")return;let O=this.createItemModel({...SI(A,{stripDefaults:!1}),id:this.generateId()}),B=this.getNumberOfItemsInFolder(S),V=B+1;this._toplevelInsertItemAt(A.index+V,O,!1,void 0);let K=A.index+1,oe=K+B;for(let Z=K;Z<=oe;Z++){let ee=Ju(this.listModel,Z);if(!ee||ee.type==="folder")return;this.copyExpressionToIndex(ee,Z+V,O.id)}}break;case"insert-item-at-index":{let S=this.createItemModel(e.state);this._toplevelInsertItemAt(e.index,S,e.focus,e.folderId)}break;case"new-expression-at-end":{this.setGeoTool("selection");let S=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),Dl(this.listModel,S),ko(this,S.id)}break;case"new-expression":{let S=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),this._toplevelNewItemAtSelection(S,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-note":{let S=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelNewItemAtSelection(S,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-folder":{let S=this.createItemModel({type:"folder",id:this.generateId()});this._toplevelNewItemAtSelection(S,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-images":this._uploadImagesAndWaitForThemToLoad({files:e.files}),this._closeAddExpression();break;case"new-inference":this._addNewInferenceObject(),this.closeAddInferenceWizard(),this._closeAddExpression();break;case"open-inference-wizard":this.layoutModel={...this.layoutModel,addInferenceOpen:!0},this.inferenceUIData.inferenceWizardData=__dcg_shared_module_exports__['f'](RY.inferenceWizardData);break;case"set-inference-wizard-data":this.inferenceUIData.inferenceWizardData={...this.inferenceUIData.inferenceWizardData,...e.update};break;case"set-inference-object-data":{this.updateInferenceParameters(e.id,e.update);break}case"set-inference-wizard-sample-data":this.setInferenceWizardSampleData(e);break;case"change-image":this._uploadImagesAndWaitForThemToLoad({files:e.files,id:e.id});break;case"new-table":{let S=this._createTableItem();this._toplevelNewItemAtSelection(S,{shouldFocus:!0}),this._closeAddExpression()}break;case"paste-table":this._pasteTable(e.data);break;case"convert-or-create-table":this._convertOrCreateTable(e.index);break;case"insert-several-expressions":this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this._insertSeveralExpressions(e.expressions);break;case"append-number-list":this._appendNumberList(e.latex);break;case"remove-item-by-id":ub(this.listModel,e.id);break;case"replace-item-at-index":{let S=this.createItemModel(e.state);this._toplevelReplaceItemAt(e.index,S,e.focus)}break;case"create-sliders-for-item":this.createSlidersForItem(e.id,e.variables,e.doNotChangeFocus);break;case"create-sliders-for-ticker":this.createSlidersForTicker(e.variables);break;case"convert-image-to-draggable":this.convertImageToDraggable(e.id);break;case"start-dragdrop":{let S=this.getItemModel(e.dragTarget.calcId);if(!S)return;let A={x:0,y:0},O=this.getItemRootNodeById(S.id);if(O){let K=O.getBoundingClientRect();A.y=e.grabPt.y-K.top,A.x=e.grabPt.x-K.left}this.isItemSelected(S.id)?Ir(this.listModel,S):Ir(this.listModel,void 0),this.setGeoTool("selection");let B=!1,V=1;S.type==="folder"&&(V+=this.getNumberOfItemsInFolder(S.id),S.collapsed||(B=!0,av(S,!0))),B0(this.listModel,{firstItemId:S.id,numberOfItems:V,expandFolder:B,grabOffset:A,mousePt:e.mousePt,dragTarget:e.dragTarget,renderType:e.dragTarget.type,itemTop:0,itemLeft:0}),this.dragdrop_expressions.startDragging(e.mousePt)}break;case"update-dragdrop":{let S=this.listModel.dragState;if(!S)return;B0(this.listModel,{...S,mousePt:e.mousePt})}break;case"stop-dragdrop":{let S=this.listModel.dragState;if(!S)return;let A=this.getItemModel(S.firstItemId);if(!A)return;A.type==="folder"&&S.expandFolder&&av(A,!1),B0(this.listModel,void 0),this.ensureAtLeastOneVisibleItem()}break;case"set-selected-id":{let S=this.getItemModel(e.id);S?e.state==="selected"?Ir(this.listModel,S):(e.state,S9(this.listModel,S)):Ir(this.listModel,void 0)}break;case"set-all-selected-ids":r3(this.listModel,e.ids);break;case"toggle-selected-with-multi-select":t3(this.listModel,e.id,e.state);break;case"set-selected-index":{let S=this.getItemModelByIndex(e.index);Ir(this.listModel,S)}break;case"set-none-selected":Ir(this.listModel,void 0);break;case"commit-tentative-selection":{k9(this.listModel);break}case"clear-tentative-selection":{_9(this.listModel);break}case"set-focus-location":{let S=e.location?e.location.type:"";if(S==="expression"&&this.setGeoTool("selection"),(S==="image"||S==="table")&&this.setEditListMode(!1),S==="graph-paper"){this.setGraphPaperFocus({isFocused:!0});break}Rr(this,e.location)}break;case"focus-first-expression":{this.focusFirstExpression();break}case"move-focus-to-item":ko(this,e.id,e.where);break;case"blur-focus-location":this.isFocusLocationFocused(e.location)&&Rr(this,void 0),((t=e.location)==null?void 0:t.type)==="graph-paper"&&this.setGraphPaperFocus({isFocused:!1});break;case"set-folder-collapsed":{let S=this.getItemModel(e.id);if(!S||S.type!=="folder")return;av(S,e.isCollapsed)}break;case"set-all-folders-collapsed":A9(this.listModel,e.isCollapsed);break;case"set-item-secret":{let S=this.getItemModel(e.id);if(!S)return;yI(S,e.isSecret)}break;case"set-item-in-front-of-everything":{let S=this.getItemModel(e.id);if(!S||S.type!=="folder")return;mH(S,e.inFrontOfEverything)}break;case"set-item-readonly":{let{id:S,readonly:A}=e,O=this.getItemModel(S);if(!O)return;if(S0(O,A),O.type==="folder")for(let B of sM(this.listModel,S))S0(B,A)}break;case"set-item-disable-graph-interactions":{let{id:S,disableGraphInteractions:A}=e,O=this.getItemModel(S);if(!O)return;switch(O.type){case"expression":w3(O,A);break;case"image":BF(O,A);break}break}case"set-tablecolumn-disable-graph-interactions":{let{tableId:S,columnId:A,disableGraphInteractions:O}=e,B=this.getItemModel(S);if(!B||B.type!=="table")return;let V=lo(B,A);if(!V)return;nH(V,O);break}case"set-tablecolumn-color":{let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;Xq(S,e.columnId,e.color)}break;case"set-tableregression-color":{let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;$q(S,e.color)}break;case"set-tablecolumn-colorlatex":{let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;pI(S,e.columnId,e.colorLatex)}break;case"set-cdf-props":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;E7(S,e.props)}break;case"toggle-item-hidden":this._toggleItemHidden(e.id);break;case"toggle-tablecolumn-hidden":this._toggleTableColumnHidden(e.tableId,e.columnId);break;case"toggle-item-settings-menu":this.isItemSettingsMenuOpen(e.menu.guid)?this.closeItemSettingsMenu():(this.listModel.openItemMenu=e.menu,e.menu.focusFirstOption&&(e.menu.type==="geo-tool-dropdown"?Rr(this,{type:"geo-basic-tool-menu-item",tool:e.menu.tools[0]}):e.menu.type==="multi-select-more"||e.menu.type==="multi-select-construct"||e.menu.type==="multi-select-style"||e.menu.type==="multi-select-label"?Rr(this,{type:"generic-menu",where:"start"}):Rr(this,{type:"expression-menu",id:e.menu.model.id,location:"start"})));break;case"close-item-settings-menu":this.closeItemSettingsMenu();break;case"toggle-fraction-evaluation":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;let A=Gg(S);i7(S,!A)}break;case"set-item-label":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;fp(S,e.label),this.enqueueEvent("userEditedLabel",e)}break;case"set-item-showlabel":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;Vg(S,e.showLabel),!e.showLabel&&!Lg(S)&&(rk(S,!1),DM(S,__dcg_shared_module_exports__['$d'].None))}break;case"set-item-color":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;IM(S,e.color)}break;case"set-item-description":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression"&&S.type!=="image")return;S.type==="expression"?n7(S,e.description):S.type==="image"&&aW(S,e.description)}break;case"set-item-fill":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;c3(S,e.fill),this._setItemHidden(S.id,Uv(S))}break;case"set-image-opacity":{let S=this.getItemModel(e.id);if(!S||S.type!=="image")return;cW(S,e.opacity),this._setItemHidden(S.id,!1)}break;case"set-image-in-foreground":{let S=this.getItemModel(e.id);if(!S||S.type!=="image")return;UF(S,e.foreground)}break;case"image-upload-error":this.__pendingImageUploads[e.token]&&(delete this.__pendingImageUploads[e.token],this._showToast({message:this.s("graphing-calculator-text-toast-image-upload-failed")}));break;case"image-upload-success":{if(this.__pendingImageUploads[e.token])if(delete this.__pendingImageUploads[e.token],e.id){let S=this.getItemModel(e.id);S&&S.type==="image"&&dW(S,e.url)}else{let S=this.createItemModel({type:"image",id:this.generateId(),width:e.width,height:e.height,image_url:e.url,name:e.name});this._toplevelNewItemAtSelection(S,{shouldFocus:!1})}this.isUploadingImages()||(this.toastData={})}break;case"image-load-success":{let S=this.getItemModel(e.id);if(!S||S.type!=="image")return;BI(S,"loaded"),this.imageRetryState={lastAttemptTime:0,attempts:0}}break;case"image-load-error":{let S=this.getItemModel(e.id);if(!S||S.type!=="image")return;BI(S,"failed")}break;case"image-retry-loading":{let S=this.getItemModel(e.id);if(!S||S.type!=="image")return;YF(S)}break;case"set-item-dragmode":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;Fv(S,e.dragMode)}break;case"set-tablecolumn-dragmode":{let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;jq(S,e.columnId,e.dragMode),e.dragMode!==__dcg_shared_module_exports__['Gd'].NONE&&this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-points":{let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;yF(S,e.columnId,e.bool),this._setTableColumnHidden(e.tableId,e.columnId,uI(S,e.columnId))}break;case"set-tablecolumn-lines":{let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;zq(S,e.columnId,e.bool),this._setTableColumnHidden(e.tableId,e.columnId,uI(S,e.columnId))}break;case"set-tablecolumn-linestyle":{let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;qq(S,e.columnId,e.lineStyle),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-linewidth":{let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;sI(S,e.columnId,e.lineWidth),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-lineopacity":{let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;lI(S,e.columnId,e.lineOpacity),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointsize":{let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;cI(S,e.columnId,e.pointSize),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointoutline":{let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;Hq(S,e.columnId,e.pointOutline),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointopacity":{let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;dI(S,e.columnId,e.pointOpacity),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointstyle":{let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;Kq(S,e.columnId,e.pointStyle),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-item-points":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;d3(S,e.points),this._setItemHidden(e.id,Uv(S))}break;case"set-item-pointstyle":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;p3(S,e.pointStyle),this._setItemHidden(e.id,!1)}break;case"set-item-lines":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;u3(S,e.lines),this._setItemHidden(e.id,Uv(S))}break;case"set-item-extend-to-3D":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;s7(S,e.extendTo3D),this._setItemHidden(e.id,!1);let A=(o=this.grapher3d)==null?void 0:o.transition;A&&e.extendTo3D&&(A.objectIdExtendingTo3D&&((i=this.grapher3d)==null||i.webglLayer.setZboundsOnSurfaces(A.objectIdExtendingTo3D,-1/0,1/0)),A.objectIdExtendingTo3D=S.id,A.startTime=-1,A.duration=150)}break;case"set-item-linestyle":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;MM(S,e.lineStyle),this._setItemHidden(e.id,!1)}break;case"set-item-arrow-mode":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;l7(S,e.value),this._setItemHidden(e.id,!1);break}case"set-item-label-dropdown-open":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;a7(S,e.open)}break;case"set-item-fillopacity":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;H0(S,e.fillOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-surfaceopacity":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;W0(S,e.surfaceOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-lineopacity":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;Iv(S,e.lineOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-pointopacity":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;j0(S,e.pointOpacity),S.showLabel||this._setItemHidden(e.id,!1)}break;case"set-item-pointoutline":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;d7(S,e.pointOutline)}break;case"set-item-pointsize":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;X0(S,e.pointSize),this._setItemHidden(e.id,!1)}break;case"set-item-linewidth":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;Mv(S,e.lineWidth),this._setItemHidden(e.id,!1)}break;case"set-item-resolution":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;vM(S,e.resolution),this._setItemHidden(e.id,!1)}break;case"set-item-colorlatex":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;$0(S,e.colorLatex)}break;case"set-item-labelSize":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;J0(S,e.labelSize)}break;case"set-item-labelangle":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;wM(S,e.labelAngle)}break;case"set-item-label-orientation":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;h3(S,e.labelOrientation)}break;case"set-suppress-text-outline":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;c7(S,e.suppressTextOutline)}break;case"set-item-interactive-label":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;rk(S,e.interactiveLabel),e.interactiveLabel&&DM(S,__dcg_shared_module_exports__['$d'].None)}break;case"set-item-editable-label-mode":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;S.editableLabelMode!==__dcg_shared_module_exports__['$d'].None&&e.editableLabelMode!==__dcg_shared_module_exports__['$d'].None&&S.editableLabelMode!==e.editableLabelMode&&fp(S,""),DM(S,e.editableLabelMode),e.editableLabelMode!==__dcg_shared_module_exports__['$d'].None&&rk(S,!1)}break;case"plot-residuals":{let S=this.getItemModel(e.id);if(!S)return;let A;if(S.type==="expression"?A=S.formula.regression:S.type==="table"&&((a=(n=S.formula)==null?void 0:n.table_regression)==null?void 0:a.status)==="success"&&(A=S.formula.table_regression.result),!A)return;let O=A.residualSuggestionId;if(!O)return;let B=this.getItemModel(O);if(!B)return;aI(B,{latex:A.residualVariable,columnIndex:B.columnModels.length-1}),Rr(this,{type:"regression-output",id:e.id,parameter:"residual-zoom"})}break;case"toggle-logmode":{let S=this.getItemModel(e.id);if(!S)return;let A;S.type==="expression"?(A=S.isLogModeRegression,l3(S,!A)):S.type==="table"&&S.regression&&(A=S.regression.isLogMode,Jq(S,!A)),A!==void 0&&this.logEvent({category:"regressions",action:A?"disable-log-mode":"enable-log-mode"})}break;case"set-item-latex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;let A=e.latex,O=S.latex;if(this.garbageCollectGeo([],{[S.id]:{prevLatex:O,nextLatex:A}}),(A==='"'||A==="note")&&this.areNotesEnabled()){let B=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelReplaceItemAt(S.index,B,!0)}else if(A==="")P7(S),this.expandedEvaluationId===S.id&&(this.expandedEvaluationId=void 0);else if(A==="ticker"&&this.canAddTicker())this.listModel.ticker.open=!0,this.focusLocation={type:"ticker",location:"handler"},this._removeExpressionSynchronously(S);else if(A==="folder"&&this.areFoldersEnabled()){let B=this.createItemModel({id:this.generateId(),type:"folder"});Ua(S)?(this._toplevelNewItemAtSelection(B,{shouldFocus:!0}),Zn(S,"")):this._toplevelReplaceItemAt(S.index,B,!0)}else if(A==="table"){let B=this._createTableItem();this._toplevelReplaceItemAt(S.index,B,!0)}else!this.isGeometry()&&(A==="betchacant"||A==="pride"||A==="teapot"&&this.is3dProduct())?this.runAfterDispatch(()=>{this.triggerEasterEgg&&this.triggerEasterEgg(A)}):(Zn(S,A),e.source==="user-edit"&&this.trackActionForPotentialEvaluatorRestart("edit",e.id))}break;case"set-visualization-prop":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;z9(S,e.prop,e.value)}break;case"set-clickableinfo-prop":{let S=this.getItemModel(e.id);if(!S)return;S.type==="expression"?q9(S,e.prop,e.value):S.type==="image"&&KI(S,e.prop,e.value)}break;case"set-clickableinfo-rule-latex":{let S=this.getItemModel(e.id);if(!S)return;S.type==="expression"?bM(S,e.latex):S.type==="image"&&yW(S,e.latex)}break;case"set-folder-title":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let S=this.getItemModel(e.id);if(!S||S.type!=="folder")return;wF(S,e.title)}break;case"set-image-mq-attribute":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let S=this.getItemModel(e.id);if(!S||S.type!=="image")return;ed(S,e.attribute,e.latex)}break;case"set-image-name":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let S=this.getItemModel(e.id);if(!S||S.type!=="image")return;sW(S,e.name)}break;case"set-image-draggable":{let S=this.getItemModel(e.id);if(!S||S.type!=="image")return;let A=mv(S);if(!A)return;NF(S,e.draggable),e.draggable&&(co(A)===__dcg_shared_module_exports__['Gd'].NONE||A.dragMode===__dcg_shared_module_exports__['Gd'].AUTO)&&Fv(A,__dcg_shared_module_exports__['Gd'].XY)}break;case"update-degree-mode":{if(this.isComplexModeEnabled())return;this.graphSettings.setProperty("degreeMode",e.mode);break}case"set-graph-settings":{for(let S in e)S!=="type"&&(S==="xAxisScale"?this.switchAxisScale("xAxisScale",e.xAxisScale):S==="yAxisScale"?this.switchAxisScale("yAxisScale",e.yAxisScale):this.graphSettings.setProperty(S,e[S]));this.grapher3d&&this.isThreeDMode()&&(this.grapher2d.redrawAllLayersSynchronously(),"backgroundColor3d"in e&&this.grapher3d.webglLayer.setBackgroundColor(e.backgroundColor3d),this.apply3dProps(e))}break;case"set-polar-mode":if(this.graphSettings.setProperty("polarMode",e.polarMode),e.polarMode){let S=this.graphSettings.xAxisScale==="logarithmic"||this.graphSettings.yAxisScale==="logarithmic",A=this.getGrapher2d();S&&A&&(this.graphSettings.setProperty("xAxisScale","linear"),this.graphSettings.setProperty("yAxisScale","linear"),A.viewportController.setViewport(A.getDefaultViewport()),A.getProjection().updateScalePairs())}break;case"set-domain-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;bs(S,e.latex,e.variable)}break;case"set-domain-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;ys(S,e.latex,e.variable)}break;case"set-note-text":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let S=this.getItemModel(e.id);if(!S||S.type!=="text")return;jF(S,e.text)}break;case"set-edit-list-mode":{let S=pb(this.listModel);if(this.setEditListMode(e.isEditListMode),e.focusExpressionList){if(S===void 0&&(S=this.getItemModelByIndex(0)),!S)return;ko(this,S.id,S.type==="table"&&e.isEditListMode?"container":"start")}else Ir(this.listModel,void 0),Rr(this,void 0)}break;case"set-ghost-mode":this.getGraphSettings().config.setProperty("ghostMode",e.value);break;case"set-projector-mode":this.getGraphSettings().config.setProperty("projectorMode",e.value),this.isThreeDMode()&&this.grapher2d.redrawAllLayersSynchronously();break;case"set-inverted-colors":this.getGraphSettings().config.setProperty("invertedColors",e.value);break;case"set-tablecell-latex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let S=this.getItemModel(e.tableId);if(!S||S.type!=="table")return;Cg(S,e.cell,e.latex)}break;case"set-state":this.externalSetState(e.state,e.opts);break;case"set-blank":this.externalSetState(this.getBlankState({degreeMode:e.degreeMode}),e.opts);break;case"restore-history":{let{currentState:S,history:A}=Yoe(e.history);this.setState(zo(S)),this.stateStack=A.clone()}break;case"clear-unsaved-changes":this.enqueueEvent("clearUnsavedChanges",e);break;case"reset-graph":{let S=this.getState();this.externalSetState(this.graphSettings.defaultState,{allowUndo:!0}),this.setGeoTool("selection"),this.graphSettings.config.expressions?this.focusFirstExpression():this.setGraphPaperFocus({isFocused:!0}),this._showToast({message:this.s("graphing-calculator-text-toast-graph-reset"),undoCallback:()=>this.dispatch({type:"set-state",state:S,opts:{allowUndo:!0}})}),this.enqueueEvent("graphReset",e)}break;case"clear-graph":{if(this.triggerClearGraph){this.runAfterDispatch(()=>this.triggerClearGraph());return}let S=this.getState();this.externalSetState(this.getBlankState(),{allowUndo:!0});let A=this.getItemModelByIndex(0);A&&ko(this,A.id,"end"),this._showToast({message:this.s("graphing-calculator-text-toast-graph-cleared"),undoCallback:()=>this.dispatch({type:"set-state",state:S,opts:{allowUndo:!0}})}),this.enqueueEvent("graphReset",e)}break;case"hide-progress-update-legend":this.progressUpdateLegendHidden=!0;break;case"evaluator-progress-update":this.handleEvaluatorProgressUpdates();break;case"on-evaluator-changes":{if(this.onEvaluatorChangesSpy&&this.onEvaluatorChangesSpy(e.changes,e.timingData,e.graphData,e.eventUpdates),this.clearSlowEvaluatorTracking(),this.evaluator.cancelRestartWorker(),v9(this.listModel,e.changes,e.dependencyOrder),(s=this.toneController)==null||s.recomputeAudio(),e.type==="on-evaluator-changes"&&!this.getIncludeFunctionParametersInRandomSeed()&&!T9(this.listModel)&&this.stateStack.getState()&&this.setIncludeFunctionParametersInRandomSeed(!0),!e.graphData)break;for(let S in e.graphData.addedGraphs){let A=e.graphData.addedGraphs[S];if(__dcg_shared_module_exports__['Ac'](A)){let O=A.filter(V=>!__dcg_shared_module_exports__['$c'](V.graphMode)),B=A.filter(V=>__dcg_shared_module_exports__['$c'](V.graphMode));(c=this.grapher2d)==null||c.updateSketch(S,O),(d=this.grapher3d)==null||d.updateSketch(S,B),x9(this.listModel,S,A)}}for(let S in e.graphData.removedGraphs)(p=this.grapher2d)==null||p.removeGraphSketch(S),(u=this.grapher3d)==null||u.removeGraphSketch(S);if(this.isThreeDMode())(g=this.grapher2d)==null||g.redrawAllLayersSynchronously();else{for(let S in e.graphData.intersections){let A=e.graphData.intersections[S];__dcg_shared_module_exports__['Ac'](A)&&((h=this.grapher2d)==null||h.updateIntersections(S,A))}(b=this.get2dPOIController())==null||b.handleTraceUpdate(),(v=this.getAudioGraph())==null||v.handleEvaluatorChange(e.graphData)}if(e.eventUpdates){let S=!1;for(let A in e.eventUpdates.updates)if(this.doesIdentifierBlockActionUpdate(A)){S=!0;break}if(!S){for(let A in e.eventUpdates.updates)this.updateLatexForIdentifier(A,e.eventUpdates.updates[A]);e.eventUpdates.objectClicked&&this.enqueueEvent("userClickedObject",e),this.onActionUpdatesAppliedSpy&&this.onActionUpdatesAppliedSpy(e.eventUpdates)}}}break;case"add-helper-expression":a9(this.listModel,e.state);break;case"tick":this._tickSliders(e.time);break;case"tick-ticker":this.tickTicker(e.time);break;case"adjust-slider-by-keyboard":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;qF(S,e.adjustment)}break;case"adjust-slider-by-dragging-thumb":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;HF(S,e.target)}break;case"set-slider-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;nb(S,e.latex)}break;case"set-slider-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;ab(S,e.latex)}break;case"set-slider-steplatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;V0(S,e.latex)}break;case"set-slider-dragging":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;ZI(S,e.dragging)}break;case"play-slider-from-min":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;let A=Zs(S);if(isNaN(A))return;let O=$u(S.latex,A);fs(S,!1),Zn(S,O),fs(S,!0)}break;case"set-slider-isplaying":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;fs(S,e.isPlaying)}break;case"set-slider-loopmode":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;o7(S,e.loopMode)}break;case"set-slider-animationperiod":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression")return;wW(S,e.animationPeriod)}break;case"show-expressions-list":this._showExpressions(e.focusHideIcon);break;case"hide-expressions-list":this._hideExpressions(e.focusShowIcon);break;case"open-drawer":this.enqueueEvent("openDrawer",e);break;case"re-randomize":this.setRandomSeed(Cp());break;case"resize-exp-list":this._setExpListWidth(e.expListWidth);break;case"toast/show":this._showToast(e.toast);break;case"toast/close":this.closeToast();break;case"toast/undo":let P=this.toastData.undoCallback;P&&this.runAfterDispatch(P),this.closeToast();break;case"toast/learn-more":let F=this.toastData.learnMoreCallback;F&&this.runAfterDispatch(F),this.toastData={};break;case"start-moving-points":this.movablePointsController.startMovingPoints(e.points);break;case"stop-moving-points":this.movablePointsController.stopMovingPoints(e.points);break;case"on-move-points":{let{didMovePoint:S}=this.movablePointsController.movePoints({points:e.points,previous_screen_pts:e.previousScreenPts,screen_pts:e.screenPts,projection:e.projection,transform:e.transform,keyboardDirection:e.keyboardDirection});S&&this.enqueueEvent("userMovedPoint",e)}break;case"commit-user-requested-viewport":this._commitUserRequestedViewport(e.viewport);break;case"commit-user-requested-rotation":this.graphSettings.setProperty("worldRotation3D",e.worldRotation3D),this.graphSettings.setProperty("axis3D",e.axis3D),this.graphSettings.setProperty("speed3D",e.speed3D);break;case"toggle-lock-viewport":this.graphSettings.setProperty("userLockedViewport",!this.graphSettings.userLockedViewport),!this.graphSettings.userLockedViewport&&this.graphSettings.userLockedRotation&&this.graphSettings.setProperty("userLockedRotation",!1);break;case"set-lock-rotation":e.lockRotation&&this.graphSettings.setProperty("speed3D",0),this.graphSettings.setProperty("userLockedRotation",e.lockRotation);break;case"toggle-complex-mode":{let S=this.getState({avoidBackMigration:!0});S.graph.complex=!S.graph.complex,S.graph.degreeMode=!1,this.setState(S,{allowUndo:!0});break}case"set-axis-limit-latex":this._setAxisLimitLatex(e.limit,e.latex),e.updateYZAlso&&(this._setAxisLimitLatex(e.limit==="xmin"?"ymin":"ymax",e.latex),this._setAxisLimitLatex(e.limit==="xmin"?"zmin":"zmax",e.latex)),this.lastDirectlyEditedViewport=(T=this.getGrapher())==null?void 0:T.getCurrentViewport();break;case"toggle-graph-settings":this.layoutModel={...this.layoutModel,graphSettingsOpen:!this.layoutModel.graphSettingsOpen},Ir(this.listModel,void 0),e.focusOnOpen&&(this.layoutModel.graphSettingsOpen?this.is3dProduct()?Rr(this,{type:"settings",location:"reverse-contrast"}):this.getGraphSettings().config.projectorMode?Rr(this,{type:"settings",location:"large-size"}):Rr(this,{type:"settings",location:"default-size"}):Rr(this,{type:"settings",location:"icon"}));break;case"close-graph-settings":this.layoutModel={...this.layoutModel,graphSettingsOpen:!1},e.focusIconAfterClose&&Rr(this,{type:"settings",location:"icon"});break;case"toggle-add-expression":this.layoutModel.addInferenceOpen?this.closeAddInferenceWizard():(this.layoutModel={...this.layoutModel,addExpressionOpen:!this.layoutModel.addExpressionOpen,addInferenceOpen:!1},e.focusOnOpen&&this.layoutModel.addExpressionOpen&&Rr(this,{type:"add-expression-btn"}));break;case"close-add-expression":this._closeAddExpression(),e.focusIconAfterClose&&Rr(this,{type:"add-item-btn"});break;case"ui/container-resized":this.layoutMeasurements={width:e.size.width,height:e.size.height},this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;break;case"enter-printmode":this.inPrintMode=!0;break;case"exit-printmode":this.inPrintMode=!1;break;case"expression-size-exceeded":this._showToast({message:this.s("graphing-calculator-text-toast-expression-size-limit")});break;case"keypad/set-layout":this.layoutModel={...this.layoutModel,keypadLayout:e.layout,keypadFunctionsOpen:!1};break;case"keypad/set-minimized":this.layoutModel={...this.layoutModel,keypadMinimized:e.minimized,keypadLayout:"mainNumbers"},this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this.needsFakeKeypad()||eZ(this),_e(e.minimized?this.s("graphing-calculator-narration-keypad-hidden"):this.s("graphing-calculator-narration-keypad-visible"));break;case"keypad/type-text":this.layoutModel={...this.layoutModel,keypadFunctionsOpen:!1},this.runAfterDispatch(()=>{let S=Qe.getFocusedMathquill();S&&Qe.canAcceptText(S,this.getCapExpressionSize(),e.text)&&(S.typedText(e.text),Qe.simulateUserChangedLatex(S))});break;case"keypad/press-key":this.layoutModel={...this.layoutModel,keypadFunctionsOpen:!1},this.runAfterDispatch(()=>{let S=Qe.getFocusedMathquill();S&&Qe.simulateKeypressFromKeypad(S,e.key)});break;case"keypad/audio-trace":this.handleAudioTraceCommand(e.command);break;case"set-audio-trace-speed":this.setAudioTraceSpeed(e.speed);break;case"keypad/custom-command":this.layoutModel={...this.layoutModel,keypadFunctionsOpen:!1},this.runAfterDispatch(()=>{let S=Qe.getFocusedMathquill();S&&(cV(S,e.command,{capExpressionSize:this.getCapExpressionSize()}),Qe.simulateUserChangedLatex(S))});break;case"keypad/shift":this.layoutModel={...this.layoutModel,keypadLayout:Koe(this.getKeypadLayout()),keypadFunctionsOpen:!1};break;case"keypad/123":this.layoutModel={...this.layoutModel,keypadLayout:"mainNumbers",keypadFunctionsOpen:!1};break;case"keypad/abc":this.isQwertyKeyboardEnabled()?this.layoutModel={...this.layoutModel,keypadLayout:"letters",keypadFunctionsOpen:!1}:this.layoutModel={...this.layoutModel,keypadLayout:"noQwertyLetters",keypadFunctionsOpen:!1};break;case"keypad/audio":this.layoutModel={...this.layoutModel,keypadMinimized:!1,keypadLayout:"audio",keypadFunctionsOpen:!1};break;case"keypad/functions":this.layoutModel={...this.layoutModel,keypadFunctionsOpen:!this.isKeypadFunctionsPopoverOpen()};break;case"grapher/drag-start":break;case"grapher/drag-move":break;case"grapher/drag-end":break;case"open-on-web":this._openOnWeb();break;case"file-is-dragged-over":this.listModel.openItemMenu=void 0,this.layoutModel={...this.layoutModel,isFileDraggedOver:!0};break;case"file-is-not-dragged-over":this.layoutModel={...this.layoutModel,isFileDraggedOver:!1};break;case"zoom":(E=this.getGrapher())==null||E.viewportController.zoom(e.direction);break;case"set-hovered-image":{let S=this.getItemModel(e.id);if(!S||S.type!=="image")return;KI(S,"hoveredImage",e.url)}break;case"set-depressed-image":{let S=this.getItemModel(e.id);if(!S||S.type!=="image")return;KI(S,"depressedImage",e.url)}break;case"clickable-item-clicked":this.handleClickableItemClicked(e.id,e.listIndex);break;case"action-single-step":{let S=this.getItemModel(e.id);if(!S||S.type!=="expression"||!S.formula.action_value)return;this.evaluator.addActionStepEvent(S.id)}break;case"update-expression-search-str":this.updateExpressionSearchStr(e.str);break;case"update-expression-replace-str":this.updateExpressionReplaceStr(e.str);break;case"rename-identifier-global":mp(this.listModel,e.search,e.replace);break;case"rename-identifier-in-item":let N=this.getItemModel(e.id);N&&N.type==="folder"?mp(this.listModel,e.search,e.replace,{limitToFolder:e.id}):mp(this.listModel,e.search,e.replace,{limitToItem:e.id});break;case"update-ticker-handlerlatex":this.updateTickerHandlerLatex(e.latex);break;case"update-ticker-minsteplatex":this.updateTickerMinStepLatex(e.latex);break;case"set-braille-mode":this.setBrailleMode(e.mode);break;case"set-six-key-input":this.setSixKeyInput(e.useSixKeyInput);break;case"set-show-constructions-open":if(this.showConstructionsOpen=e.open,e.setFocus)if(!e.open)Rr(this,{type:"geo-show-constructions-icon"});else for(let S in this.cachedGeoTokenInfo){let{calcId:A}=this.cachedGeoTokenInfo[S];if(this.getItemModel(A)){Rr(this,{type:"geo-token",identifier:S});break}}break;case"select-geo-tool":this.listModel.openItemMenu=void 0,this.setGeoTool(e.tool),e.forceSingleUse&&this.geoModel.markCurrentToolSingleUse(),__dcg_shared_module_exports__['Pc'](e.tool)||e.tool==="selection"||Ir(this.listModel,void 0),e.focusGraphPaper&&this.setGraphPaperFocus({isFocused:!0}),this.closeToast();break;case"cancel-geo-toolplay":this.cancelGeoToolplay(),this.geoModel.getNonObjectsState().ui.currentTool.forceSingleUse&&this.setGeoTool("selection");break;case"update-click-to-insert-mode":this.getGeoModel().setClickToInsertMode(e.clickToInsertMode);break;case"commit-geo-objects":{let S=[],A=[],O=this.findLastSubscriptForLetters(),B={},V=ae=>{let $=B[ae];if($)return $.assignmentLatex;let se=this.getItemModel(ae);if(!se||se.type!=="expression")return ae;let J=this._autoNameExpression(se,O);return $=B[ae]={model:se,assignmentLatex:J},$.assignmentLatex},K=[],oe=YU(e.committed,{isBeingCommitted:!0,getVariableNameForId:V});for(let ae in e.committed){let $=e.committed[ae];__dcg_shared_module_exports__['Pc']($.type)&&K.push(ae);let se=oe[ae];(se==null?void 0:se.type)==="assignment"&&(se.sliderInfo?A.push({latex:se.latex,color:se.color,sliderInfo:se.sliderInfo}):S.push({...se,tokenId:ae}))}let Z=this.listModel.__toolPreviewIdToModel;if(S.length){let ae=this.getGeometryFolder(),$=ae?ae.index+this.getNumberOfItemsInFolder(ae.id)+1:0;S.forEach(se=>{var ye;let J;for(let Se in Z){let Ce=Z[Se];if(((ye=Go(Ce))==null?void 0:ye.latex)===se.tokenId){J=Ce;break}}J?(J.latex=se.latex,J.color=se.color,J.showLabel=!!se.showLabel,J.showAngleLabel=se.showAngleLabel!==!1,ae&&(J.folderId=ae.id)):J=this.createItemModel({id:this.generateId(),type:"expression",showLabel:se.showLabel,showAngleLabel:se.showAngleLabel,latex:se.latex,folderId:ae&&ae.id,color:se.color}),ae?(cn(this.listModel,J,$),$+=1):Dl(this.listModel,J),this.getGeoModel().recordCommittedOutput(J.id)})}A.forEach(ae=>{let $;for(let se in Z){let J=Z[se];if(J.latex===ae.latex){$=J;break}}$?($.latex=ae.latex,$.color=ae.color,nb($,ae.sliderInfo.min),ab($,ae.sliderInfo.max)):$=this.createItemModel({id:this.generateId(),type:"expression",latex:ae.latex,color:ae.color,slider:{hardMin:!0,hardMax:!0,min:ae.sliderInfo.min,max:ae.sliderInfo.max}}),cn(this.listModel,$,0),this.getGeoModel().recordCommittedOutput($.id)}),K.length===1&&this.transformAllSelectedItemsByAssignmentLatex(K[0]),(this.geoModel.isCurrentToolSingleUse()||e.clearToolAndSelection)&&this.setGeoTool("selection"),e.clearToolAndSelection&&Ir(this.listModel,void 0);let ee=e.toolIdToLatex[1],ue=oe[ee],he=(ue==null?void 0:ue.type)==="inline"?ue.rhs:ee;if(this.geoModel.getToolMode()==="expression-edit"&&he){let ae=UU(he,V);this.writeIdentifierIntoCurrentMathquill(ae)}this.isGeometry()&&this.getGeoModel().updateFadeAnimations()}break;case"rename-identifier":{let S=e.from,A=e.to,O=__dcg_shared_module_exports__['wb'](S),B=this.getGeometryFolder();B&&this.getItemsByIdentifier(O).forEach(V=>{e.geoFolder&&V.folderId!==B.id?(In(V,B.id),Ag(this.listModel,V.index,B.index+1,1)):!e.geoFolder&&V.folderId===B.id&&(Ag(this.listModel,V.index,B.index+this.getNumberOfItemsInFolder(B.id),1),In(V,""))}),mp(this.listModel,S,A)}break;case"set-active-token":this.activeTokens[e.style]=e.identifier;break;case"unset-active-token":this.activeTokens[e.style]===e.identifier&&(this.activeTokens[e.style]=void 0);break;case"select-expression-that-defines-token":{let S=this.getExpressionIdForIdentifier(e.identifier);if(!S||(this.setGeoTool("selection"),this.isItemNotSelectableBecauseItsSecret(S)))return;e.multiSelectMode||e.toggle?t3(this.listModel,S,"selected"):this.tryInsertTokenIntoMathquill(S,void 0)||Ir(this.listModel,this.getItemModel(S))}break;case"close-expression-search":this.closeExpressionsSearch();break;case"open-expression-search":this.expressionSearchOpen=!0,this.focusLocation={type:"search-expressions"};let Y=e.latex;e.rename&&!Fa(Y)&&(Y="");let z=e.rename?Y?`\\operatorname{rename}\\ ${Y}\\to`:"\\operatorname{rename}\\ ":Y;this.updateExpressionSearchStr(z);break;case"open-ticker":this.listModel.ticker.open=!0,this.focusLocation={type:"ticker",location:"handler"},this._closeAddExpression();break;case"close-ticker":this.listModel.ticker.open=!1,this.listModel.ticker.playing=!1,this.listModel.ticker.minStepLatex="",this.listModel.ticker.handlerLatex="";break;case"toggle-ticker":this.listModel.ticker.playing=!this.listModel.ticker.playing,this.listModel.ticker.lastTickTime=void 0,this.pauseAllSliders();break;case"set-tool-preview-state":this.setToolPreviewState(e.state);break;case"apply-transformation-to-selected":this.transformAllSelectedItemsByAssignmentLatex(e.assignmentLatex),this.closeItemSettingsMenu();break;case"set-geometry-toolbar":{ZH(this.geometryToolbarModel,e.toolbar);break}case"set-geometry-custom-toolbar-setting":{GI(this.geometryToolbarModel,e.tool,e.value);break}case"set-author-mode":{this.setAuthorMode(e.enabled);break}case"set-translucent-surfaces":{this.getGraphSettings().config.setProperty("translucentSurfaces",e.value);break}case"set-perspective-distortion":{this.getGraphSettings().config.setProperty("perspectiveDistortion",e.value),(I=this.grapher3d)==null||I.redrawAllLayers();break}case"mute-global":case"unmute-global":{e.type==="unmute-global"&&this.runAfterDispatch(()=>{var S;(S=this.getAudioGraph())==null||S.exitAudioTrace()}),(_=this.toneController)==null||_.handleAction(e),this.getGraphSettings().config.setProperty("muted",e.type==="mute-global");break}case"mark-too-complex-for-gl":{for(let S of e.errors){let A=this.getItemModel(S);A&&A.type==="expression"&&(A.expressionTooComplex=!0)}for(let S of e.fixed){let A=this.getItemModel(S);A&&A.type==="expression"&&(A.expressionTooComplex=!1)}break}case"update-legacy-random-seed-behavior":{this.setIncludeFunctionParametersInRandomSeed(!0),this.setState(this.getState({avoidBackMigration:!0}),{allowUndo:!0});break}case"export-latex-to-explist":{let S=this.createItemModel({type:"expression",id:this.generateId(),latex:e.latex,color:e.color});this.layoutModel.openPopoverGuid=void 0,e.indexToInsert?cn(this.listModel,S,e.indexToInsert):Dl(this.listModel,S),this.setEditListMode(!1),ko(this,S.id);break}case"create-table-regression":{let S=this.getItemModel(e.tableId);if((S==null?void 0:S.type)==="table"&&this.areTableRegressionsEnabled()){let A=e.columnIds;if(!A){let O=S.columnModels.slice(1).filter(B=>ju(B)&&Tg(B));if(O.length===0)break;A={x:S.columnModels[0].id,y:O[0].id}}w0(S,{type:e.regressionType,columnIds:A,id:this.generateId(),color:this.getNextColor(),lineStyle:__dcg_shared_module_exports__['Dd'].SOLID,hidden:!1,isLogMode:this.areLogModeRegressionsDefault()||this.areLogModeRegressionsForced(),residualVariable:void 0}),Rr(this,{type:"table-regression-type-dropdown",id:e.tableId})}break}case"remove-table-regression":{let S=this.getItemModel(e.tableId);if((S==null?void 0:S.type)==="table"){if(((D=(C=S.formula)==null?void 0:C.table_regression)==null?void 0:D.status)==="success"){let O=S.formula.table_regression.result.residualVariable;if(O){let B=S.columnModels.findIndex(V=>V.latex===O);B>=0&&y0(S,B)}}w0(S,void 0),Rr(this,{type:"add-table-regression-btn",id:e.tableId})}break}case"update-table-regression":{let S=this.getItemModel(e.tableId);if((S==null?void 0:S.type)==="table"&&S.regression){let A={...S.regression,...e.update};w0(S,A)}break}case"export-table-regression":{this.exportTableRegression(e.mode,e.tableId);break}case"export-inference-item-to-expression-list":{this.exportInferenceItem(e.item,e.id),this.layoutModel.openPopoverGuid=void 0;break}case"set-table-regression-dropdown-open":e.open?this.layoutModel.tableRegressionsDropdownOpenForTableId=e.tableId:this.layoutModel.tableRegressionsDropdownOpenForTableId=void 0;break;case"set-popover-open":e.open?this.layoutModel.openPopoverGuid=e.guid:this.layoutModel.openPopoverGuid===e.guid&&(this.layoutModel.openPopoverGuid=void 0);break;case"expand-evaluation":let X=this.getItemModel(e.id);Ir(this.listModel,X),this.expandedEvaluationId=e.id;break;case"collapse-evaluation":e.id===this.expandedEvaluationId&&(this.expandedEvaluationId=void 0);break;case"run-within-dispatch":e.cb();break;case"request-full-evaluation":this.isCurrentlyDoingRestoreState=!0;break;case"set-visual-viewport-zoom":this.visualViewportZoom=e.zoom;break;default:return e}}areTableRegressionsEnabled(){return this.getGraphSettings().config.tableRegressions}isTableRegressionsDropdownOpen(e){return this.layoutModel.tableRegressionsDropdownOpenForTableId===e}switchAxisScale(e,t){var i;if(!t||t===this.graphSettings[e])return;this.graphSettings.setProperty("polarMode",!1);let o;this.getAllItemModels().forEach(n=>{if(this.isExpressionZoomFit(n)){if(!this.getBoundingBoxesForZoomFit(n))return;o=n.id}}),this.graphSettings.setProperty(e,t),(i=this.getGrapher2d())==null||i.getProjection().updateScalePairs(),!(o&&this._expressionZoomFit(o,{focusAfterTap:!1,synchronous:!0,justResiduals:!1}))&&this.enforceAxisLimitsForScale(e)}enforceAxisLimitsForScale(e){let t=this.getGrapher2d();if(!t)return;let o=t.getDefaultViewport();if(!o)return;e==="xAxisScale"?(this._setAxisLimitLatex("xmin",__dcg_shared_module_exports__['ub'](o.xmin)),this._setAxisLimitLatex("xmax",__dcg_shared_module_exports__['ub'](o.xmax))):(this._setAxisLimitLatex("ymin",__dcg_shared_module_exports__['ub'](o.ymin)),this._setAxisLimitLatex("ymax",__dcg_shared_module_exports__['ub'](o.ymax))),this.graphSettings.xAxisScale===this.graphSettings.yAxisScale&&(this.graphSettings.setProperty("lastChangedAxis",e==="xAxisScale"?"y":"x"),t.viewportController.zoomSquareImmediately(),this.markSquareAxesAfterUserEditedViewport());let i=t.viewportController.getViewport(),n=t.getProjection(),{xmin:a,xmax:s,ymin:c,ymax:d}=i,p=this.getGraphSettings().config.logScales;if(e==="xAxisScale"&&p){let u=n.mapx(a),g=n.mapx(s),h=no(n.reverse_mapx(u-.25),n.reverse_mapx(u+.25)),b=no(n.reverse_mapx(g-.25),n.reverse_mapx(g+.25));this._setAxisLimitLatex("xmin",__dcg_shared_module_exports__['ub'](h)),this._setAxisLimitLatex("xmax",__dcg_shared_module_exports__['ub'](b))}if(e==="yAxisScale"&&p){let u=n.mapy(c),g=n.mapy(d),h=no(n.reverse_mapy(u-.25),n.reverse_mapy(u+.25)),b=no(n.reverse_mapy(g-.25),n.reverse_mapy(g+.25));this._setAxisLimitLatex("ymin",__dcg_shared_module_exports__['ub'](h)),this._setAxisLimitLatex("ymax",__dcg_shared_module_exports__['ub'](b))}this.lastDirectlyEditedViewport=t.getCurrentViewport()}_convertOrCreateTable(e){let t=this.getItemModelByIndex(e),o=$f(t),i=QE(t);if((t==null?void 0:t.type)!=="expression")return;let n=this.isInEditListMode(),a;switch(o){case"point-list":a=Qz(t);break;case"point-list-reference":a=eq(t);break;case"anonymous-function":a=tq(t);break;case"function-reference":a=iq(t);break;case"recursive-function":a=oq(t);break}if(n&&this.setEditListMode(!1),!o||!a){this._showToast({message:this.s("graphing-calculator-text-table-creation-error")}),Er("Convert to table bug",{metaData:{latex:t.latex,type:o}});return}let s={id:this.generateId(),type:"table",readonly:t.readonly,columns:[{...Wu,id:this.generateId(),latex:a.headers[0],values:a.values[0]},{...Wu,id:this.generateId(),latex:a.headers[1],values:a.values[1],color:t.color,lines:!i&&!!t.lines}]},c=this.createItemModel(s);if(i){let p=t.index+1;if(o==="recursive-function"){let u=t.formula.function_definition;for(;this.isBaseCaseItem(p,u);)p++}this._toplevelInsertItemAt(p,c,!0,t.folderId)}else this._toplevelReplaceItemAt(t.index,c,!0);let d=()=>{this.dispatch({type:"undo"}),n&&this.dispatch({type:"set-edit-list-mode",isEditListMode:!0,focusExpressionList:!1})};this._showToast({message:this.s("graphing-calculator-text-table-created"),undoCallback:d}),this.logEvent({category:"convert-to-table",action:o})}isBaseCaseItem(e,t){var i;let o=this.getItemModelByIndex(e);return!o||o.type!=="expression"||!t?!1:((i=o.formula.recursion_base_case)==null?void 0:i.symbol)===t}hasTableHeaderWithIdentifier(e){return!!e&&$W(this.listModel,e)}updateGraphSettingsViewportLimitsLatex(e){this._setAxisLimitLatex("xmin",e.xmin+""),this._setAxisLimitLatex("xmax",e.xmax+""),this._setAxisLimitLatex("ymin",e.ymin+""),this._setAxisLimitLatex("ymax",e.ymax+""),this._setAxisLimitLatex("zmin",e.zmin+""),this._setAxisLimitLatex("zmax",e.zmax+"")}transformAllSelectedItemsByAssignmentLatex(e){var d,p;let t=hM(this.listModel),o=this.findLastTokenNumber()+1,i=this.findLastSubscriptForLetters(),n=this.getGeometryFolder(),a=n?n.index+this.getNumberOfItemsInFolder(n.id)+1:0,s={};for(let u of t){if(u.type!=="expression"||!u.formula.geometry)continue;let h=(d=u.formula.typed_constant_value)==null?void 0:d.valueType;if(!h||__dcg_shared_module_exports__['wa'](h,__dcg_shared_module_exports__['W']))continue;let b=(p=Go(u))==null?void 0:p.latex;b||(b=this._autoNameExpression(u,i));let v=`\\token{${o}}`;o+=1;let T=`${v}=${e}\\left(${b}\\right)`,E=this.createItemModel({id:this.generateId(),type:"expression",showLabel:u.showLabel&&!u.label,showAngleLabel:u.showAngleLabel&&!u.label,latex:T,folderId:n&&n.id,color:u.color});s[E.id]=!0,n?(cn(this.listModel,E,a),a+=1):Dl(this.listModel,E)}let c=Object.keys(s);if(c.length&&r3(this.listModel,s),c.length===1){let u=c[0];this.runAfterDispatch(()=>{this.getItemModel(u)&&this.get2dPOIController().keyboardAttentionManager.updateKeyboardAttention({calcId:u,listIndex:void 0,polygonEdge:void 0},{describe:!1})})}}convertToTokenAssignment(e,t=""){var n;let o=(n=Go(e))==null?void 0:n.latex,i=t?m0(t)||"":"\\token{"+(this.findLastTokenNumber()+1)+"}";o?mp(this.listModel,o,i):Zn(e,i+"="+e.latex)}convertToNamedAssignment(e,t=""){let o=TM(e);if(!o)return;let i=t?m0(t):this.getAutonameLatexForExpression(e);i?mp(this.listModel,o,i):Zn(e,t)}getAutonameLatexForExpression(e,t){if(t||(t=this.findLastSubscriptForLetters()),s3(e)==="point"&&e.label&&Fa(e.label)&&this.countGlobalIdentifierOccurences(e.label)===0)return e.label;let o=Q9(e),i=(t[o]||0)+1;return t[o]=i,o+"_{"+i+"}"}_autoNameExpression(e,t){let o=this.getAutonameLatexForExpression(e,t);return Zn(e,o+"="+e.latex),o}isGeoToolVisible(e,{ignoreAuthorMode:t}={ignoreAuthorMode:!1}){return!t&&this.shouldShowAuthorFeatures()?!0:rb(this.geometryToolbarModel,e)}isGeoToolEnabled(e,{ignoreAuthorMode:t}={ignoreAuthorMode:!1}){return!t&&this.shouldShowAuthorFeatures()?!0:hv(this.geometryToolbarModel,e)}setGeoTool(e){if(!this.geoUIActive||this.activeTool===e||!this.isGeoToolEnabled(e))return;QH(this.geometryToolbarModel,e,this.shouldShowAuthorFeatures()),this.activeTool=e,this.getGeoModel().setToolMode(e),this.cancelGeoToolplay()}cancelGeoToolplay(){var t;let e=this.getGeoModel();e.cancelToolplay(),e.deselectAllObjects(),this.setToolPreviewState({}),(t=this.get2dPOIController())==null||t.cancelGeoToolplay()}setToolPreviewState(e){var i;this.toolPreviewJSONState=e;let t=this.listModel.__toolPreviewIdToModel;this.listModel.__toolPreviewIdToModel={};let o=YU(e,{isBeingCommitted:!1});for(let n in e){let a=e[n],s=o[n];if(!s||s.type!=="assignment")continue;let c;for(let d in t){let p=t[a.type==="expression-edit-preview-latex"?wv:d];if(((i=Go(p))==null?void 0:i.latex)===n){c=p;break}}if(c)c.latex=s.latex,c.color=s.color,c.showAngleLabel=!!s.showAngleLabel,c.hidden=a.hidden;else{let d=a.type==="expression-edit-preview-latex"?this.getSelectedItem():void 0,p=(d==null?void 0:d.type)==="expression"?q0(d,{stripDefaults:!0}):void 0;c=yM({...p,id:a.type==="expression-edit-preview-latex"?wv:this.generateId(),type:"expression",color:s.color,latex:s.latex,showAngleLabel:!!s.showAngleLabel,hidden:a.hidden},this)}this.listModel.__toolPreviewIdToModel[c.id]=c}}isGeoItem(e){let t=this.getItemModel(e);return t&&t.type==="expression"&&t.formula&&t.formula.geometry&&!t.formula.error}getSelectedGeoExpression(){let e=this.getSelectedItem();if(e&&this.isGeoItem(e.id)&&e.type==="expression")return e}getGeometryFolder(){let e=this.getItemModel(__dcg_shared_module_exports__['Zd']);return e&&e.type==="folder"?e:void 0}isItemInGeoFolder(e){let t=this.getItemModel(e);return!t||t.type==="folder"?!1:t.folderId===__dcg_shared_module_exports__['Zd']}isGeoFolder(e){return e.id===__dcg_shared_module_exports__['Zd']}isItemNotSelectableBecauseItsSecret(e){return!(this.shouldShowAuthorFeatures()||this.isItemInGeoFolder(e)||!this.isItemSecret(e))}pauseAllSliders(){this.getPlayingSliders().forEach(e=>{fs(e,!1)})}countGlobalIdentifierOccurences(e){return G0(this.listModel,e)}handleClickableItemClicked(e,t){let o=this.getItemModel(e);Tv(o)&&this.evaluator.addClickEvent(o.id,t)}canAddTicker(){return!this.getTickerOpen()}doesIdentifierBlockActionUpdate(e){let t=this.getFocusLocation(),o=Dg(this.listModel,e);for(let i of o)if((t==null?void 0:t.type)==="expression"&&t.id===i.id||r7(i))return!0;return!1}getItemsByIdentifier(e){return Dg(this.listModel,e)}isAtLeastOnePointSelected(){let e=this.getAllSelectedItems();for(let t=0;t<e.length;t++){let o=e[t];if(o.type==="expression"&&$c(o))return!0}return!1}toggleLabelForAllSelectedObjects(){let e=[],t=[];this.getAllSelectedItems().forEach(o=>{o.type==="expression"&&$c(o)&&(o.showLabel?t.push(o):e.push(o))}),e.length?this.setLabelStateForObjects(e,"measurement"):t.length&&this.setLabelStateForObjects(t,"none")}setLabelStateForObjects(e,t){let o=/^([A-Z])([0-9]*)$/;if(t==="auto"){let i=0;this.getAllItemModels().forEach(n=>{if(n.type!=="expression"||!n.showLabel||!n.label)return;let a=n.label.match(o);if(!a)return;let s=a[1].charCodeAt(0)-65;a[2]&&(s+=parseInt(a[2])*26),s>=i&&(i=s+1)}),e.forEach(n=>{if(!n.label){let a=i;i++;let s=String.fromCharCode(a%26+65),c=Math.floor(a/26),d=c>0?c+"":"";fp(n,s+d)}Vg(n,!0)})}else if(t==="measurement")for(let i of e)fp(i,""),Vg(i,!0);else if(t==="none")for(let i of e)o.test(i.label)&&fp(i,""),Vg(i,!1)}updateLatexForIdentifier(e,t){let o=Dg(this.listModel,e);if(o.length===1){let i=o[0];i.slider.isPlaying?(fs(i,!1),Zn(i,t),fs(i,!0)):Zn(i,t)}}updateExpressionSearchStr(e){this.rawExpressionSearchStr=e;let t="\\operatorname{rename}";if(e.indexOf(t)===0){let i=e.slice(t.length).replace(/\\ /g,"").split(/\\to(?![a-zA-Z])/);i.length===2?(this.expressionSearchStr=i[0],this.isExpressionSearchStrValidForReplace=Fa(this.expressionSearchStr),this.updateExpressionReplaceStr(i[1])):(this.expressionSearchStr=i[0],this.isExpressionSearchStrValidForReplace=!1,this.updateExpressionReplaceStr(""));let n=JW(this.listModel,this.getExpressionSearchStr());this.expressionSearchCount=this.expressionSearchOpen?n:0}else this.expressionSearchStr=e.length>1&&"rename".indexOf(e)===0?"":e,this.isExpressionSearchStrValidForReplace=!1,this.updateExpressionReplaceStr(""),this.filterItemsBySearch()}closeExpressionsSearch(){var o;if(this.expressionSearchOpen=!1,this.updateExpressionSearchStr(""),((o=this.getFocusLocation())==null?void 0:o.type)==="ticker")return;let e=this.getFirstSelectedItem(),t=this.getItemModelByIndex(0);!e&&t&&ko(this,t.id,"end"),e&&this.getSelectedItem()&&!this.getFocusedItem()&&ko(this,e.id,"end"),(e||t)&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0)}filterItemsBySearch(){if(!this.getExpressionReplaceStr()){let e=QW(this.listModel,this.getExpressionSearchStr());this.expressionSearchCount=this.expressionSearchOpen?e:0}}updateExpressionReplaceStr(e){this.expressionReplaceStr=e,this.isExpressionReplaceStrValidForReplace=Fa(e)}getIsExpressionSearchStrValidForReplace(){return this.isExpressionSearchStrValidForReplace}getIsExpressionReplaceStrValidForReplace(){return this.isExpressionReplaceStrValidForReplace}isSearchReplaceValid(){return this.getIsExpressionSearchStrValidForReplace()&&this.getIsExpressionReplaceStrValidForReplace()}shouldShowReplaceIcon(){return this.isSearchReplaceValid()}updateTickerHandlerLatex(e){this.listModel.ticker.handlerLatex=e}updateTickerMinStepLatex(e){this.listModel.ticker.minStepLatex=e}getRawExpressionSearchStr(){return this.rawExpressionSearchStr||""}getExpressionSearchStr(){return this.expressionSearchStr||""}getExpressionReplaceStr(){return this.expressionReplaceStr||""}getExpressionSearchCount(){return this.expressionSearchCount||0}getTicker(){return this.listModel.ticker}getTickerHandlerLatex(){return this.listModel.ticker.handlerLatex||""}getTickerMinStepLatex(){return this.listModel.ticker.minStepLatex||""}getTickerAvgDelta(){return this.listModel.ticker.avgDelta}getBrailleMode(){return this.graphSettings.config.brailleMode}setBrailleMode(e){this.graphSettings.config.setProperty("brailleMode",e)}getSixKeyInput(){return this.graphSettings.config.sixKeyInput}setSixKeyInput(e){this.graphSettings.config.setProperty("sixKeyInput",e)}getBrailleControls(){return this.graphSettings.config.brailleControls}setBrailleControls(e){this.graphSettings.config.setProperty("brailleControls",e)}dispatchExpressionSizeExceeded(){this.dispatch({type:"expression-size-exceeded"})}getAudio(){return this.graphSettings.config.audio}setAudio(e){this.graphSettings.config.setProperty("audio",e)}getReconciledReportPosition(){let{reportPosition:e}=this.graphSettings.config,{showXAxis:t,showYAxis:o}=this.graphSettings;return e!=="default"?e:t||o?"coordinates":"percents"}setEditListMode(e){this.layoutModel={...this.layoutModel,inEditListMode:e}}generateTableXSubscript(){return dM(this.listModel)}findLastTokenNumber(){return e9(this.listModel)}findLastSubscriptForLetters(){return t9(this.listModel)}_createTableItem(){let e=this.generateTableXSubscript(),t=bF(e,[[],[]],this);return this.createItemModel(t)}_populateSettingsViewLimitLatex(){let e=this.getGrapher();if(!e)return;let t=e.getCurrentViewport();this.isGraphSettingsOpen()&&__dcg_shared_module_exports__['db'](t,this.lastDirectlyEditedViewport)||(this.settingsViewModel={...this.settingsViewModel,limitLatex:joe(t,{steps:this.getAxisStepSettings(),scales:this.getAxisScaleSettings()})})}getAxisStepSettings(){return{xAxisStep:this.graphSettings.xAxisStep,yAxisStep:this.graphSettings.yAxisStep}}getAxisScaleSettings(){return{xAxisScale:this.graphSettings.xAxisScale,yAxisScale:this.graphSettings.yAxisScale}}getDefaultAxisScaleSettings(){var t,o;let{defaultState:e}=this.graphSettings;return{xAxisScale:((t=e==null?void 0:e.graph)==null?void 0:t.xAxisScale)||"linear",yAxisScale:((o=e==null?void 0:e.graph)==null?void 0:o.yAxisScale)||"linear"}}getSettingsViewModel(){return this.settingsViewModel}getListModel(){return this.listModel}getGeometryToolbarModel(){return this.geometryToolbarModel}hasBackgroundColor(){return this.getBackgroundColor()!=="#ffffff"}getBackgroundColor(){return this.getGraphSettings().getConfiguredBackgroundColor()}hasTextColor(){return this.getTextColor()!=="#000000"}getTextColor(){return this.getGraphSettings().getConfiguredTextColor()}getPillboxBackgroundColor(){return __dcg_shared_module_exports__['sd'](this.getBackgroundColor(),-.07)}subscribeToChanges(e){let t=this.nextSubscription;return this.nextSubscription+=1,this.subscriptions[t]=e,()=>{delete this.subscriptions[t]}}updateTheComputedWorld(){var p,u,g,h,b,v,T,E,I;db(this.listModel);let e=this.getSelectedItem();this.expandedEvaluationId!==(e==null?void 0:e.id)&&(this.expandedEvaluationId=void 0);let t=e&&this.activeTool==="expression-edit"&&this.listModel.__toolPreviewIdToModel[wv]&&((p=this.getGrapher())!=null&&p.graphSketches[wv])?"preview":"actual";r9(this.listModel,t),(u=this.grapher2d)==null||u.setTabOrder(this.listModel.tabOrder),(g=this.grapher3d)==null||g.setTabOrder(this.listModel.tabOrder),(h=this.grapher2d)==null||h.setDrawLayers(this.listModel.drawLayers),(b=this.grapher3d)==null||b.setDrawLayers(this.listModel.drawLayers);let o={},i=_=>{var D;let C=(D=Go(_))==null?void 0:D.identifier;C&&(C[0]==="$"||_.formula.geometry)&&C&&(o[C]?o[C].multiple=!0:o[C]={model:_,multiple:!1})};for(let _ of this.getAllToolPreviewItems())EM(_),i(_);for(let _ of this.getAllItemModels())switch(_.type){case"expression":EM(_),this.createOrUpdateComputedInferenceModelsFromExpression(_),i(_);break;case"image":pW(_);break;case"table":Pq(_);break;case"folder":pH(_);break;case"text":CW(_);break;default:return _}for(let _ in this.inferenceUIData.inferenceObjectModels)id(this.listModel,_)||(Object.values(this.inferenceUIData.inferenceObjectModels[_]).forEach(C=>pM(this.listModel,C)),delete this.inferenceUIData.inferenceObjectModels[_]);for(let _ of this.getAllInferenceUiExpressions())EM(_),i(_);this.geoUIActive=this.isGeometry()&&!this.getGraphSettings().config.hideGeoUI,this.cachedGeoTokenInfo={};for(let _ in o){let{multiple:C,model:D}=o[_],P="blue",F="unknown",N="unknown",Y=!1,z=!1,X=!1,q=ji(D);!C&&D?(P=Eg(D),Y=Z9(D),N=t7(D),F=s3(D),D.error&&(z=!0,P="#")):(F="error",z=!0),F&&D?this.isItemSelected(D.id)&&(X=!0):z=!0;let S=(D==null?void 0:D.label)||"";this.cachedGeoTokenInfo[_]={groupType:F,iconType:N,isList:Y,hasError:z,color:P,isSelected:X,isHidden:q,label:S,calcId:D&&D.id||""}}this.cachedGeoTokenDepths={};let{createdDepth:n,firstReferencedDepth:a}=this.geoModel.getComputedBoard().getDepthValues();for(let _ in this.cachedGeoTokenInfo){let{calcId:C}=this.cachedGeoTokenInfo[_],D=this.getItemModel(C);if(!D)continue;let P=_;if(!(_ in n)&&D.type==="expression"&&(C===this.getDraggedItemId()||D===this.getFocusedItem())){let S=D.formula.assignment;S&&S in n&&(P=S)}let F=n[P]||0,N=a[P];N=isFinite(N)?N:0;let Y=Math.max(F,N-1)+"",z=this.cachedGeoTokenDepths[Y];z||(z=[],this.cachedGeoTokenDepths[Y]=z);let X=this.cachedGeoTokenInfo[_];!this.isItemInGeoFolder(D.id)&&(D.readonly||$n(D))||z.push({color:X.color,groupType:X.groupType,identifier:_,calcId:C})}OW(this.listModel.ticker);let s=this.getFocusLocation();if(s&&s.type==="expression"&&s.isFakeGraphFocus&&(this.getValidCursorContext()||Rr(this,{...s,isFakeGraphFocus:void 0})),this.isCurrentFocusLocationValid()||Rr(this,void 0),this.listModel.openItemMenu){let _=this.getOpenMenuIcon();document.body&&_&&document.body.contains(_)||(this.listModel.openItemMenu=void 0)}let c=this.getSelectedItem();c&&!this.getItemModel(c.id)&&Ir(this.listModel,void 0),this._populateSettingsViewLimitLatex(),this.propagateSelection(),this.propagateActiveTokens(),this.isKeypadOpen()||(this.layoutModel={...this.layoutModel,keypadFunctionsOpen:!1}),D9(this.listModel),this.isGeometry()&&c&&c.type==="expression"?this.getValidCursorContext()?(this.setGeoTool("expression-edit"),this.geoModel.updateFadeAnimations()):this.geoModel.getToolMode()==="expression-edit"&&this.setGeoTool("selection"):this.geoModel.getToolMode()==="expression-edit"&&this.setGeoTool("selection"),this.isGeometry()&&this.getGeoModel().updateAvailableInputTypes();let d=this.getValidCursorContext();this.isGeometry()&&this.getGeoModel().getToolMode()==="expression-edit"&&!__dcg_shared_module_exports__['db'](d,this.lastCursorContext)&&this.runAfterDispatch(()=>{var _;(_=this.get2dPOIController())==null||_.replayGeoTapMove()}),this.lastCursorContext=d,(T=(v=this.grapher2d)==null?void 0:v.poiController)!=null&&T.keyboardAttentionManager.getKeyboardAttention()&&!this.isGraphPaperFocused()&&((I=(E=this.grapher2d)==null?void 0:E.poiController)==null||I.keyboardAttentionManager.setKeyboardAttention(void 0)),this.isGeometry()&&(WH(this.geometryToolbarModel),this.isGeoToolEnabled(this.getActiveTool())||this.setGeoTool("selection")),this.runAfterDispatch(()=>{var _,C;this.isThreeDMode()||((_=this.grapher2d)==null||_.audioGraph.checkIfSelectedItemChanged(c?c.id:void 0),this.focusLocation&&this.focusLocation.type!=="graph-paper"&&((C=this.grapher2d)==null||C.audioGraph.exitAudioTrace()))})}getOpenMenuIconSelector(){let e=this.getOpenItemMenu();return e?`[dcg-open-menu-guid="${e.guid}"]`:void 0}getOpenMenuIcon(){let e=this.getOpenMenuIconSelector();return e?this.findEl(e):void 0}propagateSelection(){let e=this.getGrapher();e?this.__lastSelectedIdsForPropagation=Roe(this,e,this.__lastSelectedIdsForPropagation):this.__lastSelectedIdsForPropagation={selected:{},hoistedToTop:{}}}propagateActiveTokens(){var e,t;this.isThreeDMode()||((e=this.grapher2d)==null||e.setActiveToken(this.getExpressionIdForIdentifier(this.activeTokens.selected),"selected"),(t=this.grapher2d)==null||t.setActiveToken(this.getExpressionIdForIdentifier(this.activeTokens.hovered),"hovered"))}getHoveredOrFocusedTokenIdentifier(){if(this.activeTokens.hovered)return this.activeTokens.hovered;let e=this.getFocusLocation();if(e&&e.type==="geo-token")return e.identifier}doesLatexContainToken(e){return e7(e)}getToolPreviewJSONState(){return this.toolPreviewJSONState}removeListOfItems(e){let t={},o=[],i=new Set;return e.forEach(n=>{if(this.isItemReadonly(n))i.add(n);else{let a=ub(this.listModel,n);for(let s of a)t[s.id]||(t[s.id]=!0,o.push(s))}}),{deletedItems:o,readonlyItemsNotDeleted:i.size}}garbageCollectGeo(e,t){if(!this.isGeometry())return;let o=Noe(this,e,t);o.length&&this.removeListOfItems(o)}ensureAtLeastOneVisibleItem(){if(p9(this.listModel)){let e=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});Dl(this.listModel,e)}}getExpressionIdForIdentifier(e){if(!e)return;let t=this.getItemsByIdentifier(e);if(t.length===1)return t[0].id}getValidCursorContext(){var n;let e=this.getSelectedItem();if(!e||e.type!=="expression")return;let t=e.formula.cursor_context,o=(n=Qe.getFocusedMathquill())==null?void 0:n.selection(),i=(e==null?void 0:e.type)==="expression"&&e.latex===(t==null?void 0:t.selection.input)&&(o==null?void 0:o.startIndex)===(t==null?void 0:t.selection.start)&&(o==null?void 0:o.endIndex)===(t==null?void 0:t.selection.end)&&(o==null?void 0:o.latex)===(t==null?void 0:t.selection.input);if(this.getGeoModel().getClickToInsertMode()==="permissive")return{type:"permissive",allowedTypes:[__dcg_shared_module_exports__['A']],cursorContext:i?t:void 0};if(i){if((t==null?void 0:t.type)==="expression-arguments"){let{argIndex:a,positionWithinArg:s}=t;if(!(a===t.argCount-1&&s==="end"||t.positionWithinArg==="start-to-end"&&(o==null?void 0:o.startIndex)!==void 0&&(o==null?void 0:o.startIndex)===(o==null?void 0:o.endIndex)))return}return t}}tryInsertTokenIntoMathquill(e,t){if(!this.isGeometry()||!e)return!1;let o=this.getItemModel(e);if(!o||o.type!=="expression")return!1;let i=o.formula.typed_constant_value;t===0&&(!i||!__dcg_shared_module_exports__['qa'](i.valueType))&&(t=void 0);let n,a,s=Pg(o);if(s?a=__dcg_shared_module_exports__['vb'](s):o.formula.geometry&&(a=this.getAutonameLatexForExpression(o),n=a),!a)return!1;t!==void 0&&(a+="\\left["+(t+1)+"\\right]");let c=this.getFocusLocation();return!c||!this.seemsLikeInsertingTokenWillImproveThings(i==null?void 0:i.valueType)?!1:c.type==="expression"?(n&&(co(o)===__dcg_shared_module_exports__['Gd'].NONE&&o.dragMode===__dcg_shared_module_exports__['Gd'].AUTO&&Fv(o,__dcg_shared_module_exports__['Gd'].NONE),Zn(o,n+"="+o.latex)),this.writeIdentifierIntoCurrentMathquill(a),!0):!1}seemsLikeInsertingTokenWillImproveThings(e){let t=this.getValidCursorContext();if(t){if(!e)return!1;let o=__dcg_shared_module_exports__['sa'](e);return t.type==="empty"&&__dcg_shared_module_exports__['ta'](o)?!1:(t.type==="expression-arguments"?t.allowedTypesForInsertedArg:t.allowedTypes).some(n=>__dcg_shared_module_exports__['y'](o,n))}return!1}writeIdentifierIntoCurrentMathquill(e){this.runAfterDispatch(()=>{let t=Qe.getFocusedMathquill();if(!t)return;let o=this.getValidCursorContext(),i=(o==null?void 0:o.type)==="permissive"?o.cursorContext:o,n="",a="";(i==null?void 0:i.type)==="expression-arguments"&&((i==null?void 0:i.positionWithinArg)==="end"?n=",":(i==null?void 0:i.positionWithinArg)==="start"&&(a=","));let s=`${n}${e}${a}`,c=!1;if((i==null?void 0:i.type)==="expression-arguments"&&i.polygonVertices){let{argIndex:d,polygonVertices:p,positionWithinArg:u}=i;(e===p.firstLatex||e===p.lastLatex)&&(u==="end"||u==="start-to-end")&&d===i.argCount-1&&(s="",c=!0)}else(i==null?void 0:i.type)==="expression-arguments"&&(c=i.isLastValidArg);Qe.canAcceptText(t,this.getCapExpressionSize(),s)&&(t.write(s),Qe.simulateUserChangedLatex(t),c&&t.keystroke("Right"))})}getSelectedExpressionIds(){return h9(this.listModel)}hasTentativeSelection(){return w9(this.listModel)}getPropagatedSelectedIds(){return this.__lastSelectedIdsForPropagation}areParsableObjectsEqual(e,t){return e===t?!0:__dcg_shared_module_exports__['db']({...e,regressionParameters:void 0},{...t,regressionParameters:void 0})}requestParseForAllItems(){var i,n,a;(this.isCurrentlyDoingSetState||this.isCurrentlyDoingRestoreState)&&(this.lastParsableObjects={},this.evaluator.clearStatementsAndStartCompleteState(),this.isCurrentlyDoingRestoreState&&this.evaluator.markUndoRedoState());let e={},t=this.lastParsableObjects;for(let s of this.getAllItemModels())switch(s.type){case"expression":case"image":case"table":case"folder":e[s.guid]=s.cachedParsableState;break;case"text":break;default:return s}for(let s of jW(this.listModel))e[s.guid]=s.cachedParsableState;for(let s of this.getAllInferenceUiExpressions())e[s.guid]=s.cachedParsableState,e[s.guid].isInferenceUIExpression=!0;for(let s of this.getAllToolPreviewItems()){let c=this.getSelectedItem(),d=this.activeTool==="polygon";if(this.activeTool==="expression-edit"&&(c==null?void 0:c.type)==="expression"&&((n=(i=c.formula.geometry)==null?void 0:i.call)==null?void 0:n.symbol)==="polygon"&&((a=c.formula.cursor_context)==null?void 0:a.type)==="expression-arguments"){let{positionWithinArg:p,argIndex:u}=c.formula.cursor_context;d=(p==="end"||p==="start-to-end")&&u===c.formula.geometry.call.parents.length-1}e[s.guid]={...s.cachedParsableState,shouldOmitLastPolygonSegment:d}}let o=this.getFocusedItem();if((o==null?void 0:o.type)==="expression"){let s=Qe.getFocusedMathquill(),c=s==null?void 0:s.selection();(c==null?void 0:c.latex)===o.latex&&this.shouldEvaluateSelection()&&(e[o.guid]={...o.cachedParsableState,latexSelection:{start:c.startIndex,end:c.endIndex}})}if(this.is3dProduct()&&this.getTranslucentSurfaces())for(let s in e){let c=e[s];c.type==="statement"&&(e[s]={...c,surfaceOpacity:this.getGraphSettings().config.translucentOpacity})}this.listModel.ticker.cachedParsableState&&(e[this.listModel.ticker.guid]=this.listModel.ticker.cachedParsableState);for(let s of jH(this.geometryToolbarModel))e[s.id]=s;for(let s in t){let c=t[s],d=e[s];if((c==null?void 0:c.type)==="image"&&(!d||d.type!==c.type||d.guid!==c.guid)&&this.grapher2d&&this.grapher2d.removeGraphImage(c.id),!d&&(this.evaluator.removeStatement(c.id),c.type==="table"))for(let p of c.columns)this.evaluator.removeStatement(p.id)}for(let s in e){let c=e[s],d=t[s];if((c==null?void 0:c.type)==="image"&&(!d||c.type!==d.type||c.guid!==d.guid)&&this.grapher2d){let p=this.getItemModel(c.id);p&&p.type==="image"&&this.grapher2d.addGraphImage(p)}this.areParsableObjectsEqual(c,d)||(this.grapher2d&&c.type==="statement"&&c.latex===""&&this.grapher2d.removeGraphSketch(c.id),this.evaluator.addStatement(c))}this.lastParsableObjects=e}getViewState(){let e=this.getGrapher();if(e){let t=e.getProjection();return{viewport:t.viewport.toObject(),screen:t.screen,xAxisScale:t.settings.xAxisScale,yAxisScale:t.settings.yAxisScale,degreeMode:t.settings.degreeMode}}else return}getTokenRenderInfoByIdentifier(e){let t=this.cachedGeoTokenInfo[e];return t||(t={iconType:"unknown",isList:!1,hasError:!0,isSelected:!1,groupType:"unknown",color:"",isHidden:!1,label:"",calcId:""}),t}getTokenController(){return this}setEvaluator(e){this.evaluator=e,e.clearSlowEvaluatorTracking=this.clearSlowEvaluatorTracking.bind(this)}getEvaluator(){return this.evaluator}setGrapher2d(e){this.grapher2d=e}setGrapher3d(e){this.grapher3d=e,this.grapher2d.poiController.add3DTouchEventHandlers(e)}getGrapher(){return this.isThreeDMode()?this.grapher3d:this.grapher2d}getGrapher2d(){return this.grapher2d}getGrapher3d(){return this.grapher3d}get2dPOIController(){var e;return(e=this.grapher2d)==null?void 0:e.poiController}isDefaultViewportRestored(){var e;return!!((e=this.getGrapher())!=null&&e.viewportController.isDefaultViewportRestored())}requestRedrawGraph(){var e,t;(e=this.grapher2d)==null||e.redrawAllLayers(),this.isThreeDMode()&&((t=this.grapher3d)==null||t.redrawAllLayers())}get2dProjection(){var e;return(e=this.grapher2d)==null?void 0:e.getProjection()}get2dSketchOrder(){return this.grapher2d?[...this.grapher2d.generateMergeDrawOrder()]:[]}getBoundingBoxesForZoomFit(e){if(!(!this.grapher2d&&!this.grapher3d)&&this.isZoomFitEnabled()&&!(e.type!=="expression"&&e.type!=="table")&&!(e.type==="expression"&&(e.error||!e.shouldGraph||!e.formula.is_graphable)))return e.boundingBoxes}getBoundingBoxForResidualsZoomFit(e){var t,o;if(!(!this.grapher2d&&!this.grapher3d)&&this.isZoomFitEnabled()&&!(e.type!=="expression"&&e.type!=="table")&&!(e.type==="expression"&&(e.error||!e.formula.is_graphable))){if(e.type==="table"&&((o=(t=e.formula)==null?void 0:t.table_regression)==null?void 0:o.status)==="success"&&e.boundingBoxes){let i=e.formula.table_regression.result.residualVariable;for(let n of e.boundingBoxes)if(n.symbol&&__dcg_shared_module_exports__['vb'](n.symbol)===i)return[n]}if(e.type==="expression"&&e.formula.regression){let i=e.formula.regression.residualVariable;for(let n of this.getAllItemModels())if(n.type==="table"&&n.boundingBoxes){for(let a of n.boundingBoxes)if(a.symbol&&__dcg_shared_module_exports__['vb'](a.symbol)===i)return[a]}}}}isExpressionZoomFit(e){if(this.isThreeDMode())return!1;let t=this.getBoundingBoxesForZoomFit(e),o=this.get2dProjection();return!o||!t?!1:!dV(t,o)&&!!VC(t,o)}getVisualViewportIsZoomed(){return this.visualViewportZoom>1.02}zoomAndPanDisabled(){return this.viewportIsLocked()||this.getVisualViewportIsZoomed()}viewportIsLocked(){return this.getLockViewportConfigSetting()||this.getLockViewportUserSetting()}showExpressionZoomFitButton(e){if(this.viewportIsLocked()||this.isGeometry()||this.is3dProduct())return!1;let t=this.getBoundingBoxesForZoomFit(e),o=this.get2dProjection();return e.type==="expression"&&ik(e)?!1:!!(o&&t&&dV(t,o))}showResidualsZoomFitButton(e){if(this.viewportIsLocked()||this.isGeometry()||this.is3dProduct())return!1;let t=this.getBoundingBoxForResidualsZoomFit(e),o=this.get2dProjection();return!!(o&&t&&dV(t,o))}zoomEnabled(){return this.getGraphSettings().config.zoomButtons&&!this.viewportIsLocked()}onSmallScreen(){let e=this.getLayoutMeasurements();return e.width<450||e.height<450}shouldShowZoomInOutButtons(){return jn&&this.onSmallScreen()?!1:this.zoomEnabled()}shouldShowZoomHomeButton(){return this.zoomEnabled()&&!this.isDefaultViewportRestored()}setBugsnagContext(e){this.bugsnagContext=e}getItemRootNodeById(e){let t=this.getItemModel(e);return t==null?void 0:t.rootViewNode}getItemNodeById(e){return this.getItemRootNodeById(e)}generateId(){let e=this.__nextItemId;return this.__nextItemId+=1,e+""}getNextColor(){return KW(this.listModel)}getNextDisplayIndex(){return this.listModel.nextDisplayIndex}_clearPendingImageUploads(){this.__pendingImageUploads={}}isUploadingImages(){return Object.keys(this.__pendingImageUploads).length>0}getExpressionAnalysis(){return this.listModel.expressionAnalysis}getHelperExpressions(){return n9(this.listModel).map(e=>e.proxy)}createItemModel(e){return vv(this.listModel,e)}getItemModel(e,t){return id(this.listModel,e,t)}getHiddenGeoItemCount(){return d9(this.listModel)}getColorById(e){var o;let t=this.getItemModel(e);return!t||t.type!=="expression"?"":(o=yb(t))!=null?o:""}getAllColorAssignments(){let e=[];for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let o=Pg(t);o&&yb(t)&&e.push({id:t.id,assignmentLatex:__dcg_shared_module_exports__['vb'](o)})}return e}getAllColorFunctionAssignments(){let e=[];if(!this.isBeta3DMode())return e;for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let o=Pg(t),i=a3(t);!o||!i||e.push({id:"shader",assignmentLatex:"shader:"+__dcg_shared_module_exports__['vb'](o)})}return e}getShader(e){for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let o=Pg(t);if(o&&__dcg_shared_module_exports__['vb'](o)===e){let i=a3(t);if(i)return i}}return{source:"",shaderFunctions:{},shaderUniforms:[]}}getItemModelByIndex(e){return Ju(this.listModel,e)}getItemCount(){return Y0(this.listModel)}getItemEditableLabelMode(e){let t=this.getItemModel(e);if(!(!t||t.type!=="expression"))return p7(t)}isItemSecret(e){let t=this.getItemModel(e);return t?xv(t):!1}isItemMarkedReadonly(e){let t=this.getItemModel(e);return t?!this.isListEnabled()&&!this.isItemInGeoFolder(e)?!0:HW(t):!1}isItemReadonly(e){return this.isItemMarkedReadonly(e)&&!this.shouldShowAuthorFeatures()}isItemSelected(e){let t=this.getItemModel(e);return!!t&&Mn(t)}getItemSelectedState(e){return M9(this.listModel,e)}isItemGraphing(e){return this.getEvaluatorStateForItem(e)==="GRAPHING"}getEvaluatorStateForItem(e){return this.evaluator.evaluationProgressById.get(e)}hasAnyItemsSelected(){return this.getAllSelectedItems().length>0}hasMultipleItemsSelected(){return this.getAllSelectedItems().length>1}isItemSelectable(e){let t=this.getItemModel(e);return t?kv(t):!1}anyItemDependsOnRandomSeed(){return C9(this.listModel)}areActionsEnabled(){return this.graphSettings.config.actions==="auto"?E9(this.listModel):!!this.graphSettings.config.actions}getAllItemModels(){return lM(this.listModel)}getAllToolPreviewItems(){return N0(this.listModel)}isToolPreviewItem(e){return i9(this.listModel,e)}getAllModelsWithSliders(){return u9(this.listModel)}getGraphSettings(){return this.graphSettings}getAudioGraph(){var e;if(!this.isThreeDMode())return(e=this.grapher2d)==null?void 0:e.audioGraph}inAudioTraceMode(){let e=this.getAudioGraph();return!!(e&&e.audioTraceActive)}canAudioTrace(){let e=this.getAudioGraph();return e?e.canAudioTraceCurrentExp():!1}isAudioTracing(){let e=this.getAudioGraph();return e?e.isAudioTracing():!1}expressionsAreFullWidth(){return this.isNarrow()||this.graphSettings.config.graphpaper===!1}getExpListWidthString(){return this.expressionsAreFullWidth()?"100%":this.rootElt?this._getExpListWidth()+"px":"0"}getExpListWidth(){return this.rootElt?this._getExpListWidth():0}findFirstVisibleItem(){let e=eoe(this,this._previousFirstVisibleId);if(this._previousFirstVisibleId=e,e)return this.getItemModel(e)}findLastVisibleItem(){let e=toe(this,this._previousLastVisibleId);if(this._previousLastVisibleId=e,e)return this.getItemModel(e)}updateRenderShellsAfterDispatch(){if(!this.rootElt||!this.isListVisible())return;let e=this.findFirstVisibleItem(),t=this.findLastVisibleItem(),o=e&&this.getItemRootNodeById(e.id),i=t&&this.getItemRootNodeById(t.id);if(o===this.lastInfiniteScrollFirstDOM&&i===this.lastInfiniteScrollLastDOM&&!this.hasDispatchSinceLastInfiniteScrollUpdate)return;this.lastInfiniteScrollFirstDOM=o,this.lastInfiniteScrollLastDOM=i,this.hasDispatchSinceLastInfiniteScrollUpdate=!1;let n=!1,a=e?e.index:1/0,s=t?t.index:1/0,c=this.listModel.dragState&&this.listModel.dragState.firstItemId,d,p=this.getOpenItemMenu();p&&p.type!=="multi-select-more"&&p.type!=="multi-select-construct"&&p.type!=="multi-select-style"&&p.type!=="multi-select-label"&&p.type!=="geo-tool-dropdown"&&(d=p.model.id);for(let u of this.getAllItemModels()){let g=(u.index<a||u.index>s||u.isHiddenFromUI)&&!(u.type==="expression"&&u.sliderDragging);if(c==u.id&&(g=!1),d===u.id&&(g=!1),u.renderShell!==g&&(u.renderShell=g,n=!0,g)){let h=this.getItemRootNodeById(u.id);if(h){let b=h.getBoundingClientRect().height;b>0&&(u.cachedRenderHeight=b)}}}n&&this.markTickRequiredNextFrame()}updateRenderShellsBeforePaint(){if(this.hasDispatchSinceLastInfiniteScrollUpdate=!0,this.inPrintMode){for(let t of this.getAllItemModels())t.renderShell=!1;return}for(let t of this.getAllItemModels())t.isHiddenFromUI&&(t.renderShell=!0),t.type==="expression"&&t.sliderDragging&&(t.renderShell=!1);let e=this.getSelectedItem();if(e&&!this.isGeoItem(e.id)){e.renderShell=!1;let t=o9(this.listModel,e.id);if(t>=0){let o=Ju(this.listModel,t+1);o&&!this.isGeoItem(o.id)&&(o.renderShell=!1);let i=Ju(this.listModel,t-1);i&&!this.isGeoItem(i.id)&&(i.renderShell=!1)}}}updateDragDrop(){let e=this.listModel.dragState;if(!e)return;let t=this.getItemModel(e.firstItemId);if(!t)return;let o=this.dragdrop_expressions.applyDrag();o&&(B0(this.listModel,o.dragState),In(t,o.folderId),t.index!==o.newIndex&&Ag(this.listModel,t.index,o.newIndex,e.numberOfItems))}_tickSliders(e){this.getPlayingSliders().forEach(t=>{WF(t,e)})}tickTicker(e){let t=this.listModel.ticker.lastTickTime===void 0;this.evaluator.addClockTickEvent(this.listModel.ticker.id,t),FW(this.listModel.ticker,e)}stopAllSliders(){for(let e of this.getAllItemModels())e.type==="expression"&&e.slider.isPlaying&&fs(e,!1)}getPlayingSliders(){let e=this.getAllItemModels(),t=[];for(let o of e)o.type==="expression"&&o.sliderExists&&o.slider.isPlaying&&t.push(o);return t}areAnyImagesLoading(){return BW(this.listModel)}_commitUserRequestedViewport(e){var t;(t=this.getGrapher())==null||t.setUserRequestedViewport(e)}_setAxisLimitLatex(e,t){this.settingsViewModel={...this.settingsViewModel,limitLatex:{...this.settingsViewModel.limitLatex,[e]:t}};let i=t===""&&(e==="xstep"||e==="ystep")?0:eo(t,this.graphSettings.degreeMode),n=this.getGrapher();switch(e){case"xstep":{if(!e1(i))return;this.graphSettings.setProperty("xAxisStep",i)}break;case"ystep":{if(!e1(i))return;this.graphSettings.setProperty("yAxisStep",i)}break;case"xmin":case"xmax":case"ymin":case"ymax":case"zmin":case"zmax":{if(!n)return;let a=n.viewportController.getViewport(),s="xmin";e==="xmin"&&(s="xmax"),e==="ymax"&&(s="ymin"),e==="ymin"&&(s="ymax"),e==="zmax"&&(s="zmin"),e==="zmin"&&(s="zmax");let c=eo(this.settingsViewModel.limitLatex[s]||"",this.graphSettings.degreeMode),d=Or.fromObject({...a.toObject(),[e]:i,[s]:c});if(!d.isValid(this.getAxisScaleSettings()))return;n.viewportController.setViewport(d);let u;switch(e){case"xmin":case"xmax":u="x";break;case"ymin":case"ymax":u="y";break;case"zmin":case"zmax":u="z";break;default:let g=e;throw new Error(`Invalid limit: ${g}`)}this.graphSettings.setProperty("lastChangedAxis",u),this.markSquareAxesAfterUserEditedViewport()}break}if(n){let a=n.viewportController.getViewport().toObject();this._commitUserRequestedViewport(a)}}unmarkLastChangedAxis(){this.graphSettings.setProperty("lastChangedAxis",void 0)}markSquareAxesAfterUserEditedViewport(){let e=this.getGrapher();if(!e)return;let t=e.viewportController.getViewport(),o=this.isThreeDMode()?t.isSquare3D():t.isSquare(e.getProjection().screen,this.getAxisScaleSettings());this.graphSettings.setProperty("squareAxes",o)}getLockViewportConfigSetting(){return this.graphSettings.config.lockViewport}getLockViewportUserSetting(){return this.graphSettings.userLockedViewport}getLockRotationUserSetting(){return this.graphSettings.userLockedRotation}canUserAddExpressions(){return!!this.graphSettings.config.expressions}areNotesEnabled(){return!!this.graphSettings.config.notes}areSlidersEnabled(){return!!this.graphSettings.config.sliders}areLinksEnabled(){return!!this.graphSettings.config.links}areImagesEnabled(){let e=window.FileReader,t=ha&&Fu&&Fu[0]===8&&Fu[1]===0&&Fu[2]===0;return!!(this.graphSettings.config.images&&e&&!t&&!this.is3dProduct())}areFoldersEnabled(){return!!this.graphSettings.config.folders}isDecimalToFractionEnabled(){return!!this.graphSettings.config.decimalToFraction}isTraceEnabled(){return!!this.graphSettings.config.trace}areFunctionsRestricted(){return!!this.graphSettings.config.restrictedFunctions}areGeometryFunctionsForceEnabled(){return!!this.graphSettings.config.forceEnableGeometryFunctions}isQwertyKeyboardEnabled(){return!!this.graphSettings.config.qwertyKeyboard}isZoomFitEnabled(){return!!this.graphSettings.config.zoomFit}canEditOnWeb(){return!!this.graphSettings.config.editOnWeb}hasTransparentBackground(){return!!this.graphSettings.config.transparentBackground}shouldAudioTraceReverseExpressions(){return!!this.graphSettings.config.audioTraceReverseExpressions}hasDefaultState(){return!!this.graphSettings.defaultState}getDefaultViewport(){var t;let e=this.graphSettings.defaultState;return e&&e.graph?e.graph.viewport:(t=this.getGrapher())==null?void 0:t.getDefaultViewport()}getColors(){return this.isThreeDMode()?__dcg_shared_module_exports__['Ad']:this.graphSettings.config.colors}getImageOpacities(){return["0.2","0.4","0.6","0.8","1"]}getUIDragModes(){return[__dcg_shared_module_exports__['Gd'].X,__dcg_shared_module_exports__['Gd'].Y,__dcg_shared_module_exports__['Gd'].XY]}getNumberOfItemsInFolder(e){return zW(this.listModel,e)}getEnabledDragModesForItem(e){let t=this.getItemModel(e);if(!t||t.type!=="expression")return[];let o=t.formula,i=[];if(!o.move_strategy)return i;let n=o.move_strategy[0].type!=="none",a=o.move_strategy[1].type!=="none",s=n&&a;return n&&i.push(__dcg_shared_module_exports__['Gd'].X),a&&i.push(__dcg_shared_module_exports__['Gd'].Y),s&&i.push(__dcg_shared_module_exports__['Gd'].XY),i}shouldShowEvaluationForItem(e){let t=this.getItemModel(e);return!t||t.type!=="expression"?!1:U9(t)}shouldShowCDFEvaluationForItem(e){let t=this.getItemModel(e);return!t||t.type!=="expression"?!1:N9(t)}canDisplayEvaluationForItemAsFraction(e){var i;if(!this.isDecimalToFractionEnabled())return!1;let t=this.getItemModel(e);if(!t||t.type!=="expression"||eh(t))return!1;let o=(i=t.formula)==null?void 0:i.typed_constant_value;return(o==null?void 0:o.valueType)!==__dcg_shared_module_exports__['B']?!1:__dcg_shared_module_exports__['rb'](o.value)}shouldEvaluationForItemDisplayAsFraction(e){if(!this.isDecimalToFractionEnabled())return!1;let t=this.getItemModel(e);return!t||t.type!=="expression"?!1:Gg(t)}getEvaluationLabelOptionsForItem(e){return{...__dcg_shared_module_exports__['pb'],displayAsFraction:this.shouldEvaluationForItemDisplayAsFraction(e)}}isInEditListMode(){return this.layoutModel.inEditListMode}authorFeaturesAvailable(){return!!this.graphSettings.config.authorFeatures}shouldShowAuthorFeatures(){return this.authorFeaturesAvailable()&&!!this.graphSettings.config.authorMode}shouldIgnoreGraphInteractions(e){return this.shouldShowAuthorFeatures()?!1:$n(e)}toolWillBeHiddenOrDisabled(e){return this.shouldShowAuthorFeatures()&&(!this.isGeoToolVisible(e,{ignoreAuthorMode:!0})||!this.isGeoToolEnabled(e,{ignoreAuthorMode:!0}))}setAuthorMode(e){this.graphSettings.config.setProperty("authorMode",e)}getInvertedColors(){return!!this.graphSettings.config.invertedColors}invertSwatches(){return this.isThreeDMode()&&this.getInvertedColors()}canUseAdvancedStyling(){return this.graphSettings.config.advancedStyling}getDegreeMode(){return this.graphSettings.degreeMode}isThreeDMode(){return this.graphSettings.threeDMode}showPlane3D(){let{threeDMode:e,showAxis3D:t,showPlane3D:o}=this.graphSettings;return e&&t&&o}showNumbers3D(){let{threeDMode:e,showAxis3D:t,showNumbers3D:o}=this.graphSettings;return e&&t&&o}getTranslucentSurfaces(){return!!this.graphSettings.config.translucentSurfaces}getPerspectiveDistortion(){let e=this.graphSettings.config.perspectiveDistortion;return isNaN(e)?1:e<1e-4?0:__dcg_shared_module_exports__['Rb'](e,0,K_)}isBeta3DMode(){return this.isThreeDMode()&&this.getGraphSettings().config.beta3d}areLogModeRegressionsForced(){return this.graphSettings.config.forceLogModeRegressions}areLogModeRegressionsDefault(){return this.graphSettings.config.defaultLogModeRegressions}setAllRegressionsToLogMode(){for(let e of this.getAllItemModels())e.type==="expression"&&e.formula&&e.formula.is_regression&&l3(e,!0)}isGraphSettingsOpen(){return this.layoutModel.graphSettingsOpen}isAddExpressionOpen(){return this.layoutModel.addExpressionOpen}isAddInferenceOpen(){return this.layoutModel.addInferenceOpen}shouldRenderList(){if(this.layoutModel.expressionsVisible)return!0;let e=this.layoutModel.expressionsHiddenTime;return e===void 0?!1:Date.now()-e<=500}isListVisible(){return this.layoutModel.expressionsVisible}isGrapherEnabled(){return this.graphSettings.config.graphpaper!==!1}isListEnabled(){return this.graphSettings.config.expressions!==!1}areDistributionsEnabled(){return this.graphSettings.config.distributions===!0}isExpressionListFocused(){let e=this.getFocusLocation();if(!e)return!1;switch(e.type){case"settings":case"generic-menu":case"expression-menu":case"editable-label":case"geo-token":case"multi-select-more-icon":case"multi-select-construct-icon":case"multi-select-label-icon":case"multi-select-style-icon":case"geo-header-back-link":case"multi-select-show-hide-icon":case"new-transformation-number":case"label-points-icon":case"geo-show-constructions-icon":case"geo-basic-tool":case"geo-basic-tool-menu-item":case"geo-construct-menu-existing-transformations":case"regression-output":case"action-info":case"stats-output":case"graph-paper":case"zoom-in-btn":case"zoom-restore-btn":case"quest":case"global-mute-button":case"color-picker-option":case"multi-select-label-menu-label-input":case"multi-select-options-menu-item":return!1;case"distribution-param":case"slider-limit":case"domain-limit":case"expression":case"visualization-prop":case"search-expressions":case"replace-expressions":case"ticker":case"table":case"image":case"readonly-expression":case"add-table-regression-btn":case"table-regression-delete-btn":case"table-regression-copy-btn":case"table-regression-type-dropdown":case"table-regression-view-source-popover":case"table-regression-model-dropdown":case"table-regression-export-btn":case"regression-plot-residuals-button":case"table-container":case"text":case"folder":case"add-item-btn":case"add-expression-btn":case"add-note-btn":case"add-table-btn":case"add-folder-btn":case"add-ticker-btn":case"add-inference-btn":case"add-inference-wizard":case"add-image-btn":case"change-image-btn":case"edit-list-toggle":case"expression-icon":case"expression-evaluation":case"image-icon":case"slider-icon":case"slider-animation-properties-icon":case"slider-thumb":case"table-icon":case"table-regression-icon":case"action-icon":case"hide-expression-list-btn":case"show-expression-list-btn":case"top-level-icon":case"inference-footer":case"distribution-footer":return!0;default:return e}}needsFakeKeypad(){if(this.inAudioTraceMode()&&this.isKeypadEnabled())return!0;let e=this.getFocusLocation();if(!e||this.getBrailleMode()!=="none"&&_c())return!1;switch(e.type){case"settings":return Woe(e.location);case"new-transformation-number":case"distribution-param":case"slider-limit":case"domain-limit":case"expression":case"visualization-prop":case"search-expressions":case"replace-expressions":case"ticker":return!0;case"add-inference-wizard":return e.subtype==="sample-prop-input";case"expression-menu":return e.location==="opacity"||e.location==="linewidth"||e.location==="lineopacity"||e.location==="pointopacity"||e.location==="pointsize"||e.location==="labelsize"||e.location==="labelangle"||e.location==="updaterule";case"table":{if(this.isInEditListMode())return!1;let o=e.location;if(o.row===0)return!0;let i=this.getItemModel(e.id);if(!i||i.type!=="table")return!1;let n=i.columnModels[o.column];return n?!tv(n):!1}case"image":return e.location!=="name";case"inference-footer":case"distribution-footer":return e.subtype==="mathquill-input";case"readonly-expression":case"add-table-regression-btn":case"table-regression-delete-btn":case"table-regression-copy-btn":case"table-regression-type-dropdown":case"table-regression-view-source-popover":case"table-regression-model-dropdown":case"table-regression-export-btn":case"regression-plot-residuals-button":case"regression-output":case"action-info":case"stats-output":case"graph-paper":case"table-container":case"text":case"folder":case"add-item-btn":case"add-expression-btn":case"add-note-btn":case"add-table-btn":case"add-folder-btn":case"add-inference-btn":case"add-ticker-btn":case"add-image-btn":case"change-image-btn":case"edit-list-toggle":case"hide-expression-list-btn":case"show-expression-list-btn":case"geo-token":case"multi-select-more-icon":case"multi-select-construct-icon":case"multi-select-label-icon":case"multi-select-style-icon":case"geo-header-back-link":case"multi-select-show-hide-icon":case"label-points-icon":case"geo-show-constructions-icon":case"geo-basic-tool":case"geo-basic-tool-menu-item":case"geo-construct-menu-existing-transformations":case"generic-menu":case"zoom-in-btn":case"zoom-restore-btn":case"quest":case"global-mute-button":case"color-picker-option":case"multi-select-label-menu-label-input":case"multi-select-options-menu-item":return!1;case"expression-icon":case"expression-evaluation":case"image-icon":case"slider-icon":case"action-icon":case"slider-animation-properties-icon":case"slider-thumb":case"table-icon":case"table-regression-icon":case"top-level-icon":return!1;case"editable-label":return this.getItemEditableLabelMode(e.id)===__dcg_shared_module_exports__['$d'].Math;default:return e}}isIdentifierRenameValid(e){return Fa(e)?!XW(this.listModel,e):!1}getBrandingMode(){return this.getEditLink()?"static-edit-link":this.getGraphSettings().config.editOnWeb?"edit-link":"powered-by"}getEditLink(){return window.iframeEmbedBrandingLink}_expressionZoomFit(e,t){let o=this.getItemModel(e);if(this.isThreeDMode()||!this.grapher2d||!this.isZoomFitEnabled()||!o||o.type!=="expression"&&o.type!=="table"||(!o.boundingBoxes||!o.boundingBoxes.length)&&!t.justResiduals)return!1;let i=this.grapher2d.viewportController;if(!("zoomCustom"in i))return!1;let n=o.boundingBoxes;if(t.justResiduals){let s=this.getBoundingBoxForResidualsZoomFit(o);s!==void 0&&(n=s)}if(n===void 0)return!1;let a=VC(n,i.getProjection());return a?(t.synchronous?i.setViewport(Or.fromObject(a)):i.zoomCustom(a),t.focusAfterTap&&Rr(this,{type:"zoom-restore-btn"}),!0):!1}_deleteItemAndAnimateOut(e,t){let i=this.getItemNodeById(e);i&&(Yo(i,{transition:.2+"s",opacity:"0",transform:"scale(.1, .1)"}),this._deleteAnimationTimeout=setTimeout(()=>{this.dispatch({type:"finish-deleting-item-after-animation",id:e,setFocusAfterDelete:t})},1e3*.2))}_finishDeletingItemAfterAnimation(e,t){let o=this.getItemModel(e);if(!o)return;let i=this.getItemNodeById(e),n=i&&document.activeElement&&i.contains(document.activeElement),a=R0(this.listModel,o.index);if(this._removeExpressionSynchronously(o),!(!t||!n)){if(!a){let s=Sv(this.listModel);s&&(a=s)}a&&ko(this,a.id,"end")}}_removeExpressionSynchronously(e){var o;if(e.type==="expression"){let i=(o=e.formula.regression)==null?void 0:o.residualVariable;if(i){for(let n of this.getAllItemModels())if(n.type==="table"){let a=n.columnModels.findIndex(s=>s.latex===i);if(a>=0){y0(n,a);break}}}}let t=Cv(this.listModel,e.index);this.trackActionForPotentialEvaluatorRestart("remove",e.id),t.forEach(i=>this.trackActionForPotentialEvaluatorRestart("remove",i.id)),this.garbageCollectGeo(t,{}),this.ensureAtLeastOneVisibleItem()}setRootElt(e){this.rootElt=e,this.dragdrop_expressions=new cC(this)}getRootElt(){return this.rootElt}_hideExpressions(e){this.graphSettings.config.expressions&&(Ir(this.listModel,void 0),this.layoutModel={...this.layoutModel,expressionsVisible:!1,expressionsHiddenTime:Date.now()},e?Rr(this,{type:"show-expression-list-btn"}):Dr())}_showExpressions(e){this.graphSettings.config.expressions&&(this.layoutModel={...this.layoutModel,expressionsVisible:!0},e?Rr(this,{type:"hide-expression-list-btn"}):Dr())}_showToast(e){this.toastData=e,clearTimeout(this._hideToastTimeout);let t=typeof e.hideAfter=="number"?e.hideAfter:6e3;t>0&&(this._hideToastTimeout=setTimeout(()=>{this.dispatch({type:"toast/close",onHide:this.toastData.onHide})},t))}clearAllTimeouts(){clearTimeout(this._hideToastTimeout),clearTimeout(this._deleteAnimationTimeout)}_setExpressionPropertiesFromAPI(e,t){let o=this.getItemModel(e);if(o)if(o.type==="table"&&t.columns){t=__dcg_shared_module_exports__['f'](t);let i=Bq(o,t),n=vv(this.listModel,i);this._toplevelReplaceItemAt(o.index,n,!1)}else if(o.type==="text"){let i=this.getItemModel(e);if(!i)return;for(let n in t)if(t.hasOwnProperty(n))switch(n){case"text":jF(i,t.text);break;case"secret":yI(i,t.secret);break;case"readonly":S0(i,t.readonly);break}}else if(o.type==="folder"){for(let i in t)if(t.hasOwnProperty(i))switch(i){case"hidden":{this._setItemHidden(e,t.hidden);break}case"title":wF(o,t.title)}}else{let i=this.getItemModel(e);if(!i)return;for(let n in t)if(t.hasOwnProperty(n))switch(n){case"slider":{if(i.type!=="expression")continue;let a=t[n];a.hasOwnProperty("min")&&nb(i,a.min),a.hasOwnProperty("max")&&ab(i,a.max),a.hasOwnProperty("step")&&V0(i,a.step),a.hasOwnProperty("isPlaying")&&fs(i,a.isPlaying)}break;case"polarDomain":{if(i.type!=="expression")continue;bs(i,__dcg_shared_module_exports__['kb'](t.polarDomain.min),"theta"),ys(i,__dcg_shared_module_exports__['kb'](t.polarDomain.max),"theta")}break;case"parametricDomain":{if(i.type!=="expression")continue;bs(i,__dcg_shared_module_exports__['kb'](t.parametricDomain.min),"t"),ys(i,__dcg_shared_module_exports__['kb'](t.parametricDomain.max),"t")}break;case"parametricDomain3Du":{if(i.type!=="expression")continue;bs(i,__dcg_shared_module_exports__['kb'](t.parametricDomain3Du.min),"u"),ys(i,__dcg_shared_module_exports__['kb'](t.parametricDomain3Du.max),"u")}break;case"parametricDomain3Dv":{if(i.type!=="expression")continue;bs(i,__dcg_shared_module_exports__['kb'](t.parametricDomain3Dv.min),"v"),ys(i,__dcg_shared_module_exports__['kb'](t.parametricDomain3Dv.max),"v")}break;case"parametricDomain3Dr":{if(i.type!=="expression")continue;bs(i,__dcg_shared_module_exports__['kb'](t.parametricDomain3Dr.min),"r"),ys(i,__dcg_shared_module_exports__['kb'](t.parametricDomain3Dr.max),"r")}break;case"parametricDomain3Dphi":{if(i.type!=="expression")continue;bs(i,__dcg_shared_module_exports__['kb'](t.parametricDomain3Dphi.min),"phi"),ys(i,__dcg_shared_module_exports__['kb'](t.parametricDomain3Dphi.max),"phi")}break;case"hidden":this._setItemHidden(e,t.hidden);break;case"secret":yI(i,t.secret);break;case"readonly":S0(i,t.readonly);break;case"color":{if(i.type!=="expression")continue;IM(i,t.color)}break;case"dragMode":{if(i.type!=="expression")continue;Fv(i,t.dragMode)}break;case"label":{if(i.type!=="expression")continue;fp(i,t.label)}break;case"showLabel":{if(i.type!=="expression")continue;Vg(i,t.showLabel)}break;case"labelSize":{if(i.type!=="expression")continue;J0(i,t.labelSize)}break;case"labelOrientation":{if(i.type!=="expression")continue;h3(i,t.labelOrientation)}break;case"latex":if(i.type!=="expression")continue;Zn(i,t.latex);break;case"points":if(i.type!=="expression")continue;d3(i,!!t.points);break;case"lines":if(i.type!=="expression")continue;u3(i,!!t.lines);break;case"pointStyle":if(i.type!=="expression")continue;p3(i,t.pointStyle);break;case"pointSize":case"movablePointSize":if(i.type!=="expression")continue;X0(i,t.pointSize);break;case"pointOpacity":if(i.type!=="expression")continue;j0(i,t.pointOpacity);break;case"lineStyle":if(i.type!=="expression")continue;MM(i,t.lineStyle);break;case"lineWidth":if(i.type!=="expression")continue;Mv(i,t.lineWidth);break;case"lineOpacity":if(i.type!=="expression")continue;Iv(i,t.lineOpacity);break;case"fill":if(i.type!=="expression")continue;c3(i,t.fill);break;case"fillOpacity":if(i.type!=="expression")continue;H0(i,t.fillOpacity);break;case"surfaceOpacity":if(i.type!=="expression")continue;W0(i,t.surfaceOpacity);break;case"id":case"type":case"domain":break;default:throw new Error("trying to call setProperty for: "+n)}}}_isParentFolderHidden(e){let t=this.getItemModel(e);if(!t)return!1;let o=Ua(t);return o?o.hidden:!1}_toggleItemHidden(e){var t;if(this._isParentFolderHidden(e))this._setItemHidden(e,!1);else{let o=this.getItemModel(e);if(!o)return;switch(o.type){case"expression":this._setItemHidden(e,!ji(o));break;case"image":case"folder":this._setItemHidden(e,!o.hidden);break;case"table":case"text":break;default:return o}el(o)&&(ji(o)||this.logEvent({category:"tone",action:ji(o)?"mute-local":"unmute-local"}),(t=this.toneController)==null||t.recomputeAudio())}}_toggleTableColumnHidden(e,t){if(this._isParentFolderHidden(e))this._setTableColumnHidden(e,t,!1);else{let o=this.getItemModel(e);if(!o||o.type!=="table")return;let i=lo(o,t);if(!i)return;this._setTableColumnHidden(e,t,!i.hidden)}}_setTableColumnHidden(e,t,o){let i=this.getItemModel(e);if(!i||i.type!=="table")return;let n=uI(i,t);!o&&this._isParentFolderHidden(e)&&this._setItemHidden(i.folderId,!1),Zq(i,t,o),!o&&n&&yF(i,t,!0)}_setItemHidden(e,t){let o=this.getItemModel(e);if(!o)return;!t&&o.type!=="folder"&&this._isParentFolderHidden(o.id)&&this._setItemHidden(o.folderId,!1);let i;switch(o.type){case"expression":{i=ji(o),g7(o,t);break}case"folder":i=gH(o),hH(o,t);break;case"image":nW(o,t);break;case"table":case"text":break;default:return o}i!==void 0&&t&&!i&&(o.type==="expression"?this.trackActionForPotentialEvaluatorRestart("hide",o.id):o.type==="folder"&&this.getAllItemModels().filter(n=>n.type==="expression"&&n.folderId===o.id).forEach(n=>this.trackActionForPotentialEvaluatorRestart("hide",n.id)))}_addItemToEndFromAPI(e){let t=aM(this.listModel);!e.secret&&t&&t.type==="expression"&&t.latex===""&&Cv(this.listModel,t.index);let o=e3(e.id);o!==void 0&&o>=this.__nextItemId&&(this.__nextItemId=o+1),Dl(this.listModel,e)}copyTableStateWithNewColumnIds(e){let t={};return e.columns&&e.columns.forEach(o=>{let i=this.generateId();t[o.id]=i,o.id=i}),e.regression&&(e.regression={...e.regression,id:this.generateId(),columnIds:{x:t[e.regression.columnIds.x],y:t[e.regression.columnIds.y]}}),e}copyExpressionToIndex(e,t,o){let i={stripDefaults:!1},n;switch(e.type){case"expression":n=q0(e,i);break;case"table":n=this.copyTableStateWithNewColumnIds(ev(e,i));break;case"image":n=YI(e,i);break;case"text":n=eM(e,i);break;default:return}let a=this.createItemModel({...n,id:this.generateId()});this._toplevelInsertItemAt(t,a,!1,o||e.folderId)}_toplevelInsertItemAt(e,t,o,i){let n=t;cn(this.listModel,n,e),i&&In(n,i),o&&ko(this,n.id)}_toplevelNewItemAtSelection(e,t){this.setGeoTool("selection");let o=this.getSelectedItem();if(o){let s=o.type==="expression"&&!o.latex;if(s&&!o.folderId&&(e.type!=="expression"||e.latex))return this._toplevelReplaceItemAt(o.index,e,t.shouldFocus);if(s&&o.folderId&&e.type!=="expression"&&e.type!=="folder")return this._toplevelReplaceItemAt(o.index,e,t.shouldFocus);if(o.type!=="folder"&&!o.folderId)return this._toplevelInsertItemAt(o.index+1,e,t.shouldFocus,void 0);if(o.type!=="folder"&&o.folderId&&e.type!=="folder")return this._toplevelInsertItemAt(o.index+1,e,t.shouldFocus,o.folderId);if(o.type==="folder"&&!o.collapsed&&e.type!=="folder")return this._toplevelInsertItemAt(o.index+1,e,t.shouldFocus,o.id)}let i=this.getFirstFullyVisibleItem();for(i&&i.type==="folder"&&(i=this.getItemModelByIndex(i.index+1));i&&i.type!=="folder"&&i.folderId;)i=this.getItemModelByIndex(i.index+1);let n=i?i.index:this.getItemCount();return this._toplevelInsertItemAt(n,e,t.shouldFocus,void 0)}getFirstFullyVisibleItem(){let e=UY(this);if(e)return id(this.listModel,e)}findEl(e){if(this.rootElt)return this.rootElt.querySelector(e)||void 0}getExppanelElt(){return sC(this)}scrollItemIntoView(e){if(!this.rootElt||!this.isListVisible())return;let t=this.getItemNodeById(e.id),o=sC(this);if(!(!t||!o)){if(e.type==="table"){let i=t.querySelector(".dcg-select-dropdown-list");if(i){bl(i,o,60);return}}if(document.activeElement&&t.contains(document.activeElement)){bl(document.activeElement,o,90);return}bl(t,o,90)}}scrollSelectedItemIntoView(){let e=this.getFirstSelectedItem();if(e){if(e&&e.type!=="folder"&&e.folderId){let t=this.getItemModel(e.folderId);t&&t.type==="folder"&&t.collapsedChildIsSelected&&(e=t)}this.scrollItemIntoView(e)}}_pasteTable(e){let t=this.getGrapher();if(!t)return;let o=dM(this.listModel),i=bF(o,e,this),n=this.createItemModel(i);this._toplevelNewItemAtSelection(n,{shouldFocus:!0}),this._closeAddExpression();let a=t.getProjection(),s=a.viewport,c=__dcg_shared_module_exports__['Ga'](e[0],u=>parseFloat(u)),d=__dcg_shared_module_exports__['Ga'](e[1],u=>parseFloat(u));if(this.is3dProduct())return;let p={xmin:__dcg_shared_module_exports__['Na'](c),xmax:__dcg_shared_module_exports__['Ma'](c),ymin:__dcg_shared_module_exports__['Na'](d),ymax:__dcg_shared_module_exports__['Ma'](d),type:"table"};if(isFinite(p.xmin)&&isFinite(p.xmax)&&isFinite(p.ymin)&&isFinite(p.ymax)&&(p.xmax>s.xmax||p.xmin<s.xmin||p.ymax>s.ymax||p.ymin<s.ymin)){let u=VC([p],a);if(u&&!this.viewportIsLocked()){let g=new Or(u.xmin,u.xmax,u.ymin,u.ymax);t.viewportController.setViewport(g),this._showToast({message:this.s("graphing-calculator-text-toast-zoom-to-fit"),undoCallback:()=>{this.dispatch({type:"undo"})}}),this.markSquareAxesAfterUserEditedViewport()}}}_insertSeveralExpressions(e){for(let t=0;t<e.length;t++){let o=this.createItemModel(e[t]);this._toplevelNewItemAtSelection(o,{shouldFocus:!0})}}_appendNumberList(e){let t=this.getSelectedItem();if(t&&t.type==="expression"){let o=t.latex,i=this.createItemModel({type:"expression",id:this.generateId(),latex:o+e});return this._toplevelReplaceItemAt(t.index,i,!0)}}_openOnWeb(){this.runAfterDispatch(()=>{let e=this.getGrapher();if(!e)return;let t=this.getProduct();if(t!=="graphing"&&t!=="geometry-calculator")return;let o=JSON.stringify(this.getState()),i=e.screenshot({width:100,height:100}),n=this.getGraphSettings().config.crossOriginSaveTest,s=(n?"/":"https://www.desmos.com/")+"api/v1/calculator/cross_origin_save",c=document.createElement("div");Joe.mountToNode(uV,c,{stateData:()=>o,thumbData:()=>i,saveURL:()=>s,openInNewWindow:()=>!n,product:()=>t}),this.rootElt.append(c);let d=c.querySelector("form[name=open_graph_on_web]");re(d).trigger("submit"),c.remove()})}notifyBugsnagAboutMissingSelectedItem(e,t){let o=pb(this.listModel),i="";try{o?i=JSON.stringify(o.cachedUndoRedoFullState,null,2):i="undefined"}catch(s){i="[[could not stringify]]"}let n="";try{if(!o)n="undefined";else{let s={id:o.id,index:o.index,displayIndex:o.index,secretIndex:o.secretIndex,guid:o.guid,renderShell:o.renderShell,isHiddenFromUI:o.isHiddenFromUI,hasDCGView:!!o.rootViewNode,cachedRenderHeight:o.cachedRenderHeight};n=JSON.stringify(s,null,2)}}catch(s){n="[[could not stringify]]"}let a="";try{a=JSON.stringify(QF(this.listModel),null,2)}catch(s){a="[[could not stringify]]"}Er("ReplaceItemAtError: no item at index",{metaData:{index:e,shouldFocus:t,selectedModelJSON:n,selectedItemJSON:i,listStateJSON:a}})}_toplevelReplaceItemAt(e,t,o){let i=t,n=this.getItemModelByIndex(e);n||this.notifyBugsnagAboutMissingSelectedItem(e,o);let a=n.type!=="folder"&&n.folderId;Cv(this.listModel,e),cn(this.listModel,i,e),a&&In(i,a),o&&ko(this,i.id)}convertImageToDraggable(e){let t=this.getItemModel(e);if(!t||t.type!=="image")return;let o=t.folderId,i=t.index+1,n=t.center,a=dM(this.listModel),s=__dcg_shared_module_exports__['vb']("C_"+a),c=this.createItemModel({id:this.generateId(),type:"expression",latex:s+"="+n,dragMode:__dcg_shared_module_exports__['Gd'].XY,hidden:!0});cn(this.listModel,c,i),o&&In(c,o),ed(t,"center",s),NF(t,!0),UF(t,!0)}createSlidersForItem(e,t,o){let i=this.getItemModel(e);if(!i)return;let n=i.type!=="folder"&&i.folderId;return this.createSliders({model:i,folderId:n,index:i.index+1,doNotChangeFocus:o},t)}createSlidersForTicker(e){return this.createSliders({model:this.listModel.ticker,folderId:!1,index:0,doNotChangeFocus:!0},e)}createSliders({model:e,folderId:t,index:o,doNotChangeFocus:i},n){let a=[];e.type==="ticker"?oM(e,(u,g)=>{a.push({latex:u,location:g})}):cb(e,(u,g)=>{a.push({latex:u,location:g.location})});let s=Ooe(a,n,{degreeMode:this.graphSettings.degreeMode,isNewStatsEnabled:this.isInferenceEnabled()}),c=e.formula?e.formula.action_value:void 0,d=n.map(u=>{let g=s[u],h="1";g&&g.value!==void 0&&(h=g.value);let b,v=__dcg_shared_module_exports__['wb'](u);u===""?b="":c&&c.hasOwnProperty(v)?b=c[v]:b=u+"="+h;let T={type:"expression",id:this.generateId(),latex:b,color:this.getNextColor(),hidden:!!b};return g&&(g.min!==void 0&&(T.slider||(T.slider={}),T.slider.hardMin=!0,T.slider.min=g.min),g.max!==void 0&&(T.slider||(T.slider={}),T.slider.hardMax=!0,T.slider.max=g.max),g.step!==void 0&&(T.slider||(T.slider={}),T.slider.step=g.step)),T});for(let u=d.length-1;u>=0;u--){let g=this.createItemModel(d[u]);cn(this.listModel,g,o),t&&In(g,t)}if(i)return;let p=d[d.length-1];p.latex===""?ko(this,p.id):Rr(this,void 0)}_uploadImagesAndWaitForThemToLoad(e){let{files:t,id:o}=e;if(!t||t.length===0){this._showToast({message:this.s("graphing-calculator-text-toast-no-file-selected")});return}if(o&&t.length>1){this._showToast({message:this.s("graphing-calculator-text-toast-choose-one-file")});return}let i=bW({controller:this,files:t,id:o}),n=i.errors[0];n&&this._showToast({message:n});for(let a of i.tokens)this.__pendingImageUploads[a]=!0;this.isUploadingImages()&&this._showToast({message:this.s("graphing-calculator-text-toast-uploading-images"),onHide:()=>{this._clearPendingImageUploads()}})}getImageToRetry(){let e;for(let t of this.getAllItemModels())t.type==="image"&&t.loadStatus==="failed"&&(!e||e.failures>t.failures)&&(e=t);return e}retryLoadingFailedImage(e){let t=Date.now(),o=t-this.imageRetryState.lastAttemptTime,i=1e3*Math.pow(2,this.imageRetryState.attempts);this.imageRetryState.attempts>0&&o<i||(YF(e),this.imageRetryState={lastAttemptTime:t,attempts:this.imageRetryState.attempts+1})}getSelectedItem(){return pb(this.listModel)}getFirstSelectedItem(){let e=this.getAllSelectedItems(),t=e[0];if(t){for(let o=1;o<e.length;o++){let i=e[o];i.index<t.index&&(t=i)}return t}}getAllSelectedItems(){return hM(this.listModel)}getOpenItemMenu(){return this.listModel.openItemMenu}isItemSettingsMenuOpen(e){let t=this.listModel.openItemMenu;return t?t.guid===e:!1}isPopoverOpen(e){return this.layoutModel.openPopoverGuid===e}closeItemSettingsMenu(){let e=this.getOpenItemMenu();e!==void 0&&(e.focusFirstOption&&(e.previousFocusLocation!==void 0?Rr(this,e.previousFocusLocation):this.focusOpenMenuIcon()),this.listModel.openItemMenu=void 0)}focusOpenMenuIcon(){let e=this.getOpenItemMenu();e&&(e.type==="slider"?this.dispatch({type:"set-focus-location",location:{type:"slider-animation-properties-icon",id:e.model.id}}):e.type==="image"?this.dispatch({type:"set-focus-location",location:{type:"image-icon",id:e.model.id}}):e.type==="table-column"?this.dispatch({type:"set-focus-location",location:{type:"table-icon",id:e.model.table.id,columnId:e.model.id}}):e.type==="table-regression"?this.dispatch({type:"set-focus-location",location:{type:"table-regression-icon",id:e.model.id}}):e.type==="geo-tool-dropdown"?this.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:e.tools[0]}}):e.type==="multi-select-more"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-more-icon"}}):e.type==="multi-select-construct"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-construct-icon"}}):e.type==="multi-select-style"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-style-icon"}}):e.type==="multi-select-label"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-label-icon"}}):this.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:e.model.id}}))}getFocusedItem(){return Nk(this)}getFocusLocation(){return this.focusLocation}isFocusLocationFocused(e){let t=this.focusLocation,o=e;return!t||!o?!1:__dcg_shared_module_exports__['db'](t,o)}isCurrentFocusLocationValid(){let e=this.focusLocation;if(!e)return!0;if(e.type==="settings")return e.location==="icon"||this.isGraphSettingsOpen();if(e.type==="add-item-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn")return this.isListEnabled();if(e.type==="add-expression-btn"||e.type==="add-table-btn")return this.layoutModel.addExpressionOpen;if(e.type==="add-note-btn")return this.layoutModel.addExpressionOpen&&this.areNotesEnabled();if(e.type==="add-folder-btn")return this.layoutModel.addExpressionOpen&&this.areFoldersEnabled();if(e.type==="add-ticker-btn")return this.layoutModel.addExpressionOpen&&this.areActionsEnabled();if(e.type==="add-image-btn")return this.layoutModel.addExpressionOpen&&this.areImagesEnabled();if(e.type==="add-inference-btn")return this.layoutModel.addExpressionOpen&&this.isInferenceEnabled();if(e.type==="add-inference-wizard")return this.layoutModel.addInferenceOpen;if(e.type==="zoom-in-btn"||e.type==="zoom-restore-btn")return!0;if(e.type==="search-expressions"||e.type==="replace-expressions")return this.expressionSearchOpen;if(e.type==="ticker")return this.listModel.ticker.open;if(e.type==="generic-menu")return!!this.getOpenItemMenu();if(e.type==="graph-paper"){let i=this.getGrapher();return!!(i&&i.getIsVisible()&&i.settings.config.graphpaper)}if(e.type==="geo-show-constructions-icon"||e.type==="geo-token"||e.type==="multi-select-more-icon"||e.type==="multi-select-construct-icon"||e.type==="multi-select-style-icon"||e.type==="multi-select-label-icon"||e.type==="label-points-icon")return this.isGeoUIActive();if(e.type==="new-transformation-number"){let i=this.getGeoModel(),n=i.getCurrentTool(),a=i.getNonObjectsState().ui.currentTool.inputIndex,s=n.getSpec&&n.getSpec();return!!s&&!!s.inputs[a]&&!!s.inputs[a].numberInputInfo}if(e.type==="geo-header-back-link"||e.type==="multi-select-show-hide-icon")return this.isGeoUIActive()&&this.hasAnyItemsSelected();if(e.type==="geo-basic-tool")return this.isGeoUIActive()&&e.tool!=="expression-edit";if(e.type==="regression-output")return!!this.getItemModel(e.id)&&e.parameter!=="";if(e.type==="stats-output"){let i=this.getItemModel(e.id);return!!(i&&i.type==="expression"&&VM(i)&&e.parameter!=="")}if(e.type==="quest")return this.getQuestIsActive();let t=this.getOpenItemMenu();if(e.type==="geo-basic-tool-menu-item")return this.isGeoUIActive()&&e.tool!==""&&t!==void 0&&(t.type==="geo-tool-dropdown"||t.type==="multi-select-construct");if(e.type==="geo-construct-menu-existing-transformations")return this.isGeoUIActive()&&(t==null?void 0:t.type)==="multi-select-construct";if(e.type==="multi-select-label-menu-label-input")return this.isGeoUIActive()&&this.hasAnyItemsSelected()&&(t==null?void 0:t.type)==="multi-select-label";if(e.type==="multi-select-options-menu-item")return this.isGeoUIActive()&&this.hasAnyItemsSelected()&&(t==null?void 0:t.type)==="multi-select-more";if(e.type==="global-mute-button")return this.toneItemsExist();if(e.type==="color-picker-option")return!0;let o;if(t&&t.type==="table-column"?o=t.model.table:o=this.getItemModel(e.id),!o)return!1;if(e.type==="change-image-btn")return this.listModel&&o.type==="image"&&this.areImagesEnabled();if(e.type==="expression-menu"){let i=this.getOpenItemMenu();if(!i||(i.type==="expression"||i.type==="image"||i.type==="table-column")&&i.model.id!==e.id)return!1;if(e.location==="start"||e.location==="end"||e.location==="updaterule"||e.location==="anywhere"||o.type==="table")return!0;if(e.location==="alt-text")return o.type==="expression"||o.type==="image";if(o.type!=="expression")return!1;let{points:n,lines:a,fill:s}=o;xp(o)&&(s=!0);let c=__dcg_shared_module_exports__['Wc'](o.formula.expression_type,{points:n,lines:a,fill:s},d=>{Er("getReconciledExpressionProps [Chrome Switch Bug]",{metaData:{method:"isCurrentFocusLocationValid",type:d}})});return!(!c.fill&&!c.points&&!c.lines&&!o.showLabel)}if(e.type==="add-table-regression-btn")return this.areTableRegressionsEnabled()&&o.type==="table"&&!o.regression;if(e.type==="table-regression-delete-btn"||e.type==="table-regression-copy-btn"||e.type==="table-regression-type-dropdown"||e.type==="table-regression-view-source-popover"||e.type==="table-regression-model-dropdown"||e.type==="table-regression-export-btn")return this.areTableRegressionsEnabled()&&o.type==="table"&&!!o.regression;if(!this.isItemSelected(e.id)&&e.type!=="editable-label")return!1;switch(e.type){case"domain-limit":return!(o.type!=="expression"||!Og(o)&&!oh(o));case"expression-icon":case"top-level-icon":return!0;case"expression-evaluation":return this.shouldShowEvaluationForItem(o.id)||this.shouldShowCDFEvaluationForItem(o.id);case"image-icon":return o.type==="image"&&o.loadStatus!=="loading"&&o.loadStatus!=="failed"&&!o.error;case"action-icon":return!(o.type!=="expression"||!Yv(o));case"slider-icon":case"slider-animation-properties-icon":case"slider-thumb":case"slider-limit":return!(o.type!=="expression"||!b7(o));case"table-icon":return o.type==="table"&&this.getGraphSettings().config.graphpaper;case"table-regression-icon":case"regression-plot-residuals-button":return this.areTableRegressionsEnabled()&&o.type==="table"&&!!o.regression;case"visualization-prop":return!(o.type!=="expression"||!PM(o));case"distribution-param":if(o.type!=="expression")return!1;let i=wp(o);return i?e.location in i.values:!1;case"image":return o.type==="image";case"folder":return o.type==="folder";case"text":return o.type==="text";case"expression":return!(o.type!=="expression"||this.isInEditListMode()||e.isFakeGraphFocus&&!this.getValidCursorContext());case"readonly-expression":return this.isItemReadonly(o.id)||o.type==="expression"&&this.isInEditListMode();case"table":return o.type!=="table"?!1:rH(o,e.location);case"table-container":return o.type==="table"&&this.isInEditListMode();case"editable-label":return o.type!=="expression"?!1:Nv(o);case"inference-footer":return o.type!=="expression"?!1:ea(o)&&this.isInferenceEnabled();case"distribution-footer":return o.type!=="expression"?!1:mb(o);case"action-info":return this.shouldShowActionInfo(o.id);default:return e}}shouldShowActionInfo(e){var o,i;if(!this.areActionsEnabled())return!1;let t=this.getItemModel(e);return!t||t.type!=="expression"&&t.type!=="image"?!1:!!((o=t.clickableInfo)!=null&&o.enabled&&((i=t.clickableInfo)!=null&&i.latex))}shouldAllowMovingPointsWithKeyboard(){let e=this.getActiveTool();return e==="selection"||e==="box-selection"}isDragDropActive(){return!!this.listModel.dragState}isItemBeingDragged(e){let t=this.listModel.dragState;return!(!t||t.firstItemId!==e)}shouldRenderDraggedItemAsToken(){let e=this.listModel.dragState;return e?e.renderType==="token":!1}canDraggedItemBeMovedIntoTokenPane(){var i,n,a;let e=this.getDraggedItemId();if(!e)return!1;let t=this.getItemModel(e);if(!t||t.type!=="expression"||this.isItemMarkedReadonly(t.id))return!1;let o=(i=t.formula.geometry)==null?void 0:i.valueType;return o===void 0||(n=t.formula.geometry)!=null&&n.unconstructable||t.formula.recursion_base_case||t.formula.function_definition&&!__dcg_shared_module_exports__['wa'](o,__dcg_shared_module_exports__['W'])?!1:!!((a=t.formula.geometry)!=null&&a.parentDependencies)}shouldShowAltTextInFooter(e){return this.shouldShowAuthorFeatures()?$F(e):!1}getDraggedItemId(){let e=this.listModel.dragState;return e&&e.firstItemId}getDraggedIdentifier(){var o;let e=this.getRawDragState();if(!e)return;let t=this.getItemModel(e.dragTarget.calcId);if(!(!t||t.type!=="expression"))return(o=Go(t))==null?void 0:o.identifier}getRawDragState(){return this.listModel.dragState}initStateStack(){this.stateStack=new zh,this.stateStack.addState({diffState:this.getUndoRedoDiffState(),fullState:this.getUndoRedoFullState()})}getUndoRedoDiffState(){var e;return{randomSeed:this.getRandomSeed(),includeFunctionParametersInRandomSeed:this.getIncludeFunctionParametersInRandomSeed(),layoutModel:this.layoutModel,settingsViewModel:this.settingsViewModel,graph:(e=this.getGrapher())==null?void 0:e.getUndoRedoDiffState(),expressions:g9(this.listModel),geometryToolbar:GF(this.geometryToolbarModel),wasCompleteSetState:this.isCurrentlyDoingSetState}}getUndoRedoFullState(){var e;return{randomSeed:this.getRandomSeed(),includeFunctionParametersInRandomSeed:this.getIncludeFunctionParametersInRandomSeed(),layoutModel:this.layoutModel,settingsViewModel:this.settingsViewModel,graph:(e=this.getGrapher())==null?void 0:e.getUndoRedoFullState(),expressions:QF(this.listModel),geometryToolbar:GF(this.geometryToolbarModel),wasCompleteSetState:this.isCurrentlyDoingSetState}}getState(e){var a,s;let t={stripDefaults:!0};e&&e.hasOwnProperty("stripDefaults")&&(t.stripDefaults=!!e.stripDefaults);let o=(s=(a=this.getGrapher())==null?void 0:a.getState(t))!=null?s:{...this.getBlankState().graph,degreeMode:this.graphSettings.degreeMode},i={version:xc,randomSeed:this.getRandomSeed(),graph:o,expressions:m9(this.listModel,t)},n=this.getIncludeFunctionParametersInRandomSeed();if((!n||!t.stripDefaults)&&(i.includeFunctionParametersInRandomSeed=n),this.isGeometry()){let c=HH(this.geometryToolbarModel,t);c&&(i.geometryToolbar=c)}return e&&e.avoidBackMigration?__dcg_shared_module_exports__['f'](i):iD(__dcg_shared_module_exports__['f'](i))}getHistory(){return new pV(this.getState(),this.stateStack)}getProduct(){return this.graphSettings.config.product}isGeometry(){return this.getProduct()==="geometry-calculator"}is3dProduct(){return this.getProduct()==="graphing-3d"}isMultiSelectEnabled(){return this.isGeometry()}shouldEvaluateSelection(){return this.isGeometry()}canLoadPastedLink(e){return this.graphSettings.config.pasteGraphLink?this.isGeometry()?RG(e)||AY(e)||PY(e):this.is3dProduct()?LY(e):RG(e):!1}getBlankState(e){if(this.isGeometry())return eD;if(this.is3dProduct())return Boe;let t;(e==null?void 0:e.degreeMode)!==void 0?t=e.degreeMode:t=this.graphSettings.config.clearIntoDegreeMode;let o={...lC.graph};return t&&(o.degreeMode=!0),{...lC,graph:o}}externalSetState(e,t){var s;this._clearPendingImageUploads(),this.rootElt&&document.activeElement&&this.rootElt.contains(document.activeElement)&&re(document.activeElement).trigger("blur"),t||(t={}),e||(e=this.getBlankState()),typeof e=="string"&&(e=JSON.parse(e)),this.isGeometry()&&fX(e)&&(e=sh(e));let o=zo(e);!this.canEnableComplexMode()&&((s=o==null?void 0:o.graph)!=null&&s.complex)&&(o.graph.complex=!1,o.graph.degreeMode=e.graph.degreeMode);let i=this.graphSettings.config.product,n;if(!o.graph||o.graph.product===void 0?n="graphing":n=o.graph.product,n!==i){let c=i==="geometry-calculator"?this.s("account-shell-text-error-loading-geometry-state"):this.s("account-shell-error-mygraphs-error-loading");this._showToast({message:c}),Er(`Data Error: state appears to have been saved in the '${n}' product and cannot be opened in the '${i}' product.`)}i==="geometry-calculator"&&(this.showConstructionsOpen=!1),Vx&&i==="graphing-3d"&&o.graph.speed3D&&delete o.graph.speed3D;let a=this.layoutModel;this.setState(o,t),c9(this.listModel),uM(this.listModel),this.layoutModel={...dB(this.graphSettings.config),keypadMinimized:a.keypadMinimized,keypadLayout:a.keypadLayout,keypadFunctionsOpen:a.keypadFunctionsOpen,expressionsVisible:!!this.graphSettings.config.expressions&&(this.isListVisible()||!!t.forceExpressionsOpen)},this.settingsViewModel=pB(),Rr(this,void 0),t.forceUnsavedChanges?this.enqueueEvent("change"):this.enqueueEvent("clearUnsavedChanges")}setState(e,t){var o;if(this.isCurrentlyDoingSetState=!0,"graph"in e&&e.graph!==void 0){if("threeDMode"in e.graph&&e.graph.threeDMode&&this.grapher3d){if(e.graph.showBox3D!==void 0&&this.grapher3d.webglLayer.showBox(e.graph.showBox3D),"showAxis3D"in e.graph&&this.grapher3d.webglLayer.showAxes(!!e.graph.showAxis3D),"showAxisLabels3D"in e.graph&&this.grapher3d.webglLayer.updateAxes(),"showPlane3D"in e.graph||"showAxis3D"in e.graph){let a=("showPlane3D"in e.graph?!!e.graph.showPlane3D:this.graphSettings.showPlane3D)&&("showAxis3D"in e.graph?!!e.graph.showAxis3D:this.graphSettings.showAxis3D);this.grapher3d.webglLayer.showPlane(a)}let n=this.grapher3d.baseplaneWidth();this.grapher2d.setCanvasSizeFor3D(n,n),this.grapher3d.webglLayer.setBackgroundColor(e.graph.backgroundColor3d)}let i=this.getGrapher();i?i.setGrapherState(e.graph):ay.copyGraphProperties(e.graph,this.graphSettings),"threeDMode"in e.graph&&e.graph.threeDMode&&this.grapher3d&&this.grapher3d.controls.copyWorldRotationToWorld()}if("expressions"in e){Ir(this.listModel,void 0);let i=f9(e.expressions);i>=this.__nextItemId&&(this.__nextItemId=i+1),b9(this.listModel,e.expressions,t||{})}if("layoutModel"in e&&(this.layoutModel=e.layoutModel),"settingsViewModel"in e&&(this.settingsViewModel=e.settingsViewModel),(!t||!t.allowUndo)&&this.clearUndoRedoHistory(),this.setRandomSeed(e.randomSeed||Cp()),this.setIncludeFunctionParametersInRandomSeed((o=e.includeFunctionParametersInRandomSeed)!=null?o:Li.includeFunctionParametersInRandomSeed),"geometryToolbar"in e){let i=e.geometryToolbar;this.geometryToolbarModel=PI(i)}}updateToState(e){if(this.isCurrentlyDoingRestoreState=!0,"graph"in e&&(e.graph.threeDMode?this.grapher3d&&this.grapher3d.setGrapherState(e.graph):this.grapher2d&&this.grapher2d.setGrapherState(e.graph,{doNotClear:!0})),"expressions"in e&&y9(this.listModel,e.expressions),e.layoutModel&&(this.layoutModel=e.layoutModel),e.settingsViewModel&&(this.settingsViewModel=e.settingsViewModel),"geometryToolbar"in e){let t=e.geometryToolbar;this.geometryToolbarModel=PI(t)}}commitUndoRedoSynchronously(e){let t=this.stateStack.getState(),o=t&&t.diffState,i=this.getUndoRedoDiffState();if(pke(o,i))return;let n=this.apiMethodCallStackInfo.withHistoryReplacementDepth>0,a={diffState:i,fullState:this.getUndoRedoFullState()};if(!n&&Xoe(e))this.stateStack.addState(a),this.enqueueEvent("change",e);else{let s=t&&t.fullState.wasCompleteSetState||a.fullState.wasCompleteSetState,c={diffState:{...a.diffState,wasCompleteSetState:s},fullState:{...a.fullState,wasCompleteSetState:s}};this.stateStack.replaceInteriorState(c)}}isUndoRedoDisabledForNotebook(){return!1}undo(){if(!this.canUndo())return;this.closeToast(),this.stateStack.undo();let e=this.stateStack.getState().fullState;e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change",{type:"undo"})}redo(){if(!this.canRedo())return;this.stateStack.redo();let e=this.stateStack.getState().fullState;e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change",{type:"undo"})}clearUndoRedoHistory(){this.stateStack.clear()}canUndo(){return this.isUndoRedoDisabledForNotebook()?!1:this.stateStack.canUndo()}canRedo(){return this.isUndoRedoDisabledForNotebook()?!1:this.stateStack.canRedo()}closeToast(){let e=this.toastData.onHide;e&&this.runAfterDispatch(e),this.toastData={}}_closeAddExpression(){this.layoutModel={...this.layoutModel,addInferenceOpen:!1,addExpressionOpen:!1}}doesDOMHaveSize(){return this.layoutMeasurements.width>0&&this.layoutMeasurements.height>0}_getExpListWidth(){let e;if(this.userSpecifiedExpListWidth!==void 0){let i=this.layoutMeasurements.width-(this.isGeometry()?320:200);e=__dcg_shared_module_exports__['Rb'](this.userSpecifiedExpListWidth,320,i)}else{if(e=this.layoutMeasurements.width,!e)return 320;let i=.2*e+160;e=__dcg_shared_module_exports__['Rb'](i,320,500)}let o=this.layoutMeasurements.width-this.getGrapherHeight();return Math.abs(o-e)<=10?o:e}_setExpListWidth(e){this.userSpecifiedExpListWidth!==e&&(this.userSpecifiedExpListWidth=e)}getKeypadHeight(){return this.computeMajorLayout().keypad.height}isKeypadEnabled(){return!!this.graphSettings.config.keypad}isKeypadOpen(){if(!this.isKeypadEnabled())return!1;let e=this.layoutModel.keypadMinimized&&!this.isNarrow();return this.needsFakeKeypad()&&!e}isHideKeypadButtonVisible(){return this.getBrailleMode()==="none"&&this.isKeypadOpen()&&(!this.isNarrow()||this.inAudioTraceMode())}isKeypadFunctionsPopoverOpen(){return!!this.layoutModel.keypadFunctionsOpen}getKeypadLayout(){let e=this.layoutModel.keypadLayout;return this.isThreeDMode()?zoe(e):e}isLetterKeypadOpen(){let e=this.getKeypadLayout();return this.isKeypadOpen()&&(e==="letters"||e==="noQwertyLetters"||e==="capitalLetters"||e==="noQwertyCapitalLetters")}isFileDraggedOver(){return this.layoutModel.isFileDraggedOver}getGeoToolbarHeight(){return this.shouldShowGeoToolbar()?48:0}isNarrowGeometryHeader(){return this.computeMajorLayout().grapher.width<450}shouldShowMultiSelectHeader(){return this.getSelectedGeoExpression()||this.hasMultipleItemsSelected()}getGrapherHeight(){return this.layoutMeasurements.height-this.getGeoToolbarHeight()}computeMajorLayout(){let e=this.layoutMeasurements.width,t=this.layoutMeasurements.height,o=this.isNarrow(),i=this.isListVisible(),n=this.isKeypadOpen(),a=!this.isGrapherEnabled(),s=!this.isListEnabled(),c=!!this.getGraphSettings().config.projectorMode,d={left:0,top:0,width:0,height:0},p={left:0,top:0,width:0,height:0,paddingTop:0},u={left:0,top:t,width:e,height:c?o?185:193:169};s?(p.width=e,p.height=t):a?(d.width=e,d.height=t):i?o?(d.width=e,d.height=Math.round(.58*t),d.top=t-d.height,p.width=e,p.height=t-d.height):(d.width=this.getExpListWidth(),d.height=t,p.left=d.width,p.width=e-p.left,p.height=t):i||(o?(d.width=e,d.height=Math.round(.58*t),d.top=t,p.width=e,p.height=t):(d.width=this.getExpListWidth(),d.height=t,d.left=-d.width,p.width=e,p.height=t)),n&&(u.top-=u.height,s||(d.height-=u.height));let g=this.getGeoToolbarHeight();return g&&(p.top+=g,p.height-=g),{list:d,grapher:p,keypad:u}}isNarrow(){return this.isGeometry()?this.layoutMeasurements.width<600:this.layoutMeasurements.width<450}getLayoutMeasurements(){return this.layoutMeasurements}getCapExpressionSize(){return!!this.getGraphSettings().config.capExpressionSize}handleAudioTraceCommand(e){let t=this.getAudioGraph();if(t===void 0)return;let o=t.agNavigator;switch(e){case"on":this.runAfterDispatch(()=>{t.enterAudioTrace({fromKeypad:!0})});break;case"off":this.runAfterDispatch(()=>{t.exitAudioTrace()});break;case"hear-graph":t.hearGraph();break;case"stop-graph":t.stopGraph();break;case"volume-down":t.adjustVolume("down");break;case"volume-up":t.adjustVolume("up");break;case"speed-down":t.speedDown();break;case"speed-up":t.speedUp();break;case"previous-point":this.runAfterDispatch(()=>{t.reportAndMoveToPrevPoint()});break;case"next-point":this.runAfterDispatch(()=>{t.reportAndMoveToNextPoint()});break;case"previous-poi":this.runAfterDispatch(()=>{t.reportAndMoveToPrevPOI()});break;case"next-poi":this.runAfterDispatch(()=>{t.reportAndMoveToNextPOI()});break;case"previous-curve":this.runAfterDispatch(()=>{o.prevCurve()});break;case"next-curve":this.runAfterDispatch(()=>{o.nextCurve()});break;case"describe-point":t.describePoint();break;case"describe-curve":t.describeCurve();break;case"describe-axes":t.describeAxes();break;case"keyboard-shortcuts":this.enqueueEvent("showHotkeysModal",{type:"keypad/audio-trace",command:e});break;default:return e}}setAudioTraceSpeed(e){let t=this.getAudioGraph();t&&t.adjustPlaybackSpeed(e)}setGraphPaperFocus(e){var t;Rr(this,e.isFocused?{type:"graph-paper"}:void 0),(t=this.get2dPOIController())==null||t.keyboardAttentionManager.setKeyboardAttention(void 0),this.requestRedrawGraph(),e.isFocused&&this.isGeoToolActive()&&this.runAfterDispatch(()=>{var o;(o=this.get2dPOIController())==null||o.keyboardAttentionManager.handleGrapherGainedFocus()})}isGraphPaperFocused(){let e=this.getFocusLocation();return e?!!(e.type==="graph-paper"||e.type==="expression"&&e.isFakeGraphFocus):!1}isVirtualMouseAllowed(){return!(!this.isGeometry()||!this.isGraphPaperFocused()||!this.geoModel.getCurrentTool().canNextInputBePoint())}isClickableId(e){return Tv(this.getItemModel(e))}setCanShowKeyboardShortcuts(e){this.canShowKeyboardShortcuts=e}getCanShowKeyboardShortcuts(){return this.canShowKeyboardShortcuts}apply3dProps(e){if(!this.isThreeDMode()||!this.grapher3d)return;let t=this.grapher3d.webglLayer;for(let o in e)switch(o){case"showPlane3D":t.showPlane(this.showPlane3D());break;case"showBox3D":t.showBox(!!e[o]);break;case"showAxis3D":t.showAxes(!!e[o]),t.showPlane(this.showPlane3D());break;case"showAxisLabels3D":t.updateAxes();break;default:break}}getGeometryTokenCount(){if(!this.cachedGeoTokenDepths)return 0;let e=0;return __dcg_shared_module_exports__['Ga'](__dcg_shared_module_exports__['ab'](this.cachedGeoTokenDepths),t=>e+=t?t.length:0),e}getAllGeometryConstructionIds(){return qW(this.listModel,__dcg_shared_module_exports__['Zd'])}makeGeoAPI(){this.geoModel=new GC(this)}getGeoTokenInfoFromIdentifier(e){if(e)return this.cachedGeoTokenInfo[e]}getGhostMode(){return this.getGraphSettings().config.getProperty("ghostMode")}getshowKeyboardShortcutsInTooltips(){return!!this.getGraphSettings().config.showKeyboardShortcutsInTooltips}isDispatching(){return this.dispatcher.isDispatching()}getSuggestedIdentifierRenameInfo(e){return this.listModel.renamePrompt.suggestionForId(e)}getMathquillConfig(e){let t=e.additionalOperators||[];return this.toneAllowed()&&t.push("tone"),{...c1({additionalOperators:t,includeGeometryFunctions:this.isGeometry(),include3DFunctions:this.is3dProduct(),newStats:this.isInferenceEnabled()}),autoCommands:jg({additionalCommands:this.isGeometry()?[]:["int"],disallowAns:this.isGeometry()})}}constrainMultiSelect(){if(this.isMultiSelectEnabled())return;let e=hM(this.listModel);e.length>1&&Ir(this.listModel,e[0])}focusFirstExpression(){if(!this.getGraphSettings().config.expressions)return;let e=Sv(this.listModel);e&&ko(this,e.id,"end")}_updateToneAvailability(){let e=this.toneAllowed();e&&!this.toneController?this.toneController=new Q0(this):!e&&this.toneController&&(this.toneController=void 0)}toneItemsExist(){return this.toneEnabled()?this.getAllItemModels().some(e=>el(e)):!1}toneAllowed(){return!!(this.graphSettings.config.audio&&this.graphSettings.config.tone)}toneEnabled(){return!!this.toneController}isAdaptivePeelingSettled(){let e=this.adaptiveDepthPeelingInfo;return(e==null?void 0:e.status)===2||(e==null?void 0:e.status)===1&&(e==null?void 0:e.peelLayers)>=Ow}setAdaptiveDepthPeelingInfo(e){let t=this.adaptiveDepthPeelingInfo;this.adaptiveDepthPeelingInfo=e,this.isAdaptivePeelingSettled()||this.requestRedrawGraph(),(t==null?void 0:t.peelLayers)!==e.peelLayers&&this.dispatch({type:"render"})}getAdaptiveDepthPeelingInfo(){return this.adaptiveDepthPeelingInfo}handleEvaluatorProgressUpdates(){this.checkSlowAnalysis=!0,this.requestedEvaluatorRestart=!1}clearSlowEvaluatorTracking(){this.expressionActionsToRestartIfSlow=[],this.checkSlowAnalysis=!1,this.requestedEvaluatorRestart=!1}handlePossiblySlowEvaluator(){if(!this.isEvaluatorSlow())return!1;let e=!1;return this.shouldRestartForSomeAction()?(this.requestEvaluatorRestart(),e=!0):this.checkSlowAnalysis&&(e=!0,this.checkSlowAnalysis=!1),e}shouldRestartForAction(e,t){switch(e){case"edit":case"remove":return this.isActivelyComputing(t);case"hide":return this.getEvaluatorStateForItem(t)==="GRAPHING";default:return e}}shouldRestartForSomeAction(){return this.expressionActionsToRestartIfSlow.some(({action:e,id:t})=>this.shouldRestartForAction(e,t))}isEvaluatorSlow(){return!this.requestedEvaluatorRestart&&this.evaluator.isCurrentlySlow()}requestEvaluatorRestart(){this.evaluator.requestRestartWorker(),this.clearSlowEvaluatorTracking(),this.requestedEvaluatorRestart=!0}shouldShowProgressUpdateLegend(){return this.getGraphSettings().config.debugProgressUpdates&&!this.progressUpdateLegendHidden}isItemSlowInEvaluator(e){return this.isActivelyComputing(e)&&this.isEvaluatorSlow()}isActivelyComputing(e){return __dcg_shared_module_exports__['Vd'](this.getEvaluatorStateForItem(e))}trackActionForPotentialEvaluatorRestart(e,t){this.expressionActionsToRestartIfSlow.push({action:e,id:t})}shouldShowProgressUpdateColors(){return this.shouldShowProgressUpdateLegend()}shouldShowProgressUpdateIcons(){return this.getGraphSettings().config.debugProgressUpdates}isComplexModeEnabled(){return this.canEnableComplexMode()&&this.graphSettings.complex}canEnableComplexMode(){return this.graphSettings.config.allowComplex}shouldShowSliderPrompt(e){let t=th(e);return t.length>0&&t.length<=4?!0:this.areSlidersEnabled()?Ev(e).length>0:!1}shouldShowRegressionButton(e){return this.is3dProduct()||!this.areTableRegressionsEnabled()||e.type!=="table"||e.regression||e.columnModels.length<2?!1:ju(e.columnModels[0])&&Tg(e.columnModels[0])&&e.columnModels.slice(1).some(t=>ju(t)&&Tg(t))}renameTableColumnsForGlobalExport(e,t){let o=this.getExportedVariables();for(let i of t){let n=lo(e,i);if(!n)continue;let a=n.latex;if(!Fa(a))continue;let s=__dcg_shared_module_exports__['wb'](a);if(o.isMultiplyDefined(s,{includeRegressionExports:!0})){let c=s.split("_")[0],d=o.getLastSubscriptForName(c,{includeRegressionExports:!0}),p=`${c}_{${d+1}}`;mp(this.listModel,a,p,{limitToItem:e.id}),o.optimisticallyRegisterColumnName(__dcg_shared_module_exports__['wb'](p))}}}exportTableRegression(e,t){var c,d;let o=this.getItemModel(t);if((o==null?void 0:o.type)!=="table")return;let i=o.regression;if(!i)return;let n="";if(e==="regression"){this.renameTableColumnsForGlobalExport(o,[i.columnIds.x,i.columnIds.y]);let p=sH(o);if(!p)return;n=__dcg_shared_module_exports__['Ne'](i.type,{operator:"~",variables:p});let u=__dcg_shared_module_exports__['Pe'](n),g=o3(this.listModel),h;u.some(b=>g.isDefined(b,{includeRegressionExports:!1}))&&(h=1+Math.max(...u.map(b=>g.getLastSubscriptForName(b,{includeRegressionExports:!1})))),n=n.replace(__dcg_shared_module_exports__['Oe'],(b,v)=>h!==void 0?`${v}_{${h}}`:v)}else{let p=((d=(c=o.formula)==null?void 0:c.table_regression)==null?void 0:d.status)==="success"?o.formula.table_regression.result:void 0;if(!p)return;n=__dcg_shared_module_exports__['Ne'](i.type,{operator:"=",variables:["x","y"],parameterValues:uB(p)})}let a=this.createItemModel({type:"expression",id:this.generateId(),latex:Qe.normalizeLatex(n,this.getMathquillConfig({})),color:this.getNextColor(),hidden:!1}),s=1+o.index;cn(this.listModel,a,s),this.setEditListMode(!1),ko(this,a.id)}getExportedVariables(){return o3(this.listModel)}isInferenceEnabled(){return this.graphSettings.config.newStats}getInferenceUIData(){return this.inferenceUIData}getInferenceUIExpressionModelsForId(e){let t=[],o=this.listModel,i=this.inferenceUIData.inferenceObjectModels[e];return i?(Object.values(i).map(n=>{let a=Zu(o,n);(a==null?void 0:a.type)==="expression"&&t.push(a)}),t):[]}getInferenceUIHypothesisExpression(e){let t=this.inferenceUIData.inferenceObjectModels[e],o=Zu(this.listModel,t==null?void 0:t.hypothesis);if((o==null?void 0:o.type)==="expression")return o}getInferenceUIConfidenceLevelExpression(e){let t=this.listModel,o=this.inferenceUIData.inferenceObjectModels[e],i=Zu(t,o==null?void 0:o.confidenceLevel);if((i==null?void 0:i.type)==="expression")return i}getInferenceWizardData(){return this.inferenceUIData.inferenceWizardData}getAllInferenceUiExpressions(){return s9(this.listModel)}setInferenceWizardSamplePropModelProp(e,t,o){let i=this.inferenceUIData.inferenceWizardData.samplePropModels[e][t],n=Zu(this.listModel,i);if((n==null?void 0:n.type)!=="expression"){let a=this.generateId();n=this.createItemModel({type:"expression",id:a,latex:o}),JF(this.listModel,n),this.inferenceUIData.inferenceWizardData.samplePropModels[e][t]=a}Zn(n,o)}setInferenceWizardSampleData(e){this.inferenceUIData.inferenceWizardData.samples[e.sampleIndex]={...this.inferenceUIData.inferenceWizardData.samples[e.sampleIndex],...e.update},this.inferenceUIData.inferenceWizardData.samplePropModels[e.sampleIndex]||(this.inferenceUIData.inferenceWizardData.samplePropModels[e.sampleIndex]={});for(let t of Object.keys(e.update))this.setInferenceWizardSamplePropModelProp(e.sampleIndex,t,e.update[t]),t==="list"&&this.setInferenceWizardSamplePropModelProp(e.sampleIndex,"listWrapped",`[${e.update[t]}]`)}_addNewInferenceObject(){let e=this.getNextAssignmentIdForLetter("T"),t=this.createItemModel({type:"expression",id:this.generateId(),latex:`${e}=${this.getLatexForInferenceObject()}`});this._addItemToEndFromAPI(t),ko(this,t.id,"end")}getLatexForInferenceObject(){let e=this.getInferenceWizardData(),t=WG[e.inferenceType][e.sampleType],o=e.samples.map((n,a)=>t.map(s=>{var c,d;return s==="list"?J_({sampleProp:"list",formula:this.getFormulaForInferenceSampleProp(a,"list")})?n[s]:`\\left[${(c=n[s])!=null?c:""}\\right]`:(d=n[s])!=null?d:""}).join(",")).join(",");return`\\operatorname{${e.inferenceType==="zprop"?"zproptest":`${e.inferenceType}test`}}\\left(${o}\\right)`}closeAddInferenceWizard(){this.getInferenceWizardData().samplePropModels.forEach(e=>Object.values(e).forEach(t=>{pM(this.listModel,t),this.trackActionForPotentialEvaluatorRestart("remove",t)})),this.layoutModel={...this.layoutModel,addInferenceOpen:!1}}getFormulaForInferenceSampleProp(e,t){var n;let o=(n=this.getInferenceWizardData().samplePropModels[e])==null?void 0:n[t],i=Zu(this.listModel,o);return i==null?void 0:i.formula}getLatexForInferenceItem(e,t){var d,p;let o=this.getItemModel(t);if((o==null?void 0:o.type)!=="expression")return;let i=Go(o),n=vp(o),a=fb(o),s=n?i==null?void 0:i.latex:(d=this.getInferenceObjectComputedModel(t,"significance"))==null?void 0:d.latex,c=a?i==null?void 0:i.latex:(p=this.getInferenceObjectComputedModel(t,"confidence"))==null?void 0:p.latex;switch(e){case"t":case"z":return`${s}.\\operatorname{score}`;case"p":return`${s}.p`;case"pleft":return`${s}.\\operatorname{pleft}`;case"pright":return`${s}.\\operatorname{pright}`;case"confidenceLower":return`${c}.\\operatorname{lower}`;case"confidenceUpper":return`${c}.\\operatorname{upper}`;case"dof":return n?`${s}.\\operatorname{dof}`:`${i==null?void 0:i.latex}.\\operatorname{dof}`;case"pointEstimate":return`${i==null?void 0:i.latex}.\\operatorname{point}`;case"standardError":return`${i==null?void 0:i.latex}.\\operatorname{stderr}`;default:throw new Error(`Unexpected item ${e}`)}}exportConfidenceDiagram(e){var c,d,p,u,g,h;let t=this.getItemModel(e);if((t==null?void 0:t.type)!=="expression")return;if(!this.inferenceUIData.exportedConfidenceIntervalPlacementData){let b=(c=this.getGrapher())==null?void 0:c.getProjection();if(b){let v=0;(b.viewport.ymin>0&&b.viewport.ymax>0||b.viewport.ymin<0&&b.viewport.ymax<0)&&(v=b.viewport.ymin),this.inferenceUIData.exportedConfidenceIntervalPlacementData={ymin:v,scale:(b.viewport.ymax-v)/10}}}this.inferenceUIData.exportedConfidenceIntervalCount++;let o=(d=this.getInferenceObjectComputedModel(e,"confidence"))==null?void 0:d.latex,n=`\\left(t,${(dF(this.inferenceUIData.exportedConfidenceIntervalCount)*((u=(p=this.inferenceUIData.exportedConfidenceIntervalPlacementData)==null?void 0:p.scale)!=null?u:1)+((h=(g=this.inferenceUIData.exportedConfidenceIntervalPlacementData)==null?void 0:g.ymin)!=null?h:0)).toFixed(1)}\\right)`,a=1+t.index;if(ea(t)){let b=this.getNextAssignmentIdForLetter("I"),v=this.createItemModel({latex:`${b}=${o}`,type:"expression",id:this.generateId()});cn(this.listModel,v,a),a++,o=b}let s=this.createItemModel({latex:n,parametricDomain:{min:`${o}.\\operatorname{lower}`,max:`${o}.\\operatorname{upper}`},type:"expression",id:this.generateId()});cn(this.listModel,s,a),this.setEditListMode(!1),ko(this,s.id)}exportSignificanceDiagram(e){var u,g,h;let t=this.getItemModel(e);if((t==null?void 0:t.type)!=="expression")return;let o=wg(t),i=this.getLatexForInferenceItem(o==="t"?"t":"z",e);if(!o||!i)return;let n=1+t.index;if(ea(t)){let b=this.getNextAssignmentIdForLetter(o==="t"?"t":"z"),v=this.createItemModel({latex:`${b}=${i}`,type:"expression",id:this.generateId()});cn(this.listModel,v,n),n++,i=b}let a=(h=(g=(u=this.getInferenceObjectData(e))==null?void 0:u.significance)==null?void 0:g.tails)!=null?h:"outer",s=o==="t"?this.getLatexForInferenceItem("dof",e):void 0,c=nq({inferenceType:o,dof:s}),d;switch(a){case"left":d={type:"expression",latex:c,cdf:{show:!0,min:i,max:`-${i}`,tails:"left"}};break;case"right":d={type:"expression",latex:c,cdf:{show:!0,min:i,max:`-${i}`,tails:"right"}};break;case"outer":d={type:"expression",latex:c,cdf:{show:!0,min:i,max:`-${i}`,tails:"outer"}};break}let p=this.createItemModel({...d,id:this.generateId()});cn(this.listModel,p,n),this.setEditListMode(!1),ko(this,p.id)}getNextAssignmentIdForLetter(e){let t=this.findLastSubscriptForLetters(),o=(t[e]||0)+1;return t[e]=o,`${e}_{${o}}`}exportInferenceItem(e,t){let o=this.getItemModel(t);if((o==null?void 0:o.type)!=="expression")return;if(Go(o)===void 0){let a="T";fb(o)&&(a="I");let s=this.getNextAssignmentIdForLetter(a);Zn(o,`${s}=${o.latex}`),this.createOrUpdateComputedInferenceModelsFromExpression(o)}if(e==="significanceDiagram")return this.exportSignificanceDiagram(t);if(e==="confidenceDiagram")return this.exportConfidenceDiagram(t);let n=this.createItemModel({type:"expression",id:this.generateId(),latex:this.getLatexForInferenceItem(e,t)});cn(this.listModel,n,1+o.index),this.setEditListMode(!1),ko(this,n.id)}getInferenceObjectData(e){let t=this.getItemModel(e);if(!((t==null?void 0:t.type)!=="expression"||!this.isInferenceEnabled()))return t.inference}createOrUpdateInferenceObjectComputedModel(e,t,o){var d,p,u;let i,n=this.getItemModel(e);if((n==null?void 0:n.type)!=="expression"||!ea(n))return;let a=(p=(d=Go(n))==null?void 0:d.latex)!=null?p:n.latex;switch(t){case"significance":i=`${a}.\\operatorname{null}\\left(${o}\\right)`;break;case"confidence":i=`${a}.\\operatorname{conf}\\left(${o}\\right)`;break;case"confidenceLevel":case"hypothesis":i=o;break;case"pointEstimate":i=`${a}.\\operatorname{point}`;break;case"standardError":i=`${a}.\\operatorname{stderr}`;break;default:throw new Error(`Unexpected prop ${t}`)}let s=(u=this.inferenceUIData.inferenceObjectModels[e])==null?void 0:u[t],c=Zu(this.listModel,s);if((c==null?void 0:c.type)!=="expression"){let g=this.generateId();c=this.createItemModel({type:"expression",id:g,latex:i}),JF(this.listModel,c),this.inferenceUIData.inferenceObjectModels[e]||(this.inferenceUIData.inferenceObjectModels[e]={}),this.inferenceUIData.inferenceObjectModels[e][t]=g}Zn(c,i)}deleteInferenceObjectComputedModel(e,t){var i;let o=(i=this.inferenceUIData.inferenceObjectModels[e])==null?void 0:i[t];o&&pM(this.listModel,o)}createOrUpdateComputedInferenceModelsFromExpression(e){ea(e)&&e.inference.confidence.show?(this.createOrUpdateInferenceObjectComputedModel(e.id,"confidenceLevel",e.inference.confidence.confidenceLevel),this.createOrUpdateInferenceObjectComputedModel(e.id,"confidence",e.inference.confidence.confidenceLevel)):(this.deleteInferenceObjectComputedModel(e.id,"confidenceLevel"),this.deleteInferenceObjectComputedModel(e.id,"confidence")),ea(e)&&e.inference.significance.show?(this.createOrUpdateInferenceObjectComputedModel(e.id,"hypothesis",e.inference.significance.hypothesis),this.createOrUpdateInferenceObjectComputedModel(e.id,"significance",e.inference.significance.hypothesis)):(this.deleteInferenceObjectComputedModel(e.id,"hypothesis"),this.deleteInferenceObjectComputedModel(e.id,"significance")),ea(e)?(this.createOrUpdateInferenceObjectComputedModel(e.id,"pointEstimate",""),this.createOrUpdateInferenceObjectComputedModel(e.id,"standardError","")):(this.deleteInferenceObjectComputedModel(e.id,"pointEstimate"),this.deleteInferenceObjectComputedModel(e.id,"standardError"))}updateInferenceParameters(e,t){let o=this.getItemModel(e);!o||o.type!=="expression"||(V7(o,t),this.createOrUpdateComputedInferenceModelsFromExpression(o))}getInferenceObjectComputedModel(e,t){var i;let o=(i=this.inferenceUIData.inferenceObjectModels[e])==null?void 0:i[t];return Zu(this.listModel,o)}getInferenceOutputErrorById(e,t){var d,p,u;let o=this.getItemModel(e);if(!o||o.type!=="expression")return;let i=ea(o),n=vp(o),a=fb(o);if(!i&&!n&&!a)return;let s=a?o:this.getInferenceObjectComputedModel(e,"confidence"),c=n?o:this.getInferenceObjectComputedModel(e,"significance");switch(t){case"confidenceLower":case"confidenceUpper":return(d=s==null?void 0:s.formula)!=null&&d.error||this.inferenceInputValueHasError(e,"confidenceLevel")?{key:"graphing-calculator-error-inference-invalid-confidence"}:void 0;case"p":case"pleft":case"pright":case"z":case"t":return(p=c==null?void 0:c.formula)!=null&&p.error||this.inferenceInputValueHasError(e,"hypothesis")?{key:"graphing-calculator-error-inference-invalid-hypothesis"}:void 0;case"dof":case"pointEstimate":case"standardError":return(u=o==null?void 0:o.formula)==null?void 0:u.error;default:throw new Error(`Unexpected outputItem: ${t}`)}}getInferenceOutputValueById(e,t){var b,v,T,E,I,_,C,D,P,F;let o=this.getItemModel(e);if(!o||o.type!=="expression")return;let i=ea(o),n=vp(o),a=fb(o);if(!i&&!n&&!a)return;let s=a?o:this.getInferenceObjectComputedModel(e,"confidence"),c=n?o:this.getInferenceObjectComputedModel(e,"significance"),d=((v=(b=s==null?void 0:s.formula)==null?void 0:b.typed_constant_value)==null?void 0:v.valueType)===__dcg_shared_module_exports__['ca']?(T=s==null?void 0:s.formula)==null?void 0:T.typed_constant_value:void 0,p=((I=(E=c==null?void 0:c.formula)==null?void 0:E.typed_constant_value)==null?void 0:I.valueType)===__dcg_shared_module_exports__['ha']?(_=c==null?void 0:c.formula)==null?void 0:_.typed_constant_value:void 0,u=i?this.getInferenceObjectComputedModel(e,"pointEstimate"):void 0,g=i?this.getInferenceObjectComputedModel(e,"standardError"):void 0,h=o==null?void 0:o.formula.typed_constant_value;switch(t){case"confidenceLower":return d?__dcg_shared_module_exports__['Aa'](d,"min"):void 0;case"confidenceUpper":return d?__dcg_shared_module_exports__['Aa'](d,"max"):void 0;case"p":return p?__dcg_shared_module_exports__['Aa'](p,"p"):void 0;case"pleft":return p?__dcg_shared_module_exports__['Aa'](p,"pleft"):void 0;case"pright":return p?__dcg_shared_module_exports__['Aa'](p,"pright"):void 0;case"z":case"t":return p?__dcg_shared_module_exports__['Aa'](p,"score"):void 0;case"dof":return(h==null?void 0:h.valueType)===__dcg_shared_module_exports__['da']||(h==null?void 0:h.valueType)===__dcg_shared_module_exports__['ea']||(h==null?void 0:h.valueType)===__dcg_shared_module_exports__['ia']?__dcg_shared_module_exports__['Aa'](h,"dof"):n&&((D=(C=o.formula)==null?void 0:C.typed_constant_value)==null?void 0:D.valueType)===__dcg_shared_module_exports__['ha']?__dcg_shared_module_exports__['Aa'](o.formula.typed_constant_value,"dof"):void 0;case"pointEstimate":{let N=(P=u==null?void 0:u.formula)==null?void 0:P.typed_constant_value;return(N==null?void 0:N.valueType)===__dcg_shared_module_exports__['B']?N.value:void 0}case"standardError":{let N=(F=g==null?void 0:g.formula)==null?void 0:F.typed_constant_value;return(N==null?void 0:N.valueType)===__dcg_shared_module_exports__['B']?N.value:void 0}default:throw new Error(`Unexpected outputItem: ${t}`)}}inferenceInputValueHasError(e,t){var n,a,s,c,d;let o=this.getItemModel(e);if((o==null?void 0:o.type)!=="expression")return!0;if(!ea(o))return!1;switch(t){case"hypothesis":{let p=(a=(n=this.getInferenceObjectComputedModel(e,"hypothesis"))==null?void 0:n.formula)==null?void 0:a.typed_constant_value;return(p==null?void 0:p.valueType)!==__dcg_shared_module_exports__['B']||isNaN(p.value)?!0:((s=Ug(o))!=null?s:qv(o))==="zproptest"?eI(o)===2?p.value<-1||p.value>1:p.value<0||p.value>1:!1}case"confidenceLevel":{let p=(d=(c=this.getInferenceObjectComputedModel(e,"confidenceLevel"))==null?void 0:c.formula)==null?void 0:d.typed_constant_value;return(p==null?void 0:p.valueType)!==__dcg_shared_module_exports__['B']?!0:isNaN(p.value)||p.value<0||p.value>1}default:throw new Error(`Unhandled type ${t}`)}}};function uB(r){let e={};for(let[t,o]of Object.entries(r.parameters)){let i=aU(o),n=Math.max(i,r.displayPrecision);e[t]=parseFloat(o.toPrecision(n))}return e}function $oe(r){return r&&{...r,wasCompleteSetState:void 0,layoutModel:void 0,settingsViewModel:void 0}}function pke(r,e){return __dcg_shared_module_exports__['db']($oe(r),$oe(e))}var{SwitchUnion:uke,If:hV,IfDefined:hB,IfElse:hke}=Kr.Components,gV=class extends Kr.View{init(){this.model=this.props.table(),this.controller=this.props.controller()}isDropdownOpen(){return this.controller.isTableRegressionsDropdownOpen(this.model.id)}customRegressionsEnabled(){return this.controller.getGraphSettings().config.customRegressions}template(){return hB(()=>this.getRegression(),e=>x("div",{class:()=>({"dcg-table-regression":!0,"dcg-do-not-blur":!0}),handleEvent:Kr.const("true"),onKeyDown:this.bindFn(this.handleKeyDown),children:[x("div",{class:()=>({"dcg-dropdown-row":!0,"dcg-dropdown-row__has-column-picker":this.shouldShowColumnDropdown()}),children:[x("div",{class:Kr.const("dcg-dropdown-row__plot-and-model"),children:[l("div",{class:Kr.const("dcg-icon-container"),children:uke(()=>e().evaluated,"status",{error:t=>l(Zo,{instant:this.const(!0),error:()=>this.controller.unpack(t().error)}),success:()=>l("div",{class:Kr.const("dcg-circular-icon-container"),role:Kr.const("button"),tabIndex:Kr.const("0"),"dcg-open-menu-guid":()=>this.getGuid(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:t=>{if(!t.wasLongheld()){if(t.shiftKey||this.optionsOpen()||this.controller.isInEditListMode())return this.toggleOptions();this.setHidden(!e().spec.hidden)}},onLongHold:t=>{Xt(t,"dcg-longhold"),Xt(t,"dcg-tap"),this.toggleOptions()},manageFocus:this.const(ze({controller:this.controller,location:{type:"table-regression-icon",id:this.model.id}})),children:l(qo,{iconType:()=>e().spec.hidden?"hidden":"graph-default",backgroundColor:()=>{var t;return{type:"single-color",value:(t=e().spec.color)!=null?t:""}},whiteIcon:this.const(!1),foregroundColor:this.const(""),iconModifier:this.const("none"),backgroundOpacity:this.const(1)})})})}),l(Ld,{id:()=>`regression-model-${this.model.id}`,controller:()=>this.controller,options:()=>this.getModelOptions(),addBottomPaddingToDropdown:this.const(!0),onOpenChange:this.bindFn(this.onDropdownOpenChange),externalControl:this.const({getValue:()=>this.getRegressionType(),onValueChange:t=>{this.controller.dispatch({type:"update-table-regression",tableId:this.model.id,update:{type:t}})}}),manageFocus:this.const(ze({controller:this.controller,location:{type:"table-regression-type-dropdown",id:this.model.id}})),buildFooter:()=>this.customRegressionsEnabled()?l("div",{class:Kr.const("dcg-table-regression-view__custom-model-notice"),children:x(Ot,{i18n:this.const(this.controller),children:["Make a custom regression model in a new line using"," ",l("span",{class:Kr.const("dcg-tilde"),children:"~"}),"."," ",l("a",{class:Kr.const("dcg-blue-link"),href:Kr.const("https://help.desmos.com/hc/en-us/articles/4406972958733-Regressions"),target:Kr.const("_blank"),children:"Learn how"}),"."]},this.const("graphing-calculator-text-make-custom-regression"))}):[]})]}),x("div",{class:Kr.const("dcg-dropdown-row__breakable"),children:[l(hV,{predicate:()=>this.shouldShowColumnDropdown(),children:()=>l("div",{class:Kr.const("dcg-table-regression__dropdown-separator"),children:()=>this.controller.s("shared-calculator-label-for")})}),l(hV,{predicate:()=>this.shouldShowColumnDropdown(),children:()=>l("div",{class:Kr.const("dcg-dropdown-row__column-selector"),children:l(Ld,{id:()=>`regression-data-${this.model.id}`,addBottomPaddingToDropdown:this.const(!0),controller:()=>this.controller,options:()=>this.getColumnOptions(),onOpenChange:this.bindFn(this.onDropdownOpenChange),manageFocus:this.const(ze({controller:this.controller,location:{type:"table-regression-model-dropdown",id:this.model.id}})),externalControl:this.const({getValue:()=>`id-${e().spec.columnIds.y}`,onValueChange:t=>{this.controller.dispatch({type:"update-table-regression",tableId:this.model.id,update:{columnIds:{x:e().spec.columnIds.x,y:t.substring(3)}}})}})})})}),hke(this.bindFn(this.customRegressionsEnabled),{true:()=>l(oa,{anchor:()=>l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-text-view-regression-options"),children:l(za,{})}),anchorAriaLabel:()=>this.controller.s("graphing-calculator-text-view-regression-options"),controlled:()=>({isOpen:this.isDropdownOpen(),setDropdownOpen:this.bindFn(this.setDropdownOpen)}),guid:()=>`view-source-regression-${this.model.id}`,dropdownProps:this.const({position:this.const("bottom-left")}),dropdownOffset:()=>-15,focusTrapping:this.const({itemNavigationKey:"tab"}),manageFocus:this.const(ze({controller:this.controller,location:{type:"table-regression-view-source-popover",id:this.model.id}})),popoverBody:()=>x("div",{class:Kr.const("dcg-generic-options-menu"),children:[x("div",{class:Kr.const("dcg-options-menu-section"),children:[l("div",{class:Kr.const("dcg-expression-footer-title"),children:()=>this.controller.s("graphing-calculator-heading-table-regression-model-structure")}),l("div",{class:Kr.const("dcg-regression-model"),children:l(wa,{controller:this.props.controller,latex:this.bindFn(this.buildLatexForRegressionModel),ariaLabel:()=>this.controller.s("graphing-calculator-heading-table-regression-model-structure"),focusLocation:this.const({type:"regression-output",id:this.model.id,parameter:"model"}),tabbable:this.const(!1)})}),hB(()=>this.getExportErrorReason(),t=>l("div",{class:Kr.const("dcg-regression-popover__unexportable-warning dcg-text-selectable"),children:l(Xi,{content:()=>this.controller.unpack(t())})}))]}),x("div",{class:Kr.const("dcg-options-menu-section"),children:[l(hV,{predicate:()=>!this.getExportErrorReason(),children:()=>l("button",{class:Kr.const("dcg-btn-light-gray dcg-regression-popover__export-to-list"),onTap:()=>this.copyToExpressionList("regression"),manageFocus:this.const(ze({controller:this.controller,location:{type:"table-regression-export-btn",id:this.model.id}})),children:()=>this.controller.s("graphing-calculator-button-copy-table-regression-model-to-expression-list")})}),l("button",{class:Kr.const("dcg-btn-red dcg-regression-popover__delete"),onTap:()=>{this.setDropdownOpen(!1),this.controller.dispatch({type:"remove-table-regression",tableId:this.model.id})},manageFocus:this.const(ze({controller:this.controller,location:{type:"table-regression-delete-btn",id:this.model.id}})),children:()=>this.controller.s("graphing-calculator-button-delete-table-regression")})]})]})}),false:()=>l("i",{class:Kr.const("dcg-icon-remove"),role:Kr.const("button"),tabIndex:Kr.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-button-delete-table-regression"),onTap:()=>this.controller.dispatch({type:"remove-table-regression",tableId:this.model.id}),manageFocus:this.const(ze({controller:this.controller,location:{type:"table-regression-delete-btn",id:this.model.id}}))})})]})]}),l(hV,{predicate:()=>e().evaluated.status==="success",children:()=>x("div",{children:[x("div",{class:Kr.const("dcg-expression-footer-title dcg-expression-footer-title__equation"),children:[()=>this.controller.s("graphing-calculator-heading-regression-equation"),l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-text-export-snapshot"),children:l("button",{class:Kr.const("dcg-unstyled-button dcg-copy-regression-button"),onTap:()=>this.copyToExpressionList("equation"),"aria-label":()=>this.controller.s("graphing-calculator-text-export-snapshot"),manageFocus:this.const(ze({controller:this.controller,location:{type:"table-regression-copy-btn",id:this.model.id}})),children:l("i",{class:Kr.const("dcg-icon-insert"),"aria-hidden":Kr.const("true")})})})]}),l("div",{class:Kr.const("dcg-regression-equation dcg-do-not-blur"),onTap:this.bindFn(this.ensureTableSelected),didMount:this.bindFn(this.didMountRegressionEquation),didUnmount:this.bindFn(this.didUnmountRegressionEquation),children:l(wa,{controller:this.props.controller,latex:this.bindFn(this.buildLatexForRegressionEquation),ariaLabel:()=>this.controller.s("graphing-calculator-narration-table-regression-equation"),focusLocation:this.const({type:"regression-output",id:this.model.id,parameter:"equation"}),tabbable:this.const(!0)})}),hB(()=>this.getRegressionDetails(),t=>l(B1,{controller:()=>this.controller,model:()=>this.model,hideParameters:this.const(!0),regression:t,suppressRMSE:this.const(!0),suppressLogModeCheckbox:()=>!__dcg_shared_module_exports__['Me'](this.getRegressionType()),showRValue:()=>this.getRegressionType()==="linear"?"always":"never"}))]})})]}))}getExportErrorReason(){let e=this.getRegression();if(e){if(e.evaluated.status==="error")return e.evaluated.error;if(e.evaluated.export_info.status==="unexportable")return e.evaluated.export_info.reason}}buildLatexForRegressionEquation(){let e=this.getRegression();return!e||e.evaluated.status!=="success"?"":__dcg_shared_module_exports__['Ne'](e.spec.type,{operator:"=",variables:["x","y"],parameterValues:uB(e.evaluated.result)})}buildLatexForRegressionModel(){let e=this.getRegression();return e?__dcg_shared_module_exports__['Ne'](e.spec.type,{operator:"~",variables:["x","y"],parameterValues:"canonical"}):""}didMountRegressionEquation(e){this.regEqNode=e}didUnmountRegressionEquation(){this.cachedRegEqLatex="",this.regEqNode=void 0}addLineBreaks(){if(!this.regEqNode)return;let e=this.buildLatexForRegressionEquation();e!==this.cachedRegEqLatex&&(this.cachedRegEqLatex=e,this.regEqNode.querySelectorAll(".dcg-mq-binary-operator").forEach(t=>{var o,i;t.textContent!=="+"&&t.textContent!=="\u2212"||(i=(o=t.parentNode)==null?void 0:o.classList)!=null&&i.contains("dcg-mq-root-block")&&t.classList.add("dcg-break-before")}))}didUpdate(){this.addLineBreaks()}onDropdownOpenChange(e){e&&this.controller.scrollItemIntoView(this.model)}getRegressionType(){var e,t;return(t=(e=this.getRegression())==null?void 0:e.spec.type)!=null?t:"linear"}ensureTableSelected(){let e=this.model.id;this.controller.isItemSelected(e)||this.controller.dispatch({type:"set-selected-id",id:e,state:"selected"})}getRegressionDetails(){var e,t;if(((t=(e=this.model.formula)==null?void 0:e.table_regression)==null?void 0:t.status)==="success")return this.model.formula.table_regression.result}hasAnyNonPositiveXValues(){let e=this.model.regression;if(!e)return!1;let t=lo(this.model,e.columnIds.x);return __dcg_shared_module_exports__['Ja']((t==null?void 0:t.computedValues)||[],o=>parseFloat(o)<=0)}getRegression(){var o;if(!this.controller.areTableRegressionsEnabled())return;let e=this.model.regression,t=(o=this.model.formula)==null?void 0:o.table_regression;if(e){let i=lo(this.model,e.columnIds.x),n=lo(this.model,e.columnIds.y);!i||!n||i.hasNanOrErrorValue||n.hasNanOrErrorValue?t={status:"error",error:__dcg_shared_module_exports__['Gb']().getError()}:e.type==="logarithmic"&&this.hasAnyNonPositiveXValues()&&(t={status:"error",error:__dcg_shared_module_exports__['Hb']().getError()})}return e&&t?{spec:e,evaluated:t}:void 0}shouldShowColumnDropdown(){return this.getColumnOptions().length>1}getColumnOptions(){let e=new Set,t=this.model.regression;return t&&(e.add(t.columnIds.x),e.add(t.columnIds.y)),this.model.columnModels.slice(1).filter(o=>e.has(o.id)||ju(o)).map(o=>({label:"`"+o.latex+"`",id:"id-"+o.id,disabled:!Tg(o)||!ju(o)}))}setDropdownOpen(e){let t=this.model.id;this.controller.dispatch({type:"set-table-regression-dropdown-open",tableId:t,open:e,regressionType:this.getRegressionType()})}getModelOptions(){return[{id:"linear",label:this.controller.s("graphing-calculator-label-table-regression-type-linear")},{id:"quadratic",label:this.controller.s("graphing-calculator-label-table-regression-type-quadratic")},{id:"cubic",label:this.controller.s("graphing-calculator-label-table-regression-type-cubic")},{id:"quartic",label:this.controller.s("graphing-calculator-label-table-regression-type-quartic")},{id:"exponential",label:this.controller.s("graphing-calculator-label-table-regression-type-exponential")},{id:"logarithmic",label:this.controller.s("graphing-calculator-label-table-regression-type-logarithmic")},{id:"power",label:this.controller.s("graphing-calculator-label-table-regression-type-power")},{id:"logistic",label:this.controller.s("graphing-calculator-label-table-regression-type-logistic")},{id:"sinusoidal",label:this.controller.s("graphing-calculator-label-table-regression-type-sinusoidal")}]}copyToExpressionList(e){this.setDropdownOpen(!1),this.controller.dispatch({type:"export-table-regression",tableId:this.model.id,mode:e,regressionType:this.getRegressionType()})}getGuid(){return`table-regression-${this.model.guid}`}toggleOptions(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"table-regression",model:this.model,guid:this.getGuid(),focusFirstOption:!0}})}setHidden(e){this.controller.dispatch({type:"update-table-regression",tableId:this.model.id,update:{hidden:e}})}optionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getGuid())}getIconAriaLabel(){var e;return this.optionsOpen()?this.controller.s("graphing-calculator-narration-hide-options"):(e=this.model.regression)!=null&&e.hidden?this.controller.s("graphing-calculator-narration-show-table-regression"):this.controller.s("graphing-calculator-narration-hide-table-regression")}handleKeyDown(e){let t=Jr(e);if(!e.altKey&&e.ctrlKey&&!e.metaKey&&e.shiftKey&&t==="O"){if(e.preventDefault(),e.stopPropagation(),this.controller.getOpenItemMenu()!==void 0)return;this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"table-regression",model:this.model,guid:this.getGuid(),focusFirstOption:!0}})}}};var qh=__dcg_shared_module_exports__['e'](j());Ut();var Od=__dcg_shared_module_exports__['e'](j());var{SwitchUnion:gke,If:mke}=Od.Components,OC=class extends Od.View{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return l("div",{class:()=>({"dcg-table-icon-container":this.typeOfIcon()!=="none"}),children:gke(this.bindFn(this.typeOfIcon),{error:()=>l(Zo,{error:()=>this.controller.unpack(this.model.error)}),none:()=>l("span",{}),icon:()=>x("div",{"aria-hidden":()=>!this.shouldIconBeFocused(),class:Od.const("dcg-circular-icon-container"),role:Od.const("button"),tabIndex:Od.const("0"),"aria-label":this.bindFn(this.getIconAriaLabel),handleEvent:Od.const("true"),"dcg-open-menu-guid":()=>this.getMenuGUID(),onTap:e=>{if(!jr(e,"dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions();if(this.controller.isInEditListMode()||e.shiftKey)return this.toggleOptions();this.toggleGraphShown()}},onLongHold:e=>{Xt(e,"dcg-longhold"),Xt(e,"dcg-tap"),this.toggleOptions()},manageFocus:this.const(ze({controller:this.controller,location:{type:"table-icon",id:this.model.table.id,columnId:this.model.id}})),children:[l(qo,{iconType:this.bindFn(this.getIcon),backgroundColor:this.bindFn(this.getModelColor)}),l(mke,{predicate:()=>this.model.disableGraphInteractions,children:()=>l("i",{class:Od.const("dcg-graph-interaction-disabled dcg-icon-lock"),"aria-hidden":Od.const("true")})})]})})})}getModelColor(){return k0(this.model)}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"table-column",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}})}toggleGraphShown(){this.controller.dispatch({type:"toggle-tablecolumn-hidden",tableId:this.model.table.id,columnId:this.model.id})}hasError(){return!!this.model.error}getIcon(){return this.model.shouldGraph?this.controller.isInEditListMode()?"none":this.model.points&&this.model.lines?"table-points-and-lines":this.model.points&&!this.model.lines?"table-points":!this.model.points&&this.model.lines?"table-lines":"none":"hidden"}typeOfIcon(){return this.model.latex===""||!this.controller.getGraphSettings().config.graphpaper?"none":this.model.error?"error":this.model.suppressIcon||this.model.index===0?"none":"icon"}getIconAriaLabel(){return this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-options"):this.controller.isInEditListMode()?this.controller.s("graphing-calculator-narration-show-options"):this.model.shouldGraph?this.controller.s("graphing-calculator-narration-hide-table-column"):this.controller.s("graphing-calculator-narration-show-table-column")}shouldIconBeFocused(){let e=this.controller.getFocusLocation();return __dcg_shared_module_exports__['db'](e,{type:"table-icon",id:this.model.table.id,columnId:this.model.id})}};var{If:mV,Switch:fke}=qh.Components,fV=class extends qh.View{init(){this.columnModel=this.props.columnModel(),this.controller=this.props.controller(),this.table=this.columnModel.table}isRightSide(){return this.lookupCellPosition().column>=this.table.columnModels.length-1}isHeader(){return this.props.rowIdx()===0}template(){return x("td",{role:()=>this.isHeader()?"columnheader":void 0,class:()=>({"dcg-cell":!0,"dcg-table-header":this.isHeader(),"dcg-selected":this.shouldFocus(),"dcg-first-column":this.getColumnType()==="first","dcg-interior-column":this.getColumnType()==="interior","dcg-last-column":this.getColumnType()==="last","dcg-header-error":!!this.columnModel.error&&!!this.columnModel.latex&&this.isHeader(),"dcg-cell-error":this.hasCellError(),"dcg-leave-space-for-icon":this.leaveSpaceForIcon(),"dcg-non-editable":!!this.isDisabled(),"dcg-computed-cell":this.isComputed(),"dcg-interior-row":this.isInteriorRow()}),index:()=>this.columnModel.index,onTap:this.bindFn(this.exitEditListMode),children:[l(mV,{predicate:this.bindFn(this.showIcon),children:()=>l(OC,{model:this.props.columnModel,controller:this.props.controller})}),l(mV,{predicate:this.bindFn(this.hasCellError),children:()=>l("span",{class:qh.const("dcg-table-icon-error-container"),children:l(Zo,{error:this.bindFn(this.getCellErrorMessage),size:this.const("small")})})}),l(fke,{children:e=>{switch(e){case!0:return l(un,{latex:this.bindFn(this.getCellContent),isFocused:this.bindFn(this.shouldFocus),ariaLabel:()=>this.getAriaLabel("speech"),brailleAriaLabel:()=>this.getAriaLabel("braille"),selectOnFocus:this.const(!0),onKeydown:this.bindFn(this.handleKeydownOnBrailleInput),...ra(this.props.controller()),noFadeout:this.const(!0),getAriaPostLabel:this.bindFn(this.getAriaPostLabel),hasError:this.const(!1),onUserPressedKey:this.bindFn(this.handleEditableMathquillKey),onUserChangedLatex:this.bindFn(this.handleLatexChanged),onFocusedChanged:this.bindFn(this.handleMQFocusedChanged)});case!1:return l(wa,{controller:()=>this.controller,latex:this.bindFn(this.getCellContent),ariaLabel:()=>this.getAriaLabel("speech"),brailleAriaLabel:()=>this.getAriaLabel("braille"),onKeypress:t=>(this.handleHotkeyEvent(t)||this.handleKeyboardNavigation(Pe(t),t),!0),suppressBlurEvent:t=>this.isNodeWithinTableCell(t.relatedTarget),tabbable:this.bindFn(this.isTabbable),focusLocation:()=>({type:"table",id:this.table.id,location:this.lookupCellPosition()})})}}},this.bindFn(this.isEditable)),l(mV,{predicate:this.bindFn(this.hasDragIcon),children:()=>l("span",{class:qh.const("dcg-drag-icon"),"dcg-drag-mode":()=>this.columnModel.dragMode,style:()=>({color:this.columnModel.color}),children:l("i",{class:()=>({"dcg-icon-move":this.columnModel.dragMode===__dcg_shared_module_exports__['Gd'].XY,"dcg-icon-move-horizontal":this.columnModel.dragMode===__dcg_shared_module_exports__['Gd'].X,"dcg-icon-move-vertical":this.columnModel.dragMode===__dcg_shared_module_exports__['Gd'].Y}),"aria-hidden":qh.const("true")})})}),l(mV,{predicate:()=>this.isRightSide(),children:()=>l("span",{class:qh.const("dcg-fade-right")})})]})}isEditable(){return this.controller.isInEditListMode()||this.controller.isItemReadonly(this.table.id)?!1:this.isHeader()?!0:!(this.columnModel===this.table.columnModels[this.table.columnModels.length-1]||this.isDisabled())}isTabbable(){return!(this.controller.isInEditListMode()||this.columnModel===this.table.columnModels[this.table.columnModels.length-1])}getCellContent(){if(this.isHeader())return this.columnModel.latex||"";let e=this.props.rowIdx()-1,t=this.columnModel.index;return v0(this.table,e,t)}getPackedCellError(){return this.isHeader()?"":this.columnModel.packedErrors[this.props.rowIdx()-1]}getCellErrorMessage(){let e=this.getPackedCellError();return e?this.controller.unpack(e):""}hasCellError(){return!!this.getPackedCellError()}showIcon(){return!this.isHeader()||this.isRightSide()?!1:!this.controller.is3dProduct()||!!this.columnModel.error}isDisabled(){return tv(this.columnModel)&&!this.isHeader()}isComputed(){return iH(this.columnModel)&&!this.isHeader()}isInteriorRow(){return this.isHeader()?!1:this.lookupCellPosition().row!==Xn(this.table)}exitEditListMode(e){this.controller.isInEditListMode()&&e.target.closest(".dcg-math-field")&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}getColumnType(){let e=this.lookupCellPosition().column;return e===0?"first":e===this.table.columnModels.length-1?"last":"interior"}hasDragIcon(){return this.isHeader()?this.columnModel.dragMode!==__dcg_shared_module_exports__['Gd'].NONE&&!this.columnModel.error:!1}leaveSpaceForIcon(){if(this.columnModel.error||this.controller.is3dProduct()||this.columnModel.suppressIcon)return!1;let{column:e}=this.lookupCellPosition(),t=Qf(this.table);return e>0&&e<t-1}handleFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}lookupCellPosition(){return{row:this.props.rowIdx(),column:this.columnModel.index}}getAriaLabel(e){let t=this.lookupCellPosition();if(!this.isHeader()){if(e==="speech"&&this.isComputed())return this.controller.s("graphing-calculator-narration-computed-cell-role-description");if(e==="braille"){let o=t.row,i=t.column+1;return this.controller.raw("r__row__c__column__",{row:o.toString(),column:i.toString()})}}return e==="speech"?" ":this.controller.raw("h__column__",{column:t.column+1})}getAriaPostLabel(){if(!this.isHeader())return"";let e="",t=this.columnModel;return t.shouldGraph&&(t.points||t.lines)&&!oH(t)&&(e=this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph"),qr?e+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-mac"):e+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-windows")),e}handleHotkeyEvent(e){if(this.controller.isInEditListMode())return!1;let t=this.lookupCellPosition();if(!e.ctrlKey||e.shiftKey||e.altKey||e.metaKey||!t)return!1;if(Pe(e)==="Up")return e.preventDefault(),e.stopPropagation(),this.setFocusLocation({row:0,column:t.column}),!0;if(Pe(e)==="Down")return e.preventDefault(),e.stopPropagation(),this.setFocusLocation({row:Xn(this.table),column:t.column}),!0;if(Pe(e)==="Left")return e.preventDefault(),e.stopPropagation(),this.setFocusLocation({row:t.row,column:0}),!0;if(Pe(e)==="Right")return e.preventDefault(),e.stopPropagation(),this.setFocusLocation({row:t.row,column:Qf(this.table)-2}),!0;if(Jr(e)==="H"){e.preventDefault(),e.stopPropagation();let o=this.controller.s("graphing-calculator-narration-table-no-column-header"),i=this.table.columnModels[t.column].latex;return i&&(o=Pl.StaticMath(document.createElement("span")).latex(i).mathspeak()),_e(o),!0}return!1}handleEditableMathquillKey(e,t){if(t&&this.handleHotkeyEvent(t))return;let o=Qe.getFocusedMathquill();o&&e&&(Qe.handleKeystrokeAndDecideIfSpecialEvent(o,e,t)||e===Wi?this.handleKeyboardNavigation(e,t):this.handleLatexChanged(o.latex()))}handleKeydownOnBrailleInput(e){if(this.handleHotkeyEvent(e))return;let t=Pe(e);if(!t)return;t===Wi&&Dr();let o=t==="Enter"||t==="Up"||t==="Down",i=_c(),n=i&&t==="Left"&&i.selectionStart===0||t==="Right"&&i.selectionStart===i.value.length;(o||n||(t==="Del"||t==="Backspace")&&this.getCellContent().length===0)&&this.handleKeyboardNavigation(t,e)}handleKeyboardNavigation(e,t){switch(e){case"Up":case"Down":case"Left":case"Right":case"Backspace":case"Del":case"Enter":return this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:e}),t==null||t.stopPropagation(),t==null||t.preventDefault(),!0;case"Esc":return t==null||t.stopPropagation(),t==null||t.preventDefault(),Dr(),!0}return!1}handleLatexChanged(e){this.getCellContent()!==e&&this.controller.dispatch({type:"set-tablecell-latex",tableId:this.table.id,cell:this.lookupCellPosition(),latex:e})}shouldFocus(){return!this.controller.isInEditListMode()&&__dcg_shared_module_exports__['db'](this.lookupCellPosition(),gs(this.table))}setFocusLocation(e){this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:e}})}isNodeWithinTableCell(e){if(!e||!e.closest(".dcg-cell"))return!1;let t=this.controller.getItemRootNodeById(this.table.id);return t?re.contains(t,e):!1}handleMQFocusedChanged(e,t){e?this.setFocusLocation(this.lookupCellPosition()):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}};var{For:Zoe}=rn.Components,RC=class extends Es{didMountRoot(e){this.onItemViewMounted(e),this.didMountContainer(e)}willUnmount(){this.onItemViewUnmounted()}template(){return x("div",{class:()=>({"dcg-expressionitem":!0,"dcg-highlighted-expressionitem":this.controller.isExpressionHighlighted(this.id),"dcg-expressiontable":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-inFolder":!!this.model.folderId,"dcg-selected":!!this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-faded-h":this.shouldFadeLastColumn(),"dcg-faded-v":this.shouldFadeLastRow()}),"expr-id":()=>this.model.id,didMount:this.bindFn(this.didMountRoot),children:[x("div",{class:rn.const("dcg-fade-container dcg-disable-horizontal-scroll-to-cursor"),children:[x("div",{class:rn.const("dcg-main"),children:[l("div",{class:rn.const("dcg-table-container"),tabIndex:()=>this.controller.isInEditListMode()?0:-1,"aria-label":()=>this.controller.getBrailleMode()==="none"?this.controller.s("graphing-calculator-narration-expression-index-table",{index:this.model.displayIndex}):this.controller.s("graphing-calculator-narration-expression-index-table",{index:this.model.displayIndex}),didMount:this.bindFn(this.didMountContainer),manageFocus:this.const({shouldBeFocused:this.shouldBeFocused.bind(this),onFocusedChanged:this.onFocusedChanged.bind(this)}),children:l("div",{class:rn.const("dcg-table-sliding-container"),style:()=>({transform:`translateX(${this.computeScrolledX()}px)`}),children:l("table",{role:rn.const("grid"),class:rn.const("dcg-tabledata"),style:()=>({"--dcg-column-count":`${this.model.columnModels.length}`}),children:l(Zoe,{each:()=>this.getVisibleRows(),children:e=>{if(e.type==="show-more")return l("tr",{class:rn.const("dcg-show-more-row"),children:x("div",{class:rn.const("dcg-show-more-row-interior dcg-do-not-blur"),children:[this.bindFn(this.missingRowMessage),l("button",{class:rn.const("dcg-show-more dcg-blue-link dcg-unstyled-button"),onTap:()=>this.controller.dispatch({type:"table-show-more-rows",id:this.id}),children:()=>this.controller.s("graphing-calculator-button-show-all-table-rows")})]})});if(e.type==="spacer-row")return l("tr",{class:rn.const("dcg-row"),children:l("td",{class:rn.const("dcg-blank-row"),style:()=>({height:(e.endIdx-e.startIdx+1)*this.getRowHeight()+"px"})})});{let t=e.type==="header"?0:e.index;return l("tr",{"aria-rowindex":()=>t,class:rn.const("dcg-row"),children:l(Zoe,{each:()=>this.model.columnModels,children:o=>l(fV,{controller:this.props.controller,columnModel:this.const(o),rowIdx:()=>t})},o=>o.guid)})}}},e=>this.getRowGUID(e))})})}),l(gV,{controller:this.props.controller,table:this.props.model})]}),l(Ic,{controller:this.props.controller,model:this.props.model})]}),x("span",{class:rn.const("dcg-tab dcg-action-drag"),handleEvent:rn.const("true"),tapboundary:rn.const("true"),disablescroll:rn.const("true"),onTapStart:this.bindFn(this.onDragPending),children:[l("span",{class:rn.const("dcg-num"),children:()=>this.model.displayIndex}),l("div",{class:rn.const("dcg-tab-interior")}),l(tV,{model:this.props.model,controller:this.props.controller}),l(W1,{model:this.props.model,controller:this.props.controller})]}),l(Cc,{controller:this.props.controller,id:()=>this.model.id})]})}getRowGUID(e){switch(e.type){case"header":return"header";case"show-more":return"show-more";case"spacer-row":return`spacer-${e.startIdx}-${e.endIdx}`;case"standard-row":return`row-${e.index}`}}getRowHeight(){return this.controller.getGraphSettings().config.projectorMode?38:33}getVisibleRows(){var g,h,b;let e=[{type:"header"}],t=Xn(this.model)+1;if(t<=25){for(let v=1;v<t;v++)e.push({type:"standard-row",index:v});return e}let o=Zf(this.model);if(o!==void 0){for(let v=1;v<o.min;v++)e.push({type:"standard-row",index:v});e.push({type:"show-more"});for(let v=o.max;v<t;v++)e.push({type:"standard-row",index:v});return e}let i=Dy(this.controller),n=i?i.height:0,a=re(this.node).offset(),s=(a?a.top:0)-(i?i.top:0),c=(b=(h=(g=this.node)==null?void 0:g.querySelector(".dcg-cell"))==null?void 0:h.getBoundingClientRect().height)!=null?b:0,d=this.getRowHeight();if(n/d>t){for(let v=1;v<t;v++)e.push({type:"standard-row",index:v});return e}let p=(-s-c)/d,u=(n-s)/d;for(let v=1;v<t;v++){let T=gs(this.model);if(v===t-2||T&&T.row===v)e.push({type:"standard-row",index:v});else if(v>u||v<p){let E=e[e.length-1];E&&E.type==="spacer-row"?E.endIdx=v:e.push({type:"spacer-row",startIdx:v,endIdx:v})}else e.push({type:"standard-row",index:v})}return e}missingRowMessage(){let e=Zf(this.model);return e===void 0?"":this.controller.s("graphing-calculator-text-table-more-rows",{rowCount:e.max-e.min})}didMountContainer(e){this.node=e,re(e).on("scroll",()=>e.scrollLeft=0)}getSelectedCell(){return gs(this.model)}computeScrolledX(){if(!this.getSelectedCell()||!this.node)return 0;let e=this.node.children[0],t=this.node.querySelector(".dcg-selected");if(e===null||t===null)return 0;let o=this.node.getBoundingClientRect(),i=t.getBoundingClientRect(),n=i.left-e.getBoundingClientRect().left,a=o.width-n-i.width-30,s=Math.min(0,o.width-e.scrollWidth-30);return a=Math.max(a,s),Math.min(0,a)}shouldFadeLastRow(){return aH(this.model)&&!this.isBottomFocused()}shouldFadeLastColumn(){return!this.isRightFocused()}isBottomFocused(){let e=this.getSelectedCell();return!!e&&e.row===Xn(this.model)}isRightFocused(){let e=this.getSelectedCell();return!!e&&e.column===this.model.columnModels.length-1}focusHelperOptions(){return{controller:this.controller,location:{type:"table-container",id:this.model.id}}}shouldBeFocused(){return _1(this.focusHelperOptions())}onFocusedChanged(e){if(this.controller.isInEditListMode())return _k(this.focusHelperOptions(),e)}};var Rd=__dcg_shared_module_exports__['e'](j());var FC=class extends Es{didMountRoot(e){this.onItemViewMounted(e)}willUnmount(){this.onItemViewUnmounted()}template(){return x("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-highlighted-expressionitem":this.controller.isExpressionHighlighted(this.id),"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressiontext":!0,"dcg-inFolder":!!this.model.folderId,"dcg-selected":!!this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id)}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect),didMount:this.bindFn(this.didMountRoot),children:[x("div",{class:Rd.const("dcg-fade-container"),children:[l("div",{class:Rd.const("dcg-main"),children:l(Uh,{isFocused:this.bindFn(this.isFocused),text:()=>this.model.text,showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey),readonly:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.id),readonlyAction:this.const({predicate:()=>this.controller.isInEditListMode(),action:()=>this.exitEditListMode()}),ariaLabel:()=>Wr(this.model,"edit_title"),placeholder:()=>this.controller.s("graphing-calculator-text-note-placeholder")})}),l(Ic,{controller:this.props.controller,model:this.props.model})]}),x("span",{class:Rd.const("dcg-tab dcg-action-drag"),handleEvent:Rd.const("true"),tapboundary:Rd.const("true"),disablescroll:Rd.const("true"),onTapStart:this.bindFn(this.onDragPending),children:[l("span",{class:Rd.const("dcg-num"),children:()=>this.model.displayIndex}),l("div",{class:Rd.const("dcg-tab-interior")}),l("i",{class:Rd.const("dcg-icon-text"),"aria-hidden":Rd.const("true")})]}),l(Cc,{controller:this.props.controller,id:()=>this.model.id})]})}onInput(e){this.controller.dispatch({type:"set-note-text",id:this.id,text:e})}onFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"text",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"text",id:this.id}})}onSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}isFocused(){let e=this.controller.getFocusLocation();return!(!e||e.type!=="text"||e.id!==this.id)}};var on=__dcg_shared_module_exports__['e'](j());var{If:Qoe,IfDefined:bke}=on.Components,bV=class extends on.View{init(){this.controller=this.props.controller()}template(){return x("div",{class:()=>({"dcg-ticker":!0,"dcg-expressions-scrolled":this.props.expsScrolled()}),children:[x("div",{class:on.const("dcg-ticker-settings-container"),children:[x("div",{class:on.const("dcg-ticker-settings-internal"),children:[x("div",{class:on.const("dcg-editable-mathquill-container dcg-action-definition"),children:[l("span",{class:on.const("dcg-ticker-label"),children:()=>this.controller.raw("Run")}),l(un,{latex:()=>this.getHandlerLatex(),ariaLabel:()=>this.controller.s("graphing-calculator-narration-tick-action"),isFocused:()=>this.getFocusedInput()==="handler",onKeydown:e=>this.handlePressedKey("handler",e.key,e),...ra(this.controller,{additionalOperators:["dt"]}),hasError:()=>!!this.getHandlerErrorString(),getAriaPostLabel:()=>{let e=this.getHandlerErrorString();return e?this.controller.unpack(e):""},onUserChangedLatex:this.bindFn(this.dispatchHandlerLatexIfChanged),onFocusedChanged:e=>this.handleFocusedChanged("handler",e),selectOnFocus:this.const(!0),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{this.handlePressedKey("handler",e,t)}}),bke(()=>this.getHandlerErrorString(),e=>l("span",{class:on.const("dcg-clickable-info-error-container"),children:l(Zo,{error:()=>this.controller.unpack(e()),size:this.const("small")})}))]}),x("div",{class:on.const("dcg-editable-mathquill-container dcg-action-frequency"),children:[l("span",{class:on.const("dcg-ticker-label"),children:()=>this.controller.raw("every")}),l(un,{latex:()=>this.getMinStepLatex(),ariaLabel:()=>this.controller.s("graphing-calculator-label-ticker-min-step"),onKeydown:e=>this.handlePressedKey("minstep",e.key,e),...ra(this.controller),hasError:()=>!!this.getMinStepErrorString(),getAriaPostLabel:()=>{let e=this.getMinStepErrorString();return e?this.controller.unpack(e):""},onUserChangedLatex:this.bindFn(this.dispatchMinStepLatexIfChanged),isFocused:()=>this.getFocusedInput()==="minstep",onFocusedChanged:e=>this.handleFocusedChanged("minstep",e),selectOnFocus:this.const(!0),placeholder:this.const("0"),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{this.handlePressedKey("minstep",e,t)}}),()=>this.controller.raw("ms"),l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-ticker-help-tooltip"),gravity:this.const("s"),children:l("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-ticker-help-tooltip"),class:on.const("dcg-ticker-toggle-help"),target:on.const("_blank"),href:on.const("https://help.desmos.com/hc/en-us/articles/4407725009165#h_01FB2RZQRYM62C3EB94H2TRRAX"),children:l("i",{class:on.const("dcg-icon-question-sign"),"aria-hidden":on.const("true")})})})]}),l(Qoe,{predicate:this.bindFn(this.shouldShowSliderPrompt),children:()=>l(Is,{model:()=>this.props.controller().getTicker(),controller:this.props.controller})})]}),x("div",{class:()=>({"dcg-circular-icon-container":!0,"dcg-disabled":this.iconDisabled()}),"aria-label":this.bindFn(this.getIconAriaLabel),role:on.const("button"),tabIndex:()=>this.iconDisabled()?-1:0,"aria-disabled":this.bindFn(this.iconDisabled),"aria-pressed":()=>this.controller.getTickerPlaying()&&!this.iconDisabled(),onTap:this.bindFn(this.toggleTicker),onTapStart:()=>{Dr()},children:[l(qo,{iconType:this.const("metronome")}),l("div",{class:()=>({"dcg-metronome-bar":!0,"dcg-metronome-playing":this.controller.getTickerPlaying()&&!this.iconDisabled()})}),l(Qoe,{predicate:()=>!this.iconDisabled(),children:()=>l("div",{class:on.const("dcg-mini-play-pause"),children:l(qo,{iconType:this.bindFn(this.getPlayIcon)})})})]})]}),l("i",{onTap:this.bindFn(this.closeTicker),tabIndex:()=>this.controller.isInEditListMode()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-label-ticker-close"),role:on.const("link"),class:on.const("dcg-icon-remove dcg-do-not-blur")})]})}iconDisabled(){return!!(this.getMinStepErrorString()||this.getHandlerErrorString()||!this.isHandlerMaybeValid())}isHandlerMaybeValid(){var t;return((t=this.controller.getTicker().formula)==null?void 0:t.handler.status)==="maybe-valid"}closeTicker(){this.controller.dispatch({type:"close-ticker"})}toggleTicker(){this.iconDisabled()||this.controller.dispatch({type:"toggle-ticker"})}getPlayIcon(){return this.controller.getTickerPlaying()?"pause":"play"}getIconAriaLabel(){return this.controller.getTickerPlaying()?this.controller.s("graphing-calculator-label-ticker-pause"):this.controller.s("graphing-calculator-label-ticker-play")}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="ticker"))return e.location}handlePressedKey(e,t,o){let i=Qe.getFocusedMathquill();if(i){if(t==="PageUp"||t==="PageDown")return o==null||o.preventDefault(),o==null||o.stopPropagation(),this.controller.dispatch({type:"on-special-key-pressed",key:t});if(t==="Enter"&&this.shouldShowSliderPrompt()&&this.controller.dispatch({type:"create-sliders-for-ticker",variables:O0(this.props.controller().getTicker())}),t==="Esc"&&this.controller.getExpressionSearchOpen()&&this.controller.dispatch({type:"close-expression-search"}),t==="Right"&&e==="handler"||t==="Left"&&e==="minstep"||t==="Down"||t==="Up"){if(!Qe.applyArrowKeyAndReturnIfWasAtBounds(i,t,o))return;if(t==="Down"||t==="Up")return this.controller.dispatch({type:"on-special-key-pressed",key:t});if(t==="Right"){this.handleFocusedChanged("minstep",!0);return}else if(t==="Left"){this.handleFocusedChanged("handler",!0);return}}i.keystroke(t,o),e==="handler"?this.dispatchHandlerLatexIfChanged(i.latex()):e==="minstep"&&this.dispatchMinStepLatexIfChanged(i.latex())}}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"ticker",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"ticker",location:e}})}dispatchHandlerLatexIfChanged(e){this.getHandlerLatex()!==e&&this.controller.dispatch({type:"update-ticker-handlerlatex",latex:e})}dispatchMinStepLatexIfChanged(e){this.getMinStepLatex()!==e&&this.controller.dispatch({type:"update-ticker-minsteplatex",latex:e})}getHandlerLatex(){return this.controller.getTickerHandlerLatex()}getMinStepLatex(){return this.controller.getTickerMinStepLatex()}getHandlerErrorString(){return this.getHandlerLatex()?NW(this.controller.getTicker()):void 0}getMinStepErrorString(){return UW(this.controller.getTicker())}shouldShowSliderPrompt(){return this.controller.areSlidersEnabled()?O0(this.controller.getTicker()).length>0:!1}};var{If:yl,IfDefined:Zw,For:yke,Switch:eie,SwitchUnion:xke,IfElse:vke}=nn.Components,NC=class extends nn.View{constructor(){super(...arguments),this.guid=__dcg_shared_module_exports__['jb']("listView")}init(){this.controller=this.props.controller()}template(){return x("div",{didMount:this.bindFn(this.didMountContainer),children:[x("div",{class:nn.const("dcg-exppanel-outer"),onDrop:this.bindFn(this.onDrop),style:()=>this.computeExppanelOuterStyle(),children:[l(yl,{predicate:()=>this.controller.isFileDraggedOver(),children:()=>l("div",{class:nn.const("dcg-drop-image"),children:l("span",{children:()=>this.controller.s("graphing-calculator-label-drop-image-here")})})}),x("div",{class:()=>{var e;return{"dcg-exppanel-container":!0,"dcg-add-shadow":this.controller.shouldRenderList(),"dcg-global-mute-on":!!((e=this.controller.toneController)!=null&&e.isGlobalMuted())}},style:()=>({transform:this.controller.isListVisible()?void 0:this.controller.isNarrow()?"translate(0, 100%)":"translate(-100%, 0)"}),children:[l(yl,{predicate:()=>this.controller.shouldRenderList(),children:()=>l(eC,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})}),l(yl,{predicate:()=>this.controller.getExpressionSearchOpen(),children:()=>l(KG,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})}),l(yl,{predicate:()=>this.controller.getTickerVisible(),children:()=>l(bV,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})}),l(yl,{predicate:()=>this.controller.shouldRenderList(),children:()=>l("div",{class:()=>({"dcg-exppanel":!0,"dcg-disable-horizontal-scroll-to-cursor":!0,"dcg-isDragging":this.controller.isDragDropActive(),"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-edit-list-mode":this.controller.isInEditListMode()}),onPaste:this.bindFn(this.onPaste),onCopy:this.bindFn(this.onCopy),onCut:this.bindFn(this.onCut),onTapStart:this.bindFn(this.onExppanelTapstart),didMount:this.bindFn(this.didMountExppanel),children:x("div",{class:nn.const("dcg-expressionlist"),role:nn.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-expression-list"),children:[l(yl,{predicate:()=>this.controller.getShowConstructionsOpen(),children:()=>l($G,{controller:this.props.controller,onDragPending:(e,t)=>this.onDragPending(e,t)})}),x("span",{class:nn.const("dcg-template-expressioneach"),children:[l(yl,{predicate:()=>this.controller.shouldShowProgressUpdateLegend(),children:()=>l(iC,{controller:()=>this.props.controller()})}),l(yke,{each:()=>this.controller.getAllItemModels(),children:e=>xke(()=>xI(e),{shell:()=>this.makeShellViewForModel(e),render:()=>this.makeViewForModel(e),none:()=>{}})},e=>e.guid)]}),l(oC,{controller:()=>this.props.controller()}),l(eie,{children:e=>{if(e){let t=this.controller.getItemModel(e);return l(j_,{controller:this.props.controller,children:this.makeDragCopyViewForModel(t)})}else return}},()=>this.controller.getDraggedItemId()),l("span",{style:nn.const("flex:1")}),Zw(()=>this.controller.getShellView("notice"),e=>l(yl,{predicate:()=>!this.controller.isKeypadOpen(),children:()=>{let t=e();return l(t,{})}})),l(yl,{predicate:()=>!this.controller.isKeypadOpen(),children:()=>l("div",{class:nn.const("dcg-expressions-branding"),children:vke(()=>this.controller.canEditOnWeb(),{true:()=>x("span",{role:nn.const("link"),tabIndex:nn.const(0),class:nn.const("dcg-edit-branding"),onTap:()=>this.controller.dispatch({type:"open-on-web"}),children:[l("div",{class:nn.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-graph-on-desmos"),children:()=>this.controller.s("graphing-calculator-button-edit-graph-on-desmos-logo")}),l("i",{class:nn.const("dcg-icon-desmos"),"aria-hidden":nn.const("true")})]}),false:()=>x("div",{children:[l("div",{class:nn.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-powered-by-desmos"),children:()=>this.controller.s("graphing-calculator-label-powered-by")}),l("i",{class:nn.const("dcg-icon-desmos"),"aria-hidden":nn.const("true")})]})})})})]})})})]}),l(UG,{controller:this.props.controller})]}),l(yl,{predicate:()=>this.isOptionsViewOpen("expression"),children:()=>l(As,{menuType:this.const("expression"),menuButtonFocusLocation:()=>{let e=this.getActiveExpressionModelForOptionsView();return e?{type:"expression-icon",id:e.id}:void 0},...this.getSharedDropdownWrapperProps(),children:Zw(this.bindFn(this.getActiveExpressionModelForOptionsView),e=>l(tw,{controller:this.props.controller,model:e}))})}),l(yl,{predicate:()=>this.isOptionsViewOpen("image"),children:()=>l(As,{menuType:this.const("image"),menuButtonFocusLocation:()=>{let e=this.getActiveImageModelForOptionsView();return e?{type:"image-icon",id:e.id}:void 0},...this.getSharedDropdownWrapperProps(),children:Zw(this.bindFn(this.getActiveImageModelForOptionsView),e=>l(ZG,{controller:this.props.controller,model:e}))})}),l(yl,{predicate:()=>this.isOptionsViewOpen("slider"),children:()=>l(As,{menuType:this.const("slider"),menuButtonFocusLocation:()=>{let e=this.getActiveSliderModelForOptionsView();return e?{type:"slider-icon",id:e.id}:void 0},...this.getSharedDropdownWrapperProps(),children:Zw(this.bindFn(this.getActiveSliderModelForOptionsView),e=>l(eV,{controller:this.props.controller,model:e}))})}),l(yl,{predicate:()=>this.isOptionsViewOpen("table-column"),children:()=>l(As,{menuType:this.const("table-column"),menuButtonFocusLocation:()=>{let e=this.getActiveColumnModelForOptionsView();return e?{type:"table-icon",id:e.table.id,columnId:e.id}:void 0},...this.getSharedDropdownWrapperProps(),children:Zw(this.bindFn(this.getActiveColumnModelForOptionsView),e=>l(YG,{controller:this.props.controller,model:e}))})}),l(yl,{predicate:()=>this.isOptionsViewOpen("table-regression"),children:()=>l(As,{menuType:this.const("table-regression"),menuButtonFocusLocation:()=>{let e=this.getActiveTableModelForOptionsView();return e?{type:"table-regression-icon",id:e.id}:void 0},...this.getSharedDropdownWrapperProps(),children:Zw(this.bindFn(this.getActiveTableModelForOptionsView),e=>l(BG,{controller:this.props.controller,model:e}))})})]})}getSharedDropdownWrapperProps(){return{rootElSelector:this.const(".dcg-container"),openAriaAlert:this.const(this.controller.s("graphing-calculator-narration-options-menu-open")),closeAriaAlert:this.const(this.controller.s("graphing-calculator-narration-options-menu-closed")),focusOnOpen:this.bindFn(this.optionsViewFocusLocation),shouldHandleTabAndEscape:this.const(!0),controller:this.props.controller}}optionsViewFocusLocation(){let e=this.controller.getOpenItemMenu();if(!e||!("model"in e))return"none";let{model:t}=e;if(!t)return"none";let o=this.controller.getFocusLocation();if(!o||o.type!=="expression-menu"||o.id!==t.id)return"none";switch(o.location){case"start":return"first";case"end":return"last";default:return"none"}}getActiveSliderModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="slider"&&"model"in e?e.model:void 0}getActiveImageModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="image"&&"model"in e?e.model:void 0}getActiveExpressionModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="expression"&&"model"in e?e.model:void 0}getActiveColumnModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="table-column"&&"model"in e?e.model:void 0}getActiveTableModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="table-regression"&&"model"in e?e.model:void 0}isOptionsViewOpen(e){let t=this.controller.getOpenItemMenu();return!!t&&t.type===e}makeShellViewForModel(e){return l(nC,{controller:this.props.controller,model:()=>e,onDragPending:()=>{},isDragCopy:()=>!1})}computeExppanelOuterStyle(){this.getListBottomAndUpdateLastExpressionPadding();let{list:e}=this.controller.computeMajorLayout(),t=0,o=e.top;return e.top>0&&!this.controller.isListVisible()&&(o-=e.height),{position:"absolute",left:t+"px",top:o+"px",width:e.width+"px",height:e.height+"px","--dcg-exp-list-width":e.width+"px"}}makeDragCopyViewForModel(e){return this.makeViewForModel(e,!0)}makeViewForModel(e,t=!1){let o;if(e.type==="table")o=l(RC,{controller:this.props.controller,model:()=>e,onDragPending:i=>this.onDragPending(i,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="folder")o=l(tC,{controller:this.props.controller,model:()=>e,onDragPending:i=>this.onDragPending(i,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="text")o=l(FC,{controller:this.props.controller,model:()=>e,onDragPending:i=>this.onDragPending(i,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="image")o=l(rC,{controller:this.props.controller,model:()=>e,onDragPending:i=>this.onDragPending(i,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="expression")o=l(eie,{children:i=>i?l(Gp,{showParentChildrenHover:this.const(!1),controller:this.props.controller,identifier:()=>this.controller.getDraggedIdentifier(),insideMQ:this.const(!1),insideGroup:this.const(!1),putInTabOrder:()=>!1}):l(zb,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>t})},()=>t&&this.controller.shouldRenderDraggedItemAsToken());else return;return o}didUnmount(){re(document.documentElement).off("."+this.guid)}didMountContainer(e){this.node=e,re(document.documentElement).on("keydown."+this.guid,this.bindFn(this.handleKeyDown))}didMountExppanel(e){this.exppanel=e,e.onscroll=()=>this.controller.markTickRequiredNextFrame()}getListBottomAndUpdateLastExpressionPadding(){let e=this.controller.getKeypadHeight(),t=this.__listBottom||0;return this.__listBottom=e,e===0&&t!==0&&nF()&&this.padLastExpressionUntilTapEnd(t),e}padLastExpression(e){let t=this.node.querySelector(".dcg-expressionitem.dcg-new-expression");t.style.marginBottom=e+"px"}unpadLastExpression(){let e=this.node.querySelector(".dcg-expressionitem.dcg-new-expression");e.style.marginBottom="0"}padLastExpressionUntilTapEnd(e){this.padLastExpression(e),re(document).on("dcg-tap.animating-bottom",()=>{this.unpadLastExpression(),re(document).off("dcg-tap.animating-bottom")})}handleKeyDown(e){var a;if(this.controller.inAudioTraceMode())return;let t=Pe(e),o=Jr(e),i=this.controller.getSelectedItem();if(!i){(t==="Backspace"||t==="Del")&&!this.controller.needsFakeKeypad()&&this.controller.hasMultipleItemsSelected()&&this.controller.dispatch({type:"delete-all-selected-items"});return}if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&o==="T"&&i){if(!this.controller.isGeometry()||!xs(i))return;e.preventDefault(),e.stopPropagation(),this.controller.convertToTokenAssignment(i);let s=this.controller.getGeometryFolder();if(s){let d=s.index+this.controller.getNumberOfItemsInFolder(s.id);In(i,s.id),i.index!==d&&Ag(this.controller.getListModel(),i.index,d,1)}this.controller.ensureAtLeastOneVisibleItem();let c=(a=Go(i))==null?void 0:a.identifier;c&&this.controller.getShowConstructionsOpen()&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-token",identifier:c}});return}let n=this.controller.getFocusLocation();if(e.ctrlKey&&e.shiftKey&&!e.metaKey&&!e.altKey&&n!==void 0){if(o==="O"){if(e.preventDefault(),e.stopPropagation(),this.controller.getOpenItemMenu()!==void 0)return;let s;if(i.type==="expression")!i.sliderExists&&!Yv(i)?(s={type:"expression",model:i,guid:i.guid,focusFirstOption:!0,previousFocusLocation:n},this.controller.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:i.id}})):i.sliderExists&&(s={type:"slider",model:i,guid:"slider-"+i.guid,focusFirstOption:!0,previousFocusLocation:n},this.controller.dispatch({type:"set-focus-location",location:{type:"slider-animation-properties-icon",id:i.id}}));else if(i.type==="image")s={type:"image",model:i,guid:i.guid,focusFirstOption:!0,previousFocusLocation:n},this.controller.dispatch({type:"set-focus-location",location:{type:"image-icon",id:i.id}});else if(i.type==="table"&&(n.type==="table"||n.type==="table-icon")){let c;if(n.type==="table"){let d=n.location;if(!d)return;c=i.columnModels[d.column]}else c=lo(i,n.columnId);if(!c||c.latex===""||!this.controller.getGraphSettings().config.graphpaper||c.error||c.index===0)return;s={type:"table-column",model:c,guid:c.guid,focusFirstOption:!0,previousFocusLocation:n},this.controller.dispatch({type:"set-focus-location",location:{type:"table-icon",id:i.id,columnId:c.id}})}if(!s)return;this.controller.dispatch({type:"toggle-item-settings-menu",menu:s});return}else if(o==="D"){if(this.controller.isItemReadonly(i.id)&&!this.controller.isInEditListMode())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"delete-item-and-animate-out",id:i.id,setFocusAfterDelete:!0});return}}if(this.controller.isInEditListMode()&&!e.altKey&&!e.ctrlKey&&!e.metaKey){if(t==="Tab"&&n!==void 0){let s=this.controller.getItemModelByIndex(0);if(!s)return;let c=(n.type==="readonly-expression"&&s.type==="expression"||n.type==="table-container"&&s.type==="table"||n.type===s.type)&&n.id===s.id,d={type:"edit-list-toggle"},p=this.controller.isFocusLocationFocused(d);e.shiftKey&&c?(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-focus-location",location:d})):!e.shiftKey&&p&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"move-focus-to-item",id:s.id,where:s.type==="table"?"container":void 0}))}else(t==="Up"||t==="Down"||t==="PageUp"||t==="PageDown")&&this.controller.dispatch({type:"on-special-key-pressed",key:t==="Up"||t==="PageUp"?"PageUp":"PageDown"});return}if(t==="Esc"&&this.controller.getExpressionSearchOpen()&&this.controller.dispatch({type:"close-expression-search"}),!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(t==="PageUp"||t==="PageDown")){this.controller.dispatch({type:"on-special-key-pressed",key:t}),e.preventDefault();return}if(!(document.activeElement&&re.contains(document.body,document.activeElement))&&!this.exppanel.contains(e.target)&&re.contains(document.documentElement,e.target))switch(t){case"Up":e.preventDefault(),this.controller.dispatch({type:"select-previous-expression"});break;case"Down":e.preventDefault(),this.controller.dispatch({type:"select-next-expression"});break;case"Esc":e.preventDefault(),this.controller.dispatch({type:"set-none-selected"});break;case"Right":e.preventDefault(),i&&(i.type==="expression"&&i.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:i.id,adjustment:"up"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:i.id}})):this.controller.dispatch({type:"move-focus-to-item",id:i.id,where:"start"}));break;case"Tab":e.preventDefault(),i&&this.controller.dispatch({type:"move-focus-to-item",id:i.id,where:"start"});break;case"Left":e.preventDefault(),i&&(i.type==="expression"&&i.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:i.id,adjustment:"down"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:i.id}})):this.controller.dispatch({type:"move-focus-to-item",id:i.id,where:"end"}));break;case"Backspace":e.preventDefault(),i&&!this.controller.isItemReadonly(i.id)&&this.controller.dispatch({type:"upward-delete-selected-expression"});break;case"Del":e.preventDefault(),i&&!this.controller.isItemReadonly(i.id)&&this.controller.dispatch({type:"downward-delete-selected-expression"});break;case"Enter":jr(e,"create-expression-with-keyboard")||(e.preventDefault(),Xt(e,"create-expression-with-keyboard"),i&&this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"}));break;default:if(e.metaKey||e.ctrlKey||t==="Shift"||t==="Space")return;i&&(i.type==="table"||this.controller.dispatch({type:"move-focus-to-item",id:i.id,where:"end"}))}}onDragPending(e,t){if(jr(e,"dcg-expression-drag"))return;e.preventDefault(),Dr();let o={x:e.touches[0].clientX,y:e.touches[0].clientY},i={x:o.x,y:o.y},n=setTimeout(()=>{re(document).off(".dragpending"),this.onDragStart(e,t,o,i)},500);re(document).on("dcg-tapmove.dragpending",a=>{i={x:a.touches[0].clientX,y:a.touches[0].clientY},(Math.abs(i.y-o.y)>3||Math.abs(i.x-o.x)>3)&&(clearTimeout(n),re(document).off(".dragpending"),this.onDragStart(e,t,o,i))}),re(document).on("dcg-tapend.dragpending",()=>{clearTimeout(n),re(document).off(".dragpending")})}onDragStart(e,t,o,i){e.touches.length===1&&(jr(e,"dcg-longhold")||this.controller.dispatch({type:"start-dragdrop",dragTarget:t,grabPt:o,mousePt:i}))}onExppanelTapstart(e){e.device!=="mouse"&&(e.target.closest(".dcg-expressionitem")||Dr())}onCopy(e){GY(e,this.controller,"copy")}onCut(e){GY(e,this.controller,"cut")}onPaste(e){let t=this.controller.getGraphSettings().config;if(Hre(e,this.controller)||Wre(e,this.controller))return;let o=VG(e);if(!o)return;let i=this.controller.getSelectedItem();if(this.controller.canLoadPastedLink(o)&&i&&i.type==="folder"&&i.title===""){e.stopPropagation(),e.preventDefault(),FG(this.controller,o,(a,s)=>s(null,a));return}if(i&&(i.type==="text"||i.type==="folder"))return;if(this.controller.canLoadPastedLink(o)){e.stopPropagation(),e.preventDefault();let a=t.pasteGraphLinkCallback?t.pasteGraphLinkCallback:(s,c)=>c(null,s);FG(this.controller,o,a);return}if(t.pasteTableData){let a=Yre(o);if(a!==void 0)return e.stopPropagation(),e.preventDefault(),this.controller.dispatch({type:"paste-table",data:a})}let n=Ure(o);if(n!==void 0){e.stopPropagation(),e.preventDefault();let a=[];n.length===1&&n[0].numberList?this.controller.dispatch({type:"append-number-list",latex:n[0].content}):(n.forEach(s=>{a.push({type:"expression",id:this.controller.generateId(),latex:s.content})}),this.controller.dispatch({type:"insert-several-expressions",expressions:a}));return}}onDrop(e){if(!this.controller.areImagesEnabled())return;let t=e.dataTransfer&&e.dataTransfer.files;t&&t.length&&this.controller.dispatch({type:"new-images",files:t})}};var $m=__dcg_shared_module_exports__['e'](j());var{If:wke}=$m.Components,Ske=3e3,yV=class extends $m.View{willUpdate(){let e=this.props.controller(),t=e.getAdaptiveDepthPeelingInfo();(t==null?void 0:t.status)===1&&t.peelLayers===Ow&&(this.visible=!0,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.visible=!1,e.dispatch({type:"render"})},Ske))}template(){return l(wke,{predicate:()=>this.visible,children:()=>l("div",{class:$m.const("dcg-adaptive-peeling-warning"),style:()=>({left:`${this.props.controller().computeMajorLayout().grapher.left}px`}),children:l("span",{class:$m.const("dcg-warning-content"),tabIndex:$m.const("0"),children:()=>this.props.controller().s("graphing-calculator-label-adaptive-peel-warning")})})})}};var Zl=__dcg_shared_module_exports__['e'](j());Ut();Ut();var gB=class{constructor(){this.handlers=[],re(document).on("keydown.delegator",e=>this.handleEvent(e))}push(e){let t=__dcg_shared_module_exports__['jb']("delegator_");return this.handlers.push({token:t,handler:e}),()=>this.handlers=__dcg_shared_module_exports__['Ha'](this.handlers,o=>o.token!=t)}handleEvent(e){if(!e.isDefaultPrevented()&&this.handlers.length){let t=!1,o=()=>t=!0;for(let{handler:i}of this.handlers.slice().reverse())if(i(e,o),t)return}}},xV=new gB;var Hh=__dcg_shared_module_exports__['e'](j());var an=__dcg_shared_module_exports__['e'](j());var Oi=__dcg_shared_module_exports__['e'](j());var{If:mB}=Oi.Components,go=class extends Oi.View{constructor(){super(...arguments),this.i18n=this.props.i18n(),this.isMounted=!1,this.isTitleStuck=!1}template(){return l("div",{class:()=>({"dcg-shared-modal-container":!0,[this.props.class?this.props.class():""]:!!this.props.class}),didMount:this.bindFn(this.didMountRoot),children:x("div",{class:()=>({"dcg-shared-modal-cover":!0,"dcg-shared-has-close-button":this.showX(),"dcg-shared-modal-fullscreen":this.props.size()==="fullscreen","dcg-shared-modal-wide":this.props.size()==="wide","dcg-shared-modal-medium":this.props.size()==="medium","dcg-shared-modal-narrow":this.props.size()==="narrow","dcg-shared-modal-tiny":this.props.size()==="tiny"}),children:[l("div",{class:Oi.const("dcg-shared-modal-background"),onTap:this.props.onClose}),l("div",{class:Oi.const("dcg-shared-modal-transition-container"),children:x("dialog",{open:Oi.const(!0),class:Oi.const("dcg-unstyled-dialog dcg-shared-modal"),"aria-modal":Oi.const("true"),"aria-label":()=>{let e="";return this.props.ariaLabel?e=this.props.ariaLabel():this.props.title&&(e=this.props.title()),e},children:[l(mB,{predicate:()=>this.showX(),children:()=>l("div",{class:Oi.const("dcg-shared-close-cross-container"),children:l(Oe,{tooltip:()=>this.i18n.s("shared-button-close-dialog"),children:l("div",{role:Oi.const("button"),tabIndex:Oi.const("0"),"aria-label":()=>this.i18n.s("shared-button-close-dialog"),class:Oi.const("dcg-shared-close-cross action-close-modal"),onTap:this.props.onClose,children:l("i",{class:Oi.const("dcg-icon-remove"),"aria-hidden":Oi.const("true")})})})})}),x("div",{class:Oi.const("dcg-shared-modal-contents-wrapper"),children:[l(mB,{predicate:()=>!!this.props.title&&!!this.props.title(),children:()=>x("h1",{class:()=>{var e,t;return{"dcg-shared-modal-title":!0,"dcg-shared-left-align-title":this.leftAlignTitle(),"dcg-shared-modal-title--sticky":!!((t=(e=this.props).withStickyTitle)!=null&&t.call(e)),"dcg-shared-modal-title--stuck":this.isTitleStuck}},children:[l(mB,{predicate:()=>{var e,t;return!!((t=(e=this.props).withBackButton)!=null&&t.call(e))},children:()=>l("button",{class:Oi.const("dcg-shared-back-button"),"aria-label":()=>this.i18n.s("shared-button-back"),tabIndex:Oi.const(0),onTap:this.props.onBack,children:l("i",{class:Oi.const("dcg-icon-chevron-left dcg-shared-back-button__icon"),"aria-hidden":Oi.const("true")})})}),()=>this.props.title()]})}),l("div",{class:Oi.const("dcg-shared-modal-scrollable-content"),children:this.props.children})]})]})})]})})}showX(){var e,t;return!!((t=(e=this.props).showX)!=null&&t.call(e))}leftAlignTitle(){return!!this.props.leftAlignTitle&&this.props.leftAlignTitle()}didMountRoot(e){var g,h,b,v;if(this.isMounted)return;this.isMounted=!0,document.body.classList.add("dcg-modal-open");let t=e.querySelector(".dcg-shared-modal-contents-wrapper"),o=e.querySelector(".dcg-shared-modal-title");if((h=(g=this.props).withStickyTitle)!=null&&h.call(g)&&t&&o){let T=()=>{this.intersectionObserver&&this.intersectionObserver.disconnect();let E=getComputedStyle(t).getPropertyValue("--dcg-modal-padding").trim();this.intersectionObserver=new IntersectionObserver(([I])=>{this.isTitleStuck=I.intersectionRatio<1,this.update()},{root:t,rootMargin:UE||E===""?void 0:`-${E} 0px 0px 0px`,threshold:[1]}),this.intersectionObserver.observe(o)};T(),this.resizeObserver=new ResizeObserver(T),this.resizeObserver.observe(t)}let i=()=>{var T;(T=e.querySelector(".dcg-shared-close-cross"))==null||T.focus()},n=()=>e.querySelector(".dcg-shared-modal-scrollable-content"),a=()=>{let T=n();T&&(T.tabIndex=T.tabIndex>=0?T.tabIndex:0,T.focus())},s=n(),c=(v=(b=this.props).setFocus)==null?void 0:v.call(b),d=c==="close"&&this.showX(),p=c==="content"||c==="close"&&!this.showX()&&s;d&&i(),p&&a();let u=sJ(e);this.unsub=xV.push((T,E)=>{var _,C,D,P,F,N;Pe(T)==Wi&&((C=(_=this.props).interceptEscape)!=null&&C.call(_)||this.onClose(),E());let I=T.altKey||T.shiftKey||T.metaKey||T.ctrlKey;Pe(T)===np&&!I&&((P=(D=this.props).onArrowKey)==null||P.call(D,"Left")),Pe(T)===ap&&!I&&((N=(F=this.props).onArrowKey)==null||N.call(F,"Right")),u(T)})}onClose(){this.props.onClose&&this.props.onClose()}didUnmount(){var e,t;this.isMounted&&(this.isMounted=!1,(e=this.intersectionObserver)==null||e.disconnect(),(t=this.resizeObserver)==null||t.disconnect(),this.unsub(),document.body.classList.remove("dcg-modal-open"))}};var{If:vV,For:tie}=an.Components,wV=class extends an.View{init(){this.controller=this.props.controller()}template(){return l(vV,{predicate:this.props.visible,children:()=>x(go,{size:this.const("medium"),onClose:this.props.onClose,i18n:this.const(this.controller),class:this.const("dcg-custom-toolbar-settings-modal"),children:[l("button",{class:an.const("dcg-unstyled-button dcg-btn-blue dcg-done-btn"),didMount:e=>e.focus(),onTap:this.props.onClose,children:()=>this.controller.s("graphing-calculator-button-done")}),l("h1",{class:an.const("dcg-shared-left-align-title"),children:()=>this.controller.s("shared-calculator-text-customize-toolbar")}),l(tie,{each:this.bindFn(this.getToolGroups),children:e=>x("div",{role:an.const("grid"),children:[x("div",{class:an.const("dcg-configuration-heading-row dcg-configuration-grid-row"),role:an.const("row"),children:[l("div",{class:an.const("dcg-first-column"),role:an.const("columnheader"),children:()=>L0(e.group)}),l("div",{class:an.const("dcg-second-column"),role:an.const("columnheader"),children:()=>this.controller.s("graphing-calculator-label-geometry-tool-disabled-when")})]}),l(tie,{each:()=>e.dropdown||[e.current],children:t=>x("div",{class:an.const("dcg-configuration-grid-row"),"dcg-geo-tool":this.const(t),role:an.const("row"),children:[l("div",{class:an.const("dcg-first-column"),role:an.const("gridcell"),children:l(ft,{disabled:()=>!this.isToolCustomizable(t),checked:()=>this.getToolInfo(t).visible,onChange:o=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:{...this.getToolInfo(t),visible:o}})},children:()=>this.getToolInfo(t).displayName})}),x("div",{class:()=>({"dcg-disabled":!this.getToolInfo(t).visible||!this.isToolCustomizable(t),"dcg-mathquill-condition-container":!0,"dcg-second-column":!0}),role:an.const("gridcell"),children:[l(vV,{predicate:()=>!!this.getToolLatexError(t)&&this.getToolInfo(t).visible,children:()=>l("div",{class:an.const("dcg-latex-error-container"),children:l(Zo,{error:()=>this.getToolLatexError(t)||""})})}),l(vV,{predicate:()=>this.isToolCustomizable(t)&&this.getToolInfo(t).visible,children:()=>l(un,{latex:()=>this.getToolLatex(t),ariaLabel:()=>this.getToolAria(t),onKeydown:()=>{},...ra(this.controller),noFadeout:this.const(!0),getAriaPostLabel:()=>this.getToolLatexError(t)||"",isFocused:()=>this.focusedLatexTool===t,hasError:()=>!!this.getToolLatexError(t),onUserChangedLatex:o=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:{...this.getToolInfo(t),disabledLatex:o}})},onFocusedChanged:o=>{this.focusedLatexTool===t&&!o?this.focusedLatexTool=void 0:o&&(this.focusedLatexTool=t)},onSelectionChanged:()=>{this.controller.runAfterDispatch(()=>{this.controller.dispatch({type:"render"})})}})}),l(vV,{predicate:()=>!this.getToolInfo(t).visible,children:()=>l("div",{class:an.const("dcg-disabled-condition-wrapper"),children:l(un,{latex:()=>this.getToolLatex(t),ariaLabel:()=>this.getToolAria(t),isStatic:this.const(!0),isFocused:this.const(!1),...ra(this.controller)})})})]})]})})]})},e=>e.group)]})})}getToolAria(e){return this.controller.s("shared-calculator-narration-disable-tool",{tool:this.getToolInfo(e).displayName})}getToolLatex(e){return this.getToolInfo(e).disabledLatex||""}isToolCustomizable(e){return e!=="selection"&&e!=="box-selection"}getToolGroups(){let e={group:"transformation",current:"translate",dropdown:lw};return[...VF(),e]}getToolLatexError(e){let t=this.controller.getGeometryToolbarModel(),o=XH(t,e);if(o)return this.controller.unpack(o)}getToolInfo(e){let t=this.controller.getGeometryToolbarModel();return{tool:e,displayName:this.controller.getGeoModel().getDisplayNameForTool(e),...t.toolbarState[e]}}};var{If:rie}=Hh.Components,SV=class extends Hh.View{init(){this.controller=this.props.controller()}template(){return l(rie,{predicate:()=>this.shouldShowAuthorFeaturesSection(),children:()=>x("div",{class:Hh.const("dcg-options-menu-section dcg-author-mode-section"),children:[x("div",{class:Hh.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("shared-calculator-narration-author-mode"),l(to,{ariaLabel:()=>this.controller.s("shared-calculator-narration-author-mode"),toggled:this.bindFn(this.isAuthorMode),onChange:()=>{this.controller.dispatch({type:"set-author-mode",enabled:!this.isAuthorMode()})}})]}),l(rie,{predicate:()=>this.isAuthorMode(),children:()=>x("div",{class:Hh.const("dcg-author-features-container"),children:[x("div",{class:Hh.const("dcg-toolbar-customization"),children:[l("span",{children:"Geometry Tools:"}),l(ar,{theme:this.const("mini"),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-configure-toolbar"),staticConfig:this.bindFn(this.getConfigurationOptions)})]}),l(ft,{checked:()=>this.controller.getGraphSettings().hideCustomColors,onChange:e=>this.controller.dispatch({type:"set-graph-settings",hideCustomColors:e}),children:()=>this.controller.s("shared-calculator-label-hide-custom-colors")}),l(wV,{controller:this.props.controller,onClose:()=>{this.customGeometryToolsSettingsModal=!1,this.controller.dispatch({type:"render"})},visible:()=>this.customGeometryToolsSettingsModal})]})})]})})}getToolbar(){return this.controller.getGeometryToolbarModel().toolbar}setToolbar(e){e==="custom"&&(this.customGeometryToolsSettingsModal=!0),this.controller.dispatch({type:"set-geometry-toolbar",toolbar:e})}getConfigurationOptions(){return[{key:"all",label:()=>this.controller.s("shared-calculator-button-settings-toolbar-show-all"),selected:()=>this.getToolbar()==="all",onSelect:()=>this.setToolbar("all")},{key:"none",label:()=>this.controller.s("shared-calculator-button-settings-toolbar-show-none"),selected:()=>this.getToolbar()==="none",onSelect:()=>this.setToolbar("none")},{key:"custom",label:()=>this.controller.s("shared-calculator-button-settings-toolbar-show-custom"),selected:()=>this.getToolbar()==="custom",onSelect:()=>this.setToolbar("custom")}]}shouldShowAuthorFeaturesSection(){return this.controller.authorFeaturesAvailable()}isAuthorMode(){return this.controller.shouldShowAuthorFeatures()}};var{If:kV}=Zl.Components,UC=class extends Zl.View{init(){this.controller=this.props.controller()}template(){return l("div",{class:()=>({"dcg-geometry-settings-container":!0,"dcg-popover":!0,"dcg-left":!0,"dcg-constrained-height-popover":!0,"dcg-generic-options-menu":!0,"dcg-no-geometry-header":!this.controller.shouldShowGeoToolbar()}),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer),children:x("div",{class:Zl.const("dcg-popover-interior"),role:Zl.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-geometry-settings"),children:[x("div",{class:Zl.const("dcg-options-menu-section"),children:[l(Bw,{controller:this.props.controller}),l(kV,{predicate:()=>!this.controller.getLockViewportConfigSetting(),children:()=>l(Ty,{controller:this.props.controller})}),l(kV,{predicate:()=>this.controller.getHiddenGeoItemCount()>0,children:()=>l(ft,{onChange:this.bindFn(this.toggleGhostMode),checked:()=>this.controller.getGhostMode(),manageFocus:this.const(ze({controller:this.controller,location:{type:"settings",location:"hidden-objects"}})),children:()=>this.controller.s("graphing-calculator-label-settings-hidden-objects",{count:this.controller.getHiddenGeoItemCount()})})})]}),x("div",{class:Zl.const("dcg-options-menu-section"),children:[x("div",{class:Zl.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-label-settings-grid"),l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-grid"),toggled:this.bindFn(this.getShowGrid),onChange:this.bindFn(this.toggleGrid)})]}),l(kV,{predicate:this.bindFn(this.getShowGrid),children:()=>l(ft,{onChange:this.bindFn(this.toggleMinorGridlines),checked:this.bindFn(this.getMinorGridlines),children:()=>this.controller.s("graphing-calculator-label-settings-minor-gridlines")})})]}),x("div",{class:Zl.const("dcg-options-menu-section"),children:[x("div",{class:Zl.const("dcg-options-menu-section-title"),children:[()=>this.controller.s("graphing-calculator-label-axes"),l(to,{ariaLabel:()=>this.controller.s("graphing-calculator-label-axes"),toggled:this.bindFn(this.getShowAxes),onChange:this.bindFn(this.toggleAxes)})]}),l(kV,{predicate:this.bindFn(this.getShowAxes),children:()=>x("div",{children:[l(ft,{onChange:this.bindFn(this.toggleAxisNumbers),checked:this.bindFn(this.getAxisNumbers),children:()=>this.controller.s("graphing-calculator-label-settings-axis-numbers")}),l("div",{children:l(ft,{onChange:this.bindFn(this.toggleArrows),checked:()=>this.getAxisArrowMode()!==__dcg_shared_module_exports__['Nd'].NONE,children:()=>this.controller.s("graphing-calculator-label-settings-arrows")})})]})})]}),l(Kw,{controller:this.props.controller}),l(SV,{controller:this.props.controller}),l(Vc,{setup:this.const({controller:this.controller,type:"advanced"})}),l("div",{class:Zl.const("dcg-arrow")})]})})}toggleGhostMode(){this.controller.dispatch({type:"set-ghost-mode",value:!this.controller.getGhostMode()})}didMountContainer(e){this.node=e,re(document.documentElement).on("dcg-tapstart.geometry-settings-view wheel.geometry-settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),this.unsub=xV.push(t=>{let o=Pe(t);if(o==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&o==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let i=this.controller.getFocusLocation();if(!i||i.type!=="settings")return;t.shiftKey?t.shiftKey&&(i.location==="default-size"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):i.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"degree-mode"}}),t.preventDefault(),t.stopPropagation())):i.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"default-size"}}),t.preventDefault(),t.stopPropagation()):i.location==="degree-mode"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){re(document.documentElement).off(".geometry-settings-view"),this.unsub()}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&this.node.contains(document.activeElement)&&bl(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=e.target,o=this.node.contains(t),i=!!t.closest(".dcg-action-settings"),n=this.isMathquillFocused()&&!!t.closest(".dcg-keypad"),a=!!t.closest(".dcg-action-undo")||!!t.closest(".dcg-action-redo");return!(o||i||n||a)}isMathquillFocused(){return this.getFocusedLimit()!==void 0}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getShowXAxis(){return!!this.controller.getGraphSettings().showXAxis}toggleAxes(){this.controller.dispatch({type:"set-graph-settings",showXAxis:!this.getShowXAxis(),showYAxis:!this.getShowXAxis()})}getShowAxes(){return!!this.controller.getGraphSettings().showXAxis}getAxisNumbers(){return!!this.controller.getGraphSettings().xAxisNumbers}toggleAxisNumbers(){let e=this.getAxisNumbers();this.controller.dispatch({type:"set-graph-settings",xAxisNumbers:!e,yAxisNumbers:!e,polarNumbers:!e})}getMinorGridlines(){return this.controller.getGraphSettings().xAxisMinorSubdivisions===0}toggleMinorGridlines(){let e=this.getMinorGridlines()?1:0;this.controller.dispatch({type:"set-graph-settings",yAxisMinorSubdivisions:e,xAxisMinorSubdivisions:e})}getAxisArrowMode(){return this.controller.getGraphSettings().xAxisArrowMode}getShowGrid(){return this.controller.getGraphSettings().showGrid}toggleGrid(){this.controller.dispatch({type:"set-graph-settings",showGrid:!this.getShowGrid()})}toggleArrows(){let e=this.getAxisArrowMode()===__dcg_shared_module_exports__['Nd'].NONE?__dcg_shared_module_exports__['Nd'].BOTH:__dcg_shared_module_exports__['Nd'].NONE;this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}};var Qw=__dcg_shared_module_exports__['e'](j()),{Switch:kke}=Qw.Components,TV=class extends Qw.View{constructor(){super(...arguments),this.frames=0,this.prevTime=0}init(){var t;this.current=0,this.panels={},this.panels.fps=new BC({name:"fps",yMax:120,fg:"#0ff",bg:"#002"}),this.panels.evaluator=new BC({name:"eval",yMax:250,fg:"#f80",bg:"#210"}),this.panels.mem=new BC({name:"MB",yMax:this.getMemory().jsHeapSizeLimit/2**20,fg:"#f08",bg:"#201"}),this.list=Object.keys(this.panels),this.props.controller().onEvaluatorChangesSpy=(o,i)=>{var n;this.props.controller().isThreeDMode()||this.frame(),this.panels.evaluator.update((n=i.timeInWorker)!=null?n:NaN)};let e=(t=this.props.controller().getGrapher3d())==null?void 0:t.webglLayer;e&&(e.debugOnlyMeasureGPUTiming=!0,e.onRenderSpy=()=>{this.frame()})}willUnmount(){this.props.controller().onEvaluatorChangesSpy=void 0}template(){return l("div",{class:Qw.const("dcg-performance-meter"),onTap:()=>{this.current=(this.current+1)%this.list.length,this.update()},children:l(kke,{children:e=>l("div",{didMount:t=>{t.appendChild(this.panels[e].dom)}})},()=>this.list[this.current])})}frame(){this.frames++;let e=(performance||Date).now();return e>=this.prevTime+1e3&&(this.panels.fps.update(this.frames*1e3/(e-this.prevTime)),this.prevTime=e,this.frames=0,this.panels.mem.update(this.getMemory().usedJSHeapSize/2**20)),e}getMemory(){if(self.performance&&"memory"in self.performance){let e=self.performance.memory;return{usedJSHeapSize:e.usedJSHeapSize,totalJSHeapSize:e.totalJSHeapSize,jsHeapSizeLimit:e.jsHeapSizeLimit}}else return{usedJSHeapSize:NaN,totalJSHeapSize:NaN,jsHeapSizeLimit:NaN}}},xl=Math.round(window.devicePixelRatio||1),fB=80*xl,oie=48*xl,iie=3*xl,nie=2*xl,_V=3*xl,YC=15*xl,bB=74*xl,CV=30*xl,BC=class{constructor(e){this.values=[],this.minValue=1/0,this.maxValue=0,this.dom=document.createElement("canvas"),this.name=e.name,this.yMax=e.yMax,this.fg=e.fg,this.bg=e.bg,this.dom.width=fB,this.dom.height=oie,this.dom.style.cssText="width:80px;height:48px";let t=this.dom.getContext("2d");if(!t)throw new Error("Could not get context");this.context=t,t.font="bold "+9*xl+"px Helvetica,Arial,sans-serif",t.textBaseline="top",t.fillStyle=this.bg,t.fillRect(0,0,fB,oie),t.fillStyle=this.fg,t.fillText(this.name,iie,nie),t.fillRect(_V,YC,bB,CV),t.fillStyle=this.bg,t.globalAlpha=.9,t.fillRect(_V,YC,bB,CV)}update(e){this.values.push(e),this.values.length>bB/xl&&this.values.shift(),this.minValue=Math.min(this.minValue,e),this.maxValue=Math.max(this.maxValue,e),this.draw()}draw(){this.context.fillStyle=this.bg,this.context.globalAlpha=1,this.context.fillRect(0,0,fB,YC),this.context.fillStyle=this.fg,this.context.fillText(Math.round(this.values[this.values.length-1])+" "+this.name+" ("+Math.round(this.minValue)+"-"+Math.round(this.maxValue)+")",iie,nie),this.context.fillStyle=this.fg,this.context.fillRect(_V+xl,YC,this.values.length*xl,CV),this.context.fillStyle=this.bg,this.context.globalAlpha=.9;for(let e=0;e<this.values.length;e++){let t=this.values[e];this.context.fillRect(_V+(e+1)*xl,YC,xl,Math.round((1-t/this.yMax)*CV))}}};var{If:Jm}=Un.Components,KC=class extends Un.View{init(){this.controller=this.props.controller()}settings(){return this.controller.getGraphSettings()}template(){return l("div",{class:this.const(Tx),style:Un.const("width: 100%; height: 100%; position: relative;"),children:x("div",{class:()=>({"dcg-container":!0,"dcg-fullscreen":!this.controller.isListVisible(),"dcg-narrow":this.controller.isNarrow(),"dcg-projector-mode":this.settings().config.projectorMode,"dcg-inverted-colors":!!this.settings().config.invertedColors,"dcg-inverted-swatches":this.controller.invertSwatches(),"dcg-EDIT-LIST-MODE":this.controller.isInEditListMode(),"dcg-no-graphpaper":!this.settings().config.graphpaper,"dcg-no-branding":!this.settings().config.branding,"dcg-no-expression-topbar":!this.settings().config.expressionsTopbar,"dcg-default-border":!!this.settings().config.border,"dcg-no-hyperlinks":!this.settings().config.links,"dcg-has-background-color":this.controller.hasBackgroundColor()}),style:()=>({"font-size":this.settings().config.fontSize+"px",background:this.controller.hasTransparentBackground()?"none":void 0,"--dcg-custom-background-color":this.controller.hasBackgroundColor()?this.controller.getBackgroundColor():void 0,"--dcg-custom-background-color-shaded":this.controller.hasBackgroundColor()?this.controller.getPillboxBackgroundColor():void 0,"--dcg-custom-text-color":this.controller.hasTextColor()?this.controller.getTextColor():void 0}),role:Un.const("application"),"aria-label":()=>this.controller.isGeometry()?this.controller.s("graphing-calculator-narration-main-desmos-geometry"):this.controller.s("graphing-calculator-narration-main-desmos-graphing-calculator"),"x-ms-format-detection":Un.const("none"),didMount:this.bindFn(this.didMountRoot),children:[l(Jm,{predicate:()=>this.controller.getGraphSettings().config.expressions,children:()=>l(NC,{controller:this.props.controller})}),l(Jm,{predicate:()=>this.controller.isListEnabled()&&!this.controller.isListVisible()&&(!this.controller.isGeometry()||this.controller.isNarrow()),children:()=>l("div",{class:()=>({"dcg-overgraph-icon-container":!0,"dcg-bottom-right":this.controller.isNarrow()}),children:l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),gravity:()=>this.controller.isNarrow()?"n":"s",children:l("div",{class:()=>({"dcg-show-expressions-tab":!0,"dcg-overgraph-icon":!0,"dcg-rotated":this.controller.isNarrow()}),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),role:Un.const("button"),tabIndex:Un.const("0"),onTap:e=>{this.controller.dispatch({type:"show-expressions-list",focusHideIcon:e.device==="keyboard"})},manageFocus:this.const(ze({controller:this.controller,location:{type:"show-expression-list-btn"}})),children:l("i",{class:Un.const("dcg-icon-show"),"aria-hidden":Un.const("true")})})})})}),l(Jm,{predicate:this.bindFn(this.showHamburger),children:()=>l("div",{class:Un.const("dcg-overgraph-icon-container"),children:l(Oe,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),gravity:this.const("s"),children:l("div",{role:Un.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),class:Un.const("dcg-action-opendrawer dcg-in-api-action-opendrawer dcg-overgraph-icon"),onTap:()=>this.controller.dispatch({type:"open-drawer"}),children:l("i",{class:Un.const("dcg-icon-hamburger"),"aria-hidden":Un.const("true")})})})})}),l(GG,{controller:this.props.controller}),l(yV,{controller:this.props.controller}),l(Jm,{predicate:()=>this.controller.isGeoUIActive()&&this.controller.getGraphSettings().config.settingsMenu&&this.controller.isGraphSettingsOpen(),children:()=>l(UC,{controller:this.props.controller})}),l(Jm,{predicate:()=>this.controller.shouldShowGeoToolbar(),children:()=>l(kG,{controller:this.props.controller})}),l(zw,{controller:this.props.controller,toastData:()=>this.controller.toastData,onClose:()=>this.controller.dispatch({type:"toast/close"}),onUndo:()=>this.controller.dispatch({type:"toast/undo"}),onLearnMore:()=>this.controller.dispatch({type:"toast/learn-more"})}),l("div",{class:Un.const("dcg-grapher dcg-grapher-2d"),style:()=>({visibility:this.controller.isThreeDMode()?"hidden":"visible","pointer-events":this.controller.isThreeDMode()?"none":"auto"})}),l(Jm,{predicate:()=>this.controller.is3dProduct(),children:()=>l("div",{class:Un.const("dcg-grapher dcg-grapher-3d"),style:()=>({visibility:this.controller.isThreeDMode()?"visible":"hidden","pointer-events":this.controller.isThreeDMode()?"auto":"none"})})}),l(Jm,{predicate:()=>this.settings().config.showPerformanceMeter&&!!this.props.controller().getGrapher(),children:()=>l(TV,{controller:this.props.controller})}),l(Jm,{predicate:()=>this.controller.getGraphSettings().config.keypad,children:()=>l(vG,{controller:this.props.controller})})]})})}showHamburger(){return!this.controller.getGraphSettings().config.showHamburger||this.controller.isGeometry()?!1:this.controller.isNarrow()}didMountRoot(e){jf(e),this.controller.getGraphSettings().config.disableScrollFix||wG(e),this.setupFileDragDrop(e)}setupFileDragDrop(e){N_(e);let t=new Set,o=this;function i(){t=new Set,re(e).off(".filedraggedover"),o.controller.dispatch({type:"file-is-not-dragged-over"})}re(e).on("dragenter",n=>{this.controller.areImagesEnabled()&&(n.target.closest(".dcg-notice")||(t.size===0&&re(e).on("dcg-tapstart.filedraggedover",i),t=t.add(n.target),this.controller.dispatch({type:"file-is-dragged-over"})))}).on("dragleave",n=>{t.delete(n.target),t.size===0&&i()}).on("drop",i)}};Ut();function aie(r){let e={},t=new __dcg_shared_module_exports__['Re'](o);function o(i,n){r({type:i,payload:n})}return e.postMessage=function(i){setTimeout(()=>{t.processChangeSet(i)},0)},e}var sie=cz("workerThrottle"),yB=0;function lie(r){return sie?function(e){var o,i;let t=((i=(o=e.data)==null?void 0:o.originalMessage)==null?void 0:i.type)==="evaluatorProgressUpdate"?0:sie;yB=Math.max(Date.now(),yB)+t,setTimeout(r,yB-Date.now(),e)}:r}var eS=class{constructor(e=1/0){this.workers=[],this.maxWorkers=e}allowedToSpawnWorker(){return!!__dcg_worker_source_exports__['createWorker']&&this.workers.length<this.maxWorkers}killWorker(e){__dcg_shared_module_exports__['Xa'](this.workers,e)!==-1&&(e.terminate(),this.workers=__dcg_shared_module_exports__['Ta'](this.workers,e),__dcg_shared_module_exports__['Oa'](__dcg_shared_module_exports__['ab'](e.__connections)).forEach(o=>{o&&o.onWorkerKilled&&o.onWorkerKilled()}))}spawnWorker(){if(!__dcg_worker_source_exports__['createWorker'])return null;try{let e=__dcg_worker_source_exports__['createWorker']();return e.__connections={},e.__isFake=!1,e.onerror=function(t){__dcg_shared_module_exports__['Be'].log(t)},e.addEventListener("message",lie(t=>{let o=t.data;if(!(o&&o.log)&&o&&o.connectionId){let i=e.__connections[o.connectionId];i&&i.onResponse(o.originalMessage)}})),this.workers.push(e),e}catch(e){return null}}spawnFakeWorker(){let e=aie(lie(t=>{let o=__dcg_shared_module_exports__['ab'](e.__connections)[0];o&&o.onResponse(t)}));return e.__isFake=!0,e.__connections={},e}findLeastUsedWorker(){let e=function(o){return __dcg_shared_module_exports__['Ra'](o.__connections)};return __dcg_shared_module_exports__['Pa'](this.workers,e)[0]}allocateWorker(){let e=null;return this.allowedToSpawnWorker()&&(e=this.spawnWorker()),e||(e=this.findLeastUsedWorker()),e||(e=this.spawnFakeWorker()),e}};var IV=class{constructor(e){this.workerPool=e,this.guid=__dcg_shared_module_exports__['jb']("worker-pool-connection"),this.worker=e.allocateWorker(),this.worker.__connections[this.guid]=this}destroy(){this.sendMessage({type:"destroy"}),delete this.worker.__connections[this.guid]}killWorker(){this.worker.__isFake||this.workerPool.killWorker(this.worker)}onWorkerKilled(){}onResponse(e){}sendMessage(e){this.worker.__isFake?this.worker.postMessage(e):this.worker.postMessage({connectionId:this.guid,originalMessage:e})}};var MV=class{constructor(e){this.onChangeSetChanged=e;this.changeSet=null;this.cumulativeChangeSet={};this.changed=!1}hasPendingChanges(){return!!this.changeSet}pendingChangesAreCompleteState(){return!!this.changeSet&&this.changeSet.isCompleteState}pendingChangesSyncId(){var e;return(e=this.changeSet)==null?void 0:e.syncId}popChangeSet(){let e=this.changeSet;return this.changeSet=null,this.changed=!1,e}applyToChangeSets(e){this.changed=!0,this.changeSet||(this.changeSet={}),this.cumulativeChangeSet||(this.cumulativeChangeSet={}),e(this.changeSet),e(this.cumulativeChangeSet),this.onChangeSetChanged()}_clearStatementsAndStartCompleteState(){this.applyToChangeSets(e=>{e.isCompleteState=!0,delete e.statements})}markDroppedJob(){this.changeSet=__dcg_shared_module_exports__['f'](this.cumulativeChangeSet),this.changed=!0}markWorkerKilledWhileIdle(){this.changeSet=__dcg_shared_module_exports__['f'](this.cumulativeChangeSet),this.changed=!1}markSyncId(e){this.applyToChangeSets(t=>{t.syncId=e})}markUndoRedoState(){this.applyToChangeSets(e=>{e.isUndoRedoState=!0})}addStatement(e){this.applyToChangeSets(t=>{t.statements||(t.statements={}),t.statements[e.id]=__dcg_shared_module_exports__['f'](e)})}removeStatement(e){this.applyToChangeSets(t=>{t.statements||(t.statements={}),t.removes||(t.removes={}),delete t.statements[e],t.removes[e]=!0})}addActionStepEvent(e){this.applyToChangeSets(t=>{t.events||(t.events=[]),t.events.push({type:"step",expressionId:e})})}addClockTickEvent(e,t){this.applyToChangeSets(o=>{o.events||(o.events=[]),o.events.push({type:"clock-tick",id:e,isFirstTick:t})})}addClickEvent(e,t){this.applyToChangeSets(o=>{o.events||(o.events=[]),t===void 0&&(t=0),o.events.push({type:"click",expressionId:e,indexVar:t})})}_applyIfChanged(e,t){let o=this.cumulativeChangeSet&&this.cumulativeChangeSet[t],i=e[t];__dcg_shared_module_exports__['db'](o,i)||this.applyToChangeSets(n=>{n[t]=i})}};var _ke=4e3,Cke=250,Tke=500,Zm=class extends MV{constructor(t){super(()=>this.processChangeSet());this.droppedMessage=!1;this.__hasBufferedProgressUpdates=!1;this.evaluationProgressById=new Map;this.lastProgressUpdateTime=-1;this.requestedIntentionalRestart=!1;this.debouncedRestart=__dcg_shared_module_exports__['_a'](()=>{this.requestedIntentionalRestart=!0,this.restartWorker()},Cke);this.__ticksEnabled=!0;this.listeners={evaluatorProgressUpdate(t){this.lastProgressUpdateTime=Date.now(),t.ids.forEach(o=>this.evaluationProgressById.set(o,t.update)),this.__hasBufferedProgressUpdates=!0},processChangeSet(t){this.clearProgressUpdates();let o={},i={};for(let c in t.graphChanges){let d=t.graphChanges[c];d===void 0?i[c]=!0:(__dcg_shared_module_exports__['Bc'](d),o[c]=d)}let n={};for(let c in t.intersectionChanges)i[c]||(n[c]=t.intersectionChanges[c]);let a=this.hasPendingChanges();this.reportEvaluatorResults({evaluationStates:t.statusChanges,graphData:{addedGraphs:o,removedGraphs:i,intersections:n},renderSlowly:!!t.isCompleteState,timingData:t.timingData,eventUpdates:t.eventUpdates,dependencyOrder:t.dependencyOrder});let s=t.syncId;for(;this.syncRequests.length&&s!==void 0&&this.syncRequests[0].id<=s;)this.syncRequests.shift().callback();this.markJobFinished(),a&&this._processChangeSet()}};this.syncId=1,this.syncRequests=[],this.workerPool=t!=null?t:new eS,this.createWorkerPoolConnection()}privateGetWorkerPool(){return this.workerPool}privateGetWorkerPoolConnection(){return this.workerPoolConnection}reportEvaluatorResults(t){this.onEvaluatorResults&&this.onEvaluatorResults(t)}createWorkerPoolConnection(){this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){}),this.workerPoolConnection=new IV(this.workerPool),this.markJobFinished(),this.workerPoolConnection.onResponse=t=>{this.shouldIgnoreWorkerMessage(t)?t.type==="processChangeSet"&&(this.markJobFinished(),this._processChangeSet()):this.listeners[t.type].call(this,t.payload)},this.workerPoolConnection.onWorkerKilled=()=>{this.cancelRestartWorker();let t=this.hasJobInWorker();this.createWorkerPoolConnection(),t?(this.markDroppedJob(),this.droppedMessage=!this.requestedIntentionalRestart):this.markWorkerKilledWhileIdle(),this.clearProgressUpdates(),this.processChangeSet(),this.requestedIntentionalRestart=!1}}destroy(){this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){},this.workerPoolConnection.destroy())}restartWorker(){this.workerPoolConnection.killWorker()}requestRestartWorker(){this.debouncedRestart()}cancelRestartWorker(){this.debouncedRestart.cancel()}shouldIgnoreWorkerMessage(t){return this.__suspendUntilSyncId?!t||!t.payload?!0:!(t.payload.syncId>=this.__suspendUntilSyncId):!1}suspend(){this.clearProgressUpdates(),this.pendingChangesSyncId()===void 0&&(this.syncId++,this.markSyncId(this.syncId)),this.__suspendUntilSyncId=this.pendingChangesSyncId()}markJobFinished(){this.droppedMessage=!1,this.__jobStartTime=-1,this.__suspendUntilSyncId=void 0}startJobTimer(){this.__jobStartTime=Date.now()}hasJobInWorker(){return this.__jobStartTime!==-1}getJobElapsedTime(){return this.hasJobInWorker()?Date.now()-this.__jobStartTime:NaN}setTicksEnabled(t){this.__ticksEnabled=t}tick(){var t;this.__ticksEnabled&&(this.__hasBufferedProgressUpdates&&((t=this.onEvaluatorProgressUpdate)==null||t.call(this)),this.__hasBufferedProgressUpdates=!1,this._processChangeSet())}processChangeSet(){this.__processChangeSetRequested=!0}_processChangeSet(){var o;if(this._syncEvaluatorConfig(),!this.__processChangeSetRequested)return;let t=this.getJobElapsedTime()>=_ke;if(this.droppedMessage&&t){this.restartWorker();return}this.changed&&this.hasPendingChanges()&&(this.pendingChangesSyncId()===void 0&&(this.syncId++,this.markSyncId(this.syncId)),this.hasJobInWorker()?this.pendingChangesAreCompleteState()&&t&&this.restartWorker():(this.startJobTimer(),this.workerPoolConnection.sendMessage(this.popChangeSet()),this.__processChangeSetRequested=!1,(o=this.clearSlowEvaluatorTracking)==null||o.call(this)))}notifyWhenSynced(t){if(this._syncEvaluatorConfig(),!this.hasJobInWorker()&&!this.hasPendingChanges()){setTimeout(t,0);return}this.syncId++,this.syncRequests.push({id:this.syncId,callback:t}),this.markSyncId(this.syncId)}clearStatementsAndStartCompleteState(){this.hasJobInWorker()&&this.suspend(),this._clearStatementsAndStartCompleteState()}_syncEvaluatorConfig(){if(!this.readEvaluatorConfig)return;let t=this.readEvaluatorConfig();for(let o in t)this._applyIfChanged(t,o)}clearProgressUpdates(){this.evaluationProgressById=new Map,this.__hasBufferedProgressUpdates=!1}isCurrentlySlow(){return this.lastProgressUpdateTime>-1&&Date.now()-this.lastProgressUpdateTime>=Tke}};Ut();var zC=class{constructor(e){this.previousPaneFocusLocations={main:void 0,quest:void 0};this.controller=e}markKeyDownAsHandled(e){e.stopPropagation(),e.preventDefault()}exitBraille(){this.controller.dispatch({type:"set-braille-mode",mode:"none"}),_e(this.controller.s("shared-calculator-narration-hotkey-braille-mode-off"))}handleKeydown(e){var n,a,s,c,d;let t=Pe(e),o=Jr(e),i=!this.controller.isUndoRedoDisabledForNotebook();if(Hf(e)&&i)this.markKeyDownAsHandled(e),this.controller.hasVisibleAndUndoableToast()?this.controller.dispatch({type:"toast/undo"}):this.controller.dispatch({type:"undo"});else if(Wf(e)&&i)this.markKeyDownAsHandled(e),this.controller.dispatch({type:"redo"});else if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&o==="Z"){let p=this.controller.getSelectedItem();p&&p.id&&this.controller.showExpressionZoomFitButton(p)&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"expression-zoom-fit",id:p.id,focusAfterTap:!1}))}else if(e.altKey!==qr&&e.metaKey===qr&&!e.ctrlKey&&e.shiftKey&&o==="A"&&this.controller.isDecimalToFractionEnabled()){let p=this.controller.getSelectedItem();p&&p.type==="expression"&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"toggle-fraction-evaluation",id:p.id}),this.controller.runAfterDispatch(()=>{Gg(p)?_e(this.controller.s("shared-calculator-narration-show-as-fraction")):_e(this.controller.s("shared-calculator-narration-show-as-decimal"))}))}else if(!e.altKey&&e.ctrlKey!==qr&&e.metaKey===qr&&o==="F"){if(this.controller.isExpressionListFocused()){let p=Qe.getFocusedMathquill(),u="";try{u=p.__controller.cursor.selection.join("latex")||""}catch(g){}this.controller.dispatch({type:"open-expression-search",rename:!!e.shiftKey,latex:u}),this.markKeyDownAsHandled(e)}}else if((e.altKey||e.metaKey)&&!e.ctrlKey&&!e.shiftKey&&o===void 0){if(t==="Up"||t==="Down"){let p=t==="Up",u=this.controller.getSelectedItem();if(!u)return;let g=u.type==="folder"?u.id:u.folderId;g&&g!==__dcg_shared_module_exports__['Zd']&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-folder-collapsed",id:g,isCollapsed:p}),_e(p?this.controller.s("graphing-calculator-narration-folder-collapsed"):this.controller.s("graphing-calculator-narration-folder-expanded")),this.controller.dispatch({type:"set-focus-location",location:{type:"folder",id:g}}))}}else if(e.shiftKey&&(e.altKey||e.metaKey)&&!e.ctrlKey){if(t==="Up")this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-all-folders-collapsed",isCollapsed:!0}),_e(this.controller.s("graphing-calculator-narration-all-folders-collapsed"));else if(t==="Down")this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-all-folders-collapsed",isCollapsed:!1}),_e(this.controller.s("graphing-calculator-narration-all-folders-expanded"));else if(o==="H"){let p=this.controller.getSelectedItem();p&&"hidden"in p&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"toggle-item-hidden",id:p.id}),this.controller.runAfterDispatch(()=>{p.hidden?_e(this.controller.s("graphing-calculator-narration-item-hidden")):_e(this.controller.s("graphing-calculator-narration-item-visible"))}))}else if(o==="O"){if(!this.controller.authorFeaturesAvailable())return;this.controller.dispatch({type:"set-author-mode",enabled:!this.controller.shouldShowAuthorFeatures()}),_e(this.controller.shouldShowAuthorFeatures()?this.controller.s("shared-calculator-narration-author-mode-on"):this.controller.s("shared-calculator-narration-author-mode-off")),this.markKeyDownAsHandled(e)}else if(o==="E"){if(!this.controller.isListEnabled())return;this.controller.isListVisible()?(this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:!1}),_e(this.controller.s("graphing-calculator-narration-hide-expression-list"))):(this.controller.dispatch({type:"show-expressions-list",focusHideIcon:!1}),this.focusExpressionList()),this.markKeyDownAsHandled(e)}}else if(e.ctrlKey&&(e.altKey||e.metaKey)&&!e.shiftKey){if(o==="E"){if(!this.controller.isListEnabled())return;this.markKeyDownAsHandled(e),this.focusExpressionList()}else if(o==="X"){if(!this.controller.isListEnabled())return;this.markKeyDownAsHandled(e),this.controller.canUserAddExpressions()?(_e(this.controller.s("graphing-calculator-narration-add-expression")),this.controller.dispatch({type:"new-expression"})):_e(this.controller.s("graphing-calculator-narration-unable-to-add-expression"))}else if(o==="O"){if(!this.controller.isListEnabled())return;this.markKeyDownAsHandled(e),this.controller.canUserAddExpressions()&&this.controller.areNotesEnabled()?(_e(this.controller.s("graphing-calculator-narration-add-note")),this.controller.dispatch({type:"new-note"})):_e(this.controller.s("graphing-calculator-narration-unable-to-add-note"))}else if(o==="F"&&this.controller.canUserAddExpressions()&&this.controller.areFoldersEnabled())this.markKeyDownAsHandled(e),_e(this.controller.s("graphing-calculator-narration-add-folder")),this.controller.dispatch({type:"new-folder"});else if(o==="I"&&this.controller.canUserAddExpressions()&&this.controller.areImagesEnabled())this.markKeyDownAsHandled(e),this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:!1}),this.controller.runAfterDispatch(()=>{let p=this.controller.findEl(".dcg-add-expression-container input[type=file]");p&&(re(p).trigger("click"),_e(this.controller.s("graphing-calculator-narration-add-image")))});else if(o==="T")this.markKeyDownAsHandled(e),this.controller.canUserAddExpressions()?(_e(this.controller.s("graphing-calculator-narration-add-table")),this.controller.dispatch({type:"new-table"})):_e(this.controller.s("graphing-calculator-narration-unable-to-add-table"));else if(o==="R"){let p=this.controller.getSelectedItem();if(!this.controller.isListEnabled())return;this.markKeyDownAsHandled(e),this.controller.canUserAddExpressions()&&p&&this.controller.shouldShowRegressionButton(p)?(_e(this.controller.s("graphing-calculator-button-add-table-regression")),this.controller.dispatch({type:"create-table-regression",tableId:p.id,regressionType:"linear"})):_e(this.controller.s("graphing-calculator-narration-unable-to-add-table-regression"))}else if(o==="M"&&this.controller.isGeoUIActive())if(this.markKeyDownAsHandled(e),this.controller.getGeoToolbarGroupKeys().length>0){let p=this.controller.getActiveTool();this.controller.shouldShowMultiSelectHeader()?this.controller.dispatch({type:"set-focus-location",location:{type:"geo-header-back-link"}}):(p==="expression-edit"&&(p="selection"),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:p}}))}else _e(this.controller.s("graphing-calculator-narration-no-geometry-tools-available"));else if(o==="C"&&this.controller.isGeoUIActive())this.markKeyDownAsHandled(e),this.controller.getGeometryTokenCount()>0?this.controller.dispatch({type:"set-show-constructions-open",open:!0,setFocus:!0}):_e(this.controller.raw("Object navigator has no items."));else if(o==="G")this.markKeyDownAsHandled(e),this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:!0});else if(o==="P"){if(this.markKeyDownAsHandled(e),this.controller.isGeometry()){let p=this.controller.getFocusLocation(),u=this.controller.getValidCursorContext();if(p&&p.type==="expression"&&u&&u.type!=="empty"){this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:p.id,isFakeGraphFocus:!0}}),(a=(n=this.controller.getGrapher2d())==null?void 0:n.poiController)==null||a.keyboardAttentionManager.handleGrapherGainedFocus();return}}this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}})}else if(o==="D"&&this.controller.canUserAddExpressions()){this.markKeyDownAsHandled(e);let p=!this.controller.isInEditListMode();this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:p,focusExpressionList:!0})}}else if(WR(e)&&this.controller.getQuestIsActive()){((s=this.controller.focusLocation)==null?void 0:s.type)==="quest"?(this.previousPaneFocusLocations.quest=this.controller.focusLocation,this.previousPaneFocusLocations.main?this.controller.dispatch({type:"set-focus-location",location:this.previousPaneFocusLocations.main}):this.focusExpressionList()):(this.previousPaneFocusLocations.main=this.controller.focusLocation,this.controller.dispatch({type:"set-focus-location",location:(c=this.previousPaneFocusLocations.quest)!=null?c:{type:"quest",location:"quest-pane"}})),this.markKeyDownAsHandled(e);return}else if(!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey){if(t==="Backspace")(!document.activeElement||!Hu(document.activeElement))&&e.preventDefault();else if(t==="Esc"&&!this.controller.getOpenItemMenu()&&!this.controller.isGraphSettingsOpen()){if(this.controller.isGeoUIActive()){let p=!1,u=this.controller.getGeoModel();if(this.controller.hasAnyItemsSelected()&&(this.controller.dispatch({type:"set-none-selected"}),p=!0),u.isToolplayActive()&&(this.controller.dispatch({type:"cancel-geo-toolplay"}),_e(this.controller.s("graphing-calculator-narration-geometry-tool-cancelled")),p=!0),this.controller.isGraphPaperFocused()&&(this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:this.controller.getActiveTool()}}),p=!0),this.controller.getActiveTool()!=="selection"&&!p){this.controller.dispatch({type:"select-geo-tool",tool:"selection"});let g=this.controller.getFocusLocation();g&&g.type==="geo-basic-tool"&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:this.controller.getActiveTool()}}),p=!0}if(p){this.markKeyDownAsHandled(e);return}}this.controller.isInEditListMode()&&!this.controller.findEl(".dcg-options-menu")&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!0}))}}else if(!e.metaKey&&!e.shiftKey&&e.ctrlKey===qr&&e.altKey===!qr){if(o==="N"){if(!this.controller.getBrailleControls())return;if(this.markKeyDownAsHandled(e),this.controller.getBrailleMode()==="nemeth"){this.exitBraille();return}this.controller.dispatch({type:"set-braille-mode",mode:"nemeth"}),_e(this.controller.s("shared-calculator-narration-hotkey-braille-mode-nemeth"))}else if(o==="U"){if(!this.controller.getBrailleControls())return;if(this.markKeyDownAsHandled(e),this.controller.getBrailleMode()==="ueb"){this.exitBraille();return}this.controller.dispatch({type:"set-braille-mode",mode:"ueb"}),_e(this.controller.s("shared-calculator-narration-hotkey-braille-mode-ueb"))}else if(o==="Q"||o==="X"){if(!this.controller.getBrailleControls())return;this.markKeyDownAsHandled(e),this.exitBraille()}else if(o==="6"){if(!this.controller.getBrailleControls())return;this.markKeyDownAsHandled(e);let p=!this.controller.getSixKeyInput();this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:p}),_e(p?this.controller.s("shared-calculator-narration-six-key-mode-on"):this.controller.s("shared-calculator-narration-six-key-mode-off"))}else if(o==="D"){if(this.controller.isComplexModeEnabled()){_e(this.controller.s("shared-calculator-text-complex-radian-mode"));return}this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-graph-settings",degreeMode:!this.controller.getGraphSettings().degreeMode}),_e(this.controller.getGraphSettings().degreeMode?this.controller.s("graphing-calculator-button-settings-degrees"):this.controller.s("graphing-calculator-button-settings-radians"))}else if(o==="K"){if(!this.controller.isKeypadEnabled()||this.controller.inAudioTraceMode())return;this.markKeyDownAsHandled(e),this.controller.dispatch({type:"keypad/set-minimized",minimized:this.controller.isHideKeypadButtonVisible()})}else o==="M"&&((d=this.controller.toneController)==null||d.handleMuteKeyShortcut(),this.markKeyDownAsHandled(e));if((o==="+"||o==="=")&&this.controller.shouldShowZoomInOutButtons()){this.zoom("in"),this.markKeyDownAsHandled(e);return}else if(o==="-"&&this.controller.shouldShowZoomInOutButtons()){this.zoom("out"),this.markKeyDownAsHandled(e);return}else if(o==="0"&&!e.shiftKey&&this.controller.shouldShowZoomHomeButton()){this.setDefaultViewport(),this.markKeyDownAsHandled(e);return}}}focusExpressionList(){let e=this.controller.getSelectedItem();e?this.controller.dispatch({type:"move-focus-to-item",id:e.id}):this.controller.dispatch({type:"focus-first-expression"})}zoom(e){var t;(t=this.controller.getGrapher())==null||t.viewportController.zoom(e)}setDefaultViewport(){var e;(e=this.controller.getGrapher())==null||e.viewportController.setDefaultViewport()}};var cie=Hi("nworkers"),die=4;cie&&(die=parseInt(cie,10));var tS=new eS(die);function pie(r){let{left:e,right:t,bottom:o,top:i}=r;return{left:e,right:t,bottom:o,top:i,xmin:e,xmax:t,ymin:o,ymax:i,width:Math.abs(t-e),height:Math.abs(i-o)}}var Eke=0,qC=class{constructor(e,t,o,i){let n=(o==null?void 0:o.evaluator)||new Zm(tS);e||(e=document.createElement("div"));let a=document.createElement("div");a.className="dcg-dom-change-wrapper",a.style.width="100%",a.style.height="100%",e.appendChild(a),this.__id=Eke++;let s=new Ch;this.graphSettings=s;for(let h in t)s.config.setProperty(h,t[h]);let c=new Vy({graphSettings:s,movablePointControllerBuilder:o==null?void 0:o.movablePointControllerBuilder});this.controller=c,i&&c.dispatch({type:"ui/container-resized",size:i}),this.rootElt=a,this.view=rS.mountToNode(KC,this.rootElt,{controller:rS.const(c)}),this.controller.setEvaluator(n),this.controller.setRootElt(this.rootElt);let d=this.controller.findEl(".dcg-grapher-2d"),p=new ay(d,s,this.controller,n);if(this.controller.setGrapher2d(p),this.controller.is3dProduct()){let h=this.controller.findEl(".dcg-grapher-3d"),b=new sG(h,s,this.controller,n);this.controller.setGrapher3d(b),this.grapher=b}else this.grapher=p;this.controller.initStateStack(),n.readEvaluatorConfig=()=>({product:s.config.product,beta3d:s.config.beta3d,evaluationMode:c.isGeometry()?"geometry":this.controller.isThreeDMode()?"graphing_3d":"graphing",globalRandomSeed:s.randomSeed,includeFunctionParametersInRandomSeed:s.includeFunctionParametersInRandomSeed,degreeMode:s.degreeMode,viewState:c.getViewState(),selectedIds:c.getPropagatedSelectedIds().selected,restrictedFunctions:s.config.restrictedFunctions,forceEnableGeometryFunctions:s.config.forceEnableGeometryFunctions,distributions:s.config.distributions,pointsOfInterest:s.config.pointsOfInterest,plotSingleVariableImplicitEquations:s.config.plotSingleVariableImplicitEquations,plotImplicits:s.config.plotImplicits,plotInequalities:s.config.plotInequalities,sliders:s.config.sliders,actions:!!s.config.actions,substitutions:s.config.substitutions,intervalComprehensions:s.config.intervalComprehensions,recursion:s.config.recursion,recursionDepthLimit:s.config.recursionDepthLimit,dimensions:c.getGrapherDimensions(),logInternalErrors:s.config.logInternalErrors,complex:s.complex,customRegressions:s.config.customRegressions,newStatsEnabled:s.config.newStats}),n.onEvaluatorProgressUpdate=()=>{this.controller.dispatch({type:"evaluator-progress-update"})},n.onEvaluatorResults=h=>{this.controller.dispatch({type:"on-evaluator-changes",changes:h.evaluationStates,timingData:h.timingData,graphData:h.graphData,eventUpdates:h.eventUpdates,dependencyOrder:h.dependencyOrder}),this.controller.requestRedrawGraph()},this.unsubFunc=this.controller.subscribeToChanges(()=>{this.controller.doesDOMHaveSize()&&(this.view.update(),this.grapher=this.controller.isThreeDMode()?this.controller.getGrapher3d()||this.controller.getGrapher2d():this.controller.getGrapher2d(),this.grapher.update());let h=!1;g()&&(h=!0),h&&this.controller.doesDOMHaveSize()&&(this.view.update(),this.grapher.update())});let u=new Ds({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:pie({top:0,bottom:0,left:0,right:0})});this.graphpaperBounds=u;let g=()=>{let h=!1,b=c.computeMajorLayout(),v={left:b.grapher.left,right:b.grapher.left+b.grapher.width,width:b.grapher.width,top:b.grapher.top,bottom:b.grapher.top+b.grapher.height,height:b.grapher.height},T=this.grapher.getCurrentViewport(),E={...pie({left:T.xmin,right:T.xmax,bottom:T.ymin,top:T.ymax}),zmin:T.zmin,zmax:T.zmax};return __dcg_shared_module_exports__['db'](E,u.mathCoordinates)||(u.setProperty("mathCoordinates",E),h=!0),v.height>0&&v.width>0&&!__dcg_shared_module_exports__['db'](v,u.pixelCoordinates)&&(u.setProperty("pixelCoordinates",v),h=!0),h};re(this.rootElt).on("keydown.calculator-"+this.__id,h=>{this.grapher instanceof ay&&this.grapher.audioGraph.handleKeydown(h),this.instanceHotkeys.handleKeydown(h)}),re(document.documentElement).on("dcg-tapstart.calculator-"+this.__id,h=>{var _;let b=h.target,v=!!this.rootElt.contains(b),T=jr(h,"create-expression-with-keyboard"),E=!!b.classList.contains("dcg-shell");!v&&!E&&!T&&c.dispatch({type:"set-none-selected"});let I=(_=this.controller.getGrapher2d())==null?void 0:_.traceLayer;if(!jr(h,"do-not-clear-poi-labels")&&I&&(I.clearOpenedPOI(),this.controller.requestRedrawGraph()),c.isInEditListMode()){let C=!b.closest(".dcg-exppanel")&&!b.closest(".dcg-options-menu")&&!b.closest(".dcg-expression-top-bar")&&!b.closest(".dcg-keypad");(!v||C)&&c.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!1})}}),this.evaluator=n,this.controller.dispatch({type:"set-blank",degreeMode:!!t.degreeMode}),s.config.expressionsCollapsed&&this.setOptions({expressionsCollapsed:!0}),s.config.capExpressionSize&&this.setOptions({capExpressionSize:!0}),s.config.hasOwnProperty("pointsOfInterest")&&this.setOptions({pointsOfInterest:s.config.pointsOfInterest}),s.config.hasOwnProperty("backgroundColor")&&this.setOptions({backgroundColor:s.config.backgroundColor}),s.config.hasOwnProperty("textColor")&&this.setOptions({textColor:s.config.textColor}),s.config.observe("language",()=>{let h=this.controller.getState();this.controller.dispatch({type:"set-state",state:h})}),s.config.observe("forceLogModeRegressions",()=>{s.config.forceLogModeRegressions&&this.controller.setAllRegressionsToLogMode()}),this.instanceHotkeys=new zC(c)}setOption(e,t){this.controller.getGraphSettings().config.setProperty(e,t)}setOptions(e){let t,o=this.controller.getGraphSettings().config,i={...e};e.hasOwnProperty("backgroundColor")&&(__dcg_shared_module_exports__['rd'](e.backgroundColor)||(__dcg_shared_module_exports__['Be'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete i.backgroundColor)),e.hasOwnProperty("textColor")&&(__dcg_shared_module_exports__['rd'](e.textColor)||(__dcg_shared_module_exports__['Be'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete i.textColor)),e.hasOwnProperty("menus")&&(__dcg_shared_module_exports__['Be'].warn("Deprecated option: menus. Setting settingsMenu and expressionsTopbar instead."),e.hasOwnProperty("settingsMenu")||(i.settingsMenu=!!e.menus),e.hasOwnProperty("expressionsTopbar")||(i.expressionsTopbar=!!e.menus),delete i.menus),e.hasOwnProperty("solutions")&&(__dcg_shared_module_exports__['Be'].warn("Deprecated option: solutions. Setting pointsOfInterest instead."),e.hasOwnProperty("pointsOfInterest")||(i.pointsOfInterest=!!e.solutions),delete i.solutions),e.hasOwnProperty("administerSecretFolders")&&(__dcg_shared_module_exports__['Be'].warn("Deprecated option: administerSecretFolders. Setting authorFeatures instead."),e.hasOwnProperty("authorFeatures")||(i.authorFeatures=!!e.administerSecretFolders),delete i.administerSecretFolders),e.hasOwnProperty("singleVariableSolutions")&&(__dcg_shared_module_exports__['Be'].warn("Deprecated option: singleVariableSolutions has been removed."),delete i.singleVariableSolutions),e.graphpaper===!1&&(e.expressionsCollapsed&&(i.expressionsCollapsed=!1,__dcg_shared_module_exports__['Be'].warn("Cannot set graphpaper: false with expressionsCollapsed: true. Proceeding with expressionsCollapsed: false.")),o.expressionsCollapsed&&(i.expressionsCollapsed=!1,__dcg_shared_module_exports__['Be'].warn("Disabling the graphpaper with the expressions list collapsed is not supported.Setting expressionsCollapsed: false.")),e.zoomButtons&&(i.zoomButtons=!1,__dcg_shared_module_exports__['Be'].warn("Cannot set graphpaper: false with zoomButtons: true. Proceeding with zoomButtons: false.")),e.showResetButtonOnGraphpaper&&(i.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['Be'].warn("Cannot set graphpaper: false with showResetButtonOnGraphpaper: true. Proceeding with showResetButtonOnGraphpaper: false.")),o.zoomButtons&&(i.zoomButtons=!1,__dcg_shared_module_exports__['Be'].warn("Disabling the graphpaper with the zoomButtons visible is not supported. Setting zoomButtons: false.")),o.showResetButtonOnGraphpaper&&(i.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['Be'].warn("Disabling the graphpaper with the reset button visible is not supported. Setting showResetButtonOnGraphpaper: false."))),o.graphpaper===!1&&(e.expressionsCollapsed||e.zoomButtons||e.showResetButtonOnGraphpaper)&&(i.graphpaper=!0,__dcg_shared_module_exports__['Be'].warn("Must have visible graphpaper to proceed. Setting graphpaper: true.")),e.lockViewport&&e.zoomButtons&&(i.zoomButtons=!1,__dcg_shared_module_exports__['Be'].warn("Cannot set zoomButtons: true and lockViewport: true. Proceeding with zoomButtons: false.")),o.lockViewport&&e.zoomButtons&&(i.lockViewport=!1,__dcg_shared_module_exports__['Be'].warn("Cannot set zoomButtons: true while the viewport is locked. Setting lockViewport: false.")),o.zoomButtons&&e.lockViewport&&(i.zoomButtons=!1,__dcg_shared_module_exports__['Be'].warn("Cannot lock the viewport without hiding the zoom buttons. Setting zoomButtons: false."));function n(p){let{notes:u,folders:g,images:h}=p;return u===!1||g===!1||h===!1}let a=n(e),s=n({...o,...e}),c=o.pasteGraphLink,d=e.pasteGraphLink;a?(d||c)&&(i.pasteGraphLink=!1,__dcg_shared_module_exports__['Be'].warn("Cannot disable creating note, folder, or image expressions without disabling graph link pasting. Setting pasteGraphLink: false.")):d&&s&&(i.notes=!0,i.folders=!0,i.images=!0,__dcg_shared_module_exports__['Be'].warn("Cannot enable graph link pasting while the creation of notes, folders, or images is disable. Setting notes: true, folders: true, images: true.")),e.language&&(i.language=Yp(e.language)),this.controller.isGeometry()&&(e.logScales&&(__dcg_shared_module_exports__['Be'].warn("Cannot set logScales: true in the geometry calculator"),delete i.logScales),e.allowComplex&&(__dcg_shared_module_exports__['Be'].warn("Cannot set allowComplex: true in the geometry calculator"),delete i.allowComplex));for(t in i)if(i.hasOwnProperty(t))switch(t){case"expressionsCollapsed":this.setOption("expressionsCollapsed",!!i.expressionsCollapsed),i.expressionsCollapsed?this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:!1}):this.controller.dispatch({type:"show-expressions-list",focusHideIcon:!1});break;case"qwertyKeyboard":this.setOption("qwertyKeyboard",!!i.qwertyKeyboard),this.controller.isLetterKeypadOpen()&&this.controller.dispatch({type:"keypad/abc"});break;case"degreeMode":this.setOption("degreeMode",!!i.degreeMode),this.controller.dispatch({type:"set-graph-settings",degreeMode:!!i.degreeMode});break;case"actions":{let u=i[t];if(u===void 0||u===this.controller.getGraphSettings().config.actions)break;this.setOption(t,u),this.controller.dispatch({type:"request-full-evaluation"});break}case"substitutions":{let u=i[t];if(u===void 0||u===this.controller.getGraphSettings().config.substitutions)break;this.setOption(t,u),this.controller.dispatch({type:"request-full-evaluation"});break}case"intervalComprehensions":{let u=i[t];if(u===void 0||u===this.controller.getGraphSettings().config.intervalComprehensions)break;this.setOption(t,u),this.controller.dispatch({type:"request-full-evaluation"});break}case"recursion":{let u=i[t];if(u===void 0||u===this.controller.getGraphSettings().config.recursion)break;this.setOption(t,u),this.controller.dispatch({type:"request-full-evaluation"});break}case"product":case"beta3d":case"folderModules":{__dcg_shared_module_exports__['Be'].warn(`Cannot update '${t}' setting.`);break}case"logScales":{let u=i[t];u!==void 0&&(u===!1&&this.controller.dispatch({type:"set-graph-settings",xAxisScale:"linear",yAxisScale:"linear"}),this.setOption(t,u));break}case"graphDescription":{let u=i[t];typeof u=="string"||typeof u=="undefined"?this.setOption(t,u):__dcg_shared_module_exports__['Be'].warn("Invalid graphDescription. graphDescription must be of type string or undefined.");break}case"muted":{let u=i[t];if(u===void 0||u===this.controller.getGraphSettings().config.muted)break;u?this.controller.dispatch({type:"mute-global"}):this.controller.dispatch({type:"unmute-global"});break}case"adaptivePeeling":case"advancedStyling":case"allowComplex":case"audio":case"audioTraceSimult":case"audioTraceReverseExpressions":case"authorFeatures":case"authorMode":case"autosize":case"backgroundColor":case"border":case"brailleControls":case"brailleMode":case"branding":case"cacheRenderedSvgs":case"capExpressionSize":case"clearIntoDegreeMode":case"colors":case"crossOriginSaveTest":case"customRegressions":case"decimalToFraction":case"debug3dRender":case"debugPeelLayers":case"debugPixelRatio":case"disableLighting":case"disableWorkerOnZoom":case"defaultLogModeRegressions":case"disableMouseInteractions":case"disableScrollFix":case"distributions":case"editOnWeb":case"enableTabindex":case"expressions":case"expressionsTopbar":case"folders":case"fontSize":case"forceEnableGeometryFunctions":case"forceLogModeRegressions":case"functionDefinition":case"ghostMode":case"graphpaper":case"hideGeoUI":case"imageUploadCallback":case"images":case"invertedColors":case"keypad":case"language":case"links":case"lockViewport":case"nativeOnscreenKeypad":case"notes":case"onlyTraceSelected":case"orientationButtons":case"pasteGraphLink":case"pasteGraphLinkCallback":case"pasteTableData":case"pauseWhenOffscreen":case"peelFloatTexture":case"peelUpsample":case"debugScale":case"perspectiveDistortion":case"plaidMode":case"plotImplicits":case"plotInequalities":case"plotSingleVariableImplicitEquations":case"pointsOfInterest":case"projectorMode":case"restrictedFunctions":case"settingsMenu":case"showHamburger":case"showKeyboardShortcutsInTooltips":case"showPerformanceMeter":case"showResetButtonOnGraphpaper":case"sixKeyInput":case"sliders":case"tableRegressions":case"textColor":case"tone":case"trace":case"translucentSurfaces":case"transparentBackground":case"translucentOpacity":case"wireframe":case"zoomButtons":case"recursionDepthLimit":case"debugProgressUpdates":case"logInternalErrors":case"reflectionArc":case"newStats":case"zoomFit":case"reportPosition":{let u=i[t];u!==void 0&&this.setOption(t,u);break}default:return t}}setViewport(e){let t=new Or(e.xmin,e.xmax,e.ymin,e.ymax,e.zmin,e.zmax);this.grapher.viewportController.setViewport(t),this.controller.dispatch({type:"commit-user-requested-viewport",viewport:t})}resize(e){e&&this.controller.dispatch({type:"ui/container-resized",size:e})}updateVisualViewportZoom(e){this.controller.dispatch({type:"set-visual-viewport-zoom",zoom:e})}destroy(){re(document.documentElement).off(".calculator-"+this.__id),re(this.rootElt).off(".calculator-"+this.__id),this.unsubFunc(),this.graphSettings.unobserveAll(),this.controller&&this.controller.destroy(),this.grapher&&this.grapher.remove(),rS.unmountFromNode(this.rootElt),this.rootElt.remove()}tick(e,t){t||(this.controller.handleTick(e),this.controller.updateRenderShellsAfterDispatch()),this.evaluator.tick(),this.grapher&&this.grapher.tick(e)}getState(e){return this.controller.getState(e)}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e||{}})}setState(e,t){this.controller.dispatch({type:"set-state",state:e,opts:t||{}})}};function Ike(r){function e(t){requestAnimationFrame(e),r(t)}requestAnimationFrame(e)}function Mke(r){function e(){setTimeout(e,oS),r(Date.now())}setTimeout(e,oS)}var uie=Hi("timeoutLoop"),oS=0;typeof uie=="string"&&(oS=parseFloat(uie),isNaN(oS)&&(oS=1e3/60));var hie=oS>0?Mke:Ike;var vB=new Pi;hie(r=>{vB.triggerEvent("tick",r)});var xB=0;function Ql(r){return xB+=1,vB.observeEvent("tick."+xB,(e,t)=>{r(t)}),xB}function Vs(r){vB.unobserveEvent("tick."+r)}function gie(r,e){let t={},o={};for(let i in r)EU(i)?t[i]=r[i]:xX(i)?o[i]=r[i]:e||__dcg_shared_module_exports__['Be'].warn("Unrecognized setting: "+i+". Ignoring.");return{configOptions:t,settingsOptions:o}}function mie(r,e){let t={};return e.hasOwnProperty("x")&&(t.x=r.mapX(e.x)),e.hasOwnProperty("y")&&(t.y=r.mapY(e.y)),t}var bie=[],wB=!1,fie=new Map;function Dke(r){let e=fie.get(r);return e||(e=new r,fie.set(r,e)),e}function yie(r){if(!r||wB)return;let e;for(;(e=bie.shift())&&e.api._destroyed;);if(!e)return;let t=e;wB=!0;let{options:o,mathBounds:i,state:n,callback:a,api:s}=t,c=Dke(r),d=s._calc.controller.getGraphSettings().config,p={};Object.keys(d).forEach(v=>{EU(v)&&v!=="product"&&v!=="beta3d"&&v!=="projectorMode"&&(p[v]=d[v])}),c.updateSettings(p),c.setState(n),c.setMathBounds(i);let u=c._calc.evaluator,g=()=>{c._calc.grapher.asyncScreenshot(o,v=>{wB=!1,yie(r),a(v)})},h=t.api._calc.controller,b=Ql(()=>{h.areAnyImagesLoading()||(Vs(b),u.notifyWhenSynced(g))})}var Wh=class extends Ds{constructor(t,o,i,n){super();this._eventBus=new Pi;this._destroyed=!1;this.isOffscreen=!1;t&&(t.dcgAPIInstance=this);let a=gie(o||{},!0),s=BA(a.configOptions),c=a.settingsOptions;this._calc=new qC(t,s,n),this.controller=this._calc.controller,this.controller.onEventsEmitted=d=>{let p=this.controller.getSelectedItem();this.setProperty("isAnyExpressionSelected",!!p),this.setProperty("selectedExpressionId",p?p.id:void 0),this.setProperty("expressionAnalysis",this.controller.getExpressionAnalysis());let u=Qe.getFocusedMathquill();this.setProperty("focusedMathQuill",u?new YA(u):void 0);for(let g in d){if(!d.hasOwnProperty(g))continue;let h=d[g];h&&this._eventBus.triggerEvent(g,h)}},this._calc.graphpaperBounds.observeAndSync("mathCoordinates",this._syncGraphpaperBounds.bind(this)),this._calc.graphpaperBounds.observeAndSync("pixelCoordinates",this._syncGraphpaperBounds.bind(this)),this.colors=this.controller.getColors(),this._initGraphSettings(),this.updateSettings(c),this._sharedClockBusToken=Ql(d=>this.withControllerInAPIMode(()=>{let p=this._calc.grapher.settings.config.pauseWhenOffscreen&&this.isOffscreen;this._calc.tick(d,p)})),this.domChangeDetector=new Xb(t,d=>this.withControllerInAPIMode(()=>{switch(this.isOffscreen=d.isOffscreen,d.type){case"offscreen-noop":break;case"added":this._calc.resize(d.size);break;case"removed":break;case"resized":this._calc.resize(d.size);break;case"visual-viewport-zoom":this._calc.updateVisualViewportZoom(d.zoom);break}})),s.autosize?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges(),typeof i=="function"&&i(this)}destroy(){this.controller.onEventsEmitted=function(){},this._calc.destroy(),Vs(this._sharedClockBusToken),this.domChangeDetector.destroy();function t(n){__dcg_shared_module_exports__['Be'].warn("You've destroyed this API instance. You can no longer call ."+n+"()")}let o={},i=this;for(;i;)Object.getOwnPropertyNames(i).forEach(a=>o[a]=!0),i=Object.getPrototypeOf(i);for(let n in o)typeof this[n]=="function"?this[n]=t.bind(this,n):this.hasOwnProperty(n)&&delete this[n];this.destroy=function(){},this._destroyed=!0}withHistoryReplacement(t){try{this.controller.pushWithHistoryReplacement(),t()}finally{this.controller.popWithHistoryReplacement()}}withControllerInAPIMode(t){try{return this.controller.pushAPIMethodCall(),t()}finally{this.controller.popAPIMethodCall()}}_syncGraphpaperBounds(){return this.withControllerInAPIMode(()=>{this.controller.runAfterDispatch(()=>{this.setProperty("graphpaperBounds",{mathCoordinates:this._calc.graphpaperBounds.mathCoordinates,pixelCoordinates:this._calc.graphpaperBounds.pixelCoordinates})})})}observeEvent(t,o){return this._eventBus.observeEvent(t,o)}unobserveEvent(t){this._eventBus.unobserveEvent(t)}_initGraphSettings(){return this.withControllerInAPIMode(()=>{let t=new Ds;this.settings=this.graphSettings=t,yX.forEach(o=>{this._calc.grapher.settings.observeAndSync(o,()=>{this.controller.runAfterDispatch(()=>{t.setProperty(o,this._calc.grapher.settings[o])})})}),LZ.forEach(o=>{this._calc.grapher.settings.config.observeAndSync(o,()=>{this.controller.runAfterDispatch(()=>{t.setProperty(o,this._calc.grapher.settings.config[o])})})})})}updateSettings(t){return this.withControllerInAPIMode(()=>{let o=gie(t,!1),i=o.configOptions,n=o.settingsOptions;__dcg_shared_module_exports__['eb'](i)||this._calc.setOptions(i),__dcg_shared_module_exports__['eb'](n)||this.controller.dispatch({type:"set-graph-settings",...this.controller.getGraphSettings().validateSettings(n)}),this.notifyControllerOfAPICall()})}setGraphSettings(t){return this.withControllerInAPIMode(()=>{__dcg_shared_module_exports__['Be'].warn("As of API v0.8 the 'setGraphSettings' method is deprecated and has been renamed 'updateSettings.'"),this.updateSettings(t),this.setGraphSettings=this.updateSettings,this.notifyControllerOfAPICall()})}setDefaultState(t){return this.withControllerInAPIMode(()=>{this._calc.grapher.settings.setProperty("defaultState",t),this.notifyControllerOfAPICall()})}mathToPixels(t){return this.withControllerInAPIMode(()=>{let o=__dcg_shared_module_exports__['jd'].fromRects(this.graphpaperBounds.mathCoordinates,this.graphpaperBounds.pixelCoordinates,{xAxisScale:this._calc.grapher.settings.xAxisScale,yAxisScale:this._calc.grapher.settings.yAxisScale});return mie(o,t)})}pixelsToMath(t){return this.withControllerInAPIMode(()=>{let o=__dcg_shared_module_exports__['jd'].fromRects(this.graphpaperBounds.mathCoordinates,this.graphpaperBounds.pixelCoordinates,{xAxisScale:this._calc.grapher.settings.xAxisScale,yAxisScale:this._calc.grapher.settings.yAxisScale}).inverse();return mie(o,t)})}notifyControllerOfAPICall(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"render"})})}setExpression(t){return this.withControllerInAPIMode(()=>{let i=this.controller.getItemModel(t.id),n=i&&i.type,a=uD(t,n,this.controller);if(a)if(n)this.controller.dispatch({type:"set-expression-properties-from-api",id:a.id,properties:a});else{if(a.type==="image")return;this.controller.dispatch({type:"add-item-to-end-from-api",state:a})}})}setExpressions(t){return this.withControllerInAPIMode(()=>{t.forEach(this.setExpression.bind(this))})}removeExpression(t){return this.withControllerInAPIMode(()=>{let o=t.id.toString();this.controller.dispatch({type:"remove-item-by-id",id:o})})}removeExpressions(t){return this.withControllerInAPIMode(()=>{t.forEach(this.removeExpression.bind(this))})}removeSelected(){return this.withControllerInAPIMode(()=>{let t=this.controller.getSelectedItem();if(!t)return;let{id:o}=t;return this.controller.dispatch({type:"remove-item-by-id",id:o}),o})}setMathBounds(t){return this.withControllerInAPIMode(()=>{var g,h,b,v;let o=t,i=(g=o.xmin)!=null?g:o.left,n=(h=o.xmax)!=null?h:o.right,a=(b=o.ymin)!=null?b:o.bottom,s=(v=o.ymax)!=null?v:o.top,{zmin:c,zmax:d}=o,p,u;c===void 0&&d===void 0?(p=!0,u=!1):c===void 0||d===void 0?(p=!1,u=!0):(p=c<d,u=!0),i<n&&a<s&&p?(this._calc.setViewport({xmin:i,xmax:n,ymin:a,ymax:s,zmin:c,zmax:d}),this._calc.controller.unmarkLastChangedAxis(),this._calc.controller.markSquareAxesAfterUserEditedViewport()):__dcg_shared_module_exports__['Be'].warn("Invalid bounds argument. "+u?"Expected a bounds object with bounds.xmin < bounds.xmax, bounds.ymin < bounds.ymax, and bounds.zmin < bounds.zmax. ":"Expected a bounds object with bounds.xmin < bounds.xmax, and bounds.ymin < bounds.ymax. Got "+JSON.stringify(t)),this.notifyControllerOfAPICall()})}setViewport(t){let[o,i,n,a]=t;return this.withControllerInAPIMode(()=>{t.length==4&&t[1]>t[0]&&t[3]>t[2]?(this._calc.setViewport({xmin:o,xmax:i,ymin:n,ymax:a}),this._calc.controller.markSquareAxesAfterUserEditedViewport()):__dcg_shared_module_exports__['Be'].warn("Invalid viewport.  Expected [xmin, xmax, ymin, ymax].  Got "+t),this.notifyControllerOfAPICall()})}resize(){return this.withControllerInAPIMode(()=>{this.domChangeDetector.checkForChanges()})}getState(t){return this.withControllerInAPIMode(()=>this.controller.getState(t))}getExpressions(){return this.withControllerInAPIMode(()=>this.getState({stripDefaults:!1}).expressions.list.map(_b))}setBlank(t){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"set-blank",opts:t||{}})})}setState(t,o){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"set-state",state:t,opts:o||{}})})}undo(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"undo"})})}redo(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"redo"})})}clearHistory(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"clear-undoredo-history"})})}getHistory(){return this.withControllerInAPIMode(()=>this.controller.getHistory())}restoreHistory(t){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"restore-history",history:t})})}newRandomSeed(){return this.withControllerInAPIMode(()=>{this.updateSettings({randomSeed:Cp()})})}screenshot(t){return this.withControllerInAPIMode(()=>(t||(t={}),t=this._validateBrailleScreenshotOptions(t),this._calc.grapher.screenshot(t)))}_getMathAspectRatio(){return this.withControllerInAPIMode(()=>{let t=this.graphpaperBounds.mathCoordinates,o=this._calc.grapher.getProjection().pixelCoordinates,i=o.right-o.left,n=o.bottom-o.top,a=t.width/i,s=t.height/n;return a/s})}isProjectionUniform(){return this.withControllerInAPIMode(()=>!!this._calc.grapher.getProjection().settings.squareAxes)}_validateBrailleScreenshotOptions(t){return this.withControllerInAPIMode(()=>{t=__dcg_shared_module_exports__['f'](t);let o=t.braille;if(o){let i=o.embosserModel;if(!i)return __dcg_shared_module_exports__['Be'].warn("Screenshot braille options requires an embosser model to be specified. "),__dcg_shared_module_exports__['Be'].warn("Continuing with non-braille screenshot."),delete t.braille,t;if(i==="etc"&&(o.embosserModel="etc11"),i==="vpmax"&&(o.embosserModel="vpmax11"),o.embosserModel!=="etc8"&&o.embosserModel!=="etc11"&&o.embosserModel!=="vpmax8"&&o.embosserModel!=="vpmax11")return __dcg_shared_module_exports__['Be'].warn('Unknown screenshot braille embosser model. Valid models are "etc" and "vpmax".'),__dcg_shared_module_exports__['Be'].warn("Continuing with non-braille screenshot."),delete t.braille,t;o.brailleMode!=="nemeth"&&o.brailleMode!=="ueb"&&(__dcg_shared_module_exports__['Be'].warn("Screenshot options braille.brailleMode must be nemeth or ueb. Proceeding with nemeth."),o.brailleMode="nemeth"),t.width&&(__dcg_shared_module_exports__['Be'].warn("Screenshot width option is ignored when exporting Braille."),delete t.width),t.height&&(__dcg_shared_module_exports__['Be'].warn("Screenshot height option is ignored when exporting Braille."),delete t.height),t.targetPixelRatio&&(__dcg_shared_module_exports__['Be'].warn("Screenshot targetPixelRatio option is ignored when exporting Braille."),delete t.targetPixelRatio),t.preserveAxisNumbers&&(__dcg_shared_module_exports__['Be'].warn("Screenshot preserveAxisNumbers option is ignored when exporting Braille."),delete t.preserveAxisNumbers)}return t})}_validateAsyncScreenshotOpts(t){return this.withControllerInAPIMode(()=>{t=__dcg_shared_module_exports__['f'](t);let o=t.mode||(this.controller.getGraphSettings().squareAxes?"preserveX":"stretch"),i=t.width||t.height||this.graphpaperBounds.pixelCoordinates.width,n=t.height||t.width||this.graphpaperBounds.pixelCoordinates.height,a=t.targetPixelRatio||1;a<1&&(a=1);let s=t.preserveAxisNumbers;t.hasOwnProperty("format")||(t.svg?(t.format="svg",delete t.svg):t.format="png");let c=t.mathBounds||{},d=this._getMathAspectRatio(),p=this.graphpaperBounds.pixelCoordinates.width/this.graphpaperBounds.pixelCoordinates.height,u=AZ({mode:o,width:i,height:n,currentBounds:this.graphpaperBounds.mathCoordinates,graphpaperAspectRatio:p,mathAspectRatio:d,mathBounds:c});return{opts:{...t,width:i,height:n,targetPixelRatio:a,preserveAxisNumbers:s},mathBounds:u}})}asyncScreenshot(...t){var n;if(!t.length){__dcg_shared_module_exports__['Be'].warn("asyncScreenshot expects a callback");return}let o,i;if(t.length===1)if(typeof t[0]!="function"){__dcg_shared_module_exports__['Be'].warn("asyncScreenshot expects a callback");return}else i=t[0],o={};else i=t[1],o=(n=t[0])!=null?n:{};return this.withControllerInAPIMode(()=>{o=this._validateBrailleScreenshotOptions(o);let{opts:a,mathBounds:s}=this._validateAsyncScreenshotOpts(o);bie.push({api:this,options:a,mathBounds:s,state:this.getState(),callback:i}),yie(this.constructor)})}setOptions(t){return this.withControllerInAPIMode(()=>{let o=this._calc.setOptions(t);return this.notifyControllerOfAPICall(),o})}focusFirstExpression(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"focus-first-expression"})})}openKeypad(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!1})})}HelperExpression(t){return this.withControllerInAPIMode(()=>{let o=(t==null?void 0:t.latex)||"",i=new Ds({latex:o});return this.controller.dispatch({type:"add-helper-expression",state:{type:"helper-expression",id:this.controller.generateId(),latex:o,proxy:i}}),i})}getHelperExpressions(){return this.withControllerInAPIMode(()=>this.controller.getHelperExpressions())}};var Qm=class extends Wh{constructor(t,o,i){super(t,{...o,product:"graphing-3d"},i);this.mathToPixels=void 0;this.pixelsToMath=void 0}asyncScreenshot(t){throw new Error("asyncScreenshot() is currently unimplemented in 3D. Use screenshot() instead.")}};jo();En();var HC=class{constructor({evaluationMode:e,additionalFunctions:t,disableParentheses:o,functionDefinition:i,replaceRoundWithReciprocal:n,workerPool:a}){this._evaluations={};this._nextObjectId=0;this.store=new Vd({expressions:{1:{id:"1",latex:"",braille:"",type:"latex",displayAsFraction:!1}},order:["1"],settings:{degreeMode:!1,complex:!1},ui:{focus:void 0}});this.evaluationMode=e,this.additionalFunctions=t,this.disableParentheses=o,this.functionDefinition=i,this.replaceRoundWithReciprocal=n,this.workerPool=a,this._setupEvaluator(),this.clear(),this._sharedClockBusToken=Ql(()=>{this._evaluator.tick()})}isSingleExpression(){return this.evaluationMode==="singleExpressionScientific"||this.evaluationMode==="singleExpressionFourFunction"}destroy(){Vs(this._sharedClockBusToken)}generateObjectId(){return(this._nextObjectId++).toString()}updateNextObjectId(){let e=this.store.getState().order;this._nextObjectId=0;let t=/^[0-9]+$/;for(let o of e)if(t.test(o)){let i=parseInt(o,10);i>=this._nextObjectId&&(this._nextObjectId=i+1)}}clearShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!1}markShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!0}getShouldDebounceUndoRedo(){return this._shouldDebounceUndoRedo}clearCachedBrailleValues(){for(let e of this.getExpressionOrder())this.store.set(["expressions",e,"braille"],"")}getState(){return this.store.getState()}getPersistedState(){let{expressions:e,order:t,settings:o}=this.getState();return{expressions:{list:t.map(i=>{let n=e[i];return{id:n.id,latex:n.latex,displayAsFraction:n.displayAsFraction}})},settings:o}}setState(e){this.store.set(e),this._updateIndexes(),this.updateNextObjectId()}setStateFromAPI(e){let t=[],o={},{settings:i}=e;i.complex&&i.degreeMode&&(i={...i,degreeMode:!1}),e.expressions.list.forEach(({id:n,latex:a,displayAsFraction:s})=>{t.push(n),o[n]={id:n,latex:a,displayAsFraction:s,braille:"",type:"latex"}}),this.setState({expressions:o,order:t,settings:i,ui:{focus:void 0}})}canClear(){if(this.getNumberOfExpressions()>1)return!0;let e=this.getExpressionOrder()[0];return this.getExpressionLatex(e)!==""}clear(){this.setState({expressions:{1:{id:"1",type:"latex",latex:"",braille:"",displayAsFraction:!1}},ui:{focus:void 0},order:["1"],settings:this.getState().settings})}getExpressionOrder(){return this.store.getState().order}getNumberOfExpressions(){return this.getExpressionOrder().length}getExpressionById(e){return this.getState().expressions[e]}getExpressionIndex(e){return this._indexes[e]}_getExpressionByIndex(e){let t=this.getExpressionOrder()[e];return this.getExpressionById(t)}_updateIndexes(){this._indexes={};let e=0;for(let t of this.getExpressionOrder())this._indexes[t]=e,e+=1;this._evaluate()}_usesAnsById(e){return this.getExpressionById(e).latex.indexOf("\\operatorname{ans}")!==-1}_getPreviousExpById(e){let t=this.getExpressionIndex(e);return this._getExpressionByIndex(t-1)}createBlankAfterId(e){if(this.isSingleExpression()||!this.getExpressionById(e).latex)return;let t=this.getExpressionIndex(e),o=this.generateObjectId();this.store.shallowMutate("order",i=>{i.splice(t+1,0,o)}),this.store.shallowMutate("expressions",i=>{i[o]={id:o,latex:"",braille:"",type:"latex",displayAsFraction:!1}}),this._updateIndexes(),this.setFocusedById(o,!0)}conditionallyCopyPrevious(e){let t=this._getPreviousExpById(e),o=this.getExpressionById(e);t!=null&&o.latex===""&&this._usesAnsById(t.id)&&this.setLatexById(e,t.latex)}backspaceAtFrontOfId(e){if(this.getExpressionById(e).latex!==""||this.getNumberOfExpressions()===1)return;let o=this.getExpressionIndex(e);this.store.shallowMutate("order",i=>{i.splice(o,1)}),this.store.shallowMutate("expressions",i=>{delete i[e]}),this._updateIndexes(),this._setFocusedByIndex(Math.max(o-1,0),!0)}setLatexById(e,t){this.store.set(["expressions",e,"latex"],t),this.store.set(["expressions",e,"braille"],""),t===""&&this.setFractionEvaluation(e,!1),this._evaluate()}setLatexAndBrailleById(e,t,o){this.store.set(["expressions",e,"latex"],t),this.store.set(["expressions",e,"braille"],o),t===""&&this.setFractionEvaluation(e,!1),this._evaluate()}setFractionEvaluation(e,t){this.store.set(["expressions",e,"displayAsFraction"],t)}setLatexOfFocusedExpression(e){let t=this.getFocusedExpressionId();t&&this.setLatexById(t,e)}isExpressionFocused(e){return this.getFocusedExpressionId()===e}getExpressionLatex(e){return this.getExpressionById(e).latex}getExpressionError(e){var t;return(t=this._evaluations[e])==null?void 0:t.error}getExpressionValue(e){var t,o;return(o=(t=this._evaluations[e])==null?void 0:t.typedConstantValue)==null?void 0:o.value}getExpressionTypedConstantValue(e){var t;return(t=this._evaluations[e])==null?void 0:t.typedConstantValue}getExpressionAns(e){var o,i;let t=(o=this._evaluations[e])==null?void 0:o.ansId;return t!==void 0?(i=this._evaluations[t])==null?void 0:i.typedConstantValue:t}getExpressionAnsId(e){var t;return(t=this._evaluations[e])==null?void 0:t.ansId}shouldShowEvaluationForExpression(e){let t=this._evaluations[e];return t?t.showEvaluation:!1}isRationalizableConstant(e){let t=this._evaluations[e];return t?t.isRationalizableConstant:!1}canDisplayEvaluationAsFraction(e){let t=this.getExpressionValue(e);return!t||typeof t!="number"?!1:__dcg_shared_module_exports__['rb'](t)}isEvaluationList(e){var t;return __dcg_shared_module_exports__['qa']((t=this.getExpressionTypedConstantValue(e))==null?void 0:t.valueType)}_setFocusedByIndex(e,t){let o=this._getExpressionByIndex(e),i=this.store.getState().ui.focus,n=t?{type:"latex-expression",id:o.id}:void 0;if(!__dcg_shared_module_exports__['db'](i,n)){if(i){let a=i.id;this.store.deepMutate("expressions",s=>{let c=s[a];c&&(c.braille="")})}!t&&this.getFocusedExpressionId()!==o.id||this.store.shallowMutate("ui",a=>{a.focus=n})}}setFocusedById(e,t){let o=this.getExpressionIndex(e);this._setFocusedByIndex(o,t)}focusPrevById(e){let t=this.getExpressionIndex(e)-1;t>=0&&this._setFocusedByIndex(t,!0)}focusNextById(e){let t=this.getExpressionIndex(e)+1;t<this.getNumberOfExpressions()?this._setFocusedByIndex(t,!0):this.createAtEnd()}getFocusedExpression(){let e=this.getFocusedExpressionId();if(e)return this.getExpressionById(e)}getFocusedExpressionId(){let e=this.getState().ui.focus;return e&&e.id}clearFocusedExpression(){let e=this.getFocusedExpression();e&&this.setLatexById(e.id,"")}shouldShowClear(){if(this.getNumberOfExpressions()===1)return!1;let e=this.getFocusedExpression();return!!e&&!!e.latex}getLastExpression(){return this._getExpressionByIndex(this.getNumberOfExpressions()-1)}isLastExpressionEmpty(){return!!this.getLastExpression().latex}createAtEnd(){this.createBlankAfterId(this.getLastExpression().id)}focusLastExpression(){this._setFocusedByIndex(this.getNumberOfExpressions()-1,!0)}focusFirstExpression(){this._setFocusedByIndex(0,!0)}getDegreeMode(){return this.getState().settings.degreeMode}setDegreeMode(e){this.getComplexMode()||(this.store.set(["settings","degreeMode"],e),this._evaluate())}getComplexMode(){return!!this.getState().settings.complex}setComplexMode(e){this.store.set(["settings","complex"],e),e&&this.store.set(["settings","degreeMode"],!1),this._evaluate()}_cleanupLatex(e){return e=__dcg_shared_module_exports__['xb'](e),e.substr(e.length-1)==="="&&(e=e.substr(0,e.length-1)),e}_evaluate(){this._evaluator.clearStatementsAndStartCompleteState(),this.getExpressionOrder().forEach(e=>this._evaluator.addStatement({id:e,index:this.getExpressionIndex(e),latex:this._cleanupLatex(this.getExpressionLatex(e)),shouldGraph:!1,type:"statement"}))}getAdditionalFunctions(){return this.getComplexMode()?[...this.additionalFunctions,...__dcg_shared_module_exports__['Fb']]:this.additionalFunctions}_setupEvaluator(){this._evaluator=new Zm(this.workerPool),this._evaluator.readEvaluatorConfig=()=>({degreeMode:this.getDegreeMode(),evaluationMode:this.evaluationMode,additionalFunctions:this.getAdditionalFunctions(),disableParentheses:this.disableParentheses,functionDefinition:this.functionDefinition,replaceRoundWithReciprocal:this.replaceRoundWithReciprocal,complex:this.getComplexMode(),actions:!1}),this._evaluator.onEvaluatorResults=e=>{var i;let t=e.evaluationStates;this._evaluations={};for(let n in t){let a=t[n];if(!this.getExpressionById(n))continue;let{value:c,valueType:d}=(i=a.typed_constant_value)!=null?i:{},p=!a.is_evaluable&&d===__dcg_shared_module_exports__['B']&&__dcg_shared_module_exports__['rb'](c);this._evaluations[n]={error:a.error,ansId:void 0,typedConstantValue:a.typed_constant_value,showEvaluation:a.is_evaluable||p||d===__dcg_shared_module_exports__['E'],isRationalizableConstant:p}}let o;for(let n of this.getExpressionOrder()){let a=this._evaluations[n];o&&a&&(a.ansId=o),o=n}typeof this.onEvaluationUpdate=="function"&&this.onEvaluationUpdate()}}reloadState(){this.setState(this.getState())}getFunctionDefinition(){return!!this.functionDefinition}enableFunctionDefinition(){this.functionDefinition=!0,this.reloadState()}disableFunctionDefinition(){this.functionDefinition=!1,this.reloadState()}getReplaceRoundWithReciprocal(){return!!this.replaceRoundWithReciprocal}enableReplaceRoundWithReciprocal(){this.replaceRoundWithReciprocal=!0,this.reloadState()}disableReplaceRoundWithReciprocal(){this.replaceRoundWithReciprocal=!1,this.reloadState()}};var WC=class{constructor(e,t){this.keyboardMode="main";this.fontSize=16;this.invertedColors=!1;this.backgroundColor="";this.textColor="";this.projectorMode=!1;this.capExpressionSize=!1;this.decimalToFraction=!0;this.settingsMenu=!0;this.settingsMenuOpen=!1;this.language="en";this.brailleMode="none";this.sixKeyInput=!1;this.brailleControls=!0;this.brailleExpressionDownload=!0;this.replaceCommaWith10Exp=!1;this.typingAsteriskWritesTimesSymbol=!1;this.stateStack=new zh;this.dispatcher=new Ay;this.s=Qc(()=>this.language);this.raw=$s;this.dispatch=e=>{Xf("dispatch",{type:e.type}),this.dispatcher.dispatch(e);let t;for(;t=this._queuedCallbacks.shift();)t()};this._queuedCallbacks=[];this.logEvent=e=>{};this.stateStack=new zh,this.dispatcher=new Ay,this.options=e,this.model=new HC({evaluationMode:this.options.evaluationMode,additionalFunctions:this.options.additionalFunctions,disableParentheses:this.options.disableParentheses,functionDefinition:this.options.functionDefinition,replaceRoundWithReciprocal:this.options.replaceRoundWithReciprocal,workerPool:t.workerPool}),this.model.setComplexMode(e.complex),this.model.setDegreeMode(e.degreeMode),this.setLanguage(e.language),this.setBrailleMode(e.brailleMode),this.setSixKeyInput(e.sixKeyInput),this.setBrailleControls(e.brailleControls),this.setBrailleExpressionDownload(e.brailleExpressionDownload),this.setReplaceCommaWith10Exp(e.replaceCommaWith10Exp),this.setReplaceRoundWithReciprocal(e.replaceRoundWithReciprocal),this.setTypingAsteriskWritesTimesSymbol(e.typingAsteriskWritesTimesSymbol),this.setProjectorMode(e.projectorMode),this.setCapExpressionSize(e.capExpressionSize),this.setDecimalToFraction(e.decimalToFraction),this.invertedColors=e.invertedColors,this.backgroundColor=e.backgroundColor,this.textColor=e.textColor,this.settingsMenu=e.settingsMenu,this.model.onEvaluationUpdate=()=>this.dispatch({type:"render"}),this.settingsProxy=t.settingsProxy,this.syncPublicSettings(),this.hookUpDispatcher(),this.containerSize={width:0,height:0}}runAfterDispatch(e){this._queuedCallbacks.push(e)}enqueueEvent(e){this.runAfterDispatch(()=>{this.onEventEmitted&&this.onEventEmitted(e)})}getSettingsMenu(){return this.settingsMenu}getBrailleMode(){return this.brailleMode}renderAsBraille(){return this.brailleMode!=="none"}setBrailleMode(e){this.brailleMode=e}getSixKeyInput(){return this.sixKeyInput}setSixKeyInput(e){this.sixKeyInput=e}getBrailleControls(){return this.brailleControls}setBrailleControls(e){this.brailleControls=e}getBrailleExpressionDownload(){return this.brailleExpressionDownload}setBrailleExpressionDownload(e){this.brailleExpressionDownload=e}getRestrictedEditing(){return this.options.restrictedEditing}getKeyboardMode(){return this.keyboardMode}getFontSize(){return this.fontSize}getInvertedColors(){return this.invertedColors}hasBackgroundColor(){return this.getBackgroundColor()!=="#ffffff"}getBackgroundColor(){return __dcg_shared_module_exports__['qd'](this.backgroundColor||"#fff")}hasTextColor(){return this.getTextColor()!=="#000000"}getTextColor(){return __dcg_shared_module_exports__['qd'](this.textColor||"#000")}getAdditionalFunctions(){return this.options.additionalFunctions}getDisableParentheses(){return this.options.disableParentheses}getTypingSlashWritesDivisionSymbol(){return this.options.typingSlashWritesDivisionSymbol}setTypingAsteriskWritesTimesSymbol(e){this.typingAsteriskWritesTimesSymbol=e}getTypingAsteriskWritesTimesSymbol(){return this.typingAsteriskWritesTimesSymbol}setProjectorMode(e){this.projectorMode=e}isProjectorMode(){return this.projectorMode}getReplaceCommaWith10Exp(){return this.replaceCommaWith10Exp}setReplaceCommaWith10Exp(e){this.replaceCommaWith10Exp=e}getReplaceRoundWithReciprocal(){return this.model.getReplaceRoundWithReciprocal()}setReplaceRoundWithReciprocal(e){e?this.model.enableReplaceRoundWithReciprocal():this.model.disableReplaceRoundWithReciprocal()}setCapExpressionSize(e){this.capExpressionSize=e}getCapExpressionSize(){return this.capExpressionSize}setDecimalToFraction(e){this.decimalToFraction=e}setLanguage(e){e!=="en"&&!LI(e)?__dcg_shared_module_exports__['Be'].warn(`Translation for '${e}' isn't currently available. Using '${this.language}' instead.`):this.language=e}getLanguage(){return this.language}getDecimalToFraction(){return this.decimalToFraction}isScientificCalc(){let e=this.options.evaluationMode;return e==="scientific"||e==="singleExpressionScientific"}isFourFunctionCalc(){return this.options.evaluationMode==="fourFunction"||this.options.evaluationMode==="singleExpressionFourFunction"}getAllowLinks(){return this.options.links}canUndo(){return this.stateStack.canUndo()}canRedo(){return this.stateStack.canRedo()}undo(e){if(!this.canUndo())return;this.stateStack.undo();let t=this.stateStack.getState();e.restoreFocus||(t={...t,ui:{focus:void 0}}),this.model.setState(t),this.enqueueEvent("change")}redo(e){if(!this.canRedo())return;this.stateStack.redo();let t=this.stateStack.getState();e.restoreFocus||(t={...t,ui:{focus:void 0}}),this.model.setState(t),this.enqueueEvent("change")}clearHistory(){this.stateStack.clear()}canBackspace(){let e=this.model.getFocusedExpression();return e&&(e.latex.length>0||this.model.getNumberOfExpressions()>1)}focusLastExpression(){this.model.focusLastExpression()}shouldRender(){return this.containerSize.width>0&&this.containerSize.height>0}canClear(){return this.model.canClear()}shouldShowClear(){return this.model.shouldShowClear()}enableSettingsMenu(){this.settingsMenu=!0}disableSettingsMenu(){this.closeSettingsMenu(),this.settingsMenu=!1}closeSettingsMenu(){this.settingsMenuOpen=!1}toggleSettingsMenu(){this.settingsMenuOpen=!this.settingsMenuOpen}isSettingsMenuOpen(){return this.settingsMenuOpen}isLastExpressionEmpty(){return this.model.isLastExpressionEmpty()}createAtEnd(){this.model.createAtEnd()}clearFocusedExpression(){this.model.clearFocusedExpression()}setLatexById(e,t){this.model.setLatexById(e,t)}setLatexAndBrailleById(e,t,o){this.model.setLatexAndBrailleById(e,t,o)}setLatexOfFocusedExpression(e){this.model.setLatexOfFocusedExpression(e)}toggleFractionEvaluationById(e){this.model.setFractionEvaluation(e,!this.model.getExpressionById(e).displayAsFraction)}conditionallyCopyPrevious(e){this.model.conditionallyCopyPrevious(e)}createBlankAfterId(e){this.model.createBlankAfterId(e)}backspaceAtFrontOfId(e){this.model.backspaceAtFrontOfId(e)}areStatesDifferentEnoughForUndoRedo(e,t){let o={focus:void 0};return __dcg_shared_module_exports__['db']({...e,ui:o},{...t,ui:o})}commitUndoRedoDebounced(){let e=this.model.getState(),t=this.stateStack.getState();if(this.areStatesDifferentEnoughForUndoRedo(e,t))return;let o=new Date().getTime();o-this._lastDebouncedTime<1e3?this.stateStack.replaceState(e):this.stateStack.addState(e),this._lastDebouncedTime=o,this.enqueueEvent("change")}commitUndoRedoSynchronously(){let e=this.model.getState(),t=this.stateStack.getState();this.areStatesDifferentEnoughForUndoRedo(e,t)||(this._lastDebouncedTime=0,this.stateStack.addState(e),this.enqueueEvent("change"))}updateKeyboardMode(e){this.keyboardMode=e}getFocusedMathquill(){if(this.model.getFocusedExpressionId())return Qe.getFocusedMathquill()}ensureMathquillIsFocusedAndReturnFocusedMathquill(){let e=this.getFocusedMathquill();if(e)return e;if(this.isLastExpressionEmpty()&&!this.model.isSingleExpression()?this.createAtEnd():this.focusLastExpression(),this.onEventEmitted&&this.onEventEmitted("render"),e=this.getFocusedMathquill(),!e)throw new Error("No focused mathquill found");return e}typeIntoFocusedMathquill(e){e=e.replace(/\r|\n/g,"");let t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();t&&Qe.canAcceptText(t,this.getCapExpressionSize(),e)&&(t.typedText(e),this.setLatexOfFocusedExpression(t.latex()),this.model.markShouldDebounceUndoRedo())}pressKeyInFocusedMathquill(e){if(this.getBrailleMode()!=="none")return;let t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();if(!t)return;let{key:o,source:i,evt:n}=e;if(o==="Up"||o==="Down"||o==="Left"||o==="Right"){let a=i==="keypad"?Qe.temporarilyOverrideLeftRightIntoCommandGoes(t,void 0):void 0,s=Qe.applyArrowKeyAndReturnIfWasAtBounds(t,o,n);a==null||a(),s&&this.moveFocusInDirection(o)}else o==="Enter"?(n&&(n.preventDefault(),n.stopPropagation()),this.handleEnter()):o==="Backspace"?this.attemptToMoveFocusWithBackspace()||(t.keystroke(o,n),this.setLatexOfFocusedExpression(t.latex())):o==="Delete"?(t.keystroke(o,n),this.setLatexOfFocusedExpression(t.latex())):(t.keystroke(o,n),this.setLatexOfFocusedExpression(t.latex()))}moveFocusInDirection(e){let t=this.model.getFocusedExpressionId();t&&(e==="Up"?this.model.focusPrevById(t):e==="Down"&&this.model.focusNextById(t))}handleEnter(){if(this.model.isSingleExpression())return;let e=this.model.getFocusedExpressionId();e&&(this.conditionallyCopyPrevious(e),this.createBlankAfterId(e))}attemptToMoveFocusWithBackspace(){let e=this.model.getFocusedExpression();if(!e)return!1;let{latex:t,id:o}=e;return t===""?(this.backspaceAtFrontOfId(o),!0):!1}executeCommandInFocusedMathquill(e){let t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();t&&(cV(t,e,{capExpressionSize:this.getCapExpressionSize()}),this.setLatexOfFocusedExpression(t.latex()))}syncPublicSettings(){this.settingsProxy.setProperty("language",this.language),this.settingsProxy.setProperty("fontSize",this.fontSize),this.settingsProxy.setProperty("degreeMode",this.model.getDegreeMode()),this.settingsProxy.setProperty("invertedColors",this.invertedColors),this.settingsProxy.setProperty("backgroundColor",this.backgroundColor),this.settingsProxy.setProperty("textColor",this.textColor),this.settingsProxy.setProperty("brailleMode",this.brailleMode),this.settingsProxy.setProperty("sixKeyInput",this.sixKeyInput),this.settingsProxy.setProperty("brailleControls",this.brailleControls),this.settingsProxy.setProperty("brailleExpressionDownload",this.brailleExpressionDownload),this.settingsProxy.setProperty("projectorMode",this.projectorMode),this.settingsProxy.setProperty("capExpressionSize",this.capExpressionSize),this.settingsProxy.setProperty("decimalToFraction",this.decimalToFraction),this.settingsProxy.setProperty("qwertyKeyboard",this.options.qwertyKeyboard),this.settingsProxy.setProperty("links",this.options.links),this.settingsProxy.setProperty("settingsMenu",this.settingsMenu),this.settingsProxy.setProperty("functionDefinition",this.model.getFunctionDefinition()),this.settingsProxy.setProperty("replaceCommaWith10Exp",this.replaceCommaWith10Exp),this.settingsProxy.setProperty("replaceRoundWithReciprocal",this.model.getReplaceRoundWithReciprocal()),this.settingsProxy.setProperty("typingAsteriskWritesTimesSymbol",this.typingAsteriskWritesTimesSymbol)}getDegreeMode(){return this.model.getDegreeMode()}hookUpDispatcher(){this.dispatcher.register(e=>{this.enqueueEvent("render");let t=!1,o=this.getRestrictedEditing();switch(e.type){case"update-options":{this.options={...this.options,...e.options};break}case"keypad/shift":{let s;switch(this.keyboardMode){case"qwerty":s="capitalQwerty";break;case"capitalQwerty":s="qwerty";break;case"letters":s="capitalLetters";break;case"capitalLetters":s="letters";break;default:s="qwerty"}this.updateKeyboardMode(s)}break;case"undo":o||(this.undo({restoreFocus:e.source==="keyboard-shortcut"}),t=!0);break;case"redo":o||(this.redo({restoreFocus:e.source==="keyboard-shortcut"}),t=!0);break;case"clear-history":this.clearHistory();break;case"set-state-from-api":e.opts.allowUndo||this.clearHistory(),this.model.setStateFromAPI(e.state);break;case"main":this.updateKeyboardMode("main");break;case"ABC":this.options.qwertyKeyboard?this.updateKeyboardMode("qwerty"):this.updateKeyboardMode("letters");break;case"functions":this.updateKeyboardMode("functions");break;case"degrees":this.model.setDegreeMode(!this.model.getDegreeMode());break;case"update-degree-mode":this.model.setDegreeMode(!!e.mode);break;case"update-font-size":let i=e.size;if(typeof i!="number"&&(i=parseInt(i,10)),isNaN(i))return;this.fontSize=i;break;case"update-inverted-colors":this.invertedColors=!!e.mode;break;case"update-background-color":this.backgroundColor=e.color;break;case"update-text-color":this.textColor=e.color;break;case"update-projector-mode":this.setProjectorMode(!!e.mode);break;case"update-cap-expression-size":this.setCapExpressionSize(!!e.mode);break;case"update-decimal-to-fraction":this.setDecimalToFraction(!!e.mode);break;case"update-language":this.setLanguage(e.language);break;case"set-blank":e.opts.allowUndo||this.clearHistory(),this.model.clear(),this.focusLastExpression();break;case"clear":this.model.clearFocusedExpression();break;case"set-braille-mode":let n=e.mode;n!=="nemeth"&&n!=="ueb"&&n!=="none"?__dcg_shared_module_exports__['Be'].warn(`Valid Braille modes are 'nemeth', 'none', and 'ueb'. You passed '${n}'.`):(this.model.clearCachedBrailleValues(),this.setBrailleMode(e.mode));break;case"set-six-key-input":this.setSixKeyInput(!!e.useSixKeyInput);break;case"set-braille-controls":this.setBrailleControls(!!e.value);break;case"set-braille-expression-download":this.setBrailleExpressionDownload(!!e.mode);break;case"set-replace-comma-with-10-exp":this.setReplaceCommaWith10Exp(!!e.replace);break;case"set-replace-round-with-reciprocal":this.setReplaceRoundWithReciprocal(!!e.replace);break;case"set-typing-asterisk-writes-times-symbol":this.setTypingAsteriskWritesTimesSymbol(!!e.mode);break;case"update-latex":this.model.markShouldDebounceUndoRedo(),this.setLatexById(e.id,e.latex);break;case"update-latex-from-braille":this.model.markShouldDebounceUndoRedo(),this.setLatexAndBrailleById(e.id,e.latex,e.braille);break;case"focusin":this.model.setFocusedById(e.id,!0);break;case"focusout":this.model.setFocusedById(e.id,!1);break;case"focus-first-expression":this.model.focusFirstExpression();break;case"focus-prev-expression":this.moveFocusInDirection("Up");break;case"focus-next-expression":this.moveFocusInDirection("Down");break;case"focus-last-expression":this.model.focusLastExpression();break;case"insert-blank-expression":this.handleEnter();break;case"backspace-from-braille":this.attemptToMoveFocusWithBackspace();break;case"keypad/type-text":this.typeIntoFocusedMathquill(e.text);break;case"keypad/press-key":this.pressKeyInFocusedMathquill(e);break;case"keypad/custom-command":this.executeCommandInFocusedMathquill(e.command);break;case"keypad/123":case"keypad/abc":case"keypad/audio-trace":break;case"enable-settings-menu":this.enableSettingsMenu();break;case"disable-settings-menu":this.disableSettingsMenu();break;case"toggle-settings-menu":this.toggleSettingsMenu();break;case"close-settings-menu":this.closeSettingsMenu();break;case"render":break;case"ui/container-resized":this.containerSize=e.size;break;case"toggle-fraction-evaluation":this.toggleFractionEvaluationById(e.id);break;case"toggle-complex-mode":this.isComplexModeAllowed()&&this.model.setComplexMode(e.enabled);break;case"toggle-complex-allowed":this.options.allowComplex=e.enabled;break;default:return e}this.runAfterDispatch(()=>this.syncPublicSettings()),t||(this.model.getShouldDebounceUndoRedo()?(this.commitUndoRedoDebounced(),this.model.clearShouldDebounceUndoRedo()):this.commitUndoRedoSynchronously())})}getMathquillConfig(){let e=this.getAdditionalFunctions(),t=this.isFourFunctionCalc()&&(!e||e.indexOf("fraction")===-1);return{typingAsteriskWritesTimesSymbol:this.getTypingAsteriskWritesTimesSymbol(),typingSlashWritesDivisionSymbol:this.getTypingSlashWritesDivisionSymbol(),disableCopyPaste:this.getRestrictedEditing(),autoCommands:jg({disallowFrac:t}),...c1()}}isComplexModeEnabled(){return this.model.getComplexMode()&&this.isComplexModeAllowed()}isComplexModeAllowed(){return this.options.evaluationMode==="scientific"&&this.options.allowComplex}canDisplayEvaluationAsFraction(e){return this.getDecimalToFraction()&&this.model.canDisplayEvaluationAsFraction(e)}shouldDisplayEvaluationAsFraction(e){return this.canDisplayEvaluationAsFraction(e)&&this.model.getExpressionById(e).displayAsFraction}getEvaluationDigits(){return this.isScientificCalc()?10:7}getLabelOptionsForExpression(e){let t=this.model.getExpressionTypedConstantValue(e);return(t==null?void 0:t.valueType)===__dcg_shared_module_exports__['_']?{...__dcg_shared_module_exports__['qb'],digits:Math.min(this.getEvaluationDigits(),__dcg_shared_module_exports__['qb'].digits)}:{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:this.shouldDisplayEvaluationAsFraction(e)}}getEvaluationMode(){return this.options.evaluationMode}};jo();var lu=__dcg_shared_module_exports__['e'](j());var ef=__dcg_shared_module_exports__['e'](j());Ut();var xie=__dcg_shared_module_exports__['e'](j()),pr=class extends xie.View{init(){this.controller=this.props.controller(),this.model=this.controller.model,this.dispatch=this.controller.dispatch,this.s=this.controller.s}};var Ia=__dcg_shared_module_exports__['e'](j());var{If:jh,Input:Ake,Textarea:Lke}=Ia.Components,jC=class extends pr{constructor(){super(...arguments),this.lastBrailleModeDuringFocusChange="none"}getAriaLabel(){let e=this.getIndex()+1+"";return this.s("shared-calculator-narration-expression-index",{index:e})}didUpdate(){this.renderAnsValue()}didMountMQ(e){this.mq=e}getExp(){return this.model.getExpressionById(this.props.id())}getLatex(){return this.getExp().latex}getValue(){return this.model.getExpressionValue(this.props.id())}getBraille(){let e=this.getExp().braille;if(e!=="")return e;{let t=I1(this.getLatex(),this.controller.getBrailleMode());return t.isError?"":ma.toExpandedBrailleAscii(t.value)}}getIndex(){return this.model.getExpressionIndex(this.props.id())}getShowEvaluation(){return this.model.shouldShowEvaluationForExpression(this.props.id())}isFractionEvaluation(){return this.getExp().displayAsFraction}toggleFractionEvaluation(){this.dispatch({type:"toggle-fraction-evaluation",id:this.props.id()})}getFractionDisplayAriaLabel(){return this.controller.shouldDisplayEvaluationAsFraction(this.props.id())?this.controller.s("basic-calculator-narration-convert-to-decimal"):this.controller.s("basic-calculator-narration-convert-to-fraction")}getError(){let e=this.model.getExpressionError(this.props.id());return e&&this.getLatex().length>0?fc(e,this.controller.getLanguage()):""}showError(){return!!this.getError()}getFractionMessage(){return this.controller.shouldDisplayEvaluationAsFraction(this.props.id())?this.s("basic-calculator-label-convert-to-decimal"):this.s("basic-calculator-label-convert-to-fraction")}getIsFocused(){return!this.controller.isSettingsMenuOpen()&&this.model.isExpressionFocused(this.props.id())}onFocusedChanged(e){let t=this.controller.getBrailleMode(),o=t!==this.lastBrailleModeDuringFocusChange;this.lastBrailleModeDuringFocusChange=t,!(!this.getExp()||o)&&(e?this.dispatch({type:"focusin",id:this.props.id()}):this.dispatch({type:"focusout",id:this.props.id()}))}onMQReflow(){this.cachedRenderedAnsString=void 0,this.renderAnsValue()}renderAnsValue(){if(!this.mq)return;let e=this.model.getExpressionAnsId(this.props.id()),t;if(e!==void 0){let o=this.controller.getLabelOptionsForExpression(e),i=this.model.getExpressionTypedConstantValue(e);switch(i==null?void 0:i.valueType){case __dcg_shared_module_exports__['_']:t=__dcg_shared_module_exports__['yb'](i.value,{...o,digits:5,scientificNotationDigits:3},"html");break;case __dcg_shared_module_exports__['B']:t=__dcg_shared_module_exports__['tb'](i.value,o);break;default:__dcg_shared_module_exports__['qa'](i==null?void 0:i.valueType)&&(t="[...]");break}}t!==this.cachedRenderedAnsString&&(this.mq.querySelectorAll(".dcg-mq-ans").forEach(o=>{t?(o.classList.remove("dcg-invalid"),o.innerHTML=t):(o.classList.add("dcg-invalid"),o.innerHTML='<i class="dcg-icon-error" aria-hidden="true"></i>')}),this.cachedRenderedAnsString=t)}getEvaluationLatex(){let e=this.props.id();if(this.model.isRationalizableConstant(e)&&!this.controller.shouldDisplayEvaluationAsFraction(e))return"";let t=this.controller.getLabelOptionsForExpression(e),o=this.model.getExpressionTypedConstantValue(e),i;switch(o==null?void 0:o.valueType){case __dcg_shared_module_exports__['_']:i=__dcg_shared_module_exports__['yb'](o.value,t,"latex");break;case __dcg_shared_module_exports__['B']:i=__dcg_shared_module_exports__['ub'](o.value,t);break;default:if(__dcg_shared_module_exports__['qa'](o==null?void 0:o.valueType))return`\\mathrm{${o.value.length}\\ element\\ list}`;break}return(i==="undefined"||i===void 0)&&(i="\\mathrm{undefined}"),`=${i}`}getEvaluationBraille(){let e=this.getEvaluationLatex(),t=I1(e,this.controller.getBrailleMode());return t.isError?"":ma.toExpandedBrailleAscii(t.value)}didMountBrailleInput(e){this.brailleInputNode=e}didUnmountBrailleInput(){this.brailleInputNode=void 0}handleBrailleKeydown(e){!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(Pe(e)===Tn?(this.forceModelFocus(),this.dispatch({type:"focus-prev-expression"}),e.preventDefault()):Pe(e)===Mi?(this.forceModelFocus(),this.dispatch({type:"focus-next-expression"}),e.preventDefault()):Pe(e)===Yu?(this.forceModelFocus(),this.dispatch({type:"insert-blank-expression"}),e.preventDefault()):Pe(e)===Ox&&document.activeElement===this.brailleInputNode&&this.getBraille()===""&&(this.dispatch({type:"backspace-from-braille"}),e.preventDefault()))}forceModelFocus(){document.activeElement!==this.brailleInputNode&&this.onFocusedChanged(!0)}getPostLabel(){let e=this.props.id(),t=this.controller.getLabelOptionsForExpression(e);if(this.showError())return this.getError();if(this.getShowEvaluation()){let o=this.model.getExpressionTypedConstantValue(e),i="";switch(o==null?void 0:o.valueType){case __dcg_shared_module_exports__['_']:i=__dcg_shared_module_exports__['yb'](o.value,t);break;case __dcg_shared_module_exports__['B']:i=__dcg_shared_module_exports__['ub'](o.value,t);break;default:if(__dcg_shared_module_exports__['qa'](o==null?void 0:o.valueType))return`${o.value.length} element list`;break}return"equals "+Mr(i!=null?i:"undefined")}return""}onBrailleInput(e){this.controller.isSettingsMenuOpen()&&this.controller.dispatch({type:"close-settings-menu"});let t=tA(ma.coerceToSixDotCells(e),this.controller.getBrailleMode()),o=t.isError?"":t.value;(!this.controller.getCapExpressionSize()||d1(o)<=E1)&&this.controller.dispatch({type:"update-latex-from-braille",latex:o,braille:e,id:this.props.id()})}getIndexSubscript(){return`_{${this.getIndex()+1}}`}onMountContainer(e){this.containerNode=e}onTapContainer(e){e.target===this.containerNode&&!this.getShowEvaluation()&&!this.showError()&&this.forceModelFocus()}template(){return x("div",{class:()=>({"dcg-basic-expression":!0,"dcg-focused":this.getIsFocused(),"dcg-braille-io":this.controller.renderAsBraille()}),onTap:this.bindFn(this.onTapContainer),onMount:this.bindFn(this.onMountContainer),children:[l(jh,{predicate:()=>this.controller.renderAsBraille(),children:()=>l("div",{class:Ia.const("dcg-braille-input"),children:l(Vb,{ariaLabel:()=>{let e=I1(`eq${this.getIndexSubscript()}`,this.controller.getBrailleMode());return e.isError?"":ma.toExpandedBrailleAscii(e.value)},didMount:this.bindFn(this.didMountBrailleInput),didUnmount:this.bindFn(this.didUnmountBrailleInput),onFocusedChanged:this.bindFn(this.onFocusedChanged),isFocused:this.bindFn(this.getIsFocused),onKeyDown:this.bindFn(this.handleBrailleKeydown),onInput:this.bindFn(this.onBrailleInput),sixKeyInput:()=>this.controller.getSixKeyInput(),value:()=>this.getBraille(),isStatic:this.const(!1)})})}),l(jh,{predicate:()=>this.controller.renderAsBraille(),children:()=>x("div",{class:Ia.const("dcg-braille-evaluation-container"),children:[l(jh,{predicate:()=>this.getShowEvaluation(),children:()=>l("div",{class:Ia.const("dcg-braille-evaluation"),children:l(Ake,{readOnly:this.const(!0),class:this.const("dcg-braille-evaluation-inner"),value:()=>this.getEvaluationBraille(),onKeyDown:this.bindFn(this.handleBrailleKeydown),onInput:()=>{}})})}),l(jh,{predicate:()=>this.showError(),children:()=>x("div",{class:Ia.const("dcg-braille-error"),children:[l("div",{class:Ia.const("dcg-basic-expression-error"),children:l("i",{class:Ia.const("dcg-icon-error"),"aria-hidden":Ia.const("true")})}),l(Lke,{readOnly:this.const(!0),class:this.const("dcg-braille-error-inner"),value:()=>this.getError(),onKeyDown:this.bindFn(this.handleBrailleKeydown),onInput:()=>{}})]})})]})}),l(jh,{predicate:()=>this.controller.renderAsBraille(),children:()=>l("div",{class:Ia.const("dcg-exp-mathquill-container"),didMount:this.bindFn(this.didMountMQ),onTap:this.bindFn(this.forceModelFocus),children:l(dt,{latex:()=>this.getLatex(),config:this.const({}),onReflow:this.bindFn(this.onMQReflow)})})}),l(jh,{predicate:()=>!this.controller.renderAsBraille(),children:()=>l("div",{class:Ia.const("dcg-exp-mathquill-container"),didMount:this.bindFn(this.didMountMQ),children:l(Qe,{latex:()=>this.getLatex(),onReflow:this.bindFn(this.onMQReflow),isFocused:this.bindFn(this.getIsFocused),capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel(),getAriaPostLabel:()=>this.getPostLabel(),hasError:()=>!1,onUserPressedKey:(e,t)=>{this.controller.isSettingsMenuOpen()&&this.controller.dispatch({type:"close-settings-menu"}),this.dispatch({type:"keypad/press-key",key:e,evt:t,source:"keyboard"})},onUserChangedLatex:e=>{this.dispatch({type:"update-latex",id:this.props.id(),latex:e})},onFocusedChanged:this.bindFn(this.onFocusedChanged),disableSpace:()=>this.controller.getRestrictedEditing()})})}),x("div",{class:Ia.const("dcg-exp-output-container"),children:[l(jh,{predicate:()=>this.showError()&&!this.controller.renderAsBraille(),children:()=>l(Zo,{error:this.bindFn(this.getError),gravity:this.const("w")})}),l(jh,{predicate:()=>this.getShowEvaluation(),children:()=>x("div",{class:()=>({"dcg-basic-expression-value":!0,"dcg-basic-evaluation-gray":this.model.isEvaluationList(this.props.id())}),children:[l(dt,{config:this.const({}),latex:()=>this.getEvaluationLatex()}),l(jh,{predicate:()=>this.controller.canDisplayEvaluationAsFraction(this.props.id()),children:()=>l(Oe,{tooltip:this.bindFn(this.getFractionMessage),gravity:this.const("s"),children:l("span",{role:Ia.const("button"),tabIndex:Ia.const("0"),"aria-label":this.bindFn(this.getFractionDisplayAriaLabel),class:()=>({"dcg-basic-fraction-toggle":!0,"dcg-selected":this.isFractionEvaluation()}),onTap:this.bindFn(this.toggleFractionEvaluation),children:l("i",{class:Ia.const("dcg-icon-fraction"),"aria-hidden":Ia.const("true")})})})})]})})]})]})}getMQConfig(){return this.controller.getMathquillConfig()}};var{For:Pke,If:Gke}=ef.Components,XC=class extends pr{constructor(){super(...arguments),this.didShowAnswerHint=!1,this.didHideAnswerHint=!1}template(){return x("div",{class:ef.const("dcg-basic-list-container"),role:ef.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-expression-list"),didMount:this.bindFn(this.didMountContainer),children:[l("div",{class:ef.const("dcg-basic-list-placeholder"),didMount:this.bindFn(this.didMountPlaceholder),children:l(Gke,{predicate:this.bindFn(this.showAnswerHint),children:()=>x("div",{class:ef.const("dcg-answer-hint"),children:[()=>this.controller.s("basic-calculator-label-answer-hint"),l("i",{class:ef.const("dcg-icon-curved-arrow")})]})})}),l("div",{class:()=>({"dcg-basic-list":!0,"dcg-projector-mode":this.controller.isProjectorMode()}),children:l(Pke,{each:()=>this.model.getExpressionOrder(),children:e=>l(jC,{controller:this.props.controller,id:this.const(e)})})})]})}didMountPlaceholder(e){re(e).on("dcg-tap",Dr)}showAnswerHint(){if(this.didHideAnswerHint)return!1;let e=this.model.getExpressionOrder()[0];return this.model.shouldShowEvaluationForExpression(e)||this.didShowAnswerHint?(this.didShowAnswerHint=!0,this.model.getNumberOfExpressions()>1||this.model.getExpressionLatex(e)===""?(this.didHideAnswerHint=!0,!1):!0):!1}didUpdate(){if(!this.container)return;let e=this.container.querySelector(".dcg-focused");e&&bl(e,this.container,50)}didMountContainer(e){this.container=e}};var Nc=__dcg_shared_module_exports__['e'](j());var Oy=__dcg_shared_module_exports__['e'](j());var{For:Vke}=Oy.Components,nS=class extends Oy.View{template(){return x("tr",{children:[l("td",{children:l(Vke,{each:()=>this.getBrailleAscii(this.props.latex()),children:e=>l("span",{class:Oy.const("dcg-key-press"),children:()=>e.char})},e=>e.key)}),l("td",{class:Oy.const("dcg-braille-font"),children:()=>this.getBrailleUnicode(this.props.latex())}),l("td",{children:l(dt,{config:this.const({}),latex:()=>this.props.latex()})})]})}getBrailleAscii(e){let t=ma.toExpandedBrailleAscii(this.getBrailleUnicode(e)),o=[];for(let i=0;i<t.length;i++)o.push({char:t[i],key:i+")"+t[i]});return o}getBrailleUnicode(e){let t;return this.props.brailleMode()==="nemeth"?t=nh(e):this.props.brailleMode()==="ueb"&&(t=ah(e)),t&&t.value?t.value:""}};var Ry=class extends pr{template(){return l("div",{class:()=>({"dcg-braille-io-keypad-container":!0,"dcg-has-background-color":this.controller.hasBackgroundColor()}),children:x("div",{class:Nc.const("dcg-braille-io-keypad"),children:[x("div",{class:Nc.const("dcg-braille-description"),children:[l("div",{class:Nc.const("dcg-braille-title"),children:()=>this.controller.s("basic-calculator-text-braille-mode-is-on",{mode:this.brailleType()})}),l("div",{class:Nc.const("dcg-braille-info-text"),children:()=>this.controller.s("basic-calculator-text-how-to-type-braille")}),l("div",{class:Nc.const("dcg-btn-blue"),role:Nc.const("button"),tabIndex:Nc.const(0),onTap:()=>this.controller.dispatch({type:"set-braille-mode",mode:"none"}),children:()=>this.controller.s("basic-calculator-button-turn-braille-mode-off",{mode:this.brailleType()})})]}),x("div",{class:Nc.const("dcg-braille-examples-table-container"),children:[x("table",{class:Nc.const("dcg-braille-examples-table"),children:[x("tr",{children:[l("th",{children:()=>this.controller.s("basic-calculator-heading-braille-table-type-this")}),l("th",{children:()=>this.brailleType()}),l("th",{children:()=>this.controller.s("basic-calculator-heading-braille-table-typeset")})]}),l(nS,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("2+2")}),l(nS,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("\\frac{1}{2}")}),l(nS,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("\\sqrt{4}")})]}),l("div",{class:Nc.const("dcg-more-examples-link"),children:l("a",{href:()=>"https://www.desmos.com/braille-examples?"+this.controller.getBrailleMode(),target:Nc.const("_blank"),children:()=>this.controller.s("basic-calculator-link-view-braille-examples")})})]})]})})}brailleType(){return this.controller.getBrailleMode()==="nemeth"?"Nemeth":this.controller.getBrailleMode()==="ueb"?"UEB":""}};var au=__dcg_shared_module_exports__['e'](j());var DV=__dcg_shared_module_exports__['e'](j());var Fd=class extends ky{template(){return l("div",{class:DV.const("dcg-keypad-control-bar dcg-do-not-blur"),role:DV.const("group"),"aria-label":()=>this.controller.s("shared-calculator-narration-keypad-controlbar"),children:l("div",{class:DV.const("dcg-keypad-control-bar-contents"),children:this.props.children})})}};var AV=__dcg_shared_module_exports__['e'](j()),vo=class extends AV.View{template(){return l("div",{class:()=>({"dcg-keypad-control-btn":!0,"dcg-disabled":this.isDisabled(),"dcg-selected":!this.isDisabled()&&this.isSelected(),"dcg-selectable-btn":!this.isDisabled()&&this.isSelectable(),"dcg-narrow-control-btn":this.props.narrowButton&&this.props.narrowButton()}),didMount:this.bindFn(this.didDivMount),role:AV.const("button"),"aria-disabled":()=>this.isDisabled()||void 0,"aria-label":()=>this.getAriaLabel(),"dcg-command":this.props.command,onTap:this.bindFn(this.handleTap),"aria-pressed":()=>!this.hasPopup()&&!this.isDisabled()&&this.isSelectable()?this.isSelected():void 0,"aria-expanded":()=>this.hasPopup()&&!this.isDisabled()?this.isSelected():void 0,tabIndex:this.bindFn(this.getTabIndex),children:this.props.children})}getTabIndex(){if(!this.isDisabled())return this.props.ignoreInTabOrder&&this.props.ignoreInTabOrder()?-1:0}handleTap(e){this.isDisabled()||this.props.onTap(e)}getAriaLabel(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()}hasPopup(){var e,t;return!!((t=(e=this.props).ariaPopup)!=null&&t.call(e))}isDisabled(){var e,t;return!!((t=(e=this.props).disabled)!=null&&t.call(e))}isSelected(){var e,t;return!!((t=(e=this.props).selected)!=null&&t.call(e))}isSelectable(){var e,t;return!!((t=(e=this.props).selectable)!=null&&t.call(e))}didDivMount(e){this.props.didMount&&this.props.didMount(e)}};var nu=__dcg_shared_module_exports__['e'](j());var aS=__dcg_shared_module_exports__['e'](j());function Oke(){if(!UE)return!1;let r=navigator.userAgent.match(/Version\/(\d+)/);return!r||!r[1]?!1:parseFloat(r[1])<11}function vie(){return!uz&&!Oke()&&typeof document.createElement("a").download!="undefined"}function LV(){return vie()||navigator.msSaveBlob!==void 0}var tf=class extends aS.View{init(){this.supportsDirectDownload=vie()}template(){return x("a",{role:aS.const("button"),tabIndex:()=>this.props.enabled()?0:-1,"aria-disabled":()=>this.props.enabled()?void 0:!0,class:()=>{var e,t,o,i,n,a;return{"dcg-download-button":!0,"dcg-btn-blue":((t=(e=this.props).buttonType)==null?void 0:t.call(e))==="primary","dcg-btn-blue-outline":((i=(o=this.props).buttonType)==null?void 0:i.call(o))==="secondary","dcg-primary-link":((a=(n=this.props).buttonType)==null?void 0:a.call(n))==="link","dcg-disabled":!this.props.enabled()}},didMount:this.bindFn(this.didMountDownload),didUnmount:this.bindFn(this.didUnmountDownload),didUpdate:this.bindFn(this.didUpdate),download:()=>this.supportsDirectDownload?this.props.filename():void 0,onTap:e=>{var o,i;if((i=(o=this.props).triggerLogEvent)==null||i.call(o),this.supportsDirectDownload||!navigator.msSaveOrOpenBlob)return;let t=this.props.data();t&&(navigator.msSaveOrOpenBlob(t,this.props.filename()),e.preventDefault())},children:[l("i",{class:aS.const("dcg-icon-download"),"aria-hidden":aS.const("true")}),l("span",{children:()=>this.props.text()})]})}didMountDownload(e){this.downloadLink=e,this.didUpdate()}didUnmountDownload(){this.revokeBlobURL()}didUpdate(){this.updateDownloadURL(),this.cachedObjectURL&&(this.downloadLink.href=this.cachedObjectURL)}updateDownloadURL(){if(this.revokeBlobURL(),!this.supportsDirectDownload)return;let e=this.props.data();e&&(this.cachedObjectURL=URL.createObjectURL(e))}revokeBlobURL(){this.cachedObjectURL&&URL.revokeObjectURL(this.cachedObjectURL)}};Ut();function Rke(r,e,t=!1){if(__dcg_shared_module_exports__['Ke'](r)==="text")return Ma(r,e,t);let o=__dcg_shared_module_exports__['Le'](r),i="";return o.forEach(n=>{__dcg_shared_module_exports__['Ke'](n)==="latex"?i+=Ma(n.slice(1,-1),e,t):i+=n.replace(/ /g,"| ")}),i}function Ma(r,e,t=!1){if(t&&(r=r.replace(/ /g,"\\ ")),e==="none")return r;let o=e==="nemeth"?nh(r):ah(r);return o.isError?"":ma.toBrailleAscii(o.value)}function wie(r,e){if(e==="none")return"";let t=[];t.push(Ma("Expression List",e,!0)),t.push(""),t.push("");let o="",i=r.getItemCount();for(let n=0;n<i;n++){let a=r.getItemModelByIndex(n);if(a&&!a.secret){o!==""&&a.type!=="folder"&&o!==a.folderId&&(t.push($C(Ma("End Folder",e,!0))),o="");let s="";switch(a.type){case"expression":if(!a.hidden){let d=kie(a.displayIndex,e);Lk.evaluation(r,a)?t.push(`${d}  ${Ma(`${a.latex}${lU("evaluation",r,a)}`,e,!1)}`):t.push(`${d}  ${Ma(a.latex,e,!1)}`);let p=!1;dA.forEach(u=>{if(u!=="evaluation"&&Lk[u](r,a)){let g=lU(u,r,a).map(h=>Rke(h,e,!1));g.length>0&&(p=!0),t.push(...g)}}),p&&t.push("")}break;case"text":t.push(Ma(a.text,e,!0));break;case"folder":a.collapsed?s=`Collapsed Folder ${a.title}`:(s=`Start Folder ${a.title}`,o=a.id),t.push($C(Ma(s,e,!0)));break;case"image":t.push(Ma("Image",e,!1));break;case"table":t.push($C(Ma("Start Table",e,!0)));for(let d=0;d<Xn(a);d++){let p=[],u;for(let h=0;h<Qf(a);h++)d===0?u=a.columnModels[h].latex||"":u=v0(a,d-1,h),p.push(Ma(u,e));let g=p.join("	");/^\t/.test(g)||t.push(g)}t.push($C(Ma("End Table",e,!0)));break;default:return a}}}return o!==""&&t.push($C(Ma("End Folder",e,!0))),(t.slice(-1)[0]===""?t.slice(0,-1):t).join(`
`)}function Sie(r,e){if(e==="none")return"";let t=[];t.push(Ma("Expression List",e,!0)),t.push(""),t.push("");for(let o of r.getExpressionOrder()){let i=kie(""+(r.getExpressionIndex(o)+1),e),n=r.getExpressionLatex(o),a=r.getExpressionValue(o);a!==void 0&&(n+=`=${a}`),t.push(`${i}  ${Ma(n,e,!1)}`)}return t.join(`
`)}function $C(r){let e="--------------------";return`${e}
${r}
${e}`}function kie(r,e){return e==="nemeth"?`${Ma(r,e,!1)}_4`:e==="ueb"?Ma(`${r}.`,e,!1):""}var{If:JC}=nu.Components,PV=class extends pr{template(){return l("div",{class:()=>({"dcg-settings-dropdown":!0,"dcg-popover":!0,"dcg-point-left":this.controller.containerSize.height<=420}),role:nu.const("region"),"aria-label":nu.const("Settings Menu"),didMount:this.bindFn(this.didMountSettingsDropdown),didUnmount:this.bindFn(this.didUnmountSettingsDropdown),children:x("div",{class:nu.const("dcg-popover-interior"),children:[l("div",{class:()=>({"dcg-settings-menu-option":!0,"dcg-displaysize-container":!0}),children:l(ar,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size"),staticConfig:this.bindFn(this.getProjectorModeOptions)})}),l(ft,{onChange:this.bindFn(this.onToggleInvertedColors),checked:()=>this.controller.getInvertedColors(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-reverse-contrast"),children:l("span",{class:nu.const("dcg-checkbox-label"),children:()=>this.controller.s("basic-calculator-label-reverse-contrast")})}),l(JC,{predicate:()=>this.controller.getBrailleControls(),children:()=>x("div",{children:[l(ft,{onChange:this.bindFn(this.onToggleBrailleMode),checked:()=>this.controller.renderAsBraille(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-braille-mode"),children:l("span",{class:nu.const("dcg-checkbox-label"),children:()=>this.controller.s("shared-calculator-narration-braille-mode")})}),l(JC,{predicate:()=>this.controller.renderAsBraille(),children:()=>x("div",{class:()=>({"dcg-settings-menu-option":!0,"dcg-braille-container":!0}),children:[l(Fm,{showBrailleNote:this.const(!1),controller:this.props.controller}),l("div",{class:nu.const("dcg-braille-options-container"),children:l(JC,{predicate:()=>!jn&&LV()&&this.controller.getBrailleExpressionDownload(),children:()=>l(tf,{data:()=>{let e=Sie(this.model,this.controller.getBrailleMode());return new Blob([e],{type:"text/plain"})},enabled:this.const(!0),filename:this.const("desmos-equations.brl"),text:()=>this.controller.s("basic-calculator-link-download-braille-equations"),buttonType:this.const("link")})})})]})})]})}),l(JC,{predicate:()=>this.controller.isComplexModeAllowed(),children:()=>l(Nm,{controller:this.props.controller,isComplexModeEnabled:()=>this.controller.isComplexModeEnabled(),toggleComplexMode:this.bindFn(this.onToggleComplexMode),product:this.const("scientific")})}),l(JC,{predicate:()=>!!this.getVersionNumber(),children:()=>x("div",{class:nu.const("dcg-version-number"),children:["Version: ",()=>this.getVersionNumber()]})})]})})}getProjectorModeOptions(){return[{key:"default",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-default"),class:()=>"dcg-displaysize-default",selected:()=>!this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!1)},{key:"large",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-large"),class:()=>"dcg-displaysize-large",selected:()=>this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!0)}]}onSelectProjectorModeOption(e){this.controller.dispatch({type:"update-projector-mode",mode:e})}getVersionNumber(){let e=window;if(e&&e.AppBridge)return e.AppBridge.versionNumber}didUnmountSettingsDropdown(){re(document).off(".dcg-settings-view")}didMountSettingsDropdown(e){this.settingsGroupNode=e,re(document).on("dcg-tapstart.dcg-settings-view",t=>{t.target.closest(".dcg-basic-settings-container")||this.controller.dispatch({type:"close-settings-menu"})}),re(document).on("keydown.dcg-settings-view",t=>{if(Pe(t)==="Esc"&&(this.controller.dispatch({type:"close-settings-menu"}),this.controller.dispatch({type:"focus-last-expression"})),Pe(t)==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let o=document.activeElement,i=this.props.settingsButtonNode(),n=[...this.settingsGroupNode.querySelectorAll(".dcg-settings-menu-option")].slice(-1)[0];!t.shiftKey&&o===n?(i.focus(),t.preventDefault(),t.stopPropagation()):t.shiftKey&&o===i&&(n.focus(),t.preventDefault(),t.stopPropagation())}})}onToggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.renderAsBraille()?"none":"nemeth"})}onToggleInvertedColors(){let e=!this.controller.getInvertedColors();this.controller.dispatch({type:"update-inverted-colors",mode:e})}onToggleComplexMode(){this.controller.dispatch({type:"toggle-complex-mode",enabled:!this.controller.isComplexModeEnabled()})}getProjectorMode(){return this.controller.isProjectorMode()}};var sS=__dcg_shared_module_exports__['e'](j());var{If:Fke}=sS.Components,lS=class extends pr{template(){let r=this.props.controller();return x("div",{class:sS.const("dcg-basic-settings-container"),children:[l(vo,{didMount:e=>this.settingsButtonNode=e,command:this.const("settings"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-settings"),onTap:this.bindFn(this.onToggleSettingsMenu),selected:()=>this.controller.isSettingsMenuOpen(),ariaPopup:this.const(!0),children:l("i",{class:sS.const("dcg-icon-wrench"),"aria-hidden":sS.const("true")})}),l(Fke,{predicate:()=>this.controller.isSettingsMenuOpen(),children:()=>l(PV,{controller:this.props.controller,settingsButtonNode:()=>this.settingsButtonNode})})]})}onToggleSettingsMenu(){this.controller.dispatch({type:"toggle-settings-menu"})}};var{If:ZC,IfElse:Nke}=au.Components,GV=class extends pr{template(){let r=this.props.controller();return x(Fd,{controller:this.props.controller,children:[l(ZC,{predicate:()=>this.showUndoRedo(),children:()=>l(vo,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"}),children:l("i",{class:au.const("dcg-icon-undo"),"aria-hidden":au.const("true")})})}),l(ZC,{predicate:()=>this.showUndoRedo(),children:()=>l(vo,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"}),children:l("i",{class:au.const("dcg-icon-redo"),"aria-hidden":au.const("true")})})}),Nke(()=>r.shouldShowClear(),{true:()=>l(vo,{command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"}),children:()=>r.s("basic-calculator-button-controlbar-clear")}),false:()=>l(vo,{command:this.const("clearall"),disabled:()=>!r.canClear(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear-all"),onTap:()=>r.dispatch({type:"set-blank",opts:{allowUndo:!0}}),children:()=>r.s("basic-calculator-button-controlbar-clear-all")})}),l(ZC,{predicate:()=>!this.showUndoRedo(),children:()=>l("div",{class:au.const("dcg-spacer-2")})}),l(ZC,{predicate:()=>r.getBrailleMode()==="none",children:()=>l(vo,{command:this.const("backspace"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-backspace"),disabled:()=>!r.canBackspace(),onTap:()=>r.dispatch({type:"keypad/press-key",key:"Backspace",source:"keypad"}),children:l("i",{class:au.const("dcg-icon-delete"),"aria-hidden":au.const("true")})})}),l(ZC,{predicate:()=>this.props.controller().getSettingsMenu(),children:()=>l(lS,{controller:this.props.controller})})]})}showUndoRedo(){return!(this.controller.getRestrictedEditing()||this.controller.getDisableParentheses())}onToggleSettingsMenu(){this.controller.dispatch({type:"toggle-settings-menu"})}};var VV=__dcg_shared_module_exports__['e'](j());var{Switch:Cie}=VV.Components,QC=class extends pr{template(){return l("div",{role:VV.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad"),children:x(Pr,{controller:this.props.controller,children:[x(ot,{children:[l(Cie,{children:e=>{switch(e){case"parens":return R(this,"(",{colspan:this.parenColspan()});case"undoredo":return R(this,"undo",{colspan:this.parenColspan(),disabled:()=>!this.controller.canUndo()});case"none":return Zr(this.parenColspan())}}},this.bindFn(this.getTopLeftButtons)),l(Cie,{children:e=>{switch(e){case"parens":return R(this,")",{colspan:this.parenColspan()});case"undoredo":return R(this,"redo",{colspan:this.parenColspan(),disabled:()=>!this.controller.canRedo()});case"none":return Zr(this.parenColspan())}}},this.bindFn(this.getTopLeftButtons)),this.makeAdditionalFunctionKey(0),this.makeAdditionalFunctionKey(1),R(this,"division")]}),x(ot,{children:[R(this,"7",{style:"highlight"}),R(this,"8",{style:"highlight"}),R(this,"9",{style:"highlight"}),R(this,"multiplication")]}),x(ot,{children:[R(this,"4",{style:"highlight"}),R(this,"5",{style:"highlight"}),R(this,"6",{style:"highlight"}),R(this,"-")]}),x(ot,{children:[R(this,"1",{style:"highlight"}),R(this,"2",{style:"highlight"}),R(this,"3",{style:"highlight"}),R(this,"+")]}),x(ot,{children:[R(this,"0",{style:"highlight"}),R(this,".",{style:"highlight"}),R(this,"ans"),R(this,"enter",{style:"blue"})]})]})})}getTopLeftButtons(){return this.showParens()?"parens":this.controller.getRestrictedEditing()?"none":"undoredo"}showParens(){return!this.controller.getDisableParentheses()}parenColspan(){return this.controller.getAdditionalFunctions().length>1?.5:1}makeAdditionalFunctionKey(e){let t=this.controller.getAdditionalFunctions()[e];return t==="exponent"?R(this,"a^b"):t==="percent"?R(this,"%"):t==="sqrt"?R(this,"sqrt"):t==="fraction"?R(this,"a/b"):void 0}};var Fy=__dcg_shared_module_exports__['e'](j());var{If:SB,IfElse:Uke}=Fy.Components,OV=class extends pr{template(){let r=this.props.controller();return x(Fd,{controller:this.props.controller,children:[l(vo,{command:this.const("main"),selected:()=>r.getKeyboardMode()==="main",disabled:()=>this.controller.renderAsBraille(),selectable:this.const(!0),onTap:()=>r.dispatch({type:"main"}),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-main"),children:()=>r.s("basic-calculator-button-controlbar-main")}),l(vo,{command:this.const("ABC"),selected:()=>["qwerty","capitalQwerty","letters"].indexOf(r.getKeyboardMode())!==-1,disabled:()=>this.controller.renderAsBraille(),selectable:this.const(!0),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-abc"),onTap:()=>r.dispatch({type:"ABC"}),children:()=>r.s("basic-calculator-button-controlbar-abc")}),l(vo,{command:this.const("functions"),selected:()=>["functions","restrictedFunctions"].indexOf(r.getKeyboardMode())!==-1,ariaLabel:()=>r.s("basic-calculator-narration-controlbar-functions"),disabled:()=>this.controller.renderAsBraille(),selectable:this.const(!0),onTap:()=>r.dispatch({type:"functions"}),children:()=>r.s("basic-calculator-button-controlbar-func")}),l(Vc,{setup:this.const({type:"basic",controller:this.controller})}),l(SB,{predicate:()=>!this.controller.getRestrictedEditing(),children:()=>l(vo,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"}),children:l("i",{class:Fy.const("dcg-icon-undo"),"aria-hidden":Fy.const("true")})})}),l(SB,{predicate:()=>!this.controller.getRestrictedEditing(),children:()=>l(vo,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"}),children:l("i",{class:Fy.const("dcg-icon-redo"),"aria-hidden":Fy.const("true")})})}),Uke(()=>r.shouldShowClear(),{true:()=>l(vo,{command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"}),children:()=>r.s("basic-calculator-button-controlbar-clear")}),false:()=>l(vo,{command:this.const("clearall"),disabled:()=>!r.canClear(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear-all"),onTap:()=>r.dispatch({type:"set-blank",opts:{allowUndo:!0}}),children:()=>r.s("basic-calculator-button-controlbar-clear-all")})}),l(SB,{predicate:()=>this.props.controller().getSettingsMenu(),children:()=>l(lS,{controller:this.props.controller})})]})}};var RV=__dcg_shared_module_exports__['e'](j());var eT=class extends pr{template(){return x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"A"),R(this,"B"),R(this,"C"),R(this,"D"),R(this,"E"),R(this,"F"),R(this,"G"),R(this,"H"),R(this,"I"),R(this,"J")]}),x(ot,{children:[R(this,"K"),R(this,"L"),R(this,"M"),R(this,"N"),R(this,"O"),R(this,"P"),R(this,"Q"),R(this,"R"),R(this,"S"),R(this,"T")]}),x(ot,{children:[R(this,"=",{style:"highlight"}),R(this,","),R(this,"U"),R(this,"V"),R(this,"W"),R(this,"X"),R(this,"Y"),R(this,"Z"),R(this,"pi"),R(this,"backspace",{style:"highlight"})]}),x(ot,{children:[R(this,"shift",{style:"highlight",colspan:2}),R(this,"("),R(this,")"),R(this,"["),R(this,"]"),R(this,"!"),R(this,"'"),R(this,"enter",{style:"blue",colspan:2})]})]})}};var kB=__dcg_shared_module_exports__['e'](j());var tT=class extends pr{template(){return x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"Q"),R(this,"W"),R(this,"E"),R(this,"R"),R(this,"T"),R(this,"Y"),R(this,"U"),R(this,"I"),R(this,"O"),R(this,"P")]}),x(ot,{children:[l("div",{class:kB.const("dcg-half-width-placeholder")}),R(this,"A"),R(this,"S"),R(this,"D"),R(this,"F"),R(this,"G"),R(this,"H"),R(this,"J"),R(this,"K"),R(this,"L"),l("div",{class:kB.const("dcg-half-width-placeholder")})]}),x(ot,{children:[R(this,"=",{style:"highlight"}),R(this,"Z"),R(this,"X"),R(this,"C"),R(this,"V"),R(this,"B"),R(this,"N"),R(this,"M"),R(this,","),R(this,"backspace",{style:"highlight"})]}),x(ot,{children:[R(this,"shift",{style:"highlight",colspan:1.5}),R(this,"("),R(this,")"),R(this,"["),R(this,"]"),R(this,"!"),R(this,"'"),R(this,"pi"),R(this,"enter",{style:"blue",colspan:1.5})]})]})}};var rf=__dcg_shared_module_exports__['e'](j());var{IfElse:Yke}=rf.Components,rT=class extends pr{template(){return l("div",{class:rf.const("dcg-sci-func-keypad"),children:x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"sin"),R(this,"cos"),R(this,"tan"),l("div",{class:rf.const("dcg-partition-placeholder")}),R(this,"a^b"),R(this,"sqrt"),R(this,"nthroot")]}),x(ot,{children:[R(this,"arcsin"),R(this,"arccos"),R(this,"arctan"),l("div",{class:rf.const("dcg-partition-placeholder")}),R(this,"e^x"),R(this,"abs"),Yke(()=>this.controller.getReplaceRoundWithReciprocal(),{true:()=>R(this,"a^{-1}"),false:()=>R(this,"round")})]}),x(ot,{children:[R(this,"mean"),R(this,"stdev"),R(this,"stdevp"),l("div",{class:rf.const("dcg-partition-placeholder")}),R(this,"ln"),R(this,"log"),R(this,"backspace",{style:"highlight"})]}),x(ot,{children:[R(this,"nPr"),R(this,"nCr"),R(this,"!"),l("div",{class:rf.const("dcg-partition-placeholder")}),R(this,"e"),R(this,"pi"),R(this,"enter",{style:"blue"})]})]})})}};var of=__dcg_shared_module_exports__['e'](j());var{IfElse:Bke}=of.Components,oT=class extends pr{template(){return l("div",{class:of.const("dcg-sci-func-keypad dcg-sci-func-keypad--complex"),children:x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"sin"),R(this,"cos"),R(this,"tan"),l("div",{class:of.const("dcg-partition-placeholder")}),R(this,"%"),R(this,"pi"),R(this,"e"),R(this,"e^x")]}),x(ot,{children:[R(this,"arcsin"),R(this,"arccos"),R(this,"arctan"),l("div",{class:of.const("dcg-partition-placeholder")}),R(this,"real"),R(this,"imag"),R(this,"conj"),R(this,"arg")]}),x(ot,{children:[R(this,"mean"),R(this,"stdev"),R(this,"stdevp"),l("div",{class:of.const("dcg-partition-placeholder")}),R(this,"ln"),R(this,"log"),R(this,"sqrt"),R(this,"backspace",{style:"highlight"})]}),x(ot,{children:[R(this,"nPr"),R(this,"nCr"),R(this,"!"),l("div",{class:of.const("dcg-partition-placeholder")}),R(this,"abs"),Bke(()=>this.controller.getReplaceRoundWithReciprocal(),{true:()=>R(this,"a^{-1}"),false:()=>R(this,"round")}),R(this,"nthroot"),R(this,"enter",{style:"blue"})]})]})})}};var Nd=__dcg_shared_module_exports__['e'](j());var{IfElse:Tie}=Nd.Components,iT=class extends pr{template(){return x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"a^2"),R(this,"a^b"),R(this,"|a|"),l("div",{class:Nd.const("dcg-partition-placeholder")}),R(this,"7",{style:"highlight"}),R(this,"8",{style:"highlight"}),R(this,"9",{style:"highlight"}),R(this,"division"),l("div",{class:Nd.const("dcg-partition-placeholder")}),Tie(()=>{var e,t;return(t=(e=this.controller).isComplexModeEnabled)==null?void 0:t.call(e)},{true:()=>R(this,"i"),false:()=>R(this,"%")}),R(this,"a/b")]}),x(ot,{children:[R(this,"sqrt"),R(this,"nthroot"),R(this,"pi"),l("div",{class:Nd.const("dcg-partition-placeholder")}),R(this,"4",{style:"highlight"}),R(this,"5",{style:"highlight"}),R(this,"6",{style:"highlight"}),R(this,"multiplication"),l("div",{class:Nd.const("dcg-partition-placeholder")}),R(this,"left",{style:"highlight"}),R(this,"right",{style:"highlight"})]}),x(ot,{children:[R(this,"sin"),R(this,"cos"),R(this,"tan"),l("div",{class:Nd.const("dcg-partition-placeholder")}),R(this,"1",{style:"highlight"}),R(this,"2",{style:"highlight"}),R(this,"3",{style:"highlight"}),R(this,"-"),l("div",{class:Nd.const("dcg-partition-placeholder")}),Zr(.5),R(this,"backspace",{style:"highlight",colspan:1.5})]}),x(ot,{children:[R(this,"("),R(this,")"),Tie(()=>this.controller.getReplaceCommaWith10Exp(),{true:()=>R(this,"10^n"),false:()=>R(this,",")}),l("div",{class:Nd.const("dcg-partition-placeholder")}),R(this,"0",{style:"highlight"}),R(this,".",{style:"highlight"}),R(this,"ans"),R(this,"+"),l("div",{class:Nd.const("dcg-partition-placeholder")}),R(this,"enter",{style:"blue",colspan:2})]})]})}};var nT=class extends pr{template(){return x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"a"),R(this,"b"),R(this,"c"),R(this,"d"),R(this,"e"),R(this,"f"),R(this,"g"),R(this,"h"),R(this,"i"),R(this,"j")]}),x(ot,{children:[R(this,"k"),R(this,"l"),R(this,"m"),R(this,"n"),R(this,"o"),R(this,"p"),R(this,"q"),R(this,"r"),R(this,"s"),R(this,"t")]}),x(ot,{children:[R(this,"=",{style:"highlight"}),R(this,","),R(this,"u"),R(this,"v"),R(this,"w"),R(this,"x"),R(this,"y"),R(this,"z"),R(this,"pi"),R(this,"backspace",{style:"highlight"})]}),x(ot,{children:[R(this,"shift",{style:"highlight",colspan:2}),R(this,"("),R(this,")"),R(this,"["),R(this,"]"),R(this,"!"),R(this,"'"),R(this,"enter",{style:"blue",colspan:2})]})]})}};var _B=__dcg_shared_module_exports__['e'](j());var aT=class extends pr{template(){return x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"q"),R(this,"w"),R(this,"e"),R(this,"r"),R(this,"t"),R(this,"y"),R(this,"u"),R(this,"i"),R(this,"o"),R(this,"p")]}),x(ot,{children:[l("div",{class:_B.const("dcg-half-width-placeholder")}),R(this,"a"),R(this,"s"),R(this,"d"),R(this,"f"),R(this,"g"),R(this,"h"),R(this,"j"),R(this,"k"),R(this,"l"),l("div",{class:_B.const("dcg-half-width-placeholder")})]}),x(ot,{children:[R(this,"=",{style:"highlight"}),R(this,"z"),R(this,"x"),R(this,"c"),R(this,"v"),R(this,"b"),R(this,"n"),R(this,"m"),R(this,","),R(this,"backspace",{style:"highlight"})]}),x(ot,{children:[R(this,"shift",{style:"highlight",colspan:1.5}),R(this,"("),R(this,")"),R(this,"["),R(this,"]"),R(this,"!"),R(this,"'"),R(this,"pi"),R(this,"enter",{style:"blue",colspan:1.5})]})]})}};var{SwitchUnion:Kke,IfElse:zke}=RV.Components,sT=class extends pr{template(){return l("div",{role:RV.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad"),children:Kke(()=>this.controller.getKeyboardMode(),{qwerty:()=>l(aT,{controller:this.props.controller}),letters:()=>l(nT,{controller:this.props.controller}),capitalQwerty:()=>l(tT,{controller:this.props.controller}),capitalLetters:()=>l(eT,{controller:this.props.controller}),functions:()=>zke(()=>this.controller.isComplexModeEnabled(),{true:()=>l(oT,{controller:this.props.controller}),false:()=>l(rT,{controller:this.props.controller})}),main:()=>l(iT,{controller:this.props.controller})})})}};var su=__dcg_shared_module_exports__['e'](j());var{If:FV}=su.Components,NV=class extends pr{template(){let r=this.props.controller();return x(Fd,{controller:this.props.controller,children:[l(FV,{predicate:()=>!this.controller.getRestrictedEditing(),children:()=>l(vo,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"}),children:l("i",{class:su.const("dcg-icon-undo"),"aria-hidden":su.const("true")})})}),l(FV,{predicate:()=>!this.controller.getRestrictedEditing(),children:()=>l(vo,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"}),children:l("i",{class:su.const("dcg-icon-redo"),"aria-hidden":su.const("true")})})}),l(vo,{command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"}),children:()=>r.s("basic-calculator-button-controlbar-clear")}),l(FV,{predicate:()=>this.controller.getRestrictedEditing(),children:()=>l("div",{class:su.const("dcg-spacer-2")})}),l(FV,{predicate:()=>r.getBrailleMode()==="none",children:()=>l(vo,{command:this.const("backspace"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-backspace"),disabled:()=>!r.canBackspace(),onTap:()=>r.dispatch({type:"keypad/press-key",key:"Backspace",source:"keypad"}),children:l("i",{class:su.const("dcg-icon-delete"),"aria-hidden":su.const("true")})})})]})}};var Eie=__dcg_shared_module_exports__['e'](j());var lT=class extends pr{template(){return l("div",{role:Eie.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad"),children:x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"(",{colspan:this.parenColspan()}),R(this,")",{colspan:this.parenColspan()}),this.makeAdditionalFunctionKey(1)]}),x(ot,{children:[R(this,"7",{style:"highlight"}),R(this,"8",{style:"highlight"}),R(this,"9",{style:"highlight"}),R(this,"division")]}),x(ot,{children:[R(this,"4",{style:"highlight"}),R(this,"5",{style:"highlight"}),R(this,"6",{style:"highlight"}),R(this,"multiplication")]}),x(ot,{children:[R(this,"1",{style:"highlight"}),R(this,"2",{style:"highlight"}),R(this,"3",{style:"highlight"}),R(this,"-")]}),x(ot,{children:[R(this,"0",{style:"highlight"}),R(this,".",{style:"highlight",colspan:this.dotColspan()}),this.makeAdditionalFunctionKey(0),R(this,"+")]})]})})}parenColspan(){return this.controller.getAdditionalFunctions().length===2?1.5:2}dotColspan(){return this.controller.getAdditionalFunctions().length?1:2}makeAdditionalFunctionKey(e){let t=this.controller.getAdditionalFunctions()[e];return t==="exponent"?R(this,"a^b"):t==="percent"?R(this,"%"):t==="sqrt"?R(this,"sqrt"):void 0}};var Ud=__dcg_shared_module_exports__['e'](j());var{If:Iie}=Ud.Components,UV=class extends pr{template(){let r=this.props.controller();return x(Fd,{controller:this.props.controller,children:[l(Vc,{setup:this.const({type:"basic",controller:this.controller})}),l("div",{class:Ud.const("dcg-spacer")}),l(Iie,{predicate:()=>!this.controller.getRestrictedEditing(),children:()=>l(vo,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"}),children:l("i",{class:Ud.const("dcg-icon-undo"),"aria-hidden":Ud.const("true")})})}),l(Iie,{predicate:()=>!this.controller.getRestrictedEditing(),children:()=>l(vo,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"}),children:l("i",{class:Ud.const("dcg-icon-redo"),"aria-hidden":Ud.const("true")})})}),l("div",{class:Ud.const("dcg-spacer")}),l(vo,{narrowButton:this.const(!0),command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"}),children:()=>r.s("basic-calculator-button-controlbar-clear")}),l(vo,{narrowButton:this.const(!0),command:this.const("backspace"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-backspace"),onTap:()=>r.dispatch({type:"keypad/press-key",key:"Backspace",source:"keypad"}),children:l("i",{class:Ud.const("dcg-icon-delete"),"aria-hidden":Ud.const("true")})})]})}};var cS=__dcg_shared_module_exports__['e'](j());var cT=class extends pr{template(){return x(Pr,{controller:this.props.controller,children:[x(ot,{children:[R(this,"("),R(this,")"),R(this,"x^2"),R(this,"sqrt"),l("div",{class:cS.const("dcg-partition-placeholder")}),R(this,"x^3"),R(this,"x^y"),R(this,"ythroot")]}),x(ot,{children:[R(this,"7",{style:"highlight"}),R(this,"8",{style:"highlight"}),R(this,"9",{style:"highlight"}),R(this,"division"),l("div",{class:cS.const("dcg-partition-placeholder")}),R(this,"pi"),R(this,"e^x"),R(this,"!")]}),x(ot,{children:[R(this,"4",{style:"highlight"}),R(this,"5",{style:"highlight"}),R(this,"6",{style:"highlight"}),R(this,"multiplication"),l("div",{class:cS.const("dcg-partition-placeholder")}),R(this,"log"),R(this,"ln"),R(this,"|x|")]}),x(ot,{children:[R(this,"1",{style:"highlight"}),R(this,"2",{style:"highlight"}),R(this,"3",{style:"highlight"}),R(this,"-"),l("div",{class:cS.const("dcg-partition-placeholder")}),R(this,"sin"),R(this,"cos"),R(this,"tan")]}),x(ot,{children:[R(this,"0",{style:"highlight"}),R(this,".",{style:"highlight"}),R(this,"x/y"),R(this,"+"),l("div",{class:cS.const("dcg-partition-placeholder")}),R(this,"arcsin"),R(this,"arccos"),R(this,"arctan")]})]})}};var{If:dT,IfElse:YV}=lu.Components,pT=class extends pr{template(){return l(dT,{predicate:()=>this.controller.shouldRender(),children:()=>l("div",{class:this.const(Tx),style:lu.const("width: 100%; height: 100%; position: relative;"),children:l("div",{class:()=>({"dcg-calc-basic-main-wrapper":!0,"dcg-narrow":this.controller.containerSize.width<570,"dcg-narrower":this.controller.containerSize.width<380,"dcg-short":this.controller.containerSize.height<=540,"dcg-scientific-calculator":this.controller.isScientificCalc(),"dcg-four-function-calculator":this.controller.isFourFunctionCalc(),"dcg-container":!0}),onKeyDown:this.bindFn(this.handleRootKeydown),didMount:this.bindFn(this.didMountRoot),"x-ms-format-detection":lu.const("none"),style:()=>({"--dcg-custom-background-color":this.controller.hasBackgroundColor()?this.controller.getBackgroundColor():void 0,"--dcg-custom-text-color":this.controller.hasTextColor()?this.controller.getTextColor():void 0}),children:x("div",{role:lu.const("application"),"aria-label":()=>this.controller.isScientificCalc()?this.controller.s("basic-calculator-narration-calc-description-scientific"):this.controller.isFourFunctionCalc()?this.controller.s("basic-calculator-narration-calc-description-fourfunction"):"",class:()=>({"dcg-calc-basic-main":!0,"dcg-inverted-colors":this.controller.getInvertedColors(),"dcg-projector-mode":this.controller.isProjectorMode(),"dcg-ipad":ha,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-no-hyperlinks":!this.controller.getAllowLinks()}),style:()=>({"font-size":`${this.controller.getFontSize()}px`,filter:this.controller.getInvertedColors()?"invert(100%)":"none"}),children:[l(XC,{controller:this.props.controller}),l(dT,{predicate:()=>this.controller.isScientificCalc()&&this.model.isSingleExpression(),children:()=>x("div",{children:[l(UV,{controller:this.props.controller}),l("div",{class:lu.const("dcg-basic-keypad-container"),children:YV(()=>this.controller.renderAsBraille(),{true:()=>l(Ry,{controller:this.props.controller}),false:()=>l(cT,{controller:this.props.controller})})})]})}),l(dT,{predicate:()=>this.controller.isScientificCalc()&&!this.model.isSingleExpression(),children:()=>x("div",{children:[l(OV,{controller:this.props.controller}),l("div",{class:lu.const("dcg-basic-keypad-container"),children:YV(()=>this.controller.renderAsBraille(),{true:()=>l(Ry,{controller:this.props.controller}),false:()=>l(sT,{controller:this.props.controller})})})]})}),l(dT,{predicate:()=>this.controller.isFourFunctionCalc()&&this.model.isSingleExpression(),children:()=>x("div",{children:[l(NV,{controller:this.props.controller}),l("div",{class:lu.const("dcg-basic-keypad-container"),children:YV(()=>this.controller.renderAsBraille(),{true:()=>l(Ry,{controller:this.props.controller}),false:()=>l(lT,{controller:this.props.controller})})})]})}),l(dT,{predicate:()=>this.controller.isFourFunctionCalc()&&!this.model.isSingleExpression(),children:()=>x("div",{children:[l(GV,{controller:this.props.controller}),l("div",{class:lu.const("dcg-basic-keypad-container"),children:YV(()=>this.controller.renderAsBraille(),{true:()=>l(Ry,{controller:this.props.controller}),false:()=>l(QC,{controller:this.props.controller})})})]})})]})})})})}didMountRoot(e){jf(e)}handleRootKeydown(e){let t=Jr(e),o=this.controller.model;if(Hf(e))return this.dispatch({type:"undo",source:"keyboard-shortcut"}),!1;if(Wf(e))return this.dispatch({type:"redo",source:"keyboard-shortcut"}),!1;if(e.altKey!==qr&&e.metaKey===qr&&!e.ctrlKey&&e.shiftKey&&t==="A"&&this.controller.getDecimalToFraction()){let i=o.getFocusedExpression();i&&o.canDisplayEvaluationAsFraction(i.id)&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-fraction-evaluation",id:i.id}),this.controller.runAfterDispatch(()=>{o.getFocusedExpression().displayAsFraction?_e(this.controller.s("shared-calculator-narration-show-as-fraction")):_e(this.controller.s("shared-calculator-narration-show-as-decimal"))}))}else if(!e.metaKey&&!e.shiftKey){if(!e.ctrlKey&&!e.altKey&&Pe(e)===Ox){if(!document.activeElement||Hu(document.activeElement))return!1}else if(e.ctrlKey===qr&&e.altKey===!qr)if(t==="N"){if(!this.controller.getBrailleControls())return;if(e.preventDefault(),e.stopPropagation(),this.controller.getBrailleMode()==="nemeth"){this.exitBraille();return}return this.dispatch({type:"set-braille-mode",mode:"nemeth"}),_e(this.controller.s("shared-calculator-narration-hotkey-braille-mode-nemeth")),!1}else if(t==="U"){if(!this.controller.getBrailleControls())return;if(e.preventDefault(),e.stopPropagation(),this.controller.getBrailleMode()==="ueb"){this.exitBraille();return}return this.dispatch({type:"set-braille-mode",mode:"ueb"}),_e(this.controller.s("shared-calculator-narration-hotkey-braille-mode-ueb")),!1}else{if(t==="Q"||t==="X")return this.controller.getBrailleControls()?(e.preventDefault(),e.stopPropagation(),this.exitBraille(),!1):void 0;if(t==="6"){if(!this.controller.getBrailleControls())return;let i=!this.controller.getSixKeyInput();return this.dispatch({type:"set-six-key-input",useSixKeyInput:i}),_e(i?this.controller.s("basic-calculator-narration-hotkey-six-key-input-on"):this.controller.s("basic-calculator-narration-hotkey-six-key-input-off")),!1}else if(t==="D")return this.controller.isScientificCalc()?(e.preventDefault(),this.controller.dispatch({type:"degrees"}),_e(o.getDegreeMode()?this.controller.s("basic-calculator-narration-controlbar-degrees"):this.controller.s("basic-calculator-narration-controlbar-radians")),!1):void 0}}return!0}exitBraille(){this.dispatch({type:"set-braille-mode",mode:"none"}),_e(this.controller.s("shared-calculator-narration-hotkey-braille-mode-off"))}};var pS=__dcg_shared_module_exports__['e'](j());var uT=class{constructor(e){this.eventModel=new Pi;if(this.rootElt=e,!e)throw new Error("must pass an HTMLElement to the API")}setupDomChangeDetector(e){this.autoSize=e,wG(this.rootElt),this.domChangeDetector=new Xb(this.rootElt,t=>{switch(t.type){case"added":this.view=this.onCreateView(),this.onResizeView(t.size);break;case"removed":this.onDestroyView(),this.view=void 0;break;case"resized":this.onResizeView(t.size);break}}),this.autoSize!==!1?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges()}detach(){__dcg_shared_module_exports__['Be'].warn(".detach() is deprecated. It should no longer be necessary")}destroy(){this.view&&this.onDestroyView(),this.domChangeDetector.destroy();function e(i){__dcg_shared_module_exports__['Be'].warn("You've destroyed this API instance. You can no longer call ."+i+"()")}let t={},o=this;for(;o;)Object.getOwnPropertyNames(o).forEach(n=>t[n]=!0),o=Object.getPrototypeOf(o);for(let i in t)typeof this[i]=="function"?this[i]=e.bind(this,i):this.hasOwnProperty(i)&&delete this[i];this.destroy=function(){}}resize(){this.domChangeDetector.checkForChanges()}updateView(){this.view&&document.body&&document.body.contains(this.rootElt)&&this.view.update()}triggerEvent(e,t){this.eventModel.triggerEvent(e,t)}observeEvent(e,t){this.eventModel.observeEvent(e,t)}unobserveEvent(e){this.eventModel.unobserveEvent(e)}};var qke={allowComplex:!0,autosize:!0,backgroundColor:"#fff",brailleControls:!0,brailleExpressionDownload:!0,brailleMode:"none",capExpressionSize:!1,complex:!1,decimalToFraction:!0,degreeMode:!1,functionDefinition:!0,invertedColors:!1,language:"en",links:!0,projectorMode:!1,qwertyKeyboard:!0,replaceCommaWith10Exp:!1,replaceRoundWithReciprocal:!1,settingsMenu:!0,sixKeyInput:!1,textColor:"#000"};Cx();var Hke={additionalFunctions:["sqrt"],disableParentheses:!1,evaluationMode:"scientific",restrictedEditing:!1,typingAsteriskWritesTimesSymbol:!1,typingSlashWritesDivisionSymbol:!1},Wke=["allowComplex","backgroundColor","brailleControls","brailleExpressionDownload","brailleMode","capExpressionSize","complex","decimalToFraction","degreeMode","functionDefinition","invertedColors","language","links","projectorMode","qwertyKeyboard","replaceCommaWith10Exp","replaceRoundWithReciprocal","settingsMenu","sixKeyInput","textColor","restrictedEditing","typingAsteriskWritesTimesSymbol","fontSize"];Cx();var dS=class extends uT{constructor(e){super(e)}init(e){e=__dcg_shared_module_exports__['f'](e),e.backgroundColor&&!__dcg_shared_module_exports__['rd'](e.backgroundColor)&&(__dcg_shared_module_exports__['Be'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete e.backgroundColor),e.textColor&&!__dcg_shared_module_exports__['rd'](e.textColor)&&(__dcg_shared_module_exports__['Be'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete e.textColor),e.allowComplex||(e.complex&&__dcg_shared_module_exports__['Be'].warn("complex: true is not compatible with allowComplex: false. Forcing complex: false"),delete e.complex),e.complex&&e.degreeMode&&(__dcg_shared_module_exports__['Be'].warn("degreeMode: true is not compatible with complex: true. Forcing degreeMode: false"),delete e.degreeMode);let t={...Hke,...qke,...e};this.settings=new Ds;let o={workerPool:tS,settingsProxy:this.settings};this.controller=new WC(t,o),this.controller.onEventEmitted=i=>{i==="render"&&this.updateView(),this.triggerEvent(i,void 0)},this.setupDomChangeDetector(t.autosize)}onCreateView(){return pS.mountToNode(pT,this.rootElt,{controller:pS.const(this.controller)})}setState(e,t){t||(t={}),!this.controller.isComplexModeAllowed()&&e.settings.complex&&(e={...e,settings:{...e.settings,complex:!1}}),this.controller.dispatch({type:"set-state-from-api",state:e,opts:{allowUndo:!!t.allowUndo}})}getState(){return __dcg_shared_module_exports__['f'](this.controller.model.getPersistedState())}undo(){this.controller.dispatch({type:"undo",source:"api"})}redo(){this.controller.dispatch({type:"redo",source:"api"})}clearHistory(){this.controller.dispatch({type:"clear-history"})}setBlank(e){e||(e={}),this.controller.dispatch({type:"set-blank",opts:{allowUndo:!!e.allowUndo}})}updateSettings(e){e=__dcg_shared_module_exports__['f'](e),(!e.allowComplex&&!this.controller.isComplexModeAllowed()||this.controller.getEvaluationMode()!=="scientific")&&(delete e.complex,delete e.allowComplex);for(let t of Wke)if(t in e)switch(t){case"fontSize":let o=e[t];if(o===void 0)continue;this.controller.dispatch({type:"update-font-size",size:o});break;case"invertedColors":let i=e[t];if(i===void 0)continue;this.controller.dispatch({type:"update-inverted-colors",mode:i});break;case"backgroundColor":let n=e[t];if(n===void 0||!__dcg_shared_module_exports__['rd'](n)){__dcg_shared_module_exports__['Be'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)");continue}this.controller.dispatch({type:"update-background-color",color:n});break;case"textColor":let a=e[t];if(a===void 0||!__dcg_shared_module_exports__['rd'](a)){__dcg_shared_module_exports__['Be'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)");continue}this.controller.dispatch({type:"update-text-color",color:a});break;case"degreeMode":let s=e[t];if(s===void 0)continue;this.controller.dispatch({type:"update-degree-mode",mode:s});break;case"brailleMode":let c=e[t];this.controller.dispatch({type:"set-braille-mode",mode:c});break;case"sixKeyInput":let d=e[t];if(d===void 0)continue;this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:d});break;case"brailleControls":{let _=e[t];if(_===void 0)continue;this.controller.dispatch({type:"set-braille-controls",value:_});break}case"brailleExpressionDownload":let p=e[t];if(p===void 0)continue;this.controller.dispatch({type:"set-braille-expression-download",mode:p});break;case"projectorMode":let u=e[t];if(u===void 0)continue;this.controller.dispatch({type:"update-projector-mode",mode:u});break;case"capExpressionSize":let g=e[t];if(g===void 0)continue;this.controller.dispatch({type:"update-cap-expression-size",mode:g});break;case"language":let h=e[t];if(h===void 0)continue;this.controller.dispatch({type:"update-language",language:Yp(h)});break;case"settingsMenu":e.settingsMenu?this.controller.dispatch({type:"enable-settings-menu"}):this.controller.dispatch({type:"disable-settings-menu"});break;case"qwertyKeyboard":{this.controller.dispatch({type:"update-options",options:{qwertyKeyboard:!!e.qwertyKeyboard}});let _=this.controller.getKeyboardMode();(_==="qwerty"||_==="letters")&&this.controller.dispatch({type:"ABC"})}break;case"functionDefinition":e.functionDefinition?this.controller.model.enableFunctionDefinition():this.controller.model.disableFunctionDefinition();break;case"links":this.controller.dispatch({type:"update-options",options:{links:!!e.links}});break;case"decimalToFraction":let b=e[t];if(b===void 0)continue;this.controller.dispatch({type:"update-decimal-to-fraction",mode:b});break;case"replaceCommaWith10Exp":let v=e[t];if(v===void 0)continue;this.controller.dispatch({type:"set-replace-comma-with-10-exp",replace:v});break;case"replaceRoundWithReciprocal":let T=e[t];if(T===void 0)continue;this.controller.dispatch({type:"set-replace-round-with-reciprocal",replace:T});break;case"restrictedEditing":{this.controller.dispatch({type:"update-options",options:{restrictedEditing:!!e.restrictedEditing}});break}case"typingAsteriskWritesTimesSymbol":let E=e[t];if(E===void 0)continue;this.controller.dispatch({type:"set-typing-asterisk-writes-times-symbol",mode:E});break;case"allowComplex":this.controller.dispatch({type:"toggle-complex-allowed",enabled:!!e[t]});break;case"complex":this.controller.dispatch({type:"toggle-complex-mode",enabled:!!e[t]});break;default:console.warn(`Unsupported setting: ${t}`);break}}focusFirstExpression(){this.controller.dispatch({type:"focus-first-expression"})}onResizeView(e){this.controller.dispatch({type:"ui/container-resized",size:e})}onDestroyView(){pS.unmountFromNode(this.rootElt)}destroy(){this.controller.model.destroy(),super.destroy()}};var uS=class extends dS{constructor(e,t){super(e),this.init(jke(t||{}))}};function jke(r){if(r=__dcg_shared_module_exports__['f'](r),r.hasOwnProperty("typingSlashWritesDivisionSymbol")||(r.typingSlashWritesDivisionSymbol=!0),r.hasOwnProperty("typingAsteriskWritesTimesSymbol")||(r.typingAsteriskWritesTimesSymbol=!0),r.exponentButtonForSquareRoot&&(__dcg_shared_module_exports__['Be'].warn(`As of API version 1.0, the 'exponentButtonForSquareRoot' option is deprecated.Use 'additionalFunctions: "exponent"' instead.`),r.additionalFunctions=["exponent"]),r.additionalFunctions){let e=r.additionalFunctions;typeof e=="string"&&(e=[e]),e.length>2&&(__dcg_shared_module_exports__['Be'].warn("additionalFunctions can only take up to 2 new functions. Using the first two."),e=e.slice(0,2));let t=!0;for(let o=0;o<e.length;o++)["sqrt","exponent","percent","fraction"].indexOf(e[o])===-1&&(__dcg_shared_module_exports__['Be'].warn("Unrecognized value: '"+e[o]+`' for 'additionalFunction'. Valid values are 'sqrt', 'percent', 'exponent', or 'fraction'. Using default ("sqrt")`),t=!1);r.additionalFunctions=t?e:["sqrt"]}return(!r.additionalFunctions||!r.additionalFunctions.length)&&(r.additionalFunctions=["sqrt"]),r.singleExpression?(r.evaluationMode="singleExpressionFourFunction",r.disableParentheses&&(delete r.disableParentheses,__dcg_shared_module_exports__['Be'].warn("Incompatible options: singleExpression can't be used in combination with disableParentheses. Ignoring disableParentheses."))):r.evaluationMode="fourFunction",delete r.singleExpression,r.hasOwnProperty("decimalToFraction")||(r.decimalToFraction=!1),r.language&&(r.language=Yp(r.language)),delete r.allowComplex,delete r.complex,r}var nf=class extends Wh{constructor(e,t,o){super(e,{...t,allowComplex:!1,product:"geometry-calculator"},o),this.setState(eD),this.clearHistory()}};var af=class extends Wh{constructor(e,t,o){super(e,{...t,product:"graphing"},o)}};var BV=class{constructor(e,t){let o=new Ch;for(let a in t)o.config.setProperty(a,t[a]);this.controller=new Vy({graphSettings:o});let i=new Zm(e);this.controller.setEvaluator(i),i.readEvaluatorConfig=()=>({product:this.controller.getGraphSettings().config.product,beta3d:t.beta3d,evaluationMode:this.controller.isGeometry()?"geometry":"graphing",globalRandomSeed:o.randomSeed,includeFunctionParametersInRandomSeed:o.includeFunctionParametersInRandomSeed,degreeMode:o.degreeMode,restrictedFunctions:o.config.restrictedFunctions,distributions:o.config.distributions,pointsOfInterest:o.config.pointsOfInterest,plotSingleVariableImplicitEquations:o.config.plotSingleVariableImplicitEquations,plotImplicits:o.config.plotImplicits,plotInequalities:o.config.plotInequalities,sliders:o.config.sliders,actions:o.config.actions,recursion:!!o.config.recursion,newStatsEnabled:o.config.newStats}),i.onEvaluatorResults=a=>{this.controller.dispatch({type:"on-evaluator-changes",changes:a.evaluationStates,timingData:a.timingData,eventUpdates:a.eventUpdates,dependencyOrder:a.dependencyOrder})};let n=new Ds({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0}});this.graphpaperBounds=n,this.evaluator=i,this.setBlank()}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e})}tick(){this.evaluator.tick()}destroy(){this.controller.destroy()}};var hS=class{constructor(e){this._calc=new BV(tS,BA({...e})),this.controller=this._calc.controller,this._sharedClockBusToken=Ql(()=>{this._calc.tick()})}destroy(){this._calc.destroy(),Vs(this._sharedClockBusToken);function e(i){__dcg_shared_module_exports__['Be'].warn("You've destroyed this API instance. You can no longer call ."+i+"()")}let t={},o=this;for(;o;)Object.getOwnPropertyNames(o).forEach(n=>t[n]=!0),o=Object.getPrototypeOf(o);for(let i in t)typeof this[i]=="function"?this[i]=e.bind(this,i):this.hasOwnProperty(i)&&delete this[i];this.destroy=function(){}}setExpression(e){let o=this.controller.getItemModel(e.id),i=o&&o.type,n=uD(e,i,this.controller);if(n)if(i)this.controller.dispatch({type:"set-expression-properties-from-api",id:n.id,properties:n});else{if(n.type==="image")return;this.controller.dispatch({type:"add-item-to-end-from-api",state:n})}}setExpressions(e){e.forEach(this.setExpression.bind(this))}removeExpression(e){let t=e.id.toString();this.controller.dispatch({type:"remove-item-by-id",id:t})}removeExpressions(e){e.forEach(this.removeExpression.bind(this))}getState(e){return this.controller.getState(e)}getExpressions(){return this.getState({stripDefaults:!1}).expressions.list.map(_b)}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e||{}})}setState(e,t){this.controller.dispatch({type:"set-state",state:e,opts:t||{}})}HelperExpression(e){let t=e&&e.latex||"",o=new Ds({latex:t});return this.controller.dispatch({type:"add-helper-expression",state:{type:"helper-expression",id:this.controller.generateId(),latex:t,proxy:o}}),o}getHelperExpressions(){return this.controller.getHelperExpressions()}resize(){}};function Xke(r,e){let t=r._calc.controller.getItemModel(e);if((t==null?void 0:t.type)==="image")return t}function $ke(r){return r.imageObj}function Jke(r){var e;return(e=r.formula.dimensions.opacity)==null?void 0:e[0]}var Mie={getGraphImage:Xke,getImageElement:$ke,getImageOpacity:Jke};function Die(r){return r.graphMode==4?{...r,graphMode:3,showPoint:!0,pointOpacity:r.pointOpacity===1?.9:r.pointOpacity}:r}function Aie(r){switch(r.graphMode){case 1:case 2:case 6:case 5:case 7:case 8:case 20:case 21:case 18:case 17:case 19:case 24:case 23:case 3:case 4:case 25:case 26:case 15:case 22:return!0;default:return!1}}async function Zke(r){await Promise.all([new Promise(e=>setTimeout(e,1)),new Promise(e=>requestAnimationFrame(e))]),await Lie(r)}async function Lie(r){return await Pie(r),new Promise(e=>{r._calc.grapher.notifyAfterRedraw(e)})}function Pie(r){return new Promise(e=>{r._calc.evaluator.notifyWhenSynced(e)})}function Qke(r){let e=[],t=r._calc.grapher.graphSketches,o=r._calc.grapher.getDrawLayers();for(let i of o)for(let n of i.drawOrder){let a=t[n];if(a)for(let s of a.branches)s.graphMode===4&&s.segments[0].length>0&&e.push(s.segments[0][0])}return e}var Gie={waitForLastInteractionToSettle:Zke,waitForGrapherToRender:Lie,waitForExpressionUpdate:Pie,getMovablePointPositions:Qke};var gS=class extends dS{constructor(e,t){super(e),this.init(e_e(t||{}))}};function e_e(r){return r=__dcg_shared_module_exports__['f'](r),r.singleExpression?(r.evaluationMode="singleExpressionScientific",delete r.allowComplex,delete r.complex):r.evaluationMode="scientific",delete r.singleExpression,r.language&&(r.language=Yp(r.language)),r}var hT;typeof Desmos!="undefined"?hT=Desmos:(hT={},window.Desmos=hT);var t_e={SMALL:"0.85",MEDIUM:"1",LARGE:"1.35"};function CB(...r){return new af(...r)}CB.prototype=af.prototype;function TB(...r){return new nf(...r)}TB.prototype=nf.prototype;function EB(...r){return new hS(...r)}EB.prototype=hS.prototype;function Vie(...r){return new uS(...r)}Vie.prototype=uS.prototype;function Oie(...r){return new gS(...r)}Oie.prototype=gS.prototype;function Rie(...r){return new Qm(...r)}Rie.prototype=Qm.prototype;function r_e(r){return r.expressions.list.length}var KV={Colors:{RED:hI,BLUE:gI,GREEN:mI,ORANGE:bI,PURPLE:fI,BLACK:ov},imageFileToDataURL:EA,supportedLanguages:["en"].concat(typeof desmosLocaleData=="object"?Object.keys(desmosLocaleData):[]),Styles:{...__dcg_shared_module_exports__['Dd'],...__dcg_shared_module_exports__['Cd']},ColumnModes:pD,DragModes:__dcg_shared_module_exports__['Gd'],AxisArrowModes:__dcg_shared_module_exports__['Nd'],FontSizes:MA,LabelSizes:t_e,LabelOrientations:__dcg_shared_module_exports__['Od'],GraphingCalculator:CB,Calculator:CB,FourFunctionCalculator:Vie,ScientificCalculator:Oie,Geometry:TB,Calculator3D:Rie,Abraham:_p,Private:{Abraham:_p,Mathtools:nd,Graphtools:{ScalePair:__dcg_shared_module_exports__['jd'],getClippingGraphType:ck,mapSegmentToCanvas:qg,computeDrawingCommandsForDOMLabel:WD,drawCommandsToCtx:jD,replaceMovablePointsWithStaticPoints:Die,isBranch2D:Aie},MathquillConfig:{getAutoCommands:jg,getAutoOperators:LN},Parser:__dcg_shared_module_exports__['Ae'],extractSliderValueFromLatex:Wx,__compareBranches:{getSliderMin:Zs,getSliderMax:bc,valueTypes:__dcg_shared_module_exports__['la'],migrateGeoStateToCalcState:sh,Mathtools:nd},GeometryBeta:TB,migrateGeoStateToCalcState:sh,HeadlessGraphingCalculator:EB,maybeNotifyUserChangedLatex:Qe.simulateUserChangedLatex,Fragile:{DCGView:{...IB,Class:IB.View},PromptSliderView:Is,Checkbox:ft,SegmentedControl:ar,MathquillView:Qe,InlineMathInputView:or,StaticMathquillView:dt,Tooltip:Oe,ExpressionOptionsMenuView:tw,ExpressionView:zb,ImageIconView:qb,evaluateLatex:eo,Keys:rr,getReconciledExpressionProps:__dcg_shared_module_exports__['Wc'],List:{moveItemsTo:Ag,removeItemById:ub},currentLanguage:D0},getExpressionCount:r_e,ImageHelpers:Mie,TestHelpers:Gie},TestInternal:{fetchLanguage:r=>pv(r)},MathQuill:Pl,HeadlessGraphingCalculator:EB};function gT(r){let e=hT.enabledFeatures;return!e||e[r]}function mS(r){KV[r]=function(){throw new Error("The Desmos "+r+" is not enabled for this API key.")}}gT("GraphingCalculator")||(mS("GraphingCalculator"),mS("Calculator"));gT("FourFunctionCalculator")||mS("FourFunctionCalculator");gT("ScientificCalculator")||mS("ScientificCalculator");gT("GeometryCalculator")||mS("Geometry");gT("Calculator3D")||mS("Calculator3D");for(let r in KV)KV.hasOwnProperty(r)&&(hT[r]=KV[r]);Ut();var o_e=0,Ny=class{constructor(e,t,o){this.__id=o_e++,this.controller=e,this.shellController=t,this.userController=t.userController,this.mygraphsController=t.mygraphsController,this.instanceHotkeys=o,this.startListening()}remove(){this.stopListening()}startListening(){this.isListening||(re(document).on("keydown.dcg-global-keyboard-listener-"+this.__id,e=>this.handleGlobalKeydown(e)),this.isListening=!0)}stopListening(){this.isListening&&(re(document).off("keydown.dcg-global-keyboard-listener-"+this.__id),this.isListening=!1)}handleGlobalKeydown(e){let t=!1;if(Hf(e)||Wf(e))(!this.controller.getRootElt()||document.activeElement&&document.activeElement!=document.body&&!document.activeElement.closest(".dcg-dom-change-wrapper"))&&(t=!0);else if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&!e.shiftKey&&Pe(e)===Wi)t=this.handleEscape(e);else if(HR(e))e.preventDefault(),e.stopPropagation(),t=!0,this.shellController.dispatch({type:"show-modal",modal:"hotkeys"});else if(e.ctrlKey&&(e.altKey||e.metaKey)&&!e.shiftKey)if(Jr(e)==="A")if(e.preventDefault(),e.stopPropagation(),t=!0,this.userController.isLoggedIn())this.shellController.dispatch({type:"toggle-menu",payload:this.mygraphsController.isMygraphsOpen()?"account-mygraphs":"account"});else{let o=document.querySelector(".dcg-sign-in");this.triggerKeyboardTapEvent(o)}else Jr(e)==="L"?(e.preventDefault(),e.stopPropagation(),t=!0,this.shellController.dispatch({type:"toggle-menu",payload:"language"})):Jr(e)==="H"?(e.preventDefault(),e.stopPropagation(),this.shellController.dispatch({type:"toggle-menu",payload:"help"})):Jr(e)==="S"&&(e.preventDefault(),e.stopPropagation(),t=!0,this.shellController.dispatch({type:"toggle-menu",payload:"share"}));t||this.instanceHotkeys.handleKeydown(e)}handleEscape(e){let t=!1,o=this.shellController.getModalState().modal!=="none",i=!!document.querySelector(".graph-preview"),n=this.mygraphsController.isMygraphsOpen(),a=!1;if(i){let s=document.querySelector(".dcg-action-close-resources");Ku(s)&&this.triggerKeyboardTapEvent(s),a=!0}else n&&(this.shellController.dispatch({type:"close-mygraphs"}),a=!0);if(a){if(!jn)if(!i&&!(o&&n)){let s=this.controller.getSelectedItem();if(s)this.controller.dispatch({type:"move-focus-to-item",id:s.id});else{let c=this.controller.getItemModelByIndex(0);c&&this.controller.dispatch({type:"move-focus-to-item",id:c.id})}}else o&&n&&document.querySelector(".new-blank-graph").focus();e.preventDefault(),e.stopPropagation(),t=!0}return t}triggerKeyboardTapEvent(e){if(!e)return;let t=re.Event("dcg-tap");t.device="keyboard",re(e).trigger(t)}};jo();En();var mT=class{constructor(e){this.s=Qc(()=>this._language);this._language=tb(),this.dispatch=e}raw(e,t){return $s(e,t)}unpack(e){return fc(e,this._language)}getLanguage(){return this._language}updateUrl(e){if(!(window.history&&history.replaceState))return;let{origin:t,pathname:o,search:i,hash:n}=location,a=dz(i,"lang",e),s=`${t}${o}${a}${n}`;history.replaceState(null,"",s)}async fetchLanguage(e){await pv(e),this.dispatch({type:"set-language",code:e})}setLanguage(e){this._language=e,this.updateUrl(e)}};var B2=__dcg_shared_module_exports__['e'](j());var fS=__dcg_shared_module_exports__['e'](j());var zV=class extends fS.View{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return l(go,{title:()=>this.i18n.s("shared-title-account-reactivated"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller,children:x("div",{class:fS.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog dcg-shared-account-dialog--account-reenabled"),children:[l("div",{class:fS.const("dcg-shared-account-paragraph"),children:()=>this.i18n.s("shared-message-account-reactivated")}),l("div",{class:fS.const("dcg-shared-modal-actions-container"),children:l("button",{class:()=>({"dcg-btn-blue":!0}),onTap:()=>this.controller.dispatch({type:"close-modal"}),children:()=>this.i18n.s("shared-button-continue-to-desmos")})})]})})}};var ec=__dcg_shared_module_exports__['e'](j());Ut();var Os=__dcg_shared_module_exports__['e'](j());var Uy=__dcg_shared_module_exports__['e'](j()),{If:i_e,For:n_e}=Uy.Components,Da=class extends Uy.View{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return l(i_e,{predicate:()=>!!this.props.errors().length,children:()=>l("span",{children:l(n_e,{each:this.props.errors,children:e=>l("div",{class:Uy.const("dcg-shared-account-modal-errors"),role:Uy.const("alert"),children:l("span",{children:()=>this.i18n.raw(e)})})})})})}};var{If:Fie}=Os.Components,a_e=0,MB=1,Nie=2,qV=class extends Os.View{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.mode=MB,this.formErrors=[]}template(){return x("div",{class:Os.const("dcg-shared-change-password dcg-shared-account-settings-section"),children:[l(Fie,{predicate:()=>this.mode===MB,children:()=>x("div",{class:Os.const("dcg-shared-reset-by-email"),children:[l("div",{class:Os.const("dcg-shared-account-paragraph"),children:()=>this.i18n.s("shared-message-change-password-email-sent",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})}),l(Da,{controller:this.props.controller,errors:()=>this.formErrors}),l("div",{class:Os.const("dcg-shared-modal-actions-container"),children:l("div",{role:Os.const("button"),"aria-disabled":()=>this.emailDisabled,tabIndex:()=>this.emailDisabled?"-1":"0",class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.emailDisabled}),onTap:()=>this.sendResetPasswordEmail(),children:()=>this.i18n.s("shared-button-send-email")})})]})}),l(Fie,{predicate:()=>this.mode===Nie,children:()=>x("div",{"aria-live":Os.const("assertive"),"aria-atomic":Os.const("true"),class:Os.const("dcg-shared-confirmation-message-container"),children:[x("div",{class:Os.const("dcg-shared-confirmation-message"),children:[l("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":Os.const("true")}),()=>this.i18n.s("shared-message-email-sent")]}),l("div",{children:()=>this.i18n.s("shared-message-check-email-for-password-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})})]})})]})}onEmailSent(){this.mode=Nie,this.update(),setTimeout(this.bindIfMounted(()=>{this.mode=a_e,this.update()}),5e3),setTimeout(this.bindIfMounted(()=>{this.mode=MB,this.update()}),5200)}onEmailSendingFailed(e){this.formErrors=this.controller.parseJSONErrors(e),this.update()}sendResetPasswordEmail(){this.controller.userController.recoverPassword({email:this.controller.userController.getEmail(),lang:this.controller.getLanguage()}).then(this.bindIfMounted(this.onEmailSent),this.bindIfMounted(this.onEmailSendingFailed))}};var jt=__dcg_shared_module_exports__['e'](j());var vl=__dcg_shared_module_exports__['e'](j());var HV=class extends vl.View{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formErrors=[]}template(){return x("div",{class:vl.const("dcg-shared-delete-account dcg-shared-account-settings-section"),children:[l("h1",{class:vl.const("dcg-shared-account-title dcg-shared-left-align-title"),children:()=>this.i18n.s("shared-title-delete-account")}),l("div",{class:vl.const("dcg-shared-account-paragraph"),children:x(Ot,{i18n:this.props.controller,children:["When you delete your account,"," ",l("b",{children:"we will retain your data for 30 days."})," You can reactivate your account at any time during those 30 days by logging back in. If there's something about Desmos we can improve, please"," ",l("a",{href:vl.const("mailto:support@desmos.com"),class:vl.const("dcg-blue-link"),children:"let us know."})]},this.const("shared-message-delete-account-notice"))}),l("div",{class:vl.const("dcg-shared-account-paragraph"),children:()=>this.i18n.s("shared-message-delete-account-will-send-email",{email:this.i18n.raw(this.controller.userController.getEmail())})}),x("form",{onSubmit:this.bindFn(this.onSubmit),children:[l(Da,{controller:this.props.controller,errors:()=>this.formErrors}),x("div",{class:vl.const("dcg-shared-modal-actions-container"),children:[l("div",{role:vl.const("link"),tabIndex:vl.const(0),class:vl.const("dcg-gray-link"),onTap:()=>this.props.hideForm(),children:()=>this.i18n.s("shared-button-cancel")}),l("button",{class:()=>({"dcg-btn-red":!0,"dcg-disabled":this.disabled}),"aria-disabled":()=>this.disabled,tabIndex:()=>this.disabled?"-1":"0",type:vl.const("submit"),children:()=>this.i18n.s("shared-button-send-delete-account-email")})]})]})]})}onAccountDeleted(){this.props.submitForm()}onAccountDeletionFailed(e){this.formErrors=this.controller.parseJSONErrors(e),this.update()}doDeleteAccount(){this.disabled||(this.controller.logEvent({category:"accounts",action:"send-delete-email"}),this.controller.userController.initiateAccountDeletion({lang:this.controller.getLanguage()}).then(this.bindFn(this.onAccountDeleted),this.bindIfMounted(this.onAccountDeletionFailed)))}onSubmit(e){e.preventDefault(),this.doDeleteAccount()}};var To=__dcg_shared_module_exports__['e'](j());var{If:DB}=To.Components,bS=0,Uie=1,s_e=2,Yie=3,WV=class extends To.View{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formStatus=bS,this.emailDisabled=null}template(){return x("div",{class:To.const("dcg-shared-email-field-container"),children:[l(DB,{predicate:()=>this.formStatus===bS,children:()=>l("div",{class:To.const("dcg-shared-email-field"),children:x("div",{class:To.const("dcg-shared-profile-info-container"),children:[l("span",{class:To.const("dcg-shared-profile-info-title"),role:To.const("heading"),"aria-level":To.const("1"),children:()=>this.i18n.s("shared-title-email-settings")}),x("div",{class:To.const("dcg-shared-profile-info-content"),children:[()=>this.i18n.raw(this.controller.userController.getEmail()),l("div",{class:To.const("dcg-shared-message-container"),children:l("div",{role:To.const("link"),tabIndex:To.const(0),class:To.const("dcg-blue-link"),onTap:()=>this.setFormStatus(Uie),children:()=>this.i18n.s("shared-button-change-email-address")})})]})]})})}),l(DB,{predicate:()=>this.formStatus===Uie,children:()=>x("div",{class:To.const("dcg-shared-change-email-container"),children:[l("div",{class:To.const("dcg-shared-change-email-description"),children:()=>this.i18n.s("shared-message-email-settings-will-send-email",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})}),l(Da,{controller:this.props.controller,errors:()=>this.formErrors}),x("div",{class:To.const("dcg-shared-modal-actions-container"),children:[l("span",{role:To.const("link"),tabIndex:To.const(0),class:To.const("dcg-gray-link"),onTap:()=>this.setFormStatus(bS),children:()=>this.i18n.s("shared-button-cancel")}),l("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!!this.emailDisabled}),"aria-disabled":()=>this.disabled,tabIndex:()=>this.disabled?"-1":"0",type:To.const("submit"),onTap:()=>this.emailDisabled||this.sendChangeEmail(),children:()=>this.i18n.s("shared-button-send-email")})]})]})}),l(DB,{predicate:()=>this.formStatus===Yie,children:()=>x("div",{"aria-live":To.const("assertive"),"aria-atomic":To.const("true"),class:To.const("dcg-shared-confirmation-message-container"),children:[x("div",{class:To.const("dcg-shared-confirmation-message"),children:[l("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":To.const("true")}),()=>this.i18n.s("shared-message-email-sent")]}),l("div",{children:()=>this.i18n.s("shared-message-check-email-for-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})})]})})]})}setToast(e){this._isMounted&&(this.toastMessage||(this.toastMessage=e,this.update(),setTimeout(this.bindIfMounted(()=>{this.toastMessage=null,this.update()}),5e3),this.formStatus===s_e&&setTimeout(this.bindIfMounted(()=>{this.setFormStatus(bS),this.update()}),5200)))}setFormStatus(e){this.formStatus=e,this.toastMessage=null,this.formErrors=[],this.update()}onEmailSent(){this.formStatus=Yie,this.emailDisabled=null,this.update(),setTimeout(this.bindIfMounted(()=>{this.formStatus=bS,this.update()}),5e3),setTimeout(this.bindIfMounted(()=>{this.formStatus=bS,this.update()}),5200)}onEmailSendingFailed(e){this.formErrors=this.controller.parseJSONErrors(e),this.emailDisabled=null,this.update()}sendChangeEmail(){this.emailDisabled=!0,this.update(),this.controller.userController.initiateEmailChange({lang:this.controller.getLanguage()}).then(this.bindIfMounted(this.onEmailSent),this.bindIfMounted(this.onEmailSendingFailed))}};var{If:jV,Input:PB,Switch:l_e,SwitchUnion:c_e}=jt.Components,AB=0,Bie=1,LB=2,XV=class extends jt.View{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.deleteAccount=AB}template(){return l("div",{class:jt.const("dcg-shared-profile-info dcg-shared-account-settings-section"),children:l(l_e,{children:e=>{switch(e){case AB:return x("div",{children:[l("div",{class:jt.const("dcg-shared-email-form-container"),children:l(GB,{controller:this.props.controller})}),l(WV,{controller:this.props.controller}),l("button",{class:jt.const("dcg-gray-link dcg-shared-delete-link"),onTap:()=>this.confirmDeletion(),children:()=>this.i18n.s("shared-button-delete-account-question")})]});case Bie:return l(HV,{hideForm:()=>this.setDeleteAccount(AB),submitForm:()=>this.setDeleteAccount(LB),controller:this.props.controller});case LB:return x("div",{"aria-live":jt.const("assertive"),"aria-atomic":jt.const("true"),class:jt.const("dcg-shared-confirmation-message-container"),children:[x("div",{class:jt.const("dcg-shared-confirmation-message"),children:[l("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":jt.const("true")}),()=>this.i18n.s("shared-message-email-sent")]}),l("div",{children:()=>this.i18n.s("shared-message-check-email-for-delete-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})})]})}}},()=>this.deleteAccount)})}setDeleteAccount(e){this.deleteAccount=e,e===LB&&setTimeout(()=>{this.controller.userController.logout().then(()=>{this.controller.dispatch({type:"close-modal"})})},5e3),this._isMounted&&this.update()}confirmDeletion(){this.setDeleteAccount(Bie)}},GB=class extends jt.View{init(){this.controller=this.props.controller(),this.formErrors=[];let e=this.controller.userController.getNameDetail();e.source=="legacy"?this.state={state:"legacy",name:e.given,previousName:e.given}:e.source=="parsed"?this.state={state:"name-detail",confirm:!0,given:e.given,family:e.family||"",previousGiven:"",previousFamily:""}:this.state={state:"name-detail",confirm:!1,given:e.given,family:e.family||"",previousGiven:e.given,previousFamily:e.family||""}}template(){return c_e(()=>this.state,"state",{legacy:e=>l(VB,{state:e,controller:this.props.controller,onSaveName:this.bindFn(this.onSaveName),formErrors:()=>this.formErrors,showSavedNotice:()=>this.showSavedNotice,updateState:t=>{this.state.state=="legacy"&&(this.state={...this.state,...t},this._isMounted&&this.update())}}),"name-detail":e=>l(OB,{state:e,controller:this.props.controller,showSavedNotice:()=>this.showSavedNotice,onSaveName:this.bindFn(this.onSaveName),formErrors:()=>this.formErrors,updateState:t=>{this.state.state=="name-detail"&&(this.state={...this.state,...t},this._isMounted&&this.update())}})})}onSaveName(){switch(this.state.state){case"legacy":this.controller.userController.setNameLegacy({name:this.state.name,lang:this.controller.getLanguage()}).then(this.bindIfMounted(this.onSaved)).catch(this.bindIfMounted(e=>{this.formErrors=this.controller.parseJSONErrors(e),this.update()}));break;case"name-detail":this.controller.userController.setNameDetail({given:this.state.given,family:this.state.family,lang:this.controller.getLanguage()}).then(this.bindIfMounted(this.onSaved)).catch(this.bindIfMounted(e=>{this.formErrors=this.controller.parseJSONErrors(e),this.update()}));break}}onSaved(){switch(this.state.state){case"legacy":this.state.previousName=this.state.name;break;case"name-detail":this.state.previousGiven=this.state.given,this.state.previousFamily=this.state.family,this.state.confirm=!1;break}this.showSavedNotice=!0,this.update(),setTimeout(this.bindIfMounted(()=>{this.showSavedNotice=!1,this.update()}),3e3)}},VB=class extends jt.View{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return x("form",{class:jt.const("dcg-shared-name-field"),onSubmit:this.bindFn(this.onSaveName),children:[x("div",{class:jt.const("dcg-shared-profile-info-container"),children:[l("label",{class:jt.const("dcg-shared-profile-info-title"),for:jt.const("dcg-profile-name"),children:()=>this.i18n.s("shared-label-name")}),l(PB,{type:jt.const("text"),name:jt.const("dcg-profile-name"),id:jt.const("dcg-profile-name"),class:jt.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),didMount:this.bindFn(this.didMountName),onInput:this.bindFn(this.onNameInput),value:()=>this.props.state().name,autocomplete:jt.const("off")})]}),x("div",{class:jt.const("dcg-shared-modal-actions-container"),children:[l($V,{showSavedNotice:this.props.showSavedNotice,i18n:this.props.controller}),l("button",{type:jt.const("submit"),disabled:()=>this.nameFieldDisabled()?!0:void 0,class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.nameFieldDisabled()}),children:()=>this.i18n.s("shared-button-save")})]}),l(jV,{predicate:()=>this.props.formErrors().length>0,children:()=>l(Da,{controller:this.props.controller,errors:()=>this.props.formErrors()})})]})}onNameInput(e){this.props.updateState({name:e})}didMountName(e){Hc||e.focus()}onSaveName(e){e.preventDefault(),!this.nameFieldDisabled()&&this.props.onSaveName()}nameFieldDisabled(){let e=this.props.state();return!e.name||e.name===e.previousName}},OB=class extends jt.View{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return l("form",{class:jt.const("dcg-shared-name-field"),onSubmit:this.bindFn(this.onSaveName),children:x("div",{class:()=>({"dcg-shared-confirm-name":this.props.state().confirm}),children:[l(jV,{predicate:()=>this.props.state().confirm,children:()=>l("span",{children:()=>this.i18n.s("shared-message-please-review-name")})}),x("div",{class:jt.const("dcg-shared-profile-info-container"),children:[x("div",{class:jt.const("dcg-shared-name-input"),children:[l("label",{class:jt.const("dcg-shared-profile-info-title"),for:jt.const("dcg-profile-given-name"),children:()=>this.i18n.s("shared-label-given-name-or-nickname")}),l(PB,{type:jt.const("text"),name:jt.const("dcg-profile-given-name"),id:jt.const("dcg-profile-given-name"),class:jt.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),didMount:this.bindFn(this.didMountName),onInput:e=>this.props.updateState({given:e}),value:()=>this.props.state().given,autocomplete:jt.const("off")})]}),x("div",{class:jt.const("dcg-shared-name-input"),children:[l("label",{class:jt.const("dcg-shared-profile-info-title"),for:jt.const("dcg-profile-family-name"),children:()=>this.i18n.s("shared-label-family-name")}),l(PB,{type:jt.const("text"),name:jt.const("dcg-profile-family-name"),id:jt.const("dcg-profile-family-name"),class:jt.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),onInput:e=>this.props.updateState({family:e}),value:()=>this.props.state().family,autocomplete:jt.const("off")})]})]}),x("div",{class:jt.const("dcg-shared-modal-actions-container"),children:[l($V,{i18n:this.props.controller,showSavedNotice:this.props.showSavedNotice}),l("button",{type:jt.const("submit"),disabled:()=>this.canSubmit()?void 0:!0,class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.canSubmit()}),children:()=>this.props.state().confirm?this.i18n.s("shared-button-confirm-name"):this.i18n.s("shared-button-save")})]}),l(jV,{predicate:()=>this.props.formErrors().length>0,children:()=>l(Da,{controller:this.props.controller,errors:()=>this.props.formErrors()})})]})})}didMountName(e){Hc||e.focus()}onSaveName(e){e.preventDefault(),this.canSubmit()&&this.props.onSaveName()}canSubmit(){let e=this.props.state();return e.given?e.confirm?!0:!(e.given===e.previousGiven&&e.family===e.previousFamily):!1}},$V=class extends jt.View{template(){return l(jV,{predicate:()=>this.props.showSavedNotice(),children:()=>x("span",{"aria-live":jt.const("assertive"),"aria-atomic":jt.const("true"),class:jt.const("dcg-shared-confirmation-message"),children:[l("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":jt.const("true")}),()=>this.props.i18n().s("shared-message-information-saved")]})})}};var{For:d_e,Switch:p_e}=ec.Components,JV="profile-info",RB="change-password",ZV=class extends ec.View{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.settingsView=this.props.initialTab&&this.props.initialTab()||JV,this.breakPoint=660,this.measureWindow()}template(){return l(go,{title:()=>this.i18n.s("shared-title-account-settings"),size:this.const("wide"),showX:this.const(!0),leftAlignTitle:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller,children:x("div",{class:ec.const("dcg-shared-account-settings-dialog dcg-shared-account-dialog"),children:[l("div",{class:ec.const("dcg-shared-navigation-tabs"),role:ec.const("tablist"),didMount:e=>this.tablistElement=e,children:l(d_e,{each:()=>this.getTabs(),children:e=>l("div",{"aria-orientation":ec.const("vertical"),role:ec.const("tab"),tabIndex:()=>this.settingsView===e.key?0:-1,"aria-selected":()=>this.settingsView===e.key,class:()=>({"dcg-shared-tab-gray-underline":!0,[e.class]:!0,"dcg-selected":this.settingsView===e.key}),onKeyDown:this.bindFn(this.handleTablistKeyDown),onTap:()=>this.updateSettingsView(e.key),children:e.label})},e=>""+e.key)}),l("div",{class:ec.const("dcg-shared-content-container"),role:ec.const("tabpanel"),"aria-label":this.bindFn(this.getLabelForTab),children:l(p_e,{children:e=>e===JV?l(XV,{controller:this.props.controller}):e===RB?l(qV,{controller:this.props.controller}):this.props.extraTabs?l("div",{class:ec.const("dcg-shared-profile-info dcg-shared-account-settings-section"),children:this.props.extraTabs().createView(e)}):l("span",{})},()=>this.settingsView)})]})})}getTabs(){let e=[{key:JV,label:this.bindFn(this.profileTitle),class:"profile-view-button"},{key:RB,label:this.bindFn(this.passwordTitle),class:"change-password-view-button"}];return this.props.extraTabs?[...e,...this.props.extraTabs().tabs.map(({key:t,narrowLabel:o,wideLabel:i,class:n})=>({key:t,label:()=>this.windowWidth>this.breakPoint?o():i(),class:`${n}-button`}))]:e}updateSettingsView(e){this.settingsView=e,this._isMounted&&this.update()}handleTablistKeyDown(e){var d;if(!this.tablistElement||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;let t=Pe(e);if(t!=="Up"&&t!=="Down"&&t!=="Left"&&t!=="Right"&&t!=="Home"&&t!=="End")return;e.preventDefault();let o='[role="tab"]',i=Array.from(this.tablistElement.querySelectorAll(o));if(!i)return;let n=(d=document.activeElement)==null?void 0:d.closest(o);if(!n)return;let a=i.indexOf(n),s=0;t==="Up"||t==="Left"?s=(a-1+i.length)%i.length:t==="Down"||t==="Right"?s=(a+1)%i.length:t==="Home"?s=0:t==="End"&&(s=i.length-1);let c=i[s];c&&c.focus()}getLabelForTab(){let e=this.getTabs().find(t=>t.key===this.settingsView);return e==null?void 0:e.label()}profileTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-title-profile-information-wide"):this.i18n.s("shared-title-profile-information-narrow")}passwordTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-title-change-password-wide"):this.i18n.s("shared-title-change-password-narrow")}measureWindow(){return this.windowWidth=re(window).width()}didMount(){re(window).on("resize.account-dialog",__dcg_shared_module_exports__['Za'](()=>{this.measureWindow(),this._isMounted&&this.update()},200))}didUnmount(){re(window).off("resize.account-dialog")}isProfileSelected(){return this.settingsView===JV}isChangePasswordSelected(){return this.settingsView===RB}};var xn=__dcg_shared_module_exports__['e'](j());var cu="[^@\\s]+@[^@\\s]+\\.[^@\\s]+";var{Input:Kie}=xn.Components,QV=class extends xn.View{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formErrors=[]}template(){return l(go,{title:()=>this.i18n.s("shared-title-change-email-address"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller,children:x("div",{class:xn.const("dcg-shared-change-email dcg-shared-account-dialog"),children:[l("div",{class:xn.const("dcg-shared-account-paragraph"),children:()=>this.i18n.s("shared-message-set-new-email-address")}),x("form",{onSubmit:this.bindFn(this.onSubmit),method:xn.const("post"),class:xn.const("dcg-shared-email-form-container"),children:[x("label",{children:[l("span",{class:xn.const("dcg-shared-input-title"),children:()=>this.i18n.s("shared-label-new-email-address")}),l(Kie,{type:xn.const("email"),pattern:this.const(cu),name:xn.const("newEmail"),class:xn.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-new-email-address"),required:xn.const("true"),didMount:e=>{Hc||e.focus()},value:()=>this.newEmail,onInput:e=>{this.newEmail=e,this._isMounted&&this.update()}})]}),x("label",{for:xn.const("password"),children:[l("span",{children:()=>this.i18n.s("shared-label-password")}),l(Kie,{type:xn.const("password"),class:xn.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-password"),required:xn.const("true"),value:()=>this.password,name:this.const("password"),onInput:e=>{if(this.password=e,this._isMounted)return this.update()}})]}),l(Da,{controller:this.props.controller,errors:()=>this.formErrors}),l("div",{class:xn.const("dcg-shared-sign-in-options"),children:l("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabIndex:()=>this.submitEnabled()?"0":"-1",type:xn.const("submit"),children:()=>this.i18n.s("shared-button-change-email-and-password")})})]})]})})}submitEnabled(){return!!(this.password&&this.newEmail)}async onSubmit(e){if(e.preventDefault(),this.submitEnabled())try{await this.controller.userController.setEmail({changeToken:this.getChangeToken(),password:this.password,newEmail:this.newEmail,lang:this.controller.getLanguage()}),this.controller.dispatch({type:"close-modal"}),history.replaceState(null,null,document.location.pathname)}catch(t){if(!this._isMounted)return;t.status===409?this.formErrors=["Sorry, someone has already registered with this email address."]:this.formErrors=this.controller.parseJSONErrors(t),this.update()}}getChangeToken(){return this.controller.userController.getEmailChangeToken()||""}};var vn=__dcg_shared_module_exports__['e'](j());var{If:e2,Input:u_e}=vn.Components,t2=class extends vn.View{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.email=this.controller.emailForResetPassword||"",this.formErrors=[],this.isSubmittingForm=!1,this.didSendRecoveryEmail=!1}template(){return l(go,{title:()=>this.i18n.s("shared-title-recover-password"),size:this.const("tiny"),showX:this.const(!0),class:this.const("dcg-authentication-modal"),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller,withBackButton:this.const(!0),withStickyTitle:this.const(!0),onBack:this.bindFn(this.onBack),children:x("div",{class:vn.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog"),children:[l(Da,{controller:this.props.controller,errors:()=>this.formErrors}),l(e2,{predicate:()=>this.didSendRecoveryEmail,children:()=>x("div",{role:vn.const("alert"),class:vn.const("dcg-shared-account-paragraph"),children:[()=>this.i18n.s("shared-message-check-email-for-password-recovery-link")," ",l("a",{href:vn.const("#"),class:vn.const("dcg-blue-link"),onTap:()=>(this.didSendRecoveryEmail=!1,this.controller.dispatch({type:"show-modal",modal:"recover-password"})),children:()=>this.i18n.s("shared-button-try-again")})]})}),l(e2,{predicate:()=>!this.didSendRecoveryEmail,children:()=>x("form",{class:vn.const("dcg-shared-email-form-container"),onSubmit:this.bindFn(this.onSubmit),children:[l("div",{class:vn.const("dcg-shared-account-paragraph"),children:()=>this.i18n.s("shared-prompt-enter-email-for-password-recovery-link")}),l("div",{class:vn.const("dcg-authentication-modal__control"),children:x("label",{children:[()=>this.i18n.s("shared-label-email"),l(u_e,{type:vn.const("email"),pattern:this.const(cu),name:vn.const("email"),class:()=>({"dcg-shared-input-blue-outline":!0,"dcg-authentication-modal__input":!0,"dcg-authentication-modal__input--email":!0}),"aria-label":()=>this.i18n.s("shared-label-email"),required:vn.const("true"),didMount:e=>{Hc||(e.focus(),e.select())},value:()=>this.email,onInput:e=>{this.email=e,this._isMounted&&this.update()}})]})}),x("div",{class:vn.const("dcg-shared-sign-in-options"),children:[l(e2,{predicate:()=>this.isSubmittingForm,children:()=>l("div",{class:vn.const("dcg-shared-progress-indicator dcg-shared-create-account-progress"),children:l("div",{class:vn.const("dcg-shared-spinner")})})}),l(e2,{predicate:()=>!this.isSubmittingForm,children:()=>l("button",{class:()=>({"dcg-btn-blue":!0,"dcg-authentication-modal__button":!0,"dcg-authentication-modal__button-no-top-padding":!0,"dcg-disabled":this.isSubmitButtonDisabled()}),disabled:()=>this.isSubmitButtonDisabled()||void 0,type:vn.const("submit"),children:()=>this.i18n.s("shared-button-recover-password")})})]})]})})]})})}onBack(){this.controller.dispatch({type:"show-modal",modal:"authentication"})}isSubmitButtonDisabled(){return!this.email}onSubmit(e){e.preventDefault(),this.submitForm()}async submitForm(){this.formErrors=[],this.isSubmittingForm=!0;try{if(await this.controller.userController.recoverPassword({email:this.email,lang:this.controller.getLanguage()}),!this._isMounted)return;this.didSendRecoveryEmail=!0}catch(e){if(!this._isMounted)return;this.formErrors=this.controller.parseJSONErrors(e)}finally{this._isMounted&&(this.isSubmittingForm=!1,this.update())}}};var Ky=__dcg_shared_module_exports__['e'](j());Ut();var o2=__dcg_shared_module_exports__['e'](j());var r2=class extends o2.View{constructor(){super(...arguments),this.controller=this.props.controller()}template(){return l("div",{class:o2.const("dcg-my-graphs-toast"),children:l(zw,{controller:this.props.controller,toastData:()=>this.controller.myGraphsToastData,onClose:()=>this.controller.dispatch({type:"my-graphs-toast-close"}),onUndo:()=>this.controller.dispatch({type:"my-graphs-toast-undo"}),onLearnMore:()=>this.controller.dispatch({type:"my-graphs-toast-learn-more"})})})}};var i2=__dcg_shared_module_exports__['e'](j());var du=class extends i2.View{template(){return x("div",{class:()=>{var e,t;return{"dcg-shared-loading-indicator":!0,[((t=(e=this.props).class)==null?void 0:t.call(e))||""]:!!this.props.class}},children:[l("span",{class:i2.const("dcg-spinner dcg-shared-loading-spinner")}),()=>wt("account-shell-label-loading")]})}};var pu=__dcg_shared_module_exports__['e'](j());var Aa=__dcg_shared_module_exports__['e'](j()),{If:n2,IfElse:h_e}=Aa.Components,a2=class extends Aa.View{shouldShowSaveButton(){return!this.props.isSaving()&&!this.props.didSaveRecentlySucceed()&&!this.props.didSaveRecentlyFail()}template(){return x("div",{class:Aa.const("save-btn-container"),children:[l(n2,{predicate:()=>this.shouldShowSaveButton(),children:()=>l("div",{role:Aa.const("button"),onTap:this.props.onTap,class:()=>({"dcg-action-save":!0,"dcg-btn-blue":this.props.enabled(),"dcg-disabled":!this.props.enabled()}),"aria-disabled":()=>!this.props.enabled(),tabIndex:()=>this.props.enabled()?0:-1,children:h_e(()=>!this.props.isSyncing()&&this.props.willSaveCopy(),{true:()=>l("span",{children:()=>this.props.s("account-shell-button-save-copy")}),false:()=>l("span",{children:()=>this.props.s("account-shell-button-mygraphs-save")})})})}),l(n2,{predicate:this.props.isSaving,children:()=>l("div",{class:Aa.const("save-saving"),children:l("span",{class:Aa.const("dcg-spinner-dark")})})}),l(n2,{predicate:this.props.didSaveRecentlyFail,children:()=>x("div",{class:Aa.const("save-error"),"aria-live":Aa.const("assertive"),"aria-atomic":Aa.const("true"),children:[l("i",{class:Aa.const("dcg-icon-remove"),"aria-hidden":Aa.const("true")})," ",()=>this.props.s("account-shell-text-error")]})}),l(n2,{predicate:this.props.didSaveRecentlySucceed,children:()=>x("div",{class:Aa.const("save-success"),children:[l("i",{class:Aa.const("dcg-icon-check"),"aria-hidden":Aa.const("true")})," ",()=>this.props.s("account-shell-text-saved")]})})]})}};var yS=class extends pu.View{template(){return l("div",{class:pu.const("graph-link-container graph-in-progress"),children:x("div",{role:pu.const("link"),"aria-label":()=>this.props.s("account-shell-button-mygraphs-save"),class:pu.const("graph-link dcg-action-preview-graph"),onTap:this.props.openSaveDialog,children:[l("span",{class:pu.const("dcg-thumb"),style:()=>({"background-image":`url(${this.props.getThumbnail()})`})}),x("div",{class:pu.const("dcg-graph-details"),children:[l("div",{class:pu.const("dcg-title"),children:this.props.getTitle}),l("div",{class:pu.const("dcg-subtitle dcg-save-status"),children:()=>this.props.isSaveEnabled()?this.props.wasCurrentGraphEverSaved()?this.props.s("account-shell-label-mygraphs-last-saved",{date:this.props.getDisplayDate()}):this.props.s("account-shell-label-mygraphs-unsaved-graph"):this.props.s("account-shell-label-mygraphs-no-unsaved-changes")})]}),l(a2,{enabled:this.props.isSaveEnabled,isSaving:this.props.isSaving,didSaveRecentlySucceed:this.props.didSaveRecentlySucceed,didSaveRecentlyFail:this.props.didSaveRecentlyFail,isSyncing:this.props.isSyncing,willSaveCopy:this.props.willSaveCopy,onTap:()=>{},s:this.props.s})]})})}shouldUpdate(){return this.props.isOpen()}};var Fi=__dcg_shared_module_exports__['e'](j());var wl=__dcg_shared_module_exports__['e'](j());var zie=__dcg_shared_module_exports__['e'](j());Ut();var Ri=class extends zie.View{init(){this.controller=this.props.controller(),this.focusHelper=new am({anchorSelector:`[dcg-menu-button=${this.props.type()}]`,popoverSelector:`.dcg-calculator-shell-menu.${this.getTypeClass()}.${this.getProductClass()}`,itemNavigationKey:"tab",isOpen:()=>this.controller.getOpenMenu()===this.props.type(),closeMenu:()=>{this.controller.isSharingGraph()||this.controller.dispatch({type:"toggle-menu",payload:"none"})}})}onMountPopover(){re(document.body).on(`dcg-tapstart.${this.guid}`,this.focusHelper.handleTap)}didUnmount(){re(document.body).off(`.${this.guid}`)}getTypeClass(){switch(this.props.type()){case"art-contest":return"dcg-art-contest-container";case"account":case"account-mygraphs":case"account-mygraphs-modal":return"dcg-account-container";case"current-tool":return"dcg-current-tool-container";case"graph-actions":return"dcg-graph-actions-container";case"help":return"dcg-help-container";case"language":return"dcg-language-container";case"share":return"dcg-share-container"}}getProductClass(){switch(this.props.controller().getProduct()){case"geometry-calculator":return"dcg-product-geometry-calculator";case"graphing":return"dcg-product-graphing";case"graphing-3d":return"dcg-product-graphing-3d"}}getClassNames(){return`dcg-calculator-shell-menu ${this.getTypeClass()} ${this.getProductClass()}`}template(){return l(Mk,{position:this.const("bottom-left"),className:()=>this.getClassNames(),didMount:this.bindFn(this.onMountPopover),title:this.props.title,constrainHeight:this.const(!0),focusHelper:()=>this.focusHelper,style:()=>this.props.left?{left:`${this.props.left()}px`,right:"auto"}:void 0,arrowStyle:()=>this.props.arrowLeft?{left:`${this.props.arrowLeft()}px`,right:"auto"}:void 0,popoverBody:()=>l("div",{children:this.props.children})})}didMount(){let e=this.props.type();this.guid=`menu-${e}`}};var{If:g_e}=wl.Components,sf=class extends wl.View{init(){this.controller=this.props.controller(),this.userController=this.controller.userController}template(){return l(g_e,{predicate:()=>this.userController.isLoggedIn(),children:()=>x(Ri,{type:this.props.type,label:()=>this.controller.s("account-shell-label-account-information"),left:this.props.left,arrowLeft:this.props.arrowLeft,controller:this.props.controller,children:[x("div",{class:wl.const("user-info"),children:[l("span",{class:wl.const("account-name"),children:()=>this.userController.getFullName()}),l("span",{class:wl.const("account-email"),children:()=>this.userController.getEmail()}),l("a",{class:wl.const("dcg-action-accountsettings"),role:wl.const("link"),tabIndex:wl.const(0),onTap:()=>this.controller.dispatch({type:"show-modal",modal:"account-settings"}),children:()=>this.controller.s("account-shell-link-account-settings")})]}),l("a",{class:wl.const("dcg-action-logout"),role:wl.const("link"),tabIndex:wl.const(0),onTap:()=>this.logout(),children:()=>this.controller.s("account-shell-link-sign-out")})]})})}logout(){this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.userController.logout()}};var{Input:m_e,If:f_e,IfElse:b_e}=Fi.Components,s2=class extends Fi.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.myGraphsController=this.controller.mygraphsController,this.userController=this.controller.userController,this.wasMobileSearchOpen=!1}didUpdate(){var e;this.myGraphsController.isModalMobileSearchOpen&&!this.wasMobileSearchOpen&&((e=document.querySelector("input[name=my-graphs-modal-mobile-search]"))==null||e.focus()),this.wasMobileSearchOpen=this.myGraphsController.isModalMobileSearchOpen}updateSearchFilter(e){this.controller.dispatch({type:"set-my-graphs-search-filter",searchFilter:e})}setModalMobileSearchOpen(e){this.controller.dispatch({type:"set-my-graphs-modal-mobile-search-open",isModalMobileSearchOpen:e})}template(){return l("div",{class:Fi.const("dcg-my-graphs-modal__mobile-header"),children:b_e(()=>this.myGraphsController.isModalMobileSearchOpen,{true:()=>x("div",{class:Fi.const("dcg-my-graphs-modal__mobile-search-section-open"),children:[l("i",{class:Fi.const("dcg-my-graphs-modal__mobile-search-icon-search-bar dcg-icon-search"),"aria-hidden":Fi.const("true")}),l(m_e,{name:this.const("my-graphs-modal-mobile-search"),placeholder:()=>this.controller.s("account-shell-text-mygraphs-search-by-title"),"aria-label":()=>this.controller.s("account-shell-narration-my-graphs-search"),value:()=>this.controller.mygraphsController.searchFilter,maxLength:this.const("140"),onInput:e=>this.updateSearchFilter(e)}),l("button",{class:Fi.const("dcg-unstyled-button dcg-my-graphs-modal__mobile-remove-icon dcg-icon-remove"),"aria-label":()=>this.controller.s("account-shell-narration-my-graphs-close-search"),onTap:()=>{this.setModalMobileSearchOpen(!1)}})]}),false:()=>x("div",{class:Fi.const("dcg-my-graphs-modal__mobile-search-section-closed"),children:[x("button",{class:Fi.const("dcg-unstyled-button dcg-my-graphs-modal__mobile-search-button"),onTap:()=>{this.setModalMobileSearchOpen(!0)},children:[l("i",{class:Fi.const("dcg-my-graphs-modal__mobile-search-icon-search-section dcg-icon-search"),"aria-hidden":Fi.const("true")}),l("span",{class:Fi.const("dcg-my-graphs-modal__search-title"),children:()=>this.controller.s("account-shell-heading-title-mygraphs-search")})]}),x("div",{class:Fi.const("dcg-my-graphs-modal__mobile-account-link-section"),children:[x("button",{class:Fi.const("dcg-unstyled-button dcg-account-link-modal"),"dcg-menu-button":Fi.const("account-mygraphs-modal"),"aria-haspopup":Fi.const("true"),"aria-expanded":()=>this.controller.getOpenMenu()==="account-mygraphs-modal","aria-label":()=>this.controller.s("account-shell-label-account-information"),onTap:()=>{this.controller.dispatch({type:"toggle-menu",payload:"account-mygraphs-modal"})},children:[l("span",{class:Fi.const("dcg-my-graphs-modal__account-title"),children:()=>this.userController.getFirstName()}),l("i",{class:Fi.const("dcg-my-graphs-modal__mobile-caret-icon dcg-icon-caret-down"),"aria-hidden":Fi.const("true")})]}),l(f_e,{predicate:()=>this.controller.getOpenMenu()==="account-mygraphs-modal",children:()=>l(sf,{type:this.const("account-mygraphs-modal"),controller:this.const(this.controller),arrowLeft:this.const(205)})})]})]})})})}};jo();var Pa=__dcg_shared_module_exports__['e'](j());var Uc=__dcg_shared_module_exports__['e'](j());jo();var Yd=__dcg_shared_module_exports__['e'](j());var qie=__dcg_shared_module_exports__['e'](j());var y_e={"2d":"dcg-icon-graphing",scientific:"dcg-icon-scientific",fourfunction:"dcg-icon-four-function",matrix:"dcg-icon-matrix","3d":"dcg-icon-3d",geometry:"dcg-icon-geometry",practice:"dcg-icon-test-mode","assessment-fourfunction":"dcg-icon-assessment-four","assessment-scientific":"dcg-icon-assessment-sci","assessment-graphing":"dcg-icon-assessment-graphing"},Rs=class extends qie.View{template(){return l("i",{class:()=>{var e,t;return{"dcg-shared-product-icon":!0,[y_e[this.props.name()]]:!0,"dcg-disabled":(t=(e=this.props).disabled)==null?void 0:t.call(e)}},"aria-hidden":()=>{var e,t;return(t=(e=this.props).ariaHidden)==null?void 0:t.call(e)},role:()=>{var e,t;return((t=(e=this.props).role)==null?void 0:t.call(e))||"img"},"aria-label":this.bindFn(this.getAriaLabel)})}getAriaLabel(){if(this.props.ariaLabel)return this.props.ariaLabel();switch(this.props.name()){case"2d":return wt("frontpage-link-shared-graphing-calculator-short");case"assessment-graphing":return wt("frontpage-narration-shared-assessment-calculator",{calculatorType:wt("frontpage-link-shared-graphing-calculator-short")});case"scientific":return wt("frontpage-link-shared-scientific-calculator-short");case"assessment-scientific":return wt("frontpage-narration-shared-assessment-calculator",{calculatorType:wt("frontpage-link-shared-scientific-calculator-short")});case"fourfunction":return wt("frontpage-link-shared-four-function-calculator-short");case"assessment-fourfunction":return wt("frontpage-narration-shared-assessment-calculator",{calculatorType:wt("frontpage-link-shared-four-function-calculator-short")});case"matrix":return wt("frontpage-link-shared-matrix-calculator-short");case"3d":return wt("frontpage-link-shared-3d-calculator-short");case"geometry":return wt("frontpage-link-shared-geometry-short");case"practice":return wt("frontpage-link-shared-test-practice")}}};var l2=class extends Yd.View{template(){return x("div",{class:Yd.const("dcg-example-graphs-tile"),role:Yd.const("link"),tabIndex:Yd.const("0"),onTap:this.props.onTap,id:this.props.key,children:[l("h2",{class:Yd.const("dcg-unstyled-heading dcg-example-tile__title"),children:this.props.getTitle}),x("div",{class:Yd.const("dcg-example-tile__image-container"),children:[l("span",{class:Yd.const("dcg-example-graphs-tile__image"),style:this.const({"background-image":`url(${this.props.getImageURL()})`})}),l("div",{class:Yd.const("dcg-example-graphs-tile__product-icon"),children:l(Rs,{disabled:this.const(!0),name:()=>hg(this.props.product())})}),l("h3",{class:Yd.const("dcg-unstyled-heading dcg-example-graphs-tile__subtitle"),children:this.props.getSubtitle})]})]})}};var{For:x_e,If:v_e}=Uc.Components,FB={graphing:{heading:"account-shell-text-example-gallery-2d",description:"account-shell-text-example-gallery-description-2d",arrowIconClass:"dcg-example-gallery__arrow--2d"},"geometry-calculator":{heading:"account-shell-text-example-gallery-geometry",description:"account-shell-text-example-gallery-description-geometry",arrowIconClass:"dcg-example-gallery__arrow--geometry"},"graphing-3d":{heading:"account-shell-text-example-gallery-3d",description:"account-shell-text-example-gallery-description-3d",arrowIconClass:"dcg-example-gallery__arrow--3d"}},c2=class extends Uc.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.myGraphsController=this.controller.mygraphsController}template(){return x("div",{children:[x("div",{class:Uc.const("dcg-example-gallery__heading-section"),children:[l("h1",{class:Uc.const("dcg-unstyled-heading dcg-example-gallery__heading"),children:()=>this.controller.s(FB[this.myGraphsController.exampleGalleryFilter].heading)}),x("div",{class:Uc.const("dcg-example-gallery__subheading-section"),children:[l("h2",{class:Uc.const("dcg-unstyled-heading dcg-example-gallery__subheading"),children:()=>this.controller.s(FB[this.myGraphsController.exampleGalleryFilter].description)}),l("i",{class:()=>({"dcg-icon-curved-arrow":!0,"dcg-example-gallery__arrow":!0,[FB[this.myGraphsController.exampleGalleryFilter].arrowIconClass]:!0}),"aria-hidden":Uc.const("true")})]})]}),l(v_e,{predicate:()=>!this.myGraphsController.hasExampleGraphsToDisplay(),children:()=>l("h2",{class:Uc.const("dcg-unstyled-heading dcg-my-graphs-modal__gray-heading dcg-my-graphs-modal__no-example-graphs-heading"),children:()=>this.controller.s("account-shell-text-mygraphs-no-examples-match-search")})}),l("ul",{class:Uc.const("dcg-unstyled-list dcg-example-tiles-section dcg-my-graphs-modal-examples"),children:l(x_e,{each:()=>this.myGraphsController.getExampleGraphsToDisplay(this.myGraphsController.exampleGalleryFilter),children:e=>l("li",{children:l(l2,{controller:()=>this.controller,getSubtitle:()=>this.controller.s("account-shell-label-mygraphs-example"),getTitle:()=>e.getVisibleTitle(this.controller.s),getImageURL:()=>e.thumbUrl,product:()=>e.product,onTap:()=>this.controller.dispatch({type:"fetch-graph-from-modal",graph:e})},()=>e.getCollectionKey())})},e=>e.getCollectionKey())})]})}};var sa=__dcg_shared_module_exports__['e'](j());var La=__dcg_shared_module_exports__['e'](j());var p2=__dcg_shared_module_exports__['e'](j());var{If:w_e,Input:S_e}=p2.Components,d2=class extends p2.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.myGraphsController=this.controller.mygraphsController}getFolderDropdownOptions(){return this.myGraphsController.getFolders().map(e=>{var t;return{key:e.id,title:()=>e.name,icon:"dcg-icon-folder",disabled:e.id===((t=this.myGraphsController.getOpenFolder())==null?void 0:t.id),action:()=>{var o;return this.myGraphsController.dispatch({type:"move-graphs-to-folder",payload:{id:e.id,graphs:[this.props.graph()],currentFolderId:(o=this.myGraphsController.getOpenFolder())==null?void 0:o.id}})}}})}getDropdownOptions(){var o;let e=[],t=(o=this.myGraphsController.getOpenFolder())==null?void 0:o.id;return t&&e.push({title:()=>"Saved Graphs",icon:"dcg-icon-arrow-left",action:()=>this.myGraphsController.dispatch({type:"remove-graphs-from-folder",payload:{id:t,graphs:[this.props.graph()]}})}),e=e.concat(this.getFolderDropdownOptions()).filter(i=>this.myGraphsController.moveGraphMenuSearchFilter?i.title().startsWith(this.myGraphsController.moveGraphMenuSearchFilter):!0),this.myGraphsController.moveGraphMenuSearchFilter&&e.push({title:()=>`Create new: "${this.myGraphsController.moveGraphMenuSearchFilter}"`,icon:"dcg-icon-plus",class:"dcg-move-mygraph-menu__add-graph",action:()=>this.myGraphsController.dispatch({type:"create-folder",payload:this.myGraphsController.moveGraphMenuSearchFilter})}),e}backToOptions(){this.controller.dispatch({type:"set-single-graph-action-menu",payload:{menu:"options-list"}})}template(){return x(Yy,{title:()=>this.controller.s("account-shell-button-mygraphs-move"),backButton:()=>({onTap:()=>this.backToOptions(),ariaLabel:()=>this.controller.s("account-shell-button-cancel")}),children:[l(S_e,{class:this.const("dcg-move-mygraph-menu__input dcg-input-blue-outline"),placeholder:()=>"Choose a location",value:()=>this.myGraphsController.moveGraphMenuSearchFilter,onFocus:()=>this.myGraphsController.dispatch({type:"set-move-graph-menu-input-focused",payload:{isFocused:!0}}),maxLength:this.const("140"),onInput:e=>this.myGraphsController.dispatch({type:"set-move-graph-menu-search-filter",payload:{searchFilter:e}})}),l(w_e,{predicate:()=>this.myGraphsController.isMoveGraphMenuInputFocused,children:()=>l(Jl,{class:()=>"dcg-move-mygraph-menu__dropdown",options:()=>this.getDropdownOptions(),onTap:e=>{var t;return(t=e.action)==null?void 0:t.call(e)}})})]})}};var{SwitchUnion:k_e,IfDefined:Hie}=La.Components;function Wie(r){return{title:()=>r.s("account-shell-button-mygraphs-delete-graph"),icon:"dcg-icon-trashcan",key:"delete-confirmation",class:"dcg-red-dropdown-option"}}var xS=class extends La.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.myGraphsController=this.controller.mygraphsController,this.graphTitle=this.props.graph().getVisibleTitle(this.controller.s),this.graphActions=this.props.graph().recovery?[Wie(this.controller)]:[{title:()=>this.controller.s("account-shell-heading-mygraphs-copy-share-link"),icon:"dcg-icon-link",key:"copy-share-link"},{title:()=>this.controller.s("account-shell-button-mygraphs-move"),icon:"dcg-icon-folder-open",key:"move-graph"},Wie(this.controller)]}copyShareLink(){let e=this.props.graph().getURLInterchangeableProducts();this.myGraphsController.copyShareLink(e)}openMenu(e){this.controller.dispatch({type:"set-single-graph-action-menu",payload:{menu:e}})}onOptionTap(e){e.key==="copy-share-link"?this.copyShareLink():(e.key==="delete-confirmation"||e.key==="move-graph")&&this.openMenu(e.key)}confirmDelete(){this.props.graph().recovery?this.controller.dispatch({type:"update-graphs-state",update:{type:"delete-recovery-graph-immediately",graph:this.props.graph()}}):this.controller.dispatch({type:"update-graphs-state",update:{type:"delete-graphs-immediately",graphs:[this.props.graph()]}})}backToOptions(){this.controller.dispatch({type:"set-single-graph-action-menu",payload:{menu:"options-list"}})}template(){return l(oa,{anchor:()=>l("div",{class:La.const("dcg-graph-list__row-action"),children:l(za,{})}),containerClassName:this.const("dcg-mygraph-actions-dropdown"),anchorAriaLabel:()=>this.controller.s("account-shell-narration-graph-options",{graphTitle:this.graphTitle}),guid:this.const(`saved-graphs--${this.props.graph().getCollectionKey()}`),dropdownProps:()=>({position:()=>"bottom-left",didMount:()=>this.controller.dispatch({type:"reset-single-graph-action-menu"})}),dropdownOffset:this.props.dropdownOffset,focusTrapping:this.const({itemNavigationKey:"arrow"}),anchorTapStopPropagation:this.const(!0),popoverBody:()=>k_e(()=>this.myGraphsController.singleGraphActionMenu,{"move-graph":()=>l(d2,{controller:()=>this.controller,graph:()=>this.props.graph()}),"options-list":()=>l("div",{onTap:e=>{e.stopPropagation()},children:l(Jl,{options:()=>this.graphActions,onTap:e=>this.onOptionTap(e)})}),"delete-confirmation":()=>l(Yy,{title:()=>this.controller.s("account-shell-heading-mygraphs-delete"),subtitle:()=>this.controller.s("account-shell-label-confirm-graph-delete",{count:__dcg_shared_module_exports__['Db'](1)}),backButton:()=>({onTap:()=>this.backToOptions(),ariaLabel:()=>this.controller.s("account-shell-button-cancel")}),children:x("div",{class:La.const("dcg-mygraph-delete-confirmation__buttons"),children:[l("button",{class:La.const("dcg-mygraph-delete-confirmation__delete-button dcg-btn-red"),onTap:()=>this.confirmDelete(),children:()=>this.controller.s("account-shell-button-mygraphs-delete-confirm")}),l("button",{class:La.const("dcg-gray-link dcg-unstyled-button"),onTap:()=>this.backToOptions(),children:()=>this.controller.s("account-shell-button-cancel")})]})})})})}},Yy=class extends La.View{template(){return x("div",{class:La.const("dcg-mygraph-action-menu"),onTap:e=>{e.stopPropagation()},children:[x("div",{class:La.const("dcg-mygraph-action-menu__header"),children:[Hie(()=>{var e,t;return(t=(e=this.props).backButton)==null?void 0:t.call(e)},e=>l("button",{class:La.const("dcg-mygraph-action-menu__back-button dcg-unstyled-button"),onTap:e().onTap,ariaLabel:e().ariaLabel,children:l("i",{class:La.const("dcg-icon-chevron-left"),"aria-hidden":La.const("true")})})),l("h1",{class:La.const("dcg-mygraph-action-menu__title dcg-unstyled-heading"),children:()=>this.props.title()})]}),Hie(()=>{var e,t;return(t=(e=this.props).subtitle)==null?void 0:t.call(e)},e=>l("h2",{class:La.const("dcg-mygraph-action-menu__subtitle dcg-unstyled-heading"),children:e})),this.props.children]})}};var{If:__e}=sa.Components,u2=class extends sa.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.myGraphsController=this.controller.mygraphsController}copyShareLink(){if(this.myGraphsController.selectedGraphCount()===1){let e=this.myGraphsController.selectedGraphs[0].getURLInterchangeableProducts();this.myGraphsController.copyShareLink(e)}}getOptions(){return[{title:()=>this.controller.s("account-shell-heading-mygraphs-copy-share-link"),icon:"dcg-icon-link",action:()=>this.copyShareLink(),class:"dcg-mygraphs-selected-toolbar__copy-link"}]}showDotDotDropdown(){return this.myGraphsController.selectedGraphCount()===1&&!this.myGraphsController.selectedGraphs[0].recovery}template(){return x("div",{class:sa.const("dcg-mygraphs-selected-toolbar"),children:[l("button",{class:sa.const("dcg-mygraphs-selected-toolbar__button dcg-unstyled-button"),onTap:()=>this.controller.dispatch({type:"deselect-all-graphs"}),ariaLabel:()=>this.controller.s("account-shell-narration-deselect-all-graphs"),children:l("i",{class:sa.const("dcg-icon-chevron-left"),"aria-hidden":sa.const("true")})}),l("div",{class:sa.const("dcg-mygraphs-selected-toolbar__selected-text"),children:()=>this.controller.s("account-shell-heading-mygraphs-saved-graphs-count",{count:__dcg_shared_module_exports__['Db'](this.myGraphsController.selectedGraphCount())})}),l(NB,{controller:this.props.controller}),l(__e,{predicate:()=>this.showDotDotDropdown(),children:()=>l(qm,{anchor:()=>l("div",{class:sa.const("dcg-mygraphs-selected-toolbar__button"),children:l(za,{})}),anchorAriaLabel:()=>this.controller.s("account-shell-narration-selected-graphs-options"),containerClassName:this.const("dcg-mygraphs-selected-toolbar__dropdown"),guid:this.const("selected-graphs-actions-dropdown"),hideArrow:this.const(!0),dropdownOffset:this.const(0),options:()=>this.getOptions()})})]})}},NB=class extends sa.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.myGraphsController=this.controller.mygraphsController,this.isPopoverOpen=!1}deleteSelectedGraphs(){let e=this.myGraphsController.selectedGraphs;this.isPopoverOpen=!1,this.controller.dispatch({type:"update-graphs-state",update:{type:"delete-graphs-immediately",graphs:e}})}setIsPopoverOpen(e){this.isPopoverOpen=e,this.update()}template(){return l(oa,{controlled:()=>({isOpen:this.isPopoverOpen,setDropdownOpen:this.setIsPopoverOpen.bind(this)}),containerClassName:this.const("dcg-mygraphs-toolbar-bulk-delete"),anchorAriaLabel:()=>this.controller.s("account-shell-narration-delete-selected-graphs"),anchor:()=>l("div",{class:sa.const("dcg-mygraphs-selected-toolbar__button"),children:l("i",{class:sa.const("dcg-icon-trashcan"),"aria-hidden":sa.const("true")})}),guid:this.const("selected-mygraphs-delete-confirmation"),dropdownOffset:this.const(0),dropdownProps:this.const({hideArrow:()=>!0,position:()=>"bottom-right"}),popoverBody:()=>l(Yy,{title:()=>this.controller.s("account-shell-heading-mygraphs-delete"),subtitle:()=>this.controller.s("account-shell-label-confirm-graph-delete",{count:__dcg_shared_module_exports__['Db'](this.myGraphsController.selectedGraphCount())}),children:x("div",{class:sa.const("dcg-mygraph-delete-confirmation__buttons"),children:[l("button",{class:sa.const("dcg-mygraph-delete-confirmation__delete-button dcg-btn-red"),onTap:()=>this.deleteSelectedGraphs(),children:()=>this.controller.s("account-shell-button-mygraphs-delete-confirm")}),l("button",{class:sa.const("dcg-gray-link dcg-unstyled-button"),onTap:()=>this.setIsPopoverOpen(!1),children:()=>this.controller.s("account-shell-button-cancel")})]})})})}};jo();var la=__dcg_shared_module_exports__['e'](j());var g2=__dcg_shared_module_exports__['e'](j()),h2=class extends g2.View{template(){return l("img",{class:g2.const("dcg-graph-thumbnail"),src:()=>this.props.thumbUrl(),width:()=>this.props.width()})}};var m2=__dcg_shared_module_exports__['e'](j()),vS=class extends m2.View{constructor(){super(...arguments),this.controller=this.props.controller()}template(){return l("div",{class:m2.const("dcg-my-graphs-modal__currently-open"),children:()=>this.controller.s("account-shell-text-mygraphs-currently-open")})}};var lf=__dcg_shared_module_exports__['e'](j());var uu=__dcg_shared_module_exports__['e'](j());var{Input:C_e}=uu.Components,f2=class extends uu.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.myGraphsController=this.controller.mygraphsController,this.name=this.folder.name||this.myGraphsController.defaultFolderName,this.isPopoverOpen=!1,this.options=[{title:()=>this.controller.s("graphing-calculator-narration-rename"),class:"dcg-folder-option dcg-folder-option--rename",icon:"dcg-icon-pencil",action:()=>this.onRenameOptionTap()}]}get folder(){return this.myGraphsController.getFolder(this.props.id())}onTap(){this.controller.dispatch({type:"toggle-folder-selection",payload:this.props.id()})}openFolder(){this.controller.dispatch({type:"set-open-folder",payload:this.props.id()})}onNameMount(e){this.nameElement=e,!(!this.myGraphsController.isFolderLastCreated(this.folder.id)||!this.nameElement)&&(this.nameElement.scrollIntoView({behavior:"smooth",block:"nearest"}),this.nameElement.focus(),this.nameElement.select())}onNameUnmount(){this.nameElement=void 0,this.myGraphsController.isFolderLastCreated(this.folder.id)&&this.myGraphsController.perform({type:"clear-last-created-folder-id"})}onNameFocus(){!this.nameElement||this.name!==this.myGraphsController.defaultFolderName||this.nameElement.select()}onNameInput(e){this.name=e}onNameKeyDown(e){!this.nameElement||e!=="Enter"||this.nameElement.blur()}onNameBlur(){if(this.nameElement){if(this.nameElement.scrollLeft=0,this.name||(this.name=this.myGraphsController.defaultFolderName),this.name===this.folder.name){this.update();return}this.myGraphsController.dispatch({type:"rename-folder",payload:{id:this.props.id(),name:this.name}})}}setIsPopoverOpen(e){this.folder.hasPendingChanges&&e||(this.isPopoverOpen=e,this.update())}onPopoverAnchorTap(){this.togglePopover()}togglePopover(){this.setIsPopoverOpen(!this.isPopoverOpen)}onRenameOptionTap(){this.nameElement&&(this.nameElement.focus(),this.nameElement.select(),this.togglePopover())}onOptionTap(e){var t;(t=e.action)==null||t.call(e)}template(){return x("li",{class:()=>({"dcg-folder":!0,"dcg-folder--selected":this.folder.isSelected,"dcg-folder--disabled":this.folder.hasPendingChanges}),onTap:e=>{e.target.classList.contains("dcg-folder")&&this.onTap()},onDblClick:()=>this.openFolder(),tabIndex:this.const(0),"aria-disabled":()=>this.folder.hasPendingChanges?!0:void 0,role:uu.const("option"),"aria-selected":()=>this.folder.isSelected,children:[x("h2",{class:uu.const("dcg-folder__header"),children:[l("i",{class:uu.const("dcg-folder__icon dcg-icon-folder"),"aria-hidden":uu.const("true")}),l(C_e,{class:this.const("dcg-folder__name"),onMount:e=>this.onNameMount(e),onUnmount:()=>this.onNameUnmount(),onInput:e=>this.onNameInput(e),onFocus:()=>this.onNameFocus(),onKeyDown:({key:e})=>this.onNameKeyDown(e),onBlur:()=>this.onNameBlur(),value:()=>{var e;return(e=this.name)!=null?e:this.folder.name}}),l(oa,{containerClassName:this.const("dcg-folder__options"),controlled:()=>({isOpen:this.isPopoverOpen,setDropdownOpen:this.setIsPopoverOpen.bind(this)}),anchor:()=>l(za,{}),anchorAriaLabel:()=>this.controller.s("account-shell-narration-graph-options",{graphTitle:this.folder.name}),guid:this.const(`my-graphs-folder-options-${this.folder.id}`),dropdownProps:()=>({position:()=>"bottom-left"}),dropdownOffset:this.const(-16),focusTrapping:this.const({itemNavigationKey:"arrow"}),anchorTapStopPropagation:this.const(!0),popoverBody:()=>l(Jl,{options:()=>this.options,onTap:e=>this.onOptionTap(e)})})]}),l("span",{class:uu.const("dcg-folder-item-count"),children:()=>this.controller.s("account-shell-text-my-graphs-folder-items",{count:this.folder.graphs.length})})]})}};var{For:T_e}=lf.Components,b2=class extends lf.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.myGraphsController=this.controller.mygraphsController}template(){return l("ul",{class:lf.const("dcg-folders dcg-unstyled-list"),role:lf.const("listbox"),"aria-multiselectable":lf.const("true"),children:l(T_e,{each:()=>this.myGraphsController.getFolderIds(),children:e=>l(f2,{controller:this.const(this.controller),id:this.const(e)})})})}};jo();var as=__dcg_shared_module_exports__['e'](j());var{IfElse:E_e}=as.Components,y2=class extends as.View{constructor(){super(...arguments),this.controller=this.props.controller()}template(){return x("div",{class:as.const("dcg-saved-graphs-tile-container"),children:[x("div",{class:()=>{var e,t;return{"dcg-saved-graphs-tile":!0,"dcg-selected":(t=(e=this.props).isSelected)==null?void 0:t.call(e)}},role:as.const("link"),tabIndex:as.const("0"),onTap:this.props.onTap,id:this.props.key,children:[x("div",{class:as.const("dcg-saved-graphs-tile__header"),children:[l("div",{class:as.const("dcg-saved-graphs-tile__product-icon"),children:l(Rs,{disabled:this.const(!0),name:()=>hg(this.props.product())})}),l("h2",{class:as.const("dcg-unstyled-heading dcg-saved-graphs-tile__title"),children:this.props.getTitle})]}),x("div",{class:as.const("dcg-saved-graphs-tile__image-container"),children:[l("span",{class:as.const("dcg-saved-graphs-tile__image"),style:this.const({"background-image":`url(${this.props.getImageURL()})`})}),E_e(()=>this.props.isCurrentlyOpen(),{true:()=>l("div",{class:as.const("dcg-saved-graphs-tile__subtitle--currently-open"),children:l(vS,{controller:this.props.controller})}),false:()=>l("h3",{class:as.const("dcg-unstyled-heading dcg-saved-graphs-tile__subtitle"),children:this.props.getSubtitle})})]})]}),l("div",{class:as.const("dcg-saved-graphs-tile__dropdown"),children:l(xS,{controller:()=>this.controller,graph:()=>this.props.graph(),dropdownOffset:this.const(-9)})})]})}};var{For:UB,If:x2,IfElse:jie,SwitchUnion:I_e}=la.Components,M_e=[{field:"name",labelKey:"shared-label-name"},{field:"last-edited",labelKey:"account-shell-label-mygraphs-last-edited",class:"dcg-graph-list__header-cell--small"},{field:"tool",labelKey:"shared-label-tool",class:"dcg-graph-list__header-cell--extra-small"}],v2=class extends la.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.myGraphsController=this.controller.mygraphsController,this.graphsController=this.controller.graphsController,this.previousNumberDisplayedSavedGraphs=this.myGraphsController.getSavedGraphsToDisplay().length}setSortField(e){this.controller.dispatch({type:"set-mygraphs-sort-field",sortField:e})}toggleSortDirection(){this.controller.dispatch({type:"toggle-mygraphs-sort-direction"})}onTableHeaderClick(e){e===this.myGraphsController.sorting.sortField?this.toggleSortDirection():this.setSortField(e)}getArrowDirectionClass(){return this.myGraphsController.sorting.reverseDirection?"dcg-graph-list__sort-arrow--up":"dcg-graph-list__sort-arrow--down"}onTapGraphTile(e,t){if(t.shiftKey&&!e.recovery){this.controller.dispatch({type:"toggle-graph-selected",graph:e});return}this.myGraphsController.isGraphSelected(e)&&this.myGraphsController.selectedGraphCount()===1?this.controller.dispatch({type:"fetch-graph-from-modal",graph:e}):this.controller.dispatch({type:"set-selected-graph",graph:e})}getNoSavedGraphsText(){return this.myGraphsController.searchFilter.length>0?this.controller.s("account-shell-text-mygraphs-no-graph-search-results"):this.myGraphsController.savedGraphsOption==="recovered-graphs"?this.controller.s("account-shell-text-mygraphs-no-unsaved-graphs"):this.controller.s("account-shell-text-mygraphs-no-saved-graphs")}isGraphCurrentlyOpen(e){return e.hash===this.graphsController.currentGraph.hash}didUpdate(){var e;this.previousNumberDisplayedSavedGraphs<this.myGraphsController.getSavedGraphsToDisplay().length&&((e=Array.from(document.querySelectorAll(".dcg-my-graphs-modal-saved-graphs .dcg-saved-graphs-tile"))[this.previousNumberDisplayedSavedGraphs])==null||e.focus(),this.previousNumberDisplayedSavedGraphs=this.myGraphsController.getSavedGraphsToDisplay().length)}showLoadingIndicator(){let e=this.myGraphsController.savedGraphsOption;switch(e){case"recovered-graphs":return this.graphsController.isFetchingRecoveryGraphs();case"saved-graphs":return this.graphsController.isSyncing();default:return e}}template(){return l("div",{children:jie(()=>this.showLoadingIndicator(),{true:()=>l(du,{class:this.const("dcg-my-graphs-modal__loading")}),false:()=>x("div",{children:[l(x2,{predicate:()=>this.myGraphsController.savedGraphsOption!=="recovered-graphs"&&this.myGraphsController.hasFolders()&&!this.myGraphsController.isFolderOpen(),children:()=>l(b2,{controller:this.const(this.controller)})}),l(x2,{predicate:()=>this.myGraphsController.getSavedGraphsToDisplay().length===0,children:()=>l("h2",{class:la.const("dcg-unstyled-heading dcg-my-graphs-modal__gray-heading dcg-my-graphs-modal__no-saved-graphs-heading"),children:()=>this.getNoSavedGraphsText()})}),I_e(()=>this.myGraphsController.graphLayout,{list:()=>x("table",{class:la.const("dcg-graph-list"),children:[l("thead",{children:x("tr",{class:la.const("dcg-graph-list__header-row"),children:[l(UB,{each:()=>M_e,children:e=>l("th",{class:()=>`dcg-graph-list__header-cell ${e.class||""}`,children:x("button",{class:la.const("dcg-unstyled-button dcg-graph-list__field-btn"),onTap:()=>this.onTableHeaderClick(e.field),children:[()=>this.controller.s(e.labelKey),l(x2,{predicate:()=>this.myGraphsController.sorting.sortField===e.field,children:()=>l("i",{class:()=>`dcg-icon-arrow-right dcg-graph-list__sort-arrow ${this.getArrowDirectionClass()}`})})]})})},e=>e.field),l("th",{class:la.const("dcg-graph-list__header-cell--extra-small")})]})}),l("tbody",{children:l(UB,{each:()=>this.myGraphsController.getSortedGraphs(),children:e=>x("tr",{class:()=>({"dcg-graph-list__row":!0,"dcg-graph-list__row--selected":this.myGraphsController.isGraphSelected(e)}),onTap:t=>this.onTapGraphTile(e,t),children:[x("td",{class:la.const("dcg-graph-list__row-cell dcg-graph-list__graph-title"),children:[l(h2,{thumbUrl:()=>e.thumbUrl,width:this.const(36)}),()=>e.getVisibleTitle(this.controller.s)]}),l("td",{class:la.const("dcg-graph-list__row-cell dcg-graph-list__row-date"),children:jie(()=>this.isGraphCurrentlyOpen(e),{true:()=>l(vS,{controller:this.props.controller}),false:()=>l("div",{children:()=>this.controller.unpack(e.displayDate())})})}),l("td",{class:la.const("dcg-graph-list__row-cell dcg-graph-list__row-tool-icon"),children:l(Rs,{disabled:this.const(!0),name:()=>hg(e.product)})}),l("td",{children:l("div",{class:la.const("dcg-graph-list__row-actions"),children:l(xS,{controller:()=>this.controller,graph:()=>e,dropdownOffset:this.const(-14)})})})]})},e=>e.getCollectionKey())})]}),grid:()=>l("ul",{class:la.const("dcg-unstyled-list dcg-my-graphs-modal__saved-graphs-tiles dcg-my-graphs-modal-saved-graphs"),children:l(UB,{each:()=>this.myGraphsController.getSortedGraphs(),children:e=>l("li",{children:l(y2,{controller:()=>this.controller,graph:()=>e,getSubtitle:()=>this.controller.unpack(e.displayDate()),getTitle:()=>e.getVisibleTitle(this.controller.s),getImageURL:()=>e.thumbUrl,onTap:t=>this.onTapGraphTile(e,t),product:()=>e.product,isSelected:()=>this.myGraphsController.isGraphSelected(e),isCurrentlyOpen:()=>this.isGraphCurrentlyOpen(e)},()=>e.getCollectionKey())})},e=>e.getCollectionKey())})}),l(x2,{predicate:()=>this.myGraphsController.shouldShowLoadMore(),children:()=>l("div",{role:la.const("link"),tabIndex:la.const("0"),class:la.const("dcg-blue-link dcg-my-graphs-modal__load-more-link"),onTap:()=>this.controller.dispatch({type:"load-more-graphs-from-modal"}),children:()=>this.controller.s("account-shell-text-mygraphs-load-more")})})]})})})}};var{IfElse:w2}=Pa.Components,D_e=["grid","list"],Xie={grid:{icon:"dcg-icon-grid",label:"account-shell-button-mygraphs-grid"},list:{icon:"dcg-icon-list",label:"account-shell-button-mygraphs-list"}},$ie={graphing:{icon:"dcg-my-graphs-modal-dropdown-icon dcg-shared-product-icon dcg-icon-graphing",label:"account-shell-text-mygraphs-examples-2d"},"geometry-calculator":{icon:"dcg-my-graphs-modal-dropdown-icon dcg-shared-product-icon dcg-icon-geometry",label:"account-shell-text-mygraphs-examples-3d"},"graphing-3d":{icon:"dcg-my-graphs-modal-dropdown-icon dcg-shared-product-icon dcg-icon-3d",label:"account-shell-text-mygraphs-examples-geometry"}},A_e=["saved-graphs","recovered-graphs"],Jie={"saved-graphs":"account-shell-heading-mygraphs-saved-graphs","recovered-graphs":"account-shell-heading-mygraphs-recovered-graphs"},S2=class extends Pa.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.myGraphsController=this.controller.mygraphsController,this.savedGraphsTabOptions=A_e.map(e=>({title:()=>this.controller.s(Jie[e]),action:()=>this.updateSavedGraphsOption(e)}))}getGraphLayoutOptions(){return D_e.map(e=>({key:e,icon:()=>Xie[e].icon,ariaLabel:()=>this.controller.s(Xie[e].label),selected:()=>e===this.myGraphsController.graphLayout,onSelect:()=>this.setGraphLayout(e)}))}getExampleGalleryFilterOptions(){return Lu.map(e=>({key:e,icon:()=>$ie[e].icon,ariaLabel:()=>this.controller.s($ie[e].label),selected:()=>e===this.myGraphsController.exampleGalleryFilter,onSelect:()=>this.setExampleGalleryFilter(e)}))}updateCurrentTab(e){this.controller.dispatch({type:"select-mygraphs-modal-tab",selectedTab:e})}updateSavedGraphsOption(e){this.controller.dispatch({type:"select-saved-graphs-option",selectedOption:e})}setGraphLayout(e){this.controller.dispatch({type:"update-mygraphs-layout",selectedGraphLayout:e})}setExampleGalleryFilter(e){this.controller.dispatch({type:"update-example-gallery-filter",productFilter:e})}getCurrentTitle(){let e=this.myGraphsController.savedGraphsOption;return this.controller.s(Jie[e])}template(){return x("div",{children:[w2(()=>this.myGraphsController.selectedGraphCount()>0,{true:()=>l(u2,{...this.props}),false:()=>x("div",{class:Pa.const("dcg-my-graphs-modal__options"),children:[w2(()=>this.myGraphsController.isFolderOpen(),{true:()=>x("div",{class:Pa.const("dcg-my-graphs-modal__folder-header"),children:[l("button",{class:Pa.const("dcg-my-graphs-modal__back-button dcg-unstyled-button"),onTap:()=>this.myGraphsController.dispatch({type:"set-open-folder",payload:void 0}),children:l("i",{class:Pa.const("dcg-icon-chevron-left"),"aria-hidden":Pa.const("true")})}),l("h2",{class:Pa.const("dcg-unstyled-heading dcg-my-graphs-modal__heading dcg-my-graphs-modal-saved-graphs-header dcg-selected"),children:()=>{var e;return(e=this.myGraphsController.getOpenFolder())==null?void 0:e.name}})]}),false:()=>x("div",{class:Pa.const("dcg-my-graphs-modal__tabs"),children:[l("a",{class:()=>({"dcg-unstyled-heading":!0,"dcg-my-graphs-modal__heading":!0,"dcg-my-graphs-modal-saved-graphs-header":!0,"dcg-selected":this.myGraphsController.currentTab==="my-graphs"}),onTap:()=>this.updateCurrentTab("my-graphs"),tabIndex:Pa.const("0"),children:()=>this.getCurrentTitle()}),l(qm,{anchor:()=>l("div",{class:Pa.const("dcg-my-graphs-modal__title-dropdown"),children:l("i",{class:Pa.const("dcg-icon-caret-down"),"aria-hidden":Pa.const("true")})}),anchorAriaLabel:()=>this.controller.s("account-shell-narration-saved-graphs-options"),guid:()=>"my-graphs-modal__saved-graphs-dropdown",dropdownOffset:this.const(15),options:()=>this.savedGraphsTabOptions}),l("a",{class:()=>({"dcg-unstyled-heading":!0,"dcg-my-graphs-modal__heading":!0,"dcg-my-graphs-modal-examples-header":!0,"dcg-selected":this.myGraphsController.currentTab==="example-graphs"}),onTap:()=>this.updateCurrentTab("example-graphs"),tabIndex:Pa.const("0"),children:()=>this.controller.s("account-shell-heading-mygraphs-examples")})]})}),l("div",{children:w2(()=>this.myGraphsController.currentTab==="example-graphs",{true:()=>l(ar,{theme:this.const("mini"),staticConfig:this.bindFn(this.getExampleGalleryFilterOptions),ariaGroupLabel:()=>this.controller.s("account-shell-narration-example-gallery-filter")}),false:()=>l(ar,{theme:this.const("mini"),staticConfig:this.bindFn(this.getGraphLayoutOptions),ariaGroupLabel:()=>this.controller.s("account-shell-narration-my-graphs-layout")})})})]})}),w2(()=>this.myGraphsController.currentTab==="example-graphs",{true:()=>l(c2,{controller:this.props.controller}),false:()=>l(v2,{controller:this.props.controller})})]})}};var By=__dcg_shared_module_exports__['e'](j());var Xh=__dcg_shared_module_exports__['e'](j());var L_e=["graphing","geometry-calculator","graphing-3d","folder"],k2=class extends Xh.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.dropdownOptions={graphing:{title:()=>this.controller.s("account-shell-button-mygraphs-new-graph"),icon:this.getProductIconClasses("dcg-icon-add-2d"),action:this.getOpenBlankGraphAction("graphing"),preventClose:!0},"geometry-calculator":{title:()=>this.controller.s("account-shell-button-mygraphs-new-geometry"),icon:this.getProductIconClasses("dcg-icon-add-geometry"),action:this.getOpenBlankGraphAction("geometry-calculator"),preventClose:!0},"graphing-3d":{title:()=>this.controller.s("account-shell-button-mygraphs-new-3d"),icon:this.getProductIconClasses("dcg-icon-add-3d"),action:this.getOpenBlankGraphAction("graphing-3d"),preventClose:!0},folder:{title:()=>this.controller.s("account-shell-button-mygraphs-new-folder"),icon:"dcg-my-graphs-modal__product-icon dcg-icon-add-folder",action:()=>this.controller.dispatch({type:"create-folder"})}}}getProductIconClasses(e){return"dcg-my-graphs-modal__product-icon dcg-my-graphs-modal__add-product-icon "+e}getOpenBlankGraphAction(e){return()=>this.controller.dispatch({type:"open-blank-graph-modal",product:e})}getNewItemDropdownOptions(){return L_e.map(e=>this.dropdownOptions[e])}template(){return x("div",{class:Xh.const("dcg-new-my-graphs-item__dropdown-section"),children:[x("button",{class:Xh.const("dcg-btn-gray-outline dcg-action-new-blank-graph-construction dcg-new-my-graphs-item__button"),onTap:this.getOpenBlankGraphAction(this.controller.getProduct()),children:[l("i",{class:()=>"dcg-new-my-graphs-item__icon "+this.dropdownOptions[this.controller.getProduct()].icon,"aria-hidden":Xh.const("true")}),()=>this.dropdownOptions[this.controller.getProduct()].title()]}),l(qm,{anchor:()=>l("div",{class:Xh.const("dcg-btn-gray-outline dcg-new-my-graphs-item__dropdown"),children:l("i",{class:Xh.const("dcg-icon-caret-down"),"aria-hidden":Xh.const("true")})}),anchorAriaLabel:()=>this.controller.s("account-shell-narration-new-graph-options"),guid:()=>"new-my-graphs-item-dropdown",hideArrow:this.const(!0),dropdownOffset:this.const(2),options:()=>this.getNewItemDropdownOptions()})]})}};var{Input:P_e}=By.Components,_2=class extends By.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.myGraphsController=this.controller.mygraphsController}updateSearchFilter(e){this.controller.dispatch({type:"set-my-graphs-search-filter",searchFilter:e})}template(){return x("div",{class:By.const("dcg-my-graphs-modal__header"),children:[l(k2,{controller:()=>this.controller}),l("div",{class:By.const("dcg-my-graphs-modal__search-bar"),children:l(P_e,{class:this.const("dcg-input-blue-outline"),name:this.const("my-graphs-modal-search"),placeholder:()=>this.controller.s("account-shell-text-mygraphs-search-by-title"),"aria-label":()=>this.controller.s("account-shell-narration-my-graphs-search"),value:()=>this.myGraphsController.searchFilter,maxLength:this.const("140"),onInput:e=>this.updateSearchFilter(e)})})]})}};var{IfDefined:G_e,IfElse:V_e}=Ky.Components,C2=class extends Ky.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.myGraphsController=this.controller.mygraphsController}template(){return x(go,{ariaLabel:()=>this.controller.s("account-shell-narration-my-graphs-modal"),size:this.const("fullscreen"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.const(this.controller),class:this.const("dcg-my-graphs-modal"),interceptEscape:()=>this.myGraphsController.selectedGraphCount()>0?(this.controller.dispatch({type:"deselect-all-graphs"}),!0):!1,children:[l(r2,{controller:this.props.controller}),V_e(()=>this.myGraphsController.isModalLoading,{true:()=>l(du,{class:this.const("dcg-my-graphs-modal__loading")}),false:()=>x("div",{children:[l(s2,{controller:()=>this.controller}),G_e(()=>this.graphsController.myGraphsModalFailureMessage,e=>l("div",{class:Ky.const("dcg-my-graphs-modal__error-message-toast"),children:e})),x("div",{class:Ky.const("dcg-my-graphs-modal__desktop-header-and-tile-content"),didMount:this.bindFn(this.didMountTileSection),didUnmount:this.bindFn(this.didUnmountTileSection),children:[l(_2,{controller:()=>this.controller}),l(yS,{getTitle:()=>this.graphsController.currentGraph.getVisibleTitle(this.controller.s),getDisplayDate:()=>this.controller.unpack(this.graphsController.getCurrentDisplayDate()),isOpen:this.const(!0),getThumbnail:()=>this.myGraphsController.getThumbnail(),isSaveEnabled:()=>this.controller.isSaveEnabled(),simpleSave:()=>this.controller.simpleSave(),openSaveDialog:()=>this.controller.openSaveDialog({fromSaveInProgress:!0}),wasCurrentGraphEverSaved:()=>this.graphsController.wasCurrentGraphEverSaved(),isSaving:()=>this.graphsController.isSaving(),didSaveRecentlySucceed:()=>this.graphsController.showSaveSuccessNotice(),didSaveRecentlyFail:()=>this.graphsController.showSaveFailNotice(),isSyncing:()=>this.graphsController.isSyncing(),willSaveCopy:()=>this.graphsController.willSaveCopy(),s:this.controller.s}),l(S2,{controller:()=>this.controller})]})]})})]})}didMount(){var e;_e(this.controller.s("account-shell-narration-mygraphs-open-graph")),(e=document.querySelector(".dcg-action-new-blank-graph-construction"))==null||e.focus()}didMountTileSection(e){re(e).on("keydown",t=>{if(this.controller.getOpenModal()==="my-graphs"){let o=document.querySelector(".dcg-action-new-blank-graph-construction"),i=Array.from(document.querySelectorAll(".dcg-my-graphs-modal-saved-graphs .dcg-saved-graphs-tile")),n=document.querySelector(".dcg-my-graphs-modal__load-more-link"),a=Array.from(document.querySelectorAll(".dcg-my-graphs-modal-examples .dcg-saved-graphs-tile")),s;n?s=[o,...i,n,...a]:s=[o,...i,...a];let c=s.findIndex(d=>d===document.activeElement);if(c!==-1)switch(Pe(t)){case Tn:return t.preventDefault(),c===0?void 0:s[c-1].focus();case Mi:return t.preventDefault(),c===s.length-1?void 0:s[c+1].focus()}}})}didUnmountTileSection(e){re(e).off("keydown")}};var Zie="/assets/build/eye-closed-UJEGA3IU.svg";var Qie="/assets/build/eye-open-BCWR7SYV.svg";var Bt=__dcg_shared_module_exports__['e'](j());var{For:F_e,If:T2,Input:fT,SwitchUnion:N_e,IfDefined:ene}=Bt.Components;function tne(){return window.googleAuthConnectionFailed}var E2=class extends Bt.View{template(){return l("input",{class:Bt.const("dcg-authentication-modal__input dcg-authentication-modal__input--email dcg-authentication-modal__input--hidden"),type:Bt.const("email"),value:this.bindFn(this.props.email),disabled:Bt.const(!0),tabIndex:Bt.const(-1)})}},I2=class extends Bt.View{constructor(){super(...arguments),this.passwordElementType="password"}onInputMount(e){var t,o;Hc||!((o=(t=this.props).withAutoFocus)!=null&&o.call(t))||(e.focus(),e.select())}onPasswordToggle(){this.passwordElementType=this.passwordElementType==="password"?"text":"password",this.update()}template(){return x("div",{class:Bt.const("dcg-authentication-modal__control dcg-authentication-modal__control--password"),children:[x("label",{class:()=>{var e,t;return{"dcg-authentication-modal__label":!0,"dcg-authentication-modal__label--password":!0,"dcg-authentication-modal__label--standalone":!!((t=(e=this.props).isSignUp)!=null&&t.call(e))}},children:[()=>{var e,t;return(t=(e=this.props).isSignUp)!=null&&t.call(e)?this.props.i18n("shared-label-create-password"):this.props.i18n("shared-label-enter-password")},l(fT,{id:this.const("authenticationModalPassword"),class:()=>{var e,t;return{"dcg-shared-input-blue-outline":!0,"dcg-authentication-modal__input":!0,"dcg-authentication-modal__input--password":!0,"dcg-disabled":!!((t=(e=this.props).isDisabled)!=null&&t.call(e))}},type:()=>this.passwordElementType,onInput:this.bindFn(this.props.onInput),value:this.bindFn(this.props.value),onMount:this.bindFn(this.onInputMount),onUnmount:this.bindFn(this.props.onUnmount),onEnterPressed:this.bindFn(this.props.onEnterPressed),disabled:()=>{var e,t;return!!((t=(e=this.props).isDisabled)!=null&&t.call(e))||void 0},autocomplete:()=>{var e,t;return(t=(e=this.props).isSignUp)!=null&&t.call(e)?"new-password":"current-password"}})]}),l(fT,{class:this.const("dcg-authentication-modal__button dcg-authentication-modal__button--password"),type:this.const("image"),src:()=>this.passwordElementType==="password"?Qie:Zie,alt:()=>this.passwordElementType==="password"?this.props.i18n("shared-button-show-password"):this.props.i18n("shared-button-hide-password"),onTap:this.bindFn(this.onPasswordToggle),onEnterPressed:this.bindFn(this.onPasswordToggle),value:this.const("")})]})}},M2=class extends Bt.View{template(){return x("label",{class:Bt.const("dcg-authentication-modal__label dcg-authentication-modal__label--standalone"),children:[()=>this.props.i18n("shared-label-choose-all-that-describe")," ",l("span",{class:Bt.const("dcg-authentication-modal__sublabel"),children:()=>this.props.i18n("shared-label-optional")}),l("ul",{class:Bt.const("dcg-unstyled-list dcg-authentication-modal__tag-control"),role:Bt.const("listbox"),"aria-multiselectable":Bt.const("true"),onKeyDown:this.bindFn(this.onKeyDown),children:l(F_e,{each:this.bindFn(this.props.tags),children:e=>x("li",{class:()=>({"dcg-authentication-modal__tag":!0,"dcg-authentication-modal__tag--selected":e.isSelected()}),onTap:()=>this.props.onSelect(e),"aria-selected":()=>e.isSelected(),tabIndex:()=>e.isSelected()||this.isFirstAndNoneSelected(e)?0:-1,role:Bt.const("option"),children:[l(T2,{predicate:()=>e.isSelected(),children:()=>l("i",{class:Bt.const("dcg-icon-check"),"aria-hidden":Bt.const("true")})}),()=>e.label]})},e=>e.id)})]})}isFirstAndNoneSelected(e){let t=this.props.tags()[0];return e.id===t.id&&!t.isSelected()}onKeyDown(e){var a,s,c,d;let t=Pe(e);if(!t||!["Up","Down","Right","Left"].includes(t)||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;e.preventDefault(),e.stopPropagation();let o=["Up","Left"].includes(t)?-1:1,i=".dcg-authentication-modal__tag",n=o===1?(s=(a=document.activeElement)==null?void 0:a.closest(i))==null?void 0:s.nextSibling:(d=(c=document.activeElement)==null?void 0:c.closest(i))==null?void 0:d.previousSibling;n&&"focus"in n&&typeof n.focus=="function"&&n.focus()}},bT=class extends Bt.View{getClassName(){switch(this.props.provider()){case"apple":return"dcg-authentication-modal__button--apple";case"google":return"dcg-authentication-modal__button--google"}}getButtonText(){switch(this.props.provider()){case"apple":return this.props.controller().s("shared-prompt-continue-with-apple");case"google":return this.props.controller().s("shared-prompt-continue-with-google")}}onSsoTap(e){this.props.controller().dispatch({type:"sso-log-in",payload:{provider:e}})}stepIsLoading(){var e;return((e=this.props.controller().userController.getAuthenticationStep().status)==null?void 0:e.type)==="loading"}isDisabled(){return this.props.provider()==="google"?tne()||this.stepIsLoading():this.stepIsLoading()}template(){return l("button",{class:()=>({"dcg-authentication-modal__button":!0,"dcg-authentication-modal__button--sso":!0,"dcg-btn-gray-outline":!0,"dcg-disabled":this.isDisabled(),[this.getClassName()]:!0}),didMount:e=>{var t,o;(o=(t=this.props).focusOnMount)!=null&&o.call(t)&&e.focus()},"aria-disabled":()=>this.isDisabled()?!0:void 0,disabled:()=>this.isDisabled()?!0:void 0,onTap:()=>this.onSsoTap(this.props.provider()),children:()=>this.getButtonText()})}},D2=class extends Bt.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.userController=this.controller.userController,this.email="",this.password="",this.firstName="",this.lastName="",this.selectedTags=new Set,this.tagLabels={student:this.controller.s("shared-button-student-classification"),teacher:this.controller.s("shared-button-teacher-classification"),"non-education":this.controller.s("shared-button-non-education-classification"),fun:this.controller.s("shared-button-fun-classification")}}getTags(){return Object.keys(this.tagLabels).map(e=>({id:e,label:this.tagLabels[e],isSelected:()=>this.selectedTags.has(e)}))}onClose(){this.controller.closeExternalLoginPopupWindow(),this.controller.dispatch({type:"close-modal"})}getTitle(){switch(this.userController.getAuthenticationStep().name){case"authenticate":return this.controller.s("shared-title-authenticate");case"email-login":case"previously-sso":return this.controller.s("shared-title-login");case"email-signup":return this.controller.s("shared-title-welcome");case"sso-confirmation":return this.controller.s("shared-title-welcome-with-name",{name:this.userController.getFullName()})}}withBackButton(){return["email-login","email-signup","previously-sso"].includes(this.userController.getAuthenticationStep().name)}onBack(){this.controller.dispatch({type:"previous-step"})}onEmailInputMount(e){this.emailElement=e,!Hc&&(e.focus(),e.select())}onEmailInputUnmount(){this.emailElement=void 0}onEmailInput(e){this.email=e,this.update()}isAuthenticateStepLoading(){var t;let e=this.userController.getAuthenticationStep();return e.name==="authenticate"&&((t=e.status)==null?void 0:t.type)==="loading"}isEmailInputDisabled(){return this.isAuthenticateStepLoading()}getAuthenticationStepError(e="authenticate"){var o;let t=this.userController.getAuthenticationStep();if(t.name===e&&((o=t.status)==null?void 0:o.type)==="error")return this.controller.s("account-shell-error-unknown");if(tne())return this.controller.s("shared-message-google-login-not-available")}onNext(){var e;!((e=this.emailElement)!=null&&e.reportValidity())||this.isNextButtonDisabled()||this.controller.dispatch({type:"get-email-registration-status",payload:{email:this.email}})}isNextButtonDisabled(){return!this.email||this.isAuthenticateStepLoading()}onPasswordUnmount(){this.password=""}onPasswordInput(e){this.password=e,this.update()}isPasswordInputDisabled(){var t,o;let e=this.userController.getAuthenticationStep();return e.name==="email-login"&&((t=e.status)==null?void 0:t.type)==="loading"||e.name==="email-signup"&&((o=e.status)==null?void 0:o.type)==="loading"}isLogInButtonDisabled(){var t;let e=this.userController.getAuthenticationStep();return e.name==="email-login"&&(((t=e.status)==null?void 0:t.type)==="loading"||!this.password)}onPasswordEnterPressed(){if(!(this.isLogInButtonDisabled()||this.isSignUpButtonDisabled())){if(this.userController.getAuthenticationStep().name==="email-signup"){this.controller.dispatch({type:"email-sign-up",payload:{i18n:this.controller.s,language:this.controller.getLanguage(),firstName:this.firstName,lastName:this.lastName,email:this.email,password:this.password,classifications:this.getSelectedTags().map(e=>e.id)}});return}this.controller.dispatch({type:"email-log-in",payload:{language:this.controller.getLanguage(),email:this.email,password:this.password,i18n:this.controller.s}})}}onSaveSsoConfirmationTap(){this.getSelectedTags().length>0&&this.controller.dispatch({type:"update-classifications",payload:{classifications:this.getSelectedTags().map(e=>e.id)}}),this.controller.dispatch({type:"close-modal"})}hasEmailLogInError(e=this.userController.getAuthenticationStep()){var t;return e.name==="email-login"&&((t=e.status)==null?void 0:t.type)==="error"}onFirstNameMount(e){Hc||e.focus()}onFirstNameInput(e){this.firstName=e,this.update()}isFirstNameInputDisabled(){var t;let e=this.userController.getAuthenticationStep();return e.name==="email-signup"&&((t=e.status)==null?void 0:t.type)==="loading"}onLastNameInput(e){this.lastName=e,this.update()}isLastNameInputDisabled(){var t;let e=this.userController.getAuthenticationStep();return e.name==="email-signup"&&((t=e.status)==null?void 0:t.type)==="loading"}isSignUpButtonDisabled(){var t;let e=this.userController.getAuthenticationStep();return e.name==="email-signup"&&(!this.firstName||!this.password||((t=e.status)==null?void 0:t.type)==="loading")}getSelectedTags(){return this.getTags().filter(e=>e.isSelected())}onTagSelect(e){e.isSelected()?this.selectedTags.delete(e.id):this.selectedTags.add(e.id),this.update()}hasEmailSignUpError(e=this.userController.getAuthenticationStep()){var t;return e.name==="email-signup"&&((t=e.status)==null?void 0:t.type)==="error"}onForgotPassword(){this.controller.emailForResetPassword=this.email,this.controller.dispatch({type:"show-modal",modal:"recover-password"})}getPreviousSsoSubtitle(e){switch(e){case"google":return this.controller.s("shared-text-previous-google");case"apple":return this.controller.s("shared-text-previous-apple")}}showTerms(){let e=this.userController.getAuthenticationStep().name;return["email-sign-up","authenticate","sso-confirmation"].includes(e)}template(){return x(go,{title:this.bindFn(this.getTitle),withStickyTitle:this.const(!0),withBackButton:this.bindFn(this.withBackButton),onBack:this.bindFn(this.onBack),size:this.const("tiny"),showX:this.const(!0),onClose:this.bindFn(this.onClose),i18n:this.const(this.controller),leftAlignTitle:this.const(!0),class:this.const("dcg-authentication-modal"),children:[N_e(()=>this.userController.getAuthenticationStep(),"name",{authenticate:()=>x("div",{class:Bt.const("dcg-authentication-modal__step dcg-authentication-modal__step--authenticate"),children:[l(bT,{provider:this.const("google"),controller:()=>this.controller}),l(bT,{provider:this.const("apple"),controller:()=>this.controller}),l("div",{role:Bt.const("separator"),class:Bt.const("dcg-authentication-modal__divider"),children:()=>this.controller.s("shared-text-or")}),x("div",{class:Bt.const("dcg-authentication-modal__control dcg-authentication-modal__control--email"),children:[x("label",{children:[()=>this.controller.s("shared-label-continue-with-email"),l(fT,{id:this.const("authenticationModalEmail"),class:()=>({"dcg-shared-input-blue-outline":!0,"dcg-authentication-modal__input":!0,"dcg-authentication-modal__input--email":!0,"dcg-disabled":this.isEmailInputDisabled()}),disabled:()=>this.isEmailInputDisabled(),type:this.const("email"),pattern:this.const(cu),onInput:this.bindFn(this.onEmailInput),value:()=>this.email,onMount:this.bindFn(this.onEmailInputMount),onUnmount:this.bindFn(this.onEmailInputUnmount),onEnterPressed:this.bindFn(this.onNext),autocomplete:this.const("username")})]}),l("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.isNextButtonDisabled(),"dcg-authentication-modal__button":!0,"dcg-authentication-modal__button--next":!0}),disabled:()=>this.isNextButtonDisabled()||void 0,onTap:this.bindFn(this.onNext),children:()=>this.controller.s("shared-button-next")})]}),ene(()=>this.getAuthenticationStepError(),e=>l("div",{class:Bt.const("dcg-authentication-modal__error"),role:Bt.const("alert"),children:e})),l("small",{class:Bt.const("dcg-authentication-modal__detail dcg-authentication-modal__detail--cookies"),children:l(Ot,{i18n:this.const(this.controller),children:"We use cookies only for logged in users. Please stay logged out to use Desmos without cookies."},this.const("shared-text-cookie-notice"))})]}),"email-login":()=>x("div",{class:Bt.const("dcg-authentication-modal__step dcg-authentication-modal__step--email-login"),children:[l(E2,{email:()=>this.email}),l(I2,{i18n:this.controller.s,withAutoFocus:this.const(!0),isDisabled:this.bindFn(this.isPasswordInputDisabled),onUnmount:this.bindFn(this.onPasswordUnmount),onInput:this.bindFn(this.onPasswordInput),value:()=>this.password,onEnterPressed:this.bindFn(this.onPasswordEnterPressed)}),x("div",{class:Bt.const("dcg-authentication-modal__button-group"),children:[l("button",{class:Bt.const("dcg-authentication-modal__detail dcg-authentication-modal__detail--forgot-password"),tabIndex:Bt.const(0),onTap:this.bindFn(this.onForgotPassword),children:()=>this.controller.s("shared-prompt-forgot-password")}),l("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.isLogInButtonDisabled(),"dcg-authentication-modal__button":!0,"dcg-authentication-modal__button--log-in":!0}),disabled:()=>this.isLogInButtonDisabled()||void 0,onTap:this.bindFn(this.onPasswordEnterPressed),children:()=>this.controller.s("shared-button-login-capitalized")})]}),l(T2,{predicate:this.bindFn(this.hasEmailLogInError),children:()=>l("div",{class:Bt.const("dcg-authentication-modal__error"),role:Bt.const("alert"),children:()=>{let e=this.userController.getAuthenticationStep();if(this.hasEmailLogInError(e))return e.status.message}})})]}),"email-signup":()=>x("div",{class:Bt.const("dcg-authentication-modal__step"),children:[l(E2,{email:()=>this.email}),l("h2",{class:Bt.const("dcg-authentication-modal__subtitle"),children:x(Ot,{i18n:this.const(this.controller),children:["You're signing up with ",l("b",{children:()=>this.email}),"."]},this.const("shared-title-using-for-sign-up"))}),x("div",{class:Bt.const("dcg-authentication-modal__input-group"),children:[x("label",{children:[()=>this.controller.s("shared-label-first-name"),l(fT,{class:()=>({"dcg-shared-input-blue-outline":!0,"dcg-authentication-modal__input":!0,"dcg-authentication-modal__input--first-name":!0,"dcg-disabled":this.isFirstNameInputDisabled()}),type:this.const("text"),onInput:this.bindFn(this.onFirstNameInput),value:()=>this.firstName,onMount:this.bindFn(this.onFirstNameMount),disabled:()=>this.isFirstNameInputDisabled()||void 0,autocomplete:this.const("given-name")})]}),x("label",{children:[()=>this.controller.s("shared-label-last-name")," ",l("span",{class:Bt.const("dcg-authentication-modal__sublabel dcg-authentication-modal__sublabel--shrunk"),children:()=>this.controller.s("shared-label-optional")}),l(fT,{class:()=>({"dcg-shared-input-blue-outline":!0,"dcg-authentication-modal__input":!0,"dcg-authentication-modal__input--last-name":!0,"dcg-disabled":this.isLastNameInputDisabled()}),type:this.const("text"),onInput:this.bindFn(this.onLastNameInput),value:()=>this.lastName,disabled:()=>this.isLastNameInputDisabled()||void 0,autocomplete:this.const("family-name")})]})]}),l(I2,{i18n:this.controller.s,isSignUp:this.const(!0),isDisabled:this.bindFn(this.isPasswordInputDisabled),onUnmount:this.bindFn(this.onPasswordUnmount),onInput:this.bindFn(this.onPasswordInput),value:()=>this.password,onEnterPressed:this.bindFn(this.onPasswordEnterPressed)}),l(M2,{i18n:this.controller.s,onSelect:this.bindFn(this.onTagSelect),tags:this.bindFn(this.getTags)}),l("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.isSignUpButtonDisabled(),"dcg-authentication-modal__button":!0,"dcg-authentication-modal__button--full-width":!0,"dcg-authentication-modal__button--sign-up":!0}),"aria-disabled":()=>this.isSignUpButtonDisabled()?"":void 0,onTap:this.bindFn(this.onPasswordEnterPressed),children:()=>this.controller.s("shared-button-sign-up")}),l(T2,{predicate:this.bindFn(this.hasEmailSignUpError),children:()=>l("div",{class:Bt.const("dcg-authentication-modal__error"),role:Bt.const("alert"),children:()=>{let e=this.userController.getAuthenticationStep();if(this.hasEmailSignUpError(e))return e.status.message}})})]}),"previously-sso":e=>x("div",{class:Bt.const("dcg-authentication-modal__step dcg-authentication-modal__step--previously-sso"),children:[l("h2",{class:Bt.const("dcg-authentication-modal__subtitle dcg-authentication-modal__subtitle-large-font"),children:()=>this.getPreviousSsoSubtitle(e().ssoProvider)}),l(bT,{provider:()=>e().ssoProvider,controller:()=>this.controller,focusOnMount:this.const(!0)}),l("button",{class:Bt.const("dcg-authentication-modal__detail dcg-unstyled-button dcg-authentication-modal__detail--set-password dcg-blue-link"),tabIndex:Bt.const(0),onTap:this.bindFn(this.onForgotPassword),children:()=>this.controller.s("shared-prompt-set-password")}),ene(()=>this.getAuthenticationStepError(),t=>l("div",{class:Bt.const("dcg-authentication-modal__error"),role:Bt.const("alert"),children:t}))]}),"sso-confirmation":()=>x("div",{class:Bt.const("dcg-authentication-modal__step dcg-authentication-modal__step--sso-confirmation"),children:[l("h2",{class:Bt.const("dcg-authentication-modal__subtitle"),children:x(Ot,{i18n:this.const(this.controller),children:["You signed up with"," ",l("b",{children:()=>this.userController.getEmail()}),". Finish setting up your account below."]},this.const("shared-title-account-finish-set-up"))}),l(M2,{i18n:this.controller.s,onSelect:this.bindFn(this.onTagSelect),tags:this.bindFn(this.getTags)}),l("button",{class:()=>({"dcg-btn-blue":!0,"dcg-authentication-modal__button":!0,"dcg-authentication-modal__button--full-width":!0,"dcg-authentication-modal__button--save":!0}),onTap:this.bindFn(this.onSaveSsoConfirmationTap),children:()=>this.controller.s("graphing-calculator-button-done")})]})}),l(T2,{predicate:()=>this.showTerms(),children:()=>l("small",{class:Bt.const("dcg-authentication-modal__detail dcg-authentication-modal__detail--privacy"),children:x(Ot,{i18n:this.props.controller,children:["By signing up, you agree to our"," ",l("a",{class:Bt.const("dcg-blue-link"),href:Bt.const("/privacy"),target:Bt.const("_blank"),children:"Privacy Policy"})," ","&"," ",l("a",{class:Bt.const("dcg-blue-link"),href:Bt.const("/terms"),target:Bt.const("_blank"),children:"Terms"}),"."]},this.const("shared-text-privacy-notice"))})})]})}};En();var ss=__dcg_shared_module_exports__['e'](j());var{IfDefined:U_e,For:Y_e}=ss.Components,A2={"dcg-actions":{label:"account-shell-label-feature-flag-actions",description:"account-shell-text-feature-flag-actions-description",learnMoreLink:"https://help.desmos.com/hc/en-us/articles/4407725009165"}},L2=class extends ss.View{init(){this.formErrors=[]}template(){return x("div",{class:ss.const("dcg-advanced-settings"),children:[l("div",{class:ss.const("dcg-shared-account-paragraph"),children:()=>this.props.controller().s("account-shell-text-advanced-preferences-instructions")}),l("div",{class:ss.const("dcg-feature-flag-list"),children:l(Y_e,{each:()=>Object.keys(A2),children:e=>x("div",{children:[l(ft,{checked:()=>this.isFeatureFlagEnabled(e),disabled:()=>!!this.updateInFlight,onChange:t=>this.toggleFeatureFlag(e,t),children:l("span",{class:ss.const("dcg-feature-flag-label"),children:()=>this.label(e)})}),x("div",{class:ss.const("dcg-feature-flag-description"),children:[()=>this.description(e)," ",l("a",{href:()=>this.learnMoreLink(e),class:ss.const("dcg-blue-link"),target:ss.const("_blank"),children:()=>this.props.controller().s("graphing-calculator-link-learn-more")})]})]})})}),l(Da,{controller:this.props.controller,errors:()=>this.formErrors}),U_e(this.bindFn(this.getSaveProgress),e=>x("span",{"aria-live":ss.const("assertive"),"aria-atomic":ss.const("true"),class:ss.const("dcg-shared-confirmation-message"),children:[l("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0,"dcg-saving":e()==="saving"}),"aria-hidden":ss.const("true")}),()=>e()==="saving"?this.props.controller().s("shared-calculator-label-saving"):this.props.controller().s("shared-message-information-saved")]}))]})}getSaveProgress(){if(this.updateInFlight)return"saving";if(this.showSuccessConfirmation)return"saved"}isFeatureFlagEnabled(e){return this.updateInFlight&&e in this.updateInFlight?this.updateInFlight[e]:this.props.controller().userController.getFeatureFlags().indexOf(e)!==-1}async toggleFeatureFlag(e,t){this.updateInFlight={[e]:t},this.props.controller().dispatch({type:"render"});try{if(await this.props.controller().userController.updateFeatureFlags({featureFlagsUpdate:this.updateInFlight,lang:this.props.controller().getLanguage()}),!this._isMounted)return;this.showSuccessConfirmation=!0,setTimeout(this.bindIfMounted(()=>{this.showSuccessConfirmation=!1,this.props.controller().dispatch({type:"render"})}),3e3)}catch(o){if(!this._isMounted)return;Er(o),this.formErrors=this.props.controller().parseJSONErrors(o)}finally{this._isMounted&&(this.updateInFlight=void 0,this.props.controller().dispatch({type:"render"}))}}learnMoreLink(e){return A2[e].learnMoreLink}label(e){return this.props.controller().s(A2[e].label)}description(e){return this.props.controller().s(A2[e].description)}};jo();jo();function YB(){return Di("/account/logout_xhr")}async function rne(r){return await YB(),await Di("/account/login_xhr",r),wS({lang:r.lang})}function one(r){if("loggedIn"in r&&!r.loggedIn)throw r;return r}async function wS(r){return one(await Jc("/account/user_info",r))}async function P2(){return one(await Jc("/account/user_info?no401"))}var ine=r=>qf(()=>Di("/account/check_account_status",r)),nne=async r=>(await Di("/account/register_xhr",r),wS({lang:r.lang})),B_e={google:"/drive_api/calculator/login",apple:"/apple_api/calculator/login"},ane=r=>`${Xu()}${B_e[r]}`;function sne(r,{classifications:e}){return qf(()=>wH(`/account/${r}/metadata`,{metadata:{selfClassifications:e}}))}async function lne(r){return await Di("/account/change_name",r),wS({lang:r.lang})}async function cne(r){return await Di("/account/change_name_detail",{lang:r.lang,userProvidedName:{given:r.given,family:r.family}}),wS({lang:r.lang})}function dne(r){return Di("/account/recover_xhr",r)}function pne(r){return Jc("/account/initiate_delete_account",r)}function une(r){return Jc("/account/initiate_email_change",r)}async function hne(r){return await Di("/account/set_email",r),wS({lang:r.lang})}async function gne(r){return await kH("/account/update_feature_flags",r),wS({lang:r.lang})}var mne=()=>Jc("/account/dismissed-notices"),fne=async r=>{await Di(`/account/dismissed-notices/${r}`)};function bne(r){return Di(`/account/art_contest_submissions${r.submission_id?`/${r.submission_id}`:""}`,r)}var cf=async({year:r,product:e})=>{var i;let t=Hi("userId"),o;try{o=(i=await Jc("/account/art_contest_submissions",{year:String(r),product:e,userId:t}))!=null?i:[]}catch(n){if((n==null?void 0:n.status)!==401)throw n;return[]}return Array.isArray(o)?o:[o]},yne=r=>qf(()=>Jc(`/account/${r}/registration`));var qe=__dcg_shared_module_exports__['e'](j());var xne="/assets/build/13-14-play-img-RHLTY5XV.png";var vne="/assets/build/13-14-pythagorean-img-WSKSNUHG.png";var wne="/assets/build/13-14-sunset-on-the-hudson-img-D4DHJBLE.png";var Sne="/assets/build/13-14-tiger-img-UHUHAIFL.png";var kne="/assets/build/13-14-turtle-img-CDEITE2Q.png";var _ne="/assets/build/15-16-atom-img-TAA77OSZ.png";var Cne="/assets/build/15-16-desgolf-img-5R72LAJ4.png";var Tne="/assets/build/15-16-match-img-VYMGAXL5.png";var Ene="/assets/build/15-16-scream-img-QCM2FBGU.png";var Ine="/assets/build/17-18-nighthawks-img-L6G4REOI.png";var Mne="/assets/build/17-18-rhythm-img-OBOKLGYD.png";var Dne="/assets/build/17-18-sailboat-sunset-img-PQNFRDFU.png";var Ane="/assets/build/19-digit-img-373B3TOE.png";var Lne="/assets/build/19-guitar-img-MFZDLYME.png";var Pne="/assets/build/19-refraction-img-Y54IA473.png";var Gne="/assets/build/constellations-TLH4I45P.png";var Vne="/assets/build/moving-mountains-XJD6F2RW.png";var One="/assets/build/sudoku-ZTDDHG6H.png";var Rne="/assets/build/voxel-maker-JFPANGUM.png";var Fne=[{ageRange:"13-14",title:"Twilight Citadel",hash:"7phesdm2cz",name:"Izabelle Ott-Rodriguez",country:"United States",statement:"Hellooo, I made this graph using elements from story ideas I've come up with and drawn. (This specific one is from a scrapped/unfinished sketch for a little world.) I love to write and draw characters and junk, so I thought it would be fun to share.",tool:"2d"},{ageRange:"13-14",title:"Human Being",originalHash:"o6q6bg2pdc",hash:"yst109dpka",name:"Ridham Shroff",country:"United States",statement:"For this Desmos art project, I decided to make a human being. Human beings are great, and they're even better with sunglasses, so I added some. I also tried experimenting with Desmos in doing things like the explosion.",tool:"geometry"},{ageRange:"13-14",title:"Sunset on the Hudson",hash:"nkwvtfuv99",name:"Richard He",country:"United States",statement:"The first time I saw the Hudson River from the park near my school, I was amazed how beautiful the skyline looked. When I found out about this contest, I knew that I wanted to create a graph based on that. My friend and I took a few pictures to use as a reference, and I used those to create this graph.",hasSound:!0,tool:"2d",thumbUrl:wne,lightOnDark:!0},{ageRange:"13-14",title:"Solar System Model",hash:"fb53e63bd9",name:"Ty Reyna",country:"United States",lightOnDark:!0,statement:"I made this graph for my science class with the goal of creating a new type of solar system model that stands out, despite its limitation to a screen.",tool:"3d",videoUrl:"13-14-solar-system-image",reverseContrast:!0,originalHash:"25d44ecc16"},{ageRange:"13-14",title:"Tiger",hash:"eyngvuepdq",name:"Charlene Uyen Dung Tran",country:"United States",statement:"As a kid, the tiger always played a big role in my life. I created many works of art related to tigers and appreciated them for their beauty. Nowadays, as mankind continues to destroy forests and jungles, I hope not only for the tigers but also for all endangered species to be appreciated. That is why I created this.",tool:"2d",thumbUrl:Sne},{ageRange:"13-14",title:"Perseverence Mars Rover",hash:"kkizngmfli",name:"Claire Bancroft",country:"United States",statement:"Throughout my life, I have always had a deep love for both astronomy and math. After discovering Desmos and seeing this math art contest, I decided to put my two loves together and create this graph. Using all the math knowledge I have, I did my best to make this graph, and I greatly enjoyed designing it!",tool:"2d",lightOnDark:!0,videoUrl:"13-14-perseverence-mars-rover"},{ageRange:"13-14",title:"Winter Friend",hash:"blszgngt6l",name:"Avrill",country:"United States",statement:"It\u2019s been really fun working on Desmos and learning so much about mathematics while exploring this wonderful new art medium! This graph is based on my cat, who spent many hours sitting on my lap while I worked on it. Hope you enjoy!",tool:"2d"},{ageRange:"13-14",title:"Six",hash:"8q0nbjcqqh",name:"Olivia H",country:"United States",statement:`There are, of course, six default Desmos colors, and it's also my favorite number, so I decided to make the number six the theme of this project. The graph features various objects related to the number six, including the tally marks representing six, the cuboid box, the balloon from the music video of Schoolhouse Rock's "I Got Six," the D6 die, the double-six domino, the hexagon around "SIX," the proton symbolizing the six types of quarks in quantum physics, and the equation used for the background: r tan(\u03B8*2.6) = 6.`,tool:"2d"},{ageRange:"13-14",title:"The Beauty of Parabolas",hash:"ceyyqvbpl1",name:"Ananth Arunkumar",country:"Canada",statement:`For this year's Desmos Math Art Contest, I decided to make a fox out of only parabolas.

I've always found parabolas interesting. There's something about the way that a function as simple as x^2 is so useful. For example, it matches the position/time graph of a thrown object without air friction and is also the set of points equidistant to a point and a line. Isn't that just so poetic, in the way that math is?

After deciding that I would only use parabolas, I found some nice reference images online with cute looking foxes. I decided to take inspiration from them and make a simple sketch.

I put the two ideas together, and I created this fox. Enjoy!`,tool:"2d"},{ageRange:"13-14",title:"Playing the Tempest",hash:"yvchjdew6g",name:"Nick Ertman",country:"United States",statement:`This graph started as just an experiment with the new tone feature of Desmos. As someone who enjoys classical music and plays piano, I wanted to try to recreate part of one of my favorite piano sonatas in Desmos: Beethoven's Piano Sonata in D minor, Opus 31, Number 2, "The Tempest." I also enjoy the videos on the internet of people playing the piano with the falling notes from the top, so when I found an equation that could turn my already existing list into a visual, I decided to try to turn my tone experiment into a large-scale Desmos project: this graph.`,hasSound:!0,tool:"2d",videoUrl:"13-14-playing-the-tempest",lightOnDark:!0,thumbUrl:xne,originalHash:"wzdvupx6tf"},{ageRange:"13-14",title:"Voxel Scene",hash:"b12dcd4f71",name:"Mourya Peri",country:"United States",statement:"A few months ago, I learned about voxel art. I already knew about pixel art prior to this, but before then, I didn't know that it was also a thing in 3d and had a whole community behind it. When I saw that Desmos had made a 3d graphing version, I decided to try making some art.",tool:"3d",videoUrl:"13-14-voxel-scene"},{ageRange:"13-14",title:"Silhouette",hash:"dyiozkxqcj",name:"Hazel Chen",country:"United States",statement:"I love looking at natural landscapes, especially those with sunsets or sunrises. This graph was inspired by a Tanzanian sunset, except I decided to add a little twist to the scenery and make it inside a silhouette. Thank you, Desmos! I had so much fun making this graph!",tool:"2d",videoUrl:"13-14-silhouette",originalHash:"ll88scwnn8"},{ageRange:"13-14",title:"An Animation Equation",hash:"g3axyvjhrd",name:"Raghav Rajendran",country:"United Kingdom",statement:"For my first time submitting a graph to the Desmos Art Contest, I wanted to make infinite animation loops, with algorithms as my subject. I then created four of these loops representing Timing, Information, Stability and Creativity, four of their core ideas. This was quite a step up from my previous uses of the Desmos graphing calculator (a static image and a 3D renderer), but it turned out better than I had expected.",tool:"2d",videoUrl:"13-14-an-animation-equation",lightOnDark:!0,originalHash:"abayooixuv"},{ageRange:"13-14",title:"Skiing Forever",hash:"ryn4gxvugr",name:"Diana Anvari",country:"United States",statement:"During 2021-2022, I lived in a small town in Tahoe. Throughout that year, I started to love skiing, and found it a great outlet to ease my mind. I'd ski every minute of the winter season for whatever time I had. This could be from open to close, or just for the hour of free time I had after school before it closed.",tool:"2d",videoUrl:"13-14-skiing-forever",originalHash:"imqg09xnvc"},{ageRange:"13-14",title:"Desmos Turtle",hash:"d375058370",name:"Sir Canis IV",country:"United States",statement:"It has always been my dream to combine my love of art with my love of mathematics. That's why I created D\u{1D5F2}\u{1D600}\u{1D5FA}\u{1D5FC}\u{1D600} \u{1D447}\u{1D462}\u{1D45F}\u{1D461}\u{1D459}\u{1D452} 3D.",tool:"3d",videoUrl:"13-14-desmos-turtle",thumbUrl:kne},{ageRange:"13-14",title:"Perry the Parametric Pencil",hash:"5b8u4ljy89",name:"Courtney Winkowski",country:"United States",statement:"This is Perry the Parametric Pencil, and he can draw hundreds of unique parametric equations! All his drawings represent the many different kinds of artwork around the world and the versatility of the pencil. Every piece of art is an expression (pun intended) of the artist\u2019s individuality, and Perry is the sole embodiment of our expression.",tool:"2d",videoUrl:"13-14-perry-the-parametric-pencil",originalHash:"g1yecpbmhv"},{ageRange:"13-14",title:"3D Printing",hash:"17c9afc22a",name:"\u865E\u4EF2\u73AE",country:"China",statement:"This is a 3D printer.",tool:"3d",originalHash:"558841a4d5"},{ageRange:"13-14",title:"Climate Change",hash:"dkutzwzs05",name:"Ella Sugarman",country:"United States",statement:"I have always loved being in nature, away from the sounds of cities and cars. I also love snow and all of the activities that come with snow, like skiing and sledding. All of these things I love will quickly disappear due to climate change. I combined my love of math and coding with my interest in stopping climate change to create this graph on Desmos. I created a visual representation of what will happen and what is already happening to our world. In my project, I created an ocean with a cliff and a small city on top, overlooking it. In the ocean, there are icebergs that melt as the animation is played. The iceberg, that is originally home to the penguin, melts, dropping the penguin into the water. The animation represents time. (The animations were really glitchy on the computer I was using, so they might still be really glitchy.)",tool:"2d",originalHash:"qtnnopxsjn"},{ageRange:"13-14",title:"Pythagorean Theorem",hash:"5shw8dydms",name:"Bret Huang",country:"United States",statement:"I have been studying Euclid's propositions in math class, and after learning Euclid's method of proving the Pythagorean Theorem (or, in Euclid's words, Proposition 47), I decided to make a visual representation of it. I really enjoyed making this animation/video, and I hope you like it!!",tool:"geometry",thumbUrl:vne,originalHash:"ghhh9wydd8"},{ageRange:"13-14",title:"A New Feathery Friend",hash:"jnxtmwm0mk",name:"Maya Arnon",country:"Israel",statement:"It was a hot sunny day in the middle of October. My friend and I were preparing for our next class when suddenly we noticed a bird lying on the ground, barely breathing. It could have been due to the intense heat. Carefully, we picked up the bird, carried it inside, and gave our new feathery friend some food and water. After a brief rest, the bird began to recover, and our friend was ready to fly. :) A moment before parting ways, we took this photograph. I really loved the way the photo turned out, so I tried to recreate it in Desmos. I absolutely loved the final result, and I hope that the Desmos community will love it too.",tool:"2d"},{ageRange:"13-14",title:"Mochi Pounding",hash:"113ba91a15",name:"Hinata Asou",country:"Japan",statement:'This digital art work was created by a student at Tezukayama Gakuin Izumigaoka Junior High School. It shows a Japanese New Year tradition called "mochi pounding.',tool:"3d",videoUrl:"13-14-mochi-pounding",originalHash:"f2d0b8824d"},{ageRange:"13-14",title:"Penguin on Ice",hash:"uhwww8wpef",name:"Evan Chen",country:"United States",statement:"I have always really loved using math to create beautiful things. So, when I learned about the Desmos Art Contest, I decided to give it a go. Throughout this graph, I tried to challenge myself to use complex equations and animation, and I ended up learning a lot!",tool:"2d",videoUrl:"13-14-penguin-on-ice",originalHash:"gmeadyrdkv"},{ageRange:"13-14",title:"Wang Zhenyi",hash:"k47oc6vefy",name:"Chian-Shin Du",country:"United States",statement:"This graph is of Wang Zhenyi, a female astronomer and mathematician who lived during the Qing Dynasty in China. She is inspiring to me because she worked hard to achieve success despite social barriers. I thinks she deserves more recognition for her work, so I graphed her.",tool:"2d",originalHash:"agtktkekzb"},{ageRange:"13-14",title:'Desmos "A Broken World',hash:"1n0zxuo0j9",name:"Joshua Tellez",country:"United States",statement:"I originally decided to make a song because I've always loved music, and I made it on a free app that comes on all mobile devices nowadays. I also started picking up Desmos around this time and learning how to do cool things like write functions, so one day I just thought that it would be fun to make a song in Desmos.",hasSound:!0,tool:"2d",videoUrl:"13-14-desmos-a-broken-world"},{ageRange:"13-14",title:"It's a Big World Out There",hash:"9y4p4dh93t",name:"Holly Beck",country:"United States",statement:`For this contest, I wanted to capture the wonder of the world we live in. This all started because of a phrase my mom always says, "it's a small world". And while the world immediately surrounding us seems small, when you look outside your small world, you see something much more beautiful and powerful than you could ever imagine. I've always loved math and art, and combining them wasn't an idea that I've ever explored before, so I decided to give it a shot. I'm super proud of the end result. (Also, the cat's name is Muffin.)`,tool:"2d",lightOnDark:!0},{ageRange:"15-16",title:"TJHSST Portrait",hash:"soxwtem4b7",name:"Catelyn Dao",country:"United States",statement:"This is Thomas Jefferson High School for Science and Technology, the institution that I am so proud to call my school. From driving by the beautiful campus almost every day for as long as I can remember, to eventually having the honor of being a student and calling it my home away from home, it has been a monumental part of my life journey and I would not be where I am today without it. TJ is truly a one of a kind school in so many ways, from its loving community and environment to advanced facilities and cutting-edge technologies, and I hope that you can appreciate my attempt to capture the unique qualities of this amazing school.",tool:"2d",videoUrl:"15-16-TJHSST-Portrait",lightOnDark:!0},{ageRange:"15-16",title:"Evolution of the Hydrogen Atom",hash:"kelsqtspjv",name:"Marcus Liu",country:"New Zealand",statement:"I've always liked physics, but especially the creation and refinement of theories in physics. So, I decided to make a timeline of sorts of the most iconic symbol in physics, and science in general, the atom.",tool:"2d",thumbUrl:_ne},{ageRange:"15-16",title:"Johnny the Horse",hash:"yekm2uu9qh",name:"Ariella Goldgewert",country:"United states",statement:"This graph commemorates Johnny, a horse I rescued in the summer of 2022, imparting countless lessons. The image is my artistic interpretation of a picture taken with Johnny, capturing our special bond. Through this graph, I honor Johnny's legacy and the infinite wisdom he shared with me during our time together.",tool:"2d"},{ageRange:"15-16",title:"Planet III Or, The Model",hash:"vgglvqvjpx",name:"Nathaniel Son",country:"United States",statement:"A lot of the elements of this graph are based off of my personal experiences, such as the mountains representing my love for hiking and the lighthouse representing my affinity for beaches. I've been drawing for a long time, and I think the fusion of math and art offered by the Desmos graphing calculator is pretty cool. I guess this graph could represent finding joy in the small things, as a lot of the parts I worked the hardest on are invisible when the graph is zoomed out all the way.",tool:"2d",videoUrl:"15-16-planet-iii-or",lightOnDark:!0},{ageRange:"15-16",title:"Voxel Art Maker (v8)",hash:"cb0zqnlc6n",name:"Lennon Wielechowski",country:"United States",statement:"This is my Voxel Art Maker! I wanted to create a submission that both displays art, and allows the user to create it for themselves. I hope that whoever uses this graph finds happiness from the creativity, and develops a curiosity about the intricacies of mathematics.",tool:"2d",thumbUrl:Rne},{ageRange:"15-16",title:"Moonlit Night",hash:"prc3kk8fju",name:"Annie Lewis",country:"United States",statement:"I love making music on Desmos and showing it to my friends. I put the song Canon in D by Pachelbel into the graph because it is a peaceful and interesting song; along with the music, I put some nice mountains in the background because I enjoy painting landscapes. Through this project, I have learned a lot more about Desmos, and that is all that matters to me.",hasSound:!0,tool:"geometry",videoUrl:"15-16-moonlit-night",lightOnDark:!0},{ageRange:"15-16",title:"Silent Scream",hash:"mdmf4zoiuy",name:"Shino Yamamoto",country:"Japan",statement:"I made someone watching the first sunrise of the year rising from Mt. Fuji. A breathtaking moment of tension at the sight of Mother Nature is burned into my brain. I love that moment when I\u2019m overwhelmed by nature because I feel so alive.",tool:"2d",thumbUrl:Ene},{ageRange:"15-16",title:"\u{1F432}Wish You A Happy Year of the Dragon\u{1F432}",hash:"5xxkh2vqeo",name:"HDAsian",country:"China",statement:"This graph is a mixture of the beauty of Chinese culture and the beauty of maths. Most of the elements in the graph is Chinese style. I love the Chinese dragon and I think it's cool to make artwork for it and submit it in 2024--the Year of Dragon! May health and luck be with you with the dragon's blessing!",tool:"2d"},{ageRange:"15-16",title:"The Water's Edge",hash:"lsco5v79y2",name:"JQ Chong",country:"Australia",statement:"This scene depicts a section of Western Australian bushland adjacent to the coast. I made this to explore all the interesting maths on Desmos as well as to showcase the incredible native flora and fauna that this area has to offer.",tool:"2d",videoUrl:"15-16-the-waters- edge",lightOnDark:!0},{ageRange:"15-16",title:"Penstriped",hash:"dsvii2yxb4",name:"Choomber & Khuenyy",country:"United States",statement:"Ever since a fated Desmos project in freshman year, I found a hobby making graphs of the characters and art I liked - the messier and more expressive, the better. Usually, it would be art of existing characters (uh-oh!), so when the annual Art Contest rolled around, I approached a friend to put help me put together this piece. With functions acting like the stroke of a pen, I hope this graph communicates the same joy of pairing math and art to make something simply fun. -Choomber",tool:"2d",videoUrl:"15-16-penstriped",lightOnDark:!0},{ageRange:"15-16",title:"Blossom",hash:"opmp5uwki5",name:"Sophie Morgan",country:"United Kingdom",statement:"I wanted to enter as two of the main subjects I am interested in are maths and art, and I decided that I wanted to depict something natural, as I have always been interested in the way in which maths is so integrated into patterns and textures in the environment. When I started to work on making a graph, I discovered the rose curve, which is what the majority of my piece is based on, and I thought that this would be a perfect thing to experiment with and show in my artwork. I also wanted to explore the changing of seasons through using light and colour in my piece, as I thought that it would be cool to see how I could model these through just using a combination of equations and variables, showing just how closely linked maths in with nature.",tool:"2d",videoUrl:"15-16-blossom",originalHash:"p4rikoagvl"},{ageRange:"15-16",title:"Desgolf",hash:"yfzhd3t6se",name:"Bandhu (Miles Gupta)",country:"United States",statement:"My name is Miles Gupta, I have loved math since I started school. Games have always been a big part of my life and I love to create them. I wanted to push myself to create a game in a graphing calculator, and that is why I created Desgolf. (Note: This game is designed to be played on around a 16:9 aspect ratio with at least 800 pixels height and 1100 pixels width.)",tool:"2d",thumbUrl:Cne},{ageRange:"15-16",title:"Tima Nigroannulata (Jellyfish)",hash:"fi043myfki",name:"Natrioj",country:"Japan",statement:"When I saw this jellyfish, I was drawn to its beauty and eeriness, so I thought I could somehow recreate it and created this piece. I had just been dealing with parametric variable representation in my math class, so I utilized it as much as possible.",tool:"2d",videoUrl:"15-16-tima-nigroannulata",lightOnDark:!0,originalHash:"2p6yedqhc2"},{ageRange:"15-16",title:"Don't Drag On",hash:"f4c36fb484",name:"Daniel W",country:"Hong Kong",statement:"2024 is the year of the Dragon based on the Chinese zodiac. In Chinese culture, the dragon symbolizes transformation, growth, and prosperity with its vibrant, colorful appearance signifying good fortune. Each color represents different aspects of the year: Red - luck and happiness; Yellow/Purple - wealth and wisdom; Green - new life and nature; Blue - harmony and peace; White - purity. In short, a Dragon year always brings good tidings. May there be peace and stability throughout the world.",hasSound:!0,tool:"3d",videoUrl:"15-16-dont-drag-on",originalHash:"f8d433bb76"},{ageRange:"15-16",title:"Transformation",hash:"6d209d2062",name:"Yaroslava Cheshkovskaya",country:"Estonia",statement:"I enjoy writing music, doing 3D modeling and mathematics. Desmos 3D gave me the opportunity to combine my favorite hobbies into one project, and working on it was really interesting and cool!",hasSound:!0,tool:"3d",originalHash:"498356de51"},{ageRange:"15-16",title:"The Collector's Curve",hash:"agmww61u8l",name:"Louis du Plessis",country:"South Africa",statement:"An animated scene featuring a procedurally generated sea creature lying in wait by a spent space capsule, inspired by the concept of the collector's curve, which predicts there to be about 6 more undiscovered sea monsters within the ocean.",hasSound:!0,tool:"geometry",videoUrl:"15-16-the-collectors-curve",lightOnDark:!0,originalHash:"3grobdbo71"},{ageRange:"15-16",title:"Alien Noticeboard",hash:"ykemjv9hqw",name:"Lydia Sollis",country:"United Kingdom",statement:"In this graph, I wanted to create a different alien world and imagine a snippet of life in it. To do this I created an alien writing system, which I used throughout the piece.",tool:"2d"},{ageRange:"15-16",title:"Shooting Star",hash:"hzjfemkik5",name:"Sanjhbati Chakraborty",country:"United Kingdom",statement:"I was inspired by the beautiful sunsets that I have seen around where I live. I used my love of maths to create this piece of artwork.",tool:"2d",videoUrl:"15-16-shooting-star",originalHash:"98fpgpylf4"},{ageRange:"15-16",title:"Customizable Flower Vase",hash:"73f3b7c688",name:"Phillip Pham",country:"United States",statement:"I wanted to create a model that I would be able to create using different math concepts, so I decided to create a flower vase. I also wanted to add an element of interactivity, so I made it so that you can customize the flowers and the vase.",tool:"3d"},{ageRange:"15-16",title:"Peace in Palms",hash:"jiabj0ulpn",name:"Brent Lu",country:"Canada",statement:"The graph is inspired by themes of global unity and environmental stewardship. In the palms of the hands lies a map-like pattern symbolizing human influence and diversity across the Earth. The doves represent peace and the hope for a harmonious coexistence between humanity and nature, emphasizing the idea that the world's well-being rests in our hands.",tool:"2d",videoUrl:"15-16-peace-in-palms"},{ageRange:"15-16",title:"Constellations",hash:"4uemov1opl",name:"Angela Zhou",country:"United States",statement:"Nighttime is my favorite time of the day. On the nights when the skies are clear, some of these constellations can be seen overhead. It's really amazing how beautiful the world can be.",tool:"2d",videoUrl:"15-16-desmos-art-project",lightOnDark:!0,thumbUrl:Gne,originalHash:"rntdkotpgz"},{ageRange:"15-16",title:"Match 3 Game",hash:"ih3ufzprbf",name:"Edmund",country:"United States",statement:"Match 3 games are so simple yet still so fun to play. Making one in Desmos was an enjoyable experience of having to work around the limitations. I found that some of the things needed to make such a game were not so simple, like checking for possible moves or ensuring that a possible move exists (which I did not implement).",tool:"geometry",hasSound:!0,thumbUrl:Tne},{ageRange:"15-16",title:"Zooming Through Time",hash:"mryhcrbiw8",name:"Aabhisaar Shrivastav",country:"United States",statement:"For my submission this year, I wanted to utilize the near-infinite zoom capacity of Desmos. In my submission, zooming out lets you travel forward in time and witness some of my favorite historical events from human history!",tool:"2d"},{ageRange:"15-16",title:"Polygon Flower",hash:"vu54qep5h1",name:"bananaicecream",country:"Canada",statement:"Having seen the works of others, I was inspired to make my own illustration in Desmos. It's not very technical, but I hope that it may bring inspiration to someone else.",tool:"2d"},{ageRange:"15-16",title:"A Galaxy in a Mason Jar",originalHash:"6jzuawmobh",hash:"y0zf72jr3b",name:"Timothy Alicea",country:"United States",statement:`I had never heard about the Desmos Geometry Tool, so when I started working on a project for the art competition, I figured I would give it a go. The swirling galaxy effect was the first thing I made, and then I thought, "What if you could just jar up a galaxy and carry it with you?" It led to the small story I attempt to tell with the graph and the jar sitting on a kid's desk. We try to confine complex concepts within our limits of understanding, just like how the mason jar captures the seemingly infinite within the finite.`,tool:"geometry",lightOnDark:!0},{ageRange:"17-18",title:"Satisfying Circle Polyrhythm",hash:"sahvbml7w7",originalHash:"hwsxyztvtr",name:"Kaitlyn West",country:"United States",statement:"This is a soothing polyrhythmic circle, inspired by videos of similar concepts. Partially done because I wanted to complete this without using a specific application, like many online videos use.",hasSound:!0,tool:"2d",videoUrl:"17-18-satisfying-circle-polyrhythm",lightOnDark:!0},{ageRange:"17-18",title:"Koi Pond",hash:"quksrjxfjz",name:"Emerson Mills",country:"United States",statement:"One of the things that spurred my love of math, alongside a wonderful high school teacher, was discovering math art through Desmos. The first real piece I made was a simple animated koi fish. Two years later, as a math major in college, I wanted to expand on that old idea to see how my skills have improved. I don't expect to win this contest, but I am proud of how far I've come.",tool:"2d",videoUrl:"17-18-koi-pond",lightOnDark:!0,originalHash:"isvvyiltny"},{ageRange:"17-18",title:"\u6708\u898B (Moon Viewing)",hash:"e21cihrxpo",name:"\u3089\u3092\u3093",country:"Japan",statement:"This is a work made with the theme of moon viewing.",tool:"2d",videoUrl:"17-18-moon-viewing",lightOnDark:!0},{ageRange:"17-18",title:"Abstract Trigonometric Noise Art",hash:"7jg1l7yty2",name:"Scarlett O\u2019Shaughnessey",country:"United States",statement:"The inspiration behind this work is the beauty of how a complex mathematical system, despite being purely composed of numerical rules, can, when viewed from a narrow perspective, appear abstract and lawless.",tool:"2d",originalHash:"jkzlxjdx93"},{ageRange:"17-18",title:"Fireworks",hash:"haz60bnxvw",name:"Liebig",country:"Japan",statement:"I made fireworks in Desmos because I like the beauty of them. I drew the colorful fireworks above the sea.",tool:"2d",videoUrl:"17-18-fireworks",lightOnDark:!0,originalHash:"zxpzohludh"},{ageRange:"17-18",title:"Mulieris Potentia",hash:"isowiuczdd",name:"Mark Socorro",country:"Philippines",statement:"Mulieris potentia means women's power in Latin. This artwork was dedicated to empowering women in our society because women have always had the potential to compete with men in different kinds of work that men dominate.",tool:"2d",originalHash:"vuzvqkrbov"},{ageRange:"17-18",title:"virus",hash:"ba15600e56",name:"Eriya Ito",country:"Japan",statement:"During COVID lockdown, I was making paper models of coronavirus. When I heard that Desmos made a 3D grapher, I remembered that and I tried to make a 3D digital model of the virus. Digital is superior to paper in being able to show how it is inside.",tool:"3d",videoUrl:"17-18-virus",originalHash:"83bed773dc"},{ageRange:"17-18",title:"sudoku",hash:"vg3vye1rvm",name:"Madylin Carnell",country:"United States",statement:"I absolutely adore both Desmos and sudoku, and I spend much of my free time between the two. There are moments, however, when I can't decide whether or not I want to play a sudoku or play with Desmos. This graph solves this problem whilst allowing me to play with pretty colors. It may help anyone else who struggles with this same issue.",tool:"2d",thumbUrl:One,originalHash:"gntvnec7un"},{ageRange:"17-18",title:"Journey North",hash:"y1mvhkmkak",name:"Frederick Park",country:"United States",statement:`After winning in last year's contest with "A Penguin Looking North", I wanted to outdo myself. A Penguin Looking North was mostly a still image with some ambient animations, and the way I wanted to one-up myself was to create a full-scale animation. Also, I love dem penguins. :D`,hasSound:!0,tool:"2d",videoUrl:"17-18-journey-north",originalHash:"64nec52z2i"},{ageRange:"17-18",title:"TopHop",hash:"iqhtp7solc",name:"Jonah Uellenberg",country:"United States",statement:"The main motivation for this is that I wanted to create something that transcends the art competition. Desmos is a powerful tool for building interactive math demonstrations, but making anything complicated is, well... complicated. TopHop is a full-featured demo of my game/animation engine, Graphgame, which is a system that makes it simple to create these things and can help make a project more accessible for those interested in it.",tool:"2d",videoUrl:"17-18-tophop",lightOnDark:!0,originalHash:"ymdvbihlcn"},{ageRange:"17-18",title:"Sailboat Sunset",hash:"v7sup4sivt",name:"Isobel",country:"United States",statement:"I've always loved sunsets, art, and math. Thus, I decided to recreate a painting I had previously painted, of a boat amongst a vibrant sunset, using Desmos.",tool:"2d",thumbUrl:Dne,originalHash:"crhlag76ny"},{ageRange:"17-18",title:"Carousel",hash:"afaaa8ce02",name:"Eliana Underwood",country:"United States",statement:'I got the idea for making a carousel when I was doing the "Slice a Surface" quest. I love carousels. They were my first ever carnival ride when I was younger.',tool:"3d",videoUrl:"17-18-carousel",originalHash:"10c8c03326"},{ageRange:"17-18",title:"Funky auroras",hash:"nrrt6ihiez",name:"Lukas Emander",country:"Sweden",statement:"A while back, I learned from a friend that horizontal parabolas can be used to focus vertical light rays into a single point (known as parabolic mirrors). This got me interested in what would happen if the same was done to different functions, and not only with horizontal light, but light from any given point in a 2-dimensional space. When deriving formulae and applying those to Desmos simulations, I discovered that for a lot of functions, the reflected light would concentrate in beautiful, curvy regions with an intrinsic appeal, which, using the right colours, resembled something majestic, like auroras. I was amazed by this and combined it with a mountainous theme to create this graph of a personally stunning nature-themed setting.",tool:"2d",videoUrl:"17-18-funky-auroras",lightOnDark:!0},{ageRange:"17-18",title:"Bath Fun",hash:"464e32e484",name:"Finlay",country:"Australia",statement:"I still remember a couple of years ago trying to build my own 3D 'renderer' and seeing other people's creations using all of the tricks as the original Desmos engine evolved. So, when I found out Desmos had released a 3D grapher I was overjoyed it comes with built in vector math! I hope this piece reflects the fun I had using this tool.",tool:"3d",videoUrl:"17-18-bath-fun"},{ageRange:"17-18",title:"Football Training Ground",hash:"ovfrvpg4wx",name:"Samuel A Obigbesan",country:"United Kingdom",statement:"I was always interested in building 3D models using Desmos, so I decided to create a 3D Football Training Pitch. I tried experimenting with the player\u2019s animation, as well as the lighting and shadows to create a more realistic and immersive experience.",tool:"2d",originalHash:"thhfhrshao"},{ageRange:"17-18",title:"Cotopaxi",hash:"6dczynpkvs",name:"Eric Segrest",country:"United States",statement:"Upon witnessing the snowcapped majesty of Cotopaxi, one of the highest active volcanoes in the world, I was inspired to capture its rugged allure. Despite the present violence in my beloved Ecuador, I feel that this is the perfect opportunity to highlight the country's extraordinary beauty and the resilience of its unique and wonderful people.",tool:"2d",videoUrl:"17-18-cotopaxi",originalHash:"o909caqoda"},{ageRange:"17-18",title:"Starbirth",hash:"5k74o1u3ib",name:"Noah Witte",country:"United States",statement:"All my life, I've wanted to explore space's beauty. I tried to capture the magic of a star's birth, through the language of math.",tool:"2d",videoUrl:"17-18-starbirth",lightOnDark:!0},{ageRange:"17-18",title:"Desmos Museum",hash:"vrlrv7bxjc",name:"\u306F\u3057",country:"Japan",statement:`This is my first time participating in the contest. I wanted to create a 3D graph using a fisheye lens.
Through "Desmos Museum" I hope to convey the beauty of Desmos and mathematics to you.`,tool:"2d"},{ageRange:"17-18",title:"Rhythm Game Desmos V3",hash:"sgidsictwh",name:"William Patmore",country:"United States",statement:"This graph was inspired by my love of computer science. I noticed that there were some really powerful tools for making games, but the ones I've seen were very slow, and usually had very little player interaction. Tone came just in time for me to put it into my project, making it feel complete with a little help from one of my friends!",hasSound:!0,tool:"2d",thumbUrl:Mne,originalHash:"yroprwopro"},{ageRange:"17-18",title:"Moving Mountains",hash:"4onzlulo7k",name:"Jalen H.",country:"United States",statement:"As a math enthusiast, I'm always looking for interesting and engaging ways to visualize different math concepts. Here, functions turn into sprawling mountains dotted with trees. From an artist's perspective, I came up with a simple way to tweak the colors that mimic how distant mountains look in real life.",hasSound:!0,tool:"geometry",videoUrl:"17-18-moving-mountains",thumbUrl:Vne,lightOnDark:!0,originalHash:"fayfek56hi"},{ageRange:"17-18",title:"Butterfly",hash:"tqecj9c8nv",name:"Elizabeth Mitchell",country:"Austrailia",statement:"I wanted to create a graph with some interesting movement and the first idea that came to mind was\xA0a\xA0butterfly. I decided to aim for simplicity to keep the animation smooth and natural.",tool:"2d",videoUrl:"17-18-butterfly",lightOnDark:!0,originalHash:"hsl3lefwlq"},{ageRange:"17-18",title:"Andromeda",hash:"lbebuw1dxo",name:"Luke Thompson",country:"United States",statement:"Learning about space definitely was a big inspiration for this graph. I wanted to share with people how beautiful (and mathematical) the night sky is. With my submission, I hope I can spark more people's interest in Astronomy and Cosmology.",tool:"2d",videoUrl:"17-18-andromeda",lightOnDark:!0,originalHash:"5lqd0zdvtb"},{ageRange:"17-18",title:"Sailboat",hash:"f6dd6b2a47",name:"William",country:"United States",statement:"I wanted to make a graph that had multiple different textures in it so I made a sailboat.",hasSound:!0,tool:"3d",originalHash:"dafab7f707"},{ageRange:"17-18",title:"Desmos Song Lab",hash:"z3zqcixnka",name:"Cameron Zifcak",country:"United States",statement:"I am passionate about music, so I designed a music editor from scratch that works in Desmos! It has basic sine notes with decay, and a simple and sleek UI. The notes are selectable and can be dragged to make a pattern.",hasSound:!0,tool:"2d",videoUrl:"17-18-desmos-song-lab",lightOnDark:!0,originalHash:"jmgdxfzi2t"},{ageRange:"17-18",title:"Nighthawks",hash:"1cwbqzjqjm",name:"Judy Luo",country:"Canada",statement:'Sparse in detail but beautifully geometric, I was drawn into the simplicity of the original oil painting titled "Nighthawks" by Edward Hopper. I wanted to produce a sense of perspective and depth through the layering of solid shapes. The eerie atmosphere begs the viewer to wonder about the four mysterious figures, the seemingly empty outside view, and the absence of any doors connecting the exterior and interior of the restaurant, creating a sense of loneliness as they gaze at the flickering scene through the window.',tool:"2d",thumbUrl:Ine,originalHash:"2eiooe3qpq"},{ageRange:"19+",title:"Cube-6-Pieces-Puzzle",originalHash:"89b12d0621",hash:"edbafd0bf7",name:"Leo Ventyk",country:"Ukraine",statement:"I wanted to build something that would resist to forces like the gravity.",tool:"3d",videoUrl:"19-cube-6-pieces-puzzle"},{ageRange:"19+",title:"Electrostatic Field 3D Annimation",hash:"db78e443be",name:"Mois\xE9s L\xF3pez Caeiro",country:"Spain",statement:"This simulation of an electrostatic field created by two point charges is intended to help high school students visualise the concept of electric field in 3D.",tool:"3d",videoUrl:"19-electrostatic-field-3d"},{ageRange:"19+",title:"Voxel",hash:"eeee57c1d0",name:"Michael Salston",country:"United States",statement:"A simple way to represent a 6x6x6 3D Voxel using a list of inputs.  Users can customize the list to create any shape they want.",tool:"3d"},{ageRange:"19+",title:"Desmos Guitar Guy!",hash:"ystijfqayn",name:"Dylan Lee",country:"United States",statement:"For my final school project, I designed an algorithm that can calculate the appropriate fingering positions for any piece of guitar tablature, and then used it to make this little guitar guy (his name is Clyde)! I wanted to really push the experimental bounds of the art style for this piece, so I made almost everything out of PNG images, including the TV head which plays a little slideshow of some happy memories from the past year.",hasSound:!0,tool:"2d",videoUrl:"19-desmos-guitar-guy",lightOnDark:!0,thumbUrl:Lne,originalHash:"4ym25oxa4o"},{ageRange:"19+",title:"Still Life (Tree Stump)",hash:"bbfe67248e",name:"Sea-Saw",country:"United States",statement:"In the still moments of change or loss, find beauty in life's small movements.",tool:"3d"},{ageRange:"19+",title:"Jellyfish Love Song",hash:"32n6xt5nh7",name:"Simon Lav",country:"Israel",statement:"I love graphing using Desmos. I started during my studies of electrical engineering and never stopped since.",hasSound:!0,tool:"2d",videoUrl:"19-jellyfish-love-song",lightOnDark:!0},{ageRange:"19+",title:"Refraction",hash:"yuz2wkcauu",name:"Lenny the Burger",country:"Canada",statement:'With talk of how this year the focus is on "fast," I decided to make something where I would really be able to show off my skills in real-time rendering: refracted mesh caustics. They also look really cool ;)',tool:"2d",videoUrl:"19-refraction",lightOnDark:!0,thumbUrl:Pne},{ageRange:"19+",title:"Digit CNN (Handwriting Number Detector)",hash:"xi5i850vas",name:"Albert Yuan",country:"United States",statement:"I took a machine learning class at school and got addicted to Desmos at the same time. This project is a byproduct of that.",tool:"2d",thumbUrl:Ane},{ageRange:"19+",title:"PolyGone",hash:"aw7pq0gdlu",name:"Brylle Logro\xF1o",country:"Philippines",statement:"The pandemic prompted a reevaluation of life's fragility and meaning, leading me to recognize the importance of mathematics in achieving a meaningful life. The self-portrait created in Desmos with polygon art symbolizes the multifaceted nature of my life, incorporating imperfections, the passage of time, and the transient aspects of existence. The changing colors and motion in the artwork, described by an equation of an underdamped harmonic oscillator, illustrate life's ups and downs, emphasizing its ephemeral nature, while encouraging a pursuit of meaning despite the inevitability of death.",tool:"2d",videoUrl:"19-polygone"},{ageRange:"19+",title:"Fusion",hash:"szjueydq7y",name:"Vei Kei",country:"Sweden",statement:"Testing my linkage tool using t, instead of a variable, it generated spirograph-like shapes. Adjusting it to change over time, and be less consistant, it created these beautiful patterns.",tool:"2d",videoUrl:"19-fusion",lightOnDark:!0,originalHash:"mzedhg7a1v"},{ageRange:"19+",title:"Kawaii Keyboard",hash:"ylpzxxsks5",name:"Devika Bej",country:"India",statement:"Kawaii Keyboard is a functioning keyboard built in Desmos Graphing Calculator, with a cute pastel theme. The aim of this project was to build something that is interactive and usable.",tool:"2d"},{ageRange:"19+",title:"Notes on Life (Pixel Subway)",hash:"rxnntp6nlg",name:"TETH_Main",country:"Japan",statement:"Whenever I make function art, it is when I am relaxed. When I am feeling calm, I am full of ideas and can see many different views. With this image in mind, I created a scene of using the Desmos graphing calculator while riding on a train.",hasSound:!0,tool:"2d",videoUrl:"19-notes-on-life"},{ageRange:"19+",title:"Desmooog by Jannosch",hash:"kbkwkigfkz",name:"Jannis M\xFCller",country:"Germany",statement:"I am fascinated by the maths behind music and the emotions it can create. Inspired by legendary analog synthesizers and the introduction of 'tone,' I created 'desmooog' - a fully controllable synthesizer in Desmos.",hasSound:!0,tool:"2d"},{ageRange:"19+",title:"Math: Final Boss",hash:"u6nxdjq31x",name:"Jake Walker",country:"United States",statement:'This idea spawned from me realizing I could use the integral symbol to make a pair of angel wings, and it developed into the idea of making a "math deity." Many parts of its design are based on ideas and subjects from math, some more subtle and obscure than others. A few of my other inspirations are listed at the bottom of the graph.',tool:"2d",videoUrl:"19-math-final-boss",lightOnDark:!0},{ageRange:"19+",title:"Goddess Meenakshi",hash:"reu2dwt8mb",name:"Harshitha",country:"India",statement:"The Meenakshi temple in Madurai is the inspiration behind my submission. I had countless ideas, but this temple holds a special place in my heart. I have used the simplest equations here, but this experience makes me more curious about what can be achieved though math.",tool:"2d",videoUrl:"19-goddess-meenakshi",lightOnDark:!0},{ageRange:"19+",title:"Neogastropoda (Shells)",hash:"ubi0lv3dhb",name:"Harry Chen",country:"Canada",statement:"My artwork attempts to represent five sea snail species under the taxonomic order Neogastropoda. As someone who lived in a coastal town in Southeast China throughout my younger ages, seashells are significant parts of my childhood memory. I aim to explore my connection with seashells by modelling the most memorable ones in my childhood memory. I am glad with how this artwork allows me to express my unique background and lasting fascination with these sea creatures.",tool:"2d",videoUrl:"19-neogastropoda"},{ageRange:"19+",title:"Robot Arm",hash:"mdffbazqea",name:"Maxwell",country:"United States",statement:"As a student in mechanical engineering, my passion for mathematics and fascination with intricate mechanisms inspired the creation of this graph. The animation depicts a shape-sorting system using a robotic arm, blending my love for math and engineering.",hasSound:!0,tool:"geometry",videoUrl:"19-robot-arm"},{ageRange:"19+",title:"Spring Boxes",hash:"dc50727ace",name:"Jose Angel Munoz",country:"Spain",statement:"This animation is inspired by the aesthetics of 3D video games and the beauty of Mathematics (as expressed in parametrical terms, for a smoother animation) and basic Physics (as applied to mechanical systems).",tool:"3d",videoUrl:"19-spring-boxes"},{ageRange:"19+",title:"Additive Synthesizer",hash:"fcuw6s8jgm",name:"Reina Quinn",country:"United States",statement:"I like using Desmos to make things that aren't just graphs, and I also love audio engineering and synthesis. So naturally, I always felt a bit disappointed that Desmos had so little functionality in terms of audio. When the tone function was added, I knew I had to try making a synthesizer.",hasSound:!0,tool:"2d"},{ageRange:"19+",title:"August 20 in Budapest",hash:"rbiymkstlz",name:"Zolt\xE1n Kalocsai",country:"Hungary",statement:"The Budapest city skyline is a beautiful landmark of Hungarian history. I now get to witness it daily since I attend university.  This piece also let me employ the newest graphing techniques I have developed by using Desmos.",hasSound:!0,tool:"2d",videoUrl:"19-august-20-in-budapest",lightOnDark:!0},{ageRange:"19+",title:"Music Box",hash:"0196ae61eb",name:"zboy",country:"Japan",statement:"I focused on 3D graph mode and tone function, which are both recently added. It is expected that many participants apply Fourier transform, so I looked for ways to make a beautiful sound without it.",hasSound:!0,tool:"3d",videoUrl:"19-music-box"},{ageRange:"19+",title:"Claire de Lune (Piano)",hash:"4fe020e052",name:"Audrey Chiang",country:"United States",statement:"As soon as the new Tone feature was released, I knew I wanted to incorporate it into my project this year. Inspired by my love for music, the goal was simple: to recreate a musical performance in Desmos. To do so, I used a rendition of Clair de Lune that I recorded, using tones and animations to bring it to life in the calculator.",hasSound:!0,tool:"3d",originalHash:"aa7028b976"},{ageRange:"19+",title:"Metamor-fishies",hash:"hq8qsoym9r",name:"Andrew Irving and Ebrahim Patel",country:"United Kingdom",statement:"Behind D'Arcy Thompson's fish sketches is a mathematical theory: simple functions can transform various species into one another.  An age before computers, he communicated each mapping by its reshaping of a coordinate grid, a pliable net he drew over each pre-image and image.  With Desmos, we can experience these metamorphoses in full.",tool:"2d",videoUrl:"19-metamor-fishies"},{ageRange:"19+",title:"Journey (Animated Short Film)",hash:"6jkt01mc9l",name:"Ye Shun Hew",country:"Malaysia",statement:"I want to deliver a good story solely using Desmos. I was unable to create fast enough animation last time (2021's contest), so I decided to challenge it once again, with another story, another journey.",hasSound:!0,tool:"2d",videoUrl:"19-journey",lightOnDark:!0},{ageRange:"19+",title:"Spontaneous Synchronization",hash:"z0wega2pgp",name:"Andrew Black",country:"United States",statement:"When multiple metronomes are placed on a mobile platform, the oscillations are coupled, and they begin to synchronize as the feedback of the platform gradually changes the phase of each oscillator. This project is a simulation of this phenomenon.",hasSound:!0,tool:"2d",videoUrl:"19-spontaneous-synchronization",lightOnDark:!0}];var Nne="/assets/build/13-14-desmos-clarinet-5CK6OFBK.png";var Une="/assets/build/13-14-flags-of-the-world-XT6ILSJ3.png";var Yne="/assets/build/13-14-interactive-hertzsprung-russel-diagram-VQ7NHMKX.png";var Bne="/assets/build/13-14-lisbon-impression-BI63PDKH.png";var Kne="/assets/build/13-14-motor-image-GOZ5AXG6.png";var zne="/assets/build/13-14-text-editor-F4LDAFRU.png";var qne="/assets/build/13-14-tiger-3-UJTNJKVV.png";var Hne="/assets/build/15-16-dancers-strength-GM-DCVQPGLA.png";var Wne="/assets/build/15-16-desmos-art-studio-OAMHW2XB.png";var jne="/assets/build/15-16-let-there-be-light-LUDNV3YS.png";var Xne="/assets/build/15-16-scls-image-H4JJG6AL.png";var $ne="/assets/build/17-18-desart-2.0-TJOMVGJK.png";var Jne="/assets/build/17-18-desmos-poker-646CAB64.png";var Zne="/assets/build/17-18-funigma-image-2HT2CT74.png";var Qne="/assets/build/17-18-seasonal-bouquet-image-PXYVK4ZW.png";var eae="/assets/build/17-18-sines-and-cosines-of-equilateral-polygons-WK5F2PVN.png";var tae="/assets/build/19-billiards-image-BO2EOGJL.png";var rae="/assets/build/19-complex-fourier-transform-visualiser-image-IIIEVSLC.png";var oae="/assets/build/19-design-a-potholder-VEC7R5BM.png";var iae="/assets/build/19-desmos-snake-image-Y56DDALA.png";var nae="/assets/build/19-dynamics-cart-image-WFTKJAOM.png";var aae="/assets/build/19-mathbox-image-PQENZF7X.png";var sae="/assets/build/19-qr-code-and-barcode-generator-K3YQC4DD.png";var lae=[{ageRange:"13-14",country:"United States",lightOnDark:!0,name:"Andrew Roden",statement:'This three-month project combines my love for geography and mathematics. It depicts something that many of you know: flags. If you live in a country that starts with "A," your flag is probably here. From polygons and implicit circles to parametric circles and B\xE9zier curves, this graph clearly shows my growth as a Desmos artist. Enjoy.',tool:"2d",title:"Flags of the World -- The 'A' Collection",hash:"fppmmjp4do",tags:["list"],thumbUrl:Une},{ageRange:"13-14",country:"United States",name:"Anushka Gangopadhyay",originalHash:"darg2amxg2",statement:"This is a representation of a sapling in four seasons. I learned about parametrics and matrices while making this graph.",tool:"3d",title:"Sapling",hash:"ycyl0isblb",tags:["list"],videoUrl:"13-14-sapling"},{ageRange:"13-14",country:"United States",lightOnDark:!0,name:"Ariana Park",statement:"This project was very time-consuming, and I started it months ago as a math project for school. I had no idea what to graph for the project when it was assigned, but I was looking around and just decided spontaneously to make my criteria sheet. Due to the tons and tons of very small lines, this project took hours to do, with me even running out of time in the end. Because of this, I decided to use a picture of my cat as a model to help cover some of the text so I didn't have to it all. Even with the cat, the project has over 3,600 equations, with all that work coming together into this large project that I'm very proud of and hope the Desmos community enjoys.",tool:"2d",title:"cat sat on my homework",hash:"xs9onibmkk",tags:[]},{ageRange:"13-14",country:"United States",lightOnDark:!0,name:"Brendan Julius",statement:"I was inspired to make my submission a globe because I have tried to learn more about the world around me this year, but I ended up learning more about myself, too. My submission represents how everyone we know and everything we have can be shown in a single picture, similar to the Blue Marble photograph, and everything is connected together in one way or another.",tool:"2d",title:"Blue Marble",hash:"devjlhajyn",tags:["random","animation","list"],videoUrl:"13-14-blue-marble"},{ageRange:"13-14",country:"United States",lightOnDark:!0,name:"David Jacobs",originalHash:"tfr4jmqtle",statement:"This graph was inspired by the beauty and complexity of fractals. I originally just set out to make a graph of the Koch curve, but I realized that I was already halfway to making it customizable! While working on this graph, I learned about recursive functions and how to use transformations in Desmos.",tool:"geometry",title:"Fractal art",hash:"m0zbh23mq5",videoUrl:"13-14-fractal-art",tags:["recursion","interactive","list"]},{ageRange:"13-14",country:"United States",lightOnDark:!0,name:"Evan Chen",statement:"I wanted to explore interactivity in Desmos, so I decided to create a playful game with a hamster rolling through a level. The experience challenged me to think creatively about both design and efficiency. The result is a fun game showing the limitless possibilities of the Desmos Geometry Tool.",tool:"geometry",title:"Hamster Game",hash:"redcaas20h",tags:["random","interactive","animation","list"],videoUrl:"13-14-hamster-game"},{ageRange:"13-14",country:"Japan",name:"Harumi Hiraku",statement:"Is this just a small house? No, this is a teddy bear house with gimmicks here and there. Because I wanted to include animations, I added sine and cosine functions, which I had not yet learned, and I used many symbols. Have fun with different numbers and gimmicks!",tool:"2d",title:"Teddy Bear House",hash:"kdhmvtomep",tags:["animation"],videoUrl:"13-14-teddy-bear-house"},{ageRange:"13-14",country:"Bangladesh",name:"Hrishikesh Paul",statement:"My two favorite things are maths and programming, so I figured why not combine both of them? I thought a text editor would be relatively simple to make while still being fun, so that's what I went for! I hope you have fun using it!",tool:"2d",title:"Text Editor",hash:"nscmbqjegi",tags:["interactive","list"],thumbUrl:zne},{ageRange:"13-14",country:"United States",name:"Inler Lu",originalHash:"tt2xjbowto",statement:"The clarinet is a beautiful woodwind instrument, and I decided that this instrument I play would be fun to make in Desmos. My graph uses the tone feature to recreate the sound and 3D rendering with polygons to display a model of the clarinet. The instrument is fully playable. I used various techniques, including info compression in binary, a Python script to import OBJ models, the painter's algorithm for the hidden surface removal problem, ADSR for sound, and a rough Fourier transform using regressions. This project was very fun to create, and I hope the Desmos community enjoys it, too.",tool:"2d",title:"Desmos Clarinet",hash:"ivbj09ztt5",tags:["tone","interactive","list"],thumbUrl:Nne},{ageRange:"13-14",country:"United States",name:"Ishi Patel",statement:"This piece is a celebration of my personal journey. From a little, shy girl, I became strong and confident. The circles symbolize the everlasting self-love I've established ever since a particular time in my life. Desmos gave me a canvas to create this piece and express myself. It's my first time creating anything like this, and I absolutely love the final result.",tool:"2d",title:"My Circular Odyssey",hash:"dzxmimosmr",tags:["list"]},{ageRange:"13-14",country:"United States",name:"Jasper Jahnig",statement:"I created this project to explore the limits of Desmos's 3D Calculator and tone feature. While planning this project, I learned how to use Python scripting to import different file types into Desmos. This graph uses this to create a visually pleasing and audibly accurate experience.",tool:"3d",title:"MIDIJam Bass & Guitar",hash:"uuxpmvvjz7",tags:["tone","list","random","animation"],videoUrl:"13-14-midijam-bass-and-guitar"},{ageRange:"13-14",country:"United States",lightOnDark:!0,name:"John Choe",statement:"I started this project as a testing ground for what I could achieve with the Desmos calculator. The amount of freedom that is present in making art in Desmos is definitely what interested me the most. I discovered that randomness, if used properly, can make a beautiful and distinctive piece of art.",tool:"2d",title:"Reaching Out",hash:"ucap1blhgx",tags:["random","list","animation"],videoUrl:"13-14-reaching-out"},{ageRange:"13-14",country:"United States",name:"Leighton Sher",statement:"This piece is a self-portrait of me self-reflecting with a reflection of myself. The piece represents self-evaluation and its benefits. I believe reflection is very important in life because it can help you identify your strengths and weaknesses, understand how you\u2019re feeling, and look back upon what you\u2019ve learned and experienced.",tool:"geometry",title:"Self-reflection",hash:"oojzewwxf5",tags:["list"]},{ageRange:"13-14",country:"United States",lightOnDark:!0,name:"Olivia Fang",statement:"I've always had a love for symbolism and a passion to inspire, so I decided to create this art piece on Desmos. I'm incredibly happy I chose to dedicate some time to getting creative with art and math, and I didn't expect myself to learn so much in the process. I enjoyed every bit of this experience, and I hope people will find joy in exploring the deeper meaning for themselves.",tool:"2d",title:"Masquerade",hash:"g8hijosy5f",tags:["random","list","animation"]},{ageRange:"13-14",country:"United States",lightOnDark:!0,name:"Olivia H.",statement:"Since age four, I have been enamored with and profoundly intrigued by astrophysics. One thing that I have been particularly fascinated by is the evolution and lifespan of a star. This aspect of astrophysics has been one of the main things that has kept my fervent interest over the years. I love discussing, teaching, and researching the topic, so this graph is especially significant to me, as it is one of the resources that I would often reference to do so. The Hertzsprung-Russell (H-R) diagram reveals the patterns and relationships that mark the stages of a star's life cycle. The diagram classifies stars by their luminosity (absolute magnitude) and temperature (spectral class). The different groups on the diagram represent different stages of a star\u2019s life cycle. I learned to incorporate actions (specifically clickable objects), the random() function, and lists of values.",tool:"2d",title:"Interactive Hertzsprung-Russel Diagram",hash:"jlmmtcv3wh",tags:["interactive","list","random","animation"],thumbUrl:Yne},{ageRange:"13-14",country:"United States",name:"Qingyun Li",originalHash:"nr2xd8ydim",statement:"I've always been using Desmos to create fun and exciting graphs. It's something that has value to me and maybe to others :). But, I've realized the real value isn't in the graphs themselves: it's the discoveries you make along the way.",tool:"2d",title:"Discovery",hash:"kbchbsgod2",tags:["animation","list","tone"],videoUrl:"13-14-discovery"},{ageRange:"13-14",country:"United States",name:"Raaj Konduru",statement:"Through this project, I learned the importance of patience and problem-solving. Some challenges, like fixing shading glitches, took hours to figure out, but each breakthrough made me more confident in my skills. I realized that even in math, innovation and persistence go hand in hand.",tool:"2d",title:"The Ram: Rising Above Challenges",hash:"mrhscps4jo",tags:["interactive"]},{ageRange:"13-14",country:"United States",lightOnDark:!0,name:"Talia Castillo",statement:"When I first heard about the Desmos Art Expo, I was making small creations like simple Christmas trees and geometric cat faces in the Graphing Calculator. Through time and Desmos\u2019s built-in tutorials and Help Center, I learned how to use equations to my advantage and started learning how to code in gradients and use polygons. I'm so excited to be participating in the Desmos Art Expo, and I have already grown as a mathematician and artist over the past couple of weeks! I hope y'all enjoy!",tool:"geometry",title:"Tiger:3",hash:"rjxuorl7az",tags:["list"],thumbUrl:qne},{ageRange:"13-14",country:"Brazil",lightOnDark:!0,name:"Victor Hugo Cubines",statement:"Ever since I was little, I've had a really strong interest in motors, how they work, and how to improve them, probably because my father has a motorcycle store. I've been monitoring the store's growth for a long time, so when I discovered this art contest, I imediately knew what to do: recreate a four-stroke motor with a transmission system. Actually, this is my first time competing, so I hope you enjoy the animation!",tool:"2d",title:"motor",hash:"eftctamytr",tags:["interactive","list","animation"],videoUrl:"13-14-motor",thumbUrl:Kne},{ageRange:"13-14",country:"Portugal",name:"Xuanyi Liu",statement:"This is my first year participating in the contest! Working on this Desmos entry taught me how mathematical equations can transform into visual art, showing the creative potential of math beyond calculations. I discovered new ways to manipulate functions and graphing techniques to create complex designs, improving both my problem-solving skills and creativity. Most importantly, I learned patience and persistence as I refined my work to align with my vision.",tool:"2d",title:"Lisbon Impression",hash:"icvqbujrj6",tags:["random","list"],thumbUrl:Bne},{ageRange:"15-16",country:"United States",name:"Aditi Boddu",statement:"This graph was inspired by the three things that come to mind when I envision my future: a cat, snow, and a yellow umbrella. Initially, I used the process of creating this graph as an opportunity to learn the Geometry Tool. However, after a lot of playing around, what began as a learning experiment evolved into one of the best things I\u2019ve made.",tool:"geometry",title:"Whiskers & Wonder",hash:"6m2jithtpl",tags:["animation","random"],videoUrl:"15-16-whiskers-and-wonder"},{ageRange:"15-16",country:"United States",name:"Anna Shen",statement:"This is a graph of my brother Aaron who has autism. I wanted to use this graph to help more people understand him, as many do not. There are more details about Aaron inside the graph!",tool:"2d",title:"The Epitome of Aaron",hash:"hip7l9f0gl",tags:["random","interactive","list"]},{ageRange:"15-16",country:"Ireland",name:"Ben Maguire",originalHash:"fulfnwnwhw",statement:"Minesweeper-like games are immensely enjoyable, and I felt that creating one in Desmos could be fun. This was my first time ever creating any artistic or complicated graph in Desmos. I had to learn a lot about actions, lists, and functions in Desmos, which I had never made much use of before, in order to get this project to work. It's been enjoyable trying to work around the limitations of Desmos in order to make a functional game.",tool:"2d",title:"Desmos Sweeper",hash:"fhmxe3kjlf",tags:["list","random","interactive","animation"],videoUrl:"15-16-desmossweeper"},{ageRange:"15-16",country:"Zimbabwe",lightOnDark:!0,name:"Catherine ",statement:"This art piece was created for a STEM competition under the theme of sustainability. Our graph depicts three scenes: a dam, a solar farm, and a wind farm, showing sustainable energy sources used around the world. Creating this artwork was a huge leap for both of the creators who worked on this piece, and, out of pure ambition, we managed to put this together in a few months. I feel that this piece really shows that anything is possible if you put your mind to it and that collaboration is a huge step to success.",tool:"2d",title:"DESMOS STEM 2023-2024",hash:"rdt5jonta5",tags:["list","tone","interactive","animation"],videoUrl:"15-16-desmos-stem-2023-2024"},{ageRange:"15-16",country:"Canada",lightOnDark:!0,name:"Grace Manley",originalHash:"4sinoprese",statement:"I have been dancing ballet for 10 years, and I wanted to capture some of the technical anatomy of a dancer using mathematics. Ever since I first started creating art in Desmos, I've always wanted to merge my passions in the two disciplines. Usually, when people think of ballet, they think of graceful and delicate ballerinas with pink tutus. In this piece, I wanted to show the technical and strong side that I experience in my classes.",tool:"geometry",title:"Dancer's Strength GM",hash:"klfihjur8z",tags:["interactive"],thumbUrl:Hne},{ageRange:"15-16",country:"United States",name:"Henry Yu",statement:"I applied skills from my previous projects, which include games inspired by Wordle, Connect 4, Minesweeper, and tic-tac-toe. I learned many hacks and workarounds to limitations in Desmos while I created this, and I also learned perhaps every rule of chess along the way.",tool:"3d",title:"Chess",hash:"rkmaxqfij2",tags:["list","interactive"]},{ageRange:"15-16",country:"Canada",lightOnDark:!0,name:"Jack Stormes",originalHash:"cymz89dvyj",statement:"I learned about the math behind creating maps and used that knowledge to turn a map of the world back into a spinning globe. Additionally, I learned about music theory and how the 12-TET tuning system works. This project was a ton of fun!",tool:"2d",title:"Starman",hash:"f5t0narvnf",tags:["tone","animation","random"],videoUrl:"15-16-starman"},{ageRange:"15-16",country:"China",name:"Jiazhi Chen",statement:"Creating iClock showed me the beauty of blending mathematics with design. Using Desmos, I explored how to use mathematical formulas to achieve adaptive dynamic effects, expanding my understanding of art and functionality.",tool:"geometry",title:"iClock",hash:"p4i42jkcp1",tags:["interactive","animation","random","list"],videoUrl:"15-16-iclock"},{ageRange:"15-16",country:"United States",lightOnDark:!0,name:"Lucy Porwoll",statement:"I love learning about light, and I wanted to show some of the major breakthroughs in the physics of light. This graph helped me strengthen a lot of my mathematical skills, and it taught me more about light. I hope that other people will also learn more about light through this graph!",tool:"2d",title:"Let There be Light!: A Timeline of Breakthroughs in Optics and the Physics of Light",hash:"ay8ohmnzcp",tags:["animation"],thumbUrl:jne},{ageRange:"15-16",country:"United States",lightOnDark:!0,name:"Matthew Vantron",originalHash:"5iopppparg",statement:"I had to learn a lot about programming in Desmos for this project, specifically using the flexibility of lists and conditionals. Since all actions in Desmos run at once, I had to learn to get creative with how variables are changed, and it took a lot of time to simplify the code. After lots of work and a few tips and tricks I learned from the Desmos community over on Discord, I made this game!",tool:"2d",title:"the key to it all",hash:"4aw6f7xkvt",videoUrl:"15-16-the-key-to-it-all",tags:["interactive","list"]},{ageRange:"15-16",country:"Sweden",lightOnDark:!0,name:"Maximilian Tj\xE4der ",originalHash:"e3fzyo9wcr",statement:"Working on this project, I discovered the power of parametric equations and how they can help me bring out my design. I also enjoyed experimenting with lists and using the shuffle feature, which opened up new approaches and allowed me to refine my idea in a unique way.",tool:"2d",title:"Neuron",hash:"rthtxnaqls",tags:["list","interactive","animation","random"],videoUrl:"15-16-neuron"},{ageRange:"15-16",country:"United States",lightOnDark:!0,name:"Morrison Ws",statement:"For a bit more than a year now, I have been making art in Desmos. I have never been much of an artist, but the medium is just so interesting to me. I did participate last year, and I did not end up winning, but since then, I have learned a lot and have adopted a more unique and parametric-based style, which I tried to show in this graph.",tool:"2d",title:"The Nebulous Terminus",hash:"nwhwm2ifb1",tags:["random","list"]},{ageRange:"15-16",country:"United States",lightOnDark:!0,name:"Neel Mistri",statement:"I've spent around two years learning and figuring out 3D rendering (like how computers and artist do it) and perspective projection. I even learned a fair bit about the intricacies of the Desmos Graphing Calculator itself and explored higher dimensions. Even if I don't win the contest, the knowledge of gemoetry and computing I've gained throughout working on this project is more valuable than any prize.",tool:"2d",title:"Puzzle Hypercube",hash:"hlduiqny8j",tags:["interactive","list","random"]},{ageRange:"15-16",country:"United States",lightOnDark:!0,name:"Nicholas Ertman",originalHash:"i5hynuqbet",statement:"While working on this project, I learned a lot about Desmos as a medium for art and programming. I learned about the limitations of Desmos, like how you can\u2019t store text in a variable or directly replace items in lists. However, I also learned about ways the community gets around these limitations, such as using the join function to replace items in lists inderectly or creating functions to display letters that aren't strictly assigned to a variable.",tool:"2d",title:"Desmos Art Studio",hash:"xhxm1sbq2x",tags:["interactive","list"],thumbUrl:Wne},{ageRange:"15-16",country:"Australia",lightOnDark:!0,name:"Noahn I",statement:"Coming across rotation matrices inspired me to create something 3D on a 2D surface. Working on this project has allowed me to gain a deeper understanding of computer graphics and sound frequencies. I also added simple chords and a melody to create a peaceful atmosphere. ",tool:"2d",title:"Winter Polygons",hash:"s5ah1ayop0",tags:["tone","list","animation","random"],videoUrl:"15-16-winter-polygons"},{ageRange:"15-16",country:"Japan",lightOnDark:!0,name:"Oba Shun",statement:"I used polygons to create a beautiful aurora sky.",tool:"2d",title:"AURORA SKY",hash:"k6jbtfch0o",tags:["list","random","animation"],videoUrl:"15-16-aurora-sky"},{ageRange:"15-16",country:"China",name:"Quqing Chen",statement:"Reflecting back, this graph has been, by far, the most ambitious project I have taken on. I have had the idea of creating my school, Song Ching Ling School, in Desmos in the back of my mind for months. I made this graph to celebrate my school's birthday. I practiced the knowledge I learned in AP pre-calculus, and I learned a lot from Desmos, like how to use clickers and sliders to control the sun's colors and other things. I want to thank my family, friends, and teachers. I also want to thank Desmos for giving me this opportunity to learn math. It's so amazing when I can visualize math in Desmos and and see its beauty.",tool:"2d",title:"scls",hash:"b3ke7rruhr",tags:["interactive","list","animation"],videoUrl:"15-16-scls",thumbUrl:Xne},{ageRange:"15-16",country:"United States",lightOnDark:!0,name:"Sequoia Leger",statement:"In this graph, I tried to extend a pleasant yet passing moment in my life through art and math. Working on a project of this scale was something new for me, but I think it was worth it. I expanded my awareness of what math could do to create rather than just solve, and I ended up with a piece that can share my memories and feelings better than I can with words. I hope you enjoy my graph!",tool:"2d",title:"Modular Lifetimes",hash:"gio4mkqylg",tags:["random","list","animation"],videoUrl:"15-16-modular-lifetimes"},{ageRange:"15-16",country:"United States",name:"Stanley Yen",statement:"I have so many fond childhood memories surrounding graphing calculators. I would often spend hours a day programming and drawing in calculators meant for graphing equations. No matter the model, I loved it. With this graph, I wanted to recreate that feeling of nostalgia, blending my favorite parts of those experiences into something I could be proud of, something that I knew I programmed myself.",tool:"2d",title:"The Graph Pro Micro",hash:"k2ck35htka",tags:["interactive","list"]},{ageRange:"15-16",country:"India",name:"Swarnika Sharma",originalHash:"vqpiekvmqc",statement:"Creating this graph has been an enjoyable experience, blending my passion for math and talent for art. I was really excited to create this graph and spend time experimenting with equations and functions. The car I've recreated on Desmos has been an integral part of my life, aiding my family and me for 7.5 years until we sold it about a month ago. Through this project, I have not only enhanced my mathematical and artistic skills, but I've also cherished and recollected the memories of my car.",tool:"2d",title:"A Journey of 7 years - My family's car",hash:"ybrl9leomo",tags:["list","infringing","animation"],videoUrl:"15-16-a-journey-of-7-years-my-familys-car"},{ageRange:"17-18",country:"Japan",lightOnDark:!0,name:"Asato Kamamoto",statement:"I had difficulty figuring out how to implement existing algorithms within Desmos. However, rethinking the algorithm from a different perspective led to a deeper understanding.",tool:"2d",title:"Reversi",hash:"hmx24xhkc8",tags:["list","interactive","random"]},{ageRange:"17-18",country:"United States",lightOnDark:!0,name:"Avi Rosenberg",statement:"This art work is largely inspired by Edward Hopper's masterpiece Ryder's House. I love this work because the lack of people in the scene gives it greater emotional power and allows you to place yourself into the scene more easily. This graph heavily incorporates randomization in order to simulate the smoke and the breeze across the wheat to create a sense of calm and grandeur. I enjoyed learning about the various uses of randomization and used it to make realistic, looping animations of breeze and smoke.",tool:"2d",title:"Ryder's House",hash:"smjsdfwmql",tags:["random","animation","list"],videoUrl:"17-18-ryders-house"},{ageRange:"17-18",country:"United Kingdom",lightOnDark:!0,name:"Cameron Zifcak",statement:"I have always been inspired by music and have created many songs using complicated music production software. Based on my experience, I decided to develop my very own Desmos Song Studio using only Desmos features (like tone)! My goal for this tool is to allow people to learn about producing music without the stress of using complicated professional software.",tool:"2d",title:"Desmos Song Studio",hash:"5wah4s1q4e",tags:["tone","interactive","animation"],videoUrl:"17-18-desmos-song-studio"},{ageRange:"17-18",country:"United States",lightOnDark:!0,name:"Caper Karchem",statement:"I have been crazy about math ever since I could speak, and I have carried my passion with me consistently throughout my life. I haven't done much art in Desmos, but with a total of around three hours of scattered work time, I have created this work, which I am both very excited to share and quite proud of.",tool:"2d",title:"The Purple Eye",hash:"jnzskctuyt",tags:[]},{ageRange:"17-18",country:"Norway",lightOnDark:!0,name:"dokso",statement:"This graph is inspired by the Greek myth of Sisyphus, whose fate is to push a boulder up a mountain for eternity. I had to learn a bunch of new concepts like inverse kinematics and signed distance functions to be able to make this, and I'm very happy with the results!",tool:"2d",title:"One must imagine sisyphus happy, animated",hash:"wgmb52ycwu",tags:["animation"],videoUrl:"17-18-one-must-imagine-sisyphus-happy-animated"},{ageRange:"17-18",country:"United States",name:"Edmund",originalHash:"oxhtms06c5",statement:"I learned about how 3D points can be used outside of the 3D calculator to store points to project to 2D afterwards. I also learned about how running effectively simultaneous actions can be useful to update all the masses at the same time.",tool:"geometry",title:"Fabric Simulator",hash:"usnq9sj6v6",tags:["interactive"],videoUrl:"17-18-fabric-simulator"},{ageRange:"17-18",country:"Portugal",name:"Gui R.",statement:"In the journey of creating DesArt 2.0 (and as I'm writing this at 3 AM) I've learned that I'm much more determined than I think I am. Fostering a growing Desmos Art Club at my school has taught me the power of collaborative learning philosophies and visual approaches when it comes to teaching math. This graph takes these lessons and runs with them, building on techniques I've been working on with the inspiration of many members of the Desmos community. Here's to many more years of graphing!",tool:"2d",title:"DesArt 2.0",hash:"zyzgc9vzay",tags:["interactive","random","list"],thumbUrl:$ne},{ageRange:"17-18",country:"United States",lightOnDark:!0,name:"Henry Stein",statement:"This was my first experience dedicating a significant amount of time to an art project. I learned that even though my main interests are math and science, I also really enjoy making art! What better way to discover that than to make a piece of art using math?",tool:"2d",title:"Aurora over the Adirondacks",hash:"rmbsvmvhwb",tags:["list","random"]},{ageRange:"17-18",country:"United States",lightOnDark:!0,name:"Katherine Stuhr",statement:"I learned how much I value challenges and working through them independently. Each one I take on leads me to learn more about manipulating numbers to create fascinating data, and in the end, I get to satisfy a fraction of a percent of my curiosity.",tool:"2d",title:"Sines and Cosines of Equilateral Polygons",hash:"divispdlnn",tags:["list"],thumbUrl:eae},{ageRange:"17-18",country:"United States",name:"Lennon Wielechowski",statement:"I've learned and grown so much this past year, and I wanted to put it all into one piece. This graph is an interactive system that allows to the user to view art as well as create it for themselves, all in a user-friendly interface that encourages innovation. I hope that whoever uses my work comes away with a new appreciation for 3d modeling and mathematics.",tool:"2d",title:"Blendesmos",hash:"mqjckcozjk",tags:["list","interactive"]},{ageRange:"17-18",country:"United States",lightOnDark:!0,name:"Madelyn Manley",originalHash:"lsnsfkyusx",statement:"The Christmas activities I enjoy most are decorating, listening to holiday songs, and counting down the days until our family party at Grandma's house. I incorporated all of these events using Desmos\u2019s ticker and variable dt, allowing me to understand the complexities of tracking time. I also used the tone function, which, as a musician, has become my personal favorite.",tool:"2d",title:"Deck the Halls With Desmos",hash:"c83pgn523x",tags:["interactive","animation","random","tone"],videoUrl:"17-18-deck-the-halls-with-desmos"},{ageRange:"17-18",country:"Saudi Arabia",lightOnDark:!0,name:"Maryam Mehdi Afiri",statement:"I'm obsessed with hacks, whistleblowers, and encryption machines. I'm also fascinated by mathematics, APIs, and art. However, I struggle in math and was previously inexperienced in Desmos. So, with lots of love and patience, I was able to make this piece\u2014my first one ever. It's a dream come true!",tool:"geometry",title:"Funigma",hash:"5lsgskunu2",tags:["interactive","animation"],videoUrl:"17-18-funigma",thumbUrl:Zne},{ageRange:"17-18",country:"United States",name:"Michael Liu",statement:"I learned that Desmos is, in fact, a very powerful tool that supports many of the operations I do daily in my hobby of computer graphics programming. It was a lot of work, but implementing everything from scratch in this graph gave me a more fundamental understanding of the things I do in my code editor.",tool:"2d",title:"Unified Renderer",hash:"n7r5dqo9w5",tags:["list","animation"],videoUrl:"17-18-unified-renderer"},{ageRange:"17-18",country:"United States",lightOnDark:!0,name:"Miles Gupta",originalHash:"nus5esircv",statement:"Just over a year ago, a friend of mine proposed the idea of a poker night at his house to me and a couple of others. We didn't play for much, buying in for about $10, and there were only about six or seven of us. Fast forward a couple months, and poker night has become a regular occurrence. Every three or four weeks, we gather at my friend's house to play low-stakes poker and hang out. Just recently, we held the largest gathering so far with nine people. These gatherings have been great, serving as a monthly event that we all look forward to. Because of this, I decided to center my Desmos Art Expo submission around poker.",tool:"2d",title:"Desmos Poker",hash:"csdm6sn8yi",tags:["random","interactive"],thumbUrl:Jne},{ageRange:"17-18",country:"United States",name:"Nathaniel",statement:"Over the past year, I learned about Desmos's with and for functions, which I use a lot in this graph. I also learned about color theory, which I applied when coloring in everything.",tool:"3d",title:"deep breaths",hash:"7xwwjvhzwx",tags:["list","animation","random"],videoUrl:"17-18-deep-breaths"},{ageRange:"17-18",country:"United States",name:"Riley Sanders",statement:"I started this project as a simple needlepoint design for my mother, but I was quickly struck by the power of color in conveying complex ideas. I made this graph as a reminder of the fragility of life and how we should value our time with the beauty of Earth.",tool:"2d",title:"Seasonal Bouquet",hash:"g5antxh1zl",tags:["random","animation"],thumbUrl:Qne,videoUrl:"17-18-seasonal-bouquet"},{ageRange:"17-18",country:"Hong Kong",name:"Samion Suwito",statement:"I really love 3D data visualisations, but they're typically only images. So, I utilized Desmos to draw a 3D population density map of Hong Kong. I learned a lot about designing an aesthetic visualisation with this project.",tool:"3d",title:"Map of Hong Kong",hash:"uwlxeanj1s",tags:["list"]},{ageRange:"17-18",country:"United Kingdom",name:"Samuel Ayokunle Obigbesan",originalHash:"9hh0rafaya",statement:"From this piece, I learned how to apply mathematical concepts like coordinates, geometry, and transformations creatively to design intricate 3D models in Desmos. It taught me how to use math as a tool for artistic expression, combining functions and equations to build realistic environments. This project also highlights the versatility of Desmos, showing how it can go beyond standard graphing to create visually stunning and complex designs.",tool:"3d",title:"Heavenly Baked Bakery",hash:"4zxbcfiwpr",tags:["random","interactive","animation"],videoUrl:"17-18-heavenly-baked-bakery"},{ageRange:"17-18",country:"China",lightOnDark:!0,name:"Simon Xiao",statement:"What better illustration of the harmony between algebra and geometry than the Riemann surface? At its core, Desmos is a graphing calculator, so I hope this graph can show everyone the joy of graphing, even if it's just the square root function!",tool:"2d",title:"Riemann Surface",hash:"3iryytembl",tags:["complex","interactive"],videoUrl:"17-18-riemann-surface"},{ageRange:"17-18",country:"Portugal",lightOnDark:!0,name:"Sofia Golubovski",statement:"This graph is my first project on Desmos, and it has been such an amazing journey for me, from starting off with simple linear equations to figuring out actions and animations. By the end, I fell in love with Desmos art. This graph, inspired by my love for the piano as well as the sciences, is meant to show the beauty and tranquility felt in the connections between math and music and how they aren't so different after all.",tool:"2d",title:"piano",hash:"yao7rcoubp",tags:["list","animation"],videoUrl:"17-18-piano"},{ageRange:"19+",country:"United States",lightOnDark:!0,name:"Andrew Black",originalHash:"hfn8ltq6pl",statement:"Signal processing classes gave me an appreciation for the ingenuity behind the standards we use to send and receive digital information. This interactive graph runs the discrete cosine transform (DCT) and quantization steps of JPEG, a compression standard created in 1992, on a couple downscaled photographs my brother and I took.",tool:"2d",title:"Lossy Compression",hash:"ojpahqloea",tags:["animation","list","interactive"]},{ageRange:"19+",country:"T\xFCrkiye",name:"\xC7a\u011Fr\u0131 Delihasanlar",originalHash:"q8wvvdong2",statement:'After becoming interested in barcodes, I thought: "Can I make a barcode generator on Desmos?" I successfully made several of them in February and March of 2020. Then, I wondered: "Can I make a QR Code generator as well?" I made just that in May 2022. This graph combines and accelerates everything I made before and includes new features like the keyboard.',tool:"2d",title:"QR Code and Barcode Generator",hash:"jzstj5b397",tags:["list","interactive","recursion"],thumbUrl:sae},{ageRange:"19+",country:"United States",lightOnDark:!0,name:"Derek Thompson",statement:"Through this project, I gained a deeper understanding of how mathematical concepts like additive synthesis and linear interpolation can be applied creatively to sound design. I explored how ADSR (attack, decay, sustain, and release) can shape the dynamics of a sound and how combining these elements can result in a more organic, musical experience. Additionally, designing the pixel art background allowed me to express the mood of the song visually, with the mushroom cave theme adding a whimsical and immersive layer to the project.",tool:"2d",title:"Mushroom Caves",hash:"glofedvu2q",tags:["list","tone","animation"],videoUrl:"19-mushroom-caves"},{ageRange:"19+",country:"Italy",lightOnDark:!0,name:"Guzman Tierno",statement:"I learnt that Desmos is fast. Really fast. You can code a video game inside Desmos. And you can do it even if you force yourself to use just one variable and just one action. The coding paradigm of Desmos, where all the expressions are true at the same time, makes using math really fun.",tool:"geometry",title:"Asteroids One-Liner",hash:"ihkkb4kecm",tags:["interactive","list","random","animation"],videoUrl:"19-asteroids-one-liner"},{ageRange:"19+",country:"United States",lightOnDark:!0,name:"Jake Walker",statement:"This is inspired by a game I often like to play where I pick four random digits and use them with any math operators to try to make the numbers 1\u2013100. For this graph, I tried to encompass almost every kind of skill I have in Desmos, be it art, animation, programming, optimization, or game design. This is by far the largest and most complex graph I've ever made, and I think it will stay with that title for a long time.",tool:"2d",title:"MathBox",hash:"icoaxvej64",tags:["recursion","animation","interactive","list","random"],videoUrl:"19-mathbox",thumbUrl:aae},{ageRange:"19+",country:"United States",name:"Julie Hue",statement:"When I drew my first potholder chart in the fall of 2023, all I knew how to do was draw equations and inequalities. It was a simple chart that was so slow and difficult to use that even I didn't enjoy using it. As I learned about polygons, lists, clickables, and sliders, the chart became a fun and useful tool for me and my fellow weavers.",tool:"2d",title:"Design a Potholder",hash:"5k8bm6hen7",tags:["list","interactive"],thumbUrl:oae},{ageRange:"19+",country:"Japan",lightOnDark:!0,name:"Kaito",statement:"I learned how to compute physical simulations on the computer efficiently. I also got a lot of universal know-how while trying to lighten the process through trial and error.",tool:"2d",title:"Billiards",hash:"ectj04nvx9",tags:["random","interactive","list","animation"],videoUrl:"19-billiards",thumbUrl:tae},{ageRange:"19+",country:"Japan",lightOnDark:!0,name:"Liebig",statement:"This is a train simulator game. You can drive the train and also enjoy the sound!",tool:"2d",title:"Train Simulator",hash:"0ukkzaqsc4",tags:["animation","interactive","tone","list"],videoUrl:"19-train-simulator"},{ageRange:"19+",country:"United States",name:"Michael Freeman",originalHash:"oc72hvih7n",statement:"As a physics teacher, I try to use my creativity to present physics concepts in interactive ways that allow students to draw connections between different representations of physics. In this project, I specifically learned, among many other things, how to use the modulo function to create a smooth infinite scroll for both the interactive cart animation as well as the position, velocity, acceleration, and force vs. time graphs. More generally, I learned what I can accomplish with a vision in mind; I knew for a long time what I wanted this to look like, and I kept working at it until it matched my vision.",tool:"2d",title:"Dynamics Cart",hash:"mupfg5ot3i",tags:["interactive","animation","list"],videoUrl:"19-dynamics-cart",thumbUrl:nae},{ageRange:"19+",country:"Israel",name:"ronwnor",statement:"looping animations are fun and cool",tool:"3d",title:"Graphic Decay",hash:"zgmsvhci9q",tags:["list","random","animation"],videoUrl:"19-graphic-decay"},{ageRange:"19+",country:"United States",name:"sea-saw",statement:`Thanks for checking out "The Meadow!" Through this piece, I explored the power of using Desmos restrictions to create complex shapes and organic textures. Most of the graph's geometry is simple planes and triangles with various types of noise applied through restrictions. The graph contains more information about how I created it and links to resources if you're interested learning more.`,tool:"3d",title:"The Meadow",hash:"7rjmjitoa2",tags:["random","list","animation"],videoUrl:"19-the-meadow"},{ageRange:"19+",country:"Israel",name:"Simon Lav",statement:`I'm not a mathematician, but I've always enjoyed crafting something beautiful using math. In this one, I tried to capture the magnificent flight of the hummingbird.
`,tool:"2d",title:"Hummingbird",hash:"lt3yqpjlru",tags:["animation","list"],videoUrl:"19-hummingbird"},{ageRange:"19+",country:"United Kingdom",name:"Sofia Monarchi",statement:`One of my favourite things I learnt this year was how to sketch solutions to first-order differential equations (equations for a function that involve its derivative).This inspired my submission, which uses Euler's method to simulate flowers blowing around in the wind. I like the saying "I'll see where the wind takes me" because I think it represents being open to new experiences and opportunities. However, this year I've learned it's also important to take initiative and find those opportunities for yourself, which is why I thought, "Ah, what about a project where you can be the wind..." And so, here we are.`,tool:"2d",title:"Where the wind takes me",hash:"yclweenaqq",tags:["animation","interactive","list"],videoUrl:"19-where-the-wind-takes-me"},{ageRange:"19+",country:"Singapore",name:"Soh Hui En",statement:"I was inspired to make this graph after seeing Taylor Swift (for the first time!) at the Eras Tour. In creating this artwork, I learnt how to use transformations to graph simpler functions instead of complicated functions. I also learnt many new Desmos functions, such as the random function, shading, and creating custom colours!",tool:"2d",title:"The Eras Tour",hash:"ccjjnaptf4",tags:["interactive","list","random"]},{ageRange:"19+",country:"Japan",lightOnDark:!0,name:"TETH_Main",statement:"This year, the implementation of complex numbers and recursion in Desmos prompted me to revisit and deepen my understanding of these concepts, which allowed me to incorporate the dragon curve into my artwork. Additionally, regarding 3D, I was able not only to enhance my understanding but also to create a textbook as part of my work, enabling me to explain the concepts to others.",tool:"2d",title:"The Fractal Milky Way",hash:"plcgxuggwb",tags:["complex","list","random","recursion","animation"],videoUrl:"19-the-fractal-milky-way"},{ageRange:"19+",country:"China",name:"Y.",statement:'Since Desmos 3D has been launched, I thought it was time to build a music player with 3D note visualization. The work is inspired by MIDITrail, a famous 3D MIDI visualizer. The piece ("Little" Fugue in G minor, BWV 578) has been parsed into four tracks to play in Desmos. You may also parse your MIDI in tracks, as in this example (as well as Track Select Function, Timbre and Barlines).',tool:"3d",title:'"Little" Fugue in G minor BWV578',hash:"wdu9e4eovg",tags:["animation","tone","list"],videoUrl:"19-little-fugue-in-g-minor-bwv578"},{ageRange:"19+",country:"Australia",name:"Zane Fares",originalHash:"uu8kk7gzro",statement:"I've always loved coding in unconventional environments, and one of the things I learned was that when loops aren't a supported structure, recursive functions can be used instead. So, when I saw Desmos added them, I had to try using Desmos as a coding language. The result: Desmos Snake.",tool:"2d",title:"Desmos Snake",hash:"db1dkewi9x",tags:["recursion","animation","interactive","random","list"],videoUrl:"19-desmos-snake",thumbUrl:iae},{ageRange:"19+",country:"Japan",name:"zboy",statement:"In creating this work, I thought of a way to give people a visual understanding of the complex Fourier transform. I also learned animation easing techniques and made my own improvements to speed up the process on Desmos.",tool:"2d",title:"Complex Fourie Transform Visualiser",hash:"vjolrybqdt",tags:["animation","list","interactive","complex"],videoUrl:"19-complex-fourier-transform-visualiser",thumbUrl:rae},{ageRange:"19+",country:"Hungary",lightOnDark:!0,name:"Zolt\xE1n Kalocsai",statement:"My submission is a neon logo for an imaginary Desmos-themed bar. It employs techniques inspired by metaballs, making it easy to render while remaining dynamic. The piece is intended to reference the iconic works of Ezra Oppenheimer from the 2020 and 2021 Desmos Math Art Contests.",tool:"2d",title:"Desmos Bar",hash:"tceetimm3k",tags:["random","list","animation"],videoUrl:"19-desmos-bar"},{ageRange:"19+",country:"South Korea",name:"HuiBeom Kim",statement:"Pintograph: Mesmerising Line Art was a fascinating app that generated a beautiful picture of the intersection of bars connected to two spinning discs. It's no longer on the App Store, but I'd love to run it again. At first, I didn't intend to find the time when all the discs ended up in their initial positions, but doing the calculations to find it was a fun maths moment that I look back on now.",tool:"2d",title:"Pintograph",hash:"bkpsugnufn",originalHash:"dzwetdcnh8",tags:["animation","list","interactive","random"],videoUrl:"19-pintograph"}];var cae={"13-14":"frontpage-link-art-contest-age-range-13-14","15-16":"frontpage-link-art-contest-age-range-15-16","17-18":"frontpage-link-art-contest-age-range-17-18","19+":"frontpage-link-art-contest-age-range-19"},G2=class{constructor(e){this.dispatch=e;this.submissionUrl="";this.submissionsByYear={};this.winningSubmissionsByYear={2023:Fne,2024:lae}}async fetchSubmissions(...e){let t=await Promise.all(e.map(o=>cf({year:o})));e.forEach((o,i)=>{this.submissionsByYear[o]=t[i]}),this.dispatch({type:"render"})}getSubmissions(e){var t;return(t=this.submissionsByYear[e])!=null?t:[]}getSubmission({year:e,product:t}){return this.getSubmissions(e).find(o=>o.product===t)}isLoadingSubmissions(...e){return e.some(t=>this.submissionsByYear[t]===void 0)}hasSubmissions(e,t){let o=this.getSubmissions(e);return t?o.some(i=>i.product===t):o.length>0}getOwnSubmissions(e){return this.getSubmissions(e).filter(t=>!t.submitting_for_someone_else)}hasOwnSubmissions(e){return this.getOwnSubmissions(e).length>0}getElseSubmissions(e){return this.getSubmissions(e).filter(t=>!!t.submitting_for_someone_else)}hasElseSubmissions(e){return this.getElseSubmissions(e).length>0}getWinningSubmissions(e){var t;return(t=this.winningSubmissionsByYear[e])!=null?t:[]}setWinningSubmissions(e,t){this.winningSubmissionsByYear[e]=t,this.dispatch({type:"render"})}getOwnWinningSubmission(e){let t=this.getOwnSubmissions(e);return this.getWinningSubmissions(e).find(o=>t.some(i=>i.graph_hash===o.originalHash||i.graph_hash===o.hash))}hasOwnWinningSubmission(e){return!this.isLoadingSubmissions(e)&&!!this.getOwnWinningSubmission(e)}getTargetSubmission(){return this.targetSubmission}getSubmissionUrl(){return this.submissionUrl}getHashFromUrl(e){return e.split("?")[0].split("/").pop()}hasSubmissionUrl(){return!!this.submissionUrl&&!!Hw(this.submissionUrl)&&Hw(this.submissionUrl)!=="geometry"}inferTargetSubmission(){let e=Hw(this.submissionUrl),t=this.getHashFromUrl(this.submissionUrl);!this.hasSubmissionUrl()||!t||!e||e==="geometry"||(this.targetSubmission={graph_hash:t,product:e,submitting_for_someone_else:!0,first_time_submission:!0})}setTargetSubmission(e){this.targetSubmission=e}setSubmissionUrl(e){this.submissionUrl=e}resetTargetSubmission(){this.submissionUrl="",this.targetSubmission=void 0}resetSubmissionsByYear(){this.submissionsByYear={},this.submissionUrl="",this.targetSubmission=void 0}};var Fs=__dcg_shared_module_exports__['e'](j());var{If:V2,For:LCe,Input:PCe}=Fs.Components,yT=class extends Fs.View{constructor(){super(...arguments),this.filter=void 0,this.focusLocation=void 0,this.lastResultCount=0}init(){this.controller=this.props.controller()}template(){return x("div",{class:Fs.const("dcg-search-container"),onKeyDown:this.bindFn(this.onKeydown),children:[l(V2,{predicate:this.props.renderWithInput,children:()=>x("div",{role:Fs.const("search"),class:Fs.const("dcg-searchable-dropdown"),children:[l(PCe,{class:()=>({"dcg-results-hidden":!this.showResults()}),id:()=>this.props.id?this.props.id():void 0,didMount:this.bindFn(this.didMountInput),onInput:this.bindFn(this.onInputChange),value:this.bindFn(this.getFilterString),placeholder:()=>this.props.placeholder(),autofill:this.const(!1),"data-1p-ignore":this.const(!0),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFilterBeFocused),onFocusedChanged:this.bindFn(this.onFilterFocusChange)}),required:()=>{var e,t;return(t=(e=this.props).required)==null?void 0:t.call(e)}}),l(V2,{predicate:()=>this.shouldShowDeleteX(),children:()=>l("i",{class:Fs.const("dcg-icon-remove dcg-remove-x dcg-do-not-blur"),role:Fs.const("button"),tabIndex:Fs.const("0"),"aria-label":()=>this.controller.s("shared-calculator-button-clear"),onTap:this.bindFn(this.onDeleteXTapped)})})]})}),l(V2,{predicate:()=>this.getFilteredOptions().length>0&&this.showResults(),children:()=>l("div",{class:()=>{var e,t;return{"dcg-searchable-dropdown-list-container":!0,"dcg-render-as-popover":(t=(e=this.props).popoverOptionsOnFocus)==null?void 0:t.call(e)}},children:l("div",{class:()=>({"dcg-searchable-dropdown-list":!0,"dcg-do-not-blur":!0,"dcg-no-input":!this.props.renderWithInput()}),role:Fs.const("listbox"),"aria-label":()=>this.controller.s("shared-calculator-label-search-results"),children:l(LCe,{each:()=>this.getFilteredOptions(),children:e=>l("div",{class:Fs.const("dcg-searchable-dropdown-option"),role:Fs.const("option"),onTap:t=>this.selectOption(e,t.device==="keyboard"),manageFocus:this.const({shouldBeFocused:()=>this.shouldOptionBeFocused(e),onFocusedChanged:t=>this.onOptionFocusChange(e,t)}),tabIndex:Fs.const(0),children:this.const(e.label)})},e=>e.id+"-"+e.label)})})}),l(V2,{predicate:()=>this.getFilteredOptions().length===0&&this.showResults(),children:()=>l("div",{class:()=>{var e,t;return{"dcg-searchable-dropdown-list-container":!0,"dcg-render-as-popover":(t=(e=this.props).popoverOptionsOnFocus)==null?void 0:t.call(e)}},children:l("div",{class:()=>({"dcg-searchable-dropdown-list":!0,"dcg-no-search-results":!0}),children:()=>this.controller.s("shared-calculator-text-search-results",{count:__dcg_shared_module_exports__['Db'](0)})})})})]})}showResults(){var e,t;return(t=(e=this.props).popoverOptionsOnFocus)!=null&&t.call(e)?!!this.focusLocation:!0}didMountInput(){var e,t;(t=(e=this.props).popoverOptionsOnFocus)!=null&&t.call(e)||this.focusFilter()}shouldShowDeleteX(){return!!this.getFilterString()}onDeleteXTapped(e){this.onInputChange(""),this.props.externalControl?(this.props.externalControl().onClear(),e.device==="keyboard"&&this.focusFilter()):(this.focusFilter(),this.update())}shouldFilterBeFocused(){return this.focusLocation&&this.focusLocation.type==="filter"}onFilterFocusChange(e){e?this.focusFilter():(this.focusLocation=void 0,this.update())}shouldOptionBeFocused(e){return this.focusLocation&&this.focusLocation.type==="option"&&this.focusLocation.id===e.id}focusFilter(){this.focusLocation={type:"filter"},this.update()}focusOption(e){this.focusLocation={type:"option",id:e.id},this.update()}getFocusedOptionIndex(){if(!this.focusLocation||this.focusLocation.type!=="option")return-1;let e=this.focusLocation.id,t=this.getFilteredOptions();for(let o=0;o<t.length;o++)if(t[o].id===e)return o;return-1}onOptionFocusChange(e,t){t?this.focusOption(e):(this.focusLocation=void 0,this.update())}onKeydown(e){switch(Pe(e)){case Yu:if(this.shouldFilterBeFocused()){let t=this.getFilteredOptions();t.length===1&&this.selectOption(t[0],!0)}break;case Tn:this.moveFocusInDirection(-1)&&e.preventDefault();break;case Mi:this.moveFocusInDirection(1)&&e.preventDefault();break;case Bu:e.preventDefault(),this.focusFirstOption();break;case Wc:e.preventDefault(),this.focusLastOption();break;case Wi:this.props.onCancel();break;case us:e.shiftKey?this.moveFocusInDirection(-1)&&e.preventDefault():this.moveFocusInDirection(1)&&e.preventDefault();break}}moveFocusInDirection(e){let t=this.getFilteredOptions(),i=this.getFocusedOptionIndex()+e;if(i==-1&&this.props.renderWithInput())return this.focusFilter(),!0;let n=t[i];return n?(this.focusOption(n),!0):!1}focusFirstOption(){let e=this.getFilteredOptions();e.length!==0&&this.focusOption(e[0])}focusLastOption(){let e=this.getFilteredOptions();e.length!==0&&this.focusOption(e[e.length-1])}onInputChange(e){this.props.externalControl?this.props.externalControl().onValueChange(e):this.filter=e,this.update()}getFilterString(){return this.props.externalControl?this.props.externalControl().getValue():this.filter||""}selectOption(e,t){var o,i;(i=(o=this.props).popoverOptionsOnFocus)!=null&&i.call(o)?this.onInputChange(e.label):this.onInputChange(""),this.focusLocation=void 0,this.update(),this.props.onChange({value:e.id,fromKeyboard:t})}getFilteredOptions(){let e=this.props.options(),t=this.getFilterString().toLowerCase().trim();return t&&(e=e.filter(o=>o.label.toLowerCase().indexOf(t)!==-1)),e}onUpdate(){let e=this.getFilteredOptions().length;this.focusLocation&&this.focusLocation.type==="filter"&&e!==this.lastResultCount&&_e(this.controller.s("shared-calculator-text-search-results",{count:__dcg_shared_module_exports__['Db'](e)})),this.lastResultCount=e}};var Sl=__dcg_shared_module_exports__['e'](j()),{Input:GCe,Switch:VCe}=Sl.Components,SS=r=>({inputLabel:r.s("graphing-calculator-narration-share-graph-link"),inputName:r.s("graphing-calculator-text-share-graph-link"),successLabel:r.s("graphing-calculator-narration-share-graph-link-copied"),errorLabel:r.s("graphing-calculator-narration-share-graph-link-unable-to-copy"),copyText:r.s("graphing-calculator-button-share-graph-link-copy")}),df=class extends Sl.View{template(){return x("div",{class:Sl.const("dcg-selectable-input-container"),children:[l(GCe,{class:this.const("dcg-permalink select-all dcg-variable-permalink"),"aria-label":()=>this.props.strings().inputLabel,name:()=>this.props.strings().inputName,value:this.props.link,didMount:e=>{this.inputEl=e,this.inputEl.focus(),this.inputEl.select()},onTap:()=>this.inputEl.select(),onCopy:()=>{var e,t;return(t=(e=this.props).triggerLogEvent)==null?void 0:t.call(e)},onInput:()=>{}}),l("div",{role:Sl.const("button"),tabIndex:Sl.const(0),class:Sl.const("dcg-copy-button"),onTap:this.bindFn(this.copyLink),children:l(VCe,{children:e=>e=="success"?l("span",{"aria-label":()=>this.props.strings().successLabel,children:l("i",{class:Sl.const("dcg-icon-check"),"aria-hidden":Sl.const("true")})}):e=="error"?l("span",{"aria-label":()=>this.props.strings().errorLabel,children:l("i",{class:Sl.const("dcg-icon-error"),"aria-hidden":Sl.const("true")})}):l("span",{class:Sl.const("dcg-copy-text"),children:()=>this.props.strings().copyText})},()=>this.copyStatus)})]})}copyLink(){var e,t;if(this.inputEl){this.inputEl.select(),this.copyStatus="success";try{document.execCommand("copy")}catch(o){this.copyStatus="error"}this._isMounted&&((t=(e=this.props).triggerLogEvent)==null||t.call(e),this.update(),clearTimeout(this.copyStatusTimeout),this.copyStatusTimeout=setTimeout(this.bindIfMounted(()=>{this.copyStatus=null,this.update()}),2500))}}};var BB={US:"United States",AF:"Afghanistan",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BQ:"Bonaire, Sint Eustatius and Saba",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",CV:"Cabo Verde",KH:"Cambodia",CM:"Cameroon",CA:"Canada",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CD:"Congo (the Democratic Republic of the)",CG:"Congo",CK:"Cook Islands",CR:"Costa Rica",HR:"Croatia",CU:"Cuba",CW:"Cura\xE7ao",CY:"Cyprus",CZ:"Czechia",CI:"C\xF4te d'Ivoire",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",SZ:"Eswatini",ET:"Ethiopia",FK:"Falkland Islands [Malvinas]",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Islands",VA:"Holy See",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"North Korea",KR:"South Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MK:"North Macedonia",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",RE:"R\xE9union",BL:"Saint Barth\xE9lemy",SH:"Saint Helena, Ascension and Tristan da Cunha",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin (French part)",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten (Dutch part)",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",TR:"T\xFCrkiye",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",UM:"United States Minor Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands (British)",VI:"Virgin Islands (U.S.)",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe",AX:"\xC5land Islands"},OCe=Object.values(BB),dae=r=>!!r&&OCe.indexOf(r)!==-1,pae={Algeria:13,Angola:13,"Antigua and Barbuda":16,Argentina:18,Armenia:18,Australia:15,Austria:14,Azerbaijan:20,Bahamas:16,Barbados:18,Bangladesh:18,Belgium:13,Belize:16,Benin:13,Bolivia:14,Botswana:13,Brazil:13,Bulgaria:14,"Burkina Faso":13,Burundi:13,Cameroon:13,Canada:16,"Cabo Verde":13,"Central African Republic":13,Chad:13,Chile:18,China:14,Colombia:18,Comoros:13,Congo:13,"Costa Rica":15,"C\xF4te d'Ivoire":13,Croatia:16,Cyprus:14,Czechia:15,Denmark:13,Djibouti:13,"Dominican Republic":16,Ecuador:14,Egypt:18,"El Salvador":18,"Equatorial Guinea":13,Eritrea:13,Estonia:13,Ethiopia:13,Finland:13,France:15,Gabon:13,Gambia:13,Germany:16,Ghana:13,Gibraltar:16,Greece:15,Grenada:16,Guatemala:16,Guinea:13,Guyana:16,Haiti:16,"Hong Kong":20,Hungary:16,Iceland:18,India:18,Indonesia:21,Ireland:16,Israel:14,Italy:14,Jamaica:16,Japan:20,Jordan:16,Kazakhstan:18,Kenya:13,Kuwait:17,Kyrgyzstan:18,Latvia:13,Lebanon:18,Lesotho:13,Liberia:13,Libya:13,Lithuania:14,Luxembourg:16,"North Macedonia":14,Madagascar:13,Malawi:13,Malaysia:18,Mali:13,Malta:13,Mauritania:13,Mauritius:13,Mexico:18,Moldova:18,Morocco:18,Mozambique:13,Namibia:13,Nepal:16,Netherlands:16,"New Zealand":16,Niger:13,Nigeria:13,Norway:15,Pakistan:18,Panama:18,Paraguay:20,Peru:15,Philippines:18,Poland:16,Portugal:13,"Puerto Rico":18,R\u00E9union:13,Romania:16,"Russian Federation":18,Rwanda:13,"Saint Lucia":16,"Saint Vincent and the Grenadines":15,"Sao Tome and Principe":13,"Saudi Arabia":20,Senegal:13,Serbia:18,Seychelles:13,"Sierra Leone":13,Singapore:13,Slovakia:16,Slovenia:16,Somalia:13,"South Africa":18,"South Korea":14,"South Sudan":13,Spain:14,"Sri Lanka":18,Sudan:13,Suriname:16,Eswatini:13,Sweden:13,Switzerland:18,Taiwan:18,Tajikistan:18,Tanzania:13,Thailand:20,Togo:13,"Trinidad and Tobago":16,Tunisia:13,T\u00FCrkiye:16,Uganda:13,Ukraine:14,"United Arab Emirates":18,"United Kingdom":13,"United States":13,Uruguay:18,Uzbekistan:18,Venezuela:18,"Western Sahara":13,"Viet Nam":18,Yemen:9,Zambia:13,Zimbabwe:13};function KB(r){return!!r&&!!r.country&&!!r.birth_year&&!!r.email&&!!r.artist_statement&&!!r.name&&!!r.graph_hash&&!!r.product&&!!r.country&&!!r.age_group}var{If:pf,IfElse:zB,Input:uae,SwitchUnion:RCe,Textarea:FCe}=qe.Components,NCe=Object.values(BB).map(r=>({id:r,label:r})),UCe=Array.from({length:121},(r,e)=>{let t=2020-e;return{id:t.toString(),label:t.toString()}}),YCe={country:"account-shell-text-art-contest-someone-else-country","birth-year":"account-shell-text-art-contest-someone-else-birth-year",name:"account-shell-text-art-contest-someone-else-name",email:"account-shell-text-art-contest-someone-else-email","artist-statement":"account-shell-text-art-contest-someone-else-artist-statement","artist-statement-description":"account-shell-text-art-contest-someone-else-artist-statement-description","artist-statement-placeholder":"account-shell-label-artist-statement-placeholder-someone-else",agreement:"account-shell-text-art-contest-someone-else-copyright-agreement"},BCe={country:"account-shell-heading-country","birth-year":"account-shell-heading-birth-year",name:"account-shell-heading-name",email:"account-shell-heading-email","artist-statement":"account-shell-heading-artist-statement","artist-statement-description":"account-shell-label-artist-statement-description","artist-statement-placeholder":"account-shell-label-artist-statement-placeholder",agreement:"account-shell-text-art-contest-copyright-agreement"},qB=class extends qe.View{template(){return x("div",{class:qe.const("dcg-contest-submission-preview"),children:[l("div",{class:qe.const("dcg-art-contest-submission-thumbnail"),children:l("img",{src:()=>{var e;return(e=this.props.currentSubmission())==null?void 0:e.thumb},alt:this.bindFn(this.getThumbAlt)})}),x("div",{class:qe.const("dcg-contest-about"),children:[x("div",{class:qe.const("dcg-contest-about__header"),children:[l("div",{class:qe.const("dcg-contest-about__age-group"),children:()=>{var e;return this.getAgeBracket((e=this.props.currentSubmission())==null?void 0:e.age_group)}}),l("div",{class:qe.const("dcg-contest-about__title"),children:()=>{var e;return`\u201C${((e=this.props.currentSubmission())==null?void 0:e.title)||this.props.s("account-shell-text-untitled")}\u201D`}}),l("div",{class:qe.const("dcg-contest-about__author"),children:()=>{var e,t;return this.props.s("frontpage-text-art-contest-name-and-country",{name:((e=this.props.currentSubmission())==null?void 0:e.name)||"",country:((t=this.props.currentSubmission())==null?void 0:t.country)||""})}})]}),l("div",{class:qe.const("dcg-contest-about__artist-statement"),children:()=>{var e;return(e=this.props.currentSubmission())==null?void 0:e.artist_statement}}),this.props.children]})]})}getThumbAlt(){let e=this.props.currentSubmission();return e!=null&&e.title&&e.title!==""?this.props.s("frontpage-narration-art-contest-image-of-graph",{graphTitle:e.title}):e!=null&&e.name?this.props.s("frontpage-narration-art-contest-image-of-graph-by",{name:e.name}):""}getAgeBracket(e){return e?this.props.s(cae[e]):""}},HB=class extends qe.View{template(){return x(Ot,{i18n:this.props.i18n,children:["Submitted for ",l("b",{children:()=>{var e;return(e=this.props.currentSubmission())==null?void 0:e.name}})," by"," ",l("b",{children:()=>{var e;return(e=this.props.currentSubmission())==null?void 0:e.email}}),". You can delete and resubmit any time before"," ",l("span",{class:qe.const("dcg-non-breaking-date"),children:"January 15th, 2025"}),". Learn more at"," ",l("a",{href:qe.const("/art"),target:qe.const("_blank"),class:qe.const("dcg-blue-link"),children:"desmos.com/art"}),"."]},this.const("account-shell-text-art-contest-success-paragraph-someone-else"))}},O2=class extends qe.View{getProductType(){var t,o,i;let e=(t=this.shellController)==null?void 0:t.getProduct();return(i=(o=this.currentSubmission)==null?void 0:o.product)!=null?i:e}shouldSaveGraph(){var e;return(e=this.shellController)==null?void 0:e.graphsController.hasUnsavedChanges()}saveGraph(){!this.shellController||!this.currentSubmission||(this.shellController.graphsController.isCurrentGraphTitled()&&this.shellController.graphsController.wasCurrentGraphEverSaved()?(this.saveStatus={operation:"save",status:"pending"},this.shellController.saveGraph({preventCloseModal:!0})):(this.saveStatus={operation:"share",status:"pending"},this.shellController.graphsController.createSnapshotLink()))}didUpdate(){if(!this.shellController)return;let e=this.shellController.graphsController;if(this.saveStatus.status==="pending"){let t=this.saveStatus.operation==="save"?e.lastSaveStatus:e.lastShareStatus;if((t==null?void 0:t.state)==="loaded"){let o=t.data;this.currentSubmission.title=o.title,this.currentSubmission.graph_hash=o.hash,this.saveStatus={...this.saveStatus,status:"success"},this.update()}else(t==null?void 0:t.state)==="error"&&(this.saveStatus={...this.saveStatus,status:"fail"},this.update())}}init(){var e,t,o;"frontpageController"in this.props?(this.frontpageController=this.props.frontpageController(),this.s=this.frontpageController.s):(this.shellController=this.props.shellController(),this.s=this.shellController.s),this.saveStatus={status:"idle"},this.submitStatus="idle",this.currentSubmission={...(t=(e=this.props).currentSubmission)==null?void 0:t.call(e)},(o=this.currentSubmission)!=null&&o.submitting_for_someone_else?this.translationStrings=YCe:this.translationStrings=BCe,this.getScreen()==="form"&&this.initEditMode()}getProductSafely(){var t;return(t=this.shellController)==null?void 0:t.getProduct()}async initEditMode(){var o,i,n,a;let e=((o=this.currentSubmission)==null?void 0:o.name)||((i=this.shellController)==null?void 0:i.userController.getFullName()),t=(n=this.currentSubmission)==null?void 0:n.name;this.currentSubmission={age_group:this.getSelectedAgeGroup(),product:this.getProductSafely(),...this.currentSubmission,name:this.getIsForSomeoneElse()?t:e,email:((a=this.currentSubmission)==null?void 0:a.email)||this.getController().userController.getEmail()},this.hasConsent=!1,this.shouldSaveGraph()?this.saveGraph():this.shellController&&(this.currentSubmission.graph_hash=this.shellController.graphsController.getCurrentGraphHash(),this.currentSubmission.title=this.shellController.graphsController.getCurrentGraphTitle())}getIsForSomeoneElse(){var e;return!!((e=this.currentSubmission)!=null&&e.submitting_for_someone_else)}didJustSubmit(){return this.submitStatus==="success"}getScreen(){var e;return(e=this.currentSubmission)!=null&&e.submission_id&&this.submitStatus==="idle"&&!this.shouldUpdateSubmission?"showing-submission":this.saveStatus.status==="pending"?"saving":this.saveStatus.status==="fail"?"save-failed":this.submitStatus==="fail"?"submit-failed":this.submitStatus==="pending"?"submitting":this.submitStatus==="success"?"showing-submission":"form"}getController(){return"shellController"in this.props?this.props.shellController():this.props.frontpageController()}shouldAllowUpdate(){return this.didJustSubmit()||!this.shellController?!1:this.shellController.isGraphComplexEnoughForContest()&&!this.shellController.graphsController.willSaveCopy()}template(){return l("div",{class:qe.const("modal_section"),children:l("div",{class:qe.const("dcg-contest-submission-dialog dcg-text-selectable"),children:RCe(()=>this.getScreen(),{"showing-submission":()=>x("div",{class:qe.const("dcg-contest-submission-container"),children:[x("h1",{class:qe.const("dcg-contest-submission-title"),children:[l("i",{class:qe.const("dcg-icon-sparkle"),"aria-hidden":qe.const("true")}),()=>this.didJustSubmit()?this.s("account-shell-label-submission-received"):this.s("account-shell-label-submission-already-received"),l("i",{class:qe.const("dcg-icon-sparkle"),"aria-hidden":qe.const("true")})]}),l(qB,{s:this.s,currentSubmission:()=>this.currentSubmission,children:l(pf,{predicate:this.bindFn(this.shouldAllowUpdate),children:()=>l("button",{class:qe.const("dcg-btn-purple-outline dcg-contest-about__resubmit"),onTap:this.bindFn(this.triggerSubmissionUpdate),children:()=>this.s("account-shell-button-update-graph")})})}),l("div",{class:qe.const("dcg-contest-submission-dialog__footer"),children:l("div",{class:qe.const("dcg-contest-submission-dialog__footer-message"),children:zB(()=>this.getIsForSomeoneElse(),{false:()=>x(Ot,{i18n:this.bindFn(this.getController),children:["Submitted using"," ",l("b",{children:()=>{var e;return((e=this.currentSubmission)==null?void 0:e.email)||""}}),". You can edit your submission anytime before"," ",l("span",{class:qe.const("dcg-non-breaking-date"),children:"January 15th, 2025"}),". Learn more at"," ",l("a",{href:qe.const("/art"),target:qe.const("_blank"),class:qe.const("dcg-blue-link"),children:"desmos.com/art"}),"."]},this.const("account-shell-label-submission-already-received-with-email")),true:()=>l(HB,{currentSubmission:()=>this.currentSubmission,i18n:()=>this.getController()})})})})]}),saving:()=>l("div",{class:qe.const("dcg-save-animation-container"),children:l("div",{class:qe.const("dcg-saving"),children:x("div",{"aria-live":qe.const("polite"),"aria-atomic":qe.const("true"),children:[l("span",{class:qe.const("dcg-spinner")}),()=>this.s("account-shell-label-saving-graph")]})})}),"save-failed":()=>l("div",{class:qe.const("dcg-save-animation-container"),children:l("div",{class:qe.const("dcg-saving"),children:l("div",{"aria-live":qe.const("polite"),"aria-atomic":qe.const("true"),children:()=>this.s("account-shell-error-save-art-contest")})})}),submitting:()=>l("div",{class:qe.const("dcg-save-animation-container"),children:l("div",{class:qe.const("dcg-saving"),children:x("div",{"aria-live":qe.const("polite"),"aria-atomic":qe.const("true"),children:[l("span",{class:qe.const("dcg-spinner")}),()=>this.s("account-shell-label-submitting")]})})}),"submit-failed":()=>l("div",{class:qe.const("dcg-save-animation-container"),children:l("div",{class:qe.const("dcg-saving"),children:l("div",{"aria-live":qe.const("polite"),"aria-atomic":qe.const("true"),children:()=>this.s("account-shell-error-submitting")})})}),form:()=>x("div",{class:qe.const("dcg-contest-submission-container"),children:[l("h1",{class:qe.const("dcg-contest-submission-title"),children:()=>this.s("account-shell-heading-submit-graph")}),x("form",{class:qe.const("dcg-submission-form"),onSubmit:this.bindFn(this.submitEntry),children:[x("div",{class:qe.const("dcg-country-and-year"),children:[x("div",{class:qe.const("dcg-form-section"),children:[l("label",{class:qe.const("dcg-section-title"),for:qe.const("art-contest-country"),children:()=>this.s(this.translationStrings.country)}),l(pf,{predicate:()=>!!this.getSelectedCountry(),children:()=>l("button",{class:qe.const("dcg-blue-link dcg-edit-link"),onTap:()=>{this.setSelectedCountry(void 0)},"aria-label":()=>this.s("account-shell-narration-edit-selected-country"),children:()=>this.s("account-shell-button-edit")})}),zB(()=>!!this.getSelectedCountry(),{true:()=>l("div",{class:qe.const("dcg-your-country-name"),children:()=>this.getSelectedCountry()}),false:()=>l(yT,{controller:this.bindFn(this.getController),options:()=>this.getListOfCountries(),onChange:e=>this.setSelectedCountry(e.value),onCancel:()=>this.setSelectedCountry(void 0),renderWithInput:()=>!0,id:this.const("art-contest-country"),placeholder:()=>this.s("account-shell-label-country-placeholder"),required:this.const(!0)})})]}),x("div",{class:qe.const("dcg-form-section"),children:[l("label",{class:qe.const("dcg-section-title"),for:qe.const("art-contest-birth-year"),children:()=>this.s(this.translationStrings["birth-year"])}),l(pf,{predicate:()=>!!this.getSelectedCountry()&&!!this.getSelectedYear(),children:()=>l("button",{class:qe.const("dcg-blue-link dcg-edit-link"),onTap:()=>{this.setSelectedYear(void 0)},"aria-label":()=>this.s("account-shell-narration-edit-selected-year"),children:()=>this.s("account-shell-button-edit")})}),l(pf,{predicate:()=>this.shouldShowAgeOptions(),children:()=>l("div",{children:zB(()=>!!this.getSelectedYear(),{true:()=>l("div",{class:qe.const("dcg-your-birth-year"),children:()=>this.getSelectedYear()}),false:()=>l(yT,{controller:this.bindFn(this.getController),options:()=>this.getListOfYears(),onChange:e=>this.setSelectedYear(e.value),onCancel:()=>this.setSelectedYear(void 0),renderWithInput:()=>!0,placeholder:()=>this.s("account-shell-label-birth-year-placeholder"),id:this.const("art-contest-birth-year"),required:()=>!0})})})})]})]}),l(pf,{predicate:()=>this.isSubmissionEligible(),children:()=>x("div",{children:[x("div",{class:qe.const("dcg-form-section-flex"),children:[x("div",{class:qe.const("dcg-form-section"),children:[l("label",{class:qe.const("dcg-section-title"),for:qe.const("art-contest-name"),children:()=>this.s(this.translationStrings.name)}),l(uae,{class:this.const("dcg-shared-input-blue-outline"),didMount:e=>{e.focus(),e.select()},"data-1p-ignore":this.const(!0),onInput:e=>this.setUserName(e),value:this.bindFn(this.getUserName),disabled:()=>!1,id:this.const("art-contest-name"),required:()=>!0,"aria-describedby":this.const("art-contest-name-description")}),l("div",{class:qe.const("dcg-section-subtitle"),id:qe.const("art-contest-name-description"),children:()=>this.s("account-shell-heading-name-details")})]}),x("div",{class:qe.const("dcg-form-section"),children:[l("label",{class:qe.const("dcg-section-title"),for:qe.const("art-contest-email"),children:()=>this.s(this.translationStrings.email)}),l(uae,{class:this.const("dcg-shared-input-blue-outline"),"data-1p-ignore":this.const(!0),onInput:e=>this.setUserEmail(e),value:this.bindFn(this.getUserEmail),placeholder:()=>this.s("account-shell-label-email-address"),disabled:()=>!1,id:this.const("art-contest-email"),required:()=>!0,"aria-describedby":this.const("art-contest-email-description"),type:this.const("email"),pattern:this.const(cu)}),l("div",{class:qe.const("dcg-section-subtitle"),id:qe.const("art-contest-email-description"),children:()=>this.s("account-shell-heading-email-details")})]})]}),x("div",{class:qe.const("dcg-form-section"),children:[l("label",{class:qe.const("dcg-section-title"),for:qe.const("art-contest-artist-statement"),children:()=>this.s(this.translationStrings["artist-statement"])}),l("div",{class:qe.const("dcg-section-artist-statement-label"),id:qe.const("art-contest-artist-statement-description"),children:()=>this.s(this.translationStrings["artist-statement-description"])}),l(FCe,{class:this.const("dcg-shared-input-blue-outline dcg-artist-statement-input"),onInput:e=>this.setArtistStatement(e),value:this.bindFn(this.getArtistStatement),maxLength:this.const(900),placeholder:()=>this.s(this.translationStrings["artist-statement-placeholder"]),id:this.const("art-contest-artist-statement"),required:()=>!0,"aria-describedby":this.const("art-contest-artist-statement-description")})]}),l(ft,{checked:this.bindFn(this.getConsentTicked),onChange:this.bindFn(this.toggleConsent),required:()=>!0,children:()=>this.s(this.translationStrings.agreement)}),l("div",{class:qe.const("dcg-submit-btn-container"),children:l("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.isSubmitButtonDisabled(),"dcg-submit-this-graph-btn":!0}),"aria-disabled":()=>this.isSubmitButtonDisabled()?!0:void 0,type:qe.const("submit"),children:()=>this.s("account-shell-button-submit-graph")})})]})}),l(pf,{predicate:()=>this.shouldShowIneligible(),children:()=>x("div",{class:qe.const("dcg-ineligible-container"),"aria-live":qe.const("polite"),"aria-atomic":qe.const("true"),children:[l("i",{class:qe.const("dcg-icon-error"),"aria-hidden":qe.const("true")}),l(Ot,{i18n:this.bindFn(this.getController),children:x("div",{class:qe.const("dcg-ineligible-text-container"),children:[l("div",{class:qe.const("dcg-ineligible-text"),children:"Based on the provided age, we aren\u2019t able to accept this graph submission this year."}),l("div",{class:qe.const("dcg-ineligible-text"),children:"Keep up the awesome graphing! There will be new contests every year."})]})},this.const("account-shell-text-artcontest-ineligible"))]})}),l(pf,{predicate:()=>this.shouldPromptSomeoneElse(),children:()=>x("div",{class:qe.const("dcg-ineligible-container"),"aria-live":qe.const("polite"),"aria-atomic":qe.const("true"),children:[l("i",{class:qe.const("dcg-icon-error"),"aria-hidden":qe.const("true")}),l(Ot,{i18n:this.bindFn(this.getController),children:x("div",{class:qe.const("dcg-ineligible-text-container"),children:[l("div",{class:qe.const("dcg-ineligible-text"),children:"Based on your age and location, you need a teacher, parent, or guardian over the age of 18 to submit your graph for you."}),x("div",{class:qe.const("dcg-ineligible-text"),children:["Here is the link to your graph:"," "]}),Ot.subview("graphlink",()=>l(df,{strings:()=>SS(this.getController()),link:()=>Kre(this.getGraphHash(),this.getProductType())})),x("div",{class:qe.const("dcg-ineligible-text"),children:["Please share it with one of them and have them submit it at"," ",l("a",{href:qe.const("/art"),class:qe.const("dcg-blue-link"),target:qe.const("_blank"),children:"desmos.com/art"}),"."]})]})},this.const("account-shell-text-artcontest-someone-else"))]})})]}),l(pf,{predicate:()=>this.isSubmissionEligible(),children:()=>l("div",{class:qe.const("dcg-contest-submission-dialog__footer"),children:l("div",{class:qe.const("dcg-contest-submission-dialog__footer-message"),children:()=>this.s("account-shell-text-art-contest-legal-disclaimer")})})})]})})})})}getGraphHash(){return this.currentSubmission.graph_hash}async submitEntry(e){var t,o,i;if(e.preventDefault(),!this.isSubmitButtonDisabled()){this.submitStatus="pending",this.update();try{let n=this.currentSubmission;if(!KB(n))throw new Error("Invalid submission");let a=await bne(n);if(!this._isMounted)return;let s=Array.isArray(a)?a[0]:a;if(s!=null&&s.submission_id&&(this.submitStatus="success",(o=(t=this.props).onSuccessfulSubmit)==null||o.call(t),(i=this.currentSubmission)!=null&&i.submitting_for_someone_else?Sr({category:"art-contest",action:"submit-for-someone-else"}):Sr({category:"art-contest",action:"submit"})),await this.fetchContestEntry(),!this._isMounted)return;this.shouldUpdateSubmission=!1}catch(n){if(!this._isMounted)return;_e(this.s("account-shell-error-submitting")),this.submitStatus="fail"}finally{this._isMounted&&this.update()}}}triggerSubmissionUpdate(){this.initEditMode(),this.shouldUpdateSubmission=!0,this.update()}async fetchContestEntry(){let e=this.getProductType();if(e)try{let t=await cf({year:Hs,product:e});if(!this._isMounted)return;this.currentSubmission=t[0]}catch(t){if(!this._isMounted)return;_e(this.s("account-shell-error-submitting")),this.submitStatus="fail"}finally{this._isMounted&&this.update()}}shouldShowAgeOptions(){return!!this.getSelectedCountry()}shouldShowIneligible(){let e=this.getUserAgeInYears();return!!this.getSelectedCountry()&&!!this.getSelectedYear()&&!!e&&e<13}shouldPromptSomeoneElse(){return!!this.getSelectedCountry()&&!!this.getSelectedYear()&&!this.isSubmissionEligible()&&!this.shouldShowIneligible()}setArtistStatement(e){this.currentSubmission.artist_statement=e,this.update()}setSelectedYear(e){this.currentSubmission.birth_year!==e&&(this.currentSubmission.birth_year=e?Number(e):void 0,this.currentSubmission.age_group=this.getSelectedAgeGroup(),this.update())}setSelectedCountry(e){this.currentSubmission.country=e,this.update()}getArtistStatement(){return this.currentSubmission.artist_statement||""}getSelectedCountry(){return this.currentSubmission.country}getSelectedYear(){return this.currentSubmission.birth_year}getUserAgeInYears(){return this.currentSubmission.birth_year?Hs-this.currentSubmission.birth_year:void 0}getSelectedAgeGroup(e=this.getUserAgeInYears()){if(e!==void 0){if(e>=19)return"19+";if(e>=17)return"17-18";if(e>=15)return"15-16";if(e>=13)return"13-14"}}getUserName(){return this.currentSubmission.name||""}setUserName(e){this.currentSubmission.name=e,this.update()}getUserEmail(){return this.currentSubmission.email||""}setUserEmail(e){this.currentSubmission.email=e,this.update()}getConsentTicked(){return!!this.hasConsent}toggleConsent(){this.hasConsent=!this.hasConsent,this.update()}isSubmitButtonDisabled(){return!this.hasConsent||this.submitStatus==="pending"||!KB(this.currentSubmission)}isSubmissionEligible(){var o,i;if(!this.currentSubmission.country||!this.currentSubmission.birth_year)return!1;let e=this.getUserAgeInYears();if((o=this.currentSubmission)!=null&&o.submitting_for_someone_else&&e&&e>=13)return!0;let t=(i=pae[this.currentSubmission.country])!=null?i:16;return!!e&&e>=t}getListOfCountries(){return NCe}getListOfYears(){return UCe}};var Eo=__dcg_shared_module_exports__['e'](j());function hae(r){let e=r.split(","),t=e[0].match(/:(.*?);/),o=t!==null?t[1]:"",i=e[1]!==null?atob(e[1]):"",n=i.length,a=new Uint8Array(n);for(;n--;)a[n]=i.charCodeAt(n);return new Blob([a],{type:o})}function gae(r){if(r.indexOf("xmlns=")===-1)throw new Error('Programming error: <svg> elements require the "xmlns" attribute to render properly');return new Blob([r],{type:"image/xml+svg;charset=utf-8"})}var{If:$h,IfElse:KCe}=Eo.Components,Jh={};Jh.small_square={width:160,height:160};Jh.medium_square={width:400,height:400};Jh.large_square={width:1e3,height:1e3};Jh.medium_rectangle={width:600,height:400};Jh.large_rectangle={width:1200,height:800};Jh={...Jh,...hm};var xT=class extends Eo.View{init(){this.controller=this.props.controller(),this.thickness="thin";let e=this.controller.api.controller.getBrailleMode();this.brailleMode=e!=="none"?e:"nemeth",this.showDownloadButton=LV(),this.markImagesDirty(),this.loaded=!1,this.exportType=e!=="none"?this.brailleMode:"png",this.size=e!=="none"?"vpmax8":"medium_square",this.updateGraphPreview()}template(){return l("div",{children:l(go,{title:()=>this.controller.s("account-shell-heading-export-image"),size:this.const("wide"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller,children:l("div",{id:Eo.const("export-image-dialog"),children:x("div",{class:Eo.const("dcg-columns"),children:[l("div",{class:Eo.const("dcg-left-column"),children:x("div",{class:()=>({"dcg-graph-preview":!0,"dcg-preview-loading":this.imgDirty}),children:[l($h,{predicate:()=>this.loaded,children:()=>l("img",{class:Eo.const("dcg-graph-image"),didMount:this.bindFn(this.didMountGraphPreview),src:()=>this.previewDataURL,alt:()=>this.controller.s("account-shell-narration-graph-preview")})}),l($h,{predicate:()=>this.imgDirty,children:()=>x("span",{class:Eo.const("dcg-loading-message"),children:[l("span",{class:Eo.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-loading")]})}),l($h,{predicate:()=>!this.imgDirty&&!this.isExportingBraille(),children:()=>l("span",{class:Eo.const("dcg-zoom-percentage"),children:this.bindFn(this.getZoom)})})]})}),x("div",{class:Eo.const("dcg-right-column"),children:[x("div",{class:Eo.const("dcg-option-container"),children:[l("label",{class:Eo.const("dcg-section-title"),for:Eo.const("export-graph-type"),children:()=>this.controller.s("account-shell-heading-file-format")}),l(Ld,{controller:this.bindFn(this.props.controller),options:this.bindFn(this.getExportOptions),onChange:e=>this.setExportType(e),id:this.const("export-graph-type"),defaultValue:()=>this.exportType,focusOnMount:this.const(!0)})]}),x("div",{class:Eo.const("dcg-option-container"),children:[l("label",{class:Eo.const("dcg-section-title"),for:Eo.const("export-graph-size"),children:()=>this.controller.s("account-shell-heading-export-size")}),l(Ld,{controller:this.bindFn(this.props.controller),options:this.bindFn(this.getSizeOptions),id:this.const("export-graph-size"),externalControl:()=>({getValue:()=>this.size,onValueChange:e=>this.selectSize(e)})})]}),l($h,{predicate:()=>!this.isExportingBraille(),children:()=>x("div",{children:[l("h2",{class:Eo.const("dcg-section-title"),children:()=>this.controller.s("account-shell-heading-line-thickness")}),l(ar,{staticConfig:this.bindFn(this.getLineThicknessOptions),ariaGroupLabel:()=>this.controller.s("account-shell-heading-line-thickness")})]})}),l($h,{predicate:()=>this.isExportingBraille(),children:()=>x("div",{class:Eo.const("braille-container"),children:[l("h2",{class:Eo.const("dcg-section-title"),children:()=>this.controller.s("account-shell-heading-embossing-instructions")}),l($h,{predicate:()=>this.size==="vpmax8"||this.size==="vpmax11",children:()=>x("ul",{children:[l("li",{children:()=>this.controller.s("account-shell-text-embossing-vpmax-save")}),l("li",{children:()=>this.controller.s("account-shell-text-embossing-vpmax-print",{size:mae(this.size)})})]})}),l($h,{predicate:()=>this.size==="etc8"||this.size==="etc11",children:()=>x("ul",{children:[l("li",{children:()=>this.controller.s("account-shell-text-embossing-etc-save")}),l("li",{children:()=>this.controller.s("account-shell-text-embossing-etc-print",{size:mae(this.size)})})]})}),l("div",{children:x(Ot,{i18n:this.const(this.controller),children:["Feedback? Email"," ",l("a",{class:Eo.const("dcg-blue-link"),href:Eo.const("mailto:accessibility@desmos.com"),children:"accessibility@desmos.com"}),"."]},this.const("graphing-calculator-text-export-braille-email-accessibility"))})]})}),KCe(()=>this.showDownloadButton,{true:()=>x("div",{class:Eo.const("dcg-export-button-actions"),children:[l($h,{predicate:()=>this.isExportingBraille()&&!jn,children:()=>l(tf,{buttonType:this.const("secondary"),data:()=>this.brailleBlob,enabled:()=>!this.imgDirty,filename:this.const("desmos-equations.brl"),text:()=>this.controller.s("account-shell-button-download-braille"),triggerLogEvent:()=>Sr({category:"share",action:"download-equations",name:`${this.exportType} - ${this.size}`})})}),l("div",{class:Eo.const("dcg-download-button-group"),children:l(tf,{buttonType:this.const("primary"),data:()=>this.imageBlob,enabled:()=>!this.imgDirty,filename:()=>`desmos-graph.${this.exportType==="svg"?"svg":"png"}`,text:()=>this.controller.s(this.exportType==="svg"?"account-shell-button-download-svg":"account-shell-button-download-png"),triggerLogEvent:()=>Sr({category:"share",action:"download-image",name:`${this.exportType} - ${this.size}`})})})]}),false:()=>l($h,{predicate:()=>!this.isExportingBraille(),children:()=>x("div",{class:Eo.const("dcg-download-not-enabled-notice"),children:[l("h2",{class:Eo.const("dcg-title"),children:()=>this.controller.s("account-shell-heading-download-instructions")}),()=>this.controller.s("account-shell-text-download-instructions")]})})})]})]})})})})}getSizeOptions(){return this.isExportingBraille()?[{id:"vpmax8",label:this.controller.s("graphing-calculator-label-braille-size-vpmax8")},{id:"vpmax11",label:this.controller.s("graphing-calculator-label-braille-size-vpmax11")},{id:"etc8",label:this.controller.s("graphing-calculator-label-braille-size-etc8")},{id:"etc11",label:this.controller.s("graphing-calculator-label-braille-size-etc11")}]:[{id:"small_square",label:this.controller.s("account-shell-label-export-size-small-square")},{id:"medium_square",label:this.controller.s("account-shell-label-export-size-medium-square")},{id:"large_square",label:this.controller.s("account-shell-label-export-size-large-square")},{id:"medium_rectangle",label:this.controller.s("account-shell-label-export-size-medium-rectangle")},{id:"large_rectangle",label:this.controller.s("account-shell-label-export-size-large-rectangle")}]}getExportOptions(){return[{id:"png",label:this.controller.s("graphing-calculator-label-png")},{id:"svg",label:this.controller.s("graphing-calculator-label-svg")},{id:"nemeth",label:this.controller.s("graphing-calculator-label-braille-nemeth")},{id:"ueb",label:this.controller.s("graphing-calculator-label-braille-ueb")}]}getLineThicknessOptions(){return[{key:"thin",label:()=>this.controller.s("account-shell-button-line-thin"),selected:()=>this.thickness==="thin",onSelect:()=>this.selectThickness("thin")},{key:"medium",label:()=>this.controller.s("account-shell-button-line-medium"),selected:()=>this.thickness==="medium",onSelect:()=>this.selectThickness("medium")},{key:"thick",label:()=>this.controller.s("account-shell-button-line-thick"),selected:()=>this.thickness==="thick",onSelect:()=>this.selectThickness("thick")}]}markImagesDirty(){this.imgDirty=!0}selectSize(e){this.size=e,this.markImagesDirty(),this.updateIfMounted()}setExportType(e){R2(e)!==R2(this.exportType)&&(this.size=R2(e)?"vpmax8":"medium_square"),this.exportType=e,this.markImagesDirty(),this.updateIfMounted()}getZoom(){return this.controller.s("account-shell-label-zoom",{value:Math.min(100,Math.round(100*400/this.getWidth()))})}selectThickness(e){this.thickness=e,this.markImagesDirty(),this.updateIfMounted()}didMountGraphPreview(e){this.previewImg=e}getGridOpacity(){switch(this.thickness){case"thick":return 1;case"medium":return .6;case"thin":return .4;default:return this.thickness}}getAxisWeight(){switch(this.thickness){case"thick":return 2;case"medium":return 2;case"thin":return 1.5;default:return this.thickness}}getGraphThickness(){switch(this.thickness){case"thick":return 5;case"medium":return 3.5;case"thin":return 2.5;default:return this.thickness}}getLabelSize(){if(this.size==="small_square")switch(this.thickness){case"thick":return 14;case"medium":return 12;case"thin":return 10;default:return this.thickness}else switch(this.thickness){case"thick":return 20;case"medium":return 17;case"thin":return 14;default:return this.thickness}}getHeight(){return Jh[this.size].height}getWidth(){return Jh[this.size].width}updateIfMounted(){this._isMounted&&this.update()}getAsyncScreenshotOptions(){let e={axisLineWidth:this.getAxisWeight(),graphLineWidth:this.getGraphThickness(),majorAxisOpacity:this.getGridOpacity(),minorAxisOpacity:this.getGridOpacity()/2,pointLineWidth:this.getGraphThickness()*3,axisLineOffset:0,labelSize:this.getLabelSize()},t=this.controller.api._calc.grapher.getCurrentViewport(),i=this.controller.api._calc.grapher.settings.squareAxes?"preserveX":"stretch",n={left:t.xmin,right:t.xmax,top:t.ymax,bottom:t.ymin};switch(this.exportType){case"png":case"svg":return{width:this.getWidth(),height:this.getHeight(),mode:i,preserveAxisNumbers:!0,showLabels:!0,targetPixelRatio:2,format:this.exportType,settings:e,mathBounds:n};case"nemeth":case"ueb":return{braille:{embosserModel:this.size,brailleMode:this.exportType},mode:i,format:"png",mathBounds:n};default:let a=this.exportType;throw new Error(`Unexpected export type ${a}`)}}updateGraphPreview(){if(!this.imgDirty)return;let{exportType:e}=this;this.controller.api.asyncScreenshot(this.getAsyncScreenshotOptions(),t=>{this._isMounted&&typeof t=="string"&&this.exportType===e&&(e==="svg"?(this.imageBlob=gae(t),this.previewDataURL=`data:image/svg+xml,${encodeURIComponent(t)}`):(this.previewDataURL=t,this.imageBlob=hae(this.previewDataURL)),this.imgDirty=!1,this.loaded=!0,this.update(),this.resizePreviewImg())})}updateBrailleEquations(){if(this.isExportingBraille()){let e=wie(this.controller.api.controller,this.brailleMode);this.brailleBlob=new Blob([e],{type:"text/plain"})}}resizePreviewImg(){if(!this.previewImg)return;let e=1;(this.size==="etc8"||this.size==="etc11")&&(e=2),(this.size==="vpmax8"||this.size==="vpmax11")&&(e=1.5);let t=Math.min(this.getWidth(),400),i=this.getHeight()/this.getWidth()*t;this.previewImg.width=t*e,this.previewImg.height=i*e}willUpdate(){this.updateGraphPreview(),this.updateBrailleEquations()}isExportingBraille(){return R2(this.exportType)}};function R2(r){return r==="nemeth"||r==="ueb"}function mae(r){switch(r){case"etc8":return"8.5 x 11.0";case"etc11":return"11.5 x 11.0";case"vpmax8":return"8.5 x 11";case"vpmax11":return"11.5 x 11";default:return r}}var wo=__dcg_shared_module_exports__['e'](j());var fae={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-braille",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-nemeth-mode",standard:"<key>ALT</key> + <key>N</key>",apple:"<key>CTRL</key> + <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-ueb-mode",standard:"<key>ALT</key> + <key>U</key>",apple:"<key>CTRL</key> + <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-print-mode",standard:"<key>ALT</key> + <key>Q</key>",apple:"<key>CTRL</key> + <key>Q</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-braille-typing",standard:"<key>ALT</key> + <key>6</key>",apple:"<key>CTRL</key> + <key>6</key>"}]};var F2=function(r){let e={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-expression",standard:"<key>UP ARROW</key>, <key>SHIFT</key> + <key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-expression",standard:"<key>DOWN ARROW</key>, <key>Tab</key>"}]};return r.pageUpAndDown&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-previous-item",standard:"<key>PAGE UP</key>",apple:"<key>Fn</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-item",standard:"<key>PAGE DOWN</key>",apple:"<key>Fn</key> + <key>DOWN ARROW</key>"}),e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-remove-empty-expression",standard:"<key>Backspace</key>",apple:"<key>Delete</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-character",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-character",standard:"<key>RIGHT ARROW</key>"}),r.fractionNavigation&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-numerator",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-denominator",standard:"<key>DOWN ARROW</key>"}),e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-exit-block",standard:"<key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-beginning-of-block",standard:"<key>Home</key>",apple:"<key>Fn</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-end-of-block",standard:"<key>End</key>",apple:"<key>Fn</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-beginning-of-expression",standard:"<key>CTRL</key> + <key>Home</key>",apple:"<key>CTRL</key> + <key>Fn</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-end-of-expression",standard:"<key>CTRL</key> + <key>End</key>",apple:"<key>CTRL</key> + <key>Fn</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-selection-left",standard:"<key>SHIFT</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-selection-right",standard:"<key>SHIFT</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-delete-selection",standard:"<key>Backspace</key>",apple:"<key>Delete</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-select-all",standard:"<key>CTRL</key> + <key>A</key>",apple:"<key>COMMAND</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-parent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>UP ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-focused-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-left-adjacent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>LEFT ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-right-adjacent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>RIGHT ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-selection",standard:"<key>CTRL</key> + <key>ALT</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-answer",standard:"<key>CTRL</key> + <key>ALT</key> + <key>=</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>SHIFT</key> + <key>RIGHT ARROW</key>"}),r.decimalToFraction&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-show-answer-as-decimal-or-fraction",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>A</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>A</key>"}),e};function WB(r){return{common:jB(r),tables:XB(r),sliders:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-sliders",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-decrease",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-decrease-larger",standard:"<key>PAGE DOWN</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-increase",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-increase-larger",standard:"<key>PAGE UP</key>",apple:"<key>FN</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-minimum",standard:"<key>HOME</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-maximum",standard:"<key>END</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key>"}]},audiotrace:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-audio-tracing",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-audio-trace",standard:"<key>ALT</key> + <key>T</key>",apple:"<key>OPTION</key> + <key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-summarize-graph",standard:"<key>ALT</key> + <key>S</key>",apple:"<key>OPTION</key> + <key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-describe-axes",standard:"<key>ALT</key> + <key>G</key>",apple:"<key>OPTION</key> + <key>G</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-point",standard:"<key>LEFT ARROW</key>, <key>UP ARROW</key>, <key>J</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-point",standard:"<key>RIGHT ARROW</key>, <key>DOWN ARROW</key>, <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-poi",standard:"<key>PAGE UP</key>, <key>SHIFT</key> + <key>TAB</key>, <key>K</key>",apple:"<key>FN</key> + <key>UP ARROW</key>, <key>SHIFT</key> + <key>TAB</key>, <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-poi",standard:"<key>PAGE DOWN</key>, <key>TAB</key>, <key>I</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>, <key>TAB</key>, <key>I</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-first-point",standard:"<key>HOME</key>, <key>U</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key>, <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-last-point",standard:"<key>END</key> <key>N</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key> <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-poi-count",standard:"<key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-x",standard:"<key>X</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-y",standard:"<key>Y</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-color",standard:"<key>C</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-branch",standard:"<key>B</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-point-type",standard:"<key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-origin",standard:"<key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-curve",standard:"<key>ALT</key> + <key>UP ARROW</key>",apple:"<key>OPTION</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-curve",standard:"<key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>OPTION</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-hear-graph",standard:"<key>H</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-hear-specific-branch",standard:"<key>1</key> - <key>0</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-adjust-playback-speed",standard:"<key>ALT</key> + <key>1</key> - <key>5</key>",apple:"<key>OPTION</key> + <key>1</key> - <key>5</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-volume",standard:"<key>V</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-volume",standard:"<key>SHIFT</key> + <key>V</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-announce-slider-animations",standard:"<key>A</key>"}]},slidertrace:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-slider-trace",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-slider-trace",standard:"<key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-decrease",standard:"<key>LEFT ARROW</key> <key>J</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-decrease-larger",standard:"<key>PAGE DOWN</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-increase",standard:"<key>RIGHT ARROW</key> <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-increase-larger",standard:"<key>PAGE UP</key>",apple:"<key>FN</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-minimum",standard:"<key>HOME</key> <key>U</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key> <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-maximum",standard:"<key>END</key> <key>N</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key> <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-next-slider",standard:"<key>DOWN ARROW</key>, <key>TAB</key>, <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-previous-slider",standard:"<key>UP ARROW</key>, <key>SHIFT</key> + <key>TAB</key>, <key>I</key>"}]},interactivepoints:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-interactive-points",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-first-interactive-point",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-interactive-point",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-interactive-point",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-x",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-x",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-y",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-y",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-x-larger",standard:"<key>SHIFT</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-x-larger",standard:"<key>SHIFT</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-y-larger",standard:"<key>SHIFT</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-y-larger",standard:"<key>SHIFT</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-x",standard:"<key>X</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-y",standard:"<key>Y</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-label",standard:"<key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-color",standard:"<key>C</key>"}]},commonactions:vT({folders:!0,notes:!0,images:!0,authorFeatures:!1}),desmoscomonly:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-desmos-com-only",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-open-shortcuts-dialog",standard:"<key>CTRL</key> + <key>/</key>",apple:"<key>COMMAND</key> + <key>/</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-open-a-graph",standard:"<key>CTRL</key> + <key>O</key>",apple:"<key>COMMAND</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-save-a-graph",standard:"<key>CTRL</key> + <key>S</key>",apple:"<key>COMMAND</key> + <key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-print-a-graph",standard:"<key>CTRL</key> + <key>P</key>",apple:"<key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-account-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>A</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-help-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>H</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>H</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-language-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>L</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-share-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>S</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>S</key>"}]},braille:fae,mathquill:F2({decimalToFraction:!0,fractionNavigation:!0,pageUpAndDown:!0})}}function jB(r){let e={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-common-symbols",shortcuts:[{latex:"a^b",standard:"<key>^</key> (<key>SHIFT</key> + <key>6</key>)"},{latex:"a_b",standard:"<key>_</key> (<key>SHIFT</key> + <key>-</key>)"},{latex:"\\le",standard:"<key><</key><key>=</key>"},{latex:"\\ge",standard:"<key>></key><key>=</key>"},{latex:"a'",standard:"<key>'</key>"},{latex:"\\frac{a}{b}",standard:"<key>f</key><key>r</key><key>a</key><key>c</key>"},{latex:"\\sqrt{a}",standard:"<key>s</key><key>q</key><key>r</key><key>t</key>"},{latex:"\\sqrt[3]{a}",standard:"<key>c</key><key>b</key><key>r</key><key>t</key>"},{latex:"\\sqrt[n]{a}",standard:"<key>n</key><key>t</key><key>h</key><key>r</key><key>o</key><key>o</key><key>t</key>"},{latex:"\\sum_{n=a}^b",standard:"<key>s</key><key>u</key><key>m</key>"}]};return e.shortcuts.push({latex:"\\int_a^b",standard:r.isGeometry?"<key>i</key><key>n</key><key>t</key><key>e</key><key>g</key><key>r</key><key>a</key><key>l</key>":"<key>i</key><key>n</key><key>t</key>"}),e.shortcuts=e.shortcuts.concat([{latex:"\\prod_{n=a}^b",standard:"<key>p</key><key>r</key><key>o</key><key>d</key>"},{latex:"\\pi",standard:"<key>p</key><key>i</key>"},{latex:"\\theta",standard:"<key>t</key><key>h</key><key>e</key><key>t</key><key>a</key>"},{latex:"\\to",standard:"<key>-</key><key>></key>"}]),e}function vT(r){let e={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-common-actions",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-close-a-dialog",standard:"<key>ESC</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-show-or-hide-expression-list",standard:"<key>SHIFT</key> + <key>ALT</key> + <key>E</key>",apple:"<key>SHIFT</key> + <key>COMMAND</key> + <key>E</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-expression-list",standard:"<key>CTRL</key> + <key>ALT</key> + <key>E</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>E</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-open-expression-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-show-or-hide-expression",standard:"<key>SHIFT</key> + <key>ALT</key> + <key>H</key>",apple:"<key>SHIFT</key> + <key>COMMAND</key> + <key>H</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-delete-expression",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-degrees-toggle",standard:"<key>ALT</key> + <key>D</key>",apple:"<key>CTRL</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-keypad-toggle",standard:"<key>ALT</key> + <key>K</key>",apple:"<key>CTRL</key> + <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-mute-toggle",standard:"<key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-add-expression",standard:"<key>CTRL</key> + <key>ALT</key> + <key>X</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>X</key>"}]};return r.notes&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-add-note",standard:"<key>CTRL</key> + <key>ALT</key> + <key>O</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>O</key>"}),r.folders&&(e.shortcuts=e.shortcuts.concat([{i18nKey:"shared-calculator-text-keyboard-shortcut-add-folder",standard:"<key>CTRL</key> + <key>ALT</key> + <key>F</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>F</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-collapse-folder",standard:"<key>ALT</key> + <key>UP ARROW</key>",apple:"<key>COMMAND</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-expand-folder",standard:"<key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>COMMAND</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-collapse-all-folders",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>UP ARROW</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-expand-all-folders",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>"}])),r.images&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-add-image",standard:"<key>CTRL</key> + <key>ALT</key> + <key>I</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>I</key>"}),e.shortcuts=e.shortcuts.concat([{i18nKey:"shared-calculator-text-keyboard-shortcut-add-table",standard:"<key>CTRL</key> + <key>ALT</key> + <key>T</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-undo",standard:"<key>CTRL</key> + <key>Z</key>",apple:"<key>COMMAND</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-redo",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>Z</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-in",standard:"<key>ALT</key> + <key>+</key>",apple:"<key>CTRL</key> + <key>+</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-out",standard:"<key>ALT</key> + <key>-</key>",apple:"<key>CTRL</key> + <key>-</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-restore-default",standard:"<key>ALT</key> + <key>0</key>",apple:"<key>CTRL</key> + <key>0</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-fit",standard:"<key>SHIFT</key> + <key>ALT</key> + <key>Z</key>",apple:"<key>SHIFT</key> + <key>OPTION</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-pan-graph",i18nStandard:"shared-calculator-text-keyboard-shortcut-rotate-3d-cube-command"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-edit-list-mode",standard:"<key>CTRL</key> + <key>ALT</key> + <key>D</key>",apple:"<key>CTRL</key> + <key>OPTION</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-graph-settings-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>G</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>G</key>"}]),r.authorFeatures&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-author-mode",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>O</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>O</key>"}),e}function XB(r){let e={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-tables",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-cell",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-cell",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-row",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-row",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-column",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-column",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-first-row",standard:"<key>CTRL</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-last-row",standard:"<key>CTRL</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-first-column",standard:"<key>CTRL</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-last-column",standard:"<key>CTRL</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-speak-column-header",standard:"<key>CTRL</key> + <key>H</key>"}]};return r.tableRegressions&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-add-table-regression",standard:"<key>CTRL</key> + <key>ALT</key> + <key>R</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>R</key>"}),e}var Zh=WB({isGeometry:!1,tableRegressions:!0});var{audiotrace:DPt,slidertrace:APt,interactivepoints:LPt,...zCe}=JSON.parse(JSON.stringify(Zh));zCe.commonactions=$B({folders:!0,notes:!0,images:!0,authorFeatures:!1});function $B(r){let e=vT(r);e.shortcuts.unshift({i18nKey:"shared-calculator-text-keyboard-shortcut-focus-graph-paper",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-rotate-3d-cube",i18nStandard:"shared-calculator-text-keyboard-shortcut-rotate-3d-cube-command"},{i18nKey:"shared-calculator-text-keyboard-shortcut-spin-3d-cube",i18nStandard:"shared-calculator-text-keyboard-shortcut-spin-3d-cube-command"},{i18nKey:"shared-calculator-text-keyboard-shortcut-switch-pane-in-3d-quest",standard:"<key>F6</key>"});for(let t=e.shortcuts.length-1;t>=0;t--)e.shortcuts[t].i18nKey==="shared-calculator-text-keyboard-shortcut-pan-graph"&&e.shortcuts.splice(t,1);return e}var wT={toolSelection:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-tool-selection",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-focus-toolbar",standard:"<key>CTRL</key> + <key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-categories",standard:"<key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-dropdown-items",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-choose-toolbar-item-and-focus-graph",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-cancel-active-tool",standard:"<key>ESC</key>"}]},graphNavigation:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-graph-navigation-during-construction",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-graph-paper",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-graph",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-top-of-graph",standard:"<key>CTRL</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-bottom-of-graph",standard:"<key>CTRL</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-left-of-graph",standard:"<key>CTRL</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-right-of-graph",standard:"<key>CTRL</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-next-object",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-previous-object",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-describe-object",standard:"<key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-repeat-active-tool-prompt",standard:"<key>?</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-tool-by-number",standard:"<key>1</key>, <key>2</key>, <key>3</key>, ..., <key>6</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-next-category",standard:"<key>=</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-previous-category",standard:"<key>-</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-next-tool-within-category",standard:"<key>]</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-previous-tool-within-category",standard:"<key>[</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-add-object-to-selection",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-drag-movable-objects",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-delete-selected-objects",standard:"<key>DELETE</key>, <key>BACKSPACE</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-focus-selected-objects-toolbar",standard:"<key>CTRL</key> + <key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-transformation-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-deselect-all-objects",standard:"<key>ESC</key>"}]},expressionEdit:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-expression-edit",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-graph-paper",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-graph",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-top-of-graph",standard:"<key>CTRL</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-expression-edit-next-object",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-expression-edit-previous-object",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-expression-edit-add-object",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-expression-edit-complete",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"}]},tokenNavigator:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-token-navigator",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-token-navigator",standard:"<key>CTRL</key> + <key>ALT</key> + <key>C</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>C</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-close-token-navigator",standard:"<key>ESC</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-tokens-at-current-level",standard:"<key>LEFT ARROW</key>, <key>RIGHT ARROW</key"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-object-levels",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-token-between-expression-list-and-navigator",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>T</key>",apple:"<key>OPTION</key> + <key>SHIFT</key> + <key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-single-object-token",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-add-object-token-to-selection",standard:"<key>SHIFT</key> + <key>ENTER</key>",apple:"<key>SHIFT</key> + <key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-delete-selected-objects",standard:"<key>DELETE</key>, <key>BACKSPACE</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-focus-selected-objects-toolbar",standard:"<key>CTRL</key> + <key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>O</key>"}]},...WB({isGeometry:!0,tableRegressions:!0})};var kS=__dcg_shared_module_exports__['e'](j());var{For:JB,If:qCe}=kS.Components,ca=class extends kS.View{template(){return x("table",{class:kS.const("dcg-shortcuts-table"),children:[l("tr",{children:l(JB,{each:this.bindFn(this.getCols),children:e=>l("th",{children:()=>this.getHeader(e)})})}),l("tbody",{children:l(JB,{each:()=>__dcg_shared_module_exports__['$a'](this.props.section().shortcuts),children:e=>l("tr",{children:l(JB,{each:this.bindFn(this.getCols),children:t=>l("td",{didMount:o=>this.populateContent(o,e,t),children:l(qCe,{predicate:()=>!!this.getLatex(e),children:()=>l(dt,{latex:()=>this.getLatex(e),config:this.const({})})})})})})})})]})}getLatex(e){return this.props.section().shortcuts[e].latex||""}populateContent(e,t,o){let i=this.props.section().shortcuts[t];switch(o){case"heading":if(i.latex)return;i.i18nKey&&(e.innerHTML=this.props.controller().s(i.i18nKey));return;case"windows":i.i18nStandard?e.innerHTML=this.replaceKey(this.props.controller().s(i.i18nStandard)):e.innerHTML=this.replaceKey(i.standard||"");return;case"mac":i.i18nApple?e.innerHTML=this.replaceKey(this.props.controller().s(i.i18nApple)):i.i18nStandard?e.innerHTML=this.replaceKey(this.props.controller().s(i.i18nStandard)):e.innerHTML=this.replaceKey(i.apple||i.standard||"");return}}getHeader(e){let t=this.props.controller().s;switch(e){case"heading":return t("shared-calculator-heading-function-table-column-header");case"windows":return t("shared-calculator-heading-windows-chrome-table-column-header");case"mac":return t("shared-calculator-heading-mac-table-column-header")}}getCols(){return this.props.os?this.props.os()==="windows"?["heading","windows"]:["heading","mac"]:["heading","windows","mac"]}replaceKey(e){return e.replace(/\<key\>/g,"<span class='dcg-key-command'>").replace(/\<\/key\>/g,"</span>")}};var{If:ls}=wo.Components,N2=class extends wo.View{init(){this.controller=this.props.controller(),this.controller.state.hotkeysDialog==null&&(this.controller.state.hotkeysDialog={shortcutOS:qr?"mac":"windows"})}showGeoShortcuts(){return this.controller.product==="geometry-calculator"}show3dShortcuts(){return this.controller.product==="graphing-3d"}areTableRegressionsEnabled(){return this.controller.getApiConfig().tableRegressions}template(){return l(go,{size:this.const("fullscreen"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.const(this.controller),class:this.const("dcg-hotkeys-modal"),setFocus:this.const("close"),children:l("div",{class:wo.const("modal_section dcg-hotkeys-dialog"),children:x("div",{id:wo.const("dcg-hotkeys-dialog"),children:[x("div",{class:wo.const("dcg-hotkeys-header"),children:[l("h1",{class:wo.const("dcg-hotkeys-title"),children:()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts")}),l("div",{class:wo.const("dcg-hotkeys-toggle-container"),children:l(ar,{staticConfig:this.bindFn(this.getOSOptions),ariaGroupLabel:()=>this.controller.s("shared-calculator-label-os")})})]}),x("div",{class:wo.const("dcg-hotkey-container"),children:[x("div",{class:wo.const("dcg-hotkey-section"),children:[l(ls,{predicate:this.bindFn(this.showGeoShortcuts),children:()=>l("h2",{class:wo.const("dcg-hotkey-section-header"),children:()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-geometry-tool-selection")})}),l(ls,{predicate:this.bindFn(this.showGeoShortcuts),children:()=>l(ca,{controller:this.props.controller,section:this.const(wT.toolSelection),os:this.bindFn(this.getShortcutOS)})}),l(ls,{predicate:this.bindFn(this.showGeoShortcuts),children:()=>l("h2",{class:wo.const("dcg-hotkey-section-header"),children:()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-geometry-expression-edit")})}),l(ls,{predicate:this.bindFn(this.showGeoShortcuts),children:()=>l(ca,{controller:this.props.controller,section:this.const(wT.expressionEdit),os:this.bindFn(this.getShortcutOS)})}),l(ls,{predicate:this.bindFn(this.showGeoShortcuts),children:()=>l("h2",{class:wo.const("dcg-hotkey-section-header"),children:()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-geometry-token-navigator")})}),l(ls,{predicate:this.bindFn(this.showGeoShortcuts),children:()=>l(ca,{controller:this.props.controller,section:this.const(wT.tokenNavigator),os:this.bindFn(this.getShortcutOS)})}),l("h2",{class:wo.const("dcg-hotkey-section-header"),children:()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-common-actions")}),l(ls,{predicate:this.bindFn(this.show3dShortcuts),children:()=>l(ca,{controller:this.props.controller,section:()=>$B({folders:!0,notes:!0,images:!0,authorFeatures:this.controller.getApiConfig().authorFeatures}),os:this.bindFn(this.getShortcutOS)})}),l(ls,{predicate:()=>!this.show3dShortcuts(),children:()=>l(ca,{controller:this.props.controller,section:()=>vT({folders:!0,notes:!0,images:!0,authorFeatures:this.controller.getApiConfig().authorFeatures}),os:this.bindFn(this.getShortcutOS)})}),l("h2",{class:wo.const("dcg-hotkey-section-header"),children:()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-desmos-com-only")}),l(ca,{controller:this.props.controller,section:this.const(Zh.desmoscomonly),os:this.bindFn(this.getShortcutOS)}),l("h2",{class:wo.const("dcg-hotkey-section-header"),children:()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation")}),l(ca,{controller:this.props.controller,section:()=>F2({decimalToFraction:this.controller.isDecimalToFractionEnabled(),fractionNavigation:!0,pageUpAndDown:!0}),os:this.bindFn(this.getShortcutOS)}),l(ls,{predicate:()=>!this.show3dShortcuts(),children:()=>l("h2",{class:wo.const("dcg-hotkey-section-header"),children:()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-interactive-points")})}),l(ls,{predicate:()=>!this.show3dShortcuts(),children:()=>l(ca,{controller:this.props.controller,section:this.const(Zh.interactivepoints),os:this.bindFn(this.getShortcutOS)})})]}),x("div",{class:wo.const("dcg-hotkey-section"),children:[l(ls,{predicate:this.bindFn(this.showGeoShortcuts),children:()=>l("h2",{class:wo.const("dcg-hotkey-section-header"),children:()=>this.controller.s("shared-calculator-text-keyboard-shortcut-geometry-navigate-graph")})}),l(ls,{predicate:this.bindFn(this.showGeoShortcuts),children:()=>l(ca,{controller:this.props.controller,section:this.const(wT.graphNavigation),os:this.bindFn(this.getShortcutOS)})}),l(Ot,{i18n:this.const(this.controller),children:x("h2",{class:wo.const("dcg-hotkey-section-header"),children:["Common Symbols and"," ",l("a",{href:wo.const("https://help.desmos.com/hc/en-us/articles/212235786-Supported-Functions"),target:wo.const("_blank"),children:"Supported Functions"})]})},this.const("shared-calculator-heading-keyboard-shortcuts-symbols-and-supported-functions")),l(ca,{controller:this.props.controller,section:()=>jB({isGeometry:this.showGeoShortcuts(),tableRegressions:this.areTableRegressionsEnabled()}),os:this.bindFn(this.getShortcutOS)}),l(ls,{predicate:()=>!this.show3dShortcuts(),children:()=>l("h2",{class:wo.const("dcg-hotkey-section-header"),children:()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-audio-tracing")})}),l(ls,{predicate:()=>!this.show3dShortcuts(),children:()=>l(ca,{controller:this.props.controller,section:this.const(Zh.audiotrace),os:this.bindFn(this.getShortcutOS)})}),l(ls,{predicate:()=>!this.show3dShortcuts(),children:()=>l("h2",{class:wo.const("dcg-hotkey-section-header"),children:()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-slider-trace")})}),l(ls,{predicate:()=>!this.show3dShortcuts(),children:()=>l(ca,{controller:this.props.controller,section:this.const(Zh.slidertrace),os:this.bindFn(this.getShortcutOS)})}),l("h2",{class:wo.const("dcg-hotkey-section-header tables-section"),children:()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-sliders")}),l(ca,{controller:this.props.controller,section:this.const(Zh.sliders),os:this.bindFn(this.getShortcutOS)}),l("h2",{class:wo.const("dcg-hotkey-section-header tables-section"),children:()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-tables")}),l(ca,{controller:this.props.controller,section:()=>XB({isGeometry:this.showGeoShortcuts(),tableRegressions:this.areTableRegressionsEnabled()}),os:this.bindFn(this.getShortcutOS)}),l("h2",{class:wo.const("dcg-hotkey-section-header"),children:()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-braille")}),l(ca,{controller:this.props.controller,section:this.const(Zh.braille),os:this.bindFn(this.getShortcutOS)})]})]})]})})})}getOSOptions(){return[{key:"windows",label:()=>this.controller.s("shared-calculator-button-windows-chrome"),selected:()=>this.getShortcutOS()==="windows",onSelect:()=>this.setShortcutOS("windows")},{key:"mac",label:()=>this.controller.s("shared-calculator-button-mac"),selected:()=>this.getShortcutOS()==="mac",onSelect:()=>this.setShortcutOS("mac")}]}getShortcutOS(){return this.controller.state.hotkeysDialog.shortcutOS}setShortcutOS(e){this.controller.state.hotkeysDialog.shortcutOS=e,this._isMounted&&this.update()}didMount(){this.updateVisibleShortcuts()}didUpdate(){this.updateVisibleShortcuts()}updateVisibleShortcuts(){let e=this.getShortcutOS(),t=document.querySelector(".dcg-os-mac"),o=document.querySelector(".dcg-os-windows");!t||!o||(e==="mac"?(t.style.display="block",o.style.display="none"):e==="windows"&&(t.style.display="none",o.style.display="block"))}};var cs=__dcg_shared_module_exports__['e'](j());Ut();var ki=class r{constructor(e){this.product=e.product,this.title=e.title,this.thumbUrl=e.thumbUrl,this.stateUrl=e.stateUrl,this.hash=e.hash,this.parentHash=e.parentHash,this.recovery=!!e.recovery,this.recoveryParentHash=e.recoveryParentHash,(typeof e.graphData=="string"||typeof e.graphData=="object")&&(this.graphData=e.graphData),this.created=e.created||new Date,this.questHash=e.questHash,e.example?this.exampleData={example:!0,i18nKey:e.i18nKey,easterEgg:e.easterEgg}:this.exampleData={example:!1},this.now=new Date}ensureSaveable(){if(!this.thumbUrl||!this.graphData||!this.hash)throw new Error("Cannot save graph");let e=typeof this.graphData=="string"?this.graphData:JSON.stringify(this.graphData);return{thumbUrl:this.thumbUrl,graphData:e,hash:this.hash}}getVisibleTitle(e){let t=this.exampleData.example?this.exampleData.i18nKey:void 0;return t?e(t):this.title||r.getUntitledString(this.product,e)}copy(e={}){let t={product:this.product,title:this.title,thumbUrl:this.thumbUrl,stateUrl:this.stateUrl,hash:this.hash,parentHash:this.parentHash,recovery:this.recovery,recoveryParentHash:this.recoveryParentHash,graphData:this.graphData,questHash:this.questHash,created:this.created,...this.exampleData,...e};return new r(t)}setGraphData(e){this.graphData=e}getCollectionKey(){let e="";return this.exampleData.example?e="example-":this.recovery&&(e="draft-"),e+this.product+this.hash}isEasterEgg(){return this.exampleData.example&&this.exampleData.easterEgg!==void 0}isSpecificEasterEgg(e){return this.exampleData.example&&this.exampleData.easterEgg===e}isNonEasterEggExample(){return this.exampleData.example&&!this.exampleData.easterEgg}toGraphIdentifier(){if(this.hash===void 0)throw new Error("Graph does not have a hash");return{graphHash:this.hash,product:this.product}}displayDate(){let o=(Date.now()-this.created.getTime())/1e3/60,i=o/60,n=i/24,a=n/7,s=[__dcg_shared_module_exports__['z']("account-shell-label-month-jan"),__dcg_shared_module_exports__['z']("account-shell-label-month-feb"),__dcg_shared_module_exports__['z']("account-shell-label-month-mar"),__dcg_shared_module_exports__['z']("account-shell-label-month-apr"),__dcg_shared_module_exports__['z']("account-shell-label-month-may"),__dcg_shared_module_exports__['z']("account-shell-label-month-jun"),__dcg_shared_module_exports__['z']("account-shell-label-month-jul"),__dcg_shared_module_exports__['z']("account-shell-label-month-aug"),__dcg_shared_module_exports__['z']("account-shell-label-month-sep"),__dcg_shared_module_exports__['z']("account-shell-label-month-oct"),__dcg_shared_module_exports__['z']("account-shell-label-month-nov"),__dcg_shared_module_exports__['z']("account-shell-label-month-dec")];return a>=5?__dcg_shared_module_exports__['z']("account-shell-label-created-on-date",{month:s[this.created.getMonth()],day:this.created.getDate(),year:this.created.getFullYear()}):a>=2?__dcg_shared_module_exports__['z']("account-shell-label-created-weeks-ago",{number:String(Math.floor(a))}):n>=7?__dcg_shared_module_exports__['z']("account-shell-label-created-last-week"):n>=2?__dcg_shared_module_exports__['z']("account-shell-label-created-days-ago",{number:String(Math.floor(n))}):i>=24?__dcg_shared_module_exports__['z']("account-shell-label-created-yesterday"):i>=2?__dcg_shared_module_exports__['z']("account-shell-label-created-hours-ago",{number:String(Math.floor(i))}):o>=60?__dcg_shared_module_exports__['z']("account-shell-label-created-one-hour-ago"):o>=2?__dcg_shared_module_exports__['z']("account-shell-label-created-minutes-ago",{number:String(Math.floor(o))}):o>=1?__dcg_shared_module_exports__['z']("account-shell-label-created-one-minute-ago"):__dcg_shared_module_exports__['z']("account-shell-label-created-seconds-ago")}getFullTopLevelURL(){let e;if(window.location.protocol==="file:"){let t="/calculator";if(!Xu())return t;e=Xu()+t}else{let t="/"+document.location.pathname.split("/")[1];e=window.location.href.split(t)[0]+t}return e}getFullTopLevelURLInterchangeableProducts(){let e,t=["/geometry","/calculator","/3d"],o;switch(this.product){case"geometry-calculator":o="/geometry";break;case"graphing":o="/calculator";break;case"graphing-3d":o="/3d";break}if(window.location.protocol==="file:"){if(!Xu())return o;e=Xu()}else e=window.location.origin;return window.location.pathname.match(new RegExp(`^${t.join("|")}`))?e+o:e+window.location.pathname}getURL(){return this.getFullTopLevelURL()+(this.hash?"/"+this.hash:"")}getURLInterchangeableProducts(){return this.getFullTopLevelURLInterchangeableProducts()+(this.hash?"/"+this.hash:"")}static fromAjax(e,{isRecovery:t}={}){let o="example"in e?{example:!0,i18nKey:e.i18nKey,easterEgg:e.easterEgg}:{example:!1};return new r({product:e.product,title:e.title,thumbUrl:e.thumbUrl,stateUrl:e.stateUrl,graphData:e.state,hash:e.hash,parentHash:e.parent_hash,created:new Date(e.created),recovery:!!t,...o})}static toAjax(e){return{title:e.title,thumbUrl:e.thumbUrl,stateUrl:e.stateUrl,state:e.graphData,hash:e.hash,parent_hash:e.parentHash,recovery_parent_hash:e.recoveryParentHash,created:e.created.toString(),product:e.product}}static updateFromSync(e,t){t.title&&(e.title=t.title),e.hash=t.hash,t.parent_hash&&(e.parentHash=t.parent_hash),t.thumbUrl&&(e.thumbUrl=t.thumbUrl),t.stateUrl&&(e.stateUrl=t.stateUrl),e.created=new Date(t.created)}static getUntitledString(e,t){switch(e){case"graphing":case"graphing-3d":return t("account-shell-text-untitled-graph");case"geometry-calculator":return t("account-shell-text-untitled")}}};var{Input:HCe,If:WCe}=cs.Components,_S=class extends cs.View{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.lastSavedTitle=this.graphsController.getCurrentGraphTitle(),this.controller.getOpenModal()==="duplicate"?this.newSaveTitle=this.controller.s("account-shell-text-copy-of-title",{originalTitle:this.lastSavedTitle}):this.newSaveTitle=this.lastSavedTitle,this.controller.state.saveDialog==null&&(this.controller.state.saveDialog={copyOnSave:!0})}template(){return l(go,{size:this.const("tiny"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.const(this.controller),class:this.const("dcg-save-dialog"),children:x("div",{id:cs.const("save-dialog"),class:cs.const("dcg-save-dialog__contents"),children:[l("h1",{class:cs.const("dcg-save-dialog__heading"),children:()=>this.getTitle()}),l("div",{class:cs.const("dcg-clear")}),x("form",{didMount:this.bindFn(this.didMountForm),children:[x("div",{class:cs.const("dcg-save-dialog__input-section"),children:[l(HCe,{class:cs.const("dcg-save-dialog__title-input dcg-input-blue-outline"),name:cs.const("title"),placeholder:()=>ki.getUntitledString(this.controller.getProduct(),this.controller.s),value:()=>this.newSaveTitle,maxLength:cs.const("140"),onInput:e=>this.newSaveTitle=e,didMount:e=>re(e).trigger("focus").trigger("select"),ariaLabel:()=>this.controller.s("account-shell-label-graph-title")}),l("button",{type:cs.const("submit"),class:cs.const("dcg-btn dcg-btn-blue dcg-action-save"),children:()=>this.controller.s("account-shell-button-save")})]}),l(WCe,{predicate:()=>this.shouldShowDuplicateOption()&&this.graphsController.wasCurrentGraphEverSaved(),children:()=>l(ft,{checked:()=>this.controller.state.saveDialog.copyOnSave,onChange:e=>{if(this.controller.state.saveDialog.copyOnSave=e,this._isMounted)return this.update()},class:this.const("dcg-save-dialog__duplicate-checkbox"),children:l("span",{class:cs.const("duplicate-label"),children:()=>this.getDuplicateLabel()})})})]})]})})}didMountForm(e){re(e).on("submit",t=>{t.preventDefault(),this.newSaveTitle===""&&(this.newSaveTitle="Untitled Graph");let o;this.shouldShowDuplicateOption()?o=this.controller.state.saveDialog.copyOnSave:o=this.controller.getOpenModal()!=="rename",this.controller.dispatch({type:"save-graph",payload:{title:this.newSaveTitle,saveCopy:o}})})}getTitle(){switch(this.controller.getOpenModal()){case"rename":return this.graphsController.isGeometryTool()?this.controller.s("account-shell-heading-rename-construction"):this.controller.s("account-shell-heading-rename-graph");case"save":return this.graphsController.isGeometryTool()?this.controller.s("account-shell-heading-save-construction"):this.controller.s("account-shell-heading-save-graph");case"duplicate":return this.graphsController.isGeometryTool()?this.controller.s("account-shell-heading-duplicate-construction"):this.controller.s("account-shell-heading-duplicate-graph");default:return""}}getDuplicateLabel(){return this.graphsController.isGeometryTool()?this.controller.s("account-shell-heading-duplicate-construction"):this.controller.s("account-shell-heading-duplicate-graph")}shouldShowDuplicateOption(){let e=this.controller.getModalState();return!!(e.modal==="save"&&e.fromSaveInProgress)}};var tc=__dcg_shared_module_exports__['e'](j());var U2=class extends tc.View{init(){this.controller=this.props.controller()}template(){return l(go,{size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.const(this.controller),class:this.const("dcg-unsupported-browser-dialog"),children:l("div",{class:tc.const("modal_section"),children:x("div",{id:tc.const("unsupported-browser"),children:[l("div",{id:tc.const("unsupported-browser-title"),style:tc.const("color:black; font-size:150%;"),children:()=>this.controller.s("account-shell-heading-unsupported-browser")}),x("div",{style:tc.const("padding:20px 0px; color:#666"),children:[()=>this.controller.s("account-shell-text-unsupported-browser-android"),l("br",{}),l("br",{}),x("a",{href:tc.const("https://play.google.com/store/apps/details?id=com.android.chrome"),children:[()=>this.controller.s("account-shell-link-download-chrome"),l("br",{}),l("br",{})]}),l("div",{style:tc.const("text-align: center; margin-top: 25px; margin-bottom:-16px"),children:l("a",{role:tc.const("link"),tabIndex:tc.const("0"),class:tc.const("dcg-btn dcg-action-hide dcg-do-not-blur"),onTap:()=>this.controller.dispatch({type:"close-modal"}),children:()=>this.controller.s("account-shell-button-hide-browser-warning")})})]})]})})})}};var{SwitchUnion:jCe}=B2.Components,Y2=class extends B2.View{init(){this.controller=this.props.controller()}template(){return jCe(()=>this.controller.getModalState(),"modal",{save:()=>l(_S,{controller:this.props.controller}),rename:()=>l(_S,{controller:this.props.controller}),duplicate:()=>l(_S,{controller:this.props.controller}),"export-image":()=>l(xT,{controller:this.props.controller}),authentication:()=>l(D2,{controller:this.props.controller}),"recover-password":()=>l(t2,{controller:this.props.controller}),hotkeys:()=>l(N2,{controller:this.props.controller}),"unsupported-browser":()=>l(U2,{controller:this.props.controller}),"account-settings":e=>l(ZV,{controller:this.props.controller,extraTabs:this.bindFn(this.getAccountSettingsExtraTabs),initialTab:()=>e().initialTab}),"change-email":()=>l(QV,{controller:this.props.controller}),"account-reenabled":()=>l(zV,{controller:this.props.controller}),"contest-submission":e=>l(go,{title:()=>"",size:this.const("medium"),showX:this.const(!0),class:this.const("dcg-art-expo-submission-modal"),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller,children:l(O2,{shellController:this.props.controller,currentSubmission:()=>e().currentSubmission})}),"my-graphs":()=>l(C2,{controller:this.props.controller}),none:()=>l("div",{})})}getAccountSettingsExtraTabs(){return{tabs:[{key:"advanced",wideLabel:()=>this.props.controller().s("account-shell-label-advanced-preferences"),narrowLabel:()=>this.props.controller().s("account-shell-label-advanced-preferences"),class:"advanced"}],createView:e=>e?e=="advanced"?l(L2,{controller:this.props.controller}):e:l("span",{})}}};var QO=__dcg_shared_module_exports__['e'](j());Ut();function bae(r,e){if(!e.hasOwnProperty("myGraphs"))throw new Error("Argument Error: saveGraph options must specify myGraphs");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveGraph options must specify isUpdate");let{hash:t,thumbUrl:o,graphData:i}=r.ensureSaveable(),n={parent_hash:r.parentHash,thumb_data:o,hash:t,my_graphs:!!e.myGraphs,is_update:!!e.isUpdate,title:r.title,state:i};return Di("/api/v1/calculator_3d/save",n).then(a=>(ki.updateFromSync(r,a),r))}var yae=sv("/api/v1/calculator_3d/email_feedback"),xae=eb("/api/v1/calculator_3d/my_graphs");function vae(r){return Di("/api/v1/calculator_3d/my_graphs/remove",r)}async function Sae(r,e){let{hash:t,thumbUrl:o,graphData:i}=r.ensureSaveable(),n={parentHash:r.parentHash,recoveryParentHash:r.recoveryParentHash,thumbnailData:o,hash:t,type:e,title:r.title||void 0,state:i,product:r.product},a=await Di("/api/v1/calculator-shared/save",n);return ki.updateFromSync(r,a),r}async function kae(r,e){let{hash:t,thumbUrl:o,graphData:i}=r.ensureSaveable(),n={parent_hash:r.parentHash,recovery_parent_hash:r.recoveryParentHash,thumb_data:o,graph_hash:t,my_graphs:!1,is_update:!1,recovery:!0,title:r.title||void 0,calc_state:i,lang:e.lang,product:e.product},a=await Di("/api/v1/calculator/save",n);return ki.updateFromSync(r,a),r}function _ae(r,e){if(!e.hasOwnProperty("myGraphs"))throw new Error("Argument Error: saveGraph options must specify myGraphs");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveGraph options must specify isUpdate");let{hash:t,thumbUrl:o,graphData:i}=r.ensureSaveable(),n={parent_hash:r.parentHash,recovery_parent_hash:r.recoveryParentHash,thumb_data:o,graph_hash:t,my_graphs:e.myGraphs,is_update:e.isUpdate,recovery:!1,title:r.title||void 0,calc_state:i,lang:e.lang,product:e.product};return Di("/api/v1/calculator/save",n).then(a=>(ki.updateFromSync(r,a),r))}var Cae=sv("/api/v1/calculator/email_feedback"),Tae=eb("/api/v1/calculator/my_graphs"),Eae=eb("/api/v1/calculator-shared/my_graphs"),Iae=eb("/api/v1/calculator-shared/recovery_graphs"),Mae=eb("/api/v1/calculator/recovery_graphs"),Dae=_F("/api/v1/calculator-shared/recovery_graph"),Aae=sv("/api/v1/calculator/my_graphs/remove"),Lae=sv("/api/v1/calculator/recovery_graphs/clear"),Pae=_F("/api/v1/calculator-shared/my_graphs/batch");function XCe(r){var t;let e=(t=r==null?void 0:r.responseJSON)==null?void 0:t.errors;return Array.isArray(e)?e:void 0}function Qh(r,e,t){let o=XCe(r);return o===void 0?[t!=null?t:e("account-shell-error-unexpected-server",{email:"support@desmos.com"})]:o.map(({key:i,message:n})=>i==="connection_failed"?e("account-shell-error-connection-failed"):n)}var t6={};__dcg_shared_module_exports__['d'](t6,{init:()=>rTe,next:()=>eTe,nextSeed:()=>tTe});var ZB=class{constructor(e){this.bauArc4=new QB($Ce(e))}g(e){let t=Array(e);for(let o=0;o<e;o++)t[o]=this.bauArc4.g(1);return t}},ST=256;function hu(r){return r&ST-1}function $Ce(r){let e=r+"",t=[],o=0,i;for(i=0;i<e.length;i++)t[hu(i)]=hu((o^=t[hu(i)]*19)+e.charCodeAt(i));return t}var QB=class{constructor(e){this.S=[];this.c=[];this.i=0;this.j=0;this.m=0;let t,o,i=e.length,n=0,a=0;for(i||(e=[i++]);n<ST;)this.S[n]=n++;for(n=0;n<ST;n++)t=this.S[n],a=hu(a+t+e[n%i]),o=this.S[a],this.S[n]=o,this.S[a]=t;this.g(ST)}g(e){let t=this.S,o=hu(this.i+1),i=t[o],n=hu(this.j+i),a=t[n];t[o]=a,t[n]=i;let s=t[hu(i+a)];for(;--e;)o=hu(o+1),i=t[o],n=hu(n+i),a=t[n],t[o]=a,t[n]=i,s=s*ST+t[hu(i+a)];return this.i=o,this.j=n,s}},JCe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",ZCe=JCe.toLowerCase(),QCe=62,Vae=10,e6=class{constructor(e){if(!e||!e.length||e.length<32)throw new Error("You must supply a seed to RandomHashFactory. It should have at least 128 bits of entropy, but was "+e);this.arc4=new ZB(e)}next(){let e=Array(Vae),t=0,o;for(;t<Vae;)o=this.arc4.g(1)[0]>>2,o<QCe&&(e[t]=ZCe[o],t++);return e.join("")}nextSeed(){let t=this.arc4.g(16),o=Array(16);for(let i=0;i<16;i++)o[i]=t[i].toString(16),o[i].length===1&&(o[i]="0"+o[i]);return o.join("")}},kT;function eTe(){if(!kT)throw"Random Hash Factory not initialized";return kT.next()}function tTe(){if(!kT)throw"Random Hash Factory not initialized";return kT.nextSeed()}function rTe(r){kT=new e6(r)}var K2=class{constructor({examplesJSONs:e,randomSeed:t,parentParams:{s:o,getLanguage:i,getProduct:n,getApi:a,dispatch:s,showSavedGraphsRedesign:c}}){this.__eventBus=new Pi;this.myGraphsModalFailureMessage=void 0;this.showRecentSaveNotice=!1;this.shouldUpdateCurrentGraphDuringSave=!0;this.getProduct=n,this.getApi=a,this.showSavedGraphsRedesign=c,this.s=o,this.getLanguage=i,this.dispatch=s,this.previousGraph=void 0,this.recoveryParentHash=void 0,this.randomHash=t6,this._seedRandom(t),this.__savedGraphs={state:"loaded",data:[]},this.__recoveryGraphs={state:"loaded",data:[]},this.__exampleJSONs=e;let d=e[this.getProduct()].map(p=>ki.fromAjax(p));this.__exampleGraphsLegacy=__dcg_shared_module_exports__['Ha'](d,p=>p.isNonEasterEggExample()),this.__easterEggGraphsLegacy=__dcg_shared_module_exports__['Ha'](d,p=>p.isEasterEgg()),this.__graphInfoCache={},this.__exampleGraphsLegacy.forEach(p=>{this._addGraphToCache(p)}),this.__easterEggGraphsLegacy.forEach(p=>{this._addGraphToCache(p)}),this.lastSync=void 0,this.syncError=!1,this.currentGraph=new ki({product:this.getProduct()}),this._enableLoadingGraphStates(),this.pageLoadTime=Date.now()}observeEvent(e,t){return this.__eventBus.observeEvent(e,t)}updateState(e){switch(e.type){case"set-saved-graphs":this.setSavedGraphsState(e.fetchedGraphs);break;case"set-recovery-graphs":this.setRecoveryGraphsState(e.fetchedGraphs);break;case"fetch-recovery-graphs-legacy":this.fetchRecoveryGraphsLegacy();break;case"request-delete-graph":this.requestDeleteGraphLegacy(e.graph);break;case"cancel-delete-graph":this.cancelDeleteGraph(e.graph);break;case"set-graphs-delete-status":this.setGraphsDeleteStatus(e.graphs,e.status);break;case"restore-previous-graph":this.restorePreviousGraph(e.opts);break;case"delete-graphs-immediately":this.deleteGraphsImmediately(e.graphs);break;case"delete-recovery-graph-immediately":this.deleteRecoveryGraphImmediately(e.graph);break;case"open-blank-graph":this.openBlankGraph();break;case"clear-graph-without-undo":this.clearGraph();break;case"save-graph-complete":this.handleSaveComplete(e.status,e.isUpdate);break;case"dismiss-save-notice":this.showRecentSaveNotice=!1;break;case"share-graph-complete":this.lastShareStatus=e.status;break;default:}}dispatchUpdateGraphsStateAction(e){this.dispatch({type:"update-graphs-state",update:e})}_seedRandom(e){if(!e){alert(this.s("account-shell-error-something-went-wrong",{error_num:"77361"}));return}let t=new Date,o=""+e+t.getTime()+t.getMilliseconds();this.randomHash.init(o)}requestDeleteGraphLegacy(e){let t=this._getCachedGraphInfo(e);t.deleteTimeout=setTimeout(()=>{this.dispatchUpdateGraphsStateAction({type:"set-graphs-delete-status",graphs:[e],status:{state:"loading",cancelable:!1}}),this.removeGraphLegacy(e)},3e3),this.setGraphsDeleteStatus([e],{state:"loading",cancelable:!0})}setGraphsDeleteStatus(e,t){for(let o of e){let i=this._getCachedGraphInfo(o);if(i.deleteStatus=t,(t==null?void 0:t.state)==="loaded"&&o.hash){let n=o.hash;this._removeSavedGraphByHash(n),this._removeRecoveryGraphByHash(n)}}(t==null?void 0:t.state)==="error"&&(this.myGraphsModalFailureMessage=t.message)}_removeSavedGraphByHash(e){this.__savedGraphs.state==="loaded"&&(this.__savedGraphs.data=__dcg_shared_module_exports__['Ha'](this.__savedGraphs.data,t=>t.hash!==e),this.__eventBus.triggerEvent("listChanged",void 0))}_removeRecoveryGraphByHash(e){this.__recoveryGraphs.state==="loaded"&&(this.__recoveryGraphs.data=__dcg_shared_module_exports__['Ha'](this.__recoveryGraphs.data,t=>t.hash!==e))}getRemovePromise(e,t){return t==="graphing-3d"?vae({hash:e}):Aae({hash:e,product:t})}async deleteGraphsImmediately(e){let t={graphing:[],"graphing-3d":[],"geometry-calculator":[]};this.setGraphsDeleteStatus(e,{state:"loading",cancelable:!1});for(let i of e){if(!i.hash){this.setGraphsDeleteStatus(e,{state:"error",message:"Error deleting graphs"});return}t[i.product].push(i.hash)}let o;try{await Pae({hashes2d:t.graphing,hashes3d:t["graphing-3d"],hashesGeometry:t["geometry-calculator"]}),o={state:"loaded",data:!0}}catch(i){o={state:"error",message:"Error deleting graphs"}}this.dispatchUpdateGraphsStateAction({type:"set-graphs-delete-status",graphs:e,status:o})}async deleteRecoveryGraphImmediately(e){if(this.setGraphsDeleteStatus([e],{state:"loading",cancelable:!1}),!e.hash||e.product==="graphing-3d"){this.setGraphsDeleteStatus([e],{state:"error",message:"Error deleting graphs"});return}let t;try{await Dae({hash:e.hash,product:e.product}),t={state:"loaded",data:!0}}catch(o){t={state:"error",message:"Error deleting graphs"}}this.dispatchUpdateGraphsStateAction({type:"set-graphs-delete-status",graphs:[e],status:t})}async removeGraphLegacy(e){if(!e.hash){this.setGraphsDeleteStatus([e],{state:"error",message:"Error deleting graph!"});return}let t;try{await this.getRemovePromise(e.hash,e.product),t={state:"loaded",data:!0}}catch(o){t={state:"error",message:"Error deleting graph!"}}this.dispatchUpdateGraphsStateAction({type:"set-graphs-delete-status",graphs:[e],status:t})}cancelDeleteGraph(e){let t=this._getCachedGraphInfo(e);clearTimeout(t.deleteTimeout),t.deleteStatus=void 0}millisecondsSinceSync(){return this.lastSync?Date.now()-this.lastSync:1/0}clear(){this.lastSync=void 0,this.setSavedGraphsState({state:"loaded",data:[]}),this.setRecoveryGraphsState({state:"loaded",data:[]})}copyCurrentGraphForSave({isRecoverySave:e=!1,maintainHash:t=!1}={}){let o=t?this.currentGraph.hash:this.randomHash.next();e&&(o=o+this.randomHash.next());let i=this.getApi(),n=JSON.stringify(i.getState()),a=i.screenshot({width:200,height:200,targetPixelRatio:2}),s={graphData:n,parentHash:this.currentGraph.hash,recoveryParentHash:this.recoveryParentHash,hash:o,thumbUrl:a};return this.recoveryParentHash=o,this.currentGraph.copy(s)}async save(e){this.shouldUpdateCurrentGraphDuringSave=!0;let t=e&&e.newTitle,o=!!(e!=null&&e.saveCopy);if(this.isSaving())return;t&&(this.currentGraph.title=t),this.showRecentSaveNotice=!1,clearTimeout(this.recentSaveTimeout),this.lastSaveStatus={state:"loading"};let i=!o&&this.wasCurrentGraphEverSaved(),n=this.showSavedGraphsRedesign()&&i,a=this.copyCurrentGraphForSave({maintainHash:n});a.recovery&&(a.recovery=!1);let s=this.getSavePromise({graph:a,isUpdateLegacy:i,saveType:"my-graph"}),c;try{c={state:"loaded",data:await s}}catch(d){c={state:"error",message:(d==null?void 0:d.status)===413?this.s("account-shell-error-graph-too-large"):Qh(d,this.s)[0]}}this.dispatchUpdateGraphsStateAction({type:"save-graph-complete",status:c,isUpdate:i})}handleSaveComplete(e,t){if(e.state==="error")this.toast(e.message,{});else if(e.state==="loaded"){let o=e.data;this.shouldUpdateCurrentGraphDuringSave&&(this.currentGraph=o.copy(),this._onCurrentGraphChanged()),this.getApi()._calc.controller.dispatch({type:"clear-unsaved-changes"}),t&&o.parentHash&&this._removeSavedGraphByHash(o.parentHash),o.recovery&&o.parentHash&&this._removeRecoveryGraphByHash(o.parentHash),this.__savedGraphs.state==="loaded"&&(o.hash&&this._removeSavedGraphByHash(o.hash),this.__savedGraphs.data.unshift(o)),this._addGraphToCache(o),this.__eventBus.triggerEvent("listChanged",void 0)}this.lastSaveStatus=e,this.showRecentSaveNotice=!0,this.recentSaveTimeout=setTimeout(()=>{this.dispatchUpdateGraphsStateAction({type:"dismiss-save-notice"})},3e3)}getSavePromise({graph:e,isUpdateLegacy:t,saveType:o}){if(this.showSavedGraphsRedesign()&&!e.recovery)return Sae(e,o);let i=this.getProduct();switch(i){case"graphing":case"geometry-calculator":return _ae(e,{myGraphs:o==="my-graph",isUpdate:t,product:i,lang:this.getLanguage()});case"graphing-3d":return bae(e,{myGraphs:o==="my-graph",isUpdate:t})}}async createSnapshotLink(){this.lastShareStatus={state:"loading"};let e=this.copyCurrentGraphForSave(),t;try{t={state:"loaded",data:await this.getSavePromise({graph:e,isUpdateLegacy:!1,saveType:"quick-link"})}}catch(o){let i=this.s("account-shell-error-sharing-link");t={state:"error",message:Qh(o,this.s,i)[0]}}this.dispatchUpdateGraphsStateAction({type:"share-graph-complete",status:t})}saveRecoveryGraph(){let e=this.getProduct();switch(e){case"graphing":case"geometry-calculator":{let t=this.copyCurrentGraphForSave({isRecoverySave:!0});return kae(t,{product:e,lang:this.getLanguage()})}case"graphing-3d":throw new Error(`Programming Error: ${e} cannot save recovery graphs`)}}isCurrentGraphTitled(){return!!this.currentGraph.title&&!this.currentGraph.questHash}wasCurrentGraphEverSaved(){let e=this.currentGraph;if(!e||!e.hash)return!1;let t=e.hash;return __dcg_shared_module_exports__['Ja'](this.getSavedGraphs(),o=>o.hash===t)}willSaveCopy(){let e=this.currentGraph;return!!e.questHash||!!e.hash&&!this.wasCurrentGraphEverSaved()}isSaveEnabled(){var e;return this.hasUnsavedChanges()?!0:(e=this.currentGraph)!=null&&e.hash?!this.wasCurrentGraphEverSaved():!1}isRecoveryUIEnabledForProduct(){let e=this.getProduct();return e==="graphing"||e==="geometry-calculator"}isGeometryTool(){return this.getProduct()==="geometry-calculator"}getRefreshRecoveryGraphsPromise(){if(this.showSavedGraphsRedesign())return Iae();let e=this.getProduct();switch(e){case"graphing":case"geometry-calculator":return Mae({product:e,lang:this.getLanguage()});case"graphing-3d":throw new Error("code error: should not fetchRecoveryGraphs for 3d")}}async fetchRecoveryGraphsLegacy(){let t=Date.now(),o;clearTimeout(this.fetchDurationTimeout),this.__recoveryGraphs={state:"loading"};try{let a=await this.getRefreshRecoveryGraphsPromise();o={state:"loaded",data:this.parseGraphsFromJSON(a.recoveryGraphs,{isRecovery:!0})}}catch(a){o={state:"error",message:"Unknown error"}}let n=2e3-(Date.now()-t);n>0?this.fetchDurationTimeout=setTimeout(()=>{this.dispatchUpdateGraphsStateAction({type:"set-recovery-graphs",fetchedGraphs:o})},n):this.dispatchUpdateGraphsStateAction({type:"set-recovery-graphs",fetchedGraphs:o})}async fetchRecoveryGraphs(){let e;if(this.__recoveryGraphs.state!=="loading"){this.__recoveryGraphs={state:"loading"};try{let{recoveryGraphs:t}=await this.getRefreshRecoveryGraphsPromise();e={state:"loaded",data:this.parseGraphsFromJSON(t,{isRecovery:!0})}}catch(t){e={state:"error",message:"Unknown error"}}this.dispatchUpdateGraphsStateAction({type:"set-recovery-graphs",fetchedGraphs:e})}}clearRecoveryGraphsForTests(){return Lae()}async fetchMyGraphsForAllProducts(){let{myGraphs:e}=await Eae();return e}async fetchMyGraphsForCurrentProduct(){let e=this.getProduct(),t=this.getLanguage();if(e==="graphing-3d"){let{myGraphs:i}=await xae({lang:t});return i}let{myGraphs:o}=await Tae({product:e,lang:t});return o}async refreshGraphs({allProducts:e}){this.__savedGraphs={state:"loading"};let t=e?this.fetchMyGraphsForAllProducts():this.fetchMyGraphsForCurrentProduct(),o;try{o=await t}catch(n){this.dispatchUpdateGraphsStateAction({type:"set-saved-graphs",fetchedGraphs:{state:"error",message:"Error syncing graphs!"}});return}this.lastSync=Date.now();let i;"folders"in o?(this.dispatch({type:"set-folders",payload:o.folders}),i=[...o.graphs2d,...o.graphs3d,...o.graphsGeometry]):(i=o,this.dispatch({type:"set-folders",payload:[]})),this.dispatchUpdateGraphsStateAction({type:"set-saved-graphs",fetchedGraphs:{state:"loaded",data:this.parseGraphsFromJSON(i)}})}getRecoveryGraphs(){return this.__recoveryGraphs.state!=="loaded"?[]:this.showSavedGraphsRedesign()?this.__recoveryGraphs.data.slice(0).filter(e=>!this.isDeletingGraph(e)):this.__recoveryGraphs.data.slice(0)}getSavedGraphs(){return this.__savedGraphs.state!=="loaded"?[]:this.showSavedGraphsRedesign()?this.__savedGraphs.data.slice(0).filter(e=>!this.isDeletingGraph(e)):this.__savedGraphs.data.slice(0)}getExampleGraphs(){return this.__exampleGraphsLegacy.slice(0)}getExampleGraphsAllProducts(){return this.__exampleGraphsAllProducts||(this.__exampleGraphsAllProducts=this.setUpExampleGraphsAllProducts()),this.__exampleGraphsAllProducts}setUpExampleGraphsAllProducts(){return{graphing:this.processExampleGraphsFromJSON("graphing"),"geometry-calculator":this.processExampleGraphsFromJSON("geometry-calculator"),"graphing-3d":this.processExampleGraphsFromJSON("graphing-3d")}}processExampleGraphsFromJSON(e){return this.__exampleJSONs[e].map(i=>{let n=ki.fromAjax(i);return this._addGraphToCache(n),n}).filter(i=>i.isNonEasterEggExample())}getEasterEggGraphs(e){return __dcg_shared_module_exports__['Ha'](this.__easterEggGraphsLegacy,t=>t.isSpecificEasterEgg(e))}getSavedAndExampleGraphs(){return this.getSavedGraphs().concat(this.__exampleGraphsLegacy)}parseGraphsFromJSON(e,{isRecovery:t}={isRecovery:!1}){return e||(e=[]),e.sort((i,n)=>{let a=new Date(i.created);return new Date(n.created).valueOf()-a.valueOf()}),e.map(i=>{let n=ki.fromAjax(i,{isRecovery:t}),a=this._getCachedGraphInfo(n);return a?a.graph:(this._addGraphToCache(n),n)})}setSavedGraphsState(e){this.__savedGraphs=e,this.__savedGraphs.state==="loaded"&&this.__eventBus.triggerEvent("listChanged",void 0),this.__savedGraphs.state==="error"&&(this.myGraphsModalFailureMessage=this.__savedGraphs.message,this.__eventBus.triggerEvent("onSyncError",void 0))}setRecoveryGraphsState(e){this.__recoveryGraphs=e,this.__recoveryGraphs.state==="error"&&this.__eventBus.triggerEvent("onRecoveryGraphsError",void 0)}getSavedGraphsAsJSON(){return(this.__savedGraphs.state==="loaded"?this.__savedGraphs.data:[]).map(ki.toAjax)}_enableLoadingGraphStates(){clearTimeout(this.__loadNextGraphStateTimeout);let e=()=>{this._loadNextGraphState(),this.__loadNextGraphStateTimeout=setTimeout(e,50)};e()}async _loadNextGraphState(){if(this.__currentAjaxRequest)return;let e=this._dequeueGraphInfo();if(e){this.__currentAjaxRequest=this.loadDataForGraphImmediately(e.graph);try{await this.__currentAjaxRequest}catch(t){}this.__currentAjaxRequest=void 0}}async loadDataForGraphImmediately(e){if(e.graphData)return;let t=e.stateUrl,o=this._getCachedGraphInfo(e);o.isDataLoading=!0;try{let i=await fetch(`${t}?${new URLSearchParams(Ig)}`),n=await i.json();if(!i.ok)throw n;return e.setGraphData(n),o.didDataLoadFail=!1,n}catch(i){throw o.didDataLoadFail=!0,i}finally{o.isDataLoading=!1,this.__eventBus.triggerEvent("listChanged",void 0),this.__eventBus.triggerEvent("triggerRender",void 0)}}_getCachedGraphInfo(e){return e&&this.__graphInfoCache[e.getCollectionKey()]}_addGraphToCache(e){this.__graphInfoCache[e.getCollectionKey()]={graph:e}}_enqueueGraphInfo(e){this.__nextAjaxRequestPriority||(this.__nextAjaxRequestPriority=0),e.ajaxPriority=++this.__nextAjaxRequestPriority}_dequeueGraphInfo(){let e=-1/0,t;for(let o in this.__graphInfoCache){let i=this.__graphInfoCache[o],n=i.ajaxPriority;n!==void 0&&n>e&&(e=n,t=i)}return!__dcg_shared_module_exports__['gb'](t)||t===void 0?null:(delete t.ajaxPriority,t)}loadDataForGraph(e){if(!e)return;let t=this._getCachedGraphInfo(e);if(!t)throw new Error('graphsController does not have a reference to graph with hash "'+e.hash+'"');t.graph.graphData||(t.isDataLoading=!0,t.didDataLoadFail=!1,this._enqueueGraphInfo(t),this.__eventBus.triggerEvent("triggerRender",void 0))}didDataLoadFail(e){let t=this._getCachedGraphInfo(e);return!!(t&&t.didDataLoadFail)}didDeleteGraphFail(e){var o;return((o=this._getCachedGraphInfo(e).deleteStatus)==null?void 0:o.state)==="error"}isDeletingGraph(e){var o;return((o=this._getCachedGraphInfo(e).deleteStatus)==null?void 0:o.state)==="loading"}canCancelDelete(e){var o;let t=this._getCachedGraphInfo(e);return((o=t.deleteStatus)==null?void 0:o.state)==="loading"&&t.deleteStatus.cancelable}loadGraph(e,t){this.previousGraph=this.currentGraph.copy();let o=this.getApi();this.previousGraph.product===this.getProduct()&&this.previousGraph.setGraphData(o.getState());let i=e.copy({example:!1});o.setState(i.graphData,{forceExpressionsOpen:!0,forceUnsavedChanges:!!i.recovery,allowUndo:t&&t.allowUndo}),this.currentGraph=i,this._onCurrentGraphChanged(),this.shouldUpdateCurrentGraphDuringSave=!1,this.recoveryParentHash=this.currentGraph.hash;let n=o._calc.controller;(!t||!t.allowUndo)&&n.dispatch({type:"clear-undoredo-history"}),i.recovery||n.dispatch({type:"clear-unsaved-changes"}),this.__eventBus.triggerEvent("onLoadGraph",void 0)}restorePreviousGraph(e){var o;let t=((o=this.previousGraph)==null?void 0:o.copy())||new ki({product:this.getProduct()});this.loadGraph(t,e)}clearGraph(e){this.loadGraph(new ki({product:this.getProduct()}),e),this.getApi().focusFirstExpression()}defaultTitle(){switch(this.getProduct()){case"graphing":return this.s("account-shell-heading-graphingcalc-page-title");case"graphing-3d":return this.s("account-shell-heading-3dcalc-page-title");case"geometry-calculator":return this.s("account-shell-heading-geometry-page-title")}}_onCurrentGraphChanged(){let e=this.currentGraph;e.title?document.title=this.s("account-shell-heading-named-graph",{title:e.title}):document.title=this.defaultTitle(),this._replaceState(e)}_replaceState(e){if(this.showSavedGraphsRedesign()){this._replaceStateInterchangeableProducts(e);return}if(!(window.history&&history.replaceState))return;let t=e.recovery?e.getFullTopLevelURL():e.getURL();t&&(window.location.search&&(t+=window.location.search),t!==window.location.href&&history.replaceState(e.hash,e.getVisibleTitle(this.s),t))}toast(e,t){this.getApi()._calc.controller.dispatch({type:"toast/show",toast:{message:e,...t}})}_replaceStateInterchangeableProducts(e){let t=e.recovery?e.getFullTopLevelURLInterchangeableProducts():e.getURLInterchangeableProducts();t&&(window.location.search&&(t+=window.location.search),t!==window.location.href&&history.replaceState(e.hash,e.getVisibleTitle(this.s),t))}openBlankGraph(){let e;if(this.currentGraph.hash||this.currentGraph.questHash){this.clearGraph(),e=this.isGeometryTool()?this.s("account-shell-text-new-construction-created"):this.s("account-shell-text-new-graph-created"),this.toast(e,{undoCallback:()=>{this.dispatchUpdateGraphsStateAction({type:"restore-previous-graph"})}});return}let t=this.getApi(),o=t.getState();this.clearGraph({allowUndo:!0}),e=this.isGeometryTool()?this.s("account-shell-text-construction-cleared"):this.s("account-shell-text-graph-cleared"),this.showSavedGraphsRedesign()?this.toast(e,{undoCallback:()=>{var i;this.dispatchUpdateGraphsStateAction({type:"restore-previous-graph",opts:{forceExpressionsOpen:!0,allowUndo:((i=this.previousGraph)==null?void 0:i.product)===this.currentGraph.product}})}}):this.toast(e,{undoCallback:()=>{t.setState(o,{forceExpressionsOpen:!0,allowUndo:!0})}})}isSaving(){var e;return((e=this.lastSaveStatus)==null?void 0:e.state)==="loading"}showSaveSuccessNotice(){var e;return((e=this.lastSaveStatus)==null?void 0:e.state)==="loaded"&&this.showRecentSaveNotice}showSaveFailNotice(){var e;return((e=this.lastSaveStatus)==null?void 0:e.state)==="error"&&this.showRecentSaveNotice}isSyncing(){return this.__savedGraphs.state==="loading"}didSyncFail(){return this.__savedGraphs.state==="error"}isFetchingRecoveryGraphs(){return this.__recoveryGraphs.state==="loading"}didFetchRecoveryGraphsFail(){return this.__recoveryGraphs.state==="error"}getCurrentDisplayDate(){return this.currentGraph.displayDate()}getCurrentGraphTitle(){return this.currentGraph.getVisibleTitle(this.s)}getCurrentGraphHash(){return this.currentGraph.hash}hasUnsavedChanges(){return this.getApi()._calc.controller.hasUnsavedChanges()}setLastSync(e){this.lastSync=e}};function Oae(){let r={platform:navigator.platform,userAgent:navigator.userAgent,supportsContext:!!window.WebGL2RenderingContext,createdContext:!1,webGLInfo:{}};if(!r.supportsContext)return r;let e=document.createElement("canvas");e.width=1,e.height=1,document.body.appendChild(e);let t,i=["webgl2","experimental-webgl2"].filter(C=>t?!1:(t=e.getContext(C,{stencil:!0}),!!t))[0];if(e.remove(),r.createdContext=!!t,!t)return r;function n(C){return"["+C[0]+", "+C[1]+"]"}function a(){let C=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic");if(C){let D=t.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT);return D===0&&(D=2),D}return"n/a"}function s(C,D){return D?""+Math.pow(2,C):"2^"+C}function c(C,D){let P=D?" bit mantissa":"";return"[-"+s(C.rangeMin,D)+", "+s(C.rangeMax,D)+"] ("+C.precision+P+")"}function d(C){let D=t.getShaderPrecisionFormat(C,t.HIGH_FLOAT),P=t.getShaderPrecisionFormat(C,t.MEDIUM_FLOAT),F=t.getShaderPrecisionFormat(C,t.LOW_FLOAT),N=D;return D.precision===0&&(N=P),{high:c(D,!0),medium:c(P,!0),low:c(F,!0),best:c(N,!1)}}function p(C){let D=C.getShaderPrecisionFormat(C.FRAGMENT_SHADER,C.HIGH_FLOAT),P=D.precision!==0?"highp/":"mediump/";return D=C.getShaderPrecisionFormat(C.FRAGMENT_SHADER,C.HIGH_INT),P+=D.rangeMax!==0?"highp":"lowp",P}function u(C){return C!==0&&(C&C-1)===0}function g(C){let D=n(C.getParameter(C.ALIASED_LINE_WIDTH_RANGE));return(navigator.platform==="Win32"||navigator.platform==="Win64")&&C.getParameter(C.RENDERER)!=="Internet Explorer"&&C.getParameter(C.RENDERER)!=="Microsoft Edge"&&D===n([1,1])?u(C.getParameter(C.MAX_VERTEX_UNIFORM_VECTORS))&&u(C.getParameter(C.MAX_FRAGMENT_UNIFORM_VECTORS))?"Yes, D3D11":"Yes, D3D9":"No"}function h(C){let D=document.createElement("canvas");D.width=1,D.height=1,document.body.appendChild(D);let P=D.getContext(C,{failIfMajorPerformanceCaveat:!0});return D.remove(),P?typeof P.getContextAttributes().failIfMajorPerformanceCaveat=="undefined"?"Not implemented":"No":"Yes"}function b(){return navigator.userAgent.indexOf("Chrome")!==-1?'To see draft extensions in Chrome, browse to about:flags, enable the "Enable WebGL Draft Extensions" option, and relaunch.':navigator.userAgent.indexOf("Firefox")!==-1?"To see draft extensions in Firefox, browse to about:config and set webgl.enable-draft-extensions to true.":""}function v(C){let D=1,P=C.getExtension("WEBGL_draw_buffers");return P!=null&&(D=C.getParameter(P.MAX_DRAW_BUFFERS_WEBGL)),D}function T(C){let D={renderer:"",vendor:""},P=C.getExtension("WEBGL_debug_renderer_info");return P!=null&&(D.renderer=C.getParameter(P.UNMASKED_RENDERER_WEBGL),D.vendor=C.getParameter(P.UNMASKED_VENDOR_WEBGL)),D}function E(C){return C===null?"n/a":C}function I(C){let D=["copyBufferSubData","getBufferSubData","blitFramebuffer","framebufferTextureLayer","getInternalformatParameter","invalidateFramebuffer","invalidateSubFramebuffer","readBuffer","renderbufferStorageMultisample","texStorage2D","texStorage3D","texImage3D","texSubImage3D","copyTexSubImage3D","compressedTexImage3D","compressedTexSubImage3D","getFragDataLocation","uniform1ui","uniform2ui","uniform3ui","uniform4ui","uniform1uiv","uniform2uiv","uniform3uiv","uniform4uiv","uniformMatrix2x3fv","uniformMatrix3x2fv","uniformMatrix2x4fv","uniformMatrix4x2fv","uniformMatrix3x4fv","uniformMatrix4x3fv","vertexAttribI4i","vertexAttribI4iv","vertexAttribI4ui","vertexAttribI4uiv","vertexAttribIPointer","vertexAttribDivisor","drawArraysInstanced","drawElementsInstanced","drawRangeElements","drawBuffers","clearBufferiv","clearBufferuiv","clearBufferfv","clearBufferfi","createQuery","deleteQuery","isQuery","beginQuery","endQuery","getQuery","getQueryParameter","createSampler","deleteSampler","isSampler","bindSampler","samplerParameteri","samplerParameterf","getSamplerParameter","fenceSync","isSync","deleteSync","clientWaitSync","waitSync","getSyncParameter","createTransformFeedback","deleteTransformFeedback","isTransformFeedback","bindTransformFeedback","beginTransformFeedback","endTransformFeedback","transformFeedbackVaryings","getTransformFeedbackVarying","pauseTransformFeedback","resumeTransformFeedback","bindBufferBase","bindBufferRange","getIndexedParameter","getUniformIndices","getActiveUniforms","getUniformBlockIndex","getActiveUniformBlockParameter","getActiveUniformBlockName","uniformBlockBinding","createVertexArray","deleteVertexArray","isVertexArray","bindVertexArray"],P=[],F=0,N=D.length;for(let Y=0;Y<N;++Y){let z=D[Y],X="extension";C[z]?++F:X+=" unsupported",P.push({name:z,className:X})}return{status:F+" of "+N+" new functions implemented.",functions:P}}let _=I(t);return r.webGLInfo={contextName:i,glVersion:t.getParameter(t.VERSION),shadingLanguageVersion:t.getParameter(t.SHADING_LANGUAGE_VERSION),vendor:t.getParameter(t.VENDOR),renderer:t.getParameter(t.RENDERER),unMaskedVendor:T(t).vendor,unMaskedRenderer:T(t).renderer,antialias:t.getContextAttributes().antialias?"Available":"Not available",angle:g(t),majorPerformanceCaveat:h(i),maxColorBuffers:v(t),redBits:t.getParameter(t.RED_BITS),greenBits:t.getParameter(t.GREEN_BITS),blueBits:t.getParameter(t.BLUE_BITS),alphaBits:t.getParameter(t.ALPHA_BITS),depthBits:t.getParameter(t.DEPTH_BITS),stencilBits:t.getParameter(t.STENCIL_BITS),maxRenderBufferSize:t.getParameter(t.MAX_RENDERBUFFER_SIZE),maxCombinedTextureImageUnits:t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxCubeMapTextureSize:t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),maxFragmentUniformVectors:t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),maxTextureImageUnits:t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:t.getParameter(t.MAX_TEXTURE_SIZE),maxVaryingVectors:t.getParameter(t.MAX_VARYING_VECTORS),maxVertexAttributes:t.getParameter(t.MAX_VERTEX_ATTRIBS),maxVertexTextureImageUnits:t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexUniformVectors:t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),aliasedLineWidthRange:n(t.getParameter(t.ALIASED_LINE_WIDTH_RANGE)),aliasedPointSizeRange:n(t.getParameter(t.ALIASED_POINT_SIZE_RANGE)),maxViewportDimensions:n(t.getParameter(t.MAX_VIEWPORT_DIMS)),maxAnisotropy:a(),vertexShaderBestPrecision:d(t.VERTEX_SHADER),fragmentShaderBestPrecision:d(t.FRAGMENT_SHADER),fragmentShaderFloatIntPrecision:p(t),extensions:t.getSupportedExtensions(),draftExtensionsInstructions:b(),webgl2Status:_.status,webgl2Functions:_.functions,maxVertexUniformComponents:E(t.getParameter(t.MAX_VERTEX_UNIFORM_COMPONENTS)),maxVertexUniformBlocks:E(t.getParameter(t.MAX_VERTEX_UNIFORM_BLOCKS)),maxVertexOutputComponents:E(t.getParameter(t.MAX_VERTEX_OUTPUT_COMPONENTS)),maxVaryingComponents:E(t.getParameter(t.MAX_VARYING_COMPONENTS)),maxFragmentUniformComponents:E(t.getParameter(t.MAX_FRAGMENT_UNIFORM_COMPONENTS)),maxFragmentUniformBlocks:E(t.getParameter(t.MAX_FRAGMENT_UNIFORM_BLOCKS)),maxFragmentInputComponents:E(t.getParameter(t.MAX_FRAGMENT_INPUT_COMPONENTS)),minProgramTexelOffset:E(t.getParameter(t.MIN_PROGRAM_TEXEL_OFFSET)),maxProgramTexelOffset:E(t.getParameter(t.MAX_PROGRAM_TEXEL_OFFSET)),maxDrawBuffers:E(t.getParameter(t.MAX_DRAW_BUFFERS)),maxColorAttachments:E(t.getParameter(t.MAX_COLOR_ATTACHMENTS)),maxSamples:E(t.getParameter(t.MAX_SAMPLES)),max3dTextureSize:E(t.getParameter(t.MAX_3D_TEXTURE_SIZE)),maxArrayTextureLayers:E(t.getParameter(t.MAX_ARRAY_TEXTURE_LAYERS)),maxTextureLodBias:E(t.getParameter(t.MAX_TEXTURE_LOD_BIAS)),maxUniformBufferBindings:E(t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS)),maxUniformBlockSize:E(t.getParameter(t.MAX_UNIFORM_BLOCK_SIZE)),uniformBufferOffsetAlignment:E(t.getParameter(t.UNIFORM_BUFFER_OFFSET_ALIGNMENT)),maxCombinedUniformBlocks:E(t.getParameter(t.MAX_COMBINED_UNIFORM_BLOCKS)),maxCombinedVertexUniformComponents:E(t.getParameter(t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS)),maxCombinedFragmentUniformComponents:E(t.getParameter(t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS)),maxTransformFeedbackInterleavedComponents:E(t.getParameter(t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS)),maxTransformFeedbackSeparateAttribs:E(t.getParameter(t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS)),maxTransformFeedbackSeparateComponents:E(t.getParameter(t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS)),maxElementIndex:E(t.getParameter(t.MAX_ELEMENT_INDEX)),maxServerWaitTimeout:E(t.getParameter(t.MAX_SERVER_WAIT_TIMEOUT))},r}jo();var Rae=r=>Di("/api/v1/folder",{name:r}),Fae=({id:r,name:e})=>SH(`/api/v1/folder/${r}`,{name:e});var Nae=(r,e)=>Di(`/api/v1/folder/${r}/graphs`,{graphs:e}),Uae=(r,e)=>_I(`/api/v1/folder/${r}/graphs`,{graphs:e});var z2=class extends Pi{constructor(t,o,{getApi:i,getProduct:n,s:a,dispatch:s,runAfterDispatch:c}){super();this.recoveryAttempted=!1;this.isOpen=!1;this.searchFilter="";this.isModalLoading=!1;this.isModalMobileSearchOpen=!1;this.currentTab="my-graphs";this.savedGraphsOption="saved-graphs";this.graphLayout="grid";this.singleGraphActionMenu="options-list";this.isMoveGraphMenuInputFocused=!1;this.moveGraphMenuSearchFilter="";this.shareMenuState="main";this.sorting={sortField:"last-edited",reverseDirection:!1};this.selectedGraphs=[];this.folders=new Map;this.graphsController=t,this.userController=o,this.dispatch=s,this.getApi=i,this.getProduct=n,this.s=a,this.runAfterDispatch=c,this.numSavedGraphsToDisplay=this.calculateNumTilesToAddOnLoadMore(),this.exampleGalleryFilter=this.getProduct(),this.pageLoadTime=Date.now(),this.defaultFolderName=this.s("account-shell-text-untitled-folder")}perform(t){switch(t.type){case"set-single-graph-action-menu":this.setGraphActionDropdownView(t.payload.menu);break;case"set-move-graph-menu-input-focused":this.setMoveGraphMenuInputFocus(t.payload.isFocused);break;case"set-move-graph-menu-search-filter":this.setMoveGraphMenuSearchFilter(t.payload.searchFilter);break;case"reset-single-graph-action-menu":this.resetGraphActionDropdownState();break;case"create-folder":this.createFolder(t.payload);break;case"set-folders":t.payload.forEach(o=>this.addFolder(o));break;case"toggle-folder-selection":this.toggleFolderSelection(t.payload);break;case"rename-folder":this.renameFolder({id:t.payload.id,name:t.payload.name||this.defaultFolderName});break;case"update-folder":this.updateFolder(t.payload);break;case"set-open-folder":this.setOpenFolder(t.payload),this.deselectAllGraphs(),this.deselectAllFolders();break;case"move-graphs-complete":this.moveGraphs(t.payload.graphIdentifiers,t.payload.removeFromFolder,t.payload.addToFolder);break;case"move-graphs-to-folder":this.requestMoveGraphsToFolder(t.payload.id,t.payload.graphs,t.payload.currentFolderId);break;case"remove-graphs-from-folder":this.requestRemoveGraphsFromFolder(t.payload.id,t.payload.graphs);break;case"clear-last-created-folder-id":this.lastCreatedFolderId=void 0;break;case"clear-folders":this.folders.clear(),this.lastCreatedFolderId=void 0;break;default:break}}isMygraphsOpen(){return this.isOpen}hasAttemptedRecovery(){return this.recoveryAttempted}openMygraphs(){var t;this.recoveryAttempted=!1,this.isOpen=!0,document.body.classList.add("resources-open"),_e(this.s("account-shell-narration-mygraphs-open-graph")),Dr(),(t=document.querySelector(".dcg-action-newblankgraph"))==null||t.focus()}closeMygraphs(){this.isOpen=!1,document.body.classList.remove("resources-open")}onOpenGraphFromSidebar(t){let o=this.copyGraphWithTranslation(t);this.graphsController.loadGraph(o),this._concludeOpenGraph(o)}toast(t,o){this.getApi()._calc.controller.dispatch({type:"toast/show",toast:{message:t,...o}})}showMyGraphsToast(t,o){this.dispatch({type:"my-graphs-toast-show",myGraphsToast:{message:t,...o}})}_concludeOpenGraph(t){this.showRestorePreviousToast(t),this.closeMygraphs(),this.triggerEvent("triggerRender",void 0),qx()}showLegacyGeometryMigrationToast(t){this.toast(this.s("account-shell-text-graph-migrated-from-geometry",{title:t.getVisibleTitle(this.s)}),{link:{text:this.s("shared-calculator-label-toast-learn-more"),url:"https://help.desmos.com/hc/en-us/articles/17817122756877"}})}showRestorePreviousToast(t){let o=t.getVisibleTitle(this.s);this.toast(this.s("account-shell-text-mygraphs-opened-graph",{graphTitle:o}),{undoCallback:()=>{this.dispatch({type:"update-graphs-state",update:{type:"restore-previous-graph"}})}})}copyGraphWithTranslation(t){return t.copy({title:t.getVisibleTitle(this.s)})}openGraphBehindCover(t){let o=this.copyGraphWithTranslation(t);return this.graphsController.loadGraph(o),this.triggerEvent("triggerRender",void 0),new Promise(i=>{let n=this.getProduct();(n==="graphing"||n==="graphing-3d"||n==="geometry-calculator")&&(this.getApi()._calc.evaluator.notifyWhenSynced(()=>{i()}),setTimeout(()=>{i()},6e3))}).then(()=>{this._concludeOpenGraph(o)})}getThumbnail(){return this.getApi().screenshot({width:200,height:200,targetPixelRatio:2})}async fetchAndOpenGraphFromModal(t){this.setModalLoadingState(!0),await this.graphsController.loadDataForGraphImmediately(t),this.dispatch({type:"open-fetched-graph-from-modal",graph:t})}openFetchedGraph(t,{showRestoreToast:o}){let i=this.copyGraphWithTranslation(t);this.graphsController.loadGraph(i),o&&this.showRestorePreviousToast(t)}setSortField(t){this.sorting={sortField:t,reverseDirection:!1}}toggleSortDirection(){this.sorting.reverseDirection=!this.sorting.reverseDirection}getSortedGraphs(){let t=this.getSavedGraphsToDisplay();if(this.graphLayout==="list"){switch(this.sorting.sortField){case"name":t=t.sort((o,i)=>{var n;return((n=o.title)==null?void 0:n.localeCompare(i.title||""))||0});break;case"last-edited":t=t.sort((o,i)=>i.created.getTime()-o.created.getTime());break;case"tool":t=[...this.getSavedGraphsByProduct("graphing"),...this.getSavedGraphsByProduct("geometry-calculator"),...this.getSavedGraphsByProduct("graphing-3d")];break;default:return this.sorting.sortField,[]}t=this.sorting.reverseDirection?t.reverse():t}return this.reorderCurrentlyOpenGraphFirst(t)}reorderCurrentlyOpenGraphFirst(t){let o=t.findIndex(i=>i.hash===this.graphsController.currentGraph.hash);if(o!==-1){let i=t.splice(o,1);t.unshift(i[0])}return t}setSearchFilter(t){this.searchFilter=t}isGraphSelected(t){return this.selectedGraphs.filter(o=>o.hash===t.hash).length>0}selectedGraphCount(){return this.selectedGraphs.length}setSelectedGraph(t){this.selectedGraphs=[t]}deselectAllGraphs(){this.selectedGraphs=[]}toggleGraphSelected(t){this.isGraphSelected(t)?this.selectedGraphs=this.selectedGraphs.filter(o=>o.hash!==t.hash):this.selectedGraphs.push(t)}getSavedGraphsToDisplay(){return this.getFilteredSavedGraphs().slice(0,this.numSavedGraphsToDisplay)}getSavedGraphsByProduct(t){return this.getSavedGraphsToDisplay().filter(o=>o.product===t)}getFilteredSavedGraphs(){return this.savedGraphsOption==="recovered-graphs"?this.filterGraphs(this.graphsController.getRecoveryGraphs()):this.openFolderId?this.filterGraphs(this.getGraphsInFolder(this.openFolderId)):this.filterGraphs(this.getUnfolderedGraphs())}getExampleGraphsToDisplay(t){return this.filterGraphs(this.graphsController.getExampleGraphsAllProducts()[t])}hasExampleGraphsToDisplay(){return Lu.some(t=>this.getExampleGraphsToDisplay(t).length>0)}loadMoreGraphsFromModal(){this.numSavedGraphsToDisplay+=this.calculateNumTilesToAddOnLoadMore()}shouldShowLoadMore(){return this.numSavedGraphsToDisplay<this.getFilteredSavedGraphs().length}setModalLoadingState(t){this.isModalLoading=t}setModalMobileSearchOpen(t){t||this.setSearchFilter(""),this.isModalMobileSearchOpen=t}setSelectedTab(t){this.currentTab=t}setSelectedSavedGraphsOption(t){this.currentTab="my-graphs",this.savedGraphsOption=t}setGraphLayout(t){this.graphLayout=t}setExampleGalleryFilter(t){this.exampleGalleryFilter=t}resetModalState(){this.currentTab="my-graphs",this.savedGraphsOption="saved-graphs",this.exampleGalleryFilter=this.getProduct(),this.graphsController.myGraphsModalFailureMessage=void 0,this.deselectAllGraphs(),this.setModalMobileSearchOpen(!1)}setGraphActionDropdownView(t){this.singleGraphActionMenu=t}setMoveGraphMenuInputFocus(t){this.isMoveGraphMenuInputFocused=t}setMoveGraphMenuSearchFilter(t){this.moveGraphMenuSearchFilter=t}resetGraphActionDropdownState(){this.setGraphActionDropdownView("options-list"),this.setMoveGraphMenuInputFocus(!1),this.setMoveGraphMenuSearchFilter("")}setShareMenuState(t){this.shareMenuState=t,t==="share-snapshot"&&this.graphsController.createSnapshotLink()}copyShareLink(t){let o=document.createElement("textarea");o.value=t,document.body.appendChild(o),o.select();try{document.execCommand("copy"),this.showMyGraphsToast(this.s("graphing-calculator-narration-share-graph-link-copied"),{})}catch(i){this.showMyGraphsToast(this.s("account-shell-error-sharing-link"),{})}finally{o.remove()}}filterGraphs(t){let o=this.searchFilter.toLowerCase();return o?t.filter(i=>i.getVisibleTitle(this.s).toLowerCase().indexOf(o)>=0):t}calculateNumTilesToAddOnLoadMore(){return this.numSavedGraphsToDisplay+12>this.getFilteredSavedGraphs().length?this.getFilteredSavedGraphs().length-this.numSavedGraphsToDisplay:12}getUnfolderedGraphs(){let t=this.getFolders(),o=new Set;return t.forEach(i=>{i.graphs.forEach(n=>{o.add(`${n.graphHash}${n.product}`)})}),this.graphsController.getSavedGraphs().filter(i=>!o.has(`${i.hash}${i.product}`))}getGraphsInFolder(t){let o=new Set(this.getFolder(t).graphs.map(i=>`${i.graphHash}${i.product}`));return this.graphsController.getSavedGraphs().filter(i=>o.has(`${i.hash}${i.product}`))}getFolders(){return Array.from(this.folders.values())}getOpenFolder(){if(this.openFolderId)return this.folders.get(this.openFolderId)}isFolderOpen(){return!!this.openFolderId}getFolderIds(){return Array.from(this.folders.values(),({id:t})=>t)}hasFolders(){return this.folders.size>0}getFolder(t){if(!this.folders.has(t))throw new Error(`Expected folder with ID ${t} to exist.`);return this.folders.get(t)}updateFolder({id:t,...o}){this.folders.has(t)&&this.folders.set(t,{...this.folders.get(t),...o})}setOpenFolder(t){this.openFolderId=t}addFolder(t){this.folders.set(t.id,{...t,isSelected:!1,hasPendingChanges:!1,error:void 0,name:t.name||this.defaultFolderName})}async createFolder(t=this.defaultFolderName){let o=await Rae(t);this.addFolder(o),this.lastCreatedFolderId=o.id,this.dispatch({type:"render"})}isFolderLastCreated(t){return this.lastCreatedFolderId===t}toggleFolderSelection(t){var i;if(!this.folders.has(t)||(i=this.folders.get(t))!=null&&i.hasPendingChanges)return;let o=this.folders.get(t);this.folders.set(t,{...o,isSelected:!o.isSelected})}deselectAllFolders(){this.getFolders().forEach(t=>t.isSelected=!1)}isFolderSelected(t){var o;return!!((o=this.folders.get(t))!=null&&o.isSelected)}async renameFolder({id:t,name:o=this.defaultFolderName}){var n;if(!this.folders.has(t)||(n=this.folders.get(t))!=null&&n.hasPendingChanges)return;this.updateFolder({id:t,hasPendingChanges:!0,error:void 0});let i;try{i=await Fae({id:t,name:o})}catch(a){let s=typeof a=="object"&&!!a&&"status"in a&&a.status===404;this.dispatch({type:"update-folder",payload:{id:t,hasPendingChanges:!1,error:s?void 0:"Error"}});return}this.dispatch({type:"update-folder",payload:{id:i.folderId,hasPendingChanges:!1,error:void 0,name:o}})}moveGraphs(t,o,i){o&&t.forEach(n=>this.removeGraphFromFolder(o,n)),i&&t.forEach(n=>this.addGraphToFolder(i,n))}addGraphToFolder(t,o){let i=this.getFolder(t);i.graphs.some(n=>n.graphHash===o.graphHash&&n.product===o.product)||i.graphs.push(o)}removeGraphFromFolder(t,o){let i=this.getFolder(t);i.graphs=i.graphs.filter(n=>!(n.graphHash===o.graphHash&&n.product===o.product))}async requestMoveGraphsToFolder(t,o,i){let n=[];try{n=(await Nae(t,o.map(a=>a.toGraphIdentifier()))).graphs}catch(a){throw new Error("Failed to add graphs to folder")}this.dispatch({type:"move-graphs-complete",payload:{graphIdentifiers:n,removeFromFolder:i,addToFolder:t}})}async requestRemoveGraphsFromFolder(t,o){let i=[];try{i=(await Uae(t,o.map(n=>n.toGraphIdentifier()))).graphs}catch(n){throw new Error("Failed to remove graphs from folder")}this.dispatch({type:"move-graphs-complete",payload:{graphIdentifiers:i,removeFromFolder:t}})}};var Yc=null,_T=null,o6=!1,CT={},Yae=0;function iTe(){window.fetch=function(r,e){let t=new Request(r,e),o=Yae+"";Yae+=1;let i=new Promise((n,a)=>{CT[o]={resolve:n,reject:a}});return t.text().then(n=>{Yc.methods.proxyXHR(JSON.stringify({id:o,url:t.url,method:t.method,headers:t.headers,body:n}))},()=>{CT[o].reject(new TypeError("Could not decode request body")),delete CT[o]}),i}}function nTe(r){var t;let e=(t=r.target)==null?void 0:t.closest("a[href]");if(e&&e.protocol==="file:"){let o=e.getAttribute("href");o[0]!=="/"&&(o="/"+o),e.setAttribute("href",Xu()+o)}}if(Ws){let r=[],e=[],t=function(i){let n=e.length?e.pop():r.length;return r[n]=i,n},o=function(i){let n=r[i];return r[i]=null,e.push(i),n};Yc={loaded:!1,methods:{},queuedMethodCalls:[]},KE(()=>{let i=[];window.ObjC_callback=function(a){Yc.loaded=!0,a.split(" ").forEach(s=>{Yc.methods[s]=function(c,d){let p=d?t(d):-1;i.push("desmos:"+s+"/"+p+"/"+encodeURIComponent(c)),i.length===1&&n.setAttribute("src",i[0])}}),this.ObjC_callback=function(s,c){try{s!==-1&&o(s)(c)}finally{i.shift(),i.length>0&&n.setAttribute("src",i[0])}},Yc.methods.proxyXHR&&iTe(),Yc.queuedMethodCalls.forEach(s=>{zy[s.methodName].apply(zy,s.args)})};let n=document.createElement("iframe");Yo(n,{position:"absolute",left:"-1000px",zIndex:"-1"}),n.setAttribute("id","objc-bridge"),n.setAttribute("src","desmos:loaded"),document.body.append(n)})}else Nu?_T=window.Android:o6=!0;var aTe=["hideLoadingScreen","gaEvent","openGoogleLogin","openAppleLogin","logout","saveCookies","deleteCookies","startSingleAppMode","endSingleAppMode","setWWWSubdomain","sendSerializedAnalyticsEvent","sendStoredLogsToDesmos"],r6=class{constructor(){this._eventBus=new Pi;this.heartbeatTimeout=void 0,this._eventBus.observeEvent("started resumed",e=>{this.gaEvent(e+":"+this.versionNumber),this.incrementHeartbeat(0)}),document.location.search.indexOf("simulateVersionNumber")!==-1&&(this.versionNumber="?.?.?");for(let e of aTe)this[e]=function(){o6||(_T?_T[e]?_T[e].apply(_T,arguments):__dcg_shared_module_exports__['Be'].log("call to missing Android method",e,arguments):Yc&&(Yc.loaded?Yc.methods[e]?Yc.methods[e].apply(Yc,arguments):__dcg_shared_module_exports__['Be'].log("call to missing ObjC method",e,arguments):Yc.queuedMethodCalls.push({methodName:e,args:arguments})))}}heartbeat(e){clearTimeout(this.heartbeatTimeout),this.gaEvent("heartbeat-"+10*e),this.incrementHeartbeat(e)}incrementHeartbeat(e){clearTimeout(this.heartbeatTimeout),this.heartbeatTimeout=setTimeout(()=>{this.heartbeat(e+1)},600*1e3)}_started(e,t){this.appId=e,this.versionNumber=t,this._eventBus.triggerEvent("started",void 0)}_resumed(){this._eventBus.triggerEvent("resumed",void 0)}handleAndroidBackButtonAndReturnIfShouldMoveToBackground(){let e=window.Calc&&window.Calc.controller;return e&&e.isKeypadOpen()?(Dr(),"false"):(e=window.MainController,e&&e.handleAndroidBackButton()?"false":"true")}isInApp(){return window.platform&&window.platform!=="www"}onGoogleAuthResult(e){this._eventBus.triggerEvent("onGoogleAuthResult",e)}onAppleAuthResult(e){this._eventBus.triggerEvent("onAppleAuthResult",e)}onObjCXHRProxyResult(e){let t=e.id,{resolve:o,reject:i}=CT[t];delete CT[t],e.status===0?i(new TypeError("Network error")):o(new Response(e.body,{status:e.status,headers:e.headers}))}sendAnalyticsEvent(e,t){this.sendSerializedAnalyticsEvent(JSON.stringify({type:e,payload:t}))}observeEvent(e,t){return this._eventBus.observeEvent(e,t)}},zy=new r6;o6||(window.AppBridge=zy,document.addEventListener("click",nTe,!0));window.__dcgAppBridgeDefined=!0;var zae=__dcg_shared_module_exports__['e'](j());jo();var Ct=__dcg_shared_module_exports__['e'](j());Ut();var qy=__dcg_shared_module_exports__['e'](j()),q2=class extends qy.View{init(){this.controller=this.props.controller()}template(){return x("div",{class:qy.const("dcg-account-reminder"),children:[x("span",{class:qy.const("dcg-login"),children:[l("button",{class:qy.const("dcg-sign-in dcg-action-login dcg-btn-white-outline"),onTap:this.props.onSignIn,children:()=>this.props.controller().s("account-shell-button-log-in")}),()=>this.props.controller().s("account-shell-text-or"),l("button",{class:qy.const("dcg-create-account dcg-btn dcg-btn-blue dcg-tool-color dcg-action-createaccount"),onTap:this.props.onCreateAccount,children:()=>this.props.controller().s("account-shell-button-sign-up")})]}),l("div",{children:()=>this.getToSaveYourText()})]})}getToSaveYourText(){return this.controller.graphsController.isGeometryTool()?this.controller.s("account-shell-text-mygraphs-to-save-constructions"):this.controller.s("account-shell-text-mygraphs-to-save-graphs")}};var Nr=__dcg_shared_module_exports__['e'](j());Ut();var{If:TT}=Nr.Components,CS=class extends Nr.View{template(){return x("div",{role:Nr.const("listitem"),class:()=>({"saved-graph":!0,"graph-link-container":!0,"dcg-selected":this.props.isSelected()}),onTap:e=>{jr(e)||this.props.onTap(e)},children:[l(TT,{predicate:()=>!this.props.isDeletingGraph()&&!this.props.didDeleteGraphFail(),children:()=>x("div",{role:Nr.const("link"),tabIndex:Nr.const(0),class:()=>({"graph-link":!0,"dcg-action-preview-graph":!0,"example-graph":this.props.isExample()}),didMount:this.bindFn(this.didDivMount),children:[l("span",{class:Nr.const("dcg-thumb"),style:this.const({"background-image":`url(${this.props.getThumbURL()})`})}),x("div",{class:Nr.const("dcg-graph-details"),children:[l("div",{class:Nr.const("dcg-title"),children:this.props.getTitle}),l("div",{class:Nr.const("dcg-subtitle dcg-graph-date"),children:()=>this.props.isExample()?this.props.controller().s("account-shell-label-mygraphs-example"):this.props.getDisplayDate()})]})]})}),l(TT,{predicate:this.props.isDeletingGraph,children:()=>x("div",{"aria-live":Nr.const("assertive"),"aria-atomic":Nr.const("true"),class:Nr.const("deleting"),handleEvent:Nr.const("true"),onTap:()=>{this.props.canCancelDelete()&&this.props.cancelDeleteGraph()},children:[()=>this.props.controller().s("account-shell-text-mygraphs-deleting"),l(TT,{predicate:this.props.canCancelDelete,children:()=>l("div",{role:Nr.const("button"),tabIndex:Nr.const(0),class:Nr.const("cancel-delete"),children:()=>this.props.controller().s("account-shell-button-mygraphs-cancel")})})]})}),l(TT,{predicate:this.props.didDeleteGraphFail,children:()=>x("div",{"aria-live":Nr.const("assertive"),"aria-atomic":Nr.const("true"),class:Nr.const("retry-delete"),handleEvent:Nr.const("true"),children:[()=>this.props.controller().s("account-shell-error-mygraphs-error-deleting"),l("a",{role:Nr.const("button"),tabIndex:Nr.const(0),class:Nr.const("dcg-action-removegraph"),onTap:this.props.requestDeleteGraph,children:()=>this.props.controller().s("account-shell-button-mygraphs-try-again")}),()=>this.props.controller().s("account-shell-text-mygraphs-or"),l("a",{role:Nr.const("button"),tabIndex:Nr.const(0),class:Nr.const("dcg-action-cancelremovegraph"),onTap:this.props.cancelDeleteGraph,children:()=>this.props.controller().s("account-shell-button-mygraphs-cancel")})]})}),l(TT,{predicate:()=>!this.props.isExample()&&!this.props.isDeletingGraph()&&!this.props.didDeleteGraphFail(),children:()=>l("span",{class:Nr.const("actions"),handleEvent:Nr.const("true"),children:l("span",{role:Nr.const("button"),tabIndex:Nr.const(0),"aria-label":()=>this.props.controller().s("account-shell-button-mygraphs-delete-title",{graphTitle:this.props.getTitle()}),class:Nr.const("dcg-action-removegraph"),onTap:this.props.requestDeleteGraph,children:l(Oe,{tooltip:this.bindFn(this.getDeleteTooltipText),gravity:this.const("e"),children:l("i",{class:Nr.const("dcg-icon-remove"),"aria-hidden":Nr.const("true")})})})})})]})}getDeleteTooltipText(){return this.props.controller().graphsController.isGeometryTool()?this.props.controller().s("account-shell-button-mygraphs-delete-construction"):this.props.controller().s("account-shell-button-mygraphs-delete-graph")}didUpdate(){this.props.isSelected()&&re(this.node).trigger("focus")}didDivMount(e){this.node=e,re(this.node).on("focus",()=>{this.props.isSelected()||this.props.onFocus()})}};var Yn=__dcg_shared_module_exports__['e'](j());var _i=__dcg_shared_module_exports__['e'](j()),{If:H2}=_i.Components,uf=class extends _i.View{template(){return x("div",{class:_i.const("dcg-loading-container"),children:[l(H2,{predicate:()=>!this.props.didDataLoadFail(),children:()=>x("div",{class:_i.const("dcg-graph-loading"),children:[l("div",{class:_i.const("pulsing-message"),children:()=>this.props.s("account-shell-text-mygraphs-loading")}),l("div",{role:_i.const("link"),tabIndex:_i.const("0"),class:_i.const("dcg-cancel-while-loading"),onTap:this.props.onCancel,children:()=>this.props.s("account-shell-button-mygraphs-cancel")})]})}),l(H2,{predicate:()=>this.props.didDataLoadFail(),children:()=>x("div",{class:_i.const("dcg-graph-loading-error"),"aria-live":_i.const("assertive"),"aria-atomic":_i.const("true"),children:[l("div",{class:_i.const("dcg-graph-loading-error-title"),children:()=>this.props.s("account-shell-error-mygraphs-error-loading")}),l("div",{class:_i.const("dcg-graph-loading-error-subtitle"),children:()=>this.props.s("account-shell-error-mygraphs-check-connection")}),x("div",{class:_i.const("dcg-graph-loading-error-options"),children:[l("span",{role:_i.const("button"),tabIndex:_i.const("0"),class:_i.const("dcg-action-try-again dcg-btn-blue dcg-btn-medium"),onTap:this.props.requestLoadGraphData,children:()=>this.props.s("account-shell-button-mygraphs-try-again")}),l(H2,{predicate:()=>!!this.props.onCancel,children:()=>l("span",{children:()=>this.props.s("account-shell-text-mygraphs-or")})}),l(H2,{predicate:()=>!!this.props.onCancel,children:()=>l("span",{role:_i.const("button"),tabIndex:_i.const("0"),class:_i.const("dcg-action-cancel dcg-btn-light-gray dcg-btn-medium"),onTap:this.props.onCancel,children:()=>this.props.s("account-shell-button-mygraphs-cancel")})})]})]})})]})}};var{If:sTe}=Yn.Components,W2=class extends Yn.View{didMountGraphPreview(e){return this.graphPreview=e,this.updateGraphPreviewTop()}didMountArrow(e){return this.arrow=e,this.updateArrowTop()}didMountCalc(e){return this.previewCalc=this.props.makeAPI(e),this.updatePreviewCalc()}willUnmountCalc(){this.previewCalc&&this.previewCalc.destroy&&this.previewCalc.destroy()}didUpdate(){return this.updateGraphPreviewTop(),this.updateArrowTop(),this.updatePreviewCalc()}updateGraphPreviewTop(){this.graphPreview.style.top=this.getTopOffset()+"px"}updateArrowTop(){this.arrow.style.top=this.getArrowOffset()+"px"}updatePreviewCalc(){let e=this.props.getGraphData();e!==this.cachedGraphData&&(this.cachedGraphData=e,!this.props.disableApiPreview()&&(this.previewCalc.setState(e),this.previewCalc.resize()))}getMaxTop(){return window.innerHeight-this.graphPreview.offsetHeight-10}getIdealTop(){let e=this.props.alignToNode();return e==null?null:yo(e).top+.5*e.offsetHeight-60}getTopOffset(){let e=this.getIdealTop();if(e==null)return 0;let t=this.getMaxTop();return Math.min(e,t)}getArrowOffset(){let e=this.getIdealTop();if(e==null)return 60;let t=this.getTopOffset();return 60+e-t}template(){return x("div",{class:Yn.const("graph-preview"),didMount:this.bindFn(this.didMountGraphPreview),children:[x("div",{class:Yn.const("dcg-graph-preview-info"),children:[l("h4",{class:Yn.const("dcg-title"),children:this.props.getTitle}),l("span",{role:Yn.const("button"),tabIndex:Yn.const("0"),class:Yn.const("dcg-action-cancel"),onTap:this.props.onCancel,children:l("i",{class:Yn.const("dcg-icon-remove"),"aria-hidden":Yn.const("true")})})]}),x("div",{class:Yn.const("preview-graph-area"),children:[l(sTe,{predicate:()=>!this.props.getGraphData(),children:()=>l(uf,{didDataLoadFail:this.props.didDataLoadFail,onCancel:this.props.onCancel,requestLoadGraphData:this.props.requestLoadGraphData,s:this.props.s.bind(this.props)})}),l("div",{didMount:this.bindFn(this.didMountCalc),willUnmount:this.bindFn(this.willUnmountCalc),class:()=>({"dcg-preview-calculator":!0,"dcg-visible":this.props.getGraphData()})}),l("div",{class:()=>({"screenshot-clickjack":!0,"dcg-action-open-graph":!0,"dcg-visible":this.props.getGraphData()}),children:l("span",{role:Yn.const("button"),tabIndex:Yn.const("0"),class:Yn.const("dcg-action-open-graph dcg-open-graph-btn dcg-btn-blue"),onTap:this.props.onOpenGraph,children:this.props.getOpenText})})]}),l("div",{class:Yn.const("active-arrow"),didMount:this.bindFn(this.didMountArrow),children:l("div",{class:Yn.const("dcg-graphic")})})]})}};var Hy=__dcg_shared_module_exports__['e'](j()),Wy=class extends Hy.View{template(){return l("div",{class:Hy.const("dcg-mygraphs-section-title-container"),children:l("span",{role:Hy.const("heading"),"aria-level":Hy.const("1"),class:Hy.const("dcg-mygraphs-section-title"),children:()=>this.props.title()})})}};var Ho=__dcg_shared_module_exports__['e'](j());Ut();var{Input:lTe,If:j2}=Ho.Components,Bae=4,X2=class extends Ho.View{willUpdate(){this.props.isSearching()||this.setSearchValue("")}setSearchValue(e){this.searchValue!==e&&(this.searchValue=e,this.props.updateFilter(e))}init(){this.controller=this.props.controller(),this.searchValue=""}template(){return x("div",{class:Ho.const("dcg-user-bar"),didMount:e=>this.rootNode=e,children:[l(j2,{predicate:()=>!this.props.isSearching(),children:()=>x("div",{class:Ho.const("dcg-account-link-container"),children:[x("button",{class:Ho.const("dcg-unstyled-button dcg-account-link"),"dcg-menu-button":Ho.const("account-mygraphs"),"aria-haspopup":Ho.const("true"),"aria-expanded":()=>this.controller.getOpenMenu()==="account-mygraphs","aria-label":()=>this.props.s("account-shell-label-account-information"),onTap:e=>{var t;if(this.measureAccountDropdownArrowOffset(),this.props.controller().dispatch({type:"toggle-menu",payload:"account-mygraphs"}),e.device=="keyboard"){let i=this.props.controller().getOpenMenu()==="account-mygraphs"?".dcg-action-accountsettings":".dcg-account-link";(t=document.querySelector(i))==null||t.focus()}},children:[l("span",{class:Ho.const("dcg-variable-name"),children:()=>this.controller.userController.getFirstName()}),l("i",{class:Ho.const("dcg-icon-caret-down"),"aria-hidden":Ho.const("true")})]}),l(j2,{predicate:()=>this.controller.getOpenMenu()==="account-mygraphs",children:()=>l(sf,{type:this.const("account-mygraphs"),controller:this.const(this.controller),left:this.const(Bae),arrowLeft:this.const(this.accountDropdownArrowOffset-Bae)})})]})}),l(j2,{predicate:()=>!this.props.isSearching(),children:()=>x("div",{role:Ho.const("link"),tabIndex:Ho.const("0"),class:Ho.const("dcg-search-btn"),onTap:e=>{var t;e.preventDefault(),this.props.openSearch(),(t=document.querySelector(".search-container input"))==null||t.focus()},children:[l("i",{class:Ho.const("dcg-icon-search search-icon"),"aria-hidden":Ho.const("true")}),l("span",{class:Ho.const("dcg-menu-title"),children:()=>this.props.s("account-shell-heading-title-mygraphs-search")})]})}),l(j2,{predicate:()=>this.props.isSearching(),children:()=>x("div",{role:Ho.const("search"),class:Ho.const("search-container search-open"),children:[l("i",{class:Ho.const("dcg-icon-search search-icon"),"aria-hidden":Ho.const("true")}),l(lTe,{placeholder:()=>this.props.s("account-shell-text-mygraphs-search-by-title"),onInput:this.bindFn(this.setSearchValue),onFocus:this.props.openSearch,value:()=>this.searchValue,didMount:this.bindFn(this.didMountSearch)}),l("span",{role:Ho.const("button"),tabIndex:Ho.const(0),"aria-label":()=>this.props.s("account-shell-heading-title-mygraphs-search"),class:Ho.const("dcg-icon-remove dcg-action-close-search"),onTap:e=>{e.preventDefault(),this.props.closeSearch()}})]})})]})}didMountSearch(e){re(e).on("blur",()=>{e.value||this.props.closeSearch()})}measureAccountDropdownArrowOffset(){var a,s;let e=this.rootNode.querySelector(".dcg-account-link i"),t=e&&yo(e),o=(a=t==null?void 0:t.left)!=null?a:0,i=(s=e==null?void 0:e.getBoundingClientRect().width)!=null?s:0,n=o+i/2;this.accountDropdownArrowOffset=n}};var{If:Bn,For:i6,IfElse:Kae}=Ct.Components,n6="default",eg="search",cTe=50,$2=class extends Ct.View{constructor(){super(...arguments),this.state="default"}didUpdate(){if(this.previewGraph){let e=this.getSelectedNode();e&&bl(e,this.scrollableNode,60)&&this.update()}}didMountScrollable(e){this.scrollableNode=e,re(this.scrollableNode).on("focusin",o=>{if(this.previewGraph&&!o.target.classList.contains("graph-link"))return this.previewItem(void 0)}),re(window).on("keydown",o=>{if(!this.props.isOpen())return!0;switch(Pe(o)){case Tn:return this.selectUp(o);case Mi:return this.selectDown(o)}});let t=__dcg_shared_module_exports__['Za'](this.hidePreviewIfTooScrolled.bind(this),200);re(this.scrollableNode).on("scroll",t),this.debouncedFetchSelectedGraph=__dcg_shared_module_exports__['_a'](this.fetchSelectedGraph.bind(this),200)}fetchSelectedGraph(){return this.props.graphsController().loadDataForGraph(this.previewGraph)}hidePreviewIfTooScrolled(){if(!this.previewGraph)return;let e=this.getSelectedNode();if(!e)return;let t=this.rootNode.querySelector(".active-arrow")||void 0,o=yo(e),i=e.getBoundingClientRect().height,n=yo(t);if(o===void 0||i===void 0||n===void 0)return;let a=o.top+.5*i,s=n.top;Math.abs(a-s)>10&&this.previewItem(void 0)}openSearch(){this.state=eg,this.previewItem(void 0)}closeSearch(){this.state=n6,this.previewItem(void 0)}updateFilter(e){this.filter=e,this.update()}getMaxGraphs(){return this.maxGraphs||cTe}getCountRemaining(){return this.getSavedGraphs().length-this.getMaxGraphs()}showMoreGraphs(e){let t=this.getMaxGraphs();if(this.getCountRemaining()<2*t?this.maxGraphs=1/0:this.maxGraphs=2*t,this.update(),(e!=null?e.device:void 0)==="keyboard"){let o=this.getSavedAndExampleGraphs(),i=o?o[t]:void 0;i&&this.previewItem(i)}}getSelectedNode(){return document.querySelector(".dcg-mygraphs .graph-link-container.dcg-selected")}selectUp(e){if(!this.previewGraph)return;e.preventDefault();let t=this.getSavedAndExampleGraphs();if(!t.length)return;let o=this.previewGraph?this.previewGraph.hash:void 0,i=t.findIndex(a=>a.hash===o),n=i>-1&&t?t[i-1]:void 0;n?n&&this.previewItem(n):this.newGraph&&re(this.newGraph).trigger("focus")}selectDown(e){if(!this.previewGraph)return;let t=this.getSavedAndExampleGraphs();if(!t.length)return;e.preventDefault();let o=this.previewGraph?this.previewGraph.hash:void 0,i=t.findIndex(a=>a.hash===o),n=i>-1&&t?t[i+1]:void 0;n&&(!n.exampleData.example&&i+1>=this.getMaxGraphs()&&this.showMoreGraphs(),this.previewItem(n))}getFilter(){return this.state===eg&&this.filter?this.filter:""}getRecoveryGraphs(){return this.props.graphsController().getRecoveryGraphs()}dispatchGraphsAction(e){this.controller.dispatch({type:"update-graphs-state",update:e})}attemptRecovery(){this.dispatchGraphsAction({type:"fetch-recovery-graphs-legacy"})}hasAttemptedRecovery(){return this.controller.mygraphsController.hasAttemptedRecovery()&&!this.isAttemptingRecovery()}isAttemptingRecovery(){return this.controller.graphsController.isFetchingRecoveryGraphs()}shouldShowAttemptRecoveryText(){return this.graphsController.isRecoveryUIEnabledForProduct()?!this.hasAttemptedRecovery():!1}hasFetchedSavedGraphs(){return this.props.graphsController().millisecondsSinceSync()!==1/0}getSavedGraphs(){return this.props.graphsController().getSavedGraphs()}getExampleGraphs(){return this.props.graphsController().getExampleGraphs()}getSavedAndExampleGraphs(){return this.props.graphsController().getSavedAndExampleGraphs()}filterGraphs(e){let t=this.getFilter().toLowerCase();return t?e.filter(o=>o.getVisibleTitle(this.controller.s).toLowerCase().indexOf(t)>=0):e}sliceGraphs(e){return e.slice(0,this.getMaxGraphs())}canShowMore(e){return e.length>this.getMaxGraphs()}onFocusGraph(e){this.isSmallScreen()||this.previewItem(e)}onTapGraph(e,t){this.isSmallScreen()||t.device==="keyboard"?this.openGraphWithCover(e):this.previewGraph!==e&&this.previewItem(e)}previewItem(e){this.previewGraph&&(this.previewGraph=void 0),e&&(this.previewGraph=e,this.debouncedFetchSelectedGraph()),this.update()}isSmallScreen(){let e=window.platform;return document.body.getBoundingClientRect().width<650||document.body.getBoundingClientRect().height<=450||e==="ios"||e==="android"}onOpenPreviewGraph(){if(!this.previewGraph)return;let{previewGraph:e}=this;this.previewItem(void 0),this.props.onOpenGraph(e)}openGraphWithCover(e){if(this.graphWithCover=e,this.previewItem(void 0),e!==void 0)return setTimeout(async()=>{try{if(await this.props.graphsController().loadDataForGraphImmediately(e),!this.graphWithCover)return;this.props.openGraphBehindCover(e).then(this.bindIfMounted(()=>{this.graphWithCover=void 0,this.update()}))}catch(t){}this._isMounted&&this.update()},250)}cancelLoadGraphWithCover(){this.graphWithCover=void 0,this.update()}didDataLoadFail(e){return e?this.props.graphsController().didDataLoadFail(e):!1}willUpdate(){(!this.props.isOpen()||!this.controller.userController.isLoggedIn())&&(this.state=n6)}didMountNewGraph(e){return this.newGraph=e,re(this.newGraph).on("keydown",t=>{if(Pe(t)!==Mi)return;let o=this.getSavedAndExampleGraphs();return this.previewItem(o[0]),t.preventDefault(),t.stopPropagation()})}async hideGraphsAndShowArtContest(){if(this.props.closeDrawer(),this.isSmallScreen())try{let e=this.controller.getProduct(),o=(await cf({year:Hs,product:e})).filter(i=>!(i!=null&&i.submitting_for_someone_else));this.props.controller().dispatch({type:"show-modal",modal:"contest-submission",currentSubmission:o[0]})}catch(e){this.controller.api.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("frontpage-error-something-went-wrong-try-again-later")}})}else this.props.controller().dispatch({type:"toggle-menu",payload:"art-contest"})}init(){this.state=n6,this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}template(){return x("div",{class:()=>({"dcg-mygraphs":!0,"logged-in":this.controller.userController.isLoggedIn()}),didMount:e=>this.rootNode=e,children:[x("div",{class:Ct.const("dcg-resources-container"),children:[l(Bn,{predicate:()=>this.props.accountsEnabled()&&!this.controller.userController.isLoggedIn(),children:()=>l(q2,{onCreateAccount:this.props.onCreateAccount,onSignIn:this.props.onSignIn,controller:this.props.controller})}),l(Bn,{predicate:()=>this.controller.userController.isLoggedIn(),children:()=>l("div",{children:l(X2,{controller:this.props.controller,openSearch:this.bindFn(this.openSearch),closeSearch:this.bindFn(this.closeSearch),updateFilter:this.bindFn(this.updateFilter),isSearching:()=>this.state===eg,s:this.controller.s})})}),l("div",{class:Ct.const("dcg-scrollable"),didMount:this.bindFn(this.didMountScrollable),children:x("div",{class:Ct.const("dcg-scrollable-interior"),children:[l(Bn,{predicate:()=>this.state!==eg,children:()=>l("div",{role:Ct.const("link"),tabIndex:Ct.const("0"),class:Ct.const("new-blank-graph dcg-action-newblankgraph"),onTap:()=>(this.previewItem(void 0),this.props.openBlankGraph()),didMount:this.bindFn(this.didMountNewGraph),children:x("div",{class:Ct.const("new-blank-graph-inner"),children:[l("span",{class:Ct.const("dcg-add-blank"),children:l("i",{class:Ct.const("dcg-icon-plus"),"aria-hidden":Ct.const("true")})}),l("span",{class:Ct.const("dcg-new-graph-title"),children:this.bindFn(this.getNewTitleText)})]})})}),l(Bn,{predicate:()=>this.state!==eg&&this.controller.shouldShowArtContestNudge(),children:()=>x("button",{onTap:this.bindFn(this.hideGraphsAndShowArtContest),class:Ct.const("dcg-sidebar-contest-submit"),children:[l("i",{class:Ct.const("dcg-icon-sparkle"),"aria-hidden":Ct.const("true")})," ",l(Ot,{i18n:this.const(this.controller),children:x("span",{class:Ct.const("dcg-contest-submit-message"),children:["Submit this graph to the ",l("b",{children:"Art Expo"}),"!"]})},this.const("account-shell-text-mygraphs-contest-submit-to-contest"))]})}),l(Bn,{predicate:()=>this.controller.userController.isLoggedIn()&&this.state!==eg,children:()=>x("div",{children:[l(Wy,{title:this.bindFn(this.getCurrentText)}),l(yS,{getTitle:()=>this.getPreviewTitle(),getDisplayDate:()=>this.controller.unpack(this.props.graphsController().getCurrentDisplayDate()),isOpen:this.props.isOpen,getThumbnail:this.props.getThumbnail,isSaveEnabled:this.props.isSaveEnabled,simpleSave:()=>(this.props.simpleSave(),this.previewItem(void 0)),openSaveDialog:()=>(this.props.openSaveDialog(),this.previewItem(void 0)),wasCurrentGraphEverSaved:()=>this.props.graphsController().wasCurrentGraphEverSaved(),isSaving:()=>this.graphsController.isSaving(),didSaveRecentlySucceed:()=>this.graphsController.showSaveSuccessNotice(),didSaveRecentlyFail:()=>this.graphsController.showSaveFailNotice(),isSyncing:()=>this.props.graphsController().isSyncing(),willSaveCopy:()=>this.props.graphsController().willSaveCopy(),s:this.controller.s}),l(Bn,{predicate:this.bindFn(this.shouldShowAttemptRecoveryText),children:()=>l("div",{class:Ct.const("dcg-lost-work-link"),children:Kae(()=>this.isAttemptingRecovery(),{true:()=>x("span",{children:[l("span",{children:()=>this.controller.s("account-shell-text-mygraphs-attempting-recovery")}),l("span",{class:Ct.const("dcg-spinner-dark")})]}),false:()=>x("span",{children:[l("span",{children:()=>this.controller.s("account-shell-text-mygraphs-lost-work")+" "}),l("span",{tabIndex:Ct.const("0"),role:Ct.const("link"),class:Ct.const("dcg-attempt-recovery"),onTap:this.bindFn(this.attemptRecovery),children:()=>this.controller.s("account-shell-button-mygraphs-attempt-recovery")})]})})})})]})}),l(Bn,{predicate:()=>this.controller.userController.isLoggedIn()&&this.hasAttemptedRecovery()&&this.state!==eg&&this.controller.graphsController.didFetchRecoveryGraphsFail(),children:()=>l("div",{class:Ct.const("no-matches"),"aria-live":Ct.const("assertive"),"aria-atomic":Ct.const("true"),children:()=>this.controller.s("account-shell-error-unknown")})}),l(Bn,{predicate:()=>this.controller.userController.isLoggedIn()&&this.hasAttemptedRecovery()&&this.state!==eg&&!this.controller.graphsController.didFetchRecoveryGraphsFail(),children:()=>l("div",{children:Kae(()=>this.getRecoveryGraphs().length>0,{true:()=>x("div",{class:Ct.const("dcg-recovery-graphs-list"),children:[l(Wy,{title:()=>this.controller.s("account-shell-heading-mygraphs-recovered-work")}),l("div",{role:Ct.const("list"),children:l(i6,{each:()=>this.getRecoveryGraphs(),children:e=>l(CS,{onTap:t=>this.onTapGraph(e,t),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>this.dispatchGraphsAction({type:"cancel-delete-graph",graph:e}),requestDeleteGraph:()=>{this.previewItem(void 0),this.dispatchGraphsAction({type:"request-delete-graph",graph:e})},isDeletingGraph:()=>this.props.graphsController().isDeletingGraph(e),canCancelDelete:()=>this.props.graphsController().canCancelDelete(e),didDeleteGraphFail:()=>this.props.graphsController().didDeleteGraphFail(e),isSelected:()=>e===this.previewGraph,isExample:Ct.const(!1),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>e.getVisibleTitle(this.controller.s),getThumbURL:()=>e.thumbUrl,controller:()=>this.controller})},e=>e.getCollectionKey())})]}),false:()=>l("div",{class:Ct.const("dcg-no-recovery-graphs"),children:this.bindFn(this.getNoUnsavedText)})})})}),l(Bn,{predicate:()=>this.controller.userController.isLoggedIn(),children:()=>l(Wy,{title:this.bindFn(this.getSavedTitle)})}),l("div",{class:Ct.const("dcg-saved-graphs-list"),role:Ct.const("list"),children:l(i6,{each:()=>this.sliceGraphs(this.filterGraphs(this.getSavedGraphs())),children:e=>l(CS,{onTap:t=>this.onTapGraph(e,t),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>this.dispatchGraphsAction({type:"cancel-delete-graph",graph:e}),requestDeleteGraph:()=>{this.previewItem(void 0),this.dispatchGraphsAction({type:"request-delete-graph",graph:e})},isDeletingGraph:()=>this.props.graphsController().isDeletingGraph(e),canCancelDelete:()=>this.props.graphsController().canCancelDelete(e),didDeleteGraphFail:()=>this.props.graphsController().didDeleteGraphFail(e),isSelected:()=>e===this.previewGraph,isExample:Ct.const(!1),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>e.getVisibleTitle(this.controller.s),getThumbURL:()=>e.thumbUrl,controller:()=>this.controller})},e=>e.getCollectionKey())}),l(Bn,{predicate:()=>this.controller.userController.isLoggedIn()&&this.controller.graphsController.didSyncFail(),children:()=>l("div",{"aria-live":Ct.const("assertive"),"aria-atomic":Ct.const("true"),class:Ct.const("no-matches"),children:()=>this.controller.s("account-shell-error-unknown")})}),l(Bn,{predicate:()=>this.controller.userController.isLoggedIn()&&!this.controller.graphsController.didSyncFail()&&this.hasFetchedSavedGraphs()&&this.filterGraphs(this.getSavedGraphs()).length===0,children:()=>l("div",{"aria-live":Ct.const("assertive"),"aria-atomic":Ct.const("true"),class:Ct.const("no-matches"),children:this.bindFn(this.getNoMatchesText)})}),l(Bn,{predicate:()=>this.controller.userController.isLoggedIn()&&!this.controller.graphsController.didSyncFail()&&!this.hasFetchedSavedGraphs(),children:()=>x("span",{class:Ct.const("dcg-loading-message"),children:[l("span",{class:Ct.const("dcg-spinner-dark")}),()=>this.controller.s("account-shell-label-loading")]})}),l(Bn,{predicate:()=>this.canShowMore(this.filterGraphs(this.getSavedGraphs())),children:()=>l("div",{class:Ct.const("dcg-show-more-graphs"),onTap:this.bindFn(this.showMoreGraphs),role:Ct.const("button"),tabIndex:Ct.const("0"),children:()=>this.controller.s("account-shell-text-mygraphs-count-more",{count:this.getCountRemaining()})})}),l(Bn,{predicate:()=>this.getExampleGraphs().length>0,children:()=>l(Wy,{title:()=>this.controller.s("account-shell-heading-mygraphs-examples")})}),l("div",{role:Ct.const("list"),children:l(i6,{each:()=>this.filterGraphs(this.getExampleGraphs()),children:e=>l(CS,{onTap:t=>this.onTapGraph(e,t),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>{},requestDeleteGraph:()=>{},isDeletingGraph:Ct.const(!1),didDeleteGraphFail:Ct.const(!1),canCancelDelete:Ct.const(!1),isSelected:()=>e===this.previewGraph,isExample:Ct.const(!0),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>e.getVisibleTitle(this.controller.s),getThumbURL:()=>e.thumbUrl,controller:()=>this.controller})},e=>e.getCollectionKey())}),l(Bn,{predicate:()=>this.getFilter()?this.filterGraphs(this.getExampleGraphs()).length===0:!1,children:()=>l("div",{"aria-live":Ct.const("assertive"),"aria-atomic":Ct.const("true"),class:Ct.const("no-matches"),children:()=>this.controller.s("account-shell-text-mygraphs-no-examples-match-search")})}),x("div",{class:Ct.const("dcg-mygraphs-legal"),children:[l("a",{href:Ct.const("/terms"),target:Ct.const("_blank"),children:()=>this.controller.s("account-shell-link-terms")}),"|",l("a",{href:Ct.const("/privacy"),target:Ct.const("_blank"),children:()=>this.controller.s("account-shell-link-privacy")}),l(Bn,{predicate:()=>!!this.props.versionNumber(),children:()=>x("div",{class:Ct.const("dcg-version"),children:[()=>this.controller.s("account-shell-text-mygraphs-version")," ",this.props.versionNumber]})})]})]})}),l(Bn,{predicate:()=>!!this.previewGraph,children:()=>l(W2,{alignToNode:()=>this.getSelectedNode(),getTitle:()=>{var e,t;return(t=(e=this.previewGraph)==null?void 0:e.getVisibleTitle(this.controller.s))!=null?t:""},getGraphData:()=>this.previewGraph?this.previewGraph.graphData:void 0,onCancel:()=>this.previewItem(void 0),didDataLoadFail:()=>this.didDataLoadFail(this.previewGraph),requestLoadGraphData:this.bindFn(this.fetchSelectedGraph),onOpenGraph:this.bindFn(this.onOpenPreviewGraph),s:this.controller.s,makeAPI:this.props.makeAPI,getOpenText:()=>this.controller.getOpenText(),disableApiPreview:()=>this.controller.showSavedGraphsRedesign()})})]}),l(Bn,{predicate:this.props.isOpen,children:()=>l("div",{role:Ct.const("link"),tabIndex:Ct.const("0"),class:Ct.const("dcg-resources-cover dcg-action-close-resources"),style:()=>({opacity:this.previewGraph?"0.6":"0"}),onTap:()=>this.previewGraph?this.previewItem(void 0):this.props.closeDrawer(),"aria-label":()=>this.previewGraph?this.controller.s("account-shell-button-mygraphs-close-graph-preview"):this.controller.s("account-shell-button-mygraphs-close-graph-list")})}),l(Bn,{predicate:()=>!!this.graphWithCover,children:()=>l("div",{class:Ct.const("dcg-fullscreen-loading-container"),children:l(uf,{didDataLoadFail:()=>this.didDataLoadFail(this.graphWithCover),onCancel:this.bindFn(this.cancelLoadGraphWithCover),requestLoadGraphData:()=>this.openGraphWithCover(this.graphWithCover),s:this.controller.s})})})]})}getNewTitleText(){return this.graphsController.isGeometryTool()?this.controller.s("account-shell-text-mygraphs-new-construction"):this.controller.s("account-shell-text-mygraphs-new-blank-graph")}getCurrentText(){return this.graphsController.isGeometryTool()?this.controller.s("account-shell-text-mygraphs-current-construction"):this.controller.s("account-shell-text-mygraphs-current-graph")}getNoUnsavedText(){return this.graphsController.isGeometryTool()?this.controller.s("account-shell-text-mygraphs-no-unsaved-constructions"):this.controller.s("account-shell-text-mygraphs-no-unsaved-graphs")}getSavedTitle(){return this.graphsController.isGeometryTool()?this.controller.s("account-shell-heading-mygraphs-saved-constructions"):this.controller.s("account-shell-heading-mygraphs-saved-graphs")}getNoMatchesText(){return this.state===eg?this.graphsController.isGeometryTool()?this.controller.s("account-shell-text-mygraphs-no-construction-search-results"):this.controller.s("account-shell-text-mygraphs-no-graph-search-results"):this.graphsController.isGeometryTool()?this.controller.s("account-shell-text-mygraphs-no-saved-constructions"):this.controller.s("account-shell-text-mygraphs-no-saved-graphs")}getPreviewTitle(){return this.graphsController.getCurrentGraphTitle()}};var J2=class extends zae.View{makeAPI(e){let t=this.controller.api._calc.controller.getGraphSettings().cloneConfig();return this.props.makeAPI(e,t)}init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.mygraphsController=this.controller.mygraphsController}template(){return l($2,{isOpen:()=>this.mygraphsController.isMygraphsOpen(),graphsController:()=>this.graphsController,accountsEnabled:this.const(!0),controller:()=>this.controller,closeDrawer:()=>this.controller.dispatch({type:"close-mygraphs"}),openBlankGraph:()=>this.controller.dispatch({type:"open-blank-graph-sidebar"}),onOpenGraph:e=>this.controller.onOpenGraphFromSidebar(e),openGraphBehindCover:e=>this.mygraphsController.openGraphBehindCover(e),onLogout:()=>this.controller.userController.logout(),onEditAccount:()=>this.controller.dispatch({type:"show-modal",modal:"account-settings"}),onCreateAccount:()=>this.controller.dispatch({type:"show-modal",modal:"authentication",fromButton:"sign-up"}),onSignIn:()=>this.controller.dispatch({type:"show-modal",modal:"authentication",fromButton:"log-in"}),getThumbnail:()=>this.mygraphsController.getThumbnail(),simpleSave:()=>this.controller.simpleSave(),openSaveDialog:()=>this.controller.openSaveDialog({fromSaveInProgress:!0}),versionNumber:()=>zy.versionNumber,isSaveEnabled:()=>this.controller.isSaveEnabled(),makeAPI:this.bindFn(this.makeAPI)})}};var bO=__dcg_shared_module_exports__['e'](j());var a6={};var tO=__dcg_shared_module_exports__['e'](j());function Z2(r,e){return __dcg_shared_module_exports__['q'](1/__dcg_shared_module_exports__['Je'](__dcg_shared_module_exports__['Ie'](r)),0,e)}function dTe(r,e,t,o,i,n){return Z2([[r,e,1],[t,o,1],[i,n,1]])}function pTe(r,e,t,o,i,n,a,s){return Z2([[r*r+e*e,r,e,1],[t*t+o*o,t,o,1],[i*i+n*n,i,n,1],[a*a+s*s,a,s,1]])}function uTe(r,e,t,o,i,n,a,s,c,d,p,u){return Z2([[r*r,e*e,2*r*e,r,e,1],[t*t,o*o,2*t*o,t,o,1],[i*i,n*n,2*i*n,i,n,1],[a*a,s*s,2*a*s,a,s,1],[c*c,d*d,2*c*d,c,d,1],[p*p,u*u,2*p*u,p,u,1]])}function hTe(r,e,t,o,i,n,a,s,c,d){return{a:__dcg_shared_module_exports__['He'].det([[e*e,2*r*e,r,e,1],[o*o,2*t*o,t,o,1],[n*n,2*i*n,i,n,1],[s*s,2*a*s,a,s,1],[d*d,2*c*d,c,d,1]]),b:__dcg_shared_module_exports__['He'].det([[r*r,e*e,r,e,1],[t*t,o*o,t,o,1],[i*i,n*n,i,n,1],[a*a,s*s,a,s,1],[c*c,d*d,c,d,1]]),c:-__dcg_shared_module_exports__['He'].det([[r*r,2*r*e,r,e,1],[t*t,2*t*o,t,o,1],[i*i,2*i*n,i,n,1],[a*a,2*a*s,a,s,1],[c*c,2*c*d,c,d,1]])}}function gTe(r,e,t,o,i,n,a,s,c,d,p,u){if(dTe(r,e,i,n,p,u))return"line";if(pTe(r,e,t,o,c,d,p,u))return"circle";if(!uTe(r,e,t,o,i,n,a,s,c,d,p,u))return"none";let g=hTe(r,e,t,o,i,n,a,s,c,d);return Z2([[g.a,g.b],[g.b,g.c]],20)?"parabola":g.b*g.b>g.a*g.c?"hyperbola":"ellipse"}function qae(r){let e,t;if(r.length===1&&r[0].length===4)return"line";for(let o of r){let i=o.length;if(i<12)return"unknown";if(t=gTe(o[0],o[1],o[2*Math.floor(1*i/12)],o[2*Math.floor(1*i/12)+1],o[2*Math.floor(2*i/12)],o[2*Math.floor(2*i/12)+1],o[2*Math.floor(3*i/12)],o[2*Math.floor(3*i/12)+1],o[2*Math.floor(4*i/12)],o[2*Math.floor(4*i/12)+1],o[i-2],o[i-1]),t==="none"||e&&t!==e)return"none";e=t}return e}function Q2(r){return Mn(r)&&r.type==="expression"}function TS(r,e){return Mn(r)&&r.type==="expression"?!0:r.type==="expression"&&vs(r)}function Hae(r){return qae(r)}function jy(r,e){return r.type==="expression"}function Wae(r,e){return r.type==="expression"&&eh(r)}function s6(r,e){return r.type==="expression"&&!!r.error&&!vs(r)}function l6(r){return function(e,t){return e.type==="expression"&&e.formula&&e.formula.variables&&e.formula.variables.length>=r}}function jae(r){return function(e,t){var i;if(e.type!=="table")return!1;let o=(i=e.formula)==null?void 0:i.column_data[1].values;return!!o&&o.length>=r}}function fTe(r){var t;if(r.type!=="expression"||!r.formula||!r.formula.typed_constant_value)return!1;let e=(t=r.formula.typed_constant_value)==null?void 0:t.value;return typeof e=="number"&&isFinite(e)}function c6(r,e){return!!e&&Hae(e.branches[0].segments)==="line"&&!fTe(r)}function d6(r,e){return c6(r,e)&&u6(r,e)}function p6(r,e){return jy(r,e)&&!d6(r,e)}function ET(r,e){return!!e&&e.branches&&e.branches.some(t=>Hae(t.segments)==="parabola")}function u6(r,e){return!r||r.type!=="expression"||!r.latex?!1:!!r.latex.match(/\\left\\{(.+)\\right\\}/)}function Xae(r,e){return!r||r.type!=="expression"||!r.latex?!1:!!r.latex.match(/\\left\\{x(.+)\\right\\}/)}function $ae(r,e){return!r||r.type!=="expression"||!r.latex?!1:!!r.latex.match(/\\left\\{y(.+)\\right\\}/)}function Jae(r,e){if(!ET(r,e)||!e)return!1;let t=e.branches[0].compiled.fn;return t(0)!==0||t(1)!==1}function Zae(r,e){return r.type==="expression"&&r.formula.assignment==="y"}function IT(r){return(e,t)=>e.type==="expression"&&$x(e.latex,r).length>0}var a2t=IT("x");function Bd(r,e){return r.type==="expression"&&!!r.sliderExists&&!eh(r)}function Qae(r,e){return r.type==="expression"&&!!r.sliderExists&&r.slider.isPlaying}function MT(r,e){return r.type==="expression"&&!!r.sliderExists&&!eh(r)&&Qs(r)!==1}function eO(r,e){return r.type==="table"}function hf(r,e){return r.type==="expression"&&!!r.formula&&!!r.formula.regression}function tg(r,e){if(r.type!=="table")return!1;for(let t=1;t<r.columnModels.length-1;t++)if(!r.columnModels[t].computed)return!0;return!1}var rc=__dcg_shared_module_exports__['e'](j());var{IfDefined:yTe,For:xTe,Switch:vTe}=rc.Components;function g6(r,e){if(!r||!e||r.innerHTML!==e.innerHTML)return!1;let t=Array.isArray(r.content);return t!==Array.isArray(e.content)||t&&__dcg_shared_module_exports__['Va'](r.content,e.content).length>0?!1:!(!t&&r.content!==e.content)}var h6=class extends rc.View{setInnerHtml(){let e=this.props.innerHTML();if(e){let t=document.getElementById("dcg-trip-content--inner");t&&(t.innerHTML=e),this.rootNode.querySelectorAll(".dcg-trip-math:not(.dcg-mq-math-mode)").forEach(o=>{Pl.StaticMath(o)})}}didMountRoot(e){this.rootNode=e,this.setInnerHtml()}didUpdate(){this.setInnerHtml()}template(){return l("div",{id:rc.const("dcg-trip-content--inner"),didMount:this.bindFn(this.didMountRoot)})}},ES=class extends rc.View{init(){this.controller=this.props.controller()}getTargetElement(){var t;let e=this.props.target();if("element"in e)return e.element!==null&&e.element?e.element:void 0;if("selector"in e){let o=(t=this.controller.getRootElt())==null?void 0:t.querySelector(e.selector);return o!==null&&o?o:void 0}else return}getTargetPosition(){let e=this.props.target(),t=this.getTargetElement(),o="getCanvasPos"in e&&e.getCanvasPos();if(t){let i=yo(t);return t.closest("#graph-container")&&(i.top-=yo(this.controller.getRootElt()).top),{top:i.top,left:i.left,width:t.clientWidth,height:t.clientHeight}}else return o?(o.top-=yo(this.controller.getRootElt()).top,{...o,width:0,height:0}):this.cachedTargetPos}getFallbackPosition(){var o;let e=(o=this.controller.getRootElt())==null?void 0:o.querySelector(".dcg-exppanel-outer");if(!e)return;let t=yo(e);return e.closest("#graph-container")&&(t.top-=yo(this.controller.getRootElt()).top),{top:t.top,left:t.left,width:e.clientWidth,height:e.clientHeight}}withinTolerance(e,t){return Math.abs(e.height-t.height)<=30&&Math.abs(e.width-t.width)<=30&&Math.abs(e.top-t.top)<=30&&Math.abs(e.left-t.left)<=30}updatePosition(){var g,h,b;if(this.isSameStep()&&((g=this.props.target())==null?void 0:g.updatePosition)==="never")return;let e=this.rootNode,t=this.getTargetPosition();if(!e||!this.props.position||!t||!("getCanvasPos"in this.props.target())&&t.width===0&&t.height===0||this.isSameStep()&&((h=this.props.target())==null?void 0:h.updatePosition)!=="always"&&this.cachedTargetPos&&this.withinTolerance(t,this.cachedTargetPos))return;let o=e.offsetWidth||0,i=e.offsetHeight||0,n=10,a=10,s=window.innerWidth||0,c=0,d=t.left+(t.width-o)/2,p=t.top-n-i;switch(this.props.position()){case"e":d=t.left+t.width+a,p=t.top-(i-t.height)/2;break;case"s":d=t.left+(t.width-o)/2,p=t.top+t.height+n,d+o>s-1&&(c=s-1-d-o),d<1&&(c=1-d);break;case"n":d=t.left+(t.width-o)/2,p=t.top-t.height-n-i,d+o>s-1&&(c=s-1-d-o),d<1&&(c=1-d);break;case"w":d=t.left-(a+o),p=t.top-(i-t.height)/2;break}Yo(e,{left:`${d}px`,top:`${p}px`});let u=e.querySelector(".dcg-trip-interior");u&&(u.style.transform="translate("+c+"px, 0)"),this.cachedBlock={target:this.props.target(),innerHTML:this.props.innerHTML(),header:this.props.header(),content:this.props.content()},this.cachedRootEltTop=(b=yo(this.controller.getRootElt()))==null?void 0:b.top,this.cachedTargetPos=t}onMount(){this.clockBusId=Ql(()=>this.updatePosition()),this.updatePosition()}willUnmount(){this.clockBusId&&Vs(this.clockBusId)}didUpdate(){this.updatePosition()}getClasses(){var e,t;return{"dcg-tour-step":!0,[`dcg-tour-step-${this.props.position()}`]:!0,"dcg-tour-step--update-always":((t=(e=this.props).target)==null?void 0:t.call(e).updatePosition)==="always"}}getContent(){let e=this.props.content();return Array.isArray(e)?e:e?[e]:[]}isSameStep(){var o,i;let e=this.props.target(),t=(o=this.cachedBlock)==null?void 0:o.target;return!t||!e||((i=yo(this.controller.getRootElt()))==null?void 0:i.top)!==this.cachedRootEltTop||"selector"in e&&"selector"in t&&(t==null?void 0:t.selector)!==e.selector||"element"in e&&"element"in t&&(t==null?void 0:t.element)!==e.element||"selector"in e&&"element"in t||"element"in e&&"selector"in t?!1:g6(this.cachedBlock,{target:e,innerHTML:this.props.innerHTML(),header:this.props.header(),content:this.props.content()})}template(){return x("div",{class:()=>this.getClasses(),didMount:e=>this.rootNode=e,children:[x("div",{class:rc.const("dcg-trip-interior"),children:[l("a",{class:rc.const("dcg-trip-close"),onTap:()=>this.props.tourController().stopTour({reason:"exit"}),"aria-label":()=>this.controller.s("graphing-tours-label-close-tour"),children:"\xD7"}),x("div",{class:rc.const("dcg-trip-content dcg-text-selectable"),"aria-live":rc.const("polite"),children:[yTe(()=>this.props.header(),e=>l("h2",{children:e})),l("div",{children:l(xTe,{each:this.bindFn(this.getContent),children:e=>l("div",{class:rc.const("dcg-trip-content-sentence"),children:()=>e})})}),l(vTe,{children:e=>e?l(h6,{innerHTML:()=>e}):l("div",{})},()=>this.props.innerHTML())]})]}),l("div",{class:rc.const("dcg-trip-arrow")})]})}};var{IfDefined:wTe}=tO.Components,STe=5e3,kTe=500,DT=class{constructor(e){this.getController=e}getState(){return this.getController().getState()}expressionCount(){return this.getController().getItemCount()}getExpSketch(e){return this.getExpSketchById(e.id)}getExpSketchById(e){var t;if(e)return(t=this.getController().getGrapher())==null?void 0:t.graphSketches[e]}getAvailableExp(e){let t=this.getMatchingExpNode(TS,e);return t||document.querySelector(".dcg-new-math-div")}getExpressionNodeById(e){if(e)return this.getController().getItemNodeById(e)}getModelById(e){if(e)return this.getController().getItemModel(e)}expMatches(e,t){return e?typeof t=="function"?this.safeCall(t,e,this.getExpSketch(e)):t.every(o=>this.safeCall(o,e,this.getExpSketch(e))):!1}safeCall(e,t,o){return"is3d"in e&&e.is3d?o instanceof iw?e.call(null,t,o):e.call(null,t,void 0):o instanceof gw?e.call(null,t,o):e.call(null,t,void 0)}getMatchingExpIds(e,t=[]){return this.getController().getAllItemModels().filter(o=>t.indexOf(o.id)===-1&&xI(o)!=="none"&&this.expMatches(o,e)).map(o=>o.id)}getMatchingExpId(e,t=[]){let o=this.getMatchingExpIds(e,t);if(o.length===0)return;let i=this.getController().getSelectedItem();return i&&o.indexOf(i.id)>=0?i.id:o[0]}hasMatchingExpression(e,t=[]){return this.getMatchingExpIds(e,t).length>0}getMatchingExpNode(e,t){let o=this.getMatchingExpId(e,t);return this.getExpressionNodeById(o)}getMatchingExpModel(e,t){let o=this.getMatchingExpId(e,t);return o?this.getModelById(o):void 0}getMatchingExpModels(e,t){return this.getMatchingExpIds(e,t).map(i=>this.getModelById(i)).filter(i=>i&&i.type==="expression")}getUniqueSliceValues(e){let t=e==="x"?0:e==="y"?1:2,o=this.getMatchingExpIds([]),i=[];for(let n of o){let a=this.getExpSketchById(n);a==null||a.branches.forEach(s=>{if(s.graphMode!==100&&s.graphMode!==128)return;let c=s.points[t];i.indexOf(c)===-1&&s.points.every((d,p)=>p%3!==t||Math.abs(d-c)<=1e-4||isNaN(d))&&i.push(c)})}return i}},AT=class extends tO.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.tourController=this.props.tourController(),this.s=this.controller.s,this.raw=this.controller.raw,this.validator=new DT(()=>this.controller),this.expressionCount=()=>this.validator.expressionCount(),this.getAvailableExp=e=>this.validator.getAvailableExp(e),this.getExpressionNodeById=e=>this.validator.getExpressionNodeById(e),this.getModelById=e=>this.validator.getModelById(e),this.expMatches=(e,t)=>this.validator.expMatches(e,t),this.getMatchingExpIds=(e,t)=>this.validator.getMatchingExpIds(e,t),this.getMatchingExpId=(e,t)=>this.validator.getMatchingExpId(e,t),this.hasMatchingExpression=(e,t)=>this.validator.hasMatchingExpression(e,t),this.getMatchingExpNode=(e,t)=>this.validator.getMatchingExpNode(e,t),this.getMatchingExpModel=(e,t)=>this.validator.getMatchingExpModel(e,t)}},gf=class extends AT{constructor(){super(...arguments),this.currentStepIndex=0,this.currentSubStepIndex=0,this.steps=[]}editListMode(){return this.controller.isInEditListMode()}requireNotEditListMode(){return{type:"guardrail-only",shouldAdvance:()=>!this.controller.isInEditListMode(),getBlock:()=>({position:"s",content:this.controller.s("graphing-tours-label-require-not-edit-list-mode"),target:{element:document.querySelector(".dcg-action-toggle-edit")}})}}expressionsVisible(){return this.controller.isListVisible()}requireExpressionsVisible(){return{type:"guardrail-only",shouldAdvance:()=>this.expressionsVisible(),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-require-expressions-visible"),target:{element:document.querySelector(".dcg-show-expressions-tab")}})}}resourcesOpen(){var e;return!!((e=document.querySelector("body"))!=null&&e.classList.contains("resources-open"))}requireResourcesNotOpen(){return{type:"guardrail-only",shouldAdvance:()=>!this.resourcesOpen(),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-require-resources-not-open"),target:{element:document.querySelector(".dcg-action-opendrawer")}})}}addCountdown(e,t,o){if(!e)return;if(!t)return e;let i=Math.round(t/1e3),n=e.content;return n?Array.isArray(n)||(n=[n]):n=[],o==="final"?{...e,content:[...n,this.controller.s("graphing-tours-label-self-destruct",{seconds:i})]}:{...e,content:[...n,this.controller.s("graphing-tours-label-next-step-countdown",{seconds:i})]}}advanceTour(){do this.currentSubStepIndex===this.steps[this.currentStepIndex].length-1?(this.currentStepIndex++,this.currentSubStepIndex=0):this.currentSubStepIndex++;while(this.steps[this.currentStepIndex][this.currentSubStepIndex].shouldAdvance()&&this.steps[this.currentStepIndex][this.currentSubStepIndex].type!=="final")}checkGuardrails(){let{currentStepIndex:e,currentSubStepIndex:t}=this,o,i;for(o=0;o<=e;o++)if(i=this.steps[o].find((n,a)=>((n.type==="guardrail"||n.type==="guardrail-only")&&(o<e||a<t)||(n.type==="guardrail-only--this-step"||n.type==="guardrail--this-step")&&o===e&&a<t)&&!n.shouldAdvance()),i)return i}getCurrentStep(){if(!(!this.steps||this.steps.length===0||this.currentStepIndex>=this.steps.length||this.currentSubStepIndex>=this.steps[this.currentStepIndex].length))return this.steps[this.currentStepIndex][this.currentSubStepIndex]}handleDelayOrCountdown(e){var o;let t;if(e)return e.delayBeforeExit?typeof e.delayBeforeExit=="function"?t=e.delayBeforeExit():t=e.delayBeforeExit:t=STe,this.nextUpdateTime=Date.now()+t-1,e.type==="countdown"||e.type==="final"?(this.tourController.addInterval(kTe),this.addCountdown(e.getBlock(),t,(o=e.type)!=null?o:"countdown")):(this.tourController.addUpdateTimeout(t),e.getBlock())}getTourStep(){var n;let e=Date.now(),t=this.getCurrentStep();if(!t)return;if(this.nextUpdateTime&&e<this.nextUpdateTime)return t.type==="countdown"||t.type==="final"?this.addCountdown(t.getBlock(),this.nextUpdateTime-Date.now(),t.type):this.curTripBlock;if(t.type==="final"&&this.nextUpdateTime&&e>=this.nextUpdateTime){setTimeout(()=>this.tourController.stopTour());return}let o=!1;if(t.shouldAdvance()){if(this.nextUpdateTime===void 0&&t.delayBeforeExit)return this.handleDelayOrCountdown(t);this.nextUpdateTime=void 0,o=!0,this.advanceTour()}let i=(n=this.checkGuardrails())!=null?n:this.getCurrentStep();return i?(o&&i.beforeStep&&i.beforeStep(),i.updateEveryTick?o&&this.clockBusId===void 0&&(this.clockBusId=Ql(()=>this.update())):this.clockBusId!==void 0&&(Vs(this.clockBusId),this.clockBusId=void 0),i.type==="final"||i.type==="countdown"?this.handleDelayOrCountdown(i):i.getBlock()):this.curTripBlock}willUpdate(){let e=this.getTourStep();e&&(this.curTripBlock=e)}onMount(){this.updateListener||(this.updateListener=this.controller.subscribeToChanges(()=>this.update()))}willUnmount(){this.updateListener!==void 0&&(this.updateListener(),this.updateListener=void 0),this.clockBusId!==void 0&&Vs(this.clockBusId),this.tourController.clearTimeouts()}template(){return l("div",{children:wTe(()=>this.curTripBlock,e=>l(ES,{tourController:this.props.tourController,controller:this.props.controller,content:()=>e().content,header:()=>e().header,innerHTML:()=>e().innerHTML,position:()=>e().position,target:()=>e().target}))})}shouldPopup(){return!1}};var gu=class extends gf{checkGuardrails(){}advanceTour(){}getCurrentStep(){let e=this.getCurrentStepBase();if(e){let t=e.getBlock();return this.cachedLastBlock&&(g6(t,this.cachedLastBlock)||(this.nextUpdateTime=void 0)),this.cachedLastBlock=t,e.type==="final"&&(this.nextUpdateTime||(this.nextUpdateTime=Date.now()+5e3-1,this.tourController.addInterval(500))),e}}};var rO=class extends gu{shouldPopup(){return!!this.getMatchingExpNode(u6)}restrictedLineTour(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();let e=this.getMatchingExpNode([d6,Xae]),t=this.getMatchingExpNode(p6);if(e)return t?(this.completedPhase1=!0,this.getCurrentStepBase()):{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-brilliant"),content:this.controller.s("graphing-tours-label-restrictions-new-expression"),target:{selector:".dcg-new-math-div"}})};let o=this.getMatchingExpId(TS),i=this.getExpressionNodeById(o),n=this.getModelById(o);if(i&&n){let a=this.expMatches(n,c6);return this.expMatches(n,s6)?void 0:a?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-awesome"),content:[],innerHTML:[this.controller.s("graphing-tours-label-restrictions-domain",{sample_expression:'<span class="dcg-trip-math">\\left\\{x<0\\right\\}</span>'}),"<br><i>"+this.controller.s("graphing-tours-label-restrictions-abc",{buttons:"{ }"})+"</i>"].join(""),target:{element:i}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-restrictions-start"),content:[],innerHTML:this.controller.s("graphing-tours-label-restrictions-straight-line",{sample_expression:'<span class="dcg-trip-math">y=2x</span>'}),target:{element:i}}),delayBeforeExit:500}}return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-restrictions-blank-expression"),target:{selector:".dcg-new-math-div"}})}}restrictedParabolaTour(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.getMatchingExpNode([$ae,ET]))return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-restrictions-star"),content:[],target:{selector:".dcg-exppanel-container"}}),type:"final"};let t=this.getMatchingExpId([p6,Q2]),o=this.getExpressionNodeById(t),i=this.getModelById(t);if(o&&i){let n=this.expMatches(i,[ET,Zae]),a=this.expMatches(i,Jae),s=this.expMatches(i,ET);return this.expMatches(i,s6)?void 0:s?n?a?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-nice"),content:[],innerHTML:this.controller.s("graphing-tours-label-restrictions-range",{sample_expression:'<span class="dcg-trip-math">\\left\\{y<4\\right\\}</span>'}),target:{element:o}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-restrictions-move-parabola"),content:[],innerHTML:this.controller.s("graphing-tours-label-restrictions-change-equation",{sample_expression:'<span class="dcg-trip-math">y=x^2-2</span>'}),target:{element:o,updatePosition:"always"}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-restrictions-dont-forget"),content:[],innerHTML:this.controller.s("graphing-tours-label-restrictions-type-all",{sample_expression:'<span class="dcg-trip-math">y=x^2</span>'}),target:{element:o}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:[],innerHTML:[this.controller.s("graphing-tours-label-restrictions-graph-parabola",{sample_expression:'<span class="dcg-trip-math">y=x^2</span>'})+"<br><i>"+this.controller.s("graphing-tours-label-restrictions-typing-hint",{suggestion1:"y=x^2",suggestion2:'<span class="dcg-trip-math">a^2</span>'})+"</i>"].join(""),target:{element:o,updatePosition:"always"}})}}return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-restrictions-blank-expression"),target:{selector:".dcg-new-math-div"}})}}getCurrentStepBase(){return this.completedPhase1?this.restrictedParabolaTour():this.restrictedLineTour()}};var oO=class extends gu{shouldPopup(){return!!this.getMatchingExpNode(Bd)}getCurrentStepBase(){var a;if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();let e=this.getMatchingExpModel(Wae),t=this.getMatchingExpNode(Bd),o=this.getMatchingExpNode(Qae),i=this.getMatchingExpNode(MT);if(e&&o)return{type:"final",shouldAdvance:()=>!0,getBlock:()=>({position:"s",header:this.controller.s("graphing-tours-label-sliders-pro"),content:[],target:{element:o==null?void 0:o.querySelector(".dcg-circular-icon-container")}})};if(e&&i&&!((a=i.querySelector(".dcg-thumb"))!=null&&a.classList.contains("dcg-depressed")))return{shouldAdvance:()=>!0,getBlock:()=>({position:"s",header:this.controller.s("graphing-tours-label-sliders-hands-free"),content:this.controller.s("graphing-tours-label-sliders-press-play"),target:{element:i==null?void 0:i.querySelector(".dcg-circular-icon-container")}})};if(e&&t){let s=t==null?void 0:t.querySelector(".dcg-thumb .dcg-graphic");return{shouldAdvance:()=>!0,getBlock:()=>s?{position:"s",content:this.controller.s("graphing-tours-label-sliders-drag-handle"),target:{element:s,updatePosition:"never"}}:{position:"e",content:this.controller.s("graphing-tours-label-sliders-change-value"),target:{element:t}},updateEveryTick:!0}}let n;return this.expressionCount()>1?n=this.getMatchingExpNode(l6(1)):n=this.getMatchingExpNode(l6(2)),n&&(n!=null&&n.querySelector(".dcg-slider-btn-container:last-child .dcg-btn-blue"))?{shouldAdvance:()=>!0,getBlock:()=>({position:"s",header:this.controller.s("graphing-tours-label-awesome"),content:this.controller.s("graphing-tours-label-sliders-add"),target:{element:n==null?void 0:n.querySelector(".dcg-slider-btn-container:last-child .dcg-btn-blue")}})}:(n=this.getMatchingExpNode(TS),n?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-sliders-make-sliders"),content:[],innerHTML:this.controller.s("graphing-tours-label-sliders-try-typing",{sample_expression:'<span class="dcg-trip-math">y=mx+b</span>'}),target:{element:n}}),delayBeforeExit:600}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-sliders-blank-expression"),target:{selector:".dcg-action-newmath"}})})}};var iO=class extends gu{constructor(){super(...arguments);this.hasCreatedLinearRegression=!1;this.hasInitiallyRenderedSampleDataLink=!1}shouldPopup(){return this.hasMatchingExpression(eO)}getRegressionExpId(){return this.getMatchingExpId(hf)||this.getMatchingExpId(jy)}getRegressionExp(){return this.getMatchingExpModel(hf)||this.getMatchingExpModel(jy)}hasRegression(){var i,n;let t=this.getRegressionExp(),o=(n=(i=t==null?void 0:t.formula)==null?void 0:i.regression)==null?void 0:n.statistics;return!!o&&o.r}hasFilledTable(){return!!this.getMatchingExpNode([tg,jae(5)])}getCurrentStepBase(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();let t=this.getMatchingExpId(hf)||this.getMatchingExpId(jy),o=this.getExpressionNodeById(t),i=this.getModelById(t),n=this.getMatchingExpId(tg),a=this.getExpressionNodeById(n),s=this.getModelById(n);if(!s||s.type!=="table"||!s.columnModels[1]){let E=document.querySelector(".dcg-action-newtable");return!E&&(!ha&&!jn)?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-data"),content:[],innerHTML:this.controller.s("graphing-tours-label-regressions-docs",{sample_data_link:'<a class="dcg-trip-link" target="_blank" href="https://docs.google.com/spreadsheets/d/1h4kYwWka_1PvI5G-hPYz_QBe1FrYLo9Gb1XvxJz-QYE/edit#gid=0">'+this.controller.s("graphing-tours-label-regressions-sample-data")+"</a>"})+' <div class="dcg-trip-hint"><br>'+this.controller.s("graphing-tours-label-regressions-own-data",{plus_icon:'<i class="dcg-icon-plus" aria-hidden="true"></i>'}),target:{element:o||document.querySelector(".dcg-exppanel")}})}:E?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-regressions-new-table"),target:{element:E}}),delayBeforeExit:250}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-data-2"),content:this.controller.s("graphing-tours-label-new-item"),target:{selector:".dcg-add-expression-btn"}}),delayBeforeExit:150}}let c=s.columnModels[0].values.length;if(a&&c<5)return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-fill-sample-data"),content:[],innerHTML:"<table class='dcg-regression-tour-table'><tr><td><span class='dcg-trip-math'>x_1</span></td><td><span class='dcg-trip-math'>y_1</span></td></tr><tr><td>1</td><td>0.8</td></tr><tr><td>2</td><td>2.7</td></tr><tr><td>3</td><td>3.9</td></tr><tr><td>4</td><td>4.6</td></tr><tr><td>5</td><td>5</td></tr></table>",target:{element:a.querySelector(".dcg-row:nth-of-type(2) .dcg-cell:nth-of-type(2)")}})};let d=this.getMatchingExpModel(hf)||this.getMatchingExpModel(Q2)||this.controller.getItemModelByIndex(0);if(!d||d.type!=="expression"){let E=document.querySelector(".dcg-action-newexpression");return E?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-regressions-expression-option"),target:{element:E}}),delayBeforeExit:150}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-awesome"),content:this.controller.s("graphing-tours-label-new-item"),target:{selector:".dcg-add-expression-btn"}}),delayBeforeExit:150}}let p=i&&i.type==="expression"&&i.formula,u=p?p.regression:void 0,g=u?u.statistics:void 0,h=u?u.parameters:void 0;if(g&&g.r&&(this.hasCreatedLinearRegression=!0),!this.hasCreatedLinearRegression&&o)return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:[],innerHTML:this.controller.s("graphing-tours-label-regressions-equation",{equation:"<span class='dcg-trip-math'>y_1\\sim mx_1+b</span>"})+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-regressions-hint-1",{y_1:"<span class='dcg-trip-math'>y_1</span>",y1:"<span class='dcg-trip-math'>y1</span>"})+"</div><div class='dcg-trip-hint'>"+this.controller.s("graphing-tours-label-regressions-hint-2",{twiddle:"<span class='dcg-trip-math'>~</span>"})+"</div>",target:{element:o,updatePosition:"never"}}),delayBeforeExit:250};if(document.querySelector(".dcg-residual-suggestion"))return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-check-model"),content:this.controller.s("graphing-tours-label-regressions-residuals"),target:{selector:".dcg-residual-suggestion"}}),delayBeforeExit:250};if(g&&(g.Rsquared!==void 0&&g.Rsquared>=.99||g.r!==void 0&&g.r>=.99||h&&h.a&&h.k&&h.h))return{shouldAdvance:()=>!0,type:"final",getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-keep-exploring"),content:[],target:{selector:".dcg-exppanel"}})};if(!o)return;let v,T=this.getMatchingExpIds(hf);return T.length>1?v=this.getExpressionNodeById(T.pop()):v=this.getExpressionNodeById(T[0]),{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-new-model"),content:[],innerHTML:this.controller.s("graphing-tours-label-regressions-better-fit",{equation:"<span class='dcg-trip-math'>y_1~a(x_1-h)^2+b</span>"}),target:{element:v,updatePosition:"never"}}),delayBeforeExit:300}}};var nO=class extends gu{shouldPopup(){return!1}getCurrentStepBase(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();let e=this.getMatchingExpId(hf)||this.getMatchingExpId(jy),t=this.getExpressionNodeById(e),o=this.getMatchingExpId(tg),i=this.getExpressionNodeById(o),n=this.getModelById(o);if(!n||n.type!=="table"||!n.columnModels[1]){let d=document.querySelector(".dcg-action-newtable");return!d&&(!ha&&!jn)?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-data"),content:[],innerHTML:this.controller.s("graphing-tours-label-regressions-docs",{sample_data_link:'<a class="dcg-trip-link" target="_blank" href="https://docs.google.com/spreadsheets/d/1h4kYwWka_1PvI5G-hPYz_QBe1FrYLo9Gb1XvxJz-QYE/edit#gid=0">'+this.controller.s("graphing-tours-label-regressions-sample-data")+"</a>"})+' <div class="dcg-trip-hint"><br>'+this.controller.s("graphing-tours-label-regressions-own-data",{plus_icon:'<i class="dcg-icon-plus" aria-hidden="true"></i>'}),target:{element:t||document.querySelector(".dcg-exppanel")}})}:d?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-regressions-new-table"),target:{element:d}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-data-2"),content:this.controller.s("graphing-tours-label-new-item"),target:{selector:".dcg-add-expression-btn"}})}}let a=n.columnModels[0].values.length,s=n.columnModels[0].values.length;return i&&(a<3||s<3)?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-fill-sample-data"),content:[],innerHTML:"<table class='dcg-regression-tour-table'><tr><td><span class='dcg-trip-math'>x_1</span></td><td><span class='dcg-trip-math'>y_1</span></td></tr><tr><td>1</td><td>0.8</td></tr><tr><td>2</td><td>2.7</td></tr><tr><td>3</td><td>3.9</td></tr><tr><td>4</td><td>4.6</td></tr><tr><td>5</td><td>5</td></tr></table>",target:{element:i.querySelector(".dcg-row:nth-of-type(2) .dcg-cell:nth-of-type(2)")}})}:n.regression?document.querySelector(".dcg-residual-suggestion")?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-check-model"),content:this.controller.s("graphing-tours-label-regressions-residuals"),target:{selector:".dcg-residual-suggestion"}})}:n.regression.type==="linear"?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-restrictions-change-model"),target:{selector:".dcg-dropdown-input"}})}:{shouldAdvance:()=>!0,type:"final",getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-keep-exploring"),content:[],target:{selector:".dcg-exppanel"}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-awesome"),content:this.controller.s("graphing-tours-label-add-regression"),target:{selector:".dcg-add-regression-view"}})}}};var aO=class extends gf{constructor(){super(...arguments);this.steps=[[this.requireExpressionsVisible(),this.requireResourcesNotOpen(),this.requireNotEditListMode(),{shouldAdvance:()=>!!this.hasMatchingExpression(tg),getBlock:()=>{let t=document.querySelector(".dcg-action-newtable");return t?{position:"e",content:this.controller.s("graphing-tours-label-tables-select-table"),target:{element:t}}:{position:"e",header:this.controller.s("graphing-tours-label-tables-start"),content:this.controller.s("graphing-tours-label-new-item"),target:{selector:".dcg-add-expression-btn"}}},type:"guardrail"}],[{shouldAdvance:()=>this.getFilledRows()>=3,getBlock:()=>{var s,c;let t=this.getTableEl();if(!t)return;let o=t.querySelector(".dcg-row .dcg-cell.dcg-error");if(o)return{position:"e",content:this.controller.s("graphing-tours-label-tables-valid-number"),target:{element:o}};let i=gs(this.getTable());if(!i)return t.getBoundingClientRect().y<0?{position:"e",content:this.controller.s("graphing-tours-label-tables-scroll"),target:{selector:".dcg-expressionlist"}}:{position:"e",content:this.controller.s("graphing-tours-label-tables-back"),target:{element:(c=(s=t==null?void 0:t.querySelector(".dcg-row .dcg-cell.dcg-empty:first-of-type"))==null?void 0:s.parentElement)==null?void 0:c.querySelector(".dcg-cell:nth-of-type(2)")}};if(this.getRows()===2&&this.getFilledRows()===1&&i&&i.row===1)return{position:"e",content:this.controller.s("graphing-tours-label-tables-next-row"),target:{element:t.querySelector(`.dcg-row:nth-of-type(${i.row+1}) .dcg-cell:nth-of-type(2)`)}};if(this.getFilledRows()===0&&(t==null?void 0:t.querySelectorAll(".dcg-row:nth-of-type(2) .dcg-cell:not(.dcg-empty):not(.dcg-error)").length)===1)return{position:"e",header:this.controller.s("graphing-tours-label-tables-fill-cell"),content:this.controller.s("graphing-tours-label-tables-type-number"),target:{element:t==null?void 0:t.querySelector(".dcg-row:nth-of-type(2) .dcg-cell:nth-of-type(2)")}};let n=this.controller.s("graphing-tours-label-tables-fill-row"),a;return this.getFilledRows()===2&&i.row===2?(a=this.controller.s("graphing-tours-label-awesome"),n=this.controller.s("graphing-tours-label-tables-enter")):this.getFilledRows()===2&&(n=this.controller.s("graphing-tours-label-tables-fill-another")),{position:"e",content:n,header:a,target:{element:t==null?void 0:t.querySelector(`.dcg-row:nth-of-type(${i.row+1}) .dcg-cell:nth-of-type(2)`)}}}}],[{shouldAdvance:()=>!!document.querySelector(".dcg-table-column-menu"),getBlock:()=>{var t;return{header:this.controller.s("graphing-tours-label-tables-last-trick"),content:this.controller.s("graphing-tours-label-tables-open-options"),position:"e",target:{element:(t=this.getTableEl())==null?void 0:t.querySelector(".dcg-row:nth-of-type(1) .dcg-cell:nth-of-type(2) .dcg-circular-icon")}}},type:"guardrail--this-step"},{shouldAdvance:()=>{let t=this.getTable();return!!t&&t.columnModels[1].points&&t.columnModels[1].lines},getBlock:()=>({content:this.controller.s("graphing-tours-label-tables-dots"),position:"e",target:{selector:".dcg-table-column-menu .dcg-options-menu-section:nth-of-type(3)"}})}],[{shouldAdvance:()=>!document.querySelector(".dcg-table-column-menu"),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-tables-close-options"),target:{selector:".dcg-table-column-menu"}})},{shouldAdvance:()=>!1,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-tables-whiz"),content:[],target:{selector:".dcg-exppanel"}}),type:"final"}]]}getRows(){let t=this.getTable();return t?Xn(t):0}getFilledRows(){var a,s;let t=this.getTable();if(!t)return 0;let o=(a=t.formula)==null?void 0:a.column_data[0].values,i=(s=t.formula)==null?void 0:s.column_data[1].values;if(!o||!i)return 0;let n=0;for(let c=0;c<o.length;c++)isFinite(o[c])&&isFinite(i[c])&&n++;return n}shouldPopup(){return!!this.getMatchingExpNode(eO)}getTableEl(){let t=this.getMatchingExpId(tg);if(t)return this.getExpressionNodeById(t)}getTable(){let t=this.getMatchingExpId(tg);if(!t)return;let o=this.getModelById(t);if((o==null?void 0:o.type)==="table")return o}};var _Te=Xc("tableRegressions")===!1,LT={sliders:{tour:oO,titleKey:"graphing-tours-heading-sliders",thumb:""},tables:{tour:aO,titleKey:"graphing-tours-heading-tables",thumb:""},restrictions:{tour:rO,titleKey:"graphing-tours-heading-restrictions",thumb:""},regressions:{tour:_Te?iO:nO,titleKey:"graphing-tours-heading-regressions",thumb:""}};var ese=__dcg_shared_module_exports__['e'](j());var{IfDefined:CTe}=ese.Components,mu=class extends AT{constructor(){super(...arguments),this.currentStepIndex=0,this.currentSubStepIndex=0,this.steps=[]}editListMode(){return this.controller.isInEditListMode()}requireNotEditListMode(){return{type:"guardrail-only",shouldAdvance:()=>!this.controller.isInEditListMode(),getBlock:()=>({position:"s",content:this.controller.s("graphing-tours-label-require-not-edit-list-mode"),target:{element:document.querySelector(".dcg-action-toggle-edit")}})}}expressionsVisible(){return this.controller.isListVisible()}requireExpressionsVisible(){return{type:"guardrail-only",shouldAdvance:()=>this.expressionsVisible(),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-require-expressions-visible"),target:{element:document.querySelector(".dcg-show-expressions-tab")}})}}resourcesOpen(){var e;return!!((e=document.querySelector("body"))!=null&&e.classList.contains("resources-open"))}requireResourcesNotOpen(){return{type:"guardrail-only",shouldAdvance:()=>!this.resourcesOpen(),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-require-resources-not-open"),target:{element:document.querySelector(".dcg-action-opendrawer")}})}}advanceTour(){if(!this.isLastStep())do this.currentSubStepIndex===this.steps[this.currentStepIndex].length-1?(this.currentStepIndex++,this.currentSubStepIndex=0):this.currentSubStepIndex++;while(this.steps[this.currentStepIndex][this.currentSubStepIndex].shouldAdvance()&&!this.isLastStep())}checkGuardrails(){let{currentStepIndex:e,currentSubStepIndex:t}=this,o,i;for(o=0;o<=e;o++)if(i=this.steps[o].find((n,a)=>((n.type==="guardrail"||n.type==="guardrail-only")&&(o<e||a<t)||(n.type==="guardrail-only--this-step"||n.type==="guardrail--this-step")&&o===e&&a<t)&&!n.shouldAdvance()),i)return i}getCurrentStep(){if(!(!this.steps||this.steps.length===0||this.currentStepIndex>=this.steps.length||this.currentSubStepIndex>=this.steps[this.currentStepIndex].length))return this.steps[this.currentStepIndex][this.currentSubStepIndex]}isLastStep(){return this.currentStepIndex===this.steps.length-1&&this.currentSubStepIndex===this.steps[this.currentStepIndex].length-1}getTourStep(){var i;let e=this.getCurrentStep();if(!e)return;let t=!1;e.shouldAdvance()&&(t=!0,this.advanceTour());let o=(i=this.checkGuardrails())!=null?i:this.getCurrentStep();return o?(o.updateEveryTick?t&&this.clockBusId===void 0&&(this.clockBusId=Ql(()=>this.update())):this.clockBusId!==void 0&&(Vs(this.clockBusId),this.clockBusId=void 0),o.getBlock()):this.curTripBlock}willUpdate(){var t;let e=this.getTourStep();e&&(this.curTripBlock=e),this.isLastStep()&&((t=this.getCurrentStep())!=null&&t.shouldAdvance())&&setTimeout(()=>this.tourController.stopTour())}onMount(){this.updateListener||(this.updateListener=this.controller.subscribeToChanges(__dcg_shared_module_exports__['Za'](()=>{this._isMounted&&this.update()},600)))}willUnmount(){this.updateListener!==void 0&&(this.updateListener(),this.updateListener=void 0),this.clockBusId!==void 0&&Vs(this.clockBusId),this.tourController.clearTimeouts()}template(){return l("div",{children:CTe(()=>this.curTripBlock,e=>l(ES,{tourController:this.props.tourController,controller:this.props.controller,content:()=>e().content,header:()=>e().header,innerHTML:()=>e().innerHTML,position:()=>e().position,target:()=>e().target}))})}};var sO=class extends mu{constructor(){super(...arguments);this.steps=[[this.requireExpressionsVisible(),this.requireNotEditListMode(),{shouldAdvance:()=>this.hasMatchingExpression(Bd),getBlock:()=>({position:"e",content:"To create a slider, type something like a=1",target:{element:this.getAvailableExp()}}),type:"guardrail"},{shouldAdvance:()=>{let t=this.getMatchingExpModel(Bd);if(!t||t.type!=="expression")return!1;let o=t.latex.match(/(\w+)\=/);if(!o)return!1;let i=o[1];return this.hasMatchingExpression([IT(i)],[t.id])},getBlock:()=>{let t=this.getMatchingExpIds(Bd);return{position:"e",content:"Now use that new parameter somewhere else in this graph.",target:{element:this.getAvailableExp(t)}}},type:"guardrail"},{shouldAdvance:()=>!this.hasMatchingExpression(MT),getBlock:()=>({position:"e",content:'This graph already has a slider! Drag it to change the value, or press "play" to animate.',target:{updatePosition:"never",element:this.getMatchingExpNode(Bd)}})},{shouldAdvance:()=>this.hasMatchingExpression(MT),getBlock:()=>{var t;return{position:"s",content:"Drag the handle to watch your graph update.",target:{updatePosition:"never",element:(t=this.getMatchingExpNode(Bd))==null?void 0:t.querySelector(".dcg-slider-container .dcg-thumb .dcg-graphic")}}}}]]}};var lO=class extends mu{constructor(){super(...arguments);this.steps=[[this.requireExpressionsVisible(),{shouldAdvance:()=>document.getElementsByClassName("dcg-colored-icon").length>0,getBlock:()=>({position:"e",content:"Start by graphing something. For example, type (1,2,0) to plot a point",target:{element:this.getAvailableExp()}}),type:"guardrail"},{shouldAdvance:()=>{var t;return((t=this.controller.getOpenItemMenu())==null?void 0:t.type)==="expression"},getBlock:()=>({position:"e",content:this.raw("To open display properties, click and hold on the icon."),target:{element:document.getElementsByClassName("dcg-colored-icon")[0]}}),type:"guardrail"},{shouldAdvance:()=>{let t=this.controller.getOpenItemMenu();return(t==null?void 0:t.type)!=="expression"?!1:this.currentlySelectedColor?t.model.color!==this.currentlySelectedColor:(this.currentlySelectedColor=t.model.color,!1)},getBlock:()=>({position:"e",content:this.raw("Click on a new tile to change the color."),target:{selector:".dcg-color-picker-container"}})}]]}};function IS(r,e){return tse(r)||rse(r)}IS.is3d=!0;function tse(r,e){return r.type!=="expression"?!1:!!r.formula&&r.formula.expression_type===__dcg_shared_module_exports__['Vc'].POINT3D_LIST}tse.is3d=!0;function rse(r,e){return r.type!=="expression"?!1:!!r.formula&&r.formula.expression_type===__dcg_shared_module_exports__['Vc'].POINT3D}rse.is3d=!0;function TTe(r,e){return r.type!=="expression"?!1:(!r.formula||!!r.formula.error)&&!!r.latex&&r.latex.startsWith("\\left(")||r.formula.expression_type===__dcg_shared_module_exports__['Vc'].POINT3D}TTe.is3d=!0;function m6(r,e){return!e||!IS(r)?!1:e.branches.some(t=>t.position[2]>0)}m6.is3d=!0;function f6(r,e){return!e||!IS(r)?!1:e.branches.some(t=>t.position[2]<0)}f6.is3d=!0;function b6(r,e){return!e||!IS(r)?!1:e.branches.some(t=>"position"in t&&t.position[0]===0&&t.position[1]===0)}b6.is3d=!0;function cO(r,e){return r.type!=="expression"?!1:!!r.extendTo3D}cO.is3d=!0;function y6(r,e){return e?e.branches.every(t=>{if(t.graphMode!==100&&t.graphMode!==128)return!1;let o=t.points[1];return t.points.every((i,n)=>n%3!==1||Math.abs(i-o)<=1e-4||isNaN(i))}):!1}y6.is3d=!0;function dO(r,e){return e?e.branches.every(t=>{if(t.graphMode!==100&&t.graphMode!==128)return!1;let o=t.points[0],i=t.points[1],n=t.points[2];return t.points.every((a,s)=>s%3!==0||Math.abs(a-o)<=1e-4||isNaN(a))||t.points.every((a,s)=>s%3!==1||Math.abs(a-i)<=1e-4||isNaN(a))||t.points.every((a,s)=>s%3!==2||Math.abs(a-n)<=1e-4||isNaN(a))}):!1}dO.is3d=!0;function pO(r,e){return e?e.branches.every(t=>t.graphMode===118):!1}pO.is3d=!0;function ETe(r,e){return e?e.branches[0].graphMode===118&&e.branches[0].position[2]<=1:!1}ETe.is3d=!0;var uO=class extends mu{constructor(){super(...arguments);this.steps=[[this.requireExpressionsVisible(),this.requireNotEditListMode(),{shouldAdvance:()=>!!document.querySelector(".dcg-extend-to-3d-checkbox"),getBlock:()=>({position:"e",content:"Start by graphing a 2-dimensional equation, like y=2x+3",target:{element:this.getAvailableExp()}}),type:"guardrail"},{shouldAdvance:()=>!document.querySelector(".dcg-extend-to-3d-checkbox.dcg-checked"),getBlock:()=>({position:"e",content:"This graph was extended to 3D, so it shows every (x,y,z) value that satisfies the equation, not just the ones in the plane where z=0.",target:{element:this.getMatchingExpNode(cO)}})},{shouldAdvance:()=>this.hasMatchingExpression(cO),getBlock:()=>({position:"s",content:this.raw("Check this box to see the surface."),target:{selector:".dcg-extend-to-3d-checkbox:not(.dcg-checked) .dcg-checkbox"}})}]]}};var hO=class extends mu{constructor(){super(...arguments);this.steps=[[{shouldAdvance:()=>this.controller.getState().graph.showAxis3D!==!1||document.getElementsByClassName("dcg-settings-container").length>0,getBlock:()=>({position:"w",content:"The axes are already off. To turn them on, or adjust other settings, click on this wrench.",target:{selector:".dcg-action-settings"}})},{shouldAdvance:()=>document.getElementsByClassName("dcg-settings-container").length>0||this.controller.getState().graph.showAxis3D===!1,getBlock:()=>({position:"w",content:this.raw("To change graph settings, click on this wrench."),target:{selector:".dcg-action-settings"}}),type:"guardrail"},{shouldAdvance:()=>this.controller.getState().graph.showAxis3D===!1,getBlock:()=>({position:"s",content:this.raw("Click here to turn off the axes, plane, and labels all at once."),target:{selector:".dcg-toggle-switch"}})}]]}};var MS={change_color_3d:{tour:lO,titleKey:"graphing-tours-label-change-color",thumb:"change-color-2x.png"},change_line_to_surface:{tour:uO,titleKey:"graphing-tours-label-show-surface",thumb:"show-3D-surface-2x.png"},add_slider:{tour:sO,titleKey:"graphing-tours-label-add-slider",thumb:"add-slider-2x.png"},turn_off_axes:{tour:hO,titleKey:"graphing-tours-label-turn-off-axes",thumb:"turn-off-axes-2x.png"}};var ITe={version:10,randomSeed:"4fd2b19fe0ef32598432e66d6dea4a8d",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[-.4034467850661228,-.9130294825148988,-.0600654283128971,.9030757945548551,-.4078935695234748,.13445053079307687,-.14725760051335893,-4673193812242393e-29,.9890981746475297],axis3D:[0,0,-1.0000000000030735],product:"graphing-3d"},expressions:{list:[{type:"text",id:"6",text:'The "sphere" function requires a center point and a radius. For example: sphere((0,0,0), 3) will draw a sphere of radius 3 at the origin.',readonly:!0},{type:"expression",id:"1",color:"#c74440",latex:"\\operatorname{sphere}\\left(\\left(0,0,-2\\right),\\ 2\\right)",readonly:!0},{type:"expression",id:"2",color:"#2d70b3",latex:"\\operatorname{sphere}\\left(\\left(0,0,H\\right),R\\right)",readonly:!0},{type:"expression",id:"4",color:"#6042a6",latex:"H=2",hidden:!0,readonly:!0,slider:{hardMin:!0,min:"-2"}},{type:"expression",id:"3",color:"#388c46",latex:"R=2",hidden:!0,readonly:!0,slider:{hardMin:!0,min:"0"}}]}},ose={title:"Build a Snowman",thumb:"snowman-2x.png",prompt:"Update this graph so that...",startingState:ITe,goals:[{text:"the top sphere is smaller than the bottom one, but still touching",complexCriterion:r=>{let e=r.getExpSketchById("2");if(!e||e.branches.length!==1||e.branches[0].graphMode!==118)return!1;let t=e.branches[0],o=Math.abs(t.radius[2]);return o<2&&t.position[2]<=o&&t.position[2]>=-o}},{text:"it has a third sphere that's even smaller and on top of the other two",complexCriterion:r=>{var o;let e=(o=r.getExpSketchById("2"))==null?void 0:o.branches[0];return(e==null?void 0:e.graphMode)!==118?!1:r.getMatchingExpIds(pO).some(i=>{var s;let n=(s=r.getExpSketchById(i))==null?void 0:s.branches[0];return(n==null?void 0:n.graphMode)!==118?!1:Math.sqrt(Math.pow(n.position[0]-e.position[0],2)+Math.pow(n.position[1]-e.position[1],2)+Math.pow(n.position[2]-e.position[2],2))<=Math.abs(e.radius[2])+Math.abs(n.radius[2])+1e-4&&n.position[2]>e.position[2]&&n.radius[2]<e.radius[2]})}},{text:"the spheres are all the same color",complexCriterion:r=>{let t=r.getMatchingExpIds(pO).map(i=>r.getModelById(i)),{color:o}=t[0];return t.every(i=>i.color===o)}},{text:"the axes and grid are hidden",complexCriterion:r=>r.getState().graph.showAxis3D===!1}],hintMiniTours:["change_color_3d","turn_off_axes"]};var x6=r=>{if(!r.is3dProduct())return!1;let t=r.getGrapher3d();if(!t)return!1;let o=t.getCurrentViewport().zmax,i=t.mathCoordinatesToScreenCoordinates({x:0,y:0,z:0}),n=t.mathCoordinatesToScreenCoordinates({x:0,y:0,z:o!=null?o:1});return Math.abs(n.x-i.x)+Math.abs(n.y-i.y)<20},ise=r=>{if(!r.is3dProduct())return!1;let e=r.getGrapher3d();return e?e.settings.speed3D!==0:!1},v6=r=>e=>!r(e);var MTe={version:10,randomSeed:"dc76b01fd3183b4066c467ba113fbef9",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[3749399456654644e-48,-1,6123233995736766e-32,6123233995736766e-32,6123233995736766e-32,1,-1,0,6123233995736766e-32],axis3D:[.9999999996978197,-6123233993886446e-32,59328897079605555e-46],product:"graphing-3d"},expressions:{list:[{type:"expression",id:"1",color:"#388c46",latex:"y=a\\left(x\\right)^{2}+k",readonly:!0,lines:!0,surfaces:!1},{type:"expression",id:"5",color:"#388c46",latex:"y=\\sin x",readonly:!0,lines:!0,surfaces:!1},{type:"expression",id:"6",color:"#c74440",latex:"a=0.5",hidden:!0,readonly:!0,slider:{hardMin:!0,hardMax:!0}},{type:"expression",id:"4",color:"#6042a6",latex:"k=-1.5",hidden:!0,readonly:!0,slider:{hardMin:!0,hardMax:!0}}]}},nse={title:"Make a 3D Surface",thumb:"surfaces-2x.png",prompt:"Update this graph so that...",startingState:MTe,goals:[{text:"it's tilted so you can see the z-axis",controllerCriteria:v6(x6)},{text:"you see the 3d surfaces for both equations",complexCriterion:r=>{let e=r.getModelById("1"),t=r.getModelById("5");return!!(e&&e.type==="expression"&&e.extendTo3D&&t&&t.type==="expression"&&t.extendTo3D)}},{text:"the colors of the two surfaces are different",complexCriterion:r=>{let e=r.getModelById("1"),t=r.getModelById("5");return!!(e&&e.type==="expression"&&t&&t.type==="expression"&&e.color!==t.color)}},{text:"it has momentum, rotating around the z-axis",controllerCriteria:[ise,v6(x6)]}],hintMiniTours:["change_line_to_surface","change_color_3d"]};var DTe={version:10,randomSeed:"303b2b2529c124fd179bcf0928c52bf1",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[-.4566162267528601,-.8805869756969109,-.126760402725266,.848498419860239,-.47388456213838426,.23555010775147064,-.2674921549518761,-53011017512727e-26,.9635600381083326],axis3D:[-.8805869757112816,-.4738845621467119,17425479990120072e-28],product:"graphing-3d"},expressions:{list:[{type:"text",id:"3",text:"You can use lists to slice a surface in several places at once. Lists are are defined by [start ... end]. You can also set a step size with the second number. For example [0, 2, ... 20] will just be the evens from 0 to 20.",readonly:!0},{type:"expression",id:"1",color:"#aaaaaa",latex:"f\\left(x,y\\right)=\\frac{x^{2}-y^{2}}{6}",readonly:!0},{type:"expression",id:"4",color:"#2d70b3",latex:"z=f\\left(x,y\\right)\\left\\{x=a\\right\\}",readonly:!0},{type:"expression",id:"5",color:"#6042a6",latex:"a=\\left[-5...5\\right]",hidden:!0}]}},ase={title:"Make a Mesh",thumb:"mesh-2x.png",prompt:"Update this graph so that...",startingState:DTe,goals:[{text:"it also has a list of y-slices",complexCriterion:r=>r.getUniqueSliceValues("y").length>1},{text:"the slices are denser, so there are at least 20 x-slices and 20 y-slices",complexCriterion:r=>{let e=r.getUniqueSliceValues("x"),t=r.getUniqueSliceValues("y");return e.length>=20&&t.length>=20}},{text:"the surface is hidden so that you only see the mesh",complexCriterion:r=>{let e=r.getModelById("1");return!!e&&e.type==="expression"&&e.hidden===!0}},{text:"the axes and grid are hidden",complexCriterion:r=>r.getState().graph.showAxis3D===!1}],hintMiniTours:["turn_off_axes"]};var gO=r=>e=>e.getMatchingExpModels(Bd).filter(i=>i.type==="expression").map(i=>i.formula.assignment&&__dcg_shared_module_exports__['vb'](i.formula.assignment)).some(i=>!!i&&e.hasMatchingExpression([r,IT(i)]));var ATe={version:10,randomSeed:"c13e89605fe04a21e53d878aa0a7202d",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[-.5132799671593364,-.8314696123025455,-.212607523691814,.7681777567114166,-.555570233019602,.3181896451432085,-.3826834323650897,0,.9238795325112867],axis3D:[-.9389975190442629,-.3439239154086105,-26438544160422738e-28],product:"graphing-3d"},expressions:{list:[{type:"text",id:"3",text:"3-dimensional points have three coordinates. For example, the point below is at x=1, y=2, and z=0.",readonly:!0},{type:"expression",id:"1",color:"#6042a6",latex:"\\left(1,2,0\\right)",readonly:!0}]}},sse={title:"Plot Points in 3D",thumb:"points-2x.png",prompt:"Update the graph so that it has a point that is...",startingState:ATe,goals:[{text:"above the XY plane",expressionCriteria:[m6]},{text:"below the XY plane",expressionCriteria:[f6]},{text:"on the z-axis",expressionCriteria:[b6]},{text:"connected to a slider",complexCriterion:gO(IS)}],hintMiniTours:["add_slider"]};var LTe={version:10,randomSeed:"c60138920fbda2e34d39e64024c81e8f",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[-.7911610162161196,.5672186659200341,-.22875146218502837,-.5448994070006874,-.8235672316404455,-.15754888517028243,-.27775687690890294,1234910249295711e-28,.960651402606498],axis3D:[0,0,-.9999999999834579],product:"graphing-3d"},expressions:{list:[{type:"text",id:"6",text:'If you restrict a surface to a single x, y, or z value it graphs a "slice" of that surface. Here we can use that to show conic sections.',readonly:!0},{type:"expression",id:"1",color:"#c74440",latex:"z^{2}=x^{2}+y^{2}",readonly:!0},{type:"expression",id:"4",color:"#6042a6",latex:"z^{2}=x^{2}+y^{2}\\left\\{x=1\\right\\}",readonly:!0}]}},lse={title:"Slice a Surface",thumb:"slices-2x.png",prompt:"Update this graph so that...",startingState:LTe,goals:[{text:"there is a slice with a constant y value (y-slice)",expressionCriteria:y6},{text:"there are at least 3 z-slices",complexCriterion:r=>r.getUniqueSliceValues("z").length>=3},{text:"at least 1 slice is connected to a slider",complexCriterion:gO(dO)},{text:"all of the slices are the same color",complexCriterion:r=>{let e=r.getMatchingExpModels(dO);if(e.length===0)return!1;let t=e[0].color;return e.every(o=>o.color===t)}}],hintMiniTours:["change_color_3d","add_slider"]};var fu={"0aab81de":sse,"46fc0484":nse,ecd99f28:ose,"3a96cffc":lse,be0997b4:ase};var mO=class{constructor(e,t,o){this.currentValidationStatus="never-validated";this.CHECK_ANIMATION_DELAY=900;this.didCloseSuccessModal=!1;this.currentQuestIsClosing=!1;this.questWindowPos=void 0;this.getController=()=>o.getApi()._calc.controller,this.tourController=e,this.validator=new DT(this.getController),this.graphsController=t,this.shellDispatch=o.dispatch}isValidQuestId(e){return e in fu}removeQuestFromQueryParams(){let e=new URLSearchParams(window.location.search);e.delete("quest"),Px(e)}getUrlForQuest(e){let t=new URLSearchParams(window.location.search);return t.delete("quest"),t.append("quest",e),`/3d?${t.toString()}`}startQuest(e,t={}){var n,a,s,c,d;if(this.currentQuestIsClosing=!1,this.isValidatingStep=void 0,this.didCloseSuccessModal=!1,this.setHintsVisible(!1),this.tourController.stopTour({reason:"exit"}),this.currentValidationStatus="never-validated",!(e in fu))return;this.currentQuestId=e;let o=this.getCurrentQuest();if(!o)return;let i=this.getController();if(this.graphsController.previousGraph=this.graphsController.currentGraph?this.graphsController.currentGraph.copy():new ki({product:"graphing-3d"}),this.graphsController.previousGraph.setGraphData(i.getState()),this.cachedOldCalcState=i.getState(),o!=null&&o.startingState&&!t.isUndoing&&i.setState(zo(o.startingState)),i.getGraphSettings().setProperty("defaultState",o.startingState),i.dispatch({type:"render"}),!t.isLoadingFromUrl){let p=this.getUrlForQuest(this.currentQuestId);this.cachedPreviousUrl=window.location.href,window.location.href!==p&&history.replaceState({},"",p)}this.graphsController.currentGraph=new ki({product:"graphing-3d",title:i.s("graphing-calculator-heading-quest",{title:(a=(n=this.getCurrentQuest())==null?void 0:n.title)!=null?a:""}),questHash:this.currentQuestId}),this.graphsController._onCurrentGraphChanged(),Sr({category:"quest",action:"start",name:(s=this.getCurrentQuest())==null?void 0:s.title}),this.tourController.triggerEvent("startQuest",void 0),this.currentQuestStartTime=Date.now(),this.cancelChangeSubcription=i.subscribeToChanges(()=>this.tourController.updateRootView()),!t.isUndoing&&!t.isLoadingFromUrl&&(i.dispatch({type:"toast/show",toast:{message:i.s("graphing-tours-narration-quest-started",{title:(d=(c=this.getCurrentQuest())==null?void 0:c.title)!=null?d:""}),undoCallback:()=>{this.shellDispatch({type:"undo-start-quest"})}}}),t.isLoadingFromUrl||i.dispatch({type:"set-focus-location",location:{type:"quest",location:"quest-pane"}})),i.runAfterDispatch(()=>this.tourController.updateRootView())}getCurrentQuest(){if(this.currentQuestId)return fu[this.currentQuestId]}getQuestActive(){return!!this.currentQuestId}getQuestGoals(){var e,t;return(t=(e=this.getCurrentQuest())==null?void 0:e.goals)!=null?t:[]}getQuestValidationStatus(){return this.currentValidationStatus}stopQuest({doRedirect:e,isUndoing:t}={doRedirect:!0,isUndoing:!1}){if(!this.currentQuestId)return;this.currentQuestIsClosing=!0,this.isValidatingStep=void 0,this.tourController.updateRootView(),clearTimeout(this.validationTimeoutId);let o=this.getController();o.getGraphSettings().setProperty("defaultState",void 0),this.cancelChangeSubcription&&this.cancelChangeSubcription(),this.removeQuestFromQueryParams();let{currentQuestId:i}=this;this.currentQuestStartTime=void 0;let n=setTimeout(()=>{this.currentQuestId=void 0,this.tourController.triggerEvent("stopQuest",void 0),this.tourController.updateRootView(),e&&this.removeQuestFromQueryParams()},300);t||o.dispatch({type:"toast/show",toast:{message:o.s("graphing-tours-narration-exiting-quest"),undoCallback:()=>{clearTimeout(n),this.startQuest(i,{isUndoing:!0})}}})}getGoalValidationStatus(e){switch(this.getQuestValidationStatus()){case"unvalidated":case"never-validated":return"unvalidated";case"complete":return"satisfied";case"incomplete":return e.satisfied?"satisfied":"unsatisfied";case"validating":if(this.isValidatingStep===void 0)return"unvalidated";let t=this.getQuestGoals().indexOf(e);return t===this.isValidatingStep?"validating":t>this.isValidatingStep?"unvalidated":e.satisfied?"satisfied":"unsatisfied"}}checkQuestGoals(){if(!this.currentQuestId)return;this.tourController.stopTour({reason:"exit"});let e=this.getQuestGoals();if(this.didCloseSuccessModal=!1,Vx){e.forEach(t=>t.satisfied=this.validateGoal(t)),this.ariaAlertGoalStatus(),this.completeValidation();return}this.isValidatingStep=0,this.currentValidationStatus="validating",this.ariaAlertGoalStatus(),this.checkCurrentQuestGoal()}validateGoal(e){let t=!0;return e.expressionCriteria!==void 0&&(t=this.validator.hasMatchingExpression(e.expressionCriteria)),e.controllerCriteria!==void 0&&(t=t&&this.matchesControllerCriteria(e.controllerCriteria)),e.complexCriterion!==void 0?e.complexCriterion.call({},this.validator):t}startNextQuest(){var o;let e=Object.keys(fu),t=0;if(this.currentQuestId){let i=e.findIndex(n=>n===this.currentQuestId);i<e.length-1&&(t=i+1)}Sr({category:"quest",action:"start-next",name:(o=this.getCurrentQuest())==null?void 0:o.title}),this.stopQuest({doRedirect:!1,isUndoing:!1}),setTimeout(()=>this.startQuest(e[t]),300)}getSuccessModalIsOpen(){return this.getQuestValidationStatus()==="complete"&&!this.didCloseSuccessModal}continueCurrentQuest(){var e;Sr({category:"quest",action:"keep-playing",name:(e=this.getCurrentQuest())==null?void 0:e.title}),this.closeSuccessModal()}closeSuccessModal(){this.didCloseSuccessModal=!0,this.tourController.updateRootView()}setQuestWindowPos(e,t){this.questWindowPos={left:e,top:t}}getQuestWindowPos(){return this.questWindowPos}checkCurrentQuestGoal(){if(this.isValidatingStep===void 0)return;let e=this.isValidatingStep,t=this.getQuestGoals();if(e>=t.length)return this.completeValidation();t[e].satisfied=this.validateGoal(t[e]),this.tourController.updateRootView(),this.isValidatingStep++,this.validationTimeoutId=setTimeout(this.checkCurrentQuestGoal.bind(this),this.CHECK_ANIMATION_DELAY)}ariaAlertGoalStatus(){var o;let e=[],t=this.getController();(o=this.getCurrentQuest())==null||o.goals.forEach(i=>{this.validateGoal(i)?e.push(t.s("graphing-tours-narration-quest-goal-complete",{goal:i.text})):e.push(t.s("graphing-tours-narration-quest-goal-incomplete",{goal:i.text}))}),e.length>0&&_e(e.join(" "))}matchesControllerCriteria(e){return Array.isArray(e)?e.every(t=>t(this.getController())):e(this.getController())}completeValidation(){var t;let e=this.getQuestGoals();clearTimeout(this.validationTimeoutId),this.isValidatingStep=void 0,this.currentValidationStatus=e.every(o=>o.satisfied)?"complete":"incomplete",this.currentValidationStatus==="complete"&&Sr({category:"quest",action:"finish",name:(t=this.getCurrentQuest())==null?void 0:t.title,value:this.currentQuestStartTime?Date.now()-this.currentQuestStartTime:void 0}),this.tourController.updateRootView()}setHintsVisible(e){var o,i;this.isValidatingStep&&this.completeValidation(),this.hintsVisible=e;let t=(o=this.tourController.getRootViewNode())==null?void 0:o.querySelector(".dcg-quest__body");if(t)if(e){let n=t.getBoundingClientRect();t.style.height=`${n.height}px`,t.style.width=`${n.width}px`}else t.style.height="unset",t.style.width="unset";this.tourController.updateRootView(),e?Sr({category:"quest",action:"hint-enter",name:(i=this.getCurrentQuest())==null?void 0:i.title}):this.tourController.stopTour()}getHintsVisible(){return this.hintsVisible}};var fO=class extends Pi{constructor(t,o){super();this.questListModalIsOpen=!1;this.hasTourBeenStopped=!1;this.tourKeyDownListener=t=>{"key"in t&&t.key.startsWith("Esc")&&this.stopTour()};this.getApi=o.getApi,this.questController=new mO(this,t,o)}getController(){return this.getApi()._calc.controller}shouldPopupTour(t){if(this.getController().getItemCount()>3)return!0;let o=this.getTourClass(t);if(!o)return!1;let i=new o({id:()=>t,controller:()=>this.getController(),tourController:()=>this},[]);return i&&i.shouldPopup?i.shouldPopup():!1}startTour(t,o=!1){if(this.mountedTour&&this.unmountTour(),!t||(this.buildTour(t),!this.mountedTour))return;this.isMiniTour=o,this.hasTourBeenStopped=!1;let i=this.isMiniTour?{category:"quest",action:"start-tour",name:t}:{category:"tour",action:"start",name:t};Sr(i),setTimeout(()=>{this.mountedTour&&(this.mountedTour.update(),setTimeout(()=>{var n;return(n=this.tourContainerElt)==null?void 0:n.classList.add("dcg-tour-loaded")}))}),document.addEventListener("keydown",this.tourKeyDownListener)}startMiniTour(t){this.activeMinitour=t,this.startTour(t,!0),this.updateRootView()}startTourFromUrl(){let t=Hi("quest");if(t){this.getController().is3dProduct()&&this.questController.isValidQuestId(t)&&!this.getController().isNarrow()?this.questController.startQuest(t,{isLoadingFromUrl:!0}):this.questController.removeQuestFromQueryParams();return}else this.getController().is3dProduct()&&Uo("showQuestsList")&&(this.questListModalIsOpen=!0);if(document.querySelectorAll(".dcg-expressionitem").length<2){setTimeout(this.startTourFromUrl.bind(this),100);return}let o=Hi("tour");o&&this.startTour(o)}getTourClass(t){var o;if(t==="baseTour")return gf;if(this.getController().is3dProduct()&&t in a6)return(o=a6[t])==null?void 0:o.tour;if(t in LT)return LT[t].tour;if(t in MS)return MS[t].tour}buildTour(t){t===this.tourId?this.stopTour({reason:"restart"}):this.stopTour({reason:"exit"}),this.tourId=t;let o=this.getTourClass(t);if(o)return this.mountTour(t,o)}mountTour(t,o){var i;return this.tourContainerElt||(this.tourContainerElt=document.createElement("div"),this.tourContainerElt.id="dcg-tour-container",(i=this.getController().getRootElt())==null||i.append(this.tourContainerElt)),this.mountedTour=bO.mountToNode(o,this.tourContainerElt,{controller:()=>this.getController(),tourController:()=>this,id:()=>t}),this.mountedTour}unmountTour(){this.mountedTour&&this.tourContainerElt&&bO.unmountFromNode(this.tourContainerElt),this.mountedTour=void 0,this.tourId=void 0}getActiveMinitour(){return this.activeMinitour}stopTour({reason:t,stopImmediately:o}={reason:"finish"}){if(!(!this.mountedTour||!this.tourContainerElt||this.hasTourBeenStopped)){if(this.hasTourBeenStopped=!0,this.activeMinitour=void 0,this.clearTimeouts(),document.removeEventListener("keydown",this.tourKeyDownListener),this.tourContainerElt.classList.remove("dcg-tour-loaded"),o?this.unmountTour():setTimeout(()=>{this.activeMinitour||this.unmountTour()},300),t==="finish"){let i=this.isMiniTour?{category:"quest",action:"finish-tour",name:this.tourId}:{category:"tour",action:"finish",name:this.tourId};Sr(i)}this.updateRootView()}}forceUpdate(){this.mountedTour&&this.mountedTour.update()}addInterval(t){this.intervalId!==void 0&&(clearInterval(this.intervalId),this.intervalId=void 0),this.intervalId=setInterval(()=>{this.mountedTour&&this.mountedTour.update()},t)}addUpdateTimeout(t){this.updateTimeoutId!==void 0&&(clearTimeout(this.updateTimeoutId),this.updateTimeoutId=void 0),this.updateTimeoutId=setTimeout(()=>{this.mountedTour&&this.mountedTour.update()},t)}clearTimeouts(){clearTimeout(this.updateTimeoutId),clearInterval(this.intervalId),this.intervalId=void 0,this.updateTimeoutId=void 0}setRootView(t,o){this.rootView=t,this.rootViewNode=o}getRootViewNode(){return this.rootViewNode}updateRootView(){var t;(t=this.rootView)==null||t.update()}setQuestsListModalVisibility(t){this.questListModalIsOpen=t;let o=new URLSearchParams(window.location.search);t?(o.set("showQuestsList",""),Sr({category:"quest",action:"open-list",name:"3d-expression-list"})):o.delete("showQuestsList"),Px(o),this.updateRootView()}getQuestsListModalIsOpen(){return this.questListModalIsOpen}getSuccessModalIsOpen(){return this.questController.getSuccessModalIsOpen()}continueCurrentQuest(){return this.questController.continueCurrentQuest()}closeSuccessModal(){return this.questController.closeSuccessModal()}startQuest(t){return this.questController.startQuest(t)}startQuestFromUndo(t){return this.questController.startQuest(t,{isUndoing:!0})}startNextQuest(){return this.questController.startNextQuest()}getCurrentQuest(){return this.questController.getCurrentQuest()}getQuestActive(){return this.questController.getQuestActive()}getQuestGoals(){return this.questController.getQuestGoals()}getQuestValidationStatus(){return this.questController.getQuestValidationStatus()}stopQuestFromUndo(){return this.questController.stopQuest({doRedirect:!0,isUndoing:!0})}stopQuest(){return this.questController.stopQuest()}getGoalValidationStatus(t){return this.questController.getGoalValidationStatus(t)}validateGoal(t){return this.questController.validateGoal(t)}getCurrentQuestIsClosing(){return this.questController.currentQuestIsClosing}setQuestWindowPos(t,o){return this.questController.setQuestWindowPos(t,o)}getQuestWindowPos(){return this.questController.getQuestWindowPos()}checkQuestGoals(){return this.setHintsVisible(!1),this.questController.checkQuestGoals()}getUrlForQuest(t){return this.questController.getUrlForQuest(t)}setHintsVisible(t){return this.questController.setHintsVisible(t)}getHintsVisible(){return this.questController.getHintsVisible()}};var Kd=null,cse=r=>{if(Kd!=null&&Kd.closed){r.askServerIfLoggedIn({fromSsoWindow:!0});return}setTimeout(()=>{cse(r)},1e3)},PTe=({url:r,blockedMessage:e,userController:t})=>{if(Kd&&!Kd.closed){Kd.focus();return}if(Kd=window.open(r,"login_window","width=650,height=530,resizable,scrollbars"),!Kd){alert(e);return}cse(t)},w6=()=>{Kd&&!Kd.closed&&Kd.close()},dse=({userController:r,i18n:e})=>{window.userController=r,window.addEventListener("beforeunload",w6),r.observeEvent("ssoLogin",(t,o)=>{!o||typeof o!="string"||!["google","apple"].includes(o)||PTe({url:ane(o),userController:r,blockedMessage:e(o==="google"?"account-shell-text-login-window-blocked-google":"account-shell-text-login-window-blocked-apple")})})};var Sse=__dcg_shared_module_exports__['e'](j());var AS=__dcg_shared_module_exports__['e'](j());var Kn=__dcg_shared_module_exports__['e'](j());var xO=__dcg_shared_module_exports__['e'](j());var yO=class extends xO.View{constructor(){super(...arguments),this.resizeListener=()=>{this.clampPosition()}}startDrag(e){e.device!=="keyboard"&&e.target&&(e.preventDefault(),Dr(),this.previousCursor=document.body.style.cursor,document.body.style.setProperty("cursor","move","important"),this.dragDrop.startDrag(e))}willUnmount(){this.resizeObserver.disconnect(),window.removeEventListener("resize",this.resizeListener)}cachePosition(){var t;let e=(t=this.paneNode)==null?void 0:t.getBoundingClientRect();e&&(this.cachedPos={left:e.left,top:e.top,width:e.width,height:e.height})}setPosition(e,t){let o=this.paneNode;o&&(o.style.bottom="unset",o.style.right="unset",o.style.top=`${t}px`,o.style.left=`${e}px`)}clampPosition(){var n;let e=this.paneNode,t=e==null?void 0:e.getBoundingClientRect();if(!t)return;let o=(n=document.getElementById("dcg-header-container"))==null?void 0:n.getBoundingClientRect(),i=o?o.height:0;e.style.top&&e.style.top!=="unset"&&t.top>window.innerHeight-t.height-5&&(e.style.top=`${Math.max(i+5,window.innerHeight-t.height-5)}px`),e.style.left&&e.style.left!=="unset"&&t.left>window.innerWidth-t.width-5&&(e.style.left=`${Math.max(5,window.innerWidth-t.width-5)}px`)}updatePosition(e,t){var n;if(this.cachedPos||this.cachePosition(),!this.cachedPos)return;let o=(n=document.getElementById("dcg-header-container"))==null?void 0:n.getBoundingClientRect(),i=o?o.height:0;this.setPosition(__dcg_shared_module_exports__['Rb'](this.cachedPos.left+e,5,window.innerWidth-this.cachedPos.width-5),__dcg_shared_module_exports__['Rb'](this.cachedPos.top+t,i+5,window.innerHeight-this.cachedPos.height-5))}onMountPane(e){this.paneNode=e,this.dragDrop=new K1;let t=this.props.getCachedPosition();t&&(this.setPosition(t.left,t.top),this.cachePosition()),this.dragDrop.observeEvent("onDrop",()=>{document.body.style.cursor=this.previousCursor,this.cachedPos&&this.props.setCachedPosition(this.cachedPos),this.update()}),this.dragDrop.observeEvent("onGrab",()=>{this.cachePosition()}),this.dragDrop.observeEvent("onDrag",(o,i)=>{this.updatePosition(i.dx,i.dy)}),window.addEventListener("resize",this.resizeListener),this.resizeObserver=new ResizeObserver(()=>this.resizeListener()),this.resizeObserver.observe(e)}getPaneTabIndex(){var e,t,o;if((o=(t=(e=this.props).manageFocus)==null?void 0:t.call(e))!=null&&o.shouldBeFocused())return 0}didUpdate(){var o,i,n;let e=document.activeElement===this.paneNode,t=!!((n=(i=(o=this.props).manageFocus)==null?void 0:i.call(o))!=null&&n.shouldBeFocused());t&&!e?this.paneNode.focus():e&&!t&&this.paneNode.blur()}template(){return x("aside",{...this.props.containerProps(),onMount:this.bindFn(this.onMountPane),manageFocus:this.props.manageFocus,tabIndex:this.bindFn(this.getPaneTabIndex),children:[l("div",{onTapStart:this.bindFn(this.startDrag),class:xO.const("dcg-draggable-pane--target"),children:this.props.dragTargetContents()}),this.props.children]})}};var DS=__dcg_shared_module_exports__['e'](j()),vO=class extends DS.View{init(){this.controller=this.props.controller()}template(){return x("li",{class:()=>({"dcg-list-item":!0,"dcg-text-selectable":!0,"dcg-active":this.props.validationStatus()==="validating"}),children:[l("div",{class:DS.const("dcg-quest__step-status-container"),children:l("div",{class:()=>({"dcg-quest__step-status":!0,"dcg-unvalidated":this.props.validationStatus()==="unvalidated","dcg-validating":this.props.validationStatus()==="validating","dcg-satisfied":this.props.validationStatus()==="satisfied","dcg-unsatisfied":this.props.validationStatus()==="unsatisfied"}),children:l("div",{class:DS.const("dcg-validation-checkmark")})})}),l("div",{class:DS.const("dcg-quest__step-text"),children:this.props.title})]})}};var S6={};(function r(e,t,o,i){var n=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL);function a(){}function s(A){var O=t.exports.Promise,B=O!==void 0?O:e.Promise;return typeof B=="function"?new B(A):(A(a,a),null)}var c=function(){var A=Math.floor(16.666666666666668),O,B,V={},K=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(O=function(oe){var Z=Math.random();return V[Z]=requestAnimationFrame(function ee(ue){K===ue||K+A-1<ue?(K=ue,delete V[Z],oe()):V[Z]=requestAnimationFrame(ee)}),Z},B=function(oe){V[oe]&&cancelAnimationFrame(V[oe])}):(O=function(oe){return setTimeout(oe,A)},B=function(oe){return clearTimeout(oe)}),{frame:O,cancel:B}}(),d=function(){var A,O,B={};function V(K){function oe(Z,ee){K.postMessage({options:Z||{},callback:ee})}K.init=function(ee){var ue=ee.transferControlToOffscreen();K.postMessage({canvas:ue},[ue])},K.fire=function(ee,ue,he){if(O)return oe(ee,null),O;var ae=Math.random().toString(36).slice(2);return O=s(function($){function se(J){J.data.callback===ae&&(delete B[ae],K.removeEventListener("message",se),O=null,he(),$())}K.addEventListener("message",se),oe(ee,ae),B[ae]=se.bind(null,{data:{callback:ae}})}),O},K.reset=function(){K.postMessage({reset:!0});for(var ee in B)B[ee](),delete B[ee]}}return function(){if(A)return A;if(!o&&n){var K=["var CONFETTI, SIZE = {}, module = {};","("+r.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{A=new Worker(URL.createObjectURL(new Blob([K])))}catch(oe){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("\u{1F38A} Could not load worker",oe),null}V(A)}return A}}(),p={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function u(A,O){return O?O(A):A}function g(A){return A!=null}function h(A,O,B){return u(A&&g(A[O])?A[O]:p[O],B)}function b(A){return A<0?0:Math.floor(A)}function v(A,O){return Math.floor(Math.random()*(O-A))+A}function T(A){return parseInt(A,16)}function E(A){return A.map(I)}function I(A){var O=String(A).replace(/[^0-9a-f]/gi,"");return O.length<6&&(O=O[0]+O[0]+O[1]+O[1]+O[2]+O[2]),{r:T(O.substring(0,2)),g:T(O.substring(2,4)),b:T(O.substring(4,6))}}function _(A){var O=h(A,"origin",Object);return O.x=h(O,"x",Number),O.y=h(O,"y",Number),O}function C(A){A.width=document.documentElement.clientWidth,A.height=document.documentElement.clientHeight}function D(A){var O=A.getBoundingClientRect();A.width=O.width,A.height=O.height}function P(A){var O=document.createElement("canvas");return O.style.position="fixed",O.style.top="0px",O.style.left="0px",O.style.pointerEvents="none",O.style.zIndex=A,O}function F(A,O,B,V,K,oe,Z,ee,ue){A.save(),A.translate(O,B),A.rotate(oe),A.scale(V,K),A.arc(0,0,1,Z,ee,ue),A.restore()}function N(A){var O=A.angle*(Math.PI/180),B=A.spread*(Math.PI/180);return{x:A.x,y:A.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:A.startVelocity*.5+Math.random()*A.startVelocity,angle2D:-O+(.5*B-Math.random()*B),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:A.color,shape:A.shape,tick:0,totalTicks:A.ticks,decay:A.decay,drift:A.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:A.gravity*3,ovalScalar:.6,scalar:A.scalar}}function Y(A,O){O.x+=Math.cos(O.angle2D)*O.velocity+O.drift,O.y+=Math.sin(O.angle2D)*O.velocity+O.gravity,O.wobble+=O.wobbleSpeed,O.velocity*=O.decay,O.tiltAngle+=.1,O.tiltSin=Math.sin(O.tiltAngle),O.tiltCos=Math.cos(O.tiltAngle),O.random=Math.random()+2,O.wobbleX=O.x+10*O.scalar*Math.cos(O.wobble),O.wobbleY=O.y+10*O.scalar*Math.sin(O.wobble);var B=O.tick++/O.totalTicks,V=O.x+O.random*O.tiltCos,K=O.y+O.random*O.tiltSin,oe=O.wobbleX+O.random*O.tiltCos,Z=O.wobbleY+O.random*O.tiltSin;if(A.fillStyle="rgba("+O.color.r+", "+O.color.g+", "+O.color.b+", "+(1-B)+")",A.beginPath(),O.shape==="circle")A.ellipse?A.ellipse(O.x,O.y,Math.abs(oe-V)*O.ovalScalar,Math.abs(Z-K)*O.ovalScalar,Math.PI/10*O.wobble,0,2*Math.PI):F(A,O.x,O.y,Math.abs(oe-V)*O.ovalScalar,Math.abs(Z-K)*O.ovalScalar,Math.PI/10*O.wobble,0,2*Math.PI);else if(O.shape==="star")for(var ee=Math.PI/2*3,ue=4*O.scalar,he=8*O.scalar,ae=O.x,$=O.y,se=5,J=Math.PI/se;se--;)ae=O.x+Math.cos(ee)*he,$=O.y+Math.sin(ee)*he,A.lineTo(ae,$),ee+=J,ae=O.x+Math.cos(ee)*ue,$=O.y+Math.sin(ee)*ue,A.lineTo(ae,$),ee+=J;else A.moveTo(Math.floor(O.x),Math.floor(O.y)),A.lineTo(Math.floor(O.wobbleX),Math.floor(K)),A.lineTo(Math.floor(oe),Math.floor(Z)),A.lineTo(Math.floor(V),Math.floor(O.wobbleY));return A.closePath(),A.fill(),O.tick<O.totalTicks}function z(A,O,B,V,K){var oe=O.slice(),Z=A.getContext("2d"),ee,ue,he=s(function(ae){function $(){ee=ue=null,Z.clearRect(0,0,V.width,V.height),K(),ae()}function se(){o&&!(V.width===i.width&&V.height===i.height)&&(V.width=A.width=i.width,V.height=A.height=i.height),!V.width&&!V.height&&(B(A),V.width=A.width,V.height=A.height),Z.clearRect(0,0,V.width,V.height),oe=oe.filter(function(J){return Y(Z,J)}),oe.length?ee=c.frame(se):$()}ee=c.frame(se),ue=$});return{addFettis:function(ae){return oe=oe.concat(ae),he},canvas:A,promise:he,reset:function(){ee&&c.cancel(ee),ue&&ue()}}}function X(A,O){var B=!A,V=!!h(O||{},"resize"),K=!1,oe=h(O,"disableForReducedMotion",Boolean),Z=n&&!!h(O||{},"useWorker"),ee=Z?d():null,ue=B?C:D,he=A&&ee?!!A.__confetti_initialized:!1,ae=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,$;function se(ye,Se,Ce){for(var Te=h(ye,"particleCount",b),Ae=h(ye,"angle",Number),je=h(ye,"spread",Number),ie=h(ye,"startVelocity",Number),te=h(ye,"decay",Number),we=h(ye,"gravity",Number),Ie=h(ye,"drift",Number),He=h(ye,"colors",E),ge=h(ye,"ticks",Number),nt=h(ye,"shapes"),lt=h(ye,"scalar"),Me=_(ye),Nt=Te,Tt=[],Et=A.width*Me.x,gr=A.height*Me.y;Nt--;)Tt.push(N({x:Et,y:gr,angle:Ae,spread:je,startVelocity:ie,color:He[Nt%He.length],shape:nt[v(0,nt.length)],ticks:ge,decay:te,gravity:we,drift:Ie,scalar:lt}));return $?$.addFettis(Tt):($=z(A,Tt,ue,Se,Ce),$.promise)}function J(ye){var Se=oe||h(ye,"disableForReducedMotion",Boolean),Ce=h(ye,"zIndex",Number);if(Se&&ae)return s(function(ie){ie()});B&&$?A=$.canvas:B&&!A&&(A=P(Ce),document.body.appendChild(A)),V&&!he&&ue(A);var Te={width:A.width,height:A.height};ee&&!he&&ee.init(A),he=!0,ee&&(A.__confetti_initialized=!0);function Ae(){if(ee){var ie={getBoundingClientRect:function(){if(!B)return A.getBoundingClientRect()}};ue(ie),ee.postMessage({resize:{width:ie.width,height:ie.height}});return}Te.width=Te.height=null}function je(){$=null,V&&(K=!1,e.removeEventListener("resize",Ae)),B&&A&&(document.body.removeChild(A),A=null,he=!1)}return V&&!K&&(K=!0,e.addEventListener("resize",Ae,!1)),ee?ee.fire(ye,Te,je):se(ye,Te,je)}return J.reset=function(){ee&&ee.reset(),$&&$.reset()},J}var q;function S(){return q||(q=X(null,{useWorker:!0,resize:!0})),q}t.exports=function(){return S().apply(this,arguments)},t.exports.reset=function(){S().reset()},t.exports.create=X})(function(){return typeof window!="undefined"?window:typeof self!="undefined"?self:this||{}}(),S6,!1);var xRt=S6.exports,pse=S6.exports.create;var ds=__dcg_shared_module_exports__['e'](j());var wO=class extends ds.View{init(){this.tourController=this.props.tourController(),this.controller=this.tourController.getController()}launchConfetti(){var e;if(this.props.showAnimation()){let t=document.createElement("canvas");t.id="dcg-quest-success-canvas",t.width=window.innerWidth,t.height=window.innerHeight,(e=document.querySelector("#dcg-quest-success-container .dcg-shared-modal-transition-container"))==null||e.before(t),pse(t,{resize:!0,useWorker:!0})({particleCount:150,spread:60,colors:["#d53b90","#af2067","#ff8856"]})}}template(){return l("div",{id:ds.const("dcg-quest-success-container"),children:l(go,{title:this.const(""),size:this.const("narrow"),class:this.const("dcg-quest__success"),showX:this.const(!0),onClose:()=>this.tourController.closeSuccessModal(),i18n:()=>this.controller,ariaLabel:()=>this.controller.s("account-shell-label-success"),children:x("div",{class:ds.const("dcg-quest-success-interior"),didMount:()=>this.launchConfetti(),children:[l("div",{class:ds.const("dcg-quest-success-image"),children:l("img",{src:()=>{var e;return`/assets/img/quests/${(e=this.tourController.getCurrentQuest())==null?void 0:e.thumb}`},width:ds.const("120"),height:ds.const("120"),alt:()=>{var e;return this.controller.s("graphing-tours-narration-quest-thumbnail",{title:this.controller.raw(((e=this.tourController.getCurrentQuest())==null?void 0:e.title)||"")})}})}),x("div",{class:ds.const("dcg-quest-success-content"),children:[l("h1",{class:ds.const("dcg-unstyled-heading"),children:()=>this.controller.s("account-shell-label-success")}),l("div",{class:ds.const("quest-title"),children:()=>{var e;return this.controller.s("graphing-tours-heading-quest-success",{title:this.controller.raw(((e=this.tourController.getCurrentQuest())==null?void 0:e.title)||"")})}}),x("div",{class:ds.const("dcg-modal-actions"),children:[l("button",{class:ds.const("dcg-btn-gray-outline"),onTap:()=>this.tourController.stopQuest(),children:()=>this.controller.s("graphing-tours-label-close-quests")}),l("button",{class:ds.const("dcg-btn-pink"),onTap:()=>this.tourController.startNextQuest(),children:()=>this.controller.s("account-shell-link-try-next-quest")})]}),l("div",{class:ds.const("dcg-footer-option"),children:x(Ot,{i18n:this.const(this.controller),children:["...or"," ",l("button",{class:ds.const("dcg-unstyled-button dcg-blue-link"),onTap:()=>this.tourController.continueCurrentQuest(),children:"keep playing with this quest"}),"."]},this.const("account-shell-text-continue-with-quest"))})]})]})})})}};var oc=__dcg_shared_module_exports__['e'](j());var{For:VTe}=oc.Components,SO=class extends oc.View{init(){this.tourController=this.props.tourController(),this.controller=this.tourController.getController()}template(){return x("div",{class:oc.const("dcg-mini-tours-container"),children:[l("h2",{class:oc.const("dcg-unstyled-heading"),id:oc.const("dcg-quest-mini-tours-heading"),children:()=>this.controller.s("graphing-tours-label-quest-tours")}),l("ul",{class:oc.const("dcg-quest-mini-tours dcg-unstyled-list"),"aria-labelledby":oc.const("#dcg-quest-mini-tours-heading"),children:l(VTe,{each:()=>this.getMiniTours(),children:e=>l("li",{children:x("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-tour-tile":!0,"dcg-active":this.tourController.getActiveMinitour()===e}),"aria-current":()=>this.tourController.getActiveMinitour()===e,onTap:()=>this.onTapMinitour(e),manageFocus:this.const(ze({controller:this.controller,location:{type:"quest",location:"mini-tour-button",tour:e}})),children:[l("img",{src:()=>`/assets/img/quests/${MS[e].thumb}`,width:oc.const("90"),height:oc.const("90"),alt:()=>this.controller.s("graphing-tours-narration-tour-thumbnail",{title:this.getTourTitle(e)})}),l("div",{class:oc.const("dcg-tour-title"),children:()=>this.getTourTitle(e)})]})})})})]})}getTourTitle(e){return this.controller.s(MS[e].titleKey)}onTapMinitour(e){this.tourController.getActiveMinitour()===e?this.tourController.stopTour():this.tourController.startMiniTour(e)}getMiniTours(){var e;return((e=this.tourController.getCurrentQuest())==null?void 0:e.hintMiniTours)||[]}};var{For:OTe,If:PT}=Kn.Components,kO=class extends Kn.View{init(){this.tourController=this.props.tourController(),this.controller=this.tourController.getController()}template(){return x("div",{children:[l(PT,{predicate:()=>this.tourController.getSuccessModalIsOpen(),children:()=>l(wO,{tourController:this.props.tourController,showAnimation:()=>!Vx})}),x(yO,{getCachedPosition:()=>this.tourController.getQuestWindowPos(),setCachedPosition:e=>this.tourController.setQuestWindowPos(e.left,e.top),controller:()=>this.controller,manageFocus:this.const(ze({controller:this.controller,location:{type:"quest",location:"quest-pane"}})),containerProps:()=>({class:()=>({"dcg-quest":!0,"dcg-closing":!!this.tourController.getCurrentQuestIsClosing()}),id:this.const("dcg-quest"),"aria-labelledby":this.const("dcg-quest__title"),"aria-describedby":this.const("dcg-quest__instructions")}),dragTargetContents:()=>x("div",{class:Kn.const("dcg-quest__header"),children:[l("h1",{class:Kn.const("dcg-title"),id:Kn.const("dcg-quest__title"),children:()=>{var e;return(e=this.tourController.getCurrentQuest())==null?void 0:e.title}}),l("div",{class:Kn.const("dcg-sr-only"),id:Kn.const("dcg-quest__instructions"),children:()=>this.controller.raw("Press F6 to switch keyboard focus back and forth between this quest and the calculator.")}),l("button",{class:Kn.const("dcg-tours-btn dcg-btn-gray-outline"),manageFocus:this.const(ze({controller:this.controller,location:{type:"quest",location:"close-button"}})),"aria-label":()=>this.controller.s("graphing-tours-label-close-quest"),onTap:()=>{this.tourController.stopQuest()},children:()=>this.controller.s("graphing-tours-label-close-quest")})]}),children:[x("div",{class:Kn.const("dcg-quest__body"),children:[l(PT,{predicate:()=>!this.tourController.getHintsVisible(),children:()=>x("div",{children:[l("div",{class:Kn.const("dcg-quest__prompt"),children:()=>{var e;return(e=this.tourController.getCurrentQuest())==null?void 0:e.prompt}}),l("ul",{class:Kn.const("dcg-unstyled-list dcg-quest__steps"),children:l(OTe,{each:()=>this.tourController.getQuestGoals(),children:e=>l(vO,{validationStatus:()=>this.tourController.getGoalValidationStatus(e),title:()=>e.text,controller:()=>this.controller})},e=>e.text)})]})}),l(PT,{predicate:()=>this.tourController.getHintsVisible(),children:()=>l(SO,{tourController:this.props.tourController})})]}),x("div",{class:Kn.const("dcg-footer"),children:[x("button",{class:()=>({"dcg-main-quest-btn":!0,"dcg-btn-gray-outline":this.tourController.getHintsVisible(),"dcg-btn-pink":!this.tourController.getHintsVisible(),"dcg-disabled":this.validationButtonDisabled()}),disabled:()=>this.validationButtonDisabled()?!0:void 0,onTap:()=>this.tourController.getHintsVisible()?this.tourController.setHintsVisible(!1):!this.validationButtonDisabled()&&this.tourController.checkQuestGoals(),manageFocus:this.const(ze({controller:this.controller,location:{type:"quest",location:"check-button"}})),children:[l(PT,{predicate:()=>this.tourController.getHintsVisible(),children:()=>l("i",{class:Kn.const("dcg-icon-chevron-left"),"aria-hidden":Kn.const("true")})}),()=>this.tourController.getHintsVisible()?this.controller.s("graphing-tours-label-quest-back-to-quest"):this.controller.s("graphing-tours-label-check-progress")]}),l(PT,{predicate:()=>{var e;return(((e=this.tourController.getCurrentQuest())==null?void 0:e.hintMiniTours)||[]).length>0},children:()=>l(Oe,{gravity:this.const("n"),tooltip:()=>this.tourController.getHintsVisible()?this.controller.s("graphing-tours-label-quest-back-to-quest"):this.controller.s("graphing-tours-label-quest-take-a-tour"),children:l("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-gray-outline-icon":!0,"dcg-active":this.tourController.getHintsVisible()}),"aria-label":()=>this.tourController.getHintsVisible()?this.controller.s("graphing-tours-label-quest-back-to-quest"):this.controller.s("graphing-tours-label-quest-tours-aria"),onTap:()=>{this.tourController.setHintsVisible(!this.tourController.getHintsVisible())},manageFocus:this.const(ze({controller:this.controller,location:{type:"quest",location:"hints-button"}})),children:l("i",{class:Kn.const("dcg-icon-map"),"aria-hidden":Kn.const("true")})})})})]})]})]})}validationButtonDisabled(){let e=this.tourController.getQuestValidationStatus();return e==="validating"||e==="complete"&&this.tourController.getSuccessModalIsOpen()}};var kl=__dcg_shared_module_exports__['e'](j());var{For:RTe}=kl.Components,_O=class extends kl.View{init(){this.tourController=this.props.tourController(),this.controller=this.tourController.getController()}template(){return x(go,{title:()=>this.controller.s("account-shell-label-try-a-quest-title"),size:this.const("narrow"),class:this.const("dcg-quests-modal"),showX:this.const(!0),onClose:this.bindFn(this.closeModal),i18n:()=>this.controller,children:[l("ul",{class:kl.const("dcg-all-quest-buttons dcg-unstyled-list"),children:l(RTe,{each:()=>Object.keys(fu),children:e=>l("li",{children:x("a",{class:kl.const("dcg-quest-button"),tabIndex:kl.const("0"),role:kl.const("link"),onTap:()=>this.launchQuest(e),children:[l("img",{width:kl.const("180"),height:kl.const("180"),alt:()=>this.controller.s("graphing-tours-narration-quest-thumbnail",{title:this.controller.raw(fu[e].title)}),src:()=>`/assets/img/quests/${fu[e].thumb}`}),l("div",{children:()=>this.controller.raw(fu[e].title)})]})})})}),x("div",{class:kl.const("dcg-quests-disclaimer"),children:["Quests are an experimental new feature. Please share your thoughts with us at"," ",l("a",{class:kl.const("dcg-blue-link"),href:kl.const("mailto:feedback@desmos.com"),children:"feedback@desmos.com"}),"."]})]})}closeModal(){this.tourController.setQuestsListModalVisibility(!1)}launchQuest(e){this.tourController.startQuest(e),this.closeModal()}};var{If:use}=AS.Components,CO=class extends AS.View{init(){this.tourController=this.props.tourController(),window.addEventListener("hashchange",this.bindFn(this.update))}isQuestsModalOpen(){return this.tourController.getQuestsListModalIsOpen()}isQuestOpen(){return!!this.tourController.getQuestActive()}didMountRoot(e){this.tourController.setRootView(this,e)}template(){return x("div",{id:AS.const("dcg-quest-container"),didMount:e=>this.didMountRoot(e),children:[l(use,{predicate:this.bindFn(this.isQuestsModalOpen),children:()=>l(_O,{tourController:()=>this.tourController})}),l(use,{predicate:this.bindFn(this.isQuestOpen),children:()=>l(kO,{tourController:()=>this.tourController})})]})}};jo();var ci=__dcg_shared_module_exports__['e'](j());var hse=__dcg_shared_module_exports__['e'](j());var TO=class extends hse.View{template(){return l("span",{onMount:this.bindFn(this.addSVGLogo)})}addSVGLogo(e){e.innerHTML=`
    <svg version="1.1" class="dcg-desmos-svg-logo" id="svg-desmos" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    viewBox="0 0 909.3 188.4" xml:space="preserve">
    <title>${wt("frontpage-narration-shared-desmos-logo")}</title>
    <g>
      <path d="M129.6,0c-6.8,0-12.4,5.5-12.4,12.4v48c-27.7-25.4-70.6-24-96.7,3.1c-27.4,28.4-27.4,73.4,0,101.8
        c26.1,27.1,69.1,28.4,96.8,3v8.8c2,6.5,9,10.2,15.5,8.2c3.9-1.2,7-4.3,8.2-8.2V12.4C141.1,5.9,136.1,0.5,129.6,0z M103.9,148.7
        c-17.3,18.2-46.1,18.9-64.3,1.6c-0.6-0.5-1.1-1.1-1.6-1.6c-18.4-19.2-18.4-49.5,0-68.7c17.3-18.2,46.1-18.9,64.3-1.6
        c0.6,0.5,1.1,1.1,1.6,1.6C122.3,99.3,122.3,129.6,103.9,148.7z"/>
      <path d="M298.3,124c2.2-2.3,3.4-5.3,3.5-8.4c-0.1-19-7.6-37.2-20.9-50.7c-26.6-27.6-70.6-28.4-98.2-1.8c-0.6,0.6-1.2,1.2-1.8,1.8
        c-27.4,28.4-27.4,73.4,0,101.8c21.8,22.6,56.2,27.7,83.7,12.4c10-5.6,18.5-13.5,24.8-23.1c3.4-5.5,1.9-12.7-3.3-16.5
        c-5.5-3.3-12.6-1.7-16.4,3.5c-4.2,6.4-9.9,11.6-16.6,15.4c-6.8,3.8-14.4,5.8-22.2,5.8c-12.5,0-24.4-5.1-33.1-14.1
        c-6-6.3-10.3-14-12.4-22.4h104C292.7,127.6,296,126.3,298.3,124z M231.3,67.2c12.4,0.1,24.3,5.2,33,14.1
        c6.1,6.3,10.4,14.1,12.4,22.6h-90.7c2.1-8.5,6.3-16.3,12.4-22.6C207,72.4,218.8,67.3,231.3,67.2z"/>
      <path d="M763.5,63c-26.7-28.1-71.1-29.2-99.2-2.5c-0.8,0.8-1.7,1.6-2.5,2.5c-13.7,13.9-21.3,32.7-20.9,52.2
        c-0.2,19.3,7.2,37.8,20.7,51.6c27.7,28.2,73.1,28.7,101.3,0.9c0.3-0.3,0.6-0.6,0.9-0.9c13.4-13.8,20.9-32.4,20.7-51.7
        c0.2-19.4-7.3-38.2-21.1-51.9 M712.8,66.7c12.4,0,24.2,5.2,32.5,14.4c8.9,9.2,13.8,21.5,13.6,34.3c0.2,12.7-4.6,25-13.5,34.1
        c-8.5,9.2-20.5,14.2-33,13.9c-12.3,0.3-24.2-4.7-32.5-13.8c-8.8-9.1-13.6-21.4-13.3-34.1c-0.3-12.9,4.7-25.4,13.8-34.6
        c8.2-9.3,20-14.6,32.4-14.4"/>
      <path d="M623.8,92.6v81.9c0.3,6.8-4.9,12.7-11.8,13c-6.8,0.3-12.7-4.9-13-11.8V93.1c0-7.5-3-14.6-8.3-19.8
        c-4.3-4.7-10.2-7.6-16.5-8.1h-1.9c-7-0.1-13.6,2.9-18.2,8.2c-4.8,4.9-7.5,11.5-7.7,18.3v2l0,0v81.1c0,6.8-5.5,12.4-12.4,12.4
        c-6.5,0-11.9-4.9-12.4-11.4V91.5c-0.6-4.3-1.8-8.4-3.5-12.4c-1.2-2.3-2.6-4.5-4.3-6.4c-4.7-5.2-11.3-8.3-18.3-8.3
        c-7,0-13.6,3-18.1,8.3c-5.1,5.2-8,12.3-7.9,19.6V176c-0.8,6.3-6.1,11-12.4,10.9c-6.8,0-12.4-5.5-12.4-12.4V52.9
        c-0.7-6.8,4.2-12.9,11-13.6c5.9-0.6,11.4,3,13.1,8.7l2.9-1.9c7.4-3.9,15.6-6,23.9-5.9c12.3-0.1,24.1,4.3,33.3,12.4
        c1.1,0.9,2.1,2,3,3.1c0.9,0.7,1.7,1.5,2.5,2.4l2.2-2.4c0.9-1.1,1.9-2.2,3-3.1c9.2-8.1,21-12.5,33.2-12.4h4.3
        c10.8,0.8,21,5.1,29,12.4c0.9,1,2,1.9,3,2.9C618.9,65.3,624,78.7,623.8,92.6"/>
      <path d="M427.2,145.4c0.1,23.4-18.6,42.5-42,43h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4H384c10-0.2,17.9-8.4,17.8-18.3
        c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4c1.2-22,18.8-39.6,40.8-40.8h50.2
        c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.1c-10,0.8-17.5,9.6-16.7,19.7c0.7,8.9,7.8,15.9,16.7,16.7H385
        c5.9,0,11.8,1.2,17.2,3.7C417.7,112.8,427.2,128.4,427.2,145.4"/>
      <path d="M908.9,145.2c0,23.4-18.3,42.7-41.6,43.3h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4h50.2
        c10-0.2,17.9-8.4,17.8-18.3c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4
        c1.2-22,18.8-39.6,40.8-40.8h49.6c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.6c-10.1,0-18.2,8.2-18.2,18.2c0,0,0,0,0,0
        c0,9.9,8,18,17.8,18.1h24.8c5.9,0,11.8,1.3,17.2,3.7C898.9,112.8,908.9,128.2,908.9,145.2"/>
    </g>
    </svg>
    `}};var Ga=__dcg_shared_module_exports__['e'](j());var{If:GT}=Ga.Components,EO=class extends Ga.View{getAccountMenuArrowOffset(){var e,t;return this.props.controller().showSavedGraphsRedesign()?61:(t=(e=this.props).withArtContest)!=null&&t.call(e)?60:100}template(){let e=this.props.controller().userController;return x("span",{children:[l(GT,{predicate:()=>e.isLoggedIn(),children:()=>x("span",{children:[l(GT,{predicate:()=>e.isLoggingOut(),children:()=>l("span",{class:Ga.const("logout-progress-notice"),children:l("span",{class:Ga.const("dcg-spinner-dark")})})}),l(GT,{predicate:()=>!e.isLoggingOut(),children:()=>l("button",{class:Ga.const("dcg-unstyled-button dcg-account-link"),"dcg-menu-button":Ga.const("account"),"aria-haspopup":Ga.const("true"),"aria-expanded":()=>this.props.controller().getOpenMenu()==="account","aria-label":()=>this.props.controller().s("account-shell-label-account-information"),onTap:()=>{this.props.controller().dispatch({type:"toggle-menu",payload:"account"})},children:x("span",{class:Ga.const("email"),children:[l("div",{class:Ga.const("header-account-name dcg-variable-name"),children:()=>e.getFirstName()}),l("i",{class:Ga.const("dcg-icon-caret-down"),"aria-hidden":Ga.const("true")})]})})}),l(GT,{predicate:()=>this.props.controller().getOpenMenu()=="account",children:()=>l(sf,{type:this.const("account"),controller:this.props.controller,arrowLeft:this.bindFn(this.getAccountMenuArrowOffset)})})]})}),l(GT,{predicate:()=>!e.isLoggedIn(),children:()=>x("span",{class:Ga.const("dcg-login"),children:[l("button",{class:Ga.const("dcg-sign-in dcg-action-login dcg-btn-white-outline"),onTap:()=>{this.props.controller().dispatch({type:"show-modal",modal:"authentication",fromButton:"log-in"})},children:()=>this.props.controller().s("account-shell-button-log-in")}),l("button",{class:Ga.const("dcg-create-account dcg-btn dcg-btn-blue dcg-action-createaccount"),onTap:()=>{this.props.controller().dispatch({type:"show-modal",modal:"authentication",fromButton:"sign-up"})},children:()=>this.props.controller().s("account-shell-button-sign-up")})]})})]})}};var ic=__dcg_shared_module_exports__['e'](j());var{IfElse:FTe}=ic.Components,IO=class extends ic.View{template(){return FTe(()=>this.props.controller().showSavedGraphsRedesign(),{true:()=>l(Oe,{additionalClass:this.const("dcg-action-open-graphs-modal"),tooltip:()=>this.openGraphText(),gravity:this.const("s"),children:l("button",{"aria-label":()=>this.openGraphText(),class:ic.const("dcg-header-btn dcg-unstyled-button dcg-tooltip"),onTap:()=>{this.props.controller().dispatch({type:"show-modal",modal:"my-graphs"})},children:l("i",{class:ic.const("dcg-action-open-graphs-modal-folder-icon dcg-icon-folder-open"),"aria-hidden":ic.const("true")})})}),false:()=>l("span",{role:ic.const("button"),tabIndex:ic.const(0),"aria-label":()=>this.openGraphText(),class:ic.const("dcg-header-btn dcg-action-opendrawer dcg-tooltip"),tooltip:()=>this.openGraphText(),onTap:()=>this.props.controller().dispatch({type:"open-mygraphs"}),children:l(Oe,{tooltip:()=>this.openGraphText(),gravity:this.const("s"),offset:()=>({top:12}),children:l("i",{class:ic.const("dcg-icon-hamburger"),"aria-hidden":ic.const("true")})})})})}openGraphText(){let e=this.props.controller().getOpenText();return qr?this.props.controller().s("account-shell-label-open-graph-mac",{open_graph:e}):this.props.controller().s("account-shell-label-open-graph-pc",{open_graph:e})}};var AO=__dcg_shared_module_exports__['e'](j());var nc=__dcg_shared_module_exports__['e'](j());var Io=__dcg_shared_module_exports__['e'](j());Ut();var{If:VT,For:NTe,Input:UTe,Textarea:YTe}=Io.Components,MO=class extends Io.View{init(){this.controller=this.props.controller(),this.formErrors=[],this.feedbackInProgress=!1,this.didSendFeedbackEmail=!1}template(){return x("div",{class:Io.const("dcg-suggestions"),children:[l("div",{class:Io.const("template-errors"),children:l(VT,{predicate:()=>!!this.formErrors.length,children:()=>l("span",{children:l(NTe,{each:()=>this.formErrors,children:e=>l("div",{class:Io.const("errors"),children:l("span",{children:()=>e})})})})})}),x("form",{didMount:this.bindFn(this.didMountContactForm),class:Io.const("dcg-action-submit"),id:Io.const("support-contact-us-form"),children:[l("div",{class:Io.const("dcg-feedback-message-label"),children:()=>this.controller.s("account-shell-label-feedback-message")}),l(YTe,{placeholder:()=>this.controller.s("account-shell-label-feedback-placeholder"),didMount:this.bindFn(this.didMountTextArea),disabled:()=>!this.shouldAllowSubmission(),class:Io.const("dcg-shared-input-blue-outline dcg-contact-textarea"),name:Io.const("message"),value:()=>this.controller.getFeedbackMessage(),onInput:e=>{this.controller.dispatch({type:"update-feedback-message",message:e})}}),x("div",{class:Io.const("dcg-suggestions-expansion"),children:[l("div",{class:Io.const("dcg-feedback-email-label"),children:()=>this.controller.s("account-shell-label-feedback-email")}),l(UTe,{name:Io.const("provided-email"),class:Io.const("dcg-provided-email dcg-shared-input-blue-outline"),placeholder:()=>this.controller.s("account-shell-label-email-placeholder"),disabled:()=>!this.shouldAllowSubmission(),type:Io.const("email"),pattern:this.const(cu),value:()=>this.controller.getFeedbackEmail(),onInput:e=>{this.controller.dispatch({type:"update-feedback-email",email:e})}}),x("div",{class:Io.const("dcg-feedback-action-container"),children:[l(VT,{predicate:()=>this.feedbackInProgress,children:()=>x("div",{class:Io.const("dcg-template-processing"),children:[l("span",{class:Io.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-feedback-sending")]})}),l(VT,{predicate:()=>this.didSendFeedbackEmail,children:()=>x("div",{class:Io.const("dcg-template-sent"),children:[l("i",{class:Io.const("dcg-icon-check"),"aria-hidden":Io.const("true")}),()=>this.controller.s("account-shell-text-feedback-sent")]})}),l(VT,{predicate:this.bindFn(this.shouldAllowSubmission),children:()=>x("span",{class:Io.const("dcg-feedback-btns"),children:[l(VT,{predicate:()=>!this.controller.contactFormStartsOpen(),children:()=>l("button",{class:Io.const("dcg-unstyled-button dcg-action-closesuggestion"),onTap:this.bindFn(this.onCancel),children:()=>this.controller.s("account-shell-button-cancel")})}),l("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.submitDisabled()}),name:Io.const("submit"),type:Io.const("submit"),children:()=>this.controller.s("account-shell-button-contact-us")})]})})]})]})]})]})}willUnmount(){this.controller.getFeedbackMessage().trim()||this.controller.clearForm()}submitDisabled(){return!this.controller.getFeedbackMessage()}didMountContactForm(e){return re(e).on("submit",t=>(t.preventDefault(),this.submitForm()))}didMountTextArea(e){e.focus(),e.select()}shouldAllowSubmission(){return!this.feedbackInProgress&&!this.didSendFeedbackEmail}onCancel(){this.controller.setFeedbackMessage(""),this.controller.dispatch({type:"show-contact-form",showForm:!1})}async submitForm(){if(this.submitDisabled())return;this.didSendFeedbackEmail=!1,this.feedbackInProgress=!0,this.formErrors=[];let e=this.controller.getFeedbackMessage(),t=this.controller.product;if(t!=="graphing"&&t!=="graphing-3d"&&t!=="geometry-calculator")throw new Error(`Unexpected product: ${t}`);let o=this.controller.getFeedbackEmail(),i={message:e,state:JSON.stringify(this.controller.api.getState()),userAgent:navigator.userAgent,"provided-email":o||"",lang:this.controller.getLanguage(),todoExtraData:!0};this.controller.dispatch({type:"render"});try{t==="graphing-3d"?await yae(i):await Cae({...i,product:t}),this.didSendFeedbackEmail=!0,setTimeout(()=>{this.controller.clearForm(),this.didSendFeedbackEmail=!1,this.controller.dispatch({type:"render"})},2e3)}catch(n){this.formErrors=Qh(n,this.controller.s).map(a=>this.controller.raw(a))}finally{this.feedbackInProgress=!1,this.controller.dispatch({type:"render"})}}};var{IfElse:gse}=nc.Components,mf=class extends nc.View{handleClick(){this.props.controller().dispatch({type:"show-contact-form",showForm:!0})}template(){return l("div",{class:nc.const("dcg-hide-on-mobile"),"aria-label":()=>this.props.controller().s("account-shell-label-feedback"),children:gse(()=>this.props.controller().requestedContactForm()||this.props.controller().contactFormStartsOpen(),{true:()=>l("div",{class:nc.const("dcg-resources-content dcg-feedback-content"),children:l(MO,{controller:this.props.controller})}),false:()=>l("div",{class:nc.const("dcg-contact-us"),children:x("button",{class:nc.const("dcg-unstyled-button dcg-contact-link"),"aria-expanded":nc.const("false"),"aria-controls":nc.const("support-contact-us-form"),onTap:this.bindFn(this.handleClick),children:[l("i",{class:nc.const("dcg-icon-mail"),"aria-hidden":nc.const("true")}),gse(()=>this.props.controller().product==="graphing-3d",{true:()=>l("span",{children:()=>this.props.controller().s("account-shell-link-send-feedback")}),false:()=>l("span",{children:()=>this.props.controller().s("account-shell-link-email-support")})})]})})})})}};var Va=__dcg_shared_module_exports__['e'](j());var OT=class extends Va.View{template(){return x("a",{href:()=>this.props.href(),target:Va.const("_blank"),class:Va.const("dcg-resource-link"),children:[l("i",{class:()=>this.props.icon(),"aria-hidden":Va.const("true")}),x("span",{children:[()=>this.props.title()," "]})]})}},ff=class extends Va.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.productUserGuideUrl={graphing:Zc[this.controller.languageController.getLanguage()].userGuideURL,"geometry-calculator":"https://docs.google.com/document/d/1u4fhQsXWzdCWRGfTdJSuAg9xtyiDk-wmkIAsUkb2L20/preview","graphing-3d":"https://docs.google.com/document/d/1jDJC0Zw7cB82SNEc04m5HGQHaXYaJK62iZM88ojNYwI/preview"}}template(){return x(Dp,{children:[l("h2",{class:Va.const("dcg-unstyled-heading dcg-help-menu-title"),children:()=>this.controller.s("account-shell-heading-resources")}),x("div",{class:Va.const("dcg-resources-content dcg-resource-links"),role:Va.const("region"),"aria-label":()=>this.controller.s("account-shell-heading-resources"),children:[l(OT,{href:()=>this.productUserGuideUrl[this.controller.getProduct()],icon:Va.const("dcg-icon-book"),title:()=>this.controller.s("account-shell-link-user-guide")}),l(OT,{href:Va.const("https://help.desmos.com/"),icon:Va.const("dcg-icon-comments"),title:()=>this.controller.s("account-shell-link-help-center")}),x("button",{class:Va.const("dcg-unstyled-button dcg-resource-link dcg-action-show-hotkeys"),onTap:()=>this.controller.dispatch({type:"show-modal",modal:"hotkeys"}),children:[l("i",{class:Va.const("dcg-icon-keyboard"),"aria-hidden":Va.const("true")}),l("span",{children:()=>this.controller.s("account-shell-link-keyboard-shortcuts")})]}),l(OT,{href:()=>"https://help.desmos.com/hc/en-us/articles/212235786-Supported-Functions",icon:Va.const("dcg-icon-check"),title:()=>this.controller.s("shared-heading-keyboard-shortcuts-supported-functions")})]})]})}};var DO=class extends AO.View{init(){this.controller=this.props.controller()}template(){return x(Ri,{type:()=>"help",label:()=>this.controller.s("account-shell-label-help-menu"),controller:this.props.controller,arrowLeft:this.controller.showSavedGraphsRedesign()?this.const(253):void 0,children:[l(ff,{controller:()=>this.controller}),l("h2",{class:AO.const("dcg-unstyled-heading dcg-help-menu-title dcg-hide-on-mobile"),children:()=>this.controller.s("account-shell-heading-contact-us")}),l(mf,{controller:this.props.controller})]})}};jo();jo();var Jt=__dcg_shared_module_exports__['e'](j());var{For:mse,If:k6,IfElse:LO,SwitchUnion:BTe,IfDefined:KTe}=Jt.Components,PO=class extends Jt.View{init(){this.entry=this.props.entry(),this.controller=this.props.controller()}getThumbAlt(){var e,t;return(e=this.entry)!=null&&e.title&&this.entry.title!==""?this.controller.s("frontpage-narration-art-contest-image-of-graph",{graphTitle:this.entry.title}):(t=this.entry)!=null&&t.name?this.controller.s("frontpage-narration-art-contest-image-of-graph-by",{name:this.entry.name}):""}template(){return l("div",{children:LO(()=>!!this.entry&&!!this.entry.url,{true:()=>l("img",{class:Jt.const("dcg-submission-image"),src:()=>{var e;return(e=this.entry)==null?void 0:e.thumb},alt:this.bindFn(this.getThumbAlt)}),false:()=>l("i",{class:()=>this.getIconName(this.props.product()),"aria-hidden":Jt.const("true")})})})}getIconName(e){switch(e){case"geometry-calculator":return"dcg-icon-geometry";case"graphing":return"dcg-icon-graphing";case"graphing-3d":return"dcg-icon-3d"}}},GO=class extends Jt.View{init(){this.controller=this.props.controller(),this.checkForExistingSubmission()}getScreen(){let e=Hi("artStatus");if(e==="authenticate")return"needs-authentication";if(e==="fetching")return"fetching";if(e==="failed")return"fetch-failed";if(this.controller.userController.isLoggedIn()){if(this.isFetchingSubmissions)return"fetching";if(this.fetchSubmissionsFailed)return"fetch-failed"}else return"needs-authentication";return"showing-submissions"}getTitle(e){switch(e){case"geometry-calculator":return this.controller.s("frontpage-link-shared-geometry-short");case"graphing":return this.controller.s("frontpage-link-shared-graphing-calculator-short");case"graphing-3d":return this.controller.s("frontpage-link-shared-3d-calculator-short")}}getDeadlineNotice(){return this.isSubmissionEligible()?this.controller.s("account-shell-text-art-contest-deadline-notice"):this.controller.isGeometry()?this.controller.s("account-shell-text-art-contest-create-construction-notice"):this.controller.s("account-shell-text-art-contest-create-graph-notice")}isSubmissionEligible(){return this.controller.isGraphComplexEnoughForContest()&&!this.controller.graphsController.willSaveCopy()}getPreviousSubmission(){return this.controller.artController.getSubmission({year:Yf,product:this.controller.getProduct()})}template(){return x(Ri,{type:()=>"art-contest",label:()=>this.controller.s("account-shell-heading-desmos-art-expo"),controller:this.props.controller,children:[l("h2",{class:Jt.const("dcg-art-contest-header"),children:()=>this.controller.s("account-shell-heading-desmos-art-expo")}),x("div",{class:Jt.const("dcg-art-contest-announcement"),children:[l(k6,{predicate:()=>this.controller.getArtExpoStatus()==="open",children:()=>x("div",{class:Jt.const("dcg-contest-top-paragraph"),children:[LO(()=>this.controller.isGeometry(),{true:()=>x(Ot,{i18n:this.props.controller,children:["Have a construction that you're proud of? We'd love to see it! Learn more at"," ",x("a",{href:Jt.const("/art"),target:Jt.const("_blank"),class:Jt.const("dcg-blue-link"),children:["desmos.com/art",l("span",{class:Jt.const("dcg-sr-only"),children:" (opens in new tab)"})]}),"."]},this.const("account-shell-text-art-contest-has-arrived-construction")),false:()=>x(Ot,{i18n:this.props.controller,children:["Have a graph that you're proud of? We'd love to see it! Learn more at"," ",x("a",{href:Jt.const("/art"),target:Jt.const("_blank"),class:Jt.const("dcg-blue-link"),children:["desmos.com/art",l("span",{class:Jt.const("dcg-sr-only"),children:" (opens in new tab)"})]}),"."]},this.const("account-shell-text-art-contest-has-arrived"))}),l("i",{class:Jt.const("dcg-icon-sparkle"),"aria-hidden":Jt.const("true")})]})}),l(k6,{predicate:()=>this.controller.getArtExpoStatus()==="closed",children:()=>x("div",{class:Jt.const("dcg-contest-top-paragraph dcg-contest-top-paragraph--closed"),children:[x(Ot,{i18n:this.props.controller,children:["Submissions are now closed. Check out"," ",x("a",{href:Jt.const("/art"),target:Jt.const("_blank"),class:Jt.const("dcg-blue-link"),children:["desmos.com/art",l("span",{class:Jt.const("dcg-sr-only"),children:" (opens in new tab)"})]})," ","for announcements about the 2024 featured graph gallery."]},this.const("account-shell-text-art-contest-has-closed")),l("i",{class:Jt.const("dcg-icon-sparkle"),"aria-hidden":Jt.const("true")})]})})]}),l(k6,{predicate:()=>this.controller.getArtExpoStatus()==="open",children:()=>BTe(()=>this.getScreen(),{"needs-authentication":()=>x("div",{class:Jt.const("dcg-contest-status-section"),children:[l("button",{class:Jt.const("dcg-btn-purple-outline"),onTap:()=>{this.props.controller().dispatch({type:"show-modal",modal:"authentication"})},children:()=>this.controller.s("account-shell-error-art-contest-logged-out")}),l("div",{class:Jt.const("dcg-contest-deadline-notice"),children:()=>this.controller.s("account-shell-text-art-contest-deadline-notice")})]}),fetching:()=>x("div",{class:Jt.const("dcg-contest-status-section"),children:[l("ul",{class:Jt.const("dcg-submissions"),children:l(mse,{each:()=>Lu,children:e=>l("li",{class:Jt.const("dcg-submission dcg-submission-loading")})})}),l("div",{class:Jt.const("dcg-contest-deadline-notice"),children:()=>this.controller.s("account-shell-text-art-contest-loading-submissions")})]}),"fetch-failed":()=>x("div",{class:Jt.const("dcg-contest-status-section"),children:[l("div",{class:Jt.const("dcg-error-message"),children:()=>this.controller.s("frontpage-error-something-went-wrong-try-again-later")}),l("button",{class:Jt.const("dcg-btn-purple-outline"),onTap:this.bindFn(this.checkForExistingSubmission),children:()=>this.controller.s("account-shell-button-mygraphs-try-again")})]}),"showing-submissions":()=>x("div",{class:Jt.const("dcg-contest-status-section"),children:[l("ul",{class:Jt.const("dcg-submissions"),children:l(mse,{each:()=>Lu,children:e=>{var o;let t=(o=this.submissions)==null?void 0:o.find(i=>(i==null?void 0:i.product)===e);return x("li",{children:[LO(()=>this.isCurrentProduct(e),{false:()=>l("a",{class:()=>({"dcg-submission":!0,"dcg-not-yet-submitted":!t}),href:()=>this.getEntryURL(e,t),target:Jt.const("_blank"),"aria-label":()=>this.getTileAriaLabel(e,t),children:l(PO,{entry:()=>t,product:()=>e,controller:()=>this.controller})}),true:()=>l("button",{class:()=>({"dcg-disabled":this.disableTileLink(e,t),"dcg-submission":!0,"dcg-not-yet-submitted":!t}),disabled:()=>this.disableTileLink(e,t)?!0:void 0,"aria-label":()=>this.getTileAriaLabel(e,t),onTap:()=>{this.disableTileLink(e,t)||this.controller.dispatch({type:"show-modal",modal:"contest-submission",currentSubmission:this.currentToolSubmission})},children:l(PO,{entry:()=>t,product:()=>e,controller:()=>this.controller})})}),l("h3",{class:Jt.const("dcg-submission-title"),children:this.const(this.getTitle(e))})]})}})}),l("div",{children:l("button",{class:()=>({"dcg-btn-purple":!0,"dcg-disabled":this.disableButtonLink()}),onTap:()=>{this.controller.logEvent({category:"art-contest",action:"open-modal"}),this.controller.dispatch({type:"show-modal",modal:"contest-submission",currentSubmission:this.getCurrentSubmission()})},disabled:()=>this.disableButtonLink()?!0:void 0,children:LO(()=>!!this.getCurrentSubmissionId(),{true:()=>l("span",{children:()=>this.controller.isGraphComplexEnoughForContest()?this.controller.s("account-shell-text-art-contest-view-or-update-submission"):this.controller.s("account-shell-text-art-contest-view-submission")}),false:()=>l("span",{children:()=>this.controller.getProduct()==="geometry-calculator"?this.controller.s("account-shell-text-art-contest-submit-construction"):this.controller.s("account-shell-text-art-contest-submit-graph")})})})}),l("div",{class:Jt.const("dcg-contest-deadline-notice"),children:()=>this.getDeadlineNotice()}),KTe(()=>this.getPreviousSubmission(),e=>x("div",{class:Jt.const("dcg-contest__previous-submission"),children:[l("a",{class:Jt.const("dcg-unstyled-link dcg-contest__previous-submission-thumbnail"),href:()=>e().url,target:Jt.const("_blank"),children:l("img",{src:()=>e().thumb,alt:()=>e().title||this.controller.s("account-shell-text-untitled")})}),x("div",{class:Jt.const("dcg-contest__previous-submission-description"),children:[l("div",{class:Jt.const("dcg-contest__previous-submission-title"),children:()=>this.controller.s("account-shell-text-art-contest-last-year-link")}),l("a",{href:()=>e().url,target:Jt.const("_blank"),class:Jt.const("dcg-blue-link dcg-contest__previous-submission-link"),children:()=>e().title||this.controller.s("account-shell-text-untitled")})]})]}))]})})})]})}disableButtonLink(){return!this.isSubmissionEligible()&&!this.currentToolSubmission}disableTileLink(e,t){return this.isCurrentProduct(e)&&!t&&!this.isSubmissionEligible()}getEntryURL(e,t){if(t&&t.url)return t.url;switch(e){case"geometry-calculator":return"/geometry";case"graphing":return"/calculator";case"graphing-3d":return"/3d"}}getTileAriaLabel(e,t){if(this.disableTileLink(e,t))return;let o="";if(t)switch(e){case"geometry-calculator":o=this.controller.s("account-shell-text-art-contest-your-geometry-submission");break;case"graphing":o=this.controller.s("account-shell-text-art-contest-your-2d-submission");break;case"graphing-3d":o=this.controller.s("account-shell-text-art-contest-your-3d-submission");break}else switch(e){case"geometry-calculator":o=this.controller.s("frontpage-link-shared-geometry-short");break;case"graphing":o=this.controller.s("frontpage-link-shared-graphing-calculator-short");break;case"graphing-3d":o=this.controller.s("frontpage-link-shared-3d-calculator-short");break}return this.isCurrentProduct(e)?o:this.controller.s("shared-label-opens-in-new-tab-suffix",{title:o})}isCurrentProduct(e){return this.controller.getProduct()===e}getCurrentSubmissionId(){let e=this.getCurrentSubmission();if("submission_id"in e&&e.submission_id)return e.submission_id}getCurrentSubmission(){var o,i,n,a;if(this.currentToolSubmission)return this.currentToolSubmission;let e=this.controller.getProduct(),t=(i=(o=this.submissions)==null?void 0:o[0])==null?void 0:i.country;return dae(t)||(t=void 0),{product:e,graph_hash:this.controller.graphsController.getCurrentGraphHash(),title:this.controller.graphsController.getCurrentGraphTitle(),submitting_for_someone_else:!1,birth_year:(a=(n=this.submissions)==null?void 0:n[0])==null?void 0:a.birth_year,country:t}}async checkForExistingSubmission(){if(this.controller.userController.isLoggedIn()){this.isFetchingSubmissions=!0,this.fetchSubmissionsFailed=!1;try{let e=await cf({year:Hs});if(!this._isMounted)return;let t=e.filter(o=>(o==null?void 0:o.user_id)===this.controller.userController.getUserId()&&!(o!=null&&o.submitting_for_someone_else));this.currentToolSubmission=t.find(o=>o.product===this.controller.getProduct()),this.submissions=t}catch(e){if(!this._isMounted)return;this.fetchSubmissionsFailed=!0}finally{this._isMounted&&(this.isFetchingSubmissions=!1,this.update())}}}};jo();var Bc=__dcg_shared_module_exports__['e'](j());var zTe=[{href:"/calculator",name:"2d",text:()=>wt("frontpage-link-shared-graphing-calculator")},{href:"/scientific",name:"scientific",text:()=>wt("frontpage-link-shared-scientific-calculator")},{href:"/fourfunction",name:"fourfunction",text:()=>wt("frontpage-link-shared-four-function-calculator")},{href:"/practice",name:"practice",text:()=>wt("frontpage-link-shared-test-practice")},{href:"/matrix",name:"matrix",text:()=>wt("frontpage-link-shared-matrix-calculator")},{href:"/geometry",name:"geometry",text:()=>wt("frontpage-link-shared-geometry-tool")},{href:"/3d",name:"3d",text:()=>wt("frontpage-link-shared-3d-calculator")}],qTe=[{href:"/about",text:()=>wt("frontpage-link-shared-about-us")},{href:"/careers",text:()=>wt("frontpage-link-shared-careers")},{href:"https://help.desmos.com",text:()=>wt("frontpage-link-shared-help-center")},{href:"/accessibility",text:()=>wt("shared-calculator-label-accessibility")},{href:"/testing",text:()=>wt("frontpage-link-shared-assessments")},{href:"/partners",text:()=>wt("frontpage-link-shared-partnerships")},{href:"/guiding-principles",text:()=>wt("frontpage-link-shared-guiding-principles")},{href:"/design-principles",text:()=>wt("frontpage-link-shared-design-principles")},{href:"//store.desmos.com",text:()=>wt("frontpage-link-shared-store")},{href:"https://blog.desmos.com",text:()=>wt("frontpage-link-shared-blog")}],fse={MATH_TOOLS:{links:zTe,title:()=>wt("frontpage-link-header-math-tools")},RESOURCES:{links:qTe,title:()=>wt("frontpage-link-header-resources")}};var{For:HTe,IfDefined:WTe}=Bc.Components,VO=class extends Bc.View{constructor(){super(...arguments),this.controller=this.props.controller()}getTools(){return fse.MATH_TOOLS.links}isCurrentTool(e){return this.controller.getProduct()===e}template(){return l(Ri,{type:()=>"current-tool",label:()=>this.controller.s("account-shell-label-tool-menu"),controller:this.props.controller,arrowLeft:this.const(222),children:l("div",{children:l("ul",{class:Bc.const("dcg-unstyled-list"),children:l(HTe,{each:()=>this.getTools(),children:({href:e,name:t,text:o})=>l("li",{children:WTe(()=>$8(t),i=>x("button",{onTap:()=>this.isCurrentTool(i())?this.controller.dispatch({type:"toggle-menu",payload:"current-tool"}):this.controller.dispatch({type:"open-blank-graph-modal",product:i()}),class:Bc.const("dcg-unstyled-button dcg-current-tool-menu__tool-option"),children:[l("div",{class:Bc.const("dcg-current-tool-menu__tool-icon"),children:l(Rs,{name:()=>t,ariaHidden:this.const("true")})}),l("span",{class:Bc.const("dcg-current-tool-menu__tool-text"),children:o})]}),()=>x("a",{href:()=>e,class:Bc.const("dcg-unstyled-link dcg-current-tool-menu__tool-option"),children:[l("div",{class:Bc.const("dcg-current-tool-menu__tool-icon"),children:l(Rs,{name:()=>t,ariaHidden:this.const("true")})}),l("span",{class:Bc.const("dcg-current-tool-menu__tool-text"),children:o})]}))})},({name:e})=>e)})})})}};var RO=__dcg_shared_module_exports__['e'](j());var OO=class extends RO.View{init(){this.controller=this.props.controller()}template(){return x(Ri,{type:()=>"help",label:()=>this.controller.s("account-shell-label-help-menu"),controller:this.props.controller,arrowLeft:this.controller.showSavedGraphsRedesign()?this.const(253):void 0,children:[l(ff,{controller:()=>this.controller}),l("h2",{class:RO.const("dcg-unstyled-heading dcg-help-menu-title dcg-hide-on-mobile"),children:()=>this.controller.s("account-shell-heading-contact-us")}),l(mf,{controller:this.props.controller})]})}};var ac=__dcg_shared_module_exports__['e'](j());var bse=__dcg_shared_module_exports__['e'](j());var jTe=28,XTe=10,_6=4,FO=class extends bse.View{template(){return l(Ri,{type:this.const("graph-actions"),label:()=>this.props.controller().s("account-shell-label-graph-actions"),controller:this.props.controller,left:()=>this.left,arrowLeft:()=>this.arrowLeft,children:l(Jl,{class:this.const("dcg-graph-actions-list"),options:this.bindFn(this.getOptions),onTap:this.bindFn(this.tapOption)})})}didMount(){var n,a,s,c;let e=document.querySelector(".dcg-graph-actions-dropdown-anchor"),t=((a=(n=yo(e))==null?void 0:n.left)!=null?a:0)+((s=e.getBoundingClientRect().width)!=null?s:0)/2,i=((c=document.querySelector(".dcg-graph-actions-container").getBoundingClientRect().width)!=null?c:0)-jTe/2-XTe;t<=i+_6?(this.left=_6,this.arrowLeft=t-_6):(this.left=t-i,this.arrowLeft=i),this.update()}getOptions(){let e=[];return e.push({title:()=>this.props.controller().s("account-shell-button-rename"),icon:"dcg-icon-pencil",class:"dcg-blue-link",action:()=>{this.props.controller().dispatch({type:"show-modal",modal:"rename"})}}),this.props.controller().graphsController.wasCurrentGraphEverSaved()&&e.push({title:()=>this.props.controller().s("account-shell-button-duplicate"),icon:"dcg-icon-duplicate",action:()=>this.props.controller().dispatch({type:"show-modal",modal:"duplicate"})}),e}tapOption(e){e.action!==void 0&&e.action(),!e.preventClose&&("href"in e?e.isDeepLink&&setTimeout(()=>this.closeMenu()):this.closeMenu())}closeMenu(){this.props.controller().dispatch({type:"toggle-menu",payload:"graph-actions"})}};var zd=__dcg_shared_module_exports__['e'](j());var{SwitchUnion:$Te}=zd.Components,NO=class extends zd.View{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}getSaveStatus(){return this.graphsController.isSaving()?"saving":this.graphsController.showSaveSuccessNotice()?"save-success":"default"}getSaveMessage(){return this.graphsController.willSaveCopy()?this.controller.s("account-shell-button-save-copy"):this.controller.s("account-shell-button-save")}template(){return l("span",{children:$Te(()=>this.getSaveStatus(),{saving:()=>l("span",{class:zd.const("dcg-if-user save-btn-container"),children:l("span",{class:zd.const("saving-notice"),children:l("span",{class:zd.const("dcg-spinner-dark")})})}),"save-success":()=>x("span",{class:zd.const("dcg-save-success"),children:[l("i",{class:zd.const("dcg-icon-check"),"aria-hidden":zd.const("true")}),()=>this.controller.s("shared-calculator-label-saved")]}),default:()=>l("span",{class:()=>({"dcg-if-user save-btn-container":!0}),children:l(Oe,{tooltip:()=>this.controller.isSaveEnabled()?this.saveChangesText():this.controller.s("account-shell-label-no-unsaved-changes"),offset:()=>({top:7}),children:l("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-action-save":!0,"tooltip-offset":!0,"dcg-btn-blue":this.controller.isSaveEnabled(),"dcg-disabled":!this.controller.isSaveEnabled()}),disabled:()=>this.controller.isSaveEnabled()?void 0:!0,onTap:()=>{this.controller.isSaveEnabled()&&this.controller.simpleSave()},children:()=>this.getSaveMessage()})})})})})}saveChangesText(){return qr?this.controller.s("account-shell-label-save-changes-mac"):this.controller.s("account-shell-label-save-changes-pc")}};var{If:yse}=ac.Components,UO=class extends ac.View{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}getTitle(){return this.graphsController.getCurrentGraphTitle()}template(){return x("span",{class:ac.const("title-div"),children:[x("span",{role:ac.const("button"),class:ac.const("dcg-variable-title-container"),"dcg-menu-button":()=>this.shouldShowDropdown()?"graph-actions":void 0,tabIndex:ac.const(0),onTap:e=>{this.shouldShowDropdown()&&this.openGraphActionsDropdown(e)},"aria-haspopup":()=>this.shouldShowDropdown(),"aria-expanded":()=>this.props.controller().getOpenMenu()=="graph-actions","aria-label":()=>this.shouldShowDropdown()?this.controller.s("account-shell-label-graph-actions"):void 0,children:[l("h1",{class:ac.const("dcg-variable-title dcg-tooltip"),children:()=>this.getTitle()}),l(yse,{predicate:this.bindFn(this.shouldShowDropdown),children:()=>l("span",{class:ac.const("dcg-graph-actions-dropdown-anchor"),children:l("i",{class:ac.const("dcg-icon-caret-down"),"aria-hidden":ac.const("true")})})}),l(yse,{predicate:()=>this.controller.getOpenMenu()==="graph-actions",children:()=>l(FO,{controller:this.props.controller})})]}),l(NO,{controller:this.props.controller})]})}shouldShowDropdown(){return this.graphsController.wasCurrentGraphEverSaved()}openGraphActionsDropdown(e){this.props.controller().dispatch({type:"toggle-menu",payload:"graph-actions"}),e&&e.device==="keyboard"&&this.controller.getOpenMenu()!=="share"&&document.querySelectorAll(".dcg-graph-actions-container .dcg-dropdown-choice:not(.dcg-disabled)")[0].focus()}};var RT=__dcg_shared_module_exports__['e'](j());var Xy=class extends RT.View{init(){this.controller=this.props.controller()}template(){return this.controller=this.props.controller(),l(Oe,{tooltip:this.props.tooltip,gravity:this.bindFn(this.getGravity),children:l("button",{"aria-haspopup":RT.const("true"),"aria-label":()=>this.props.label(),"aria-expanded":()=>this.isMenuOpen(),class:()=>({"dcg-unstyled-button":!0,"dcg-header-btn":!0,[this.getBtnClass()]:!0,"dcg-tooltip":!0,"dcg-active":this.isMenuOpen()}),"dcg-menu-button":this.props.name,onTap:this.props.onTap,children:l("i",{class:this.props.icon,"aria-hidden":RT.const("true")})})})}getBtnClass(){switch(this.props.name()){case"help":return"dcg-action-help";case"language":return"dcg-action-language";case"share":return"dcg-action-share";case"art-contest":return"dcg-action-contest"}}getGravity(){return this.props.gravity?this.props.gravity():"s"}isMenuOpen(){return this.controller.getOpenMenu()===this.props.name()}};var FT=__dcg_shared_module_exports__['e'](j());var bu=__dcg_shared_module_exports__['e'](j()),{For:JTe,If:ZTe}=bu.Components,C6=class extends bu.View{init(){this.controller=this.props.controller(),this.tourController=this.controller.tourController}getBaseUrl(){switch(this.controller.getProduct()){case"graphing-3d":return"3d";case"geometry-calculator":return"geometry";default:return"calculator"}}template(){return x("a",{class:bu.const("dcg-feature"),href:()=>`/${this.getBaseUrl()}?tour=${this.props.name()}`,target:bu.const("_blank"),onTap:e=>{var o;let t=e.altKey||e.shiftKey||e.metaKey;if(!this.tourController.shouldPopupTour(this.props.name())&&!t)return(o=e.originalEvent)==null||o.preventDefault(),this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.tourController.startTour(this.props.name())},children:[l("span",{class:()=>({"dcg-thumb":!0,[this.getTourClassName()]:!0})}),()=>this.controller.s(this.props.titleKey())]})}getTourClassName(){switch(this.props.name()){case"regressions":return"dcg-regressions-thumb";case"restrictions":return"dcg-restrictions-thumb";case"sliders":return"dcg-sliders-thumb";case"tables":return"dcg-tables-thumb";default:return"dcg-unknown-thumb"}}},YO=class extends bu.View{init(){this.controller=this.props.controller()}template(){return l("div",{class:bu.const("dcg-tours-content"),role:bu.const("region"),"aria-label":()=>this.controller.s("account-shell-heading-tours"),children:l(JTe,{each:()=>Object.keys(this.props.tours()),children:e=>l(ZTe,{predicate:()=>!this.props.tours()[e].hideInHelp,children:()=>l(C6,{name:()=>e,titleKey:()=>this.props.tours()[e]?this.props.tours()[e].titleKey:"",controller:this.props.controller})})})})}};var BO=class extends FT.View{init(){this.controller=this.props.controller()}template(){return x(Ri,{type:()=>"help",label:()=>this.controller.s("account-shell-label-help-menu"),controller:this.props.controller,arrowLeft:this.controller.showSavedGraphsRedesign()?this.const(253):void 0,children:[l("h2",{class:FT.const("dcg-unstyled-heading dcg-help-menu-title"),children:()=>this.controller.s("account-shell-heading-tours")}),l(YO,{controller:this.props.controller,tours:this.const(LT)}),l(ff,{controller:this.props.controller}),l("h2",{class:FT.const("dcg-unstyled-heading dcg-help-menu-title dcg-hide-on-mobile"),children:()=>this.controller.s("account-shell-heading-contact-us")}),l(mf,{controller:this.props.controller})]})}};var xse=__dcg_shared_module_exports__['e'](j());var rg=__dcg_shared_module_exports__['e'](j()),{For:QTe}=rg.Components,KO=class extends rg.View{init(){this.i18n=this.props.i18n()}template(){return l("div",{class:()=>({"dcg-language-picker":!0,"dcg-two-columns":this.getLanguages().length>7}),children:l("ul",{class:rg.const("dcg-unstyled-list dcg-languages-list"),role:rg.const("menu"),children:l(QTe,{each:()=>this.getLanguages(),children:e=>l("li",{class:()=>({"dcg-listitem":!0,"dcg-language-option":!0,"dcg-selected":this.isLanguageSelected(e)}),lang:this.const(this.getLangCode(e)),role:rg.const("menuitem"),tabIndex:rg.const("0"),"aria-current":()=>this.isLanguageSelected(e),onTap:()=>this.updateLang(e),children:()=>this.i18n.raw(this.getLanguageDisplayName(e))})})})})}getCurrentLang(){return this.props.currentLang()}getLanguages(){return Object.keys(this.props.getAllLangs())}getLanguageDisplayName(e){return this.props.getAllLangs()[e].display_name}updateLang(e){let t=this.props.getAllLangs()[e].code;return this.props.onLangChosen(t)}getLangCode(e){return this.props.getAllLangs()[e].code}isLanguageSelected(e){return this.getLangCode(e)===this.getCurrentLang()}};var eEe=_H(),zO=class extends xse.View{init(){this.controller=this.props.controller(),this.languageController=this.controller.languageController}template(){return l(Ri,{type:()=>"language",label:()=>this.controller.s("account-shell-narration-language-menu"),controller:this.props.controller,title:()=>this.props.controller().s("shared-title-language-menu"),arrowLeft:this.controller.showSavedGraphsRedesign()?this.const(250):void 0,children:l(KO,{getAllLangs:()=>eEe,currentLang:()=>this.languageController.getLanguage(),onLangChosen:e=>{this.controller.dispatch({type:"fetch-language",code:e}),this.controller.dispatch({type:"toggle-menu",payload:"none"})},i18n:this.props.controller})})}};var ro=__dcg_shared_module_exports__['e'](j());var{If:$y,IfDefined:tEe,Textarea:rEe}=ro.Components,qO=class extends ro.View{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,Sr({category:"share",action:"open-menu"})}getGraph(){var e;return((e=this.graphsController.lastShareStatus)==null?void 0:e.state)==="loaded"?this.graphsController.lastShareStatus.data:void 0}isSharing(){var e;return((e=this.graphsController.lastShareStatus)==null?void 0:e.state)==="loading"}getErrorMessage(){let e=this.graphsController.lastShareStatus;return(e==null?void 0:e.state)==="error"?e.message:void 0}template(){return l(Ri,{title:this.bindFn(this.getTitle),type:ro.const("share"),label:()=>this.controller.s("account-shell-narration-share-options"),controller:this.props.controller,children:x("div",{class:ro.const("dcg-share-menu-legacy"),children:[l($y,{predicate:()=>this.isSharing(),children:()=>x("div",{class:ro.const("dcg-loading"),children:[l("span",{class:ro.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-loading")]})}),tEe(()=>this.getErrorMessage(),e=>x("div",{class:ro.const("dcg-failed"),children:[l("span",{"aria-live":ro.const("assertive"),"aria-atomic":ro.const(!0),children:()=>e()+" "}),l("button",{class:ro.const("dcg-unstyled-button dcg-action-retry"),onTap:()=>(this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.controller.dispatch({type:"toggle-menu",payload:"share"})),children:()=>this.controller.s("account-shell-button-retry-now")}),()=>` ${this.controller.s("account-shell-text-or")} `,l("button",{class:ro.const("dcg-unstyled-button dcg-action-close"),onTap:()=>this.controller.dispatch({type:"toggle-menu",payload:"share"}),children:()=>this.controller.s("account-shell-button-cancel")}),ro.const(".")]})),l($y,{predicate:()=>!this.isSharing()&&!this.getErrorMessage(),children:()=>x("div",{class:ro.const("dcg-loaded"),didMount:this.bindFn(this.didMountLoaded),children:[()=>this.controller.s("account-shell-label-share-link"),l(df,{link:()=>this.getGraphPath(),triggerLogEvent:()=>Sr({category:"share",action:"copy-link"}),strings:()=>SS(this.controller)}),l($y,{predicate:()=>!this.controller.shouldDisablePrintAndExport(),children:()=>x("div",{class:ro.const("dcg-share-actions"),children:[l($y,{predicate:()=>this.controller.product!=="geometry-calculator",children:()=>x("span",{class:ro.const("dcg-print-link"),onTap:this.bindFn(this.print),tabIndex:ro.const("0"),role:ro.const("link"),children:[l("i",{class:ro.const("dcg-icon-print"),"aria-hidden":ro.const("true")}),l("span",{children:()=>this.controller.s("account-shell-button-print")})]})}),l($y,{predicate:()=>this.controller.product!=="graphing-3d",children:()=>x("span",{class:ro.const("dcg-export-image-link"),onTap:this.bindFn(this.exportImage),tabIndex:ro.const("0"),role:ro.const("link"),children:[l("i",{class:ro.const("dcg-icon-export"),"aria-hidden":ro.const("true")}),l("span",{children:()=>this.controller.s("account-shell-button-export-image")})]})}),l($y,{predicate:()=>this.controller.product!=="geometry-calculator",children:()=>x("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-embed-link":!0,"dcg-selected":this.embedVisible}),onTap:this.bindFn(this.toggleEmbedVisible),"aria-pressed":()=>this.embedVisible,children:[l("i",{class:ro.const("dcg-icon-embed"),"aria-hidden":ro.const("true")}),l("span",{children:()=>this.controller.s("account-shell-button-embed")})]})})]})}),l($y,{predicate:()=>this.embedVisible,children:()=>l("div",{class:ro.const("dcg-embed-div share-div"),didMount:this.bindFn(this.didMountTextarea),children:l(rEe,{rows:ro.const("6"),class:ro.const("select-all first-input dcg-variable-htmlembedcode"),value:()=>this.getGraphEmbedCode(),onInput:()=>{}})})})]})})]})})}didMountTextarea(e){let t=e.querySelector("textarea");t.select(),t.focus()}toggleEmbedVisible(){this.embedVisible=!this.embedVisible,Sr({category:"share",action:"embed-graph"}),this._isMounted&&this.update()}didMountLoaded(){this.embedVisible=!1}print(){Sr({category:"share",action:"print-graph"}),window.print()}exportImage(){Sr({category:"share",action:"export-image"}),this.controller.dispatch({type:"show-modal",modal:"export-image"})}getGraphPath(){var e;return((e=this.getGraph())==null?void 0:e.getURL())||""}getGraphEmbedCode(){return this.getGraph()?`<iframe src="${`${this.getGraphPath()}?embed`}" width="500" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>`:""}getTitle(){return this.graphsController.isGeometryTool()?this.controller.s("account-shell-heading-share-construction"):this.controller.s("account-shell-heading-share-graph")}};var Jy=__dcg_shared_module_exports__['e'](j());var li=__dcg_shared_module_exports__['e'](j());var{If:vse,Textarea:oEe,SwitchUnion:wse}=li.Components,NT=class extends li.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}onBack(){this.controller.dispatch({type:"update-share-menu-state",shareMenuState:"main"})}getUrlFetchStatus(){return this.props.viewType()==="share-my-graph"?this.graphsController.isSaving()?{state:"loading"}:{state:"loaded",data:this.graphsController.currentGraph}:this.graphsController.lastShareStatus||{state:"error",message:"Error sharing graph"}}getTitle(){return this.props.viewType()==="share-my-graph"?this.controller.s("account-shell-label-share-your-save"):this.controller.s("account-shell-label-share-your-snapshot")}getGraphEmbedCode(e){return`<iframe src="${`${e}?embed`}" width="500" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>`}template(){return x("div",{class:li.const("dcg-share-menu__share-link"),children:[x("div",{class:li.const("dcg-share-menu__header"),children:[l("button",{class:li.const("dcg-shared-back-button dcg-share-menu__back-button"),"aria-label":()=>this.controller.s("shared-button-back"),tabIndex:li.const(0),onTap:this.bindFn(this.onBack),children:l("i",{class:li.const("dcg-icon-chevron-left dcg-shared-back-button__icon"),"aria-hidden":li.const("true")})}),l("h1",{class:li.const("dcg-unstyled-heading dcg-share-menu__title"),children:()=>this.getTitle()})]}),wse(()=>this.getUrlFetchStatus(),"state",{loading:()=>l(du,{class:this.const("dcg-share-menu__loading")}),error:()=>l("div",{}),loaded:e=>x(Dp,{children:[l(vse,{predicate:()=>this.props.viewType()==="share-my-graph",children:()=>x("div",{class:li.const("dcg-share-menu__graph-details"),children:[l("img",{src:()=>this.graphsController.currentGraph.thumbUrl,class:li.const("dcg-share-menu__graph-thumbnail")}),x("div",{class:li.const("dcg-share-menu__graph-description"),children:[l("div",{class:li.const("dcg-share-menu__graph-title"),children:()=>this.graphsController.currentGraph.title}),l("div",{class:li.const("dcg-share-menu__graph-display-date"),children:()=>this.controller.unpack(this.graphsController.currentGraph.displayDate())})]})]})}),l(df,{link:()=>e().data.getURL(),strings:()=>SS(this.controller)}),l(vse,{predicate:()=>this.controller.getProduct()==="graphing",children:()=>l("div",{class:li.const("dcg-share-menu__embed"),children:l(oEe,{rows:this.const("6"),class:this.const("dcg-share-menu__embed-textarea"),value:()=>this.getGraphEmbedCode(e().data.getURL()),onInput:()=>{}})})}),l(T6,{controller:this.props.controller,viewType:this.props.viewType})]})})]})}},T6=class extends li.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}saveGraph(){this.controller.saveFromShareMenu()}shareSavedGraph(){this.controller.dispatch({type:"update-share-menu-state",shareMenuState:"share-my-graph"})}getNoteType(){return this.props.viewType()==="share-my-graph"?"my-graph":this.graphsController.wasCurrentGraphEverSaved()&&!this.graphsController.hasUnsavedChanges()?"saved-snapshot":"unsaved-snapshot"}template(){return l("div",{class:li.const("dcg-share-menu__note"),children:wse(()=>this.getNoteType(),{"my-graph":()=>x(Ot,{i18n:this.const(this.controller),children:[l("b",{children:"Note"}),": No one but you can edit this graph, but other people will see your updates."]},this.const("account-shell-text-share-menu-my-graph-description")),"unsaved-snapshot":()=>x(Ot,{i18n:this.const(this.controller),children:[l("b",{children:"Note"}),": You can't edit or delete a graph that is shared as a snapshot."," ",l("a",{class:li.const("dcg-share-menu__link"),tabIndex:li.const("0"),onTap:this.bindFn(this.saveGraph),children:"Save this graph"})," ","before sharing if you want to come back to it."]},this.const("account-shell-text-share-menu-unsaved-snapshot-description")),"saved-snapshot":()=>x(Ot,{i18n:this.const(this.controller),children:[l("b",{children:"Note"}),": You can't edit or delete a graph that is shared as a snapshot. If you want to come back to it,"," ",l("a",{class:li.const("dcg-share-menu__link"),tabIndex:li.const("0"),onTap:this.bindFn(this.shareSavedGraph),children:"share your save"})," ","instead."]},this.const("account-shell-text-share-menu-saved-snapshot-description"))})})}};var sc=__dcg_shared_module_exports__['e'](j());var LS=__dcg_shared_module_exports__['e'](j()),HO=class extends LS.View{constructor(){super(...arguments),this.controller=this.props.controller()}exportImage(){this.controller.dispatch({type:"show-modal",modal:"export-image"})}template(){return x("button",{class:LS.const("dcg-btn-gray-outline dcg-share-menu__sharing-options-button"),onTap:this.bindFn(this.exportImage),children:[l("i",{class:LS.const("dcg-icon-export"),"aria-hidden":LS.const("true")}),()=>this.controller.s("account-shell-button-export-image")]})}};var PS=__dcg_shared_module_exports__['e'](j()),WO=class extends PS.View{constructor(){super(...arguments),this.controller=this.props.controller()}print(){window.print()}template(){return x("button",{class:PS.const("dcg-btn-gray-outline dcg-share-menu__sharing-options-button"),onTap:this.bindFn(this.print),children:[l("i",{class:PS.const("dcg-icon-print"),"aria-hidden":PS.const("true")}),()=>this.controller.s("account-shell-button-print")]})}};var{If:E6,IfElse:iEe}=sc.Components,jO=class extends sc.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}getActionButtonText(){return this.showLoggedOutShareMenu()?this.controller.s("account-shell-label-log-in-and-save"):this.graphsController.wasCurrentGraphEverSaved()&&!this.graphsController.hasUnsavedChanges()?this.controller.s("account-shell-label-share-your-save"):this.controller.s("account-shell-label-save-graph-before-share")}onActionButtonTap(){this.graphsController.wasCurrentGraphEverSaved()&&!this.graphsController.hasUnsavedChanges()?this.controller.dispatch({type:"update-share-menu-state",shareMenuState:"share-my-graph"}):this.controller.saveFromShareMenu()}generateSnapshot(){this.controller.dispatch({type:"update-share-menu-state",shareMenuState:"share-snapshot"})}showLoggedOutShareMenu(){return this.controller.showSavedGraphsRedesignLoggedOut()}showLoadingIndicator(){return this.graphsController.isSaving()}template(){return x("div",{class:sc.const("dcg-share-menu__share-your-graph"),children:[l("h1",{class:sc.const("dcg-unstyled-heading dcg-share-menu__title"),children:()=>this.controller.s("account-shell-heading-share-graph")}),iEe(()=>this.showLoadingIndicator(),{true:()=>l(du,{class:this.const("dcg-share-menu__loading")}),false:()=>x(Dp,{children:[l(E6,{predicate:()=>this.showLoggedOutShareMenu(),children:()=>l("h2",{class:sc.const("dcg-unstyled-heading dcg-share-menu__subtitle"),children:()=>this.controller.s("account-shell-text-share-menu-log-in-prompt")})}),l("button",{class:sc.const("dcg-btn-blue dcg-share-menu__action-button"),onTap:()=>this.onActionButtonTap(),children:()=>this.getActionButtonText()}),l("div",{class:sc.const("dcg-share-menu__alternative-action-section"),children:x(Ot,{i18n:this.const(this.controller),children:["or"," ",l("a",{class:sc.const("dcg-share-menu__link"),tabIndex:sc.const("0"),onTap:this.bindFn(this.generateSnapshot),children:"generate a snapshot"}),"."]},this.const("account-shell-text-share-menu-quick-link"))}),l(E6,{predicate:()=>this.controller.getProduct()!=="graphing-3d",children:()=>x("div",{class:sc.const("dcg-share-menu__sharing-options"),children:[l(HO,{controller:this.props.controller}),l(E6,{predicate:()=>this.controller.getProduct()!=="geometry-calculator",children:()=>l(WO,{controller:this.props.controller})})]})})]})})]})}};var{SwitchUnion:nEe}=Jy.Components,XO=class extends Jy.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.myGraphsController=this.controller.mygraphsController}template(){return l(Ri,{type:Jy.const("share"),label:()=>this.controller.s("account-shell-narration-share-options"),controller:this.props.controller,arrowLeft:this.controller.showSavedGraphsRedesign()?this.const(202):void 0,children:l("div",{class:Jy.const("dcg-share-menu"),children:nEe(()=>this.myGraphsController.shareMenuState,{main:()=>l(jO,{controller:this.props.controller}),"share-snapshot":()=>l(NT,{controller:this.props.controller,viewType:this.const("share-snapshot")}),"share-my-graph":()=>l(NT,{controller:this.props.controller,viewType:this.const("share-my-graph")})})})})}};var{SwitchUnion:aEe,If:bf,IfElse:sEe}=ci.Components,$O=class extends ci.View{init(){this.controller=this.props.controller(),this.userController=this.controller.userController,this.graphsController=this.controller.graphsController}getShareTooltipText(){return this.graphsController.isGeometryTool()?this.controller.s("account-shell-label-share-construction"):this.controller.s("account-shell-label-share-graph")}showArtExpoHeaderIcon(){return this.controller.getArtExpoStatus()==="open"||this.controller.getArtExpoStatus()==="closed"&&this.controller.artController.hasSubmissions(Hs)}template(){return l("div",{class:ci.const("dcg-header"),children:x("div",{class:ci.const("dcg-header-desktop"),children:[x("div",{class:ci.const("align-left-container"),children:[l(IO,{controller:this.props.controller}),l(UO,{controller:this.props.controller})]}),l("div",{class:ci.const("align-center-container"),children:l("a",{href:ci.const("/"),target:ci.const("_blank"),class:ci.const("dcg-home-link"),children:l(TO,{})})}),l(bf,{predicate:()=>this.userController.didLogoutFail(),children:()=>l("div",{class:ci.const("dcg-toast-container"),children:l("div",{class:ci.const("dcg-toast"),children:()=>this.controller.s("account-shell-error-logging-out")})})}),x("div",{class:ci.const("align-right-container"),children:[l(EO,{controller:this.props.controller,withArtContest:()=>this.showArtExpoHeaderIcon()}),l(bf,{predicate:()=>this.showArtExpoHeaderIcon(),children:()=>x("span",{children:[l(Xy,{controller:this.props.controller,label:()=>wt("account-shell-label-math-art-expo"),tooltip:()=>this.controller.s("account-shell-label-math-art-expo"),icon:ci.const("dcg-icon-sparkle"),name:()=>"art-contest",onTap:()=>{this.controller.dispatch({type:"toggle-menu",payload:"art-contest"})}}),l(bf,{predicate:()=>this.controller.getOpenMenu()==="art-contest",children:()=>l(GO,{controller:this.props.controller})})]})}),l(Xy,{controller:this.props.controller,label:()=>wt("account-shell-label-share"),tooltip:this.bindFn(this.getShareTooltipText),icon:ci.const("dcg-icon-share"),name:()=>"share",onTap:()=>{this.controller.dispatch({type:"toggle-menu",payload:"share"})}}),l(bf,{predicate:()=>this.controller.getOpenMenu()==="share",children:()=>sEe(()=>this.controller.showSavedGraphsRedesign(),{true:()=>l(XO,{controller:this.props.controller}),false:()=>l(qO,{controller:this.props.controller})})}),l(Xy,{controller:this.props.controller,label:()=>wt("account-shell-label-help"),tooltip:()=>this.controller.s("account-shell-label-help"),icon:ci.const("dcg-icon-question-sign"),name:ci.const("help"),onTap:()=>{this.controller.dispatch({type:"toggle-menu",payload:"help"})}}),l(bf,{predicate:()=>this.controller.getOpenMenu()==="help",children:()=>aEe(()=>this.props.controller().product,{"geometry-calculator":()=>l(OO,{controller:this.props.controller}),"graphing-3d":()=>l(DO,{controller:this.props.controller}),graphing:()=>l(BO,{controller:this.props.controller})})}),l(Xy,{controller:this.props.controller,gravity:this.const("s"),label:()=>wt("account-shell-label-language"),tooltip:()=>this.controller.s("account-shell-label-language"),icon:ci.const("dcg-icon-world"),name:ci.const("language"),onTap:()=>{this.controller.dispatch({type:"toggle-menu",payload:"language"})}}),l(bf,{predicate:()=>this.controller.getOpenMenu()==="language",children:()=>l(zO,{controller:this.props.controller})}),l(bf,{predicate:()=>this.controller.showSavedGraphsRedesign(),children:()=>l(Oe,{tooltip:()=>this.controller.s("account-shell-label-tools"),gravity:this.const("s"),children:l("button",{"aria-haspopup":ci.const("true"),"aria-label":()=>wt("account-shell-label-tools"),"aria-expanded":()=>this.controller.getOpenMenu()==="current-tool",class:()=>({"dcg-unstyled-button":!0,"dcg-header-btn":!0,"dcg-action-current-tool":!0,"dcg-tooltip":!0,"dcg-active":this.controller.getOpenMenu()==="current-tool"}),"dcg-menu-button":ci.const("current-tool"),onTap:()=>{this.controller.dispatch({type:"toggle-menu",payload:"current-tool"})},children:l("div",{class:ci.const("dcg-header-bar__product-icon"),children:l(Rs,{name:()=>hg(this.controller.product),ariaHidden:this.const("true")})})})})}),l(bf,{predicate:()=>this.controller.getOpenMenu()==="current-tool",children:()=>l(VO,{controller:this.props.controller})})]})]})})}focusElement(e){var t;(t=document.querySelector(e))==null||t.focus()}};var JO=class extends Sse.View{init(){this.controller=this.props.controller()}template(){return x("div",{children:[l($O,{controller:this.props.controller}),l(CO,{tourController:()=>this.controller.tourController})]})}};jo();En();function kse(r){if(!r)return"";if(r.match(/[\d@_&\.\']/))return r;let e=r.split(" ");return e[0].length>=3?e[0]:r}var lEe=r=>{var t,o,i;let e=r;return!!(e!=null&&e.isMaintenanceMode)||(e==null?void 0:e.status)===503&&((i=(o=(t=e==null?void 0:e.responseJSON)==null?void 0:t.errors)==null?void 0:o[0])==null?void 0:i.key)==="maintenance_mode"},ZO=class extends Pi{constructor(t){super();this.dispatch=t;this._authenticationStep={name:"authenticate"};this.loggedIn="not-checked";this.logoutFailed=!1;this.loggingOut=!1;this.userId="";this.name="";this.email="";this.teacher=!1;this.featureFlags=[];this.emailVerificationStatus="";xH(()=>this.logout())}perform(t){switch(t.type){case"set-authentication-step":this._authenticationStep=t.payload;break;case"reset-authentication-step":this._authenticationStep={name:"authenticate"};break;case"get-email-registration-status":this.onGetEmailRegistrationStatus(t.payload);break;case"email-log-in":this.onEmailLogIn(t.payload);break;case"email-sign-up":this.onEmailSignUp(t.payload);break;case"previous-step":this.onPreviousStep();break;case"update-classifications":this.onUpdateClassifications(t.payload);break;case"sso-log-in":this.onSsoLogin(t.payload.provider);break;default:}}getAuthenticationStep(){return this._authenticationStep}async desmosLogin(t){let o=await rne(t);return this.completeLogin(o)}triggerSsoLoginEvent(t){this.triggerEvent("ssoLogin",t)}onSsoLogin(t){this._authenticationStep={...this._authenticationStep,status:{type:"loading"}},this.triggerSsoLoginEvent(t)}async askServerIfLoggedIn({fromSsoWindow:t=!1}={fromSsoWindow:!1}){let o;try{o=await P2()}catch(i){lEe(i)&&this.triggerEvent("detectedMaintenanceMode",void 0),t&&this.dispatch({type:"reset-authentication-step"}),this.completeLogout();return}o.isMaintenanceMode&&this.triggerEvent("detectedMaintenanceMode",void 0),this.completeLogin(o)}async driveCallback({isNewUser:t}){t?this.dispatch({type:"set-authentication-step",payload:{name:"sso-confirmation"}}):this.dispatch({type:"close-modal"});let o;try{o=await P2()}catch(i){this.logout();return}this.completeLogin(o)}isTeacher(){return!!this.teacher}async setNameLegacy(t){let o=await lne(t);this.name=o.name||"",this.triggerEvent("userUpdated",void 0),this.dispatch({type:"render"})}async setNameDetail(t){let o=await cne({...t,source:"user"});this.name=o.name||"",this.nameDetail=o.nameDetail,this.triggerEvent("userUpdated",void 0),this.dispatch({type:"render"})}recoverPassword(t){return dne(t)}completeLogin(t){this.loggedIn="logged-in",this.userId=t.userId,this.name=t.name,this.nameDetail=t.nameDetail,this.email=t.email,this.featureFlags=t.featureFlags,this.emailVerificationStatus=t.emailVerificationStatus,this.teacher=t.isTeacher,this.dispatch({type:"login-changed"}),this.triggerEvent("userUpdated",void 0)}async logout(){this.loggingOut=!0,this.triggerEvent("logout",void 0),this.dispatch({type:"render"});try{await YB(),this.completeLogout()}catch(t){await P2().then(()=>this._onLogoutFailure()).catch(o=>{"loggedIn"in o&&!o.loggedIn?this.completeLogout():this._onLogoutFailure()})}finally{this.loggingOut=!1,this.dispatch({type:"render"})}}completeLogout(){this.loggedIn="logged-out",this.logoutFailed=!1,this.userId="",this.email="",this.name="",this.featureFlags=[],this.emailVerificationStatus="",this.teacher=!1,this.dispatch({type:"login-changed"}),this.triggerEvent("userUpdated",void 0)}_onLogoutFailure(){this.logoutFailed=!0,this.dispatch({type:"render"}),setTimeout(()=>{this.logoutFailed=!1,this.dispatch({type:"render"})},2e3)}initiateAccountDeletion(t){return pne(t)}getEmailChangeToken(){return Hi("changeToken")}initiateEmailChange(t){return une(t)}async setEmail(t){await hne(t),this.email=t.newEmail||"",this.emailVerificationStatus="VERIFYING",this.triggerEvent("userUpdated",void 0),this.dispatch({type:"render"})}async updateFeatureFlags(t){let o=await gne(t);this.featureFlags=o.featureFlags,this.triggerEvent("userUpdated",void 0)}getFeatureFlags(){return this.featureFlags}hasFeatureFlag(t){return this.featureFlags.some(o=>o===t)}getLoginStatus(){return this.loggedIn}isLoggedIn(){return this.loggedIn==="logged-in"}isLoggingOut(){return!!this.loggingOut}didLogoutFail(){return!!this.logoutFailed}getEmail(){return this.email}getFirstName(){return kse(this.name)}getFullName(){return this.name}getNameDetail(){return this.nameDetail}getUserId(){return this.userId}getVerificationStatus(){return this.emailVerificationStatus}getUserAsJSON(){if(this.isLoggedIn())return{userId:this.userId,email:this.email,name:this.name,nameDetail:this.nameDetail,emailVerificationStatus:this.emailVerificationStatus,featureFlags:this.featureFlags,isTeacher:this.isTeacher()}}parseError(t,o){return t instanceof Error?t:new Error([...new Set(Qh(t,o))].join(`
`))}fetchEmailRegistration(t){return yne(t)}async onGetEmailRegistrationStatus({email:t}){var n,a;if(this._authenticationStep.name!=="authenticate")throw new Error("Cannot get email registration status outside of authentication step.");if(((a=(n=this._authenticationStep)==null?void 0:n.status)==null?void 0:a.type)==="loading")return;this._authenticationStep={name:"authenticate",status:{type:"loading"}};let o=await this.fetchEmailRegistration(t);if(o.type!=="resolved"){this.dispatch({type:"set-authentication-step",payload:{name:"authenticate",status:{type:"error",message:o.error.message}}});return}if(!o.value.isRegistered){this.dispatch({type:"set-authentication-step",payload:{name:"email-signup"}});return}if(!o.value.ssoProvider||o.value.usesPassword){this.dispatch({type:"set-authentication-step",payload:{name:"email-login"}});return}let i;switch(o.value.ssoProvider){case"googleSso":i="google";break;case"appleSso":i="apple";break;default:let s=o.value.ssoProvider;throw new Error(`Unexpected ssoProvider ${s}`)}this.dispatch({type:"set-authentication-step",payload:{name:"previously-sso",ssoProvider:i}}),Sr({category:"authentication",action:"show-previous-sso-login"})}async onEmailLogIn({language:t,email:o,password:i,i18n:n}){var d;if(this._authenticationStep.name!=="email-login")throw new Error("Cannot log in with email outside of email-login step.");if(((d=this._authenticationStep.status)==null?void 0:d.type)==="loading")return;this._authenticationStep={name:"email-login",status:{type:"loading"}};let a=!1,s=await ine({lang:t,email:o});s.type!=="error"&&(a=s.value.pendingDeletion);let c=await qf(()=>this.desmosLogin({email:o,password:i,lang:t}),p=>this.parseError(p,n));if(c.type==="error"){this.dispatch({type:"set-authentication-step",payload:{name:"email-login",status:{type:"error",message:c.error.message}}});return}a?this.dispatch({type:"show-modal",modal:"account-reenabled"}):this.dispatch({type:"close-modal"})}async onEmailSignUp({i18n:t,language:o,firstName:i,lastName:n,email:a,password:s,classifications:c}){var p;if(this._authenticationStep.name!=="email-signup")throw new Error("Cannot sign up with email outside of email-signup step.");if(((p=this._authenticationStep.status)==null?void 0:p.type)==="loading")return;this._authenticationStep={name:"email-signup",status:{type:"loading"}};let d=await qf(()=>nne({lang:o,name:i,userProvidedName:{given:i,family:n||void 0},email:a,password:s,metadata:c?{selfClassifications:c}:void 0}),u=>this.parseError(u,t));if(d.type==="error"){this.dispatch({type:"set-authentication-step",payload:{name:"email-signup",status:{type:"error",message:d.error.message}}});return}this.completeLogin(d.value),this.dispatch({type:"close-modal"})}onPreviousStep(){["email-login","email-signup","previously-sso"].includes(this._authenticationStep.name)&&(Sr({category:"authentication",action:"navigate-back",name:this._authenticationStep.name}),this._authenticationStep={name:"authenticate"})}onUpdateClassifications({classifications:t}){t.length!==0&&sne(this.getUserId(),{classifications:t})}async fetchPermanentlyDismissedNotices(){let t;try{t=await mne()}catch(o){Er("Error fetching persistent dismissed notices.");return}this.permanentlyDismissedNotices=t}hasPermanentlyDismissedNotice(t){var o;return this.isLoggedIn()&&(!this.permanentlyDismissedNotices||((o=this.permanentlyDismissedNotices)==null?void 0:o.includes(t)))}async dismissNoticePermanently(t){var o;try{await fne(t)}catch(i){Er(`Error dismissing notice: ${t}.`);return}Sr({category:"notice",action:t,name:"dismiss-permanently"}),this.permanentlyDismissedNotices=[...(o=this.permanentlyDismissedNotices)!=null?o:[],t]}resetPermanentDismissedNotices(){this.permanentlyDismissedNotices=void 0}};var _se=5*60*1e3;Uo("fastAutoSave")&&(_se=5*1e3);var eR=class{constructor(e){this._queuedCallbacks=[];this.hasTemporarilyDismissedNotices=!1;this.myGraphsToastData={};this.views=[];var o,i;this.dispatcher=new Ay,this.dispatch=n=>{Xf("dispatch::header-controller",{type:n.type}),this.dispatcher.dispatch(n);let a;for(;a=this._queuedCallbacks.shift();)a()},this.product=e.product,this.languageController=new mT(this.dispatch),this.s=this.languageController.s.bind(this.languageController),this.raw=this.languageController.raw.bind(this.languageController),this.unpack=this.languageController.unpack.bind(this.languageController),this.getLanguage=this.languageController.getLanguage.bind(this.languageController),this.initApiOptions={configOverrides:e.apiOptionOverrides,onCalcReady:e.onCalcReady,setUpSubscribers:e.setUpCalcSubscribers},this.initializeApi(),this.userController=new ZO(this.dispatch),this.userController.observeEvent("detectedMaintenanceMode",()=>I6(this.api._calc.controller,this.s));let t={getApi:()=>this.api,getProduct:()=>this.product,dispatch:this.dispatch,s:this.s,getLanguage:this.getLanguage,showSavedGraphsRedesign:()=>this.showSavedGraphsRedesign(),runAfterDispatch:n=>this.runAfterDispatch(n)};this.graphsController=new K2({examplesJSONs:e.exampleGraphs,randomSeed:e.randomSeed,parentParams:t}),this.tourController=new fO(this.graphsController,t),this.mygraphsController=new z2(this.graphsController,this.userController,t),this.artController=new G2(this.dispatch),this._openMenu="none",this._requestedContactForm=!1,this._feedbackMessage="",this.state={},this.hookupControllers(),this.hookupHotkeys(),this.hookupObserveEvents(),this.dispatcher.register(n=>{switch(this.logDispatches(n),n.type){case"save-graph":this.saveGraph(n.payload);break;case"close-modal":this.closeModal();break;case"toggle-menu":this.setOpenMenu(n.payload);break;case"open-blank-graph-sidebar":this.tourController.stopQuest(),this.mygraphsController.closeMygraphs(),this.graphsController.openBlankGraph();break;case"open-blank-graph-modal":this.tourController.stopQuest(),this.ensureCorrectProduct(n.product),this.closeModal(),this.graphsController.openBlankGraph(),this._openMenu==="current-tool"&&this.closeMenu();break;case"open-mygraphs":this.setOpenMenu("none",!1),this.mygraphsController.openMygraphs(),this.isLoggedIn()&&this.graphsController.millisecondsSinceSync()>2*60*1e3&&this.refreshGraphs();break;case"close-mygraphs":this.mygraphsController.closeMygraphs();break;case"render":break;case"show-modal":this.showModal(n);break;case"show-contact-form":this._requestedContactForm=n.showForm;break;case"update-feedback-email":this.setFeedbackEmail(n.email);break;case"update-feedback-message":this.setFeedbackMessage(n.message);break;case"close-notice":let a=this.getNoticeName();if(!a)return;this.hasTemporarilyDismissedNotices=!0,this.isLoggedIn()&&bK(a)?this.userController.dismissNoticePermanently(a).then(()=>{this.triggerRender()}):this.logEvent({category:"notice",action:a,name:"dismiss-temporarily"}),n.focusFirstExpression&&this.focusFirstExpression();break;case"fetch-language":this.languageController.fetchLanguage(n.code);break;case"set-language":this.api.updateSettings({language:n.code}),this.languageController.setLanguage(n.code);break;case"login-changed":if(this.mygraphsController.recoveryAttempted=!1,!this.isLoggedIn()){this.graphsController.clear(),this.mygraphsController.perform({type:"clear-folders"}),this.userController.resetPermanentDismissedNotices(),this.artController.resetSubmissionsByYear();break}this.refreshGraphs(),Promise.all([this.userController.fetchPermanentlyDismissedNotices(),this.artController.fetchSubmissions(Yf,Hs)]).then(()=>{this.triggerRender()});break;case"undo-start-quest":this.tourController.stopQuestFromUndo(),this.graphsController.restorePreviousGraph(),this.startQuestFromRestore();break;case"update-graphs-state":this.handleUpdateGraphsState(n);break;case"fetch-graph-from-modal":this.tourController.stopQuest(),this.ensureCorrectProduct(n.graph.product),this.mygraphsController.fetchAndOpenGraphFromModal(n.graph);break;case"open-fetched-graph-from-modal":this.mygraphsController.openFetchedGraph(n.graph,{showRestoreToast:!0}),this.closeModal(),qx(),this.mygraphsController.setModalLoadingState(!1);break;case"open-fetched-graph-on-init":this.openInitialGraph(n.graph);break;case"set-my-graphs-search-filter":this.mygraphsController.setSearchFilter(n.searchFilter);break;case"load-more-graphs-from-modal":this.mygraphsController.loadMoreGraphsFromModal();break;case"set-my-graphs-modal-mobile-search-open":this.mygraphsController.setModalMobileSearchOpen(n.isModalMobileSearchOpen);break;case"select-mygraphs-modal-tab":this.mygraphsController.setSelectedTab(n.selectedTab);break;case"select-saved-graphs-option":this.mygraphsController.setSelectedSavedGraphsOption(n.selectedOption);break;case"update-mygraphs-layout":this.mygraphsController.setGraphLayout(n.selectedGraphLayout);break;case"update-example-gallery-filter":this.mygraphsController.setExampleGalleryFilter(n.productFilter);break;case"update-share-menu-state":this.mygraphsController.setShareMenuState(n.shareMenuState);break;case"set-mygraphs-sort-field":this.mygraphsController.setSortField(n.sortField);break;case"toggle-mygraphs-sort-direction":this.mygraphsController.toggleSortDirection();break;case"toggle-graph-selected":this.mygraphsController.toggleGraphSelected(n.graph);break;case"set-selected-graph":this.mygraphsController.setSelectedGraph(n.graph);break;case"deselect-all-graphs":this.mygraphsController.deselectAllGraphs();break;case"set-single-graph-action-menu":case"set-move-graph-menu-input-focused":case"set-move-graph-menu-search-filter":case"reset-single-graph-action-menu":case"set-folders":case"create-folder":case"toggle-folder-selection":case"rename-folder":case"update-folder":case"set-open-folder":case"move-graphs-complete":case"move-graphs-to-folder":case"remove-graphs-from-folder":case"clear-last-created-folder-id":case"clear-folders":this.mygraphsController.perform(n);break;case"set-authentication-step":case"reset-authentication-step":case"get-email-registration-status":case"email-log-in":case"email-sign-up":case"previous-step":case"update-classifications":case"sso-log-in":this.userController.perform(n);break;case"my-graphs-toast-show":this.showModalToast(n.myGraphsToast);break;case"my-graphs-toast-close":this.closeModalToast();break;case"my-graphs-toast-undo":let s=this.myGraphsToastData.undoCallback;s&&this.runAfterDispatch(s),this.closeModalToast();break;case"my-graphs-toast-learn-more":let c=this.myGraphsToastData.learnMoreCallback;c&&this.runAfterDispatch(c),this.myGraphsToastData={};break;default:}this.triggerRender()}),this.lastRecoveryState={},this.checkRecoveryState(),(i=(o=this.initApiOptions).setUpSubscribers)==null||i.call(o,this.api,this),[QO.mountToNode(JO,document.getElementById("dcg-header-container"),{controller:()=>this}),QO.mountToNode(Y2,document.getElementById("dcg-modal-container"),{controller:()=>this}),QO.mountToNode(J2,document.getElementById("mygraphs-container"),{controller:()=>this,makeAPI:(n,a)=>new(this.getCalculatorConstructor())(n,{...a,settingsMenu:!1,keypad:!1,zoomButtons:!1,branding:!1,border:!1,disableScrollFix:!0,expressions:!1,hideGeoUI:!0})})].forEach(n=>this.registerView(n)),Kz(n=>{this.product==="graphing-3d"&&n.addMetadata("webgl",Oae())})}isRegisteredView(e){return this.views.some(t=>t instanceof e.constructor)}registerView(e){if(this.isRegisteredView(e))throw new Error("A shell view cannot be registered with its controller more than once.");this.views.push(e)}unregisterView(e){if(!this.isRegisteredView(e))throw new Error("A shell view cannot be unregistered from its controller if it was never registered.");this.views.splice(this.views.findIndex(t=>t instanceof e.constructor),1)}runAfterDispatch(e){this.dispatcher.isDispatching()?this._queuedCallbacks.push(e):e()}showSavedGraphsRedesign(){return this.userController.hasFeatureFlag("savedGraphsRedesign")&&!!Hi("savedGraphsRedesign")}showSavedGraphsRedesignLoggedOut(){return this.showSavedGraphsRedesign()&&Hi("savedGraphsRedesign")==="loggedOut"}onOpenGraphFromSidebar(e){this.tourController.stopQuest(),this.mygraphsController.onOpenGraphFromSidebar(e)}openInitialGraph(e){this.showSavedGraphsRedesign()&&this.ensureCorrectProduct(e.product),this.mygraphsController.openFetchedGraph(e,{showRestoreToast:!1})}handleUpdateGraphsState(e){switch(e.update.type){case"set-saved-graphs":this._isSavingGraph&&(this.showSavedGraphsRedesign()&&this.isSharingGraph()?this.runAfterDispatch(()=>this.saveFromShareMenu()):this.runAfterDispatch(()=>this.simpleSave()));break;case"fetch-recovery-graphs-legacy":this.mygraphsController.recoveryAttempted=!0;break;case"restore-previous-graph":this.showSavedGraphsRedesign()&&this.graphsController.previousGraph&&this.ensureCorrectProduct(this.graphsController.previousGraph.product);break}this.graphsController.updateState(e.update),e.update.type==="restore-previous-graph"&&this.startQuestFromRestore()}startQuestFromRestore(){let e=this.graphsController.currentGraph.questHash;e&&this.tourController.startQuestFromUndo(e)}refreshGraphs(){this.graphsController.refreshGraphs({allProducts:this.showSavedGraphsRedesign()})}getCalculatorConstructor(){switch(this.product){case"geometry-calculator":return nf;case"graphing":return af;case"graphing-3d":return Qm;default:throw this.product,new Error(`Expected all products to be handled, but got ${this.product}.`)}}initializeApi(){let e=document.getElementById("graph-container");this.api=new(this.getCalculatorConstructor())(e,{...jz(),...this.getFeatureFlaggedApiConfig(),...this.initApiOptions.configOverrides(this.product)},this.initApiOptions.onCalcReady),this.api.updateSettings({language:this.getLanguage()}),this.api._calc.controller.setBugsnagContext("main-controller"),window.Calc=this.api}ensureCorrectProduct(e){var o,i;if(this.product===e)return;this.graphsController.currentGraph.setGraphData(this.api.getState()),this.tourController.stopTour({reason:"exit",stopImmediately:!0}),this.api._calc.globalHotkeys instanceof Ny&&this.api._calc.globalHotkeys.remove(),this.api.destroy(),this.product=e,this.initializeApi(),(i=(o=this.initApiOptions).setUpSubscribers)==null||i.call(o,this.api,this);let t=document.querySelector('link[rel="icon"]');t&&(t.href=J8[this.product])}getNoticeName(){if(this.hasTemporarilyDismissedNotices)return;let e=t=>!this.userController.hasPermanentlyDismissedNotice(t)&&(!this.api.controller.isNarrow()||!fK(t));if(this.product!=="graphing-3d"&&!this.userController.isLoggedIn()&&!this.graphsController.currentGraph.hash&&e("authenticate"))return"authenticate";if(this.userController.isLoggedIn()&&this.getArtExpoStatus()==="open"&&!this.artController.isLoadingSubmissions(Yf,Hs)&&!this.artController.hasSubmissions(Hs,this.product)&&e("art-contest"))return"art-contest";if(this.product==="graphing-3d"&&e("3d"))return"3d"}closeExternalLoginPopupWindow(){w6()}logDispatches(e){e.type==="toggle-menu"&&this.getOpenMenu()!==e.payload?e.payload==="help"?this.logEvent({category:"help",action:"open-menu"}):e.payload==="art-contest"&&this.logEvent({category:"art-contest",action:"open-menu"}):e.type==="open-mygraphs"&&this.logEvent({category:"mygraphs",action:"open-menu"})}triggerRender(){this.views.forEach(e=>e.update())}hookupObserveEvents(){this.tourController.observeEvent("startQuest",()=>{this.triggerRender()}),this.tourController.observeEvent("stopQuest",()=>{this.triggerRender()})}hookupControllers(){this.mygraphsController.observeEvent("triggerRender",()=>{this.triggerRender()}),this.userController.observeEvent("userUpdated",()=>{this.api.updateSettings(this.getFeatureFlaggedApiConfig())}),this.graphsController.observeEvent("triggerRender",()=>{this.triggerRender()})}hookupHotkeys(){re(document).on("keydown",e=>{var s;let t,{altKey:o,ctrlKey:i,metaKey:n,shiftKey:a}=e;if(qr?t=!i&&n&&!o&&!a:t=i&&!n&&!o&&!a,t)switch(Jr(e)){case"S":return this.simpleSave(),!1;case"O":return this.showSavedGraphsRedesign()?this.getOpenModal()==="my-graphs"?(s=document.querySelector(".dcg-action-new-blank-graph-construction"))==null||s.focus():this.dispatch({type:"show-modal",modal:"my-graphs"}):this.dispatch({type:"open-mygraphs"}),!1}})}disablePrintAndExport(){this._disablePrintAndExport=!0}shouldDisablePrintAndExport(){return this.product==="graphing-3d"?!0:!!this._disablePrintAndExport}getOpenMenu(){return this._openMenu}getModalState(){return this._openModal||{modal:"none"}}getOpenModal(){var e,t;return(t=(e=this._openModal)==null?void 0:e.modal)!=null?t:"none"}hasOpenModal(){return!!this._openModal}isSharingGraph(){return this._nextShareMenuState!==void 0}closeModal(){var e,t,o,i,n;if(((e=this._openModal)==null?void 0:e.modal)!=="authentication"&&(this._isSavingGraph=!1,this.showSavedGraphsRedesign()&&(this._nextShareMenuState=void 0)),((t=this._openModal)==null?void 0:t.modal)==="authentication"&&!this.isLoggedIn()&&Sr({category:"authentication",action:"close-modal",name:this.userController.getAuthenticationStep().name}),((o=this._openModal)==null?void 0:o.modal)==="my-graphs"&&this.mygraphsController.resetModalState(),((i=this._openModal)==null?void 0:i.modal)==="contest-submission"&&this.getNoticeName()==="art-contest"&&(this.hasTemporarilyDismissedNotices=!0),((n=this._openModal)==null?void 0:n.modal)==="change-email"){let a=Lx();a.delete("changeToken"),Px(a)}this._openModal=void 0}closeMenu(){this._openMenu="none"}showModal(e){if(this.isSharingGraph()||this.closeMenu(),this._openModal=e,e.modal==="authentication"&&(this.userController.perform({type:"reset-authentication-step"}),e.fromButton)){let t;switch(e.fromButton){case"log-in":t="open-modal--login";break;case"sign-up":t="open-modal--signup";break;case"save":t="open-modal--save";break;default:return e.fromButton}this.logEvent({category:"authentication",action:t,name:Hz()})}e.modal==="my-graphs"&&this.isLoggedIn()&&(this.graphsController.millisecondsSinceSync()>2*60*1e3&&this.refreshGraphs(),this.graphsController.fetchRecoveryGraphs())}setOpenMenu(e,t=!0){var o,i;this.showSavedGraphsRedesign()&&this._openMenu==="share"&&this.mygraphsController.setShareMenuState("main"),(e==="none"||e===this._openMenu&&t)&&((i=(o=this._lastActiveElement)==null?void 0:o.focus)==null||i.call(o)),this._openMenu=e===this._openMenu?"none":e,this._lastActiveElement=document.activeElement,this._openMenu==="share"&&this.graphsController.createSnapshotLink()}getFeedbackMessage(){return this._feedbackMessage}getFeedbackEmail(){return this._feedbackEmail!==void 0?this._feedbackEmail:this.userController.getEmail()||""}setFeedbackMessage(e){this._feedbackMessage=e}setFeedbackEmail(e){this._feedbackEmail=e}clearForm(){this.setFeedbackEmail(void 0),this.setFeedbackMessage(""),this._requestedContactForm=!1}getProduct(){return this.product}isGeometry(){return this.product==="geometry-calculator"}focusFirstExpression(){this.api.controller.focusFirstExpression()}saveRecoveryState(){let e=this.api.getState(),t=this.graphsController.saveRecoveryGraph();return this.lastRecoveryState=e,t}shouldSaveRecoveryState(){if(!this.userController.isLoggedIn()||!this.graphsController.hasUnsavedChanges())return!1;let e=this.api.getState();return!__dcg_shared_module_exports__['db'](e,this.lastRecoveryState)}checkRecoveryState(){this.graphsController.isRecoveryUIEnabledForProduct()&&setTimeout(()=>{this.checkRecoveryState(),this.shouldSaveRecoveryState()&&this.saveRecoveryState()},_se)}isLoggedIn(){return this.userController.isLoggedIn()}isDecimalToFractionEnabled(){return this.getApiConfig().decimalToFraction}isSaveEnabled(){return this.graphsController.isSaveEnabled()}saveGraph(e){this.isLoggedIn()?(this.graphsController.save({newTitle:e==null?void 0:e.title,saveCopy:!!(e!=null&&e.saveCopy)}),this._isSavingGraph=!1,this.showSavedGraphsRedesign()&&this._nextShareMenuState?(this.mygraphsController.setShareMenuState(this._nextShareMenuState),this._nextShareMenuState=void 0):this.closeMenu(),e!=null&&e.preventCloseModal||this.closeModal()):this.showModal({modal:"authentication",fromButton:"save"})}simpleSave(){this.userController.isLoggedIn()?this._isSavingGraph&&this.graphsController.wasCurrentGraphEverSaved()?this.dispatch({type:"show-modal",modal:"duplicate"}):this.graphsController.wasCurrentGraphEverSaved()?this.dispatch({type:"save-graph"}):this.openSaveDialog():(this._isSavingGraph=!0,this.dispatch({type:"show-modal",modal:"authentication",fromButton:"save"}))}saveFromShareMenu(){this._nextShareMenuState="share-my-graph",this.simpleSave()}openSaveDialog(e={}){this.dispatch({type:"show-modal",modal:"save",fromSaveInProgress:e.fromSaveInProgress})}getOpenText(){switch(this.product){case"graphing":case"graphing-3d":return this.s("account-shell-button-open-graph");case"geometry-calculator":return this.s("account-shell-button-open-construction")}}getArtExpoStatus(){if(zy.isInApp())return"inactive";let e=Hi("artExpo")||"";return this.userController.hasFeatureFlag("artExpo")&&Q8(e)?e:Z8}isGraphComplexEnoughForContest(){let e=this.api.getState(),{list:t}=e.expressions;return t.filter(i=>i.type!=="folder"&&(i.type!=="expression"||!!i.latex&&i.latex!=="")).length>=1}shouldShowArtContestNudge(){return this.getArtExpoStatus()==="open"&&this.isGraphComplexEnoughForContest()&&this.isLoggedIn()&&!this.graphsController.willSaveCopy()}logEvent(e){Sr(e)}parseJSONErrors(e,t){return Qh(e,this.s,t)}contactFormStartsOpen(){return this.product==="geometry-calculator"||this.product==="graphing-3d"}requestedContactForm(){return this._requestedContactForm}getApiConfig(){return this.api._calc.grapher.settings.config}getFeatureFlaggedApiConfig(){var t;let e={};return Xc("actions")===void 0&&(e.actions=((t=this.userController)==null?void 0:t.hasFeatureFlag("dcg-actions"))||_h.actions),_K.forEach(o=>{var i;return e[o]=((i=this.userController)==null?void 0:i.hasFeatureFlag(o))||_h[o]}),e}showModalToast(e){this.myGraphsToastData=e,clearTimeout(this.hideMyGraphsToastTimeout);let t=typeof e.hideAfter=="number"?e.hideAfter:6e3;t>0&&(this.hideMyGraphsToastTimeout=setTimeout(()=>{this.dispatch({type:"my-graphs-toast-close",onHide:this.myGraphsToastData.onHide})},t))}closeModalToast(){let e=this.myGraphsToastData.onHide;e&&this.runAfterDispatch(e),this.myGraphsToastData={}}};var Zy=__dcg_shared_module_exports__['e'](j());var Cse=__dcg_shared_module_exports__['e'](j()),Tse=({controller:r,View:e})=>class extends Cse.View{didMount(){r.registerView(this)}didUnmount(){r.unregisterView(this)}template(){return l(e,{controller:this.const(r),...this.props})}};var _l=__dcg_shared_module_exports__['e'](j());var UT=__dcg_shared_module_exports__['e'](j()),Kc=class extends UT.View{constructor(){super(...arguments),this.controller=this.props.controller()}hide({device:e}){this.controller.dispatch({type:"close-notice",focusFirstExpression:e==="keyboard"})}template(){return l("i",{class:()=>({"dcg-icon-remove":!0,"dcg-close-notice-icon":!0,"dcg-theme-dark":this.props.theme()==="dark","dcg-theme-light":this.props.theme()==="light"}),role:UT.const("button"),tabIndex:UT.const("0"),"aria-label":()=>this.controller.s("shared-button-close-message"),onTap:this.bindFn(this.hide)})}};var tR=class extends _l.View{constructor(){super(...arguments),this.controller=this.props.controller(),this.s=this.controller.s}template(){return x("aside",{class:_l.const("dcg-notice dcg-notice--3d"),children:[l(Kc,{controller:this.props.controller,theme:this.const("dark")}),l("h2",{class:_l.const("dcg-notice__title"),children:()=>this.s("account-shell-text-welcome-to-3d")}),l("div",{class:_l.const("dcg-notice__message"),children:x(Ot,{i18n:this.props.controller,children:["Please share any bugs, questions, or suggestions at:"," ",l("a",{class:_l.const(""),href:_l.const("mailto:feedback@desmos.com"),children:"feedback@desmos.com"})]},this.const("account-shell-text-3d-expression-list-notice"))}),x("div",{class:_l.const("dcg-notice__actions"),children:[x("a",{class:_l.const("dcg-btn-white-outline dcg-unstyled-button dcg-flexed-notice-btn"),href:_l.const("//blog.desmos.com/articles/beta-3d-release/"),target:_l.const("_blank"),onTap:()=>this.controller.logEvent({category:"notice",action:"3d",name:"read-blog"}),children:[()=>this.s("account-shell-link-read-blog"),l("span",{class:_l.const("dcg-sr-only"),children:()=>this.s("account-shell-link-read-blog")})]}),l("button",{class:_l.const("dcg-unstyled-button dcg-notice__action--primary dcg-flexed-notice-btn"),onTap:()=>{var e;return(e=this.controller.tourController)==null?void 0:e.setQuestsListModalVisibility(!0)},children:()=>this.s("account-shell-link-try-a-quest")})]})]})}};jo();var Ns=__dcg_shared_module_exports__['e'](j());var{IfElse:cEe}=Ns.Components,rR=class extends Ns.View{constructor(){super(...arguments),this.controller=this.props.controller()}onLinkButtonTap(){Sr({category:"notice",action:"art-contest",name:`join-${this.wasArtContestParticipant()?"participant":"non-participant"}`}),this.controller.dispatch({type:"toggle-menu",payload:"art-contest"})}getSubmission(){return this.controller.artController.getSubmission({year:Yf,product:this.controller.getProduct()})}getSubmissionThumbnail(){var e;return(e=this.getSubmission())==null?void 0:e.thumb}getSubmissionThumbnailAlt(){let e=this.getSubmission();return!(e!=null&&e.title)&&!(e!=null&&e.name)?"":e.title?this.controller.s("frontpage-narration-art-contest-image-of-graph",{graphTitle:e.title}):this.controller.s("frontpage-narration-art-contest-image-of-graph-by",{name:e.name})}wasArtContestParticipant(){return!!this.getSubmission()}template(){return x("aside",{class:()=>({"dcg-notice":!0,"dcg-notice--art-contest":!0,"dcg-notice--art-contest-non-participant":!this.wasArtContestParticipant(),"dcg-notice--art-contest-participant":this.wasArtContestParticipant()}),children:[l(Kc,{controller:this.props.controller,theme:()=>this.wasArtContestParticipant()?"dark":"light"}),cEe(this.bindFn(this.wasArtContestParticipant),{true:()=>x(Ot,{i18n:this.const(this.controller),children:[l("button",{class:Ns.const("dcg-unstyled-button"),onTap:this.bindFn(this.onLinkButtonTap),children:l("img",{class:Ns.const("dcg-notice__thumbnail"),src:this.bindFn(this.getSubmissionThumbnail),alt:this.bindFn(this.getSubmissionThumbnailAlt)})}),x("span",{children:["Great work in last year's Art Expo\u2014",l("button",{class:Ns.const("dcg-notice__link-button dcg-notice__link-button--dark dcg-unstyled-button"),onTap:this.bindFn(this.onLinkButtonTap),children:"join this year's too"}),"! ",l("i",{class:Ns.const("dcg-icon-sparkle"),"aria-hidden":Ns.const("true")})]})]},this.const("account-shell-text-art-contest-notice-participant")),false:()=>l("div",{children:x(Ot,{i18n:this.const(this.controller),children:[l("i",{class:Ns.const("dcg-icon-sparkle"),"aria-hidden":Ns.const("true")})," ",l("button",{class:Ns.const("dcg-notice__link-button dcg-blue-link dcg-unstyled-button"),onTap:this.bindFn(this.onLinkButtonTap),children:"Join the 2024 Art Expo"})," ",l("i",{class:Ns.const("dcg-icon-sparkle"),"aria-hidden":Ns.const("true")}),l("br",{}),"Do you have a graph that you're proud of? We'd love to see it!"]},this.const("account-shell-text-art-contest-notice-non-participant"))})})]})}};var yf=__dcg_shared_module_exports__['e'](j());var oR=class extends yf.View{constructor(){super(...arguments),this.controller=this.props.controller()}onLinkButtonTap(e){this.controller.logEvent({category:"notice",action:"authenticate",name:e}),this.controller.dispatch({type:"show-modal",modal:"authentication"})}template(){return x("aside",{class:yf.const("dcg-notice dcg-notice--authenticate"),children:[l(Kc,{controller:this.props.controller,theme:this.const("light")}),l("button",{class:yf.const("dcg-unstyled-button dcg-notice__tile"),onTap:()=>this.onLinkButtonTap("product-icon"),tabIndex:yf.const("-1"),children:l(Rs,{name:()=>this.controller.isGeometry()?"geometry":"2d"})}),l("div",{children:x(Ot,{i18n:this.props.controller,children:[l("button",{class:yf.const("dcg-notice__link-button dcg-blue-link dcg-unstyled-button"),onTap:()=>this.onLinkButtonTap("log-in"),children:"Log in"})," ","or"," ",l("button",{class:yf.const("dcg-notice__link-button dcg-blue-link dcg-unstyled-button"),onTap:()=>this.onLinkButtonTap("sign-up"),children:"sign up"})," ","to save your beautiful math!"]},this.const("account-shell-text-authenticate-notice"))})]})}};var og=__dcg_shared_module_exports__['e'](j());var iR=class extends og.View{constructor(){super(...arguments),this.controller=this.props.controller()}template(){return x("aside",{class:og.const("dcg-notice dcg-notice--terms"),children:[l(Kc,{controller:this.props.controller,theme:this.const("light")}),l("div",{class:og.const("dcg-notice__message"),children:()=>this.controller.s("frontpage-text-header-terms-update")}),l("div",{class:og.const("dcg-notice__actions"),children:l("a",{href:og.const("//blog.desmos.com/articles/desmos-studio-terms-update//"),target:og.const("_blank"),class:og.const("dcg-notice__action dcg-btn-gray-outline"),children:()=>this.controller.s("account-shell-link-read-blog")})})]})}};var yu=__dcg_shared_module_exports__['e'](j());var dEe={start:new Date("2024-08-10T09:00:00.000-04:00"),end:new Date("2024-08-10T11:00:00.000-04:00")};function pEe(r,e){let{start:t,end:o}=dEe,i=new Intl.DateTimeFormat(r,{year:"numeric",month:"short",day:"numeric",weekday:"short"}),n=new Intl.DateTimeFormat(r,{hour:"numeric",timeZoneName:"short"});return o?e("shared-message-maintenance-window",{localizedStartDate:i.format(t),localizedStartTime:t.toLocaleString(r,{hour:"numeric"}),localizedEndTime:n.format(o)}):e("shared-message-maintenance-starts-at",{localizedStartDate:i.format(t),localizedStartTime:n.format(t)})}var nR=class extends yu.View{constructor(){super(...arguments),this.controller=this.props.controller()}template(){return x("aside",{class:yu.const("dcg-notice dcg-notice--upcoming-maintenance"),children:[l(Kc,{controller:this.props.controller,theme:this.const("light")}),x("div",{class:yu.const("dcg-notice__message"),children:[()=>pEe(this.controller.getLanguage(),this.controller.s)," ",l("a",{role:yu.const("link"),class:yu.const("dcg-blue-link"),tabIndex:yu.const(0),target:yu.const("_blank"),href:yu.const("https://help.desmos.com/hc/en-us/articles/29072368846093-Maintenance-Mode"),children:()=>this.controller.s("graphing-calculator-link-learn-more")})]})]})}};var{IfDefined:uEe,Switch:hEe}=Zy.Components,M6=class extends Zy.View{constructor(){super(...arguments),this.controller=this.props.controller()}template(){return uEe(()=>this.controller.getNoticeName(),e=>l("div",{class:Zy.const("dcg-notice-wrapper dcg-text-selectable"),role:Zy.const("note"),children:l(hEe,{children:t=>{switch(t){case"authenticate":return l(oR,{controller:this.props.controller});case"3d":return l(tR,{controller:this.props.controller});case"art-contest":return l(rR,{controller:this.props.controller});case"terms":return l(iR,{controller:this.props.controller});case"upcoming-maintenance":return l(nR,{controller:this.props.controller})}}},e)}))}},Ese=r=>Tse({controller:r,View:M6});var aR=class{constructor(){this.seen=new Set;this.samples=[];this.button=document.createElement("button");this.isRecording=!1;this.reset(),this.button.addEventListener("click",()=>{if(this.isRecording){this.isRecording=!1;let e=this.reportAsCalcState();console.log("Profiler result (also set on window.profilerResult):"),console.log(e),window.profilerResult=e;let t=JSON.stringify(e);fEe(t)}else this.reset(),this.isRecording=!0;this.updateButtonText()})}updateButtonText(){this.button.innerText=this.isRecording?"\u25FC\uFE0F":"\u{1F534}"}add(e,t){this.seen.has(e)||this.samples.push(t)}reset(){this.seen=new Set,this.samples=[],this.isRecording=!1,this.updateButtonText()}reportAsCalcState(){let e={};for(let o of this.samples)for(let i in o)e[i]||(e[i]=[]),e[i].push(o[i]);return gEe(window.location.href,e)}},Ise=[__dcg_shared_module_exports__['zd'].RED,__dcg_shared_module_exports__['zd'].BLUE,__dcg_shared_module_exports__['zd'].GREEN,__dcg_shared_module_exports__['zd'].PURPLE,__dcg_shared_module_exports__['zd'].ORANGE,__dcg_shared_module_exports__['zd'].BLACK];function gEe(r,e){let t=[];for(let i in e){let n=e[i].map(__dcg_shared_module_exports__['lb']);t.push({id:`col-${i}`,latex:mEe(i),values:n,color:Ise[t.length%Ise.length]})}return{...lC,expressions:{list:[{id:"1",type:"text",text:r},{id:"2",type:"table",columns:t}]}}}function mEe(r){if(r.length===1)return r;let e=r.replace(/[^a-zA-Z0-9_]/g,"").replace(/^[0-9]/,"").replace(/__+/g,"_");return`${e[0]}_{${e.slice(1)}}`}async function fEe(r){if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(r);else{let e=document.createElement("textarea");e.value=r,e.style.position="absolute",e.style.left="-999999px",document.body.prepend(e),e.select();try{document.execCommand("copy")}catch(t){console.error(t)}finally{e.remove()}}}function Mse(r){let e=document.createElement("div");Yo(e,{zIndex:"99999",position:"absolute",left:"0px",top:"0px",background:"#FFF"}),document.body.append(e);let t=document.createElement("div");t.innerText="waiting...",t.style.display="inline-block";let o=new aR;e.appendChild(o.button),e.appendChild(t);let i=[],n=[];r.controller.onEvaluatorChangesSpy=function(){i.push(Date.now())};let a=new WeakSet;window.__dcgKnownPrograms=a;let s=0;if(window.__reset3DFpsStats=()=>{i=[],n=[],a=new WeakSet,window.__dcgKnownPrograms=a,s=0},r.controller.isThreeDMode()){let c=r.controller.getGrapher3d().webglLayer;c.debugOnlyMeasureGPUTiming=!0,c.onRenderSpy=function(){let d=c.debugGetPrograms(),p=d.reduce((g,h)=>g+h.usedTimes,0),u=0;for(let g of d)a.has(g)||(u+=1,s+=1,a.add(g));n.push({ts:Date.now(),programCount:d.length,programUses:p,newProgramCount:u,frame:c.lastRenderInfo})},c.debugOnlyTrackBufferUploads()}setInterval(()=>{let c=Date.now();for(;c-i[0]>1e3;)i.shift();for(;n.length&&c-n[0].ts>1e3;)n.shift();let d=n.length,p=n.slice(-100);if(o.isRecording)for(let N of p){let{startTimeCPU:Y,durationCPU:z,endTimeGPU:X}=N.frame;X&&o.add(Y,{t0:Y,tcpu:z,tgpu0:X[0]-Y,tgpu1:X[1]-Y})}let u=xu(p.map(N=>N.frame.durationCPU),2),g=[],h=[];for(let{frame:N}of p)N.endTimeGPU&&(g.push((N.endTimeGPU[0]+N.endTimeGPU[1])/2-N.startTimeCPU),h.push((N.endTimeGPU[0]-N.startTimeCPU)/2));let b=xu(g,2),v=xu(h,0),T=xu(p.map(N=>N.programUses)),E=xu(p.map(N=>N.programCount)),I=xu(p.map(N=>N.newProgramCount)),_=xu(p.map(N=>N.frame.triangles/1e3)),C=xu(p.map(N=>N.frame.bufferUploads,0)),D=xu(p.map(N=>N.frame.bufferUploadItems/1e3,1)),P=xu(p.map(N=>N.frame.peelLayers)),F=r.controller.isThreeDMode()?[`compute: <span dcg-fps-metric="computeFPS">${i.length}</span> fps`,`3d render: <span dcg-fps-metric="fps">${d}</span> fps`,`Redraw (CPU): <span dcg-fps-metric="redraw">${u}</span> ms`,`Redraw (CPU+GPU): <span dcg-fps-metric="cpu-gpu-redraw">${b}</span> \xB1<span dcg-fps-metric="cpu-gpu-redraw-error">${v}</span>ms`,`peels: <span dcg-fps-metric="peelLayers">${P}</span>`,`triangles: <span dcg-fps-metric="triangles">${_}</span>K/fr`,`buffers: <span dcg-fps-metric="uploadsPerFrame">${C}</span> uploads/fr, <span dcg-fps-metric="itemsPerFrame">${D}</span>K items/fr`,`programs: <span dcg-fps-metric="programsPerFrame">${T} uses/fr, <span dcg-fps-metric="programsCurrentPerFrame">${E} current/fr, <span dcg-fps-metric="programsNewPerFrame">${I}</span> new/fr, <span dcg-fps-metric="programsTotal">${s}</span> total`].join(" | "):`${i.length} fps`;t.innerHTML=F},100)}function xu(r,e=1){let t=0;for(let i of r)t+=i;return(t/r.length).toFixed(e)}function Dse(r){let e=document.createElement("div");Yo(e,{zIndex:"99999",position:"absolute",left:"0px",top:"0px",background:"#FFF"}),e.innerText="waiting...",document.body.append(e);let t=[],o=0;r.controller.onEvaluatorChangesSpy=function(s,c){let{timeInWorker:d}=c;t[o%100]=d,o+=1};function i(){let s=0;for(let d of t)s+=d;let c=s/t.length;e.innerText=c.toFixed(1)+" ms"}let n;function a(){cancelAnimationFrame(n),n=requestAnimationFrame(a),i()}a()}var I6=(r,e)=>{r.dispatch({type:"toast/show",toast:{message:e("account-shell-text-maintenance-mode"),hideAfter:-1,link:{text:e("account-shell-link-learn-more"),url:"https://help.desmos.com/hc/en-us/articles/29072368846093-Maintenance-Mode"}}})},bEe=(r,e)=>{let{graphsController:t,mygraphsController:o,tourController:i}=e,n=!1;r._calc.controller.subscribeToChanges(()=>{let s=r._calc.controller.hasUnsavedChanges();s!==n&&e.triggerRender(),n=s});let a;r._calc.controller.triggerEasterEgg=s=>{let c=t.getEasterEggGraphs(s);if(c.length===0)return;let d=s==="betchacant"?r._calc.controller.s("account-shell-label-betchacant-loading"):r._calc.controller.s("account-shell-label-loading");a=Math.floor(Math.random()*c.length),r._calc.controller.dispatch({type:"toast/show",toast:{message:d,hideAfter:0,toastStyle:"cover"}}),t.loadDataForGraphImmediately(c[a]).then(()=>{o.openGraphBehindCover(c[a])})},Xc("expressions")!==!1&&(r._calc.controller.triggerClearGraph=()=>{e.dispatch({type:"update-graphs-state",update:{type:"open-blank-graph"}})}),r.observeEvent("openDrawer",()=>{e.showSavedGraphsRedesign()?e.dispatch({type:"show-modal",modal:"my-graphs"}):e.dispatch({type:"open-mygraphs"})}),r._calc.controller.setShellView("notice",Ese(e)),r._calc.controller.getQuestIsActive=()=>i.getQuestActive(),r._calc.globalHotkeys=new Ny(r._calc.controller,e,r._calc.instanceHotkeys),r._calc.controller.setCanShowKeyboardShortcuts(!0),r.observeEvent("showHotkeysModal",()=>{e.dispatch({type:"show-modal",modal:"hotkeys"})}),r._calc.controller.logEvent=Sr,r._calc.controller.logEventsFromDispatch=s=>{switch(s.type){case"create-table-regression":Sr({category:"regressions",action:"add-table-regression",name:"linear"});break;case"update-table-regression":"type"in s.update&&Sr({category:"regressions",action:"update-table-regression",name:s.update.type});break;case"remove-table-regression":Sr({category:"regressions",action:"remove-table-regression"});break;case"export-table-regression":Sr({category:"regressions",action:s.mode==="regression"?"export-model-to-expression-list":"copy-snapshot-to-expression-list",name:s.regressionType});break;case"set-table-regression-dropdown-open":s.open&&Sr({category:"regressions",action:"view-regression-options",name:s.regressionType})}}};function Ase({exampleGraphsRaw:r,seed:e,initialProduct:t,apiOptionOverrides:o,onCalcReady:i}){let n={graphing:JSON.parse(r.graphing),"geometry-calculator":JSON.parse(r["geometry-calculator"]),"graphing-3d":JSON.parse(r["graphing-3d"])};qz();let a=new eR({product:t,randomSeed:e,exampleGraphs:n,apiOptionOverrides:o,onCalcReady:i,setUpCalcSubscribers:bEe}),s=a.api,c=a.userController,d=a.graphsController,p=a.tourController;return Xc("maintenance")&&a.getNoticeName()!=="upcoming-maintenance"&&I6(s._calc.controller,a.s),Uo("simulationFPS")&&setTimeout(()=>Mse(s),1),Uo("timeInWorker")&&Dse(s),window.userController=c,window.shellController=a,window.tourController=p,{userController:c,graphsController:d,tourController:p,shellController:a,Calc:s}}Ut();var vu=re(document.body).data("load-data");Ut();var yEe=500*1024,Lse=[];function Pse(){let r=[],e=0;for(let t=0;t<Lse.length;t++){let o=Lse[t];if(e+=o.size,e>yEe)break;r.push(o.payload)}return r}var Rse=__dcg_shared_module_exports__['e'](Vse());function xEe(r){return r.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")}var vEe=["UnhandledRejection","lnrAppboy","socratic","MyAppGet","SymBrowser_","mobincube_","_avast_submit","Cannot redefine property: googletag","jcarousel","SyntaxError: Unexpected identifier 'script'","__gCrWeb.autofill.extractForms","BrowseITEXT","Can't find variable: removeAllHighlights","aAttribruteValue.parentNode.getAttribute","vid_mate_check","GetImageTagSrcFromPoint","Can't find variable: didEnterViewPort","tinyMCE is not defined","div:has(> iframe[id='198230182308109283091823098102938908128390'])"],Ose=new RegExp(vEe.map(xEe).join("|"));function wEe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{let e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}function SEe(){return window.Desmos&&window.Desmos.commit}function kEe(){let r="production";if(location&&location.hostname){let t=location.hostname.split("."),o=t.slice(0,t.length-2).join(".");t.slice(t.length-2).join(".")==="desmos.com"&&(!o||o==="www"?r="production":r=o)}return r}var sR=class{constructor(){this.numberOfSentErrors=0;this.pageLoadId=wEe();this.bugsnagClient=Rse.default.start({apiKey:"7f7807097671acbc4557e64bbf5eb529",maxBreadcrumbs:40,appVersion:SEe(),releaseStage:kEe(),onError:e=>this.onError(e),enabledBreadcrumbTypes:["error","navigation","request","user"]})}onError(e){let t=Fu;return t&&t[0]<=10||e.errors.some(o=>Ose.test(o.errorClass)||Ose.test(o.errorMessage))?!1:(this.beforeSendCb&&this.beforeSendCb(e),this.attachWebGLReport&&this.attachWebGLReport(e),this.numberOfSentErrors+=1,e.addMetadata("custom",{errorNumber:this.numberOfSentErrors,pageLoadId:this.pageLoadId}),!0)}setBeforeSendCB(e){this.beforeSendCb=e}setAttachWebGLReport(e){this.attachWebGLReport=e}leaveBreadcrumb(e,t,o){if(t){t={...t};for(let i in t)try{t[i]=JSON.stringify(t[i],null,2)}catch(n){t[i]="[[could not stringify]]"}}this.bugsnagClient.leaveBreadcrumb(e,t,o)}notify(e,t){this.bugsnagClient&&this.bugsnagClient.notify(e,o=>(t&&t.metaData&&o.addMetadata("custom",t.metaData),t&&t.context&&(o.context=t.context),t&&t.severity&&(o.severity=t.severity),!0))}};var Fse=__dcg_shared_module_exports__['e'](j());function _Ee(r,e){let t=document.createElement("div");t.style.zIndex="999999",t.style.position="fixed",t.style.bottom="50px",t.style.left="0",t.style.right="0",document.body.append(t),Fse.mountToNode(uf,t,{s:e,didDataLoadFail:function(){return!0},requestLoadGraphData:function(){t.remove(),r()}})}function Nse(r,e){return new Promise(t=>{if(r&&r.state)t(r);else if(r&&typeof r.stateUrl=="string"){let o=!1,i=async()=>{if(!o){o=!0;try{let n=await fetch(`${r.stateUrl}?${new URLSearchParams(Ig)}`,{headers:{Accept:"application/json"}});if(!n.ok)throw void 0;let a=await n.json();r.state=a,t(r)}catch(n){_Ee(i,e)}finally{o=!1}}};i()}else t(void 0)})}var Use;Uo("testing")||(Yz(new sR),window.self!==window.top&&((Use=window.top)==null||Use.postMessage("embed",window.location.origin),__dcg_shared_module_exports__['Be'].log("%c%s","font-size:2em; color: #fad54b;","Warning: iFrames aren't a supported or secure way to use Desmos inside of another application. Please reach out to partnerships@desmos.com for more details on how to safely embed Desmos within your website.")));async function Yse({exampleGraphsRaw:r,initialProduct:e}){let t=tb();try{await pv(t)}catch(v){}Xc("disableScrollFix")||Are();let o=Ase({seed:vu.seed,exampleGraphsRaw:r,initialProduct:e,apiOptionOverrides:v=>{let T=!0;return v==="graphing"&&(T=!1),{border:!1,disableScrollFix:!0,showHamburger:!0,pasteGraphLink:!0,showKeyboardShortcutsInTooltips:!0,onlyTraceSelected:T}}}),i=o.Calc,n=i._calc.controller,a=o.userController,s=o.graphsController,c=o.tourController,d=o.shellController,p=d.s.bind(d);Bz(v=>{let T=d.api._calc.controller.stateStack;T&&T.serializeForBugsnag&&v.addMetadata("states",T.serializeForBugsnag());let E=v.originalError;E&&E.dcgExtraErrorMetaData&&v.addMetadata("extraErrorData",E.dcgExtraErrorMetaData),v.addMetadata("codeEvents",Pse())});let u=new ak(e,{calcController:n,graphsController:s});u.trackFeatureUsage("graph-feature","hasSlider"),u.trackFeatureUsage("graph-feature","hasRegression"),u.trackFeatureUsage("graph-feature","hasAction"),u.trackFeatureUsage("graph-feature","expressionErrors"),u.trackFeatureUsage("graph-feature","expressionCount"),u.trackFeatureUsage("graph-feature","folderCount"),u.trackFeatureUsage("graph-feature","imageCount"),u.trackFeatureUsage("graph-feature","tableCount"),u.trackFeatureUsage("graph-feature","textCount"),i.observeEvent("change",(v,{isUserInitiated:T})=>{T&&u.handleUserChangeEvent()}),u.start(),dse({userController:a,i18n:p}),(vK()||Uo("testing")||Uo("reloadcss")||Uo("noconcat"))&&!Uo("showNavigationWarning")||re(window).on("beforeunload",()=>{if(s.hasUnsavedChanges())return p("account-shell-text-confirm-leave")}),vu.user&&a.completeLogin(vu.user);let h=vu.graph;h||(d.dispatch({type:"update-graphs-state",update:{type:"clear-graph-without-undo"}}),vu.latex&&i.setExpression({latex:vu.latex})),c.startTourFromUrl(),a.getEmailChangeToken()&&d.getOpenModal()!=="change-email"&&d.dispatch({type:"show-modal",modal:"change-email"}),Nu&&!hz&&!Gx&&d.dispatch({type:"show-modal",modal:"unsupported-browser"}),document.location.search.match(/(\?|\&)create_account/)?(history.replaceState(null,"",document.location.pathname),a.isLoggedIn()?n.dispatch({type:"toast/show",toast:{message:p("account-shell-text-logged-in")}}):d.dispatch({type:"show-modal",modal:"authentication"})):document.location.search.match(/(\?|\&)login/)?(history.replaceState(null,"",document.location.pathname),a.isLoggedIn()?n.dispatch({type:"toast/show",toast:{message:p("account-shell-text-logged-in")}}):d.dispatch({type:"show-modal",modal:"authentication"})):document.location.search.match(/(\?|\&)reset_password/)&&(history.replaceState(null,"",document.location.pathname),d.dispatch({type:"show-modal",modal:"recover-password"})),window.matchMedia&&window.matchMedia("print").addListener(T=>{T.matches?n.dispatch({type:"enter-printmode"}):n.dispatch({type:"exit-printmode"})}),N_(document);let b=await Nse(h,p);if(b&&b.state)if(!d.showSavedGraphsRedesign()&&d.product==="graphing"&&b.state.graph.product==="geometry-calculator")window.location.replace(document.location.href.split("/calculator/").join("/geometry/"));else{let v=ki.fromAjax(b);d.dispatch({type:"open-fetched-graph-on-init",graph:v})}qx()}Ut();typeof Desmos=="undefined"&&(Desmos={});function Bse(){Desmos.$=re,Desmos.$.noConflict(!0)}function Kse(){window.TestBridge={}}jf(document.body);Bse();var CEe={graphing:Nz,"graphing-3d":Fz,"geometry-calculator":Uz},TEe=X8(vu.initialProduct)?vu.initialProduct:"graphing";Yse({initialProduct:TEe,exampleGraphsRaw:CEe}).then(()=>{document.querySelector(".dcg-loading-div-container").style.display="none",Kse()});
/*!
 * jQuery JavaScript Library v3.6.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2021-03-02T17:08Z
 */
/*!!
 *  Canvas 2 Svg v1.0.19
 *  A low level canvas to SVG converter. Uses a mock canvas context to build an SVG document.
 *
 *  Licensed under the MIT license:
 *  http://www.opensource.org/licenses/mit-license.php
 *
 *  Author:
 *  Kerry Liu
 *
 *  Copyright (c) 2014 Gliffy Inc.
 *
 *  Modifications by Desmos:
 *  - wrapped in AMD pattern
 *  - added ctx.ellipse() method
 *  - fixed image opacity bug
 *  - added ability to add classNames to exported svg elements
 *  - added ability to add named groups
 *  - removed dominant-basline attribute. Editors appear to ignore it. Must solve baseline issues using transformations
 */
})()